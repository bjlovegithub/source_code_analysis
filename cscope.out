cscope 15 $HOME/CodeAnalysis/xapian-core-1.1.4               0003477245
	@api/decvalwtsource.cc

21 
	~<cÚfig.h
>

23 
	~"x­Ÿn/po¡šgsourû.h
"

24 
	~"x­Ÿn/”rÜ.h
"

25 
	~"£rŸli£.h
"

26 
	~"£rŸli£-doubË.h
"

27 
	~<cm©h
>

29 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

31 
	gDeü—sšgV®ueWeightPo¡šgSourû
::
Deü—sšgV®ueWeightPo¡šgSourû
(

32 
X­Ÿn
::
v®u’o
 
¦Ù_
,

33 
X­Ÿn
::
docid
 
¿nge_¡¬t_
,

34 
X­Ÿn
::
docid
 
¿nge_’d_
)

35 : 
X­Ÿn
::
V®ueWeightPo¡šgSourû
(
¦Ù_
),

36 
¿nge_¡¬t
(
¿nge_¡¬t_
),

37 
	$¿nge_’d
(
¿nge_’d_
)

39 
	}
}

41 
	gX­Ÿn
::
weight


42 
Deü—sšgV®ueWeightPo¡šgSourû
::
	$g‘_weight
() const {

43  
cu¼_weight
;

44 
	}
}

46 
	gX­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 *

47 
Deü—sšgV®ueWeightPo¡šgSourû
::
	$şÚe
() const {

48  
Ãw
 
	`Deü—sšgV®ueWeightPo¡šgSourû
(
¦Ù
, 
¿nge_¡¬t
,

49 
¿nge_’d
);

50 
	}
}

52 
	g¡d
::
¡ršg


53 
Deü—sšgV®ueWeightPo¡šgSourû
::
	$Çme
() const {

55 
	}
}

57 
	g¡d
::
¡ršg


58 
Deü—sšgV®ueWeightPo¡šgSourû
::
	$£rŸli£
() const {

59 
¡d
::
¡ršg
 
»suÉ
;

60 
»suÉ
 +ğ
	`’code_Ëngth
(
¦Ù
);

61 
»suÉ
 +ğ
	`’code_Ëngth
(
¿nge_¡¬t
);

62 
»suÉ
 +ğ
	`’code_Ëngth
(
¿nge_’d
);

63  
»suÉ
;

64 
	}
}

66 
	gX­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 *

67 
Deü—sšgV®ueWeightPo¡šgSourû
::
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
) const {

68 cÚ¡ * 
pos
 = 
s
.
d©a
();

69 cÚ¡ * 
	g’d
 = 
pos
 + 
s
.
size
();

70 
	gX­Ÿn
::
v®u’o
 
Ãw_¦Ù
 = 
decode_Ëngth
(&
pos
, 
’d
, 
çl£
);

71 
	gX­Ÿn
::
docid
 
Ãw_¿nge_¡¬t
 = 
decode_Ëngth
(&
pos
, 
’d
, 
çl£
);

72 
	gX­Ÿn
::
docid
 
Ãw_¿nge_’d
 = 
decode_Ëngth
(&
pos
, 
’d
, 
çl£
);

73 ià(
	gpos
 !ğ
’d
)

74 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Junk‡tƒnd of serialised "

76  
Ãw
 
Deü—sšgV®ueWeightPo¡šgSourû
(
Ãw_¦Ù
, 
Ãw_¿nge_¡¬t
,

77 
Ãw_¿nge_’d
);

81 
	gDeü—sšgV®ueWeightPo¡šgSourû
::
š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db_
) {

82 
X­Ÿn
::
V®ueWeightPo¡šgSourû
::
š™
(
db_
);

83 ià(
	g¿nge_’d
 =ğ0 || 
db
.
g‘_doccouÁ
(è<ğ
¿nge_’d
)

84 
™ems_©_’d
 = 
çl£
;

86 
	g™ems_©_’d
 = 
Œue
;

90 
	gDeü—sšgV®ueWeightPo¡šgSourû
::
sk_if_š_¿nge
(
X­Ÿn
::
weight
 
mš_wt
)

92 ià(
v®ue_™
 =ğ
db
.
v®ue¡»am_’d
(
¦Ù
)) ;

93 
	gcu¼_weight
 = 
X­Ÿn
::
V®ueWeightPo¡šgSourû
::
g‘_weight
();

94 
	gX­Ÿn
::
docid
 docid = 
X­Ÿn
::
V®ueWeightPo¡šgSourû
::
g‘_docid
();

95 ià(
	gdocid
 >ğ
¿nge_¡¬t
 && (
¿nge_’d
 =ğ0 || 
docid
 <=„ange_end)) {

96 ià(
™ems_©_’d
) {

97 ià(
cu¼_weight
 < 
mš_wt
) {

99 
v®ue_™
.
sk_to
(
¿nge_’d
 + 1);

100 ià(
	gv®ue_™
 !ğ
db
.
v®ue¡»am_’d
(
¦Ù
))

101 
cu¼_weight
 = 
X­Ÿn
::
V®ueWeightPo¡šgSourû
::
g‘_weight
();

104 ià(
	gcu¼_weight
 < 
	gmš_wt
) {

106 
	gv®ue_™
 = 
db
.
v®ue¡»am_’d
(
¦Ù
);

109 
£t_maxweight
(
cu¼_weight
);

116 
	gDeü—sšgV®ueWeightPo¡šgSourû
::
Ãxt
(
X­Ÿn
::
weight
 
mš_wt
) {

117 ià(
g‘_maxweight
(è< 
mš_wt
) {

118 
v®ue_™
 = 
db
.
v®ue¡»am_’d
(
¦Ù
);

119 
	g¡¬‹d
 = 
Œue
;

122 
	gX­Ÿn
::
V®ueWeightPo¡šgSourû
::
Ãxt
(
mš_wt
);

123 
sk_if_š_¿nge
(
mš_wt
);

127 
	gDeü—sšgV®ueWeightPo¡šgSourû
::
sk_to
(
X­Ÿn
::
docid
 
mš_docid
,

128 
X­Ÿn
::
weight
 
mš_wt
) {

129 ià(
g‘_maxweight
(è< 
mš_wt
) {

130 
v®ue_™
 = 
db
.
v®ue¡»am_’d
(
¦Ù
);

131 
	g¡¬‹d
 = 
Œue
;

134 
	gX­Ÿn
::
V®ueWeightPo¡šgSourû
::
sk_to
(
mš_docid
, 
mš_wt
);

135 
sk_if_š_¿nge
(
mš_wt
);

138 
boŞ


139 
	gDeü—sšgV®ueWeightPo¡šgSourû
::
check
(
X­Ÿn
::
docid
 
mš_docid
,

140 
X­Ÿn
::
weight
 
mš_wt
) {

141 ià(
g‘_maxweight
(è< 
mš_wt
) {

142 
v®ue_™
 = 
db
.
v®ue¡»am_’d
(
¦Ù
);

143 
	g¡¬‹d
 = 
Œue
;

144  
	gŒue
;

146 
boŞ
 
	gv®id
 = 
X­Ÿn
::
V®ueWeightPo¡šgSourû
::
check
(
mš_docid
, 
mš_wt
);

147 ià(
	gv®id
) {

148 
sk_if_š_¿nge
(
mš_wt
);

150  
	gv®id
;

153 
	g¡d
::
¡ršg


154 
Deü—sšgV®ueWeightPo¡šgSourû
::
	$g‘_desütiÚ
() const {

156 
	}
}

	@api/documentvaluelist.cc

21 
	~<cÚfig.h
>

23 
	~"docum’tv®u–i¡.h
"

25 
	~"docum’t.h
"

26 
	~"omas£¹.h
"

27 
	~"¡r.h
"

29 
	~"x­Ÿn/”rÜ.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gX­Ÿn
::
docid


34 
Docum’tV®ueLi¡
::
	$g‘_docid
() const

36 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("get_docid() isn't valid when iterating over values in‡ document");

37 
	}
}

39 
	gX­Ÿn
::
v®u’o


40 
Docum’tV®ueLi¡
::
	$g‘_v®u’o
() const

42 
	`As£¹
(!
	`©_’d
());

43  
™
->
fœ¡
;

44 
	}
}

46 
¡ršg


47 
	gDocum’tV®ueLi¡
::
	$g‘_v®ue
() const

49 
	`As£¹
(!
	`©_’d
());

50  
™
->
£cÚd
;

51 
	}
}

53 
boŞ


54 
	gDocum’tV®ueLi¡
::
	$©_’d
() const

56  
™
 =ğ
doc
->
v®ues
.
	`’d
();

57 
	}
}

60 
	gDocum’tV®ueLi¡
::
	$Ãxt
()

62 ià(
™
 =ğ
doc
->
v®ues
.
	`’d
()) {

63 
™
 = 
doc
->
v®ues
.
	`begš
();

65 ++
™
;

67 
	}
}

70 
	gDocum’tV®ueLi¡
::
sk_to
(
X­Ÿn
::
docid
 
¦Ù
)

72 
™
 = 
doc
->
v®ues
.
low”_bound
(
¦Ù
);

75 
¡ršg


76 
	gDocum’tV®ueLi¡
::
	$g‘_desütiÚ
() const

78 
¡ršg
 
desc
 = "DocumentValueList(";

79 ià(!
	`©_’d
()) {

80 
desc
 += "slot=";

81 
desc
 +ğ
	`¡r
(
	`g‘_v®u’o
());

82 
desc
 += ", value=\"";

83 
desc
 +ğ
	`g‘_v®ue
();

84 
desc
 += "\")";

86 
desc
 += "atend)";

88  
desc
;

89 
	}
}

	@api/documentvaluelist.h

21 #iâdeà
XAPIAN_INCLUDED_DOCUMENTVALUELIST_H


22 
	#XAPIAN_INCLUDED_DOCUMENTVALUELIST_H


	)

24 
	~"v®u–i¡.h
"

26 
	~"docum’t.h
"

29 şas 
	cDocum’tV®ueLi¡
 : 
public
 
V®ueLi¡
 {

31 
İ”©Ü
=(cÚ¡ 
Docum’tV®ueLi¡
 &);

34 
Docum’tV®ueLi¡
(const DocumentValueList &);

37 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
Docum’t
::IÁ”Çl> 
doc
;

43 
	mX­Ÿn
::
Docum’t
::
IÁ”Çl
::
docum’t_v®ues
::
cÚ¡_™”©Ü
 
™
;

45 
	mpublic
:

46 
Docum’tV®ueLi¡
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<X­Ÿn::
Docum’t
::IÁ”Çl> & 
doc_
)

47 : 
doc
(
doc_
), 
™
(doc->
v®ues
.
	$’d
()) { }

49 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

51 
¡d
::
¡ršg
 
	$g‘_v®ue
() const;

53 
X­Ÿn
::
v®u’o
 
	$g‘_v®u’o
() const;

55 
boŞ
 
	$©_’d
() const;

57 
	`Ãxt
();

60 
	`sk_to
(
X­Ÿn
::
docid
 
¦Ù
);

62 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

63 
	}
};

	@api/editdistance.cc

30 
	~<cÚfig.h
>

32 
	~"ed™di¡ªû.h
"

34 
	~"omas£¹.h
"

36 
	~<®gÜ™hm
>

37 
	~<c¡dlib
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
	g‹m¶©e
<
şass
 
	gCHR
>

42 
	sedi¡_£q
 {

43 
edi¡_£q
(cÚ¡ 
CHR
 * 
±r_
, 
Ën_
è: 
±r
ÕŒ_), 
Ën
(len_) { }

44 cÚ¡ 
CHR
 * 
	m±r
;

45 
	mËn
;

48 
	g‹m¶©e
<
şass
 
	gCHR
>

49 şas 
	cedi¡_¡©e
 {

51 
	mİ”©Ü
=(cÚ¡ 
edi¡_¡©e
 &);

54 
edi¡_¡©e
(constƒdist_state &);

56 
	medi¡_£q
<
	mCHR
> 
	m£q1
;

57 
	medi¡_£q
<
	mCHR
> 
	m£q2
;

64 * 
	mfkp
;

65 
	mfkp_cŞs
;

69 
	mmaxdi¡
;

71 
	$ÿlc_šdex
(
k
, 
p
) const {

72  (
k
 + 
maxdi¡
è* 
fkp_cŞs
 + 
p
 + 1;

75 
public
:

77 
	`edi¡_¡©e
(cÚ¡ 
CHR
 * 
±r1
, 
Ën1
, cÚ¡ CHR * 
±r2
, 
Ën2
);

79 ~
	`edi¡_¡©e
();

81 
	$g‘_f_kp
(
k
, 
p
) const {

82  
fkp
[
	`ÿlc_šdex
(
k
, 
p
)];

83 
	}
}

85 
	$£t_f_kp
(
k
, 
p
, 
v®
) {

86 
fkp
[
	`ÿlc_šdex
(
k
, 
p
)] = 
v®
;

87 
	}
}

89 
boŞ
 
	$is_Œª¥o£d
(
pos1
, 
pos2
) const {

90 ià(
pos1
 <ğ0 || 
pos2
 <ğ0 ||…os1 >ğ
£q1
.
Ën
 ||…os2 >ğ
£q2
.Ënè 
çl£
;

91  (
£q1
.
±r
[
pos1
 - 1] =ğ
£q2
.±r[
pos2
] &&

92 
£q1
.
±r
[
pos1
] =ğ
£q2
.±r[
pos2
 - 1]);

93 
	}
}

95 
edi¡_ÿlc_f_kp
(
k
, 
p
);

98 
	g‹m¶©e
<
şass
 
	gCHR
>

99 
	gedi¡_¡©e
<
	gCHR
>::
	$edi¡_ÿlc_f_kp
(
k
, 
p
)

101 
maxËn
 = 
	`g‘_f_kp
(
k
, 
p
 - 1) + 1;

102 
maxËn2
 = 
	`g‘_f_kp
(
k
 - 1, 
p
 - 1);

103 
maxËn3
 = 
	`g‘_f_kp
(
k
 + 1, 
p
 - 1) + 1;

105 ià(
	`is_Œª¥o£d
(
maxËn
, maxËÀ+ 
k
)) {

107 ++
maxËn
;

110 ià(
maxËn
 >ğ
maxËn2
) {

111 ià(
maxËn
 >ğ
maxËn3
) {

115 
maxËn
 = 
maxËn3
;

118 ià(
maxËn2
 >ğ
maxËn3
) {

120 
maxËn
 = 
maxËn2
;

123 
maxËn
 = 
maxËn3
;

129 
maxËn
 < 
£q1
.
Ën
 &&

130 
maxËn
 + 
k
 < 
£q2
.
Ën
 &&

131 
£q1
.
±r
[
maxËn
] =ğ
£q2
.±r[maxËÀ+ 
k
]) {

132 ++
maxËn
;

134 
	`£t_f_kp
(
k
, 
p
, 
maxËn
);

135 
	}
}

137 
	#INF
 1000000

	)

138 
	g‹m¶©e
<
şass
 
	gCHR
>

139 
	gedi¡_¡©e
<
	gCHR
>::
	$edi¡_¡©e
(cÚ¡ 
CHR
 * 
±r1
, 
Ën1
,

140 cÚ¡ 
CHR
 * 
±r2
, 
Ën2
)

141 : 
	`£q1
(
±r1
, 
Ën1
), 
	`£q2
(
±r2
, 
Ën2
), 
	$maxdi¡
(
Ën2
)

143 
	`As£¹
(
Ën2
 >ğ
Ën1
);

145 
fkp_rows
 = 
maxdi¡
 * 2 + 1;

147 
fkp_cŞs
 = 
maxdi¡
 + 2;

149 
fkp
 = 
Ãw
 [
fkp_rows
 * 
fkp_cŞs
];

151 
k
 = -
maxdi¡
; k <= maxdist; k++) {

152 
p
 = -1;… <ğ
maxdi¡
;…++) {

153 ià(
p
 =ğ
	`abs
(
k
) - 1) {

154 ià(
k
 < 0) {

155 
	`£t_f_kp
(
k
, 
p
, 
	`abs
(k) - 1);

157 
	`£t_f_kp
(
k
, 
p
, -1);

159 } ià(
p
 < 
	`abs
(
k
)) {

160 
	`£t_f_kp
(
k
, 
p
, -
INF
);

164 
	}
}

166 
	g‹m¶©e
<
şass
 
	gCHR
>

167 
	gedi¡_¡©e
<
	gCHR
>::~
	$edi¡_¡©e
() {

168 
d–‘e
 [] 
fkp
;

169 
	}
}

171 
	g‹m¶©e
<
şass
 
	gCHR
>

173 
	$£qcmp_ed™di¡
(cÚ¡ 
CHR
 * 
±r1
, 
Ën1
, cÚ¡ CHR * 
±r2
, 
Ën2
,

174 
max_di¡ªû
)

176 
Ëndiff
 = 
Ën2
 - 
Ën1
;

178 ià(
Ëndiff
 < 0) {

179 
Ëndiff
 = -lendiff;

180 
	`sw­
(
±r1
, 
±r2
);

181 
	`sw­
(
Ën1
, 
Ën2
);

185 ià(
Ën1
 =ğ0è 
Ën2
;

187 
edi¡_¡©e
<
CHR
> 
	`¡©e
(
±r1
, 
Ën1
, 
±r2
, 
Ën2
);

189 
p
 = 
Ëndiff
;

190 
p
 <ğ
max_di¡ªû
) {

191 
‹mp_p
 = 0;emp_°!ğ
p
; ++temp_p) {

192 
šc
 = 
p
 - 
‹mp_p
;

193 ià(
	`abs
(
Ëndiff
 - 
šc
è<ğ
‹mp_p
) {

194 
¡©e
.
	`edi¡_ÿlc_f_kp
(
Ëndiff
 - 
šc
, 
‹mp_p
);

196 ià(
	`abs
(
Ëndiff
 + 
šc
è<ğ
‹mp_p
) {

197 
¡©e
.
	`edi¡_ÿlc_f_kp
(
Ëndiff
 + 
šc
, 
‹mp_p
);

200 
¡©e
.
	`edi¡_ÿlc_f_kp
(
Ëndiff
, 
p
);

202 ià(
¡©e
.
	`g‘_f_kp
(
Ëndiff
, 
p
è=ğ
Ën1
) ;

203 ++
p
;

206  
p
;

207 
	}
}

210 
	$ed™_di¡ªû_unsigÃd
(cÚ¡ * 
±r1
, 
Ën1
,

211 cÚ¡ * 
±r2
, 
Ën2
,

212 
max_di¡ªû
)

214  
£qcmp_ed™di¡
<>(
±r1
, 
Ën1
, 
±r2
, 
Ën2
, 
max_di¡ªû
);

215 
	}
}

	@api/editdistance.h

22 #iâdeà
XAPIAN_INCLUDED_EDITDISTANCE_H


23 
	#XAPIAN_INCLUDED_EDITDISTANCE_H


	)

48 
ed™_di¡ªû_unsigÃd
(cÚ¡ * 
±r1
, 
Ën1
,

49 cÚ¡ * 
±r2
, 
Ën2
,

50 
max_di¡ªû
);

	@api/emptypostlist.cc

21 
	~<cÚfig.h
>

23 
	~"em±ypo¡li¡.h
"

25 
	~"omas£¹.h
"

27 
usšg
 
Çme¥aû
 
	g¡d
;

29 
	gX­Ÿn
::
doccouÁ


30 
Em±yPo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

33 
	}
}

35 
	gX­Ÿn
::
doccouÁ


36 
Em±yPo¡Li¡
::
	$g‘_‹rmäeq_max
() const

39 
	}
}

41 
	gX­Ÿn
::
doccouÁ


42 
Em±yPo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

45 
	}
}

47 
	gX­Ÿn
::
weight


48 
Em±yPo¡Li¡
::
	$g‘_maxweight
() const

51 
	}
}

53 
	gX­Ÿn
::
docid


54 
Em±yPo¡Li¡
::
	$g‘_docid
() const

56 
	`As£¹
(
çl£
);

58 
	}
}

60 
	gX­Ÿn
::
‹rmcouÁ


61 
Em±yPo¡Li¡
::
	$g‘_doş’gth
() const

63  
X­Ÿn
::
	`‹rmcouÁ
(
Em±yPo¡Li¡
::
	`g‘_docid
());

64 
	}
}

66 
	gX­Ÿn
::
weight


67 
Em±yPo¡Li¡
::
	$g‘_weight
() const

69 
	`As£¹
(
çl£
);

71 
	}
}

73 
boŞ


74 
	gEm±yPo¡Li¡
::
	$©_’d
() const

76  
Œue
;

77 
	}
}

79 
	gX­Ÿn
::
weight


80 
Em±yPo¡Li¡
::
	$»ÿlc_maxweight
()

82  
Em±yPo¡Li¡
::
	`g‘_maxweight
();

83 
	}
}

85 
Po¡Li¡
 *

86 
	gEm±yPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
)

88 
As£¹
(
çl£
);

89  
	gNULL
;

92 
Po¡Li¡
 *

93 
	gEm±yPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
)

95 
As£¹
(
çl£
);

96  
	gNULL
;

99 
¡ršg


100 
	gEm±yPo¡Li¡
::
	$g‘_desütiÚ
() const

103 
	}
}

	@api/error.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/”rÜ.h
>

25 
	~"§ã”ºo.h
"

26 #ifdeà
__WIN32__


27 
	~"§ãwšdows.h
"

29 
	~<Ãtdb.h
>

32 
	~<c¡dio
>

33 
	~<c¡ršg
>

35 
	~"uts.h
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	gX­Ÿn
::
E¼Ü
::E¼Ü(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
,

40 cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

41 : 
msg
(
msg_
), 
cÚ‹xt
(
cÚ‹xt_
), 
ty³
(
ty³_
), 
my_”ºo
(0),

42 
”rÜ_¡ršg
(), 
	$®»ady_hªdËd
(
çl£
)

44 ià(
”rÜ_¡ršg_
è
”rÜ_¡ršg
.
	`assign
(error_string_);

45 
	}
}

48 
	gX­Ÿn
::
E¼Ü
::
	$g‘_”rÜ_¡ršg
() const

50 ià(!
”rÜ_¡ršg
.
	`em±y
()èƒ¼Ü_¡ršg.
	`c_¡r
();

51 ià(
my_”ºo
 =ğ0è 
NULL
;

52 ià(
my_”ºo
 > 0) {

53 
”rÜ_¡ršg
.
	`assign
(
	`¡»¼Ü
(
my_”ºo
));

54  
”rÜ_¡ršg
.
	`c_¡r
();

56 #ifdeà
__WIN32__


57 
DWORD
 
Ën
;

58 * 
”rÜ
;

59 
Ën
 = 
	`FÜm©Mes§ge
(
FORMAT_MESSAGE_FROM_SYSTEM
|
FORMAT_MESSAGE_ALLOCATE_BUFFER
,

60 0, -
my_”ºo
, 0, (
CHAR
*)&
”rÜ
, 0, 0);

61 ià(
”rÜ
) {

63 ià(
Ën
 >ğ2 && 
”rÜ
[len - 2] == '\r' &&ƒrror[len - 1] == '\n')

64 
Ën
 -= 2;

65 
”rÜ_¡ršg
.
	`assign
(
”rÜ
, 
Ën
);

66 
	`LoÿlF»e
(
”rÜ
);

67  
”rÜ_¡ršg
.
	`c_¡r
();

70 #ifdeà
HAVE_HSTRERROR


71 
”rÜ_¡ršg
.
	`assign
(
	`h¡»¼Ü
(-
my_”ºo
));

72  
”rÜ_¡ršg
.
	`c_¡r
();

74 cÚ¡ * 
s
 = 
NULL
;

75 -
my_”ºo
) {

76 
HOST_NOT_FOUND
:

77 
s
 = "Unknown host";

79 
NO_ADDRESS
:

80 #ià
NO_ADDRESS
 !ğ
NO_DATA


81 
NO_DATA
:

83 
s
 = "No‡ddress‡ssociated with‚ame";

85 
NO_RECOVERY
:

86 
s
 = "Unknown serverƒrror";

88 
TRY_AGAIN
:

89 
s
 = "Host‚ame†ookup failure";

92 ià(
s
) {

93 
”rÜ_¡ršg
.
	`assign
(
s
);

94  
”rÜ_¡ršg
.
	`c_¡r
();

99 #iâdeà
HAVE_HSTRERROR


100 
”rÜ_¡ršg
 = "Unknown Error ";

101 
”rÜ_¡ršg
 +ğ
	`om_to¡ršg
(-
my_”ºo
);

102  
”rÜ_¡ršg
.
	`c_¡r
();

104 
	}
}

106 
¡ršg


107 
	gX­Ÿn
::
E¼Ü
::
	$g‘_desütiÚ
() const

109 
¡ršg
 
	`desc
(
ty³
);

110 
desc
 += ": ";

111 
desc
 +ğ
msg
;

112 ià(!
cÚ‹xt
.
	`em±y
()) {

113 
desc
 += " (context: ";

114 
desc
 +ğ
cÚ‹xt
;

115 
desc
 += ')';

117 cÚ¡ *
e
 = 
	`g‘_”rÜ_¡ršg
();

118 ià(
e
) {

119 
desc
 += " (";

120 
desc
 +ğ
e
;

121 
desc
 += ')';

123  
desc
;

124 
	}
}

	@api/errorhandler.cc

20 
	~<cÚfig.h
>

22 
	~<x­Ÿn/”rÜ.h
>

23 
	~<x­Ÿn/”rÜhªdËr.h
>

25 
	gX­Ÿn
::
E¼ÜHªdËr
::~
	$E¼ÜHªdËr
(è{ 
	}
}

28 
X­Ÿn
::
E¼ÜHªdËr
::
	$İ”©Ü
()(
X­Ÿn
::
E¼Ü
 & 
”rÜ
)

30 
boŞ
 
®»ady_hªdËd
 = 
”rÜ
.already_handled;

31 
”rÜ
.
®»ady_hªdËd
 = 
Œue
;

32 ià(
®»ady_hªdËd
 || !
	`hªdË_”rÜ
(
”rÜ
)) {

33 
throw
 
”rÜ
;

35 
	}
}

	@api/expanddecider.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/ex·nddecid”.h
>

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 
Çme¥aû
 
	gX­Ÿn
 {

29 
	gEx·ndDecid”
::~
Ex·ndDecid”
() { }

31 
boŞ


32 
Ex·ndDecid”And
::
İ”©Ü
()(cÚ¡ 
¡ršg
 &
‹rm
) const

34  
fœ¡
(
‹rm
è&& 
£cÚd
(term);

37 
boŞ


38 
	gEx·ndDecid”F‹rT”ms
::
İ”©Ü
()(cÚ¡ 
¡ršg
 &
‹rm
) const

44 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
 = 
»jeùs
.
fšd
(
‹rm
);

45  
	gi
 =ğ
»jeùs
.
’d
();

	@api/keymaker.cc

21 
	~<cÚfig.h
>

23 
	~"x­Ÿn/keymak”.h
"

25 
	~"x­Ÿn/docum’t.h
"

27 
	~<¡ršg
>

28 
	~<veùÜ
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
Çme¥aû
 
	gX­Ÿn
 {

34 
	gKeyMak”
::~
KeyMak”
() { }

36 
¡ršg


37 
MuÉiV®ueKeyMak”
::
İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
) const

39 
¡ršg
 
»suÉ
;

41 
	gveùÜ
<
	g·œ
<
	gX­Ÿn
::
v®u’o
, 
	gboŞ
> >::
cÚ¡_™”©Ü
 
i
 = 
v®nos
.
begš
();

43 ià(
¿»
(
i
 =ğ
v®nos
.
’d
())è 
»suÉ
;

45 
size_t
 
	gÏ¡_nÙ_em±y_fÜw¬ds
 = 0;

46 
	gŒue
) {

51 
¡ršg
 
	gv
 = 
doc
.
g‘_v®ue
(
i
->
fœ¡
);

52 
boŞ
 
	g»v”£_sÜt
 = 
i
->
£cÚd
;

54 ià(
	g»v”£_sÜt
 || !
	gv
.
em±y
())

55 
	gÏ¡_nÙ_em±y_fÜw¬ds
 = 
»suÉ
.
size
();

57 ià(++
	gi
 =ğ
v®nos
.
’d
(è&& !
»v”£_sÜt
) {

58 ià(
v
.
em±y
()) {

60 
»suÉ
.
»size
(
Ï¡_nÙ_em±y_fÜw¬ds
);

63 
	g»suÉ
 +ğ
v
;

68 ià(
	g»v”£_sÜt
) {

72 
	g¡ršg
::
cÚ¡_™”©Ü
 
j
 = 
v
.
begš
(); 
	gj
 !ğv.
’d
(); ++j) {

73 
ch
(*
j
);

74 
	g»suÉ
 +ğ(255 - 
ch
);

75 ià(
	gch
 =ğ0è
»suÉ
 += '\0';

77 
	g»suÉ
.
­³nd
("\xff\xff", 2);

78 ià(
	gi
 =ğ
v®nos
.
’d
()) ;

79 
	gÏ¡_nÙ_em±y_fÜw¬ds
 = 
»suÉ
.
size
();

84 
	g¡ršg
::
size_ty³
 
j
 = 0, 
	gnul
;

85 (
	gnul
 = 
v
.
fšd
('\0', 
j
)è!ğ
¡ršg
::
Åos
) {

86 ++
nul
;

87 
	g»suÉ
.
­³nd
(
v
, 
j
, 
nul
 - j);

88 
	g»suÉ
 += '\xff';

89 
	gj
 = 
nul
;

91 
	g»suÉ
.
­³nd
(
v
, 
j
, 
¡ršg
::
Åos
);

92 ià(!
	gv
.
em±y
())

93 
	gÏ¡_nÙ_em±y_fÜw¬ds
 = 
»suÉ
.
size
();

94 
	g»suÉ
.
­³nd
("\0", 2);

97  
	g»suÉ
;

100 
¡ršg


101 
	gMuÉiV®ueSÜ‹r
::
İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
) const

103 
¡ršg
 
»suÉ
;

105 
	gveùÜ
<
	g·œ
<
	gX­Ÿn
::
v®u’o
, 
	gboŞ
> >::
cÚ¡_™”©Ü
 
i
 = 
v®nos
.
begš
();

107 ià(
¿»
(
i
 =ğ
v®nos
.
’d
())è 
»suÉ
;

109 
	gŒue
) {

114 
¡ršg
 
	gv
 = 
doc
.
g‘_v®ue
(
i
->
fœ¡
);

115 
boŞ
 
	g»v”£_sÜt
 = !
i
->
£cÚd
;

117 ià(++
	gi
 =ğ
v®nos
.
’d
(è&& !
»v”£_sÜt
) {

119 
»suÉ
 +ğ
v
;

123 ià(
	g»v”£_sÜt
) {

127 
	g¡ršg
::
cÚ¡_™”©Ü
 
j
 = 
v
.
begš
(); 
	gj
 !ğv.
’d
(); ++j) {

128 
ch
(*
j
);

129 
	g»suÉ
 +ğ(255 - 
ch
);

130 ià(
	gch
 =ğ0è
»suÉ
 += '\0';

132 
	g»suÉ
.
­³nd
("\xff\xff", 2);

133 ià(
	gi
 =ğ
v®nos
.
’d
()) ;

138 
	g¡ršg
::
size_ty³
 
j
 = 0, 
	gnul
;

139 (
	gnul
 = 
v
.
fšd
('\0', 
j
)è!ğ
¡ršg
::
Åos
) {

140 ++
nul
;

141 
	g»suÉ
.
­³nd
(
v
, 
j
, 
nul
 - j);

142 
	g»suÉ
 += '\xff';

143 
	gj
 = 
nul
;

145 
	g»suÉ
.
­³nd
(
v
, 
j
, 
¡ršg
::
Åos
);

146 
	g»suÉ
.
­³nd
("\0", 2);

149  
	g»suÉ
;

	@api/leafpostlist.cc

22 
	~<cÚfig.h
>

24 
	~"x­Ÿn/weight.h
"

26 
	~"Ëaåo¡li¡.h
"

27 
	~"omas£¹.h
"

28 
	~"debuglog.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	gL—fPo¡Li¡
::~
	$L—fPo¡Li¡
()

34 
d–‘e
 
weight
;

35 
	}
}

37 
	gX­Ÿn
::
doccouÁ


38 
L—fPo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

40  
	`g‘_‹rmäeq
();

41 
	}
}

43 
	gX­Ÿn
::
doccouÁ


44 
L—fPo¡Li¡
::
	$g‘_‹rmäeq_max
() const

46  
	`g‘_‹rmäeq
();

47 
	}
}

49 
	gX­Ÿn
::
doccouÁ


50 
L—fPo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

52  
	`g‘_‹rmäeq
();

53 
	}
}

56 
	gL—fPo¡Li¡
::
£t_‹rmweight
(cÚ¡ 
X­Ÿn
::
Weight
 * 
weight_
)

59 
As£¹
(!
weight
);

60 
	gweight
 = 
weight_
;

61 
	gÃed_doş’gth
 = 
weight
->
g‘_sum·¹_Ãeds_doş’gth_
();

64 
	gX­Ÿn
::
weight


65 
L—fPo¡Li¡
::
	$g‘_maxweight
() const

67  
weight
 ? weight->
	`g‘_max·¹
() : 0;

68 
	}
}

70 
	gX­Ÿn
::
weight


71 
L—fPo¡Li¡
::
	$g‘_weight
() const

73 ià(!
weight
)  0;

74 
X­Ÿn
::
‹rmcouÁ
 
doş’
 = 0;

77 ià(
Ãed_doş’gth
è
doş’
 = 
	`g‘_doş’gth
();

78  
weight
->
	`g‘_sum·¹
(
	`g‘_wdf
(), 
doş’
);

79 
	}
}

81 
	gX­Ÿn
::
weight


82 
L—fPo¡Li¡
::
	$»ÿlc_maxweight
()

84  
L—fPo¡Li¡
::
	`g‘_maxweight
();

85 
	}
}

87 
T”mF»qs


88 
	gL—fPo¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

89 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

91 
LOGCALL
(
MATCH
, 
T”mF»qs
,

92 "L—fPo¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

93 ià(
	g‹rm
.
em±y
()) {

94 
RETURN
(
T”mF»qs
(
¡©s
.
cŞËùiÚ_size
, sts.
r£t_size
));

96 
	gm­
<
	g¡ršg
, 
	gT”mF»qs
>::
cÚ¡_™”©Ü
 
i
 = 
¡©s
.
‹rmäeqs
.
fšd
(
‹rm
);

97 
As£¹
(
i
 !ğ
¡©s
.
‹rmäeqs
.
’d
());

98 
RETURN
(
i
->
£cÚd
);

101 
	gX­Ÿn
::
‹rmcouÁ


102 
L—fPo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

105 
	}
}

	@api/maptermlist.h

22 #iâdeà
OM_HGUARD_MAPTERMLIST_H


23 
	#OM_HGUARD_MAPTERMLIST_H


	)

25 
	~"‹rmli¡.h
"

27 
	~"šmemÜy_pos™iÚli¡.h
"

28 
	~"docum’t.h
"

30 
	~"omas£¹.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 şas 
	cM­T”mLi¡
 : 
public
 
T”mLi¡
 {

35 
´iv©e
:

36 
X­Ÿn
::
Docum’t
::
IÁ”Çl
::
docum’t_‹rms
::
cÚ¡_™”©Ü
 
™
;

37 
	mX­Ÿn
::
Docum’t
::
IÁ”Çl
::
docum’t_‹rms
::
cÚ¡_™”©Ü
 
™_’d
;

38 
boŞ
 
	m¡¬‹d
;

40 
	mpublic
:

41 
M­T”mLi¡
(cÚ¡ 
X­Ÿn
::
Docum’t
::
IÁ”Çl
::
docum’t_‹rms
::
cÚ¡_™”©Ü
 &
™_
,

42 cÚ¡ 
X­Ÿn
::
Docum’t
::
IÁ”Çl
::
docum’t_‹rms
::
cÚ¡_™”©Ü
 &
™_’d_
)

43 : 
™
(
™_
), 
™_’d
(
™_’d_
), 
	$¡¬‹d
(
çl£
)

47 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const {

49 
	`As£¹
(
çl£
);

51 
	}
}

54 
¡ršg
 
	$g‘_‹rmÇme
() const {

55 
	`As£¹
(
¡¬‹d
);

56 
	`As£¹
(!
	`©_’d
());

57  
™
->
fœ¡
;

58 
	}
}

61 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const {

62 
	`As£¹
(
¡¬‹d
);

63 
	`As£¹
(!
	`©_’d
());

64  
™
->
£cÚd
.
wdf
;

65 
	}
}

68 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const {

69 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Can't geterm frequency from‡ documentermlist which is‚ot‡ssociated with‡ database.");

70 
	}
}

72 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const {

73  
X­Ÿn
::
	`Pos™iÚI‹¿tÜ
(
Ãw
 
	`InMemÜyPos™iÚLi¡
(
™
->
£cÚd
.
pos™iÚs
));

74 
	}
}

76 
	gX­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const {

77  
™
->
£cÚd
.
pos™iÚs
.
	`size
();

78 
	}
}

80 
T”mLi¡
 * 
	$Ãxt
() {

81 ià(!
¡¬‹d
) {

82 
¡¬‹d
 = 
Œue
;

84 
	`As£¹
(!
	`©_’d
());

85 
™
++;

87  
NULL
;

88 
	}
}

91 
boŞ
 
	$©_’d
() const {

92 
	`As£¹
(
¡¬‹d
);

93  
™
 =ğ
™_’d
;

94 
	}
}

	@api/matchspy.cc

23 
	~<cÚfig.h
>

24 
	~<x­Ÿn/m©ch¥y.h
>

26 
	~<x­Ÿn/docum’t.h
>

27 
	~<x­Ÿn/”rÜ.h
>

28 
	~<x­Ÿn/qu”y·r£r.h
>

29 
	~<x­Ÿn/»gi¡ry.h
>

31 
	~<m­
>

32 
	~<¡ršg
>

33 
	~<veùÜ
>

35 
	~"autİŒ.h
"

36 
	~"debuglog.h
"

37 
	~"omas£¹.h
"

38 
	~"£rŸli£.h
"

39 
	~"¡ršguts.h
"

40 
	~"¡r.h
"

41 
	~"‹rmli¡.h
"

43 
	~<cæßt
>

44 
	~<cm©h
>

46 
usšg
 
Çme¥aû
 
	g¡d
;

47 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

49 
	gM©chSpy
::~
	$M©chSpy
(è{
	}
}

51 
M©chSpy
 *

52 
M©chSpy
::
	$şÚe
() const {

53 
throw
 
	`Unim¶em’‹dE¼Ü
("MatchSpy‚ot suitable for use with„emote searches - clone() method unimplemented");

54 
	}
}

56 
¡ršg


57 
	gM©chSpy
::
	$Çme
() const {

58 
throw
 
	`Unim¶em’‹dE¼Ü
("MatchSpy‚ot suitable for use with„emote searches -‚ame() method unimplemented");

59 
	}
}

61 
¡ršg


62 
	gM©chSpy
::
	$£rŸli£
() const {

63 
throw
 
	`Unim¶em’‹dE¼Ü
("MatchSpy‚ot suitable for use with„emote searches - serialise() method unimplemented");

64 
	}
}

66 
M©chSpy
 *

67 
	gM©chSpy
::
	$un£rŸli£
(cÚ¡ 
¡ršg
 &, cÚ¡ 
Regi¡ry
 &) const {

68 
throw
 
	`Unim¶em’‹dE¼Ü
("MatchSpy‚ot suitable for use with„emote searches - unserialise() method unimplemented");

69 
	}
}

71 
¡ršg


72 
	gM©chSpy
::
	$£rŸli£_»suÉs
() const {

73 
throw
 
	`Unim¶em’‹dE¼Ü
("MatchSpy‚ot suitable for use with„emote searches - serialise_results() method unimplemented");

74 
	}
}

77 
	gM©chSpy
::
	$m”ge_»suÉs
(cÚ¡ 
¡ršg
 &) {

78 
throw
 
	`Unim¶em’‹dE¼Ü
("MatchSpy‚ot suitable for use with„emote searches - merge_results() method unimplemented");

79 
	}
}

81 
¡ršg


82 
	gM©chSpy
::
	$g‘_desütiÚ
() const {

84 
	}
}

86 
XAPIAN_NORETURN
(
unsuµÜ‹d_m‘hod
());

87 
	$unsuµÜ‹d_m‘hod
() {

88 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Method‚ot supported forhisype ofermlist");

89 
	}
}

92 şas 
	cV®ueCouÁT”mLi¡
 : 
public
 
T”mLi¡
 {

93 
´iv©e
:

94 
m­
<
¡ršg
, 
	mX­Ÿn
::
doccouÁ
>::
cÚ¡_™”©Ü
 
™
;

95 
boŞ
 
	m¡¬‹d
;

96 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
X­Ÿn
::
V®ueCouÁM©chSpy
::IÁ”Çl> 
¥y
;

97 
	mpublic
:

99 
V®ueCouÁT”mLi¡
(
V®ueCouÁM©chSpy
::
IÁ”Çl
 * 
¥y_
è: 
	$¥y
(
¥y_
) {

100 
™
 = 
¥y
->
v®ues
.
	`begš
();

101 
¡¬‹d
 = 
çl£
;

104 
¡ršg
 
	$g‘_‹rmÇme
() const {

105 
	`As£¹
(
¡¬‹d
);

106 
	`As£¹
(!
	`©_’d
());

107  
™
->
fœ¡
;

108 
	}
}

110 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const {

111 
	`As£¹
(
¡¬‹d
);

112 
	`As£¹
(!
	`©_’d
());

113  
™
->
£cÚd
;

114 
	}
}

116 
T”mLi¡
 * 
	$Ãxt
() {

117 ià(!
¡¬‹d
) {

118 
¡¬‹d
 = 
Œue
;

120 
	`As£¹
(!
	`©_’d
());

121 ++
™
;

123  
NULL
;

124 
	}
}

126 
boŞ
 
	$©_’d
() const {

127 
	`As£¹
(
¡¬‹d
);

128  
™
 =ğ
¥y
->
v®ues
.
	`’d
();

129 
	}
}

131 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
(ècÚ¡ { 
	`unsuµÜ‹d_m‘hod
(); 
	}
}

132 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
(ècÚ¡ { 
	`unsuµÜ‹d_m‘hod
(); 
	}
}

133 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const {

134 
	`unsuµÜ‹d_m‘hod
();

135 
	}
}

136 
	gX­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
(ècÚ¡ { 
	`unsuµÜ‹d_m‘hod
(); 
	}
}

141 şas 
	cSŒšgAndF»qu’cy
 {

142 
	m¡d
::
¡ršg
 
¡r
;

143 
	mX­Ÿn
::
doccouÁ
 
äequ’cy
;

144 
	mpublic
:

146 
SŒšgAndF»qu’cy
(
¡d
::
¡ršg
 
¡r_
, 
X­Ÿn
::
doccouÁ
 
äequ’cy_
)

147 : 
¡r
(
¡r_
), 
	$äequ’cy
(
äequ’cy_
) {}

150 
¡d
::
¡ršg
 
	$g‘_¡ršg
(ècÚ¡ {  
¡r
; 
	}
}

153 
	gX­Ÿn
::
doccouÁ
 
	$g‘_äequ’cy
(ècÚ¡ {  
äequ’cy
; 
	}
}

161 şas 
	cSŒšgAndF»qCmpByF»q
 {

162 
	mpublic
:

164 
	$SŒšgAndF»qCmpByF»q
() {}

168 
boŞ
 
	$İ”©Ü
()(cÚ¡ 
SŒšgAndF»qu’cy
 &
a
,

169 cÚ¡ 
SŒšgAndF»qu’cy
 &
b
) const {

170 ià(
a
.
	`g‘_äequ’cy
(è> 
b
.g‘_äequ’cy()è 
Œue
;

171 ià(
a
.
	`g‘_äequ’cy
(è< 
b
.g‘_äequ’cy()è 
çl£
;

172 ià(
a
.
	`g‘_¡ršg
(è> 
b
.g‘_¡ršg()è 
çl£
;

173  
Œue
;

174 
	}
}

178 şas 
	cSŒšgAndF»qT”mLi¡
 : 
public
 
T”mLi¡
 {

179 
´iv©e
:

180 
veùÜ
<
SŒšgAndF»qu’cy
>::
cÚ¡_™”©Ü
 
™
;

181 
boŞ
 
	m¡¬‹d
;

182 
	mpublic
:

183 
veùÜ
<
SŒšgAndF»qu’cy
> 
v®ues
;

188 
	$š™
() {

189 
™
 = 
v®ues
.
	`begš
();

190 
¡¬‹d
 = 
çl£
;

193 
¡ršg
 
	$g‘_‹rmÇme
() const {

194 
	`As£¹
(
¡¬‹d
);

195 
	`As£¹
(!
	`©_’d
());

196  
™
->
	`g‘_¡ršg
();

197 
	}
}

199 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const {

200 
	`As£¹
(
¡¬‹d
);

201 
	`As£¹
(!
	`©_’d
());

202  
™
->
	`g‘_äequ’cy
();

203 
	}
}

205 
T”mLi¡
 * 
	$Ãxt
() {

206 ià(!
¡¬‹d
) {

207 
¡¬‹d
 = 
Œue
;

209 
	`As£¹
(!
	`©_’d
());

210 ++
™
;

212  
NULL
;

213 
	}
}

215 
boŞ
 
	$©_’d
() const {

216 
	`As£¹
(
¡¬‹d
);

217  
™
 =ğ
v®ues
.
	`’d
();

218 
	}
}

220 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
(ècÚ¡ { 
	`unsuµÜ‹d_m‘hod
(); 
	}
}

221 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
(ècÚ¡ { 
	`unsuµÜ‹d_m‘hod
(); 
	}
}

222 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const {

223 
	`unsuµÜ‹d_m‘hod
();

224 
	}
}

225 
	gX­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
(ècÚ¡ { 
	`unsuµÜ‹d_m‘hod
(); 
	}
}

244 
g‘_mo¡_äequ’t_™ems
(
veùÜ
<
SŒšgAndF»qu’cy
> & 
»suÉ
,

245 cÚ¡ 
m­
<
¡ršg
, 
doccouÁ
> & 
™ems
,

246 
size_t
 
max™ems
)

248 
	g»suÉ
.
ş—r
();

249 
	g»suÉ
.
»£rve
(
max™ems
);

250 
SŒšgAndF»qCmpByF»q
 
	gcmpâ
;

251 
boŞ
 
is_h—p
(
çl£
);

253 
	gm­
<
	g¡ršg
, 
	gdoccouÁ
>::
cÚ¡_™”©Ü
 
i
 = 
™ems
.
begš
();

254 
	gi
 !ğ
™ems
.
’d
(); i++) {

255 
As£¹
(
»suÉ
.
size
(è<ğ
max™ems
);

256 
	g»suÉ
.
push_back
(
SŒšgAndF»qu’cy
(
i
->
fœ¡
, i->
£cÚd
));

257 ià(
	g»suÉ
.
size
(è> 
	gmax™ems
) {

259 ià(
	gis_h—p
) {

261 
push_h—p
(
»suÉ
.
begš
(),„esuÉ.
’d
(), 
cmpâ
);

264 
make_h—p
(
»suÉ
.
begš
(),„esuÉ.
’d
(), 
cmpâ
);

265 
	gis_h—p
 = 
Œue
;

267 
pİ_h—p
(
»suÉ
.
begš
(),„esuÉ.
’d
(), 
cmpâ
);

268 
	g»suÉ
.
pİ_back
();

272 ià(
	gis_h—p
) {

273 
sÜt_h—p
(
»suÉ
.
begš
(),„esuÉ.
’d
(), 
cmpâ
);

275 
sÜt
(
»suÉ
.
begš
(),„esuÉ.
’d
(), 
cmpâ
);

280 
	gV®ueCouÁM©chSpy
::
	$İ”©Ü
()(cÚ¡ 
Docum’t
 &
doc
, 
weight
) {

281 ++(
š‹º®
->
tÙ®
);

282 
¡ršg
 
	`v®
(
doc
.
	`g‘_v®ue
(
š‹º®
->
¦Ù
));

283 ià(!
v®
.
	`em±y
()è++(
š‹º®
->
v®ues
[val]);

284 
	}
}

286 
T”mI‹¿tÜ


287 
	gV®ueCouÁM©chSpy
::
	$v®ues_begš
() const

289 
AutoPŒ
<
V®ueCouÁT”mLi¡
> 
	`‹rmli¡
(
Ãw
 
	`V®ueCouÁT”mLi¡
(
š‹º®
.
	`g‘
()));

290  
X­Ÿn
::
	`T”mI‹¿tÜ
(
‹rmli¡
.
	`»Ëa£
());

291 
	}
}

293 
T”mI‹¿tÜ


294 
	gV®ueCouÁM©chSpy
::
	$tİ_v®ues_begš
(
size_t
 
maxv®ues
) const

296 
AutoPŒ
<
SŒšgAndF»qT”mLi¡
> 
	`‹rmli¡
(
Ãw
 StringAndFreqTermList);

297 
	`g‘_mo¡_äequ’t_™ems
(
‹rmli¡
->
v®ues
, 
š‹º®
->v®ues, 
maxv®ues
);

298 
‹rmli¡
->
	`š™
();

299  
X­Ÿn
::
	`T”mI‹¿tÜ
(
‹rmli¡
.
	`»Ëa£
());

300 
	}
}

302 
M©chSpy
 *

303 
	gV®ueCouÁM©chSpy
::
	$şÚe
() const {

304  
Ãw
 
	`V®ueCouÁM©chSpy
(
š‹º®
->
¦Ù
);

305 
	}
}

307 
¡ršg


308 
	gV®ueCouÁM©chSpy
::
	$Çme
() const {

310 
	}
}

312 
¡ršg


313 
	gV®ueCouÁM©chSpy
::
	$£rŸli£
() const {

314 
¡ršg
 
»suÉ
;

315 
»suÉ
 +ğ
	`’code_Ëngth
(
š‹º®
->
¦Ù
);

316  
»suÉ
;

317 
	}
}

319 
M©chSpy
 *

320 
	gV®ueCouÁM©chSpy
::
	$un£rŸli£
(cÚ¡ 
¡ršg
 & 
s
, cÚ¡ 
Regi¡ry
 &) const

322 cÚ¡ * 
p
 = 
s
.
	`d©a
();

323 cÚ¡ * 
’d
 = 
p
 + 
s
.
	`size
();

325 
v®u’o
 
Ãw_¦Ù
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
);

326 ià(
p
 !ğ
’d
) {

327 
throw
 
	`N‘wÜkE¼Ü
("Junk‡tƒnd of serialised ValueCountMatchSpy");

330  
Ãw
 
	`V®ueCouÁM©chSpy
(
Ãw_¦Ù
);

331 
	}
}

333 
¡ršg


334 
	gV®ueCouÁM©chSpy
::
	$£rŸli£_»suÉs
() const {

335 
	`LOGCALL
(
REMOTE
, 
¡ršg
, "V®ueCouÁM©chSpy::£rŸli£_»suÉs", 
NO_ARGS
);

336 
¡ršg
 
»suÉ
;

337 
»suÉ
 +ğ
	`’code_Ëngth
(
š‹º®
->
tÙ®
);

338 
»suÉ
 +ğ
	`’code_Ëngth
(
š‹º®
->
v®ues
.
	`size
());

339 
m­
<
¡ršg
, 
doccouÁ
>::
cÚ¡_™”©Ü
 
i
 = 
š‹º®
->
v®ues
.
	`begš
();

340 
i
 !ğ
š‹º®
->
v®ues
.
	`’d
(); ++i) {

341 
»suÉ
 +ğ
	`’code_Ëngth
(
i
->
fœ¡
.
	`size
());

342 
»suÉ
 +ğ
i
->
fœ¡
;

343 
»suÉ
 +ğ
	`’code_Ëngth
(
i
->
£cÚd
);

345 
	`RETURN
(
»suÉ
);

346 
	}
}

349 
	gV®ueCouÁM©chSpy
::
	$m”ge_»suÉs
(cÚ¡ 
¡ršg
 & 
s
) {

350 
	`LOGCALL_VOID
(
REMOTE
, "V®ueCouÁM©chSpy::m”ge_»suÉs", 
s
);

351 cÚ¡ * 
p
 = 
s
.
	`d©a
();

352 cÚ¡ * 
’d
 = 
p
 + 
s
.
	`size
();

354 
š‹º®
->
tÙ®
 +ğ
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
);

356 
m­
<
¡ršg
, 
doccouÁ
>::
size_ty³
 
™ems
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
);

357 
p
 !ğ
’d
) {

358 
™ems
 != 0) {

359 
size_t
 
v®Ën
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

360 
¡ršg
 
	`v®
(
p
, 
v®Ën
);

361 
p
 +ğ
v®Ën
;

362 
doccouÁ
 
äeq
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
);

363 
š‹º®
->
v®ues
[
v®
] +ğ
äeq
;

364 --
™ems
;

367 
	}
}

369 
¡ršg


370 
	gV®ueCouÁM©chSpy
::
	$g‘_desütiÚ
() const {

371  "X­Ÿn::V®ueCouÁM©chSpy(" + 
	`¡r
(
š‹º®
->
tÙ®
) +

372 " doc £’,†ookšg iÀ" + 
	`¡r
(
š‹º®
->
v®ues
.
	`size
()) + " slots)";

373 
	}
}

	@api/omdatabase.cc

24 
	~<cÚfig.h
>

26 
	~"autİŒ.h
"

28 
	~<x­Ÿn/”rÜ.h
>

29 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

30 
	~<x­Ÿn/po¡šg™”©Ü.h
>

31 
	~<x­Ÿn/‹rm™”©Ü.h
>

32 
	~<x­Ÿn/unicode.h
>

34 
	~"omas£¹.h
"

35 
	~"debuglog.h
"

36 
	~"../back’ds/muÉi/muÉi_po¡li¡.h
"

37 
	~"../back’ds/muÉi/muÉi_‹rmli¡.h
"

38 
	~"®É”m¦i¡.h
"

39 
	~"muÉŸÎ‹rm¦i¡.h
"

40 
	~"muÉiv®u–i¡.h
"

41 
	~"d©aba£.h
"

42 
	~"ed™di¡ªû.h
"

43 
	~"Ü‹rmli¡.h
"

44 
	~"nÜ‘uº.h
"

46 
	~<c¡dlib
>

48 
	~<c¡ršg
>

49 
	~<veùÜ
>

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
XAPIAN_NORETURN
(
docid_z”o_šv®id
());

54 
	$docid_z”o_šv®id
()

56 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Document ID 0 is invalid");

57 
	}
}

59 
XAPIAN_NORETURN
(
no_subd©aba£s
());

60 
	$no_subd©aba£s
()

62 
throw
 
X­Ÿn
::
	`DocNÙFoundE¼Ü
("No subdatabases");

63 
	}
}

65 
Çme¥aû
 
	gX­Ÿn
 {

67 
	gD©aba£
::
D©aba£
()

69 
LOGCALL_CTOR
(
API
, "D©aba£::D©aba£", 
NO_ARGS
);

72 
	gD©aba£
::
D©aba£
(D©aba£::
IÁ”Çl
 *
š‹º®_
)

74 
LOGCALL_CTOR
(
API
, "Database::Database", "Database::Internal");

75 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> 
Ãwi
(
š‹º®_
);

76 
	gš‹º®
.
push_back
(
Ãwi
);

79 
	gD©aba£
::
D©aba£
(cÚ¡ D©aba£ &
Ùh”
)

81 
LOGCALL_CTOR
(
API
, "Database::Database", "Database");

82 
	gš‹º®
 = 
Ùh”
.
š‹º®
;

86 
	gD©aba£
::
İ”©Ü
=(cÚ¡ 
D©aba£
 &
Ùh”
)

88 
LOGCALL_VOID
(
API
, "Database::operator=", "Database");

89 ià(
	gthis
 =ğ&
Ùh”
) {

90 
LOGLINE
(
API
, "Database‡ssignedo itself");

94 
	gš‹º®
 = 
Ùh”
.
š‹º®
;

97 
	gD©aba£
::~
D©aba£
()

99 
LOGCALL_DTOR
(
API
, "Database::~Database");

103 
	gD©aba£
::
»İ’
()

105 
LOGCALL_VOID
(
API
, "D©aba£::»İ’", 
NO_ARGS
);

106 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
™”©Ü
 
i
;

107 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); ++i) {

108 (*
	gi
)->
»İ’
();

113 
	gD©aba£
::
şo£
()

115 
LOGCALL_VOID
(
API
, "D©aba£::şo£", 
NO_ARGS
);

116 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
™”©Ü
 
i
;

117 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); ++i) {

118 (*
	gi
)->
şo£
();

123 
	gD©aba£
::
add_d©aba£
(cÚ¡ 
D©aba£
 & 
d©aba£
)

125 
LOGCALL_VOID
(
API
, "Database::add_database", "Database");

126 ià(
	gthis
 =ğ&
d©aba£
) {

127 
LOGLINE
(
API
, "Database‡ddedo itself");

128 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("Can't‡dd‡ Databaseo itself");

130 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

131 
	gi
 = 
d©aba£
.
š‹º®
.
begš
(); i !ğd©aba£.š‹º®.
’d
(); ++i) {

132 
	gš‹º®
.
push_back
(*
i
);

136 
Po¡šgI‹¿tÜ


137 
	gD©aba£
::
po¡li¡_begš
(cÚ¡ 
¡ršg
 &
Šame
) const

139 
LOGCALL
(
API
, 
Po¡šgI‹¿tÜ
, "D©aba£::po¡li¡_begš", 
Šame
);

146 ià(
	gš‹º®
.
size
() == 1)

147 
RETURN
(
Po¡šgI‹¿tÜ
(
š‹º®
[0]->
İ’_po¡_li¡
(
Šame
)));

149 ià(
¿»
(
š‹º®
.
size
() == 0))

150 
RETURN
(
Po¡šgI‹¿tÜ
(
NULL
));

152 
	gveùÜ
<
	gL—fPo¡Li¡
 *> 
	g¶s
;

153 
	gŒy
 {

154 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

155 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); ++i) {

156 
	g¶s
.
push_back
((*
i
)->
İ’_po¡_li¡
(
Šame
));

157 
	g¶s
.
back
()->
Ãxt
();

159 
As£¹
(
¶s
.
begš
(è!ğ¶s.
’d
());

160 } 
ÿtch
 (...) {

161 
	gveùÜ
<
	gL—fPo¡Li¡
 *>::
™”©Ü
 
i
;

162 
	gi
 = 
¶s
.
begš
(); i !ğ¶s.
’d
(); ++i) {

163 
d–‘e
 *
	gi
;

164 *
	gi
 = 0;

166 
	gthrow
;

169 
RETURN
(
Po¡šgI‹¿tÜ
(
Ãw
 
MuÉiPo¡Li¡
(
¶s
, *
this
)));

172 
T”mI‹¿tÜ


173 
	gD©aba£
::
‹rmli¡_begš
(
X­Ÿn
::
docid
 
did
) const

175 
LOGCALL
(
API
, 
T”mI‹¿tÜ
, "D©aba£::‹rmli¡_begš", 
did
);

176 ià(
	gdid
 == 0)

177 
docid_z”o_šv®id
();

179 
	gmuÉl›r
 = 
š‹º®
.
size
();

180 ià(
¿»
(
muÉl›r
 == 0))

181 
no_subd©aba£s
();

182 
T”mLi¡
 *
	g
;

183 ià(
	gmuÉl›r
 == 1) {

186 

 = 
š‹º®
[0]->
İ’_‹rm_li¡
(
did
);

188 
As£¹
(
muÉl›r
 != 0);

189 
	gX­Ÿn
::
doccouÁ
 
n
 = (
did
 - 1è% 
muÉl›r
;

190 
	gX­Ÿn
::
docid
 
m
 = (
did
 - 1è/ 
muÉl›r
 + 1;

192 
	g
 = 
Ãw
 
MuÉiT”mLi¡
(
š‹º®
[
n
]->
İ’_‹rm_li¡
(
m
), *
this
,‚);

194 
RETURN
(
T”mI‹¿tÜ
(

));

197 
T”mI‹¿tÜ


198 
	gD©aba£
::
®É”ms_begš
() const

200  
®É”ms_begš
("");

203 
T”mI‹¿tÜ


204 
	gD©aba£
::
®É”ms_begš
(cÚ¡ 
¡d
::
¡ršg
 & 
´efix
) const

206 
LOGCALL
(
API
, 
T”mI‹¿tÜ
, "D©aba£::®É”ms_begš", 
NO_ARGS
);

207 
T”mLi¡
 * 
	g
;

208 ià(
¿»
(
š‹º®
.
size
() == 0)) {

209 

 = 
NULL
;

210 } ià(
	gš‹º®
.
size
() == 1) {

211 

 = 
š‹º®
[0]->
İ’_®É”ms
(
´efix
);

213 
	g
 = 
Ãw
 
MuÉiAÎT”msLi¡
(
š‹º®
, 
´efix
);

215 
RETURN
(
T”mI‹¿tÜ
(

));

218 
boŞ


219 
	gD©aba£
::
has_pos™iÚs
() const

221 
LOGCALL
(
API
, 
boŞ
, "D©aba£::has_pos™iÚs", 
NO_ARGS
);

223 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

224 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); ++i) {

225 ià((*
	gi
)->
has_pos™iÚs
()è
RETURN
(
Œue
);

227 
RETURN
(
çl£
);

230 
Pos™iÚI‹¿tÜ


231 
	gD©aba£
::
pos™iÚli¡_begš
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 &
Šame
) const

233 
LOGCALL
(
API
, 
Pos™iÚI‹¿tÜ
, "Database::positionlist_begin",

234 
did
 << ", " << 
Šame
);

235 ià(
	gŠame
.
em±y
())

236 
throw
 
Inv®idArgum’tE¼Ü
("Zero†engtherms‡re invalid");

237 ià(
	gdid
 == 0)

238 
docid_z”o_šv®id
();

240 
	gmuÉl›r
 = 
š‹º®
.
size
();

241 ià(
¿»
(
muÉl›r
 == 0))

242 
no_subd©aba£s
();

243 
	gX­Ÿn
::
doccouÁ
 
n
 = (
did
 - 1è% 
muÉl›r
;

244 
	gX­Ÿn
::
docid
 
m
 = (
did
 - 1è/ 
muÉl›r
 + 1;

245 
RETURN
(
Pos™iÚI‹¿tÜ
(
š‹º®
[
n
]->
İ’_pos™iÚ_li¡
(
m
, 
Šame
)));

248 
	gX­Ÿn
::
doccouÁ


249 
D©aba£
::
g‘_doccouÁ
() const

251 
LOGCALL
(
API
, 
X­Ÿn
::
doccouÁ
, "D©aba£::g‘_doccouÁ", 
NO_ARGS
);

252 
	gX­Ÿn
::
doccouÁ
 
docs
 = 0;

253 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

254 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); ++i) {

255 
	gdocs
 +ğ(*
i
)->
g‘_doccouÁ
();

257 
RETURN
(
docs
);

260 
	gX­Ÿn
::
docid


261 
D©aba£
::
g‘_Ï¡docid
() const

263 
LOGCALL
(
API
, 
X­Ÿn
::
docid
, "D©aba£::g‘_Ï¡docid", 
NO_ARGS
);

264 
	gX­Ÿn
::
docid
 
did
 = 0;

266 
	gmuÉl›r
 = 
š‹º®
.
size
();

267 
	gX­Ÿn
::
doccouÁ
 
i
 = 0; 
	gi
 < 
	gmuÉl›r
; ++i) {

268 
	gX­Ÿn
::
docid
 
did_i
 = 
š‹º®
[
i
]->
g‘_Ï¡docid
();

269 ià(
	gdid_i
è
	gdid
 = 
¡d
::
max
(
did
, (
did_i
 - 1è* 
muÉl›r
 + 
i
 + 1);

271 
RETURN
(
did
);

274 
	gX­Ÿn
::
doş’gth


275 
D©aba£
::
g‘_avËngth
() const

277 
LOGCALL
(
API
, 
X­Ÿn
::
doş’gth
, "D©aba£::g‘_avËngth", 
NO_ARGS
);

278 
	gX­Ÿn
::
doccouÁ
 
docs
 = 0;

279 
	gX­Ÿn
::
doş’gth
 
tÙËn
 = 0;

281 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

282 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); ++i) {

283 
	gX­Ÿn
::
doccouÁ
 
db_doccouÁ
 = (*
i
)->
g‘_doccouÁ
();

284 
	gdocs
 +ğ
db_doccouÁ
;

285 
	gtÙËn
 +ğ(*
i
)->
g‘_avËngth
(è* 
db_doccouÁ
;

287 
LOGLINE
(
UNKNOWN
, "g‘_avËngth(èğ" << 
tÙËn
 << " / " << 
docs
 <<

288 " (äom " << 
š‹º®
.
size
() << " dbs)");

290 ià(
	gdocs
 =ğ0è
RETURN
(0.0);

291 
RETURN
(
tÙËn
 / 
docs
);

294 
	gX­Ÿn
::
doccouÁ


295 
D©aba£
::
g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

297 
LOGCALL
(
API
, 
X­Ÿn
::
doccouÁ
, "D©aba£::g‘_‹rmäeq", 
Šame
);

298 ià(
	gŠame
.
em±y
()è
RETURN
(
g‘_doccouÁ
());

300 
	gX­Ÿn
::
doccouÁ
 
tf
 = 0;

301 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

302 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); i++) {

303 
	gtf
 +ğ(*
i
)->
g‘_‹rmäeq
(
Šame
);

305 
RETURN
(
tf
);

308 
	gX­Ÿn
::
‹rmcouÁ


309 
D©aba£
::
g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

311 
LOGCALL
(
API
, 
X­Ÿn
::
‹rmcouÁ
, "D©aba£::g‘_cŞËùiÚ_äeq", 
Šame
);

312 ià(
	gŠame
.
em±y
()è
RETURN
(
g‘_doccouÁ
());

314 
	gX­Ÿn
::
‹rmcouÁ
 
cf
 = 0;

315 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

316 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); i++) {

317 
	gcf
 +ğ(*
i
)->
g‘_cŞËùiÚ_äeq
(
Šame
);

319 
RETURN
(
cf
);

322 
	gX­Ÿn
::
doccouÁ


323 
D©aba£
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const

325 
LOGCALL
(
API
, 
X­Ÿn
::
doccouÁ
, "D©aba£::g‘_v®ue_äeq", 
v®no
);

327 
	gX­Ÿn
::
doccouÁ
 
vf
 = 0;

328 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

329 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); i++) {

330 
	gvf
 +ğ(*
i
)->
g‘_v®ue_äeq
(
v®no
);

332 
RETURN
(
vf
);

335 
¡ršg


336 
	gD©aba£
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

338 
LOGCALL
(
API
, 
¡ršg
, "D©aba£::g‘_v®ue_low”_bound", 
v®no
);

340 ià(
¿»
(
š‹º®
.
em±y
())è
RETURN
(
¡ršg
());

342 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

343 
	gi
 = 
š‹º®
.
begš
();

344 
¡ršg
 
	gfuÎ_lb
 = (*
i
)->
g‘_v®ue_low”_bound
(
v®no
);

345 ++
	gi
 !ğ
š‹º®
.
’d
()) {

346 
¡ršg
 
lb
 = (*
i
)->
g‘_v®ue_low”_bound
(
v®no
);

347 ià(
	glb
 < 
	gfuÎ_lb
èfuÎ_lb = 
lb
;

349 
RETURN
(
fuÎ_lb
);

352 
	g¡d
::
¡ršg


353 
D©aba£
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

355 
LOGCALL
(
API
, 
¡d
::
¡ršg
, "D©aba£::g‘_v®ue_uµ”_bound", 
v®no
);

357 
	g¡d
::
¡ršg
 
fuÎ_ub
;

358 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

359 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); i++) {

360 
	g¡d
::
¡ršg
 
ub
 = (*
i
)->
g‘_v®ue_uµ”_bound
(
v®no
);

361 ià(
	gub
 > 
	gfuÎ_ub
)

362 
	gfuÎ_ub
 = 
ub
;

364 
RETURN
(
fuÎ_ub
);

367 
	gX­Ÿn
::
‹rmcouÁ


368 
D©aba£
::
g‘_doş’gth_low”_bound
() const

370 
LOGCALL
(
API
, 
X­Ÿn
::
‹rmcouÁ
, "D©aba£::g‘_doş’gth_low”_bound", 
NO_ARGS
);

372 ià(
¿»
(
š‹º®
.
em±y
())è
RETURN
(0);

374 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

375 
	gi
 = 
š‹º®
.
begš
();

376 
	gX­Ÿn
::
‹rmcouÁ
 
fuÎ_lb
 = (*
i
)->
g‘_doş’gth_low”_bound
();

377 ++
	gi
 !ğ
š‹º®
.
’d
()) {

378 
X­Ÿn
::
‹rmcouÁ
 
lb
 = (*
i
)->
g‘_doş’gth_low”_bound
();

379 ià(
	glb
 < 
	gfuÎ_lb
èfuÎ_lb = 
lb
;

381 
RETURN
(
fuÎ_lb
);

384 
	gX­Ÿn
::
‹rmcouÁ


385 
D©aba£
::
g‘_doş’gth_uµ”_bound
() const

387 
LOGCALL
(
API
, 
X­Ÿn
::
‹rmcouÁ
, "D©aba£::g‘_doş’gth_uµ”_bound", 
NO_ARGS
);

389 
	gX­Ÿn
::
‹rmcouÁ
 
fuÎ_ub
 = 0;

390 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

391 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); i++) {

392 
	gX­Ÿn
::
‹rmcouÁ
 
ub
 = (*
i
)->
g‘_doş’gth_uµ”_bound
();

393 ià(
	gub
 > 
	gfuÎ_ub
èfuÎ_ub = 
ub
;

395 
RETURN
(
fuÎ_ub
);

398 
	gX­Ÿn
::
‹rmcouÁ


399 
D©aba£
::
g‘_wdf_uµ”_bound
(cÚ¡ 
¡ršg
 & 
‹rm
) const

401 
LOGCALL
(
API
, 
X­Ÿn
::
‹rmcouÁ
, "D©aba£::g‘_wdf_uµ”_bound", 
‹rm
);

403 
	gX­Ÿn
::
‹rmcouÁ
 
fuÎ_ub
 = 0;

404 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

405 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); i++) {

406 
	gX­Ÿn
::
‹rmcouÁ
 
ub
 = (*
i
)->
g‘_wdf_uµ”_bound
(
‹rm
);

407 ià(
	gub
 > 
	gfuÎ_ub
èfuÎ_ub = 
ub
;

409 
RETURN
(
fuÎ_ub
);

412 
V®ueI‹¿tÜ


413 
	gD©aba£
::
v®ue¡»am_begš
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

415 
LOGCALL
(
API
, 
V®ueI‹¿tÜ
, "D©aba£::v®ue¡»am_begš", 
¦Ù
);

416 ià(
	gš‹º®
.
size
() == 0)

417 
RETURN
(
V®ueI‹¿tÜ
());

418 ià(
	gš‹º®
.
size
() != 1)

419 
RETURN
(
V®ueI‹¿tÜ
(
Ãw
 
MuÉiV®ueLi¡
(
š‹º®
, 
¦Ù
)));

420 
RETURN
(
V®ueI‹¿tÜ
(
š‹º®
[0]->
İ’_v®ue_li¡
(
¦Ù
)));

423 
	gX­Ÿn
::
‹rmcouÁ


424 
D©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

426 
LOGCALL
(
API
, 
X­Ÿn
::
‹rmcouÁ
, "D©aba£::g‘_doş’gth", 
did
);

427 ià(
	gdid
 == 0)

428 
docid_z”o_šv®id
();

430 
	gmuÉl›r
 = 
š‹º®
.
size
();

431 ià(
¿»
(
muÉl›r
 == 0))

432 
no_subd©aba£s
();

433 
	gX­Ÿn
::
doccouÁ
 
n
 = (
did
 - 1è% 
muÉl›r
;

434 
	gX­Ÿn
::
docid
 
m
 = (
did
 - 1è/ 
muÉl›r
 + 1;

435 
RETURN
(
š‹º®
[
n
]->
g‘_doş’gth
(
m
));

438 
Docum’t


439 
	gD©aba£
::
g‘_docum’t
(
X­Ÿn
::
docid
 
did
) const

441 
LOGCALL
(
API
, 
Docum’t
, "D©aba£::g‘_docum’t", 
did
);

442 ià(
	gdid
 == 0)

443 
docid_z”o_šv®id
();

445 
	gmuÉl›r
 = 
š‹º®
.
size
();

446 ià(
¿»
(
muÉl›r
 == 0))

447 
no_subd©aba£s
();

448 
	gX­Ÿn
::
doccouÁ
 
n
 = (
did
 - 1è% 
muÉl›r
;

449 
	gX­Ÿn
::
docid
 
m
 = (
did
 - 1è/ 
muÉl›r
 + 1;

452 
RETURN
(
Docum’t
(
š‹º®
[
n
]->
İ’_docum’t
(
m
, 
çl£
)));

455 
	gDocum’t
::
IÁ”Çl
 *

456 
D©aba£
::
g‘_docum’t_Ïzy
(
X­Ÿn
::
docid
 
did
) const

458 
DEBUGCALL
(
DB
, 
Docum’t
::
IÁ”Çl
 *, "D©aba£::g‘_docum’t_Ïzy", 
did
);

459 ià(
	gdid
 == 0)

460 
docid_z”o_šv®id
();

462 
	gmuÉl›r
 = 
š‹º®
.
size
();

463 
As£¹
(
muÉl›r
 != 0);

464 
	gX­Ÿn
::
doccouÁ
 
n
 = (
did
 - 1è% 
muÉl›r
;

465 
	gX­Ÿn
::
docid
 
m
 = (
did
 - 1è/ 
muÉl›r
 + 1;

467 
RETURN
(
š‹º®
[
n
]->
İ’_docum’t
(
m
, 
Œue
));

470 
boŞ


471 
	gD©aba£
::
‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const

473 
LOGCALL
(
API
, 
boŞ
, "D©aba£::‹rm_exi¡s", 
Šame
);

474 ià(
	gŠame
.
em±y
()) {

475 
RETURN
(
g‘_doccouÁ
() != 0);

477 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

478 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); ++i) {

479 ià((*
	gi
)->
‹rm_exi¡s
(
Šame
)è
RETURN
(
Œue
);

481 
RETURN
(
çl£
);

485 
	gD©aba£
::
k“p_®ive
()

487 
LOGCALL_VOID
(
API
, "D©aba£::k“p_®ive", 
NO_ARGS
);

488 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

489 
	gi
 = 
š‹º®
.
begš
(); i !ğš‹º®.
’d
(); ++i) {

490 (*
	gi
)->
k“p_®ive
();

494 
¡ršg


495 
	gD©aba£
::
g‘_desütiÚ
() const

511 
	#VEC_SIZE
 64

	)

514 
äeq_ed™_low”_bound
(cÚ¡ 
veùÜ
<> & 
a
, cÚ¡ veùÜ<> & 
b
)

516 
	gvec
[
VEC_SIZE
];

517 
mem£t
(
vec
, 0, (vec));

518 
	gveùÜ
<>::
cÚ¡_™”©Ü
 
i
;

519 
	gi
 = 
a
.
begš
(); i !ğa.
’d
(); ++i) {

520 ++
	gvec
[(*
i
è% 
VEC_SIZE
];

522 
	gi
 = 
b
.
begš
(); i !ğb.
’d
(); ++i) {

523 --
	gvec
[(*
i
è% 
VEC_SIZE
];

525 
	gtÙ®
 = 0;

526 
size_t
 
	gj
 = 0; j < 
	gVEC_SIZE
; ++j) {

527 
	gtÙ®
 +ğ
abs
(
vec
[
j
]);

533  (
	gtÙ®
 + 1) / 2;

538 
	#TRIGRAM_SCORE_THRESHOLD
 2

	)

540 
¡ršg


541 
	gD©aba£
::
g‘_¥–lšg_sugge¡iÚ
(cÚ¡ 
¡ršg
 &
wÜd
,

542 
max_ed™_di¡ªû
) const

544 
LOGCALL
(
API
, 
¡ršg
, "Database::get_spelling_suggestion",

545 
wÜd
 << ", " << 
max_ed™_di¡ªû
);

546 ià(
	gwÜd
.
size
(è<ğ1è 
¡ršg
();

547 
	gAutoPŒ
<
	gT”mLi¡
> 
	gm”g”
;

548 
size_t
 
	gi
 = 0; i < 
	gš‹º®
.
size
(); ++i) {

549 
T”mLi¡
 * 
	g
 = 
š‹º®
[
i
]->
İ’_¥–lšg_‹rmli¡
(
wÜd
);

550 
LOGLINE
(
SPELLING
, "Sub db " << 
i
 << "Èğ" << (*)

);

551 ià(
	g
) {

552 ià(
	gm”g”
.
g‘
()) {

553 
	gm”g”
.
»£t
(
Ãw
 
OrT”mLi¡
(
m”g”
.
»Ëa£
(), 

));

555 
	gm”g”
.
»£t
(

);

559 ià(!
	gm”g”
.
g‘
()è
RETURN
(
¡ršg
());

562 #ifdeà
__SUNPRO_CC


563 
	gveùÜ
<> 
	gutf32_wÜd
;

564 
Utf8I‹¿tÜ
 
suÅro_™
(
wÜd
); 
	gsuÅro_™
 != Utf8Iterator(); ++sunpro_it) {

565 
	gutf32_wÜd
.
push_back
(*
suÅro_™
);

570 
	gveùÜ
<> 
utf32_wÜd
((
Utf8I‹¿tÜ
(
wÜd
)), Utf8Iterator());

573 
	gveùÜ
<> 
	gutf32_‹rm
;

575 
	gX­Ÿn
::
‹rmcouÁ
 
be¡
 = 1;

576 
¡ršg
 
	g»suÉ
;

577 
	gedi¡_be¡
 = 
max_ed™_di¡ªû
;

578 
	gX­Ÿn
::
doccouÁ
 
äeq_be¡
 = 0;

579 
	gŒue
) {

580 
T”mLi¡
 *
	g»t
 = 
m”g”
->
Ãxt
();

581 ià(
	g»t
è
	gm”g”
.
»£t
(
»t
);

583 ià(
	gm”g”
->
©_’d
()) ;

585 
¡ršg
 
	g‹rm
 = 
m”g”
->
g‘_‹rmÇme
();

586 
	gX­Ÿn
::
‹rmcouÁ
 
scÜe
 = 
m”g”
->
g‘_wdf
();

588 
LOGLINE
(
SPELLING
, "T”m \"" << 
‹rm
 << "\"‚g¿m scÜ" << 
scÜe
);

589 ià(
	gscÜe
 + 
	gTRIGRAM_SCORE_THRESHOLD
 >ğ
be¡
) {

590 ià(
scÜe
 > 
be¡
) best = score;

598 ià(
abs
((
‹rm
.
size
()è- (
wÜd
.size())è> 
	gedi¡_be¡
 * 4) {

599 
LOGLINE
(
SPELLING
, "Lengths muchoo different");

605 
	gutf32_‹rm
.
assign
(
Utf8I‹¿tÜ
(
‹rm
), Utf8Iterator());

607 ià(
abs
((
utf32_‹rm
.
size
()è- (
utf32_wÜd
.size()))

608 > 
	gedi¡_be¡
) {

609 
LOGLINE
(
SPELLING
, "Lengthsoo different");

613 ià(
äeq_ed™_low”_bound
(
utf32_‹rm
, 
utf32_wÜd
è> 
	gedi¡_be¡
) {

614 
LOGLINE
(
SPELLING
, "Rejected by character frequencyest");

618 
	gedi¡
 = 
ed™_di¡ªû_unsigÃd
(&
utf32_‹rm
[0],

619 (
utf32_‹rm
.
size
()),

620 &
utf32_wÜd
[0],

621 (
utf32_wÜd
.
size
()),

622 
edi¡_be¡
);

623 
LOGLINE
(
SPELLING
, "Ed™ di¡ªû " << 
edi¡
);

626 ià(
	gedi¡
 =ğ0è
RETURN
(
¡ršg
());

628 ià(
	gedi¡
 <ğ
edi¡_be¡
) {

629 
X­Ÿn
::
doccouÁ
 
äeq
 = 0;

630 
size_t
 
	gj
 = 0; j < 
	gš‹º®
.
size
(); ++j)

631 
	gäeq
 +ğ
š‹º®
[
j
]->
g‘_¥–lšg_äequ’cy
(
‹rm
);

633 
LOGLINE
(
SPELLING
, "F»q " << 
äeq
 << " be¡ " << 
äeq_be¡
);

634 ià(
	gedi¡
 < 
	gedi¡_be¡
 || 
	gäeq
 > 
	gäeq_be¡
) {

635 
LOGLINE
(
SPELLING
, "Be¡ sØçr: \"" << 
‹rm
 <<

636 "\"ƒdi¡ " << 
edi¡
 << " f»q " << 
äeq
);

637 
	g»suÉ
 = 
‹rm
;

638 
	gedi¡_be¡
 = 
edi¡
;

639 
	gäeq_be¡
 = 
äeq
;

644 
RETURN
(
»suÉ
);

647 
T”mI‹¿tÜ


648 
	gD©aba£
::
¥–lšgs_begš
() const

650 
LOGCALL
(
API
, 
T”mI‹¿tÜ
, "D©aba£::¥–lšgs_begš", 
NO_ARGS
);

651 
	gAutoPŒ
<
	gT”mLi¡
> 
	gm”g”
;

652 
size_t
 
	gi
 = 0; i < 
	gš‹º®
.
size
(); ++i) {

653 
T”mLi¡
 * 
	g
 = 
š‹º®
[
i
]->
İ’_¥–lšg_wÜdli¡
();

654 ià(
	g
) {

655 ià(
	gm”g”
.
g‘
()) {

656 
	gm”g”
.
»£t
(
Ãw
 
F»qAdd”OrT”mLi¡
(
m”g”
.
»Ëa£
(), 

));

658 
	gm”g”
.
»£t
(

);

662 
RETURN
(
T”mI‹¿tÜ
(
m”g”
.
»Ëa£
()));

665 
T”mI‹¿tÜ


666 
	gD©aba£
::
synÚyms_begš
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
) const

668 
LOGCALL
(
API
, 
T”mI‹¿tÜ
, "D©aba£::synÚyms_begš", 
‹rm
);

669 
	gAutoPŒ
<
	gT”mLi¡
> 
	gm”g”
;

670 
size_t
 
	gi
 = 0; i < 
	gš‹º®
.
size
(); ++i) {

671 
T”mLi¡
 * 
	g
 = 
š‹º®
[
i
]->
İ’_synÚym_‹rmli¡
(
‹rm
);

672 ià(
	g
) {

673 ià(
	gm”g”
.
g‘
()) {

674 
	gm”g”
.
»£t
(
Ãw
 
OrT”mLi¡
(
m”g”
.
»Ëa£
(), 

));

676 
	gm”g”
.
»£t
(

);

680 
RETURN
(
T”mI‹¿tÜ
(
m”g”
.
»Ëa£
()));

683 
T”mI‹¿tÜ


684 
	gD©aba£
::
synÚym_keys_begš
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const

686 
LOGCALL
(
API
, 
T”mI‹¿tÜ
, "D©aba£::synÚyms_keys_begš", 
´efix
);

687 
	gAutoPŒ
<
	gT”mLi¡
> 
	gm”g”
;

688 
size_t
 
	gi
 = 0; i < 
	gš‹º®
.
size
(); ++i) {

689 
T”mLi¡
 * 
	g
 = 
š‹º®
[
i
]->
İ’_synÚym_keyli¡
(
´efix
);

690 ià(
	g
) {

691 ià(
	gm”g”
.
g‘
()) {

692 
	gm”g”
.
»£t
(
Ãw
 
OrT”mLi¡
(
m”g”
.
»Ëa£
(), 

));

694 
	gm”g”
.
»£t
(

);

698 
RETURN
(
T”mI‹¿tÜ
(
m”g”
.
»Ëa£
()));

701 
¡ršg


702 
	gD©aba£
::
g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const

704 
LOGCALL
(
API
, 
¡ršg
, "D©aba£::g‘_m‘ad©a", 
key
);

705 ià(
	gkey
.
em±y
())

706 
throw
 
Inv®idArgum’tE¼Ü
("Empty metadata keys‡re invalid");

707 ià(
	gš‹º®
.
em±y
()è
RETURN
(
¡d
::
¡ršg
());

708 
RETURN
(
š‹º®
[0]->
g‘_m‘ad©a
(
key
));

711 
	gX­Ÿn
::
T”mI‹¿tÜ


712 
D©aba£
::
m‘ad©a_keys_begš
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const

714 
LOGCALL
(
API
, 
X­Ÿn
::
T”mI‹¿tÜ
, "D©aba£::m‘ad©a_keys_begš", 
NO_ARGS
);

715 ià(
	gš‹º®
.
em±y
()è
RETURN
(
T”mI‹¿tÜ
(
NULL
));

716 
RETURN
(
T”mI‹¿tÜ
(
š‹º®
[0]->
İ’_m‘ad©a_keyli¡
(
´efix
)));

719 
	g¡d
::
¡ršg


720 
D©aba£
::
g‘_uuid
() const

722 
LOGCALL
(
API
, 
¡d
::
¡ršg
, "D©aba£::g‘_uuid", 
NO_ARGS
);

723 
¡ršg
 
	guuid
;

724 
size_t
 
	gi
 = 0; i < 
	gš‹º®
.
size
(); ++i) {

725 
¡ršg
 
	gsub_uuid
 = 
š‹º®
[
i
]->
g‘_uuid
();

728 ià(
	gsub_uuid
.
em±y
())

729 
RETURN
(
sub_uuid
);

730 ià(!
	guuid
.
em±y
()) uuid += ':';

731 
	guuid
 +ğ
sub_uuid
;

733 
RETURN
(
uuid
);

738 
	gWr™abËD©aba£
::
Wr™abËD©aba£
(è: 
D©aba£
()

740 
LOGCALL_CTOR
(
API
, "Wr™abËD©aba£::Wr™abËD©aba£", 
NO_ARGS
);

743 
	gWr™abËD©aba£
::
Wr™abËD©aba£
(
D©aba£
::
IÁ”Çl
 *
š‹º®_
)

744 : 
D©aba£
(
š‹º®_
)

746 
LOGCALL_CTOR
(
API
, "WritableDatabase::WritableDatabase", "Database::Internal");

749 
	gWr™abËD©aba£
::
Wr™abËD©aba£
(cÚ¡ Wr™abËD©aba£ &
Ùh”
)

750 : 
D©aba£
(
Ùh”
)

752 
LOGCALL_CTOR
(
API
, "WritableDatabase::WritableDatabase", "WritableDatabase");

756 
	gWr™abËD©aba£
::
İ”©Ü
=(cÚ¡ 
Wr™abËD©aba£
 &
Ùh”
)

758 
LOGCALL_VOID
(
API
, "WritableDatabase::operator=", "WritableDatabase");

759 
	gD©aba£
::
İ”©Ü
=(
Ùh”
);

762 
	gWr™abËD©aba£
::~
Wr™abËD©aba£
()

764 
LOGCALL_DTOR
(
API
, "WritableDatabase::~WritableDatabase");

767 
XAPIAN_NORETURN
(
Úly_Úe_subd©aba£_®lowed
());

768 
Úly_Úe_subd©aba£_®lowed
()

770 
throw
 
	gX­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("WritableDatabase‚eedsƒxactly one subdatabase");

774 
	gWr™abËD©aba£
::
comm™
()

776 
LOGCALL_VOID
(
API
, "Wr™abËD©aba£::comm™", 
NO_ARGS
);

777 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

778 
	gš‹º®
[0]->
comm™
();

782 
	gWr™abËD©aba£
::
begš_Œª§ùiÚ
(
boŞ
 
æushed
)

784 
LOGCALL_VOID
(
API
, "Wr™abËD©aba£::begš_Œª§ùiÚ", 
NO_ARGS
);

785 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

786 
	gš‹º®
[0]->
begš_Œª§ùiÚ
(
æushed
);

790 
	gWr™abËD©aba£
::
comm™_Œª§ùiÚ
()

792 
LOGCALL_VOID
(
API
, "Wr™abËD©aba£::comm™_Œª§ùiÚ", 
NO_ARGS
);

793 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

794 
	gš‹º®
[0]->
comm™_Œª§ùiÚ
();

798 
	gWr™abËD©aba£
::
ÿnûl_Œª§ùiÚ
()

800 
LOGCALL_VOID
(
API
, "Wr™abËD©aba£::ÿnûl_Œª§ùiÚ", 
NO_ARGS
);

801 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

802 
	gš‹º®
[0]->
ÿnûl_Œª§ùiÚ
();

806 
	gX­Ÿn
::
docid


807 
Wr™abËD©aba£
::
add_docum’t
(cÚ¡ 
Docum’t
 & 
docum’t
)

809 
LOGCALL
(
API
, 
X­Ÿn
::
docid
, "Wr™abËD©aba£::add_docum’t", 
docum’t
);

810 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

811 
RETURN
(
š‹º®
[0]->
add_docum’t
(
docum’t
));

815 
	gWr™abËD©aba£
::
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
)

817 
LOGCALL_VOID
(
API
, "Wr™abËD©aba£::d–‘e_docum’t", 
did
);

818 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

819 ià(
	gdid
 == 0)

820 
docid_z”o_šv®id
();

821 
	gš‹º®
[0]->
d–‘e_docum’t
(
did
);

825 
	gWr™abËD©aba£
::
d–‘e_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
unique_‹rm
)

827 
LOGCALL_VOID
(
API
, "Wr™abËD©aba£::d–‘e_docum’t", 
unique_‹rm
);

828 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

829 ià(
	gunique_‹rm
.
em±y
())

830 
throw
 
Inv®idArgum’tE¼Ü
("Emptyermnames‡re invalid");

831 
	gš‹º®
[0]->
d–‘e_docum’t
(
unique_‹rm
);

835 
	gWr™abËD©aba£
::
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
Docum’t
 & 
docum’t
)

837 
LOGCALL_VOID
(
API
, "WritableDatabase::replace_document",

838 
did
 << ", " << 
docum’t
);

839 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

840 ià(
	gdid
 == 0)

841 
docid_z”o_šv®id
();

842 
	gš‹º®
[0]->
»¶aû_docum’t
(
did
, 
docum’t
);

845 
	gX­Ÿn
::
docid


846 
Wr™abËD©aba£
::
»¶aû_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
unique_‹rm
,

847 cÚ¡ 
Docum’t
 & 
docum’t
)

849 
LOGCALL
(
API
, 
X­Ÿn
::
docid
, "WritableDatabase::replace_document",

850 
unique_‹rm
 << ", " << 
docum’t
);

851 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

852 ià(
	gunique_‹rm
.
em±y
())

853 
throw
 
Inv®idArgum’tE¼Ü
("Emptyermnames‡re invalid");

854 
RETURN
(
š‹º®
[0]->
»¶aû_docum’t
(
unique_‹rm
, 
docum’t
));

858 
	gWr™abËD©aba£
::
add_¥–lšg
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
,

859 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const

861 
LOGCALL_VOID
(
API
, "WritableDatabase::add_spelling",

862 
wÜd
 << ", " << 
äeqšc
);

863 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

864 
	gš‹º®
[0]->
add_¥–lšg
(
wÜd
, 
äeqšc
);

868 
	gWr™abËD©aba£
::
»move_¥–lšg
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
,

869 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const

871 
LOGCALL_VOID
(
API
, "WritableDatabase::remove_spelling",

872 
wÜd
 << ", " << 
äeqdec
);

873 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

874 
	gš‹º®
[0]->
»move_¥–lšg
(
wÜd
, 
äeqdec
);

878 
	gWr™abËD©aba£
::
add_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
,

879 cÚ¡ 
¡d
::
¡ršg
 & 
synÚym
) const

881 
LOGCALL_VOID
(
API
, "WritableDatabase::add_synonym",

882 
‹rm
 << ", " << 
synÚym
);

883 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

884 
	gš‹º®
[0]->
add_synÚym
(
‹rm
, 
synÚym
);

888 
	gWr™abËD©aba£
::
»move_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
,

889 cÚ¡ 
¡d
::
¡ršg
 & 
synÚym
) const

891 
LOGCALL_VOID
(
API
, "WritableDatabase::remove_synonym",

892 
‹rm
 << ", " << 
synÚym
);

893 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

894 
	gš‹º®
[0]->
»move_synÚym
(
‹rm
, 
synÚym
);

898 
	gWr™abËD©aba£
::
ş—r_synÚyms
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const

900 
LOGCALL_VOID
(
API
, "Wr™abËD©aba£::ş—r_synÚyms", 
‹rm
);

901 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

902 
	gš‹º®
[0]->
ş—r_synÚyms
(
‹rm
);

906 
	gWr™abËD©aba£
::
£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
)

908 
LOGCALL_VOID
(
API
, "Wr™abËD©aba£::£t_m‘ad©a", 
key
 << ", " << 
v®ue
);

909 ià(
	gš‹º®
.
size
(è!ğ1è
Úly_Úe_subd©aba£_®lowed
();

910 ià(
	gkey
.
em±y
())

911 
throw
 
Inv®idArgum’tE¼Ü
("Empty metadata keys‡re invalid");

912 
	gš‹º®
[0]->
£t_m‘ad©a
(
key
, 
v®ue
);

915 
¡ršg


916 
	gWr™abËD©aba£
::
g‘_desütiÚ
() const

	@api/omdocument.cc

24 
	~<cÚfig.h
>

26 
	~<x­Ÿn/docum’t.h
>

28 
	~"docum’t.h
"

29 
	~"docum’tv®u–i¡.h
"

30 
	~"m­‹rmli¡.h
"

31 
	~"£rŸli£.h
"

32 
	~"uts.h
"

34 
	~<x­Ÿn/”rÜ.h
>

35 
	~<x­Ÿn/ty³s.h
>

36 
	~<x­Ÿn/v®ue™”©Ü.h
>

38 
	~<®gÜ™hm
>

39 
	~<¡ršg
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

43 
Çme¥aû
 
	gX­Ÿn
 {

47 
	gDocum’t
::
Docum’t
(Docum’t::
IÁ”Çl
 *
š‹º®_
è: 
š‹º®
(internal_)

51 
Docum’t
::Docum’t(è: 
š‹º®
(
Ãw
 
X­Ÿn
::Docum’t::
IÁ”Çl
)

55 
¡ršg


56 
Docum’t
::
g‘_v®ue
(
X­Ÿn
::
v®u’o
 
v®ue
) const

58 
DEBUGAPICALL
(
¡ršg
, "Docum’t::g‘_v®ue", 
v®ue
);

59 
RETURN
(
š‹º®
->
g‘_v®ue
(
v®ue
));

62 
¡ršg


63 
	gDocum’t
::
g‘_d©a
() const

65 
DEBUGAPICALL
(
¡ršg
, "Document::get_data", "");

66 
RETURN
(
š‹º®
->
g‘_d©a
());

70 
	gDocum’t
::
£t_d©a
(cÚ¡ 
¡ršg
 &
d©a
)

72 
DEBUGAPICALL
(, "Docum’t::£t_d©a", 
d©a
);

73 
	gš‹º®
->
£t_d©a
(
d©a
);

77 
	gDocum’t
::
İ”©Ü
=(cÚ¡ 
Docum’t
 &
Ùh”
)

80 
š‹º®
 = 
Ùh”
.internal;

83 
	gDocum’t
::
Docum’t
(cÚ¡ Docum’ˆ&
Ùh”
)

84 : 
š‹º®
(
Ùh”
.internal)

88 
Docum’t
::~Document()

92 
¡ršg


93 
Docum’t
::
g‘_desütiÚ
() const

95  "Docum’t(" + 
š‹º®
->
g‘_desütiÚ
() + ")";

99 
	gDocum’t
::
add_v®ue
(
X­Ÿn
::
v®u’o
 v®u’o, cÚ¡ 
¡ršg
 &
v®ue
)

101 
DEBUGAPICALL
(, "Docum’t::add_v®ue", 
v®u’o
 << ", " << 
v®ue
);

102 
	gš‹º®
->
add_v®ue
(
v®u’o
, 
v®ue
);

106 
	gDocum’t
::
»move_v®ue
(
X­Ÿn
::
v®u’o
 valueno)

108 
DEBUGAPICALL
(, "Docum’t::»move_v®ue", 
v®u’o
);

109 
	gš‹º®
->
»move_v®ue
(
v®u’o
);

113 
	gDocum’t
::
ş—r_v®ues
()

115 
DEBUGAPICALL
(, "Document::clear_values", "");

116 
	gš‹º®
->
ş—r_v®ues
();

120 
	gDocum’t
::
add_po¡šg
(cÚ¡ 
¡ršg
 & 
Šame
,

121 
X­Ÿn
::
‹rmpos
 
os
,

122 
X­Ÿn
::
‹rmcouÁ
 
wdfšc
)

124 
DEBUGAPICALL
(, "Document::add_posting",

125 
Šame
 << ", " << 
os
 << ", " << 
wdfšc
);

126 ià(
	gŠame
.
em±y
()) {

127 
throw
 
Inv®idArgum’tE¼Ü
("Emptyermnames‡ren't‡llowed.");

129 
	gš‹º®
->
add_po¡šg
(
Šame
, 
os
, 
wdfšc
);

133 
	gDocum’t
::
add_‹rm
(cÚ¡ 
¡ršg
 & 
Šame
, 
X­Ÿn
::
‹rmcouÁ
 
wdfšc
)

135 
DEBUGAPICALL
(, "Docum’t::add_‹rm", 
Šame
 << ", " << 
wdfšc
);

136 ià(
	gŠame
.
em±y
()) {

137 
throw
 
Inv®idArgum’tE¼Ü
("Emptyermnames‡ren't‡llowed.");

139 
	gš‹º®
->
add_‹rm
(
Šame
, 
wdfšc
);

143 
	gDocum’t
::
»move_po¡šg
(cÚ¡ 
¡ršg
 & 
Šame
, 
X­Ÿn
::
‹rmpos
 
os
,

144 
X­Ÿn
::
‹rmcouÁ
 
wdfdec
)

146 
DEBUGAPICALL
(, "Document::remove_posting",

147 
Šame
 << ", " << 
os
 << ", " << 
wdfdec
);

148 ià(
	gŠame
.
em±y
()) {

149 
throw
 
Inv®idArgum’tE¼Ü
("Emptyermnames‡ren't‡llowed.");

151 
	gš‹º®
->
»move_po¡šg
(
Šame
, 
os
, 
wdfdec
);

155 
	gDocum’t
::
»move_‹rm
(cÚ¡ 
¡ršg
 & 
Šame
)

157 
DEBUGAPICALL
(, "Docum’t::»move_‹rm", 
Šame
);

158 
	gš‹º®
->
»move_‹rm
(
Šame
);

162 
	gDocum’t
::
ş—r_‹rms
()

164 
DEBUGAPICALL
(, "Document::clear_terms", "");

165 
	gš‹º®
->
ş—r_‹rms
();

168 
	gX­Ÿn
::
‹rmcouÁ


169 
Docum’t
::
‹rmli¡_couÁ
() const {

170 
DEBUGAPICALL
(
X­Ÿn
::
‹rmcouÁ
, "Document::termlist_count", "");

171 
RETURN
(
š‹º®
->
‹rmli¡_couÁ
());

174 
T”mI‹¿tÜ


175 
	gDocum’t
::
‹rmli¡_begš
() const

177 
DEBUGAPICALL
(
T”mI‹¿tÜ
, "Document::termlist_begin", "");

178 
RETURN
(
T”mI‹¿tÜ
(
š‹º®
->
İ’_‹rm_li¡
()));

181 
	gX­Ÿn
::
‹rmcouÁ


182 
Docum’t
::
v®ues_couÁ
() const {

183 
DEBUGAPICALL
(
X­Ÿn
::
‹rmcouÁ
, "Document::values_count", "");

184 
RETURN
(
š‹º®
->
v®ues_couÁ
());

187 
V®ueI‹¿tÜ


188 
	gDocum’t
::
v®ues_begš
() const

190 
DEBUGAPICALL
(
V®ueI‹¿tÜ
, "Document::values_begin", "");

193 ià(
	gš‹º®
->
v®ues_couÁ
(è=ğ0è
RETURN
(
V®ueI‹¿tÜ
());

194 
RETURN
(
V®ueI‹¿tÜ
(
Ãw
 
Docum’tV®ueLi¡
(
š‹º®
)));

197 
docid


198 
	gDocum’t
::
g‘_docid
() const

200 
DEBUGAPICALL
(
docid
, "Document::get_docid", "");

201 
RETURN
(
š‹º®
->
g‘_docid
());

204 
	g¡d
::
¡ršg


205 
Docum’t
::
£rŸli£
() const

207 
DEBUGAPICALL
(
¡d
::
¡ršg
, "Document::serialise", "");

208  
£rŸli£_docum’t
(*
this
);

211 
Docum’t


212 
	gDocum’t
::
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
)

214 
DEBUGAPICALL_STATIC
(
Docum’t
, "Docum’t::un£rŸli£", 
s
);

215  
un£rŸli£_docum’t
(
s
);

223 
	gOmDocum’tT”m
::
add_pos™iÚ
(
X­Ÿn
::
‹rmpos
 
os
)

225 
DEBUGAPICALL
(, "OmDocum’tT”m::add_pos™iÚ", 
os
);

229 ià(
	gpos™iÚs
.
em±y
(è|| 
	gos
 >…os™iÚs.
back
()) {

230 
	gpos™iÚs
.
push_back
(
os
);

236 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
>::
™”©Ü
 
i
;

237 
	gi
 = 
low”_bound
(
pos™iÚs
.
begš
(),…os™iÚs.
’d
(), 
os
);

238 ià(
	gi
 =ğ
pos™iÚs
.
’d
(è|| *
i
 !ğ
os
) {

239 
pos™iÚs
.
š£¹
(
i
, 
os
);

244 
	gOmDocum’tT”m
::
»move_pos™iÚ
(
X­Ÿn
::
‹rmpos
 
os
)

246 
DEBUGAPICALL
(, "OmDocum’tT”m::»move_pos™iÚ", 
os
);

250 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
>::
™”©Ü
 
i
;

251 
	gi
 = 
low”_bound
(
pos™iÚs
.
begš
(),…os™iÚs.
’d
(), 
os
);

252 ià(
	gi
 =ğ
pos™iÚs
.
’d
(è|| *
i
 !ğ
os
) {

253 
throw
 
X­Ÿn
::
Inv®idArgum’tE¼Ü
("Pos™iÚ `" + 
om_to¡ršg
(
os
) +

255 
Šame
 +

259 
	gpos™iÚs
.
”a£
(
i
);

262 
¡ršg


263 
	gOmDocum’tT”m
::
	$g‘_desütiÚ
() const

265 
¡ršg
 
desütiÚ
;

267 
desütiÚ
 = "OmDocum’tT”m(" + 
Šame
 +

268 ", wdàğ" + 
	`om_to¡ršg
(
wdf
) +

269 ",…os™iÚs[" + 
	`om_to¡ršg
(
pos™iÚs
.
	`size
()) + "]" +

271  
desütiÚ
;

272 
	}
}

274 
¡ršg


275 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
g‘_v®ue
(
X­Ÿn
::
v®u’o
 
v®ueid
) const

277 ià(
v®ues_h”e
) {

278 
m­
<
X­Ÿn
::
v®u’o
, 
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
;

279 
	gi
 = 
v®ues
.
fšd
(
v®ueid
);

280 ià(
	gi
 =ğ
v®ues
.
’d
()è 
¡ršg
();

281  
	gi
->
	g£cÚd
;

283 ià(!
	gd©aba£
.
g‘
()è 
¡ršg
();

284  
do_g‘_v®ue
(
v®ueid
);

287 
¡ršg


288 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$g‘_d©a
() const

290 ià(
d©a_h”e
è 
d©a
;

291 ià(!
d©aba£
.
	`g‘
()è 
	`¡ršg
();

292  
	`do_g‘_d©a
();

293 
	}
}

296 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$£t_d©a
(cÚ¡ 
¡ršg
 &
d©a_
)

298 
	`DEBUGCALL
(
DB
, , "X­Ÿn::Docum’t::IÁ”Çl::£t_d©a", 
d©a_
);

299 
d©a
 = 
d©a_
;

300 
d©a_h”e
 = 
Œue
;

301 
	}
}

303 
T”mLi¡
 *

304 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$İ’_‹rm_li¡
() const

306 
	`DEBUGCALL
(
MATCH
, 
T”mLi¡
 *, "Document::Internal::open_term_list", "");

307 ià(
‹rms_h”e
) {

308 
	`RETURN
(
Ãw
 
	`M­T”mLi¡
(
‹rms
.
	`begš
(),”ms.
	`’d
()));

310 ià(!
d©aba£
.
	`g‘
()è
	`RETURN
(
NULL
);

311 
	`RETURN
(
d©aba£
->
	`İ’_‹rm_li¡
(
did
));

312 
	}
}

315 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
add_v®ue
(
X­Ÿn
::
v®u’o
 v®u’o, cÚ¡ 
¡ršg
 &
v®ue
)

317 
Ãed_v®ues
();

318 ià(!
	gv®ue
.
em±y
()) {

319 
	gv®ues
[
v®u’o
] = 
v®ue
;

323 
	gv®ues
.
”a£
(
v®u’o
);

328 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
»move_v®ue
(
X­Ÿn
::
v®u’o
 valueno)

330 
Ãed_v®ues
();

331 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	g¡ršg
>::
™”©Ü
 
i
 = 
v®ues
.
fšd
(valueno);

332 ià(
	gi
 =ğ
v®ues
.
’d
()) {

333 
throw
 
X­Ÿn
::
Inv®idArgum’tE¼Ü
("V®u#" + 
om_to¡ršg
(
v®u’o
) +

337 
	gv®ues
.
”a£
(
i
);

341 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$ş—r_v®ues
()

343 
v®ues
.
	`ş—r
();

344 
v®ues_h”e
 = 
Œue
;

345 
	}
}

348 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
add_po¡šg
(cÚ¡ 
¡ršg
 & 
Šame
, 
X­Ÿn
::
‹rmpos
 
os
,

349 
X­Ÿn
::
‹rmcouÁ
 
wdfšc
)

351 
Ãed_‹rms
();

353 
	gm­
<
	g¡ršg
, 
	gOmDocum’tT”m
>::
™”©Ü
 
i
;

354 
	gi
 = 
‹rms
.
fšd
(
Šame
);

355 ià(
	gi
 =ğ
‹rms
.
’d
()) {

356 
OmDocum’tT”m
 
Ãw‹rm
(
Šame
, 
wdfšc
);

357 
	gÃw‹rm
.
add_pos™iÚ
(
os
);

358 
	g‹rms
.
š£¹
(
make_·œ
(
Šame
, 
Ãw‹rm
));

360 
	gi
->
	g£cÚd
.
add_pos™iÚ
(
os
);

361 ià(
	gwdfšc
è
	gi
->
	g£cÚd
.
šc_wdf
(
wdfšc
);

366 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
add_‹rm
(cÚ¡ 
¡ršg
 & 
Šame
, 
X­Ÿn
::
‹rmcouÁ
 
wdfšc
)

368 
Ãed_‹rms
();

370 
	gm­
<
	g¡ršg
, 
	gOmDocum’tT”m
>::
™”©Ü
 
i
;

371 
	gi
 = 
‹rms
.
fšd
(
Šame
);

372 ià(
	gi
 =ğ
‹rms
.
’d
()) {

373 
OmDocum’tT”m
 
Ãw‹rm
(
Šame
, 
wdfšc
);

374 
	g‹rms
.
š£¹
(
make_·œ
(
Šame
, 
Ãw‹rm
));

376 ià(
	gwdfšc
è
	gi
->
	g£cÚd
.
šc_wdf
(
wdfšc
);

381 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
»move_po¡šg
(cÚ¡ 
¡ršg
 & 
Šame
,

382 
X­Ÿn
::
‹rmpos
 
os
,

383 
X­Ÿn
::
‹rmcouÁ
 
wdfdec
)

385 
Ãed_‹rms
();

387 
	gm­
<
	g¡ršg
, 
	gOmDocum’tT”m
>::
™”©Ü
 
i
;

388 
	gi
 = 
‹rms
.
fšd
(
Šame
);

389 ià(
	gi
 =ğ
‹rms
.
’d
()) {

390 
throw
 
X­Ÿn
::
Inv®idArgum’tE¼Ü
("T”m `" + 
Šame
 +

394 
	gi
->
	g£cÚd
.
»move_pos™iÚ
(
os
);

395 ià(
	gwdfdec
è
	gi
->
	g£cÚd
.
dec_wdf
(
wdfdec
);

399 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$»move_‹rm
(cÚ¡ 
¡ršg
 & 
Šame
)

401 
	`Ãed_‹rms
();

402 
m­
<
¡ršg
, 
OmDocum’tT”m
>::
™”©Ü
 
i
;

403 
i
 = 
‹rms
.
	`fšd
(
Šame
);

404 ià(
i
 =ğ
‹rms
.
	`’d
()) {

405 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("T”m `" + 
Šame
 +

409 
‹rms
.
	`”a£
(
i
);

410 
	}
}

413 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$ş—r_‹rms
()

415 
‹rms
.
	`ş—r
();

416 
‹rms_h”e
 = 
Œue
;

417 
	}
}

419 
	gX­Ÿn
::
‹rmcouÁ


420 
X­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$‹rmli¡_couÁ
() const

422 ià(!
‹rms_h”e
) {

425 
	`Ãed_‹rms
();

427 
	`As£¹
(
‹rms_h”e
);

428  
‹rms
.
	`size
();

429 
	}
}

432 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$Ãed_‹rms
() const

434 ià(
‹rms_h”e
) ;

435 ià(
d©aba£
.
	`g‘
()) {

436 
X­Ÿn
::
T”mI‹¿tÜ
 
	`t
(
d©aba£
->
	`İ’_‹rm_li¡
(
did
));

437 
X­Ÿn
::
T”mI‹¿tÜ
 
	`‹nd
(
NULL
);

438  ; 
t
 !ğ
‹nd
; ++t) {

439 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
p
 = 
t
.
	`pos™iÚli¡_begš
();

440 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
³nd
 = 
t
.
	`pos™iÚli¡_’d
();

441 
OmDocum’tT”m
 
	`‹rm
(*
t
,.
	`g‘_wdf
());

442  ; 
p
 !ğ
³nd
; ++p) {

443 
‹rm
.
	`add_pos™iÚ
(*
p
);

445 
‹rms
.
	`š£¹
(
	`make_·œ
(*
t
, 
‹rm
));

448 
‹rms_h”e
 = 
Œue
;

449 
	}
}

451 
	gX­Ÿn
::
v®u’o


452 
X­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$v®ues_couÁ
() const

454 
	`LOGLINE
(
API
, "Xapian::Document::Internal::values_count() called");

455 
	`Ãed_v®ues
();

456 
	`As£¹
(
v®ues_h”e
);

457  
v®ues
.
	`size
();

458 
	}
}

460 
¡ršg


461 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$g‘_desütiÚ
() const

463 
¡ršg
 
desütiÚ
 = "Xapian::Document::Internal(";

465 ià(
d©a_h”e
è
desütiÚ
 +ğ"d©a=`" + 
d©a
 + "'";

467 ià(
v®ues_h”e
) {

468 ià(
d©a_h”e
è
desütiÚ
 += ", ";

469 
desütiÚ
 +ğ"v®ues[" + 
	`om_to¡ršg
(
v®ues
.
	`size
()) + "]";

472 ià(
‹rms_h”e
) {

473 ià(
d©a_h”e
 || 
v®ues_h”e
è
desütiÚ
 += ", ";

474 
desütiÚ
 +ğ"‹rms[" + 
	`om_to¡ršg
(
‹rms
.
	`size
()) + "]";

477 ià(
d©aba£
.
	`g‘
()) {

478 ià(
d©a_h”e
 || 
v®ues_h”e
 || 
‹rms_h”e
è
desütiÚ
 += ", ";

479 
desütiÚ
 += "doc=";

480 
desütiÚ
 += "?";

483 
desütiÚ
 += ')';

485  
desütiÚ
;

486 
	}
}

489 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::
	$Ãed_v®ues
() const

491 ià(!
v®ues_h”e
) {

492 ià(
d©aba£
.
	`g‘
()) {

493 
	`As£¹
(
v®ues
.
	`em±y
());

494 
	`do_g‘_®l_v®ues
(
v®ues
);

496 
v®ues_h”e
 = 
Œue
;

498 
	}
}

500 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
::~
	$IÁ”Çl
()

502 ià(
d©aba£
.
	`g‘
())

503 
d©aba£
->
	`šv®id©e_doc_objeù
(
this
);

504 
	}
}

	@api/omenquire.cc

24 
	~<cÚfig.h
>

25 
	~"omdebug.h
"

27 
	~"x­Ÿn/docum’t.h
"

28 
	~"x­Ÿn/’quœe.h
"

29 
	~"x­Ÿn/”rÜ.h
"

30 
	~"x­Ÿn/”rÜhªdËr.h
"

31 
	~"x­Ÿn/ex·nddecid”.h
"

32 
	~"x­Ÿn/‹rm™”©Ü.h
"

33 
	~"x­Ÿn/weight.h
"

35 
	~"veùÜ‹rmli¡.h
"

37 
	~"d©aba£.h
"

38 
	~"e£tš‹º®.h
"

39 
	~"ex·ndweight.h
"

40 
	~"muÉim©ch.h
"

41 
	~"om’quœeš‹º®.h
"

42 
	~"r£t.h
"

43 
	~"uts.h
"

44 
	~"weightš‹º®.h
"

46 
	~<®gÜ™hm
>

47 
	~"autİŒ.h
"

48 
	~<cæßt
>

49 
	~<cm©h
>

50 
	~<veùÜ
>

52 
usšg
 
Çme¥aû
 
	g¡d
;

54 
usšg
 
	gX­Ÿn
::
IÁ”Çl
::
Ex·ndWeight
;

56 
Çme¥aû
 
	gX­Ÿn
 {

58 
	gM©chDecid”
::~
M©chDecid”
() { }

62 
RS‘
::RS‘(è: 
š‹º®
(
Ãw
 RS‘::
IÁ”Çl
)

66 
RS‘
::RS‘(cÚ¡ RS‘ &
Ùh”
è: 
š‹º®
(other.internal)

71 
RS‘
::
İ”©Ü
=(cÚ¡ RS‘ &
Ùh”
)

73 
š‹º®
 = 
Ùh”
.internal;

76 
	gRS‘
::~
RS‘
()

80 
X­Ÿn
::
doccouÁ


81 
RS‘
::
size
() const

83  
š‹º®
->
™ems
.
size
();

86 
boŞ


87 
	gRS‘
::
em±y
() const

89  
š‹º®
->
™ems
.
em±y
();

93 
	gRS‘
::
add_docum’t
(
X­Ÿn
::
docid
 
did
)

95 ià(
did
 =ğ0è
throw
 
X­Ÿn
::
Inv®idArgum’tE¼Ü
("Docid 0‚ot valid");

96 
	gš‹º®
->
	g™ems
.
š£¹
(
did
);

100 
	gRS‘
::
»move_docum’t
(
X­Ÿn
::
docid
 
did
)

102 
š‹º®
->
™ems
.
”a£
(
did
);

105 
boŞ


106 
	gRS‘
::
cÚšs
(
X­Ÿn
::
docid
 
did
) const

108  
š‹º®
->
™ems
.
fšd
(
did
è!ğš‹º®->™ems.
’d
();

111 
¡ršg


112 
	gRS‘
::
g‘_desütiÚ
() const

114  "RS‘(" + 
š‹º®
->
g‘_desütiÚ
() + ")";

117 
¡ršg


118 
	gRS‘
::
IÁ”Çl
::
g‘_desütiÚ
() const

120 
¡ršg
 
desütiÚ
("RSet::Internal(");

122 
	g£t
<
	gX­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
i
;

123 
	gi
 = 
™ems
.
begš
(); i !ğ™ems.
’d
(); ++i) {

124 ià(
	gi
 !ğ
™ems
.
begš
()è
desütiÚ
 += ", ";

125 
	gdesütiÚ
 +ğ
om_to¡ršg
(*
i
);

128 
	gdesütiÚ
 += ')';

130  
	gdesütiÚ
;

133 
Çme¥aû
 
	gIÁ”Çl
 {

137 
¡ršg


138 
	gMS‘I‹m
::
g‘_desütiÚ
() const

140 
¡ršg
 
desütiÚ
;

142 
	gdesütiÚ
 = 
om_to¡ršg
(
did
è+ ", " + om_to¡ršg(
wt
) + ", " +

143 
cŞÏp£_key
;

145 
	gdesütiÚ
 = "X­Ÿn::MS‘I‹m(" + 
desütiÚ
 + ")";

147  
	gdesütiÚ
;

154 
	gMS‘
::
MS‘
(è: 
š‹º®
(
Ãw
 MS‘::
IÁ”Çl
)

158 
MS‘
::MS‘(MS‘::
IÁ”Çl
 * 
š‹º®_
è: 
š‹º®
(internal_)

162 
MS‘
::~MSet()

166 
MS‘
::MS‘(cÚ¡ MS‘ & 
Ùh”
è: 
š‹º®
(other.internal)

171 
MS‘
::
İ”©Ü
=(cÚ¡ MS‘ &
Ùh”
)

173 
š‹º®
 = 
Ùh”
.internal;

177 
	gMS‘
::
ãtch
(cÚ¡ 
MS‘I‹¿tÜ
 & 
begš™”
, cÚ¡ MS‘I‹¿tÜ & 
’d™”
) const

179 
DEBUGAPICALL
(, "X­Ÿn::MS‘::ãtch", 
begš™”
 << ", " << 
’d™”
);

180 
As£¹
(
š‹º®
.
g‘
() != 0);

181 ià(
	gbegš™”
 !ğ
’d™”
)

182 
š‹º®
->
ãtch_™ems
(
begš™”
.
šdex
, 
’d™”
.index - 1);

186 
	gMS‘
::
ãtch
(cÚ¡ 
MS‘I‹¿tÜ
 & 
begš™”
) const

188 
DEBUGAPICALL
(, "X­Ÿn::MS‘::ãtch", 
begš™”
);

189 
As£¹
(
š‹º®
.
g‘
() != 0);

190 
	gš‹º®
->
ãtch_™ems
(
begš™”
.
šdex
, beginiter.index);

194 
	gMS‘
::
ãtch
() const

196 
DEBUGAPICALL
(, "Xapian::MSet::fetch", "");

197 
As£¹
(
š‹º®
.
g‘
() != 0);

198 ià(!
	gš‹º®
->
	g™ems
.
em±y
())

199 
	gš‹º®
->
ãtch_™ems
(0, 
š‹º®
->
™ems
.
size
() - 1);

202 
³rûÁ


203 
	gMS‘
::
cÚv”t_to_³rûÁ
(
X­Ÿn
::
weight
 
wt
) const

205 
DEBUGAPICALL
(
X­Ÿn
::
³rûÁ
, "X­Ÿn::MS‘::cÚv”t_to_³rûÁ", 
wt
);

206 
As£¹
(
š‹º®
.
g‘
() != 0);

207 
RETURN
(
š‹º®
->
cÚv”t_to_³rûÁ_š‹º®
(
wt
));

210 
³rûÁ


211 
	gMS‘
::
cÚv”t_to_³rûÁ
(cÚ¡ 
MS‘I‹¿tÜ
 & 
™
) const

213 
DEBUGAPICALL
(
X­Ÿn
::
³rûÁ
, "X­Ÿn::MS‘::cÚv”t_to_³rûÁ", 
™
);

214 
As£¹
(
š‹º®
.
g‘
() != 0);

215 
RETURN
(
š‹º®
->
cÚv”t_to_³rûÁ_š‹º®
(
™
.
g‘_weight
()));

218 
	gX­Ÿn
::
doccouÁ


219 
MS‘
::
g‘_‹rmäeq
(cÚ¡ 
¡ršg
 &
Šame
) const

221 
DEBUGAPICALL
(
X­Ÿn
::
doccouÁ
, "X­Ÿn::MS‘::g‘_‹rmäeq", 
Šame
);

222 
	gm­
<
	g¡ršg
, 
	gIÁ”Çl
::
T”mF»qAndWeight
>::
cÚ¡_™”©Ü
 
i
;

223 
As£¹
(
š‹º®
.
g‘
() != 0);

224 
	gi
 = 
š‹º®
->
‹rmäeqªdwts
.
fšd
(
Šame
);

225 ià(
	gi
 !ğ
š‹º®
->
‹rmäeqªdwts
.
’d
()) {

226 
RETURN
(
i
->
£cÚd
.
‹rmäeq
);

228 ià(
	gš‹º®
->
	g’quœe
.
g‘
() == 0) {

229 
throw
 
Inv®idO³¿tiÚE¼Ü
("Can't getermfreq from‡n MSet which is‚ot derived from‡ query.");

231 
RETURN
(
š‹º®
->
’quœe
->
g‘_‹rmäeq
(
Šame
));

234 
	gX­Ÿn
::
weight


235 
MS‘
::
g‘_‹rmweight
(cÚ¡ 
¡ršg
 &
Šame
) const

237 
DEBUGAPICALL
(
X­Ÿn
::
weight
, "X­Ÿn::MS‘::g‘_‹rmweight", 
Šame
);

238 
	gm­
<
	g¡ršg
, 
	gIÁ”Çl
::
T”mF»qAndWeight
>::
cÚ¡_™”©Ü
 
i
;

239 
As£¹
(
š‹º®
.
g‘
() != 0);

240 
	gi
 = 
š‹º®
->
‹rmäeqªdwts
.
fšd
(
Šame
);

241 ià(
	gi
 =ğ
š‹º®
->
‹rmäeqªdwts
.
’d
()) {

242 
throw
 
Inv®idArgum’tE¼Ü
("T”m weighˆoà`" + 
Šame
 +

245 
RETURN
(
i
->
£cÚd
.
‹rmweight
);

248 
	gX­Ÿn
::
doccouÁ


249 
MS‘
::
g‘_fœ¡™em
() const

251 
As£¹
(
š‹º®
.
g‘
() != 0);

252  
	gš‹º®
->
	gfœ¡™em
;

255 
	gX­Ÿn
::
doccouÁ


256 
MS‘
::
g‘_m©ches_low”_bound
() const

258 
As£¹
(
š‹º®
.
g‘
() != 0);

259  
	gš‹º®
->
	gm©ches_low”_bound
;

262 
	gX­Ÿn
::
doccouÁ


263 
MS‘
::
g‘_m©ches_e¡im©ed
() const

265 
As£¹
(
š‹º®
.
g‘
() != 0);

266  
	gš‹º®
->
	gm©ches_e¡im©ed
;

269 
	gX­Ÿn
::
doccouÁ


270 
MS‘
::
g‘_m©ches_uµ”_bound
() const

272 
As£¹
(
š‹º®
.
g‘
() != 0);

273  
	gš‹º®
->
	gm©ches_uµ”_bound
;

276 
	gX­Ÿn
::
doccouÁ


277 
MS‘
::
g‘_uncŞÏp£d_m©ches_low”_bound
() const

279 
As£¹
(
š‹º®
.
g‘
() != 0);

280  
	gš‹º®
->
	guncŞÏp£d_low”_bound
;

283 
	gX­Ÿn
::
doccouÁ


284 
MS‘
::
g‘_uncŞÏp£d_m©ches_e¡im©ed
() const

286 
As£¹
(
š‹º®
.
g‘
() != 0);

287  
	gš‹º®
->
	guncŞÏp£d_e¡im©ed
;

290 
	gX­Ÿn
::
doccouÁ


291 
MS‘
::
g‘_uncŞÏp£d_m©ches_uµ”_bound
() const

293 
As£¹
(
š‹º®
.
g‘
() != 0);

294  
	gš‹º®
->
	guncŞÏp£d_uµ”_bound
;

297 
	gX­Ÿn
::
weight


298 
MS‘
::
g‘_max_possibË
() const

300 
As£¹
(
š‹º®
.
g‘
() != 0);

301  
	gš‹º®
->
	gmax_possibË
;

304 
	gX­Ÿn
::
weight


305 
MS‘
::
g‘_max_©šed
() const

307 
As£¹
(
š‹º®
.
g‘
() != 0);

308  
	gš‹º®
->
	gmax_©šed
;

311 
	gX­Ÿn
::
doccouÁ


312 
MS‘
::
size
() const

314 
As£¹
(
š‹º®
.
g‘
() != 0);

315  
	gš‹º®
->
	g™ems
.
size
();

318 
boŞ


319 
	gMS‘
::
em±y
() const

321 
As£¹
(
š‹º®
.
g‘
() != 0);

322  
	gš‹º®
->
	g™ems
.
em±y
();

326 
	gMS‘
::
sw­
(
MS‘
 & 
Ùh”
)

328 
¡d
::
sw­
(
š‹º®
, 
Ùh”
.internal);

331 
MS‘I‹¿tÜ


332 
	gMS‘
::
begš
() const

334  
MS‘I‹¿tÜ
(0, *
this
);

337 
MS‘I‹¿tÜ


338 
	gMS‘
::
’d
() const

340 
As£¹
(
š‹º®
.
g‘
() != 0);

341  
MS‘I‹¿tÜ
(
š‹º®
->
™ems
.
size
(), *
this
);

344 
MS‘I‹¿tÜ


345 
	gMS‘
::
İ”©Ü
[](
X­Ÿn
::
doccouÁ
 
i
) const

348 
As£¹
(0 < (
i
 + 1è&& i < 
size
());

349  
MS‘I‹¿tÜ
(
i
, *
this
);

352 
MS‘I‹¿tÜ


353 
	gMS‘
::
back
() const

355 
As£¹
(!
em±y
());

356 
As£¹
(
š‹º®
.
g‘
() != 0);

357  
MS‘I‹¿tÜ
(
š‹º®
->
™ems
.
size
(è- 1, *
this
);

360 
¡ršg


361 
	gMS‘
::
g‘_desütiÚ
() const

363 
As£¹
(
š‹º®
.
g‘
() != 0);

364  "X­Ÿn::MS‘(" + 
	gš‹º®
->
g‘_desütiÚ
() + ")";

367 
³rûÁ


368 
	gMS‘
::
IÁ”Çl
::
cÚv”t_to_³rûÁ_š‹º®
(
X­Ÿn
::
weight
 
wt
) const

370 
DEBUGAPICALL
(
X­Ÿn
::
³rûÁ
, "X­Ÿn::MS‘::IÁ”Çl::cÚv”t_to_³rûÁ_š‹º®", 
wt
);

371 ià(
	g³rûÁ_çùÜ
 =ğ0è
RETURN
(100);

374 
	gv
 = 
wt
 * 
³rûÁ_çùÜ
 + 100.0 * 
DBL_EPSILON
;

375 
	gX­Ÿn
::
³rûÁ
 
pûÁ
 = 
¡©ic_ÿ¡
<
X­Ÿn
::³rûÁ>(
v
);

376 
LOGLINE
(
API
, "wˆğ" << 
wt
 << ", max_possibË = " << 
max_possibË
 <<

377 " =>…ûÁ = " << 
pûÁ
);

378 ià(
	gpûÁ
 > 100)…cent = 100;

379 ià(
	gpûÁ
 < 0)…cent = 0;

380 ià(
	gpûÁ
 =ğ0 && 
wt
 > 0è
pûÁ
 = 1;

382 
RETURN
(
pûÁ
);

385 
Docum’t


386 
	gMS‘
::
IÁ”Çl
::
g‘_doc_by_šdex
(
X­Ÿn
::
doccouÁ
 
šdex
) const

388 
DEBUGCALL
(
API
, 
Docum’t
, "Xapian::MSet::Internal::Data::get_doc_by_index",

389 
šdex
);

390 
	gšdex
 +ğ
fœ¡™em
;

391 
	gm­
<
	gX­Ÿn
::
doccouÁ
, 
	gDocum’t
>::
cÚ¡_™”©Ü
 
doc
;

392 
	gdoc
 = 
šdexeddocs
.
fšd
(
šdex
);

393 ià(
	gdoc
 !ğ
šdexeddocs
.
’d
()) {

394 
RETURN
(
doc
->
£cÚd
);

396 ià(
	gšdex
 < 
	gfœ¡™em
 || index >ğ
fœ¡™em
 + 
™ems
.
size
()) {

397 
throw
 
RªgeE¼Ü
("Thm£ˆ»tuºed fromhm©ch dÛ nÙ cÚšhdocum’ˆ© index " + 
om_to¡ršg
(
šdex
));

399 
ãtch_™ems
(
šdex
, index);

401 
»ad_docs
();

402 
As£¹
(
šdexeddocs
.
fšd
(
šdex
è!ğšdexeddocs.
’d
());

403 
As£¹
(
šdexeddocs
.
fšd
(
šdex
)->
fœ¡
 == index);

404 
RETURN
(
šdexeddocs
.
fšd
(
šdex
)->
£cÚd
);

408 
	gMS‘
::
IÁ”Çl
::
ãtch_™ems
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
Ï¡
) const

410 
DEBUGAPICALL
(, "Xapian::MSet::Internal::Data::fetch_items",

411 
fœ¡
 << ", " << 
Ï¡
);

412 ià(
	g’quœe
.
g‘
() == 0) {

413 
throw
 
Inv®idO³¿tiÚE¼Ü
("Can't fetch documents from‡n MSet which is‚ot derived from‡ query.");

415 
	gX­Ÿn
::
doccouÁ
 
i
 = 
fœ¡
; 
	gi
 <ğ
Ï¡
; ++i) {

416 
	gm­
<
	gX­Ÿn
::
doccouÁ
, 
	gDocum’t
>::
cÚ¡_™”©Ü
 
doc
;

417 
	gdoc
 = 
šdexeddocs
.
fšd
(
i
);

418 ià(
	gdoc
 =ğ
šdexeddocs
.
’d
()) {

420 
£t
<
X­Ÿn
::
doccouÁ
>::
cÚ¡_™”©Ü
 
s
;

421 
	gs
 = 
»que¡ed_docs
.
fšd
(
i
);

422 ià(
	gs
 =ğ
»que¡ed_docs
.
’d
()) {

424 
’quœe
->
»que¡_doc
(
™ems
[
i
 - 
fœ¡™em
]);

425 
	g»que¡ed_docs
.
š£¹
(
i
);

431 
¡ršg


432 
	gMS‘
::
IÁ”Çl
::
g‘_desütiÚ
() const

434 
¡ršg
 
desütiÚ
 = "Xapian::MSet::Internal(";

436 
	gdesütiÚ
 +ğ"fœ¡™em=" + 
om_to¡ršg
(
fœ¡™em
) + ", " +

437 "m©ches_low”_bound=" + 
om_to¡ršg
(
m©ches_low”_bound
) + ", " +

438 "m©ches_e¡im©ed=" + 
om_to¡ršg
(
m©ches_e¡im©ed
) + ", " +

439 "m©ches_uµ”_bound=" + 
om_to¡ršg
(
m©ches_uµ”_bound
) + ", " +

440 "max_possibË=" + 
om_to¡ršg
(
max_possibË
) + ", " +

441 "max_©šed=" + 
om_to¡ršg
(
max_©šed
);

443 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
cÚ¡_™”©Ü
 
i
 = 
™ems
.
begš
();

444 
	gi
 !ğ
™ems
.
’d
(); ++i) {

445 ià(!
	gdesütiÚ
.
em±y
()) description += ", ";

446 
	gdesütiÚ
 +ğ
i
->
g‘_desütiÚ
();

449 
	gdesütiÚ
 += ")";

451  
	gdesütiÚ
;

455 
	gMS‘
::
IÁ”Çl
::
»ad_docs
() const

457 
£t
<
X­Ÿn
::
doccouÁ
>::
cÚ¡_™”©Ü
 
i
;

458 
	gi
 = 
»que¡ed_docs
.
begš
(); i !ğ»que¡ed_docs.
’d
(); ++i) {

459 
	gšdexeddocs
[*
i
] = 
’quœe
->
»ad_doc
(
™ems
[*˜- 
fœ¡™em
]);

460 
LOGLINE
(
API
, "¡Üed doø© index " << *
i
 << " i " << 
šdexeddocs
[*i]);

463 
	g»que¡ed_docs
.
ş—r
();

468 
	gES‘
::
ES‘
(è: 
š‹º®
(
Ãw
 
IÁ”Çl
) { }

470 
ES‘
::~ESet()

474 
ES‘
::ES‘(cÚ¡ ES‘ & 
Ùh”
è: 
š‹º®
(other.internal)

479 
ES‘
::
İ”©Ü
=(cÚ¡ ES‘ &
Ùh”
)

481 
š‹º®
 = 
Ùh”
.internal;

484 
	gX­Ÿn
::
‹rmcouÁ


485 
ES‘
::
g‘_ebound
() const

487  
š‹º®
->
ebound
;

490 
	gX­Ÿn
::
‹rmcouÁ


491 
ES‘
::
size
() const

493  
š‹º®
->
™ems
.
size
();

496 
boŞ


497 
	gES‘
::
em±y
() const

499  
š‹º®
->
™ems
.
em±y
();

503 
	gES‘
::
sw­
(
ES‘
 & 
Ùh”
)

505 
¡d
::
sw­
(
š‹º®
, 
Ùh”
.internal);

508 
ES‘I‹¿tÜ


509 
	gES‘
::
begš
() const

511  
ES‘I‹¿tÜ
(0, *
this
);

514 
ES‘I‹¿tÜ


515 
	gES‘
::
’d
() const

517 
As£¹
(
š‹º®
.
g‘
() != 0);

518  
ES‘I‹¿tÜ
(
š‹º®
->
™ems
.
size
(), *
this
);

521 
ES‘I‹¿tÜ


522 
	gES‘
::
İ”©Ü
[](
X­Ÿn
::
‹rmcouÁ
 
i
) const

525 
As£¹
(0 < (
i
 + 1è&& i < 
size
());

526  
ES‘I‹¿tÜ
(
i
, *
this
);

529 
ES‘I‹¿tÜ


530 
	gES‘
::
back
() const

532 
As£¹
(!
em±y
());

533 
As£¹
(
š‹º®
.
g‘
() != 0);

534  
ES‘I‹¿tÜ
(
š‹º®
->
™ems
.
size
(è- 1, *
this
);

537 
¡ršg


538 
	gES‘
::
g‘_desütiÚ
() const

540 
As£¹
(
š‹º®
.
g‘
() != 0);

541  "X­Ÿn::ES‘(" + 
	gš‹º®
->
g‘_desütiÚ
() + ")";

546 cÚ¡ 
	g¡ršg
 &

547 
	gES‘I‹¿tÜ
::
İ”©Ü
 *() const

549  
e£t
.
š‹º®
->
™ems
[
šdex
].
‹rm
;

552 
	gX­Ÿn
::
weight


553 
ES‘I‹¿tÜ
::
g‘_weight
() const

555  
e£t
.
š‹º®
->
™ems
[
šdex
].
wt
;

558 
¡ršg


559 
	gES‘I‹¿tÜ
::
g‘_desütiÚ
() const

561  "X­Ÿn::ES‘I‹¿tÜ(" + 
om_to¡ršg
(
šdex
) + ")";

566 
	gX­Ÿn
::
docid


567 
MS‘I‹¿tÜ
::
İ”©Ü
 *() const

569  
m£t
.
š‹º®
->
™ems
[
šdex
].
did
;

572 
Docum’t


573 
	gMS‘I‹¿tÜ
::
g‘_docum’t
() const

575  
m£t
.
š‹º®
->
g‘_doc_by_šdex
(
šdex
);

578 
	gX­Ÿn
::
weight


579 
MS‘I‹¿tÜ
::
g‘_weight
() const

581  
m£t
.
š‹º®
->
™ems
[
šdex
].
wt
;

584 
	g¡d
::
¡ršg


585 
MS‘I‹¿tÜ
::
g‘_cŞÏp£_key
() const

587  
m£t
.
š‹º®
->
™ems
[
šdex
].
cŞÏp£_key
;

590 
	gX­Ÿn
::
doccouÁ


591 
MS‘I‹¿tÜ
::
g‘_cŞÏp£_couÁ
() const

593  
m£t
.
š‹º®
->
™ems
[
šdex
].
cŞÏp£_couÁ
;

596 
	gX­Ÿn
::
³rûÁ


597 
MS‘I‹¿tÜ
::
g‘_³rûÁ
() const

599 
DEBUGAPICALL
(
X­Ÿn
::
³rûÁ
, "MSetIterator::get_percent", "");

600 
RETURN
(
m£t
.
š‹º®
->
cÚv”t_to_³rûÁ_š‹º®
(
g‘_weight
()));

603 
¡ršg


604 
	gMS‘I‹¿tÜ
::
g‘_desütiÚ
() const

606  "X­Ÿn::MS‘I‹¿tÜ(" + 
om_to¡ršg
(
šdex
) + ")";

611 
	gEnquœe
::
IÁ”Çl
::IÁ”Çl(cÚ¡ 
D©aba£
 &
db_
, 
E¼ÜHªdËr
 * 
”rÜhªdËr_
)

612 : 
db
(
db_
), 
qu”y
(), 
cŞÏp£_key
(
X­Ÿn
::
BAD_VALUENO
), 
cŞÏp£_max
(0),

613 
Üd”
(
Enquœe
::
ASCENDING
), 
³rûÁ_cutoff
(0), 
weight_cutoff
(0),

614 
sÜt_key
(
X­Ÿn
::
BAD_VALUENO
), 
sÜt_by
(
REL
), 
sÜt_v®ue_fÜw¬d
(
Œue
),

615 
sÜ‹r
(0), 
”rÜhªdËr
(
”rÜhªdËr_
), 
weight
(0)

617 ià(
	gdb
.
	gš‹º®
.
em±y
()) {

618 
throw
 
Inv®idArgum’tE¼Ü
("Can't make‡n Enquire object from‡n uninitialised Database object.");

622 
	gEnquœe
::
IÁ”Çl
::~Internal()

624 
d–‘e
 
weight
;

625 
	gweight
 = 0;

629 
	gEnquœe
::
IÁ”Çl
::
£t_qu”y
(cÚ¡ 
Qu”y
 &
qu”y_
, 
‹rmcouÁ
 
qËn_
)

631 
	gqu”y
 = 
qu”y_
;

632 
	gqËn
 = 
qËn_
 ? qËn_ : 
qu”y
.
g‘_Ëngth
();

635 cÚ¡ 
	gQu”y
 &

636 
	gEnquœe
::
IÁ”Çl
::
g‘_qu”y
()

638  
qu”y
;

641 
MS‘


642 
	gEnquœe
::
IÁ”Çl
::
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
max™ems
,

643 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
, cÚ¡ 
RS‘
 *
r£t
,

644 cÚ¡ 
M©chDecid”
 *
mdecid”
,

645 cÚ¡ 
M©chDecid”
 *
m©ch¥y_Ëgacy
) const

647 
DEBUGCALL
(
API
, 
MS‘
, "Enquœe::IÁ”Çl::g‘_m£t", 
fœ¡
 << ", " <<

648 
max™ems
 << ", " << 
check_©_Ëa¡
 << ", " << 
r£t
 << ", " <<

649 
mdecid”
 << ", " << 
m©ch¥y_Ëgacy
);

651 ià(
	g³rûÁ_cutoff
 && (
	gsÜt_by
 =ğ
VAL
 || 
sÜt_by
 =ğ
VAL_REL
)) {

652 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("Use of‡…ercentage cutoff while sorting…rimary by value isn't currently supported");

655 ià(
	gweight
 == 0) {

656 
weight
 = 
Ãw
 
BM25Weight
;

659 
	gX­Ÿn
::
Weight
::
IÁ”Çl
 
¡©s
;

660 ::
MuÉiM©ch
 
m©ch
(
db
, 
qu”y
.
š‹º®
.
g‘
(), 
qËn
, 
r£t
,

661 
cŞÏp£_max
, 
cŞÏp£_key
,

662 
³rûÁ_cutoff
, 
weight_cutoff
,

663 
Üd”
, 
sÜt_key
, 
sÜt_by
, 
sÜt_v®ue_fÜw¬d
,

664 
”rÜhªdËr
, 
¡©s
, 
weight
, 
¥›s
,

665 (
sÜ‹r
 !ğ
NULL
),

666 (
mdecid”
 !ğ
NULL
 || 
m©ch¥y_Ëgacy
 != NULL));

668 
MS‘
 
	g»tv®
;

669 
	gm©ch
.
g‘_m£t
(
fœ¡
, 
max™ems
, 
check_©_Ëa¡
, 
»tv®
,

670 
¡©s
, 
mdecid”
, 
m©ch¥y_Ëgacy
, 
sÜ‹r
);

672 
As£¹
(
weight
->
Çme
(è!ğ"boŞ" || 
»tv®
.
g‘_max_possibË
() == 0);

678 
	g»tv®
.
	gš‹º®
->
	g’quœe
 = 
this
;

680  
	g»tv®
;

683 
ES‘


684 
	gEnquœe
::
IÁ”Çl
::
g‘_e£t
(
X­Ÿn
::
‹rmcouÁ
 
max™ems
,

685 cÚ¡ 
RS‘
 & 
r£t
, 
æags
, 
k
,

686 cÚ¡ 
Ex·ndDecid”
 * 
edecid”
) const

688 
DEBUGCALL
(
API
, 
ES‘
, "Enquire::Internal::get_eset",

689 
max™ems
 << ", " << 
r£t
 << ", " << 
æags
 << ", " <<

690 
k
 << ", " << 
edecid”
);

692 ià(
	gmax™ems
 =ğ0 || 
r£t
.
em±y
()) {

695 
RETURN
(
ES‘
());

698 
RS‘I
 
r£ti
(
db
, 
r£t
);

700 
LOGVALUE
(
API
, 
r£t
.
size
());

705 
	gAutoPŒ
<
	gEx·ndDecid”
> 
	gdecid”_noqu”y
;

706 
	gAutoPŒ
<
	gEx·ndDecid”
> 
	gdecid”_ªdnoqu”y
;

708 ià(!
	gqu”y
.
em±y
(è&& !(
	gæags
 & 
	gEnquœe
::
INCLUDE_QUERY_TERMS
)) {

709 
AutoPŒ
<
Ex·ndDecid”
> 
‹mp1
(

710 
Ãw
 
Ex·ndDecid”F‹rT”ms
(
qu”y
.
g‘_‹rms_begš
(),

711 
qu”y
.
g‘_‹rms_’d
()));

712 
	gdecid”_noqu”y
 = 
‹mp1
;

714 ià(
	gedecid”
) {

715 
	gAutoPŒ
<
	gEx·ndDecid”
> 
‹mp2
(

716 
Ãw
 
Ex·ndDecid”And
(
decid”_noqu”y
.
g‘
(), 
edecid”
));

717 
	gdecid”_ªdnoqu”y
 = 
‹mp2
;

718 
	gedecid”
 = 
decid”_ªdnoqu”y
.
g‘
();

720 
	gedecid”
 = 
decid”_noqu”y
.
g‘
();

724 
boŞ
 
u£_exaù_‹rmäeq
(
æags
 & 
Enquœe
::
USE_EXACT_TERMFREQ
);

725 
Ex·ndWeight
 
eweight
(
db
, 
r£ti
.
size
(), 
u£_exaù_‹rmäeq
, 
k
);

727 
	gX­Ÿn
::
ES‘
 
e£t
;

728 
	ge£t
.
	gš‹º®
->
ex·nd
(
max™ems
, 
db
, 
r£ti
, 
edecid”
, 
eweight
);

729 
RETURN
(
e£t
);

732 şas 
	cByQu”yIndexCmp
 {

733 
	g´iv©e
:

734 
m­
<
	t¡ršg
, > 
	ttm­_t
;

735 cÚ¡ 
	gtm­_t
 &
	gtm­
;

736 
	gpublic
:

737 
ByQu”yIndexCmp
(cÚ¡ 
tm­_t
 &
tm­_
è: 
tm­
(tmap_) {}

738 
boŞ
 
İ”©Ü
()(cÚ¡ 
¡ršg
 &
Ëá
,

739 cÚ¡ 
	g¡ršg
 &
	gright
) const {

740 
	gtm­_t
::
cÚ¡_™”©Ü
 
l
, 
	gr
;

741 
	gl
 = 
tm­
.
fšd
(
Ëá
);

742 
	gr
 = 
tm­
.
fšd
(
right
);

743 
As£¹
((
l
 !ğ
tm­
.
’d
()è&& (
r
 !=map.end()));

745  
	gl
->
	g£cÚd
 < 
	gr
->second;

749 
T”mI‹¿tÜ


750 
	gEnquœe
::
IÁ”Çl
::
g‘_m©chšg_‹rms
(
X­Ÿn
::
docid
 
did
) const

752 ià(
qu”y
.
em±y
())

753 
throw
 
X­Ÿn
::
Inv®idArgum’tE¼Ü
("get_matching_terms withƒmpty query");

757 
T”mI‹¿tÜ
 
	gqt
 = 
qu”y
.
g‘_‹rms_begš
();

758 
T”mI‹¿tÜ
 
	gqt_’d
 = 
qu”y
.
g‘_‹rms_’d
();

763 
	gm­
<
	g¡ršg
, > 
	gtm­
;

764 
	gšdex
 = 1;

765  ; 
	gqt
 !ğ
qt_’d
; ++qt) {

766 ià(
	gtm­
.
fšd
(*
qt
è=ğ
tm­
.
’d
())

767 
tm­
[*
qt
] = 
šdex
++;

770 
	gveùÜ
<
	g¡ršg
> 
	gm©chšg_‹rms
;

772 
T”mI‹¿tÜ
 
	gdoù”ms
 = 
db
.
‹rmli¡_begš
(
did
);

773 
T”mI‹¿tÜ
 
	gdoù”ms_’d
 = 
db
.
‹rmli¡_’d
(
did
);

774 
	gdoù”ms
 !ğ
doù”ms_’d
) {

775 
¡ršg
 
‹rm
 = *
doù”ms
;

776 
	gm­
<
	g¡ršg
, >::
™”©Ü
 
t
 = 
tm­
.
fšd
(
‹rm
);

777 ià(
	gt
 !ğ
tm­
.
’d
()è
m©chšg_‹rms
.
push_back
(
‹rm
);

778 
	gdoù”ms
++;

782 
sÜt
(
m©chšg_‹rms
.
begš
(), m©chšg_‹rms.
’d
(), 
ByQu”yIndexCmp
(
tm­
));

784  
T”mI‹¿tÜ
(
Ãw
 
VeùÜT”mLi¡
(
m©chšg_‹rms
.
begš
(),

785 
m©chšg_‹rms
.
’d
()));

788 
T”mI‹¿tÜ


789 
	gEnquœe
::
IÁ”Çl
::
	$g‘_m©chšg_‹rms
(cÚ¡ 
MS‘I‹¿tÜ
 &
™
) const

793  
	`g‘_m©chšg_‹rms
(*
™
);

794 
	}
}

796 
	gX­Ÿn
::
doccouÁ


797 
Enquœe
::
IÁ”Çl
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 &
Šame
) const

799  
db
.
	`g‘_‹rmäeq
(
Šame
);

800 
	}
}

802 
¡ršg


803 
	gEnquœe
::
IÁ”Çl
::
	$g‘_desütiÚ
() const

805 
¡ršg
 
desütiÚ
 = 
db
.
	`g‘_desütiÚ
();

806 
desütiÚ
 += ", ";

807 
desütiÚ
 +ğ
qu”y
.
	`g‘_desütiÚ
();

808  
desütiÚ
;

809 
	}
}

814 
	gEnquœe
::
IÁ”Çl
::
»que¡_doc
(cÚ¡ 
X­Ÿn
::IÁ”Çl::
MS‘I‹m
 &
™em
) const

816 
Œy
 {

817 
muÉl›r
 = 
db
.
š‹º®
.
size
();

819 
	gX­Ÿn
::
docid
 
»®did
 = (
™em
.
did
 - 1è/ 
muÉl›r
 + 1;

820 
	gX­Ÿn
::
doccouÁ
 
dbnumb”
 = (
™em
.
did
 - 1è% 
muÉl›r
;

822 
	gdb
.
	gš‹º®
[
dbnumb”
]->
»que¡_docum’t
(
»®did
);

823 } 
ÿtch
 (
E¼Ü
 & 
e
) {

824 ià(
	g”rÜhªdËr
è(*”rÜhªdËr)(
	ge
);

825 
	gthrow
;

829 
Docum’t


830 
	gEnquœe
::
IÁ”Çl
::
»ad_doc
(cÚ¡ 
X­Ÿn
::IÁ”Çl::
MS‘I‹m
 &
™em
) const

832 
Œy
 {

833 
muÉl›r
 = 
db
.
š‹º®
.
size
();

835 
	gX­Ÿn
::
docid
 
»®did
 = (
™em
.
did
 - 1è/ 
muÉl›r
 + 1;

836 
	gX­Ÿn
::
doccouÁ
 
dbnumb”
 = (
™em
.
did
 - 1è% 
muÉl›r
;

838 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *
doc
;

839 
	gdoc
 = 
db
.
š‹º®
[
dbnumb”
]->
cŞËù_docum’t
(
»®did
);

840  
Docum’t
(
doc
);

841 } 
ÿtch
 (
E¼Ü
 & 
e
) {

842 ià(
	g”rÜhªdËr
è(*”rÜhªdËr)(
	ge
);

843 
	gthrow
;

848 
	gEnquœe
::
IÁ”Çl
::
	$»gi¡”_m©ch_decid”
(cÚ¡ 
¡ršg
 &,

849 cÚ¡ 
M©chDecid”
 *)

851 
	}
}

855 
	gEnquœe
::
	$Enquœe
(cÚ¡ 
Enquœe
 & 
Ùh”
è: 
	$š‹º®
(
Ùh”
.
š‹º®
)

857 
	`DEBUGAPICALL
(, "X­Ÿn::Enquœe::Enquœe", 
Ùh”
);

858 
	}
}

861 
	gEnquœe
::
İ”©Ü
=(cÚ¡ 
Enquœe
 & 
Ùh”
)

863 
DEBUGAPICALL
(, "X­Ÿn::Enquœe::İ”©Ü=", 
Ùh”
);

864 
	gš‹º®
 = 
Ùh”
.
š‹º®
;

867 
	gEnquœe
::
	$Enquœe
(cÚ¡ 
D©aba£
 &
d©aba£s
, 
E¼ÜHªdËr
 * 
”rÜhªdËr
)

868 : 
	`š‹º®
(
Ãw
 
	$IÁ”Çl
(
d©aba£s
, 
”rÜhªdËr
))

870 
	`DEBUGAPICALL
(, "X­Ÿn::Enquœe::Enquœe", 
d©aba£s
);

871 
	}
}

873 
	gEnquœe
::~
	$Enquœe
()

875 
	`DEBUGAPICALL
(, "Xapian::Enquire::~Enquire", "");

876 
	}
}

879 
	gEnquœe
::
	$£t_qu”y
(cÚ¡ 
Qu”y
 & 
qu”y
, 
‹rmcouÁ
 
Ën
)

881 
	`DEBUGAPICALL
(, "X­Ÿn::Enquœe::£t_qu”y", 
qu”y
 << ", " << 
Ën
);

882 
š‹º®
->
	`£t_qu”y
(
qu”y
, 
Ën
);

883 
	}
}

885 cÚ¡ 
	gQu”y
 &

886 
	gEnquœe
::
	$g‘_qu”y
() const

888 
	`DEBUGAPICALL
(cÚ¡ 
X­Ÿn
::
Qu”y
 &, "Xapian::Enquire::get_query", "");

889 
Œy
 {

890 
	`RETURN
(
š‹º®
->
	`g‘_qu”y
());

891 } 
	`ÿtch
 (
E¼Ü
 & 
e
) {

892 ià(
š‹º®
->
”rÜhªdËr
è(*š‹º®->”rÜhªdËr)(
e
);

893 
throw
;

895 
	}
}

898 
	gEnquœe
::
	$add_m©ch¥y
(
M©chSpy
 * 
¥y
) {

899 
	`DEBUGAPICALL
(, "X­Ÿn::Enquœe::add_m©ch¥y", 
¥y
);

900 
š‹º®
->
¥›s
.
	`push_back
(
¥y
);

901 
	}
}

904 
	gEnquœe
::
	$ş—r_m©ch¥›s
() {

905 
	`DEBUGAPICALL
(cÚ¡ 
X­Ÿn
::
Qu”y
 &, "Xapian::Enquire::clear_matchspies", "");

906 
š‹º®
->
¥›s
.
	`ş—r
();

907 
	}
}

910 
	gEnquœe
::
	$£t_weightšg_scheme
(cÚ¡ 
Weight
 &
weight_
)

912 
	`DEBUGAPICALL
(, "Xapian::Enquire::set_weighting_scheme", "[Weight]");

914 
Weight
 * 
wt
 = 
weight_
.
	`şÚe
();

915 
	`sw­
(
wt
, 
š‹º®
->
weight
);

916 
d–‘e
 
wt
;

917 
	}
}

920 
	gEnquœe
::
£t_cŞÏp£_key
(
X­Ÿn
::
v®u’o
 
cŞÏp£_key
, X­Ÿn::
doccouÁ
 
cŞÏp£_max
)

922 ià(
cŞÏp£_key
 =ğ
X­Ÿn
::
BAD_VALUENO
è
cŞÏp£_max
 = 0;

923 
	gš‹º®
->
	gcŞÏp£_key
 = 
cŞÏp£_key
;

924 
	gš‹º®
->
	gcŞÏp£_max
 = 
cŞÏp£_max
;

928 
	gEnquœe
::
£t_docid_Üd”
(
Enquœe
::
docid_Üd”
 
Üd”
)

930 
š‹º®
->
Üd”
 = order;

934 
	gEnquœe
::
£t_cutoff
(
X­Ÿn
::
³rûÁ
 
³rûÁ_cutoff
, X­Ÿn::
weight
 
weight_cutoff
)

936 
š‹º®
->
³rûÁ_cutoff
 =…ercent_cutoff;

937 
	gš‹º®
->
	gweight_cutoff
 = 
weight_cutoff
;

941 
	gEnquœe
::
	$£t_sÜt_by_»Ëvªû
()

943 
š‹º®
->
sÜt_by
 = 
IÁ”Çl
::
REL
;

944 
	}
}

947 
	gEnquœe
::
	$£t_sÜt_by_v®ue
(
v®u’o
 
sÜt_key
, 
boŞ
 
asûndšg
)

949 
š‹º®
->
sÜ‹r
 = 
NULL
;

950 
š‹º®
->
sÜt_key
 = sort_key;

951 
š‹º®
->
sÜt_by
 = 
IÁ”Çl
::
VAL
;

952 
š‹º®
->
sÜt_v®ue_fÜw¬d
 = 
asûndšg
;

953 
	}
}

956 
	gEnquœe
::
	$£t_sÜt_by_v®ue_th’_»Ëvªû
(
v®u’o
 
sÜt_key
, 
boŞ
 
asûndšg
)

958 
š‹º®
->
sÜ‹r
 = 
NULL
;

959 
š‹º®
->
sÜt_key
 = sort_key;

960 
š‹º®
->
sÜt_by
 = 
IÁ”Çl
::
VAL_REL
;

961 
š‹º®
->
sÜt_v®ue_fÜw¬d
 = 
asûndšg
;

962 
	}
}

965 
	gEnquœe
::
	$£t_sÜt_by_»Ëvªû_th’_v®ue
(
v®u’o
 
sÜt_key
, 
boŞ
 
asûndšg
)

967 
š‹º®
->
sÜ‹r
 = 
NULL
;

968 
š‹º®
->
sÜt_key
 = sort_key;

969 
š‹º®
->
sÜt_by
 = 
IÁ”Çl
::
REL_VAL
;

970 
š‹º®
->
sÜt_v®ue_fÜw¬d
 = 
asûndšg
;

971 
	}
}

974 
	gEnquœe
::
	$£t_sÜt_by_key
(
KeyMak”
 * 
sÜ‹r
, 
boŞ
 
asûndšg
)

976 ià(
sÜ‹r
 =ğ
NULL
)

977 
throw
 
	`Inv®idArgum’tE¼Ü
("sorter can't be NULL");

978 
š‹º®
->
sÜ‹r
 = sorter;

979 
š‹º®
->
sÜt_by
 = 
IÁ”Çl
::
VAL
;

980 
š‹º®
->
sÜt_v®ue_fÜw¬d
 = 
asûndšg
;

981 
	}
}

984 
	gEnquœe
::
	$£t_sÜt_by_key_th’_»Ëvªû
(
KeyMak”
 * 
sÜ‹r
, 
boŞ
 
asûndšg
)

986 ià(
sÜ‹r
 =ğ
NULL
)

987 
throw
 
	`Inv®idArgum’tE¼Ü
("sorter can't be NULL");

988 
š‹º®
->
sÜ‹r
 = sorter;

989 
š‹º®
->
sÜt_by
 = 
IÁ”Çl
::
VAL_REL
;

990 
š‹º®
->
sÜt_v®ue_fÜw¬d
 = 
asûndšg
;

991 
	}
}

994 
	gEnquœe
::
	$£t_sÜt_by_»Ëvªû_th’_key
(
KeyMak”
 * 
sÜ‹r
, 
boŞ
 
asûndšg
)

996 ià(
sÜ‹r
 =ğ
NULL
)

997 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("sorter can't be NULL");

998 
š‹º®
->
sÜ‹r
 = sorter;

999 
š‹º®
->
sÜt_by
 = 
IÁ”Çl
::
REL_VAL
;

1000 
š‹º®
->
sÜt_v®ue_fÜw¬d
 = 
asûndšg
;

1001 
	}
}

1003 
MS‘


1004 
	gEnquœe
::
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
max™ems
,

1005 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
, cÚ¡ 
RS‘
 *
r£t
,

1006 cÚ¡ 
M©chDecid”
 *
mdecid”
,

1007 cÚ¡ 
M©chDecid”
 *
m©ch¥y
) const

1010 
DEBUGAPICALL
(
X­Ÿn
::
MS‘
, "X­Ÿn::Enquœe::g‘_m£t", 
fœ¡
 << ", " <<

1011 
max™ems
 << ", " << 
check_©_Ëa¡
 << ", " << 
r£t
 << ", " <<

1012 
mdecid”
 << ", " << 
m©ch¥y
);

1014 
	gŒy
 {

1015 
RETURN
(
š‹º®
->
g‘_m£t
(
fœ¡
, 
max™ems
, 
check_©_Ëa¡
, 
r£t
,

1016 
mdecid”
, 
m©ch¥y
));

1017 } 
ÿtch
 (
E¼Ü
 & 
e
) {

1018 ià(
	gš‹º®
->
	g”rÜhªdËr
è(*š‹º®->”rÜhªdËr)(
	ge
);

1019 
	gthrow
;

1023 
MS‘


1024 
	gEnquœe
::
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
max™ems
,

1025 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
, cÚ¡ 
RS‘
 *
r£t
,

1026 cÚ¡ 
M©chDecid”
 *
mdecid”
) const

1029 
DEBUGAPICALL
(
X­Ÿn
::
MS‘
, "X­Ÿn::Enquœe::g‘_m£t", 
fœ¡
 << ", " <<

1030 
max™ems
 << ", " << 
check_©_Ëa¡
 << ", " << 
r£t
 << ", " <<

1031 
mdecid”
);

1033 
	gŒy
 {

1034 
RETURN
(
š‹º®
->
g‘_m£t
(
fœ¡
, 
max™ems
, 
check_©_Ëa¡
, 
r£t
,

1035 
mdecid”
, 
NULL
));

1036 } 
ÿtch
 (
E¼Ü
 & 
e
) {

1037 ià(
	gš‹º®
->
	g”rÜhªdËr
è(*š‹º®->”rÜhªdËr)(
	ge
);

1038 
	gthrow
;

1042 
ES‘


1043 
	gEnquœe
::
g‘_e£t
(
X­Ÿn
::
‹rmcouÁ
 
max™ems
, cÚ¡ 
RS‘
 & 
r£t
, 
æags
,

1044 
k
, cÚ¡ 
Ex·ndDecid”
 * 
edecid”
) const

1048 
DEBUGAPICALL
(
X­Ÿn
::
ES‘
, "X­Ÿn::Enquœe::g‘_e£t", 
max™ems
 << ", " <<

1049 
r£t
 << ", " << 
æags
 << ", " << 
k
 << ", " << 
edecid”
);

1051 
	gŒy
 {

1053 
RETURN
(
š‹º®
->
g‘_e£t
(
max™ems
, 
r£t
, 
æags
, 
k
, 
edecid”
));

1054 } 
ÿtch
 (
E¼Ü
 & 
e
) {

1055 ià(
	gš‹º®
->
	g”rÜhªdËr
è(*š‹º®->”rÜhªdËr)(
	ge
);

1056 
	gthrow
;

1060 
T”mI‹¿tÜ


1061 
	gEnquœe
::
	$g‘_m©chšg_‹rms_begš
(cÚ¡ 
MS‘I‹¿tÜ
 &
™
) const

1063 
	`DEBUGAPICALL
(
X­Ÿn
::
T”mI‹¿tÜ
, "X­Ÿn::Enquœe::g‘_m©chšg_‹rms", 
™
);

1064 
Œy
 {

1065 
	`RETURN
(
š‹º®
->
	`g‘_m©chšg_‹rms
(
™
));

1066 } 
	`ÿtch
 (
E¼Ü
 & 
e
) {

1067 ià(
š‹º®
->
”rÜhªdËr
è(*š‹º®->”rÜhªdËr)(
e
);

1068 
throw
;

1070 
	}
}

1072 
T”mI‹¿tÜ


1073 
	gEnquœe
::
g‘_m©chšg_‹rms_begš
(
X­Ÿn
::
docid
 
did
) const

1075 
DEBUGAPICALL
(
X­Ÿn
::
T”mI‹¿tÜ
, "X­Ÿn::Enquœe::g‘_m©chšg_‹rms", 
did
);

1076 
	gŒy
 {

1077 
RETURN
(
š‹º®
->
g‘_m©chšg_‹rms
(
did
));

1078 } 
ÿtch
 (
E¼Ü
 & 
e
) {

1079 ià(
	gš‹º®
->
	g”rÜhªdËr
è(*š‹º®->”rÜhªdËr)(
	ge
);

1080 
	gthrow
;

1084 
¡ršg


1085 
	gEnquœe
::
	$g‘_desütiÚ
() const

1087  "X­Ÿn::Enquœe(" + 
š‹º®
->
	`g‘_desütiÚ
() + ")";

1088 
	}
}

	@api/ompositionlistiterator.cc

22 
	~<cÚfig.h
>

23 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

24 
	~"pos™iÚli¡.h
"

25 
	~"omas£¹.h
"

26 
	~"omdebug.h
"

28 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
::
	$Pos™iÚI‹¿tÜ
(
IÁ”Çl
 *
š‹º®_
)

29 : 
	$š‹º®
(
š‹º®_
)

31 ià(
š‹º®
.
	`g‘
()) {

32 
š‹º®
->
	`Ãxt
();

33 ià(
š‹º®
->
	`©_’d
()) internal = 0;

35 
	}
}

37 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
::
	$Pos™iÚI‹¿tÜ
(è: 
	$š‹º®
(0)

39 
	}
}

41 
X­Ÿn
::
Pos™iÚI‹¿tÜ
::Pos™iÚI‹¿tÜ(cÚ¡ X­Ÿn::Pos™iÚI‹¿tÜ &
o
)

42 : 
	$š‹º®
(
o
.
š‹º®
)

44 
	}
}

46 
X­Ÿn
::
Pos™iÚI‹¿tÜ
::~
	$Pos™iÚI‹¿tÜ
()

48 
	}
}

51 
X­Ÿn
::
Pos™iÚI‹¿tÜ
::
İ”©Ü
=(cÚ¡ X­Ÿn::Pos™iÚI‹¿tÜ &
o
)

53 
š‹º®
 = 
o
.internal;

56 
	gX­Ÿn
::
‹rmpos


57 
X­Ÿn
::
Pos™iÚI‹¿tÜ
::
İ”©Ü
 *() const

59 
DEBUGAPICALL
(
X­Ÿn
::
‹rmpos
, "Xapian::PositionIterator::operator*", "");

60 
As£¹
(
š‹º®
.
g‘
());

61 
As£¹
(!
š‹º®
->
©_’d
());

62 
RETURN
(
š‹º®
->
g‘_pos™iÚ
());

65 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 &

66 
X­Ÿn
::
Pos™iÚI‹¿tÜ
::
İ”©Ü
++()

68 
DEBUGAPICALL
(, "Xapian::PositionIterator::operator++", "");

69 
As£¹
(
š‹º®
.
g‘
());

70 
As£¹
(!
š‹º®
->
©_’d
());

71 
	gš‹º®
->
Ãxt
();

72 ià(
	gš‹º®
->
©_’d
()) internal = 0;

73  *
	gthis
;

78 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
::
sk_to
(
X­Ÿn
::
‹rmpos
 
pos
)

80 
DEBUGAPICALL
(, "X­Ÿn::Pos™iÚI‹¿tÜ::sk_to", 
pos
);

81 
As£¹
(
š‹º®
.
g‘
());

82 
As£¹
(!
š‹º®
->
©_’d
());

83 
	gš‹º®
->
sk_to
(
pos
);

84 ià(
	gš‹º®
->
©_’d
()) internal = 0;

87 
	g¡d
::
¡ršg


88 
X­Ÿn
::
Pos™iÚI‹¿tÜ
::
	$g‘_desütiÚ
() const

92 
	}
}

	@api/ompostlistiterator.cc

22 
	~<cÚfig.h
>

23 
	~<x­Ÿn/po¡šg™”©Ü.h
>

24 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

25 
	~"po¡li¡.h
"

26 
	~"omas£¹.h
"

27 
	~"omdebug.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
::
	$Po¡šgI‹¿tÜ
(
IÁ”Çl
 *
š‹º®_
)

32 : 
	$š‹º®
(
š‹º®_
)

34 ià(
š‹º®
.
	`g‘
()) {

36 
IÁ”Çl
 *
p
 = 
š‹º®
->
	`Ãxt
();

37 ià(
p
è
š‹º®
 =…;

38 ià(
š‹º®
->
	`©_’d
()) internal = 0;

40 
	}
}

42 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
::
	$Po¡šgI‹¿tÜ
(è: 
	$š‹º®
(0) {

43 
	`DEBUGAPICALL
(, "Xapian::PostingIterator::PostingIterator", "");

44 
	}
}

46 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
::~
	$Po¡šgI‹¿tÜ
() {

47 
	`DEBUGAPICALL
(, "Xapian::PostingIterator::~PostingIterator", "");

48 
	}
}

50 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
::Po¡šgI‹¿tÜ(cÚ¡ 
X­Ÿn
::Po¡šgI‹¿tÜ &
Ùh”
)

51 : 
	$š‹º®
(
Ùh”
.
š‹º®
)

53 
	`DEBUGAPICALL
(, "X­Ÿn::Po¡šgI‹¿tÜ::X­Ÿn::Po¡šgI‹¿tÜ", 
Ùh”
);

54 
	}
}

57 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
::
İ”©Ü
=(cÚ¡ 
X­Ÿn
::Po¡šgI‹¿tÜ &
Ùh”
)

59 
DEBUGAPICALL
(, "X­Ÿn::Po¡šgI‹¿tÜ::İ”©Ü=", 
Ùh”
);

60 
	gš‹º®
 = 
Ùh”
.
š‹º®
;

63 
	gX­Ÿn
::
docid


64 
X­Ÿn
::
Po¡šgI‹¿tÜ
::
İ”©Ü
 *() const

66 
DEBUGAPICALL
(
X­Ÿn
::
docid
, "Xapian::PostingIterator::operator*", "");

67 
As£¹
(
š‹º®
.
g‘
());

68 
As£¹
(!
š‹º®
->
©_’d
());

69 
RETURN
(
š‹º®
->
g‘_docid
());

72 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 &

73 
X­Ÿn
::
Po¡šgI‹¿tÜ
::
İ”©Ü
++()

75 
DEBUGAPICALL
(, "Xapian::PostingIterator::operator++", "");

76 
As£¹
(
š‹º®
.
g‘
());

77 
As£¹
(!
š‹º®
->
©_’d
());

78 
IÁ”Çl
 *
	gp
 = 
š‹º®
->
Ãxt
();

79 ià(
	gp
è
	gš‹º®
 = 
p
;

80 ià(
	gš‹º®
->
©_’d
()) internal = 0;

81  *
	gthis
;

86 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
::
sk_to
(
X­Ÿn
::
docid
 
did
)

88 
DEBUGAPICALL
(, "X­Ÿn::Po¡šgI‹¿tÜ::sk_to", 
did
);

89 
As£¹
(
š‹º®
.
g‘
());

90 
As£¹
(!
š‹º®
->
©_’d
());

91 
Po¡Li¡
 *
	gp
 = 
š‹º®
->
sk_to
(
did
, 0);

92 ià(
	gp
è
	gš‹º®
 = 
p
;

93 ià(
	gš‹º®
->
©_’d
()) internal = 0;

96 
	gX­Ÿn
::
‹rmcouÁ


97 
X­Ÿn
::
Po¡šgI‹¿tÜ
::
	$g‘_doş’gth
() const

99 
	`DEBUGAPICALL
(
X­Ÿn
::
‹rmcouÁ
, "Xapian::PostingIterator::get_doclength", "");

100 
	`As£¹
(
š‹º®
.
	`g‘
());

101 
	`As£¹
(!
š‹º®
->
	`©_’d
());

102 
	`RETURN
(
š‹º®
->
	`g‘_doş’gth
());

103 
	}
}

105 
	gX­Ÿn
::
‹rmcouÁ


106 
X­Ÿn
::
Po¡šgI‹¿tÜ
::
	$g‘_wdf
() const

108 
	`DEBUGAPICALL
(
X­Ÿn
::
‹rmcouÁ
, "Xapian::PostingIterator::get_wdf", "");

109 
	`As£¹
(
š‹º®
.
	`g‘
());

110 
	`As£¹
(!
š‹º®
->
	`©_’d
());

111 
	`RETURN
(
š‹º®
->
	`g‘_wdf
());

112 
	}
}

114 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


115 
X­Ÿn
::
Po¡šgI‹¿tÜ
::
	$pos™iÚli¡_begš
() const

117 
	`DEBUGAPICALL
(
X­Ÿn
::
Pos™iÚI‹¿tÜ
, "Xapian::PostingIterator::positionlist_begin", "");

118 
	`As£¹
(
š‹º®
.
	`g‘
());

119 
	`As£¹
(!
š‹º®
->
	`©_’d
());

120 
	`RETURN
(
X­Ÿn
::
	`Pos™iÚI‹¿tÜ
(
š‹º®
->
	`İ’_pos™iÚ_li¡
()));

121 
	}
}

123 
¡ršg


124 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
::
	$g‘_desütiÚ
() const

126 
¡ršg
 
desc
 = "Xapian::PostingIterator(pos=";

127 ià(
š‹º®
.
	`g‘
() == 0) {

128 
desc
 += "END";

130 
desc
 +ğ
š‹º®
->
	`g‘_desütiÚ
();

132 
desc
 += ")";

133  
desc
;

134 
	}
}

	@api/omquery.cc

24 
	~<cÚfig.h
>

26 
	~"omas£¹.h
"

27 
	~"omdebug.h
"

28 
	~"omqu”yš‹º®.h
"

29 
	~"uts.h
"

31 
	~"x­Ÿn/”rÜ.h
"

32 
	~"x­Ÿn/po¡šgsourû.h
"

33 
	~"x­Ÿn/»gi¡ry.h
"

34 
	~"x­Ÿn/‹rm™”©Ü.h
"

36 
	~<cm©h
>

38 
Çme¥aû
 
	gX­Ÿn
 {

42 
	gQu”y
::
add_subqu”y
(cÚ¡ 
Qu”y
 & 
subq
)

44 
DEBUGAPICALL
(, "X­Ÿn::Qu”y::add_subqu”y", 
subq
);

45 
As£¹
(
š‹º®
.
g‘
());

46 
	gš‹º®
->
add_subqu”y
(
subq
.
š‹º®
.
g‘
());

51 
	gQu”y
::
add_subqu”y
(cÚ¡ 
Qu”y
 * 
subq
)

53 
DEBUGAPICALL
(, "X­Ÿn::Qu”y::add_subqu”y", 
subq
);

54 ià(
	gsubq
 == 0) {

55 
throw
 
Inv®idArgum’tE¼Ü
("Pointero subquery may‚ot be‚ull");

57 
As£¹
(
š‹º®
.
g‘
());

58 
	gš‹º®
->
add_subqu”y
(
subq
->
š‹º®
.
g‘
());

63 
	gQu”y
::
add_subqu”y
(cÚ¡ 
¡ršg
 & 
Šame
)

65 
DEBUGAPICALL
(, "X­Ÿn::Qu”y::add_subqu”y", 
Šame
);

66 
As£¹
(
š‹º®
.
g‘
());

67 
	gQu”y
::
IÁ”Çl
 
subqšt
(
Šame
);

68 
	gš‹º®
->
add_subqu”y
(&
subqšt
);

73 
	gQu”y
::
¡¬t_cÚ¡ruùiÚ
(
Qu”y
::
İ
 
İ_
, 
‹rmcouÁ
 
·¿m‘”
)

75 
DEBUGAPICALL
(, "X­Ÿn::Qu”y::¡¬t_cÚ¡ruùiÚ", 
İ_
);

76 
As£¹
(!
š‹º®
.
g‘
());

77 
	gš‹º®
 = 
Ãw
 
Qu”y
::
IÁ”Çl
(
İ_
, 
·¿m‘”
);

82 
	gQu”y
::
’d_cÚ¡ruùiÚ
()

84 
DEBUGAPICALL
(, "Xapian::Query::end_construction", "");

85 
As£¹
(
š‹º®
.
g‘
());

86 
	gš‹º®
 = 
š‹º®
->
’d_cÚ¡ruùiÚ
();

91 
	gQu”y
::
abÜt_cÚ¡ruùiÚ
()

93 
DEBUGAPICALL
(, "Xapian::Query::abort_construction", "");

94 
As£¹
(
š‹º®
.
g‘
());

95 
	gš‹º®
 = 0;

98 
	gQu”y
::
Qu”y
(cÚ¡ 
¡ršg
 & 
Šame_
, 
‹rmcouÁ
 
wqf_
, 
‹rmpos
 
pos_
)

99 : 
š‹º®
(
Ãw
 
Qu”y
::
IÁ”Çl
(
Šame_
, 
wqf_
, 
pos_
))

101 
DEBUGAPICALL
(, "Xapian::Query::Query",

102 
Šame_
 << ", " << 
wqf_
 << ", " << 
pos_
);

105 
	gQu”y
::
Qu”y
(Qu”y::
İ
 
İ_
, cÚ¡ Qu”y &
Ëá
, cÚ¡ Qu”y &
right
)

106 : 
š‹º®
(
Ãw
 
Qu”y
::
IÁ”Çl
(
İ_
, 0u))

108 
DEBUGAPICALL
(, "Xapian::Query::Query",

109 
İ_
 << ", " << 
Ëá
 << ", " << 
right
);

110 
	gŒy
 {

111 
add_subqu”y
(
Ëá
);

112 
add_subqu”y
(
right
);

113 
’d_cÚ¡ruùiÚ
();

114 } 
ÿtch
 (...) {

115 
abÜt_cÚ¡ruùiÚ
();

116 
	gthrow
;

120 
	gQu”y
::
Qu”y
(Qu”y::
İ
 
İ_
, 
X­Ÿn
::Qu”y 
q
, 
·¿m‘”
)

122 
DEBUGAPICALL
(, "Xapian::Query::Query",

123 
İ_
 << ", " << 
q
 << ", " << 
·¿m‘”
);

124 ià(
	gİ_
 =ğ
OP_SCALE_WEIGHT
) {

125 ià(!
q
.
š‹º®
.
g‘
() ||

126 
q
.
š‹º®
->
İ
 =ğ
OP_VALUE_RANGE
 ||

127 
q
.
š‹º®
->
İ
 =ğ
OP_VALUE_GE
 ||

128 
q
.
š‹º®
->
İ
 =ğ
OP_VALUE_LE
) {

131 
š‹º®
 = 
q
.internal;

135 
	gŒy
 {

136 
¡¬t_cÚ¡ruùiÚ
(
İ_
, 0);

137 
	gš‹º®
->
£t_dbl_·¿m‘”
(
·¿m‘”
);

138 
add_subqu”y
(
q
);

139 
’d_cÚ¡ruùiÚ
();

140 } 
ÿtch
 (...) {

141 
abÜt_cÚ¡ruùiÚ
();

142 
	gthrow
;

146 
	gQu”y
::
Qu”y
(Qu”y::
İ
 
İ_
, 
X­Ÿn
::
v®u’o
 
v®no
,

147 cÚ¡ 
¡ršg
 &
begš
, cÚ¡ sŒšg &
’d
)

148 : 
š‹º®
(
Ãw
 
Qu”y
::
IÁ”Çl
(
İ_
, 
v®no
, 
begš
, 
’d
))

150 
DEBUGAPICALL
(, "Xapian::Query::Query",

151 
İ_
 << ", " << 
v®no
 << ", " << 
begš
 << ", " << 
’d
);

154 
	gQu”y
::
Qu”y
(Qu”y::
İ
 
İ_
, 
X­Ÿn
::
v®u’o
 
v®no
, cÚ¡ 
¡d
::
¡ršg
 &
v®ue
)

155 : 
š‹º®
(
Ãw
 
Qu”y
::
IÁ”Çl
(
İ_
, 
v®no
, 
v®ue
))

157 
DEBUGAPICALL
(, "Xapian::Query::Query",

158 
İ_
 << ", " << 
v®no
 << ", " << 
v®ue
);

161 
	gQu”y
::
Qu”y
(
Po¡šgSourû
 * 
ex‹º®_sourû
)

162 : 
š‹º®
(
NULL
)

164 
DEBUGAPICALL
(, "X­Ÿn::Qu”y::Qu”y", 
ex‹º®_sourû
);

165 ià(!
	gex‹º®_sourû
)

166 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("Theƒxternal_source…arameter can‚ot be NULL");

167 
Po¡šgSourû
 * 
	gşÚe
 = 
ex‹º®_sourû
->
şÚe
();

168 ià(
	gşÚe
) {

169 
	gš‹º®
 = 
Ãw
 
Qu”y
::
IÁ”Çl
(
şÚe
, 
Œue
);

171 
	gš‹º®
 = 
Ãw
 
Qu”y
::
IÁ”Çl
(
ex‹º®_sourû
, 
çl£
);

176 
	gQu”y
::
Qu”y
(cÚ¡ Qu”y & 
cİyme
)

177 : 
š‹º®
(
cİyme
.internal)

179 
DEBUGAPICALL
(, "X­Ÿn::Qu”y::Qu”y", 
cİyme
);

183 
	gQu”y
 &

184 
	gQu”y
::
İ”©Ü
=(cÚ¡ 
Qu”y
 & 
cİyme
)

186 
DEBUGAPICALL
(
X­Ÿn
::
Qu”y
 &, "X­Ÿn::Qu”y::İ”©Ü=", 
cİyme
);

187 
	gš‹º®
 = 
cİyme
.
š‹º®
;

188 
RETURN
(*
this
);

192 
	gQu”y
::
Qu”y
(è: 
š‹º®
(0)

194 
DEBUGAPICALL
(, "Xapian::Query::Query", "");

198 
	gQu”y
::~
Qu”y
()

200 
DEBUGAPICALL
(, "Xapian::Query::~Query", "");

203 
	g¡d
::
¡ršg


204 
Qu”y
::
£rŸli£
() const

206 
DEBUGAPICALL
(
¡d
::
¡ršg
, "Xapian::Query::serialise", "");

207 ià(!
	gš‹º®
.
g‘
()è 
	g¡d
::
¡ršg
();

208  
	gš‹º®
->
£rŸli£
();

211 
Qu”y


212 
	gQu”y
::
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
)

214 
DEBUGAPICALL_STATIC
(
X­Ÿn
::
Qu”y
, "X­Ÿn::Qu”y::un£rŸli£", 
s
);

215 
Qu”y
 
	g»suÉ
;

216 ià(!
	gs
.
em±y
()) {

217 
	g»suÉ
.
	gš‹º®
 = 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
un£rŸli£
(
s
, 
Regi¡ry
());

219 
RETURN
(
»suÉ
);

222 
Qu”y


223 
	gQu”y
::
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, cÚ¡ 
Regi¡ry
 & 
»g
)

225 
DEBUGAPICALL_STATIC
(
X­Ÿn
::
Qu”y
, "X­Ÿn::Qu”y::un£rŸli£", 
s
 << ",„eg");

226 
Qu”y
 
	g»suÉ
;

227 ià(!
	gs
.
em±y
()) {

228 
	g»suÉ
.
	gš‹º®
 = 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
un£rŸli£
(
s
, 
»g
);

230 
RETURN
(
»suÉ
);

233 
	g¡d
::
¡ršg


234 
Qu”y
::
g‘_desütiÚ
() const

236 
¡d
::
¡ršg
 
»s
("Xapian::Query(");

237 ià(
	gš‹º®
.
g‘
()è
	g»s
 +ğ
š‹º®
->
g‘_desütiÚ
();

238 
	g»s
 += ")";

239  
	g»s
;

242 
‹rmcouÁ
 
	gQu”y
::
g‘_Ëngth
() const

244 
DEBUGAPICALL
(
X­Ÿn
::
‹rmcouÁ
, "Xapian::Query::get_length", "");

245 
RETURN
(
š‹º®
.
g‘
(è? iÁ”Çl->
g‘_Ëngth
() : 0);

248 
T”mI‹¿tÜ
 
	gQu”y
::
g‘_‹rms_begš
() const

250 
DEBUGAPICALL
(
X­Ÿn
::
T”mI‹¿tÜ
, "Xapian::Query::get_terms_begin", "");

251 ià(!
	gš‹º®
.
g‘
()è
RETURN
(
T”mI‹¿tÜ
(
NULL
));

252 
RETURN
(
š‹º®
->
g‘_‹rms
());

255 
boŞ


256 
	gQu”y
::
em±y
() const

258 
DEBUGAPICALL
(, "Xapian::Query::empty", "");

259  
	gš‹º®
.
g‘
() == 0;

262 
	gQu”y
::
Qu”y
(Qu”y::
İ
 
İ_
, cÚ¡ 
¡d
::
¡ršg
 & 
Ëá
, cÚ¡ std::¡ršg & 
right
)

263 : 
š‹º®
(0)

265 
Œy
 {

266 
¡¬t_cÚ¡ruùiÚ
(
İ_
, 0);

267 
add_subqu”y
(
Ëá
);

268 
add_subqu”y
(
right
);

269 
’d_cÚ¡ruùiÚ
();

270 } 
ÿtch
 (...) {

271 
abÜt_cÚ¡ruùiÚ
();

272 
	gthrow
;

277 cÚ¡ 
	gX­Ÿn
::
Qu”y
 
X­Ÿn
::Qu”y::
M©chAÎ
 = X­Ÿn::Qu”y(
¡ršg
());

278 cÚ¡ 
	gX­Ÿn
::
Qu”y
 
X­Ÿn
::Qu”y::
M©chNÙhšg
 = Xapian::Query();

	@api/omqueryinternal.cc

24 
	~<cÚfig.h
>

26 
	~"omqu”yš‹º®.h
"

28 
	~"»gi¡ryš‹º®.h
"

29 
	~"omdebug.h
"

30 
	~"uts.h
"

31 
	~"£rŸli£.h
"

32 
	~"£rŸli£-doubË.h
"

34 
	~<x­Ÿn/”rÜ.h
>

35 
	~<x­Ÿn/po¡šgsourû.h
>

36 
	~<x­Ÿn/‹rm™”©Ü.h
>

37 
	~<x­Ÿn/v”siÚ.h
>

38 
	~"veùÜ‹rmli¡.h
"

40 
	~<®gÜ™hm
>

41 
	~"autİŒ.h
"

42 
	~<cæßt
>

43 
	~<şim™s
>

44 
	~<cm©h
>

45 
	~<£t
>

46 
	~<veùÜ
>

48 
usšg
 
Çme¥aû
 
	g¡d
;

53 
g‘_mš_subqs
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
)

55 
İ
) {

56 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_EXTERNAL_SOURCE
:

57 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
:

58 
X­Ÿn
::
Qu”y
::
OP_AND
:

59 
X­Ÿn
::
Qu”y
::
OP_OR
:

60 
X­Ÿn
::
Qu”y
::
OP_XOR
:

61 
X­Ÿn
::
Qu”y
::
OP_NEAR
:

62 
X­Ÿn
::
Qu”y
::
OP_PHRASE
:

63 
X­Ÿn
::
Qu”y
::
OP_ELITE_SET
:

64 
X­Ÿn
::
Qu”y
::
OP_VALUE_RANGE
:

65 
X­Ÿn
::
Qu”y
::
OP_VALUE_GE
:

66 
X­Ÿn
::
Qu”y
::
OP_VALUE_LE
:

67 
X­Ÿn
::
Qu”y
::
OP_SYNONYM
:

69 
	gX­Ÿn
::
Qu”y
::
OP_SCALE_WEIGHT
:

71 
	gX­Ÿn
::
Qu”y
::
OP_FILTER
:

72 
X­Ÿn
::
Qu”y
::
OP_AND_MAYBE
:

73 
X­Ÿn
::
Qu”y
::
OP_AND_NOT
:

76 
As£¹
(
çl£
);

77 
throw
 
	gX­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("get_min_subqs called with invalid operatorype");

82 
g‘_max_subqs
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
)

84 
İ
) {

85 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_EXTERNAL_SOURCE
:

86 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
:

87 
X­Ÿn
::
Qu”y
::
OP_VALUE_RANGE
:

88 
X­Ÿn
::
Qu”y
::
OP_VALUE_GE
:

89 
X­Ÿn
::
Qu”y
::
OP_VALUE_LE
:

91 
	gX­Ÿn
::
Qu”y
::
OP_SCALE_WEIGHT
:

93 
	gX­Ÿn
::
Qu”y
::
OP_FILTER
:

94 
X­Ÿn
::
Qu”y
::
OP_AND_MAYBE
:

95 
X­Ÿn
::
Qu”y
::
OP_AND_NOT
:

97 
	gX­Ÿn
::
Qu”y
::
OP_AND
:

98 
X­Ÿn
::
Qu”y
::
OP_OR
:

99 
X­Ÿn
::
Qu”y
::
OP_XOR
:

100 
X­Ÿn
::
Qu”y
::
OP_NEAR
:

101 
X­Ÿn
::
Qu”y
::
OP_PHRASE
:

102 
X­Ÿn
::
Qu”y
::
OP_ELITE_SET
:

103 
X­Ÿn
::
Qu”y
::
OP_SYNONYM
:

104  
UINT_MAX
;

106 
As£¹
(
çl£
);

107 
throw
 
	gX­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("get_max_subqs called with invalid operatorype");

111 
šlše
 
boŞ


112 
is_Ëaf
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
)

114  (
İ
 =ğ
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
);

117 
šlše
 
boŞ


118 
is_di¡ribubË
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
)

120 
İ
) {

121 
X­Ÿn
::
Qu”y
::
OP_AND
:

122 
X­Ÿn
::
Qu”y
::
OP_OR
:

123 
X­Ÿn
::
Qu”y
::
OP_XOR
:

124 
X­Ÿn
::
Qu”y
::
OP_SYNONYM
:

125  
Œue
;

127  
çl£
;

151 
¡ršg


152 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
£rŸli£
(
X­Ÿn
::
‹rmpos
 & 
cu½os
) const

154 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


155 
¡ršg
 
»suÉ
;

157 ià(
	gİ
 =ğ
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
) {

158 
»suÉ
 += '[';

159 
	g»suÉ
 +ğ
’code_Ëngth
(
Šame
.
Ëngth
());

160 
	g»suÉ
 +ğ
Šame
;

161 ià(
	g‹rm_pos
 !ğ
cu½os
è
»suÉ
 +ğ'@' + 
’code_Ëngth
(
‹rm_pos
);

163 ià(
	g·¿m‘”
 !ğ1è
»suÉ
 +ğ'#' + 
’code_Ëngth
(
·¿m‘”
);

164 ++
	gcu½os
;

165 } ià(
	gİ
 =ğ
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_EXTERNAL_SOURCE
) {

166 
¡ršg
 
sourûÇme
 = 
ex‹º®_sourû
->
Çme
();

167 ià(
	gsourûÇme
.
em±y
())

168 
throw
 
	gX­Ÿn
::
Unim¶em’‹dE¼Ü
("This PostingSource doesn't support„emote use.");

169 
	g»suÉ
 += '!';

170 
	g»suÉ
 +ğ
’code_Ëngth
(
sourûÇme
.
Ëngth
());

171 
	g»suÉ
 +ğ
sourûÇme
;

172 
¡ršg
 
	gsourûd©a
 = 
ex‹º®_sourû
->
£rŸli£
();

173 
	g»suÉ
 +ğ
’code_Ëngth
(
sourûd©a
.
Ëngth
());

174 
	g»suÉ
 +ğ
sourûd©a
;

176 
	g»suÉ
 += "(";

177 
	gsubqu”y_li¡
::
cÚ¡_™”©Ü
 
i
 = 
subqs
.
begš
();

178 
	gi
 !ğ
subqs
.
’d
();

179 ++
	gi
) {

180 
	g»suÉ
 +ğ(*
i
)->
£rŸli£
(
cu½os
);

182 
	gİ
) {

183 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
:

184 
As£¹
(
çl£
);

186 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_EXTERNAL_SOURCE
:

187 
As£¹
(
çl£
);

189 
	gX­Ÿn
::
Qu”y
::
OP_AND
:

190 
»suÉ
 += "&";

192 
	gX­Ÿn
::
Qu”y
::
OP_OR
:

193 
»suÉ
 += "|";

195 
	gX­Ÿn
::
Qu”y
::
OP_FILTER
:

196 
»suÉ
 += "%";

198 
	gX­Ÿn
::
Qu”y
::
OP_AND_MAYBE
:

199 
»suÉ
 += "+";

201 
	gX­Ÿn
::
Qu”y
::
OP_AND_NOT
:

202 
»suÉ
 += "-";

204 
	gX­Ÿn
::
Qu”y
::
OP_XOR
:

205 
»suÉ
 += "^";

207 
	gX­Ÿn
::
Qu”y
::
OP_NEAR
:

208 
»suÉ
 +ğ"~" + 
’code_Ëngth
(
·¿m‘”
);

210 
	gX­Ÿn
::
Qu”y
::
OP_PHRASE
:

211 
»suÉ
 +ğ"\"" + 
’code_Ëngth
(
·¿m‘”
);

213 
	gX­Ÿn
::
Qu”y
::
OP_ELITE_SET
:

214 
»suÉ
 +ğ"*" + 
’code_Ëngth
(
·¿m‘”
);

216 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_RANGE
:

217 
»suÉ
 += "]";

218 
	g»suÉ
 +ğ
’code_Ëngth
(
Šame
.
Ëngth
());

219 
	g»suÉ
 +ğ
Šame
;

220 
	g»suÉ
 +ğ
’code_Ëngth
(
¡r_·¿m‘”
.
Ëngth
());

221 
	g»suÉ
 +ğ
¡r_·¿m‘”
;

222 
	g»suÉ
 +ğ
’code_Ëngth
(
·¿m‘”
);

224 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_GE
:

225 
»suÉ
 += "}";

226 
	g»suÉ
 +ğ
’code_Ëngth
(
Šame
.
Ëngth
());

227 
	g»suÉ
 +ğ
Šame
;

228 
	g»suÉ
 +ğ
’code_Ëngth
(
·¿m‘”
);

230 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_LE
:

231 
»suÉ
 += "{";

232 
	g»suÉ
 +ğ
’code_Ëngth
(
Šame
.
Ëngth
());

233 
	g»suÉ
 +ğ
Šame
;

234 
	g»suÉ
 +ğ
’code_Ëngth
(
·¿m‘”
);

236 
	gX­Ÿn
::
Qu”y
::
OP_SCALE_WEIGHT
:

237 
»suÉ
 += ".";

238 
	g»suÉ
 +ğ
¡r_·¿m‘”
;

240 
	gX­Ÿn
::
Qu”y
::
OP_SYNONYM
:

241 
»suÉ
 += "=";

245  
	g»suÉ
;

247 ()
	gcu½os
;

248 
throw
 
	gX­Ÿn
::
IÁ”ÇlE¼Ü
("query serialisation‚ot compiled in");

252 
¡ršg


253 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
g‘_İ_Çme
(
X­Ÿn
::Qu”y::IÁ”Çl::
İ_t
 
İ
)

255 
¡ršg
 
Çme
;

256 
	gİ
) {

257 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_EXTERNAL_SOURCE
:

258 
Çme
 = "EXTERNAL_SOURCE"; ;

259 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
: 
Çme
 = "LEAF"; ;

260 
	gX­Ÿn
::
Qu”y
::
OP_AND
: 
Çme
 = "AND"; ;

261 
	gX­Ÿn
::
Qu”y
::
OP_OR
: 
Çme
 = "OR"; ;

262 
	gX­Ÿn
::
Qu”y
::
OP_FILTER
: 
Çme
 = "FILTER"; ;

263 
	gX­Ÿn
::
Qu”y
::
OP_AND_MAYBE
: 
Çme
 = "AND_MAYBE"; ;

264 
	gX­Ÿn
::
Qu”y
::
OP_AND_NOT
: 
Çme
 = "AND_NOT"; ;

265 
	gX­Ÿn
::
Qu”y
::
OP_XOR
: 
Çme
 = "XOR"; ;

266 
	gX­Ÿn
::
Qu”y
::
OP_NEAR
: 
Çme
 = "NEAR"; ;

267 
	gX­Ÿn
::
Qu”y
::
OP_PHRASE
: 
Çme
 = "PHRASE"; ;

268 
	gX­Ÿn
::
Qu”y
::
OP_ELITE_SET
: 
Çme
 = "ELITE_SET"; ;

269 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_RANGE
: 
Çme
 = "VALUE_RANGE"; ;

270 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_GE
: 
Çme
 = "VALUE_GE"; ;

271 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_LE
: 
Çme
 = "VALUE_LE"; ;

272 
	gX­Ÿn
::
Qu”y
::
OP_SCALE_WEIGHT
: 
Çme
 = "SCALE_WEIGHT"; ;

273 
	gX­Ÿn
::
Qu”y
::
OP_SYNONYM
: 
Çme
 = "SYNONYM"; ;

275  
	gÇme
;

278 
¡ršg


279 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$g‘_desütiÚ
() const

281 
¡ršg
 
İ¡r
;

283 ià(
	`is_Ëaf
(
İ
)) {

284 ià(
‹rm_pos
 != 0) {

285 
İ¡r
 +ğ"pos=" + 
	`om_to¡ršg
(
‹rm_pos
);

288 ià(
·¿m‘”
 != 1) {

289 ià(!
İ¡r
.
	`em±y
()) opstr += ",";

290 
İ¡r
 +ğ"wqf=" + 
	`om_to¡ršg
(
·¿m‘”
);

292 ià(!
İ¡r
.
	`em±y
()) opstr = ":(" + opstr + ")";

293 ià(
Šame
.
	`em±y
()è "<®ldocum’ts>" + 
İ¡r
;

294  
Šame
 + 
İ¡r
;

297 
İ
) {

298 
X­Ÿn
::
Qu”y
::
OP_VALUE_RANGE
:

299 
İ¡r
 = 
	`g‘_İ_Çme
(
İ
);

300 
İ¡r
 += ' ';

301 
İ¡r
 +ğ
	`om_to¡ršg
(
·¿m‘”
);

302 
İ¡r
 += ' ';

303 
İ¡r
 +ğ
Šame
;

304 
İ¡r
 += ' ';

305 
İ¡r
 +ğ
¡r_·¿m‘”
;

306  
İ¡r
;

307 
X­Ÿn
::
Qu”y
::
OP_VALUE_GE
:

308 
X­Ÿn
::
Qu”y
::
OP_VALUE_LE
:

309 
İ¡r
 = 
	`g‘_İ_Çme
(
İ
);

310 
İ¡r
 += ' ';

311 
İ¡r
 +ğ
	`om_to¡ršg
(
·¿m‘”
);

312 
İ¡r
 += ' ';

313 
İ¡r
 +ğ
Šame
;

314  
İ¡r
;

315 
X­Ÿn
::
Qu”y
::
OP_SCALE_WEIGHT
:

316 
İ¡r
 +ğ
	`om_to¡ršg
(
	`g‘_dbl_·¿m‘”
());

317 
İ¡r
 += " * ";

318 
İ¡r
 +ğ
subqs
[0]->
	`g‘_desütiÚ
();

319  
İ¡r
;

320 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_EXTERNAL_SOURCE
:

321 
İ¡r
 = "PostingSource(";

322 
İ¡r
 +ğ
ex‹º®_sourû
->
	`g‘_desütiÚ
();

323 
İ¡r
 += ')';

324  
İ¡r
;

327 
İ¡r
 = " " + 
	`g‘_İ_Çme
(
İ
) + " ";

328 ià(
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_NEAR
 ||

329 
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_PHRASE
 ||

330 
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_ELITE_SET
)

331 
İ¡r
 +ğ
	`om_to¡ršg
(
·¿m‘”
) + " ";

333 
¡ršg
 
desütiÚ
;

334 
subqu”y_li¡
::
cÚ¡_™”©Ü
 
i
;

335 
i
 = 
subqs
.
	`begš
(); i !ğsubqs.
	`’d
(); i++) {

336 ià(!
desütiÚ
.
	`em±y
()èdesütiÚ +ğ
İ¡r
;

337 
desütiÚ
 +ğ(**
i
).
	`g‘_desütiÚ
();

340  "(" + 
desütiÚ
 + ")";

341 
	}
}

343 
	gX­Ÿn
::
‹rmcouÁ


344 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$g‘_Ëngth
() const

346 ià(
	`is_Ëaf
(
İ
)) {

348  
·¿m‘”
;

350 
X­Ÿn
::
‹rmcouÁ
 
Ën
 = 0;

351 
subqu”y_li¡
::
cÚ¡_™”©Ü
 
i
;

352 
i
 = 
subqs
.
	`begš
(); i !ğsubqs.
	`’d
(); ++i) {

353 
Ën
 +ğ(**
i
).
	`g‘_Ëngth
();

355  
Ën
;

356 
	}
}

360 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
accumuÏ‹_‹rms
(

361 
veùÜ
<
·œ
<
¡ršg
, 
X­Ÿn
::
‹rmpos
> > &
‹rms
) const

363 ià(
is_Ëaf
(
İ
)) {

366 ià(!
Šame
.
em±y
())

367 
‹rms
.
push_back
(
make_·œ
(
Šame
, 
‹rm_pos
));

369 
	gsubqu”y_li¡
::
cÚ¡_™”©Ü
 
’d
 = 
subqs
.end();

371 
	gsubqu”y_li¡
::
cÚ¡_™”©Ü
 
i
 = 
subqs
.
begš
(); 
	gi
 !ğ
’d
; ++i) {

372 (*
	gi
)->
accumuÏ‹_‹rms
(
‹rms
);

377 
	sLessByT”mpos
 {

378 cÚ¡ 
	t·œ
<
	t¡ršg
, 
	tX­Ÿn
::
	t‹rmpos
> 
	t¬gty³
;

379 
boŞ
 
İ”©Ü
()(
	m¬gty³
 &
	mËá
,‡rgty³ &
	mright
) {

380 ià(
	mËá
.
	m£cÚd
 !ğ
right
.
£cÚd
) {

381  
Ëá
.
£cÚd
 < 
right
.second;

383  
	mËá
.
	mfœ¡
 < 
	mright
.first;

388 
	gX­Ÿn
::
T”mI‹¿tÜ


389 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$g‘_‹rms
() const

391 
veùÜ
<
·œ
<
¡ršg
, 
X­Ÿn
::
‹rmpos
> > 
‹rms
;

392 
	`accumuÏ‹_‹rms
(
‹rms
);

394 
	`sÜt
(
‹rms
.
	`begš
(),”ms.
	`’d
(), 
	`LessByT”mpos
());

398 
veùÜ
<
·œ
<
¡ršg
, 
X­Ÿn
::
‹rmpos
> >::
™”©Ü
 
ÃwÏ¡
 =

399 
	`unique
(
‹rms
.
	`begš
(),”ms.
	`’d
());

401 
‹rms
.
	`”a£
(
ÃwÏ¡
,”ms.
	`’d
());

403 
veùÜ
<
¡ršg
> 
»suÉ
;

404 
veùÜ
<
·œ
<
¡ršg
, 
X­Ÿn
::
‹rmpos
> >::
cÚ¡_™”©Ü
 
i
;

405 
i
 = 
‹rms
.
	`begš
(); i !ğ‹rms.
	`’d
(); ++i) {

406 
»suÉ
.
	`push_back
(
i
->
fœ¡
);

409  
X­Ÿn
::
	`T”mI‹¿tÜ
(
Ãw
 
	`VeùÜT”mLi¡
(
»suÉ
.
	`begš
(),

410 
»suÉ
.
	`’d
()));

411 
	}
}

413 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


416 şas 
	cQUn£rŸl
 {

417 
	m´iv©e
:

418 cÚ¡ *
p
;

419 cÚ¡ *
	m’d
;

420 
	mX­Ÿn
::
‹rmpos
 
cu½os
;

421 cÚ¡ 
	mX­Ÿn
::
Regi¡ry
 & 
»g
;

423 
	mX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
»adqu”y
();

424 
	mX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
»adex‹º®
();

425 
	mX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
»adcompound
();

427 
	mpublic
:

428 
QUn£rŸl
(cÚ¡ 
¡ršg
 & 
s
, cÚ¡ 
X­Ÿn
::
Regi¡ry
 & 
»g_
)

429 : 
p
(
s
.
c_¡r
()), 
’d
Õ + s.
size
()), 
cu½os
(1), 
	$»g
(
»g_
) { }

430 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
	`decode
();

431 
	}
};

433 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

434 
QUn£rŸl
::
	$decode
() {

435 
	`LOGLINE
(
UNKNOWN
, "QUn£rŸl::decode(" << 
p
 << ")");

436 
AutoPŒ
<
X­Ÿn
::
Qu”y
::
IÁ”Çl
> 
	`qšt
(
	`»adqu”y
());

437 ià(
p
 !ğ
’d
)

438 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Bad serialised query");

439  
qšt
.
	`»Ëa£
();

440 
	}
}

442 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

443 
QUn£rŸl
::
	$»adqu”y
() {

444 ià(
p
 =ğ
’d
)

445 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Bad serialised query");

446 *
p
++) {

448 
size_t
 
Ëngth
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

449 
¡ršg
 
	`Šame
(
p
, 
Ëngth
);

450 
p
 +ğ
Ëngth
;

451 
X­Ÿn
::
‹rmpos
 
‹rm_pos
 = 
cu½os
;

452 
X­Ÿn
::
‹rmcouÁ
 
wqf
 = 1;

453 ià(
p
 !ğ
’d
) {

454 ià(*
p
 == '@') {

455 ++
p
;

456 
‹rm_pos
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
);

458 ià(*
p
 == '#') {

459 ++
p
;

460 
wqf
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
);

463 ++
cu½os
;

464  
Ãw
 
X­Ÿn
::
Qu”y
::
	`IÁ”Çl
(
Šame
, 
wqf
, 
‹rm_pos
);

467  
	`»adex‹º®
();

469  
	`»adcompound
();

471 
	`LOGLINE
(
UNKNOWN
, "Cª'ˆ·r£„emašd” `" << 
p
 - 1 << "'");

472 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Invalid query string");

474 
	}
}

476 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

477 
QUn£rŸl
::
	$»adex‹º®
()

479 ià(
p
 =ğ
’d
)

480 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Bad serialised query");

482 
size_t
 
Ëngth
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

483 
¡ršg
 
	`sourûÇme
(
p
, 
Ëngth
);

484 cÚ¡ 
X­Ÿn
::
Po¡šgSourû
 * 
sourû
 = 
»g
.
	`g‘_po¡šg_sourû
(
sourûÇme
);

485 ià(
sourû
 =ğ
NULL
) {

486 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Po¡šgSourû " + 
sourûÇme
 +

490 
p
 +ğ
Ëngth
;

491 
Ëngth
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

492 
¡ršg
 
	`sourûd©a
(
p
, 
Ëngth
);

493 
p
 +ğ
Ëngth
;

495  
Ãw
 
X­Ÿn
::
Qu”y
::
	`IÁ”Çl
(
sourû
->
	`un£rŸli£
(
sourûd©a
), 
Œue
);

496 
	}
}

498 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

499 
qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
İ
 op,

500 cÚ¡ 
veùÜ
<
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *> & 
vec
,

501 
X­Ÿn
::
‹rmcouÁ
 
·¿m‘”
 = 0)

503 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qšt
 = 
Ãw
 X­Ÿn::Qu”y::IÁ”Çl(
İ
, 
·¿m‘”
);

504 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *>::
cÚ¡_™”©Ü
 
i
;

505 
	gi
 = 
vec
.
begš
(); i !ğvec.
’d
(); i++) {

506 
	gqšt
->
add_subqu”y_nocİy
(*
i
);

508 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
r
 = 
qšt
->
’d_cÚ¡ruùiÚ
();

511 
As£¹Eq
(
r
, 
qšt
);

512  
	gr
;

515 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

516 
qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
İ
 op,

517 cÚ¡ 
veùÜ
<
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *> & 
vec
,

518 
X­Ÿn
::
‹rmcouÁ
 
·¿m‘”
,

519 
dbl_·¿m‘”
)

521 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qšt
 = 
Ãw
 
X­Ÿn
::Qu”y::IÁ”Çl(
İ
, 
·¿m‘”
);

522 
	gqšt
->
£t_dbl_·¿m‘”
(
dbl_·¿m‘”
);

523 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *>::
cÚ¡_™”©Ü
 
i
;

524 
	gi
 = 
vec
.
begš
(); i !ğvec.
’d
(); i++) {

525 
	gqšt
->
add_subqu”y_nocİy
(*
i
);

527 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
r
 = 
qšt
->
’d_cÚ¡ruùiÚ
();

530 
As£¹Eq
(
r
, 
qšt
);

531  
	gr
;

534 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

535 
QUn£rŸl
::
	$»adcompound
() {

536 
veùÜ
<
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *> 
subqs
;

537 
Œy
 {

538 
Œue
) {

539 ià(
p
 =ğ
’d
)

540 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Bad serialised query");

541 *
p
++) {

543 --
p
;

544 
subqs
.
	`push_back
(
	`»adqu”y
());

547 
subqs
.
	`push_back
(
	`»adex‹º®
());

550 
subqs
.
	`push_back
(
	`»adcompound
());

554  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_AND
, 
subqs
);

556  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_OR
, 
subqs
);

558  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_FILTER
, 
subqs
);

560  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_XOR
, 
subqs
);

562  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_AND_MAYBE
, 
subqs
);

564  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_AND_NOT
, 
subqs
);

566 
X­Ÿn
::
‹rmcouÁ
 
	`wšdow
(
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
));

567  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_NEAR
, 
subqs
, 
wšdow
);

570 
X­Ÿn
::
‹rmcouÁ
 
	`wšdow
(
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
));

571  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_PHRASE
, 
subqs
, 
wšdow
);

574 
X­Ÿn
::
‹rmcouÁ
 
	`–™e_£t_size
(
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
));

575  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_ELITE_SET
, 
subqs
,

576 
–™e_£t_size
);

579 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

580 
¡ršg
 
	`¡¬t
(
p
, 
Ën
);

581 
p
 +ğ
Ën
;

582 
Ën
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

583 
¡ršg
 
	`¡İ
(
p
, 
Ën
);

584 
p
 +ğ
Ën
;

585 
X­Ÿn
::
v®u’o
 
	`v®no
(
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
));

586  
Ãw
 
X­Ÿn
::
Qu”y
::
	`IÁ”Çl
(X­Ÿn::Qu”y::
OP_VALUE_RANGE
, 
v®no
,

587 
¡¬t
, 
¡İ
);

590 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

591 
¡ršg
 
	`¡¬t
(
p
, 
Ën
);

592 
p
 +ğ
Ën
;

593 
X­Ÿn
::
v®u’o
 
	`v®no
(
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
));

594  
Ãw
 
X­Ÿn
::
Qu”y
::
	`IÁ”Çl
(X­Ÿn::Qu”y::
OP_VALUE_GE
, 
v®no
,

595 
¡¬t
);

598 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

599 
¡ršg
 
	`¡¬t
(
p
, 
Ën
);

600 
p
 +ğ
Ën
;

601 
X­Ÿn
::
v®u’o
 
	`v®no
(
	`decode_Ëngth
(&
p
, 
’d
, 
çl£
));

602  
Ãw
 
X­Ÿn
::
Qu”y
::
	`IÁ”Çl
(X­Ÿn::Qu”y::
OP_VALUE_LE
, 
v®no
,

603 
¡¬t
);

606 
·¿m
 = 
	`un£rŸli£_doubË
(&
p
, 
’d
);

607  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_SCALE_WEIGHT
,

608 
subqs
, 0, 
·¿m
);

611  
	`qšt_äom_veùÜ
(
X­Ÿn
::
Qu”y
::
OP_SYNONYM
, 
subqs
);

614 
	`LOGLINE
(
UNKNOWN
, "Cª'ˆ·r£„emašd” `" << 
p
 - 1 << "'");

615 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Invalid query string");

618 } 
	`ÿtch
 (...) {

619 
veùÜ
<
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *>::
™”©Ü
 
i
;

620 
i
 = 
subqs
.
	`begš
(); i !ğsubqs.
	`’d
(); i++)

621 
d–‘e
 *
i
;

622 
throw
;

624 
	}
}

626 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

627 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
un£rŸli£
(cÚ¡ 
¡ršg
 &
s
,

628 cÚ¡ 
X­Ÿn
::
Regi¡ry
 & 
»g
)

630 
As£¹
(
s
.
Ëngth
() > 1);

631 
QUn£rŸl
 
u
(
s
, 
»g
);

632 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qšt
 = 
u
.
decode
();

633 
As£¹Eq
(
s
, 
qšt
->
£rŸli£
());

634  
	gqšt
;

637 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

638 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
un£rŸli£
(cÚ¡ 
¡ršg
 &, cÚ¡ X­Ÿn::
Regi¡ry
 &)

640 
throw
 
X­Ÿn
::
IÁ”ÇlE¼Ü
("query serialisation‚ot compiled in");

644 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::IÁ”Çl(cÚ¡ 
X­Ÿn
::Qu”y::IÁ”ÇÈ&
cİyme
)

645 : 
X­Ÿn
::
IÁ”Çl
::
RefCÁBa£
(),

646 
İ
(
cİyme
.op),

647 
subqs
(),

648 
·¿m‘”
(
cİyme
.parameter),

649 
Šame
(
cİyme
.tname),

650 
¡r_·¿m‘”
(
cİyme
.str_parameter),

651 
‹rm_pos
(
cİyme
.term_pos),

652 
ex‹º®_sourû
(
NULL
),

653 
	$ex‹º®_sourû_owÃd
(
çl£
)

655 
subqu”y_li¡
::
cÚ¡_™”©Ü
 
i
 = 
cİyme
.
subqs
.
	`begš
();

656 
i
 !ğ
cİyme
.
subqs
.
	`’d
();

657 ++
i
) {

658 
subqs
.
	`push_back
(
Ãw
 
X­Ÿn
::
Qu”y
::
	`IÁ”Çl
(**
i
));

660 ià(
cİyme
.
ex‹º®_sourû
) {

661 
ex‹º®_sourû
 = 
cİyme
.ex‹º®_sourû->
	`şÚe
();

662 ià(
ex‹º®_sourû
 =ğ
NULL
) {

663 
ex‹º®_sourû
 = 
cİyme
.external_source;

664 
ex‹º®_sourû_owÃd
 = 
çl£
;

666 
ex‹º®_sourû_owÃd
 = 
Œue
;

669 
	}
}

674 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::IÁ”Çl(cÚ¡ 
¡ršg
 & 
Šame_
, 
X­Ÿn
::
‹rmcouÁ
 
wqf_
,

675 
X­Ÿn
::
‹rmpos
 
‹rm_pos_
)

676 : 
İ
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
),

677 
subqs
(),

678 
·¿m‘”
(
wqf_
),

679 
Šame
(
Šame_
),

680 
‹rm_pos
(
‹rm_pos_
),

681 
ex‹º®_sourû
(
NULL
),

682 
	$ex‹º®_sourû_owÃd
(
çl£
)

684 
	`v®id©e_qu”y
();

685 
	}
}

687 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::IÁ”Çl(
İ_t
 
İ_
, 
X­Ÿn
::
‹rmcouÁ
 
·¿m‘”_
)

688 : 
İ
(
İ_
),

689 
subqs
(),

690 
·¿m‘”
(
·¿m‘”_
),

691 
Šame
(),

692 
‹rm_pos
(0),

693 
ex‹º®_sourû
(
NULL
),

694 
	$ex‹º®_sourû_owÃd
(
çl£
)

696 ià(
·¿m‘”
 !ğ0 && 
İ
 !ğ
OP_PHRASE
 && o°!ğ
OP_NEAR
 && o°!ğ
OP_ELITE_SET
)

697 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("parameter is only meaningful for OP_NEAR, OP_PHRASE, or OP_ELITE_SET");

698 
	}
}

700 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::IÁ”Çl(
İ_t
 
İ_
, 
X­Ÿn
::
v®u’o
 
v®no
,

701 cÚ¡ 
¡ršg
 &
begš
, cÚ¡ sŒšg &
’d
)

702 : 
İ
(
İ_
),

703 
·¿m‘”
(
X­Ÿn
::
‹rmcouÁ
(
v®no
)),

704 
Šame
(
begš
),

705 
¡r_·¿m‘”
(
’d
),

706 
ex‹º®_sourû
(
NULL
),

707 
	$ex‹º®_sourû_owÃd
(
çl£
)

709 ià(
İ
 !ğ
OP_VALUE_RANGE
)

710 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("This constructor is only meaningful for OP_VALUE_RANGE");

711 
	`v®id©e_qu”y
();

712 
	}
}

714 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::IÁ”Çl(
İ_t
 
İ_
, 
X­Ÿn
::
v®u’o
 
v®no
,

715 cÚ¡ 
¡d
::
¡ršg
 &
v®ue
)

716 : 
İ
(
İ_
),

717 
·¿m‘”
(
X­Ÿn
::
‹rmcouÁ
(
v®no
)),

718 
Šame
(
v®ue
),

719 
ex‹º®_sourû
(
NULL
),

720 
	$ex‹º®_sourû_owÃd
(
çl£
)

722 ià(
İ
 !ğ
OP_VALUE_GE
 && o°!ğ
OP_VALUE_LE
)

723 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("This constructor is only meaningful for OP_VALUE_GE or OP_VALUE_LE");

724 ià(
İ
 =ğ
OP_VALUE_GE
 && 
v®ue
.
	`em±y
()) {

726 
İ
 = 
OP_LEAF
;

727 
·¿m‘”
 = 1;

728 
‹rm_pos
 = 0;

730 
	`v®id©e_qu”y
();

731 
	}
}

733 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$IÁ”Çl
(
Po¡šgSourû
 * 
ex‹º®_sourû_
, 
boŞ
 
owÃd
)

734 : 
	`İ
(
OP_EXTERNAL_SOURCE
), 
	`ex‹º®_sourû
(
ex‹º®_sourû_
),

735 
	$ex‹º®_sourû_owÃd
(
owÃd
)

737 
	`As£¹
(
ex‹º®_sourû
);

738 
	}
}

740 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::~
	$IÁ”Çl
()

742 
subqu”y_li¡
::
™”©Ü
 
i
;

743 
i
 = 
subqs
.
	`begš
(); i !ğsubqs.
	`’d
(); i++) {

744 
d–‘e
 *
i
;

746 ià(
ex‹º®_sourû_owÃd
) {

747 
d–‘e
 
ex‹º®_sourû
;

749 
	}
}

751 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

752 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$’d_cÚ¡ruùiÚ
()

754 
	`DEBUGCALL
(
API
, , "Xapian::Query::Internal::end_construction", "");

755 
	`v®id©e_qu”y
();

756 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qšt
 = 
	`sim¶ify_qu”y
();

757 ià(
qšt
èqšt->
	`v®id©e_qu”y
();

758  
qšt
;

759 
	}
}

762 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$v®id©e_qu”y
() const

764 
	`DEBUGCALL
(
API
, , "Xapian::Query::Internal::validate_query", "");

767 ià(
subqs
.
	`size
(è< 
	`g‘_mš_subqs
(
İ
) ||

768 
subqs
.
	`size
(è> 
	`g‘_max_subqs
(
İ
)) {

769 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("X­Ÿn::Qu”y: " + 
	`g‘_İ_Çme
(
İ
) +

770 "„equœe ¨mšimum oà" + 
	`om_to¡ršg
(
	`g‘_mš_subqs
(
İ
)) +

771 "‡nd‡ maximum oà" + 
	`om_to¡ršg
(
	`g‘_max_subqs
(
İ
)) +

773 
	`om_to¡ršg
(
subqs
.
	`size
()) + ".");

776 ià(
İ
 =ğ
OP_SCALE_WEIGHT
 && 
	`g‘_dbl_·¿m‘”
() < 0) {

777 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("X­Ÿn::Qu”y: " + 
	`g‘_İ_Çme
(
İ
) + "„equires‡‚on-negative…arameter.");

782 
	`As£¹
(
	`is_Ëaf
(
İ
) ||

783 
İ
 =ğ
OP_VALUE_RANGE
 ||

784 
İ
 =ğ
OP_VALUE_GE
 ||

785 
İ
 =ğ
OP_VALUE_LE
 ||

786 
Šame
.
	`em±y
());

787 
	}
}

789 
boŞ


790 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$sim¶ify_m©chnÙhšg
()

792 
subqu”y_li¡
::
™”©Ü
 
sq
;

793 
İ
) {

794 
OP_PHRASE
:

795 
OP_NEAR
:

796 
OP_AND
:

797 
OP_FILTER
:

800 
sq
 = 
subqs
.
	`begš
(); sq !ğsubqs.
	`’d
(); sq++) {

801 ià(*
sq
 == 0) {

802 
sq
 = 
subqs
.
	`begš
(); sq !ğsubqs.
	`’d
(); sq++)

803 
d–‘e
 *
sq
;

804 
subqs
.
	`ş—r
();

805  
Œue
;

809 
OP_ELITE_SET
:

810 
OP_OR
:

811 
OP_XOR
:

812 
OP_SYNONYM
:

817 
sq
 = 
subqs
.
	`begš
();

818 
sq
 !ğ
subqs
.
	`’d
(è&& subqs.
	`size
() > 1) {

819 ià(*
sq
 == 0) {

820 
sq
 = 
subqs
.
	`”a£
(sq);

822 ++
sq
;

826 
OP_AND_MAYBE
:

827 
OP_AND_NOT
:

834 
	`As£¹
(
subqs
.
	`size
() == 2);

835 ià(
subqs
[0] == 0 || subqs[1] == 0) {

836 
sq
 = 
subqs
.
	`begš
();

837 ++
sq
;

838 
d–‘e
 *
sq
;

839 
subqs
.
	`”a£
(
sq
);

842 
OP_SCALE_WEIGHT
:

843 
	`As£¹
(
subqs
.
	`size
() == 1);

846 
	`As£¹
(
subqs
[0]);

848 
OP_LEAF
:

852  
çl£
;

853 
	}
}

855 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

856 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$sim¶ify_qu”y
()

858 
	`DEBUGCALL
(
API
, 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *, "Xapian::Query::Internal::simplify_query", "");

861 ià(
	`sim¶ify_m©chnÙhšg
()) {

866 
İ
) {

867 
OP_LEAF
:

868  
this
;

869 
OP_VALUE_RANGE
:

872 ià(
Šame
 > 
¡r_·¿m‘”
)  0;

873  
this
;

874 
OP_VALUE_GE
:

875 
OP_VALUE_LE
:

876  
this
;

877 
OP_SCALE_WEIGHT
:

878 ià(
	`çbs
(
	`g‘_dbl_·¿m‘”
(è- 1.0è> 
DBL_EPSILON
è 
this
;

882 
OP_PHRASE
: 
OP_NEAR
:

885 ià(
subqs
.
	`size
() <= 1) ;

888 ià(!
·¿m‘”
è·¿m‘” = 
subqs
.
	`size
();

891  
	`æ©‹n_subqs
();

892 
OP_ELITE_SET
:

893 ià(!
·¿m‘”
) {

896 ià(
subqs
.
	`size
() <= 100) {

897 
·¿m‘”
 = 10;

899 
·¿m‘”
 = 
X­Ÿn
::
	`‹rmcouÁ
(
	`û
(
	`sq¹
((
subqs
.
	`size
()))));

900 
	`As£¹
(
·¿m‘”
 > 10);

904 
OP_OR
: 
OP_AND
: 
OP_XOR
: 
OP_SYNONYM
:

906 ià(
subqs
.
	`size
(è> 1è
	`cŞÏp£_subqs
();

913 ià(
subqs
.
	`em±y
())

918 ià(
subqs
.
	`size
() == 1) {

919 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qšt
 = 
subqs
[0];

920 
subqs
[0] = 0;

921  
qšt
;

924  
this
;

925 
	}
}

927 
	sSÜtPosName
 {

928 
boŞ
 
İ”©Ü
()(cÚ¡ 
	mX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
Ëá
,

929 cÚ¡ 
	mX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
right
) const {

930 
As£¹
(
Ëá
 != 0);

931 
As£¹
(
right
 != 0);

932 
As£¹
(
is_Ëaf
(
Ëá
->
İ
));

933 
As£¹
(
is_Ëaf
(
right
->
İ
));

934 ià(
	mËá
->
	m‹rm_pos
 !ğ
right
->
‹rm_pos
) {

935  
Ëá
->
‹rm_pos
 < 
right
->term_pos;

937  
	mËá
->
	mŠame
 < 
	mright
->tname;

946 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$cŞÏp£_subqs
()

948 
	`As£¹
(
İ
 =ğ
OP_OR
 || o°=ğ
OP_AND
 || o°=ğ
OP_XOR
 || o°=ğ
OP_SYNONYM
);

949 
£t
<
	tX­Ÿn
::
	tQu”y
::
	tIÁ”Çl
 *, 
	tSÜtPosName
> 
	tsubqbË
;

950 
subqbË
 
sqb
;

952 
subqu”y_li¡
::
™”©Ü
 
sq
 = 
subqs
.
	`begš
();

953 
sq
 !ğ
subqs
.
	`’d
()) {

954 
	`As£¹
(*
sq
 != 0);

955 ià(
	`is_Ëaf
((*
sq
)->
İ
)) {

956 
	`As£¹
((*
sq
)->
subqs
.
	`em±y
());

957 
subqbË
::
™”©Ü
 
s
 = 
sqb
.
	`fšd
(*
sq
);

958 ià(
s
 =ğ
sqb
.
	`’d
()) {

959 
sqb
.
	`š£¹
(*
sq
);

960 ++
sq
;

962 
	`As£¹Eq
((*
s
)->
Šame
, (*
sq
)->tname);

963 
	`As£¹Eq
((*
s
)->
‹rm_pos
, (*
sq
)->term_pos);

965 (*
s
)->
·¿m‘”
 +ğ(*
sq
)->parameter;

969 
d–‘e
 *
sq
;

970 
sq
 = 
subqs
.
	`”a£
(sq);

973 ++
sq
;

976 
	}
}

979 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 *

980 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$æ©‹n_subqs
()

982 
	`As£¹
(
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_NEAR
 || o°=ğX­Ÿn::Qu”y::
OP_PHRASE
);

984 
subqu”y_li¡
::
™”©Ü
 
sq
;

985 
sq
 = 
subqs
.
	`begš
(); sq !ğsubqs.
	`’d
(); ++sq) {

986 ià(!
	`is_Ëaf
((*
sq
)->
İ
)) ;

989 ià(
sq
 =ğ
subqs
.
	`’d
()è 
this
;

991 ià((*
sq
)->
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_NEAR
 ||

992 (*
sq
)->
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_PHRASE
) {

994 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Can't use NEAR/PHRASE with‡ subexpression containing NEAR or PHRASE");

997 
AutoPŒ
<
X­Ÿn
::
Qu”y
::
IÁ”Çl
> 
	`æ©‹nme
(*
sq
);

998 *
sq
 = 0;

1000 
subqu”y_li¡
::
™”©Ü
 
j
;

1001 
j
 = 
æ©‹nme
->
subqs
.
	`begš
(); j !ğæ©‹nme->subqs.
	`’d
(); ++j) {

1002 *
sq
 = *
j
;

1003 *
j
 = 0;

1004 
AutoPŒ
<
X­Ÿn
::
Qu”y
::
IÁ”Çl
> 
	`Ãwq
(
Ãw
 X­Ÿn::Qu”y::
	`IÁ”Çl
(*
this
));

1005 
d–‘e
 *
sq
;

1006 *
sq
 = 0;

1007 
Ãwq
.
	`»£t
Òewq->
	`æ©‹n_subqs
());

1008 *
j
 = 
Ãwq
.
	`»Ëa£
();

1011 ià(
æ©‹nme
->
İ
 =ğ
OP_AND
 ||

1012 
æ©‹nme
->
İ
 =ğ
OP_OR
 ||

1013 
æ©‹nme
->
İ
 =ğ
OP_XOR
) {

1014 
size_t
 
i
 = 
æ©‹nme
->
subqs
.
	`size
();

1016 --
i
;

1017 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
q
 = 
æ©‹nme
->
subqs
[
i
];

1018 ià(
æ©‹nme
->
İ
 =ğ
q
->op) {

1019 
subqu”y_li¡
::
™”©Ü
 
k
;

1020 
k
 = 
q
->
subqs
.
	`begš
(), ++k;

1021 
k
 !ğ
q
->
subqs
.
	`’d
();

1022 ++
k
) {

1023 
æ©‹nme
->
subqs
.
	`push_back
(0);

1024 
æ©‹nme
->
subqs
.
	`back
(èğ*
k
;

1025 *
k
 = 0;

1027 
æ©‹nme
->
subqs
[
i
] = 
q
->subqs[0];

1028 
q
->
subqs
.
	`ş—r
();

1029 
d–‘e
 
q
;

1031 } 
i
 != 0);

1034  
æ©‹nme
.
	`»Ëa£
();

1035 
	}
}

1038 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
add_subqu”y
(cÚ¡ 
X­Ÿn
::Qu”y::IÁ”ÇÈ* 
subq
)

1040 
As£¹
(!
is_Ëaf
(
İ
));

1041 ià(
	gsubq
 == 0) {

1042 
subqs
.
push_back
(0);

1043 } ià(
	gİ
 =ğ
subq
->
İ
 && 
is_di¡ribubË
(op)) {

1045 
subqu”y_li¡
::
cÚ¡_™”©Ü
 
i
 = 
subq
->
subqs
.
begš
();

1046 
	gi
 !ğ
subq
->
subqs
.
’d
(); i++) {

1047 
add_subqu”y
(*
i
);

1050 
	gsubqs
.
push_back
(
Ãw
 
X­Ÿn
::
Qu”y
::
IÁ”Çl
(*
subq
));

1055 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
add_subqu”y_nocİy
(
X­Ÿn
::Qu”y::IÁ”ÇÈ* 
subq
)

1057 
As£¹
(!
is_Ëaf
(
İ
));

1058 ià(
	gsubq
 == 0) {

1059 
subqs
.
push_back
(0);

1060 } ià(
	gİ
 =ğ
subq
->
İ
 && 
is_di¡ribubË
(op)) {

1062 
subqu”y_li¡
::
cÚ¡_™”©Ü
 
i
 = 
subq
->
subqs
.
begš
();

1063 
	gi
 !ğ
subq
->
subqs
.
’d
(); i++) {

1064 
add_subqu”y
(*
i
);

1066 
d–‘e
 
	gsubq
;

1068 
	gsubqs
.
push_back
(
subq
);

1073 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$£t_dbl_·¿m‘”
(
dbl_·¿m‘”_
)

1079 
¡r_·¿m‘”
 = 
	`£rŸli£_doubË
(
dbl_·¿m‘”_
);

1080 
	}
}

1083 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
	$g‘_dbl_·¿m‘”
() const

1089 cÚ¡ * 
p
 = 
¡r_·¿m‘”
.
	`d©a
();

1090 cÚ¡ * 
’d
 = 
p
 + 
¡r_·¿m‘”
.
	`size
();

1091  
	`un£rŸli£_doubË
(&
p
, 
’d
);

1092 
	}
}

	@api/omtermlistiterator.cc

22 
	~<cÚfig.h
>

23 
	~<x­Ÿn/‹rm™”©Ü.h
>

24 
	~"‹rmli¡.h
"

25 
	~"pos™iÚli¡.h
"

26 
	~"omas£¹.h
"

27 
	~"omdebug.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

32 
šlše
 

33 
hªdË_´uÃ
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
T”mLi¡
>& 
Şd
, T”mLi¡ * 
»suÉ
)

35 ià(
	g»suÉ
) {

36 
	gŞd
 = 
»suÉ
;

40 
	gX­Ÿn
::
T”mI‹¿tÜ
::
	$T”mI‹¿tÜ
(
IÁ”Çl
 *
š‹º®_
)

41 : 
	$š‹º®
(
š‹º®_
)

43 ià(
š‹º®
.
	`g‘
()) {

45 
	`hªdË_´uÃ
(
š‹º®
, iÁ”Çl->
	`Ãxt
());

46 ià(
š‹º®
->
	`©_’d
()) internal = 0;

48 
	}
}

50 
	gX­Ÿn
::
T”mI‹¿tÜ
::
	$T”mI‹¿tÜ
(è: 
	$š‹º®
(0)

52 
	`DEBUGAPICALL
(, "Xapian::TermIterator::TermIterator", "");

53 
	}
}

55 
	gX­Ÿn
::
T”mI‹¿tÜ
::~
	$T”mI‹¿tÜ
() {

56 
	`DEBUGAPICALL
(, "Xapian::TermIterator::~TermIterator", "");

57 
	}
}

59 
	gX­Ÿn
::
T”mI‹¿tÜ
::T”mI‹¿tÜ(cÚ¡ 
X­Ÿn
::T”mI‹¿tÜ &
Ùh”
)

60 : 
	$š‹º®
(
Ùh”
.
š‹º®
)

62 
	`DEBUGAPICALL
(, "X­Ÿn::T”mI‹¿tÜ::T”mI‹¿tÜ", 
Ùh”
);

63 
	}
}

66 
	gX­Ÿn
::
T”mI‹¿tÜ
::
İ”©Ü
=(cÚ¡ 
X­Ÿn
::T”mI‹¿tÜ &
Ùh”
)

68 
DEBUGAPICALL
(, "X­Ÿn::T”mI‹¿tÜ::İ”©Ü=", 
Ùh”
);

69 
	gš‹º®
 = 
Ùh”
.
š‹º®
;

72 
¡ršg


73 
	gX­Ÿn
::
T”mI‹¿tÜ
::
İ”©Ü
 *() const

75 
DEBUGAPICALL
(
¡ršg
, "Xapian::TermIterator::operator*", "");

76 
As£¹
(
š‹º®
.
g‘
());

77 
As£¹
(!
š‹º®
->
©_’d
());

78 
RETURN
(
š‹º®
->
g‘_‹rmÇme
());

81 
	gX­Ÿn
::
‹rmcouÁ


82 
X­Ÿn
::
T”mI‹¿tÜ
::
	$g‘_wdf
() const

84 
	`DEBUGAPICALL
(
X­Ÿn
::
‹rmcouÁ
, "Xapian::TermIterator::get_wdf", "");

85 
	`As£¹
(
š‹º®
.
	`g‘
());

86 
	`As£¹
(!
š‹º®
->
	`©_’d
());

87 
	`RETURN
(
š‹º®
->
	`g‘_wdf
());

88 
	}
}

90 
	gX­Ÿn
::
doccouÁ


91 
X­Ÿn
::
T”mI‹¿tÜ
::
	$g‘_‹rmäeq
() const

93 
	`DEBUGAPICALL
(
X­Ÿn
::
doccouÁ
, "Xapian::TermIterator::get_termfreq", "");

94 
	`As£¹
(
š‹º®
.
	`g‘
());

95 
	`As£¹
(!
š‹º®
->
	`©_’d
());

96 
	`RETURN
(
š‹º®
->
	`g‘_‹rmäeq
());

97 
	}
}

99 
	gX­Ÿn
::
T”mI‹¿tÜ
 &

100 
X­Ÿn
::
T”mI‹¿tÜ
::
İ”©Ü
++()

102 
DEBUGAPICALL
(, "Xapian::TermIterator::operator++", "");

103 
As£¹
(
š‹º®
.
g‘
());

104 
As£¹
(!
š‹º®
->
©_’d
());

105 
hªdË_´uÃ
(
š‹º®
, iÁ”Çl->
Ãxt
());

106 ià(
	gš‹º®
->
©_’d
()) internal = 0;

107  *
	gthis
;

112 
	gX­Ÿn
::
T”mI‹¿tÜ
::
	$sk_to
(cÚ¡ 
¡ršg
 & 
Šame
)

114 
	`DEBUGAPICALL
(, "X­Ÿn::T”mI‹¿tÜ::sk_to", 
Šame
);

115 ià(
š‹º®
.
	`g‘
()) {

116 
	`As£¹
(!
š‹º®
->
	`©_’d
());

117 
	`hªdË_´uÃ
(
š‹º®
, iÁ”Çl->
	`sk_to
(
Šame
));

118 ià(
š‹º®
->
	`©_’d
()) internal = 0;

120 
	}
}

122 
	gX­Ÿn
::
‹rmcouÁ


123 
X­Ÿn
::
T”mI‹¿tÜ
::
	$pos™iÚli¡_couÁ
() const

125 
	`DEBUGAPICALL
(
X­Ÿn
::
‹rmcouÁ
, "Xapian::TermIterator::positionlist_count", "");

126 
	`As£¹
(
š‹º®
.
	`g‘
());

127 
	`As£¹
(!
š‹º®
->
	`©_’d
());

128 
	`RETURN
(
š‹º®
->
	`pos™iÚli¡_couÁ
());

129 
	}
}

131 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


132 
X­Ÿn
::
T”mI‹¿tÜ
::
	$pos™iÚli¡_begš
() const

134 
	`DEBUGAPICALL
(
X­Ÿn
::
Pos™iÚI‹¿tÜ
, "Xapian::TermIterator::positionlist_begin", "");

135 
	`As£¹
(
š‹º®
.
	`g‘
());

136 
	`As£¹
(!
š‹º®
->
	`©_’d
());

137 
	`RETURN
(
š‹º®
->
	`pos™iÚli¡_begš
());

138 
	}
}

140 
	g¡d
::
¡ršg


141 
X­Ÿn
::
T”mI‹¿tÜ
::
	$g‘_desütiÚ
() const

145 
	}
}

	@api/postingsource.cc

23 
	~<cÚfig.h
>

25 
	~"x­Ÿn/po¡šgsourû.h
"

27 
	~"autİŒ.h
"

29 
	~"d©aba£.h
"

30 
	~"docum’t.h
"

31 
	~"muÉim©ch.h
"

33 
	~"x­Ÿn/docum’t.h
"

34 
	~"x­Ÿn/”rÜ.h
"

35 
	~"x­Ÿn/qu”y·r£r.h
"

37 
	~"omas£¹.h
"

38 
	~"£rŸli£.h
"

39 
	~"£rŸli£-doubË.h
"

40 
	~"¡r.h
"

42 
	~<cæßt
>

44 
usšg
 
Çme¥aû
 
	g¡d
;

46 
Çme¥aû
 
	gX­Ÿn
 {

48 
	gPo¡šgSourû
::~
Po¡šgSourû
() { }

51 
Po¡šgSourû
::
£t_maxweight
(
X­Ÿn
::
weight
 
max_weight
)

53 ià(
usu®
(
m©ch”_
)) {

54 
MuÉiM©ch
 * 
muÉim©ch
 = 
¡©ic_ÿ¡
<MuÉiM©ch*>(
m©ch”_
);

55 
	gmuÉim©ch
->
»ÿlc_maxweight
();

57 
	gmax_weight_
 = 
max_weight
;

60 
	gX­Ÿn
::
weight


61 
Po¡šgSourû
::
g‘_weight
() const

67 
	gPo¡šgSourû
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
mš_wt
)

69 !
©_’d
(è&& 
g‘_docid
(è< 
did
) {

70 
Ãxt
(
mš_wt
);

74 
boŞ


75 
	gPo¡šgSourû
::
check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
mš_wt
)

77 
sk_to
(
did
, 
mš_wt
);

78  
	gŒue
;

81 
Po¡šgSourû
 *

82 
	gPo¡šgSourû
::
şÚe
() const

84  
NULL
;

87 
¡ršg


88 
	gPo¡šgSourû
::
Çme
() const

90  
¡ršg
();

93 
¡ršg


94 
	gPo¡šgSourû
::
£rŸli£
() const

96 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("serialise()‚ot supported forhis PostingSource");

99 
Po¡šgSourû
 *

100 
	gPo¡šgSourû
::
un£rŸli£
(cÚ¡ 
¡ršg
 &) const

102 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("unserialise()‚ot supported forhis PostingSource");

105 
¡ršg


106 
	gPo¡šgSourû
::
g‘_desütiÚ
() const

112 
	gV®uePo¡šgSourû
::
V®uePo¡šgSourû
(
X­Ÿn
::
v®u’o
 
¦Ù_
)

113 : 
¦Ù
(
¦Ù_
)

117 
X­Ÿn
::
doccouÁ


118 
V®uePo¡šgSourû
::
g‘_‹rmäeq_mš
() const

120  
‹rmäeq_mš
;

123 
	gX­Ÿn
::
doccouÁ


124 
V®uePo¡šgSourû
::
g‘_‹rmäeq_e¡
() const

126  
‹rmäeq_e¡
;

129 
	gX­Ÿn
::
doccouÁ


130 
V®uePo¡šgSourû
::
g‘_‹rmäeq_max
() const

132  
‹rmäeq_max
;

136 
	gV®uePo¡šgSourû
::
Ãxt
(
X­Ÿn
::
weight
 
mš_wt
)

138 ià(!
¡¬‹d
) {

139 
¡¬‹d
 = 
Œue
;

140 
	gv®ue_™
 = 
db
.
v®ue¡»am_begš
(
¦Ù
);

142 ++
	gv®ue_™
;

145 ià(
	gv®ue_™
 =ğ
db
.
v®ue¡»am_’d
(
¦Ù
)) ;

147 ià(
	gmš_wt
 > 
g‘_maxweight
()) {

148 
	gv®ue_™
 = 
db
.
v®ue¡»am_’d
(
¦Ù
);

154 
	gV®uePo¡šgSourû
::
sk_to
(
X­Ÿn
::
docid
 
mš_docid
,

155 
X­Ÿn
::
weight
 
mš_wt
)

157 ià(!
¡¬‹d
) {

158 
¡¬‹d
 = 
Œue
;

159 
	gv®ue_™
 = 
db
.
v®ue¡»am_begš
(
¦Ù
);

161 ià(
	gv®ue_™
 =ğ
db
.
v®ue¡»am_’d
(
¦Ù
)) ;

164 ià(
	gmš_wt
 > 
g‘_maxweight
()) {

165 
	gv®ue_™
 = 
db
.
v®ue¡»am_’d
(
¦Ù
);

168 
	gv®ue_™
.
sk_to
(
mš_docid
);

171 
boŞ


172 
	gV®uePo¡šgSourû
::
check
(
X­Ÿn
::
docid
 
mš_docid
,

173 
X­Ÿn
::
weight
 
mš_wt
)

175 ià(!
¡¬‹d
) {

176 
¡¬‹d
 = 
Œue
;

177 
	gv®ue_™
 = 
db
.
v®ue¡»am_begš
(
¦Ù
);

179 ià(
	gv®ue_™
 =ğ
db
.
v®ue¡»am_’d
(
¦Ù
)è 
Œue
;

182 ià(
	gmš_wt
 > 
g‘_maxweight
()) {

183 
	gv®ue_™
 = 
db
.
v®ue¡»am_’d
(
¦Ù
);

184  
	gŒue
;

186  
	gv®ue_™
.
check
(
mš_docid
);

189 
boŞ


190 
	gV®uePo¡šgSourû
::
©_’d
() const

192  
¡¬‹d
 && 
v®ue_™
 =ğ
db
.
v®ue¡»am_’d
(
¦Ù
);

195 
	gX­Ÿn
::
docid


196 
V®uePo¡šgSourû
::
g‘_docid
() const

198  
v®ue_™
.
g‘_docid
();

202 
	gV®uePo¡šgSourû
::
š™
(cÚ¡ 
D©aba£
 & 
db_
)

204 
db
 = 
db_
;

205 
	g¡¬‹d
 = 
çl£
;

206 
£t_maxweight
(
DBL_MAX
);

207 
	gŒy
 {

208 
	g‹rmäeq_max
 = 
db
.
g‘_v®ue_äeq
(
¦Ù
);

209 
	g‹rmäeq_e¡
 = 
‹rmäeq_max
;

210 
	g‹rmäeq_mš
 = 
‹rmäeq_max
;

211 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
Unim¶em’‹dE¼Ü
 &) {

212 
‹rmäeq_max
 = 
db
.
g‘_doccouÁ
();

213 
	g‹rmäeq_e¡
 = 
‹rmäeq_max
 / 2;

214 
	g‹rmäeq_mš
 = 0;

219 
	gV®ueWeightPo¡šgSourû
::
V®ueWeightPo¡šgSourû
(
X­Ÿn
::
v®u’o
 
¦Ù_
)

220 : 
V®uePo¡šgSourû
(
¦Ù_
)

224 
X­Ÿn
::
weight


225 
V®ueWeightPo¡šgSourû
::
g‘_weight
() const

227 
As£¹
(!
©_’d
());

228 
As£¹
(
¡¬‹d
);

229  
sÜbË_un£rŸli£
(*
v®ue_™
);

232 
V®ueWeightPo¡šgSourû
 *

233 
	gV®ueWeightPo¡šgSourû
::
şÚe
() const

235  
Ãw
 
V®ueWeightPo¡šgSourû
(
¦Ù
);

238 
¡ršg


239 
	gV®ueWeightPo¡šgSourû
::
Çme
() const

241  
¡ršg
("Xapian::ValueWeightPostingSource");

244 
¡ršg


245 
	gV®ueWeightPo¡šgSourû
::
£rŸli£
() const

247  
’code_Ëngth
(
¦Ù
);

250 
V®ueWeightPo¡šgSourû
 *

251 
	gV®ueWeightPo¡šgSourû
::
un£rŸli£
(cÚ¡ 
¡ršg
 &
s
) const

253 cÚ¡ * 
p
 = 
s
.
d©a
();

254 cÚ¡ * 
	g’d
 = 
p
 + 
s
.
size
();

256 
	gX­Ÿn
::
v®u’o
 
Ãw_v®no
 = 
decode_Ëngth
(&
p
, 
’d
, 
çl£
);

257 ià(
	gp
 !ğ
’d
) {

258 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Bad serialised ValueWeightPostingSource - junk‡tƒnd");

261  
Ãw
 
V®ueWeightPo¡šgSourû
(
Ãw_v®no
);

265 
	gV®ueWeightPo¡šgSourû
::
š™
(cÚ¡ 
D©aba£
 & 
db_
)

267 
V®uePo¡šgSourû
::
š™
(
db_
);

269 
¡ršg
 
	guµ”_bound
;

270 
	gŒy
 {

271 
	guµ”_bound
 = 
db
.
g‘_v®ue_uµ”_bound
(
¦Ù
);

272 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
Unim¶em’‹dE¼Ü
 &) {

277 ià(
	guµ”_bound
.
em±y
()) {

279 
£t_maxweight
(0.0);

281 
£t_maxweight
(
sÜbË_un£rŸli£
(
uµ”_bound
));

285 
¡ršg


286 
	gV®ueWeightPo¡šgSourû
::
g‘_desütiÚ
() const

288 
¡ršg
 
desc
("Xapian::ValueWeightPostingSource(slot=");

289 
	gdesc
 +ğ
¡r
(
¦Ù
);

290 
	gdesc
 += ")";

291  
	gdesc
;

295 
	gV®ueM­Po¡šgSourû
::
V®ueM­Po¡šgSourû
(
X­Ÿn
::
v®u’o
 
¦Ù_
)

296 : 
V®uePo¡šgSourû
(
¦Ù_
),

297 
deçuÉ_weight
(0.0),

298 
max_weight_š_m­
(0.0)

303 
	gV®ueM­Po¡šgSourû
::
add_m­pšg
(cÚ¡ 
¡ršg
 & 
key
, 
weight
)

305 
	gweight_m­
[
key
] = 
weight
;

306 
	gmax_weight_š_m­
 = 
max
(
weight
, 
max_weight_š_m­
);

310 
	gV®ueM­Po¡šgSourû
::
ş—r_m­pšgs
()

312 
weight_m­
.
ş—r
();

313 
	gmax_weight_š_m­
 = 0.0;

317 
	gV®ueM­Po¡šgSourû
::
£t_deçuÉ_weight
(
wt
)

319 
deçuÉ_weight
 = 
wt
;

322 
	gX­Ÿn
::
weight


323 
V®ueM­Po¡šgSourû
::
g‘_weight
() const

325 
m­
<
¡ršg
, >::
cÚ¡_™”©Ü
 
w™
 = 
weight_m­
.
fšd
(*
v®ue_™
);

326 ià(
	gw™
 =ğ
weight_m­
.
’d
()) {

327  
deçuÉ_weight
;

329  
	gw™
->
	g£cÚd
;

332 
V®ueM­Po¡šgSourû
 *

333 
	gV®ueM­Po¡šgSourû
::
şÚe
() const

335 
AutoPŒ
<
V®ueM­Po¡šgSourû
> 
»s
(
Ãw
 V®ueM­Po¡šgSourû(
¦Ù
));

336 
	gm­
<
	g¡ršg
, >::
cÚ¡_™”©Ü
 
i
;

337 
	gi
 = 
weight_m­
.
begš
(); i !ğweight_m­.
’d
(); ++i) {

338 
	g»s
->
add_m­pšg
(
i
->
fœ¡
, i->
£cÚd
);

340 
	g»s
->
£t_deçuÉ_weight
(
deçuÉ_weight
);

341  
	g»s
.
»Ëa£
();

344 
¡ršg


345 
	gV®ueM­Po¡šgSourû
::
Çme
() const

347  
¡ršg
("Xapian::ValueMapPostingSource");

350 
¡ršg


351 
	gV®ueM­Po¡šgSourû
::
£rŸli£
() const

353 
¡ršg
 
»suÉ
 = 
’code_Ëngth
(
¦Ù
);

354 
	g»suÉ
 +ğ
£rŸli£_doubË
(
deçuÉ_weight
);

356 
	gm­
<
	g¡ršg
, >::
cÚ¡_™”©Ü
 
i
;

357 
	gi
 = 
weight_m­
.
begš
(); i !ğweight_m­.
’d
(); ++i) {

358 
	g»suÉ
.
­³nd
(
’code_Ëngth
(
i
->
fœ¡
.
size
()));

359 
	g»suÉ
.
­³nd
(
i
->
fœ¡
);

360 
	g»suÉ
.
­³nd
(
£rŸli£_doubË
(
i
->
£cÚd
));

363  
	g»suÉ
;

366 
V®ueM­Po¡šgSourû
 *

367 
	gV®ueM­Po¡šgSourû
::
un£rŸli£
(cÚ¡ 
¡ršg
 &
s
) const

369 cÚ¡ * 
p
 = 
s
.
d©a
();

370 cÚ¡ * 
	g’d
 = 
p
 + 
s
.
size
();

372 
	gX­Ÿn
::
v®u’o
 
Ãw_¦Ù
 = 
decode_Ëngth
(&
p
, 
’d
, 
çl£
);

373 
	gAutoPŒ
<
	gV®ueM­Po¡šgSourû
> 
»s
(
Ãw
 
V®ueM­Po¡šgSourû
(
Ãw_¦Ù
));

374 
	g»s
->
£t_deçuÉ_weight
(
un£rŸli£_doubË
(&
p
, 
’d
));

375 
	gp
 !ğ
’d
) {

376 
size_t
 
keyËn
 = 
decode_Ëngth
(&
p
, 
’d
, 
Œue
);

377 
¡ršg
 
key
(
p
, 
keyËn
);

378 
	gp
 +ğ
keyËn
;

379 
	g»s
->
add_m­pšg
(
key
, 
un£rŸli£_doubË
(&
p
, 
’d
));

381  
	g»s
.
»Ëa£
();

385 
	gV®ueM­Po¡šgSourû
::
š™
(cÚ¡ 
D©aba£
 & 
db_
)

387 
V®uePo¡šgSourû
::
š™
(
db_
);

388 
£t_maxweight
(
max
(
max_weight_š_m­
, 
deçuÉ_weight
));

391 
¡ršg


392 
	gV®ueM­Po¡šgSourû
::
g‘_desütiÚ
() const

394 
¡ršg
 
desc
("Xapian::ValueMapPostingSource(slot=");

395 
	gdesc
 +ğ
¡r
(
¦Ù
);

396 
	gdesc
 += ")";

397  
	gdesc
;

400 
	gFixedWeightPo¡šgSourû
::
FixedWeightPo¡šgSourû
(
X­Ÿn
::
weight
 
wt
)

401 : 
¡¬‹d
(
çl£
)

405 
£t_maxweight
(
wt
);

408 
	gX­Ÿn
::
doccouÁ


409 
FixedWeightPo¡šgSourû
::
g‘_‹rmäeq_mš
() const

411  
‹rmäeq
;

414 
	gX­Ÿn
::
doccouÁ


415 
FixedWeightPo¡šgSourû
::
g‘_‹rmäeq_e¡
() const

417  
‹rmäeq
;

420 
	gX­Ÿn
::
doccouÁ


421 
FixedWeightPo¡šgSourû
::
g‘_‹rmäeq_max
() const

423  
‹rmäeq
;

426 
	gX­Ÿn
::
weight


427 
FixedWeightPo¡šgSourû
::
g‘_weight
() const

429  
g‘_maxweight
();

433 
	gFixedWeightPo¡šgSourû
::
Ãxt
(
X­Ÿn
::
weight
 
mš_wt
)

435 ià(!
¡¬‹d
) {

436 
¡¬‹d
 = 
Œue
;

437 
	g™
 = 
db
.
po¡li¡_begš
(
¡ršg
());

439 ++
	g™
;

442 ià(
	g™
 =ğ
db
.
po¡li¡_’d
(
¡ršg
())) ;

444 ià(
	gcheck_docid
) {

445 
	g™
.
sk_to
(
check_docid
 + 1);

446 
	gcheck_docid
 = 0;

449 ià(
	gmš_wt
 > 
g‘_maxweight
()) {

450 
	g™
 = 
db
.
po¡li¡_’d
(
¡ršg
());

455 
	gFixedWeightPo¡šgSourû
::
sk_to
(
X­Ÿn
::
docid
 
mš_docid
,

456 
X­Ÿn
::
weight
 
mš_wt
)

458 ià(!
¡¬‹d
) {

459 
¡¬‹d
 = 
Œue
;

460 
	g™
 = 
db
.
po¡li¡_begš
(
¡ršg
());

462 ià(
	g™
 =ğ
db
.
po¡li¡_’d
(
¡ršg
())) ;

465 ià(
	gcheck_docid
) {

466 ià(
	gmš_docid
 < 
	gcheck_docid
)

467 
	gmš_docid
 = 
check_docid
 + 1;

468 
	gcheck_docid
 = 0;

471 ià(
	gmš_wt
 > 
g‘_maxweight
()) {

472 
	g™
 = 
db
.
po¡li¡_’d
(
¡ršg
());

475 
	g™
.
sk_to
(
mš_docid
);

478 
boŞ


479 
	gFixedWeightPo¡šgSourû
::
check
(
X­Ÿn
::
docid
 
mš_docid
,

480 
X­Ÿn
::
weight
)

484 
check_docid
 = 
mš_docid
;

485  
	gŒue
;

488 
boŞ


489 
	gFixedWeightPo¡šgSourû
::
©_’d
() const

491 ià(
check_docid
 !ğ0è 
çl£
;

492  
	g¡¬‹d
 && 
	g™
 =ğ
db
.
po¡li¡_’d
(
¡ršg
());

495 
	gX­Ÿn
::
docid


496 
FixedWeightPo¡šgSourû
::
g‘_docid
() const

498 ià(
check_docid
 != 0)  check_docid;

499  *
	g™
;

502 
FixedWeightPo¡šgSourû
 *

503 
	gFixedWeightPo¡šgSourû
::
şÚe
() const

505  
Ãw
 
FixedWeightPo¡šgSourû
(
g‘_maxweight
());

508 
¡ršg


509 
	gFixedWeightPo¡šgSourû
::
Çme
() const

511  
¡ršg
("Xapian::FixedWeightPostingSource");

514 
¡ršg


515 
	gFixedWeightPo¡šgSourû
::
£rŸli£
() const

517  
£rŸli£_doubË
(
g‘_maxweight
());

520 
FixedWeightPo¡šgSourû
 *

521 
	gFixedWeightPo¡šgSourû
::
un£rŸli£
(cÚ¡ 
¡ršg
 &
s
) const

523 cÚ¡ * 
p
 = 
s
.
d©a
();

524 cÚ¡ * 
	gs_’d
 = 
p
 + 
s
.
size
();

525 
	gÃw_wt
 = 
un£rŸli£_doubË
(&
p
, 
s_’d
);

526 ià(
	gp
 !ğ
s_’d
) {

527 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Bad serialised ValueWeightPostingSource - junk‡tƒnd");

529  
Ãw
 
FixedWeightPo¡šgSourû
(
Ãw_wt
);

533 
	gFixedWeightPo¡šgSourû
::
š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db_
)

535 
db
 = 
db_
;

536 
	g‹rmäeq
 = 
db_
.
g‘_doccouÁ
();

537 
	g¡¬‹d
 = 
çl£
;

538 
	gcheck_docid
 = 0;

541 
¡ršg


542 
	gFixedWeightPo¡šgSourû
::
g‘_desütiÚ
() const

544 
¡ršg
 
desc
("Xapian::FixedWeightPostingSource(wt=");

545 
	gdesc
 +ğ
¡r
(
g‘_maxweight
());

546 
	gdesc
 += ")";

547  
	gdesc
;

	@api/postlist.cc

21 
	~<cÚfig.h
>

23 
	~"po¡li¡.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"omas£¹.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
Çme¥aû
 
	gX­Ÿn
 {

33 
	gPo¡šgI‹¿tÜ
::
IÁ”Çl
::~Internal() { }

35 
T”mF»qs


36 
Po¡šgI‹¿tÜ
::
IÁ”Çl
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

37 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 &) const

39 
throw
 
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
(

43 
	gX­Ÿn
::
‹rmcouÁ


44 
Po¡šgI‹¿tÜ
::
IÁ”Çl
::
g‘_wdf
() const

46 
throw
 
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("get_wdf()‚ot meaningful forhis PostingIterator");

49 cÚ¡ 
¡ršg
 *

50 
	gPo¡šgI‹¿tÜ
::
IÁ”Çl
::
g‘_cŞÏp£_key
() const

52  
NULL
;

55 
Pos™iÚLi¡
 *

56 
	gPo¡Li¡
::
»ad_pos™iÚ_li¡
()

58 
throw
 
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("read_position_list()‚ot meaningful forhis PostingIterator");

61 
Pos™iÚLi¡
 *

62 
	gPo¡Li¡
::
İ’_pos™iÚ_li¡
() const

64 
throw
 
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("open_position_list()‚ot meaningful forhis PostingIterator");

67 
Po¡Li¡
 *

68 
	gPo¡Li¡
::
check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
, 
boŞ
 &
v®id
)

70 
	gv®id
 = 
Œue
;

71  
sk_to
(
did
, 
w_mš
);

74 
	gX­Ÿn
::
‹rmcouÁ


75 
Po¡Li¡
::
couÁ_m©chšg_subqs
() const

77 
As£¹
(
çl£
);

	@api/registry.cc

22 
	~<cÚfig.h
>

24 
	~"x­Ÿn/»gi¡ry.h
"

26 
	~"x­Ÿn/”rÜ.h
"

27 
	~"x­Ÿn/m©ch¥y.h
"

28 
	~"x­Ÿn/po¡šgsourû.h
"

29 
	~"x­Ÿn/weight.h
"

31 
	~"»gi¡ryš‹º®.h
"

32 
	~"omdebug.h
"

34 
	~<®gÜ™hm
>

35 
	~<m­
>

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	g‹m¶©e
<
şass
 
	gT
>

40 
šlše
 

41 
»gi¡”_objeù
(
m­
<
¡ršg
, 
T
*> & 
»gi¡ry
, cÚ¡ T & 
obj
)

43 
¡ršg
 
	gÇme
 = 
obj
.
Çme
();

44 ià(
¿»
(
Çme
.
em±y
())) {

45 
throw
 
	gX­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("Unableo„egister object -‚ame() method„eturnedƒmpty string");

48 
	g·œ
<
ty³Çme
 
	gm­
<
	g¡ršg
, 
	gT
 *>::
™”©Ü
, 
	gboŞ
> 
	gr
;

49 
	gr
 = 
»gi¡ry
.
š£¹
(
make_·œ
(
Çme
, 
¡©ic_ÿ¡
<
T
*>(
NULL
)));

50 ià(!
	gr
.
	g£cÚd
) {

59 
T
 * 
	gp
 = 
NULL
;

60 
sw­
(
p
, 
r
.
fœ¡
->
£cÚd
);

61 
d–‘e
 
	gp
;

64 
T
 * 
	gşÚe
 = 
obj
.
şÚe
();

65 ià(
¿»
(!
şÚe
)) {

66 
throw
 
	gX­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("Unableo„egister object - clone() method„eturned NULL");

69 
	gr
.
	gfœ¡
->
	g£cÚd
 = 
şÚe
;

72 
	g‹m¶©e
<
şass
 
	gT
>

73 
šlše
 cÚ¡ 
T
 *

74 
lookup_objeù
(
m­
<
¡ršg
, 
T
*> 
»gi¡ry
, cÚ¡ sŒšg & 
Çme
)

76 
ty³Çme
 
	gm­
<
	g¡ršg
, 
	gT
*>::
cÚ¡_™”©Ü
 
i
 = 
»gi¡ry
.
fšd
(
Çme
);

77 ià(
	gi
 =ğ
»gi¡ry
.
’d
()) {

78  
NULL
;

80  
	gi
->
	g£cÚd
;

83 
Çme¥aû
 
	gX­Ÿn
 {

85 
	gRegi¡ry
::
Regi¡ry
(cÚ¡ Regi¡ry & 
Ùh”
)

86 : 
š‹º®
(
Ùh”
.internal)

88 
LOGCALL_CTOR
(
API
, "Xapian::Registry::Registry", "other");

91 
	gRegi¡ry
 &

92 
	gRegi¡ry
::
İ”©Ü
=(cÚ¡ 
Regi¡ry
 & 
Ùh”
)

94 
LOGCALL
(
API
, 
X­Ÿn
::
Regi¡ry
 &, "Xapian::Registry::operator=", "other");

95 
	gš‹º®
 = 
Ùh”
.
š‹º®
;

96 (*
	gthis
);

99 
	gRegi¡ry
::
Regi¡ry
()

100 : 
š‹º®
(
Ãw
 
Regi¡ry
::
IÁ”Çl
())

102 
LOGCALL_CTOR
(
API
, "Xapian::Registry::Registry", "");

105 
	gRegi¡ry
::~
Regi¡ry
()

107 
LOGCALL_DTOR
(
API
, "Xapian::Registry::~Registry");

116 
	gRegi¡ry
::
»gi¡”_weightšg_scheme
(cÚ¡ 
X­Ÿn
::
Weight
 &
wt
)

118 
LOGCALL_VOID
(
API
, "X­Ÿn::Regi¡ry::»gi¡”_weightšg_scheme", 
wt
.
Çme
());

119 
»gi¡”_objeù
(
š‹º®
->
wtschemes
, 
wt
);

122 cÚ¡ 
	gX­Ÿn
::
Weight
 *

123 
Regi¡ry
::
g‘_weightšg_scheme
(cÚ¡ 
¡ršg
 & 
Çme
) const

125 
LOGCALL
(
API
, cÚ¡ 
X­Ÿn
::
Weight
 *, "X­Ÿn::Regi¡ry::g‘_weightšg_scheme", 
Çme
);

126 
RETURN
(
lookup_objeù
(
š‹º®
->
wtschemes
, 
Çme
));

130 
	gRegi¡ry
::
»gi¡”_po¡šg_sourû
(cÚ¡ 
X­Ÿn
::
Po¡šgSourû
 &
sourû
)

132 
LOGCALL_VOID
(
API
, "X­Ÿn::Regi¡ry::»gi¡”_po¡šg_sourû", 
sourû
.
Çme
());

133 
»gi¡”_objeù
(
š‹º®
->
po¡šgsourûs
, 
sourû
);

136 cÚ¡ 
	gX­Ÿn
::
Po¡šgSourû
 *

137 
Regi¡ry
::
g‘_po¡šg_sourû
(cÚ¡ 
¡ršg
 & 
Çme
) const

139 
LOGCALL
(
API
, cÚ¡ 
X­Ÿn
::
Po¡šgSourû
 *, "X­Ÿn::Regi¡ry::g‘_po¡šg_sourû", 
Çme
);

140 
RETURN
(
lookup_objeù
(
š‹º®
->
po¡šgsourûs
, 
Çme
));

144 
	gRegi¡ry
::
»gi¡”_m©ch_¥y
(cÚ¡ 
X­Ÿn
::
M©chSpy
 &
¥y
)

146 
LOGCALL_VOID
(
API
, "X­Ÿn::Regi¡ry::»gi¡”_m©ch_¥y", 
¥y
.
Çme
());

147 
»gi¡”_objeù
(
š‹º®
->
m©ch¥›s
, 
¥y
);

150 cÚ¡ 
	gX­Ÿn
::
M©chSpy
 *

151 
Regi¡ry
::
g‘_m©ch_¥y
(cÚ¡ 
¡ršg
 & 
Çme
) const

153 
LOGCALL
(
API
, cÚ¡ 
X­Ÿn
::
M©chSpy
 *, "X­Ÿn::Regi¡ry::g‘_m©ch_¥y", 
Çme
);

154 
RETURN
(
lookup_objeù
(
š‹º®
->
m©ch¥›s
, 
Çme
));

158 
	gRegi¡ry
::
IÁ”Çl
::Internal()

159 : 
X­Ÿn
::
IÁ”Çl
::
RefCÁBa£
(),

160 
wtschemes
(),

161 
po¡šgsourûs
()

163 
add_deçuÉs
();

166 
	gRegi¡ry
::
IÁ”Çl
::~Internal()

168 
ş—r_weightšg_schemes
();

169 
ş—r_po¡šg_sourûs
();

170 
ş—r_m©ch_¥›s
();

174 
	gRegi¡ry
::
IÁ”Çl
::
add_deçuÉs
()

176 
X­Ÿn
::
Weight
 * 
weight
;

177 
	gweight
 = 
Ãw
 
X­Ÿn
::
BM25Weight
;

178 
	gwtschemes
[
weight
->
Çme
()] = weight;

179 
	gweight
 = 
Ãw
 
X­Ÿn
::
BoŞWeight
;

180 
	gwtschemes
[
weight
->
Çme
()] = weight;

181 
	gweight
 = 
Ãw
 
X­Ÿn
::
T¿dWeight
;

182 
	gwtschemes
[
weight
->
Çme
()] = weight;

184 
	gX­Ÿn
::
Po¡šgSourû
 * 
sourû
;

185 
	gsourû
 = 
Ãw
 
X­Ÿn
::
V®ueWeightPo¡šgSourû
(0);

186 
	gpo¡šgsourûs
[
sourû
->
Çme
()] = source;

187 
	gsourû
 = 
Ãw
 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
(0);

188 
	gpo¡šgsourûs
[
sourû
->
Çme
()] = source;

189 
	gsourû
 = 
Ãw
 
X­Ÿn
::
V®ueM­Po¡šgSourû
(0);

190 
	gpo¡šgsourûs
[
sourû
->
Çme
()] = source;

191 
	gsourû
 = 
Ãw
 
X­Ÿn
::
FixedWeightPo¡šgSourû
(0.0);

192 
	gpo¡šgsourûs
[
sourû
->
Çme
()] = source;

194 
	gX­Ÿn
::
M©chSpy
 * 
¥y
;

195 
	g¥y
 = 
Ãw
 
X­Ÿn
::
V®ueCouÁM©chSpy
();

196 
	gm©ch¥›s
[
¥y
->
Çme
()] = spy;

200 
	gRegi¡ry
::
IÁ”Çl
::
ş—r_weightšg_schemes
()

202 
m­
<
¡ršg
, 
	gX­Ÿn
::
Weight
*>::
cÚ¡_™”©Ü
 
i
;

203 
	gi
 = 
wtschemes
.
begš
(); i !ğwtschemes.
’d
(); ++i) {

204 
d–‘e
 
	gi
->
	g£cÚd
;

209 
	gRegi¡ry
::
IÁ”Çl
::
ş—r_po¡šg_sourûs
()

211 
m­
<
¡ršg
, 
	gX­Ÿn
::
Po¡šgSourû
 *>::
cÚ¡_™”©Ü
 
i
;

212 
	gi
 = 
po¡šgsourûs
.
begš
(); i !ğpo¡šgsourûs.
’d
(); ++i) {

213 
d–‘e
 
	gi
->
	g£cÚd
;

218 
	gRegi¡ry
::
IÁ”Çl
::
ş—r_m©ch_¥›s
()

220 
m­
<
¡ršg
, 
	gX­Ÿn
::
M©chSpy
 *>::
cÚ¡_™”©Ü
 
i
;

221 
	gi
 = 
m©ch¥›s
.
begš
(); i !ğm©ch¥›s.
’d
(); ++i) {

222 
d–‘e
 
	gi
->
	g£cÚd
;

	@api/replication.cc

22 
	~<cÚfig.h
>

24 
	~"»¶iÿtiÚ.h
"

26 
	~"x­Ÿn/ba£.h
"

27 
	~"x­Ÿn/dbçùÜy.h
"

28 
	~"x­Ÿn/”rÜ.h
"

29 
	~"x­Ÿn/v”siÚ.h
"

31 
	~"d©aba£.h
"

32 
	~"d©aba£»¶iÿtÜ.h
"

33 
	~"feuts.h
"

34 #ifdeà
__WIN32__


35 
	~"msvc_posix_w¿µ”.h
"

37 
	~"omas£¹.h
"

38 
	~"omdebug.h
"

39 
	~"omtime.h
"

40 
	~"»mÙecÚÃùiÚ.h
"

41 
	~"»¶iÿtiÚ´ÙocŞ.h
"

42 
	~"§ã”ºo.h
"

43 
	~"§ãsys¡©.h
"

44 
	~"§ãuni¡d.h
"

45 
	~"£rŸli£.h
"

46 
	~"uts.h
"

48 
	~<autİŒ.h
>

49 
	~<c¡dio
>

50 
	~<f¡»am
>

51 
	~<¡ršg
>

53 
usšg
 
Çme¥aû
 
	g¡d
;

54 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

57 
	#REPLICA_STUB_BANNER
 \

58 "# Autom©iÿÎy g’”©ed by X­Ÿn::D©aba£R•liÿ v"
XAPIAN_VERSION
".\n" \

59 "# DØnÙ mªu®lyƒd™ -„•liÿtiÚ o³¿tiÚ may„eg’”©thi fe.\n"

	)

62 
	gD©aba£Ma¡”
::
	$wr™e_chªge£ts_to_fd
(
fd
,

63 cÚ¡ 
¡ršg
 & 
¡¬t_»visiÚ
,

64 
R•liÿtiÚInfo
 * 
šfo
) const

66 
	`DEBUGAPICALL
(, "Xapian::DatabaseMaster::write_changesets_to_fd",

67 
fd
 << ", " << 
¡¬t_»visiÚ
 << ", " << 
šfo
);

68 ià(
šfo
 !ğ
NULL
)

69 
šfo
->
	`ş—r
();

70 
D©aba£
 
db
;

71 
Œy
 {

72 
db
 = 
	`D©aba£
(
·th
);

73 } 
	`ÿtch
 (
X­Ÿn
::
D©aba£E¼Ü
 & 
e
) {

74 
RemÙeCÚÃùiÚ
 
	`cÚn
(-1, 
fd
, "");

75 
OmTime
 
’d_time
;

76 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_FAIL
,

77 "Cª'ˆİ’ d©aba£: " + 
e
.
	`g‘_msg
(),

78 
’d_time
);

81 ià(
db
.
š‹º®
.
	`size
() != 1) {

82 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("DatabaseMaster‚eedso be…ointed‡tƒxactly one subdatabase");

86 
boŞ
 
Ãed_whŞe_db
 = 
çl£
;

87 
¡ršg
 
»visiÚ
;

88 ià(
¡¬t_»visiÚ
.
	`em±y
()) {

89 
Ãed_whŞe_db
 = 
Œue
;

91 cÚ¡ * 
±r
 = 
¡¬t_»visiÚ
.
	`d©a
();

92 cÚ¡ * 
’d
 = 
±r
 + 
¡¬t_»visiÚ
.
	`size
();

93 
size_t
 
uuid_Ëngth
 = 
	`decode_Ëngth
(&
±r
, 
’d
, 
Œue
);

94 
¡ršg
 
	`»que¡_uuid
(
±r
, 
uuid_Ëngth
);

95 
±r
 +ğ
uuid_Ëngth
;

96 
¡ršg
 
db_uuid
 = 
db
.
š‹º®
[0]->
	`g‘_uuid
();

97 ià(
»que¡_uuid
 !ğ
db_uuid
) {

98 
Ãed_whŞe_db
 = 
Œue
;

100 
»visiÚ
.
	`assign
(
±r
, 
’d
 -…tr);

103 
db
.
š‹º®
[0]->
	`wr™e_chªge£ts_to_fd
(
fd
, 
»visiÚ
, 
Ãed_whŞe_db
, 
šfo
);

104 
	}
}

106 
¡ršg


107 
	gD©aba£Ma¡”
::
	$g‘_desütiÚ
() const

109  "D©aba£Ma¡”(" + 
·th
 + ")";

110 
	}
}

113 şas 
	cD©aba£R•liÿ
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

115 
İ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

118 
IÁ”Çl
(const Internal &);

121 
¡ršg
 
	m·th
;

124 
	mlive_id
;

127 
Wr™abËD©aba£
 
	mlive_db
;

134 
boŞ
 
	mhave_ofæše_db
;

138 
boŞ
 
	mÃed_cİy_Ãxt
;

142 
¡ršg
 
	mofæše_»visiÚ
;

146 
¡ršg
 
	mofæše_uuid
;

151 
¡ršg
 
	mofæše_Ãeded_»visiÚ
;

154 
RemÙeCÚÃùiÚ
 * 
	mcÚn
;

162 
	$upd©e_¡ub_d©aba£
() const;

165 
	`»move_ofæše_db
();

169 
	`­¶y_db_cİy
(cÚ¡ 
OmTime
 & 
’d_time
);

175 
	$check_mes§ge_ty³
(
ty³
, 
ex³ùed
) const;

183 
boŞ
 
	`possibly_make_ofæše_live
();

185 
¡ršg
 
	$g‘_»¶iÿ_·th
(
id
) const {

186 
¡ršg
 
p
 = 
·th
;

187 
p
 += "/replica_";

188 
p
 +ğ('0' + 
id
);

189  
p
;

192 
public
:

194 
	`IÁ”Çl
(cÚ¡ 
¡ršg
 & 
·th_
);

197 ~
	$IÁ”Çl
(è{ 
d–‘e
 
cÚn
; 
	}
}

200 
¡ršg
 
	$g‘_»visiÚ_šfo
() const;

203 
	`£t_»ad_fd
(
fd
);

206 
boŞ
 
	`­¶y_Ãxt_chªge£t
(
R•liÿtiÚInfo
 * 
šfo
);

209 
¡ršg
 
	$g‘_desütiÚ
(ècÚ¡ {  
·th
; 
	}
}

214 
	gD©aba£R•liÿ
::
	$D©aba£R•liÿ
(cÚ¡ 
D©aba£R•liÿ
 & 
Ùh”
)

215 : 
	$š‹º®
(
Ùh”
.
š‹º®
)

217 
	`DEBUGAPICALL
(, "X­Ÿn::D©aba£R•liÿ::D©aba£R•liÿ", 
Ùh”
);

218 
	}
}

221 
	gD©aba£R•liÿ
::
İ”©Ü
=(cÚ¡ 
D©aba£R•liÿ
 & 
Ùh”
)

223 
DEBUGAPICALL
(, "X­Ÿn::D©aba£R•liÿ::İ”©Ü=", 
Ùh”
);

224 
	gš‹º®
 = 
Ùh”
.
š‹º®
;

227 
	gD©aba£R•liÿ
::
	$D©aba£R•liÿ
()

228 : 
	$š‹º®
(0)

230 
	`DEBUGAPICALL
(, "Xapian::DatabaseReplica::DatabaseReplica", "");

231 
	}
}

233 
	gD©aba£R•liÿ
::
	$D©aba£R•liÿ
(cÚ¡ 
¡ršg
 & 
·th
)

234 : 
	`š‹º®
(
Ãw
 
D©aba£R•liÿ
::
	$IÁ”Çl
(
·th
))

236 
	`DEBUGAPICALL
(, "X­Ÿn::D©aba£R•liÿ::D©aba£R•liÿ", 
·th
);

237 
	}
}

239 
	gD©aba£R•liÿ
::~
	$D©aba£R•liÿ
()

241 
	`DEBUGAPICALL
(, "Xapian::DatabaseReplica::~DatabaseReplica", "");

242 
	}
}

244 
¡ršg


245 
	gD©aba£R•liÿ
::
	$g‘_»visiÚ_šfo
() const

247 
	`DEBUGAPICALL
(
¡ršg
, "Xapian::DatabaseReplica::get_revision_info", "");

248 ià(
š‹º®
.
	`g‘
(è=ğ
NULL
)

249 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Attempto call DatabaseReplica::get_revision_info on‡ closed„eplica.");

250 
	`RETURN
(
š‹º®
->
	`g‘_»visiÚ_šfo
());

251 
	}
}

254 
	gD©aba£R•liÿ
::
	$£t_»ad_fd
(
fd
)

256 
	`DEBUGAPICALL
(, "X­Ÿn::D©aba£R•liÿ::£t_»ad_fd", 
fd
);

257 ià(
š‹º®
.
	`g‘
(è=ğ
NULL
)

258 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Attempto call DatabaseReplica::set_read_fd on‡ closed„eplica.");

259 
š‹º®
->
	`£t_»ad_fd
(
fd
);

260 
	}
}

262 
boŞ


263 
	gD©aba£R•liÿ
::
	$­¶y_Ãxt_chªge£t
(
R•liÿtiÚInfo
 * 
šfo
)

265 
	`DEBUGAPICALL
(
boŞ
, "X­Ÿn::D©aba£R•liÿ::­¶y_Ãxt_chªge£t", 
šfo
);

266 ià(
šfo
 !ğ
NULL
)

267 
šfo
->
	`ş—r
();

268 ià(
š‹º®
.
	`g‘
(è=ğ
NULL
)

269 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Attempto call DatabaseReplica::apply_next_changeset on‡ closed„eplica.");

270 
	`RETURN
(
š‹º®
->
	`­¶y_Ãxt_chªge£t
(
šfo
));

271 
	}
}

274 
	gD©aba£R•liÿ
::
	$şo£
()

276 
	`DEBUGAPICALL
(
boŞ
, "Xapian::DatabaseReplica::close", "");

277 
š‹º®
 = 
NULL
;

278 
	}
}

280 
¡ršg


281 
	gD©aba£R•liÿ
::
	$g‘_desütiÚ
() const

283 
¡ršg
 
	`desc
("DatabaseReplica(");

284 ià(
š‹º®
.
	`g‘
()) {

285 
desc
 +ğ
š‹º®
->
	`g‘_desütiÚ
();

287 
desc
 += ')';

288  
desc
;

289 
	}
}

294 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$upd©e_¡ub_d©aba£
() const

296 
¡ršg
 
¡ub_·th
 = 
·th
;

297 
¡ub_·th
 += "/XAPIANDB";

298 
¡ršg
 
tmp_·th
 = 
¡ub_·th
;

299 
tmp_·th
 += ".tmp";

301 
of¡»am
 
	`¡ub
(
tmp_·th
.
	`c_¡r
());

302 
¡ub
 << 
REPLICA_STUB_BANNER


303 "autØ»¶iÿ_" << 
live_id
 << 
’dl
;

305 
»suÉ
;

306 #ifdeà
__WIN32__


307 
»suÉ
 = 
	`msvc_posix_»Çme
(
tmp_·th
.
	`c_¡r
(), 
¡ub_·th
.c_str());

309 
»suÉ
 = 
	`»Çme
(
tmp_·th
.
	`c_¡r
(), 
¡ub_·th
.c_str());

311 ià(
»suÉ
 == -1) {

312 
¡ršg
 
	`msg
("Failedo update stub db file for„eplica: ");

313 
msg
 +ğ
·th
;

314 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
);

316 
	}
}

318 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$IÁ”Çl
(cÚ¡ 
¡ršg
 & 
·th_
)

319 : 
	`·th
(
·th_
), 
	`live_id
(0), 
	`live_db
(), 
	`have_ofæše_db
(
çl£
),

320 
	`Ãed_cİy_Ãxt
(
çl£
), 
	`ofæše_»visiÚ
(), 
	`ofæše_Ãeded_»visiÚ
(),

321 
	$cÚn
(
NULL
)

323 
	`DEBUGCALL
(
API
, , "D©aba£R•liÿ::IÁ”Çl::IÁ”Çl", 
·th_
);

324 #ià! 
defšed
 
XAPIAN_HAS_FLINT_BACKEND
 && ! defšed 
XAPIAN_HAS_CHERT_BACKEND


325 
throw
 
	`F—tu»UÇvaabËE¼Ü
("Replication„equireshe Flint or Chert backendo beƒnabled");

327 ià(
	`mkdœ
(
·th
, 0777) == 0) {

334 
live_db
 = 
	`Wr™abËD©aba£
(
	`g‘_»¶iÿ_·th
(
live_id
),

335 
X­Ÿn
::
DB_CREATE
);

336 
	`upd©e_¡ub_d©aba£
();

338 ià(
”ºo
 !ğ
EEXIST
) {

339 
throw
 
	`D©aba£O³nšgE¼Ü
("Couldn'ˆü—‹ dœeùÜy '" + 
·th
 + "'", 
”ºo
);

341 ià(!
	`dœ_exi¡s
(
·th
)) {

342 
throw
 
	`D©aba£O³nšgE¼Ü
("Replica…ath must be‡ directory");

344 
¡ršg
 
¡ub_·th
 = 
·th
;

345 
¡ub_·th
 += "/XAPIANDB";

346 
live_db
 = 
Auto
::
	`İ’_¡ub
(
¡ub_·th
, 
X­Ÿn
::
DB_OPEN
);

348 
if¡»am
 
	`¡ub
(
¡ub_·th
.
	`c_¡r
());

349 
¡ršg
 
lše
;

350 
	`g‘lše
(
¡ub
, 
lše
)) {

351 ià(!
lše
.
	`em±y
() &&†ine[0] != '#') {

352 
live_id
 = 
lše
[lše.
	`size
() - 1] - '0';

358 
	}
}

360 
¡ršg


361 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$g‘_»visiÚ_šfo
() const

363 
	`DEBUGCALL
(
API
, 
¡ršg
, "DatabaseReplica::Internal::get_revision_info", "");

364 ià(
live_db
.
š‹º®
.
	`size
() != 1) {

365 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("DatabaseReplica‚eedso be…ointed‡tƒxactly one subdatabase");

367 
¡ršg
 
uuid
 = (
live_db
.
š‹º®
[0])->
	`g‘_uuid
();

368 
¡ršg
 
buf
 = 
	`’code_Ëngth
(
uuid
.
	`size
());

369 
buf
 +ğ
uuid
;

370 
buf
 +ğ(
live_db
.
š‹º®
[0])->
	`g‘_»visiÚ_šfo
();

371 
	`RETURN
(
buf
);

372 
	}
}

375 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$»move_ofæše_db
()

378 
	`»movedœ
(
	`g‘_»¶iÿ_·th
(
live_id
 ^ 1));

379 
have_ofæše_db
 = 
çl£
;

380 
	}
}

383 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$­¶y_db_cİy
(cÚ¡ 
OmTime
 & 
’d_time
)

385 
have_ofæše_db
 = 
Œue
;

386 
¡ršg
 
ofæše_·th
 = 
	`g‘_»¶iÿ_·th
(
live_id
 ^ 1);

392 
	`»movedœ
(
ofæše_·th
);

393 ià(
	`mkdœ
(
ofæše_·th
, 0777)) {

394 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Cannot make directory '" +

395 
ofæše_·th
 + "'", 
”ºo
);

399 
¡ršg
 
buf
;

400 
ty³
 = 
cÚn
->
	`g‘_mes§ge
(
buf
, 
’d_time
);

401 
	`check_mes§ge_ty³
(
ty³
, 
REPL_REPLY_DB_HEADER
);

402 cÚ¡ * 
±r
 = 
buf
.
	`d©a
();

403 cÚ¡ * 
’d
 = 
±r
 + 
buf
.
	`size
();

404 
size_t
 
uuid_Ëngth
 = 
	`decode_Ëngth
(&
±r
, 
’d
, 
Œue
);

405 
ofæše_uuid
.
	`assign
(
±r
, 
uuid_Ëngth
);

406 
ofæše_»visiÚ
.
	`assign
(
buf
, 
±r
 + 
uuid_Ëngth
 - buf.
	`d©a
(), buf.
Åos
);

410 
Œue
) {

411 
¡ršg
 
f’ame
;

412 
ty³
 = 
cÚn
->
	`¢iff_Ãxt_mes§ge_ty³
(
’d_time
);

413 ià(
ty³
 =ğ
REPL_REPLY_FAIL
)

415 ià(
ty³
 =ğ
REPL_REPLY_DB_FOOTER
)

418 
ty³
 = 
cÚn
->
	`g‘_mes§ge
(
f’ame
, 
’d_time
);

419 
	`check_mes§ge_ty³
(
ty³
, 
REPL_REPLY_DB_FILENAME
);

423 ià(
f’ame
.
	`fšd
(".."è!ğ
¡ršg
::
Åos
) {

424 
throw
 
	`N‘wÜkE¼Ü
("Filename in database contains '..'");

427 
ty³
 = 
cÚn
->
	`¢iff_Ãxt_mes§ge_ty³
(
’d_time
);

428 ià(
ty³
 =ğ
REPL_REPLY_FAIL
)

431 
¡ršg
 
f•©h
 = 
ofæše_·th
 + "/" + 
f’ame
;

432 
ty³
 = 
cÚn
->
	`»ûive_fe
(
f•©h
, 
’d_time
);

433 
	`check_mes§ge_ty³
(
ty³
, 
REPL_REPLY_DB_FILEDATA
);

435 
ty³
 = 
cÚn
->
	`g‘_mes§ge
(
ofæše_Ãeded_»visiÚ
, 
’d_time
);

436 
	`check_mes§ge_ty³
(
ty³
, 
REPL_REPLY_DB_FOOTER
);

437 
Ãed_cİy_Ãxt
 = 
çl£
;

438 
	}
}

441 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$check_mes§ge_ty³
(
ty³
, 
ex³ùed
) const

443 ià(
ty³
 !ğ
ex³ùed
) {

444 
throw
 
	`N‘wÜkE¼Ü
("Unexpected„eplication…rotocol messageype (got "

445 + 
	`om_to¡ršg
(
ty³
) + ",ƒxpected "

446 + 
	`om_to¡ršg
(
ex³ùed
) + ")");

448 
	}
}

450 
boŞ


451 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$possibly_make_ofæše_live
()

453 
¡ršg
 
	`»¶iÿ_·th
(
	`g‘_»¶iÿ_·th
(
live_id
 ^ 1));

454 
AutoPŒ
<
D©aba£R•liÿtÜ
> 
»¶iÿtÜ
;

455 
Œy
 {

456 
»¶iÿtÜ
.
	`»£t
(
D©aba£R•liÿtÜ
::
	`İ’
(
»¶iÿ_·th
));

457 } 
	`ÿtch
 (
X­Ÿn
::
D©aba£E¼Ü
 &) {

458  
çl£
;

460 ià(!
»¶iÿtÜ
->
	`check_»visiÚ_©_Ëa¡
(
ofæše_»visiÚ
,

461 
ofæše_Ãeded_»visiÚ
)) {

462  
çl£
;

465 
¡ršg
 
»¶iÿ‹d_uuid
 = 
»¶iÿtÜ
->
	`g‘_uuid
();

466 ià(
»¶iÿ‹d_uuid
.
	`em±y
()) {

467  
çl£
;

470 ià(
»¶iÿ‹d_uuid
 !ğ
ofæše_uuid
) {

471  
çl£
;

474 
live_id
 ^= 1;

477 
live_db
 = 
	`Wr™abËD©aba£
(
»¶iÿ_·th
, 
X­Ÿn
::
DB_OPEN
);

478 
	`upd©e_¡ub_d©aba£
();

479 
	`»move_ofæše_db
();

480  
Œue
;

481 
	}
}

484 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$£t_»ad_fd
(
fd
)

486 
d–‘e
 
cÚn
;

487 
cÚn
 = 
NULL
;

488 
cÚn
 = 
Ãw
 
	`RemÙeCÚÃùiÚ
(
fd
, -1, "");

489 
	}
}

491 
boŞ


492 
	gD©aba£R•liÿ
::
IÁ”Çl
::
	$­¶y_Ãxt_chªge£t
(
R•liÿtiÚInfo
 * 
šfo
)

494 
	`DEBUGCALL
(
API
, 
boŞ
,

495 "D©aba£R•liÿ::IÁ”Çl::­¶y_Ãxt_chªge£t", 
šfo
);

496 ià(
live_db
.
š‹º®
.
	`size
() != 1) {

497 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("DatabaseReplica‚eedso be…ointed‡tƒxactly one subdatabase");

499 
OmTime
 
’d_time
;

501 
Œue
) {

502 
ty³
 = 
cÚn
->
	`¢iff_Ãxt_mes§ge_ty³
(
’d_time
);

503 
ty³
) {

504 
REPL_REPLY_END_OF_CHANGES
:

505 
	`RETURN
(
çl£
);

506 
REPL_REPLY_DB_HEADER
:

508 
Œy
 {

509 
	`­¶y_db_cİy
(
’d_time
);

510 ià(
šfo
 !ğ
NULL
)

511 ++(
šfo
->
fuÎcİy_couÁ
);

512 
¡ršg
 
»¶iÿ_uuid
;

514 
AutoPŒ
<
D©aba£R•liÿtÜ
> 
	`»¶iÿtÜ
(

515 
D©aba£R•liÿtÜ
::
	`İ’
(
	`g‘_»¶iÿ_·th
(
live_id
 ^ 1)));

516 
»¶iÿ_uuid
 = 
»¶iÿtÜ
->
	`g‘_uuid
();

518 ià(
»¶iÿ_uuid
 !ğ
ofæše_uuid
) {

519 
	`»move_ofæše_db
();

526 
Ãed_cİy_Ãxt
 = 
Œue
;

528 } 
	`ÿtch
 (...) {

529 
	`»move_ofæše_db
();

530 
throw
;

532 ià(
	`possibly_make_ofæše_live
()) {

533 ià(
šfo
 !ğ
NULL
)

534 
šfo
->
chªged
 = 
Œue
;

537 
REPL_REPLY_CHANGESET
:

538 ià(
Ãed_cİy_Ãxt
) {

539 
throw
 
	`N‘wÜkE¼Ü
("Needed‡ database copy‚ext");

541 ià(!
have_ofæše_db
) {

543 
live_db
 = 
	`Wr™abËD©aba£
();

544 
¡ršg
 
	`»¶iÿ_·th
(
	`g‘_»¶iÿ_·th
(
live_id
));

549 
AutoPŒ
<
D©aba£R•liÿtÜ
> 
	`»¶iÿtÜ
(

550 
D©aba£R•liÿtÜ
::
	`İ’
(
»¶iÿ_·th
));

551 
ofæše_Ãeded_»visiÚ
 = 
»¶iÿtÜ
->

552 
	`­¶y_chªge£t_äom_cÚn
(*
cÚn
, 
’d_time
, 
Œue
);

556 ià(
šfo
 !ğ
NULL
) {

557 ++(
šfo
->
chªge£t_couÁ
);

558 
šfo
->
chªged
 = 
Œue
;

560 
live_db
 = 
	`Wr™abËD©aba£
(
»¶iÿ_·th
, 
X­Ÿn
::
DB_OPEN
);

561 
	`RETURN
(
Œue
);

565 
AutoPŒ
<
D©aba£R•liÿtÜ
> 
	`»¶iÿtÜ
(

566 
D©aba£R•liÿtÜ
::
	`İ’
(
	`g‘_»¶iÿ_·th
(
live_id
 ^ 1)));

567 
ofæše_Ãeded_»visiÚ
 = 
»¶iÿtÜ
->

568 
	`­¶y_chªge£t_äom_cÚn
(*
cÚn
, 
’d_time
, 
çl£
);

570 ià(
	`possibly_make_ofæše_live
()) {

571 ià(
šfo
 !ğ
NULL
)

572 
šfo
->
chªged
 = 
Œue
;

574 
	`RETURN
(
Œue
);

575 
REPL_REPLY_FAIL
: {

576 
¡ršg
 
buf
;

577 ()
cÚn
->
	`g‘_mes§ge
(
buf
, 
’d_time
);

578 
throw
 
	`N‘wÜkE¼Ü
("UÇbËØfuÎy synchrÚi£: " + 
buf
);

581 
throw
 
	`N‘wÜkE¼Ü
("Unknown„eplication…rotocol message ("

582 + 
	`om_to¡ršg
(
ty³
) + ")");

585 
	}
}

	@api/sortable-serialise.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/qu”y·r£r.h
>

25 
	~<cæßt
>

26 
	~<cm©h
>

28 
	~<¡ršg
>

30 
	~"omas£¹.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 #ià
FLT_RADIX
 != 2

35 #”rÜ 
Code
 
cu¼’y
 
assumes
 
FLT_RADIX
 == 2

38 #ifdeà
_MSC_VER


40 #´agm¨
w¬nšg
(
di§bË
:4146)

43 
¡ršg


44 
	gX­Ÿn
::
	$sÜbË_£rŸli£
(
v®ue
)

46 
mªtis§
;

47 
expÚ’t
;

50 ià(
v®ue
 < -
DBL_MAX
è 
	`¡ršg
();

52 
mªtis§
 = 
	`äexp
(
v®ue
, &
expÚ’t
);

62 ià(
mªtis§
 =ğ0.0 || 
expÚ’t
 < -2039)  "\x80";

64 
boŞ
 
Ãg©ive
 = (
mªtis§
 < 0);

65 ià(
Ãg©ive
è
mªtis§
 = -mantissa;

68 ià(
v®ue
 > 
DBL_MAX
 || 
expÚ’t
 > 2055) {

69 ià(
Ãg©ive
) {

72  
	`¡ršg
();

74  
	`¡ršg
(9, '\xff');

86 
Ãxt
 = (
Ãg©ive
 ? 0 : 0xe0);

89 
expÚ’t
 -= 8;

90 
boŞ
 
expÚ’t_Ãg©ive
 = (
expÚ’t
 < 0);

91 ià(
expÚ’t_Ãg©ive
) {

92 
expÚ’t
 = -exponent;

93 
Ãxt
 ^= 0x60;

96 
¡ršg
 
»suÉ
;

106 
	`As£¹
(
expÚ’t
 >= 0);

107 ià(
expÚ’t
 < 8) {

108 
Ãxt
 ^= 0x20;

109 
Ãxt
 |ğ
¡©ic_ÿ¡
<>(
expÚ’t
 << 2);

110 ià(
Ãg©ive
 ^ 
expÚ’t_Ãg©ive
è
Ãxt
 ^= 0x1c;

112 
	`As£¹
((
expÚ’t
 >> 11) == 0);

115 
Ãxt
 |ğ
¡©ic_ÿ¡
<>(
expÚ’t
 >> 6);

116 ià(
Ãg©ive
 ^ 
expÚ’t_Ãg©ive
è
Ãxt
 ^= 0x1f;

117 
»suÉ
 +ğ
Ãxt
;

120 
Ãxt
 = 
¡©ic_ÿ¡
<>(
expÚ’t
) << 2;

121 ià(
Ãg©ive
 ^ 
expÚ’t_Ãg©ive
è
Ãxt
 ^= 0xfc;

125 
mªtis§
 *ğ1 << (
Ãg©ive
 ? 26 : 27);

126 
wÜd1
 = 
¡©ic_ÿ¡
<>(
mªtis§
);

127 
mªtis§
 -ğ
wÜd1
;

128 
wÜd2
 = 
¡©ic_ÿ¡
<>(
mªtis§
 * 4294967296.0);

136 
	`As£¹
(
Ãg©ive
 || (
wÜd1
 & (1<<26)));

137 ià(
Ãg©ive
) {

140 
wÜd1
 = -word1;

141 ià(
wÜd2
 !ğ0è++
wÜd1
;

142 
wÜd2
 = -word2;

145 
wÜd1
 &= 0x03ffffff;

146 
Ãxt
 |ğ
¡©ic_ÿ¡
<>(
wÜd1
 >> 24);

147 
»suÉ
 +ğ
Ãxt
;

148 
»suÉ
.
	`push_back
((
wÜd1
 >> 16));

149 
»suÉ
.
	`push_back
((
wÜd1
 >> 8));

150 
»suÉ
.
	`push_back
((
wÜd1
));

152 
»suÉ
.
	`push_back
((
wÜd2
 >> 24));

153 
»suÉ
.
	`push_back
((
wÜd2
 >> 16));

154 
»suÉ
.
	`push_back
((
wÜd2
 >> 8));

155 
»suÉ
.
	`push_back
((
wÜd2
));

158 
size_t
 
Ën
 = 
»suÉ
.
	`size
();

159 
Ën
 > 0 && 
»suÉ
[len - 1] == '\0') {

160 --
Ën
;

162 
»suÉ
.
	`»size
(
Ën
);

164  
»suÉ
;

165 
	}
}

169 
šlše
 

170 
numäom¡r
(cÚ¡ 
¡d
::
¡ršg
 & 
¡r
, std::¡ršg::
size_ty³
 
pos
)

172  (
pos
 < 
¡r
.
size
()è? 
¡©ic_ÿ¡
<>(str[pos]) : '\0';

176 
	gX­Ÿn
::
sÜbË_un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
v®ue
)

179 ià(
v®ue
 == "\x80")  0.0;

182 ià(
	gv®ue
 =ğ
¡ršg
(9, '\xff')) {

183 #ifdeà
INFINITY


187 ià((
	gINFINITY
è> 
	gHUGE_VAL
)  INFINITY;

189  
	gHUGE_VAL
;

193 ià(
	gv®ue
.
em±y
()) {

194 #ifdeà
INFINITY


195 ià((
	gINFINITY
è> 
	gHUGE_VAL
)  -INFINITY;

197  -
	gHUGE_VAL
;

200 
	gfœ¡
 = 
numäom¡r
(
v®ue
, 0);

201 
size_t
 
	gi
 = 0;

203 
	gfœ¡
 ^ğ
¡©ic_ÿ¡
<>(
fœ¡
 & 0xc0) >> 1;

204 
boŞ
 
	gÃg©ive
 = !(
fœ¡
 & 0x80);

205 
boŞ
 
	gexpÚ’t_Ãg©ive
 = (
fœ¡
 & 0x40);

206 
boŞ
 
	gex¶’
 = !(
fœ¡
 & 0x20);

207 
	gexpÚ’t
 = 
fœ¡
 & 0x1f;

208 ià(!
	gex¶’
) {

209 
	gexpÚ’t
 >>= 2;

210 ià(
	gÃg©ive
 ^ 
	gexpÚ’t_Ãg©ive
è
	gexpÚ’t
 ^= 0x07;

212 
	gfœ¡
 = 
numäom¡r
(
v®ue
, ++
i
);

213 
	gexpÚ’t
 <<= 6;

214 
	gexpÚ’t
 |ğ(
fœ¡
 >> 2);

215 ià(
	gÃg©ive
 ^ 
	gexpÚ’t_Ãg©ive
è
	gexpÚ’t
 ^= 0x07ff;

218 
	gwÜd1
;

219 
	gwÜd1
 = ((
fœ¡
 & 0x03) << 24);

220 
	gwÜd1
 |ğ
numäom¡r
(
v®ue
, ++
i
) << 16;

221 
	gwÜd1
 |ğ
numäom¡r
(
v®ue
, ++
i
) << 8;

222 
	gwÜd1
 |ğ
numäom¡r
(
v®ue
, ++
i
);

224 
	gwÜd2
 = 0;

225 ià(
	gi
 < 
	gv®ue
.
size
()) {

226 
	gwÜd2
 = 
numäom¡r
(
v®ue
, ++
i
) << 24;

227 
	gwÜd2
 |ğ
numäom¡r
(
v®ue
, ++
i
) << 16;

228 
	gwÜd2
 |ğ
numäom¡r
(
v®ue
, ++
i
) << 8;

229 
	gwÜd2
 |ğ
numäom¡r
(
v®ue
, ++
i
);

232 ià(
	gÃg©ive
) {

233 
	gwÜd1
 = -
wÜd1
;

234 ià(
	gwÜd2
 !ğ0è++
wÜd1
;

235 
	gwÜd2
 = -
wÜd2
;

236 
As£¹
((
wÜd1
 & 0xf0000000) != 0);

237 
	gwÜd1
 &= 0x03ffffff;

239 ià(!
	gÃg©ive
è
	gwÜd1
 |= 1<<26;

241 
	gmªtis§
 = 0;

242 ià(
	gwÜd2
è
	gmªtis§
 = 
wÜd2
 / 4294967296.0;

243 
	gmªtis§
 +ğ
wÜd1
;

244 
	gmªtis§
 /ğ1 << (
Ãg©ive
 ? 26 : 27);

246 ià(
	gexpÚ’t_Ãg©ive
è
	gexpÚ’t
 = -
expÚ’t
;

247 
	gexpÚ’t
 += 8;

249 ià(
	gÃg©ive
è
	gmªtis§
 = -
mªtis§
;

251  
ldexp
(
mªtis§
, 
expÚ’t
);

	@api/termlist.cc

21 
	~<cÚfig.h
>

23 
	~"omas£¹.h
"

25 
	~"‹rmli¡.h
"

27 
usšg
 
Çme¥aû
 
	g¡d
;

29 
Çme¥aû
 
	gX­Ÿn
 {

31 
	gT”mI‹¿tÜ
::
IÁ”Çl
::~Internal() { }

34 
T”mI‹¿tÜ
::
IÁ”Çl
::
accumuÏ‹_¡©s
(
X­Ÿn
::IÁ”Çl::
Ex·ndSts
 &) const

37 
As£¹
(
çl£
);

40 
	gX­Ÿn
::
‹rmcouÁ


41 
T”mI‹¿tÜ
::
IÁ”Çl
::
g‘_cŞËùiÚ_äeq
() const

44 
As£¹
(
çl£
);

48 
	gT”mI‹¿tÜ
::
IÁ”Çl
 *

49 
T”mI‹¿tÜ
::
IÁ”Çl
::
sk_to
(cÚ¡ 
¡ršg
 & 
‹rm
)

54 !
©_’d
(è&& 
g‘_‹rmÇme
(è< 
‹rm
) {

55 
IÁ”Çl
 *

 = 
Ãxt
();

56 ià(
	g
) {

57 !
	g
->
©_’d
(è&&l->
g‘_‹rmÇme
(è< 
	g‹rm
) {

58 
IÁ”Çl
 *
	g»t
 = 

->
Ãxt
();

59 ià(
	g»t
) {

60 
d–‘e
 
	g
;

61 
	g
 = 
»t
;

64  
	g
;

68  
	gNULL
;

	@api/valueiterator.cc

21 
	~<cÚfig.h
>

23 
	~"x­Ÿn/v®ue™”©Ü.h
"

25 
	~"debuglog.h
"

26 
	~"omas£¹.h
"

27 
	~"v®u–i¡.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
Çme¥aû
 
	gX­Ÿn
 {

33 
	gV®ueI‹¿tÜ
::
V®ueI‹¿tÜ
(è: 
š‹º®
(
NULL
) { }

35 
V®ueI‹¿tÜ
::~ValueIterator() { }

37 
V®ueI‹¿tÜ
::V®ueI‹¿tÜ(
IÁ”Çl
 *
š‹º®_
è: 
š‹º®
(internal_)

39 
š‹º®
->
Ãxt
();

40 ià(
	gš‹º®
->
©_’d
()èš‹º® = 
NULL
;

43 
	gV®ueI‹¿tÜ
::
V®ueI‹¿tÜ
(cÚ¡ V®ueI‹¿tÜ & 
o
)

44 : 
š‹º®
(
o
.internal) { }

46 
V®ueI‹¿tÜ
::V®ueI‹¿tÜ(cÚ¡ 
V®ueI‹¿tÜEnd_
 &)

47 : 
š‹º®
(
NULL
) { }

49 
V®ueI‹¿tÜ
 &

50 
V®ueI‹¿tÜ
::
İ”©Ü
=(cÚ¡ V®ueI‹¿tÜ & 
o
)

52 
š‹º®
 = 
o
.internal;

53  *
	gthis
;

56 
	gV®ueI‹¿tÜ
 &

57 
	gV®ueI‹¿tÜ
::
İ”©Ü
=(cÚ¡ 
V®ueI‹¿tÜEnd_
 &)

59 
š‹º®
 = 
NULL
;

60  *
	gthis
;

63 
¡ršg


64 
	gV®ueI‹¿tÜ
::
İ”©Ü
*() const

66 
LOGCALL
(
API
, 
¡ršg
, "ValueIterator::operator*", "");

67 
As£¹
(
š‹º®
.
g‘
());

68 
RETURN
(
š‹º®
->
g‘_v®ue
());

71 
	gV®ueI‹¿tÜ
 &

72 
	gV®ueI‹¿tÜ
::
İ”©Ü
++()

74 
LOGCALL
(
API
, 
V®ueI‹¿tÜ
 &, "ValueIterator::operator++", "");

75 
As£¹
(
š‹º®
.
g‘
());

76 
	gš‹º®
->
Ãxt
();

77 ià(
	gš‹º®
->
©_’d
()èš‹º® = 
NULL
;

78 
RETURN
(*
this
);

81 
	gX­Ÿn
::
docid


82 
V®ueI‹¿tÜ
::
g‘_docid
() const

84 
LOGCALL
(
API
, 
X­Ÿn
::
docid
, "ValueIterator::get_docid", "");

85 
As£¹
(
š‹º®
.
g‘
());

86 
RETURN
(
š‹º®
->
g‘_docid
());

89 
	gX­Ÿn
::
v®u’o


90 
V®ueI‹¿tÜ
::
g‘_v®u’o
() const

92 
LOGCALL
(
API
, 
X­Ÿn
::
v®u’o
, "ValueIterator::get_valueno", "");

93 
As£¹
(
š‹º®
.
g‘
());

94 
RETURN
(
š‹º®
->
g‘_v®u’o
());

98 
	gV®ueI‹¿tÜ
::
sk_to
(
X­Ÿn
::
docid
 
docid_Ü_¦Ù
)

100 
LOGCALL_VOID
(
API
, "V®ueI‹¿tÜ::sk_to", 
docid_Ü_¦Ù
);

101 
As£¹
(
š‹º®
.
g‘
());

102 
	gš‹º®
->
sk_to
(
docid_Ü_¦Ù
);

103 ià(
	gš‹º®
->
©_’d
()èš‹º® = 
NULL
;

106 
boŞ


107 
	gV®ueI‹¿tÜ
::
check
(
X­Ÿn
::
docid
 docid)

109 
LOGCALL
(
API
, 
boŞ
, "V®ueI‹¿tÜ::check", 
docid
);

110 
As£¹
(
š‹º®
.
g‘
());

111 ià(!
	gš‹º®
->
check
(
docid
)è 
	gçl£
;

112 ià(
	gš‹º®
->
©_’d
()èš‹º® = 
NULL
;

113  
	gŒue
;

116 
	g¡d
::
¡ršg


117 
V®ueI‹¿tÜ
::
g‘_desütiÚ
() const

119 
¡ršg
 
desc
 = "ValueIterator(";

120 ià(
	gš‹º®
.
g‘
()è
	gdesc
 +ğ
š‹º®
->
g‘_desütiÚ
();

121 
	gdesc
 += ')';

122  
	gdesc
;

	@api/valuerangeproc.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/qu”y·r£r.h
>

25 
	~<c¡dio
>

26 
	~<c¡dlib
>

27 
	~"§ã”ºo.h
"

29 
	~<¡ršg
>

30 
	~"¡ršguts.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
Çme¥aû
 
	gX­Ÿn
 {

36 
	gX­Ÿn
::
v®u’o


37 
SŒšgV®ueRªgeProûssÜ
::
İ”©Ü
()(
¡ršg
 &
begš
, 
	g¡ršg
 &
	g’d
)

39 ià(
	g¡r
.
size
()) {

40 ià(
	g´efix
) {

42 ià(!
¡¬tsw™h
(
begš
, 
¡r
)) {

44  
	gX­Ÿn
::
BAD_VALUENO
;

46 
	gbegš
.
”a£
(0, 
¡r
.
size
());

48 ià(
¡¬tsw™h
(
’d
, 
¡r
)) {

49 
	g’d
.
”a£
(0, 
¡r
.
size
());

53 ià(!
’dsw™h
(
’d
, 
¡r
)) {

55  
	gX­Ÿn
::
BAD_VALUENO
;

57 
	g’d
.
»size
(
’d
.
size
(è- 
¡r
.size());

59 ià(
’dsw™h
(
begš
, 
¡r
)) {

60 
	gbegš
.
»size
(
begš
.
size
(è- 
¡r
.size());

64  
	gv®no
;

67 
boŞ


68 
decode_xxy
(cÚ¡ 
¡ršg
 & 
s
, & 
x1
, &
x2
, &
y
)

70 ià(
	gs
.
size
(è< 5 || s.size(è> 10è 
	gçl£
;

71 
size_t
 
	gi
 = 
s
.
fšd_fœ¡_nÙ_of
("0123456789");

72 ià(
	gi
 < 1 || i > 2 || !(
	gs
[
i
] =ğ'/' || 
s
[i] == '-' || s[i] == '.'))

73  
çl£
;

74 
size_t
 
	gj
 = 
s
.
fšd_fœ¡_nÙ_of
("0123456789", 
i
 + 1);

75 ià(
	gj
 - (
	gi
 + 1) < 1 || j - (i + 1) > 2 ||

76 !(
	gs
[
j
] =ğ'/' || 
s
[j] == '-' || s[j] == '.'))

77  
çl£
;

78 ià(
	gs
.
size
(è- 
	gj
 > 4 + 1è 
	gçl£
;

79 ià(
	gs
.
fšd_fœ¡_nÙ_of
("0123456789", 
j
 + 1è!ğ
¡ršg
::
Åos
)

80  
çl£
;

81 
	gx1
 = 
©oi
(
s
.
c_¡r
());

82 ià(
	gx1
 < 1 || x1 > 31è 
	gçl£
;

83 
	gx2
 = 
©oi
(
s
.
c_¡r
(è+ 
i
 + 1);

84 ià(
	gx2
 < 1 || x2 > 31è 
	gçl£
;

85 
	gy
 = 
©oi
(
s
.
c_¡r
(è+ 
j
 + 1);

86  
	gŒue
;

93 cÚ¡ 
	gmax_mÚth_Ëngth
[12] = {

97 
boŞ


98 
v‘_dm
(
d
, 
m
)

100 ià(
	gm
 > 12 || m < 1è 
	gçl£
;

101 ià(
	gd
 < 1 || d > 
	gmax_mÚth_Ëngth
[
m
 - 1]è 
	gçl£
;

102  
	gŒue
;

105 
	gX­Ÿn
::
v®u’o


106 
D©eV®ueRªgeProûssÜ
::
İ”©Ü
()(
¡ršg
 &
begš
, 
	g¡ršg
 &
	g’d
)

108 ià(
	gSŒšgV®ueRªgeProûssÜ
::
İ”©Ü
()(
begš
, 
	g’d
è=ğ
BAD_VALUENO
)

109  
BAD_VALUENO
;

111 ià(
	gbegš
.
size
(è=ğ8 && 
’d
.size() == 8 &&

112 
begš
.
fšd_fœ¡_nÙ_of
("0123456789"è=ğ
¡ršg
::
Åos
 &&

113 
’d
.
fšd_fœ¡_nÙ_of
("0123456789"è=ğ
¡ršg
::
Åos
) {

115  
v®no
;

117 ià(
	gbegš
.
size
(è=ğ10 && 
’d
.size() == 10 &&

118 
begš
.
fšd_fœ¡_nÙ_of
("0123456789") == 4 &&

119 
’d
.
fšd_fœ¡_nÙ_of
("0123456789") == 4 &&

120 
begš
.
fšd_fœ¡_nÙ_of
("0123456789", 5) == 7 &&

121 
’d
.
fšd_fœ¡_nÙ_of
("0123456789", 5) == 7 &&

122 
begš
.
fšd_fœ¡_nÙ_of
("0123456789", 8è=ğ
¡ršg
::
Åos
 &&

123 
’d
.
fšd_fœ¡_nÙ_of
("0123456789", 8è=ğ
¡ršg
::
Åos
 &&

124 
begš
[4] =ğbegš[7] && 
’d
[4] ==ƒnd[7] && begin[4] ==ƒnd[4] &&

125 (
’d
[4] == '-' ||ƒnd[4] == '.' ||ƒnd[4] == '/')) {

127 
begš
.
”a£
(7, 1);

128 
	gbegš
.
”a£
(4, 1);

129 
	g’d
.
”a£
(7, 1);

130 
	g’d
.
”a£
(4, 1);

131  
	gv®no
;

134 
	gb_d
, 
	gb_m
, 
	gb_y
;

135 
	ge_d
, 
	ge_m
, 
	ge_y
;

136 ià(!
decode_xxy
(
begš
, 
b_d
, 
b_m
, 
b_y
è|| !decode_xxy(
’d
, 
e_d
, 
e_m
, 
e_y
))

137  
	gX­Ÿn
::
BAD_VALUENO
;

141 ià(!
	g´eãr_mdy
 && 
v‘_dm
(
b_d
, 
b_m
è&& v‘_dm(
e_d
, 
e_m
) &&

142 (
	gb_y
 !ğ
e_y
 || 
b_m
 < 
e_m
 || (b_m =ğe_m && 
b_d
 <ğ
e_d
))) {

144 } ià(
v‘_dm
(
b_m
, 
b_d
è&& v‘_dm(
e_m
, 
e_d
) &&

145 (
	gb_y
 !ğ
e_y
 || 
b_d
 < 
e_d
 || (b_d =ğe_d && 
b_m
 <ğ
e_m
))) {

146 
sw­
(
b_m
, 
b_d
);

147 
sw­
(
e_m
, 
e_d
);

148 } ià(
	g´eãr_mdy
 && 
v‘_dm
(
b_d
, 
b_m
è&& v‘_dm(
e_d
, 
e_m
) &&

149 (
	gb_y
 !ğ
e_y
 || 
b_m
 < 
e_m
 || (b_m =ğe_m && 
b_d
 <ğ
e_d
))) {

152  
X­Ÿn
::
BAD_VALUENO
;

155 ià(
	gb_y
 < 100) {

156 
	gb_y
 += 1900;

157 ià(
	gb_y
 < 
	g•och_y—r
) b_y += 100;

159 ià(
	ge_y
 < 100) {

160 
	ge_y
 += 1900;

161 ià(
	ge_y
 < 
	g•och_y—r
)ƒ_y += 100;

164 #ifdeà
SNPRINTF


165 
	gbuf
[9];

166 
SNPRINTF
(
buf
, (buf), "%08d", 
b_y
 * 10000 + 
b_m
 * 100 + 
b_d
);

167 
	gbegš
.
assign
(
buf
, 8);

168 
SNPRINTF
(
buf
, (buf), "%08d", 
e_y
 * 10000 + 
e_m
 * 100 + 
e_d
);

169 
	g’d
.
assign
(
buf
, 8);

171 
	gbuf
[100];

172 
	gbuf
[(
buf
) - 1] = '\0';

173 
¥rštf
(
buf
, "%08d", 
b_y
 * 10000 + 
b_m
 * 100 + 
b_d
);

174 ià(
	gbuf
[(
buf
è- 1]è
abÜt
();

175 
	gbegš
.
assign
(
buf
, 8);

176 
¥rštf
(
buf
, "%08d", 
e_y
 * 10000 + 
e_m
 * 100 + 
e_d
);

177 ià(
	gbuf
[(
buf
è- 1]è
abÜt
();

178 
	g’d
.
assign
(
buf
, 8);

180  
	gv®no
;

183 
	gX­Ÿn
::
v®u’o


184 
Numb”V®ueRªgeProûssÜ
::
İ”©Ü
()(
¡ršg
 &
begš
, 
	g¡ršg
 &
	g’d
)

186 ià(
	gSŒšgV®ueRªgeProûssÜ
::
İ”©Ü
()(
begš
, 
	g’d
è=ğ
BAD_VALUENO
)

187  
BAD_VALUENO
;

190 
	gbegšnum
, 
	g’dnum
;

191 cÚ¡ * 
	g¡¬Œ
;

192 * 
	g’d±r
;

194 
	g”ºo
 = 0;

195 
	g¡¬Œ
 = 
begš
.
c_¡r
();

196 
	gbegšnum
 = 
¡¹od
(
¡¬Œ
, &
’d±r
);

197 ià(
	g’d±r
 !ğ
¡¬Œ
 + 
begš
.
size
())

199  
X­Ÿn
::
BAD_VALUENO
;

200 ià(
	g”ºo
)

202  
	gX­Ÿn
::
BAD_VALUENO
;

204 
	g”ºo
 = 0;

205 
	g¡¬Œ
 = 
’d
.
c_¡r
();

206 
	g’dnum
 = 
¡¹od
(
¡¬Œ
, &
’d±r
);

207 ià(
	g’d±r
 !ğ
¡¬Œ
 + 
’d
.
size
())

209  
X­Ÿn
::
BAD_VALUENO
;

210 ià(
	g”ºo
)

212  
	gX­Ÿn
::
BAD_VALUENO
;

214 
	gbegš
.
assign
(
X­Ÿn
::
sÜbË_£rŸli£
(
begšnum
));

215 
	g’d
.
assign
(
X­Ÿn
::
sÜbË_£rŸli£
(
’dnum
));

217  
	gv®no
;

	@api/valuesetmatchdecider.cc

23 
	~<cÚfig.h
>

25 
	~"x­Ÿn/v®ue£tm©chdecid”.h
"

27 
	~"x­Ÿn/docum’t.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
Çme¥aû
 
	gX­Ÿn
 {

33 
boŞ


34 
	gV®ueS‘M©chDecid”
::
İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
& 
doc
) const

36 
¡ršg
 
v®ue
 = 
doc
.
g‘_v®ue
(
v®u’um
);

37 
	g£t
<
	g¡ršg
>::
cÚ¡_™”©Ü
 
™
 = 
‹¡£t
.
fšd
(
v®ue
);

38 ià(
	gšşusive
)

39  
	g™
 !ğ
‹¡£t
.
’d
();

41  
	g™
 =ğ
‹¡£t
.
’d
();

	@api/version.cc

19 
	~<cÚfig.h
>

21 
	~"x­Ÿn.h
"

23 
Çme¥aû
 
	gX­Ÿn
 {

25 cÚ¡ * 
v”siÚ_¡ršg
(è{  
	gXAPIAN_VERSION
; }

27 
majÜ_v”siÚ
(è{  
	gXAPIAN_MAJOR_VERSION
; }

29 
mšÜ_v”siÚ
(è{  
	gXAPIAN_MINOR_VERSION
; }

31 
»visiÚ
(è{  
	gXAPIAN_REVISION
; }

	@backends/alltermslist.cc

21 
	~<cÚfig.h
>

23 
	~"®É”m¦i¡.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"omas£¹.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
	gX­Ÿn
::
‹rmcouÁ


32 
AÎT”msLi¡
::
	$g‘_­´ox_size
() const

35 
	`As£¹
(
çl£
);

37 
	}
}

39 
	gX­Ÿn
::
‹rmcouÁ


40 
AÎT”msLi¡
::
	$g‘_wdf
() const

42 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("AllTermsList::get_wdf() isn't meaningful");

43 
	}
}

45 
	gX­Ÿn
::
‹rmcouÁ


46 
AÎT”msLi¡
::
	$pos™iÚli¡_couÁ
() const

48 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("AllTermsList::positionlist_count() isn't meaningful");

49 
	}
}

51 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


52 
AÎT”msLi¡
::
	$pos™iÚli¡_begš
() const

54 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("AllTermsList::positionlist_begin() isn't meaningful");

55 
	}
}

	@backends/brass/brass_alldocspostlist.cc

22 
	~<cÚfig.h
>

24 
	~<¡ršg
>

26 
	~"b¿ss_®ldoc¥o¡li¡.h
"

27 
	~"b¿ss_d©aba£.h
"

29 
	~"uts.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gB¿ssAÎDocsPo¡Li¡
::
B¿ssAÎDocsPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db_
,

34 
X­Ÿn
::
doccouÁ
 
doccouÁ_
)

35 : 
B¿ssPo¡Li¡
(
db_
, 
¡ršg
(), 
Œue
),

36 
	$doccouÁ
(
doccouÁ_
)

38 
	`DEBUGCALL
(
DB
, , "B¿ssAÎDocsPo¡Li¡::B¿ssAÎDocsPo¡Li¡", 
db_
.
	`g‘
(è<< ", " << 
doccouÁ_
);

39 
	}
}

41 
	gX­Ÿn
::
doccouÁ


42 
B¿ssAÎDocsPo¡Li¡
::
	$g‘_‹rmäeq
() const

44 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "BrassAllDocsPostList::get_termfreq", "");

45 
	`RETURN
(
doccouÁ
);

46 
	}
}

48 
	gX­Ÿn
::
‹rmcouÁ


49 
B¿ssAÎDocsPo¡Li¡
::
	$g‘_doş’gth
() const

51 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassAllDocsPostList::get_doclength", "");

53 
	`RETURN
(
B¿ssPo¡Li¡
::
	`g‘_wdf
());

54 
	}
}

56 
	gX­Ÿn
::
‹rmcouÁ


57 
B¿ssAÎDocsPo¡Li¡
::
	$g‘_wdf
() const

59 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassAllDocsPostList::get_wdf", "");

60 
	`As£¹P¬ªoid
(!
	`©_’d
());

61 
	`RETURN
(1);

62 
	}
}

64 
Pos™iÚLi¡
 *

65 
	gB¿ssAÎDocsPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

67 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassAllDocsPostList::read_position_list", "");

68 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("BrassAllDocsPostList::read_position_list()‚ot meaningful");

69 
	}
}

71 
Pos™iÚLi¡
 *

72 
	gB¿ssAÎDocsPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

74 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassAllDocsPostList::open_position_list", "");

75 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("BrassAllDocsPostList::open_position_list()‚ot meaningful");

76 
	}
}

78 
¡ršg


79 
	gB¿ssAÎDocsPo¡Li¡
::
	$g‘_desütiÚ
() const

81 
¡ršg
 
desc
 = "BrassAllDocsPostList(did=";

82 
desc
 +ğ
	`om_to¡ršg
(
	`g‘_docid
());

83 
desc
 += ",doccount=";

84 
desc
 +ğ
	`om_to¡ršg
(
doccouÁ
);

85 
desc
 += ')';

86  
desc
;

87 
	}
}

	@backends/brass/brass_alldocspostlist.h

22 #iâdeà
XAPIAN_INCLUDED_BRASS_ALLDOCSPOSTLIST_H


23 
	#XAPIAN_INCLUDED_BRASS_ALLDOCSPOSTLIST_H


	)

25 
	~<¡ršg
>

27 
	~"b¿ss_po¡li¡.h
"

29 şas 
	cB¿ssAÎDocsPo¡Li¡
 : 
public
 
B¿ssPo¡Li¡
 {

31 
İ”©Ü
=(cÚ¡ 
B¿ssAÎDocsPo¡Li¡
 &);

34 
B¿ssAÎDocsPo¡Li¡
(const BrassAllDocsPostList &);

37 
	mX­Ÿn
::
doccouÁ
 doccount;

39 
	mpublic
:

40 
B¿ssAÎDocsPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db_
,

41 
X­Ÿn
::
doccouÁ
 
doccouÁ_
);

43 
	mX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

45 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

47 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

49 
Pos™iÚLi¡
 *
	`»ad_pos™iÚ_li¡
();

51 
Pos™iÚLi¡
 *
	$İ’_pos™iÚ_li¡
() const;

53 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

	@backends/brass/brass_alltermslist.cc

21 
	~<cÚfig.h
>

23 
	~"b¿ss_®É”m¦i¡.h
"

24 
	~"b¿ss_po¡li¡.h
"

26 
	~"·ck.h
"

27 
	~"¡ršguts.h
"

30 
	gB¿ssAÎT”msLi¡
::
	$»ad_‹rmäeq_ªd_cŞläeq
() const

32 
	`DEBUGCALL
(
DB
, , "BrassAllTermsList::read_termfreq_and_collfreq", "");

33 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

34 
	`As£¹
(!
	`©_’d
());

38 
cursÜ
->
	`»ad_g
();

39 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

40 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

41 
B¿ssPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
, 
³nd
, &
‹rmäeq
, &
cŞläeq
);

42 
	}
}

44 
	gB¿ssAÎT”msLi¡
::~
	$B¿ssAÎT”msLi¡
()

46 
	`DEBUGCALL
(
DB
, , "~BrassAllTermsList", "");

47 
d–‘e
 
cursÜ
;

48 
	}
}

50 
¡ršg


51 
	gB¿ssAÎT”msLi¡
::
	$g‘_‹rmÇme
() const

53 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassAllTermsList::get_termname", "");

54 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

55 
	`As£¹
(!
	`©_’d
());

56 
	`RETURN
(
cu¼’t_‹rm
);

57 
	}
}

59 
	gX­Ÿn
::
doccouÁ


60 
B¿ssAÎT”msLi¡
::
	$g‘_‹rmäeq
() const

62 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "BrassAllTermsList::get_termfreq", "");

63 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

64 
	`As£¹
(!
	`©_’d
());

65 ià(
‹rmäeq
 =ğ0è
	`»ad_‹rmäeq_ªd_cŞläeq
();

66 
	`RETURN
(
‹rmäeq
);

67 
	}
}

69 
	gX­Ÿn
::
‹rmcouÁ


70 
B¿ssAÎT”msLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

72 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassAllTermsList::get_collection_freq", "");

73 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

74 
	`As£¹
(!
	`©_’d
());

75 ià(
‹rmäeq
 =ğ0è
	`»ad_‹rmäeq_ªd_cŞläeq
();

76 
	`RETURN
(
cŞläeq
);

77 
	}
}

79 
T”mLi¡
 *

80 
	gB¿ssAÎT”msLi¡
::
	$Ãxt
()

82 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "BrassAllTermsList::next", "");

83 
	`As£¹
(!
	`©_’d
());

86 
‹rmäeq
 = 0;

88 
Œue
) {

89 
cursÜ
->
	`Ãxt
();

90 ià(
cursÜ
->
	`aá”_’d
()) {

91 
cu¼’t_‹rm
.
	`»size
(0);

92 
	`RETURN
(
NULL
);

95 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

96 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

97 ià(!
	`uÅack_¡ršg_´e£rvšg_sÜt
(&
p
, 
³nd
, 
cu¼’t_‹rm
)) {

98 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("PostListable key has unexpected format");

104 ià(
p
 =ğ
³nd
) ;

107 ià(!
	`¡¬tsw™h
(
cu¼’t_‹rm
, 
´efix
)) {

109 
cursÜ
->
	`to_’d
();

110 
cu¼’t_‹rm
.
	`»size
(0);

113 
	`RETURN
(
NULL
);

114 
	}
}

116 
T”mLi¡
 *

117 
	gB¿ssAÎT”msLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
‹rm
)

119 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "B¿ssAÎT”msLi¡::sk_to", 
‹rm
);

120 
	`As£¹
(!
	`©_’d
());

123 
‹rmäeq
 = 0;

125 
¡ršg
 
key
 = 
	`·ck_b¿ss_po¡li¡_key
(
‹rm
);

126 ià(
cursÜ
->
	`fšd_’Œy_ge
(
key
)) {

129 
cu¼’t_‹rm
 = 
‹rm
;

131 ià(
cursÜ
->
	`aá”_’d
()) {

132 
cu¼’t_‹rm
.
	`»size
(0);

133 
	`RETURN
(
NULL
);

136 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

137 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

138 ià(!
	`uÅack_¡ršg_´e£rvšg_sÜt
(&
p
, 
³nd
, 
cu¼’t_‹rm
)) {

139 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("PostListable key has unexpected format");

143 ià(!
	`¡¬tsw™h
(
cu¼’t_‹rm
, 
´efix
)) {

145 
cursÜ
->
	`to_’d
();

146 
cu¼’t_‹rm
.
	`»size
(0);

149 
	`RETURN
(
NULL
);

150 
	}
}

152 
boŞ


153 
	gB¿ssAÎT”msLi¡
::
	$©_’d
() const

155 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassAllTermsList::at_end", "");

156 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

157 
	}
}

	@backends/brass/brass_alltermslist.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_ALLTERMSLIST_H


22 
	#XAPIAN_INCLUDED_BRASS_ALLTERMSLIST_H


	)

24 
	~"®É”m¦i¡.h
"

25 
	~"b¿ss_d©aba£.h
"

26 
	~"b¿ss_po¡li¡.h
"

28 
şass
 
	gB¿ssCursÜ
;

30 şas 
	cB¿ssAÎT”msLi¡
 : 
public
 
AÎT”msLi¡
 {

32 
B¿ssAÎT”msLi¡
(const BrassAllTermsList &);

35 
	mİ”©Ü
=(cÚ¡ 
B¿ssAÎT”msLi¡
 &);

38 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
d©aba£
;

43 
B¿ssCursÜ
 * 
	mcursÜ
;

46 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

49 
	m¡d
::
¡ršg
 
´efix
;

57 
mubË
 
	mX­Ÿn
::
doccouÁ
 
‹rmäeq
;

60 
mubË
 
	mX­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

63 
	$»ad_‹rmäeq_ªd_cŞläeq
() const;

65 
public
:

66 
	`B¿ssAÎT”msLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
d©aba£_
,

67 cÚ¡ 
¡d
::
¡ršg
 & 
´efix_
)

68 : 
	`d©aba£
(
d©aba£_
), 
	`´efix
(
´efix_
), 
	$‹rmäeq
(0) {

69 
cursÜ
 = 
d©aba£
->
po¡li¡_bË
.
	`cursÜ_g‘
();

70 
	`As£¹
(
cursÜ
);

75 ià(
´efix
.
	`em±y
()) {

76 
cursÜ
->
	`fšd_’Œy_É
(
¡d
::
	`¡ršg
("\x00\xff", 2));

78 
¡d
::
¡ršg
 
key
 = 
	`·ck_b¿ss_po¡li¡_key
(
´efix
);

79 
cursÜ
->
	`fšd_’Œy_É
(
key
);

84 ~
	`B¿ssAÎT”msLi¡
();

91 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

98 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

105 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

108 
T”mLi¡
 * 
	`Ãxt
();

111 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
);

114 
boŞ
 
	$©_’d
() const;

115 
	}
};

	@backends/brass/brass_btreebase.cc

22 
	~<cÚfig.h
>

24 
	~"§ã”ºo.h
"

25 #ifdeà
__WIN32__


26 
	~"msvc_posix_w¿µ”.h
"

29 
	~<x­Ÿn/”rÜ.h
>

31 
	~"b¿ss_bŒ“ba£.h
"

32 
	~"b¿ss_io.h
"

33 
	~"omas£¹.h
"

34 
	~"·ck.h
"

35 
	~"uts.h
"

37 
	~<®gÜ™hm
>

38 
	~<şim™s
>

39 
	~<c¡ršg
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

71 
	#CURR_FORMAT
 5U

	)

73 
	gB¿ssTabË_ba£
::
	$B¿ssTabË_ba£
()

74 : 
	`»visiÚ
(0),

75 
	`block_size
(0),

76 
	`roÙ
(0),

77 
	`Ëv–
(0),

78 
	`b™_m­_size
(0),

79 
	`™em_couÁ
(0),

80 
	`Ï¡_block
(0),

81 
	`have_çk”oÙ
(
çl£
),

82 
	`£qu’tŸl
(
çl£
),

83 
	`b™_m­_low
(0),

84 
	`b™_m­0
(0),

85 
	$b™_m­
(0)

87 
	}
}

89 
	gB¿ssTabË_ba£
::
	$B¿ssTabË_ba£
(cÚ¡ 
B¿ssTabË_ba£
 &
Ùh”
)

90 : 
	`»visiÚ
(
Ùh”
.
»visiÚ
),

91 
	`block_size
(
Ùh”
.
block_size
),

92 
	`roÙ
(
Ùh”
.
roÙ
),

93 
	`Ëv–
(
Ùh”
.
Ëv–
),

94 
	`b™_m­_size
(
Ùh”
.
b™_m­_size
),

95 
	`™em_couÁ
(
Ùh”
.
™em_couÁ
),

96 
	`Ï¡_block
(
Ùh”
.
Ï¡_block
),

97 
	`have_çk”oÙ
(
Ùh”
.
have_çk”oÙ
),

98 
	`£qu’tŸl
(
Ùh”
.
£qu’tŸl
),

99 
	`b™_m­_low
(
Ùh”
.
b™_m­_low
),

100 
	`b™_m­0
(0),

101 
	$b™_m­
(0)

103 
Œy
 {

104 
b™_m­0
 = 
Ãw
 
by‹
[
b™_m­_size
];

105 
b™_m­
 = 
Ãw
 
by‹
[
b™_m­_size
];

107 
	`memıy
(
b™_m­0
, 
Ùh”
.b™_m­0, 
b™_m­_size
);

108 
	`memıy
(
b™_m­
, 
Ùh”
.b™_m­, 
b™_m­_size
);

109 } 
	`ÿtch
 (...) {

110 
d–‘e
 [] 
b™_m­0
;

111 
d–‘e
 [] 
b™_m­
;

113 
	}
}

116 
	gB¿ssTabË_ba£
::
	$sw­
(
B¿ssTabË_ba£
 &
Ùh”
)

118 
¡d
::
	`sw­
(
»visiÚ
, 
Ùh”
.revision);

119 
¡d
::
	`sw­
(
block_size
, 
Ùh”
.block_size);

120 
¡d
::
	`sw­
(
roÙ
, 
Ùh”
.root);

121 
¡d
::
	`sw­
(
Ëv–
, 
Ùh”
.level);

122 
¡d
::
	`sw­
(
b™_m­_size
, 
Ùh”
.bit_map_size);

123 
¡d
::
	`sw­
(
™em_couÁ
, 
Ùh”
.item_count);

124 
¡d
::
	`sw­
(
Ï¡_block
, 
Ùh”
.last_block);

125 
¡d
::
	`sw­
(
have_çk”oÙ
, 
Ùh”
.have_fakeroot);

126 
¡d
::
	`sw­
(
£qu’tŸl
, 
Ùh”
.sequential);

127 
¡d
::
	`sw­
(
b™_m­_low
, 
Ùh”
.bit_map_low);

128 
¡d
::
	`sw­
(
b™_m­0
, 
Ùh”
.bit_map0);

129 
¡d
::
	`sw­
(
b™_m­
, 
Ùh”
.bit_map);

130 
	}
}

132 
	gB¿ssTabË_ba£
::~
	$B¿ssTabË_ba£
()

134 
d–‘e
 [] 
b™_m­
;

135 
b™_m­
 = 0;

136 
d–‘e
 [] 
b™_m­0
;

137 
b™_m­0
 = 0;

138 
	}
}

141 
boŞ


142 
	$do_uÅack_ušt
(cÚ¡ **
¡¬t
, cÚ¡ *
’d
,

143 
ušt4
 *
de¡
, 
¡ršg
 &
”r_msg
,

144 cÚ¡ 
¡ršg
 &
ba£Çme
,

145 cÚ¡ *
v¬Çme
)

147 
boŞ
 
»suÉ
 = 
	`uÅack_ušt
(
¡¬t
, 
’d
, 
de¡
);

148 ià(
	`¿»
(!
»suÉ
)) {

149 
”r_msg
 += "Unableo„ead ";

150 
”r_msg
 +ğ
v¬Çme
;

151 
”r_msg
 += " from ";

152 
”r_msg
 +ğ
ba£Çme
;

153 
”r_msg
 += '\n';

155  
»suÉ
;

156 
	}
}

158 
boŞ


159 
	$do_uÅack_ušt
(cÚ¡ **
¡¬t
, cÚ¡ *
’d
,

160 
b¿ss_bËsize_t
 *
de¡
, 
¡ršg
 &
”r_msg
,

161 cÚ¡ 
¡ršg
 &
ba£Çme
,

162 cÚ¡ *
v¬Çme
)

164 
boŞ
 
»suÉ
 = 
	`uÅack_ušt
(
¡¬t
, 
’d
, 
de¡
);

165 ià(
	`¿»
(!
»suÉ
)) {

166 
”r_msg
 += "Unableo„ead ";

167 
”r_msg
 +ğ
v¬Çme
;

168 
”r_msg
 += " from ";

169 
”r_msg
 +ğ
ba£Çme
;

170 
”r_msg
 += '\n';

172  
»suÉ
;

173 
	}
}

175 
	#DO_UNPACK_UINT_ERRCHECK
(
¡¬t
, 
’d
, 
v¬
) \

177 ià(!
	`do_uÅack_ušt
(
¡¬t
, 
’d
, &
v¬
, 
”r_msg
, 
ba£Çme
, #var)) { \

178  
çl£
; \

180 } 0)

	)

188 
	#REASONABLE_BASE_SIZE
 1024

	)

190 
boŞ


191 
	gB¿ssTabË_ba£
::
	$»ad
(cÚ¡ 
¡ršg
 & 
Çme
, 
ch
, sŒšg &
”r_msg
)

193 
¡ršg
 
ba£Çme
 = 
Çme
 + "ba£" + 
ch
;

194 #ifdeà
__WIN32__


195 
h
 = 
	`msvc_posix_İ’
(
ba£Çme
.
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

197 
h
 = 
	`İ’
(
ba£Çme
.
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

200 ià(
h
 == -1) {

201 
”r_msg
 +ğ"Couldn'ˆİ’ " + 
ba£Çme
 + ": " + 
	`¡»¼Ü
(
”ºo
) + "\n";

202  
çl£
;

204 
fdşo£r
 
	`şo£fd
(
h
);

206 
buf
[
REASONABLE_BASE_SIZE
];

208 cÚ¡ *
¡¬t
 = 
buf
;

209 cÚ¡ *
’d
 = 
buf
 + 
	`b¿ss_io_»ad
(
h
, buf, 
REASONABLE_BASE_SIZE
, 0);

211 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
»visiÚ
);

212 
ušt4
 
fÜm©
;

213 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
fÜm©
);

214 ià(
fÜm©
 !ğ
CURR_FORMAT
) {

215 
”r_msg
 +ğ"Bad ba£ ffÜm© " + 
	`om_to¡ršg
(
fÜm©
) + " in " +

216 
ba£Çme
 + "\n";

217  
çl£
;

219 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
block_size
);

220 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
roÙ
);

221 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
Ëv–
);

222 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
b™_m­_size
);

223 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
™em_couÁ
);

224 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
Ï¡_block
);

225 
ušt4
 
have_çk”oÙ_
;

226 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
have_çk”oÙ_
);

227 
have_çk”oÙ
 = 
have_çk”oÙ_
;

229 
ušt4
 
£qu’tŸl_
;

230 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
£qu’tŸl_
);

231 
£qu’tŸl
 = 
£qu’tŸl_
;

233 ià(
have_çk”oÙ
 && !
£qu’tŸl
) {

234 
£qu’tŸl
 = 
Œue
;

244 
ušt4
 
»visiÚ2
;

245 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
»visiÚ2
);

246 ià(
»visiÚ
 !ğ
»visiÚ2
) {

247 
”r_msg
 += "Revision‚umber mismatch in " +

248 
ba£Çme
 + ": " +

249 
	`om_to¡ršg
(
»visiÚ
è+ " v " + om_to¡ršg(
»visiÚ2
) + "\n";

250  
çl£
;

254 
d–‘e
 [] 
b™_m­0
;

255 
b™_m­0
 = 0;

256 
d–‘e
 [] 
b™_m­
;

257 
b™_m­
 = 0;

259 
b™_m­0
 = 
Ãw
 
by‹
[
b™_m­_size
];

260 
b™_m­
 = 
Ãw
 
by‹
[
b™_m­_size
];

262 
size_t
 
n
 = 
’d
 - 
¡¬t
;

263 ià(
n
 < 
b™_m­_size
) {

264 
	`memıy
(
b™_m­0
, 
¡¬t
, 
n
);

265 ()
	`b¿ss_io_»ad
(
h
, 
»š‹½»t_ÿ¡
<*>(
b™_m­0
è+ 
n
,

266 
b™_m­_size
 - 
n
, bit_map_size -‚);

267 
n
 = 0;

269 
	`memıy
(
b™_m­0
, 
¡¬t
, 
b™_m­_size
);

270 
n
 -ğ
b™_m­_size
;

271 ià(
n
è
	`memmove
(
buf
, 
¡¬t
 + 
b™_m­_size
,‚);

273 
	`memıy
(
b™_m­
, 
b™_m­0
, 
b™_m­_size
);

275 
¡¬t
 = 
buf
;

276 
’d
 = 
buf
 + 
n
;

277 
’d
 +ğ
	`b¿ss_io_»ad
(
h
, 
buf
 + 
n
, 
REASONABLE_BASE_SIZE
 -‚, 0);

279 
ušt4
 
»visiÚ3
;

280 ià(!
	`uÅack_ušt
(&
¡¬t
, 
’d
, &
»visiÚ3
)) {

281 
”r_msg
 += "Couldn't„ead„evision3 from base file " +

282 
ba£Çme
 + "\n";

283  
çl£
;

286 ià(
»visiÚ
 !ğ
»visiÚ3
) {

287 
”r_msg
 += "Revision‚umber mismatch in " +

288 
ba£Çme
 + ": " +

289 
	`om_to¡ršg
(
»visiÚ
è+ " v " + om_to¡ršg(
»visiÚ3
) + "\n";

290  
çl£
;

293 ià(
¡¬t
 !ğ
’d
) {

294 
”r_msg
 +ğ"Junk‡ˆ’d oàba£ f" + 
ba£Çme
 + "\n";

295  
çl£
;

298  
Œue
;

299 
	}
}

302 
	gB¿ssTabË_ba£
::
	$wr™e_to_fe
(cÚ¡ 
¡ršg
 &
f’ame
,

303 
ba£_Ë‰”
,

304 cÚ¡ 
¡ršg
 &
bËÇme
,

305 
chªges_fd
,

306 cÚ¡ 
¡ršg
 * 
chªges_
)

308 
	`ÿlcuÏ‹_Ï¡_block
();

310 
¡ršg
 
buf
;

311 
	`·ck_ušt
(
buf
, 
»visiÚ
);

312 
	`·ck_ušt
(
buf
, 
CURR_FORMAT
);

313 
	`·ck_ušt
(
buf
, 
block_size
);

314 
	`·ck_ušt
(
buf
, 
¡©ic_ÿ¡
<
ušt4
>(
roÙ
));

315 
	`·ck_ušt
(
buf
, 
¡©ic_ÿ¡
<
ušt4
>(
Ëv–
));

316 
	`·ck_ušt
(
buf
, 
¡©ic_ÿ¡
<
ušt4
>(
b™_m­_size
));

317 
	`·ck_ušt
(
buf
, 
™em_couÁ
);

318 
	`·ck_ušt
(
buf
, 
¡©ic_ÿ¡
<
ušt4
>(
Ï¡_block
));

319 
	`·ck_ušt
(
buf
, 
have_çk”oÙ
);

320 
	`·ck_ušt
(
buf
, 
£qu’tŸl
);

321 
	`·ck_ušt
(
buf
, 
»visiÚ
);

322 ià(
b™_m­_size
 > 0) {

323 
buf
.
	`­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
b™_m­
), 
b™_m­_size
);

325 
	`·ck_ušt
(
buf
, 
»visiÚ
);

327 #ifdeà
__WIN32__


328 
h
 = 
	`msvc_posix_İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

330 
h
 = 
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

332 ià(
h
 < 0) {

333 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open base ")

334 + 
f’ame
 + "Øwr™e: " + 
	`¡»¼Ü
(
”ºo
);

335 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

337 
fdşo£r
 
	`şo£fd
(
h
);

339 ià(
chªges_fd
 >= 0) {

340 
¡ršg
 
chªges_buf
;

341 
	`·ck_ušt
(
chªges_buf
, 1u);

342 
	`·ck_¡ršg
(
chªges_buf
, 
bËÇme
);

343 
chªges_buf
 +ğ
ba£_Ë‰”
;

344 
	`·ck_ušt
(
chªges_buf
, 
buf
.
	`size
());

345 
	`b¿ss_io_wr™e
(
chªges_fd
, 
chªges_buf
.
	`d©a
(), chªges_buf.
	`size
());

346 
	`b¿ss_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

347 ià(
chªges_
 !ğ
NULL
) {

348 
	`b¿ss_io_wr™e
(
chªges_fd
, 
chªges_
->
	`d©a
(), chªges_->
	`size
());

350 
	`b¿ss_io_sync
(
chªges_fd
);

354 
	`b¿ss_io_wr™e
(
h
, 
buf
.
	`d©a
(), buf.
	`size
());

355 
	`b¿ss_io_sync
(
h
);

356 
	}
}

363 
boŞ


364 
	gB¿ssTabË_ba£
::
	$block_ä“_©_¡¬t
(
ušt4
 
n
) const

366 
size_t
 
i
 = 
n
 / 
CHAR_BIT
;

367 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

368  (
b™_m­0
[
i
] & 
b™
) == 0;

369 
	}
}

377 
	gB¿ssTabË_ba£
::
	$ä“_block
(
ušt4
 
n
)

379 
ušt4
 
i
 = 
n
 / 
CHAR_BIT
;

380 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

381 
b™_m­
[
i
] &ğ~ 
b™
;

383 ià(
b™_m­_low
 > 
i
)

384 ià((
b™_m­0
[
i
] & 
b™
) == 0)

385 
b™_m­_low
 = 
i
;

386 
	}
}

394 
	#BIT_MAP_INC
 1000

	)

398 
	gB¿ssTabË_ba£
::
	$ex‹nd_b™_m­
()

400 
n
 = 
b™_m­_size
 + 
BIT_MAP_INC
;

401 
by‹
 *
Ãw_b™_m­0
 = 0;

402 
by‹
 *
Ãw_b™_m­
 = 0;

404 
Œy
 {

405 
Ãw_b™_m­0
 = 
Ãw
 
by‹
[
n
];

406 
Ãw_b™_m­
 = 
Ãw
 
by‹
[
n
];

408 
	`memıy
(
Ãw_b™_m­0
, 
b™_m­0
, 
b™_m­_size
);

409 
	`mem£t
(
Ãw_b™_m­0
 + 
b™_m­_size
, 0, 
n
 - bit_map_size);

411 
	`memıy
(
Ãw_b™_m­
, 
b™_m­
, 
b™_m­_size
);

412 
	`mem£t
(
Ãw_b™_m­
 + 
b™_m­_size
, 0, 
n
 - bit_map_size);

413 } 
	`ÿtch
 (...) {

414 
d–‘e
 [] 
Ãw_b™_m­0
;

415 
d–‘e
 [] 
Ãw_b™_m­
;

416 
throw
;

418 
d–‘e
 [] 
b™_m­0
;

419 
b™_m­0
 = 
Ãw_b™_m­0
;

420 
d–‘e
 [] 
b™_m­
;

421 
b™_m­
 = 
Ãw_b™_m­
;

422 
b™_m­_size
 = 
n
;

423 
	}
}

435 
ušt4


436 
	gB¿ssTabË_ba£
::
	$Ãxt_ä“_block
()

438 
ušt4
 
i
;

439 
x
;

440 
i
 = 
b™_m­_low
;; i++) {

441 ià(
i
 >ğ
b™_m­_size
) {

442 
	`ex‹nd_b™_m­
();

444 
x
 = 
b™_m­0
[
i
] | 
b™_m­
[i];

445 ià(
x
 !ğ
UCHAR_MAX
) ;

447 
ušt4
 
n
 = 
i
 * 
CHAR_BIT
;

448 
d
 = 0x1;

449 (
x
 & 
d
è!ğ0è{ d <<ğ1; 
n
++; }

450 
b™_m­
[
i
] |ğ
d
;

451 
b™_m­_low
 = 
i
;

452 ià(
n
 > 
Ï¡_block
) {

453 
Ï¡_block
 = 
n
;

455  
n
;

456 
	}
}

458 
boŞ


459 
	gB¿ssTabË_ba£
::
	$fšd_chªged_block
(
ušt4
 * 
n
)

463 (*
n
è<ğ
Ï¡_block
) {

464 
size_t
 
off£t
 = (*
n
è/ 
CHAR_BIT
;

465 
b™
 = 0x1 << (*
n
è% 
CHAR_BIT
;

467 ià(((
b™_m­0
[
off£t
] & 
b™
è=ğ0è&& ((
b™_m­
[offset] & bit) != 0)) {

468  
Œue
;

470 ++(*
n
);

473  
çl£
;

474 
	}
}

476 
boŞ


477 
	gB¿ssTabË_ba£
::
	$block_ä“_now
(
ušt4
 
n
)

479 
ušt4
 
i
 = 
n
 / 
CHAR_BIT
;

480 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

481  (
b™_m­
[
i
] & 
b™
) == 0;

482 
	}
}

485 
	gB¿ssTabË_ba£
::
	$ÿlcuÏ‹_Ï¡_block
()

487 ià(
b™_m­_size
 == 0) {

488 
Ï¡_block
 = 0;

491 
i
 = 
b™_m­_size
 - 1;

492 
b™_m­
[
i
] == 0 && i > 0) {

493 
i
--;

495 
b™_m­_size
 = 
i
 + 1;

497 
x
 = 
b™_m­
[
i
];

500 ià(
x
 == 0) {

501 
Ï¡_block
 = 0;

504 
ušt4
 
n
 = (
i
 + 1è* 
CHAR_BIT
 - 1;

505 
d
 = 0x1 << (
CHAR_BIT
 - 1);

506 (
x
 & 
d
è=ğ0è{ d >>ğ1; 
n
--; }

508 
Ï¡_block
 = 
n
;

509 
	}
}

511 
boŞ


512 
	gB¿ssTabË_ba£
::
	$is_em±y
() const

514 
ušt4
 
i
 = 0; i < 
b™_m­_size
; i++) {

515 ià(
b™_m­
[
i
] != 0) {

516  
çl£
;

519  
Œue
;

520 
	}
}

523 
	gB¿ssTabË_ba£
::
	$ş—r_b™_m­
()

525 
	`mem£t
(
b™_m­
, 0, 
b™_m­_size
);

526 
	}
}

530 
	gB¿ssTabË_ba£
::
	$comm™
()

532 
	`memıy
(
b™_m­0
, 
b™_m­
, 
b™_m­_size
);

533 
b™_m­_low
 = 0;

534 
	}
}

	@backends/brass/brass_btreebase.h

22 #iâdeà
OM_HGUARD_BRASS_BTREEBASE_H


23 
	#OM_HGUARD_BRASS_BTREEBASE_H


	)

25 
	~<¡ršg
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~"b¿ss_ty³s.h
"

31 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mB¿ssTabË_ba£
 {

32 
	mpublic
:

34 
B¿ssTabË_ba£
();

37 
B¿ssTabË_ba£
(cÚ¡ B¿ssTabË_ba£ &
Ùh”
);

40 ~
B¿ssTabË_ba£
();

52 
boŞ
 
»ad
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, 
ch
, std::¡ršg &
”r_msg
);

54 
ušt4
 
	$g‘_»visiÚ
(ècÚ¡ {  
»visiÚ
; }

55 
ušt4
 
	$g‘_block_size
(ècÚ¡ {  
block_size
; 
	}
}

56 
ušt4
 
	$g‘_roÙ
(ècÚ¡ {  
roÙ
; 
	}
}

57 
ušt4
 
	$g‘_Ëv–
(ècÚ¡ {  
Ëv–
; 
	}
}

58 
ušt4
 
	$g‘_b™_m­_size
(ècÚ¡ {  
b™_m­_size
; 
	}
}

59 
b¿ss_bËsize_t
 
	$g‘_™em_couÁ
(ècÚ¡ {  
™em_couÁ
; 
	}
}

60 
ušt4
 
	$g‘_Ï¡_block
(ècÚ¡ {  
Ï¡_block
; 
	}
}

61 
boŞ
 
	$g‘_have_çk”oÙ
(ècÚ¡ {  
have_çk”oÙ
; 
	}
}

62 
boŞ
 
	$g‘_£qu’tŸl
(ècÚ¡ {  
£qu’tŸl
; 
	}
}

64 
	$£t_»visiÚ
(
ušt4
 
»visiÚ_
) {

65 
»visiÚ
 = 
»visiÚ_
;

66 
	}
}

67 
	$£t_block_size
(
ušt4
 
block_size_
) {

68 
block_size
 = 
block_size_
;

69 
	}
}

70 
	$£t_roÙ
(
ušt4
 
roÙ_
) {

71 
roÙ
 = 
roÙ_
;

72 
	}
}

73 
	$£t_Ëv–
(
ušt4
 
Ëv–_
) {

74 
Ëv–
 = 
Ëv–_
;

75 
	}
}

76 
	$£t_™em_couÁ
(
b¿ss_bËsize_t
 
™em_couÁ_
) {

77 
™em_couÁ
 = 
™em_couÁ_
;

78 
	}
}

79 
	$£t_have_çk”oÙ
(
boŞ
 
have_çk”oÙ_
) {

80 
have_çk”oÙ
 = 
have_çk”oÙ_
;

81 
	}
}

82 
	$£t_£qu’tŸl
(
boŞ
 
£qu’tŸl_
) {

83 
£qu’tŸl
 = 
£qu’tŸl_
;

84 
	}
}

87 
wr™e_to_fe
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame
,

88 
ba£_Ë‰”
,

89 cÚ¡ 
¡d
::
¡ršg
 &
bËÇme
,

90 
chªges_fd
,

91 cÚ¡ 
¡d
::
¡ršg
 * 
chªges_
);

97 
boŞ
 
	$block_ä“_©_¡¬t
(
ušt4
 
n
) const;

99 
	`ä“_block
(
ušt4
 
n
);

101 
ušt4
 
	`Ãxt_ä“_block
();

107 
boŞ
 
	`fšd_chªged_block
(
ušt4
 * 
n
);

109 
boŞ
 
	`block_ä“_now
(
ušt4
 
n
);

111 
	`ÿlcuÏ‹_Ï¡_block
();

114 
	`ş—r_b™_m­
();

116 
	`comm™
();

119 
boŞ
 
	$is_em±y
() const;

121 
	`sw­
(
B¿ssTabË_ba£
 &
Ùh”
);

123 
´iv©e
:

125 
İ”©Ü
=(cÚ¡ 
B¿ssTabË_ba£
 &
Ùh”
);

127 
	`ex‹nd_b™_m­
();

130 
ušt4
 
»visiÚ
;

131 
ušt4
 
block_size
;

132 
ušt4
 
roÙ
;

133 
ušt4
 
Ëv–
;

134 
ušt4
 
b™_m­_size
;

135 
b¿ss_bËsize_t
 
™em_couÁ
;

136 
ušt4
 
Ï¡_block
;

137 
boŞ
 
have_çk”oÙ
;

138 
boŞ
 
£qu’tŸl
;

143 
ušt4
 
b™_m­_low
;

147 
by‹
 *
b™_m­0
;

150 
by‹
 *
b™_m­
;

151 
	}
};

	@backends/brass/brass_check.cc

24 
	~<cÚfig.h
>

26 
	~"b¿ss_check.h
"

28 
	~<şim™s
>

30 
usšg
 
Çme¥aû
 
	gB¿ss
;

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gB¿ssTabËCheck
::
	$´št_¥aûs
(
n
) const

35 
n
--è
out
.
	`put
(' ');

36 
	}
}

38 
	gB¿ssTabËCheck
::
	$´št_by‹s
(
n
, cÚ¡ 
by‹
 * 
p
) const

40 
out
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
), 
n
);

41 
	}
}

43 
	gB¿ssTabËCheck
::
	$´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const

45 
I‹m
 
	`™em
(
p
, 
c
);

46 
¡ršg
 
key
;

47 ià(
™em
.
	`key
().
	`Ëngth
() >= 0)

48 
™em
.
	`key
().
	`»ad
(&
key
);

49 ià(
j
 == 0) {

50 
out
 << 
key
 << '/' << 
™em
.
	`compÚ’t_of
();

52 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
key
.
	`begš
(); i !ğkey.
	`’d
(); ++i) {

54 
ch
 = *
i
;

55 ià(
ch
 < 32è
out
 << '/' << (ch); out << ch;

58 
	}
}

60 
	gB¿ssTabËCheck
::
	$´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const

62 
I‹m
 
	`™em
(
p
, 
c
);

63 
¡ršg
 
g
;

64 
™em
.
	`­³nd_chunk
(&
g
);

65 ià(
j
 == 0) {

66 
out
 << "/" << 
™em
.
	`compÚ’ts_of
(è<< 
g
;

68 
out
 << "--> [" << 
	`g‘št4
(
»š‹½»t_ÿ¡
<cÚ¡ 
by‹
*>(
g
.
	`d©a
()), 0)

71 
	}
}

73 
	gB¿ssTabËCheck
::
	$»pÜt_block_fuÎ
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const

75 
j
 = 
	`GET_LEVEL
(
p
);

76 
dœ_’d
 = 
	`DIR_END
(
p
);

77 
out
 << '\n';

78 
	`´št_¥aûs
(
m
);

79 
out
 << "Block [" << 
n
 << "]†ev– " << 
j
 << ",„evisiÚ *" << 
	`REVISION
(
p
)

80 << " i‹m (" << (
dœ_’d
 - 
DIR_START
)/
D2
 << ") usage "

81 << 
	`block_u§ge
(
p
) << "%:\n";

82 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

83 
	`´št_¥aûs
(
m
);

84 
	`´št_key
(
p
, 
c
, 
j
);

85 
out
 << ' ';

86 
	`´št_g
(
p
, 
c
, 
j
);

87 
out
 << '\n';

89 
	}
}

91 
	gB¿ssTabËCheck
::
	$block_u§ge
(cÚ¡ 
by‹
 * 
p
) const

93 
¥aû
 = 
block_size
 - 
	`DIR_END
(
p
);

94 
ä“
 = 
	`TOTAL_FREE
(
p
);

95  (
¥aû
 - 
ä“
) * 100 / space;

96 
	}
}

101 
	gB¿ssTabËCheck
::
	$»pÜt_block
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const

103 
j
 = 
	`GET_LEVEL
(
p
);

104 
dœ_’d
 = 
	`DIR_END
(
p
);

105 
c
;

106 
	`´št_¥aûs
(
m
);

107 
out
 << "[" << 
n
 << "] *" << 
	`REVISION
(
p
) << " ("

108 << (
dœ_’d
 - 
DIR_START
)/
D2
 << "è" << 
	`block_u§ge
(
p
) << "% ";

110 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

111 ià(
c
 =ğ
DIR_START
 + 6è
out
 << "... ";

112 ià(
c
 >ğ
DIR_START
 + 6 && c < 
dœ_’d
 - 6) ;

114 
	`´št_key
(
p
, 
c
, 
j
);

115 
out
 << ' ';

117 
out
 << 
’dl
;

118 
	}
}

120 
	gB¿ssTabËCheck
::
	$çu»
(
n
) const

122 
out
 << "B-Œ“ƒ¼Ü " << 
n
 << 
’dl
;

123 
throw
 "btreeƒrror";

124 
	}
}

127 
	gB¿ssTabËCheck
::
block_check
(
B¿ss
::
CursÜ
 * 
C_
, 
j
, 
İts
)

129 
by‹
 * 
	gp
 = 
C_
[
j
].
p
;

130 
ušt4
 
	gn
 = 
C_
[
j
].
n
;

131 
size_t
 
	gc
;

132 
size_t
 
	gsignifiÿÁ_c
 = 
j
 =ğ0 ? 
DIR_START
 : DIR_START + 
D2
;

135 
size_t
 
	gmax_ä“
 = 
MAX_FREE
(
p
);

136 
size_t
 
	gdœ_’d
 = 
DIR_END
(
p
);

137 
	gtÙ®_ä“
 = 
block_size
 - 
dœ_’d
;

139 ià(
	gba£
.
block_ä“_©_¡¬t
(
n
)è
çu»
(0);

140 ià(
	gba£
.
block_ä“_now
(
n
)è
çu»
(1);

141 
	gba£
.
ä“_block
(
n
);

143 ià(
	gj
 !ğ
GET_LEVEL
(
p
)è
çu»
(10);

144 ià(
	gdœ_’d
 <ğ
DIR_START
 || 
dœ_’d
 > 
block_size
è
çu»
(20);

146 ià(
	gİts
 & 
	gOPT_SHORT_TREE
è
»pÜt_block
(3*(
Ëv–
 - 
j
), 
n
, 
p
);

148 ià(
	gİts
 & 
	gOPT_FULL_TREE
è
»pÜt_block_fuÎ
(3*(
Ëv–
 - 
j
), 
n
, 
p
);

150 
	gc
 = 
DIR_START
; c < 
	gdœ_’d
; c +ğ
D2
) {

151 
I‹m
 
™em
(
p
, 
c
);

152 
	go
 = 
™em
.
g‘_add»ss
(è- 
p
;

153 ià(
	go
 > (
	gblock_size
)è
çu»
(21);

154 ià(
	go
 - 
	gdœ_’d
 < 
	gmax_ä“
è
çu»
(30);

156 
	gkt_Ën
 = 
™em
.
size
();

157 ià(
	go
 + 
	gkt_Ën
 > (
	gblock_size
)è
çu»
(40);

158 
	gtÙ®_ä“
 -ğ
kt_Ën
;

160 ià(
	gc
 > 
	gsignifiÿÁ_c
 && 
I‹m
(
p
, 
c
 - 
D2
).
key
(è>ğ
™em
.key())

161 
çu»
(50);

163 ià(
	gtÙ®_ä“
 !ğ
TOTAL_FREE
(
p
))

164 
çu»
(60);

166 ià(
	gj
 == 0) ;

167 
	gc
 = 
DIR_START
; c < 
	gdœ_’d
; c +ğ
D2
) {

168 
C_
[
j
].
c
 = c;

169 
block_to_cursÜ
(
C_
, 
j
 - 1, 
I‹m
(
p
, 
c
).
block_giv’_by
());

171 
block_check
(
C_
, 
j
 - 1, 
İts
);

173 
by‹
 * 
	gq
 = 
C_
[
j
 - 1].
p
;

177 ià(
	gj
 =ğ1 && 
c
 > 
DIR_START
)

178 ià(
I‹m
(
q
, 
DIR_START
).
key
(è< I‹m(
p
, 
c
).key())

179 
çu»
(70);

184 ià(
	gj
 > 1 && 
	gc
 > 
	gDIR_START
 && 
DIR_END
(
q
è> DIR_START + 
	gD2
 &&

185 
I‹m
(
q
, 
DIR_START
 + 
D2
).
key
(è< I‹m(
p
, 
c
).key())

186 
çu»
(80);

191 ià(
	gc
 + 
	gD2
 < 
	gdœ_’d
 &&

192 (
	gj
 =ğ1 || 
DIR_START
 + 
D2
 < 
DIR_END
(
q
)) &&

193 
I‹m
(
q
, 
DIR_END
(qè- 
D2
).
key
(è>ğI‹m(
p
, 
c
 + D2).key())

194 
çu»
(90);

196 ià(
REVISION
(
q
è> REVISION(
p
)è
çu»
(91);

201 
	gB¿ssTabËCheck
::
	$check
(cÚ¡ * 
bËÇme
, cÚ¡ 
¡ršg
 & 
·th
, 
İts
,

202 
o¡»am
 &
out
)

204 
B¿ssTabËCheck
 
	`B
(
bËÇme
, 
·th
, 
çl£
, 
out
);

205 
B
.
	`İ’
();

206 
B¿ss
::
CursÜ
 * 
C
 = 
B
.C;

208 ià(
İts
 & 
OPT_SHOW_STATS
) {

209 
out
 << "ba£" << ()
B
.
ba£_Ë‰”


210 << " blocksize=" << 
B
.
block_size
 / 1024 << "K"

211 " i‹ms=" << 
B
.
™em_couÁ


212 << "†a¡block=" << 
B
.
ba£
.
	`g‘_Ï¡_block
()

213 << "„evisiÚ=" << 
B
.
»visiÚ_numb”


214 << "†ev–s=" << 
B
.
Ëv–


216 ià(
B
.
çked_roÙ_block
)

217 
out
 << "(faked)";

219 
out
 << 
C
[
B
.
Ëv–
].
n
;

220 
out
 << 
’dl
;

223 
lim™
 = 
B
.
ba£
.
	`g‘_b™_m­_size
() - 1;

225 
lim™
 =†im™ * 
CHAR_BIT
 + CHAR_BIT - 1;

227 ià(
İts
 & 
OPT_SHOW_BITMAP
) {

228 
j
 = 0; j <ğ
lim™
; j++) {

229 
out
 << (
B
.
ba£
.
	`block_ä“_©_¡¬t
(
j
) ? '.' : '*');

230 ià(
j
 > 0) {

231 ià((
j
 + 1) % 100 == 0) {

232 
out
 << '\n';

233 } ià((
j
 + 1) % 10 == 0) {

234 
out
 << ' ';

238 
out
 << '\n' << 
’dl
;

241 ià(
B
.
çked_roÙ_block
) {

242 ià(
İts
è
out
 << "void ";

244 
B
.
	`block_check
(
C
, B.
Ëv–
, 
İts
);

248 ià(!
B
.
ba£
.
	`is_em±y
()) {

249 
B
.
	`çu»
(100);

252 ià(
İts
è
out
 << "B-Œ“ checked okay" << 
’dl
;

253 
	}
}

255 
	gB¿ssTabËCheck
::
»pÜt_cursÜ
(
N
, cÚ¡ 
B¿ss
::
CursÜ
 * 
C_
) const

257 
out
 << 
N
 << ")\n";

258 
	gi
 = 0; i <ğ
Ëv–
; i++)

259 
	gout
 << "p=" << 
	gC_
[
i
].
	gp
 << ", c=" << C_[i].
	gc
 << ",‚=[" << C_[i].
	gn


260 << "],„ewr™e=" << 
	gC_
[
i
].
	g»wr™e
 << 
	g’dl
;

	@backends/brass/brass_check.h

24 #iâdeà
OM_HGUARD_BRASS_CHECK_H


25 
	#OM_HGUARD_BRASS_CHECK_H


	)

27 
	~"b¿ss_bË.h
"

28 
	~"nÜ‘uº.h
"

30 
	~<io¡»am
>

31 
	~<¡ršg
>

33 şas 
	cB¿ssTabËCheck
 : 
public
 
B¿ssTabË
 {

34 
public
:

35 
check
(cÚ¡ * 
bËÇme
, cÚ¡ 
¡d
::
¡ršg
 & 
·th
,

36 
İts
, 
¡d
::
o¡»am
 &
out
 = std::
cout
);

37 
	m´iv©e
:

38 
B¿ssTabËCheck
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡d
::
¡ršg
 &
·th_
,

39 
boŞ
 
»adÚly
, 
¡d
::
o¡»am
 &
out_
)

40 : 
B¿ssTabË
(
bËÇme_
, 
·th_
, 
»adÚly
), 
	$out
(
out_
) { }

42 
	`block_check
(
B¿ss
::
CursÜ
 * 
C_
, 
j
, 
İts
);

43 
	$block_u§ge
(cÚ¡ 
by‹
 * 
p
) const;

44 
	$»pÜt_block
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const;

45 
	$»pÜt_block_fuÎ
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const;

46 
	`»pÜt_cursÜ
(
N
, cÚ¡ 
B¿ss
::
CursÜ
 *
C_
) const;

48 
	`XAPIAN_NORETURN
(
	$çu»
(
n
) const);

49 
	$´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const;

50 
	$´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const;

51 
	$´št_¥aûs
(
n
) const;

52 
	$´št_by‹s
(
n
, cÚ¡ 
by‹
 * 
p
) const;

54 
mubË
 
¡d
::
o¡»am
 &
out
;

55 
	}
};

57 
	#OPT_SHORT_TREE
 1

	)

58 
	#OPT_FULL_TREE
 2

	)

59 
	#OPT_SHOW_BITMAP
 4

	)

60 
	#OPT_SHOW_STATS
 8

	)

	@backends/brass/brass_cursor.cc

22 
	~<cÚfig.h
>

24 
	~"b¿ss_cursÜ.h
"

26 
	~"§ã”ºo.h
"

28 
	~<x­Ÿn/”rÜ.h
>

30 
	~"b¿ss_bË.h
"

31 
	~"omas£¹.h
"

32 
	~"omdebug.h
"

34 
usšg
 
Çme¥aû
 
	gB¿ss
;

36 #ifdeà
XAPIAN_DEBUG_LOG


37 
¡ršg


38 
	$hex_di¥Ïy_’code
(cÚ¡ 
¡ršg
 & 
šput
)

40 cÚ¡ * 
bË
 = "0123456789abcdef";

41 
¡ršg
 
»suÉ
;

42 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
šput
.
	`begš
(); i !ğšput.
	`’d
(); ++i) {

43 
v®
 = *
i
;

44 
»suÉ
 += "\\x";

45 
»suÉ
 +ğ
bË
[
v®
/16];

46 
»suÉ
 +ğ
bË
[
v®
%16];

49  
»suÉ
;

50 
	}
}

53 
	#DIR_START
 11

	)

55 
	gB¿ssCursÜ
::
	$B¿ssCursÜ
(cÚ¡ 
B¿ssTabË
 *
B_
)

56 : 
	`is_pos™iÚed
(
çl£
),

57 
	`is_aá”_’d
(
çl£
),

58 
	`g_¡©us
(
UNREAD
),

59 
	`B
(
B_
),

60 
	`Ëv–
(
B_
->
Ëv–
)

62 
C
 = 
Ãw
 
B¿ss
::
CursÜ
[
Ëv–
 + 1];

64 
j
 = 0; j < 
Ëv–
; j++) {

65 
C
[
j
].
n
 = 
BLK_UNUSED
;

66 
C
[
j
].
p
 = 
Ãw
 
by‹
[
B
->
block_size
];

68 
C
[
Ëv–
].
n
 = 
B
->C[level].n;

69 
C
[
Ëv–
].
p
 = 
B
->C[level].p;

70 
	}
}

72 
	gB¿ssCursÜ
::~
	$B¿ssCursÜ
()

76 
j
 = 0; j < 
Ëv–
; j++) {

77 
d–‘e
 [] 
C
[
j
].
p
;

79 
d–‘e
 [] 
C
;

80 
	}
}

82 
boŞ


83 
	gB¿ssCursÜ
::
	$´ev
()

85 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassCursor::prev", "");

86 
	`As£¹
(
B
->
Ëv–
 <=†evel);

87 
	`As£¹
(!
is_aá”_’d
);

89 ià(!
is_pos™iÚed
) {

93 
boŞ
 
»suÉ
 = 
	`fšd_’Œy
(
cu¼’t_key
);

94 ()
»suÉ
;

95 
	`As£¹
(
»suÉ
);

96 
g_¡©us
 = 
UNREAD
;

99 ià(
g_¡©us
 !ğ
UNREAD
) {

100 
Œue
) {

101 ià(! 
B
->
	`´ev
(
C
, 0)) {

102 
is_pos™iÚed
 = 
çl£
;

103 
	`RETURN
(
çl£
);

105 ià(
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

111 
Œue
) {

112 ià(! 
B
->
	`´ev
(
C
, 0)) {

113 
is_pos™iÚed
 = 
çl£
;

114 
	`RETURN
(
çl£
);

116 ià(
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

120 
	`g‘_key
(&
cu¼’t_key
);

121 
g_¡©us
 = 
UNREAD
;

123 
	`LOGLINE
(
DB
, "MovedØ’Œy: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

124 
	`RETURN
(
Œue
);

125 
	}
}

127 
boŞ


128 
	gB¿ssCursÜ
::
	$Ãxt
()

130 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassCursor::next", "");

131 
	`As£¹
(
B
->
Ëv–
 <=†evel);

132 
	`As£¹
(!
is_aá”_’d
);

133 ià(
g_¡©us
 =ğ
UNREAD
) {

134 
Œue
) {

135 ià(! 
B
->
	`Ãxt
(
C
, 0)) {

136 
is_pos™iÚed
 = 
çl£
;

139 ià(
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

140 
is_pos™iÚed
 = 
Œue
;

146 ià(!
is_pos™iÚed
) {

147 
is_aá”_’d
 = 
Œue
;

148 
	`RETURN
(
çl£
);

151 
	`g‘_key
(&
cu¼’t_key
);

152 
g_¡©us
 = 
UNREAD
;

154 
	`LOGLINE
(
DB
, "MovedØ’Œy: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

155 
	`RETURN
(
Œue
);

156 
	}
}

158 
boŞ


159 
	gB¿ssCursÜ
::
	$fšd_’Œy
(cÚ¡ 
¡ršg
 &
key
)

161 
	`DEBUGCALL
(
DB
, 
boŞ
, "B¿ssCursÜ::fšd_’Œy", 
key
);

162 
	`As£¹
(
B
->
Ëv–
 <=†evel);

164 
is_aá”_’d
 = 
çl£
;

166 
boŞ
 
found
;

168 
is_pos™iÚed
 = 
Œue
;

169 ià(
key
.
	`size
(è> 
BRASS_BTREE_MAX_KEY_LEN
) {

172 
B
->
	`fÜm_key
(
key
.
	`sub¡r
(0, 
BRASS_BTREE_MAX_KEY_LEN
));

173 ()(
B
->
	`fšd
(
C
));

174 
found
 = 
çl£
;

176 
B
->
	`fÜm_key
(
key
);

177 
found
 = 
B
->
	`fšd
(
C
);

180 ià(!
found
) {

181 ià(
C
[0].
c
 < 
DIR_START
) {

182 
C
[0].
c
 = 
DIR_START
;

183 ià(! 
B
->
	`´ev
(
C
, 0)è
dÚe
;

185 
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() != 1) {

186 ià(! 
B
->
	`´ev
(
C
, 0)) {

187 
is_pos™iÚed
 = 
çl£
;

188 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("find_entry failedo find‡nyƒntry‡t‡ll!");

192 
dÚe
:

194 ià(
found
)

195 
cu¼’t_key
 = 
key
;

197 
	`g‘_key
(&
cu¼’t_key
);

198 
g_¡©us
 = 
UNREAD
;

200 
	`LOGLINE
(
DB
, "FoundƒÁry: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

201 
	`RETURN
(
found
);

202 
	}
}

204 
boŞ


205 
	gB¿ssCursÜ
::
	$fšd_’Œy_ge
(cÚ¡ 
¡ršg
 &
key
)

207 
	`DEBUGCALL
(
DB
, 
boŞ
, "B¿ssCursÜ::fšd_’Œy_ge", 
key
);

208 
	`As£¹
(
B
->
Ëv–
 <=†evel);

210 
is_aá”_’d
 = 
çl£
;

212 
boŞ
 
found
;

214 
is_pos™iÚed
 = 
Œue
;

215 ià(
key
.
	`size
(è> 
BRASS_BTREE_MAX_KEY_LEN
) {

218 
B
->
	`fÜm_key
(
key
.
	`sub¡r
(0, 
BRASS_BTREE_MAX_KEY_LEN
));

219 ()(
B
->
	`fšd
(
C
));

220 
found
 = 
çl£
;

222 
B
->
	`fÜm_key
(
key
);

223 
found
 = 
B
->
	`fšd
(
C
);

226 ià(
found
) {

227 
cu¼’t_key
 = 
key
;

229 ià(! 
B
->
	`Ãxt
(
C
, 0)) {

230 
is_aá”_’d
 = 
Œue
;

231 
is_pos™iÚed
 = 
çl£
;

232 
	`RETURN
(
çl£
);

234 
	`As£¹
(
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1);

235 
	`g‘_key
(&
cu¼’t_key
);

237 
g_¡©us
 = 
UNREAD
;

239 
	`LOGLINE
(
DB
, "FoundƒÁry: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

240 
	`RETURN
(
found
);

241 
	}
}

244 
	gB¿ssCursÜ
::
	$g‘_key
(
¡ršg
 * 
key
) const

246 
	`As£¹
(
B
->
Ëv–
 <=†evel);

247 
	`As£¹
(
is_pos™iÚed
);

249 ()
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`key
().
	`»ad
(
key
);

250 
	}
}

252 
boŞ


253 
	gB¿ssCursÜ
::
	$»ad_g
(
boŞ
 
k“p_com´es£d
)

255 
	`DEBUGCALL
(
DB
, 
boŞ
, "B¿ssCursÜ::»ad_g", 
k“p_com´es£d
);

256 ià(
g_¡©us
 =ğ
UNREAD
) {

257 
	`As£¹
(
B
->
Ëv–
 <=†evel);

258 
	`As£¹
(
is_pos™iÚed
);

260 ià(
B
->
	`»ad_g
(
C
, &
cu¼’t_g
, 
k“p_com´es£d
)) {

261 
g_¡©us
 = 
COMPRESSED
;

263 
g_¡©us
 = 
UNCOMPRESSED
;

268 
is_pos™iÚed
 = 
B
->
	`Ãxt
(
C
, 0);

270 
	`LOGLINE
(
DB
, "g=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_g
));

272 
	`RETURN
(
g_¡©us
 =ğ
COMPRESSED
);

273 
	}
}

275 
boŞ


276 
	gMubËB¿ssCursÜ
::
	$d–
()

278 
	`As£¹
(!
is_aá”_’d
);

284 (
cÚ¡_ÿ¡
<
B¿ssTabË
*>(
B
))->
	`d–
(
cu¼’t_key
);

291 ià(!
	`fšd_’Œy_ge
(
cu¼’t_key
)è 
is_pos™iÚed
;

292  
	`Ãxt
();

293 
	}
}

	@backends/brass/brass_cursor.h

22 #iâdeà
OM_HGUARD_BRASS_CURSOR_H


23 
	#OM_HGUARD_BRASS_CURSOR_H


	)

25 
	~<x­Ÿn/visib™y.h
>

27 
	~"b¿ss_ty³s.h
"

29 
	~<¡ršg
>

30 
usšg
 
	g¡d
::
¡ršg
;

32 
	#BLK_UNUSED
 
	`ušt4
(-1)

	)

34 
Çme¥aû
 
	gB¿ss
 {

36 şas 
	cCursÜ
 {

37 
	g´iv©e
:

39 
CursÜ
(const Cursor &);

40 
	gCursÜ
 & 
	gİ”©Ü
=(cÚ¡ 
CursÜ
 &);

42 
	gpublic
:

44 
CursÜ
(è: 
p
(0), 
c
(-1), 
n
(
BLK_UNUSED
), 
»wr™e
(
çl£
)

48 
by‹
 * 
	gp
;

50 
	gc
;

59 
ušt4
 
	gn
;

61 
boŞ
 
	g»wr™e
;

66 
şass
 
	gB¿ssTabË
;

71 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mB¿ssCursÜ
 {

72 
	m´iv©e
:

74 
B¿ssCursÜ
(const BrassCursor &);

77 
	mB¿ssCursÜ
 & 
	mİ”©Ü
=(cÚ¡ 
B¿ssCursÜ
 &);

79 
	m´Ùeùed
:

85 
boŞ
 
is_pos™iÚed
;

89 
boŞ
 
	mis_aá”_’d
;

91 
	m´iv©e
:

93 ’um { 
UNREAD
, 
	mUNCOMPRESSED
, 
	mCOMPRESSED
 } 
	gg_¡©us
;

95 
	g´Ùeùed
:

97 cÚ¡ 
B¿ssTabË
 * 
B
;

99 
	g´iv©e
:

101 
B¿ss
::
CursÜ
 * 
C
;

104 
	gËv–
;

125 
	$g‘_key
(
¡ršg
 * 
key
) const;

127 
public
:

139 
	`B¿ssCursÜ
(cÚ¡ 
B¿ssTabË
 *
B
);

142 ~
	`B¿ssCursÜ
();

146 
¡ršg
 
cu¼’t_key
;

151 
¡ršg
 
cu¼’t_g
;

165 
boŞ
 
	`»ad_g
(boŞ 
k“p_com´es£d
 = 
çl£
);

181 
boŞ
 
	`Ãxt
();

188 
boŞ
 
	`´ev
();

212 
boŞ
 
	`fšd_’Œy
(cÚ¡ 
¡ršg
 &
key
);

215 
	$fšd_’Œy_É
(cÚ¡ 
¡ršg
 &
key
) {

216 ià(
	`fšd_’Œy
(
key
)è
	`´ev
();

217 
	}
}

224 
boŞ
 
fšd_’Œy_ge
(cÚ¡ 
¡ršg
 &
key
);

228 
	$to_’d
(è{ 
is_aá”_’d
 = 
Œue
; 
	}
}

235 
boŞ
 
	$aá”_’d
(ècÚ¡ {  
is_aá”_’d
; 
	}
}

238 cÚ¡ 
B¿ssTabË
 * 
	$g‘_bË
(ècÚ¡ {  
B
; 
	}
}

241 şas 
	cMubËB¿ssCursÜ
 : 
public
 
B¿ssCursÜ
 {

242 
public
:

256 
	$MubËB¿ssCursÜ
(
B¿ssTabË
 *
B_
è: 
	$B¿ssCursÜ
(
B_
) { }

263 
boŞ
 
	`d–
();

264 
	}
};

	@backends/brass/brass_database.cc

27 
	~<cÚfig.h
>

29 
	~"b¿ss_d©aba£.h
"

31 
	~<x­Ÿn/”rÜ.h
>

32 
	~<x­Ÿn/v®ue™”©Ü.h
>

34 
	~"cÚtiguou§Îdoc¥o¡li¡.h
"

35 
	~"b¿ss_®ldoc¥o¡li¡.h
"

36 
	~"b¿ss_®É”m¦i¡.h
"

37 
	~"b¿ss_»¶iÿ‹_š‹º®.h
"

38 
	~"b¿ss_docum’t.h
"

39 
	~"b¿ss_io.h
"

40 
	~"../æšt_lock.h
"

41 
	~"b¿ss_m‘ad©a.h
"

42 
	~"b¿ss_pos™iÚli¡.h
"

43 
	~"b¿ss_po¡li¡.h
"

44 
	~"b¿ss_»cÜd.h
"

45 
	~"b¿ss_¥–lšgwÜd¦i¡.h
"

46 
	~"b¿ss_‹rmli¡.h
"

47 
	~"b¿ss_v®u–i¡.h
"

48 
	~"b¿ss_v®ues.h
"

49 
	~"omdebug.h
"

50 
	~"omtime.h
"

51 
	~"·ck.h
"

52 
	~"»mÙecÚÃùiÚ.h
"

53 
	~"»¶iÿtiÚ.h
"

54 
	~"»¶iÿtiÚ´ÙocŞ.h
"

55 
	~"£rŸli£.h
"

56 
	~"¡ršguts.h
"

57 
	~"uts.h
"

58 
	~"v®ue¡©s.h
"

60 #ifdeà
__WIN32__


61 
	~"msvc_posix_w¿µ”.h
"

64 
	~"§ã”ºo.h
"

65 
	~"§ãsys¡©.h
"

66 
	~<sys/ty³s.h
>

68 
	~<®gÜ™hm
>

69 
	~"autİŒ.h
"

70 
	~<¡ršg
>

72 
usšg
 
Çme¥aû
 
	g¡d
;

73 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

87 
	#MAX_SAFE_TERM_LENGTH
 245

	)

93 
	$sys_uÆšk_if_exi¡s
(cÚ¡ 
¡ršg
 & 
f’ame
)

95 #ifdeà
__WIN32__


96 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

98 ià(
	`uÆšk
(
f’ame
) == -1) {

100 ià(
”ºo
 =ğ
ENOENT
) ;

101 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Cª'ˆd–‘fe: `" + 
f’ame
 + "'",

102 
”ºo
);

104 
	}
}

110 
	gB¿ssD©aba£
::
	$B¿ssD©aba£
(cÚ¡ 
¡ršg
 &
b¿ss_dœ
, 
aùiÚ
,

111 
block_size
)

112 : 
	`db_dœ
(
b¿ss_dœ
),

113 
	`»adÚly
(
aùiÚ
 =ğ
XAPIAN_DB_READONLY
),

114 
	`v”siÚ_fe
(
db_dœ
),

115 
	`po¡li¡_bË
(
db_dœ
, 
»adÚly
),

116 
	`pos™iÚ_bË
(
db_dœ
, 
»adÚly
),

117 
	`‹rmli¡_bË
(
db_dœ
, 
»adÚly
),

118 
	`v®ue_mªag”
(&
po¡li¡_bË
, &
‹rmli¡_bË
),

119 
	`synÚym_bË
(
db_dœ
, 
»adÚly
),

120 
	`¥–lšg_bË
(
db_dœ
, 
»adÚly
),

121 
	`»cÜd_bË
(
db_dœ
, 
»adÚly
),

122 
	`lock
(
db_dœ
),

123 
	$max_chªge£ts
(0)

125 
	`DEBUGCALL
(
DB
, , "B¿ssD©aba£", 
b¿ss_dœ
 << ", " << 
aùiÚ
 <<

126 ", " << 
block_size
);

128 ià(
aùiÚ
 =ğ
XAPIAN_DB_READONLY
) {

129 
	`İ’_bËs_cÚsi¡’t
();

133 cÚ¡ *
p
 = 
	`g‘’v
("XAPIAN_MAX_CHANGESETS");

134 ià(
p
)

135 
max_chªge£ts
 = 
	`©oi
(
p
);

137 ià(
aùiÚ
 !ğ
X­Ÿn
::
DB_OPEN
 && !
	`d©aba£_exi¡s
()) {

142 
boŞ
 
ç
 = 
çl£
;

143 
¡©
 
¡©buf
;

144 ià(
	`¡©
(
db_dœ
, &
¡©buf
) == 0) {

145 ià(!
	`S_ISDIR
(
¡©buf
.
¡_mode
)è
ç
 = 
Œue
;

146 } ià(
”ºo
 !ğ
ENOENT
 || 
	`mkdœ
(
db_dœ
, 0755) == -1) {

147 
ç
 = 
Œue
;

149 ià(
ç
) {

150 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Cannot create directory `" +

151 
db_dœ
 + "'", 
”ºo
);

153 
	`g‘_d©aba£_wr™e_lock
(
Œue
);

155 
	`ü—‹_ªd_İ’_bËs
(
block_size
);

159 ià(
aùiÚ
 =ğ
X­Ÿn
::
DB_CREATE
) {

160 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Can't create‚ew database‡t `" +

161 
db_dœ
 + "':‡ database‡lreadyƒxists‡nd I wasold "

165 
	`g‘_d©aba£_wr™e_lock
(
çl£
);

168 ià(
aùiÚ
 =ğ
X­Ÿn
::
DB_CREATE_OR_OVERWRITE
) {

169 
	`ü—‹_ªd_İ’_bËs
(
block_size
);

174 
	`İ’_bËs_cÚsi¡’t
();

179 ià(
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
() !=

180 
po¡li¡_bË
.
	`g‘_Ï‹¡_»visiÚ_numb”
()) {

181 
b¿ss_»visiÚ_numb”_t
 
Ãw_»visiÚ
 = 
	`g‘_Ãxt_»visiÚ_numb”
();

183 
	`£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

185 
	}
}

187 
	gB¿ssD©aba£
::~
	$B¿ssD©aba£
()

189 
	`DEBUGCALL
(
DB
, , "~BrassDatabase", "");

190 
	}
}

192 
boŞ


193 
	gB¿ssD©aba£
::
	$d©aba£_exi¡s
() {

194 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassDatabase::database_exists", "");

195 
	`RETURN
(
»cÜd_bË
.
	`exi¡s
(è&& 
po¡li¡_bË
.exists());

196 
	}
}

199 
	gB¿ssD©aba£
::
	$ü—‹_ªd_İ’_bËs
(
block_size
)

201 
	`DEBUGCALL
(
DB
, , "BrassDatabase::create_and_open_tables", "");

207 
v”siÚ_fe
.
	`ü—‹
();

208 
po¡li¡_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

209 
pos™iÚ_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

210 
‹rmli¡_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

211 
synÚym_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

212 
¥–lšg_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

213 
»cÜd_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

215 
	`As£¹
(
	`d©aba£_exi¡s
());

218 
b¿ss_»visiÚ_numb”_t
 
»visiÚ
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

219 ià(
»visiÚ
 !ğ
po¡li¡_bË
.
	`g‘_İ’_»visiÚ_numb”
()) {

220 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Newly createdables‡re‚ot in consistent state");

223 
¡©s
.
	`z”o
();

224 
	}
}

227 
	gB¿ssD©aba£
::
	$İ’_bËs_cÚsi¡’t
()

229 
	`DEBUGCALL
(
DB
, , "BrassDatabase::open_tables_consistent", "");

238 
b¿ss_»visiÚ_numb”_t
 
cur_»v
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

241 ià(
cur_»v
 =ğ0è
v”siÚ_fe
.
	`»ad_ªd_check
();

243 
»cÜd_bË
.
	`İ’
();

244 
b¿ss_»visiÚ_numb”_t
 
»visiÚ
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

246 ià(
cur_»v
 && cur_»v =ğ
»visiÚ
) {

253 
block_size
 = 
»cÜd_bË
.
	`g‘_block_size
();

254 
pos™iÚ_bË
.
	`£t_block_size
(
block_size
);

255 
‹rmli¡_bË
.
	`£t_block_size
(
block_size
);

256 
synÚym_bË
.
	`£t_block_size
(
block_size
);

257 
¥–lšg_bË
.
	`£t_block_size
(
block_size
);

259 
v®ue_mªag”
.
	`»£t
();

261 
boŞ
 
fuÎy_İ’ed
 = 
çl£
;

262 
Œ›s
 = 100;

263 
Œ›s_Ëá
 = 
Œ›s
;

264 !
fuÎy_İ’ed
 && (
Œ›s_Ëá
--) > 0) {

265 ià(
¥–lšg_bË
.
	`İ’
(
»visiÚ
) &&

266 
synÚym_bË
.
	`İ’
(
»visiÚ
) &&

267 
‹rmli¡_bË
.
	`İ’
(
»visiÚ
) &&

268 
pos™iÚ_bË
.
	`İ’
(
»visiÚ
) &&

269 
po¡li¡_bË
.
	`İ’
(
»visiÚ
)) {

271 
fuÎy_İ’ed
 = 
Œue
;

283 
»cÜd_bË
.
	`İ’
();

284 
b¿ss_»visiÚ_numb”_t
 
Ãw»visiÚ
 =

285 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

286 ià(
»visiÚ
 =ğ
Ãw»visiÚ
) {

290 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Cannot openables‡t consistent„evisions");

292 
»visiÚ
 = 
Ãw»visiÚ
;

296 ià(!
fuÎy_İ’ed
) {

297 
throw
 
X­Ÿn
::
	`D©aba£Modif›dE¼Ü
("Cannot openables‡t stable„evision - changingoo fast");

300 
¡©s
.
	`»ad
(
po¡li¡_bË
);

301 
	}
}

304 
	gB¿ssD©aba£
::
	$İ’_bËs
(
b¿ss_»visiÚ_numb”_t
 
»visiÚ
)

306 
	`DEBUGCALL
(
DB
, , "B¿ssD©aba£::İ’_bËs", 
»visiÚ
);

307 
v”siÚ_fe
.
	`»ad_ªd_check
();

308 
»cÜd_bË
.
	`İ’
(
»visiÚ
);

311 
block_size
 = 
»cÜd_bË
.
	`g‘_block_size
();

312 
pos™iÚ_bË
.
	`£t_block_size
(
block_size
);

313 
‹rmli¡_bË
.
	`£t_block_size
(
block_size
);

314 
synÚym_bË
.
	`£t_block_size
(
block_size
);

315 
¥–lšg_bË
.
	`£t_block_size
(
block_size
);

317 
v®ue_mªag”
.
	`»£t
();

319 
¥–lšg_bË
.
	`İ’
(
»visiÚ
);

320 
synÚym_bË
.
	`İ’
(
»visiÚ
);

321 
‹rmli¡_bË
.
	`İ’
(
»visiÚ
);

322 
pos™iÚ_bË
.
	`İ’
(
»visiÚ
);

323 
po¡li¡_bË
.
	`İ’
(
»visiÚ
);

324 
	}
}

326 
b¿ss_»visiÚ_numb”_t


327 
	gB¿ssD©aba£
::
	$g‘_»visiÚ_numb”
() const

329 
	`DEBUGCALL
(
DB
, 
b¿ss_»visiÚ_numb”_t
, "BrassDatabase::get_revision_number", "");

331 
	`RETURN
(
po¡li¡_bË
.
	`g‘_İ’_»visiÚ_numb”
());

332 
	}
}

334 
b¿ss_»visiÚ_numb”_t


335 
	gB¿ssD©aba£
::
	$g‘_Ãxt_»visiÚ_numb”
() const

337 
	`DEBUGCALL
(
DB
, 
b¿ss_»visiÚ_numb”_t
, "BrassDatabase::get_next_revision_number", "");

342 
b¿ss_»visiÚ_numb”_t
 
Ãw_»visiÚ
 =

343 
po¡li¡_bË
.
	`g‘_Ï‹¡_»visiÚ_numb”
();

344 ++
Ãw_»visiÚ
;

345 
	`RETURN
(
Ãw_»visiÚ
);

346 
	}
}

349 
	gB¿ssD©aba£
::
	$g‘_chªge£t_»visiÚs
(cÚ¡ 
¡ršg
 & 
·th
,

350 
b¿ss_»visiÚ_numb”_t
 * 
¡¬Œev
,

351 
b¿ss_»visiÚ_numb”_t
 * 
’d»v
) const

353 
chªges_fd
 = -1;

354 #ifdeà
__WIN32__


355 
chªges_fd
 = 
	`msvc_posix_İ’
(
·th
.
	`c_¡r
(), 
O_RDONLY
);

357 
chªges_fd
 = 
	`İ’
(
·th
.
	`c_¡r
(), 
O_RDONLY
);

359 
fdşo£r
 
	`şo£r
(
chªges_fd
);

361 ià(
chªges_fd
 < 0) {

362 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open changeset ")

363 + 
·th
 + "o„ead";

364 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
, 
”ºo
);

367 
buf
[
REASONABLE_CHANGESET_SIZE
];

368 cÚ¡ *
¡¬t
 = 
buf
;

369 cÚ¡ *
’d
 = 
buf
 + 
	`b¿ss_io_»ad
(
chªges_fd
, buf,

370 
REASONABLE_CHANGESET_SIZE
, 0);

371 ià(
	`¡ºcmp
(
¡¬t
, 
CHANGES_MAGIC_STRING
,

372 
	`CONST_STRLEN
(
CHANGES_MAGIC_STRING
)) != 0) {

373 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Changeset‡t ")

374 + 
·th
 + " does‚ot contain valid magic string";

375 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

377 
¡¬t
 +ğ
	`CONST_STRLEN
(
CHANGES_MAGIC_STRING
);

378 ià(
¡¬t
 >ğ
’d
)

379 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Chªge£ˆtoØshÜˆ© " + 
·th
);

381 
chªges_v”siÚ
;

382 ià(!
	`uÅack_ušt
(&
¡¬t
, 
’d
, &
chªges_v”siÚ
))

383 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ valid version‚umber for "

384 "chªge£ˆ© " + 
·th
);

385 ià(
chªges_v”siÚ
 !ğ
CHANGES_VERSION
)

386 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Don't support version of changeset‡t "

387 + 
·th
);

389 ià(!
	`uÅack_ušt
(&
¡¬t
, 
’d
, 
¡¬Œev
))

390 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ valid start„evision from "

391 "chªge£ˆ© " + 
·th
);

393 ià(!
	`uÅack_ušt
(&
¡¬t
, 
’d
, 
’d»v
))

394 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ validƒnd„evision for "

395 "chªge£ˆ© " + 
·th
);

396 
	}
}

399 
	gB¿ssD©aba£
::
	$£t_»visiÚ_numb”
(
b¿ss_»visiÚ_numb”_t
 
Ãw_»visiÚ
)

401 
	`DEBUGCALL
(
DB
, , "B¿ssD©aba£::£t_»visiÚ_numb”", 
Ãw_»visiÚ
);

403 
v®ue_mªag”
.
	`m”ge_chªges
();

405 
po¡li¡_bË
.
	`æush_db
();

406 
pos™iÚ_bË
.
	`æush_db
();

407 
‹rmli¡_bË
.
	`æush_db
();

408 
synÚym_bË
.
	`æush_db
();

409 
¥–lšg_bË
.
	`æush_db
();

410 
»cÜd_bË
.
	`æush_db
();

412 
chªges_fd
 = -1;

413 
¡ršg
 
chªges_Çme
;

415 ià(
max_chªge£ts
 > 0) {

416 
b¿ss_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

417 ià(
Şd_»visiÚ
) {

419 
chªges_Çme
 = 
db_dœ
 + "/chªges" + 
	`om_to¡ršg
(
Şd_»visiÚ
);

420 #ifdeà
__WIN32__


421 
chªges_fd
 = 
	`msvc_posix_İ’
(
chªges_Çme
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

423 
chªges_fd
 = 
	`İ’
(
chªges_Çme
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

425 ià(
chªges_fd
 < 0) {

426 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open changeset ")

427 + 
chªges_Çme
 + "o write";

428 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
, 
”ºo
);

433 
Œy
 {

434 
fdşo£r
 
	`şo£fd
(
chªges_fd
);

435 ià(
chªges_fd
 >= 0) {

436 
¡ršg
 
buf
;

437 
b¿ss_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

438 
buf
 +ğ
CHANGES_MAGIC_STRING
;

439 
	`·ck_ušt
(
buf
, 
CHANGES_VERSION
);

440 
	`·ck_ušt
(
buf
, 
Şd_»visiÚ
);

441 
	`·ck_ušt
(
buf
, 
Ãw_»visiÚ
);

444 
	`·ck_ušt
(
buf
, 0u);

446 
	`b¿ss_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

452 
‹rmli¡_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

453 
synÚym_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

454 
¥–lšg_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

455 
»cÜd_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

456 
pos™iÚ_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

457 
po¡li¡_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

460 
po¡li¡_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

461 
pos™iÚ_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

462 
‹rmli¡_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

463 
synÚym_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

464 
¥–lšg_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

466 
¡ršg
 
chªges_
;

467 ià(
chªges_fd
 >= 0) {

468 
chªges_
 += '\0';

469 
	`·ck_ušt
(
chªges_
, 
Ãw_»visiÚ
);

471 
»cÜd_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
, &
chªges_
);

473 } 
	`ÿtch
 (...) {

475 ià(
chªges_fd
 >= 0) {

476 
	`sys_uÆšk_if_exi¡s
(
chªges_Çme
);

479 
throw
;

481 
	}
}

484 
	gB¿ssD©aba£
::
	$»İ’
()

486 
	`DEBUGCALL
(
DB
, , "BrassDatabase::reopen", "");

487 ià(
»adÚly
è
	`İ’_bËs_cÚsi¡’t
();

488 
	}
}

491 
	gB¿ssD©aba£
::
	$şo£
()

493 
	`DEBUGCALL
(
DB
, , "BrassDatabase::close", "");

494 
po¡li¡_bË
.
	`şo£
(
Œue
);

495 
pos™iÚ_bË
.
	`şo£
(
Œue
);

496 
‹rmli¡_bË
.
	`şo£
(
Œue
);

497 
synÚym_bË
.
	`şo£
(
Œue
);

498 
¥–lšg_bË
.
	`şo£
(
Œue
);

499 
»cÜd_bË
.
	`şo£
(
Œue
);

500 
lock
.
	`»Ëa£
();

501 
	}
}

504 
	gB¿ssD©aba£
::
	$g‘_d©aba£_wr™e_lock
(
boŞ
 
ü—tšg
)

506 
	`DEBUGCALL
(
DB
, , "B¿ssD©aba£::g‘_d©aba£_wr™e_lock", 
ü—tšg
);

507 
¡ršg
 
ex¶ª©iÚ
;

508 
FlštLock
::
»asÚ
 
why
 = 
lock
.
	`lock
(
Œue
, 
ex¶ª©iÚ
);

509 ià(
why
 !ğ
FlštLock
::
SUCCESS
) {

510 ià(
why
 =ğ
FlštLock
::
UNKNOWN
 && !
ü—tšg
 && !
	`d©aba£_exi¡s
()) {

511 
¡ršg
 
	`msg
("No brass database found‡t…ath `");

512 
msg
 +ğ
db_dœ
;

513 
msg
 += '\'';

514 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
);

516 
lock
.
	`throw_d©aba£lock”rÜ
(
why
, 
db_dœ
, 
ex¶ª©iÚ
);

518 
	}
}

521 
	gB¿ssD©aba£
::
	$£nd_whŞe_d©aba£
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

522 cÚ¡ 
OmTime
 & 
’d_time
)

524 
	`DEBUGCALL
(
DB
, , "BrassDatabase::send_whole_database",

528 
¡ršg
 
buf
;

529 
¡ršg
 
uuid
 = 
	`g‘_uuid
();

530 
buf
 +ğ
	`’code_Ëngth
(
uuid
.
	`size
());

531 
buf
 +ğ
uuid
;

532 
	`·ck_ušt
(
buf
, 
	`g‘_»visiÚ_numb”
());

533 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_HEADER
, 
buf
, 
’d_time
);

537 cÚ¡ 
f’ames
[] =

545 
¡ršg
 
f•©h
 = 
db_dœ
;

546 
f•©h
 += '/';

547 cÚ¡ * 
p
 = 
f’ames
; *p;… += *p + 1) {

548 
¡ršg
 
	`Ëaf
(
p
 + 1, 
	`size_t
(
¡©ic_ÿ¡
<>(*p)));

549 
f•©h
.
	`»¶aû
(
db_dœ
.
	`size
(è+ 1, 
¡ršg
::
Åos
, 
Ëaf
);

550 ià(
	`fe_exi¡s
(
f•©h
)) {

553 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FILENAME
, 
Ëaf
, 
’d_time
);

554 
cÚn
.
	`£nd_fe
(
REPL_REPLY_DB_FILEDATA
, 
f•©h
, 
’d_time
);

557 
	}
}

560 
	gB¿ssD©aba£
::
	$wr™e_chªge£ts_to_fd
(
fd
,

561 cÚ¡ 
¡ršg
 & 
»visiÚ
,

562 
boŞ
 
Ãed_whŞe_db
,

563 
R•liÿtiÚInfo
 * 
šfo
)

565 
	`DEBUGCALL
(
DB
, , "BrassDatabase::write_changesets_to_fd",

566 
fd
 << ", " << 
»visiÚ
 << ", " << 
Ãed_whŞe_db
 << ", " << 
šfo
);

568 
whŞe_db_cİ›s_Ëá
 = 
MAX_DB_COPIES_PER_CONVERSATION
;

569 
b¿ss_»visiÚ_numb”_t
 
¡¬t_»v_num
 = 0;

570 
¡ršg
 
¡¬t_uuid
 = 
	`g‘_uuid
();

572 
b¿ss_»visiÚ_numb”_t
 
Ãeded_»v_num
 = 0;

574 cÚ¡ * 
»v_±r
 = 
»visiÚ
.
	`d©a
();

575 cÚ¡ * 
»v_’d
 = 
»v_±r
 + 
»visiÚ
.
	`size
();

576 ià(!
	`uÅack_ušt
(&
»v_±r
, 
»v_’d
, &
¡¬t_»v_num
)) {

577 
Ãed_whŞe_db
 = 
Œue
;

580 
RemÙeCÚÃùiÚ
 
	`cÚn
(-1, 
fd
, 
	`¡ršg
());

581 
OmTime
 
’d_time
;

589 
Œue
) {

590 ià(
Ãed_whŞe_db
) {

594 ià(
whŞe_db_cİ›s_Ëá
 == 0) {

595 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_FAIL
,

597 
’d_time
);

600 
whŞe_db_cİ›s_Ëá
--;

603 
¡¬t_»v_num
 = 
	`g‘_»visiÚ_numb”
();

604 
¡¬t_uuid
 = 
	`g‘_uuid
();

606 
	`£nd_whŞe_d©aba£
(
cÚn
, 
’d_time
);

607 ià(
šfo
 !ğ
NULL
)

608 ++(
šfo
->
fuÎcİy_couÁ
);

610 
Ãed_whŞe_db
 = 
çl£
;

612 
	`»İ’
();

613 ià(
¡¬t_uuid
 =ğ
	`g‘_uuid
()) {

618 
¡ršg
 
buf
;

619 
Ãeded_»v_num
 = 
	`g‘_»visiÚ_numb”
();

620 
	`·ck_ušt
(
buf
, 
Ãeded_»v_num
);

621 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FOOTER
, 
buf
, 
’d_time
);

622 ià(
šfo
 !ğ
NULL
 && 
¡¬t_»v_num
 =ğ
Ãeded_»v_num
)

623 
šfo
->
chªged
 = 
Œue
;

633 
¡ršg
 
buf
;

634 
	`·ck_ušt
(
buf
, 
¡¬t_»v_num
 + 1);

635 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FOOTER
, 
buf
, 
’d_time
);

636 
Ãed_whŞe_db
 = 
Œue
;

640 ià(
¡¬t_»v_num
 >ğ
	`g‘_»visiÚ_numb”
()) {

641 
	`»İ’
();

642 ià(
¡¬t_uuid
 !ğ
	`g‘_uuid
()) {

643 
Ãed_whŞe_db
 = 
Œue
;

646 ià(
¡¬t_»v_num
 >ğ
	`g‘_»visiÚ_numb”
()) {

652 
¡ršg
 
chªges_Çme
 = 
db_dœ
 + "/chªges" + 
	`om_to¡ršg
(
¡¬t_»v_num
);

653 ià(
	`fe_exi¡s
(
chªges_Çme
)) {

656 
b¿ss_»visiÚ_numb”_t
 
chªge£t_¡¬t_»v_num
;

657 
b¿ss_»visiÚ_numb”_t
 
chªge£t_’d_»v_num
;

658 
	`g‘_chªge£t_»visiÚs
(
chªges_Çme
,

659 &
chªge£t_¡¬t_»v_num
,

660 &
chªge£t_’d_»v_num
);

661 ià(
chªge£t_¡¬t_»v_num
 !ğ
¡¬t_»v_num
) {

662 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Changeset start„evision does‚ot match changeset filename");

664 ià(
chªge£t_¡¬t_»v_num
 >ğ
chªge£t_’d_»v_num
) {

665 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Changeset start„evision is‚ot†esshanƒnd„evision");

670 
cÚn
.
	`£nd_fe
(
REPL_REPLY_CHANGESET
, 
chªges_Çme
, 
’d_time
);

671 
¡¬t_»v_num
 = 
chªge£t_’d_»v_num
;

672 ià(
šfo
 !ğ
NULL
) {

673 ++(
šfo
->
chªge£t_couÁ
);

674 ià(
¡¬t_»v_num
 >ğ
Ãeded_»v_num
)

675 
šfo
->
chªged
 = 
Œue
;

680 
Ãed_whŞe_db
 = 
Œue
;

684 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_END_OF_CHANGES
, 
	`¡ršg
(), 
’d_time
);

685 
	}
}

688 
	gB¿ssD©aba£
::
modifiÿtiÚs_çed
(
b¿ss_»visiÚ_numb”_t
 
Şd_»visiÚ
,

689 
b¿ss_»visiÚ_numb”_t
 
Ãw_»visiÚ
,

690 cÚ¡ 
¡d
::
¡ršg
 & 
msg
)

693 
Œy
 {

696 
ÿnûl
();

699 
İ’_bËs
(
Şd_»visiÚ
);

703 ++
	gÃw_»visiÚ
;

704 
£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

705 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

708 
B¿ssD©aba£
::
şo£
();

709 
throw
 
	gX­Ÿn
::
D©aba£E¼Ü
("ModifiÿtiÚ çed (" + 
msg
 +

711 "»visiÚ‚umb”s: " + 
e
.
g‘_msg
());

716 
	gB¿ssD©aba£
::
	$­¶y
()

718 
	`DEBUGCALL
(
DB
, , "BrassDatabase::apply", "");

719 ià(!
po¡li¡_bË
.
	`is_modif›d
() &&

720 !
pos™iÚ_bË
.
	`is_modif›d
() &&

721 !
‹rmli¡_bË
.
	`is_modif›d
() &&

722 !
v®ue_mªag”
.
	`is_modif›d
() &&

723 !
synÚym_bË
.
	`is_modif›d
() &&

724 !
¥–lšg_bË
.
	`is_modif›d
() &&

725 !
»cÜd_bË
.
	`is_modif›d
()) {

729 
b¿ss_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

730 
b¿ss_»visiÚ_numb”_t
 
Ãw_»visiÚ
 = 
	`g‘_Ãxt_»visiÚ_numb”
();

732 
Œy
 {

733 
	`£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

734 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

735 
	`modifiÿtiÚs_çed
(
Şd_»visiÚ
, 
Ãw_»visiÚ
, 
e
.
	`g‘_desütiÚ
());

736 
throw
;

737 } 
	`ÿtch
 (...) {

738 
	`modifiÿtiÚs_çed
(
Şd_»visiÚ
, 
Ãw_»visiÚ
, "Unknownƒrror");

739 
throw
;

741 
	}
}

744 
	gB¿ssD©aba£
::
	$ÿnûl
()

746 
	`DEBUGCALL
(
DB
, , "BrassDatabase::cancel", "");

747 
po¡li¡_bË
.
	`ÿnûl
();

748 
pos™iÚ_bË
.
	`ÿnûl
();

749 
‹rmli¡_bË
.
	`ÿnûl
();

750 
v®ue_mªag”
.
	`ÿnûl
();

751 
synÚym_bË
.
	`ÿnûl
();

752 
¥–lšg_bË
.
	`ÿnûl
();

753 
»cÜd_bË
.
	`ÿnûl
();

754 
	}
}

756 
	gX­Ÿn
::
doccouÁ


757 
B¿ssD©aba£
::
	$g‘_doccouÁ
() const

759 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "BrassDatabase::get_doccount", "");

760 
	`RETURN
(
»cÜd_bË
.
	`g‘_doccouÁ
());

761 
	}
}

763 
	gX­Ÿn
::
docid


764 
B¿ssD©aba£
::
	$g‘_Ï¡docid
() const

766 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "BrassDatabase::get_lastdocid", "");

767 
	`RETURN
(
¡©s
.
	`g‘_Ï¡_docid
());

768 
	}
}

770 
tÙËn_t


771 
	gB¿ssD©aba£
::
	$g‘_tÙ®_Ëngth
() const

773 
	`DEBUGCALL
(
DB
, 
tÙËn_t
, "BrassDatabase::get_total_length", "");

774 
	`RETURN
(
¡©s
.
	`g‘_tÙ®_doş’
());

775 
	}
}

777 
	gX­Ÿn
::
doş’gth


778 
B¿ssD©aba£
::
	$g‘_avËngth
() const

780 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doş’gth
, "BrassDatabase::get_avlength", "");

781 
X­Ÿn
::
doccouÁ
 doccouÁ = 
»cÜd_bË
.
	`g‘_doccouÁ
();

782 ià(
doccouÁ
 == 0) {

784 
	`RETURN
(0);

786 
	`RETURN
((
¡©s
.
	`g‘_tÙ®_doş’
()è/ 
doccouÁ
);

787 
	}
}

789 
	gX­Ÿn
::
‹rmcouÁ


790 
B¿ssD©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

792 
DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "B¿ssD©aba£::g‘_doş’gth", 
did
);

793 
As£¹
(
did
 != 0);

794 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
±¹Ùhis
(
this
);

795 
RETURN
(
po¡li¡_bË
.
g‘_doş’gth
(
did
, 
±¹Ùhis
));

798 
	gX­Ÿn
::
doccouÁ


799 
B¿ssD©aba£
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

801 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "B¿ssD©aba£::g‘_‹rmäeq", 
‹rm
);

802 
	`As£¹
(!
‹rm
.
	`em±y
());

803 
	`RETURN
(
po¡li¡_bË
.
	`g‘_‹rmäeq
(
‹rm
));

804 
	}
}

806 
	gX­Ÿn
::
‹rmcouÁ


807 
B¿ssD©aba£
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

809 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "B¿ssD©aba£::g‘_cŞËùiÚ_äeq", 
‹rm
);

810 
	`As£¹
(!
‹rm
.
	`em±y
());

811 
	`RETURN
(
po¡li¡_bË
.
	`g‘_cŞËùiÚ_äeq
(
‹rm
));

812 
	}
}

814 
	gX­Ÿn
::
doccouÁ


815 
B¿ssD©aba£
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const

817 
DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "B¿ssD©aba£::g‘_v®ue_äeq", 
v®no
);

818 
RETURN
(
v®ue_mªag”
.
g‘_v®ue_äeq
(
v®no
));

821 
	g¡d
::
¡ršg


822 
B¿ssD©aba£
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

824 
DEBUGCALL
(
DB
, 
¡d
::
¡ršg
, "B¿ssD©aba£::g‘_v®ue_low”_bound", 
v®no
);

825 
RETURN
(
v®ue_mªag”
.
g‘_v®ue_low”_bound
(
v®no
));

828 
	g¡d
::
¡ršg


829 
B¿ssD©aba£
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

831 
DEBUGCALL
(
DB
, 
¡d
::
¡ršg
, "B¿ssD©aba£::g‘_v®ue_uµ”_bound", 
v®no
);

832 
RETURN
(
v®ue_mªag”
.
g‘_v®ue_uµ”_bound
(
v®no
));

835 
	gX­Ÿn
::
‹rmcouÁ


836 
B¿ssD©aba£
::
	$g‘_doş’gth_low”_bound
() const

838  
¡©s
.
	`g‘_doş’gth_low”_bound
();

839 
	}
}

841 
	gX­Ÿn
::
‹rmcouÁ


842 
B¿ssD©aba£
::
	$g‘_doş’gth_uµ”_bound
() const

844  
¡©s
.
	`g‘_doş’gth_uµ”_bound
();

845 
	}
}

847 
	gX­Ÿn
::
‹rmcouÁ


848 
B¿ssD©aba£
::
	$g‘_wdf_uµ”_bound
(cÚ¡ 
¡ršg
 & 
‹rm
) const

850  
	`mš
(
	`g‘_cŞËùiÚ_äeq
(
‹rm
), 
¡©s
.
	`g‘_wdf_uµ”_bound
());

851 
	}
}

853 
boŞ


854 
	gB¿ssD©aba£
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
‹rm
) const

856 
	`DEBUGCALL
(
DB
, 
boŞ
, "B¿ssD©aba£::‹rm_exi¡s", 
‹rm
);

857 
	`As£¹
(!
‹rm
.
	`em±y
());

858  
po¡li¡_bË
.
	`‹rm_exi¡s
(
‹rm
);

859 
	}
}

861 
boŞ


862 
	gB¿ssD©aba£
::
	$has_pos™iÚs
() const

864  !
pos™iÚ_bË
.
	`em±y
();

865 
	}
}

867 
L—fPo¡Li¡
 *

868 
	gB¿ssD©aba£
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
& 
‹rm
) const

870 
	`DEBUGCALL
(
DB
, 
L—fPo¡Li¡
 *, "B¿ssD©aba£::İ’_po¡_li¡", 
‹rm
);

871 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
	`±¹Ùhis
(
this
);

873 ià(
‹rm
.
	`em±y
()) {

874 
X­Ÿn
::
doccouÁ
 doccouÁ = 
	`g‘_doccouÁ
();

875 ià(
¡©s
.
	`g‘_Ï¡_docid
(è=ğ
doccouÁ
) {

876 
	`RETURN
(
Ãw
 
	`CÚtiguousAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

878 
	`RETURN
(
Ãw
 
	`B¿ssAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

881 
	`RETURN
(
Ãw
 
	`B¿ssPo¡Li¡
(
±¹Ùhis
, 
‹rm
, 
Œue
));

882 
	}
}

884 
V®ueLi¡
 *

885 
	gB¿ssD©aba£
::
İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

887 
DEBUGCALL
(
DB
, 
V®ueLi¡
 *, "B¿ssD©aba£::İ’_v®ue_li¡", 
¦Ù
);

888 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
±¹Ùhis
(
this
);

889 
RETURN
(
Ãw
 
B¿ssV®ueLi¡
(
¦Ù
, 
±¹Ùhis
));

892 
T”mLi¡
 *

893 
	gB¿ssD©aba£
::
İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const

895 
DEBUGCALL
(
DB
, 
T”mLi¡
 *, "B¿ssD©aba£::İ’_‹rm_li¡", 
did
);

896 
As£¹
(
did
 != 0);

897 ià(!
	g‹rmli¡_bË
.
is_İ’
())

898 
throw
 
	gX­Ÿn
::
F—tu»UÇvaabËE¼Ü
("Database has‚oermlist");

900 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
±¹Ùhis
(
this
);

901 
RETURN
(
Ãw
 
B¿ssT”mLi¡
(
±¹Ùhis
, 
did
));

904 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

905 
B¿ssD©aba£
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const

907 
DEBUGCALL
(
DB
, 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 *, "BrassDatabase::open_document",

908 
did
 << ", " << 
Ïzy
);

909 
As£¹
(
did
 != 0);

910 ià(!
	gÏzy
) {

912 ()
g‘_doş’gth
(
did
);

915 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
D©aba£
::IÁ”Çl> 
±¹Ùhis
(
this
);

916 
RETURN
(
Ãw
 
B¿ssDocum’t
(
±¹Ùhis
, 
did
, &
v®ue_mªag”
, &
»cÜd_bË
));

919 
Pos™iÚLi¡
 *

920 
	gB¿ssD©aba£
::
İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
‹rm
) const

922 
As£¹
(
did
 != 0);

924 
	gAutoPŒ
<
	gB¿ssPos™iÚLi¡
> 
po¦i¡
(
Ãw
 
B¿ssPos™iÚLi¡
);

925 ià(!
	gpo¦i¡
->
»ad_d©a
(&
pos™iÚ_bË
, 
did
, 
‹rm
)) {

931  
	gpo¦i¡
.
»Ëa£
();

934 
T”mLi¡
 *

935 
	gB¿ssD©aba£
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const

937 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "BrassDatabase::open_allterms", "");

938 
	`RETURN
(
Ãw
 
	`B¿ssAÎT”msLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
>(
this
),

939 
´efix
));

940 
	}
}

942 
T”mLi¡
 *

943 
	gB¿ssD©aba£
::
	$İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const

945  
¥–lšg_bË
.
	`İ’_‹rmli¡
(
wÜd
);

946 
	}
}

948 
T”mLi¡
 *

949 
	gB¿ssD©aba£
::
	$İ’_¥–lšg_wÜdli¡
() const

951 
B¿ssCursÜ
 * 
cursÜ
 = 
¥–lšg_bË
.
	`cursÜ_g‘
();

952 ià(!
cursÜ
è 
NULL
;

953  
Ãw
 
	`B¿ssS³ÎšgWÜdsLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
>(
this
),

954 
cursÜ
);

955 
	}
}

957 
	gX­Ÿn
::
doccouÁ


958 
B¿ssD©aba£
::
	$g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const

960  
¥–lšg_bË
.
	`g‘_wÜd_äequ’cy
(
wÜd
);

961 
	}
}

963 
T”mLi¡
 *

964 
	gB¿ssD©aba£
::
	$İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const

966  
synÚym_bË
.
	`İ’_‹rmli¡
(
‹rm
);

967 
	}
}

969 
T”mLi¡
 *

970 
	gB¿ssD©aba£
::
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const

972 
B¿ssCursÜ
 * 
cursÜ
 = 
synÚym_bË
.
	`cursÜ_g‘
();

973 ià(!
cursÜ
è 
NULL
;

974  
Ãw
 
	`B¿ssSynÚymT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
>(
this
),

975 
cursÜ
, 
´efix
);

976 
	}
}

978 
¡ršg


979 
	gB¿ssD©aba£
::
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const

981 
	`DEBUGCALL
(
DB
, 
¡ršg
, "B¿ssD©aba£::g‘_m‘ad©a", 
key
);

982 
¡ršg
 
	`bŒ“_key
("\x00\xc0", 2);

983 
bŒ“_key
 +ğ
key
;

984 
¡ršg
 
g
;

985 ()
po¡li¡_bË
.
	`g‘_exaù_’Œy
(
bŒ“_key
, 
g
);

986 
	`RETURN
(
g
);

987 
	}
}

989 
T”mLi¡
 *

990 
	gB¿ssD©aba£
::
İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const

992 
DEBUGCALL
(
DB
, 
¡ršg
, "BrassDatabase::open_metadata_keylist", "");

993 
B¿ssCursÜ
 * 
	gcursÜ
 = 
po¡li¡_bË
.
cursÜ_g‘
();

994 ià(!
	gcursÜ
è 
	gNULL
;

995  
Ãw
 
B¿ssM‘ad©aT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
>(
this
),

996 
cursÜ
, 
´efix
);

999 
¡ršg


1000 
	gB¿ssD©aba£
::
	$g‘_»visiÚ_šfo
() const

1002 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassDatabase::get_revision_info", "");

1003 
¡ršg
 
buf
;

1004 
	`·ck_ušt
(
buf
, 
	`g‘_»visiÚ_numb”
());

1005 
	`RETURN
(
buf
);

1006 
	}
}

1008 
¡ršg


1009 
	gB¿ssD©aba£
::
	$g‘_uuid
() const

1011 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassDatabase::get_uuid", "");

1012 
	`RETURN
(
v”siÚ_fe
.
	`g‘_uuid_¡ršg
());

1013 
	}
}

1017 
	gB¿ssWr™abËD©aba£
::
	$B¿ssWr™abËD©aba£
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
,

1018 
block_size
)

1019 : 
	`B¿ssD©aba£
(
dœ
, 
aùiÚ
, 
block_size
),

1020 
	`chªge_couÁ
(0),

1021 
	`æush_th»shŞd
(0),

1022 
	`modify_shÜtcut_docum’t
(
NULL
),

1023 
	$modify_shÜtcut_docid
(0)

1025 
	`DEBUGCALL
(
DB
, , "B¿ssWr™abËD©aba£", 
dœ
 << ", " << 
aùiÚ
 << ", "

1026 << 
block_size
);

1028 cÚ¡ *
p
 = 
	`g‘’v
("XAPIAN_FLUSH_THRESHOLD");

1029 ià(
p
)

1030 
æush_th»shŞd
 = 
	`©oi
(
p
);

1031 ià(
æush_th»shŞd
 == 0)

1032 
æush_th»shŞd
 = 10000;

1033 
	}
}

1035 
	gB¿ssWr™abËD©aba£
::~
	$B¿ssWr™abËD©aba£
()

1037 
	`DEBUGCALL
(
DB
, , "~BrassWritableDatabase", "");

1038 
	`dtÜ_ÿÎed
();

1039 
	}
}

1042 
	gB¿ssWr™abËD©aba£
::
	$comm™
()

1044 ià(
	`Œª§ùiÚ_aùive
())

1045 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Can't commit during‡ransaction");

1046 ià(
chªge_couÁ
è
	`æush_po¡li¡_chªges
();

1047 
	`­¶y
();

1048 
	}
}

1051 
	gB¿ssWr™abËD©aba£
::
	$æush_po¡li¡_chªges
() const

1053 
¡©s
.
	`wr™e
(
po¡li¡_bË
);

1054 
šv”‹r
.
	`æush
(
po¡li¡_bË
);

1056 
chªge_couÁ
 = 0;

1057 
	}
}

1060 
	gB¿ssWr™abËD©aba£
::
	$şo£
()

1062 
	`DEBUGCALL
(
DB
, , "BrassWritableDatabase::close", "");

1063 ià(!
	`Œª§ùiÚ_aùive
()) {

1064 
	`comm™
();

1067 
B¿ssD©aba£
::
	`şo£
();

1068 
	}
}

1071 
	gB¿ssWr™abËD©aba£
::
	$­¶y
()

1073 
v®ue_mªag”
.
	`£t_v®ue_¡©s
(
v®ue_¡©s
);

1074 
B¿ssD©aba£
::
	`­¶y
();

1075 
	}
}

1077 
	gX­Ÿn
::
docid


1078 
B¿ssWr™abËD©aba£
::
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1080 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
,

1081 "B¿ssWr™abËD©aba£::add_docum’t", 
docum’t
);

1083 ià(
	g¡©s
.
g‘_Ï¡_docid
(è=ğ
X­Ÿn
::
docid
(-1))

1084 
throw
 
X­Ÿn
::
D©aba£E¼Ü
("Run out of docids - you'll haveo use copydatabaseoƒliminate‡ny gaps before you can‡dd more documents");

1086 
RETURN
(
add_docum’t_
(
¡©s
.
g‘_Ãxt_docid
(), 
docum’t
));

1089 
	gX­Ÿn
::
docid


1090 
B¿ssWr™abËD©aba£
::
add_docum’t_
(
X­Ÿn
::
docid
 
did
,

1091 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1093 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
,

1094 "B¿ssWr™abËD©aba£::add_docum’t_", 
did
 << ", " << 
docum’t
);

1095 
As£¹
(
did
 != 0);

1096 
	gŒy
 {

1098 
	g»cÜd_bË
.
»¶aû_»cÜd
(
docum’t
.
g‘_d©a
(), 
did
);

1101 
	gv®ue_mªag”
.
add_docum’t
(
did
, 
docum’t
, 
v®ue_¡©s
);

1103 
b¿ss_doş’_t
 
	gÃw_doş’
 = 0;

1105 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm
 = 
docum’t
.
‹rmli¡_begš
();

1106 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm_’d
 = 
docum’t
.
‹rmli¡_’d
();

1107  ; 
	g‹rm
 !ğ
‹rm_’d
; ++term) {

1108 
‹rmcouÁ
 
	gwdf
 = 
‹rm
.
g‘_wdf
();

1110 
	gÃw_doş’
 +ğ
wdf
;

1111 
	g¡©s
.
check_wdf
(
wdf
);

1113 
¡ršg
 
	gŠame
 = *
‹rm
;

1114 ià(
	gŠame
.
size
(è> 
	gMAX_SAFE_TERM_LENGTH
)

1115 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("T”moØlÚg (> "
STRINGIZE
(
MAX_SAFE_TERM_LENGTH
)"): " + 
Šame
);

1117 
	gšv”‹r
.
add_po¡šg
(
did
, 
Šame
, 
wdf
);

1119 ià(
	g‹rm
.
pos™iÚli¡_begš
(è!ğ
‹rm
.
pos™iÚli¡_’d
()) {

1120 
pos™iÚ_bË
.
£t_pos™iÚli¡
(

1121 
did
, 
Šame
,

1122 
‹rm
.
pos™iÚli¡_begš
(),”m.
pos™iÚli¡_’d
());

1126 
LOGLINE
(
DB
, "C®cuÏ‹d doş’ fÜ‚ew docum’ˆ" << 
did
 << "‡ " << 
Ãw_doş’
);

1129 ià(
	g‹rmli¡_bË
.
is_İ’
())

1130 
	g‹rmli¡_bË
.
£t_‹rmli¡
(
did
, 
docum’t
, 
Ãw_doş’
);

1133 
	gšv”‹r
.
£t_doş’gth
(
did
, 
Ãw_doş’
, 
Œue
);

1134 
	g¡©s
.
add_docum’t
(
Ãw_doş’
);

1135 } 
ÿtch
 (...) {

1140 
ÿnûl
();

1141 
	gthrow
;

1147 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1148 
æush_po¡li¡_chªges
();

1149 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1152 
RETURN
(
did
);

1156 
	gB¿ssWr™abËD©aba£
::
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
)

1158 
DEBUGCALL
(
DB
, , "B¿ssWr™abËD©aba£::d–‘e_docum’t", 
did
);

1159 
As£¹
(
did
 != 0);

1161 ià(!
	g‹rmli¡_bË
.
is_İ’
())

1162 
throw
 
	gX­Ÿn
::
F—tu»UÇvaabËE¼Ü
("Database has‚oermlist");

1164 ià(
¿»
(
modify_shÜtcut_docid
 =ğ
did
)) {

1167 
modify_shÜtcut_docum’t
 = 
NULL
;

1168 
	gmodify_shÜtcut_docid
 = 0;

1174 
	g»cÜd_bË
.
d–‘e_»cÜd
(
did
);

1176 
	gŒy
 {

1178 
	gv®ue_mªag”
.
d–‘e_docum’t
(
did
, 
v®ue_¡©s
);

1181 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssWr™abËD©aba£
> 
±¹Ùhis
(
this
);

1182 
B¿ssT”mLi¡
 
‹rmli¡
(
±¹Ùhis
, 
did
);

1184 
	g¡©s
.
d–‘e_docum’t
(
‹rmli¡
.
g‘_doş’gth
());

1186 
	g‹rmli¡
.
Ãxt
();

1187 !
	g‹rmli¡
.
©_’d
()) {

1188 
¡ršg
 
	gŠame
 = 
‹rmli¡
.
g‘_‹rmÇme
();

1189 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, 
Šame
);

1191 
	gšv”‹r
.
»move_po¡šg
(
did
, 
Šame
, 
‹rmli¡
.
g‘_wdf
());

1193 
	g‹rmli¡
.
Ãxt
();

1197 ià(
	g‹rmli¡_bË
.
is_İ’
())

1198 
	g‹rmli¡_bË
.
d–‘e_‹rmli¡
(
did
);

1201 
	gšv”‹r
.
d–‘e_doş’gth
(
did
);

1202 } 
ÿtch
 (...) {

1207 
ÿnûl
();

1208 
	gthrow
;

1211 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1212 
æush_po¡li¡_chªges
();

1213 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1221 
boŞ
 
pos™iÚli¡s_equ®
(
X­Ÿn
::
T”mI‹¿tÜ
 & 
‹rm™”
,

1222 
B¿ssT”mLi¡
 & 
‹rmli¡
)

1224 ià(
	g‹rm™”
.
pos™iÚli¡_couÁ
(è!ğ
‹rmli¡
.positionlist_count())

1225  
çl£
;

1227  
equ®
(
‹rm™”
.
pos™iÚli¡_begš
(),

1228 
‹rm™”
.
pos™iÚli¡_’d
(),

1229 
‹rmli¡
.
pos™iÚli¡_begš
());

1241 
£t_pos™iÚli¡
(
B¿ssPos™iÚLi¡TabË
 & 
pos™iÚ_bË
,

1242 
X­Ÿn
::
docid
 
did
,

1243 
X­Ÿn
::
T”mI‹¿tÜ
 & 
‹rm
)

1245 
Pos™iÚI‹¿tÜ
 
™
 = 
‹rm
.
pos™iÚli¡_begš
();

1246 
Pos™iÚI‹¿tÜ
 
	g™_’d
 = 
‹rm
.
pos™iÚli¡_’d
();

1247 ià(
	g™
 !ğ
™_’d
) {

1248 
pos™iÚ_bË
.
£t_pos™iÚli¡
(
did
, *
‹rm
, 
™
, 
™_’d
);

1250 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, *
‹rm
);

1256 
	gB¿ssWr™abËD©aba£
::
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

1257 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1259 
DEBUGCALL
(
DB
, , "B¿ssWr™abËD©aba£::»¶aû_docum’t", 
did
 << ", " << 
docum’t
);

1260 
As£¹
(
did
 != 0);

1262 
	gŒy
 {

1263 ià(
	gdid
 > 
	g¡©s
.
g‘_Ï¡_docid
()) {

1264 
	g¡©s
.
£t_Ï¡_docid
(
did
);

1267 ()
add_docum’t_
(
did
, 
docum’t
);

1271 ià(!
	g‹rmli¡_bË
.
is_İ’
()) {

1273 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
±¹Ùhis
(
this
);

1274 ià(!
	gpo¡li¡_bË
.
docum’t_exi¡s
(
did
, 
±¹Ùhis
)) {

1275 ()
add_docum’t_
(
did
, 
docum’t
);

1278 
throw
 
	gX­Ÿn
::
F—tu»UÇvaabËE¼Ü
("Database has‚oermlist");

1283 
boŞ
 
	gmodifyšg
 = 
çl£
;

1284 ià(
	gmodify_shÜtcut_docid
 &&

1285 
	gdocum’t
.
	gš‹º®
->
g‘_docid
(è=ğ
modify_shÜtcut_docid
) {

1286 ià(
docum’t
.
š‹º®
.
g‘
(è=ğ
modify_shÜtcut_docum’t
) {

1290 ià(!
docum’t
.
š‹º®
->
modif›d
()) {

1294 
	gmodifyšg
 = 
Œue
;

1295 
LOGLINE
(
DB
, "Detected…otential document modification shortcut.");

1300 
	gmodify_shÜtcut_docum’t
 = 
NULL
;

1301 
	gmodify_shÜtcut_docid
 = 0;

1305 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
‹rms_modif›d
()) {

1306 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssWr™abËD©aba£
> 
±¹Ùhis
(
this
);

1307 
B¿ssT”mLi¡
 
‹rmli¡
(
±¹Ùhis
, 
did
);

1308 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm
 = 
docum’t
.
‹rmli¡_begš
();

1309 
b¿ss_doş’_t
 
	gÃw_doş’
 = 
‹rmli¡
.
g‘_doş’gth
();

1310 
¡ršg
 
	gŞd_Šame
, 
	gÃw_Šame
;

1312 
	g¡©s
.
d–‘e_docum’t
(
Ãw_doş’
);

1313 
	g‹rmli¡
.
Ãxt
();

1314 !
	g‹rmli¡
.
©_’d
(è|| 
	g‹rm
 !ğ
docum’t
.
‹rmli¡_’d
()) {

1315 
cmp
;

1316 ià(
	g‹rmli¡
.
©_’d
()) {

1317 
	gcmp
 = 1;

1318 
	gÃw_Šame
 = *
‹rm
;

1320 
	gŞd_Šame
 = 
‹rmli¡
.
g‘_‹rmÇme
();

1321 ià(
	g‹rm
 !ğ
docum’t
.
‹rmli¡_’d
()) {

1322 
Ãw_Šame
 = *
‹rm
;

1323 
	gcmp
 = 
Şd_Šame
.
com·»
(
Ãw_Šame
);

1325 
	gcmp
 = -1;

1329 ià(
	gcmp
 < 0) {

1331 
‹rmcouÁ
 
	gŞd_wdf
 = 
‹rmli¡
.
g‘_wdf
();

1332 
	gÃw_doş’
 -ğ
Şd_wdf
;

1333 
	gšv”‹r
.
»move_po¡šg
(
did
, 
Şd_Šame
, 
Şd_wdf
);

1334 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, 
Şd_Šame
);

1335 
	g‹rmli¡
.
Ãxt
();

1336 } ià(
	gcmp
 > 0) {

1338 
‹rmcouÁ
 
	gÃw_wdf
 = 
‹rm
.
g‘_wdf
();

1339 
	gÃw_doş’
 +ğ
Ãw_wdf
;

1340 
	g¡©s
.
check_wdf
(
Ãw_wdf
);

1341 ià(
	gÃw_Šame
.
size
(è> 
	gMAX_SAFE_TERM_LENGTH
)

1342 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("T”moØlÚg (> "
STRINGIZE
(
MAX_SAFE_TERM_LENGTH
)"): " + 
Ãw_Šame
);

1343 
	gšv”‹r
.
add_po¡šg
(
did
, 
Ãw_Šame
, 
Ãw_wdf
);

1344 
£t_pos™iÚli¡
(
pos™iÚ_bË
, 
did
, 
‹rm
);

1345 ++
	g‹rm
;

1346 } ià(
	gcmp
 == 0) {

1348 
‹rmcouÁ
 
Şd_wdf
 = 
‹rmli¡
.
g‘_wdf
();

1349 
‹rmcouÁ
 
	gÃw_wdf
 = 
‹rm
.
g‘_wdf
();

1350 ià(
	gŞd_wdf
 !ğ
Ãw_wdf
) {

1351 
Ãw_doş’
 +ğ
Ãw_wdf
 - 
Şd_wdf
;

1352 
	g¡©s
.
check_wdf
(
Ãw_wdf
);

1353 
	gšv”‹r
.
upd©e_po¡šg
(
did
, 
Ãw_Šame
, 
Şd_wdf
, 
Ãw_wdf
);

1356 ià(!
pos™iÚli¡s_equ®
(
‹rm
, 
‹rmli¡
))

1357 
£t_pos™iÚli¡
(
pos™iÚ_bË
, 
did
, 
‹rm
);

1359 ++
	g‹rm
;

1360 
	g‹rmli¡
.
Ãxt
();

1363 
LOGLINE
(
DB
, "C®cuÏ‹d doş’ fÜ„•Ïûm’ˆdocum’ˆ" << 
did
 << "‡ " << 
Ãw_doş’
);

1366 ià(
	g‹rmli¡_bË
.
is_İ’
())

1367 
	g‹rmli¡_bË
.
£t_‹rmli¡
(
did
, 
docum’t
, 
Ãw_doş’
);

1370 
	gšv”‹r
.
£t_doş’gth
(
did
, 
Ãw_doş’
, 
çl£
);

1371 
	g¡©s
.
add_docum’t
(
Ãw_doş’
);

1374 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
d©a_modif›d
()) {

1376 
	g»cÜd_bË
.
»¶aû_»cÜd
(
docum’t
.
g‘_d©a
(), 
did
);

1379 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
v®ues_modif›d
()) {

1381 
	gv®ue_mªag”
.
»¶aû_docum’t
(
did
, 
docum’t
, 
v®ue_¡©s
);

1383 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
DocNÙFoundE¼Ü
 &) {

1384 ()
add_docum’t_
(
did
, 
docum’t
);

1386 } 
ÿtch
 (...) {

1391 
ÿnûl
();

1392 
	gthrow
;

1395 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1396 
æush_po¡li¡_chªges
();

1397 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1401 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

1402 
B¿ssWr™abËD©aba£
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const

1404 
DEBUGCALL
(
DB
, 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 *, "BrassWritableDatabase::open_document",

1405 
did
 << ", " << 
Ïzy
);

1406 
	gmodify_shÜtcut_docum’t
 = 
B¿ssD©aba£
::
İ’_docum’t
(
did
, 
Ïzy
);

1409 
	gmodify_shÜtcut_docid
 = 
did
;

1410 
RETURN
(
modify_shÜtcut_docum’t
);

1413 
	gX­Ÿn
::
‹rmcouÁ


1414 
B¿ssWr™abËD©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

1416 
DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "B¿ssWr™abËD©aba£::g‘_doş’gth", 
did
);

1417 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
;

1418 ià(
	gšv”‹r
.
g‘_doş’gth
(
did
, 
doş’
))

1419 
RETURN
(
doş’
);

1420 
RETURN
(
B¿ssD©aba£
::
g‘_doş’gth
(
did
));

1423 
	gX­Ÿn
::
doccouÁ


1424 
B¿ssWr™abËD©aba£
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

1426 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "B¿ssWr™abËD©aba£::g‘_‹rmäeq", 
‹rm
);

1427 
	`RETURN
(
B¿ssD©aba£
::
	`g‘_‹rmäeq
(
‹rm
è+ 
šv”‹r
.
	`g‘_tfd–
(term));

1428 
	}
}

1430 
	gX­Ÿn
::
‹rmcouÁ


1431 
B¿ssWr™abËD©aba£
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

1433 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "B¿ssWr™abËD©aba£::g‘_cŞËùiÚ_äeq", 
‹rm
);

1434 
	`RETURN
(
B¿ssD©aba£
::
	`g‘_cŞËùiÚ_äeq
(
‹rm
è+ 
šv”‹r
.
	`g‘_cfd–
(term));

1435 
	}
}

1437 
	gX­Ÿn
::
doccouÁ


1438 
B¿ssWr™abËD©aba£
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const

1440 
DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "B¿ssWr™abËD©aba£::g‘_v®ue_äeq", 
v®no
);

1441 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
;

1442 
	gi
 = 
v®ue_¡©s
.
fšd
(
v®no
);

1443 ià(
	gi
 !ğ
v®ue_¡©s
.
’d
()è
RETURN
(
i
->
£cÚd
.
äeq
);

1444 
RETURN
(
B¿ssD©aba£
::
g‘_v®ue_äeq
(
v®no
));

1447 
	g¡d
::
¡ršg


1448 
B¿ssWr™abËD©aba£
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

1450 
DEBUGCALL
(
DB
, 
¡d
::
¡ršg
, "B¿ssWr™abËD©aba£::g‘_v®ue_low”_bound", 
v®no
);

1451 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
;

1452 
	gi
 = 
v®ue_¡©s
.
fšd
(
v®no
);

1453 ià(
	gi
 !ğ
v®ue_¡©s
.
’d
()è
RETURN
(
i
->
£cÚd
.
low”_bound
);

1454 
RETURN
(
B¿ssD©aba£
::
g‘_v®ue_low”_bound
(
v®no
));

1457 
	g¡d
::
¡ršg


1458 
B¿ssWr™abËD©aba£
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

1460 
DEBUGCALL
(
DB
, 
¡d
::
¡ršg
, "B¿ssWr™abËD©aba£::g‘_v®ue_uµ”_bound", 
v®no
);

1461 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
;

1462 
	gi
 = 
v®ue_¡©s
.
fšd
(
v®no
);

1463 ià(
	gi
 !ğ
v®ue_¡©s
.
’d
()è
RETURN
(
i
->
£cÚd
.
uµ”_bound
);

1464 
RETURN
(
B¿ssD©aba£
::
g‘_v®ue_uµ”_bound
(
v®no
));

1467 
boŞ


1468 
	gB¿ssWr™abËD©aba£
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const

1470 
	`DEBUGCALL
(
DB
, 
boŞ
, "B¿ssWr™abËD©aba£::‹rm_exi¡s", 
Šame
);

1471 
	`RETURN
(
	`g‘_‹rmäeq
(
Šame
) != 0);

1472 
	}
}

1474 
L—fPo¡Li¡
 *

1475 
	gB¿ssWr™abËD©aba£
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
& 
Šame
) const

1477 
	`DEBUGCALL
(
DB
, 
L—fPo¡Li¡
 *, "B¿ssWr™abËD©aba£::İ’_po¡_li¡", 
Šame
);

1478 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssWr™abËD©aba£
> 
	`±¹Ùhis
(
this
);

1480 ià(
Šame
.
	`em±y
()) {

1481 
X­Ÿn
::
doccouÁ
 doccouÁ = 
	`g‘_doccouÁ
();

1482 ià(
¡©s
.
	`g‘_Ï¡_docid
(è=ğ
doccouÁ
) {

1483 
	`RETURN
(
Ãw
 
	`CÚtiguousAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

1485 
šv”‹r
.
	`æush_doş’gths
(
po¡li¡_bË
);

1486 
	`RETURN
(
Ãw
 
	`B¿ssAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

1491 
šv”‹r
.
	`æush_po¡_li¡
(
po¡li¡_bË
, 
Šame
);

1492 
	`RETURN
(
Ãw
 
	`B¿ssPo¡Li¡
(
±¹Ùhis
, 
Šame
, 
Œue
));

1493 
	}
}

1495 
V®ueLi¡
 *

1496 
	gB¿ssWr™abËD©aba£
::
İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

1498 
DEBUGCALL
(
DB
, 
V®ueLi¡
 *, "B¿ssWr™abËD©aba£::İ’_v®ue_li¡", 
¦Ù
);

1502 ià(
	gchªge_couÁ
è
	gv®ue_mªag”
.
m”ge_chªges
();

1503 
RETURN
(
B¿ssD©aba£
::
İ’_v®ue_li¡
(
¦Ù
));

1506 
T”mLi¡
 *

1507 
	gB¿ssWr™abËD©aba£
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const

1509 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "BrassWritableDatabase::open_allterms", "");

1510 ià(
chªge_couÁ
) {

1514 
šv”‹r
.
	`æush_po¡_li¡s
(
po¡li¡_bË
, 
´efix
);

1515 ià(
´efix
.
	`em±y
()) {

1519 
chªge_couÁ
 = 1;

1522 
	`RETURN
(
B¿ssD©aba£
::
	`İ’_®É”ms
(
´efix
));

1523 
	}
}

1526 
	gB¿ssWr™abËD©aba£
::
	$ÿnûl
()

1528 
B¿ssD©aba£
::
	`ÿnûl
();

1529 
¡©s
.
	`»ad
(
po¡li¡_bË
);

1531 
šv”‹r
.
	`ş—r
();

1532 
v®ue_¡©s
.
	`ş—r
();

1533 
chªge_couÁ
 = 0;

1534 
	}
}

1537 
	gB¿ssWr™abËD©aba£
::
add_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
,

1538 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const

1540 
¥–lšg_bË
.
add_wÜd
(
wÜd
, 
äeqšc
);

1544 
	gB¿ssWr™abËD©aba£
::
»move_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
,

1545 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const

1547 
¥–lšg_bË
.
»move_wÜd
(
wÜd
, 
äeqdec
);

1550 
T”mLi¡
 *

1551 
	gB¿ssWr™abËD©aba£
::
	$İ’_¥–lšg_wÜdli¡
() const

1553 
¥–lšg_bË
.
	`m”ge_chªges
();

1554  
B¿ssD©aba£
::
	`İ’_¥–lšg_wÜdli¡
();

1555 
	}
}

1557 
T”mLi¡
 *

1558 
	gB¿ssWr™abËD©aba£
::
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const

1560 
synÚym_bË
.
	`m”ge_chªges
();

1561  
B¿ssD©aba£
::
	`İ’_synÚym_keyli¡
(
´efix
);

1562 
	}
}

1565 
	gB¿ssWr™abËD©aba£
::
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
,

1566 cÚ¡ 
¡ršg
 & 
synÚym
) const

1568 
synÚym_bË
.
	`add_synÚym
(
‹rm
, 
synÚym
);

1569 
	}
}

1572 
	gB¿ssWr™abËD©aba£
::
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
,

1573 cÚ¡ 
¡ršg
 & 
synÚym
) const

1575 
synÚym_bË
.
	`»move_synÚym
(
‹rm
, 
synÚym
);

1576 
	}
}

1579 
	gB¿ssWr™abËD©aba£
::
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
‹rm
) const

1581 
synÚym_bË
.
	`ş—r_synÚyms
(
‹rm
);

1582 
	}
}

1585 
	gB¿ssWr™abËD©aba£
::
	$£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
)

1587 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassWritableDatabase::set_metadata",

1588 
key
 << ", " << 
v®ue
);

1589 
¡ršg
 
	`bŒ“_key
("\x00\xc0", 2);

1590 
bŒ“_key
 +ğ
key
;

1591 ià(
v®ue
.
	`em±y
()) {

1592 
po¡li¡_bË
.
	`d–
(
bŒ“_key
);

1594 
po¡li¡_bË
.
	`add
(
bŒ“_key
, 
v®ue
);

1596 
	}
}

1599 
	gB¿ssWr™abËD©aba£
::
šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const

1601 ià(
obj
 =ğ
modify_shÜtcut_docum’t
) {

1602 
modify_shÜtcut_docum’t
 = 
NULL
;

1603 
	gmodify_shÜtcut_docid
 = 0;

	@backends/brass/brass_database.h

24 #iâdeà
OM_HGUARD_BRASS_DATABASE_H


25 
	#OM_HGUARD_BRASS_DATABASE_H


	)

27 
	~"d©aba£.h
"

28 
	~"b¿ss_db¡©s.h
"

29 
	~"b¿ss_šv”‹r.h
"

30 
	~"b¿ss_pos™iÚli¡.h
"

31 
	~"b¿ss_po¡li¡.h
"

32 
	~"b¿ss_»cÜd.h
"

33 
	~"b¿ss_¥–lšg.h
"

34 
	~"b¿ss_synÚym.h
"

35 
	~"b¿ss_‹rmli¡bË.h
"

36 
	~"b¿ss_v®ues.h
"

37 
	~"b¿ss_v”siÚ.h
"

38 
	~"../æšt_lock.h
"

39 
	~"b¿ss_ty³s.h
"

40 
	~"v®ue¡©s.h
"

42 
	~<m­
>

44 
şass
 
	gB¿ssT”mLi¡
;

45 
şass
 
	gB¿ssAÎDocsPo¡Li¡
;

46 
şass
 
	gRemÙeCÚÃùiÚ
;

47 
şass
 
	gOmTime
;

52 şas 
	cB¿ssD©aba£
 : 
public
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 {

53 
ä›nd
 
şass
 
B¿ssWr™abËD©aba£
;

54 
ä›nd
 
şass
 
	mB¿ssT”mLi¡
;

55 
ä›nd
 
şass
 
	mB¿ssPo¡Li¡
;

56 
ä›nd
 
şass
 
	mB¿ssAÎT”msLi¡
;

57 
ä›nd
 
şass
 
	mB¿ssAÎDocsPo¡Li¡
;

58 
	m´iv©e
:

61 
¡d
::
¡ršg
 
db_dœ
;

65 
boŞ
 
	m»adÚly
;

71 
B¿ssV”siÚ
 
	mv”siÚ_fe
;

79 
mubË
 
B¿ssPo¡Li¡TabË
 
	mpo¡li¡_bË
;

83 
B¿ssPos™iÚLi¡TabË
 
	mpos™iÚ_bË
;

87 
B¿ssT”mLi¡TabË
 
	m‹rmli¡_bË
;

90 
mubË
 
B¿ssV®ueMªag”
 
	mv®ue_mªag”
;

94 
mubË
 
B¿ssSynÚymTabË
 
	msynÚym_bË
;

98 
mubË
 
B¿ssS³ÎšgTabË
 
	m¥–lšg_bË
;

108 
B¿ssRecÜdTabË
 
	m»cÜd_bË
;

111 
FlštLock
 
	mlock
;

115 
	mmax_chªge£ts
;

118 
B¿ssD©aba£Sts
 
	m¡©s
;

123 
boŞ
 
d©aba£_exi¡s
();

128 
ü—‹_ªd_İ’_bËs
(
blocksize
);

135 
İ’_bËs_cÚsi¡’t
();

144 
g‘_d©aba£_wr™e_lock
(
boŞ
 
ü—tšg
);

151 
İ’_bËs
(
b¿ss_»visiÚ_numb”_t
 
»visiÚ
);

158 
b¿ss_»visiÚ_numb”_t
 
	$g‘_»visiÚ_numb”
() const;

165 
b¿ss_»visiÚ_numb”_t
 
	$g‘_Ãxt_»visiÚ_numb”
() const;

177 
	`£t_»visiÚ_numb”
(
b¿ss_»visiÚ_numb”_t
 
Ãw_»visiÚ
);

182 
	`»İ’
();

186 
	`şo£
();

193 
	`modifiÿtiÚs_çed
(
b¿ss_»visiÚ_numb”_t
 
Şd_»visiÚ
,

194 
b¿ss_»visiÚ_numb”_t
 
Ãw_»visiÚ
,

195 cÚ¡ 
¡d
::
¡ršg
 & 
msg
);

205 
	`­¶y
();

209 
	`ÿnûl
();

213 
	`£nd_whŞe_d©aba£
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

214 cÚ¡ 
OmTime
 & 
’d_time
);

218 
	$g‘_chªge£t_»visiÚs
(cÚ¡ 
¡ršg
 & 
·th
,

219 
b¿ss_»visiÚ_numb”_t
 * 
¡¬Œev
,

220 
b¿ss_»visiÚ_numb”_t
 * 
’d»v
) const;

221 
public
:

241 
	`B¿ssD©aba£
(cÚ¡ 
¡ršg
 &
db_dœ_
, 
aùiÚ
 = 
XAPIAN_DB_READONLY
,

242 
block_size
 = 0u);

244 ~
	`B¿ssD©aba£
();

247 
B¿ssCursÜ
 * 
	$g‘_po¡li¡_cursÜ
() const {

248  
po¡li¡_bË
.
	`cursÜ_g‘
();

253 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

254 
X­Ÿn
::
docid
 
	$g‘_Ï¡docid
() const;

255 
tÙËn_t
 
	$g‘_tÙ®_Ëngth
() const;

256 
X­Ÿn
::
doş’gth
 
	$g‘_avËngth
() const;

257 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

258 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

259 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

260 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
v®no
) const;

261 
¡d
::
¡ršg
 
	`g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

262 
¡d
::
¡ršg
 
	`g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

263 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_low”_bound
() const;

264 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_uµ”_bound
() const;

265 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf_uµ”_bound
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

266 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

267 
boŞ
 
	$has_pos™iÚs
() const;

269 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

270 
V®ueLi¡
 * 
	`İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

271 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`İ’_docum’t
(X­Ÿn::
docid
 
did
, 
boŞ
 
Ïzy
) const;

273 
Pos™iÚLi¡
 * 
	`İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
‹rm
) const;

274 
T”mLi¡
 * 
	`İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const;

275 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

277 
T”mLi¡
 * 
	$İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

278 
T”mLi¡
 * 
	$İ’_¥–lšg_wÜdli¡
() const;

279 
X­Ÿn
::
doccouÁ
 
	$g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

281 
T”mLi¡
 * 
	$İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

282 
T”mLi¡
 * 
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const;

284 
¡ršg
 
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const;

285 
T”mLi¡
 * 
	`İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const;

286 
	`wr™e_chªge£ts_to_fd
(
fd
,

287 cÚ¡ 
¡ršg
 & 
¡¬t_»visiÚ
,

288 
boŞ
 
Ãed_whŞe_db
,

289 
X­Ÿn
::
R•liÿtiÚInfo
 * 
šfo
);

290 
¡ršg
 
	$g‘_»visiÚ_šfo
() const;

291 
¡ršg
 
	$g‘_uuid
() const;

294 
	}
};

298 şas 
	cB¿ssWr™abËD©aba£
 : 
public
 
B¿ssD©aba£
 {

299 
mubË
 
Inv”‹r
 
šv”‹r
;

301 
mubË
 
	mm­
<
	mX­Ÿn
::
v®u’o
, 
	mV®ueSts
> 
	mv®ue_¡©s
;

306 
mubË
 
	mX­Ÿn
::
doccouÁ
 
chªge_couÁ
;

309 
	mX­Ÿn
::
doccouÁ
 
æush_th»shŞd
;

317 
mubË
 
	mX­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
modify_shÜtcut_docum’t
;

321 
mubË
 
	mX­Ÿn
::
docid
 
modify_shÜtcut_docid
;

324 
	$æush_po¡li¡_chªges
() const;

327 
	`şo£
();

330 
	`­¶y
();

336 
	`comm™
();

339 
	`ÿnûl
();

341 
X­Ÿn
::
docid
 
	`add_docum’t
(cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

342 
X­Ÿn
::
docid
 
	`add_docum’t_
(X­Ÿn::docid 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

348 #iâdeà
_MSC_VER


349 
usšg
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
::
d–‘e_docum’t
;

350 
usšg
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
::
»¶aû_docum’t
;

352 
	`d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
);

353 
	`»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

355 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`İ’_docum’t
(X­Ÿn::
docid
 
did
,

356 
boŞ
 
Ïzy
) const;

360 
public
:

372 
	`B¿ssWr™abËD©aba£
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
);

374 ~
	`B¿ssWr™abËD©aba£
();

378 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

379 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

380 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

381 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
v®no
) const;

382 
¡d
::
¡ršg
 
	`g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

383 
¡d
::
¡ršg
 
	`g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

384 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

386 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

387 
V®ueLi¡
 * 
	`İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

388 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

390 
	`add_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const;

391 
	`»move_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const;

392 
T”mLi¡
 * 
	$İ’_¥–lšg_wÜdli¡
() const;

394 
T”mLi¡
 * 
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const;

395 
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
wÜd
, cÚ¡ sŒšg & 
synÚym
) const;

396 
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
wÜd
, cÚ¡ sŒšg & 
synÚym
) const;

397 
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

399 
	`£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
);

400 
	`šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const;

	@backends/brass/brass_databasereplicator.cc

23 
	~<cÚfig.h
>

25 
	~"b¿ss_d©aba£»¶iÿtÜ.h
"

27 
	~"x­Ÿn/”rÜ.h
"

29 
	~"b¿ss_io.h
"

30 
	~"../æšt_lock.h
"

31 
	~"b¿ss_»cÜd.h
"

32 
	~"b¿ss_»¶iÿ‹_š‹º®.h
"

33 
	~"b¿ss_ty³s.h
"

34 
	~"b¿ss_v”siÚ.h
"

35 
	~"omdebug.h
"

36 
	~"omtime.h
"

37 
	~"·ck.h
"

38 
	~"»mÙecÚÃùiÚ.h
"

39 
	~"»¶iÿtiÚ´ÙocŞ.h
"

40 
	~"§ã”ºo.h
"

41 
	~"¡ršguts.h
"

42 
	~"uts.h
"

44 #ifdeà
__WIN32__


45 
	~"msvc_posix_w¿µ”.h
"

48 
	~<c¡dio
>

50 
usšg
 
Çme¥aû
 
	g¡d
;

51 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

53 
	gB¿ssD©aba£R•liÿtÜ
::
	$B¿ssD©aba£R•liÿtÜ
(cÚ¡ 
¡ršg
 & 
db_dœ_
)

54 : 
	$db_dœ
(
db_dœ_
)

56 
	}
}

58 
boŞ


59 
B¿ssD©aba£R•liÿtÜ
::
	$check_»visiÚ_©_Ëa¡
(cÚ¡ 
¡ršg
 & 
»v
,

60 cÚ¡ 
¡ršg
 & 
rg‘
) const

62 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassDatabaseReplicator::check_revision_at_least",

63 
»v
 << ", " << 
rg‘
);

65 
b¿ss_»visiÚ_numb”_t
 
»v_v®
;

66 
b¿ss_»visiÚ_numb”_t
 
rg‘_v®
;

68 cÚ¡ * 
±r
 = 
»v
.
	`d©a
();

69 cÚ¡ * 
’d
 = 
±r
 + 
»v
.
	`size
();

70 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
»v_v®
)) {

71 
throw
 
	`N‘wÜkE¼Ü
("Invalid„evision string suppliedo check_revision_at_least");

74 
±r
 = 
rg‘
.
	`d©a
();

75 
’d
 = 
±r
 + 
rg‘
.
	`size
();

76 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
rg‘_v®
)) {

77 
throw
 
	`N‘wÜkE¼Ü
("Invalid„evision string suppliedo check_revision_at_least");

80 
	`RETURN
(
»v_v®
 >ğ
rg‘_v®
);

81 
	}
}

84 
	gB¿ssD©aba£R•liÿtÜ
::
	$´oûss_chªge£t_chunk_ba£
(cÚ¡ 
¡ršg
 & 
bËÇme
,

85 
¡ršg
 & 
buf
,

86 
RemÙeCÚÃùiÚ
 & 
cÚn
,

87 cÚ¡ 
OmTime
 & 
’d_time
) const

89 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

90 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

93 
Ë‰”
 = 
±r
[0];

94 ià(
Ë‰”
 != 'A' &&†etter != 'B')

95 
throw
 
	`N‘wÜkE¼Ü
("Invalid base file†etter in changeset");

96 ++
±r
;

100 ià(
±r
 =ğ
’d
)

101 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (5)");

102 
¡ršg
::
size_ty³
 
ba£_size
;

103 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
ba£_size
))

104 
throw
 
	`N‘wÜkE¼Ü
("Invalid base file size in changeset");

107 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

108 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
ba£_size
, 
’d_time
);

110 ià(
buf
.
	`size
(è< 
ba£_size
)

111 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (6)");

114 
¡ršg
 
tmp_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + "tmp";

115 
¡ršg
 
ba£_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + ".ba£" + 
Ë‰”
;

116 #ifdeà
__WIN32__


117 
fd
 = 
	`msvc_posix_İ’
(
tmp_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

119 
fd
 = ::
	`İ’
(
tmp_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

121 ià(
fd
 == -1) {

122 
¡ršg
 
msg
 = "Failedo open ";

123 
msg
 +ğ
tmp_·th
;

124 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

127 
fdşo£r
 
	`şo£r
(
fd
);

129 
	`b¿ss_io_wr™e
(
fd
, 
buf
.
	`d©a
(), 
ba£_size
);

130 
	`b¿ss_io_sync
(
fd
);

132 #ià
defšed
 
__WIN32__


133 ià(
	`msvc_posix_»Çme
(
tmp_·th
.
	`c_¡r
(), 
ba£_·th
.c_str()) < 0) {

135 ià(
	`»Çme
(
tmp_·th
.
	`c_¡r
(), 
ba£_·th
.c_str()) < 0) {

142 
§ved_”ºo
 = 
”ºo
;

143 ià(
	`uÆšk
(
tmp_·th
è=ğ0 || 
”ºo
 !ğ
ENOENT
) {

144 
¡ršg
 
	`msg
("Couldn't update base file ");

145 
msg
 +ğ
bËÇme
;

146 
msg
 += ".base";

147 
msg
 +ğ
Ë‰”
;

148 
throw
 
	`D©aba£E¼Ü
(
msg
, 
§ved_”ºo
);

152 
buf
.
	`”a£
(0, 
ba£_size
);

153 
	}
}

156 
	gB¿ssD©aba£R•liÿtÜ
::
	$´oûss_chªge£t_chunk_blocks
(cÚ¡ 
¡ršg
 & 
bËÇme
,

157 
¡ršg
 & 
buf
,

158 
RemÙeCÚÃùiÚ
 & 
cÚn
,

159 cÚ¡ 
OmTime
 & 
’d_time
) const

161 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

162 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

164 
chªge£t_blocksize
;

165 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
chªge£t_blocksize
))

166 
throw
 
	`N‘wÜkE¼Ü
("Invalid blocksize in changeset");

167 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

169 
¡ršg
 
db_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + ".DB";

170 #ifdeà
__WIN32__


171 
fd
 = 
	`msvc_posix_İ’
(
db_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_BINARY
);

173 
fd
 = ::
	`İ’
(
db_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_BINARY
, 0666);

175 ià(
fd
 == -1) {

176 
¡ršg
 
msg
 = "Failedo open ";

177 
msg
 +ğ
db_·th
;

178 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

181 
fdşo£r
 
	`şo£r
(
fd
);

183 
Œue
) {

184 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

185 
±r
 = 
buf
.
	`d©a
();

186 
’d
 = 
±r
 + 
buf
.
	`size
();

188 
ušt4
 
block_numb”
;

189 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
block_numb”
))

190 
throw
 
	`N‘wÜkE¼Ü
("Invalid block‚umber in changeset");

191 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

192 ià(
block_numb”
 == 0)

194 --
block_numb”
;

196 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
chªge£t_blocksize
, 
’d_time
);

197 ià(
buf
.
	`size
(è< 
chªge£t_blocksize
)

198 
throw
 
	`N‘wÜkE¼Ü
("Incomplete block in changeset");

202 ià(
	`l£ek
(
fd
, 
	`off_t
(
chªge£t_blocksize
è* 
block_numb”
, 
SEEK_SET
) == -1) {

203 
¡ršg
 
msg
 = "Failedo seeko block ";

204 
msg
 +ğ
	`om_to¡ršg
(
block_numb”
);

205 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

207 
	`b¿ss_io_wr™e
(
fd
, 
buf
.
	`d©a
(), 
chªge£t_blocksize
);

209 
buf
.
	`”a£
(0, 
chªge£t_blocksize
);

211 
	`b¿ss_io_sync
(
fd
);

213 
	}
}

215 
¡ršg


216 
	gB¿ssD©aba£R•liÿtÜ
::
	$­¶y_chªge£t_äom_cÚn
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

217 cÚ¡ 
OmTime
 & 
’d_time
,

218 
boŞ
 
v®id
) const

220 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassDatabaseReplicator::apply_changeset_from_conn",

221 "cÚn,ƒnd_time, " << 
v®id
);

224 
FlštLock
 
	`lock
(
db_dœ
);

225 
¡ršg
 
ex¶ª©iÚ
;

226 
FlštLock
::
»asÚ
 
why
 = 
lock
.
	`lock
(
Œue
, 
ex¶ª©iÚ
);

227 ià(
why
 !ğ
FlštLock
::
SUCCESS
) {

228 
lock
.
	`throw_d©aba£lock”rÜ
(
why
, 
db_dœ
, 
ex¶ª©iÚ
);

231 
ty³
 = 
cÚn
.
	`g‘_mes§ge_chunked
(
’d_time
);

232 (è
ty³
;

233 
	`As£¹Eq
(
ty³
, 
REPL_REPLY_CHANGESET
);

235 
¡ršg
 
buf
;

239 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

241 ià(!
	`¡¬tsw™h
(
buf
, 
CHANGES_MAGIC_STRING
)) {

242 
throw
 
	`N‘wÜkE¼Ü
("Invalid ChangeSet magic string");

244 
buf
.
	`”a£
(0, 12);

245 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

246 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

248 
chªges_v”siÚ
;

249 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
chªges_v”siÚ
))

250 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid version‚umber from changeset");

251 ià(
chªges_v”siÚ
 !ğ
CHANGES_VERSION
)

252 
throw
 
	`N‘wÜkE¼Ü
("Unsupported changeset version");

254 
b¿ss_»visiÚ_numb”_t
 
¡¬Œev
;

255 
b¿ss_»visiÚ_numb”_t
 
’d»v
;

257 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
¡¬Œev
))

258 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid start„evision from changeset");

259 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
’d»v
))

260 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ validƒnd„evision from changeset");

262 ià(
’d»v
 <ğ
¡¬Œev
)

263 
throw
 
	`N‘wÜkE¼Ü
("End„evision in changeset is‚ot†aterhan start„evision");

265 ià(
±r
 =ğ
’d
)

266 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (1)");

268 ià(
v®id
) {

273 
B¿ssRecÜdTabË
 
	`»cÜd_bË
(
db_dœ
, 
Œue
);

274 
»cÜd_bË
.
	`İ’
();

275 ià(
¡¬Œev
 !ğ
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
())

276 
throw
 
	`N‘wÜkE¼Ü
("Changeset supplied is for wrong„evision‚umber");

279 
chªges_ty³
 = 
±r
[0];

280 ià(
chªges_ty³
 != 0) {

281 
throw
 
	`N‘wÜkE¼Ü
("Unsupported changesetype (got %d)",

282 
chªges_ty³
);

288 
buf
.
	`”a£
(0, 
±r
 + 1 - buf.
	`d©a
());

291 
Œue
) {

292 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

293 
±r
 = 
buf
.
	`d©a
();

294 
’d
 = 
±r
 + 
buf
.
	`size
();

297 ià(
±r
 =ğ
’d
)

298 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (2)");

299 
chunk_ty³
 = 
±r
[0];

300 ++
±r
;

301 ià(
chunk_ty³
 == 0)

305 
¡ršg
 
bËÇme
;

306 ià(!
	`uÅack_¡ršg
(&
±r
, 
’d
, 
bËÇme
))

307 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (3)");

308 ià(
bËÇme
.
	`em±y
())

309 
throw
 
	`N‘wÜkE¼Ü
("Missingablename in changeset");

310 ià(
bËÇme
.
	`fšd_fœ¡_nÙ_of
("abcdefghijklmnopqrstuvwxyz") !=

311 
bËÇme
.
Åos
)

312 
throw
 
	`N‘wÜkE¼Ü
("Invalid character inablename in changeset");

315 ià(
±r
 =ğ
’d
)

316 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (4)");

317 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

319 
chunk_ty³
) {

321 
	`´oûss_chªge£t_chunk_ba£
(
bËÇme
, 
buf
, 
cÚn
, 
’d_time
);

324 
	`´oûss_chªge£t_chunk_blocks
(
bËÇme
, 
buf
, 
cÚn
, 
’d_time
);

327 
throw
 
	`N‘wÜkE¼Ü
("Unrecognised itemype in changeset");

330 
b¿ss_»visiÚ_numb”_t
 
»q»v
;

331 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
»q»v
))

332 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid„equired„evision from changeset");

333 ià(
»q»v
 < 
’d»v
)

334 
throw
 
	`N‘wÜkE¼Ü
("Required„evision in changeset isƒarlierhanƒnd„evision");

335 ià(
±r
 !ğ
’d
)

336 
throw
 
	`N‘wÜkE¼Ü
("Junk found‡tƒnd of changeset");

338 
buf
.
	`»size
(0);

339 
	`·ck_ušt
(
buf
, 
»q»v
);

340 
	`RETURN
(
buf
);

341 
	}
}

343 
¡ršg


344 
	gB¿ssD©aba£R•liÿtÜ
::
	$g‘_uuid
() const

346 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassDatabaseReplicator::get_uuid", "");

347 
B¿ssV”siÚ
 
	`v”siÚ_fe
(
db_dœ
);

348 
Œy
 {

349 
v”siÚ_fe
.
	`»ad_ªd_check
();

350 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
D©aba£E¼Ü
 &) {

351 
	`RETURN
(
	`¡ršg
());

353 
	`RETURN
(
v”siÚ_fe
.
	`g‘_uuid_¡ršg
());

354 
	}
}

	@backends/brass/brass_databasereplicator.h

23 #iâdeà
XAPIAN_INCLUDED_BRASS_DATABASEREPLICATOR_H


24 
	#XAPIAN_INCLUDED_BRASS_DATABASEREPLICATOR_H


	)

26 
	~"d©aba£»¶iÿtÜ.h
"

28 şas 
	cB¿ssD©aba£R•liÿtÜ
 : 
public
 
X­Ÿn
::
D©aba£R•liÿtÜ
 {

29 
´iv©e
:

32 
¡d
::
¡ršg
 
db_dœ
;

36 
´oûss_chªge£t_chunk_ba£
(cÚ¡ 
¡d
::
¡ršg
 & 
bËÇme
,

37 
¡d
::
¡ršg
 & 
buf
,

38 
RemÙeCÚÃùiÚ
 & 
cÚn
,

39 cÚ¡ 
OmTime
 & 
’d_time
) const;

44 
´oûss_chªge£t_chunk_blocks
(cÚ¡ 
¡d
::
¡ršg
 & 
bËÇme
,

45 
¡d
::
¡ršg
 & 
buf
,

46 
RemÙeCÚÃùiÚ
 & 
cÚn
,

47 cÚ¡ 
OmTime
 & 
’d_time
) const;

49 
	mpublic
:

50 
B¿ssD©aba£R•liÿtÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
db_dœ_
);

54 
boŞ
 
check_»visiÚ_©_Ëa¡
(cÚ¡ 
¡d
::
¡ršg
 & 
»v
,

55 cÚ¡ 
¡d
::
¡ršg
 & 
rg‘
) const;

56 
	m¡d
::
¡ršg
 
	$­¶y_chªge£t_äom_cÚn
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

57 cÚ¡ 
OmTime
 & 
’d_time
,

58 
boŞ
 
v®id
) const;

59 
¡d
::
¡ršg
 
	$g‘_uuid
() const;

	@backends/brass/brass_dbstats.cc

21 
	~<cÚfig.h
>

23 
	~"b¿ss_db¡©s.h
"

25 
	~"b¿ss_po¡li¡.h
"

27 
usšg
 
Çme¥aû
 
	g¡d
;

30 cÚ¡ 
¡ršg
 
DATABASE_STATS_KEY
(1, '\0');

33 
	gB¿ssD©aba£Sts
::
	$»ad
(
B¿ssPo¡Li¡TabË
 & 
po¡li¡_bË
)

35 
¡ršg
 
d©a
;

36 ià(!
po¡li¡_bË
.
	`g‘_exaù_’Œy
(
DATABASE_STATS_KEY
, 
d©a
)) {

38 
tÙ®_doş’
 = 0;

39 
Ï¡_docid
 = 0;

40 
doş’_lbound
 = 0;

41 
doş’_ubound
 = 0;

42 
wdf_ubound
 = 0;

46 cÚ¡ * 
p
 = 
d©a
.
	`d©a
();

47 cÚ¡ * 
’d
 = 
p
 + 
d©a
.
	`size
();

49 ià(
	`uÅack_ušt
(&
p
, 
’d
, &
Ï¡_docid
) &&

50 
	`uÅack_ušt
(&
p
, 
’d
, &
doş’_lbound
) &&

51 
	`uÅack_ušt
(&
p
, 
’d
, &
wdf_ubound
) &&

52 
	`uÅack_ušt
(&
p
, 
’d
, &
doş’_ubound
) &&

53 
	`uÅack_ušt_Ï¡
(&
p
, 
’d
, &
tÙ®_doş’
)) {

57 
doş’_ubound
 +ğ
wdf_ubound
;

61 ià(
p
)

62 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Badƒncoded DB stats (overflowed)");

64 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Badƒncoded DB stats (out of data)");

65 
	}
}

68 
	gB¿ssD©aba£Sts
::
	$wr™e
(
B¿ssPo¡Li¡TabË
 & 
po¡li¡_bË
) const

70 
¡ršg
 
d©a
;

71 
	`·ck_ušt
(
d©a
, 
Ï¡_docid
);

72 
	`·ck_ušt
(
d©a
, 
doş’_lbound
);

73 
	`·ck_ušt
(
d©a
, 
wdf_ubound
);

77 
	`·ck_ušt
(
d©a
, 
doş’_ubound
 - 
wdf_ubound
);

81 
	`·ck_ušt_Ï¡
(
d©a
, 
tÙ®_doş’
);

82 
po¡li¡_bË
.
	`add
(
DATABASE_STATS_KEY
, 
d©a
);

83 
	}
}

	@backends/brass/brass_dbstats.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_DBSTATS_H


22 
	#XAPIAN_INCLUDED_BRASS_DBSTATS_H


	)

24 
	~"b¿ss_ty³s.h
"

25 
	~"x­Ÿn/ty³s.h
"

27 
	~"š‹º®ty³s.h
"

29 
şass
 
	gB¿ssPo¡Li¡TabË
;

32 şas 
	cB¿ssD©aba£Sts
 {

34 
	mİ”©Ü
=(cÚ¡ 
B¿ssD©aba£Sts
 &);

37 
B¿ssD©aba£Sts
(const BrassDatabaseStats &);

40 
tÙËn_t
 
	mtÙ®_doş’
;

43 
	mX­Ÿn
::
docid
 
Ï¡_docid
;

46 
	mX­Ÿn
::
‹rmcouÁ
 
doş’_lbound
;

49 
	mX­Ÿn
::
‹rmcouÁ
 
doş’_ubound
;

52 
	mX­Ÿn
::
‹rmcouÁ
 
wdf_ubound
;

54 
	mpublic
:

55 
	$B¿ssD©aba£Sts
()

56 : 
	`tÙ®_doş’
(0), 
	`Ï¡_docid
(0), 
	`doş’_lbound
(0), 
	`doş’_ubound
(0),

57 
	$wdf_ubound
(0) { }

59 
tÙËn_t
 
	$g‘_tÙ®_doş’
(ècÚ¡ {  
tÙ®_doş’
; 
	}
}

61 
	gX­Ÿn
::
docid
 
	$g‘_Ï¡_docid
(ècÚ¡ {  
Ï¡_docid
; 
	}
}

63 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_low”_bound
() const {

64  
doş’_lbound
;

65 
	}
}

67 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_uµ”_bound
() const {

68  
doş’_ubound
;

69 
	}
}

71 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf_uµ”_bound
(ècÚ¡ {  
wdf_ubound
; 
	}
}

73 
	$z”o
() {

74 
tÙ®_doş’
 = 0;

75 
Ï¡_docid
 = 0;

76 
doş’_lbound
 = 0;

77 
doş’_ubound
 = 0;

78 
wdf_ubound
 = 0;

79 
	}
}

81 
»ad
(
B¿ssPo¡Li¡TabË
 & 
po¡li¡_bË
);

83 
£t_Ï¡_docid
(
X­Ÿn
::
docid
 
did
è{ 
Ï¡_docid
 = did; }

85 
add_docum’t
(
X­Ÿn
::
‹rmcouÁ
 
doş’
) {

86 ià(
tÙ®_doş’
 =ğ0 || (
doş’
 && doş’ < 
doş’_lbound
))

87 
doş’_lbound
 = 
doş’
;

88 ià(
	gdoş’
 > 
	gdoş’_ubound
)

89 
	gdoş’_ubound
 = 
doş’
;

90 
	gtÙ®_doş’
 +ğ
doş’
;

93 
d–‘e_docum’t
(
X­Ÿn
::
‹rmcouÁ
 
doş’
) {

94 
tÙ®_doş’
 -ğ
doş’
;

97 ià(
	gtÙ®_doş’
 == 0) {

98 
doş’_lbound
 = 0;

99 
	gdoş’_ubound
 = 0;

100 
	gwdf_ubound
 = 0;

104 
check_wdf
(
X­Ÿn
::
‹rmcouÁ
 
wdf
) {

105 ià(
wdf
 > 
wdf_ubound
) wdf_ubound = wdf;

108 
	gX­Ÿn
::
docid
 
	$g‘_Ãxt_docid
(è{  ++
Ï¡_docid
; 
	}
}

110 
	$wr™e
(
B¿ssPo¡Li¡TabË
 & 
po¡li¡_bË
) const;

111 
	}
};

	@backends/brass/brass_document.cc

23 
	~<cÚfig.h
>

25 
	~"b¿ss_docum’t.h
"

27 
	~"omdebug.h
"

28 
	~"b¿ss_d©aba£.h
"

29 
	~"b¿ss_v®ues.h
"

30 
	~"b¿ss_»cÜd.h
"

36 
¡ršg


37 
	gB¿ssDocum’t
::
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

39 
DEBUGCALL
(
DB
, 
¡ršg
, "B¿ssDocum’t::do_g‘_v®ue", 
¦Ù
);

40 
RETURN
(
v®ue_mªag”
->
g‘_v®ue
(
did
, 
¦Ù
));

46 
	gB¿ssDocum’t
::
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const

48 
DEBUGCALL
(
DB
, , "BrassDocument::do_get_all_values", "[values_]");

49 
	gv®ue_mªag”
->
g‘_®l_v®ues
(
v®ues_
, 
did
);

54 
¡ršg


55 
	gB¿ssDocum’t
::
	$do_g‘_d©a
() const

57 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassDocument::do_get_data", "");

58 
	`RETURN
(
»cÜd_bË
->
	`g‘_»cÜd
(
did
));

59 
	}
}

	@backends/brass/brass_document.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_DOCUMENT_H


22 
	#XAPIAN_INCLUDED_BRASS_DOCUMENT_H


	)

24 
	~"b¿ss_»cÜd.h
"

25 
	~"b¿ss_v®ues.h
"

26 
	~"d©aba£.h
"

27 
	~"docum’t.h
"

30 şas 
	cB¿ssDocum’t
 : 
public
 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 {

32 
İ”©Ü
=(cÚ¡ 
B¿ssDocum’t
 &);

35 
B¿ssDocum’t
(const BrassDocument &);

38 cÚ¡ 
B¿ssV®ueMªag”
 *
	mv®ue_mªag”
;

41 cÚ¡ 
B¿ssRecÜdTabË
 *
	m»cÜd_bË
;

44 
ä›nd
 
şass
 
	mB¿ssD©aba£
;

47 
B¿ssDocum’t
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
db
,

48 
X­Ÿn
::
docid
 
did_
,

49 cÚ¡ 
B¿ssV®ueMªag”
 *
v®ue_mªag”_
,

50 cÚ¡ 
B¿ssRecÜdTabË
 *
»cÜd_bË_
)

51 : 
X­Ÿn
::
Docum’t
::
IÁ”Çl
(
db
, 
did_
),

52 
v®ue_mªag”
(
v®ue_mªag”_
), 
	$»cÜd_bË
(
»cÜd_bË_
) { }

54 
public
:

56 
¡ršg
 
	`do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

57 
	`do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const;

58 
¡ršg
 
	$do_g‘_d©a
() const;

60 
	}
};

	@backends/brass/brass_inverter.cc

21 
	~<cÚfig.h
>

23 
	~"b¿ss_šv”‹r.h
"

25 
	~"b¿ss_po¡li¡.h
"

27 
	~<m­
>

28 
	~<¡ršg
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gInv”‹r
::
	$æush_doş’gths
(
B¿ssPo¡Li¡TabË
 & 
bË
)

35 
bË
.
	`m”ge_doş’_chªges
(
doş’_chªges
);

36 
doş’_chªges
.
	`ş—r
();

37 
	}
}

40 
	gInv”‹r
::
	$æush_po¡_li¡
(
B¿ssPo¡Li¡TabË
 & 
bË
, cÚ¡ 
¡ršg
 & 
‹rm
)

42 
m­
<
¡ršg
, 
Po¡šgChªges
>::
™”©Ü
 
i
;

43 
i
 = 
po¡li¡_chªges
.
	`fšd
(
‹rm
);

44 ià(
i
 =ğ
po¡li¡_chªges
.
	`’d
()) ;

47 
bË
.
	`m”ge_chªges
(
‹rm
, 
i
->
£cÚd
);

48 
po¡li¡_chªges
.
	`”a£
(
i
);

49 
	}
}

52 
	gInv”‹r
::
	$æush_®l_po¡_li¡s
(
B¿ssPo¡Li¡TabË
 & 
bË
)

54 
m­
<
¡ršg
, 
Po¡šgChªges
>::
cÚ¡_™”©Ü
 
i
;

55 
i
 = 
po¡li¡_chªges
.
	`begš
(); i !ğpo¡li¡_chªges.
	`’d
(); ++i) {

56 
bË
.
	`m”ge_chªges
(
i
->
fœ¡
, i->
£cÚd
);

58 
po¡li¡_chªges
.
	`ş—r
();

59 
	}
}

62 
	gInv”‹r
::
	$æush_po¡_li¡s
(
B¿ssPo¡Li¡TabË
 & 
bË
, cÚ¡ 
¡ršg
 & 
pfx
)

64 ià(
pfx
.
	`em±y
())

65  
	`æush_®l_po¡_li¡s
(
bË
);

67 
m­
<
¡ršg
, 
Po¡šgChªges
>::
™”©Ü
 
i
, 
begš
, 
’d
;

68 
begš
 = 
po¡li¡_chªges
.
	`low”_bound
(
pfx
);

69 
’d
 = 
po¡li¡_chªges
.
	`uµ”_bound
(
pfx
);

71 
i
 = 
begš
; i !ğ
’d
; ++i) {

72 
bË
.
	`m”ge_chªges
(
i
->
fœ¡
, i->
£cÚd
);

77 
po¡li¡_chªges
.
	`”a£
(
begš
, 
’d
);

78 
	}
}

81 
	gInv”‹r
::
	$æush
(
B¿ssPo¡Li¡TabË
 & 
bË
)

83 
	`æush_doş’gths
(
bË
);

84 
	`æush_®l_po¡_li¡s
(
bË
);

85 
	}
}

	@backends/brass/brass_inverter.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_INVERTER_H


22 
	#XAPIAN_INCLUDED_BRASS_INVERTER_H


	)

24 
	~"x­Ÿn/ty³s.h
"

26 
	~<m­
>

27 
	~<¡ršg
>

29 
	~"omas£¹.h
"

30 
	~"¡r.h
"

31 
	~"x­Ÿn/”rÜ.h
"

33 
şass
 
	gB¿ssPo¡Li¡TabË
;

36 cÚ¡ 
	gX­Ÿn
::
‹rmcouÁ
 
DELETED_POSTING
 = 
X­Ÿn
::termcount(-1);

39 şas 
	cInv”‹r
 {

40 
ä›nd
 
şass
 
	mB¿ssPo¡Li¡TabË
;

43 şas 
	cPo¡šgChªges
 {

44 
ä›nd
 
şass
 
	mB¿ssPo¡Li¡TabË
;

47 
	mX­Ÿn
::
‹rmcouÁ_diff
 
tf_d–
;

50 
	mX­Ÿn
::
‹rmcouÁ_diff
 
cf_d–
;

53 
	m¡d
::
m­
<
X­Ÿn
::
docid
, 
	mX­Ÿn
::
‹rmcouÁ
> 
¶_chªges
;

55 
	mpublic
:

57 
Po¡šgChªges
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
‹rmcouÁ
 
wdf
)

58 : 
tf_d–
(1), 
cf_d–
(
X­Ÿn
::
‹rmcouÁ_diff
(
wdf
))

60 
¶_chªges
.
š£¹
(
¡d
::
make_·œ
(
did
, 
wdf
));

64 
Po¡šgChªges
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
‹rmcouÁ
 
wdf
, 
boŞ
)

65 : 
tf_d–
(-1), 
cf_d–
(-
X­Ÿn
::
‹rmcouÁ_diff
(
wdf
))

67 
¶_chªges
.
š£¹
(
¡d
::
make_·œ
(
did
, 
DELETED_POSTING
));

71 
Po¡šgChªges
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
‹rmcouÁ
 
Şd_wdf
,

72 
X­Ÿn
::
‹rmcouÁ
 
Ãw_wdf
)

73 : 
tf_d–
(0), 
cf_d–
(
X­Ÿn
::
‹rmcouÁ_diff
(
Ãw_wdf
 - 
Şd_wdf
))

75 
¶_chªges
.
š£¹
(
¡d
::
make_·œ
(
did
, 
Ãw_wdf
));

79 
add_po¡šg
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
‹rmcouÁ
 
wdf
) {

80 ++
tf_d–
;

81 
	mcf_d–
 +ğ
wdf
;

83 
	m¶_chªges
[
did
] = 
wdf
;

87 
»move_po¡šg
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
‹rmcouÁ
 
wdf
) {

88 --
tf_d–
;

89 
	mcf_d–
 -ğ
wdf
;

91 
	m¶_chªges
[
did
] = 
DELETED_POSTING
;

95 
upd©e_po¡šg
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
‹rmcouÁ
 
Şd_wdf
,

96 
X­Ÿn
::
‹rmcouÁ
 
Ãw_wdf
) {

97 
cf_d–
 +ğ
Ãw_wdf
 - 
Şd_wdf
;

98 
	m¶_chªges
[
did
] = 
Ãw_wdf
;

102 
	mX­Ÿn
::
‹rmcouÁ_diff
 
g‘_tfd–
(ècÚ¡ {  
tf_d–
; }

105 
	mX­Ÿn
::
‹rmcouÁ_diff
 
g‘_cfd–
(ècÚ¡ {  
cf_d–
; }

109 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gPo¡šgChªges
> 
	gpo¡li¡_chªges
;

111 
	gpublic
:

113 
¡d
::
m­
<
X­Ÿn
::
docid
, 
	gX­Ÿn
::
‹rmcouÁ
> 
doş’_chªges
;

115 
	gpublic
:

116 
add_po¡šg
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
,

117 
X­Ÿn
::
doccouÁ
 
wdf
) {

118 
¡d
::
m­
<¡d::
¡ršg
, 
	gPo¡šgChªges
>::
™”©Ü
 
i
;

119 
	gi
 = 
po¡li¡_chªges
.
fšd
(
‹rm
);

120 ià(
	gi
 =ğ
po¡li¡_chªges
.
’d
()) {

121 
po¡li¡_chªges
.
š£¹
(

122 
¡d
::
make_·œ
(
‹rm
, 
Po¡šgChªges
(
did
, 
wdf
)));

124 
	gi
->
	g£cÚd
.
add_po¡šg
(
did
, 
wdf
);

128 
»move_po¡šg
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
,

129 
X­Ÿn
::
doccouÁ
 
wdf
) {

130 
¡d
::
m­
<¡d::
¡ršg
, 
	gPo¡šgChªges
>::
™”©Ü
 
i
;

131 
	gi
 = 
po¡li¡_chªges
.
fšd
(
‹rm
);

132 ià(
	gi
 =ğ
po¡li¡_chªges
.
’d
()) {

133 
po¡li¡_chªges
.
š£¹
(

134 
¡d
::
make_·œ
(
‹rm
, 
Po¡šgChªges
(
did
, 
wdf
, 
çl£
)));

136 
	gi
->
	g£cÚd
.
»move_po¡šg
(
did
, 
wdf
);

140 
upd©e_po¡šg
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
,

141 
X­Ÿn
::
‹rmcouÁ
 
Şd_wdf
,

142 
X­Ÿn
::
‹rmcouÁ
 
Ãw_wdf
) {

143 
¡d
::
m­
<¡d::
¡ršg
, 
	gPo¡šgChªges
>::
™”©Ü
 
i
;

144 
	gi
 = 
po¡li¡_chªges
.
fšd
(
‹rm
);

145 ià(
	gi
 =ğ
po¡li¡_chªges
.
’d
()) {

146 
po¡li¡_chªges
.
š£¹
(

147 
¡d
::
make_·œ
(
‹rm
, 
Po¡šgChªges
(
did
, 
Şd_wdf
, 
Ãw_wdf
)));

149 
	gi
->
	g£cÚd
.
upd©e_po¡šg
(
did
, 
Şd_wdf
, 
Ãw_wdf
);

153 
	$ş—r
() {

154 
doş’_chªges
.
	`ş—r
();

155 
po¡li¡_chªges
.
	`ş—r
();

156 
	}
}

158 
£t_doş’gth
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
‹rmcouÁ
 
doş’
, 
boŞ
 
add
) {

159 ià(
	gadd
) {

160 
As£¹
(
doş’_chªges
.
fšd
(
did
è=ğdoş’_chªges.
’d
(è|| doş’_chªges[did] =ğ
DELETED_POSTING
);

162 
	gdoş’_chªges
[
did
] = 
doş’
;

165 
d–‘e_doş’gth
(
X­Ÿn
::
docid
 
did
) {

166 
As£¹
(
doş’_chªges
.
fšd
(
did
è=ğdoş’_chªges.
’d
(è|| doş’_chªges[did] !ğ
DELETED_POSTING
);

167 
	gdoş’_chªges
[
did
] = 
DELETED_POSTING
;

170 
boŞ
 
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
‹rmcouÁ
 & 
doş’
) const {

171 
¡d
::
m­
<
X­Ÿn
::
docid
, 
	gX­Ÿn
::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
i
;

172 
	gi
 = 
doş’_chªges
.
fšd
(
did
);

173 ià(
	gi
 =ğ
doş’_chªges
.
’d
())

174  
çl£
;

175 ià(
¿»
(
i
->
£cÚd
 =ğ
DELETED_POSTING
))

176 
throw
 
X­Ÿn
::
DocNÙFoundE¼Ü
("Docum’ˆnÙ found: " + 
¡r
(
did
));

177 
	gdoş’
 = 
i
->
£cÚd
;

178  
	gŒue
;

182 
æush_doş’gths
(
B¿ssPo¡Li¡TabË
 & 
bË
);

185 
æush_po¡_li¡
(
B¿ssPo¡Li¡TabË
 & 
bË
, cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
);

188 
æush_®l_po¡_li¡s
(
B¿ssPo¡Li¡TabË
 & 
bË
);

191 
æush_po¡_li¡s
(
B¿ssPo¡Li¡TabË
 & 
bË
, cÚ¡ 
¡d
::
¡ršg
 & 
pfx
);

194 
æush
(
B¿ssPo¡Li¡TabË
 & 
bË
);

196 
	gX­Ÿn
::
‹rmcouÁ_diff
 
g‘_tfd–
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const {

197 
¡d
::
m­
<¡d::
¡ršg
, 
	gPo¡šgChªges
>::
cÚ¡_™”©Ü
 
i
;

198 
	gi
 = 
po¡li¡_chªges
.
fšd
(
‹rm
);

199 ià(
	gi
 =ğ
po¡li¡_chªges
.
’d
())

201  
	gi
->
	g£cÚd
.
g‘_tfd–
();

204 
	gX­Ÿn
::
‹rmcouÁ_diff
 
g‘_cfd–
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const {

205 
¡d
::
m­
<¡d::
¡ršg
, 
	gPo¡šgChªges
>::
cÚ¡_™”©Ü
 
i
;

206 
	gi
 = 
po¡li¡_chªges
.
fšd
(
‹rm
);

207 ià(
	gi
 =ğ
po¡li¡_chªges
.
’d
())

209  
	gi
->
	g£cÚd
.
g‘_cfd–
();

	@backends/brass/brass_io.cc

21 
	~<cÚfig.h
>

23 
	~"§ã”ºo.h
"

24 
	~"§ãuni¡d.h
"

26 
	~<x­Ÿn/”rÜ.h
>

28 
	~"b¿ss_io.h
"

30 
size_t
 
	$b¿ss_io_»ad
(
fd
, * 
p
, 
size_t
 
n
, size_ˆ
mš
)

32 
size_t
 
tÙ®
 = 0;

33 
n
) {

34 
ssize_t
 
c
 = 
	`»ad
(
fd
, 
p
, 
n
);

35 ià(
c
 <= 0) {

36 ià(
c
 == 0) {

37 ià(
tÙ®
 >ğ
mš
) ;

38 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„eadƒnough (EOF)");

40 ià(
”ºo
 =ğ
EINTR
) ;

41 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("E¼Ü„—dšg from fe", 
”ºo
);

43 
p
 +ğ
c
;

44 
tÙ®
 +ğ
c
;

45 
n
 -ğ
c
;

47  
tÙ®
;

48 
	}
}

51 
	$b¿ss_io_wr™e
(
fd
, cÚ¡ * 
p
, 
size_t
 
n
)

53 
n
) {

54 
ssize_t
 
c
 = 
	`wr™e
(
fd
, 
p
, 
n
);

55 ià(
c
 < 0) {

56 ià(
”ºo
 =ğ
EINTR
) ;

57 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("E¼Ü wr™šgØfe", 
”ºo
);

59 
p
 +ğ
c
;

60 
n
 -ğ
c
;

62 
	}
}

	@backends/brass/brass_io.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_IO_H


22 
	#XAPIAN_INCLUDED_BRASS_IO_H


	)

24 
	~<sys/ty³s.h
>

25 
	~"§ãfú.h
"

26 
	~"§ãuni¡d.h
"

33 
šlše
 
boŞ
 
	$b¿ss_io_sync
(
fd
)

35 #ifdeà
F_FULLFSYNC


46 ià(
	`fú
(
fd
, 
F_FULLFSYNC
, 0) == 0)

47  
Œue
;

50 #ià
defšed
 
HAVE_FDATASYNC


53  
	`fd©async
(
fd
) == 0;

54 #–ià
defšed
 
HAVE_FSYNC


55  
	`fsync
(
fd
) == 0;

56 #–ià
defšed
 
__WIN32__


57  
	`_comm™
(
fd
) == 0;

59 #”rÜ 
CªnÙ
 
im¶em’t
 
	`b¿ss_io_sync
(è
w™hout
 
	`fd©async
(), 
	`fsync
(), 
Ü
 
	`_comm™
()

61 
	}
}

70 
size_t
 
b¿ss_io_»ad
(
fd
, * 
p
, size_ˆ
n
, size_ˆ
mš
);

73 
b¿ss_io_wr™e
(
fd
, cÚ¡ * 
p
, 
size_t
 
n
);

	@backends/brass/brass_lazytable.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_LAZYTABLE_H


22 
	#XAPIAN_INCLUDED_BRASS_LAZYTABLE_H


	)

24 
	~"b¿ss_bË.h
"

26 şas 
	cB¿ssLazyTabË
 : 
public
 
B¿ssTabË
 {

27 
public
:

35 
B¿ssLazyTabË
(cÚ¡ * 
Çme_
, cÚ¡ 
¡d
::
¡ršg
 & 
·th
, 
boŞ
 
»adÚly
,

36 
z_¡¿‹gy
)

37 : 
	$B¿ssTabË
(
Çme_
, 
·th
, 
»adÚly
, 
z_¡¿‹gy
, 
Œue
) { }

44 
	$ü—‹_ªd_İ’
(
blocksize
) {

47 
B¿ssTabË
::
	`”a£
();

48 
B¿ssTabË
::
	`£t_block_size
(
blocksize
);

49 
	}
}

	@backends/brass/brass_metadata.cc

22 
	~<cÚfig.h
>

23 
	~"b¿ss_m‘ad©a.h
"

25 
	~"b¿ss_cursÜ.h
"

27 
	~"d©aba£.h
"

28 
	~"omas£¹.h
"

29 
	~"¡ršguts.h
"

31 
	~"x­Ÿn/”rÜ.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
	gB¿ssM‘ad©aT”mLi¡
::
B¿ssM‘ad©aT”mLi¡
(

36 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

37 
B¿ssCursÜ
 * 
cursÜ_
,

38 cÚ¡ 
¡ršg
 &
´efix_
)

39 : 
d©aba£
(
d©aba£_
), 
cursÜ
(
cursÜ_
), 
´efix
(
¡ršg
("\x00\xc0", 2è+ 
´efix_
)

41 
DEBUGCALL
(
DB
, , "BrassMetadataTermList", "<database>, <cursor>");

42 
As£¹
(
cursÜ
);

44 
	gcursÜ
->
fšd_’Œy_É
(
´efix
);

47 
	gB¿ssM‘ad©aT”mLi¡
::~
	$B¿ssM‘ad©aT”mLi¡
()

49 
	`DEBUGCALL
(
DB
, , "~BrassMetadataTermList", "");

50 
d–‘e
 
cursÜ
;

51 
	}
}

53 
¡ršg


54 
	gB¿ssM‘ad©aT”mLi¡
::
	$g‘_‹rmÇme
() const

56 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassMetadataTermList::get_termname", "");

57 
	`As£¹
(!
	`©_’d
());

58 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

59 
	`As£¹
(
	`¡¬tsw™h
(
cursÜ
->
cu¼’t_key
, 
´efix
));

60 
	`RETURN
(
cursÜ
->
cu¼’t_key
.
	`sub¡r
(2));

61 
	}
}

63 
	gX­Ÿn
::
doccouÁ


64 
B¿ssM‘ad©aT”mLi¡
::
	$g‘_‹rmäeq
() const

66 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("BrassMetadataTermList::get_termfreq()‚ot meaningful");

67 
	}
}

69 
	gX­Ÿn
::
‹rmcouÁ


70 
B¿ssM‘ad©aT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

72 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("BrassMetadataTermList::get_collection_freq()‚ot meaningful");

73 
	}
}

75 
T”mLi¡
 *

76 
	gB¿ssM‘ad©aT”mLi¡
::
	$Ãxt
()

78 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "BrassMetadataTermList::next", "");

79 
	`As£¹
(!
	`©_’d
());

81 
cursÜ
->
	`Ãxt
();

82 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

84 
cursÜ
->
	`to_’d
();

87 
	`RETURN
(
NULL
);

88 
	}
}

90 
T”mLi¡
 *

91 
	gB¿ssM‘ad©aT”mLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
key
)

93 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "B¿ssM‘ad©aT”mLi¡::sk_to", 
key
);

94 
	`As£¹
(!
	`©_’d
());

96 ià(!
cursÜ
->
	`fšd_’Œy_ge
(
	`¡ršg
("\x00\xc0", 2è+ 
key
)) {

99 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

101 
cursÜ
->
	`to_’d
();

104 
	`RETURN
(
NULL
);

105 
	}
}

107 
boŞ


108 
	gB¿ssM‘ad©aT”mLi¡
::
	$©_’d
() const

110 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassMetadataTermList::at_end", "");

111 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

112 
	}
}

	@backends/brass/brass_metadata.h

22 #iâdeà
XAPIAN_INCLUDED_BRASS_METADATA_H


23 
	#XAPIAN_INCLUDED_BRASS_METADATA_H


	)

25 
	~<x­Ÿn/ba£.h
>

26 
	~<x­Ÿn/d©aba£.h
>

27 
	~<x­Ÿn/ty³s.h
>

29 
	~"®É”m¦i¡.h
"

30 
	~"b¿ss_bË.h
"

31 
	~"omdebug.h
"

32 
	~"‹rmli¡.h
"

34 
	~<¡ršg
>

36 
şass
 
	gB¿ssCursÜ
;

38 şas 
	cB¿ssM‘ad©aT”mLi¡
 : 
public
 
AÎT”msLi¡
 {

40 
B¿ssM‘ad©aT”mLi¡
(const BrassMetadataTermList &);

43 
	mİ”©Ü
=(cÚ¡ 
B¿ssM‘ad©aT”mLi¡
 &);

46 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

50 
B¿ssCursÜ
 * 
	mcursÜ
;

54 
	m¡d
::
¡ršg
 
´efix
;

56 
	mpublic
:

57 
B¿ssM‘ad©aT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

58 
B¿ssCursÜ
 * 
cursÜ_
, cÚ¡ 
¡d
::
¡ršg
 &
´efix_
);

60 ~
B¿ssM‘ad©aT”mLi¡
();

67 
	m¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

73 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

79 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

82 
T”mLi¡
 * 
	`Ãxt
();

85 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
key
);

88 
boŞ
 
	$©_’d
() const;

	@backends/brass/brass_positionlist.cc

21 
	~<cÚfig.h
>

23 
	~"b¿ss_pos™iÚli¡.h
"

25 
	~<x­Ÿn/ty³s.h
>

27 
	~"b™¡»am.h
"

28 
	~"omdebug.h
"

29 
	~"·ck.h
"

31 
	~<¡ršg
>

32 
	~<veùÜ
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	gB¿ssPos™iÚLi¡TabË
::
£t_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
,

38 cÚ¡ 
¡ršg
 & 
Šame
,

39 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos
,

40 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 &
pos_’d
)

42 
DEBUGCALL
(
DB
, , "BrassPositionList::set_positionlist",

43 
did
 << ", " << 
Šame
 << ", " << 
pos
 << ", " << 
pos_’d
);

44 
As£¹
(
pos
 !ğ
pos_’d
);

47 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
> 
poscİy
(
pos
, 
pos_’d
);

49 
¡ršg
 
	gkey
 = 
make_key
(
did
, 
Šame
);

51 
¡ršg
 
	gs
;

52 
·ck_ušt
(
s
, 
poscİy
.
back
());

54 ià(
	gposcİy
.
size
() == 1) {

56 
add
(
key
, 
s
);

60 
B™Wr™”
 
wr
(
s
);

61 
	gwr
.
’code
(
poscİy
[0],…oscİy.
back
());

62 
	gwr
.
’code
(
poscİy
.
size
(è- 2,…oscİy.
back
() -…oscopy[0]);

63 
	gwr
.
’code_š‹½Ş©ive
(
poscİy
, 0,…oscİy.
size
() - 1);

64 
add
(
key
, 
wr
.
ä“ze
());

67 
	gX­Ÿn
::
‹rmcouÁ


68 
B¿ssPos™iÚLi¡TabË
::
pos™iÚli¡_couÁ
(
X­Ÿn
::
docid
 
did
,

69 cÚ¡ 
¡ršg
 & 
‹rm
) const

71 
DEBUGCALL
(
DB
, , "BrassPositionListTable::positionlist_count",

72 
did
 << ", " << 
‹rm
);

74 
¡ršg
 
	gd©a
;

75 ià(!
g‘_exaù_’Œy
(
make_key
(
did
, 
‹rm
), 
d©a
)) {

80 cÚ¡ * 
	gpos
 = 
d©a
.data();

81 cÚ¡ * 
	g’d
 = 
pos
 + 
d©a
.
size
();

82 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

83 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

84 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Position†ist data corrupt");

86 ià(
	gpos
 =ğ
’d
) {

92 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

93 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

94 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

95  
	gpos_size
;

100 
boŞ


101 
	gB¿ssPos™iÚLi¡
::
»ad_d©a
(cÚ¡ 
B¿ssTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

102 cÚ¡ 
¡ršg
 & 
Šame
)

104 
DEBUGCALL
(
DB
, , "BrassPositionList::read_data",

105 
bË
 << ", " << 
did
 << ", " << 
Šame
);

107 
	ghave_¡¬‹d
 = 
çl£
;

108 
	gpos™iÚs
.
ş—r
();

110 
¡ršg
 
	gd©a
;

111 ià(!
	gbË
->
g‘_exaù_’Œy
(
B¿ssPos™iÚLi¡TabË
::
make_key
(
did
, 
Šame
), 
d©a
)) {

113 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

114  
	gçl£
;

117 cÚ¡ * 
	gpos
 = 
d©a
.data();

118 cÚ¡ * 
	g’d
 = 
pos
 + 
d©a
.
size
();

119 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

120 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

121 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Position†ist data corrupt");

123 ià(
	gpos
 =ğ
’d
) {

125 
pos™iÚs
.
push_back
(
pos_Ï¡
);

126 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

127  
	gŒue
;

130 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

131 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

132 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

133 
	gpos™iÚs
.
»size
(
pos_size
);

134 
	gpos™iÚs
[0] = 
pos_fœ¡
;

135 
	gpos™iÚs
.
back
(èğ
pos_Ï¡
;

136 
	grd
.
decode_š‹½Ş©ive
(
pos™iÚs
, 0, 
pos_size
 - 1);

138 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

139  
	gŒue
;

142 
	gX­Ÿn
::
‹rmcouÁ


143 
B¿ssPos™iÚLi¡
::
	$g‘_size
() const

145 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassPositionList::get_size", "");

146 
	`RETURN
(
pos™iÚs
.
	`size
());

147 
	}
}

149 
	gX­Ÿn
::
‹rmpos


150 
B¿ssPos™iÚLi¡
::
	$g‘_pos™iÚ
() const

152 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmpos
, "BrassPositionList::get_position", "");

153 
	`As£¹
(
have_¡¬‹d
);

154 
	`RETURN
(*
cu¼’t_pos
);

155 
	}
}

158 
	gB¿ssPos™iÚLi¡
::
	$Ãxt
()

160 
	`DEBUGCALL
(
DB
, , "BrassPositionList::next", "");

162 ià(!
have_¡¬‹d
) {

163 
have_¡¬‹d
 = 
Œue
;

165 
	`As£¹
(!
	`©_’d
());

166 ++
cu¼’t_pos
;

168 
	}
}

171 
	gB¿ssPos™iÚLi¡
::
sk_to
(
X­Ÿn
::
‹rmpos
ermpos)

173 
DEBUGCALL
(
DB
, , "B¿ssPos™iÚLi¡::sk_to", 
‹rmpos
);

174 ià(!
	ghave_¡¬‹d
) {

175 
	ghave_¡¬‹d
 = 
Œue
;

177 !
©_’d
(è&& *
	gcu¼’t_pos
 < 
	g‹rmpos
) ++current_pos;

180 
boŞ


181 
	gB¿ssPos™iÚLi¡
::
	$©_’d
() const

183 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassPositionList::at_end", "");

184 
	`RETURN
(
cu¼’t_pos
 =ğ
pos™iÚs
.
	`’d
());

185 
	}
}

	@backends/brass/brass_positionlist.h

21 #iâdeà
XAPIAN_HGUARD_BRASS_POSITIONLIST_H


22 
	#XAPIAN_HGUARD_BRASS_POSITIONLIST_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"b¿ss_ÏzybË.h
"

27 
	~"·ck.h
"

28 
	~"pos™iÚli¡.h
"

30 
	~<¡ršg
>

31 
	~<veùÜ
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 şas 
	cB¿ssPos™iÚLi¡TabË
 : 
public
 
B¿ssLazyTabË
 {

36 
public
:

37 
¡ršg
 
make_key
(
X­Ÿn
::
docid
 
did
, cÚ¡ sŒšg & 
‹rm
) {

38 
¡ršg
 
	mkey
;

39 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

40 
	mkey
 +ğ
‹rm
;

41  
	mkey
;

52 
	$B¿ssPos™iÚLi¡TabË
(cÚ¡ 
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

53 : 
	`B¿ssLazyTabË
("pos™iÚ", 
dbdœ
 + "/pos™iÚ.", 
»adÚly
,

54 
DONT_COMPRESS
è{ 
	}
}

57 
£t_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
Šame
,

58 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos
,

59 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 &
pos_’d
);

62 
d–‘e_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
Šame
) {

63 
d–
(
make_key
(
did
, 
Šame
));

67 
	gX­Ÿn
::
‹rmcouÁ
 
pos™iÚli¡_couÁ
(
X­Ÿn
::
docid
 
did
,

68 cÚ¡ 
¡ršg
 & 
‹rm
) const;

72 şas 
	cB¿ssPos™iÚLi¡
 : 
public
 
Pos™iÚLi¡
 {

74 
veùÜ
<
X­Ÿn
::
‹rmpos
> 
pos™iÚs
;

77 
	mveùÜ
<
	mX­Ÿn
::
‹rmpos
>::
cÚ¡_™”©Ü
 
cu¼’t_pos
;

80 
boŞ
 
	mhave_¡¬‹d
;

83 
Ãxt_š‹º®
();

86 
B¿ssPos™iÚLi¡
(const BrassPositionList &);

89 
	mİ”©Ü
=(cÚ¡ 
B¿ssPos™iÚLi¡
 &);

91 
	mpublic
:

93 
	$B¿ssPos™iÚLi¡
(è: 
	$have_¡¬‹d
(
çl£
) {}

96 
	`B¿ssPos™iÚLi¡
(cÚ¡ 
B¿ssTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

97 cÚ¡ 
¡ršg
 & 
Šame
) {

98 ()
	`»ad_d©a
(
bË
, 
did
, 
Šame
);

99 
	}
}

105 
boŞ
 
»ad_d©a
(cÚ¡ 
B¿ssTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

106 cÚ¡ 
¡ršg
 & 
Šame
);

109 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_size
() const;

116 
X­Ÿn
::
‹rmpos
 
	$g‘_pos™iÚ
() const;

119 
	`Ãxt
();

122 
	`sk_to
(
X­Ÿn
::
‹rmpos
ermpos);

125 
boŞ
 
	$©_’d
() const;

126 
	}
};

	@backends/brass/brass_postlist.cc

23 
	~<cÚfig.h
>

25 
	~"b¿ss_po¡li¡.h
"

27 
	~"b¿ss_cursÜ.h
"

28 
	~"b¿ss_d©aba£.h
"

29 
	~"nÜ‘uº.h
"

30 
	~"omdebug.h
"

31 
	~"·ck.h
"

32 
	~"uts.h
"

34 
	gX­Ÿn
::
doccouÁ


35 
B¿ssPo¡Li¡TabË
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

37 
¡ršg
 
key
 = 
	`make_key
(
‹rm
);

38 
¡ršg
 
g
;

39 ià(!
	`g‘_exaù_’Œy
(
key
, 
g
))  0;

41 
X­Ÿn
::
doccouÁ
 
‹rmäeq
;

42 cÚ¡ * 
p
 = 
g
.
	`d©a
();

43 
B¿ssPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
,… + 
g
.
	`size
(), &
‹rmäeq
, 
NULL
);

44  
‹rmäeq
;

45 
	}
}

47 
	gX­Ÿn
::
‹rmcouÁ


48 
B¿ssPo¡Li¡TabË
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

50 
¡ršg
 
key
 = 
	`make_key
(
‹rm
);

51 
¡ršg
 
g
;

52 ià(!
	`g‘_exaù_’Œy
(
key
, 
g
))  0;

54 
X­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

55 cÚ¡ * 
p
 = 
g
.
	`d©a
();

56 
B¿ssPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
,… + 
g
.
	`size
(), 
NULL
, &
cŞläeq
);

57  
cŞläeq
;

58 
	}
}

60 
	gX­Ÿn
::
‹rmcouÁ


61 
B¿ssPo¡Li¡TabË
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
,

62 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db
) const {

63 ià(!
doş’_¶
.
g‘
()) {

66 
doş’_¶
.
»£t
(
Ãw
 
B¿ssPo¡Li¡
(
db
, 
¡ršg
(), 
çl£
));

68 ià(!
	gdoş’_¶
->
jump_to
(
did
))

69 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Docum’ˆ" + 
om_to¡ršg
(
did
) + "‚ot found");

70  
	gdoş’_¶
->
g‘_wdf
();

73 
boŞ


74 
	gB¿ssPo¡Li¡TabË
::
docum’t_exi¡s
(
X­Ÿn
::
docid
 
did
,

75 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db
) const

77 ià(!
doş’_¶
.
g‘
()) {

80 
doş’_¶
.
»£t
(
Ãw
 
B¿ssPo¡Li¡
(
db
, 
¡ršg
(), 
çl£
));

82  (
	gdoş’_¶
->
jump_to
(
did
));

90 cÚ¡ 
	gCHUNKSIZE
 = 2000;

98 şas 
	cB¿ss
::
Po¡li¡ChunkWr™”
 {

99 
public
:

100 
Po¡li¡ChunkWr™”
(cÚ¡ 
¡ršg
 &
Üig_key_
,

101 
boŞ
 
is_fœ¡_chunk_
,

102 cÚ¡ 
¡ršg
 &
Šame_
,

103 
boŞ
 
is_Ï¡_chunk_
);

106 
­³nd
(
B¿ssTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

107 
X­Ÿn
::
‹rmcouÁ
 
wdf
);

110 
¿w_­³nd
(
X­Ÿn
::
docid
 
fœ¡_did_
, X­Ÿn::docid 
cu¼’t_did_
,

111 cÚ¡ 
¡ršg
 & 
s
) {

112 
As£¹
(!
¡¬‹d
);

113 
	mfœ¡_did
 = 
fœ¡_did_
;

114 
	mcu¼’t_did
 = 
cu¼’t_did_
;

115 ià(!
	ms
.
em±y
()) {

116 
	mchunk
.
­³nd
(
s
);

117 
	m¡¬‹d
 = 
Œue
;

125 
æush
(
B¿ssTabË
 *
bË
);

127 
	g´iv©e
:

128 
¡ršg
 
Üig_key
;

129 
¡ršg
 
	gŠame
;

130 
boŞ
 
	gis_fœ¡_chunk
;

131 
boŞ
 
	gis_Ï¡_chunk
;

132 
boŞ
 
	g¡¬‹d
;

134 
	gX­Ÿn
::
docid
 
fœ¡_did
;

135 
	gX­Ÿn
::
docid
 
cu¼’t_did
;

137 
¡ršg
 
	gchunk
;

143 
XAPIAN_NORETURN
(
»pÜt_»ad_”rÜ
(cÚ¡ * 
pos™iÚ
));

144 
	$»pÜt_»ad_”rÜ
(cÚ¡ * 
pos™iÚ
)

146 ià(
pos™iÚ
 == 0) {

148 
	`LOGLINE
(
DB
, "BrassPostList data„an out");

149 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Data„an out unexpectedly when„eading…osting†ist.");

152 
	`LOGLINE
(
DB
, "BrassPostList valueoo†arge");

153 
throw
 
X­Ÿn
::
	`RªgeE¼Ü
("Value in…osting†istoo†arge.");

154 
	}
}

156 
šlše
 
boŞ
 
	$g‘_Šame_äom_key
(cÚ¡ **
¤c
, cÚ¡ *
’d
,

157 
¡ršg
 &
Šame
)

159  
	`uÅack_¡ršg_´e£rvšg_sÜt
(
¤c
, 
’d
, 
Šame
);

160 
	}
}

162 
šlše
 
boŞ


163 
	$check_Šame_š_key_l™e
(cÚ¡ **
keypos
, cÚ¡ *
key’d
, cÚ¡ 
¡ršg
 &
Šame
)

165 
¡ršg
 
Šame_š_key
;

167 ià(
key’d
 - *
keypos
 >= 2 && (*keypos)[0] == '\0' && (*keypos)[1] == '\xe0') {

168 *
keypos
 += 2;

171 ià(!
	`g‘_Šame_äom_key
(
keypos
, 
key’d
, 
Šame_š_key
))

172 
	`»pÜt_»ad_”rÜ
(*
keypos
);

176  
Šame_š_key
 =ğ
Šame
;

177 
	}
}

179 
šlše
 
boŞ


180 
	$check_Šame_š_key
(cÚ¡ **
keypos
, cÚ¡ *
key’d
, cÚ¡ 
¡ršg
 &
Šame
)

182 ià(*
keypos
 =ğ
key’d
è 
çl£
;

184  
	`check_Šame_š_key_l™e
(
keypos
, 
key’d
, 
Šame
);

185 
	}
}

188 
	gX­Ÿn
::
docid


189 
»ad_¡¬t_of_fœ¡_chunk
(cÚ¡ ** 
po¥Œ
,

190 cÚ¡ * 
’d
,

191 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

192 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
)

194 
DEBUGCALL_STATIC
(
DB
, 
X­Ÿn
::
docid
, "read_start_of_first_chunk",

195 (cÚ¡ *)
po¥Œ
 << ", " <<

196 (cÚ¡ *)
’d
 << ", " <<

197 (*)
numb”_of_’Œ›s_±r
 << ", " <<

198 (*)
cŞËùiÚ_äeq_±r
);

200 
	gB¿ssPo¡Li¡
::
»ad_numb”_of_’Œ›s
(
po¥Œ
, 
’d
,

201 
numb”_of_’Œ›s_±r
, 
cŞËùiÚ_äeq_±r
);

202 ià(
	gnumb”_of_’Œ›s_±r
)

203 
LOGVALUE
(
DB
, *
numb”_of_’Œ›s_±r
);

204 ià(
	gcŞËùiÚ_äeq_±r
)

205 
LOGVALUE
(
DB
, *
cŞËùiÚ_äeq_±r
);

207 
	gX­Ÿn
::
docid
 
did
;

209 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, &
did
))

210 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

211 ++
	gdid
;

212 
LOGVALUE
(
DB
, 
did
);

213 
RETURN
(
did
);

216 
šlše
 

217 
»ad_did_šü—£
(cÚ¡ ** 
po¥Œ
, cÚ¡ * 
’d
,

218 
X­Ÿn
::
docid
 * 
did_±r
)

220 
X­Ÿn
::
docid
 
did_šü—£
;

221 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, &
did_šü—£
)è
»pÜt_»ad_”rÜ
(*posptr);

222 *
	gdid_±r
 +ğ
did_šü—£
 + 1;

226 
šlše
 

227 
»ad_wdf
(cÚ¡ ** 
po¥Œ
, cÚ¡ * 
’d
, 
X­Ÿn
::
‹rmcouÁ
 * 
wdf_±r
)

229 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, 
wdf_±r
)è
»pÜt_»ad_”rÜ
(*posptr);

233 
	gX­Ÿn
::
docid


234 
»ad_¡¬t_of_chunk
(cÚ¡ ** 
po¥Œ
,

235 cÚ¡ * 
’d
,

236 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
,

237 
boŞ
 * 
is_Ï¡_chunk_±r
)

239 
DEBUGCALL_STATIC
(
DB
, 
X­Ÿn
::
docid
, "read_start_of_chunk",

240 
»š‹½»t_ÿ¡
<cÚ¡ *>(
po¥Œ
) << ", " <<

241 
»š‹½»t_ÿ¡
<cÚ¡ *>(
’d
) << ", " <<

242 
fœ¡_did_š_chunk
 << ", " <<

243 
»š‹½»t_ÿ¡
<cÚ¡ *>(
is_Ï¡_chunk_±r
));

246 ià(!
uÅack_boŞ
(
po¥Œ
, 
’d
, 
is_Ï¡_chunk_±r
))

247 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

248 ià(
	gis_Ï¡_chunk_±r
)

249 
LOGVALUE
(
DB
, *
is_Ï¡_chunk_±r
);

252 
	gX­Ÿn
::
docid
 
šü—£_to_Ï¡
;

253 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, &
šü—£_to_Ï¡
))

254 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

255 
	gX­Ÿn
::
docid
 
Ï¡_did_š_chunk
 = 
fœ¡_did_š_chunk
 + 
šü—£_to_Ï¡
;

256 
LOGVALUE
(
DB
, 
Ï¡_did_š_chunk
);

257 
RETURN
(
Ï¡_did_š_chunk
);

264 şas 
	cB¿ss
::
Po¡li¡ChunkR—d”
 {

265 
¡ršg
 
d©a
;

267 cÚ¡ *
	mpos
;

268 cÚ¡ *
	m’d
;

270 
boŞ
 
	m©_’d
;

272 
	mX­Ÿn
::
docid
 
did
;

273 
	mX­Ÿn
::
‹rmcouÁ
 
wdf
;

275 
	mpublic
:

281 
Po¡li¡ChunkR—d”
(
X­Ÿn
::
docid
 
fœ¡_did
, cÚ¡ 
¡ršg
 & 
d©a_
)

282 : 
d©a
(
d©a_
), 
pos
(d©a.d©a()), 
’d
Õo + d©a.
Ëngth
()), 
©_’d
(d©a.
em±y
()), 
	$did
(
fœ¡_did
)

284 ià(!
©_’d
è
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

287 
X­Ÿn
::
docid
 
	$g‘_docid
() const {

288  
did
;

289 
	}
}

290 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const {

291  
wdf
;

292 
	}
}

294 
boŞ
 
	$is_©_’d
() const {

295  
©_’d
;

296 
	}
}

300 
Ãxt
();

304 
	gPo¡li¡ChunkR—d”
::
	$Ãxt
()

306 ià(
pos
 =ğ
’d
) {

307 
©_’d
 = 
Œue
;

309 
	`»ad_did_šü—£
(&
pos
, 
’d
, &
did
);

310 
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

312 
	}
}

314 
	gPo¡li¡ChunkWr™”
::
	$Po¡li¡ChunkWr™”
(cÚ¡ 
¡ršg
 &
Üig_key_
,

315 
boŞ
 
is_fœ¡_chunk_
,

316 cÚ¡ 
¡ršg
 &
Šame_
,

317 
boŞ
 
is_Ï¡_chunk_
)

318 : 
	`Üig_key
(
Üig_key_
),

319 
	`Šame
(
Šame_
), 
	`is_fœ¡_chunk
(
is_fœ¡_chunk_
),

320 
	`is_Ï¡_chunk
(
is_Ï¡_chunk_
),

321 
	$¡¬‹d
(
çl£
)

323 
	`DEBUGCALL
(
DB
, , "PostlistChunkWriter::PostlistChunkWriter",

324 
Üig_key_
 << ", " << 
is_fœ¡_chunk_
 << ", " << 
Šame_
 << ", " <<

325 
is_Ï¡_chunk_
);

326 
	}
}

329 
	gPo¡li¡ChunkWr™”
::
­³nd
(
B¿ssTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

330 
X­Ÿn
::
‹rmcouÁ
 
wdf
)

332 ià(!
¡¬‹d
) {

333 
¡¬‹d
 = 
Œue
;

334 
	gfœ¡_did
 = 
did
;

336 
As£¹
(
did
 > 
cu¼’t_did
);

338 ià(
	gchunk
.
size
(è>ğ
CHUNKSIZE
) {

339 
boŞ
 
§ve_is_Ï¡_chunk
 = 
is_Ï¡_chunk
;

340 
	gis_Ï¡_chunk
 = 
çl£
;

341 
æush
(
bË
);

342 
	gis_Ï¡_chunk
 = 
§ve_is_Ï¡_chunk
;

343 
	gis_fœ¡_chunk
 = 
çl£
;

344 
	gfœ¡_did
 = 
did
;

345 
	gchunk
.
»size
(0);

346 
	gÜig_key
 = 
B¿ssPo¡Li¡TabË
::
make_key
(
Šame
, 
fœ¡_did
);

348 
·ck_ušt
(
chunk
, 
did
 - 
cu¼’t_did
 - 1);

351 
	gcu¼’t_did
 = 
did
;

352 
·ck_ušt
(
chunk
, 
wdf
);

357 
šlše
 
¡ršg


358 
make_¡¬t_of_fœ¡_chunk
(
X­Ÿn
::
doccouÁ
 
’Œ›s
,

359 
X­Ÿn
::
‹rmcouÁ
 
cŞËùiÚäeq
,

360 
X­Ÿn
::
docid
 
Ãw_did
)

362 
¡ršg
 
chunk
;

363 
·ck_ušt
(
chunk
, 
’Œ›s
);

364 
·ck_ušt
(
chunk
, 
cŞËùiÚäeq
);

365 
·ck_ušt
(
chunk
, 
Ãw_did
 - 1);

366  
	gchunk
;

371 
šlše
 
¡ršg


372 
make_¡¬t_of_chunk
(
boŞ
 
Ãw_is_Ï¡_chunk
,

373 
X­Ÿn
::
docid
 
Ãw_fœ¡_did
,

374 
X­Ÿn
::
docid
 
Ãw_fš®_did
)

376 
As£¹
(
Ãw_fš®_did
 >ğ
Ãw_fœ¡_did
);

377 
¡ršg
 
	gchunk
;

378 
·ck_boŞ
(
chunk
, 
Ãw_is_Ï¡_chunk
);

379 
·ck_ušt
(
chunk
, 
Ãw_fš®_did
 - 
Ãw_fœ¡_did
);

380  
	gchunk
;

384 
wr™e_¡¬t_of_chunk
(
¡ršg
 & 
chunk
,

385 
¡¬t_of_chunk_h—d”
,

386 
’d_of_chunk_h—d”
,

387 
boŞ
 
is_Ï¡_chunk
,

388 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
,

389 
X­Ÿn
::
docid
 
Ï¡_did_š_chunk
)

391 
As£¹
((
size_t
)(
’d_of_chunk_h—d”
 - 
¡¬t_of_chunk_h—d”
è<ğ
chunk
.
size
());

393 
	gchunk
.
»¶aû
(
¡¬t_of_chunk_h—d”
,

394 
’d_of_chunk_h—d”
 - 
¡¬t_of_chunk_h—d”
,

395 
make_¡¬t_of_chunk
(
is_Ï¡_chunk
, 
fœ¡_did_š_chunk
,

396 
Ï¡_did_š_chunk
));

400 
	gPo¡li¡ChunkWr™”
::
	$æush
(
B¿ssTabË
 *
bË
)

402 
	`DEBUGCALL
(
DB
, , "Po¡li¡ChunkWr™”::æush", 
bË
);

412 ià(!
¡¬‹d
) {

421 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): deleting chunk");

422 
	`As£¹
(!
Üig_key
.
	`em±y
());

423 ià(
is_fœ¡_chunk
) {

424 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): deleting first chunk");

425 ià(
is_Ï¡_chunk
) {

429 
bË
->
	`d–
(
Üig_key
);

438 
AutoPŒ
<
B¿ssCursÜ
> 
	`cursÜ
(
bË
->
	`cursÜ_g‘
());

440 ià(!
cursÜ
->
	`fšd_’Œy
(
Üig_key
)) {

441 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("The key we're working on has disappeared");

453 
X­Ÿn
::
doccouÁ
 
num_’t
;

454 
X­Ÿn
::
‹rmcouÁ
 
cŞl_äeq
;

456 
cursÜ
->
	`»ad_g
();

457 cÚ¡ *
gpos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

458 cÚ¡ *
g’d
 = 
gpos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

460 ()
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

461 &
num_’t
, &
cŞl_äeq
);

465 
cursÜ
->
	`Ãxt
();

466 ià(
cursÜ
->
	`aá”_’d
()) {

467 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Expected‡nother key but found‚one");

469 cÚ¡ *
kpos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

470 cÚ¡ *
k’d
 = 
kpos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

471 ià(!
	`check_Šame_š_key
(&
kpos
, 
k’d
, 
Šame
)) {

472 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Expected‡nother key withhe sameerm‚ame but found‡ different one");

476 
X­Ÿn
::
docid
 
Ãw_fœ¡_did
;

477 ià(!
	`uÅack_ušt_´e£rvšg_sÜt
(&
kpos
, 
k’d
, &
Ãw_fœ¡_did
)) {

478 
	`»pÜt_»ad_”rÜ
(
kpos
);

481 
cursÜ
->
	`»ad_g
();

482 cÚ¡ *
gpos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

483 cÚ¡ *
g’d
 = 
gpos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

486 
boŞ
 
Ãw_is_Ï¡_chunk
;

487 
X­Ÿn
::
docid
 
Ãw_Ï¡_did_š_chunk
 =

488 
	`»ad_¡¬t_of_chunk
(&
gpos
, 
g’d
, 
Ãw_fœ¡_did
,

489 &
Ãw_is_Ï¡_chunk
);

491 
¡ršg
 
	`chunk_d©a
(
gpos
, 
g’d
);

494 
bË
->
	`d–
(
cursÜ
->
cu¼’t_key
);

497 
¡ršg
 
g
;

498 
g
 = 
	`make_¡¬t_of_fœ¡_chunk
(
num_’t
, 
cŞl_äeq
, 
Ãw_fœ¡_did
);

499 
g
 +ğ
	`make_¡¬t_of_chunk
(
Ãw_is_Ï¡_chunk
,

500 
Ãw_fœ¡_did
,

501 
Ãw_Ï¡_did_š_chunk
);

502 
g
 +ğ
chunk_d©a
;

503 
bË
->
	`add
(
Üig_key
, 
g
);

507 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): deleting secondary chunk");

511 
bË
->
	`d–
(
Üig_key
);

513 ià(
is_Ï¡_chunk
) {

514 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): deleting secondary†ast chunk");

516 
AutoPŒ
<
B¿ssCursÜ
> 
	`cursÜ
(
bË
->
	`cursÜ_g‘
());

520 ià(
cursÜ
->
	`fšd_’Œy
(
Üig_key
)) {

521 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Brass key‚ot deleted‡s weƒxpected");

524 cÚ¡ * 
keypos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

525 cÚ¡ * 
key’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

526 ià(!
	`check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

527 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Couldn't find chunk before delete chunk");

530 
boŞ
 
is_´ev_fœ¡_chunk
 = (
keypos
 =ğ
key’d
);

533 
cursÜ
->
	`»ad_g
();

534 
¡ršg
 
g
 = 
cursÜ
->
cu¼’t_g
;

536 cÚ¡ *
gpos
 = 
g
.
	`d©a
();

537 cÚ¡ *
g’d
 = 
gpos
 + 
g
.
	`size
();

540 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

541 ià(
is_´ev_fœ¡_chunk
) {

542 
fœ¡_did_š_chunk
 = 
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

545 ià(!
	`uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
fœ¡_did_š_chunk
))

546 
	`»pÜt_»ad_”rÜ
(
keypos
);

548 
boŞ
 
wrÚg_is_Ï¡_chunk
;

549 
¡ršg
::
size_ty³
 
¡¬t_of_chunk_h—d”
 = 
gpos
 - 
g
.
	`d©a
();

550 
X­Ÿn
::
docid
 
Ï¡_did_š_chunk
 =

551 
	`»ad_¡¬t_of_chunk
(&
gpos
, 
g’d
, 
fœ¡_did_š_chunk
,

552 &
wrÚg_is_Ï¡_chunk
);

553 
¡ršg
::
size_ty³
 
’d_of_chunk_h—d”
 = 
gpos
 - 
g
.
	`d©a
();

556 
	`wr™e_¡¬t_of_chunk
(
g
,

557 
¡¬t_of_chunk_h—d”
,

558 
’d_of_chunk_h—d”
,

559 
Œue
,

560 
fœ¡_did_š_chunk
,

561 
Ï¡_did_š_chunk
);

562 
bË
->
	`add
(
cursÜ
->
cu¼’t_key
, 
g
);

565 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): updating chunk which still has items in it");

572 
¡ršg
 
g
;

577 ià(
is_fœ¡_chunk
) {

581 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush():„ewritinghe first chunk, which still has items in it");

582 
¡ršg
 
key
 = 
B¿ssPo¡Li¡TabË
::
	`make_key
(
Šame
);

583 
boŞ
 
ok
 = 
bË
->
	`g‘_exaù_’Œy
(
key
, 
g
);

584 ()
ok
;

585 
	`As£¹
(
ok
);

586 
	`As£¹
(!
g
.
	`em±y
());

588 
X­Ÿn
::
doccouÁ
 
num_’t
;

589 
X­Ÿn
::
‹rmcouÁ
 
cŞl_äeq
;

591 cÚ¡ * 
gpos
 = 
g
.
	`d©a
();

592 cÚ¡ * 
g’d
 = 
gpos
 + 
g
.
	`size
();

593 ()
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

594 &
num_’t
, &
cŞl_äeq
);

597 
g
 = 
	`make_¡¬t_of_fœ¡_chunk
(
num_’t
, 
cŞl_äeq
, 
fœ¡_did
);

599 
g
 +ğ
	`make_¡¬t_of_chunk
(
is_Ï¡_chunk
, 
fœ¡_did
, 
cu¼’t_did
);

600 
g
 +ğ
chunk
;

601 
bË
->
	`add
(
key
, 
g
);

605 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): updating secondary chunk which still has items in it");

617 cÚ¡ *
keypos
 = 
Üig_key
.
	`d©a
();

618 cÚ¡ *
key’d
 = 
keypos
 + 
Üig_key
.
	`size
();

619 ià(!
	`check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

620 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Have invalid key writingo…ostlist");

622 
X­Ÿn
::
docid
 
š™Ÿl_did
;

623 ià(!
	`uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
š™Ÿl_did
)) {

624 
	`»pÜt_»ad_”rÜ
(
keypos
);

626 
¡ršg
 
Ãw_key
;

627 ià(
š™Ÿl_did
 !ğ
fœ¡_did
) {

632 
Ãw_key
 = 
B¿ssPo¡Li¡TabË
::
	`make_key
(
Šame
, 
fœ¡_did
);

633 
bË
->
	`d–
(
Üig_key
);

635 
Ãw_key
 = 
Üig_key
;

639 
g
 = 
	`make_¡¬t_of_chunk
(
is_Ï¡_chunk
, 
fœ¡_did
, 
cu¼’t_did
);

641 
g
 +ğ
chunk
;

642 
bË
->
	`add
(
Ãw_key
, 
g
);

644 
	}
}

650 
	gB¿ssPo¡Li¡
::
»ad_numb”_of_’Œ›s
(cÚ¡ ** 
po¥Œ
,

651 cÚ¡ * 
’d
,

652 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

653 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
)

655 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, 
numb”_of_’Œ›s_±r
))

656 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

657 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, 
cŞËùiÚ_äeq_±r
))

658 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

680 
	gB¿ssPo¡Li¡
::
B¿ssPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
this_db_
,

681 cÚ¡ 
¡ršg
 & 
‹rm_
,

682 
boŞ
 
k“p_»ã»nû
)

683 : 
L—fPo¡Li¡
(
‹rm_
),

684 
this_db
(
k“p_»ã»nû
 ? 
this_db_
 : 
NULL
),

685 
have_¡¬‹d
(
çl£
),

686 
cursÜ
(
this_db_
->
po¡li¡_bË
.
cursÜ_g‘
()),

687 
	$is_©_’d
(
çl£
)

689 
	`DEBUGCALL
(
DB
, , "BrassPostList::BrassPostList",

690 
this_db_
.
	`g‘
(è<< ", " << 
‹rm_
 << ", " << 
k“p_»ã»nû
);

691 
¡ršg
 
key
 = 
B¿ssPo¡Li¡TabË
::
	`make_key
(
‹rm
);

692 
found
 = 
cursÜ
->
	`fšd_’Œy
(
key
);

693 ià(!
found
) {

694 
	`LOGLINE
(
DB
, "postlist forerm‚ot found");

695 
numb”_of_’Œ›s
 = 0;

696 
is_©_’d
 = 
Œue
;

697 
pos
 = 0;

698 
’d
 = 0;

699 
fœ¡_did_š_chunk
 = 0;

700 
Ï¡_did_š_chunk
 = 0;

703 
cursÜ
->
	`»ad_g
();

704 
pos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

705 
’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

707 
did
 = 
	`»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, &
numb”_of_’Œ›s
, 
NULL
);

708 
fœ¡_did_š_chunk
 = 
did
;

709 
Ï¡_did_š_chunk
 = 
	`»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

710 &
is_Ï¡_chunk
);

711 
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

712 
	`LOGLINE
(
DB
, "In™ŸÈdocid " << 
did
);

713 
	}
}

715 
	gB¿ssPo¡Li¡
::~
	$B¿ssPo¡Li¡
()

717 
	`DEBUGCALL
(
DB
, , "BrassPostList::~BrassPostList", "");

718 
	}
}

720 
	gX­Ÿn
::
‹rmcouÁ


721 
B¿ssPo¡Li¡
::
	$g‘_doş’gth
() const

723 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassPostList::get_doclength", "");

724 
	`As£¹
(
have_¡¬‹d
);

725 
	`As£¹
(
this_db
.
	`g‘
());

726 
	`RETURN
(
this_db
->
	`g‘_doş’gth
(
did
));

727 
	}
}

729 
boŞ


730 
	gB¿ssPo¡Li¡
::
	$Ãxt_š_chunk
()

732 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassPostList::next_in_chunk", "");

733 ià(
pos
 =ğ
’d
è
	`RETURN
(
çl£
);

735 
	`»ad_did_šü—£
(&
pos
, 
’d
, &
did
);

736 
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

739 
	`As£¹
(
did
 <ğ
Ï¡_did_š_chunk
);

740 
	`As£¹
(
did
 < 
Ï¡_did_š_chunk
 || 
pos
 =ğ
’d
);

741 
	`As£¹
(
pos
 !ğ
’d
 || 
did
 =ğ
Ï¡_did_š_chunk
);

743 
	`RETURN
(
Œue
);

744 
	}
}

747 
	gB¿ssPo¡Li¡
::
	$Ãxt_chunk
()

749 
	`DEBUGCALL
(
DB
, , "BrassPostList::next_chunk", "");

750 ià(
is_Ï¡_chunk
) {

751 
is_©_’d
 = 
Œue
;

755 
cursÜ
->
	`Ãxt
();

756 ià(
cursÜ
->
	`aá”_’d
()) {

757 
is_©_’d
 = 
Œue
;

758 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Unexpectedƒnd of…osting†ist for `" +

759 
‹rm
 + "'");

761 cÚ¡ * 
keypos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

762 cÚ¡ * 
key’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

764 ià(!
	`check_Šame_š_key_l™e
(&
keypos
, 
key’d
, 
‹rm
)) {

765 
is_©_’d
 = 
Œue
;

766 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Unexpectedƒnd of…osting†ist for `" +

767 
‹rm
 + "'");

770 
X­Ÿn
::
docid
 
Ãwdid
;

771 ià(!
	`uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
Ãwdid
)) {

772 
	`»pÜt_»ad_”rÜ
(
keypos
);

774 ià(
Ãwdid
 <ğ
did
) {

775 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Document ID in‚ew chunk of…ostlist (" +

776 
	`om_to¡ršg
(
Ãwdid
) +

778 
	`om_to¡ršg
(
did
) + ")");

780 
did
 = 
Ãwdid
;

782 
cursÜ
->
	`»ad_g
();

783 
pos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

784 
’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

786 
fœ¡_did_š_chunk
 = 
did
;

787 
Ï¡_did_š_chunk
 = 
	`»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

788 &
is_Ï¡_chunk
);

789 
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

790 
	}
}

792 
Pos™iÚLi¡
 *

793 
	gB¿ssPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

795 
	`DEBUGCALL
(
DB
, 
Pos™iÚLi¡
 *, "BrassPostList::read_position_list", "");

796 
	`As£¹
(
this_db
.
	`g‘
());

797 
pos™iÚli¡
.
	`»ad_d©a
(&
this_db
->
pos™iÚ_bË
, 
did
, 
‹rm
);

798 
	`RETURN
(&
pos™iÚli¡
);

799 
	}
}

801 
Pos™iÚLi¡
 *

802 
	gB¿ssPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

804 
	`DEBUGCALL
(
DB
, 
Pos™iÚLi¡
 *, "BrassPostList::open_position_list", "");

805 
	`As£¹
(
this_db
.
	`g‘
());

806 
	`RETURN
(
Ãw
 
	`B¿ssPos™iÚLi¡
(&
this_db
->
pos™iÚ_bË
, 
did
, 
‹rm
));

807 
	}
}

809 
Po¡Li¡
 *

810 
	gB¿ssPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

812 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *, "B¿ssPo¡Li¡::Ãxt", 
w_mš
);

813 ()
	gw_mš
;

815 ià(!
	ghave_¡¬‹d
) {

816 
	ghave_¡¬‹d
 = 
Œue
;

818 ià(!
Ãxt_š_chunk
()è
Ãxt_chunk
();

821 ià(
	gis_©_’d
) {

822 
LOGLINE
(
DB
, "Movedoƒnd");

824 
LOGLINE
(
DB
, "MovedØdocid " << 
did
 << ", wdàğ" << 
wdf
);

827 
RETURN
(
NULL
);

830 
boŞ


831 
	gB¿ssPo¡Li¡
::
cu¼’t_chunk_cÚšs
(
X­Ÿn
::
docid
 
desœed_did
)

833 
DEBUGCALL
(
DB
, 
boŞ
, "B¿ssPo¡Li¡::cu¼’t_chunk_cÚšs", 
desœed_did
);

834 ià(
	gdesœed_did
 >ğ
fœ¡_did_š_chunk
 &&

835 
desœed_did
 <ğ
Ï¡_did_š_chunk
) {

836 
RETURN
(
Œue
);

838 
RETURN
(
çl£
);

842 
	gB¿ssPo¡Li¡
::
move_to_chunk_cÚššg
(
X­Ÿn
::
docid
 
desœed_did
)

844 
DEBUGCALL
(
DB
, ,

845 "B¿ssPo¡Li¡::move_to_chunk_cÚššg", 
desœed_did
);

846 ()
	gcursÜ
->
fšd_’Œy
(
B¿ssPo¡Li¡TabË
::
make_key
(
‹rm
, 
desœed_did
));

847 
As£¹
(!
cursÜ
->
aá”_’d
());

849 cÚ¡ * 
	gkeypos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

850 cÚ¡ * 
	gkey’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
size
();

852 ià(!
check_Šame_š_key_l™e
(&
keypos
, 
key’d
, 
‹rm
)) {

854 
	gis_©_’d
 = 
Œue
;

855 
	gis_Ï¡_chunk
 = 
Œue
;

858 
	gis_©_’d
 = 
çl£
;

860 
	gcursÜ
->
»ad_g
();

861 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

862 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

864 ià(
	gkeypos
 =ğ
key’d
) {

866 #ifdeà
XAPIAN_ASSERTIONS


867 
X­Ÿn
::
doccouÁ
 
Şd_numb”_of_’Œ›s
 = 
numb”_of_’Œ›s
;

868 
	gdid
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, &
numb”_of_’Œ›s
, 
NULL
);

869 
As£¹
(
Şd_numb”_of_’Œ›s
 =ğ
numb”_of_’Œ›s
);

871 
	gdid
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, 
NULL
, NULL);

875 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
did
)) {

876 
»pÜt_»ad_”rÜ
(
keypos
);

880 
	gfœ¡_did_š_chunk
 = 
did
;

881 
	gÏ¡_did_š_chunk
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

882 &
is_Ï¡_chunk
);

883 
»ad_wdf
(&
pos
, 
’d
, &
wdf
);

887 ià(
	gdesœed_did
 > 
	gÏ¡_did_š_chunk
è
Ãxt_chunk
();

890 
boŞ


891 
	gB¿ssPo¡Li¡
::
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
X­Ÿn
::
docid
 
desœed_did
)

893 
DEBUGCALL
(
DB
, 
boŞ
,

894 "B¿ssPo¡Li¡::move_fÜw¬d_š_chunk_to_©_Ëa¡", 
desœed_did
);

895 ià(
	gdid
 >ğ
desœed_did
)

896 
RETURN
(
Œue
);

898 ià(
	gdesœed_did
 <ğ
Ï¡_did_š_chunk
) {

899 
pos
 !ğ
’d
) {

900 
»ad_did_šü—£
(&
pos
, 
’d
, &
did
);

901 ià(
	gdid
 >ğ
desœed_did
) {

902 
»ad_wdf
(&
pos
, 
’d
, &
wdf
);

903 
RETURN
(
Œue
);

906 
»ad_wdf
(&
pos
, 
’d
, 
NULL
);

910 
As£¹
(
çl£
);

913 
	gpos
 = 
’d
;

914 
RETURN
(
çl£
);

917 
Po¡Li¡
 *

918 
	gB¿ssPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
)

920 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *,

921 "B¿ssPo¡Li¡::sk_to", 
desœed_did
 << ", " << 
w_mš
);

922 ()
	gw_mš
;

925 
	ghave_¡¬‹d
 = 
Œue
;

928 ià(
	gis_©_’d
 || 
	gdesœed_did
 <ğ
did
è
RETURN
(
NULL
);

931 ià(!
cu¼’t_chunk_cÚšs
(
desœed_did
)) {

932 
move_to_chunk_cÚššg
(
desœed_did
);

935 ià(
	gis_©_’d
è
RETURN
(
NULL
);

939 
boŞ
 
	ghave_docum’t
 = 
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
desœed_did
);

940 ()
	ghave_docum’t
;

941 
As£¹
(
have_docum’t
);

943 ià(
	gis_©_’d
) {

944 
LOGLINE
(
DB
, "Skippedoƒnd");

946 
LOGLINE
(
DB
, "Sk³dØdocid " << 
did
 << ", wdàğ" << 
wdf
);

949 
RETURN
(
NULL
);

953 
boŞ


954 
	gB¿ssPo¡Li¡
::
jump_to
(
X­Ÿn
::
docid
 
desœed_did
)

956 
DEBUGCALL
(
DB
, 
boŞ
, "B¿ssPo¡Li¡::jump_to", 
desœed_did
);

959 
	ghave_¡¬‹d
 = 
Œue
;

962 ià(
	gpos
 =ğ0è
RETURN
(
çl£
);

967 ià(
	gis_©_’d
 || !
cu¼’t_chunk_cÚšs
(
desœed_did
è|| 
	gdesœed_did
 < 
	gdid
) {

969 
	gis_©_’d
 = 
çl£
;

971 
move_to_chunk_cÚššg
(
desœed_did
);

974 ià(
	gis_©_’d
è
RETURN
(
çl£
);

978 ià(!
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
desœed_did
)è
RETURN
(
çl£
);

979 
RETURN
(
desœed_did
 =ğ
did
);

982 
¡ršg


983 
	gB¿ssPo¡Li¡
::
	$g‘_desütiÚ
() const

985  
‹rm
 + ":" + 
	`om_to¡ršg
(
numb”_of_’Œ›s
);

986 
	}
}

989 
	gX­Ÿn
::
docid


990 
B¿ssPo¡Li¡TabË
::
g‘_chunk
(cÚ¡ 
¡ršg
 &
Šame
,

991 
X­Ÿn
::
docid
 
did
, 
boŞ
 
addšg
,

992 
Po¡li¡ChunkR—d”
 ** 
äom
, 
Po¡li¡ChunkWr™”
 **
to
)

994 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "B¿ssPo¡Li¡TabË::g‘_chunk", 
Šame
 << ", " << 
did
 << ", " << 
addšg
 << ", [from], [to]");

996 
¡ršg
 
	gkey
 = 
make_key
(
Šame
, 
did
);

999 
	gAutoPŒ
<
	gB¿ssCursÜ
> 
cursÜ
(
cursÜ_g‘
());

1001 ()
	gcursÜ
->
fšd_’Œy
(
key
);

1002 
As£¹
(!
cursÜ
->
aá”_’d
());

1004 cÚ¡ * 
	gkeypos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

1005 cÚ¡ * 
	gkey’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
size
();

1007 ià(!
check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

1012 ià(!
	gaddšg
)

1013 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("A‰em±edØd–‘Ü modify‡À’Œy iÀ¨nÚ-exi¡’ˆpo¡šg†i¡ fÜ " + 
Šame
);

1015 *
	gäom
 = 
NULL
;

1016 *
	gto
 = 
Ãw
 
Po¡li¡ChunkWr™”
(
¡ršg
(), 
Œue
, 
Šame
,rue);

1017 
RETURN
(
X­Ÿn
::
docid
(-1));

1022 
boŞ
 
	gis_fœ¡_chunk
 = (
keypos
 =ğ
key’d
);

1023 
LOGVALUE
(
DB
, 
is_fœ¡_chunk
);

1025 
	gcursÜ
->
»ad_g
();

1026 cÚ¡ * 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

1027 cÚ¡ * 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

1028 
	gX­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

1029 ià(
	gis_fœ¡_chunk
) {

1030 
	gfœ¡_did_š_chunk
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, 
NULL
, NULL);

1032 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
fœ¡_did_š_chunk
)) {

1033 
»pÜt_»ad_”rÜ
(
keypos
);

1037 
boŞ
 
	gis_Ï¡_chunk
;

1038 
	gX­Ÿn
::
docid
 
Ï¡_did_š_chunk
;

1039 
	gÏ¡_did_š_chunk
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
, &
is_Ï¡_chunk
);

1040 *
	gto
 = 
Ãw
 
Po¡li¡ChunkWr™”
(
cursÜ
->
cu¼’t_key
, 
is_fœ¡_chunk
, 
Šame
,

1041 
is_Ï¡_chunk
);

1042 ià(
	gdid
 > 
	gÏ¡_did_š_chunk
) {

1046 *
	gäom
 = 
NULL
;

1047 (*
	gto
)->
¿w_­³nd
(
fœ¡_did_š_chunk
, 
Ï¡_did_š_chunk
,

1048 
¡ršg
(
pos
, 
’d
));

1050 *
	gäom
 = 
Ãw
 
Po¡li¡ChunkR—d”
(
fœ¡_did_š_chunk
, 
¡ršg
(
pos
, 
’d
));

1052 ià(
	gis_Ï¡_chunk
è
RETURN
(
X­Ÿn
::
docid
(-1));

1055 
	gcursÜ
->
Ãxt
();

1056 ià(
	gcursÜ
->
aá”_’d
()) {

1057 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Expected‡nother key but found‚one");

1059 cÚ¡ *
	gkpos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

1060 cÚ¡ *
	gk’d
 = 
kpos
 + 
cursÜ
->
cu¼’t_key
.
size
();

1061 ià(!
check_Šame_š_key
(&
kpos
, 
k’d
, 
Šame
)) {

1062 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Expected‡nother key withhe sameerm‚ame but found‡ different one");

1066 
	gX­Ÿn
::
docid
 
fœ¡_did_of_Ãxt_chunk
;

1067 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
kpos
, 
k’d
, &
fœ¡_did_of_Ãxt_chunk
)) {

1068 
»pÜt_»ad_”rÜ
(
kpos
);

1070 
RETURN
(
fœ¡_did_of_Ãxt_chunk
 - 1);

1074 
	gB¿ssPo¡Li¡TabË
::
m”ge_doş’_chªges
(cÚ¡ 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> & 
doş’s
)

1076 
DEBUGCALL
(
DB
, , "BrassPostListTable::merge_doclen_changes", "doclens");

1079 
	gdoş’_¶
.
»£t
(0);

1081 
LOGVALUE
(
DB
, 
doş’s
.
size
());

1082 ià(
	gdoş’s
.
em±y
()) ;

1085 
¡ršg
 
	gcu¼’t_key
 = 
make_key
(string());

1086 ià(!
key_exi¡s
(
cu¼’t_key
)) {

1087 
LOGLINE
(
DB
, "Adding dummy first chunk");

1088 
¡ršg
 
	gÃwg
 = 
make_¡¬t_of_fœ¡_chunk
(0, 0, 0);

1089 
	gÃwg
 +ğ
make_¡¬t_of_chunk
(
Œue
, 0, 0);

1090 
add
(
cu¼’t_key
, 
Ãwg
);

1093 
	gm­
<
	gX­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
j
;

1094 
	gj
 = 
doş’s
.
begš
();

1095 
As£¹
(
j
 !ğ
doş’s
.
’d
());

1097 
	gX­Ÿn
::
docid
 
max_did
;

1098 
Po¡li¡ChunkR—d”
 *
	gäom
;

1099 
Po¡li¡ChunkWr™”
 *
	gto
;

1100 
	gmax_did
 = 
g‘_chunk
(
¡ršg
(), 
j
->
fœ¡
, 
Œue
, &
äom
, &
to
);

1101 
LOGVALUE
(
DB
, 
max_did
);

1102  ; 
	gj
 !ğ
doş’s
.
’d
(); ++j) {

1103 
	gX­Ÿn
::
docid
 
did
 = 
j
->
fœ¡
;

1105 
	gÃxt_doş’_chunk
:

1106 
LOGLINE
(
DB
, "Upd©šg doş’s, did=" << 
did
);

1107 ià(
	gäom
è!äom->
is_©_’d
()) {

1108 
	gX­Ÿn
::
docid
 
cİy_did
 = 
äom
->
g‘_docid
();

1109 ià(
	gcİy_did
 >ğ
did
) {

1110 ià(
cİy_did
 =ğ
did
è
äom
->
Ãxt
();

1113 
	gto
->
­³nd
(
this
, 
cİy_did
, 
äom
->
g‘_wdf
());

1114 
	gäom
->
Ãxt
();

1116 ià((!
	gäom
 || from->
is_©_’d
()è&& 
	gdid
 > 
	gmax_did
) {

1117 
d–‘e
 
	gäom
;

1118 
	gto
->
æush
(
this
);

1119 
d–‘e
 
	gto
;

1120 
	gmax_did
 = 
g‘_chunk
(
¡ršg
(), 
did
, 
çl£
, &
äom
, &
to
);

1121 
	gÃxt_doş’_chunk
;

1124 
	gX­Ÿn
::
‹rmcouÁ
 
Ãw_doş’
 = 
j
->
£cÚd
;

1125 ià(
	gÃw_doş’
 !ğ
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(-1)) {

1126 
to
->
­³nd
(
this
, 
did
, 
Ãw_doş’
);

1130 ià(
	gäom
) {

1131 !
	gäom
->
is_©_’d
()) {

1132 
	gto
->
­³nd
(
this
, 
äom
->
g‘_docid
(), from->
g‘_wdf
());

1133 
	gäom
->
Ãxt
();

1135 
d–‘e
 
	gäom
;

1137 
	gto
->
æush
(
this
);

1138 
d–‘e
 
	gto
;

1142 
	gB¿ssPo¡Li¡TabË
::
m”ge_chªges
(cÚ¡ 
¡ršg
 &
‹rm
,

1143 cÚ¡ 
Inv”‹r
::
Po¡šgChªges
 & 
chªges
)

1148 
¡ršg
 
cu¼’t_key
 = 
make_key
(
‹rm
);

1149 
¡ršg
 
	gg
;

1150 ()
g‘_exaù_’Œy
(
cu¼’t_key
, 
g
);

1153 cÚ¡ *
	gpos
 = 
g
.
d©a
();

1154 cÚ¡ *
	g’d
 = 
pos
 + 
g
.
size
();

1155 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq
;

1156 
	gX­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

1157 
	gX­Ÿn
::
docid
 
fœ¡did
, 
	gÏ¡did
;

1158 
boŞ
 
	gi¦a¡
;

1159 ià(
	gpos
 =ğ
’d
) {

1160 
‹rmäeq
 = 0;

1161 
	gcŞläeq
 = 0;

1162 
	gfœ¡did
 = 0;

1163 
	gÏ¡did
 = 0;

1164 
	gi¦a¡
 = 
Œue
;

1166 
	gfœ¡did
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
,

1167 &
‹rmäeq
, &
cŞläeq
);

1169 
	gÏ¡did
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡did
, &
i¦a¡
);

1172 
	g‹rmäeq
 +ğ
chªges
.
g‘_tfd–
();

1173 ià(
	g‹rmäeq
 == 0) {

1176 ià(
i¦a¡
) {

1178 
d–
(
cu¼’t_key
);

1181 
MubËB¿ssCursÜ
 
cursÜ
(
this
);

1182 
boŞ
 
	gfound
 = 
cursÜ
.
fšd_’Œy
(
cu¼’t_key
);

1183 
As£¹
(
found
);

1184 ià(!
	gfound
) ;

1185 
	gcursÜ
.
d–
()) {

1186 cÚ¡ *
	gkpos
 = 
cursÜ
.
cu¼’t_key
.
d©a
();

1187 cÚ¡ *
	gk’d
 = 
kpos
 + 
cursÜ
.
cu¼’t_key
.
size
();

1188 ià(!
check_Šame_š_key_l™e
(&
kpos
, 
k’d
, 
‹rm
)) ;

1192 
	gcŞläeq
 +ğ
chªges
.
g‘_cfd–
();

1195 
¡ršg
 
	gÃwhdr
 = 
make_¡¬t_of_fœ¡_chunk
(
‹rmäeq
, 
cŞläeq
, 
fœ¡did
);

1196 
	gÃwhdr
 +ğ
make_¡¬t_of_chunk
(
i¦a¡
, 
fœ¡did
, 
Ï¡did
);

1197 ià(
	gpos
 =ğ
’d
) {

1198 
add
(
cu¼’t_key
, 
Ãwhdr
);

1200 
As£¹
((
size_t
)(
pos
 - 
g
.
d©a
()è<ğg.
size
());

1201 
	gg
.
»¶aû
(0, 
pos
 - 
g
.
d©a
(), 
Ãwhdr
);

1202 
add
(
cu¼’t_key
, 
g
);

1205 
	gm­
<
	gX­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
j
;

1206 
	gj
 = 
chªges
.
¶_chªges
.
begš
();

1207 
As£¹
(
j
 !ğ
chªges
.
¶_chªges
.
’d
());

1209 
	gX­Ÿn
::
docid
 
max_did
;

1210 
Po¡li¡ChunkR—d”
 *
	gäom
;

1211 
Po¡li¡ChunkWr™”
 *
	gto
;

1212 
	gmax_did
 = 
g‘_chunk
(
‹rm
, 
j
->
fœ¡
, 
çl£
, &
äom
, &
to
);

1213  ; 
	gj
 !ğ
chªges
.
¶_chªges
.
’d
(); ++j) {

1214 
	gX­Ÿn
::
docid
 
did
 = 
j
->
fœ¡
;

1216 
	gÃxt_chunk
:

1217 
LOGLINE
(
DB
, "Upd©šg”m=" << 
‹rm
 << ", did=" << 
did
);

1218 ià(
	gäom
è!äom->
is_©_’d
()) {

1219 
	gX­Ÿn
::
docid
 
cİy_did
 = 
äom
->
g‘_docid
();

1220 ià(
	gcİy_did
 >ğ
did
) {

1221 ià(
cİy_did
 =ğ
did
) {

1222 
äom
->
Ãxt
();

1226 
	gto
->
­³nd
(
this
, 
cİy_did
, 
äom
->
g‘_wdf
());

1227 
	gäom
->
Ãxt
();

1229 ià((!
	gäom
 || from->
is_©_’d
()è&& 
	gdid
 > 
	gmax_did
) {

1230 
d–‘e
 
	gäom
;

1231 
	gto
->
æush
(
this
);

1232 
d–‘e
 
	gto
;

1233 
	gmax_did
 = 
g‘_chunk
(
‹rm
, 
did
, 
çl£
, &
äom
, &
to
);

1234 
	gÃxt_chunk
;

1237 
	gX­Ÿn
::
‹rmcouÁ
 
Ãw_wdf
 = 
j
->
£cÚd
;

1238 ià(
	gÃw_wdf
 !ğ
X­Ÿn
::
‹rmcouÁ
(-1)) {

1239 
to
->
­³nd
(
this
, 
did
, 
Ãw_wdf
);

1243 ià(
	gäom
) {

1244 !
	gäom
->
is_©_’d
()) {

1245 
	gto
->
­³nd
(
this
, 
äom
->
g‘_docid
(), from->
g‘_wdf
());

1246 
	gäom
->
Ãxt
();

1248 
d–‘e
 
	gäom
;

1250 
	gto
->
æush
(
this
);

1251 
d–‘e
 
	gto
;

	@backends/brass/brass_postlist.h

24 #iâdeà
OM_HGUARD_BRASS_POSTLIST_H


25 
	#OM_HGUARD_BRASS_POSTLIST_H


	)

27 
	~<x­Ÿn/d©aba£.h
>

29 
	~"b¿ss_šv”‹r.h
"

30 
	~"b¿ss_ty³s.h
"

31 
	~"b¿ss_pos™iÚli¡.h
"

32 
	~"Ëaåo¡li¡.h
"

33 
	~"omas£¹.h
"

34 
	~"omdebug.h
"

36 
	~"autİŒ.h
"

37 
	~<m­
>

38 
	~<¡ršg
>

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
şass
 
	gB¿ssCursÜ
;

43 
şass
 
	gB¿ssD©aba£
;

45 
Çme¥aû
 
	gB¿ss
 {

46 
şass
 
	gPo¡li¡ChunkR—d”
;

47 
şass
 
	gPo¡li¡ChunkWr™”
;

49 
usšg
 
	gB¿ss
::
Po¡li¡ChunkR—d”
;

50 
usšg
 
	gB¿ss
::
Po¡li¡ChunkWr™”
;

52 
şass
 
	gB¿ssPo¡Li¡
;

54 şas 
	cB¿ssPo¡Li¡TabË
 : 
public
 
B¿ssTabË
 {

56 
mubË
 
AutoPŒ
<
B¿ssPo¡Li¡
> 
doş’_¶
;

58 
	mpublic
:

71 
	$B¿ssPo¡Li¡TabË
(cÚ¡ 
¡ršg
 & 
·th_
, 
boŞ
 
»adÚly_
)

72 : 
	`B¿ssTabË
("po¡li¡", 
·th_
 + "/po¡li¡.", 
»adÚly_
),

73 
	$doş’_¶
()

76 
boŞ
 
	$İ’
(
b¿ss_»visiÚ_numb”_t
 
»vno
) {

77 
doş’_¶
.
	`»£t
(0);

78  
B¿ssTabË
::
	`İ’
(
»vno
);

79 
	}
}

82 
m”ge_chªges
(cÚ¡ 
¡ršg
 &
‹rm
, cÚ¡ 
Inv”‹r
::
Po¡šgChªges
 & 
chªges
);

85 
m”ge_doş’_chªges
(cÚ¡ 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> & 
doş’s
);

87 
	gX­Ÿn
::
docid
 
g‘_chunk
(cÚ¡ 
¡ršg
 &
Šame
,

88 
X­Ÿn
::
docid
 
did
, 
boŞ
 
addšg
,

89 
Po¡li¡ChunkR—d”
 ** 
äom
, 
Po¡li¡ChunkWr™”
 **
to
);

92 
¡ršg
 
make_key
(cÚ¡ sŒšg & 
‹rm
, 
X­Ÿn
::
docid
 
did
) {

93  
·ck_b¿ss_po¡li¡_key
(
‹rm
, 
did
);

97 
¡ršg
 
	$make_key
(cÚ¡ 
¡ršg
 & 
‹rm
) {

98  
	`·ck_b¿ss_po¡li¡_key
(
‹rm
);

99 
	}
}

101 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
‹rm
) const {

102  
	`key_exi¡s
(
	`make_key
(
‹rm
));

103 
	}
}

109 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

115 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

118 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
,

119 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db
) const;

122 
boŞ
 
docum’t_exi¡s
(
X­Ÿn
::
docid
 
did
,

123 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db
) const;

128 şas 
	cB¿ssPo¡Li¡
 : 
public
 
L—fPo¡Li¡
 {

129 
´Ùeùed
:

134 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
this_db
;

137 
boŞ
 
	mhave_¡¬‹d
;

140 
B¿ssPos™iÚLi¡
 
	mpos™iÚli¡
;

142 
	m´iv©e
:

144 
AutoPŒ
<
B¿ssCursÜ
> 
cursÜ
;

147 
boŞ
 
	mis_Ï¡_chunk
;

150 
	mX­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

153 
	mX­Ÿn
::
docid
 
Ï¡_did_š_chunk
;

156 cÚ¡ * 
	mpos
;

159 cÚ¡ * 
	m’d
;

162 
	mX­Ÿn
::
docid
 
did
;

165 
	mX­Ÿn
::
‹rmcouÁ
 
wdf
;

168 
boŞ
 
	mis_©_’d
;

171 
	mX­Ÿn
::
doccouÁ
 
numb”_of_’Œ›s
;

174 
B¿ssPo¡Li¡
(const BrassPostList &);

177 
	mİ”©Ü
=(cÚ¡ 
B¿ssPo¡Li¡
 &);

182 
boŞ
 
Ãxt_š_chunk
();

189 
Ãxt_chunk
();

198 
boŞ
 
cu¼’t_chunk_cÚšs
(
X­Ÿn
::
docid
 
desœed_did
);

211 
move_to_chunk_cÚššg
(
X­Ÿn
::
docid
 
desœed_did
);

222 
boŞ
 
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
X­Ÿn
::
docid
 
desœed_did
);

224 
	mpublic
:

226 
B¿ssPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
this_db_
,

227 cÚ¡ 
¡ršg
 & 
‹rm
,

228 
boŞ
 
k“p_»ã»nû
);

231 ~
B¿ssPo¡Li¡
();

237 
boŞ
 
jump_to
(
X­Ÿn
::
docid
 
desœed_did
);

243 
	mX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(ècÚ¡ {  
numb”_of_’Œ›s
; }

246 
X­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ { 
	`As£¹
(
have_¡¬‹d
);  
did
; 
	}
}

249 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

254 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
(ècÚ¡ { 
	`As£¹
(
have_¡¬‹d
);  
wdf
; 
	}
}

258 
Pos™iÚLi¡
 *
»ad_pos™iÚ_li¡
();

262 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

265 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

268 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
);

271 
boŞ
 
	$©_’d
(ècÚ¡ {  
is_©_’d
; 
	}
}

274 
	g¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

277 
	`»ad_numb”_of_’Œ›s
(cÚ¡ ** 
po¥Œ
,

278 cÚ¡ * 
’d
,

279 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

280 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
);

281 
	}
};

	@backends/brass/brass_record.cc

22 
	~<cÚfig.h
>

24 
	~"b¿ss_»cÜd.h
"

26 
	~<x­Ÿn/”rÜ.h
>

27 
	~"omas£¹.h
"

28 
	~"omdebug.h
"

29 
	~"·ck.h
"

30 
	~"uts.h
"

32 
usšg
 
	g¡d
::
¡ršg
;

34 
šlše
 
¡ršg


35 
make_key
(
X­Ÿn
::
docid
 
did
)

37 
¡ršg
 
key
;

38 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

39  
	gkey
;

42 
¡ršg


43 
	gB¿ssRecÜdTabË
::
g‘_»cÜd
(
X­Ÿn
::
docid
 
did
) const

45 
DEBUGCALL
(
DB
, 
¡ršg
, "B¿ssRecÜdTabË::g‘_»cÜd", 
did
);

46 
¡ršg
 
	gg
;

48 ià(!
g‘_exaù_’Œy
(
make_key
(
did
), 
g
)) {

49 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Docum’ˆ" + 
om_to¡ršg
(
did
) + "‚ot found.");

52 
RETURN
(
g
);

55 
	gX­Ÿn
::
doccouÁ


56 
B¿ssRecÜdTabË
::
	$g‘_doccouÁ
() const

58 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "BrassRecordTable::get_doccount", "");

59 
b¿ss_bËsize_t
 
couÁ
 = 
	`g‘_’Œy_couÁ
();

60 ià(
	`¿»
(
couÁ
 > 
	`b¿ss_bËsize_t
(
X­Ÿn
::
	`doccouÁ
(-1)))) {

63 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Impossibly manyƒntries inhe„ecordable");

65 
	`RETURN
(
X­Ÿn
::
	`doccouÁ
(
couÁ
));

66 
	}
}

69 
	gB¿ssRecÜdTabË
::
»¶aû_»cÜd
(cÚ¡ 
¡ršg
 & 
d©a
, 
X­Ÿn
::
docid
 
did
)

71 
DEBUGCALL
(
DB
, , "B¿ssRecÜdTabË::»¶aû_»cÜd", 
d©a
 << ", " << 
did
);

72 
add
(
make_key
(
did
), 
d©a
);

76 
	gB¿ssRecÜdTabË
::
d–‘e_»cÜd
(
X­Ÿn
::
docid
 
did
)

78 
DEBUGCALL
(
DB
, , "B¿ssRecÜdTabË::d–‘e_»cÜd", 
did
);

79 ià(!
d–
(
make_key
(
did
)))

80 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Cª'ˆd–‘nÚ-exi¡’ˆdocum’ˆ#" + 
om_to¡ršg
(
did
));

	@backends/brass/brass_record.h

23 #iâdeà
OM_HGUARD_BRASS_RECORD_H


24 
	#OM_HGUARD_BRASS_RECORD_H


	)

26 
	~<¡ršg
>

28 
	~<x­Ÿn/ty³s.h
>

29 
	~"b¿ss_ty³s.h
"

30 
	~"b¿ss_bË.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

36 şas 
	cB¿ssRecÜdTabË
 : 
public
 
B¿ssTabË
 {

37 
public
:

50 
	$B¿ssRecÜdTabË
(cÚ¡ 
¡ršg
 & 
·th_
, 
boŞ
 
»adÚly_
)

51 : 
	`B¿ssTabË
("»cÜd", 
·th_
 + "/»cÜd.", 
»adÚly_
, 
Z_DEFAULT_STRATEGY
) { }

55 
¡ršg
 
	`g‘_»cÜd
(
X­Ÿn
::
docid
 
did
) const;

59 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

65 
	`»¶aû_»cÜd
(cÚ¡ 
¡ršg
 & 
d©a
, 
X­Ÿn
::
docid
 
did
);

69 
	`d–‘e_»cÜd
(
X­Ÿn
::
docid
 
did
);

70 
	}
};

	@backends/brass/brass_replicate_internal.h

23 #iâdeà
XAPIAN_INCLUDED_BRASS_REPLICATE_INTERNAL_H


24 
	#XAPIAN_INCLUDED_BRASS_REPLICATE_INTERNAL_H


	)

27 
	#CHANGES_MAGIC_STRING
 "B¿ssChªges"

	)

31 
	#CHANGES_VERSION
 1u

	)

35 
	#REASONABLE_CHANGESET_SIZE
 1024

	)

	@backends/brass/brass_spelling.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/”rÜ.h
>

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"ex·ndweight.h
"

27 
	~"b¿ss_¥–lšg.h
"

28 
	~"omas£¹.h
"

29 
	~"Ü‹rmli¡.h
"

30 
	~"·ck.h
"

32 
	~<®gÜ™hm
>

33 
	~<m­
>

34 
	~<queue
>

35 
	~<veùÜ
>

36 
	~<£t
>

37 
	~<¡ršg
>

39 
usšg
 
Çme¥aû
 
	gB¿ss
;

40 
usšg
 
Çme¥aû
 
	g¡d
;

46 
	#MAGIC_XOR_VALUE
 96

	)

48 şas 
	cP»fixCom´es£dSŒšgItÜ
 {

49 cÚ¡ * 
	mp
;

50 
size_t
 
	mËá
;

51 
¡ršg
 
	mcu¼’t
;

53 
	$P»fixCom´es£dSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
,

54 cÚ¡ 
¡ršg
 &
cu¼’t_
)

55 : 
	`p
(
p_
), 
	`Ëá
(
Ëá_
), 
	$cu¼’t
(
cu¼’t_
) { }

57 
public
:

58 
	`P»fixCom´es£dSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

59 : 
	`p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
	`d©a
())),

60 
	`Ëá
(
s
.
	$size
()) {

61 ià(
Ëá
) {

62 
İ”©Ü
++();

64 
p
 = 
NULL
;

66 
	}
}

68 cÚ¡ 
	g¡ršg
 & 
	gİ”©Ü
*() const {

69  
	gcu¼’t
;

72 
P»fixCom´es£dSŒšgItÜ
 
	gİ”©Ü
++() {

73 cÚ¡ * 
	gŞd_p
 = 
p
;

74 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

75 
¡ršg
 
	gŞd_cu¼’t
 = 
cu¼’t
;

76 
	gİ”©Ü
++();

77  
P»fixCom´es£dSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
, 
Şd_cu¼’t
);

80 
	gP»fixCom´es£dSŒšgItÜ
 & 
	gİ”©Ü
++() {

81 ià(
	gËá
 == 0) {

82 
p
 = 
NULL
;

84 ià(!
	gcu¼’t
.
em±y
()) {

85 
	gcu¼’t
.
»size
(*
p
++ ^ 
MAGIC_XOR_VALUE
);

86 --
	gËá
;

88 
size_t
 
	gadd
;

89 ià(
	gËá
 =ğ0 || (
add
 = *
p
 ^ 
MAGIC_XOR_VALUE
è>ğ
Ëá
)

90 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling data (too†ittle†eft)");

91 
	gcu¼’t
.
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
add
);

92 
	gp
 +ğ
add
 + 1;

93 
	gËá
 -ğ
add
 + 1;

95  *
	gthis
;

98 
boŞ
 
	$©_’d
() const {

99  
p
 =ğ
NULL
;

100 
	}
}

103 şas 
	cP»fixCom´es£dSŒšgWr™”
 {

104 
¡ršg
 
	mcu¼’t
;

105 
	m¡ršg
 & 
	mout
;

107 
	mpublic
:

108 
	$P»fixCom´es£dSŒšgWr™”
(
¡ršg
 & 
out_
è: 
	$out
(
out_
) { }

110 
	$­³nd
(cÚ¡ 
¡ršg
 & 
wÜd
) {

113 ià(!
cu¼’t
.
	`em±y
()) {

114 
size_t
 
Ën
 = 
	`mš
(
cu¼’t
.
	`size
(), 
wÜd
.size());

115 
size_t
 
i
;

116 
i
 = 0; i < 
Ën
; ++i) {

117 ià(
cu¼’t
[
i
] !ğ
wÜd
[i]) ;

119 
out
 +ğ(
i
 ^ 
MAGIC_XOR_VALUE
);

120 
out
 +ğ((
wÜd
.
	`size
(è- 
i
è^ 
MAGIC_XOR_VALUE
);

121 
out
.
	`­³nd
(
wÜd
.
	`d©a
(è+ 
i
, wÜd.
	`size
() - i);

123 
out
 +ğ(
wÜd
.
	`size
(è^ 
MAGIC_XOR_VALUE
);

124 
out
 +ğ
wÜd
;

126 
cu¼’t
 = 
wÜd
;

127 
	}
}

131 
	gB¿ssS³ÎšgTabË
::
	$m”ge_chªges
()

133 
m­
<
äagm’t
, 
£t
<
¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

134 
i
 = 
‹rmli¡_d–s
.
	`begš
(); i !ğ‹rmli¡_d–s.
	`’d
(); ++i) {

135 
¡ršg
 
key
 = 
i
->
fœ¡
;

136 cÚ¡ 
£t
<
¡ršg
> & 
chªges
 = 
i
->
£cÚd
;

138 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
d
 = 
chªges
.
	`begš
();

139 ià(
d
 =ğ
chªges
.
	`’d
()) ;

141 
¡ršg
 
upd©ed
;

142 
¡ršg
 
cu¼’t
;

143 
P»fixCom´es£dSŒšgWr™”
 
	`out
(
upd©ed
);

144 ià(
	`g‘_exaù_’Œy
(
key
, 
cu¼’t
)) {

145 
P»fixCom´es£dSŒšgItÜ
 
	`š
(
cu¼’t
);

146 
upd©ed
.
	`»£rve
(
cu¼’t
.
	`size
());

147 !
š
.
	`©_’d
(è&& 
d
 !ğ
chªges
.
	`’d
()) {

148 cÚ¡ 
¡ršg
 & 
wÜd
 = *
š
;

149 
	`As£¹
(
d
 !ğ
chªges
.
	`’d
());

150 
cmp
 = 
wÜd
.
	`com·»
(*
d
);

151 ià(
cmp
 < 0) {

152 
out
.
	`­³nd
(
wÜd
);

153 ++
š
;

154 } ià(
cmp
 > 0) {

155 
out
.
	`­³nd
(*
d
);

156 ++
d
;

160 ++
š
;

161 ++
d
;

164 ià(!
š
.
	`©_’d
()) {

166 !
š
.
	`©_’d
()) {

167 
out
.
	`­³nd
(*
š
++);

171 
d
 !ğ
chªges
.
	`’d
()) {

172 
out
.
	`­³nd
(*
d
++);

174 ià(!
upd©ed
.
	`em±y
()) {

175 
	`add
(
key
, 
upd©ed
);

177 
	`d–
(
key
);

180 
‹rmli¡_d–s
.
	`ş—r
();

182 
m­
<
¡ršg
, 
X­Ÿn
::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
j
;

183 
j
 = 
wÜdäeq_chªges
.
	`begš
(); j !ğwÜdäeq_chªges.
	`’d
(); ++j) {

184 
¡ršg
 
key
 = "W" + 
j
->
fœ¡
;

185 ià(
j
->
£cÚd
) {

186 
¡ršg
 
g
;

187 
	`·ck_ušt_Ï¡
(
g
, 
j
->
£cÚd
);

188 
	`add
(
key
, 
g
);

190 
	`d–
(
key
);

193 
wÜdäeq_chªges
.
	`ş—r
();

194 
	}
}

197 
	gB¿ssS³ÎšgTabË
::
	$toggË_äagm’t
(
äagm’t
 
äag
, cÚ¡ 
¡ršg
 & 
wÜd
)

199 
m­
<
äagm’t
, 
£t
<
¡ršg
> >::
™”©Ü
 
i
 = 
‹rmli¡_d–s
.
	`fšd
(
äag
);

200 ià(
i
 =ğ
‹rmli¡_d–s
.
	`’d
()) {

201 
i
 = 
‹rmli¡_d–s
.
	`š£¹
(
	`make_·œ
(
äag
, 
£t
<
¡ršg
>())).
fœ¡
;

205 
·œ
<
£t
<
¡ršg
>::
™”©Ü
, 
boŞ
> 
»s
 = 
i
->
£cÚd
.
	`š£¹
(
wÜd
);

206 ià(!
»s
.
£cÚd
) {

208 
i
->
£cÚd
.
	`”a£
(
»s
.
fœ¡
);

210 
	}
}

213 
	gB¿ssS³ÎšgTabË
::
add_wÜd
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
)

215 ià(
wÜd
.
size
() <= 1) ;

217 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
‹rmcouÁ
>::
™”©Ü
 
i
 = 
wÜdäeq_chªges
.
fšd
(
wÜd
);

218 ià(
	gi
 !ğ
wÜdäeq_chªges
.
’d
()) {

220 ià(
i
->
£cÚd
) {

221 
i
->
£cÚd
 +ğ
äeqšc
;

226 
	gi
->
	g£cÚd
 = 
äeqšc
;

228 
¡ršg
 
	gkey
 = "W" + 
wÜd
;

229 
¡ršg
 
	gd©a
;

230 ià(
g‘_exaù_’Œy
(
key
, 
d©a
)) {

232 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

233 cÚ¡ * 
	gp
 = 
d©a
.data();

234 ià(!
uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
size
(), &
äeq
è|| 
	gäeq
 == 0) {

235 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

237 
	gwÜdäeq_chªges
[
wÜd
] = 
äeq
 + 
äeqšc
;

240 
	gwÜdäeq_chªges
[
wÜd
] = 
äeqšc
;

245 
äagm’t
 
	gbuf
;

247 
	gbuf
[0] = 'H';

248 
	gbuf
[1] = 
wÜd
[0];

249 
	gbuf
[2] = 
wÜd
[1];

250 
	gbuf
[3] = '\0';

251 
toggË_äagm’t
(
buf
, 
wÜd
);

254 
	gbuf
[0] = 'T';

255 
	gbuf
[1] = 
wÜd
[wÜd.
size
() - 2];

256 
	gbuf
[2] = 
wÜd
[wÜd.
size
() - 1];

257 
	gbuf
[3] = '\0';

258 
toggË_äagm’t
(
buf
, 
wÜd
);

260 ià(
	gwÜd
.
size
() <= 4) {

267 
buf
[0] = 'B';

268 
	gbuf
[1] = 
wÜd
[0];

269 
	gbuf
[3] = '\0';

270 
toggË_äagm’t
(
buf
, 
wÜd
);

272 ià(
	gwÜd
.
size
() > 2) {

274 
	gbuf
[0] = 'M';

275 
size_t
 
	g¡¬t
 = 0; s¹ <ğ
wÜd
.
size
() - 3; ++start) {

276 
memıy
(
buf
.
d©a
 + 1, 
wÜd
.d©a(è+ 
¡¬t
, 3);

277 
toggË_äagm’t
(
buf
, 
wÜd
);

283 
	gB¿ssS³ÎšgTabË
::
»move_wÜd
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
)

285 
m­
<
¡ršg
, 
	gX­Ÿn
::
‹rmcouÁ
>::
™”©Ü
 
i
 = 
wÜdäeq_chªges
.
fšd
(
wÜd
);

286 ià(
	gi
 !ğ
wÜdäeq_chªges
.
’d
()) {

287 ià(
i
->
£cÚd
 == 0) {

292 ià(
	gäeqdec
 < 
	gi
->
	g£cÚd
) {

293 
	gi
->
	g£cÚd
 -ğ
äeqdec
;

298 
	gi
->
	g£cÚd
 = 0;

300 
¡ršg
 
	gkey
 = "W" + 
wÜd
;

301 
¡ršg
 
	gd©a
;

302 ià(!
g‘_exaù_’Œy
(
key
, 
d©a
)) {

307 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

308 cÚ¡ *
	gp
 = 
d©a
.data();

309 ià(!
uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
size
(), &
äeq
)) {

310 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

312 ià(
	gäeqdec
 < 
	gäeq
) {

313 
	gwÜdäeq_chªges
[
wÜd
] = 
äeq
 - 
äeqdec
;

317 
	gwÜdäeq_chªges
[
wÜd
] = 0;

322 
äagm’t
 
	gbuf
;

324 
	gbuf
[0] = 'H';

325 
	gbuf
[1] = 
wÜd
[0];

326 
	gbuf
[2] = 
wÜd
[1];

327 
	gbuf
[3] = '\0';

328 
toggË_äagm’t
(
buf
, 
wÜd
);

331 
	gbuf
[0] = 'T';

332 
	gbuf
[1] = 
wÜd
[wÜd.
size
() - 2];

333 
	gbuf
[2] = 
wÜd
[wÜd.
size
() - 1];

334 
	gbuf
[3] = '\0';

335 
toggË_äagm’t
(
buf
, 
wÜd
);

337 ià(
	gwÜd
.
size
() <= 4) {

339 
buf
[0] = 'B';

340 
	gbuf
[1] = 
wÜd
[0];

341 
	gbuf
[3] = '\0';

342 
toggË_äagm’t
(
buf
, 
wÜd
);

344 ià(
	gwÜd
.
size
() > 2) {

346 
	gbuf
[0] = 'M';

347 
size_t
 
	g¡¬t
 = 0; s¹ <ğ
wÜd
.
size
() - 3; ++start) {

348 
memıy
(
buf
.
d©a
 + 1, 
wÜd
.d©a(è+ 
¡¬t
, 3);

349 
toggË_äagm’t
(
buf
, 
wÜd
);

354 
	sT”mLi¡G»©”AµroxSize
 {

355 
boŞ
 
İ”©Ü
()(cÚ¡ 
T”mLi¡
 *
	ma
, cÚ¡ T”mLi¡ *
	mb
) {

356  
	ma
->
g‘_­´ox_size
(è> 
	mb
->get_approx_size();

360 
T”mLi¡
 *

361 
	gB¿ssS³ÎšgTabË
::
	$İ’_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
)

364 
	`As£¹R–
(
wÜd
.
	`size
(),>,1);

368 ià(!
wÜdäeq_chªges
.
	`em±y
()è
	`m”ge_chªges
();

372 
´iÜ™y_queue
<
T”mLi¡
*, 
veùÜ
<T”mLi¡*>, 
T”mLi¡G»©”AµroxSize
> 
pq
;

373 
Œy
 {

374 
¡ršg
 
d©a
;

375 
äagm’t
 
buf
;

378 
buf
[0] = 'H';

379 
buf
[1] = 
wÜd
[0];

380 
buf
[2] = 
wÜd
[1];

381 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

382 
pq
.
	`push
(
Ãw
 
	`B¿ssS³ÎšgT”mLi¡
(
d©a
));

385 
buf
[0] = 'T';

386 
buf
[1] = 
wÜd
[wÜd.
	`size
() - 2];

387 
buf
[2] = 
wÜd
[wÜd.
	`size
() - 1];

388 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

389 
pq
.
	`push
(
Ãw
 
	`B¿ssS³ÎšgT”mLi¡
(
d©a
));

391 ià(
wÜd
.
	`size
() <= 4) {

397 
buf
[0] = 'B';

398 
buf
[1] = 
wÜd
[0];

399 
buf
[3] = '\0';

400 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

401 
pq
.
	`push
(
Ãw
 
	`B¿ssS³ÎšgT”mLi¡
(
d©a
));

403 ià(
wÜd
.
	`size
() > 2) {

405 
buf
[0] = 'M';

406 
size_t
 
¡¬t
 = 0; s¹ <ğ
wÜd
.
	`size
() - 3; ++start) {

407 
	`memıy
(
buf
.
d©a
 + 1, 
wÜd
.
	`d©a
(è+ 
¡¬t
, 3);

408 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

409 
pq
.
	`push
(
Ãw
 
	`B¿ssS³ÎšgT”mLi¡
(
d©a
));

412 ià(
wÜd
.
	`size
() == 3) {

417 
buf
[1] = 
wÜd
[1];

418 
buf
[2] = 
wÜd
[0];

419 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

420 
pq
.
	`push
(
Ãw
 
	`B¿ssS³ÎšgT”mLi¡
(
d©a
));

422 
buf
[1] = 
wÜd
[0];

423 
buf
[2] = 
wÜd
[2];

424 
buf
[3] = 
wÜd
[1];

425 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

426 
pq
.
	`push
(
Ãw
 
	`B¿ssS³ÎšgT”mLi¡
(
d©a
));

429 
	`As£¹
(
wÜd
.
	`size
() == 2);

434 
buf
[0] = 'H';

435 
buf
[1] = 
wÜd
[1];

436 
buf
[2] = 
wÜd
[0];

437 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

438 
pq
.
	`push
(
Ãw
 
	`B¿ssS³ÎšgT”mLi¡
(
d©a
));

439 
buf
[0] = 'T';

440 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

441 
pq
.
	`push
(
Ãw
 
	`B¿ssS³ÎšgT”mLi¡
(
d©a
));

444 ià(
pq
.
	`em±y
()è 
NULL
;

453 
pq
.
	`size
() > 1) {

456 
T”mLi¡
 * 
‹rmli¡
 = 
pq
.
	`tİ
();

457 
pq
.
	`pİ
();

459 
‹rmli¡
 = 
Ãw
 
	`OrT”mLi¡
(
pq
.
	`tİ
(),ermlist);

460 
pq
.
	`pİ
();

461 
pq
.
	`push
(
‹rmli¡
);

464  
pq
.
	`tİ
();

465 } 
	`ÿtch
 (...) {

468 !
pq
.
	`em±y
()) {

469 
d–‘e
 
pq
.
	`tİ
();

470 
pq
.
	`pİ
();

472 
throw
;

474 
	}
}

476 
	gX­Ÿn
::
doccouÁ


477 
B¿ssS³ÎšgTabË
::
	$g‘_wÜd_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const

479 
m­
<
¡ršg
, 
X­Ÿn
::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
i
;

480 
i
 = 
wÜdäeq_chªges
.
	`fšd
(
wÜd
);

481 ià(
i
 !ğ
wÜdäeq_chªges
.
	`’d
()) {

483  
i
->
£cÚd
;

486 
¡ršg
 
key
 = "W" + 
wÜd
;

487 
¡ršg
 
d©a
;

488 ià(
	`g‘_exaù_’Œy
(
key
, 
d©a
)) {

490 
X­Ÿn
::
‹rmcouÁ
 
äeq
;

491 cÚ¡ *
p
 = 
d©a
.
	`d©a
();

492 ià(!
	`uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
	`size
(), &
äeq
)) {

493 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spelling word freq");

495  
äeq
;

499 
	}
}

503 
	gX­Ÿn
::
‹rmcouÁ


504 
B¿ssS³ÎšgT”mLi¡
::
	$g‘_­´ox_size
() const

508  
d©a
.
	`size
();

509 
	}
}

511 
	g¡d
::
¡ršg


512 
B¿ssS³ÎšgT”mLi¡
::
	$g‘_‹rmÇme
() const

514  
cu¼’t_‹rm
;

515 
	}
}

517 
	gX­Ÿn
::
‹rmcouÁ


518 
B¿ssS³ÎšgT”mLi¡
::
	$g‘_wdf
() const

521 
	}
}

523 
	gX­Ÿn
::
doccouÁ


524 
B¿ssS³ÎšgT”mLi¡
::
	$g‘_‹rmäeq
() const

527 
	}
}

529 
	gX­Ÿn
::
‹rmcouÁ


530 
B¿ssS³ÎšgT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

533 
	}
}

535 
T”mLi¡
 *

536 
	gB¿ssS³ÎšgT”mLi¡
::
	$Ãxt
()

538 ià(
p
 =ğ
d©a
.
	`size
()) {

539 
p
 = 0;

540 
d©a
.
	`»size
(0);

541  
NULL
;

543 ià(!
cu¼’t_‹rm
.
	`em±y
()) {

544 ià(
p
 =ğ
d©a
.
	`size
())

545 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spellingermlist");

546 
cu¼’t_‹rm
.
	`»size
(
	`by‹
(
d©a
[
p
++]è^ 
MAGIC_XOR_VALUE
);

548 
size_t
 
add
;

549 ià(
p
 =ğ
d©a
.
	`size
() ||

550 (
add
 = 
	`by‹
(
d©a
[
p
]è^ 
MAGIC_XOR_VALUE
è>ğd©a.
	`size
() -…)

551 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spellingermlist");

552 
cu¼’t_‹rm
.
	`­³nd
(
d©a
.
	`d©a
(è+ 
p
 + 1, 
add
);

553 
p
 +ğ
add
 + 1;

554  
NULL
;

555 
	}
}

557 
boŞ


558 
	gB¿ssS³ÎšgT”mLi¡
::
	$©_’d
() const

560  
d©a
.
	`em±y
();

561 
	}
}

563 
	gX­Ÿn
::
‹rmcouÁ


564 
B¿ssS³ÎšgT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

566 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("BrassSpellingTermList::positionlist_count()‚ot implemented");

567 
	}
}

569 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


570 
B¿ssS³ÎšgT”mLi¡
::
	$pos™iÚli¡_begš
() const

572 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("BrassSpellingTermList::positionlist_begin()‚ot implemented");

573 
	}
}

	@backends/brass/brass_spelling.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_SPELLING_H


22 
	#XAPIAN_INCLUDED_BRASS_SPELLING_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"b¿ss_ÏzybË.h
"

27 
	~"‹rmli¡.h
"

29 
	~<m­
>

30 
	~<£t
>

31 
	~<¡ršg
>

32 
	~<c¡ršg
>

34 
Çme¥aû
 
	gB¿ss
 {

36 
	säagm’t
 {

37 
	gd©a
[4];

40 
äagm’t
() { }

43 
äagm’t
(
d©a_
[4]è{ 
	g¡d
::
memıy
(
d©a
, data_, 4); }

45 & 
	gİ”©Ü
[] (
	gi
è{  
	gd©a
[
i
]; }

46 cÚ¡ & 
	gİ”©Ü
[] (
	gi
ècÚ¡ {  
	gd©a
[
i
]; }

48 
İ”©Ü
 
	g¡d
::
¡ršg
 () const {

49  
¡d
::
¡ršg
(
d©a
, data[0] == 'M' ? 4 : 3);

52 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gäagm’t
 &
	gb
) const {

53  
	g¡d
::
memcmp
(
d©a
, 
b
.data, 4) < 0;

59 şas 
	cB¿ssS³ÎšgTabË
 : 
public
 
B¿ssLazyTabË
 {

60 
toggË_äagm’t
(
B¿ss
::
äagm’t
 
äag
, cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
);

62 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mX­Ÿn
::
‹rmcouÁ
> 
wÜdäeq_chªges
;

63 
	m¡d
::
m­
<
B¿ss
::
äagm’t
, std::
£t
<
¡d
::
¡ršg
> > 
‹rmli¡_d–s
;

65 
	mpublic
:

74 
B¿ssS³ÎšgTabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

75 : 
B¿ssLazyTabË
("¥–lšg", 
dbdœ
 + "/¥–lšg.", 
»adÚly
,

76 
Z_DEFAULT_STRATEGY
) { }

79 
m”ge_chªges
();

81 
add_wÜd
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
);

82 
»move_wÜd
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
);

84 
T”mLi¡
 * 
İ’_‹rmli¡
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
);

86 
	gX­Ÿn
::
doccouÁ
 
g‘_wÜd_äequ’cy
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
) const;

95 
boŞ
 
	$is_modif›d
() const {

96  !
wÜdäeq_chªges
.
	`em±y
(è|| 
B¿ssTabË
::
	`is_modif›d
();

97 
	}
}

99 
	$æush_db
() {

100 
	`m”ge_chªges
();

101 
B¿ssTabË
::
	`æush_db
();

102 
	}
}

104 
	$ÿnûl
() {

106 
wÜdäeq_chªges
.
	`ş—r
();

107 
‹rmli¡_d–s
.
	`ş—r
();

109 
B¿ssTabË
::
	`ÿnûl
();

110 
	}
}

116 şas 
	cB¿ssS³ÎšgT”mLi¡
 : 
public
 
T”mLi¡
 {

118 
¡d
::
¡ršg
 
d©a
;

121 
	mp
;

124 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

127 
B¿ssS³ÎšgT”mLi¡
(const BrassSpellingTermList &);

130 
	mİ”©Ü
=(cÚ¡ 
B¿ssS³ÎšgT”mLi¡
 &);

132 
	mpublic
:

134 
B¿ssS³ÎšgT”mLi¡
(cÚ¡ 
¡d
::
¡ršg
 & 
d©a_
)

135 : 
d©a
(
d©a_
), 
	$p
(0) { }

137 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

139 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

141 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

143 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

145 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

147 
T”mLi¡
 *
	`Ãxt
();

149 
boŞ
 
	$©_’d
() const;

151 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

153 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

154 
	}
};

	@backends/brass/brass_spellingwordslist.cc

23 
	~<cÚfig.h
>

25 
	~<x­Ÿn/”rÜ.h
>

26 
	~<x­Ÿn/ty³s.h
>

28 
	~"b¿ss_¥–lšgwÜd¦i¡.h
"

29 
	~"·ck.h
"

30 
	~"¡ršguts.h
"

32 
	gB¿ssS³ÎšgWÜdsLi¡
::~
	$B¿ssS³ÎšgWÜdsLi¡
()

34 
	`DEBUGCALL
(
DB
, , "~BrassSpellingWordsList", "");

35 
d–‘e
 
cursÜ
;

36 
	}
}

38 
¡ršg


39 
	gB¿ssS³ÎšgWÜdsLi¡
::
	$g‘_‹rmÇme
() const

41 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassSpellingWordsList::get_termname", "");

42 
	`As£¹
(
cursÜ
);

43 
	`As£¹
(!
	`©_’d
());

44 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

45 
	`As£¹
(
cursÜ
->
cu¼’t_key
[0] == 'W');

46 
	`RETURN
(
cursÜ
->
cu¼’t_key
.
	`sub¡r
(1));

47 
	}
}

49 
	gX­Ÿn
::
doccouÁ


50 
B¿ssS³ÎšgWÜdsLi¡
::
	$g‘_‹rmäeq
() const

52 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassSpellingWordsList::get_termfreq", "");

53 
	`As£¹
(
cursÜ
);

54 
	`As£¹
(!
	`©_’d
());

55 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

56 
	`As£¹
(
cursÜ
->
cu¼’t_key
[0] == 'W');

57 
cursÜ
->
	`»ad_g
();

59 
X­Ÿn
::
‹rmcouÁ
 
äeq
;

60 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

61 ià(!
	`uÅack_ušt_Ï¡
(&
p
,… + 
cursÜ
->
cu¼’t_g
.
	`size
(), &
äeq
)) {

62 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spelling word freq");

64  
äeq
;

65 
	}
}

67 
	gX­Ÿn
::
‹rmcouÁ


68 
B¿ssS³ÎšgWÜdsLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

70 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("BrassSpellingWordsList::get_collection_freq()‚ot meaningful");

71 
	}
}

73 
T”mLi¡
 *

74 
	gB¿ssS³ÎšgWÜdsLi¡
::
	$Ãxt
()

76 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "BrassSpellingWordsList::next", "");

77 
	`As£¹
(!
	`©_’d
());

79 
cursÜ
->
	`Ãxt
();

80 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 'W')) {

82 
cursÜ
->
	`to_’d
();

85 
	`RETURN
(
NULL
);

86 
	}
}

88 
T”mLi¡
 *

89 
	gB¿ssS³ÎšgWÜdsLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
Šame
)

91 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "B¿ssS³ÎšgWÜdsLi¡::sk_to", 
Šame
);

92 
	`As£¹
(!
	`©_’d
());

94 ià(!
cursÜ
->
	`fšd_’Œy_ge
("W" + 
Šame
)) {

97 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 'W')) {

99 
cursÜ
->
	`to_’d
();

102 
	`RETURN
(
NULL
);

103 
	}
}

105 
boŞ


106 
	gB¿ssS³ÎšgWÜdsLi¡
::
	$©_’d
() const

108 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassSpellingWordsList::at_end", "");

109 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

110 
	}
}

	@backends/brass/brass_spellingwordslist.h

21 #iâdeà
XAPIAN_HGUARD_BRASS_SPELLINGWORDSLIST_H


22 
	#XAPIAN_HGUARD_BRASS_SPELLINGWORDSLIST_H


	)

24 
	~"®É”m¦i¡.h
"

25 
	~"d©aba£.h
"

26 
	~"b¿ss_¥–lšg.h
"

28 
şass
 
	gB¿ssCursÜ
;

30 şas 
	cB¿ssS³ÎšgWÜdsLi¡
 : 
public
 
AÎT”msLi¡
 {

32 
B¿ssS³ÎšgWÜdsLi¡
(const BrassSpellingWordsList &);

35 
	mİ”©Ü
=(cÚ¡ 
B¿ssS³ÎšgWÜdsLi¡
 &);

38 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

43 
B¿ssCursÜ
 * 
	mcursÜ
;

51 
mubË
 
	mX­Ÿn
::
‹rmcouÁ
 
‹rmäeq
;

54 
	$»ad_‹rmäeq
() const;

56 
public
:

57 
	`B¿ssS³ÎšgWÜdsLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

58 
B¿ssCursÜ
 * 
cursÜ_
)

59 : 
	`d©aba£
(
d©aba£_
), 
	`cursÜ
(
cursÜ_
), 
	$‹rmäeq
(0) {

62 
cursÜ
->
	`fšd_’Œy
(
¡d
::
	`¡ršg
("W", 1));

66 ~
	`B¿ssS³ÎšgWÜdsLi¡
();

73 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

80 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

87 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

90 
T”mLi¡
 * 
	`Ãxt
();

93 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
);

96 
boŞ
 
	$©_’d
() const;

97 
	}
};

	@backends/brass/brass_synonym.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/”rÜ.h
>

25 
	~"b¿ss_cursÜ.h
"

26 
	~"b¿ss_synÚym.h
"

27 
	~"¡ršguts.h
"

28 
	~"veùÜ‹rmli¡.h
"

30 
	~<£t
>

31 
	~<¡ršg
>

32 
	~<veùÜ
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	#MAGIC_XOR_VALUE
 96

	)

42 
	gB¿ssSynÚymTabË
::
	$m”ge_chªges
()

44 ià(
Ï¡_‹rm
.
	`em±y
()) ;

46 ià(
Ï¡_synÚyms
.
	`em±y
()) {

47 
	`d–
(
Ï¡_‹rm
);

49 
¡ršg
 
g
;

51 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

52 
i
 = 
Ï¡_synÚyms
.
	`begš
(); i !ğÏ¡_synÚyms.
	`’d
(); ++i) {

53 cÚ¡ 
¡ršg
 & 
synÚym
 = *
i
;

54 
g
 +ğ
	`by‹
(
synÚym
.
	`size
(è^ 
MAGIC_XOR_VALUE
);

55 
g
 +ğ
synÚym
;

58 
	`add
(
Ï¡_‹rm
, 
g
);

59 
Ï¡_synÚyms
.
	`ş—r
();

61 
Ï¡_‹rm
.
	`»size
(0);

62 
	}
}

65 
	gB¿ssSynÚymTabË
::
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
)

67 ià(
Ï¡_‹rm
 !ğ
‹rm
) {

68 
	`m”ge_chªges
();

69 
Ï¡_‹rm
 = 
‹rm
;

71 
¡ršg
 
g
;

72 ià(
	`g‘_exaù_’Œy
(
‹rm
, 
g
)) {

73 cÚ¡ * 
p
 = 
g
.
	`d©a
();

74 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

75 
p
 !ğ
’d
) {

76 
size_t
 
Ën
;

77 ià(
p
 =ğ
’d
 ||

78 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

79 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

80 ++
p
;

81 
Ï¡_synÚyms
.
	`š£¹
(
	`¡ršg
(
p
, 
Ën
));

82 
p
 +ğ
Ën
;

87 
Ï¡_synÚyms
.
	`š£¹
(
synÚym
);

88 
	}
}

91 
	gB¿ssSynÚymTabË
::
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
)

93 ià(
Ï¡_‹rm
 !ğ
‹rm
) {

94 
	`m”ge_chªges
();

95 
Ï¡_‹rm
 = 
‹rm
;

97 
¡ršg
 
g
;

98 ià(
	`g‘_exaù_’Œy
(
‹rm
, 
g
)) {

99 cÚ¡ * 
p
 = 
g
.
	`d©a
();

100 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

101 
p
 !ğ
’d
) {

102 
size_t
 
Ën
;

103 ià(
p
 =ğ
’d
 ||

104 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

105 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

106 ++
p
;

107 
Ï¡_synÚyms
.
	`š£¹
(
	`¡ršg
(
p
, 
Ën
));

108 
p
 +ğ
Ën
;

113 
Ï¡_synÚyms
.
	`”a£
(
synÚym
);

114 
	}
}

117 
	gB¿ssSynÚymTabË
::
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
‹rm
)

124 ià(
Ï¡_‹rm
 =ğ
‹rm
) {

125 
Ï¡_synÚyms
.
	`ş—r
();

127 
	`m”ge_chªges
();

128 
Ï¡_‹rm
 = 
‹rm
;

130 
	}
}

132 
T”mLi¡
 *

133 
	gB¿ssSynÚymTabË
::
	$İ’_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
)

135 
veùÜ
<
¡ršg
> 
synÚyms
;

137 ià(
Ï¡_‹rm
 =ğ
‹rm
) {

138 ià(
Ï¡_synÚyms
.
	`em±y
()è 
NULL
;

140 
synÚyms
.
	`»£rve
(
Ï¡_synÚyms
.
	`size
());

141 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

142 
i
 = 
Ï¡_synÚyms
.
	`begš
(); i !ğÏ¡_synÚyms.
	`’d
(); ++i) {

143 
synÚyms
.
	`push_back
(*
i
);

146 
¡ršg
 
g
;

147 ià(!
	`g‘_exaù_’Œy
(
‹rm
, 
g
)è 
NULL
;

149 cÚ¡ * 
p
 = 
g
.
	`d©a
();

150 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

151 
p
 !ğ
’d
) {

152 
size_t
 
Ën
;

153 ià(
p
 =ğ
’d
 ||

154 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

155 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

156 ++
p
;

157 
synÚyms
.
	`push_back
(
	`¡ršg
(
p
, 
Ën
));

158 
p
 +ğ
Ën
;

162  
Ãw
 
	`VeùÜT”mLi¡
(
synÚyms
.
	`begš
(), synÚyms.
	`’d
());

163 
	}
}

167 
	gB¿ssSynÚymT”mLi¡
::~
	$B¿ssSynÚymT”mLi¡
()

169 
	`DEBUGCALL
(
DB
, , "~BrassSynonymTermList", "");

170 
d–‘e
 
cursÜ
;

171 
	}
}

173 
¡ršg


174 
	gB¿ssSynÚymT”mLi¡
::
	$g‘_‹rmÇme
() const

176 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassSynonymTermList::get_termname", "");

177 
	`As£¹
(
cursÜ
);

178 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

179 
	`As£¹
(!
	`©_’d
());

180 
	`RETURN
(
cursÜ
->
cu¼’t_key
);

181 
	}
}

183 
	gX­Ÿn
::
doccouÁ


184 
B¿ssSynÚymT”mLi¡
::
	$g‘_‹rmäeq
() const

186 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("BrassSynonymTermList::get_termfreq()‚ot meaningful");

187 
	}
}

189 
	gX­Ÿn
::
‹rmcouÁ


190 
B¿ssSynÚymT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

192 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("BrassSynonymTermList::get_collection_freq()‚ot meaningful");

193 
	}
}

195 
T”mLi¡
 *

196 
	gB¿ssSynÚymT”mLi¡
::
	$Ãxt
()

198 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "BrassSynonymTermList::next", "");

199 
	`As£¹
(!
	`©_’d
());

201 
cursÜ
->
	`Ãxt
();

202 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

204 
cursÜ
->
	`to_’d
();

207 
	`RETURN
(
NULL
);

208 
	}
}

210 
T”mLi¡
 *

211 
	gB¿ssSynÚymT”mLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
Šame
)

213 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "B¿ssSynÚymT”mLi¡::sk_to", 
Šame
);

214 
	`As£¹
(!
	`©_’d
());

216 ià(!
cursÜ
->
	`fšd_’Œy_ge
(
Šame
)) {

219 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

221 
cursÜ
->
	`to_’d
();

224 
	`RETURN
(
NULL
);

225 
	}
}

227 
boŞ


228 
	gB¿ssSynÚymT”mLi¡
::
	$©_’d
() const

230 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassSynonymTermList::at_end", "");

231 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

232 
	}
}

	@backends/brass/brass_synonym.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_SYNONYM_H


22 
	#XAPIAN_INCLUDED_BRASS_SYNONYM_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"®É”m¦i¡.h
"

27 
	~"d©aba£.h
"

28 
	~"b¿ss_ÏzybË.h
"

29 
	~"omdebug.h
"

30 
	~"‹rmli¡.h
"

32 
	~<£t
>

33 
	~<¡ršg
>

35 şas 
	cB¿ssSynÚymTabË
 : 
public
 
B¿ssLazyTabË
 {

37 
mubË
 
¡d
::
¡ršg
 
Ï¡_‹rm
;

40 
mubË
 
	m¡d
::
£t
<
¡d
::
¡ršg
> 
Ï¡_synÚyms
;

42 
	mpublic
:

51 
B¿ssSynÚymTabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

52 : 
B¿ssLazyTabË
("synÚym", 
dbdœ
 + "/synÚym.", 
»adÚly
,

53 
Z_DEFAULT_STRATEGY
) { }

56 
m”ge_chªges
();

59 
	$disÿrd_chªges
() {

60 
Ï¡_‹rm
.
	`»size
(0);

61 
Ï¡_synÚyms
.
	`ş—r
();

62 
	}
}

68 
add_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, cÚ¡ std::¡ršg & 
synÚym
);

74 
»move_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, cÚ¡ std::¡ršg & 
synÚym
);

80 
ş—r_synÚyms
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
);

86 
T”mLi¡
 * 
İ’_‹rmli¡
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
);

95 
boŞ
 
	$is_modif›d
() const {

96  !
Ï¡_‹rm
.
	`em±y
(è|| 
B¿ssTabË
::
	`is_modif›d
();

97 
	}
}

99 
	$æush_db
() {

100 
	`m”ge_chªges
();

101 
B¿ssTabË
::
	`æush_db
();

102 
	}
}

104 
	$ÿnûl
() {

105 
	`disÿrd_chªges
();

106 
B¿ssTabË
::
	`ÿnûl
();

107 
	}
}

112 
şass
 
	gB¿ssCursÜ
;

114 şas 
	cB¿ssSynÚymT”mLi¡
 : 
public
 
AÎT”msLi¡
 {

116 
B¿ssSynÚymT”mLi¡
(const BrassSynonymTermList &);

119 
	mİ”©Ü
=(cÚ¡ 
B¿ssSynÚymT”mLi¡
 &);

122 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

127 
B¿ssCursÜ
 * 
	mcursÜ
;

130 
¡ršg
 
	m´efix
;

132 
	mpublic
:

133 
B¿ssSynÚymT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

134 
B¿ssCursÜ
 * 
cursÜ_
,

135 cÚ¡ 
¡ršg
 & 
´efix_
)

136 : 
d©aba£
(
d©aba£_
), 
cursÜ
(
cursÜ_
), 
	$´efix
(
´efix_
)

141 ià(
´efix
.
	`em±y
()) {

142 
cursÜ
->
	`fšd_’Œy
(
	`¡ršg
());

145 
cursÜ
->
	`fšd_’Œy_É
(
´efix
);

150 ~
	`B¿ssSynÚymT”mLi¡
();

157 
¡ršg
 
	$g‘_‹rmÇme
() const;

160 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

163 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

166 
T”mLi¡
 * 
	`Ãxt
();

169 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡ršg
 &
Šame
);

172 
boŞ
 
	$©_’d
() const;

173 
	}
};

	@backends/brass/brass_table.cc

24 
	~<cÚfig.h
>

26 
	~"b¿ss_bË.h
"

28 
	~<x­Ÿn/”rÜ.h
>

30 
	~"§ã”ºo.h
"

31 #ifdeà
__WIN32__


32 
	~"msvc_posix_w¿µ”.h
"

35 
	~"omas£¹.h
"

36 
	~"¡ršguts.h
"

51 
	~<sys/ty³s.h
>

58 #ià
defšed
 
HAVE_PREAD
 && defšed 
PREAD_PROTOTYPE


59 
	gPREAD_PROTOTYPE


61 #ià
defšed
 
HAVE_PWRITE
 && defšed 
PWRITE_PROTOTYPE


62 
	gPWRITE_PROTOTYPE


65 
	~<c¡dio
>

66 
	~<c¡ršg
>

67 
	~<şim™s
>

69 
	~"b¿ss_io.h
"

70 
	~"b¿ss_bŒ“ba£.h
"

71 
	~"b¿ss_cursÜ.h
"

73 
	~"omas£¹.h
"

74 
	~"omdebug.h
"

75 
	~"·ck.h
"

76 
	~"uÇligÃd.h
"

77 
	~"uts.h
"

79 
	~<®gÜ™hm
>

80 
	~<¡ršg
>

82 
usšg
 
Çme¥aû
 
	gB¿ss
;

83 
usšg
 
Çme¥aû
 
	g¡d
;

86 cÚ¡ 
size_t
 
	gCOMPRESS_MIN
 = 4;

89 #undeà
BTREE_DEBUG_FULL


91 #ifdeà
BTREE_DEBUG_FULL


94 
´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
);

95 
´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
);

113 
	$sys_uÆšk
(cÚ¡ 
¡ršg
 &
f’ame
)

115 #ifdeà
__WIN32__


116 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

118 ià(
	`uÆšk
(
f’ame
) == -1) {

120 
¡ršg
 
mes§ge
 = "Failedo unlink ";

121 
mes§ge
 +ğ
f’ame
;

122 
mes§ge
 += ": ";

123 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

124 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
mes§ge
);

126 
	}
}

128 
šlše
 
by‹
 *
	$z”Ûd_Ãw
(
size_t
 
size
)

130 
by‹
 *
‹mp
 = 
Ãw
 by‹[
size
];

133 
	`As£¹
(
‹mp
);

134 
	`mem£t
(
‹mp
, 0, 
size
);

135  
‹mp
;

136 
	}
}

186 
	#SEQ_START_POINT
 (-10)

	)

190 
	#BLOCK_CAPACITY
 4

	)

205 
	#BYTE_PAIR_RANGE
 (1 << 2 * 
CHAR_BIT
)

	)

209 
	gB¿ssTabË
::
	$»ad_block
(
ušt4
 
n
, 
by‹
 * 
p
) const

212 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::»ad_block", 
n
 << ", " << (*)
p
);

216 
	`As£¹
(
n
 / 
CHAR_BIT
 < 
ba£
.
	`g‘_b™_m­_size
());

218 #ifdeà
HAVE_PREAD


219 
off_t
 
off£t
 = 
	`off_t
(
block_size
è* 
n
;

220 
m
 = 
block_size
;

221 
Œue
) {

222 
ssize_t
 
by‹s_»ad
 = 
	`´—d
(
hªdË
, 
»š‹½»t_ÿ¡
<*>(
p
), 
m
,

223 
off£t
);

225 ià(
by‹s_»ad
 =ğ
m
) ;

226 ià(
by‹s_»ad
 == -1) {

227 ià(
”ºo
 =ğ
EINTR
) ;

228 
¡ršg
 
mes§ge
 = "E¼Ü„—dšg block " + 
	`om_to¡ršg
(
n
) + ": ";

229 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

230 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

231 } ià(
by‹s_»ad
 == 0) {

232 
¡ršg
 
mes§ge
 = "E¼Ü„—dšg block " + 
	`om_to¡ršg
(
n
) + ": gotƒnd of file";

233 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

234 } ià(
by‹s_»ad
 < 
m
) {

238 
m
 -ğ(
by‹s_»ad
);

239 
p
 +ğ
by‹s_»ad
;

240 
off£t
 +ğ
by‹s_»ad
;

244 ià(
	`l£ek
(
hªdË
, 
	`off_t
(
block_size
è* 
n
, 
SEEK_SET
) == -1) {

245 
¡ršg
 
mes§ge
 = "Error seekingo block: ";

246 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

247 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

250 
	`b¿ss_io_»ad
(
hªdË
, 
»š‹½»t_ÿ¡
<*>(
p
), 
block_size
, block_size);

252 
	}
}

261 
	gB¿ssTabË
::
	$wr™e_block
(
ušt4
 
n
, cÚ¡ 
by‹
 * 
p
) const

263 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::wr™e_block", 
n
 << ", " << 
p
);

264 
	`As£¹
(
wr™abË
);

266 
	`As£¹
(
n
 / 
CHAR_BIT
 < 
ba£
.
	`g‘_b™_m­_size
());

269 
	`As£¹P¬ªoid
(
ba£
.
	`block_ä“_©_¡¬t
(
n
));

272 
	`As£¹EqP¬ªoid
(
	`REVISION
(
p
), 
Ï‹¡_»visiÚ_numb”
 + 1);

274 ià(
bÙh_ba£s
) {

276 
	`sys_uÆšk
(
Çme
 + "ba£" + 
	`Ùh”_ba£_Ë‰”
());

277 
bÙh_ba£s
 = 
çl£
;

278 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

281 #ifdeà
HAVE_PWRITE


282 
off_t
 
off£t
 = 
	`off_t
(
block_size
è* 
n
;

283 
m
 = 
block_size
;

284 
Œue
) {

285 
ssize_t
 
by‹s_wr™‹n
 = 
	`pwr™e
(
hªdË
, 
p
, 
m
, 
off£t
);

286 ià(
by‹s_wr™‹n
 =ğ
m
) {

289 } ià(
by‹s_wr™‹n
 == -1) {

290 ià(
”ºo
 =ğ
EINTR
) ;

291 
¡ršg
 
mes§ge
 = "Error writing block: ";

292 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

293 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

294 } ià(
by‹s_wr™‹n
 == 0) {

295 
¡ršg
 
mes§ge
 = "Error writing block: wrote‚o data";

296 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

297 } ià(
by‹s_wr™‹n
 < 
m
) {

301 
m
 -ğ
by‹s_wr™‹n
;

302 
p
 +ğ
by‹s_wr™‹n
;

303 
off£t
 +ğ
by‹s_wr™‹n
;

307 ià(
	`l£ek
(
hªdË
, (
off_t
)
block_size
 * 
n
, 
SEEK_SET
) == -1) {

308 
¡ršg
 
mes§ge
 = "Error seekingo block: ";

309 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

310 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

313 
	`b¿ss_io_wr™e
(
hªdË
, 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
), 
block_size
);

315 
	}
}

340 
	gB¿ssTabË
::
	$£t_ov”wr™‹n
() const

342 
	`LOGCALL_VOID
(
DB
, "BrassTable::set_overwritten", "");

345 ià(
wr™abË
)

346 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Db block overwritten -‡rehere multiple writers?");

347 
throw
 
X­Ÿn
::
	`D©aba£Modif›dE¼Ü
("The„evision being„ead has been discarded - you should call Xapian::Database::reopen()‡nd„etryhe operation");

348 
	}
}

361 
	gB¿ssTabË
::
block_to_cursÜ
(
B¿ss
::
CursÜ
 * 
C_
, 
j
, 
ušt4
 
n
) const

363 
LOGCALL_VOID
(
DB
, "B¿ssTabË::block_to_cursÜ", (*)
C_
 << ", " << 
j
 << ", " << 
n
);

364 ià(
	gn
 =ğ
C_
[
j
].
n
) ;

365 
by‹
 * 
	gp
 = 
C_
[
j
].
p
;

366 
As£¹
(
p
);

369 ià(
	gC_
[
j
].
	g»wr™e
) {

370 
As£¹
(
wr™abË
);

371 
As£¹
(
C
 =ğ
C_
);

372 
wr™e_block
(
C_
[
j
].
n
, 
p
);

373 
	gC_
[
j
].
	g»wr™e
 = 
çl£
;

378 ià(
	gwr™abË
 && 
	gn
 =ğ
C
[
j
].
n
) {

379 
memıy
(
p
, 
C
[
j
].p, 
block_size
);

381 
»ad_block
(
n
, 
p
);

384 
	gC_
[
j
].
	gn
 = 
n
;

385 ià(
	gj
 < 
	gËv–
) {

387 ià(
¿»
(
REVISION
(
p
è> REVISION(
C_
[
j
 + 1].p))) {

388 
£t_ov”wr™‹n
();

393 ià(
¿»
(
j
 !ğ
GET_LEVEL
(
p
))) {

394 
¡ršg
 
msg
 = "Expected block ";

395 
	gmsg
 +ğ
om_to¡ršg
(
n
);

396 
	gmsg
 += "o be†evel ";

397 
	gmsg
 +ğ
om_to¡ršg
(
j
);

398 
	gmsg
 += ",‚ot ";

399 
	gmsg
 +ğ
om_to¡ršg
(
GET_LEVEL
(
p
));

400 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
(
msg
);

426 
	gB¿ssTabË
::
	$®‹r
()

428 
	`LOGCALL_VOID
(
DB
, "BrassTable::alter", "");

429 
	`As£¹
(
wr™abË
);

430 #ifdeà
DANGEROUS


431 
C
[0].
»wr™e
 = 
Œue
;

433 
j
 = 0;

434 
by‹
 * 
p
 = 
C
[
j
].p;

435 
Œue
) {

436 ià(
C
[
j
].
»wr™e
) ;

437 
C
[
j
].
»wr™e
 = 
Œue
;

439 
ušt4
 
n
 = 
C
[
j
].n;

440 ià(
ba£
.
	`block_ä“_©_¡¬t
(
n
)) {

441 
	`As£¹
(
	`REVISION
(
p
è=ğ
Ï‹¡_»visiÚ_numb”
 + 1);

444 
	`As£¹
(
	`REVISION
(
p
è< 
Ï‹¡_»visiÚ_numb”
 + 1);

445 
ba£
.
	`ä“_block
(
n
);

446 
n
 = 
ba£
.
	`Ãxt_ä“_block
();

447 
C
[
j
].
n
 =‚;

448 
	`SET_REVISION
(
p
, 
Ï‹¡_»visiÚ_numb”
 + 1);

450 ià(
j
 =ğ
Ëv–
) ;

451 
j
++;

452 
p
 = 
C
[
j
].p;

453 
	`I‹m_wr
(
p
, 
C
[
j
].
c
).
	`£t_block_giv’_by
(
n
);

456 
	}
}

471 
	gB¿ssTabË
::
	$fšd_š_block
(cÚ¡ 
by‹
 * 
p
, 
Key
 
key
, 
boŞ
 
Ëaf
, 
c
)

473 
	`LOGCALL_STATIC
(
DB
, , "B¿ssTabË::fšd_š_block", (*)
p
 << ", " << (cÚ¡ *)
key
.
	`g‘_add»ss
(è<< ", " << 
Ëaf
 << ", " << 
c
);

474 
i
 = 
DIR_START
;

475 ià(
Ëaf
è
i
 -ğ
D2
;

476 
j
 = 
	`DIR_END
(
p
);

478 ià(
c
 != -1) {

479 ià(
c
 < 
j
 && 
i
 < c && 
	`I‹m
(
p
, c).
	`key
(è<ğ
key
)

480 
i
 = 
c
;

481 
c
 +ğ
D2
;

482 ià(
c
 < 
j
 && 
i
 < c && 
key
 < 
	`I‹m
(
p
, c).
	`key
())

483 
j
 = 
c
;

486 
j
 - 
i
 > 
D2
) {

487 
k
 = 
i
 + ((
j
 - i)/(
D2
 * 2))*D2;

488 ià(
key
 < 
	`I‹m
(
p
, 
k
).
	`key
()è
j
 = k; 
i
 = k;

490 
	`RETURN
(
i
);

491 
	}
}

500 
boŞ


501 
	gB¿ssTabË
::
fšd
(
B¿ss
::
CursÜ
 * 
C_
) const

503 
LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::fšd", (*)
C_
);

505 cÚ¡ 
by‹
 * 
	gp
;

506 
	gc
;

507 
Key
 
	gkey
 = 
kt
.
key
();

508 
	gj
 = 
Ëv–
; j > 0; --j) {

509 
	gp
 = 
C_
[
j
].
p
;

510 
	gc
 = 
fšd_š_block
(
p
, 
key
, 
çl£
, 
C_
[
j
].
c
);

511 #ifdeà
BTREE_DEBUG_FULL


512 
´štf
("Block in BrassTable:find - code…osition 1");

513 
»pÜt_block_fuÎ
(
j
, 
C_
[j].
n
, 
p
);

515 
	gC_
[
j
].
	gc
 = 
c
;

516 
block_to_cursÜ
(
C_
, 
j
 - 1, 
I‹m
(
p
, 
c
).
block_giv’_by
());

518 
	gp
 = 
C_
[0].
p
;

519 
	gc
 = 
fšd_š_block
(
p
, 
key
, 
Œue
, 
C_
[0].
c
);

520 #ifdeà
BTREE_DEBUG_FULL


521 
´štf
("Block in BrassTable:find - code…osition 2");

522 
»pÜt_block_fuÎ
(0, 
C_
[0].
n
, 
p
);

524 
	gC_
[0].
	gc
 = 
c
;

525 ià(
	gc
 < 
	gDIR_START
è
RETURN
(
çl£
);

526 
RETURN
(
I‹m
(
p
, 
c
).
key
() == key);

535 
	gB¿ssTabË
::
	$com·ù
(
by‹
 * 
p
)

537 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::com·ù", (*)
p
);

538 
	`As£¹
(
wr™abË
);

539 
e
 = 
block_size
;

540 
by‹
 * 
b
 = 
bufãr
;

541 
dœ_’d
 = 
	`DIR_END
(
p
);

542 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

543 
I‹m
 
	`™em
(
p
, 
c
);

544 
l
 = 
™em
.
	`size
();

545 
e
 -ğ
l
;

546 
	`memmove
(
b
 + 
e
, 
™em
.
	`g‘_add»ss
(), 
l
);

547 
	`£tD
(
p
, 
c
, 
e
);

549 
	`memmove
(
p
 + 
e
, 
b
 +ƒ, 
block_size
 -ƒ);

550 
e
 -ğ
dœ_’d
;

551 
	`SET_TOTAL_FREE
(
p
, 
e
);

552 
	`SET_MAX_FREE
(
p
, 
e
);

553 
	}
}

559 
	gB¿ssTabË
::
	$¥l™_roÙ
(
ušt4
 
¥l™_n
)

561 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::¥l™_roÙ", 
¥l™_n
);

563 ++
Ëv–
;

567 ià(
Ëv–
 =ğ
BTREE_CURSOR_LEVELS
) {

568 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("BŒ“ ha growÀimpossibly†¬g("
	`STRINGIZE
(
BTREE_CURSOR_LEVELS
)"†evels)");

571 
by‹
 * 
q
 = 
	`z”Ûd_Ãw
(
block_size
);

572 
C
[
Ëv–
].
p
 = 
q
;

573 
C
[
Ëv–
].
c
 = 
DIR_START
;

574 
C
[
Ëv–
].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

575 
C
[
Ëv–
].
»wr™e
 = 
Œue
;

576 
	`SET_REVISION
(
q
, 
Ï‹¡_»visiÚ_numb”
 + 1);

577 
	`SET_LEVEL
(
q
, 
Ëv–
);

578 
	`SET_DIR_END
(
q
, 
DIR_START
);

579 
	`com·ù
(
q
);

582 
by‹
 
b
[10];

583 
I‹m_wr
 
	`™em
(
b
);

584 
™em
.
	`fÜm_nuÎ_key
(
¥l™_n
);

585 
	`add_™em
(
™em
, 
Ëv–
);

586 
	}
}

604 
	gB¿ssTabË
::
	$’‹r_key
(
j
, 
Key
 
´evkey
, Key 
Ãwkey
)

606 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::’‹r_key", 
j
 << ",…revkey,‚ewkey");

607 
	`As£¹
(
wr™abË
);

608 
	`As£¹
(
´evkey
 < 
Ãwkey
);

609 
	`As£¹R–
(
j
,>=,1);

611 
ušt4
 
blocknumb”
 = 
C
[
j
 - 1].
n
;

615 cÚ¡ 
Ãwkey_Ën
 = 
Ãwkey
.
	`Ëngth
();

616 
	`As£¹R–
(
Ãwkey_Ën
,>,0);

617 
i
;

619 ià(
j
 == 1) {

622 
i
 = 0;

623 cÚ¡ 
mš_Ën
 = 
	`mš
(
Ãwkey_Ën
, 
´evkey
.
	`Ëngth
());

624 
i
 < 
mš_Ën
 && 
´evkey
[i] =ğ
Ãwkey
[i]) {

625 
i
++;

629 ià(
i
 < 
Ãwkey_Ën
) i++;

635 
i
 = 
Ãwkey_Ën
;

638 
by‹
 
b
[
UCHAR_MAX
 + 6];

639 
I‹m_wr
 
	`™em
(
b
);

640 
	`As£¹
(
i
 <ğ256 - 
I2
 - 
C2
);

641 
	`As£¹
(
i
 <ğ()(
b
è- 
I2
 - 
C2
 - 4);

642 
™em
.
	`£t_key_ªd_block
(
Ãwkey
, 
i
, 
blocknumb”
);

647 ià(
j
 > 1) {

648 
by‹
 * 
p
 = 
C
[
j
 - 1].p;

649 
ušt4
 
n
 = 
	`g‘št4
(
Ãwkey
.
	`g‘_add»ss
(), 
Ãwkey_Ën
 + 
K1
 + 
C2
);

650 
Ãw_tÙ®_ä“
 = 
	`TOTAL_FREE
(
p
è+ 
Ãwkey_Ën
 + 
C2
;

652 
	`I‹m_wr
(
cÚ¡_ÿ¡
<
by‹
*>(
Ãwkey
.
	`g‘_add»ss
()è- 
I2
).
	`fÜm_nuÎ_key
(
n
);

653 
	`SET_TOTAL_FREE
(
p
, 
Ãw_tÙ®_ä“
);

656 
C
[
j
].
c
 = 
	`fšd_š_block
(C[j].
p
, 
™em
.
	`key
(), 
çl£
, 0è+ 
D2
;

657 
C
[
j
].
»wr™e
 = 
Œue
;

658 
	`add_™em
(
™em
, 
j
);

659 
	}
}

666 
	gB¿ssTabË
::
	$mid_pošt
(
by‹
 * 
p
)

668 
	`LOGCALL
(
DB
, , "B¿ssTabË::mid_pošt", (*)
p
);

669 
n
 = 0;

670 
dœ_’d
 = 
	`DIR_END
(
p
);

671 
size
 = 
block_size
 - 
	`TOTAL_FREE
(
p
è- 
dœ_’d
;

672 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

673 
l
 = 
	`I‹m
(
p
, 
c
).
	`size
();

674 
n
 +ğ2 * 
l
;

675 ià(
n
 >ğ
size
) {

676 ià(
l
 < 
n
 - 
size
è
	`RETURN
(
c
);

677 
	`RETURN
(
c
 + 
D2
);

682 
	`As£¹
(
çl£
);

683 
	`RETURN
(0);

684 
	}
}

696 
	gB¿ssTabË
::
	$add_™em_to_block
(
by‹
 * 
p
, 
I‹m_wr
 
kt_
, 
c
)

698 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::add_™em_to_block", (*)
p
 << ", kt_, " << 
c
);

699 
	`As£¹
(
wr™abË
);

700 
dœ_’d
 = 
	`DIR_END
(
p
);

701 
kt_Ën
 = 
kt_
.
	`size
();

702 
Ãeded
 = 
kt_Ën
 + 
D2
;

703 
Ãw_tÙ®
 = 
	`TOTAL_FREE
(
p
è- 
Ãeded
;

704 
Ãw_max
 = 
	`MAX_FREE
(
p
è- 
Ãeded
;

706 
	`As£¹
(
Ãw_tÙ®
 >= 0);

708 
	`As£¹R–
(
	`MAX_FREE
(
p
),>=,
Ãeded
);

710 
	`As£¹
(
dœ_’d
 >ğ
c
);

712 
	`memmove
(
p
 + 
c
 + 
D2
,… + c, 
dœ_’d
 - c);

713 
dœ_’d
 +ğ
D2
;

714 
	`SET_DIR_END
(
p
, 
dœ_’d
);

716 
o
 = 
dœ_’d
 + 
Ãw_max
;

717 
	`£tD
(
p
, 
c
, 
o
);

718 
	`memmove
(
p
 + 
o
, 
kt_
.
	`g‘_add»ss
(), 
kt_Ën
);

720 
	`SET_MAX_FREE
(
p
, 
Ãw_max
);

722 
	`SET_TOTAL_FREE
(
p
, 
Ãw_tÙ®
);

723 
	}
}

731 
	gB¿ssTabË
::
	$add_™em
(
I‹m_wr
 
kt_
, 
j
)

733 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::add_™em", "kt_, " << 
j
);

734 
	`As£¹
(
wr™abË
);

735 
by‹
 * 
p
 = 
C
[
j
].p;

736 
c
 = 
C
[
j
].c;

737 
ušt4
 
n
;

739 
Ãeded
 = 
kt_
.
	`size
(è+ 
D2
;

740 ià(
	`TOTAL_FREE
(
p
è< 
Ãeded
) {

741 
m
;

747 ià(
£q_couÁ
 < 0) {

750 
m
 = 
	`mid_pošt
(
p
);

753 
m
 = 
c
;

756 
ušt4
 
¥l™_n
 = 
C
[
j
].
n
;

757 
C
[
j
].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

759 
	`memıy
(
¥l™_p
, 
p
, 
block_size
);

760 
	`SET_DIR_END
(
¥l™_p
, 
m
);

761 
	`com·ù
(
¥l™_p
);

764 
»sidue
 = 
	`DIR_END
(
p
è- 
m
;

765 
Ãw_dœ_’d
 = 
DIR_START
 + 
»sidue
;

766 
	`memmove
(
p
 + 
DIR_START
,… + 
m
, 
»sidue
);

767 
	`SET_DIR_END
(
p
, 
Ãw_dœ_’d
);

770 
	`com·ù
(
p
);

772 
boŞ
 
add_to_uµ”_h®f
;

773 ià(
£q_couÁ
 < 0) {

774 
add_to_uµ”_h®f
 = (
c
 >ğ
m
);

778 
add_to_uµ”_h®f
 = (
	`TOTAL_FREE
(
¥l™_p
è< 
Ãeded
);

781 ià(
add_to_uµ”_h®f
) {

782 
c
 -ğ(
m
 - 
DIR_START
);

783 
	`As£¹
(
£q_couÁ
 < 0 || 
c
 <ğ
DIR_START
 + 
D2
);

784 
	`As£¹
(
c
 >ğ
DIR_START
);

785 
	`As£¹
(
c
 <ğ
	`DIR_END
(
p
));

786 
	`add_™em_to_block
(
p
, 
kt_
, 
c
);

787 
n
 = 
C
[
j
].n;

789 
	`As£¹
(
c
 >ğ
DIR_START
);

790 
	`As£¹
(
c
 <ğ
	`DIR_END
(
¥l™_p
));

791 
	`add_™em_to_block
(
¥l™_p
, 
kt_
, 
c
);

792 
n
 = 
¥l™_n
;

794 
	`wr™e_block
(
¥l™_n
, 
¥l™_p
);

797 ià(
j
 =ğ
Ëv–
è
	`¥l™_roÙ
(
¥l™_n
);

801 
	`’‹r_key
(
j
 + 1,

802 
	`I‹m
(
¥l™_p
, 
	`DIR_END
(¥l™_pè- 
D2
).
	`key
(),

803 
	`I‹m
(
p
, 
DIR_START
).
	`key
());

805 
	`As£¹R–
(
	`TOTAL_FREE
(
p
),>=,
Ãeded
);

807 ià(
	`MAX_FREE
(
p
è< 
Ãeded
) {

808 
	`com·ù
(
p
);

809 
	`As£¹R–
(
	`MAX_FREE
(
p
),>=,
Ãeded
);

812 
	`add_™em_to_block
(
p
, 
kt_
, 
c
);

813 
n
 = 
C
[
j
].n;

815 ià(
j
 == 0) {

816 
chªged_n
 = 
n
;

817 
chªged_c
 = 
c
;

819 
	}
}

829 
	gB¿ssTabË
::
	$d–‘e_™em
(
j
, 
boŞ
 
»³©edly
)

831 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::d–‘e_™em", 
j
 << ", " << 
»³©edly
);

832 
	`As£¹
(
wr™abË
);

833 
by‹
 * 
p
 = 
C
[
j
].p;

834 
c
 = 
C
[
j
].c;

835 
kt_Ën
 = 
	`I‹m
(
p
, 
c
).
	`size
();

836 
dœ_’d
 = 
	`DIR_END
(
p
è- 
D2
;

838 
	`memmove
(
p
 + 
c
,… + c + 
D2
, 
dœ_’d
 - c);

839 
	`SET_DIR_END
(
p
, 
dœ_’d
);

840 
	`SET_MAX_FREE
(
p
, 
	`MAX_FREE
Õè+ 
D2
);

841 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè+ 
kt_Ën
 + 
D2
);

843 ià(!
»³©edly
) ;

844 ià(
j
 < 
Ëv–
) {

845 ià(
dœ_’d
 =ğ
DIR_START
) {

846 
ba£
.
	`ä“_block
(
C
[
j
].
n
);

847 
C
[
j
].
»wr™e
 = 
çl£
;

848 
C
[
j
].
n
 = 
BLK_UNUSED
;

849 
C
[
j
 + 1].
»wr™e
 = 
Œue
;

850 
	`d–‘e_™em
(
j
 + 1, 
Œue
);

853 
	`As£¹
(
j
 =ğ
Ëv–
);

854 
dœ_’d
 =ğ
DIR_START
 + 
D2
 && 
Ëv–
 > 0) {

856 
ušt4
 
Ãw_roÙ
 = 
	`I‹m
(
p
, 
DIR_START
).
	`block_giv’_by
();

857 
d–‘e
 [] 
p
;

858 
C
[
Ëv–
].
p
 = 0;

859 
ba£
.
	`ä“_block
(
C
[
Ëv–
].
n
);

860 
C
[
Ëv–
].
»wr™e
 = 
çl£
;

861 
C
[
Ëv–
].
n
 = 
BLK_UNUSED
;

862 
Ëv–
--;

864 
	`block_to_cursÜ
(
C
, 
Ëv–
, 
Ãw_roÙ
);

866 
p
 = 
C
[
Ëv–
].p;

867 
dœ_’d
 = 
	`DIR_END
(
p
);

870 
	}
}

902 
	gB¿ssTabË
::
	$add_kt
(
boŞ
 
found
)

904 
	`LOGCALL
(
DB
, , "B¿ssTabË::add_kt", 
found
);

905 
	`As£¹
(
wr™abË
);

906 
compÚ’ts
 = 0;

914 
	`®‹r
();

916 ià(
found
) {

917 
£q_couÁ
 = 
SEQ_START_POINT
;

918 
£qu’tŸl
 = 
çl£
;

920 
by‹
 * 
p
 = 
C
[0].p;

921 
c
 = 
C
[0].c;

922 
I‹m
 
	`™em
(
p
, 
c
);

923 
kt_size
 = 
kt
.
	`size
();

924 
Ãeded
 = 
kt_size
 - 
™em
.
	`size
();

926 
compÚ’ts
 = 
™em
.
	`compÚ’ts_of
();

928 ià(
Ãeded
 <= 0) {

930 
	`memmove
(
cÚ¡_ÿ¡
<
by‹
 *>(
™em
.
	`g‘_add»ss
()),

931 
kt
.
	`g‘_add»ss
(), 
kt_size
);

932 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè- 
Ãeded
);

935 
Ãw_max
 = 
	`MAX_FREE
(
p
è- 
kt_size
;

936 ià(
Ãw_max
 >= 0) {

937 
o
 = 
	`DIR_END
(
p
è+ 
Ãw_max
;

938 
	`memmove
(
p
 + 
o
, 
kt
.
	`g‘_add»ss
(), 
kt_size
);

939 
	`£tD
(
p
, 
c
, 
o
);

940 
	`SET_MAX_FREE
(
p
, 
Ãw_max
);

941 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè- 
Ãeded
);

944 
	`d–‘e_™em
(0, 
çl£
);

945 
	`add_™em
(
kt
, 0);

950 ià(
chªged_n
 =ğ
C
[0].
n
 && 
chªged_c
 =ğC[0].
c
) {

951 ià(
£q_couÁ
 < 0) seq_count++;

953 
£q_couÁ
 = 
SEQ_START_POINT
;

954 
£qu’tŸl
 = 
çl£
;

956 
C
[0].
c
 +ğ
D2
;

957 
	`add_™em
(
kt
, 0);

959 
	`RETURN
(
compÚ’ts
);

960 
	}
}

968 
	gB¿ssTabË
::
	$d–‘e_kt
()

970 
	`LOGCALL
(
DB
, , "BrassTable::delete_kt", "");

971 
	`As£¹
(
wr™abË
);

973 
boŞ
 
found
 = 
	`fšd
(
C
);

975 
compÚ’ts
 = 0;

976 
£q_couÁ
 = 
SEQ_START_POINT
;

977 
£qu’tŸl
 = 
çl£
;

985 ià(
found
) {

986 
compÚ’ts
 = 
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’ts_of
();

987 
	`®‹r
();

988 
	`d–‘e_™em
(0, 
Œue
);

990 
	`RETURN
(
compÚ’ts
);

991 
	}
}

1002 
	gB¿ssTabË
::
	$fÜm_key
(cÚ¡ 
¡ršg
 & 
key
) const

1004 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::fÜm_key", 
key
);

1005 
kt
.
	`fÜm_key
(
key
);

1006 
	}
}

1032 
	gB¿ssTabË
::
	$add
(cÚ¡ 
¡ršg
 &
key
, sŒšg 
g
, 
boŞ
 
®»ady_com´es£d
)

1034 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::add", 
key
 << ", " << 
g
 << ", " << 
®»ady_com´es£d
);

1035 
	`As£¹
(
wr™abË
);

1037 ià(
hªdË
 < 0è
	`ü—‹_ªd_İ’
(
block_size
);

1039 
	`fÜm_key
(
key
);

1041 
boŞ
 
com´es£d
 = 
çl£
;

1042 ià(
®»ady_com´es£d
) {

1043 
com´es£d
 = 
Œue
;

1044 } ià(
com´ess_¡¿‹gy
 !ğ
DONT_COMPRESS
 && 
g
.
	`size
(è> 
COMPRESS_MIN
) {

1045 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_DEFAULT_STRATEGY
);

1046 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_FILTERED
);

1047 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_HUFFMAN_ONLY
);

1048 #ifdeà
Z_RLE


1049 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_RLE
);

1052 
	`Ïzy_®loc_deæ©e_z¡»am
();

1054 
deæ©e_z¡»am
->
Ãxt_š
 = (
By‹f
 *)
cÚ¡_ÿ¡
<*>(
g
.
	`d©a
());

1055 
deæ©e_z¡»am
->
ava_š
 = (
uIÁ
)
g
.
	`size
();

1058 
blk_Ën
 = 
g
.
	`size
() - 1;

1059 * 
blk
 = 
Ãw
 [
blk_Ën
];

1060 
deæ©e_z¡»am
->
Ãxt_out
 = 
blk
;

1061 
deæ©e_z¡»am
->
ava_out
 = (
uIÁ
)
blk_Ën
;

1063 
”r
 = 
	`deæ©e
(
deæ©e_z¡»am
, 
Z_FINISH
);

1064 ià(
”r
 =ğ
Z_STREAM_END
) {

1067 
g
.
	`assign
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
blk
), 
deæ©e_z¡»am
->
tÙ®_out
);

1068 
com´es£d
 = 
Œue
;

1073 
d–‘e
 [] 
blk
;

1077 cÚ¡ 
size_t
 
cd
 = 
kt
.
	`key
().
	`Ëngth
(è+ 
K1
 + 
I2
 + 
C2
 + C2;

1078 cÚ¡ 
size_t
 
L
 = 
max_™em_size
 - 
cd
;

1079 
size_t
 
fœ¡_L
 = 
L
;

1080 
boŞ
 
found
 = 
	`fšd
(
C
);

1081 ià(!
found
) {

1082 
by‹
 * 
p
 = 
C
[0].p;

1083 
size_t
 
n
 = 
	`TOTAL_FREE
(
p
è% (
max_™em_size
 + 
D2
);

1084 ià(
n
 > 
D2
 + 
cd
) {

1085 
n
 -ğ(
D2
 + 
cd
);

1098 
size_t
 
Ï¡
 = 
g
.
	`Ëngth
(è% 
L
;

1099 ià(
n
 >ğ
Ï¡
 || (
fuÎ_com·ùiÚ
 &&‚ >ğ
key
.
	`size
() + 34))

1100 
fœ¡_L
 = 
n
;

1105 
m
 = 
g
.
	`em±y
(è? 1 : (g.
	`Ëngth
(è- 
fœ¡_L
 + 
L
 - 1) / L + 1;

1110 ià(
m
 >ğ
BYTE_PAIR_RANGE
)

1111 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Can't handle insanely†argeags");

1113 
n
 = 0;

1115 
o
 = 0;

1116 
size_t
 
»sidue
 = 
g
.
	`Ëngth
();

1117 
»¶aûm’t
 = 
çl£
;

1118 
i
;

1119 
kt
.
	`£t_compÚ’ts_of
(
m
);

1120 
i
 = 1; i <ğ
m
; i++) {

1121 
size_t
 
l
 = (
i
 =ğ
m
 ? 
»sidue
 : (˜=ğ1 ? 
fœ¡_L
 : 
L
));

1122 
	`As£¹
(
cd
 + 
l
 <ğ
block_size
);

1123 
	`As£¹
(
¡ršg
::
	`size_ty³
(
o
 + 
l
è<ğ
g
.
	`Ëngth
());

1124 
kt
.
	`£t_g
(
cd
, 
g
.
	`d©a
(è+ 
o
, 
l
, 
com´es£d
);

1125 
kt
.
	`£t_compÚ’t_of
(
i
);

1127 
o
 +ğ
l
;

1128 
»sidue
 -ğ
l
;

1130 ià(
i
 > 1è
found
 = 
	`fšd
(
C
);

1131 
n
 = 
	`add_kt
(
found
);

1132 ià(
n
 > 0è
»¶aûm’t
 = 
Œue
;

1135 
i
 = 
m
 + 1; i <ğ
n
; i++) {

1136 
kt
.
	`£t_compÚ’t_of
(
i
);

1137 
	`d–‘e_kt
();

1139 ià(!
»¶aûm’t
è++
™em_couÁ
;

1140 
BŒ“_modif›d
 = 
Œue
;

1141 
	}
}

1149 
boŞ


1150 
	gB¿ssTabË
::
	$d–
(cÚ¡ 
¡ršg
 &
key
)

1152 
	`LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::d–", 
key
);

1153 
	`As£¹
(
wr™abË
);

1155 ià(
hªdË
 < 0) {

1156 ià(
hªdË
 == -2) {

1157 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1159 
	`RETURN
(
çl£
);

1163 ià(
key
.
	`size
(è> 
BRASS_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1165 ià(
key
.
	`em±y
()è
	`RETURN
(
çl£
);

1166 
	`fÜm_key
(
key
);

1168 
n
 = 
	`d–‘e_kt
();

1169 ià(
n
 <ğ0è
	`RETURN
(
çl£
);

1171 
i
 = 2; i <ğ
n
; i++) {

1172 
kt
.
	`£t_compÚ’t_of
(
i
);

1173 
	`d–‘e_kt
();

1176 
™em_couÁ
--;

1177 
BŒ“_modif›d
 = 
Œue
;

1178 
	`RETURN
(
Œue
);

1179 
	}
}

1181 
boŞ


1182 
	gB¿ssTabË
::
	$g‘_exaù_’Œy
(cÚ¡ 
¡ršg
 &
key
, sŒšg & 
g
) const

1184 
	`LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::g‘_exaù_’Œy", 
key
 << ", [&tag]");

1185 
	`As£¹
(!
key
.
	`em±y
());

1187 ià(
hªdË
 < 0) {

1188 ià(
hªdË
 == -2) {

1189 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1191 
	`RETURN
(
çl£
);

1195 ià(
key
.
	`size
(è> 
BRASS_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1197 
	`fÜm_key
(
key
);

1198 ià(!
	`fšd
(
C
)è
	`RETURN
(
çl£
);

1200 ()
	`»ad_g
(
C
, &
g
, 
çl£
);

1201 
	`RETURN
(
Œue
);

1202 
	}
}

1204 
boŞ


1205 
	gB¿ssTabË
::
	$key_exi¡s
(cÚ¡ 
¡ršg
 &
key
) const

1207 
	`LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::key_exi¡s", 
key
);

1208 
	`As£¹
(!
key
.
	`em±y
());

1211 ià(
key
.
	`size
(è> 
BRASS_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1213 
	`fÜm_key
(
key
);

1214 
	`RETURN
(
	`fšd
(
C
));

1215 
	}
}

1217 
boŞ


1218 
	gB¿ssTabË
::
»ad_g
(
B¿ss
::
CursÜ
 * 
C_
, 
¡ršg
 *
g
, 
boŞ
 
k“p_com´es£d
) const

1220 
LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::»ad_g", "C_,ag, " << 
k“p_com´es£d
);

1221 
I‹m
 
™em
(
C_
[0].
p
, C_[0].
c
);

1224 
	gn
 = 
™em
.
compÚ’ts_of
();

1226 
	gg
->
»size
(0);

1229 ià(
	gn
 > 1è
	gg
->
»£rve
((
max_™em_size
 - (1 + 
K1
 + 
I2
 + 
C2
 + C2)è* 
n
);

1231 
	g™em
.
­³nd_chunk
(
g
);

1232 
boŞ
 
	gcom´es£d
 = 
™em
.
g‘_com´es£d
();

1234 
	gi
 = 2; i <ğ
n
; i++) {

1235 ià(!
Ãxt
(
C_
, 0)) {

1236 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Unexpectedƒnd ofable when„eading continuation ofag");

1238 ()
I‹m
(
C_
[0].
p
, C_[0].
c
).
­³nd_chunk
(
g
);

1242 ià(!
	gcom´es£d
 || 
	gk“p_com´es£d
è
RETURN
(
com´es£d
);

1248 
¡ršg
 
	gug
;

1250 
	gug
.
»£rve
(
g
->
size
() +ag->size() / 2);

1252 
By‹f
 
	gbuf
[8192];

1254 
Ïzy_®loc_šæ©e_z¡»am
();

1256 
	gšæ©e_z¡»am
->
	gÃxt_š
 = (
By‹f
*)
cÚ¡_ÿ¡
<*>(
g
->
d©a
());

1257 
	gšæ©e_z¡»am
->
	gava_š
 = (
uIÁ
)
g
->
size
();

1259 
	g”r
 = 
Z_OK
;

1260 
	g”r
 !ğ
Z_STREAM_END
) {

1261 
šæ©e_z¡»am
->
Ãxt_out
 = 
buf
;

1262 
	gšæ©e_z¡»am
->
	gava_out
 = (
uIÁ
)(
buf
);

1263 
	g”r
 = 
šæ©e
(
šæ©e_z¡»am
, 
Z_SYNC_FLUSH
);

1264 ià(
	g”r
 =ğ
Z_BUF_ERROR
 && 
šæ©e_z¡»am
->
ava_š
 == 0) {

1265 
LOGLINE
(
DB
, "Z_BUF_ERROR - fakšg checksum oà" << 
šæ©e_z¡»am
->
adËr
);

1266 
By‹f
 
	gh—d”2
[4];

1267 
£tšt4
(
h—d”2
, 0, 
šæ©e_z¡»am
->
adËr
);

1268 
	gšæ©e_z¡»am
->
	gÃxt_š
 = 
h—d”2
;

1269 
	gšæ©e_z¡»am
->
	gava_š
 = 4;

1270 
	g”r
 = 
šæ©e
(
šæ©e_z¡»am
, 
Z_SYNC_FLUSH
);

1271 ià(
	g”r
 =ğ
Z_STREAM_END
) ;

1274 ià(
	g”r
 !ğ
Z_OK
 && 
”r
 !ğ
Z_STREAM_END
) {

1275 ià(
”r
 =ğ
Z_MEM_ERROR
è
throw
 
¡d
::
bad_®loc
();

1276 
¡ršg
 
	gmsg
 = "inflate failed";

1277 ià(
	gšæ©e_z¡»am
->
	gmsg
) {

1278 
	gmsg
 += " (";

1279 
	gmsg
 +ğ
šæ©e_z¡»am
->
msg
;

1280 
	gmsg
 += ')';

1282 
throw
 
	gX­Ÿn
::
D©aba£E¼Ü
(
msg
);

1285 
	gug
.
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
),

1286 
šæ©e_z¡»am
->
Ãxt_out
 - 
buf
);

1288 ià(
	gug
.
size
(è!ğ
šæ©e_z¡»am
->
tÙ®_out
) {

1289 
¡ršg
 
msg
 = "compressedag didn'tƒxpandoheƒxpected size: ";

1290 
	gmsg
 +ğ
om_to¡ršg
(
ug
.
size
());

1291 
	gmsg
 += " != ";

1293 
	gmsg
 +ğ
om_to¡ršg
((
size_t
)
šæ©e_z¡»am
->
tÙ®_out
);

1294 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
(
msg
);

1297 
sw­
(*
g
, 
ug
);

1299 
RETURN
(
çl£
);

1303 
	gB¿ssTabË
::
	$£t_fuÎ_com·ùiÚ
(
boŞ
 
·r™y
)

1305 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::£t_fuÎ_com·ùiÚ", 
·r™y
);

1306 
	`As£¹
(
wr™abË
);

1308 ià(
·r™y
è
£q_couÁ
 = 0;

1309 
fuÎ_com·ùiÚ
 = 
·r™y
;

1310 
	}
}

1312 
B¿ssCursÜ
 * 
	gB¿ssTabË
::
	$cursÜ_g‘
() const {

1313 
	`LOGCALL
(
DB
, 
B¿ssCursÜ
 *, "BrassTable::cursor_get", "");

1314 ià(
hªdË
 < 0) {

1315 ià(
hªdË
 == -2) {

1316 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1318 
	`RETURN
(
NULL
);

1321 
	`RETURN
(
Ãw
 
	`B¿ssCursÜ
(
cÚ¡_ÿ¡
<
B¿ssTabË
 *>(
this
)));

1322 
	}
}

1326 
boŞ


1327 
	gB¿ssTabË
::
	$basic_İ’
(
boŞ
 
»visiÚ_suµl›d
, 
b¿ss_»visiÚ_numb”_t
 
»visiÚ_
)

1329 
	`LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::basic_İ’", 
»visiÚ_suµl›d
 << ", " << 
»visiÚ_
);

1330 
ch
 = 'X';

1333 cÚ¡ 
size_t
 
BTREE_BASES
 = 2;

1334 
¡ršg
 
”r_msg
;

1335 cÚ¡ 
ba£Çmes
[
BTREE_BASES
] = { 'A', 'B' };

1337 
B¿ssTabË_ba£
 
ba£s
[
BTREE_BASES
];

1338 
boŞ
 
ba£_ok
[
BTREE_BASES
];

1340 
bÙh_ba£s
 = 
Œue
;

1341 
boŞ
 
v®id_ba£
 = 
çl£
;

1343 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1344 
boŞ
 
ok
 = 
ba£s
[
i
].
	`»ad
(
Çme
, 
ba£Çmes
[i], 
”r_msg
);

1345 
ba£_ok
[
i
] = 
ok
;

1346 ià(
ok
) {

1347 
v®id_ba£
 = 
Œue
;

1349 
bÙh_ba£s
 = 
çl£
;

1354 ià(!
v®id_ba£
) {

1355 ià(
hªdË
 >= 0) {

1356 ::
	`şo£
(
hªdË
);

1357 
hªdË
 = -1;

1359 
¡ršg
 
mes§ge
 = "Error openingable `";

1360 
mes§ge
 +ğ
Çme
;

1361 
mes§ge
 += "':\n";

1362 
mes§ge
 +ğ
”r_msg
;

1363 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

1366 ià(
»visiÚ_suµl›d
) {

1367 
boŞ
 
found_»visiÚ
 = 
çl£
;

1368 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1369 ià(
ba£_ok
[
i
] && 
ba£s
[i].
	`g‘_»visiÚ
(è=ğ
»visiÚ_
) {

1370 
ch
 = 
ba£Çmes
[
i
];

1371 
found_»visiÚ
 = 
Œue
;

1375 ià(!
found_»visiÚ
) {

1380 
	`RETURN
(
çl£
);

1383 
b¿ss_»visiÚ_numb”_t
 
highe¡_»visiÚ
 = 0;

1384 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1385 ià(
ba£_ok
[
i
] && 
ba£s
[i].
	`g‘_»visiÚ
(è>ğ
highe¡_»visiÚ
) {

1386 
ch
 = 
ba£Çmes
[
i
];

1387 
highe¡_»visiÚ
 = 
ba£s
[
i
].
	`g‘_»visiÚ
();

1392 
B¿ssTabË_ba£
 *
ba£p
 = 0;

1393 
B¿ssTabË_ba£
 *
Ùh”_ba£
 = 0;

1395 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1396 
	`LOGLINE
(
DB
, "Checkšg (ch =ğ" << 
ch
 << ")‡gainst "

1397 "ba£Çmes[" << 
i
 << "] =ğ" << 
ba£Çmes
[i]);

1398 
	`LOGLINE
(
DB
, "ba£s[" << 
i
 << "].get_revision() == " <<

1399 
ba£s
[
i
].
	`g‘_»visiÚ
());

1400 
	`LOGLINE
(
DB
, "ba£_ok[" << 
i
 << "] =ğ" << 
ba£_ok
[i]);

1401 ià(
ch
 =ğ
ba£Çmes
[
i
]) {

1402 
ba£p
 = &
ba£s
[
i
];

1405 
size_t
 
Ùh”ba£_num
 = 1-
i
;

1406 ià(
ba£_ok
[
Ùh”ba£_num
]) {

1407 
Ùh”_ba£
 = &
ba£s
[
Ùh”ba£_num
];

1412 
	`As£¹
(
ba£p
);

1419 
ba£
.
	`sw­
(*
ba£p
);

1421 
»visiÚ_numb”
 = 
ba£
.
	`g‘_»visiÚ
();

1422 
block_size
 = 
ba£
.
	`g‘_block_size
();

1423 
roÙ
 = 
ba£
.
	`g‘_roÙ
();

1424 
Ëv–
 = 
ba£
.
	`g‘_Ëv–
();

1426 
™em_couÁ
 = 
ba£
.
	`g‘_™em_couÁ
();

1427 
çked_roÙ_block
 = 
ba£
.
	`g‘_have_çk”oÙ
();

1428 
£qu’tŸl
 = 
ba£
.
	`g‘_£qu’tŸl
();

1430 ià(
Ùh”_ba£
 != 0) {

1431 
Ï‹¡_»visiÚ_numb”
 = 
Ùh”_ba£
->
	`g‘_»visiÚ
();

1432 ià(
»visiÚ_numb”
 > 
Ï‹¡_»visiÚ_numb”
)

1433 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1435 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1440 
kt
 = 
	`I‹m_wr
(
	`z”Ûd_Ãw
(
block_size
));

1442 
	`£t_max_™em_size
(
BLOCK_CAPACITY
);

1444 
ba£_Ë‰”
 = 
ch
;

1448 
	`RETURN
(
Œue
);

1449 
	}
}

1452 
	gB¿ssTabË
::
	$»ad_roÙ
()

1454 
	`LOGCALL_VOID
(
DB
, "BrassTable::read_root", "");

1455 ià(
çked_roÙ_block
) {

1457 
by‹
 * 
p
 = 
C
[0].p;

1458 
	`As£¹
(
p
);

1463 
	`mem£t
(
p
, 0, 
block_size
);

1465 
o
 = 
block_size
 - 
I2
 - 
K1
 - 
C2
 - C2;

1466 
	`I‹m_wr
(
p
 + 
o
).
	`çke_roÙ_™em
();

1468 
	`£tD
(
p
, 
DIR_START
, 
o
);

1469 
	`SET_DIR_END
(
p
, 
DIR_START
 + 
D2
);

1471 
o
 -ğ(
DIR_START
 + 
D2
);

1472 
	`SET_MAX_FREE
(
p
, 
o
);

1473 
	`SET_TOTAL_FREE
(
p
, 
o
);

1474 
	`SET_LEVEL
(
p
, 0);

1476 ià(!
wr™abË
) {

1479 
	`SET_REVISION
(
p
, 0);

1480 
C
[0].
n
 = 0;

1483 
	`SET_REVISION
(
p
, 
Ï‹¡_»visiÚ_numb”
 + 1);

1484 
C
[0].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

1488 
	`block_to_cursÜ
(
C
, 
Ëv–
, 
roÙ
);

1490 ià(
	`REVISION
(
C
[
Ëv–
].
p
è> 
»visiÚ_numb”
è
	`£t_ov”wr™‹n
();

1493 
	}
}

1495 
boŞ


1496 
	gB¿ssTabË
::
	$do_İ’_to_wr™e
(
boŞ
 
»visiÚ_suµl›d
,

1497 
b¿ss_»visiÚ_numb”_t
 
»visiÚ_
,

1498 
boŞ
 
ü—‹_db
)

1500 
	`LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::do_İ’_to_wr™e", 
»visiÚ_suµl›d
 << ", " << 
»visiÚ_
 << ", " << 
ü—‹_db
);

1501 ià(
hªdË
 == -2) {

1502 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1504 
æags
 = 
O_RDWR
 | 
O_BINARY
;

1505 ià(
ü—‹_db
è
æags
 |ğ
O_CREAT
 | 
O_TRUNC
;

1506 
hªdË
 = ::
	`İ’
((
Çme
 + "DB").
	`c_¡r
(), 
æags
, 0666);

1507 ià(
hªdË
 < 0) {

1510 ià(
Ïzy
 && !
ü—‹_db
 && 
”ºo
 =ğ
ENOENT
) {

1511 
»visiÚ_numb”
 = 
»visiÚ_
;

1512 
	`RETURN
(
Œue
);

1514 
¡ršg
 
	`mes§ge
(
ü—‹_db
 ? "Couldn't create " : "Couldn't open ");

1515 
mes§ge
 +ğ
Çme
;

1516 
mes§ge
 += "DB„ead/write: ";

1517 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

1518 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

1521 ià(!
	`basic_İ’
(
»visiÚ_suµl›d
, 
»visiÚ_
)) {

1522 ::
	`şo£
(
hªdË
);

1523 
hªdË
 = -1;

1524 ià(!
»visiÚ_suµl›d
) {

1525 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Failedo open for writing");

1530 
	`RETURN
(
çl£
);

1533 
wr™abË
 = 
Œue
;

1535 
j
 = 0; j <ğ
Ëv–
; j++) {

1536 
C
[
j
].
n
 = 
BLK_UNUSED
;

1537 
C
[
j
].
p
 = 
Ãw
 
by‹
[
block_size
];

1538 ià(
C
[
j
].
p
 == 0) {

1539 
throw
 
¡d
::
	`bad_®loc
();

1542 
¥l™_p
 = 
Ãw
 
by‹
[
block_size
];

1543 ià(
¥l™_p
 == 0) {

1544 
throw
 
¡d
::
	`bad_®loc
();

1546 
	`»ad_roÙ
();

1548 
bufãr
 = 
	`z”Ûd_Ãw
(
block_size
);

1550 
chªged_n
 = 0;

1551 
chªged_c
 = 
DIR_START
;

1552 
£q_couÁ
 = 
SEQ_START_POINT
;

1554 
	`RETURN
(
Œue
);

1555 
	}
}

1557 
	gB¿ssTabË
::
	$B¿ssTabË
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡ršg
 & 
·th_
,

1558 
boŞ
 
»adÚly_
, 
com´ess_¡¿‹gy_
, boŞ 
Ïzy_
)

1559 : 
	`bËÇme
(
bËÇme_
),

1560 
	`»visiÚ_numb”
(0),

1561 
	`™em_couÁ
(0),

1562 
	`block_size
(0),

1563 
	`Ï‹¡_»visiÚ_numb”
(0),

1564 
	`bÙh_ba£s
(
çl£
),

1565 
	`ba£_Ë‰”
('A'),

1566 
	`çked_roÙ_block
(
Œue
),

1567 
	`£qu’tŸl
(
Œue
),

1568 
	`hªdË
(-1),

1569 
	`Ëv–
(0),

1570 
	`roÙ
(0),

1571 
	`kt
(0),

1572 
	`bufãr
(0),

1573 
	`ba£
(),

1574 
	`Çme
(
·th_
),

1575 
	`£q_couÁ
(0),

1576 
	`chªged_n
(0),

1577 
	`chªged_c
(0),

1578 
	`max_™em_size
(0),

1579 
	`BŒ“_modif›d
(
çl£
),

1580 
	`fuÎ_com·ùiÚ
(
çl£
),

1581 
	`wr™abË
(!
»adÚly_
),

1582 
	`¥l™_p
(0),

1583 
	`com´ess_¡¿‹gy
(
com´ess_¡¿‹gy_
),

1584 
	`deæ©e_z¡»am
(
NULL
),

1585 
	`šæ©e_z¡»am
(
NULL
),

1586 
	$Ïzy
(
Ïzy_
)

1588 
	`LOGCALL_CTOR
(
DB
, "BrassTable",

1589 
bËÇme_
 << "," << 
·th_
 << ", " << 
»adÚly_
 << ", " <<

1590 
com´ess_¡¿‹gy_
 << ", " << 
Ïzy_
);

1591 
	}
}

1593 
boŞ


1594 
	gB¿ssTabË
::
	$»®ly_em±y
() const

1596 ià(
hªdË
 < 0) {

1597 ià(
hªdË
 == -2) {

1598 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1600  
Œue
;

1602 
B¿ssCursÜ
 
	`cur
(
cÚ¡_ÿ¡
<
B¿ssTabË
*>(
this
));

1603 
cur
.
	`fšd_’Œy
(
	`¡ršg
());

1604  !
cur
.
	`Ãxt
();

1605 
	}
}

1608 
	gB¿ssTabË
::
	$Ïzy_®loc_deæ©e_z¡»am
() const {

1609 ià(
	`usu®
(
deæ©e_z¡»am
)) {

1610 ià(
	`usu®
(
	`deæ©eRe£t
(
deæ©e_z¡»am
è=ğ
Z_OK
)) ;

1612 
d–‘e
 
deæ©e_z¡»am
;

1615 
deæ©e_z¡»am
 = 
Ãw
 
z_¡»am
;

1617 
deæ©e_z¡»am
->
z®loc
 = 
»š‹½»t_ÿ¡
<
®loc_func
>(0);

1618 
deæ©e_z¡»am
->
zä“
 = 
»š‹½»t_ÿ¡
<
ä“_func
>(0);

1619 
deæ©e_z¡»am
->
İaque
 = (
voidpf
)0;

1623 
”r
;

1624 
”r
 = 
	`deæ©eIn™2
(
deæ©e_z¡»am
, 
Z_DEFAULT_COMPRESSION
, 
Z_DEFLATED
,

1625 -15, 9, 
com´ess_¡¿‹gy
);

1626 ià(
	`¿»
(
”r
 !ğ
Z_OK
)) {

1627 ià(
”r
 =ğ
Z_MEM_ERROR
) {

1628 
d–‘e
 
deæ©e_z¡»am
;

1629 
deæ©e_z¡»am
 = 0;

1630 
throw
 
¡d
::
	`bad_®loc
();

1632 
¡ršg
 
msg
 = "deflateInit2 failed (";

1633 ià(
deæ©e_z¡»am
->
msg
) {

1634 
msg
 +ğ
deæ©e_z¡»am
->msg;

1636 
msg
 +ğ
	`om_to¡ršg
(
”r
);

1638 
msg
 += ')';

1639 
d–‘e
 
deæ©e_z¡»am
;

1640 
deæ©e_z¡»am
 = 0;

1641 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1643 
	}
}

1646 
	gB¿ssTabË
::
	$Ïzy_®loc_šæ©e_z¡»am
() const {

1647 ià(
	`usu®
(
šæ©e_z¡»am
)) {

1648 ià(
	`usu®
(
	`šæ©eRe£t
(
šæ©e_z¡»am
è=ğ
Z_OK
)) ;

1650 
d–‘e
 
šæ©e_z¡»am
;

1653 
šæ©e_z¡»am
 = 
Ãw
 
z_¡»am
;

1655 
šæ©e_z¡»am
->
z®loc
 = 
»š‹½»t_ÿ¡
<
®loc_func
>(0);

1656 
šæ©e_z¡»am
->
zä“
 = 
»š‹½»t_ÿ¡
<
ä“_func
>(0);

1658 
šæ©e_z¡»am
->
Ãxt_š
 = 
Z_NULL
;

1659 
šæ©e_z¡»am
->
ava_š
 = 0;

1661 
”r
 = 
	`šæ©eIn™2
(
šæ©e_z¡»am
, -15);

1662 ià(
	`¿»
(
”r
 !ğ
Z_OK
)) {

1663 ià(
”r
 =ğ
Z_MEM_ERROR
) {

1664 
d–‘e
 
šæ©e_z¡»am
;

1665 
šæ©e_z¡»am
 = 0;

1666 
throw
 
¡d
::
	`bad_®loc
();

1668 
¡ršg
 
msg
 = "inflateInit2 failed (";

1669 ià(
šæ©e_z¡»am
->
msg
) {

1670 
msg
 +ğ
šæ©e_z¡»am
->msg;

1672 
msg
 +ğ
	`om_to¡ršg
(
”r
);

1674 
msg
 += ')';

1675 
d–‘e
 
šæ©e_z¡»am
;

1676 
šæ©e_z¡»am
 = 0;

1677 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1679 
	}
}

1681 
boŞ


1682 
	gB¿ssTabË
::
	$exi¡s
() const {

1683 
	`LOGCALL
(
DB
, 
boŞ
, "BrassTable::exists", "");

1684  (
	`fe_exi¡s
(
Çme
 + "DB") &&

1685 (
	`fe_exi¡s
(
Çme
 + "baseA") || file_exists(name + "baseB")));

1686 
	}
}

1692 
	$sys_uÆšk_if_exi¡s
(cÚ¡ 
¡ršg
 & 
f’ame
)

1694 #ifdeà
__WIN32__


1695 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

1697 ià(
	`uÆšk
(
f’ame
) == -1) {

1699 ià(
”ºo
 =ğ
ENOENT
) ;

1700 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Cª'ˆd–‘fe: `" + 
f’ame
 +

1701 "': " + 
	`¡»¼Ü
(
”ºo
));

1703 
	}
}

1706 
	gB¿ssTabË
::
	$”a£
()

1708 
	`LOGCALL_VOID
(
DB
, "BrassTable::erase", "");

1709 
	`şo£
();

1711 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseA");

1712 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseB");

1713 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "DB");

1714 
	}
}

1717 
	gB¿ssTabË
::
	$£t_block_size
(
block_size_
)

1719 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::£t_block_size", 
block_size_
);

1721 ià(
block_size_
 < 2048 || block_size_ > 
BYTE_PAIR_RANGE
 ||

1722 (
block_size_
 & (block_size_ - 1)) != 0) {

1723 
block_size_
 = 
BRASS_DEFAULT_BLOCK_SIZE
;

1725 
block_size
 = 
block_size_
;

1726 
	}
}

1729 
	gB¿ssTabË
::
	$ü—‹_ªd_İ’
(
block_size_
)

1731 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::ü—‹_ªd_İ’", 
block_size_
);

1732 ià(
hªdË
 == -2) {

1733 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1735 
	`As£¹
(
wr™abË
);

1736 
	`şo£
();

1738 ià(
block_size_
 =ğ0è
	`abÜt
();

1739 
	`£t_block_size
(
block_size_
);

1748 
B¿ssTabË_ba£
 
ba£_
;

1749 
ba£_
.
	`£t_»visiÚ
(
»visiÚ_numb”
);

1750 
ba£_
.
	`£t_block_size
(
block_size_
);

1751 
ba£_
.
	`£t_have_çk”oÙ
(
Œue
);

1752 
ba£_
.
	`£t_£qu’tŸl
(
Œue
);

1753 
ba£_
.
	`wr™e_to_fe
(
Çme
 + "ba£A", 'A', 
	`¡ršg
(), -1, 
NULL
);

1756 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseB");

1759 ()
	`do_İ’_to_wr™e
(
çl£
, 0, 
Œue
);

1760 
	}
}

1762 
	gB¿ssTabË
::~
	$B¿ssTabË
() {

1763 
	`LOGCALL_DTOR
(
DB
, "BrassTable");

1764 
B¿ssTabË
::
	`şo£
();

1766 ià(
deæ©e_z¡»am
) {

1769 (è
	`deæ©eEnd
(
deæ©e_z¡»am
);

1770 
d–‘e
 
deæ©e_z¡»am
;

1773 ià(
šæ©e_z¡»am
) {

1776 (è
	`šæ©eEnd
(
šæ©e_z¡»am
);

1777 
d–‘e
 
šæ©e_z¡»am
;

1779 
	}
}

1781 
	gB¿ssTabË
::
	$şo£
(
boŞ
 
³rmª’t
) {

1782 
	`LOGCALL_VOID
(
DB
, "BrassTable::close", "");

1784 ià(
hªdË
 >= 0) {

1787 ()::
	`şo£
(
hªdË
);

1788 
hªdË
 = -1;

1791 ià(
³rmª’t
) {

1792 
hªdË
 = -2;

1797 
j
 = 
Ëv–
; j >= 0; j--) {

1798 
d–‘e
 [] 
C
[
j
].
p
;

1799 
C
[
j
].
p
 = 0;

1801 
d–‘e
 [] 
¥l™_p
;

1802 
¥l™_p
 = 0;

1804 
d–‘e
 [] 
kt
.
	`g‘_add»ss
();

1805 
kt
 = 0;

1806 
d–‘e
 [] 
bufãr
;

1807 
bufãr
 = 0;

1808 
	}
}

1811 
	gB¿ssTabË
::
	$æush_db
()

1813 
	`LOGCALL_VOID
(
DB
, "BrassTable::flush_db", "");

1814 
	`As£¹
(
wr™abË
);

1815 ià(
hªdË
 < 0) {

1816 ià(
hªdË
 == -2) {

1817 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1822 
j
 = 
Ëv–
; j >= 0; j--) {

1823 ià(
C
[
j
].
»wr™e
) {

1824 
	`wr™e_block
(
C
[
j
].
n
, C[j].
p
);

1828 ià(
BŒ“_modif›d
) {

1829 
çked_roÙ_block
 = 
çl£
;

1831 
	}
}

1834 
	gB¿ssTabË
::
	$comm™
(
b¿ss_»visiÚ_numb”_t
 
»visiÚ
, 
chªges_fd
,

1835 cÚ¡ 
¡ršg
 * 
chªges_
)

1837 
	`LOGCALL_VOID
(
DB
, "BrassTable::commit",

1838 
»visiÚ
 << ", " << 
chªges_fd
 << ", " << 
chªges_
);

1839 
	`As£¹
(
wr™abË
);

1841 ià(
»visiÚ
 <ğ
»visiÚ_numb”
) {

1842 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("New„evisionoo†ow");

1845 ià(
hªdË
 < 0) {

1846 ià(
hªdË
 == -2) {

1847 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1849 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
 = 
»visiÚ
;

1853 
Œy
 {

1854 ià(
çked_roÙ_block
) {

1856 
ba£
.
	`ş—r_b™_m­
();

1859 
ba£
.
	`£t_»visiÚ
(
»visiÚ
);

1860 
ba£
.
	`£t_roÙ
(
C
[
Ëv–
].
n
);

1861 
ba£
.
	`£t_Ëv–
(
Ëv–
);

1862 
ba£
.
	`£t_™em_couÁ
(
™em_couÁ
);

1863 
ba£
.
	`£t_have_çk”oÙ
(
çked_roÙ_block
);

1864 
ba£
.
	`£t_£qu’tŸl
(
£qu’tŸl
);

1866 
ba£_Ë‰”
 = 
	`Ùh”_ba£_Ë‰”
();

1868 
bÙh_ba£s
 = 
Œue
;

1869 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
 = 
»visiÚ
;

1870 
roÙ
 = 
C
[
Ëv–
].
n
;

1872 
BŒ“_modif›d
 = 
çl£
;

1874 
i
 = 0; i < 
BTREE_CURSOR_LEVELS
; ++i) {

1875 
C
[
i
].
n
 = 
BLK_UNUSED
;

1876 
C
[
i
].
c
 = -1;

1877 
C
[
i
].
»wr™e
 = 
çl£
;

1882 ià(!
	`b¿ss_io_sync
(
hªdË
)) {

1883 ()::
	`şo£
(
hªdË
);

1884 
hªdË
 = -1;

1885 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Can't commit‚ew„evision - failedo flush DBo disk");

1890 
¡ršg
 
tmp
 = 
Çme
;

1891 
tmp
 += "tmp";

1892 
¡ršg
 
ba£fe
 = 
Çme
;

1893 
ba£fe
 += "base";

1894 
ba£fe
 +ğ(
ba£_Ë‰”
);

1895 
ba£
.
	`wr™e_to_fe
(
tmp
, 
ba£_Ë‰”
, 
bËÇme
, 
chªges_fd
, 
chªges_
);

1896 #ià
defšed
 
__WIN32__


1897 ià(
	`msvc_posix_»Çme
(
tmp
.
	`c_¡r
(), 
ba£fe
.c_str()) < 0)

1899 ià(
	`»Çme
(
tmp
.
	`c_¡r
(), 
ba£fe
.c_str()) < 0)

1907 
§ved_”ºo
 = 
”ºo
;

1908 ià(
	`uÆšk
(
tmp
è=ğ0 || 
”ºo
 !ğ
ENOENT
) {

1909 
¡ršg
 
	`msg
("Couldn't update base file ");

1910 
msg
 +ğ
ba£fe
;

1911 
msg
 += ": ";

1912 
msg
 +ğ
	`¡»¼Ü
(
§ved_”ºo
);

1913 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1916 
ba£
.
	`comm™
();

1918 
	`»ad_roÙ
();

1920 
chªged_n
 = 0;

1921 
chªged_c
 = 
DIR_START
;

1922 
£q_couÁ
 = 
SEQ_START_POINT
;

1923 } 
	`ÿtch
 (...) {

1924 
B¿ssTabË
::
	`şo£
();

1925 
throw
;

1927 
	}
}

1930 
	gB¿ssTabË
::
	$wr™e_chªged_blocks
(
chªges_fd
)

1932 
	`LOGCALL_VOID
(
DB
, "B¿ssTabË::wr™e_chªged_blocks", 
chªges_fd
);

1933 
	`As£¹
(
chªges_fd
 >= 0);

1934 ià(
hªdË
 < 0) ;

1935 ià(
çked_roÙ_block
) ;

1937 
¡ršg
 
buf
;

1938 
	`·ck_ušt
(
buf
, 2u);

1939 
	`·ck_¡ršg
(
buf
, 
bËÇme
);

1940 
	`·ck_ušt
(
buf
, 
block_size
);

1941 
	`b¿ss_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1945 
ušt4
 
n
 = 0;

1946 
by‹
 * 
p
 = 
Ãw
 by‹[
block_size
];

1947 
Œy
 {

1948 
ba£
.
	`ÿlcuÏ‹_Ï¡_block
();

1949 
ba£
.
	`fšd_chªged_block
(&
n
)) {

1950 
buf
.
	`»size
(0);

1951 
	`·ck_ušt
(
buf
, 
n
 + 1);

1952 
	`b¿ss_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1955 
	`»ad_block
(
n
, 
p
);

1958 
	`b¿ss_io_wr™e
(
chªges_fd
, 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
),

1959 
block_size
);

1960 ++
n
;

1962 
d–‘e
[] 
p
;

1963 
p
 = 0;

1964 } 
	`ÿtch
 (...) {

1965 
d–‘e
[] 
p
;

1966 
throw
;

1968 
buf
.
	`»size
(0);

1969 
	`·ck_ušt
(
buf
, 0u);

1970 
	`b¿ss_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1971 
	}
}

1974 
	gB¿ssTabË
::
	$ÿnûl
()

1976 
	`LOGCALL_VOID
(
DB
, "BrassTable::cancel", "");

1977 
	`As£¹
(
wr™abË
);

1979 ià(
hªdË
 < 0) {

1980 ià(
hªdË
 == -2) {

1981 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

1983 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1989 
¡ršg
 
”r_msg
;

1990 ià(!
ba£
.
	`»ad
(
Çme
, 
ba£_Ë‰”
, 
”r_msg
)) {

1991 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
	`¡ršg
("Couldn'ˆ»»ad ba£ "è+ 
ba£_Ë‰”
);

1994 
»visiÚ_numb”
 = 
ba£
.
	`g‘_»visiÚ
();

1995 
block_size
 = 
ba£
.
	`g‘_block_size
();

1996 
roÙ
 = 
ba£
.
	`g‘_roÙ
();

1997 
Ëv–
 = 
ba£
.
	`g‘_Ëv–
();

1999 
™em_couÁ
 = 
ba£
.
	`g‘_™em_couÁ
();

2000 
çked_roÙ_block
 = 
ba£
.
	`g‘_have_çk”oÙ
();

2001 
£qu’tŸl
 = 
ba£
.
	`g‘_£qu’tŸl
();

2003 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

2005 
j
 = 0; j <ğ
Ëv–
; j++) {

2006 
C
[
j
].
n
 = 
BLK_UNUSED
;

2007 
C
[
j
].
»wr™e
 = 
çl£
;

2009 
	`»ad_roÙ
();

2011 
chªged_n
 = 0;

2012 
chªged_c
 = 
DIR_START
;

2013 
£q_couÁ
 = 
SEQ_START_POINT
;

2014 
	}
}

2018 
boŞ


2019 
	gB¿ssTabË
::
	$do_İ’_to_»ad
(
boŞ
 
»visiÚ_suµl›d
, 
b¿ss_»visiÚ_numb”_t
 
»visiÚ_
)

2021 
	`LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::do_İ’_to_»ad", 
»visiÚ_suµl›d
 << ", " << 
»visiÚ_
);

2022 ià(
hªdË
 == -2) {

2023 
B¿ssTabË
::
	`throw_d©aba£_şo£d
();

2025 
hªdË
 = ::
	`İ’
((
Çme
 + "DB").
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

2026 ià(
hªdË
 < 0) {

2027 ià(
Ïzy
) {

2029 
»visiÚ_numb”
 = 
»visiÚ_
;

2030 
	`RETURN
(
Œue
);

2032 
¡ršg
 
	`mes§ge
("Couldn't open ");

2033 
mes§ge
 +ğ
Çme
;

2034 
mes§ge
 += "DBo„ead: ";

2035 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

2036 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

2039 ià(!
	`basic_İ’
(
»visiÚ_suµl›d
, 
»visiÚ_
)) {

2040 ::
	`şo£
(
hªdË
);

2041 
hªdË
 = -1;

2042 ià(
»visiÚ_suµl›d
) {

2047 
	`RETURN
(
çl£
);

2049 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Failedo openable for„eading");

2052 
j
 = 0; j <ğ
Ëv–
; j++) {

2053 
C
[
j
].
n
 = 
BLK_UNUSED
;

2054 
C
[
j
].
p
 = 
Ãw
 
by‹
[
block_size
];

2055 ià(
C
[
j
].
p
 == 0) {

2056 
throw
 
¡d
::
	`bad_®loc
();

2060 
	`»ad_roÙ
();

2061 
	`RETURN
(
Œue
);

2062 
	}
}

2065 
	gB¿ssTabË
::
	$İ’
()

2067 
	`LOGCALL_VOID
(
DB
, "BrassTable::open", "");

2068 
	`LOGLINE
(
DB
, "İ’šg‡ˆ·th " << 
Çme
);

2069 
	`şo£
();

2071 ià(!
wr™abË
) {

2073 ()
	`do_İ’_to_»ad
(
çl£
, 0);

2078 ()
	`do_İ’_to_wr™e
(
çl£
, 0);

2079 
	}
}

2081 
boŞ


2082 
	gB¿ssTabË
::
	$İ’
(
b¿ss_»visiÚ_numb”_t
 
»visiÚ
)

2084 
	`LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::İ’", 
»visiÚ
);

2085 
	`LOGLINE
(
DB
, "İ’šg fÜ…¬ticuÏ¸»visiÚ‡ˆ·th " << 
Çme
);

2086 
	`şo£
();

2088 ià(!
wr™abË
) {

2089 ià(
	`do_İ’_to_»ad
(
Œue
, 
»visiÚ
)) {

2090 
	`As£¹Eq
(
»visiÚ_numb”
, 
»visiÚ
);

2091 
	`RETURN
(
Œue
);

2093 
	`şo£
();

2094 
	`RETURN
(
çl£
);

2098 ià(!
	`do_İ’_to_wr™e
(
Œue
, 
»visiÚ
)) {

2100 
	`şo£
();

2101 
	`RETURN
(
çl£
);

2104 
	`As£¹Eq
(
»visiÚ_numb”
, 
»visiÚ
);

2105 
	`RETURN
(
Œue
);

2106 
	}
}

2108 
boŞ


2109 
	gB¿ssTabË
::
´ev_fÜ_£qu’tŸl
(
B¿ss
::
CursÜ
 * 
C_
, ) const

2111 
LOGCALL
(
DB
, 
boŞ
, "BrassTable::prev_for_sequential", "C_, UNUSED(int)");

2112 
	gc
 = 
C_
[0].
c
;

2113 ià(
	gc
 =ğ
DIR_START
) {

2114 
by‹
 * 
p
 = 
C_
[0].p;

2115 
As£¹
(
p
);

2116 
ušt4
 
	gn
 = 
C_
[0].
n
;

2117 
	gŒue
) {

2118 ià(
	gn
 =ğ0è
RETURN
(
çl£
);

2119 
	gn
--;

2120 ià(
	gwr™abË
) {

2121 ià(
	gn
 =ğ
C
[0].
n
) {

2124 
memıy
(
p
, 
C
[0].p, 
block_size
);

2131 
	gj
;

2132 
	gj
 = 1; j <ğ
Ëv–
; ++j) {

2133 ià(
	gn
 =ğ
C
[
j
].
n
) ;

2135 ià(
	gj
 <ğ
Ëv–
) ;

2140 
»ad_block
(
n
, 
p
);

2143 
»ad_block
(
n
, 
p
);

2145 ià(
	gwr™abË
è
As£¹Eq
(
»visiÚ_numb”
, 
Ï‹¡_»visiÚ_numb”
);

2146 ià(
REVISION
(
p
è> 
	g»visiÚ_numb”
 + 
	gwr™abË
) {

2147 
£t_ov”wr™‹n
();

2148 
RETURN
(
çl£
);

2150 ià(
GET_LEVEL
(
p
) == 0) ;

2152 
	gc
 = 
DIR_END
(
p
);

2153 
	gC_
[0].
	gn
 = 
n
;

2155 
	gc
 -ğ
D2
;

2156 
	gC_
[0].
	gc
 = 
c
;

2157 
RETURN
(
Œue
);

2160 
boŞ


2161 
	gB¿ssTabË
::
Ãxt_fÜ_£qu’tŸl
(
B¿ss
::
CursÜ
 * 
C_
, ) const

2163 
LOGCALL
(
DB
, 
boŞ
, "BrassTable::next_for_sequential", "C_, UNUSED(int)");

2164 
by‹
 * 
	gp
 = 
C_
[0].
p
;

2165 
As£¹
(
p
);

2166 
	gc
 = 
C_
[0].
c
;

2167 
	gc
 +ğ
D2
;

2168 
As£¹
(()
c
 < 
block_size
);

2169 ià(
	gc
 =ğ
DIR_END
(
p
)) {

2170 
ušt4
 
n
 = 
C_
[0].n;

2171 
	gŒue
) {

2172 
	gn
++;

2173 ià(
	gn
 > 
	gba£
.
g‘_Ï¡_block
()è
RETURN
(
çl£
);

2174 ià(
	gwr™abË
) {

2175 ià(
	gn
 =ğ
C
[0].
n
) {

2178 
memıy
(
p
, 
C
[0].p, 
block_size
);

2185 
	gj
;

2186 
	gj
 = 1; j <ğ
Ëv–
; ++j) {

2187 ià(
	gn
 =ğ
C
[
j
].
n
) ;

2189 ià(
	gj
 <ğ
Ëv–
) ;

2194 
»ad_block
(
n
, 
p
);

2197 
»ad_block
(
n
, 
p
);

2199 ià(
	gwr™abË
è
As£¹Eq
(
»visiÚ_numb”
, 
Ï‹¡_»visiÚ_numb”
);

2200 ià(
REVISION
(
p
è> 
	g»visiÚ_numb”
 + 
	gwr™abË
) {

2201 
£t_ov”wr™‹n
();

2202 
RETURN
(
çl£
);

2204 ià(
GET_LEVEL
(
p
) == 0) ;

2206 
	gc
 = 
DIR_START
;

2207 
	gC_
[0].
	gn
 = 
n
;

2209 
	gC_
[0].
	gc
 = 
c
;

2210 
RETURN
(
Œue
);

2213 
boŞ


2214 
	gB¿ssTabË
::
´ev_deçuÉ
(
B¿ss
::
CursÜ
 * 
C_
, 
j
) const

2216 
LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::´ev_deçuÉ", "C_, " << 
j
);

2217 
by‹
 * 
	gp
 = 
C_
[
j
].
p
;

2218 
	gc
 = 
C_
[
j
].
c
;

2219 
As£¹
(
c
 >ğ
DIR_START
);

2220 
As£¹
(()
c
 < 
block_size
);

2221 
As£¹
(
c
 <ğ
DIR_END
(
p
));

2222 ià(
	gc
 =ğ
DIR_START
) {

2223 ià(
j
 =ğ
Ëv–
è
RETURN
(
çl£
);

2224 ià(!
´ev_deçuÉ
(
C_
, 
j
 + 1)è
RETURN
(
çl£
);

2225 
	gc
 = 
DIR_END
(
p
);

2227 
	gc
 -ğ
D2
;

2228 
	gC_
[
j
].
	gc
 = 
c
;

2229 ià(
	gj
 > 0) {

2230 
block_to_cursÜ
(
C_
, 
j
 - 1, 
I‹m
(
p
, 
c
).
block_giv’_by
());

2232 
RETURN
(
Œue
);

2235 
boŞ


2236 
	gB¿ssTabË
::
Ãxt_deçuÉ
(
B¿ss
::
CursÜ
 * 
C_
, 
j
) const

2238 
LOGCALL
(
DB
, 
boŞ
, "B¿ssTabË::Ãxt_deçuÉ", "C_, " << 
j
);

2239 
by‹
 * 
	gp
 = 
C_
[
j
].
p
;

2240 
	gc
 = 
C_
[
j
].
c
;

2241 
As£¹
(
c
 >ğ
DIR_START
);

2242 
	gc
 +ğ
D2
;

2243 
As£¹
(()
c
 < 
block_size
);

2245 ià(
	gc
 >ğ
DIR_END
(
p
)) {

2246 ià(
j
 =ğ
Ëv–
è
RETURN
(
çl£
);

2247 ià(!
Ãxt_deçuÉ
(
C_
, 
j
 + 1)è
RETURN
(
çl£
);

2248 
	gc
 = 
DIR_START
;

2250 
	gC_
[
j
].
	gc
 = 
c
;

2251 ià(
	gj
 > 0) {

2252 
block_to_cursÜ
(
C_
, 
j
 - 1, 
I‹m
(
p
, 
c
).
block_giv’_by
());

2253 #ifdeà
BTREE_DEBUG_FULL


2254 
´štf
("Block in BrassTable:next_default");

2255 
»pÜt_block_fuÎ
(
j
 - 1, 
C_
[j - 1].
n
, C_[j - 1].
p
);

2258 
RETURN
(
Œue
);

2262 
	gB¿ssTabË
::
	$throw_d©aba£_şo£d
()

2264 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

2265 
	}
}

2282 
boŞ
 
	gKey
::
İ”©Ü
<(
Key
 
key2
) const

2284 
LOGCALL
(
DB
, 
boŞ
, "Key::İ”©Ü<", 
¡©ic_ÿ¡
<cÚ¡ *>(
key2
.
p
));

2285 
	gkey1_Ën
 = 
Ëngth
();

2286 
	gkey2_Ën
 = 
key2
.
Ëngth
();

2287 ià(
	gkey1_Ën
 =ğ
key2_Ën
) {

2291 
RETURN
(
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
key1_Ën
 + 
C2
) < 0);

2294 
	gk_sm®Ër
 = (
key2_Ën
 < 
key1_Ën
 ? key2_len : key1_len);

2297 
	gdiff
 = 
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
k_sm®Ër
);

2298 ià(
	gdiff
 !ğ0è
RETURN
(
diff
 < 0);

2302 
RETURN
(
key1_Ën
 < 
key2_Ën
);

2305 
boŞ
 
	gKey
::
İ”©Ü
==(
Key
 
key2
) const

2307 
LOGCALL
(
DB
, 
boŞ
, "Key::İ”©Ü==", 
¡©ic_ÿ¡
<cÚ¡ *>(
key2
.
p
));

2308 
	gkey1_Ën
 = 
Ëngth
();

2309 ià(
	gkey1_Ën
 !ğ
key2
.
Ëngth
()è
RETURN
(
çl£
);

2313 
RETURN
(
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
key1_Ën
 + 
C2
) == 0);

	@backends/brass/brass_table.h

23 #iâdeà
OM_HGUARD_BRASS_TABLE_H


24 
	#OM_HGUARD_BRASS_TABLE_H


	)

26 
	~<x­Ÿn/”rÜ.h
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~"b¿ss_ty³s.h
"

30 
	~"b¿ss_bŒ“ba£.h
"

31 
	~"b¿ss_cursÜ.h
"

33 
	~"nÜ‘uº.h
"

34 
	~"omas£¹.h
"

35 
	~"¡ršguts.h
"

36 
	~"uÇligÃd.h
"

37 
	~"uts.h
"

39 
	~<®gÜ™hm
>

40 
	~<¡ršg
>

42 
	~<zlib.h
>

44 
	#DONT_COMPRESS
 -1

	)

51 
	#BRASS_BTREE_MAX_KEY_LEN
 252

	)

54 
	#BYTES_PER_BLOCK_NUMBER
 4

	)

66 
	#K1
 1

	)

67 
	#I2
 2

	)

68 
	#D2
 2

	)

69 
	#C2
 2

	)

73 
	#g‘K
(
p
, 
c
è
	`g‘št1
Õ, c)

	)

74 
	#£tD
(
p
, 
c
, 
x
è
	`£tšt2
Õ, c, x)

	)

96 
	#REVISION
(
b
è
¡©ic_ÿ¡
<>(
	`g‘št4
(b, 0))

	)

97 
	#GET_LEVEL
(
b
è
	`g‘št1
(b, 4)

	)

98 
	#MAX_FREE
(
b
è
	`g‘št2
(b, 5)

	)

99 
	#TOTAL_FREE
(
b
è
	`g‘št2
(b, 7)

	)

100 
	#DIR_END
(
b
è
	`g‘št2
(b, 9)

	)

101 
	#DIR_START
 11

	)

103 
	#SET_REVISION
(
b
, 
x
è
	`£tšt4
(b, 0, x)

	)

104 
	#SET_LEVEL
(
b
, 
x
è
	`£tšt1
(b, 4, x)

	)

105 
	#SET_MAX_FREE
(
b
, 
x
è
	`£tšt2
(b, 5, x)

	)

106 
	#SET_TOTAL_FREE
(
b
, 
x
è
	`£tšt2
(b, 7, x)

	)

107 
	#SET_DIR_END
(
b
, 
x
è
	`£tšt2
(b, 9, x)

	)

109 
Çme¥aû
 
	gB¿ss
 {

111 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gKey
 {

112 cÚ¡ 
by‹
 *
	gp
;

113 
	gpublic
:

114 
ex¶ic™
 
Key
(cÚ¡ 
by‹
 * 
p_
è: 
p
(p_) { }

115 cÚ¡ 
by‹
 * 
g‘_add»ss
(ècÚ¡ {  
p
; }

116 
»ad
(
¡d
::
¡ršg
 * 
key
) const {

117 
key
->
assign
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 
K1
), 
Ëngth
());

119 
boŞ
 
	gİ”©Ü
==(
Key
 
key2
) const;

120 
boŞ
 
	gİ”©Ü
!=(
Key
 
key2
ècÚ¡ {  !(*
this
 == key2); }

121 
boŞ
 
	gİ”©Ü
<(
Key
 
	gkey2
) const;

122 
boŞ
 
	gİ”©Ü
>=(
Key
 
key2
ècÚ¡ {  !(*
this
 < key2); }

123 
boŞ
 
	gİ”©Ü
>(
Key
 
	gkey2
ècÚ¡ {  key2 < *
	gthis
; }

124 
boŞ
 
	gİ”©Ü
<=(
Key
 
key2
ècÚ¡ {  !(key2 < *
this
); }

125 
Ëngth
() const {

126 
As£¹R–
(
g‘K
(
p
, 0),>=,3);

127  
g‘K
(
p
, 0è- 
	gC2
 - 
	gK1
;

129 
	gİ”©Ü
[](
size_t
 
	gi
) const {

130 
As£¹R–
(
i
,<,(
size_t
)
Ëngth
());

131  
	gp
[
i
 + 
K1
];

137 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	cI‹m_ba£
 {

138 
	g´Ùeùed
:

139 
T
 
p
;

140 
	gpublic
:

142 
I‹m_ba£
(
T
 
p_
, 
c
è: 
p
Õ_ + 
g‘št2
(p_, c)) { }

143 
I‹m_ba£
(
T
 
p_
è: 
p
(p_) { }

144 
T
 
g‘_add»ss
(ècÚ¡ {  
p
; }

146 
size
() const {

147 
	g™em_size
 = 
g‘št2
(
p
, 0) & 0x7fff;

148 
As£¹R–
(
™em_size
,>=,5);

149  
	g™em_size
;

151 
boŞ
 
g‘_com´es£d
(ècÚ¡ {  *
	gp
 & 0x80; }

152 
compÚ’t_of
() const {

153  
g‘št2
(
p
, 
g‘K
Õ, 
I2
è+ I2 - 
C2
);

155 
compÚ’ts_of
() const {

156  
g‘št2
(
p
, 
g‘K
Õ, 
I2
) + I2);

158 
Key
 
key
(ècÚ¡ {  Key(
p
 + 
I2
); }

159 
­³nd_chunk
(
¡d
::
¡ršg
 * 
g
) const {

161 
cd
 = 
g‘K
(
p
, 
I2
è+ 
	gI2
 + 
	gC2
;

162 
	gl
 = 
size
(è- 
cd
;

163 
	gg
->
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 
cd
), 
l
);

168 
ušt4
 
block_giv’_by
() const {

169 
As£¹R–
(
size
(),>=,
BYTES_PER_BLOCK_NUMBER
);

170  
g‘št4
(
p
, 
size
(è- 
BYTES_PER_BLOCK_NUMBER
);

174 
şass
 
	gI‹m
 : 
public
 
I‹m_ba£
<cÚ¡ 
by‹
 *> {

175 
public
:

177 
I‹m
(cÚ¡ 
by‹
 * 
p_
, 
c
è: 
I‹m_ba£
<cÚ¡ by‹ *>Õ_, 
	gc
) { }

178 
I‹m
(cÚ¡ 
by‹
 * 
p_
è: 
I‹m_ba£
<const byte *>(p_) { }

181 
şass
 
	gI‹m_wr
 : 
public
 
I‹m_ba£
<
by‹
 *> {

182 
£t_key_Ën
(
x
è{ 
£tšt1
(
p
, 
I2
, x); }

183 
	gpublic
:

185 
I‹m_wr
(
by‹
 * 
p_
, 
c
è: 
I‹m_ba£
<by‹ *>Õ_, 
	gc
) { }

186 
I‹m_wr
(
by‹
 * 
p_
è: 
I‹m_ba£
<byte *>(p_) { }

187 
£t_compÚ’t_of
(
i
) {

188 
£tšt2
(
p
, 
g‘K
Õ, 
I2
è+ I2 - 
C2
, 
i
);

190 
£t_compÚ’ts_of
(
m
) {

191 
£tšt2
(
p
, 
g‘K
Õ, 
I2
è+ I2, 
m
);

194 
£t_key_ªd_block
(
Key
 
Ãwkey
, 
Œunÿ‹_size
, 
ušt4
 
n
) {

195 
	gi
 = 
Œunÿ‹_size
;

198 
	gÃwkey_Ën
 = 
Ãwkey
.
Ëngth
();

199 
As£¹R–
(
i
,<=,
Ãwkey_Ën
);

200 
	gÃwsize
 = 
I2
 + 
K1
 + 
i
 + 
C2
;

202 
£tšt2
(
p
, 0, 
Ãwsize
 + 
BYTES_PER_BLOCK_NUMBER
);

204 
£tšt1
(
p
, 
I2
, 
Ãwsize
 - I2);

206 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
, 
Ãwkey
.
g‘_add»ss
(è+ K1, 
i
);

208 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
 + 
i
, 
Ãwkey
.
g‘_add»ss
(è+ K1 + 
Ãwkey_Ën
, 
C2
);

211 
£tšt4
(
p
, 
Ãwsize
, 
n
);

217 
£t_block_giv’_by
(
ušt4
 
n
) {

218 
£tšt4
(
p
, 
size
(è- 
BYTES_PER_BLOCK_NUMBER
, 
n
);

220 
£t_size
(
l
) {

221 
As£¹R–
(
l
,>=,5);

222 
£tšt2
(
p
, 0, 
l
);

226 
fÜm_nuÎ_key
(
ušt4
 
n
) {

227 
£tšt4
(
p
, 
I2
 + 
K1
, 
n
);

228 
£t_key_Ën
(
K1
);

229 
£t_size
(
I2
 + 
K1
 + 
BYTES_PER_BLOCK_NUMBER
);

231 
fÜm_key
(cÚ¡ 
¡d
::
¡ršg
 & 
key_
) {

232 
¡d
::
¡ršg
::
size_ty³
 
key_Ën
 = 
key_
.
Ëngth
();

233 ià(
	gkey_Ën
 > 
	gBRASS_BTREE_MAX_KEY_LEN
) {

237 
	g¡d
::
¡ršg
 
msg
("Keyoo†ong:†ength was ");

238 
	gmsg
 +ğ
om_to¡ršg
(
key_Ën
);

239 
	gmsg
 += " bytes, maximum†ength of‡ key is "

240 
STRINGIZE
(
BRASS_BTREE_MAX_KEY_LEN
) " bytes";

241 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
(
msg
);

244 
£t_key_Ën
(
key_Ën
 + 
K1
 + 
C2
);

245 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
, 
key_
.
d©a
(), 
key_Ën
);

246 
£t_compÚ’t_of
(1);

249 
£t_g
(
cd
, cÚ¡ *
¡¬t
, 
Ën
, 
boŞ
 
com´es£d
) {

250 
	g¡d
::
memmove
(
p
 + 
cd
, 
¡¬t
, 
Ën
);

251 
£t_size
(
cd
 + 
Ën
);

252 ià(
	gcom´es£d
è*
	gp
 |= 0x80;

254 
çke_roÙ_™em
() {

255 
£t_key_Ën
(
K1
 + 
C2
);

256 
£t_size
(
I2
 + 
K1
 + 2 * 
C2
);

257 
£t_compÚ’t_of
(1);

258 
£t_compÚ’ts_of
(1);

267 
	#BTREE_CURSOR_LEVELS
 10

	)

289 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mB¿ssTabË
 {

290 
ä›nd
 
şass
 
	mB¿ssCursÜ
;

291 
	m´iv©e
:

293 
B¿ssTabË
(const BrassTable &);

296 
	mB¿ssTabË
 & 
	mİ”©Ü
=(cÚ¡ 
B¿ssTabË
 &);

299 
boŞ
 
	$»®ly_em±y
() const;

301 
public
:

318 
	`B¿ssTabË
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡d
::
¡ršg
 & 
·th_
,

319 
boŞ
 
»adÚly_
, 
com´ess_¡¿‹gy_
 = 
DONT_COMPRESS
,

320 
boŞ
 
Ïzy
 = 
çl£
);

327 ~
	`B¿ssTabË
();

334 
	`şo£
(
boŞ
 
³rmª’t
=
çl£
);

338 
boŞ
 
	$exi¡s
() const;

348 
	`İ’
();

367 
boŞ
 
	`İ’
(
b¿ss_»visiÚ_numb”_t
 
»visiÚ_
);

373 
boŞ
 
	$is_İ’
(ècÚ¡ {  
hªdË
 >= 0; }

380 
	`æush_db
();

398 
	`comm™
(
b¿ss_»visiÚ_numb”_t
 
»visiÚ
, 
chªges_fd
 = -1,

399 cÚ¡ 
¡d
::
¡ršg
 * 
chªges_
 = 
NULL
);

405 
	`wr™e_chªged_blocks
(
chªges_fd
);

412 
	`ÿnûl
();

428 
boŞ
 
	`g‘_exaù_’Œy
(cÚ¡ 
¡d
::
¡ršg
 & 
key
, std::¡ršg & 
g
) const;

441 
boŞ
 
	`key_exi¡s
(cÚ¡ 
¡d
::
¡ršg
 &
key
) const;

451 
boŞ
 
	`»ad_g
(
B¿ss
::
CursÜ
 * 
C_
, 
¡d
::
¡ršg
 *
g
, boŞ 
k“p_com´es£d
) const;

469 
	`add
(cÚ¡ 
¡d
::
¡ršg
 &
key
, std::¡ršg 
g
, 
boŞ
 
®»ady_com´es£d
 = 
çl£
);

486 
boŞ
 
	`d–
(cÚ¡ 
¡d
::
¡ršg
 &
key
);

489 
	`”a£
();

495 
	`£t_block_size
(
block_size_
);

499 
	$g‘_block_size
(ècÚ¡ {  
block_size
; 
	}
}

524 
ü—‹_ªd_İ’
(
blocksize
);

526 
£t_fuÎ_com·ùiÚ
(
boŞ
 
·r™y
);

538 
b¿ss_»visiÚ_numb”_t
 
	$g‘_Ï‹¡_»visiÚ_numb”
() const {

539  
Ï‹¡_»visiÚ_numb”
;

540 
	}
}

550 
b¿ss_»visiÚ_numb”_t
 
	$g‘_İ’_»visiÚ_numb”
() const {

551  
»visiÚ_numb”
;

552 
	}
}

563 
b¿ss_bËsize_t
 
	$g‘_’Œy_couÁ
() const {

564  
™em_couÁ
;

565 
	}
}

568 
boŞ
 
	$em±y
() const {

578  (
Ëv–
 =ğ0è&& 
	`»®ly_em±y
();

579 
	}
}

586 
B¿ssCursÜ
 * 
	$cursÜ_g‘
() const;

593 
boŞ
 
	$is_modif›d
(ècÚ¡ {  
BŒ“_modif›d
; 
	}
}

600 
	$£t_max_™em_size
(
size_t
 
block_ÿ·c™y
) {

601 ià(
block_ÿ·c™y
 > 4) block_capacity = 4;

602 
max_™em_size
 = (
block_size
 - 
DIR_START
 - 
block_ÿ·c™y
 * 
D2
)

603 / 
block_ÿ·c™y
;

604 
	}
}

606 
	g´Ùeùed
:

612 
boŞ
 
do_İ’_to_»ad
(boŞ 
»visiÚ_suµl›d
, 
b¿ss_»visiÚ_numb”_t
 
»visiÚ_
);

618 
boŞ
 
do_İ’_to_wr™e
(boŞ 
»visiÚ_suµl›d
,

619 
b¿ss_»visiÚ_numb”_t
 
»visiÚ_
,

620 
boŞ
 
ü—‹_db
 = 
çl£
);

621 
boŞ
 
basic_İ’
(boŞ 
»visiÚ_suµl›d
, 
b¿ss_»visiÚ_numb”_t
 
»visiÚ
);

623 
boŞ
 
fšd
(
B¿ss
::
CursÜ
 *) const;

624 
d–‘e_kt
();

625 
	$»ad_block
(
ušt4
 
n
, 
by‹
 *
p
) const;

626 
	$wr™e_block
(
ušt4
 
n
, cÚ¡ 
by‹
 *
p
) const;

627 
	`XAPIAN_NORETURN
(
	$£t_ov”wr™‹n
() const);

628 
	`block_to_cursÜ
(
B¿ss
::
CursÜ
 *
C_
, 
j
, 
ušt4
 
n
) const;

629 
	`®‹r
();

630 
	`com·ù
(
by‹
 *
p
);

631 
	`’‹r_key
(
j
, 
B¿ss
::
Key
 
´evkey
, B¿ss::Key 
Ãwkey
);

632 
	`mid_pošt
(
by‹
 *
p
);

633 
	`add_™em_to_block
(
by‹
 *
p
, 
B¿ss
::
I‹m_wr
 
kt
, 
c
);

634 
	`add_™em
(
B¿ss
::
I‹m_wr
 
kt
, 
j
);

635 
	`d–‘e_™em
(
j
, 
boŞ
 
»³©edly
);

636 
	`add_kt
(
boŞ
 
found
);

637 
	`»ad_roÙ
();

638 
	`¥l™_roÙ
(
ušt4
 
¥l™_n
);

639 
	`fÜm_key
(cÚ¡ 
¡d
::
¡ršg
 & 
key
) const;

641 
	$Ùh”_ba£_Ë‰”
() const {

642  (
ba£_Ë‰”
 == 'A') ? 'B' : 'A';

643 
	}
}

646 cÚ¡ * 
	gbËÇme
;

649 
	$Ïzy_®loc_deæ©e_z¡»am
() const;

652 
	$Ïzy_®loc_šæ©e_z¡»am
() const;

655 
b¿ss_»visiÚ_numb”_t
 
»visiÚ_numb”
;

658 
b¿ss_bËsize_t
 
™em_couÁ
;

661 
block_size
;

666 
mubË
 
b¿ss_»visiÚ_numb”_t
 
Ï‹¡_»visiÚ_numb”
;

672 
mubË
 
boŞ
 
bÙh_ba£s
;

675 
ba£_Ë‰”
;

681 
boŞ
 
çked_roÙ_block
;

686 
boŞ
 
£qu’tŸl
;

695 
hªdË
;

698 
Ëv–
;

701 
ušt4
 
roÙ
;

704 
mubË
 
B¿ss
::
I‹m_wr
 
kt
;

707 
by‹
 * 
bufãr
;

710 
B¿ssTabË_ba£
 
ba£
;

713 
¡d
::
¡ršg
 
Çme
;

718 
£q_couÁ
;

721 
ušt4
 
chªged_n
;

725 
chªged_c
;

728 
size_t
 
max_™em_size
;

731 
mubË
 
boŞ
 
BŒ“_modif›d
;

734 
boŞ
 
fuÎ_com·ùiÚ
;

737 
boŞ
 
wr™abË
;

740 
boŞ
 
	`´ev
(
B¿ss
::
CursÜ
 *
C_
, 
j
) const {

741 ià(
£qu’tŸl
è 
	`´ev_fÜ_£qu’tŸl
(
C_
, 
j
);

742  
	`´ev_deçuÉ
(
C_
, 
j
);

743 
	}
}

745 
boŞ
 
Ãxt
(
B¿ss
::
CursÜ
 *
C_
, 
j
) const {

746 ià(
	g£qu’tŸl
è 
Ãxt_fÜ_£qu’tŸl
(
C_
, 
j
);

747  
Ãxt_deçuÉ
(
C_
, 
j
);

751 
boŞ
 
´ev_deçuÉ
(
B¿ss
::
CursÜ
 *
C_
, 
j
) const;

752 
boŞ
 
Ãxt_deçuÉ
(
B¿ss
::
CursÜ
 *
C_
, 
j
) const;

755 
boŞ
 
´ev_fÜ_£qu’tŸl
(
B¿ss
::
CursÜ
 *
C_
, 
dummy
) const;

756 
boŞ
 
Ãxt_fÜ_£qu’tŸl
(
B¿ss
::
CursÜ
 *
C_
, 
dummy
) const;

758 
fšd_š_block
(cÚ¡ 
by‹
 * 
p
, 
B¿ss
::
Key
 
key
, 
boŞ
 
Ëaf
, 
c
);

763 
ušt4
 
block_giv’_by
(cÚ¡ 
by‹
 * 
p
, 
c
);

765 
mubË
 
	gB¿ss
::
CursÜ
 
C
[
BTREE_CURSOR_LEVELS
];

772 
by‹
 * 
	g¥l™_p
;

776 
	gcom´ess_¡¿‹gy
;

779 
mubË
 
z_¡»am
 *
	gdeæ©e_z¡»am
;

782 
mubË
 
z_¡»am
 *
	gšæ©e_z¡»am
;

785 
boŞ
 
	gÏzy
;

791 
XAPIAN_NORETURN
(
throw_d©aba£_şo£d
());

	@backends/brass/brass_termlist.cc

23 
	~<cÚfig.h
>

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"ex·ndweight.h
"

28 
	~"b¿ss_pos™iÚli¡.h
"

29 
	~"b¿ss_‹rmli¡.h
"

30 
	~"omas£¹.h
"

31 
	~"·ck.h
"

32 
	~"uts.h
"

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	gB¿ssT”mLi¡
::
B¿ssT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db_
,

37 
X­Ÿn
::
docid
 
did_
)

38 : 
db
(
db_
), 
did
(
did_
), 
cu¼’t_wdf
(0), 
	$cu¼’t_‹rmäeq
(0)

40 
	`DEBUGCALL
(
DB
, , "BrassTermList",

41 "[RefCÁPŒ<cÚ¡ B¿ssD©aba£>], " << 
did_
);

43 ià(!
db
->
‹rmli¡_bË
.
	`g‘_exaù_’Œy
(
B¿ssT”mLi¡TabË
::
	`make_key
(
did
),

44 
d©a
))

45 
throw
 
X­Ÿn
::
	`DocNÙFoundE¼Ü
("NØ‹rmli¡ fÜ docum’ˆ" + 
	`om_to¡ršg
(
did
));

47 
pos
 = 
d©a
.
	`d©a
();

48 
’d
 = 
pos
 + 
d©a
.
	`size
();

50 ià(
pos
 =ğ
’d
) {

51 
doş’
 = 0;

52 
‹rmli¡_size
 = 0;

57 ià(!
	`uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

58 cÚ¡ *
msg
;

59 ià(
pos
 == 0) {

60 
msg
 = "Too†ittle data for doclen inermlist";

62 
msg
 = "Overflowed value for doclen inermlist";

64 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

68 ià(!
	`uÅack_ušt
(&
pos
, 
’d
, &
‹rmli¡_size
)) {

69 cÚ¡ *
msg
;

70 ià(
pos
 == 0) {

71 
msg
 = "Too†ittle data for†ist size inermlist";

73 
msg
 = "Overflowed value for†ist size inermlist";

75 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

77 
	}
}

79 
b¿ss_doş’_t


80 
	gB¿ssT”mLi¡
::
	$g‘_doş’gth
() const

82 
	`DEBUGCALL
(
DB
, 
b¿ss_doş’_t
, "BrassTermList::get_doclength", "");

83 
	`RETURN
(
doş’
);

84 
	}
}

86 
	gX­Ÿn
::
‹rmcouÁ


87 
B¿ssT”mLi¡
::
	$g‘_­´ox_size
() const

89 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassTermList::get_approx_size", "");

90 
	`RETURN
(
‹rmli¡_size
);

91 
	}
}

94 
	gB¿ssT”mLi¡
::
accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const

96 
DEBUGCALL
(
DB
, , "BrassTermList::accumulate_stats", "[stats&]");

97 
As£¹
(!
©_’d
());

98 
	g¡©s
.
accumuÏ‹
(
cu¼’t_wdf
, 
doş’
, 
g‘_‹rmäeq
(), 
db
->
g‘_doccouÁ
());

101 
¡ršg


102 
	gB¿ssT”mLi¡
::
	$g‘_‹rmÇme
() const

104 
	`DEBUGCALL
(
DB
, 
¡ršg
, "BrassTermList::get_termname", "");

105 
	`RETURN
(
cu¼’t_‹rm
);

106 
	}
}

108 
	gX­Ÿn
::
‹rmcouÁ


109 
B¿ssT”mLi¡
::
	$g‘_wdf
() const

111 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassTermList::get_wdf", "");

112 
	`RETURN
(
cu¼’t_wdf
);

113 
	}
}

115 
	gX­Ÿn
::
doccouÁ


116 
B¿ssT”mLi¡
::
	$g‘_‹rmäeq
() const

118 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "BrassTermList::get_termfreq", "");

119 ià(
cu¼’t_‹rmäeq
 == 0)

120 
cu¼’t_‹rmäeq
 = 
db
->
	`g‘_‹rmäeq
(
cu¼’t_‹rm
);

121 
	`RETURN
(
cu¼’t_‹rmäeq
);

122 
	}
}

124 
T”mLi¡
 *

125 
	gB¿ssT”mLi¡
::
	$Ãxt
()

127 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "BrassTermList::next", "");

128 
	`As£¹
(!
	`©_’d
());

129 ià(
pos
 =ğ
’d
) {

130 
pos
 = 
NULL
;

131 
	`RETURN
(
NULL
);

135 
cu¼’t_‹rmäeq
 = 0;

137 
boŞ
 
wdf_š_»u£
 = 
çl£
;

138 ià(!
cu¼’t_‹rm
.
	`em±y
()) {

140 
size_t
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

141 ià(
Ën
 > 
cu¼’t_‹rm
.
	`size
()) {

143 
wdf_š_»u£
 = 
Œue
;

144 
size_t
 
divisÜ
 = 
cu¼’t_‹rm
.
	`size
() + 1;

145 
cu¼’t_wdf
 = 
Ën
 / 
divisÜ
 - 1;

146 
Ën
 %ğ
divisÜ
;

148 
cu¼’t_‹rm
.
	`»size
(
Ën
);

152 
size_t
 
­³nd_Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

153 
cu¼’t_‹rm
.
	`­³nd
(
pos
, 
­³nd_Ën
);

154 
pos
 +ğ
­³nd_Ën
;

157 ià(!
wdf_š_»u£
 && !
	`uÅack_ušt
(&
pos
, 
’d
, &
cu¼’t_wdf
)) {

158 cÚ¡ *
msg
;

159 ià(
pos
 == 0) {

160 
msg
 = "Too†ittle data for wdf inermlist";

162 
msg
 = "Overflowed value for wdf inermlist";

164 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

167 
	`RETURN
(
NULL
);

168 
	}
}

170 
boŞ


171 
	gB¿ssT”mLi¡
::
	$©_’d
() const

173 
	`DEBUGCALL
(
DB
, 
boŞ
, "BrassTermList::at_end", "");

174 
	`RETURN
(
pos
 =ğ
NULL
);

175 
	}
}

177 
	gX­Ÿn
::
‹rmcouÁ


178 
B¿ssT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

180 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "BrassTermList::positionlist_count", "");

181 
	`RETURN
(
db
->
pos™iÚ_bË
.
	`pos™iÚli¡_couÁ
(
did
, 
cu¼’t_‹rm
));

182 
	}
}

184 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


185 
B¿ssT”mLi¡
::
	$pos™iÚli¡_begš
() const

187 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
Pos™iÚI‹¿tÜ
, "BrassTermList::positionlist_begin", "");

188  
X­Ÿn
::
	`Pos™iÚI‹¿tÜ
(

189 
Ãw
 
	`B¿ssPos™iÚLi¡
(&
db
->
pos™iÚ_bË
, 
did
, 
cu¼’t_‹rm
));

190 
	}
}

	@backends/brass/brass_termlist.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_TERMLIST_H


22 
	#XAPIAN_INCLUDED_BRASS_TERMLIST_H


	)

24 
	~<¡ršg
>

26 
	~<x­Ÿn/ba£.h
>

27 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

28 
	~<x­Ÿn/ty³s.h
>

30 
Çme¥aû
 
	gX­Ÿn
 {

31 
Çme¥aû
 
	gIÁ”Çl
 {

32 
şass
 
	gEx·ndSts
;

36 
	~"b¿ss_d©aba£.h
"

37 
	~"‹rmli¡.h
"

38 
	~"b¿ss_bË.h
"

41 şas 
	cB¿ssT”mLi¡
 : 
public
 
T”mLi¡
 {

43 
İ”©Ü
=(cÚ¡ 
B¿ssT”mLi¡
 &);

46 
B¿ssT”mLi¡
(const BrassTermList &);

49 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db
;

52 
	mX­Ÿn
::
docid
 
did
;

55 
b¿ss_doş’_t
 
	mdoş’
;

58 
	mX­Ÿn
::
‹rmcouÁ
 
‹rmli¡_size
;

61 
	m¡d
::
¡ršg
 
d©a
;

67 cÚ¡ *
	mpos
;

70 cÚ¡ *
	m’d
;

73 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

76 
	mX­Ÿn
::
‹rmcouÁ
 
cu¼’t_wdf
;

83 
mubË
 
	mX­Ÿn
::
doccouÁ
 
cu¼’t_‹rmäeq
;

85 
	mpublic
:

87 
B¿ssT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db_
,

88 
X­Ÿn
::
docid
 
did_
);

94 
b¿ss_doş’_t
 
	$g‘_doş’gth
() const;

100 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

103 
	`accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const;

106 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

109 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

118 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

128 
T”mLi¡
 * 
	`Ãxt
();

131 
boŞ
 
	$©_’d
() const;

134 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

137 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

	@backends/brass/brass_termlisttable.cc

21 
	~<cÚfig.h
>

23 
	~"b¿ss_‹rmli¡bË.h
"

25 
	~<x­Ÿn/docum’t.h
>

26 
	~<x­Ÿn/”rÜ.h
>

27 
	~<x­Ÿn/‹rm™”©Ü.h
>

29 
	~"omas£¹.h
"

30 
	~"omdebug.h
"

31 
	~"·ck.h
"

32 
	~"¡ršguts.h
"

33 
	~"uts.h
"

35 
	~<¡ršg
>

37 
usšg
 
Çme¥aû
 
	g¡d
;

40 
	gB¿ssT”mLi¡TabË
::
£t_‹rmli¡
(
X­Ÿn
::
docid
 
did
,

41 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
,

42 
b¿ss_doş’_t
 
doş’
)

44 
DEBUGCALL
(
DB
, , "BrassTermListTable::set_termlist",

45 
did
 << ", " << 
doc
 << ", " << 
doş’
);

47 
¡ršg
 
	gg
;

48 
·ck_ušt
(
g
, 
doş’
);

50 
	gX­Ÿn
::
doccouÁ
 
‹rmli¡_size
 = 
doc
.
‹rmli¡_couÁ
();

51 ià(
	g‹rmli¡_size
 == 0) {

53 
As£¹
(
doş’
 == 0);

54 
As£¹
(
doc
.
‹rmli¡_begš
(è=ğdoc.
‹rmli¡_’d
());

55 
add
(
make_key
(
did
), 
¡ršg
());

59 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
doc
.
‹rmli¡_begš
();

60 ià(
	gt
 !ğ
doc
.
‹rmli¡_’d
()) {

61 
·ck_ušt
(
g
, 
‹rmli¡_size
);

62 
¡ršg
 
	g´ev_‹rm
 = *
t
;

64 
	gg
 +ğ
´ev_‹rm
.
size
();

65 
	gg
 +ğ
´ev_‹rm
;

66 
·ck_ušt
(
g
, 
t
.
g‘_wdf
());

67 --
	g‹rmli¡_size
;

69 ++
	gt
 !ğ
doc
.
‹rmli¡_’d
()) {

70 cÚ¡ 
¡ršg
 & 
‹rm
 = *
t
;

74 
size_t
 
	g»u£
 = 
commÚ_´efix_Ëngth
(
´ev_‹rm
, 
‹rm
);

83 
size_t
 
	g·cked
 = 0;

84 
	gX­Ÿn
::
‹rmcouÁ
 
wdf
 = 
t
.
g‘_wdf
();

88 ià(
	gwdf
 < 127)

89 
	g·cked
 = (
wdf
 + 1è* (
´ev_‹rm
.
size
(è+ 1è+ 
»u£
;

91 ià(
	g·cked
 &&…acked < 256) {

93 
	gg
 +ğ(
·cked
);

94 
	gg
 +ğ(
‹rm
.
size
(è- 
»u£
);

95 
	gg
.
­³nd
(
‹rm
.
d©a
(è+ 
»u£
,”m.
size
() -„euse);

97 
	gg
 +ğ(
»u£
);

98 
	gg
 +ğ(
‹rm
.
size
(è- 
»u£
);

99 
	gg
.
­³nd
(
‹rm
.
d©a
(è+ 
»u£
,”m.
size
() -„euse);

102 
·ck_ušt
(
g
, 
wdf
);

105 
	g´ev_‹rm
 = *
t
;

106 --
	g‹rmli¡_size
;

109 
As£¹
(
‹rmli¡_size
 == 0);

110 
add
(
make_key
(
did
), 
g
);

	@backends/brass/brass_termlisttable.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_TERMLISTTABLE_H


22 
	#XAPIAN_INCLUDED_BRASS_TERMLISTTABLE_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"b¿ss_ÏzybË.h
"

27 
	~"·ck.h
"

29 
	~<¡ršg
>

31 
Çme¥aû
 
	gX­Ÿn
 {

32 
şass
 
	gDocum’t
;

35 şas 
	cB¿ssT”mLi¡TabË
 : 
public
 
B¿ssLazyTabË
 {

36 
public
:

37 
¡d
::
¡ršg
 
make_key
(
X­Ÿn
::
docid
 
did
) {

38 
¡d
::
¡ršg
 
key
;

39 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

40  
	mkey
;

51 
B¿ssT”mLi¡TabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

52 : 
B¿ssLazyTabË
("‹rmli¡", 
dbdœ
 + "/‹rmli¡.", 
»adÚly
,

53 
Z_DEFAULT_STRATEGY
) { }

63 
£t_‹rmli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
doc
,

64 
b¿ss_doş’_t
 
doş’
);

70 
d–‘e_‹rmli¡
(
X­Ÿn
::
docid
 
did
è{ 
d–
(
make_key
(did)); }

79 
	$ü—‹_ªd_İ’
(
blocksize
) {

80 
B¿ssTabË
::
	`ü—‹_ªd_İ’
(
blocksize
);

81 
	}
}

	@backends/brass/brass_types.h

22 #iâdeà
OM_HGUARD_BRASS_TYPES_H


23 
	#OM_HGUARD_BRASS_TYPES_H


	)

25 
	~"š‹º®ty³s.h
"

27 
	tb¿ss_blocksize_t
;

39 
	tb¿ss_»visiÚ_numb”_t
;

45 
	tb¿ss_bËsize_t
;

50 
	tb¿ss_doş’_t
;

56 
	#BRASS_DEFAULT_BLOCK_SIZE
 8192

	)

	@backends/brass/brass_valuelist.cc

21 
	~<cÚfig.h
>

23 
	~"b¿ss_v®u–i¡.h
"

25 
	~"b¿ss_cursÜ.h
"

26 
	~"b¿ss_d©aba£.h
"

27 
	~"omas£¹.h
"

28 
	~"uts.h
"

30 
usšg
 
Çme¥aû
 
	gB¿ss
;

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
boŞ


34 
	gB¿ssV®ueLi¡
::
	$upd©e_»ad”
()

36 
X­Ÿn
::
docid
 
fœ¡_did
 = 
	`docid_äom_key
(
¦Ù
, 
cursÜ
->
cu¼’t_key
);

37 ià(!
fœ¡_did
è 
çl£
;

39 
cursÜ
->
	`»ad_g
();

40 cÚ¡ 
¡ršg
 & 
g
 = 
cursÜ
->
cu¼’t_g
;

41 
»ad”
.
	`assign
(
g
.
	`d©a
(),ag.
	`size
(), 
fœ¡_did
);

42  
Œue
;

43 
	}
}

45 
	gB¿ssV®ueLi¡
::~
	$B¿ssV®ueLi¡
()

47 
d–‘e
 
cursÜ
;

48 
	}
}

50 
	gX­Ÿn
::
docid


51 
B¿ssV®ueLi¡
::
	$g‘_docid
() const

53 
	`As£¹
(!
	`©_’d
());

54  
»ad”
.
	`g‘_docid
();

55 
	}
}

57 
	gX­Ÿn
::
v®u’o


58 
B¿ssV®ueLi¡
::
	$g‘_v®u’o
() const

60  
¦Ù
;

61 
	}
}

63 
	g¡d
::
¡ršg


64 
B¿ssV®ueLi¡
::
	$g‘_v®ue
() const

66 
	`As£¹
(!
	`©_’d
());

67  
»ad”
.
	`g‘_v®ue
();

68 
	}
}

70 
boŞ


71 
	gB¿ssV®ueLi¡
::
	$©_’d
() const

73  
cursÜ
 =ğ
NULL
;

74 
	}
}

77 
	gB¿ssV®ueLi¡
::
	$Ãxt
()

79 ià(!
cursÜ
) {

80 
cursÜ
 = 
db
->
	`g‘_po¡li¡_cursÜ
();

81 ià(!
cursÜ
) ;

82 
cursÜ
->
	`fšd_’Œy_ge
(
	`make_v®uechunk_key
(
¦Ù
, 1));

83 } ià(!
»ad”
.
	`©_’d
()) {

84 
»ad”
.
	`Ãxt
();

85 ià(!
»ad”
.
	`©_’d
()) ;

86 
cursÜ
->
	`Ãxt
();

89 ià(!
cursÜ
->
	`aá”_’d
()) {

90 ià(
	`upd©e_»ad”
()) {

91 ià(!
»ad”
.
	`©_’d
()) ;

96 
d–‘e
 
cursÜ
;

97 
cursÜ
 = 
NULL
;

98 
	}
}

101 
	gB¿ssV®ueLi¡
::
sk_to
(
X­Ÿn
::
docid
 
did
)

103 ià(!
cursÜ
) {

104 
cursÜ
 = 
db
->
g‘_po¡li¡_cursÜ
();

105 ià(!
	gcursÜ
) ;

106 } ià(!
	g»ad”
.
©_’d
()) {

107 
	g»ad”
.
sk_to
(
did
);

108 ià(!
	g»ad”
.
©_’d
()) ;

111 ià(!
	gcursÜ
->
fšd_’Œy
(
make_v®uechunk_key
(
¦Ù
, 
did
))) {

112 ià(
upd©e_»ad”
()) {

113 
	g»ad”
.
sk_to
(
did
);

114 ià(!
	g»ad”
.
©_’d
()) ;

117 
	gcursÜ
->
Ãxt
();

121 ià(!
	gcursÜ
->
aá”_’d
()) {

122 ià(
upd©e_»ad”
()) {

123 ià(!
	g»ad”
.
©_’d
()) ;

128 
d–‘e
 
	gcursÜ
;

129 
	gcursÜ
 = 
NULL
;

132 
boŞ


133 
	gB¿ssV®ueLi¡
::
check
(
X­Ÿn
::
docid
 
did
)

135 ià(!
cursÜ
) {

136 
cursÜ
 = 
db
->
g‘_po¡li¡_cursÜ
();

137 ià(!
	gcursÜ
è 
	gŒue
;

138 } ià(!
	g»ad”
.
©_’d
()) {

140 
	g»ad”
.
sk_to
(
did
);

141 ià(!
	g»ad”
.
©_’d
()è 
	gŒue
;

145 ià(!
	gcursÜ
->
fšd_’Œy
(
make_v®uechunk_key
(
¦Ù
, 
did
))) {

147 ià(
upd©e_»ad”
()) {

148 
	g»ad”
.
sk_to
(
did
);

149 ià(!
	g»ad”
.
©_’d
()è 
	gŒue
;

151  
	gçl£
;

155 
As£¹
(!
cursÜ
->
aá”_’d
());

156 ià(!
upd©e_»ad”
()) {

159 
As£¹
(
çl£
);

162  
	gŒue
;

165 
¡ršg


166 
	gB¿ssV®ueLi¡
::
	$g‘_desütiÚ
() const

168 
¡ršg
 
	`desc
("BrassValueList(slot=");

169 
desc
 +ğ
	`om_to¡ršg
(
¦Ù
);

170 
desc
 += ')';

171  
desc
;

172 
	}
}

	@backends/brass/brass_valuelist.h

21 #iâdeà
XAPIAN_INCLUDED_BRASS_VALUELIST_H


22 
	#XAPIAN_INCLUDED_BRASS_VALUELIST_H


	)

24 
	~"v®u–i¡.h
"

25 
	~"b¿ss_v®ues.h
"

27 
şass
 
	gB¿ssCursÜ
;

28 
şass
 
	gB¿ssD©aba£
;

31 şas 
	cB¿ssV®ueLi¡
 : 
public
 
X­Ÿn
::
V®ueI‹¿tÜ
::
IÁ”Çl
 {

33 
İ”©Ü
=(cÚ¡ 
B¿ssV®ueLi¡
 &);

36 
B¿ssV®ueLi¡
(const BrassValueList &);

38 
B¿ssCursÜ
 * 
	mcursÜ
;

40 
	mB¿ss
::
V®ueChunkR—d”
 
»ad”
;

42 
	mX­Ÿn
::
v®u’o
 
¦Ù
;

44 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db
;

47 
boŞ
 
upd©e_»ad”
();

49 
	mpublic
:

50 
B¿ssV®ueLi¡
(
X­Ÿn
::
v®u’o
 
¦Ù_
,

51 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
B¿ssD©aba£
> 
db_
)

52 : 
cursÜ
(
NULL
), 
¦Ù
(
¦Ù_
), 
	$db
(
db_
) { }

54 ~
	`B¿ssV®ueLi¡
();

56 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

58 
X­Ÿn
::
v®u’o
 
	$g‘_v®u’o
() const;

60 
¡d
::
¡ršg
 
	$g‘_v®ue
() const;

62 
boŞ
 
	$©_’d
() const;

64 
	`Ãxt
();

66 
	`sk_to
(
X­Ÿn
::
docid
);

68 
boŞ
 
	`check
(
X­Ÿn
::
docid
 
did
);

70 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

71 
	}
};

	@backends/brass/brass_values.cc

22 
	~<cÚfig.h
>

24 
	~"b¿ss_v®ues.h
"

26 
	~"b¿ss_cursÜ.h
"

27 
	~"b¿ss_po¡li¡.h
"

28 
	~"b¿ss_‹rmli¡.h
"

29 
	~"docum’t.h
"

30 
	~"omdebug.h
"

31 
	~"·ck.h
"

33 
	~"x­Ÿn/”rÜ.h
"

34 
	~"x­Ÿn/v®ue™”©Ü.h
"

36 
	~<®gÜ™hm
>

37 
	~"autİŒ.h
"

39 
usšg
 
Çme¥aû
 
	gB¿ss
;

40 
usšg
 
Çme¥aû
 
	g¡d
;

48 
šlše
 
¡ršg


49 
make_¦Ù_key
(
X­Ÿn
::
docid
 
did
)

51 
DEBUGCALL_STATIC
(
DB
, 
¡ršg
, "make_¦Ù_key", 
did
);

55 
¡ršg
 
	gkey
;

56 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

57 
	gkey
 += '\0';

58 
RETURN
(
key
);

62 
šlše
 
¡ršg


63 
make_v®ue¡©s_key
(
X­Ÿn
::
v®u’o
 
¦Ù
)

65 
DEBUGCALL_STATIC
(
DB
, 
¡ršg
, "make_v®ue¡©s_key", 
¦Ù
);

66 
¡ršg
 
key
("\0\xd0", 2);

67 
·ck_ušt_Ï¡
(
key
, 
¦Ù
);

68 
RETURN
(
key
);

72 
	gV®ueChunkR—d”
::
assign
(cÚ¡ * 
p_
, 
size_t
 
Ën
, 
X­Ÿn
::
docid
 
did_
)

74 
p
 = 
p_
;

75 
	g’d
 = 
p_
 + 
Ën
;

76 
	gdid
 = 
did_
;

77 ià(!
uÅack_¡ršg
(&
p
, 
’d
, 
v®ue
))

78 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Failedo unpack first value");

82 
	gV®ueChunkR—d”
::
	$Ãxt
()

84 ià(
p
 =ğ
’d
) {

85 
p
 = 
NULL
;

89 
X­Ÿn
::
docid
 
d–
;

90 ià(!
	`uÅack_ušt
(&
p
, 
’d
, &
d–
))

91 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Failedo unpack streamed value docid");

92 
did
 +ğ
d–
 + 1;

93 ià(!
	`uÅack_¡ršg
(&
p
, 
’d
, 
v®ue
))

94 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Failedo unpack streamed value");

95 
	}
}

98 
	gV®ueChunkR—d”
::
sk_to
(
X­Ÿn
::
docid
 
rg‘
)

100 ià(
p
 =ğ
NULL
 || 
rg‘
 <ğ
did
)

103 
size_t
 
	gv®ue_Ën
;

104 
	gp
 !ğ
’d
) {

106 
X­Ÿn
::
docid
 
d–
;

107 ià(
¿»
(!
uÅack_ušt
(&
p
, 
’d
, &
d–
)))

108 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Failedo unpack streamed value docid");

109 
	gdid
 +ğ
d–
 + 1;

112 ià(
¿»
(!
uÅack_ušt
(&
p
, 
’d
, &
v®ue_Ën
))) {

113 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Failedo unpack streamed value†ength");

117 ià(
¿»
(
v®ue_Ën
 > 
size_t
(
’d
 - 
p
))) {

118 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Failedo unpack streamed value");

122 ià(
	gdid
 >ğ
rg‘
) {

123 
v®ue
.
assign
(
p
, 
v®ue_Ën
);

124 
	gp
 +ğ
v®ue_Ën
;

127 
	gp
 +ğ
v®ue_Ën
;

129 
	gp
 = 
NULL
;

133 
	gB¿ssV®ueMªag”
::
add_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
,

134 cÚ¡ 
¡ršg
 & 
v®
)

136 
	gm­
<
	gX­Ÿn
::
v®u’o
, m­<X­Ÿn::
docid
, 
	g¡ršg
> >::
™”©Ü
 
i
;

137 
	gi
 = 
chªges
.
fšd
(
¦Ù
);

138 ià(
	gi
 =ğ
chªges
.
’d
()) {

139 
i
 = 
chªges
.
š£¹
(
make_·œ
(
¦Ù
, 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>())).
	gfœ¡
;

141 
	gi
->
	g£cÚd
[
did
] = 
v®
;

145 
	gB¿ssV®ueMªag”
::
»move_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
)

147 
m­
<
X­Ÿn
::
v®u’o
, 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> >::
™”©Ü
 
i
;

148 
	gi
 = 
chªges
.
fšd
(
¦Ù
);

149 ià(
	gi
 =ğ
chªges
.
’d
()) {

150 
i
 = 
chªges
.
š£¹
(
make_·œ
(
¦Ù
, 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>())).
	gfœ¡
;

152 
	gi
->
	g£cÚd
[
did
] = 
¡ršg
();

155 
	gX­Ÿn
::
docid


156 
B¿ssV®ueMªag”
::
g‘_chunk_cÚššg_did
(
X­Ÿn
::
v®u’o
 
¦Ù
,

157 
X­Ÿn
::
docid
 
did
,

158 
¡ršg
 &
chunk
) const

160 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "B¿ssV®ueMªag”::g‘_chunk_cÚššg_did", 
¦Ù
 << ", " << 
did
 << "[chunk]");

161 
	gAutoPŒ
<
	gB¿ssCursÜ
> 
cursÜ
(
po¡li¡_bË
->
cursÜ_g‘
());

162 ià(!
	gcursÜ
.
g‘
())  0;

164 
boŞ
 
	gexaù
 = 
cursÜ
->
fšd_’Œy
(
make_v®uechunk_key
(
¦Ù
, 
did
));

165 ià(!
	gexaù
) {

168 cÚ¡ * 
	gp
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

169 cÚ¡ * 
	g’d
 = 
p
 + 
cursÜ
->
cu¼’t_key
.
size
();

172 ià(
	g’d
 - 
	gp
 < 2 || *p++ !ğ'\0' || *
p
++ != '\xd8')  0;

175 
	gX­Ÿn
::
v®u’o
 
v
;

176 ià(!
uÅack_ušt
(&
p
, 
’d
, &
v
)) {

177 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad value key");

179 ià(
	gv
 !ğ
¦Ù
)  0;

182 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
p
, 
’d
, &
did
è|| 
	gp
 !=ƒnd) {

183 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad value key");

187 
	gcursÜ
->
»ad_g
();

188 
sw­
(
chunk
, 
cursÜ
->
cu¼’t_g
);

190  
	gdid
;

193 cÚ¡ 
size_t
 
	gCHUNK_SIZE_THRESHOLD
 = 2000;

195 cÚ¡ 
	gX­Ÿn
::
docid
 
MAX_DOCID
 = 
¡©ic_ÿ¡
<
X­Ÿn
::docid>(-1);

197 şas 
	cV®ueUpd©”
 {

198 
B¿ssPo¡Li¡TabË
 * 
	mbË
;

200 
	mX­Ÿn
::
v®u’o
 
¦Ù
;

202 
¡ršg
 
	mùag
;

204 
V®ueChunkR—d”
 
	m»ad”
;

206 
¡ršg
 
	mg
;

208 
	mX­Ÿn
::
docid
 
´ev_did
;

210 
	mX­Ÿn
::
docid
 
fœ¡_did
;

212 
	mX­Ÿn
::
docid
 
Ãw_fœ¡_did
;

214 
	mX­Ÿn
::
docid
 
Ï¡_®lowed_did
;

216 
­³nd_to_¡»am
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
v®ue
) {

217 
As£¹
(
did
);

218 ià(
	mg
.
em±y
()) {

219 
	mÃw_fœ¡_did
 = 
did
;

221 
As£¹R–
(
did
,>,
´ev_did
);

222 
·ck_ušt
(
g
, 
did
 - 
´ev_did
 - 1);

224 
	m´ev_did
 = 
did
;

225 
·ck_¡ršg
(
g
, 
v®ue
);

226 ià(
	mg
.
size
(è>ğ
CHUNK_SIZE_THRESHOLD
è
wr™e_g
();

229 
	$wr™e_g
() {

231 ià(
fœ¡_did
 && 
Ãw_fœ¡_did
 != first_did) {

232 
bË
->
	`d–
(
	`make_v®uechunk_key
(
¦Ù
, 
fœ¡_did
));

234 ià(!
g
.
	`em±y
()) {

235 
bË
->
	`add
(
	`make_v®uechunk_key
(
¦Ù
, 
Ãw_fœ¡_did
), 
g
);

237 
fœ¡_did
 = 0;

238 
g
.
	`»size
(0);

239 
	}
}

241 
	gpublic
:

242 
V®ueUpd©”
(
B¿ssPo¡Li¡TabË
 * 
bË_
, 
X­Ÿn
::
v®u’o
 
¦Ù_
)

243 : 
bË
(
bË_
), 
¦Ù
(
¦Ù_
), 
fœ¡_did
(0), 
	$Ï¡_®lowed_did
(0è{ 
	}
}

245 ~
	$V®ueUpd©”
() {

246 !
»ad”
.
	`©_’d
()) {

248 
	`­³nd_to_¡»am
(
»ad”
.
	`g‘_docid
(),„—d”.
	`g‘_v®ue
());

249 
»ad”
.
	`Ãxt
();

251 
	`wr™e_g
();

252 
	}
}

254 
upd©e
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
v®ue
) {

255 ià(
	gÏ¡_®lowed_did
 && 
	gdid
 >†ast_allowed_did) {

261 !
	g»ad”
.
©_’d
()) {

263 
As£¹R–
(
»ad”
.
g‘_docid
(),<=,
Ï¡_®lowed_did
);

264 
­³nd_to_¡»am
(
»ad”
.
g‘_docid
(),„—d”.
g‘_v®ue
());

265 
	g»ad”
.
Ãxt
();

267 
wr™e_g
();

268 
	gÏ¡_®lowed_did
 = 0;

270 ià(
	gÏ¡_®lowed_did
 == 0) {

271 
Ï¡_®lowed_did
 = 
MAX_DOCID
;

272 
As£¹
(
g
.
em±y
());

273 
	gÃw_fœ¡_did
 = 0;

274 
	gAutoPŒ
<
	gB¿ssCursÜ
> 
cursÜ
(
bË
->
cursÜ_g‘
());

275 ià(
	gcursÜ
->
fšd_’Œy
(
make_v®uechunk_key
(
¦Ù
, 
did
))) {

278 
	gfœ¡_did
 = 
did
;

280 
As£¹
(!
cursÜ
->
aá”_’d
());

284 
	gfœ¡_did
 = 
docid_äom_key
(
¦Ù
, 
cursÜ
->
cu¼’t_key
);

291 ià(
	gfœ¡_did
) {

293 
	gcursÜ
->
»ad_g
();

295 
	gùag
 = 
cursÜ
->
cu¼’t_g
;

296 
	g»ad”
.
assign
(
ùag
.
d©a
(), cg.
size
(), 
fœ¡_did
);

298 ià(
	gcursÜ
->
Ãxt
()) {

299 cÚ¡ 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

300 
	gX­Ÿn
::
docid
 
Ãxt_fœ¡_did
 = 
docid_äom_key
(
¦Ù
, 
key
);

301 ià(
	gÃxt_fœ¡_did
è
	gÏ¡_®lowed_did
 = 
Ãxt_fœ¡_did
 - 1;

302 
As£¹
(
Ï¡_®lowed_did
);

303 
As£¹R–
(
Ï¡_®lowed_did
,>=,
fœ¡_did
);

310 !
	g»ad”
.
©_’d
(è&&„—d”.
g‘_docid
(è< 
	gdid
) {

311 
­³nd_to_¡»am
(
»ad”
.
g‘_docid
(),„—d”.
g‘_v®ue
());

312 
	g»ad”
.
Ãxt
();

314 ià(!
	g»ad”
.
©_’d
(è&&„—d”.
g‘_docid
(è=ğ
did
è
»ad”
.
Ãxt
();

315 ià(!
	gv®ue
.
em±y
()) {

317 
­³nd_to_¡»am
(
did
, 
v®ue
);

323 
	gB¿ssV®ueMªag”
::
	$m”ge_chªges
()

325 ià(
‹rmli¡_bË
->
	`is_İ’
()) {

326 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

327 
i
 = 
¦Ùs
.
	`begš
(); i !ğ¦Ùs.
	`’d
(); ++i) {

328 cÚ¡ 
¡ršg
 & 
’c
 = 
i
->
£cÚd
;

329 
¡ršg
 
key
 = 
	`make_¦Ù_key
(
i
->
fœ¡
);

330 ià(!
’c
.
	`em±y
()) {

331 
‹rmli¡_bË
->
	`add
(
key
, 
i
->
£cÚd
);

333 
‹rmli¡_bË
->
	`d–
(
key
);

336 
¦Ùs
.
	`ş—r
();

340 
m­
<
X­Ÿn
::
v®u’o
, m­<X­Ÿn::
docid
, 
¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

341 
i
 = 
chªges
.
	`begš
(); i !ğchªges.
	`’d
(); ++i) {

342 
X­Ÿn
::
v®u’o
 
¦Ù
 = 
i
->
fœ¡
;

343 
V®ueUpd©”
 
	`upd©”
(
po¡li¡_bË
, 
¦Ù
);

344 cÚ¡ 
m­
<
X­Ÿn
::
docid
, 
¡ršg
> & 
¦Ù_chªges
 = 
i
->
£cÚd
;

345 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>::
cÚ¡_™”©Ü
 
j
;

346 
j
 = 
¦Ù_chªges
.
	`begš
(); j !ğ¦Ù_chªges.
	`’d
(); ++j) {

347 
upd©”
.
	`upd©e
(
j
->
fœ¡
, j->
£cÚd
);

350 
chªges
.
	`ş—r
();

352 
	}
}

355 
	gB¿ssV®ueMªag”
::
add_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 &
doc
,

356 
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
)

360 
¡ršg
 
	g¦Ùs_u£d
;

361 
	gX­Ÿn
::
v®u’o
 
´ev_¦Ù
 = 
¡©ic_ÿ¡
<
X­Ÿn
::valueno>(-1);

362 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
™
 = 
doc
.
v®ues_begš
();

363 
	g™
 !ğ
doc
.
v®ues_’d
()) {

364 
X­Ÿn
::
v®u’o
 
¦Ù
 = 
™
.
g‘_v®u’o
();

365 
¡ršg
 
	gv®ue
 = *
™
;

368 
	g¡d
::
·œ
<
m­
<
X­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
™”©Ü
, 
	gboŞ
> 
	gi
;

369 
	gi
 = 
v®ue_¡©s
.
š£¹
(
make_·œ
(
¦Ù
, 
V®ueSts
()));

370 
	gV®ueSts
 & 
	g¡©s
 = 
i
.
fœ¡
->
£cÚd
;

371 ià(
	gi
.
	g£cÚd
) {

373 
g‘_v®ue_¡©s
(
¦Ù
, 
¡©s
);

377 ià((
	g¡©s
.
	gäeq
)++ == 0) {

380 
¡©s
.
low”_bound
 = 
v®ue
;

381 
	g¡©s
.
	guµ”_bound
 = 
v®ue
;

384 ià(
	gv®ue
 < 
	g¡©s
.
	glow”_bound
) {

385 
	g¡©s
.
	glow”_bound
 = 
v®ue
;

386 } ià(
	gv®ue
 > 
	g¡©s
.
	guµ”_bound
) {

387 
	g¡©s
.
	guµ”_bound
 = 
v®ue
;

391 
add_v®ue
(
did
, 
¦Ù
, 
v®ue
);

392 ià(
	g‹rmli¡_bË
->
is_İ’
()) {

393 
·ck_ušt
(
¦Ùs_u£d
, 
¦Ù
 - 
´ev_¦Ù
 - 1);

394 
	g´ev_¦Ù
 = 
¦Ù
;

396 ++
	g™
;

398 ià(
	g¦Ùs_u£d
.
em±y
(è&& 
	g¦Ùs
.
fšd
(
did
è=ğ
¦Ùs
.
’d
()) {

401 
sw­
(
¦Ùs
[
did
], 
¦Ùs_u£d
);

406 
	gB¿ssV®ueMªag”
::
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
,

407 
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
)

409 
As£¹
(
‹rmli¡_bË
->
is_İ’
());

410 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
>::
™”©Ü
 
™
 = 
¦Ùs
.
fšd
(
did
);

411 
¡ršg
 
	gs
;

412 ià(
	g™
 !ğ
¦Ùs
.
’d
()) {

413 
sw­
(
s
, 
™
->
£cÚd
);

416 ià(!
	g‹rmli¡_bË
->
g‘_exaù_’Œy
(
make_¦Ù_key
(
did
), 
s
)) ;

417 
	g¦Ùs
.
š£¹
(
make_·œ
(
did
, 
¡ršg
()));

419 cÚ¡ * 
	gp
 = 
s
.
d©a
();

420 cÚ¡ * 
	g’d
 = 
p
 + 
s
.
size
();

421 
	gX­Ÿn
::
v®u’o
 
´ev_¦Ù
 = 
¡©ic_ÿ¡
<
X­Ÿn
::valueno>(-1);

422 
	gp
 !ğ
’d
) {

423 
X­Ÿn
::
v®u’o
 
¦Ù
;

424 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
)) {

425 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Value slotƒncoding corrupt");

427 
	g¦Ù
 +ğ
´ev_¦Ù
 + 1;

428 
	g´ev_¦Ù
 = 
¦Ù
;

430 
	g¡d
::
·œ
<
m­
<
X­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
™”©Ü
, 
	gboŞ
> 
	gi
;

431 
	gi
 = 
v®ue_¡©s
.
š£¹
(
make_·œ
(
¦Ù
, 
V®ueSts
()));

432 
	gV®ueSts
 & 
	g¡©s
 = 
i
.
fœ¡
->
£cÚd
;

433 ià(
	gi
.
	g£cÚd
) {

435 
g‘_v®ue_¡©s
(
¦Ù
, 
¡©s
);

439 
As£¹R–P¬ªoid
(
¡©s
.
äeq
, >, 0);

440 ià(--(
	g¡©s
.
	gäeq
) == 0) {

441 
¡©s
.
low”_bound
.
»size
(0);

442 
	g¡©s
.
	guµ”_bound
.
»size
(0);

445 
»move_v®ue
(
did
, 
¦Ù
);

450 
	gB¿ssV®ueMªag”
::
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

451 cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
,

452 
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
)

457 
	gdoc
.
	gš‹º®
->
Ãed_v®ues
();

458 
d–‘e_docum’t
(
did
, 
v®ue_¡©s
);

459 
add_docum’t
(
did
, 
doc
, 
v®ue_¡©s
);

462 
¡ršg


463 
	gB¿ssV®ueMªag”
::
g‘_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
) const

465 
m­
<
X­Ÿn
::
v®u’o
, 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

466 
	gi
 = 
chªges
.
fšd
(
¦Ù
);

467 ià(
	gi
 !ğ
chªges
.
’d
()) {

468 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>::
cÚ¡_™”©Ü
 
j
;

469 
	gj
 = 
i
->
£cÚd
.
fšd
(
did
);

470 ià(
	gj
 !ğ
i
->
£cÚd
.
’d
()è 
j
->second;

474 
¡ršg
 
	gchunk
;

475 
	gX­Ÿn
::
docid
 
fœ¡_did
;

476 
	gfœ¡_did
 = 
g‘_chunk_cÚššg_did
(
¦Ù
, 
did
, 
chunk
);

477 ià(
	gfœ¡_did
 =ğ0è 
¡ršg
();

479 
V®ueChunkR—d”
 
»ad”
(
chunk
.
d©a
(), chunk.
size
(), 
fœ¡_did
);

480 
	g»ad”
.
sk_to
(
did
);

481 ià(
	g»ad”
.
©_’d
(è||„—d”.
g‘_docid
(è!ğ
did
è 
¡ršg
();

482  
	g»ad”
.
g‘_v®ue
();

486 
	gB¿ssV®ueMªag”
::
g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues
,

487 
X­Ÿn
::
docid
 
did
) const

489 
As£¹
(
v®ues
.
em±y
());

490 ià(!
	g‹rmli¡_bË
->
is_İ’
())

491 
throw
 
	gX­Ÿn
::
F—tu»UÇvaabËE¼Ü
("Database has‚oermlist");

492 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
 = 
¦Ùs
.
fšd
(
did
);

493 
¡ršg
 
	gs
;

494 ià(
	gi
 !ğ
¦Ùs
.
’d
()) {

495 
s
 = 
i
->
£cÚd
;

498 ià(!
	g‹rmli¡_bË
->
g‘_exaù_’Œy
(
make_¦Ù_key
(
did
), 
s
)) ;

500 cÚ¡ * 
	gp
 = 
s
.
d©a
();

501 cÚ¡ * 
	g’d
 = 
p
 + 
s
.
size
();

502 
	gX­Ÿn
::
v®u’o
 
´ev_¦Ù
 = 
¡©ic_ÿ¡
<
X­Ÿn
::valueno>(-1);

503 
	gp
 !ğ
’d
) {

504 
X­Ÿn
::
v®u’o
 
¦Ù
;

505 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
)) {

506 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Value slotƒncoding corrupt");

508 
	g¦Ù
 +ğ
´ev_¦Ù
 + 1;

509 
	g´ev_¦Ù
 = 
¦Ù
;

510 
	gv®ues
.
š£¹
(
make_·œ
(
¦Ù
, 
g‘_v®ue
(
did
, slot)));

515 
	gB¿ssV®ueMªag”
::
g‘_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

517 
DEBUGCALL
(
DB
, , "B¿ssV®ueMªag”::g‘_v®ue_¡©s", 
¦Ù
);

519 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

520 
g‘_v®ue_¡©s
(
¦Ù
, 
mru_v®¡©s
);

521 
	gmru_v®no
 = 
¦Ù
;

525 
	gB¿ssV®ueMªag”
::
g‘_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
¦Ù
, 
V®ueSts
 & 
¡©s
) const

527 
DEBUGCALL
(
DB
, , "B¿ssV®ueMªag”::g‘_v®ue_¡©s", 
¦Ù
 << ", [stats]");

529 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

531 
¡ršg
 
	gg
;

532 ià(
	gpo¡li¡_bË
->
g‘_exaù_’Œy
(
make_v®ue¡©s_key
(
¦Ù
), 
g
)) {

533 cÚ¡ * 
	gpos
 = 
g
.
d©a
();

534 cÚ¡ * 
	g’d
 = 
pos
 + 
g
.
size
();

536 ià(!
uÅack_ušt
(&
pos
, 
’d
, &(
¡©s
.
äeq
))) {

537 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete stats item in valueable");

538 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Frequency statistic in valueable isoo†arge");

540 ià(!
uÅack_¡ršg
(&
pos
, 
’d
, 
¡©s
.
low”_bound
)) {

541 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete stats item in valueable");

542 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Lower bound in valueable isoo†arge");

544 
size_t
 
	gËn
 = 
’d
 - 
pos
;

545 ià(
	gËn
 == 0) {

546 
¡©s
.
uµ”_bound
 = sts.
low”_bound
;

548 
	g¡©s
.
	guµ”_bound
.
assign
(
pos
, 
Ën
);

551 
	g¡©s
.
ş—r
();

554 
	gmru_v®no
 = 
¦Ù
;

558 
	gB¿ssV®ueMªag”
::
£t_v®ue_¡©s
(
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
)

560 
DEBUGCALL
(
DB
, , "BrassValueManager::set_value_stats", "[value_stats]");

561 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
;

562 
	gi
 = 
v®ue_¡©s
.
begš
(); i !ğv®ue_¡©s.
’d
(); ++i) {

563 
¡ršg
 
	gkey
 = 
make_v®ue¡©s_key
(
i
->
fœ¡
);

564 cÚ¡ 
	gV®ueSts
 & 
	g¡©s
 = 
i
->
£cÚd
;

565 ià(
	g¡©s
.
	gäeq
 != 0) {

566 
¡ršg
 
Ãw_v®ue
;

567 
·ck_ušt
(
Ãw_v®ue
, 
¡©s
.
äeq
);

568 
·ck_¡ršg
(
Ãw_v®ue
, 
¡©s
.
low”_bound
);

572 ià(
	g¡©s
.
	glow”_bound
 !ğ
¡©s
.
uµ”_bound
)

573 
Ãw_v®ue
 +ğ
¡©s
.
uµ”_bound
;

574 
	gpo¡li¡_bË
->
add
(
key
, 
Ãw_v®ue
);

576 
	gpo¡li¡_bË
->
d–
(
key
);

579 
	gv®ue_¡©s
.
ş—r
();

580 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

	@backends/brass/brass_values.h

22 #iâdeà
XAPIAN_INCLUDED_BRASS_VALUES_H


23 
	#XAPIAN_INCLUDED_BRASS_VALUES_H


	)

25 
	~"·ck.h
"

26 
	~"v®ue¡©s.h
"

28 
	~"x­Ÿn/”rÜ.h
"

29 
	~"x­Ÿn/ty³s.h
"

31 
	~<m­
>

32 
	~<¡ršg
>

34 
Çme¥aû
 
	gB¿ss
 {

37 
šlše
 
	g¡d
::
¡ršg


38 
make_v®uechunk_key
(
X­Ÿn
::
v®u’o
 
¦Ù
, X­Ÿn::
docid
 
did
)

40 
¡d
::
¡ršg
 
key
("\0\xd8", 2);

41 
·ck_ušt
(
key
, 
¦Ù
);

42 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

43  
	gkey
;

46 
šlše
 
	gX­Ÿn
::
docid


47 
docid_äom_key
(
X­Ÿn
::
v®u’o
 
»quœed_¦Ù
, cÚ¡ 
¡d
::
¡ršg
 & 
key
)

49 cÚ¡ * 
p
 = 
key
.
d©a
();

50 cÚ¡ * 
	g’d
 = 
p
 + 
key
.
Ëngth
();

52 ià(
	g’d
 - 
	gp
 < 2 || *p++ !ğ'\0' || *
p
++ != '\xd8')  0;

53 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

54 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
))

55 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("bad value key");

57 ià(
	g¦Ù
 !ğ
»quœed_¦Ù
)  0;

58 
	gX­Ÿn
::
docid
 
did
;

59 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
p
, 
’d
, &
did
))

60 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("bad value key");

61  
	gdid
;

66 
Çme¥aû
 
	gX­Ÿn
 {

67 
şass
 
	gDocum’t
;

70 
şass
 
	gB¿ssPo¡Li¡TabË
;

71 
şass
 
	gB¿ssT”mLi¡TabË
;

72 
	gV®ueSts
;

74 şas 
	cB¿ssV®ueMªag”
 {

80 
mubË
 
	mX­Ÿn
::
v®u’o
 
mru_v®no
;

83 
mubË
 
V®ueSts
 
	mmru_v®¡©s
;

85 
B¿ssPo¡Li¡TabË
 * 
	mpo¡li¡_bË
;

87 
B¿ssT”mLi¡TabË
 * 
	m‹rmli¡_bË
;

89 
	m¡d
::
m­
<
X­Ÿn
::
docid
, std::
¡ršg
> 
¦Ùs
;

91 
	m¡d
::
m­
<
X­Ÿn
::
v®u’o
, std::m­<X­Ÿn::
docid
, std::
¡ršg
> > 
chªges
;

93 
add_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
,

94 cÚ¡ 
¡d
::
¡ršg
 & 
v®
);

96 
»move_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
);

98 
	mX­Ÿn
::
docid
 
g‘_chunk_cÚššg_did
(
X­Ÿn
::
v®u’o
 
¦Ù
,

99 
X­Ÿn
::
docid
 
did
,

100 
¡d
::
¡ršg
 &
chunk
) const;

103 
g‘_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

105 
g‘_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
¦Ù
, 
V®ueSts
 & 
¡©s
) const;

107 
	mpublic
:

109 
	$B¿ssV®ueMªag”
(
B¿ssPo¡Li¡TabË
 * 
po¡li¡_bË_
,

110 
B¿ssT”mLi¡TabË
 * 
‹rmli¡_bË_
)

111 : 
	`mru_v®no
(
X­Ÿn
::
BAD_VALUENO
),

112 
	`po¡li¡_bË
(
po¡li¡_bË_
),

113 
	$‹rmli¡_bË
(
‹rmli¡_bË_
) { }

116 
	`m”ge_chªges
();

118 
	`add_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 &
doc
,

119 
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
);

121 
	`d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
,

122 
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
);

124 
	`»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 &
doc
,

125 
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
);

127 
¡d
::
¡ršg
 
	`g‘_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
) const;

129 
	`g‘_®l_v®ues
(
¡d
::
m­
<
X­Ÿn
::
v®u’o
, std::
¡ršg
> & 
v®ues
,

130 
X­Ÿn
::
docid
 
did
) const;

132 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
¦Ù
) const {

133 ià(
mru_v®no
 !ğ
¦Ù
è
	`g‘_v®ue_¡©s
(slot);

134  
mru_v®¡©s
.
äeq
;

135 
	}
}

137 
	g¡d
::
¡ršg
 
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
¦Ù
) const {

138 ià(
mru_v®no
 !ğ
¦Ù
è
g‘_v®ue_¡©s
(slot);

139  
	gmru_v®¡©s
.
	glow”_bound
;

142 
	g¡d
::
¡ršg
 
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
¦Ù
) const {

143 ià(
mru_v®no
 !ğ
¦Ù
è
g‘_v®ue_¡©s
(slot);

144  
	gmru_v®¡©s
.
	guµ”_bound
;

154 
£t_v®ue_¡©s
(
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
);

156 
	$»£t
() {

158 
mru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

159 
	}
}

161 
boŞ
 
	$is_modif›d
() const {

162  !
chªges
.
	`em±y
();

163 
	}
}

165 
	$ÿnûl
() {

167 
¦Ùs
.
	`ş—r
();

168 
chªges
.
	`ş—r
();

169 
	}
}

172 
Çme¥aû
 
	gB¿ss
 {

174 şas 
	cV®ueChunkR—d”
 {

175 cÚ¡ *
	gp
;

176 cÚ¡ *
	g’d
;

178 
	gX­Ÿn
::
docid
 
did
;

180 
	g¡d
::
¡ršg
 
v®ue
;

182 
	gpublic
:

184 
V®ueChunkR—d”
(è: 
p
(
NULL
) { }

186 
V®ueChunkR—d”
(cÚ¡ * 
p_
, 
size_t
 
Ën
, 
X­Ÿn
::
docid
 
did_
) {

187 
assign
(
p_
, 
Ën
, 
did_
);

190 
assign
(cÚ¡ * 
p_
, 
size_t
 
Ën
, 
X­Ÿn
::
docid
 
did_
);

192 
boŞ
 
©_’d
(ècÚ¡ {  
	gp
 =ğ
NULL
; }

194 
	gX­Ÿn
::
docid
 
g‘_docid
(ècÚ¡ {  
did
; }

196 cÚ¡ 
	g¡d
::
¡ršg
 & 
g‘_v®ue
(ècÚ¡ {  
v®ue
; }

198 
Ãxt
();

200 
sk_to
(
X­Ÿn
::
docid
 
rg‘
);

	@backends/brass/brass_version.cc

21 
	~<cÚfig.h
>

23 
	~"§ã”ºo.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"b¿ss_io.h
"

28 
	~"b¿ss_v”siÚ.h
"

29 
	~"omas£¹.h
"

30 
	~"¡ršguts.h
"

31 
	~"uts.h
"

33 #ifdeà
__WIN32__


34 
	~"msvc_posix_w¿µ”.h
"

37 
	~<c¡dio
>

38 
	~<c¡ršg
>

39 
	~<¡ršg
>

41 
	~"commÚ/§ãuuid.h
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

46 
	#BRASS_VERSION
 200912150

	)

49 
	#MAGIC_STRING
 "IAmB¿ss"

	)

51 
	#MAGIC_LEN
 
	`CONST_STRLEN
(
MAGIC_STRING
)

	)

53 
	#VERSIONFILE_SIZE
 (
MAGIC_LEN
 + 4 + 16)

	)

58 
	#VERSIONFILE_SIZE_LITERAL
 28

	)

61 
	gB¿ssV”siÚ
::
	$ü—‹
()

63 
buf
[
VERSIONFILE_SIZE
] = 
MAGIC_STRING
;

64 *
v
 = 
»š‹½»t_ÿ¡
<*>(
buf
è+ 
MAGIC_LEN
;

65 
v
[0] = 
¡©ic_ÿ¡
<>(
BRASS_VERSION
 & 0xff);

66 
v
[1] = 
¡©ic_ÿ¡
<>((
BRASS_VERSION
 >> 8) & 0xff);

67 
v
[2] = 
¡©ic_ÿ¡
<>((
BRASS_VERSION
 >> 16) & 0xff);

68 
v
[3] = 
¡©ic_ÿ¡
<>((
BRASS_VERSION
 >> 24) & 0xff);

70 
	`uuid_g’”©e
(
uuid
);

71 
	`memıy
(
buf
 + 
MAGIC_LEN
 + 4, (*)
uuid
, 16);

73 
fd
 = ::
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
|
O_CREAT
|
O_TRUNC
|
O_BINARY
, 0666);

75 ià(
fd
 < 0) {

76 
¡ršg
 
	`msg
("Failedo create brass version file: ");

77 
msg
 +ğ
f’ame
;

78 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

81 
Œy
 {

82 
	`b¿ss_io_wr™e
(
fd
, 
buf
, 
VERSIONFILE_SIZE
);

83 } 
	`ÿtch
 (...) {

84 ()
	`şo£
(
fd
);

85 
throw
;

88 ià(
	`şo£
(
fd
) != 0) {

89 
¡ršg
 
	`msg
("Failedo create brass version file: ");

90 
msg
 +ğ
f’ame
;

91 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

93 
	}
}

96 
	gB¿ssV”siÚ
::
	$»ad_ªd_check
()

98 
fd
 = ::
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_RDONLY
|
O_BINARY
);

100 ià(
fd
 < 0) {

101 
¡ršg
 
msg
 = 
f’ame
;

102 
msg
 += ": Failedo open brass version file for„eading";

103 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

107 
buf
[
VERSIONFILE_SIZE
 + 1];

108 
size_t
 
size
;

109 
Œy
 {

110 
size
 = 
	`b¿ss_io_»ad
(
fd
, 
buf
, 
VERSIONFILE_SIZE
 + 1, 0);

111 } 
	`ÿtch
 (...) {

112 ()
	`şo£
(
fd
);

113 
throw
;

115 ()
	`şo£
(
fd
);

117 ià(
size
 !ğ
VERSIONFILE_SIZE
) {

118 
	`CompeTimeAs£¹
(
VERSIONFILE_SIZE
 =ğ
VERSIONFILE_SIZE_LITERAL
);

119 
¡ršg
 
msg
 = 
f’ame
;

120 
msg
 += ": Brass version file should be "

121 
	`STRINGIZE
(
VERSIONFILE_SIZE_LITERAL
)" bytes,‡ctually ";

122 
msg
 +ğ
	`om_to¡ršg
(
size
);

123 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

126 ià(
	`memcmp
(
buf
, 
MAGIC_STRING
, 
MAGIC_LEN
) != 0) {

127 
¡ršg
 
msg
 = 
f’ame
;

128 
msg
 += ": Brass version file doesn't containhe„ight magic string";

129 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

132 cÚ¡ *
v
;

133 
v
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
è+ 
MAGIC_LEN
;

134 
v”siÚ
 = 
v
[0] | (v[1] << 8) | (v[2] << 16) | (v[3] << 24);

135 ià(
v”siÚ
 !ğ
BRASS_VERSION
) {

136 
¡ršg
 
msg
 = 
f’ame
;

137 
msg
 += ": Brass version file is version ";

138 
msg
 +ğ
	`om_to¡ršg
(
v”siÚ
);

139 
msg
 +ğ" buˆI oÆy und”¡ªd "
	`STRINGIZE
(
BRASS_VERSION
);

140 
throw
 
X­Ÿn
::
	`D©aba£V”siÚE¼Ü
(
msg
);

143 
	`memıy
((*)
uuid
, 
buf
 + 
MAGIC_LEN
 + 4, 16);

144 
	}
}

	@backends/brass/brass_version.h

21 #iâdeà
OM_HGUARD_BRASS_VERSION_H


22 
	#OM_HGUARD_BRASS_VERSION_H


	)

24 
	~<c¡ršg
>

25 
	~<¡ršg
>

27 
	~"commÚ/§ãuuid.h
"

34 şas 
	cB¿ssV”siÚ
 {

36 
	m¡d
::
¡ršg
 
f’ame
;

42 
mubË
 
uuid_t
 
	muuid
;

44 
	mpublic
:

45 
B¿ssV”siÚ
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
è: 
	$f’ame
(
dbdœ
) {

46 
f’ame
 += "/iambrass";

50 
	`ü—‹
();

56 
	`»ad_ªd_check
();

59 cÚ¡ * 
	$g‘_uuid
() const {

61  
»š‹½»t_ÿ¡
<cÚ¡ *>(
uuid
);

62 
	}
}

65 
	g¡d
::
¡ršg
 
	$g‘_uuid_¡ršg
() const {

66 
buf
[37];

67 
	`uuid_uÅ¬£_low”
(
uuid
, 
buf
);

68  
¡d
::
	`¡ršg
(
buf
, 36);

69 
	}
}

72 
	$£t_uuid
(* 
d©a
) {

73 
¡d
::
	`memıy
(
uuid
, 
d©a
, 16);

74 
	}
}

80 
boŞ
 
£t_uuid_¡ršg
(cÚ¡ 
¡d
::
¡ršg
 & 
s
) {

81  
uuid_·r£
(
s
.
c_¡r
(), 
uuid
);

	@backends/chert/chert_alldocsmodifiedpostlist.cc

22 
	~<cÚfig.h
>

24 
	~"ch”t_®ldocsmodif›dpo¡li¡.h
"

25 
	~"ch”t_d©aba£.h
"

27 
	~"uts.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
	gCh”tAÎDocsModif›dPo¡Li¡
::
Ch”tAÎDocsModif›dPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db_
,

32 
X­Ÿn
::
doccouÁ
 
doccouÁ_
,

33 cÚ¡ 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> & 
doş’s_
)

34 : 
Ch”tAÎDocsPo¡Li¡
(
db_
, 
doccouÁ_
),

35 
doş’s
(
doş’s_
),

36 
doş’s_™
(
doş’s
.
	$begš
())

38 
	`DEBUGCALL
(
DB
, , "Ch”tAÎDocsModif›dPo¡Li¡::Ch”tAÎDocsModif›dPo¡Li¡", 
db_
.
	`g‘
(è<< ", " << 
doccouÁ_
 << ", " << "doclens");

39 
	}
}

42 
	gCh”tAÎDocsModif›dPo¡Li¡
::
sk_d–‘es
(
X­Ÿn
::
weight
 
w_mš
)

44 
DEBUGCALL
(
DB
, , "Ch”tAÎDocsModif›dPo¡Li¡::sk_d–‘es", 
w_mš
);

45 !
	gCh”tAÎDocsPo¡Li¡
::
©_’d
()) {

46 ià(
doş’s_™
 =ğ
doş’s
.
’d
()) ;

47 ià(
	gdoş’s_™
->
	gfœ¡
 !ğ
Ch”tAÎDocsPo¡Li¡
::
g‘_docid
()) ;

48 ià(
	gdoş’s_™
->
	g£cÚd
 !ğ
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(-1)) ;

49 ++
	gdoş’s_™
;

50 
	gCh”tAÎDocsPo¡Li¡
::
Ãxt
(
w_mš
);

52 
	gdoş’s_™
 !ğ
doş’s
.
’d
(è&& 
doş’s_™
->
£cÚd
 =ğ
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(-1)) {

53 ++
doş’s_™
;

57 
	gX­Ÿn
::
docid


58 
Ch”tAÎDocsModif›dPo¡Li¡
::
	$g‘_docid
() const

60 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "ChertAllDocsModifiedPostList::get_docid()", "");

61 ià(
doş’s_™
 =ğ
doş’s
.
	`’d
()è
	`RETURN
(
Ch”tAÎDocsPo¡Li¡
::
	`g‘_docid
());

62 ià(
Ch”tAÎDocsPo¡Li¡
::
	`©_’d
()è
	`RETURN
(
doş’s_™
->
fœ¡
);

63 
	`RETURN
(
	`mš
(
doş’s_™
->
fœ¡
, 
Ch”tAÎDocsPo¡Li¡
::
	`g‘_docid
()));

64 
	}
}

66 
	gX­Ÿn
::
‹rmcouÁ


67 
Ch”tAÎDocsModif›dPo¡Li¡
::
	$g‘_doş’gth
() const

69 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
,

73 ià(
doş’s_™
 !ğ
doş’s
.
	`’d
() &&

74 (
Ch”tAÎDocsPo¡Li¡
::
	`©_’d
() ||

75 
doş’s_™
->
fœ¡
 <ğ
Ch”tAÎDocsPo¡Li¡
::
	`g‘_docid
()))

76 
	`RETURN
(
doş’s_™
->
£cÚd
);

78 
	`RETURN
(
Ch”tAÎDocsPo¡Li¡
::
	`g‘_doş’gth
());

79 
	}
}

81 
Po¡Li¡
 *

82 
	gCh”tAÎDocsModif›dPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

84 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *,

85 "Ch”tAÎDocsModif›dPo¡Li¡::Ãxt", 
w_mš
);

86 ià(
	ghave_¡¬‹d
) {

87 ià(
	gCh”tAÎDocsPo¡Li¡
::
©_’d
()) {

88 ++
doş’s_™
;

89 
sk_d–‘es
(
w_mš
);

90 
RETURN
(
NULL
);

92 
	gX­Ÿn
::
docid
 
unmod_did
 = 
Ch”tAÎDocsPo¡Li¡
::
g‘_docid
();

93 ià(
	gdoş’s_™
 !ğ
doş’s
.
’d
(è&& 
doş’s_™
->
fœ¡
 <ğ
unmod_did
) {

94 ià(
doş’s_™
->
fœ¡
 < 
unmod_did
 &&

95 
doş’s_™
->
£cÚd
 !ğ
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(-1)) {

96 ++
doş’s_™
;

97 
sk_d–‘es
(
w_mš
);

98 
RETURN
(
NULL
);

100 ++
	gdoş’s_™
;

103 
	gCh”tAÎDocsPo¡Li¡
::
Ãxt
(
w_mš
);

104 
sk_d–‘es
(
w_mš
);

105 
RETURN
(
NULL
);

108 
Po¡Li¡
 *

109 
	gCh”tAÎDocsModif›dPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
desœed_did
,

110 
X­Ÿn
::
weight
 
w_mš
)

112 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *,

114 
desœed_did
 << ", " << 
w_mš
);

115 ià(!
	gCh”tAÎDocsPo¡Li¡
::
©_’d
())

116 
Ch”tAÎDocsPo¡Li¡
::
sk_to
(
desœed_did
, 
w_mš
);

118 
	gdoş’s_™
 !ğ
doş’s
.
’d
(è&& 
doş’s_™
->
fœ¡
 < 
desœed_did
) {

119 ++
doş’s_™
;

121 
sk_d–‘es
(
w_mš
);

122 
RETURN
(
NULL
);

125 
boŞ


126 
	gCh”tAÎDocsModif›dPo¡Li¡
::
	$©_’d
() const

128 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertAllDocsModifiedPostList::end", "");

129 
	`RETURN
(
doş’s_™
 =ğ
doş’s
.
	`’d
(è&& 
Ch”tAÎDocsPo¡Li¡
::
	`©_’d
());

130 
	}
}

132 
¡ršg


133 
	gCh”tAÎDocsModif›dPo¡Li¡
::
	$g‘_desütiÚ
() const

135 
¡ršg
 
desc
 = "ChertAllDocsModifiedPostList(did=";

136 
desc
 +ğ
	`om_to¡ršg
(
	`g‘_docid
());

137 
desc
 += ')';

138  
desc
;

139 
	}
}

	@backends/chert/chert_alldocsmodifiedpostlist.h

22 #iâdeà
XAPIAN_INCLUDED_CHERT_ALLDOCSMODIFIEDPOSTLIST_H


23 
	#XAPIAN_INCLUDED_CHERT_ALLDOCSMODIFIEDPOSTLIST_H


	)

25 
	~<¡ršg
>

27 
	~"ch”t_®ldoc¥o¡li¡.h
"

29 şas 
	cCh”tAÎDocsModif›dPo¡Li¡
 : 
public
 
Ch”tAÎDocsPo¡Li¡
 {

31 
m­
<
X­Ÿn
::
docid
, 
	mX­Ÿn
::
‹rmcouÁ
> 
doş’s
;

34 
	mm­
<
	mX­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
doş’s_™
;

37 
	mİ”©Ü
=(cÚ¡ 
Ch”tAÎDocsModif›dPo¡Li¡
 &);

40 
Ch”tAÎDocsModif›dPo¡Li¡
(const ChertAllDocsModifiedPostList &);

43 
sk_d–‘es
(
X­Ÿn
::
weight
 
w_mš
);

45 
	mpublic
:

46 
Ch”tAÎDocsModif›dPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db_
,

47 
X­Ÿn
::
doccouÁ
 
doccouÁ_
,

48 cÚ¡ 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> & 
doş’s_
);

50 
	mX­Ÿn
::
docid
 
	$g‘_docid
() const;

52 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

54 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

56 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
);

58 
boŞ
 
	$©_’d
() const;

60 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

	@backends/chert/chert_alldocspostlist.cc

22 
	~<cÚfig.h
>

24 
	~<¡ršg
>

26 
	~"ch”t_®ldoc¥o¡li¡.h
"

27 
	~"ch”t_d©aba£.h
"

29 
	~"uts.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gCh”tAÎDocsPo¡Li¡
::
Ch”tAÎDocsPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db_
,

34 
X­Ÿn
::
doccouÁ
 
doccouÁ_
)

35 : 
Ch”tPo¡Li¡
(
db_
, 
¡ršg
(), 
Œue
),

36 
	$doccouÁ
(
doccouÁ_
)

38 
	`DEBUGCALL
(
DB
, , "Ch”tAÎDocsPo¡Li¡::Ch”tAÎDocsPo¡Li¡", 
db_
.
	`g‘
(è<< ", " << 
doccouÁ_
);

39 
	}
}

41 
	gX­Ÿn
::
doccouÁ


42 
Ch”tAÎDocsPo¡Li¡
::
	$g‘_‹rmäeq
() const

44 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "ChertAllDocsPostList::get_termfreq", "");

45 
	`RETURN
(
doccouÁ
);

46 
	}
}

48 
	gX­Ÿn
::
‹rmcouÁ


49 
Ch”tAÎDocsPo¡Li¡
::
	$g‘_doş’gth
() const

51 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertAllDocsPostList::get_doclength", "");

53 
	`RETURN
(
Ch”tPo¡Li¡
::
	`g‘_wdf
());

54 
	}
}

56 
	gX­Ÿn
::
‹rmcouÁ


57 
Ch”tAÎDocsPo¡Li¡
::
	$g‘_wdf
() const

59 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertAllDocsPostList::get_wdf", "");

60 
	`As£¹P¬ªoid
(!
	`©_’d
());

61 
	`RETURN
(1);

62 
	}
}

64 
Pos™iÚLi¡
 *

65 
	gCh”tAÎDocsPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

67 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertAllDocsPostList::read_position_list", "");

68 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("ChertAllDocsPostList::read_position_list()‚ot meaningful");

69 
	}
}

71 
Pos™iÚLi¡
 *

72 
	gCh”tAÎDocsPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

74 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertAllDocsPostList::open_position_list", "");

75 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("ChertAllDocsPostList::open_position_list()‚ot meaningful");

76 
	}
}

78 
¡ršg


79 
	gCh”tAÎDocsPo¡Li¡
::
	$g‘_desütiÚ
() const

81 
¡ršg
 
desc
 = "ChertAllDocsPostList(did=";

82 
desc
 +ğ
	`om_to¡ršg
(
	`g‘_docid
());

83 
desc
 += ",doccount=";

84 
desc
 +ğ
	`om_to¡ršg
(
doccouÁ
);

85 
desc
 += ')';

86  
desc
;

87 
	}
}

	@backends/chert/chert_alldocspostlist.h

22 #iâdeà
XAPIAN_INCLUDED_CHERT_ALLDOCSPOSTLIST_H


23 
	#XAPIAN_INCLUDED_CHERT_ALLDOCSPOSTLIST_H


	)

25 
	~<¡ršg
>

27 
	~"ch”t_po¡li¡.h
"

29 şas 
	cCh”tAÎDocsPo¡Li¡
 : 
public
 
Ch”tPo¡Li¡
 {

31 
İ”©Ü
=(cÚ¡ 
Ch”tAÎDocsPo¡Li¡
 &);

34 
Ch”tAÎDocsPo¡Li¡
(const ChertAllDocsPostList &);

37 
	mX­Ÿn
::
doccouÁ
 doccount;

39 
	mpublic
:

40 
Ch”tAÎDocsPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db_
,

41 
X­Ÿn
::
doccouÁ
 
doccouÁ_
);

43 
	mX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

45 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

47 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

49 
Pos™iÚLi¡
 *
	`»ad_pos™iÚ_li¡
();

51 
Pos™iÚLi¡
 *
	$İ’_pos™iÚ_li¡
() const;

53 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

	@backends/chert/chert_alltermslist.cc

21 
	~<cÚfig.h
>

23 
	~"ch”t_®É”m¦i¡.h
"

24 
	~"ch”t_po¡li¡.h
"

26 
	~"·ck.h
"

27 
	~"¡ršguts.h
"

30 
	gCh”tAÎT”msLi¡
::
	$»ad_‹rmäeq_ªd_cŞläeq
() const

32 
	`DEBUGCALL
(
DB
, , "ChertAllTermsList::read_termfreq_and_collfreq", "");

33 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

34 
	`As£¹
(!
	`©_’d
());

38 
cursÜ
->
	`»ad_g
();

39 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

40 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

41 
Ch”tPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
, 
³nd
, &
‹rmäeq
, &
cŞläeq
);

42 
	}
}

44 
	gCh”tAÎT”msLi¡
::~
	$Ch”tAÎT”msLi¡
()

46 
	`DEBUGCALL
(
DB
, , "~ChertAllTermsList", "");

47 
d–‘e
 
cursÜ
;

48 
	}
}

50 
¡ršg


51 
	gCh”tAÎT”msLi¡
::
	$g‘_‹rmÇme
() const

53 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertAllTermsList::get_termname", "");

54 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

55 
	`As£¹
(!
	`©_’d
());

56 
	`RETURN
(
cu¼’t_‹rm
);

57 
	}
}

59 
	gX­Ÿn
::
doccouÁ


60 
Ch”tAÎT”msLi¡
::
	$g‘_‹rmäeq
() const

62 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "ChertAllTermsList::get_termfreq", "");

63 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

64 
	`As£¹
(!
	`©_’d
());

65 ià(
‹rmäeq
 =ğ0è
	`»ad_‹rmäeq_ªd_cŞläeq
();

66 
	`RETURN
(
‹rmäeq
);

67 
	}
}

69 
	gX­Ÿn
::
‹rmcouÁ


70 
Ch”tAÎT”msLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

72 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertAllTermsList::get_collection_freq", "");

73 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

74 
	`As£¹
(!
	`©_’d
());

75 ià(
‹rmäeq
 =ğ0è
	`»ad_‹rmäeq_ªd_cŞläeq
();

76 
	`RETURN
(
cŞläeq
);

77 
	}
}

79 
T”mLi¡
 *

80 
	gCh”tAÎT”msLi¡
::
	$Ãxt
()

82 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "ChertAllTermsList::next", "");

83 
	`As£¹
(!
	`©_’d
());

86 
‹rmäeq
 = 0;

88 
Œue
) {

89 
cursÜ
->
	`Ãxt
();

90 ià(
cursÜ
->
	`aá”_’d
()) {

91 
cu¼’t_‹rm
.
	`»size
(0);

92 
	`RETURN
(
NULL
);

95 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

96 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

97 ià(!
	`uÅack_¡ršg_´e£rvšg_sÜt
(&
p
, 
³nd
, 
cu¼’t_‹rm
)) {

98 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("PostListable key has unexpected format");

104 ià(
p
 =ğ
³nd
) ;

107 ià(!
	`¡¬tsw™h
(
cu¼’t_‹rm
, 
´efix
)) {

109 
cursÜ
->
	`to_’d
();

110 
cu¼’t_‹rm
.
	`»size
(0);

113 
	`RETURN
(
NULL
);

114 
	}
}

116 
T”mLi¡
 *

117 
	gCh”tAÎT”msLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
‹rm
)

119 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "Ch”tAÎT”msLi¡::sk_to", 
‹rm
);

120 
	`As£¹
(!
	`©_’d
());

123 
‹rmäeq
 = 0;

125 
¡ršg
 
key
 = 
	`·ck_ch”t_po¡li¡_key
(
‹rm
);

126 ià(
cursÜ
->
	`fšd_’Œy_ge
(
key
)) {

129 
cu¼’t_‹rm
 = 
‹rm
;

131 ià(
cursÜ
->
	`aá”_’d
()) {

132 
cu¼’t_‹rm
.
	`»size
(0);

133 
	`RETURN
(
NULL
);

136 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

137 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

138 ià(!
	`uÅack_¡ršg_´e£rvšg_sÜt
(&
p
, 
³nd
, 
cu¼’t_‹rm
)) {

139 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("PostListable key has unexpected format");

143 ià(!
	`¡¬tsw™h
(
cu¼’t_‹rm
, 
´efix
)) {

145 
cursÜ
->
	`to_’d
();

146 
cu¼’t_‹rm
.
	`»size
(0);

149 
	`RETURN
(
NULL
);

150 
	}
}

152 
boŞ


153 
	gCh”tAÎT”msLi¡
::
	$©_’d
() const

155 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertAllTermsList::at_end", "");

156 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

157 
	}
}

	@backends/chert/chert_alltermslist.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_ALLTERMSLIST_H


22 
	#XAPIAN_INCLUDED_CHERT_ALLTERMSLIST_H


	)

24 
	~"®É”m¦i¡.h
"

25 
	~"ch”t_d©aba£.h
"

26 
	~"ch”t_po¡li¡.h
"

28 
şass
 
	gCh”tCursÜ
;

30 şas 
	cCh”tAÎT”msLi¡
 : 
public
 
AÎT”msLi¡
 {

32 
Ch”tAÎT”msLi¡
(const ChertAllTermsList &);

35 
	mİ”©Ü
=(cÚ¡ 
Ch”tAÎT”msLi¡
 &);

38 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
d©aba£
;

43 
Ch”tCursÜ
 * 
	mcursÜ
;

46 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

49 
	m¡d
::
¡ršg
 
´efix
;

57 
mubË
 
	mX­Ÿn
::
doccouÁ
 
‹rmäeq
;

60 
mubË
 
	mX­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

63 
	$»ad_‹rmäeq_ªd_cŞläeq
() const;

65 
public
:

66 
	`Ch”tAÎT”msLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
d©aba£_
,

67 cÚ¡ 
¡d
::
¡ršg
 & 
´efix_
)

68 : 
	`d©aba£
(
d©aba£_
), 
	`´efix
(
´efix_
), 
	$‹rmäeq
(0) {

69 
cursÜ
 = 
d©aba£
->
po¡li¡_bË
.
	`cursÜ_g‘
();

70 
	`As£¹
(
cursÜ
);

75 ià(
´efix
.
	`em±y
()) {

76 
cursÜ
->
	`fšd_’Œy_É
(
¡d
::
	`¡ršg
("\x00\xff", 2));

78 
¡d
::
¡ršg
 
key
 = 
	`·ck_ch”t_po¡li¡_key
(
´efix
);

79 
cursÜ
->
	`fšd_’Œy_É
(
key
);

84 ~
	`Ch”tAÎT”msLi¡
();

91 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

98 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

105 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

108 
T”mLi¡
 * 
	`Ãxt
();

111 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
);

114 
boŞ
 
	$©_’d
() const;

115 
	}
};

	@backends/chert/chert_btreebase.cc

22 
	~<cÚfig.h
>

24 
	~"§ã”ºo.h
"

25 #ifdeà
__WIN32__


26 
	~"msvc_posix_w¿µ”.h
"

29 
	~<x­Ÿn/”rÜ.h
>

31 
	~"ch”t_bŒ“ba£.h
"

32 
	~"ch”t_io.h
"

33 
	~"omas£¹.h
"

34 
	~"·ck.h
"

35 
	~"uts.h
"

37 
	~<®gÜ™hm
>

38 
	~<şim™s
>

39 
	~<c¡ršg
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

72 
	#CURR_FORMAT
 5U

	)

74 
	gCh”tTabË_ba£
::
	$Ch”tTabË_ba£
()

75 : 
	`»visiÚ
(0),

76 
	`block_size
(0),

77 
	`roÙ
(0),

78 
	`Ëv–
(0),

79 
	`b™_m­_size
(0),

80 
	`™em_couÁ
(0),

81 
	`Ï¡_block
(0),

82 
	`have_çk”oÙ
(
çl£
),

83 
	`£qu’tŸl
(
çl£
),

84 
	`b™_m­_low
(0),

85 
	`b™_m­0
(0),

86 
	$b™_m­
(0)

88 
	}
}

90 
	gCh”tTabË_ba£
::
	$Ch”tTabË_ba£
(cÚ¡ 
Ch”tTabË_ba£
 &
Ùh”
)

91 : 
	`»visiÚ
(
Ùh”
.
»visiÚ
),

92 
	`block_size
(
Ùh”
.
block_size
),

93 
	`roÙ
(
Ùh”
.
roÙ
),

94 
	`Ëv–
(
Ùh”
.
Ëv–
),

95 
	`b™_m­_size
(
Ùh”
.
b™_m­_size
),

96 
	`™em_couÁ
(
Ùh”
.
™em_couÁ
),

97 
	`Ï¡_block
(
Ùh”
.
Ï¡_block
),

98 
	`have_çk”oÙ
(
Ùh”
.
have_çk”oÙ
),

99 
	`£qu’tŸl
(
Ùh”
.
£qu’tŸl
),

100 
	`b™_m­_low
(
Ùh”
.
b™_m­_low
),

101 
	`b™_m­0
(0),

102 
	$b™_m­
(0)

104 
Œy
 {

105 
b™_m­0
 = 
Ãw
 
by‹
[
b™_m­_size
];

106 
b™_m­
 = 
Ãw
 
by‹
[
b™_m­_size
];

108 
	`memıy
(
b™_m­0
, 
Ùh”
.b™_m­0, 
b™_m­_size
);

109 
	`memıy
(
b™_m­
, 
Ùh”
.b™_m­, 
b™_m­_size
);

110 } 
	`ÿtch
 (...) {

111 
d–‘e
 [] 
b™_m­0
;

112 
d–‘e
 [] 
b™_m­
;

114 
	}
}

117 
	gCh”tTabË_ba£
::
	$sw­
(
Ch”tTabË_ba£
 &
Ùh”
)

119 
¡d
::
	`sw­
(
»visiÚ
, 
Ùh”
.revision);

120 
¡d
::
	`sw­
(
block_size
, 
Ùh”
.block_size);

121 
¡d
::
	`sw­
(
roÙ
, 
Ùh”
.root);

122 
¡d
::
	`sw­
(
Ëv–
, 
Ùh”
.level);

123 
¡d
::
	`sw­
(
b™_m­_size
, 
Ùh”
.bit_map_size);

124 
¡d
::
	`sw­
(
™em_couÁ
, 
Ùh”
.item_count);

125 
¡d
::
	`sw­
(
Ï¡_block
, 
Ùh”
.last_block);

126 
¡d
::
	`sw­
(
have_çk”oÙ
, 
Ùh”
.have_fakeroot);

127 
¡d
::
	`sw­
(
£qu’tŸl
, 
Ùh”
.sequential);

128 
¡d
::
	`sw­
(
b™_m­_low
, 
Ùh”
.bit_map_low);

129 
¡d
::
	`sw­
(
b™_m­0
, 
Ùh”
.bit_map0);

130 
¡d
::
	`sw­
(
b™_m­
, 
Ùh”
.bit_map);

131 
	}
}

133 
	gCh”tTabË_ba£
::~
	$Ch”tTabË_ba£
()

135 
d–‘e
 [] 
b™_m­
;

136 
b™_m­
 = 0;

137 
d–‘e
 [] 
b™_m­0
;

138 
b™_m­0
 = 0;

139 
	}
}

142 
boŞ


143 
	$do_uÅack_ušt
(cÚ¡ **
¡¬t
, cÚ¡ *
’d
,

144 
ušt4
 *
de¡
, 
¡ršg
 &
”r_msg
,

145 cÚ¡ 
¡ršg
 &
ba£Çme
,

146 cÚ¡ *
v¬Çme
)

148 
boŞ
 
»suÉ
 = 
	`uÅack_ušt
(
¡¬t
, 
’d
, 
de¡
);

149 ià(
	`¿»
(!
»suÉ
)) {

150 
”r_msg
 += "Unableo„ead ";

151 
”r_msg
 +ğ
v¬Çme
;

152 
”r_msg
 += " from ";

153 
”r_msg
 +ğ
ba£Çme
;

154 
”r_msg
 += '\n';

156  
»suÉ
;

157 
	}
}

159 
boŞ


160 
	$do_uÅack_ušt
(cÚ¡ **
¡¬t
, cÚ¡ *
’d
,

161 
ch”t_bËsize_t
 *
de¡
, 
¡ršg
 &
”r_msg
,

162 cÚ¡ 
¡ršg
 &
ba£Çme
,

163 cÚ¡ *
v¬Çme
)

165 
boŞ
 
»suÉ
 = 
	`uÅack_ušt
(
¡¬t
, 
’d
, 
de¡
);

166 ià(
	`¿»
(!
»suÉ
)) {

167 
”r_msg
 += "Unableo„ead ";

168 
”r_msg
 +ğ
v¬Çme
;

169 
”r_msg
 += " from ";

170 
”r_msg
 +ğ
ba£Çme
;

171 
”r_msg
 += '\n';

173  
»suÉ
;

174 
	}
}

176 
	#DO_UNPACK_UINT_ERRCHECK
(
¡¬t
, 
’d
, 
v¬
) \

178 ià(!
	`do_uÅack_ušt
(
¡¬t
, 
’d
, &
v¬
, 
”r_msg
, 
ba£Çme
, #var)) { \

179  
çl£
; \

181 } 0)

	)

189 
	#REASONABLE_BASE_SIZE
 1024

	)

191 
boŞ


192 
	gCh”tTabË_ba£
::
	$»ad
(cÚ¡ 
¡ršg
 & 
Çme
, 
ch
, sŒšg &
”r_msg
)

194 
¡ršg
 
ba£Çme
 = 
Çme
 + "ba£" + 
ch
;

195 #ifdeà
__WIN32__


196 
h
 = 
	`msvc_posix_İ’
(
ba£Çme
.
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

198 
h
 = 
	`İ’
(
ba£Çme
.
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

201 ià(
h
 == -1) {

202 
”r_msg
 +ğ"Couldn'ˆİ’ " + 
ba£Çme
 + ": " + 
	`¡»¼Ü
(
”ºo
) + "\n";

203  
çl£
;

205 
fdşo£r
 
	`şo£fd
(
h
);

207 
buf
[
REASONABLE_BASE_SIZE
];

209 cÚ¡ *
¡¬t
 = 
buf
;

210 cÚ¡ *
’d
 = 
buf
 + 
	`ch”t_io_»ad
(
h
, buf, 
REASONABLE_BASE_SIZE
, 0);

212 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
»visiÚ
);

213 
ušt4
 
fÜm©
;

214 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
fÜm©
);

215 ià(
fÜm©
 !ğ
CURR_FORMAT
) {

216 
”r_msg
 +ğ"Bad ba£ ffÜm© " + 
	`om_to¡ršg
(
fÜm©
) + " in " +

217 
ba£Çme
 + "\n";

218  
çl£
;

220 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
block_size
);

221 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
roÙ
);

222 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
Ëv–
);

223 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
b™_m­_size
);

224 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
™em_couÁ
);

225 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
Ï¡_block
);

226 
ušt4
 
have_çk”oÙ_
;

227 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
have_çk”oÙ_
);

228 
have_çk”oÙ
 = 
have_çk”oÙ_
;

230 
ušt4
 
£qu’tŸl_
;

231 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
£qu’tŸl_
);

232 
£qu’tŸl
 = 
£qu’tŸl_
;

234 ià(
have_çk”oÙ
 && !
£qu’tŸl
) {

235 
£qu’tŸl
 = 
Œue
;

245 
ušt4
 
»visiÚ2
;

246 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
»visiÚ2
);

247 ià(
»visiÚ
 !ğ
»visiÚ2
) {

248 
”r_msg
 += "Revision‚umber mismatch in " +

249 
ba£Çme
 + ": " +

250 
	`om_to¡ršg
(
»visiÚ
è+ " v " + om_to¡ršg(
»visiÚ2
) + "\n";

251  
çl£
;

255 
d–‘e
 [] 
b™_m­0
;

256 
b™_m­0
 = 0;

257 
d–‘e
 [] 
b™_m­
;

258 
b™_m­
 = 0;

260 
b™_m­0
 = 
Ãw
 
by‹
[
b™_m­_size
];

261 
b™_m­
 = 
Ãw
 
by‹
[
b™_m­_size
];

263 
size_t
 
n
 = 
’d
 - 
¡¬t
;

264 ià(
n
 < 
b™_m­_size
) {

265 
	`memıy
(
b™_m­0
, 
¡¬t
, 
n
);

266 ()
	`ch”t_io_»ad
(
h
, 
»š‹½»t_ÿ¡
<*>(
b™_m­0
è+ 
n
,

267 
b™_m­_size
 - 
n
, bit_map_size -‚);

268 
n
 = 0;

270 
	`memıy
(
b™_m­0
, 
¡¬t
, 
b™_m­_size
);

271 
n
 -ğ
b™_m­_size
;

272 ià(
n
è
	`memmove
(
buf
, 
¡¬t
 + 
b™_m­_size
,‚);

274 
	`memıy
(
b™_m­
, 
b™_m­0
, 
b™_m­_size
);

276 
¡¬t
 = 
buf
;

277 
’d
 = 
buf
 + 
n
;

278 
’d
 +ğ
	`ch”t_io_»ad
(
h
, 
buf
 + 
n
, 
REASONABLE_BASE_SIZE
 -‚, 0);

280 
ušt4
 
»visiÚ3
;

281 ià(!
	`uÅack_ušt
(&
¡¬t
, 
’d
, &
»visiÚ3
)) {

282 
”r_msg
 += "Couldn't„ead„evision3 from base file " +

283 
ba£Çme
 + "\n";

284  
çl£
;

287 ià(
»visiÚ
 !ğ
»visiÚ3
) {

288 
”r_msg
 += "Revision‚umber mismatch in " +

289 
ba£Çme
 + ": " +

290 
	`om_to¡ršg
(
»visiÚ
è+ " v " + om_to¡ršg(
»visiÚ3
) + "\n";

291  
çl£
;

294 ià(
¡¬t
 !ğ
’d
) {

295 
”r_msg
 +ğ"Junk‡ˆ’d oàba£ f" + 
ba£Çme
 + "\n";

296  
çl£
;

299  
Œue
;

300 
	}
}

303 
	gCh”tTabË_ba£
::
	$wr™e_to_fe
(cÚ¡ 
¡ršg
 &
f’ame
,

304 
ba£_Ë‰”
,

305 cÚ¡ 
¡ršg
 &
bËÇme
,

306 
chªges_fd
,

307 cÚ¡ 
¡ršg
 * 
chªges_
)

309 
	`ÿlcuÏ‹_Ï¡_block
();

311 
¡ršg
 
buf
;

312 
	`·ck_ušt
(
buf
, 
»visiÚ
);

313 
	`·ck_ušt
(
buf
, 
CURR_FORMAT
);

314 
	`·ck_ušt
(
buf
, 
block_size
);

315 
	`·ck_ušt
(
buf
, 
¡©ic_ÿ¡
<
ušt4
>(
roÙ
));

316 
	`·ck_ušt
(
buf
, 
¡©ic_ÿ¡
<
ušt4
>(
Ëv–
));

317 
	`·ck_ušt
(
buf
, 
¡©ic_ÿ¡
<
ušt4
>(
b™_m­_size
));

318 
	`·ck_ušt
(
buf
, 
™em_couÁ
);

319 
	`·ck_ušt
(
buf
, 
¡©ic_ÿ¡
<
ušt4
>(
Ï¡_block
));

320 
	`·ck_ušt
(
buf
, 
have_çk”oÙ
);

321 
	`·ck_ušt
(
buf
, 
£qu’tŸl
);

322 
	`·ck_ušt
(
buf
, 
»visiÚ
);

323 ià(
b™_m­_size
 > 0) {

324 
buf
.
	`­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
b™_m­
), 
b™_m­_size
);

326 
	`·ck_ušt
(
buf
, 
»visiÚ
);

328 #ifdeà
__WIN32__


329 
h
 = 
	`msvc_posix_İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

331 
h
 = 
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

333 ià(
h
 < 0) {

334 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open base ")

335 + 
f’ame
 + "Øwr™e: " + 
	`¡»¼Ü
(
”ºo
);

336 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

338 
fdşo£r
 
	`şo£fd
(
h
);

340 ià(
chªges_fd
 >= 0) {

341 
¡ršg
 
chªges_buf
;

342 
	`·ck_ušt
(
chªges_buf
, 1u);

343 
	`·ck_¡ršg
(
chªges_buf
, 
bËÇme
);

344 
chªges_buf
 +ğ
ba£_Ë‰”
;

345 
	`·ck_ušt
(
chªges_buf
, 
buf
.
	`size
());

346 
	`ch”t_io_wr™e
(
chªges_fd
, 
chªges_buf
.
	`d©a
(), chªges_buf.
	`size
());

347 
	`ch”t_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

348 ià(
chªges_
 !ğ
NULL
) {

349 
	`ch”t_io_wr™e
(
chªges_fd
, 
chªges_
->
	`d©a
(), chªges_->
	`size
());

351 
	`ch”t_io_sync
(
chªges_fd
);

355 
	`ch”t_io_wr™e
(
h
, 
buf
.
	`d©a
(), buf.
	`size
());

356 
	`ch”t_io_sync
(
h
);

357 
	}
}

364 
boŞ


365 
	gCh”tTabË_ba£
::
	$block_ä“_©_¡¬t
(
ušt4
 
n
) const

367 
size_t
 
i
 = 
n
 / 
CHAR_BIT
;

368 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

369  (
b™_m­0
[
i
] & 
b™
) == 0;

370 
	}
}

378 
	gCh”tTabË_ba£
::
	$ä“_block
(
ušt4
 
n
)

380 
ušt4
 
i
 = 
n
 / 
CHAR_BIT
;

381 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

382 
b™_m­
[
i
] &ğ~ 
b™
;

384 ià(
b™_m­_low
 > 
i
)

385 ià((
b™_m­0
[
i
] & 
b™
) == 0)

386 
b™_m­_low
 = 
i
;

387 
	}
}

395 
	#BIT_MAP_INC
 1000

	)

399 
	gCh”tTabË_ba£
::
	$ex‹nd_b™_m­
()

401 
n
 = 
b™_m­_size
 + 
BIT_MAP_INC
;

402 
by‹
 *
Ãw_b™_m­0
 = 0;

403 
by‹
 *
Ãw_b™_m­
 = 0;

405 
Œy
 {

406 
Ãw_b™_m­0
 = 
Ãw
 
by‹
[
n
];

407 
Ãw_b™_m­
 = 
Ãw
 
by‹
[
n
];

409 
	`memıy
(
Ãw_b™_m­0
, 
b™_m­0
, 
b™_m­_size
);

410 
	`mem£t
(
Ãw_b™_m­0
 + 
b™_m­_size
, 0, 
n
 - bit_map_size);

412 
	`memıy
(
Ãw_b™_m­
, 
b™_m­
, 
b™_m­_size
);

413 
	`mem£t
(
Ãw_b™_m­
 + 
b™_m­_size
, 0, 
n
 - bit_map_size);

414 } 
	`ÿtch
 (...) {

415 
d–‘e
 [] 
Ãw_b™_m­0
;

416 
d–‘e
 [] 
Ãw_b™_m­
;

417 
throw
;

419 
d–‘e
 [] 
b™_m­0
;

420 
b™_m­0
 = 
Ãw_b™_m­0
;

421 
d–‘e
 [] 
b™_m­
;

422 
b™_m­
 = 
Ãw_b™_m­
;

423 
b™_m­_size
 = 
n
;

424 
	}
}

436 
ušt4


437 
	gCh”tTabË_ba£
::
	$Ãxt_ä“_block
()

439 
ušt4
 
i
;

440 
x
;

441 
i
 = 
b™_m­_low
;; i++) {

442 ià(
i
 >ğ
b™_m­_size
) {

443 
	`ex‹nd_b™_m­
();

445 
x
 = 
b™_m­0
[
i
] | 
b™_m­
[i];

446 ià(
x
 !ğ
UCHAR_MAX
) ;

448 
ušt4
 
n
 = 
i
 * 
CHAR_BIT
;

449 
d
 = 0x1;

450 (
x
 & 
d
è!ğ0è{ d <<ğ1; 
n
++; }

451 
b™_m­
[
i
] |ğ
d
;

452 
b™_m­_low
 = 
i
;

453 ià(
n
 > 
Ï¡_block
) {

454 
Ï¡_block
 = 
n
;

456  
n
;

457 
	}
}

459 
boŞ


460 
	gCh”tTabË_ba£
::
	$fšd_chªged_block
(
ušt4
 * 
n
)

464 (*
n
è<ğ
Ï¡_block
) {

465 
size_t
 
off£t
 = (*
n
è/ 
CHAR_BIT
;

466 
b™
 = 0x1 << (*
n
è% 
CHAR_BIT
;

468 ià(((
b™_m­0
[
off£t
] & 
b™
è=ğ0è&& ((
b™_m­
[offset] & bit) != 0)) {

469  
Œue
;

471 ++(*
n
);

474  
çl£
;

475 
	}
}

477 
boŞ


478 
	gCh”tTabË_ba£
::
	$block_ä“_now
(
ušt4
 
n
)

480 
ušt4
 
i
 = 
n
 / 
CHAR_BIT
;

481 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

482  (
b™_m­
[
i
] & 
b™
) == 0;

483 
	}
}

486 
	gCh”tTabË_ba£
::
	$ÿlcuÏ‹_Ï¡_block
()

488 ià(
b™_m­_size
 == 0) {

489 
Ï¡_block
 = 0;

492 
i
 = 
b™_m­_size
 - 1;

493 
b™_m­
[
i
] == 0 && i > 0) {

494 
i
--;

496 
b™_m­_size
 = 
i
 + 1;

498 
x
 = 
b™_m­
[
i
];

501 ià(
x
 == 0) {

502 
Ï¡_block
 = 0;

505 
ušt4
 
n
 = (
i
 + 1è* 
CHAR_BIT
 - 1;

506 
d
 = 0x1 << (
CHAR_BIT
 - 1);

507 (
x
 & 
d
è=ğ0è{ d >>ğ1; 
n
--; }

509 
Ï¡_block
 = 
n
;

510 
	}
}

512 
boŞ


513 
	gCh”tTabË_ba£
::
	$is_em±y
() const

515 
ušt4
 
i
 = 0; i < 
b™_m­_size
; i++) {

516 ià(
b™_m­
[
i
] != 0) {

517  
çl£
;

520  
Œue
;

521 
	}
}

524 
	gCh”tTabË_ba£
::
	$ş—r_b™_m­
()

526 
	`mem£t
(
b™_m­
, 0, 
b™_m­_size
);

527 
	}
}

531 
	gCh”tTabË_ba£
::
	$comm™
()

533 
	`memıy
(
b™_m­0
, 
b™_m­
, 
b™_m­_size
);

534 
b™_m­_low
 = 0;

535 
	}
}

	@backends/chert/chert_btreebase.h

22 #iâdeà
OM_HGUARD_CHERT_BTREEBASE_H


23 
	#OM_HGUARD_CHERT_BTREEBASE_H


	)

25 
	~<¡ršg
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~"ch”t_ty³s.h
"

31 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mCh”tTabË_ba£
 {

32 
	mpublic
:

34 
Ch”tTabË_ba£
();

37 
Ch”tTabË_ba£
(cÚ¡ Ch”tTabË_ba£ &
Ùh”
);

40 ~
Ch”tTabË_ba£
();

52 
boŞ
 
»ad
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, 
ch
, std::¡ršg &
”r_msg
);

54 
ušt4
 
	$g‘_»visiÚ
(ècÚ¡ {  
»visiÚ
; }

55 
ušt4
 
	$g‘_block_size
(ècÚ¡ {  
block_size
; 
	}
}

56 
ušt4
 
	$g‘_roÙ
(ècÚ¡ {  
roÙ
; 
	}
}

57 
ušt4
 
	$g‘_Ëv–
(ècÚ¡ {  
Ëv–
; 
	}
}

58 
ušt4
 
	$g‘_b™_m­_size
(ècÚ¡ {  
b™_m­_size
; 
	}
}

59 
ch”t_bËsize_t
 
	$g‘_™em_couÁ
(ècÚ¡ {  
™em_couÁ
; 
	}
}

60 
ušt4
 
	$g‘_Ï¡_block
(ècÚ¡ {  
Ï¡_block
; 
	}
}

61 
boŞ
 
	$g‘_have_çk”oÙ
(ècÚ¡ {  
have_çk”oÙ
; 
	}
}

62 
boŞ
 
	$g‘_£qu’tŸl
(ècÚ¡ {  
£qu’tŸl
; 
	}
}

64 
	$£t_»visiÚ
(
ušt4
 
»visiÚ_
) {

65 
»visiÚ
 = 
»visiÚ_
;

66 
	}
}

67 
	$£t_block_size
(
ušt4
 
block_size_
) {

68 
block_size
 = 
block_size_
;

69 
	}
}

70 
	$£t_roÙ
(
ušt4
 
roÙ_
) {

71 
roÙ
 = 
roÙ_
;

72 
	}
}

73 
	$£t_Ëv–
(
ušt4
 
Ëv–_
) {

74 
Ëv–
 = 
Ëv–_
;

75 
	}
}

76 
	$£t_™em_couÁ
(
ch”t_bËsize_t
 
™em_couÁ_
) {

77 
™em_couÁ
 = 
™em_couÁ_
;

78 
	}
}

79 
	$£t_have_çk”oÙ
(
boŞ
 
have_çk”oÙ_
) {

80 
have_çk”oÙ
 = 
have_çk”oÙ_
;

81 
	}
}

82 
	$£t_£qu’tŸl
(
boŞ
 
£qu’tŸl_
) {

83 
£qu’tŸl
 = 
£qu’tŸl_
;

84 
	}
}

87 
wr™e_to_fe
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame
,

88 
ba£_Ë‰”
,

89 cÚ¡ 
¡d
::
¡ršg
 &
bËÇme
,

90 
chªges_fd
,

91 cÚ¡ 
¡d
::
¡ršg
 * 
chªges_
);

97 
boŞ
 
	$block_ä“_©_¡¬t
(
ušt4
 
n
) const;

99 
	`ä“_block
(
ušt4
 
n
);

101 
ušt4
 
	`Ãxt_ä“_block
();

107 
boŞ
 
	`fšd_chªged_block
(
ušt4
 * 
n
);

109 
boŞ
 
	`block_ä“_now
(
ušt4
 
n
);

111 
	`ÿlcuÏ‹_Ï¡_block
();

114 
	`ş—r_b™_m­
();

116 
	`comm™
();

119 
boŞ
 
	$is_em±y
() const;

121 
	`sw­
(
Ch”tTabË_ba£
 &
Ùh”
);

123 
´iv©e
:

125 
İ”©Ü
=(cÚ¡ 
Ch”tTabË_ba£
 &
Ùh”
);

127 
	`ex‹nd_b™_m­
();

130 
ušt4
 
»visiÚ
;

131 
ušt4
 
block_size
;

132 
ušt4
 
roÙ
;

133 
ušt4
 
Ëv–
;

134 
ušt4
 
b™_m­_size
;

135 
ch”t_bËsize_t
 
™em_couÁ
;

136 
ušt4
 
Ï¡_block
;

137 
boŞ
 
have_çk”oÙ
;

138 
boŞ
 
£qu’tŸl
;

143 
ušt4
 
b™_m­_low
;

147 
by‹
 *
b™_m­0
;

150 
by‹
 *
b™_m­
;

151 
	}
};

	@backends/chert/chert_check.cc

24 
	~<cÚfig.h
>

26 
	~"ch”t_check.h
"

28 
	~<şim™s
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	gCh”tTabËCheck
::
	$´št_¥aûs
(
n
) const

34 
n
--è
out
.
	`put
(' ');

35 
	}
}

37 
	gCh”tTabËCheck
::
	$´št_by‹s
(
n
, cÚ¡ 
by‹
 * 
p
) const

39 
out
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
), 
n
);

40 
	}
}

42 
	gCh”tTabËCheck
::
	$´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const

44 
I‹m
 
	`™em
(
p
, 
c
);

45 
¡ršg
 
key
;

46 ià(
™em
.
	`key
().
	`Ëngth
() >= 0)

47 
™em
.
	`key
().
	`»ad
(&
key
);

48 ià(
j
 == 0) {

49 
out
 << 
key
 << '/' << 
™em
.
	`compÚ’t_of
();

51 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
key
.
	`begš
(); i !ğkey.
	`’d
(); ++i) {

53 
ch
 = *
i
;

54 ià(
ch
 < 32è
out
 << '/' << (ch); out << ch;

57 
	}
}

59 
	gCh”tTabËCheck
::
	$´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const

61 
I‹m
 
	`™em
(
p
, 
c
);

62 
¡ršg
 
g
;

63 
™em
.
	`­³nd_chunk
(&
g
);

64 ià(
j
 == 0) {

65 
out
 << "/" << 
™em
.
	`compÚ’ts_of
(è<< 
g
;

67 
out
 << "--> [" << 
	`g‘št4
(
»š‹½»t_ÿ¡
<cÚ¡ 
by‹
*>(
g
.
	`d©a
()), 0)

70 
	}
}

72 
	gCh”tTabËCheck
::
	$»pÜt_block_fuÎ
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const

74 
j
 = 
	`GET_LEVEL
(
p
);

75 
dœ_’d
 = 
	`DIR_END
(
p
);

76 
out
 << '\n';

77 
	`´št_¥aûs
(
m
);

78 
out
 << "Block [" << 
n
 << "]†ev– " << 
j
 << ",„evisiÚ *" << 
	`REVISION
(
p
)

79 << " i‹m (" << (
dœ_’d
 - 
DIR_START
)/
D2
 << ") usage "

80 << 
	`block_u§ge
(
p
) << "%:\n";

81 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

82 
	`´št_¥aûs
(
m
);

83 
	`´št_key
(
p
, 
c
, 
j
);

84 
out
 << ' ';

85 
	`´št_g
(
p
, 
c
, 
j
);

86 
out
 << '\n';

88 
	}
}

90 
	gCh”tTabËCheck
::
	$block_u§ge
(cÚ¡ 
by‹
 * 
p
) const

92 
¥aû
 = 
block_size
 - 
	`DIR_END
(
p
);

93 
ä“
 = 
	`TOTAL_FREE
(
p
);

94  (
¥aû
 - 
ä“
) * 100 / space;

95 
	}
}

100 
	gCh”tTabËCheck
::
	$»pÜt_block
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const

102 
j
 = 
	`GET_LEVEL
(
p
);

103 
dœ_’d
 = 
	`DIR_END
(
p
);

104 
c
;

105 
	`´št_¥aûs
(
m
);

106 
out
 << "[" << 
n
 << "] *" << 
	`REVISION
(
p
) << " ("

107 << (
dœ_’d
 - 
DIR_START
)/
D2
 << "è" << 
	`block_u§ge
(
p
) << "% ";

109 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

110 ià(
c
 =ğ
DIR_START
 + 6è
out
 << "... ";

111 ià(
c
 >ğ
DIR_START
 + 6 && c < 
dœ_’d
 - 6) ;

113 
	`´št_key
(
p
, 
c
, 
j
);

114 
out
 << ' ';

116 
out
 << 
’dl
;

117 
	}
}

119 
	gCh”tTabËCheck
::
	$çu»
(
n
) const

121 
out
 << "B-Œ“ƒ¼Ü " << 
n
 << 
’dl
;

122 
throw
 "btreeƒrror";

123 
	}
}

126 
	gCh”tTabËCheck
::
	$block_check
(
CursÜ
 * 
C_
, 
j
, 
İts
)

128 
by‹
 * 
p
 = 
C_
[
j
].p;

129 
ušt4
 
n
 = 
C_
[
j
].n;

130 
size_t
 
c
;

131 
size_t
 
signifiÿÁ_c
 = 
j
 =ğ0 ? 
DIR_START
 : DIR_START + 
D2
;

134 
size_t
 
max_ä“
 = 
	`MAX_FREE
(
p
);

135 
size_t
 
dœ_’d
 = 
	`DIR_END
(
p
);

136 
tÙ®_ä“
 = 
block_size
 - 
dœ_’d
;

138 ià(
ba£
.
	`block_ä“_©_¡¬t
(
n
)è
	`çu»
(0);

139 ià(
ba£
.
	`block_ä“_now
(
n
)è
	`çu»
(1);

140 
ba£
.
	`ä“_block
(
n
);

142 ià(
j
 !ğ
	`GET_LEVEL
(
p
)è
	`çu»
(10);

143 ià(
dœ_’d
 <ğ
DIR_START
 || dœ_’d > 
block_size
è
	`çu»
(20);

145 ià(
İts
 & 
OPT_SHORT_TREE
è
	`»pÜt_block
(3*(
Ëv–
 - 
j
), 
n
, 
p
);

147 ià(
İts
 & 
OPT_FULL_TREE
è
	`»pÜt_block_fuÎ
(3*(
Ëv–
 - 
j
), 
n
, 
p
);

149 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

150 
I‹m
 
	`™em
(
p
, 
c
);

151 
o
 = 
™em
.
	`g‘_add»ss
(è- 
p
;

152 ià(
o
 > (
block_size
)è
	`çu»
(21);

153 ià(
o
 - 
dœ_’d
 < 
max_ä“
è
	`çu»
(30);

155 
kt_Ën
 = 
™em
.
	`size
();

156 ià(
o
 + 
kt_Ën
 > (
block_size
)è
	`çu»
(40);

157 
tÙ®_ä“
 -ğ
kt_Ën
;

159 ià(
c
 > 
signifiÿÁ_c
 && 
	`I‹m
(
p
, c - 
D2
).
	`key
(è>ğ
™em
.key())

160 
	`çu»
(50);

162 ià(
tÙ®_ä“
 !ğ
	`TOTAL_FREE
(
p
))

163 
	`çu»
(60);

165 ià(
j
 == 0) ;

166 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

167 
C_
[
j
].
c
 = c;

168 
	`block_to_cursÜ
(
C_
, 
j
 - 1, 
	`I‹m
(
p
, 
c
).
	`block_giv’_by
());

170 
	`block_check
(
C_
, 
j
 - 1, 
İts
);

172 
by‹
 * 
q
 = 
C_
[
j
 - 1].
p
;

176 ià(
j
 =ğ1 && 
c
 > 
DIR_START
)

177 ià(
	`I‹m
(
q
, 
DIR_START
).
	`key
(è< I‹m(
p
, 
c
).key())

178 
	`çu»
(70);

183 ià(
j
 > 1 && 
c
 > 
DIR_START
 && 
	`DIR_END
(
q
è> DIR_START + 
D2
 &&

184 
	`I‹m
(
q
, 
DIR_START
 + 
D2
).
	`key
(è< I‹m(
p
, 
c
).key())

185 
	`çu»
(80);

190 ià(
c
 + 
D2
 < 
dœ_’d
 &&

191 (
j
 =ğ1 || 
DIR_START
 + 
D2
 < 
	`DIR_END
(
q
)) &&

192 
	`I‹m
(
q
, 
	`DIR_END
(qè- 
D2
).
	`key
(è>ğI‹m(
p
, 
c
 + D2).key())

193 
	`çu»
(90);

195 ià(
	`REVISION
(
q
è> REVISION(
p
)è
	`çu»
(91);

197 
	}
}

200 
	gCh”tTabËCheck
::
	$check
(cÚ¡ * 
bËÇme
, cÚ¡ 
¡ršg
 & 
·th
, 
İts
,

201 
o¡»am
 &
out
)

203 
Ch”tTabËCheck
 
	`B
(
bËÇme
, 
·th
, 
çl£
, 
out
);

204 
B
.
	`İ’
();

205 
CursÜ
 * 
C
 = 
B
.C;

207 ià(
İts
 & 
OPT_SHOW_STATS
) {

208 
out
 << "ba£" << ()
B
.
ba£_Ë‰”


209 << " blocksize=" << 
B
.
block_size
 / 1024 << "K"

210 " i‹ms=" << 
B
.
™em_couÁ


211 << "†a¡block=" << 
B
.
ba£
.
	`g‘_Ï¡_block
()

212 << "„evisiÚ=" << 
B
.
»visiÚ_numb”


213 << "†ev–s=" << 
B
.
Ëv–


215 ià(
B
.
çked_roÙ_block
)

216 
out
 << "(faked)";

218 
out
 << 
C
[
B
.
Ëv–
].
n
;

219 
out
 << 
’dl
;

222 
lim™
 = 
B
.
ba£
.
	`g‘_b™_m­_size
() - 1;

224 
lim™
 =†im™ * 
CHAR_BIT
 + CHAR_BIT - 1;

226 ià(
İts
 & 
OPT_SHOW_BITMAP
) {

227 
j
 = 0; j <ğ
lim™
; j++) {

228 
out
 << (
B
.
ba£
.
	`block_ä“_©_¡¬t
(
j
) ? '.' : '*');

229 ià(
j
 > 0) {

230 ià((
j
 + 1) % 100 == 0) {

231 
out
 << '\n';

232 } ià((
j
 + 1) % 10 == 0) {

233 
out
 << ' ';

237 
out
 << '\n' << 
’dl
;

240 ià(
B
.
çked_roÙ_block
) {

241 ià(
İts
è
out
 << "void ";

243 
B
.
	`block_check
(
C
, B.
Ëv–
, 
İts
);

247 ià(!
B
.
ba£
.
	`is_em±y
()) {

248 
B
.
	`çu»
(100);

251 ià(
İts
è
out
 << "B-Œ“ checked okay" << 
’dl
;

252 
	}
}

254 
	gCh”tTabËCheck
::
	$»pÜt_cursÜ
(
N
, cÚ¡ 
CursÜ
 * 
C_
) const

256 
out
 << 
N
 << ")\n";

257 
i
 = 0; i <ğ
Ëv–
; i++)

258 
out
 << "p=" << 
C_
[
i
].
p
 << ", c=" << C_[i].
c
 << ",‚=[" << C_[i].
n


259 << "],„ewr™e=" << 
C_
[
i
].
»wr™e
 << 
’dl
;

260 
	}
}

	@backends/chert/chert_check.h

24 #iâdeà
OM_HGUARD_CHERT_CHECK_H


25 
	#OM_HGUARD_CHERT_CHECK_H


	)

27 
	~"ch”t_bË.h
"

28 
	~"nÜ‘uº.h
"

30 
	~<io¡»am
>

31 
	~<¡ršg
>

33 şas 
	cCh”tTabËCheck
 : 
public
 
Ch”tTabË
 {

34 
public
:

35 
check
(cÚ¡ * 
bËÇme
, cÚ¡ 
¡d
::
¡ršg
 & 
·th
,

36 
İts
, 
¡d
::
o¡»am
 &
out
 = std::
cout
);

37 
	m´iv©e
:

38 
Ch”tTabËCheck
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡d
::
¡ršg
 &
·th_
,

39 
boŞ
 
»adÚly
, 
¡d
::
o¡»am
 &
out_
)

40 : 
Ch”tTabË
(
bËÇme_
, 
·th_
, 
»adÚly
), 
	$out
(
out_
) { }

42 
	`block_check
(
CursÜ
 * 
C_
, 
j
, 
İts
);

43 
	$block_u§ge
(cÚ¡ 
by‹
 * 
p
) const;

44 
	$»pÜt_block
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const;

45 
	$»pÜt_block_fuÎ
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const;

46 
	$»pÜt_cursÜ
(
N
, cÚ¡ 
CursÜ
 *
C_
) const;

48 
	`XAPIAN_NORETURN
(
	$çu»
(
n
) const);

49 
	$´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const;

50 
	$´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const;

51 
	$´št_¥aûs
(
n
) const;

52 
	$´št_by‹s
(
n
, cÚ¡ 
by‹
 * 
p
) const;

54 
mubË
 
¡d
::
o¡»am
 &
out
;

55 
	}
};

57 
	#OPT_SHORT_TREE
 1

	)

58 
	#OPT_FULL_TREE
 2

	)

59 
	#OPT_SHOW_BITMAP
 4

	)

60 
	#OPT_SHOW_STATS
 8

	)

	@backends/chert/chert_cursor.cc

22 
	~<cÚfig.h
>

24 
	~"ch”t_cursÜ.h
"

26 
	~"§ã”ºo.h
"

28 
	~<x­Ÿn/”rÜ.h
>

30 
	~"ch”t_bË.h
"

31 
	~"omas£¹.h
"

32 
	~"omdebug.h
"

34 #ifdeà
XAPIAN_DEBUG_LOG


35 
¡ršg


36 
	$hex_di¥Ïy_’code
(cÚ¡ 
¡ršg
 & 
šput
)

38 cÚ¡ * 
bË
 = "0123456789abcdef";

39 
¡ršg
 
»suÉ
;

40 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
šput
.
	`begš
(); i !ğšput.
	`’d
(); ++i) {

41 
v®
 = *
i
;

42 
»suÉ
 += "\\x";

43 
»suÉ
 +ğ
bË
[
v®
/16];

44 
»suÉ
 +ğ
bË
[
v®
%16];

47  
»suÉ
;

48 
	}
}

51 
	#DIR_START
 11

	)

53 
	gCh”tCursÜ
::
	$Ch”tCursÜ
(cÚ¡ 
Ch”tTabË
 *
B_
)

54 : 
	`is_pos™iÚed
(
çl£
),

55 
	`is_aá”_’d
(
çl£
),

56 
	`g_¡©us
(
UNREAD
),

57 
	`B
(
B_
),

58 
	`Ëv–
(
B_
->
Ëv–
)

60 
C
 = 
Ãw
 
CursÜ
[
Ëv–
 + 1];

62 
j
 = 0; j < 
Ëv–
; j++) {

63 
C
[
j
].
n
 = 
BLK_UNUSED
;

64 
C
[
j
].
p
 = 
Ãw
 
by‹
[
B
->
block_size
];

66 
C
[
Ëv–
].
n
 = 
B
->C[level].n;

67 
C
[
Ëv–
].
p
 = 
B
->C[level].p;

68 
	}
}

70 
	gCh”tCursÜ
::~
	$Ch”tCursÜ
()

74 
j
 = 0; j < 
Ëv–
; j++) {

75 
d–‘e
 [] 
C
[
j
].
p
;

77 
d–‘e
 [] 
C
;

78 
	}
}

80 
boŞ


81 
	gCh”tCursÜ
::
	$´ev
()

83 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertCursor::prev", "");

84 
	`As£¹
(
B
->
Ëv–
 <=†evel);

85 
	`As£¹
(!
is_aá”_’d
);

87 ià(!
is_pos™iÚed
) {

91 
boŞ
 
»suÉ
 = 
	`fšd_’Œy
(
cu¼’t_key
);

92 ()
»suÉ
;

93 
	`As£¹
(
»suÉ
);

94 
g_¡©us
 = 
UNREAD
;

97 ià(
g_¡©us
 !ğ
UNREAD
) {

98 
Œue
) {

99 ià(! 
B
->
	`´ev
(
C
, 0)) {

100 
is_pos™iÚed
 = 
çl£
;

101 
	`RETURN
(
çl£
);

103 ià(
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

109 
Œue
) {

110 ià(! 
B
->
	`´ev
(
C
, 0)) {

111 
is_pos™iÚed
 = 
çl£
;

112 
	`RETURN
(
çl£
);

114 ià(
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

118 
	`g‘_key
(&
cu¼’t_key
);

119 
g_¡©us
 = 
UNREAD
;

121 
	`LOGLINE
(
DB
, "MovedØ’Œy: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

122 
	`RETURN
(
Œue
);

123 
	}
}

125 
boŞ


126 
	gCh”tCursÜ
::
	$Ãxt
()

128 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertCursor::next", "");

129 
	`As£¹
(
B
->
Ëv–
 <=†evel);

130 
	`As£¹
(!
is_aá”_’d
);

131 ià(
g_¡©us
 =ğ
UNREAD
) {

132 
Œue
) {

133 ià(! 
B
->
	`Ãxt
(
C
, 0)) {

134 
is_pos™iÚed
 = 
çl£
;

137 ià(
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

138 
is_pos™iÚed
 = 
Œue
;

144 ià(!
is_pos™iÚed
) {

145 
is_aá”_’d
 = 
Œue
;

146 
	`RETURN
(
çl£
);

149 
	`g‘_key
(&
cu¼’t_key
);

150 
g_¡©us
 = 
UNREAD
;

152 
	`LOGLINE
(
DB
, "MovedØ’Œy: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

153 
	`RETURN
(
Œue
);

154 
	}
}

156 
boŞ


157 
	gCh”tCursÜ
::
	$fšd_’Œy
(cÚ¡ 
¡ršg
 &
key
)

159 
	`DEBUGCALL
(
DB
, 
boŞ
, "Ch”tCursÜ::fšd_’Œy", 
key
);

160 
	`As£¹
(
B
->
Ëv–
 <=†evel);

162 
is_aá”_’d
 = 
çl£
;

164 
boŞ
 
found
;

166 
is_pos™iÚed
 = 
Œue
;

167 ià(
key
.
	`size
(è> 
CHERT_BTREE_MAX_KEY_LEN
) {

170 
B
->
	`fÜm_key
(
key
.
	`sub¡r
(0, 
CHERT_BTREE_MAX_KEY_LEN
));

171 ()(
B
->
	`fšd
(
C
));

172 
found
 = 
çl£
;

174 
B
->
	`fÜm_key
(
key
);

175 
found
 = 
B
->
	`fšd
(
C
);

178 ià(!
found
) {

179 ià(
C
[0].
c
 < 
DIR_START
) {

180 
C
[0].
c
 = 
DIR_START
;

181 ià(! 
B
->
	`´ev
(
C
, 0)è
dÚe
;

183 
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() != 1) {

184 ià(! 
B
->
	`´ev
(
C
, 0)) {

185 
is_pos™iÚed
 = 
çl£
;

186 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("find_entry failedo find‡nyƒntry‡t‡ll!");

190 
dÚe
:

192 ià(
found
)

193 
cu¼’t_key
 = 
key
;

195 
	`g‘_key
(&
cu¼’t_key
);

196 
g_¡©us
 = 
UNREAD
;

198 
	`LOGLINE
(
DB
, "FoundƒÁry: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

199 
	`RETURN
(
found
);

200 
	}
}

202 
boŞ


203 
	gCh”tCursÜ
::
	$fšd_’Œy_ge
(cÚ¡ 
¡ršg
 &
key
)

205 
	`DEBUGCALL
(
DB
, 
boŞ
, "Ch”tCursÜ::fšd_’Œy_ge", 
key
);

206 
	`As£¹
(
B
->
Ëv–
 <=†evel);

208 
is_aá”_’d
 = 
çl£
;

210 
boŞ
 
found
;

212 
is_pos™iÚed
 = 
Œue
;

213 ià(
key
.
	`size
(è> 
CHERT_BTREE_MAX_KEY_LEN
) {

216 
B
->
	`fÜm_key
(
key
.
	`sub¡r
(0, 
CHERT_BTREE_MAX_KEY_LEN
));

217 ()(
B
->
	`fšd
(
C
));

218 
found
 = 
çl£
;

220 
B
->
	`fÜm_key
(
key
);

221 
found
 = 
B
->
	`fšd
(
C
);

224 ià(
found
) {

225 
cu¼’t_key
 = 
key
;

227 ià(! 
B
->
	`Ãxt
(
C
, 0)) {

228 
is_aá”_’d
 = 
Œue
;

229 
is_pos™iÚed
 = 
çl£
;

230 
	`RETURN
(
çl£
);

232 
	`As£¹
(
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1);

233 
	`g‘_key
(&
cu¼’t_key
);

235 
g_¡©us
 = 
UNREAD
;

237 
	`LOGLINE
(
DB
, "FoundƒÁry: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

238 
	`RETURN
(
found
);

239 
	}
}

242 
	gCh”tCursÜ
::
	$g‘_key
(
¡ršg
 * 
key
) const

244 
	`As£¹
(
B
->
Ëv–
 <=†evel);

245 
	`As£¹
(
is_pos™iÚed
);

247 ()
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`key
().
	`»ad
(
key
);

248 
	}
}

250 
boŞ


251 
	gCh”tCursÜ
::
	$»ad_g
(
boŞ
 
k“p_com´es£d
)

253 
	`DEBUGCALL
(
DB
, 
boŞ
, "Ch”tCursÜ::»ad_g", 
k“p_com´es£d
);

254 ià(
g_¡©us
 =ğ
UNREAD
) {

255 
	`As£¹
(
B
->
Ëv–
 <=†evel);

256 
	`As£¹
(
is_pos™iÚed
);

258 ià(
B
->
	`»ad_g
(
C
, &
cu¼’t_g
, 
k“p_com´es£d
)) {

259 
g_¡©us
 = 
COMPRESSED
;

261 
g_¡©us
 = 
UNCOMPRESSED
;

266 
is_pos™iÚed
 = 
B
->
	`Ãxt
(
C
, 0);

268 
	`LOGLINE
(
DB
, "g=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_g
));

270 
	`RETURN
(
g_¡©us
 =ğ
COMPRESSED
);

271 
	}
}

273 
boŞ


274 
	gMubËCh”tCursÜ
::
	$d–
()

276 
	`As£¹
(!
is_aá”_’d
);

282 (
cÚ¡_ÿ¡
<
Ch”tTabË
*>(
B
))->
	`d–
(
cu¼’t_key
);

289 ià(!
	`fšd_’Œy_ge
(
cu¼’t_key
)è 
is_pos™iÚed
;

290  
	`Ãxt
();

291 
	}
}

	@backends/chert/chert_cursor.h

22 #iâdeà
OM_HGUARD_CHERT_CURSOR_H


23 
	#OM_HGUARD_CHERT_CURSOR_H


	)

25 
	~<x­Ÿn/visib™y.h
>

27 
	~"ch”t_ty³s.h
"

29 
	~<¡ršg
>

30 
usšg
 
	g¡d
::
¡ršg
;

32 
	#BLK_UNUSED
 
	`ušt4
(-1)

	)

34 şas 
	cCursÜ
 {

35 
	m´iv©e
:

37 
CursÜ
(const Cursor &);

38 
	mCursÜ
 & 
	mİ”©Ü
=(cÚ¡ 
CursÜ
 &);

40 
	mpublic
:

42 
	$CursÜ
(è: 
	`p
(0), 
	`c
(-1), 
	`n
(
BLK_UNUSED
), 
	$»wr™e
(
çl£
)

46 
by‹
 * 
p
;

48 
c
;

57 
ušt4
 
n
;

59 
boŞ
 
»wr™e
;

60 
	}
};

62 
şass
 
	gCh”tTabË
;

67 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mCh”tCursÜ
 {

68 
	m´iv©e
:

70 
Ch”tCursÜ
(const ChertCursor &);

73 
	mCh”tCursÜ
 & 
	mİ”©Ü
=(cÚ¡ 
Ch”tCursÜ
 &);

75 
	m´Ùeùed
:

81 
boŞ
 
is_pos™iÚed
;

85 
boŞ
 
	mis_aá”_’d
;

87 
	m´iv©e
:

89 ’um { 
UNREAD
, 
	mUNCOMPRESSED
, 
	mCOMPRESSED
 } 
	gg_¡©us
;

91 
	g´Ùeùed
:

93 cÚ¡ 
Ch”tTabË
 * 
B
;

95 
	g´iv©e
:

97 
CursÜ
 * 
C
;

100 
	gËv–
;

121 
	$g‘_key
(
¡ršg
 * 
key
) const;

123 
public
:

135 
	`Ch”tCursÜ
(cÚ¡ 
Ch”tTabË
 *
B
);

138 ~
	`Ch”tCursÜ
();

142 
¡ršg
 
cu¼’t_key
;

147 
¡ršg
 
cu¼’t_g
;

161 
boŞ
 
	`»ad_g
(boŞ 
k“p_com´es£d
 = 
çl£
);

177 
boŞ
 
	`Ãxt
();

184 
boŞ
 
	`´ev
();

208 
boŞ
 
	`fšd_’Œy
(cÚ¡ 
¡ršg
 &
key
);

211 
	$fšd_’Œy_É
(cÚ¡ 
¡ršg
 &
key
) {

212 ià(
	`fšd_’Œy
(
key
)è
	`´ev
();

213 
	}
}

220 
boŞ
 
fšd_’Œy_ge
(cÚ¡ 
¡ršg
 &
key
);

224 
	$to_’d
(è{ 
is_aá”_’d
 = 
Œue
; 
	}
}

231 
boŞ
 
	$aá”_’d
(ècÚ¡ {  
is_aá”_’d
; 
	}
}

234 cÚ¡ 
Ch”tTabË
 * 
	$g‘_bË
(ècÚ¡ {  
B
; 
	}
}

237 şas 
	cMubËCh”tCursÜ
 : 
public
 
Ch”tCursÜ
 {

238 
public
:

252 
	$MubËCh”tCursÜ
(
Ch”tTabË
 *
B_
è: 
	$Ch”tCursÜ
(
B_
) { }

259 
boŞ
 
	`d–
();

260 
	}
};

	@backends/chert/chert_database.cc

27 
	~<cÚfig.h
>

29 
	~"ch”t_d©aba£.h
"

31 
	~<x­Ÿn/”rÜ.h
>

32 
	~<x­Ÿn/v®ue™”©Ü.h
>

34 
	~"cÚtiguou§Îdoc¥o¡li¡.h
"

35 
	~"ch”t_®ldocsmodif›dpo¡li¡.h
"

36 
	~"ch”t_®ldoc¥o¡li¡.h
"

37 
	~"ch”t_®É”m¦i¡.h
"

38 
	~"ch”t_»¶iÿ‹_š‹º®.h
"

39 
	~"ch”t_docum’t.h
"

40 
	~"ch”t_io.h
"

41 
	~"../æšt_lock.h
"

42 
	~"ch”t_m‘ad©a.h
"

43 
	~"ch”t_modif›dpo¡li¡.h
"

44 
	~"ch”t_pos™iÚli¡.h
"

45 
	~"ch”t_po¡li¡.h
"

46 
	~"ch”t_»cÜd.h
"

47 
	~"ch”t_¥–lšgwÜd¦i¡.h
"

48 
	~"ch”t_‹rmli¡.h
"

49 
	~"ch”t_v®u–i¡.h
"

50 
	~"ch”t_v®ues.h
"

51 
	~"omdebug.h
"

52 
	~"omtime.h
"

53 
	~"·ck.h
"

54 
	~"»mÙecÚÃùiÚ.h
"

55 
	~"»¶iÿtiÚ.h
"

56 
	~"»¶iÿtiÚ´ÙocŞ.h
"

57 
	~"£rŸli£.h
"

58 
	~"¡ršguts.h
"

59 
	~"uts.h
"

60 
	~"v®ue¡©s.h
"

62 #ifdeà
__WIN32__


63 
	~"msvc_posix_w¿µ”.h
"

66 
	~"§ã”ºo.h
"

67 
	~"§ãsys¡©.h
"

68 
	~<sys/ty³s.h
>

70 
	~<®gÜ™hm
>

71 
	~"autİŒ.h
"

72 
	~<¡ršg
>

74 
usšg
 
Çme¥aû
 
	g¡d
;

75 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

89 
	#MAX_SAFE_TERM_LENGTH
 245

	)

95 
	$sys_uÆšk_if_exi¡s
(cÚ¡ 
¡ršg
 & 
f’ame
)

97 #ifdeà
__WIN32__


98 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

100 ià(
	`uÆšk
(
f’ame
) == -1) {

102 ià(
”ºo
 =ğ
ENOENT
) ;

103 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Cª'ˆd–‘fe: `" + 
f’ame
 + "'",

104 
”ºo
);

106 
	}
}

112 
	gCh”tD©aba£
::
	$Ch”tD©aba£
(cÚ¡ 
¡ršg
 &
ch”t_dœ
, 
aùiÚ
,

113 
block_size
)

114 : 
	`db_dœ
(
ch”t_dœ
),

115 
	`»adÚly
(
aùiÚ
 =ğ
XAPIAN_DB_READONLY
),

116 
	`v”siÚ_fe
(
db_dœ
),

117 
	`po¡li¡_bË
(
db_dœ
, 
»adÚly
),

118 
	`pos™iÚ_bË
(
db_dœ
, 
»adÚly
),

119 
	`‹rmli¡_bË
(
db_dœ
, 
»adÚly
),

120 
	`v®ue_mªag”
(&
po¡li¡_bË
, &
‹rmli¡_bË
),

121 
	`synÚym_bË
(
db_dœ
, 
»adÚly
),

122 
	`¥–lšg_bË
(
db_dœ
, 
»adÚly
),

123 
	`»cÜd_bË
(
db_dœ
, 
»adÚly
),

124 
	`lock
(
db_dœ
),

125 
	$max_chªge£ts
(0)

127 
	`DEBUGCALL
(
DB
, , "Ch”tD©aba£", 
ch”t_dœ
 << ", " << 
aùiÚ
 <<

128 ", " << 
block_size
);

130 ià(
aùiÚ
 =ğ
XAPIAN_DB_READONLY
) {

131 
	`İ’_bËs_cÚsi¡’t
();

135 cÚ¡ *
p
 = 
	`g‘’v
("XAPIAN_MAX_CHANGESETS");

136 ià(
p
)

137 
max_chªge£ts
 = 
	`©oi
(
p
);

139 ià(
aùiÚ
 !ğ
X­Ÿn
::
DB_OPEN
 && !
	`d©aba£_exi¡s
()) {

144 
boŞ
 
ç
 = 
çl£
;

145 
¡©
 
¡©buf
;

146 ià(
	`¡©
(
db_dœ
, &
¡©buf
) == 0) {

147 ià(!
	`S_ISDIR
(
¡©buf
.
¡_mode
)è
ç
 = 
Œue
;

148 } ià(
”ºo
 !ğ
ENOENT
 || 
	`mkdœ
(
db_dœ
, 0755) == -1) {

149 
ç
 = 
Œue
;

151 ià(
ç
) {

152 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Cannot create directory `" +

153 
db_dœ
 + "'", 
”ºo
);

155 
	`g‘_d©aba£_wr™e_lock
(
Œue
);

157 
	`ü—‹_ªd_İ’_bËs
(
block_size
);

161 ià(
aùiÚ
 =ğ
X­Ÿn
::
DB_CREATE
) {

162 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Can't create‚ew database‡t `" +

163 
db_dœ
 + "':‡ database‡lreadyƒxists‡nd I wasold "

167 
	`g‘_d©aba£_wr™e_lock
(
çl£
);

170 ià(
aùiÚ
 =ğ
X­Ÿn
::
DB_CREATE_OR_OVERWRITE
) {

171 
	`ü—‹_ªd_İ’_bËs
(
block_size
);

176 
	`İ’_bËs_cÚsi¡’t
();

181 ià(
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
() !=

182 
po¡li¡_bË
.
	`g‘_Ï‹¡_»visiÚ_numb”
()) {

183 
ch”t_»visiÚ_numb”_t
 
Ãw_»visiÚ
 = 
	`g‘_Ãxt_»visiÚ_numb”
();

185 
	`£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

187 
	}
}

189 
	gCh”tD©aba£
::~
	$Ch”tD©aba£
()

191 
	`DEBUGCALL
(
DB
, , "~ChertDatabase", "");

192 
	}
}

194 
boŞ


195 
	gCh”tD©aba£
::
	$d©aba£_exi¡s
() {

196 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertDatabase::database_exists", "");

197 
	`RETURN
(
»cÜd_bË
.
	`exi¡s
(è&& 
po¡li¡_bË
.exists());

198 
	}
}

201 
	gCh”tD©aba£
::
	$ü—‹_ªd_İ’_bËs
(
block_size
)

203 
	`DEBUGCALL
(
DB
, , "ChertDatabase::create_and_open_tables", "");

209 
v”siÚ_fe
.
	`ü—‹
();

210 
po¡li¡_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

211 
pos™iÚ_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

212 
‹rmli¡_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

213 
synÚym_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

214 
¥–lšg_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

215 
»cÜd_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

217 
	`As£¹
(
	`d©aba£_exi¡s
());

220 
ch”t_»visiÚ_numb”_t
 
»visiÚ
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

221 ià(
»visiÚ
 !ğ
po¡li¡_bË
.
	`g‘_İ’_»visiÚ_numb”
()) {

222 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Newly createdables‡re‚ot in consistent state");

225 
¡©s
.
	`z”o
();

226 
	}
}

229 
	gCh”tD©aba£
::
	$İ’_bËs_cÚsi¡’t
()

231 
	`DEBUGCALL
(
DB
, , "ChertDatabase::open_tables_consistent", "");

240 
ch”t_»visiÚ_numb”_t
 
cur_»v
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

243 ià(
cur_»v
 =ğ0è
v”siÚ_fe
.
	`»ad_ªd_check
();

245 
»cÜd_bË
.
	`İ’
();

246 
ch”t_»visiÚ_numb”_t
 
»visiÚ
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

248 ià(
cur_»v
 && cur_»v =ğ
»visiÚ
) {

255 
block_size
 = 
»cÜd_bË
.
	`g‘_block_size
();

256 
pos™iÚ_bË
.
	`£t_block_size
(
block_size
);

257 
‹rmli¡_bË
.
	`£t_block_size
(
block_size
);

258 
synÚym_bË
.
	`£t_block_size
(
block_size
);

259 
¥–lšg_bË
.
	`£t_block_size
(
block_size
);

261 
v®ue_mªag”
.
	`»£t
();

263 
boŞ
 
fuÎy_İ’ed
 = 
çl£
;

264 
Œ›s
 = 100;

265 
Œ›s_Ëá
 = 
Œ›s
;

266 !
fuÎy_İ’ed
 && (
Œ›s_Ëá
--) > 0) {

267 ià(
¥–lšg_bË
.
	`İ’
(
»visiÚ
) &&

268 
synÚym_bË
.
	`İ’
(
»visiÚ
) &&

269 
‹rmli¡_bË
.
	`İ’
(
»visiÚ
) &&

270 
pos™iÚ_bË
.
	`İ’
(
»visiÚ
) &&

271 
po¡li¡_bË
.
	`İ’
(
»visiÚ
)) {

273 
fuÎy_İ’ed
 = 
Œue
;

285 
»cÜd_bË
.
	`İ’
();

286 
ch”t_»visiÚ_numb”_t
 
Ãw»visiÚ
 =

287 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

288 ià(
»visiÚ
 =ğ
Ãw»visiÚ
) {

292 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Cannot openables‡t consistent„evisions");

294 
»visiÚ
 = 
Ãw»visiÚ
;

298 ià(!
fuÎy_İ’ed
) {

299 
throw
 
X­Ÿn
::
	`D©aba£Modif›dE¼Ü
("Cannot openables‡t stable„evision - changingoo fast");

302 
¡©s
.
	`»ad
(
po¡li¡_bË
);

303 
	}
}

306 
	gCh”tD©aba£
::
	$İ’_bËs
(
ch”t_»visiÚ_numb”_t
 
»visiÚ
)

308 
	`DEBUGCALL
(
DB
, , "Ch”tD©aba£::İ’_bËs", 
»visiÚ
);

309 
v”siÚ_fe
.
	`»ad_ªd_check
();

310 
»cÜd_bË
.
	`İ’
(
»visiÚ
);

313 
block_size
 = 
»cÜd_bË
.
	`g‘_block_size
();

314 
pos™iÚ_bË
.
	`£t_block_size
(
block_size
);

315 
‹rmli¡_bË
.
	`£t_block_size
(
block_size
);

316 
synÚym_bË
.
	`£t_block_size
(
block_size
);

317 
¥–lšg_bË
.
	`£t_block_size
(
block_size
);

319 
v®ue_mªag”
.
	`»£t
();

321 
¥–lšg_bË
.
	`İ’
(
»visiÚ
);

322 
synÚym_bË
.
	`İ’
(
»visiÚ
);

323 
‹rmli¡_bË
.
	`İ’
(
»visiÚ
);

324 
pos™iÚ_bË
.
	`İ’
(
»visiÚ
);

325 
po¡li¡_bË
.
	`İ’
(
»visiÚ
);

326 
	}
}

328 
ch”t_»visiÚ_numb”_t


329 
	gCh”tD©aba£
::
	$g‘_»visiÚ_numb”
() const

331 
	`DEBUGCALL
(
DB
, 
ch”t_»visiÚ_numb”_t
, "ChertDatabase::get_revision_number", "");

333 
	`RETURN
(
po¡li¡_bË
.
	`g‘_İ’_»visiÚ_numb”
());

334 
	}
}

336 
ch”t_»visiÚ_numb”_t


337 
	gCh”tD©aba£
::
	$g‘_Ãxt_»visiÚ_numb”
() const

339 
	`DEBUGCALL
(
DB
, 
ch”t_»visiÚ_numb”_t
, "ChertDatabase::get_next_revision_number", "");

344 
ch”t_»visiÚ_numb”_t
 
Ãw_»visiÚ
 =

345 
po¡li¡_bË
.
	`g‘_Ï‹¡_»visiÚ_numb”
();

346 ++
Ãw_»visiÚ
;

347 
	`RETURN
(
Ãw_»visiÚ
);

348 
	}
}

351 
	gCh”tD©aba£
::
	$g‘_chªge£t_»visiÚs
(cÚ¡ 
¡ršg
 & 
·th
,

352 
ch”t_»visiÚ_numb”_t
 * 
¡¬Œev
,

353 
ch”t_»visiÚ_numb”_t
 * 
’d»v
) const

355 
chªges_fd
 = -1;

356 #ifdeà
__WIN32__


357 
chªges_fd
 = 
	`msvc_posix_İ’
(
·th
.
	`c_¡r
(), 
O_RDONLY
);

359 
chªges_fd
 = 
	`İ’
(
·th
.
	`c_¡r
(), 
O_RDONLY
);

361 
fdşo£r
 
	`şo£r
(
chªges_fd
);

363 ià(
chªges_fd
 < 0) {

364 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open changeset ")

365 + 
·th
 + "o„ead";

366 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
, 
”ºo
);

369 
buf
[
REASONABLE_CHANGESET_SIZE
];

370 cÚ¡ *
¡¬t
 = 
buf
;

371 cÚ¡ *
’d
 = 
buf
 + 
	`ch”t_io_»ad
(
chªges_fd
, buf,

372 
REASONABLE_CHANGESET_SIZE
, 0);

373 ià(
	`¡ºcmp
(
¡¬t
, 
CHANGES_MAGIC_STRING
,

374 
	`CONST_STRLEN
(
CHANGES_MAGIC_STRING
)) != 0) {

375 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Changeset‡t ")

376 + 
·th
 + " does‚ot contain valid magic string";

377 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

379 
¡¬t
 +ğ
	`CONST_STRLEN
(
CHANGES_MAGIC_STRING
);

380 ià(
¡¬t
 >ğ
’d
)

381 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Chªge£ˆtoØshÜˆ© " + 
·th
);

383 
chªges_v”siÚ
;

384 ià(!
	`uÅack_ušt
(&
¡¬t
, 
’d
, &
chªges_v”siÚ
))

385 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ valid version‚umber for "

386 "chªge£ˆ© " + 
·th
);

387 ià(
chªges_v”siÚ
 !ğ
CHANGES_VERSION
)

388 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Don't support version of changeset‡t "

389 + 
·th
);

391 ià(!
	`uÅack_ušt
(&
¡¬t
, 
’d
, 
¡¬Œev
))

392 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ valid start„evision from "

393 "chªge£ˆ© " + 
·th
);

395 ià(!
	`uÅack_ušt
(&
¡¬t
, 
’d
, 
’d»v
))

396 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ validƒnd„evision for "

397 "chªge£ˆ© " + 
·th
);

398 
	}
}

401 
	gCh”tD©aba£
::
	$£t_»visiÚ_numb”
(
ch”t_»visiÚ_numb”_t
 
Ãw_»visiÚ
)

403 
	`DEBUGCALL
(
DB
, , "Ch”tD©aba£::£t_»visiÚ_numb”", 
Ãw_»visiÚ
);

405 
v®ue_mªag”
.
	`m”ge_chªges
();

407 
po¡li¡_bË
.
	`æush_db
();

408 
pos™iÚ_bË
.
	`æush_db
();

409 
‹rmli¡_bË
.
	`æush_db
();

410 
synÚym_bË
.
	`æush_db
();

411 
¥–lšg_bË
.
	`æush_db
();

412 
»cÜd_bË
.
	`æush_db
();

414 
chªges_fd
 = -1;

415 
¡ršg
 
chªges_Çme
;

417 ià(
max_chªge£ts
 > 0) {

418 
ch”t_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

419 ià(
Şd_»visiÚ
) {

421 
chªges_Çme
 = 
db_dœ
 + "/chªges" + 
	`om_to¡ršg
(
Şd_»visiÚ
);

422 #ifdeà
__WIN32__


423 
chªges_fd
 = 
	`msvc_posix_İ’
(
chªges_Çme
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

425 
chªges_fd
 = 
	`İ’
(
chªges_Çme
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

427 ià(
chªges_fd
 < 0) {

428 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open changeset ")

429 + 
chªges_Çme
 + "o write";

430 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
, 
”ºo
);

435 
Œy
 {

436 
fdşo£r
 
	`şo£fd
(
chªges_fd
);

437 ià(
chªges_fd
 >= 0) {

438 
¡ršg
 
buf
;

439 
ch”t_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

440 
buf
 +ğ
CHANGES_MAGIC_STRING
;

441 
	`·ck_ušt
(
buf
, 
CHANGES_VERSION
);

442 
	`·ck_ušt
(
buf
, 
Şd_»visiÚ
);

443 
	`·ck_ušt
(
buf
, 
Ãw_»visiÚ
);

446 
	`·ck_ušt
(
buf
, 0u);

448 
	`ch”t_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

454 
‹rmli¡_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

455 
synÚym_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

456 
¥–lšg_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

457 
»cÜd_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

458 
pos™iÚ_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

459 
po¡li¡_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

462 
po¡li¡_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

463 
pos™iÚ_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

464 
‹rmli¡_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

465 
synÚym_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

466 
¥–lšg_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

468 
¡ršg
 
chªges_
;

469 ià(
chªges_fd
 >= 0) {

470 
chªges_
 += '\0';

471 
	`·ck_ušt
(
chªges_
, 
Ãw_»visiÚ
);

473 
»cÜd_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
, &
chªges_
);

475 } 
	`ÿtch
 (...) {

477 ià(
chªges_fd
 >= 0) {

478 
	`sys_uÆšk_if_exi¡s
(
chªges_Çme
);

481 
throw
;

483 
	}
}

486 
	gCh”tD©aba£
::
	$»İ’
()

488 
	`DEBUGCALL
(
DB
, , "ChertDatabase::reopen", "");

489 ià(
»adÚly
è
	`İ’_bËs_cÚsi¡’t
();

490 
	}
}

493 
	gCh”tD©aba£
::
	$şo£
()

495 
	`DEBUGCALL
(
DB
, , "ChertDatabase::close", "");

496 
po¡li¡_bË
.
	`şo£
(
Œue
);

497 
pos™iÚ_bË
.
	`şo£
(
Œue
);

498 
‹rmli¡_bË
.
	`şo£
(
Œue
);

499 
synÚym_bË
.
	`şo£
(
Œue
);

500 
¥–lšg_bË
.
	`şo£
(
Œue
);

501 
»cÜd_bË
.
	`şo£
(
Œue
);

502 
lock
.
	`»Ëa£
();

503 
	}
}

506 
	gCh”tD©aba£
::
	$g‘_d©aba£_wr™e_lock
(
boŞ
 
ü—tšg
)

508 
	`DEBUGCALL
(
DB
, , "Ch”tD©aba£::g‘_d©aba£_wr™e_lock", 
ü—tšg
);

509 
¡ršg
 
ex¶ª©iÚ
;

510 
FlštLock
::
»asÚ
 
why
 = 
lock
.
	`lock
(
Œue
, 
ex¶ª©iÚ
);

511 ià(
why
 !ğ
FlštLock
::
SUCCESS
) {

512 ià(
why
 =ğ
FlštLock
::
UNKNOWN
 && !
ü—tšg
 && !
	`d©aba£_exi¡s
()) {

513 
¡ršg
 
	`msg
("No chert database found‡t…ath `");

514 
msg
 +ğ
db_dœ
;

515 
msg
 += '\'';

516 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
);

518 
lock
.
	`throw_d©aba£lock”rÜ
(
why
, 
db_dœ
, 
ex¶ª©iÚ
);

520 
	}
}

523 
	gCh”tD©aba£
::
	$£nd_whŞe_d©aba£
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

524 cÚ¡ 
OmTime
 & 
’d_time
)

526 
	`DEBUGCALL
(
DB
, , "ChertDatabase::send_whole_database",

530 
¡ršg
 
buf
;

531 
¡ršg
 
uuid
 = 
	`g‘_uuid
();

532 
buf
 +ğ
	`’code_Ëngth
(
uuid
.
	`size
());

533 
buf
 +ğ
uuid
;

534 
	`·ck_ušt
(
buf
, 
	`g‘_»visiÚ_numb”
());

535 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_HEADER
, 
buf
, 
’d_time
);

539 cÚ¡ 
f’ames
[] =

547 
¡ršg
 
f•©h
 = 
db_dœ
;

548 
f•©h
 += '/';

549 cÚ¡ * 
p
 = 
f’ames
; *p;… += *p + 1) {

550 
¡ršg
 
	`Ëaf
(
p
 + 1, 
	`size_t
(
¡©ic_ÿ¡
<>(*p)));

551 
f•©h
.
	`»¶aû
(
db_dœ
.
	`size
(è+ 1, 
¡ršg
::
Åos
, 
Ëaf
);

552 ià(
	`fe_exi¡s
(
f•©h
)) {

555 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FILENAME
, 
Ëaf
, 
’d_time
);

556 
cÚn
.
	`£nd_fe
(
REPL_REPLY_DB_FILEDATA
, 
f•©h
, 
’d_time
);

559 
	}
}

562 
	gCh”tD©aba£
::
	$wr™e_chªge£ts_to_fd
(
fd
,

563 cÚ¡ 
¡ršg
 & 
»visiÚ
,

564 
boŞ
 
Ãed_whŞe_db
,

565 
R•liÿtiÚInfo
 * 
šfo
)

567 
	`DEBUGCALL
(
DB
, , "ChertDatabase::write_changesets_to_fd",

568 
fd
 << ", " << 
»visiÚ
 << ", " << 
Ãed_whŞe_db
 << ", " << 
šfo
);

570 
whŞe_db_cİ›s_Ëá
 = 
MAX_DB_COPIES_PER_CONVERSATION
;

571 
ch”t_»visiÚ_numb”_t
 
¡¬t_»v_num
 = 0;

572 
¡ršg
 
¡¬t_uuid
 = 
	`g‘_uuid
();

574 
ch”t_»visiÚ_numb”_t
 
Ãeded_»v_num
 = 0;

576 cÚ¡ * 
»v_±r
 = 
»visiÚ
.
	`d©a
();

577 cÚ¡ * 
»v_’d
 = 
»v_±r
 + 
»visiÚ
.
	`size
();

578 ià(!
	`uÅack_ušt
(&
»v_±r
, 
»v_’d
, &
¡¬t_»v_num
)) {

579 
Ãed_whŞe_db
 = 
Œue
;

582 
RemÙeCÚÃùiÚ
 
	`cÚn
(-1, 
fd
, 
	`¡ršg
());

583 
OmTime
 
’d_time
;

591 
Œue
) {

592 ià(
Ãed_whŞe_db
) {

596 ià(
whŞe_db_cİ›s_Ëá
 == 0) {

597 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_FAIL
,

599 
’d_time
);

602 
whŞe_db_cİ›s_Ëá
--;

605 
¡¬t_»v_num
 = 
	`g‘_»visiÚ_numb”
();

606 
¡¬t_uuid
 = 
	`g‘_uuid
();

608 
	`£nd_whŞe_d©aba£
(
cÚn
, 
’d_time
);

609 ià(
šfo
 !ğ
NULL
)

610 ++(
šfo
->
fuÎcİy_couÁ
);

612 
Ãed_whŞe_db
 = 
çl£
;

614 
	`»İ’
();

615 ià(
¡¬t_uuid
 =ğ
	`g‘_uuid
()) {

620 
¡ršg
 
buf
;

621 
Ãeded_»v_num
 = 
	`g‘_»visiÚ_numb”
();

622 
	`·ck_ušt
(
buf
, 
Ãeded_»v_num
);

623 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FOOTER
, 
buf
, 
’d_time
);

624 ià(
šfo
 !ğ
NULL
 && 
¡¬t_»v_num
 =ğ
Ãeded_»v_num
)

625 
šfo
->
chªged
 = 
Œue
;

635 
¡ršg
 
buf
;

636 
	`·ck_ušt
(
buf
, 
¡¬t_»v_num
 + 1);

637 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FOOTER
, 
buf
, 
’d_time
);

638 
Ãed_whŞe_db
 = 
Œue
;

642 ià(
¡¬t_»v_num
 >ğ
	`g‘_»visiÚ_numb”
()) {

643 
	`»İ’
();

644 ià(
¡¬t_uuid
 !ğ
	`g‘_uuid
()) {

645 
Ãed_whŞe_db
 = 
Œue
;

648 ià(
¡¬t_»v_num
 >ğ
	`g‘_»visiÚ_numb”
()) {

654 
¡ršg
 
chªges_Çme
 = 
db_dœ
 + "/chªges" + 
	`om_to¡ršg
(
¡¬t_»v_num
);

655 ià(
	`fe_exi¡s
(
chªges_Çme
)) {

658 
ch”t_»visiÚ_numb”_t
 
chªge£t_¡¬t_»v_num
;

659 
ch”t_»visiÚ_numb”_t
 
chªge£t_’d_»v_num
;

660 
	`g‘_chªge£t_»visiÚs
(
chªges_Çme
,

661 &
chªge£t_¡¬t_»v_num
,

662 &
chªge£t_’d_»v_num
);

663 ià(
chªge£t_¡¬t_»v_num
 !ğ
¡¬t_»v_num
) {

664 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Changeset start„evision does‚ot match changeset filename");

666 ià(
chªge£t_¡¬t_»v_num
 >ğ
chªge£t_’d_»v_num
) {

667 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Changeset start„evision is‚ot†esshanƒnd„evision");

672 
cÚn
.
	`£nd_fe
(
REPL_REPLY_CHANGESET
, 
chªges_Çme
, 
’d_time
);

673 
¡¬t_»v_num
 = 
chªge£t_’d_»v_num
;

674 ià(
šfo
 !ğ
NULL
) {

675 ++(
šfo
->
chªge£t_couÁ
);

676 ià(
¡¬t_»v_num
 >ğ
Ãeded_»v_num
)

677 
šfo
->
chªged
 = 
Œue
;

682 
Ãed_whŞe_db
 = 
Œue
;

686 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_END_OF_CHANGES
, 
	`¡ršg
(), 
’d_time
);

687 
	}
}

690 
	gCh”tD©aba£
::
modifiÿtiÚs_çed
(
ch”t_»visiÚ_numb”_t
 
Şd_»visiÚ
,

691 
ch”t_»visiÚ_numb”_t
 
Ãw_»visiÚ
,

692 cÚ¡ 
¡d
::
¡ršg
 & 
msg
)

695 
Œy
 {

698 
ÿnûl
();

701 
İ’_bËs
(
Şd_»visiÚ
);

705 ++
	gÃw_»visiÚ
;

706 
£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

707 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

710 
Ch”tD©aba£
::
şo£
();

711 
throw
 
	gX­Ÿn
::
D©aba£E¼Ü
("ModifiÿtiÚ çed (" + 
msg
 +

713 "»visiÚ‚umb”s: " + 
e
.
g‘_msg
());

718 
	gCh”tD©aba£
::
	$­¶y
()

720 
	`DEBUGCALL
(
DB
, , "ChertDatabase::apply", "");

721 ià(!
po¡li¡_bË
.
	`is_modif›d
() &&

722 !
pos™iÚ_bË
.
	`is_modif›d
() &&

723 !
‹rmli¡_bË
.
	`is_modif›d
() &&

724 !
v®ue_mªag”
.
	`is_modif›d
() &&

725 !
synÚym_bË
.
	`is_modif›d
() &&

726 !
¥–lšg_bË
.
	`is_modif›d
() &&

727 !
»cÜd_bË
.
	`is_modif›d
()) {

731 
ch”t_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

732 
ch”t_»visiÚ_numb”_t
 
Ãw_»visiÚ
 = 
	`g‘_Ãxt_»visiÚ_numb”
();

734 
Œy
 {

735 
	`£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

736 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

737 
	`modifiÿtiÚs_çed
(
Şd_»visiÚ
, 
Ãw_»visiÚ
, 
e
.
	`g‘_desütiÚ
());

738 
throw
;

739 } 
	`ÿtch
 (...) {

740 
	`modifiÿtiÚs_çed
(
Şd_»visiÚ
, 
Ãw_»visiÚ
, "Unknownƒrror");

741 
throw
;

743 
	}
}

746 
	gCh”tD©aba£
::
	$ÿnûl
()

748 
	`DEBUGCALL
(
DB
, , "ChertDatabase::cancel", "");

749 
po¡li¡_bË
.
	`ÿnûl
();

750 
pos™iÚ_bË
.
	`ÿnûl
();

751 
‹rmli¡_bË
.
	`ÿnûl
();

752 
v®ue_mªag”
.
	`ÿnûl
();

753 
synÚym_bË
.
	`ÿnûl
();

754 
¥–lšg_bË
.
	`ÿnûl
();

755 
»cÜd_bË
.
	`ÿnûl
();

756 
	}
}

758 
	gX­Ÿn
::
doccouÁ


759 
Ch”tD©aba£
::
	$g‘_doccouÁ
() const

761 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "ChertDatabase::get_doccount", "");

762 
	`RETURN
(
»cÜd_bË
.
	`g‘_doccouÁ
());

763 
	}
}

765 
	gX­Ÿn
::
docid


766 
Ch”tD©aba£
::
	$g‘_Ï¡docid
() const

768 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "ChertDatabase::get_lastdocid", "");

769 
	`RETURN
(
¡©s
.
	`g‘_Ï¡_docid
());

770 
	}
}

772 
tÙËn_t


773 
	gCh”tD©aba£
::
	$g‘_tÙ®_Ëngth
() const

775 
	`DEBUGCALL
(
DB
, 
tÙËn_t
, "ChertDatabase::get_total_length", "");

776 
	`RETURN
(
¡©s
.
	`g‘_tÙ®_doş’
());

777 
	}
}

779 
	gX­Ÿn
::
doş’gth


780 
Ch”tD©aba£
::
	$g‘_avËngth
() const

782 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doş’gth
, "ChertDatabase::get_avlength", "");

783 
X­Ÿn
::
doccouÁ
 doccouÁ = 
»cÜd_bË
.
	`g‘_doccouÁ
();

784 ià(
doccouÁ
 == 0) {

786 
	`RETURN
(0);

788 
	`RETURN
((
¡©s
.
	`g‘_tÙ®_doş’
()è/ 
doccouÁ
);

789 
	}
}

791 
	gX­Ÿn
::
‹rmcouÁ


792 
Ch”tD©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

794 
DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "Ch”tD©aba£::g‘_doş’gth", 
did
);

795 
As£¹
(
did
 != 0);

796 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
±¹Ùhis
(
this
);

797 
RETURN
(
po¡li¡_bË
.
g‘_doş’gth
(
did
, 
±¹Ùhis
));

800 
	gX­Ÿn
::
doccouÁ


801 
Ch”tD©aba£
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

803 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "Ch”tD©aba£::g‘_‹rmäeq", 
‹rm
);

804 
	`As£¹
(!
‹rm
.
	`em±y
());

805 
	`RETURN
(
po¡li¡_bË
.
	`g‘_‹rmäeq
(
‹rm
));

806 
	}
}

808 
	gX­Ÿn
::
‹rmcouÁ


809 
Ch”tD©aba£
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

811 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "Ch”tD©aba£::g‘_cŞËùiÚ_äeq", 
‹rm
);

812 
	`As£¹
(!
‹rm
.
	`em±y
());

813 
	`RETURN
(
po¡li¡_bË
.
	`g‘_cŞËùiÚ_äeq
(
‹rm
));

814 
	}
}

816 
	gX­Ÿn
::
doccouÁ


817 
Ch”tD©aba£
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const

819 
DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "Ch”tD©aba£::g‘_v®ue_äeq", 
v®no
);

820 
RETURN
(
v®ue_mªag”
.
g‘_v®ue_äeq
(
v®no
));

823 
	g¡d
::
¡ršg


824 
Ch”tD©aba£
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

826 
DEBUGCALL
(
DB
, 
¡d
::
¡ršg
, "Ch”tD©aba£::g‘_v®ue_low”_bound", 
v®no
);

827 
RETURN
(
v®ue_mªag”
.
g‘_v®ue_low”_bound
(
v®no
));

830 
	g¡d
::
¡ršg


831 
Ch”tD©aba£
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

833 
DEBUGCALL
(
DB
, 
¡d
::
¡ršg
, "Ch”tD©aba£::g‘_v®ue_uµ”_bound", 
v®no
);

834 
RETURN
(
v®ue_mªag”
.
g‘_v®ue_uµ”_bound
(
v®no
));

837 
	gX­Ÿn
::
‹rmcouÁ


838 
Ch”tD©aba£
::
	$g‘_doş’gth_low”_bound
() const

840  
¡©s
.
	`g‘_doş’gth_low”_bound
();

841 
	}
}

843 
	gX­Ÿn
::
‹rmcouÁ


844 
Ch”tD©aba£
::
	$g‘_doş’gth_uµ”_bound
() const

846  
¡©s
.
	`g‘_doş’gth_uµ”_bound
();

847 
	}
}

849 
	gX­Ÿn
::
‹rmcouÁ


850 
Ch”tD©aba£
::
	$g‘_wdf_uµ”_bound
(cÚ¡ 
¡ršg
 & 
‹rm
) const

852  
	`mš
(
	`g‘_cŞËùiÚ_äeq
(
‹rm
), 
¡©s
.
	`g‘_wdf_uµ”_bound
());

853 
	}
}

855 
boŞ


856 
	gCh”tD©aba£
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
‹rm
) const

858 
	`DEBUGCALL
(
DB
, 
boŞ
, "Ch”tD©aba£::‹rm_exi¡s", 
‹rm
);

859 
	`As£¹
(!
‹rm
.
	`em±y
());

860  
po¡li¡_bË
.
	`‹rm_exi¡s
(
‹rm
);

861 
	}
}

863 
boŞ


864 
	gCh”tD©aba£
::
	$has_pos™iÚs
() const

866  !
pos™iÚ_bË
.
	`em±y
();

867 
	}
}

869 
L—fPo¡Li¡
 *

870 
	gCh”tD©aba£
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
& 
‹rm
) const

872 
	`DEBUGCALL
(
DB
, 
L—fPo¡Li¡
 *, "Ch”tD©aba£::İ’_po¡_li¡", 
‹rm
);

873 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
	`±¹Ùhis
(
this
);

875 ià(
‹rm
.
	`em±y
()) {

876 
X­Ÿn
::
doccouÁ
 doccouÁ = 
	`g‘_doccouÁ
();

877 ià(
¡©s
.
	`g‘_Ï¡_docid
(è=ğ
doccouÁ
) {

878 
	`RETURN
(
Ãw
 
	`CÚtiguousAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

880 
	`RETURN
(
Ãw
 
	`Ch”tAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

883 
	`RETURN
(
Ãw
 
	`Ch”tPo¡Li¡
(
±¹Ùhis
, 
‹rm
, 
Œue
));

884 
	}
}

886 
V®ueLi¡
 *

887 
	gCh”tD©aba£
::
İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

889 
DEBUGCALL
(
DB
, 
V®ueLi¡
 *, "Ch”tD©aba£::İ’_v®ue_li¡", 
¦Ù
);

890 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
±¹Ùhis
(
this
);

891 
RETURN
(
Ãw
 
Ch”tV®ueLi¡
(
¦Ù
, 
±¹Ùhis
));

894 
T”mLi¡
 *

895 
	gCh”tD©aba£
::
İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const

897 
DEBUGCALL
(
DB
, 
T”mLi¡
 *, "Ch”tD©aba£::İ’_‹rm_li¡", 
did
);

898 
As£¹
(
did
 != 0);

899 ià(!
	g‹rmli¡_bË
.
is_İ’
())

900 
throw
 
	gX­Ÿn
::
F—tu»UÇvaabËE¼Ü
("Database has‚oermlist");

902 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
±¹Ùhis
(
this
);

903 
RETURN
(
Ãw
 
Ch”tT”mLi¡
(
±¹Ùhis
, 
did
));

906 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

907 
Ch”tD©aba£
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const

909 
DEBUGCALL
(
DB
, 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 *, "ChertDatabase::open_document",

910 
did
 << ", " << 
Ïzy
);

911 
As£¹
(
did
 != 0);

912 ià(!
	gÏzy
) {

914 ()
g‘_doş’gth
(
did
);

917 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
D©aba£
::IÁ”Çl> 
±¹Ùhis
(
this
);

918 
RETURN
(
Ãw
 
Ch”tDocum’t
(
±¹Ùhis
, 
did
, &
v®ue_mªag”
, &
»cÜd_bË
));

921 
Pos™iÚLi¡
 *

922 
	gCh”tD©aba£
::
İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
‹rm
) const

924 
As£¹
(
did
 != 0);

926 
	gAutoPŒ
<
	gCh”tPos™iÚLi¡
> 
po¦i¡
(
Ãw
 
Ch”tPos™iÚLi¡
);

927 ià(!
	gpo¦i¡
->
»ad_d©a
(&
pos™iÚ_bË
, 
did
, 
‹rm
)) {

933  
	gpo¦i¡
.
»Ëa£
();

936 
T”mLi¡
 *

937 
	gCh”tD©aba£
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const

939 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "ChertDatabase::open_allterms", "");

940 
	`RETURN
(
Ãw
 
	`Ch”tAÎT”msLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
>(
this
),

941 
´efix
));

942 
	}
}

944 
T”mLi¡
 *

945 
	gCh”tD©aba£
::
	$İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const

947  
¥–lšg_bË
.
	`İ’_‹rmli¡
(
wÜd
);

948 
	}
}

950 
T”mLi¡
 *

951 
	gCh”tD©aba£
::
	$İ’_¥–lšg_wÜdli¡
() const

953 
Ch”tCursÜ
 * 
cursÜ
 = 
¥–lšg_bË
.
	`cursÜ_g‘
();

954 ià(!
cursÜ
è 
NULL
;

955  
Ãw
 
	`Ch”tS³ÎšgWÜdsLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
>(
this
),

956 
cursÜ
);

957 
	}
}

959 
	gX­Ÿn
::
doccouÁ


960 
Ch”tD©aba£
::
	$g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const

962  
¥–lšg_bË
.
	`g‘_wÜd_äequ’cy
(
wÜd
);

963 
	}
}

965 
T”mLi¡
 *

966 
	gCh”tD©aba£
::
	$İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const

968  
synÚym_bË
.
	`İ’_‹rmli¡
(
‹rm
);

969 
	}
}

971 
T”mLi¡
 *

972 
	gCh”tD©aba£
::
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const

974 
Ch”tCursÜ
 * 
cursÜ
 = 
synÚym_bË
.
	`cursÜ_g‘
();

975 ià(!
cursÜ
è 
NULL
;

976  
Ãw
 
	`Ch”tSynÚymT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
>(
this
),

977 
cursÜ
, 
´efix
);

978 
	}
}

980 
¡ršg


981 
	gCh”tD©aba£
::
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const

983 
	`DEBUGCALL
(
DB
, 
¡ršg
, "Ch”tD©aba£::g‘_m‘ad©a", 
key
);

984 
¡ršg
 
	`bŒ“_key
("\x00\xc0", 2);

985 
bŒ“_key
 +ğ
key
;

986 
¡ršg
 
g
;

987 ()
po¡li¡_bË
.
	`g‘_exaù_’Œy
(
bŒ“_key
, 
g
);

988 
	`RETURN
(
g
);

989 
	}
}

991 
T”mLi¡
 *

992 
	gCh”tD©aba£
::
İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const

994 
DEBUGCALL
(
DB
, 
¡ršg
, "ChertDatabase::open_metadata_keylist", "");

995 
Ch”tCursÜ
 * 
	gcursÜ
 = 
po¡li¡_bË
.
cursÜ_g‘
();

996 ià(!
	gcursÜ
è 
	gNULL
;

997  
Ãw
 
Ch”tM‘ad©aT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
>(
this
),

998 
cursÜ
, 
´efix
);

1001 
¡ršg


1002 
	gCh”tD©aba£
::
	$g‘_»visiÚ_šfo
() const

1004 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertDatabase::get_revision_info", "");

1005 
¡ršg
 
buf
;

1006 
	`·ck_ušt
(
buf
, 
	`g‘_»visiÚ_numb”
());

1007 
	`RETURN
(
buf
);

1008 
	}
}

1010 
¡ršg


1011 
	gCh”tD©aba£
::
	$g‘_uuid
() const

1013 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertDatabase::get_uuid", "");

1014 
	`RETURN
(
v”siÚ_fe
.
	`g‘_uuid_¡ršg
());

1015 
	}
}

1019 
	gCh”tWr™abËD©aba£
::
	$Ch”tWr™abËD©aba£
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
,

1020 
block_size
)

1021 : 
	`Ch”tD©aba£
(
dœ
, 
aùiÚ
, 
block_size
),

1022 
	`äeq_d–s
(),

1023 
	`doş’s
(),

1024 
	`mod_¶i¡s
(),

1025 
	`chªge_couÁ
(0),

1026 
	`æush_th»shŞd
(0),

1027 
	`modify_shÜtcut_docum’t
(
NULL
),

1028 
	$modify_shÜtcut_docid
(0)

1030 
	`DEBUGCALL
(
DB
, , "Ch”tWr™abËD©aba£", 
dœ
 << ", " << 
aùiÚ
 << ", "

1031 << 
block_size
);

1033 cÚ¡ *
p
 = 
	`g‘’v
("XAPIAN_FLUSH_THRESHOLD");

1034 ià(
p
)

1035 
æush_th»shŞd
 = 
	`©oi
(
p
);

1036 ià(
æush_th»shŞd
 == 0)

1037 
æush_th»shŞd
 = 10000;

1038 
	}
}

1040 
	gCh”tWr™abËD©aba£
::~
	$Ch”tWr™abËD©aba£
()

1042 
	`DEBUGCALL
(
DB
, , "~ChertWritableDatabase", "");

1043 
	`dtÜ_ÿÎed
();

1044 
	}
}

1047 
	gCh”tWr™abËD©aba£
::
	$comm™
()

1049 ià(
	`Œª§ùiÚ_aùive
())

1050 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Can't commit during‡ransaction");

1051 ià(
chªge_couÁ
è
	`æush_po¡li¡_chªges
();

1052 
	`­¶y
();

1053 
	}
}

1056 
	gCh”tWr™abËD©aba£
::
	$æush_po¡li¡_chªges
() const

1058 
po¡li¡_bË
.
	`m”ge_chªges
(
mod_¶i¡s
, 
doş’s
, 
äeq_d–s
);

1059 
¡©s
.
	`wr™e
(
po¡li¡_bË
);

1061 
äeq_d–s
.
	`ş—r
();

1062 
doş’s
.
	`ş—r
();

1063 
mod_¶i¡s
.
	`ş—r
();

1064 
chªge_couÁ
 = 0;

1065 
	}
}

1068 
	gCh”tWr™abËD©aba£
::
	$şo£
()

1070 
	`DEBUGCALL
(
DB
, , "ChertWritableDatabase::close", "");

1071 ià(!
	`Œª§ùiÚ_aùive
()) {

1072 
	`comm™
();

1075 
Ch”tD©aba£
::
	`şo£
();

1076 
	}
}

1079 
	gCh”tWr™abËD©aba£
::
	$­¶y
()

1081 
v®ue_mªag”
.
	`£t_v®ue_¡©s
(
v®ue_¡©s
);

1082 
Ch”tD©aba£
::
	`­¶y
();

1083 
	}
}

1086 
	gCh”tWr™abËD©aba£
::
add_äeq_d–
(cÚ¡ 
¡ršg
 & 
Šame
,

1087 
X­Ÿn
::
‹rmcouÁ_diff
 
tf_d–
,

1088 
X­Ÿn
::
‹rmcouÁ_diff
 
cf_d–
)

1090 
m­
<
¡ršg
, 
	g·œ
<
	g‹rmcouÁ_diff
,”mcouÁ_diff> >::
™”©Ü
 
i
;

1091 
	gi
 = 
äeq_d–s
.
fšd
(
Šame
);

1092 ià(
	gi
 =ğ
äeq_d–s
.
’d
()) {

1093 
äeq_d–s
.
š£¹
(
make_·œ
(
Šame
, make_·œ(
tf_d–
, 
cf_d–
)));

1095 
	gi
->
	g£cÚd
.
	gfœ¡
 +ğ
tf_d–
;

1096 
	gi
->
	g£cÚd
.£cÚd +ğ
cf_d–
;

1101 
	gCh”tWr™abËD©aba£
::
š£¹_mod_¶i¡
(
X­Ÿn
::
docid
 
did
,

1102 cÚ¡ 
¡ršg
 & 
Šame
,

1103 
X­Ÿn
::
‹rmcouÁ
 
wdf
)

1106 
m­
<
¡ršg
, 
	gm­
<
	gdocid
, 
	g·œ
<, 
	g‹rmcouÁ
> > >::
™”©Ü
 
j
;

1107 
	gj
 = 
mod_¶i¡s
.
fšd
(
Šame
);

1108 ià(
	gj
 =ğ
mod_¶i¡s
.
’d
()) {

1109 
m­
<
docid
, 
·œ
<, 
‹rmcouÁ
> > 
m
;

1110 
	gj
 = 
mod_¶i¡s
.
š£¹
(
make_·œ
(
Šame
, 
m
)).
	gfœ¡
;

1112 
	gj
->
	g£cÚd
[
did
] = 
make_·œ
('A', 
wdf
);

1116 
	gCh”tWr™abËD©aba£
::
upd©e_mod_¶i¡
(
X­Ÿn
::
docid
 
did
,

1117 cÚ¡ 
¡ršg
 & 
Šame
,

1118 
ty³
,

1119 
X­Ÿn
::
‹rmcouÁ
 
wdf
)

1122 
m­
<
¡ršg
, 
	gm­
<
	gdocid
, 
	g·œ
<, 
	g‹rmcouÁ
> > >::
™”©Ü
 
j
;

1123 
	gj
 = 
mod_¶i¡s
.
fšd
(
Šame
);

1124 ià(
	gj
 =ğ
mod_¶i¡s
.
’d
()) {

1125 
m­
<
docid
, 
·œ
<, 
‹rmcouÁ
> > 
m
;

1126 
	gj
 = 
mod_¶i¡s
.
š£¹
(
make_·œ
(
Šame
, 
m
)).
	gfœ¡
;

1129 
	gm­
<
	gdocid
, 
	g·œ
<, 
	g‹rmcouÁ
> >::
™”©Ü
 
k
;

1130 
	gk
 = 
j
->
£cÚd
.
fšd
(
did
);

1131 ià(
	gk
 =ğ
j
->
£cÚd
.
’d
()) {

1132 
j
->
£cÚd
.
š£¹
(
make_·œ
(
did
, make_·œ(
ty³
, 
wdf
)));

1134 ià(
	gty³
 == 'A') {

1136 
As£¹
(
k
->
£cÚd
.
fœ¡
 == 'D');

1137 
	gty³
 = 'M';

1139 
	gk
->
	g£cÚd
 = 
make_·œ
(
ty³
, 
wdf
);

1143 
	gX­Ÿn
::
docid


1144 
Ch”tWr™abËD©aba£
::
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1146 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
,

1147 "Ch”tWr™abËD©aba£::add_docum’t", 
docum’t
);

1149 ià(
	g¡©s
.
g‘_Ï¡_docid
(è=ğ
X­Ÿn
::
docid
(-1))

1150 
throw
 
X­Ÿn
::
D©aba£E¼Ü
("Run out of docids - you'll haveo use copydatabaseoƒliminate‡ny gaps before you can‡dd more documents");

1152 
RETURN
(
add_docum’t_
(
¡©s
.
g‘_Ãxt_docid
(), 
docum’t
));

1155 
	gX­Ÿn
::
docid


1156 
Ch”tWr™abËD©aba£
::
add_docum’t_
(
X­Ÿn
::
docid
 
did
,

1157 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1159 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
,

1160 "Ch”tWr™abËD©aba£::add_docum’t_", 
did
 << ", " << 
docum’t
);

1161 
As£¹
(
did
 != 0);

1162 
	gŒy
 {

1164 
LOGLINE
(
DB
, "Addo„ecordable");

1165 
	g»cÜd_bË
.
»¶aû_»cÜd
(
docum’t
.
g‘_d©a
(), 
did
);

1168 
	gv®ue_mªag”
.
add_docum’t
(
did
, 
docum’t
, 
v®ue_¡©s
);

1170 
ch”t_doş’_t
 
	gÃw_doş’
 = 0;

1172 
LOGLINE
(
DB
, "Check‡Î”m š docum’t: " << 
docum’t
);

1173 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm
 = 
docum’t
.
‹rmli¡_begš
();

1174 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm_’d
 = 
docum’t
.
‹rmli¡_’d
();

1175  ; 
	g‹rm
 !ğ
‹rm_’d
; ++term) {

1176 
‹rmcouÁ
 
	gwdf
 = 
‹rm
.
g‘_wdf
();

1178 
	gÃw_doş’
 +ğ
wdf
;

1179 
	g¡©s
.
check_wdf
(
wdf
);

1181 
¡ršg
 
	gŠame
 = *
‹rm
;

1182 
LOGLINE
(
DB
, "T”m‚ame: " << 
Šame
);

1183 ià(
	gŠame
.
size
(è> 
	gMAX_SAFE_TERM_LENGTH
)

1184 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("T”moØlÚg (> "
STRINGIZE
(
MAX_SAFE_TERM_LENGTH
)"): " + 
Šame
);

1185 
add_äeq_d–
(
Šame
, 1, 
wdf
);

1186 
š£¹_mod_¶i¡
(
did
, 
Šame
, 
wdf
);

1188 ià(
	g‹rm
.
pos™iÚli¡_begš
(è!ğ
‹rm
.
pos™iÚli¡_’d
()) {

1189 
LOGLINE
(
DB
, "Insert into…osition†ist");

1190 
	gpos™iÚ_bË
.
£t_pos™iÚli¡
(

1191 
did
, 
Šame
,

1192 
‹rm
.
pos™iÚli¡_begš
(),”m.
pos™iÚli¡_’d
());

1196 
LOGLINE
(
DB
, "C®cuÏ‹d doş’ fÜ‚ew docum’ˆ" << 
did
 << "‡ " << 
Ãw_doş’
);

1199 
LOGLINE
(
DB
, "Call seterm†ist");

1200 ià(
	g‹rmli¡_bË
.
is_İ’
())

1201 
	g‹rmli¡_bË
.
£t_‹rmli¡
(
did
, 
docum’t
, 
Ãw_doş’
);

1204 
As£¹
(
doş’s
.
fšd
(
did
è=ğdoş’s.
’d
(è|| doş’s[did] =ğ
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(-1));

1205 
	gdoş’s
[
did
] = 
Ãw_doş’
;

1206 
	g¡©s
.
add_docum’t
(
Ãw_doş’
);

1207 } 
ÿtch
 (...) {

1212 
ÿnûl
();

1213 
	gthrow
;

1226 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1227 
LOGLINE
(
DB
, "Flush‡nd‡pply db change");

1228 
æush_po¡li¡_chªges
();

1229 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1232 
RETURN
(
did
);

1236 
	gCh”tWr™abËD©aba£
::
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
)

1238 
DEBUGCALL
(
DB
, , "Ch”tWr™abËD©aba£::d–‘e_docum’t", 
did
);

1239 
As£¹
(
did
 != 0);

1241 ià(!
	g‹rmli¡_bË
.
is_İ’
())

1242 
throw
 
	gX­Ÿn
::
F—tu»UÇvaabËE¼Ü
("Database has‚oermlist");

1244 ià(
¿»
(
modify_shÜtcut_docid
 =ğ
did
)) {

1247 
modify_shÜtcut_docum’t
 = 
NULL
;

1248 
	gmodify_shÜtcut_docid
 = 0;

1254 
	g»cÜd_bË
.
d–‘e_»cÜd
(
did
);

1256 
	gŒy
 {

1258 
	gv®ue_mªag”
.
d–‘e_docum’t
(
did
, 
v®ue_¡©s
);

1261 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tWr™abËD©aba£
> 
±¹Ùhis
(
this
);

1262 
Ch”tT”mLi¡
 
‹rmli¡
(
±¹Ùhis
, 
did
);

1264 
	g¡©s
.
d–‘e_docum’t
(
‹rmli¡
.
g‘_doş’gth
());

1266 
	g‹rmli¡
.
Ãxt
();

1267 !
	g‹rmli¡
.
©_’d
()) {

1268 
¡ršg
 
	gŠame
 = 
‹rmli¡
.
g‘_‹rmÇme
();

1269 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, 
Šame
);

1270 
‹rmcouÁ
 
	gwdf
 = 
‹rmli¡
.
g‘_wdf
();

1272 
add_äeq_d–
(
Šame
, -1, -
wdf
);

1273 
upd©e_mod_¶i¡
(
did
, 
Šame
, 'D', 0u);

1275 
	g‹rmli¡
.
Ãxt
();

1279 ià(
	g‹rmli¡_bË
.
is_İ’
())

1280 
	g‹rmli¡_bË
.
d–‘e_‹rmli¡
(
did
);

1283 
	gdoş’s
[
did
] = 
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(-1);

1284 } 
ÿtch
 (...) {

1289 
ÿnûl
();

1290 
	gthrow
;

1293 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1294 
æush_po¡li¡_chªges
();

1295 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1303 
boŞ
 
pos™iÚli¡s_equ®
(
X­Ÿn
::
T”mI‹¿tÜ
 & 
‹rm™”
,

1304 
Ch”tT”mLi¡
 & 
‹rmli¡
)

1306 ià(
	g‹rm™”
.
pos™iÚli¡_couÁ
(è!ğ
‹rmli¡
.positionlist_count())

1307  
çl£
;

1309  
equ®
(
‹rm™”
.
pos™iÚli¡_begš
(),

1310 
‹rm™”
.
pos™iÚli¡_’d
(),

1311 
‹rmli¡
.
pos™iÚli¡_begš
());

1323 
£t_pos™iÚli¡
(
Ch”tPos™iÚLi¡TabË
 & 
pos™iÚ_bË
,

1324 
X­Ÿn
::
docid
 
did
,

1325 
X­Ÿn
::
T”mI‹¿tÜ
 & 
‹rm
)

1327 
Pos™iÚI‹¿tÜ
 
™
 = 
‹rm
.
pos™iÚli¡_begš
();

1328 
Pos™iÚI‹¿tÜ
 
	g™_’d
 = 
‹rm
.
pos™iÚli¡_’d
();

1329 ià(
	g™
 !ğ
™_’d
) {

1330 
pos™iÚ_bË
.
£t_pos™iÚli¡
(
did
, *
‹rm
, 
™
, 
™_’d
);

1332 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, *
‹rm
);

1337 
	gCh”tWr™abËD©aba£
::
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

1338 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1340 
DEBUGCALL
(
DB
, , "Ch”tWr™abËD©aba£::»¶aû_docum’t", 
did
 << ", " << 
docum’t
);

1341 
As£¹
(
did
 != 0);

1343 
	gŒy
 {

1344 ià(
	gdid
 > 
	g¡©s
.
g‘_Ï¡_docid
()) {

1345 
	g¡©s
.
£t_Ï¡_docid
(
did
);

1348 ()
add_docum’t_
(
did
, 
docum’t
);

1352 ià(!
	g‹rmli¡_bË
.
is_İ’
()) {

1354 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
±¹Ùhis
(
this
);

1355 ià(!
	gpo¡li¡_bË
.
docum’t_exi¡s
(
did
, 
±¹Ùhis
)) {

1356 ()
add_docum’t_
(
did
, 
docum’t
);

1359 
throw
 
	gX­Ÿn
::
F—tu»UÇvaabËE¼Ü
("Database has‚oermlist");

1364 
boŞ
 
	gmodifyšg
 = 
çl£
;

1365 ià(
	gmodify_shÜtcut_docid
 &&

1366 
	gdocum’t
.
	gš‹º®
->
g‘_docid
(è=ğ
modify_shÜtcut_docid
) {

1367 ià(
docum’t
.
š‹º®
.
g‘
(è=ğ
modify_shÜtcut_docum’t
) {

1371 ià(!
docum’t
.
š‹º®
->
modif›d
()) {

1375 
	gmodifyšg
 = 
Œue
;

1376 
LOGLINE
(
DB
, "Detected…otential document modification shortcut.");

1381 
	gmodify_shÜtcut_docum’t
 = 
NULL
;

1382 
	gmodify_shÜtcut_docid
 = 0;

1386 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
‹rms_modif›d
()) {

1387 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tWr™abËD©aba£
> 
±¹Ùhis
(
this
);

1388 
Ch”tT”mLi¡
 
‹rmli¡
(
±¹Ùhis
, 
did
);

1389 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm
 = 
docum’t
.
‹rmli¡_begš
();

1390 
ch”t_doş’_t
 
	gÃw_doş’
 = 
‹rmli¡
.
g‘_doş’gth
();

1391 
¡ršg
 
	gŞd_Šame
, 
	gÃw_Šame
;

1393 
	g¡©s
.
d–‘e_docum’t
(
Ãw_doş’
);

1394 
	g‹rmli¡
.
Ãxt
();

1395 !
	g‹rmli¡
.
©_’d
(è|| 
	g‹rm
 !ğ
docum’t
.
‹rmli¡_’d
()) {

1396 
cmp
;

1397 ià(
	g‹rmli¡
.
©_’d
()) {

1398 
	gcmp
 = 1;

1399 
	gÃw_Šame
 = *
‹rm
;

1401 
	gŞd_Šame
 = 
‹rmli¡
.
g‘_‹rmÇme
();

1402 ià(
	g‹rm
 !ğ
docum’t
.
‹rmli¡_’d
()) {

1403 
Ãw_Šame
 = *
‹rm
;

1404 
	gcmp
 = 
Şd_Šame
.
com·»
(
Ãw_Šame
);

1406 
	gcmp
 = -1;

1410 ià(
	gcmp
 < 0) {

1412 
‹rmcouÁ
 
	gŞd_wdf
 = 
‹rmli¡
.
g‘_wdf
();

1413 
	gÃw_doş’
 -ğ
Şd_wdf
;

1414 
add_äeq_d–
(
Şd_Šame
, -1, -
Şd_wdf
);

1415 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, 
Şd_Šame
);

1416 
upd©e_mod_¶i¡
(
did
, 
Şd_Šame
, 'D', 0u);

1417 
	g‹rmli¡
.
Ãxt
();

1418 } ià(
	gcmp
 > 0) {

1420 
‹rmcouÁ
 
	gÃw_wdf
 = 
‹rm
.
g‘_wdf
();

1421 
	gÃw_doş’
 +ğ
Ãw_wdf
;

1422 ià(
	gÃw_Šame
.
size
(è> 
	gMAX_SAFE_TERM_LENGTH
)

1423 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("T”moØlÚg (> "
STRINGIZE
(
MAX_SAFE_TERM_LENGTH
)"): " + 
Ãw_Šame
);

1424 
add_äeq_d–
(
Ãw_Šame
, 1, 
Ãw_wdf
);

1425 
upd©e_mod_¶i¡
(
did
, 
Ãw_Šame
, 'A', 
Ãw_wdf
);

1426 
£t_pos™iÚli¡
(
pos™iÚ_bË
, 
did
, 
‹rm
);

1427 ++
	g‹rm
;

1428 } ià(
	gcmp
 == 0) {

1430 
‹rmcouÁ
 
Şd_wdf
 = 
‹rmli¡
.
g‘_wdf
();

1431 
‹rmcouÁ
 
	gÃw_wdf
 = 
‹rm
.
g‘_wdf
();

1432 ià(
	gŞd_wdf
 !ğ
Ãw_wdf
) {

1433 
Ãw_doş’
 +ğ
Ãw_wdf
 - 
Şd_wdf
;

1434 
add_äeq_d–
(
Ãw_Šame
, 0, 
Ãw_wdf
 - 
Şd_wdf
);

1435 
upd©e_mod_¶i¡
(
did
, 
Ãw_Šame
, 'M', 
Ãw_wdf
);

1438 ià(!
pos™iÚli¡s_equ®
(
‹rm
, 
‹rmli¡
))

1439 
£t_pos™iÚli¡
(
pos™iÚ_bË
, 
did
, 
‹rm
);

1441 ++
	g‹rm
;

1442 
	g‹rmli¡
.
Ãxt
();

1445 
LOGLINE
(
DB
, "C®cuÏ‹d doş’ fÜ„•Ïûm’ˆdocum’ˆ" << 
did
 << "‡ " << 
Ãw_doş’
);

1448 ià(
	g‹rmli¡_bË
.
is_İ’
())

1449 
	g‹rmli¡_bË
.
£t_‹rmli¡
(
did
, 
docum’t
, 
Ãw_doş’
);

1452 
	gdoş’s
[
did
] = 
Ãw_doş’
;

1453 
	g¡©s
.
add_docum’t
(
Ãw_doş’
);

1456 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
d©a_modif›d
()) {

1458 
	g»cÜd_bË
.
»¶aû_»cÜd
(
docum’t
.
g‘_d©a
(), 
did
);

1461 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
v®ues_modif›d
()) {

1463 
	gv®ue_mªag”
.
»¶aû_docum’t
(
did
, 
docum’t
, 
v®ue_¡©s
);

1465 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
DocNÙFoundE¼Ü
 &) {

1466 ()
add_docum’t_
(
did
, 
docum’t
);

1468 } 
ÿtch
 (...) {

1473 
ÿnûl
();

1474 
	gthrow
;

1477 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1478 
æush_po¡li¡_chªges
();

1479 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1483 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

1484 
Ch”tWr™abËD©aba£
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const

1486 
DEBUGCALL
(
DB
, 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 *, "ChertWritableDatabase::open_document",

1487 
did
 << ", " << 
Ïzy
);

1488 
	gmodify_shÜtcut_docum’t
 = 
Ch”tD©aba£
::
İ’_docum’t
(
did
, 
Ïzy
);

1491 
	gmodify_shÜtcut_docid
 = 
did
;

1492 
RETURN
(
modify_shÜtcut_docum’t
);

1495 
	gX­Ÿn
::
‹rmcouÁ


1496 
Ch”tWr™abËD©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

1498 
DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "Ch”tWr™abËD©aba£::g‘_doş’gth", 
did
);

1499 
	gm­
<
	gdocid
, 
	g‹rmcouÁ
>::
cÚ¡_™”©Ü
 
i
 = 
doş’s
.
fšd
(
did
);

1500 ià(
	gi
 !ğ
doş’s
.
’d
()) {

1501 
X­Ÿn
::
‹rmcouÁ
 
doş’
 = 
i
->
£cÚd
;

1502 ià(
	gdoş’
 =ğ
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(-1)) {

1503 
throw
 
X­Ÿn
::
DocNÙFoundE¼Ü
("Docum’ˆ" + 
om_to¡ršg
(
did
) + "‚ot found");

1505 
RETURN
(
doş’
);

1507 
RETURN
(
Ch”tD©aba£
::
g‘_doş’gth
(
did
));

1510 
	gX­Ÿn
::
doccouÁ


1511 
Ch”tWr™abËD©aba£
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

1513 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "Ch”tWr™abËD©aba£::g‘_‹rmäeq", 
Šame
);

1514 
X­Ÿn
::
doccouÁ
 
‹rmäeq
 = 
Ch”tD©aba£
::
	`g‘_‹rmäeq
(
Šame
);

1515 
m­
<
¡ršg
, 
·œ
<
‹rmcouÁ_diff
,”mcouÁ_diff> >::
cÚ¡_™”©Ü
 
i
;

1516 
i
 = 
äeq_d–s
.
	`fšd
(
Šame
);

1517 ià(
i
 !ğ
äeq_d–s
.
	`’d
()è
‹rmäeq
 +ği->
£cÚd
.
fœ¡
;

1518 
	`RETURN
(
‹rmäeq
);

1519 
	}
}

1521 
	gX­Ÿn
::
‹rmcouÁ


1522 
Ch”tWr™abËD©aba£
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

1524 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "Ch”tWr™abËD©aba£::g‘_cŞËùiÚ_äeq", 
Šame
);

1525 
X­Ÿn
::
‹rmcouÁ
 
cŞläeq
 = 
Ch”tD©aba£
::
	`g‘_cŞËùiÚ_äeq
(
Šame
);

1527 
m­
<
¡ršg
, 
·œ
<
‹rmcouÁ_diff
,”mcouÁ_diff> >::
cÚ¡_™”©Ü
 
i
;

1528 
i
 = 
äeq_d–s
.
	`fšd
(
Šame
);

1529 ià(
i
 !ğ
äeq_d–s
.
	`’d
()è
cŞläeq
 +ği->
£cÚd
.second;

1531 
	`RETURN
(
cŞläeq
);

1532 
	}
}

1534 
	gX­Ÿn
::
doccouÁ


1535 
Ch”tWr™abËD©aba£
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const

1537 
DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "Ch”tWr™abËD©aba£::g‘_v®ue_äeq", 
v®no
);

1538 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
;

1539 
	gi
 = 
v®ue_¡©s
.
fšd
(
v®no
);

1540 ià(
	gi
 !ğ
v®ue_¡©s
.
’d
()è
RETURN
(
i
->
£cÚd
.
äeq
);

1541 
RETURN
(
Ch”tD©aba£
::
g‘_v®ue_äeq
(
v®no
));

1544 
	g¡d
::
¡ršg


1545 
Ch”tWr™abËD©aba£
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

1547 
DEBUGCALL
(
DB
, 
¡d
::
¡ršg
, "Ch”tWr™abËD©aba£::g‘_v®ue_low”_bound", 
v®no
);

1548 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
;

1549 
	gi
 = 
v®ue_¡©s
.
fšd
(
v®no
);

1550 ià(
	gi
 !ğ
v®ue_¡©s
.
’d
()è
RETURN
(
i
->
£cÚd
.
low”_bound
);

1551 
RETURN
(
Ch”tD©aba£
::
g‘_v®ue_low”_bound
(
v®no
));

1554 
	g¡d
::
¡ršg


1555 
Ch”tWr™abËD©aba£
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

1557 
DEBUGCALL
(
DB
, 
¡d
::
¡ršg
, "Ch”tWr™abËD©aba£::g‘_v®ue_uµ”_bound", 
v®no
);

1558 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
;

1559 
	gi
 = 
v®ue_¡©s
.
fšd
(
v®no
);

1560 ià(
	gi
 !ğ
v®ue_¡©s
.
’d
()è
RETURN
(
i
->
£cÚd
.
uµ”_bound
);

1561 
RETURN
(
Ch”tD©aba£
::
g‘_v®ue_uµ”_bound
(
v®no
));

1564 
boŞ


1565 
	gCh”tWr™abËD©aba£
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const

1567 
	`DEBUGCALL
(
DB
, 
boŞ
, "Ch”tWr™abËD©aba£::‹rm_exi¡s", 
Šame
);

1568 
	`RETURN
(
	`g‘_‹rmäeq
(
Šame
) != 0);

1569 
	}
}

1571 
L—fPo¡Li¡
 *

1572 
	gCh”tWr™abËD©aba£
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
& 
Šame
) const

1574 
	`DEBUGCALL
(
DB
, 
L—fPo¡Li¡
 *, "Ch”tWr™abËD©aba£::İ’_po¡_li¡", 
Šame
);

1575 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tWr™abËD©aba£
> 
	`±¹Ùhis
(
this
);

1577 ià(
Šame
.
	`em±y
()) {

1578 
X­Ÿn
::
doccouÁ
 doccouÁ = 
	`g‘_doccouÁ
();

1579 ià(
¡©s
.
	`g‘_Ï¡_docid
(è=ğ
doccouÁ
) {

1580 
	`RETURN
(
Ãw
 
	`CÚtiguousAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

1582 ià(
doş’s
.
	`em±y
()) {

1583 
	`RETURN
(
Ãw
 
	`Ch”tAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

1585 
	`RETURN
(
Ãw
 
	`Ch”tAÎDocsModif›dPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
, 
doş’s
));

1588 
m­
<
¡ršg
, m­<
docid
, 
·œ
<, 
‹rmcouÁ
> > >::
cÚ¡_™”©Ü
 
j
;

1589 
j
 = 
mod_¶i¡s
.
	`fšd
(
Šame
);

1590 ià(
j
 !ğ
mod_¶i¡s
.
	`’d
()) {

1593 
	`RETURN
(
Ãw
 
	`Ch”tModif›dPo¡Li¡
(
±¹Ùhis
, 
Šame
, 
j
->
£cÚd
));

1596 
	`RETURN
(
Ãw
 
	`Ch”tPo¡Li¡
(
±¹Ùhis
, 
Šame
, 
Œue
));

1597 
	}
}

1599 
V®ueLi¡
 *

1600 
	gCh”tWr™abËD©aba£
::
İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

1602 
DEBUGCALL
(
DB
, 
V®ueLi¡
 *, "Ch”tWr™abËD©aba£::İ’_v®ue_li¡", 
¦Ù
);

1606 ià(
	gchªge_couÁ
è
	gv®ue_mªag”
.
m”ge_chªges
();

1607 
RETURN
(
Ch”tD©aba£
::
İ’_v®ue_li¡
(
¦Ù
));

1610 
T”mLi¡
 *

1611 
	gCh”tWr™abËD©aba£
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const

1613 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "ChertWritableDatabase::open_allterms", "");

1617 ià(
chªge_couÁ
è
	`æush_po¡li¡_chªges
();

1618 
	`RETURN
(
Ch”tD©aba£
::
	`İ’_®É”ms
(
´efix
));

1619 
	}
}

1622 
	gCh”tWr™abËD©aba£
::
	$ÿnûl
()

1624 
Ch”tD©aba£
::
	`ÿnûl
();

1625 
¡©s
.
	`»ad
(
po¡li¡_bË
);

1626 
äeq_d–s
.
	`ş—r
();

1627 
doş’s
.
	`ş—r
();

1628 
mod_¶i¡s
.
	`ş—r
();

1629 
v®ue_¡©s
.
	`ş—r
();

1630 
chªge_couÁ
 = 0;

1631 
	}
}

1634 
	gCh”tWr™abËD©aba£
::
add_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
,

1635 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const

1637 
¥–lšg_bË
.
add_wÜd
(
wÜd
, 
äeqšc
);

1641 
	gCh”tWr™abËD©aba£
::
»move_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
,

1642 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const

1644 
¥–lšg_bË
.
»move_wÜd
(
wÜd
, 
äeqdec
);

1647 
T”mLi¡
 *

1648 
	gCh”tWr™abËD©aba£
::
	$İ’_¥–lšg_wÜdli¡
() const

1650 
¥–lšg_bË
.
	`m”ge_chªges
();

1651  
Ch”tD©aba£
::
	`İ’_¥–lšg_wÜdli¡
();

1652 
	}
}

1654 
T”mLi¡
 *

1655 
	gCh”tWr™abËD©aba£
::
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const

1657 
synÚym_bË
.
	`m”ge_chªges
();

1658  
Ch”tD©aba£
::
	`İ’_synÚym_keyli¡
(
´efix
);

1659 
	}
}

1662 
	gCh”tWr™abËD©aba£
::
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
,

1663 cÚ¡ 
¡ršg
 & 
synÚym
) const

1665 
synÚym_bË
.
	`add_synÚym
(
‹rm
, 
synÚym
);

1666 
	}
}

1669 
	gCh”tWr™abËD©aba£
::
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
,

1670 cÚ¡ 
¡ršg
 & 
synÚym
) const

1672 
synÚym_bË
.
	`»move_synÚym
(
‹rm
, 
synÚym
);

1673 
	}
}

1676 
	gCh”tWr™abËD©aba£
::
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
‹rm
) const

1678 
synÚym_bË
.
	`ş—r_synÚyms
(
‹rm
);

1679 
	}
}

1682 
	gCh”tWr™abËD©aba£
::
	$£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
)

1684 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertWritableDatabase::set_metadata",

1685 
key
 << ", " << 
v®ue
);

1686 
¡ršg
 
	`bŒ“_key
("\x00\xc0", 2);

1687 
bŒ“_key
 +ğ
key
;

1688 ià(
v®ue
.
	`em±y
()) {

1689 
po¡li¡_bË
.
	`d–
(
bŒ“_key
);

1691 
po¡li¡_bË
.
	`add
(
bŒ“_key
, 
v®ue
);

1693 
	}
}

1696 
	gCh”tWr™abËD©aba£
::
šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const

1698 ià(
obj
 =ğ
modify_shÜtcut_docum’t
) {

1699 
modify_shÜtcut_docum’t
 = 
NULL
;

1700 
	gmodify_shÜtcut_docid
 = 0;

	@backends/chert/chert_database.h

24 #iâdeà
OM_HGUARD_CHERT_DATABASE_H


25 
	#OM_HGUARD_CHERT_DATABASE_H


	)

27 
	~"d©aba£.h
"

28 
	~"ch”t_db¡©s.h
"

29 
	~"ch”t_pos™iÚli¡.h
"

30 
	~"ch”t_po¡li¡.h
"

31 
	~"ch”t_»cÜd.h
"

32 
	~"ch”t_¥–lšg.h
"

33 
	~"ch”t_synÚym.h
"

34 
	~"ch”t_‹rmli¡bË.h
"

35 
	~"ch”t_v®ues.h
"

36 
	~"ch”t_v”siÚ.h
"

37 
	~"../æšt_lock.h
"

38 
	~"ch”t_ty³s.h
"

39 
	~"v®ue¡©s.h
"

41 
	~<m­
>

43 
şass
 
	gCh”tT”mLi¡
;

44 
şass
 
	gCh”tAÎDocsPo¡Li¡
;

45 
şass
 
	gRemÙeCÚÃùiÚ
;

46 
şass
 
	gOmTime
;

51 şas 
	cCh”tD©aba£
 : 
public
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 {

52 
ä›nd
 
şass
 
Ch”tWr™abËD©aba£
;

53 
ä›nd
 
şass
 
	mCh”tT”mLi¡
;

54 
ä›nd
 
şass
 
	mCh”tPo¡Li¡
;

55 
ä›nd
 
şass
 
	mCh”tAÎT”msLi¡
;

56 
ä›nd
 
şass
 
	mCh”tAÎDocsPo¡Li¡
;

57 
	m´iv©e
:

60 
¡d
::
¡ršg
 
db_dœ
;

64 
boŞ
 
	m»adÚly
;

70 
Ch”tV”siÚ
 
	mv”siÚ_fe
;

78 
mubË
 
Ch”tPo¡Li¡TabË
 
	mpo¡li¡_bË
;

82 
Ch”tPos™iÚLi¡TabË
 
	mpos™iÚ_bË
;

86 
Ch”tT”mLi¡TabË
 
	m‹rmli¡_bË
;

89 
mubË
 
Ch”tV®ueMªag”
 
	mv®ue_mªag”
;

93 
mubË
 
Ch”tSynÚymTabË
 
	msynÚym_bË
;

97 
mubË
 
Ch”tS³ÎšgTabË
 
	m¥–lšg_bË
;

107 
Ch”tRecÜdTabË
 
	m»cÜd_bË
;

110 
FlštLock
 
	mlock
;

114 
	mmax_chªge£ts
;

117 
Ch”tD©aba£Sts
 
	m¡©s
;

122 
boŞ
 
d©aba£_exi¡s
();

127 
ü—‹_ªd_İ’_bËs
(
blocksize
);

134 
İ’_bËs_cÚsi¡’t
();

143 
g‘_d©aba£_wr™e_lock
(
boŞ
 
ü—tšg
);

150 
İ’_bËs
(
ch”t_»visiÚ_numb”_t
 
»visiÚ
);

157 
ch”t_»visiÚ_numb”_t
 
	$g‘_»visiÚ_numb”
() const;

164 
ch”t_»visiÚ_numb”_t
 
	$g‘_Ãxt_»visiÚ_numb”
() const;

176 
	`£t_»visiÚ_numb”
(
ch”t_»visiÚ_numb”_t
 
Ãw_»visiÚ
);

181 
	`»İ’
();

185 
	`şo£
();

192 
	`modifiÿtiÚs_çed
(
ch”t_»visiÚ_numb”_t
 
Şd_»visiÚ
,

193 
ch”t_»visiÚ_numb”_t
 
Ãw_»visiÚ
,

194 cÚ¡ 
¡d
::
¡ršg
 & 
msg
);

204 
	`­¶y
();

208 
	`ÿnûl
();

212 
	`£nd_whŞe_d©aba£
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

213 cÚ¡ 
OmTime
 & 
’d_time
);

217 
	$g‘_chªge£t_»visiÚs
(cÚ¡ 
¡ršg
 & 
·th
,

218 
ch”t_»visiÚ_numb”_t
 * 
¡¬Œev
,

219 
ch”t_»visiÚ_numb”_t
 * 
’d»v
) const;

220 
public
:

240 
	`Ch”tD©aba£
(cÚ¡ 
¡ršg
 &
db_dœ_
, 
aùiÚ
 = 
XAPIAN_DB_READONLY
,

241 
block_size
 = 0u);

243 ~
	`Ch”tD©aba£
();

246 
Ch”tCursÜ
 * 
	$g‘_po¡li¡_cursÜ
() const {

247  
po¡li¡_bË
.
	`cursÜ_g‘
();

252 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

253 
X­Ÿn
::
docid
 
	$g‘_Ï¡docid
() const;

254 
tÙËn_t
 
	$g‘_tÙ®_Ëngth
() const;

255 
X­Ÿn
::
doş’gth
 
	$g‘_avËngth
() const;

256 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

257 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

258 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

259 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
v®no
) const;

260 
¡d
::
¡ršg
 
	`g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

261 
¡d
::
¡ršg
 
	`g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

262 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_low”_bound
() const;

263 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_uµ”_bound
() const;

264 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf_uµ”_bound
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

265 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

266 
boŞ
 
	$has_pos™iÚs
() const;

268 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

269 
V®ueLi¡
 * 
	`İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

270 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`İ’_docum’t
(X­Ÿn::
docid
 
did
, 
boŞ
 
Ïzy
) const;

272 
Pos™iÚLi¡
 * 
	`İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
‹rm
) const;

273 
T”mLi¡
 * 
	`İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const;

274 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

276 
T”mLi¡
 * 
	$İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

277 
T”mLi¡
 * 
	$İ’_¥–lšg_wÜdli¡
() const;

278 
X­Ÿn
::
doccouÁ
 
	$g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

280 
T”mLi¡
 * 
	$İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

281 
T”mLi¡
 * 
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const;

283 
¡ršg
 
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const;

284 
T”mLi¡
 * 
	`İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const;

285 
	`wr™e_chªge£ts_to_fd
(
fd
,

286 cÚ¡ 
¡ršg
 & 
¡¬t_»visiÚ
,

287 
boŞ
 
Ãed_whŞe_db
,

288 
X­Ÿn
::
R•liÿtiÚInfo
 * 
šfo
);

289 
¡ršg
 
	$g‘_»visiÚ_šfo
() const;

290 
¡ršg
 
	$g‘_uuid
() const;

293 
	}
};

297 şas 
	cCh”tWr™abËD©aba£
 : 
public
 
Ch”tD©aba£
 {

299 
mubË
 
m­
<
¡ršg
, 
	m·œ
<
	mX­Ÿn
::
‹rmcouÁ_diff
, Xapian::termcount_diff> >

300 
äeq_d–s
;

303 
mubË
 
	mm­
<
	mX­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> 
doş’s
;

306 
mubË
 
	mm­
<
	m¡ršg
, m­<
	mX­Ÿn
::
docid
,

307 
	m·œ
<, 
	mX­Ÿn
::
‹rmcouÁ
> > > 
mod_¶i¡s
;

309 
mubË
 
	mm­
<
	mX­Ÿn
::
v®u’o
, 
	mV®ueSts
> 
	mv®ue_¡©s
;

314 
mubË
 
	mX­Ÿn
::
doccouÁ
 
chªge_couÁ
;

317 
	mX­Ÿn
::
doccouÁ
 
æush_th»shŞd
;

325 
mubË
 
	mX­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
modify_shÜtcut_docum’t
;

329 
mubË
 
	mX­Ÿn
::
docid
 
modify_shÜtcut_docid
;

332 
	$æush_po¡li¡_chªges
() const;

335 
	`şo£
();

338 
	`­¶y
();

346 
	`add_äeq_d–
(cÚ¡ 
¡ršg
 & 
Šame
,

347 
X­Ÿn
::
‹rmcouÁ_diff
 
tf_d–
,

348 
X­Ÿn
::
‹rmcouÁ_diff
 
cf_d–
);

356 
	`š£¹_mod_¶i¡
(
X­Ÿn
::
docid
 
did
,

357 cÚ¡ 
¡ršg
 & 
Šame
,

358 
X­Ÿn
::
‹rmcouÁ
 
wdf
);

371 
	`upd©e_mod_¶i¡
(
X­Ÿn
::
docid
 
did
,

372 cÚ¡ 
¡ršg
 & 
Šame
,

373 
ty³
,

374 
X­Ÿn
::
‹rmcouÁ
 
wdf
);

380 
	`comm™
();

383 
	`ÿnûl
();

385 
X­Ÿn
::
docid
 
	`add_docum’t
(cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

386 
X­Ÿn
::
docid
 
	`add_docum’t_
(X­Ÿn::docid 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

392 #iâdeà
_MSC_VER


393 
usšg
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
::
d–‘e_docum’t
;

394 
usšg
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
::
»¶aû_docum’t
;

396 
	`d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
);

397 
	`»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

399 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`İ’_docum’t
(X­Ÿn::
docid
 
did
,

400 
boŞ
 
Ïzy
) const;

404 
public
:

416 
	`Ch”tWr™abËD©aba£
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
);

418 ~
	`Ch”tWr™abËD©aba£
();

422 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

423 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

424 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

425 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
v®no
) const;

426 
¡d
::
¡ršg
 
	`g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

427 
¡d
::
¡ršg
 
	`g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

428 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

430 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

431 
V®ueLi¡
 * 
	`İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

432 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

434 
	`add_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const;

435 
	`»move_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const;

436 
T”mLi¡
 * 
	$İ’_¥–lšg_wÜdli¡
() const;

438 
T”mLi¡
 * 
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const;

439 
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
wÜd
, cÚ¡ sŒšg & 
synÚym
) const;

440 
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
wÜd
, cÚ¡ sŒšg & 
synÚym
) const;

441 
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

443 
	`£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
);

444 
	`šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const;

	@backends/chert/chert_databasereplicator.cc

23 
	~<cÚfig.h
>

25 
	~"ch”t_d©aba£»¶iÿtÜ.h
"

27 
	~"x­Ÿn/”rÜ.h
"

29 
	~"ch”t_io.h
"

30 
	~"../æšt_lock.h
"

31 
	~"ch”t_»cÜd.h
"

32 
	~"ch”t_»¶iÿ‹_š‹º®.h
"

33 
	~"ch”t_ty³s.h
"

34 
	~"ch”t_v”siÚ.h
"

35 
	~"omdebug.h
"

36 
	~"omtime.h
"

37 
	~"·ck.h
"

38 
	~"»mÙecÚÃùiÚ.h
"

39 
	~"»¶iÿtiÚ´ÙocŞ.h
"

40 
	~"§ã”ºo.h
"

41 
	~"¡ršguts.h
"

42 
	~"uts.h
"

44 #ifdeà
__WIN32__


45 
	~"msvc_posix_w¿µ”.h
"

48 
	~<c¡dio
>

50 
usšg
 
Çme¥aû
 
	g¡d
;

51 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

53 
	gCh”tD©aba£R•liÿtÜ
::
	$Ch”tD©aba£R•liÿtÜ
(cÚ¡ 
¡ršg
 & 
db_dœ_
)

54 : 
	$db_dœ
(
db_dœ_
)

56 
	}
}

58 
boŞ


59 
Ch”tD©aba£R•liÿtÜ
::
	$check_»visiÚ_©_Ëa¡
(cÚ¡ 
¡ršg
 & 
»v
,

60 cÚ¡ 
¡ršg
 & 
rg‘
) const

62 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertDatabaseReplicator::check_revision_at_least",

63 
»v
 << ", " << 
rg‘
);

65 
ch”t_»visiÚ_numb”_t
 
»v_v®
;

66 
ch”t_»visiÚ_numb”_t
 
rg‘_v®
;

68 cÚ¡ * 
±r
 = 
»v
.
	`d©a
();

69 cÚ¡ * 
’d
 = 
±r
 + 
»v
.
	`size
();

70 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
»v_v®
)) {

71 
throw
 
	`N‘wÜkE¼Ü
("Invalid„evision string suppliedo check_revision_at_least");

74 
±r
 = 
rg‘
.
	`d©a
();

75 
’d
 = 
±r
 + 
rg‘
.
	`size
();

76 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
rg‘_v®
)) {

77 
throw
 
	`N‘wÜkE¼Ü
("Invalid„evision string suppliedo check_revision_at_least");

80 
	`RETURN
(
»v_v®
 >ğ
rg‘_v®
);

81 
	}
}

84 
	gCh”tD©aba£R•liÿtÜ
::
	$´oûss_chªge£t_chunk_ba£
(cÚ¡ 
¡ršg
 & 
bËÇme
,

85 
¡ršg
 & 
buf
,

86 
RemÙeCÚÃùiÚ
 & 
cÚn
,

87 cÚ¡ 
OmTime
 & 
’d_time
) const

89 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

90 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

93 
Ë‰”
 = 
±r
[0];

94 ià(
Ë‰”
 != 'A' &&†etter != 'B')

95 
throw
 
	`N‘wÜkE¼Ü
("Invalid base file†etter in changeset");

96 ++
±r
;

100 ià(
±r
 =ğ
’d
)

101 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (5)");

102 
¡ršg
::
size_ty³
 
ba£_size
;

103 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
ba£_size
))

104 
throw
 
	`N‘wÜkE¼Ü
("Invalid base file size in changeset");

107 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

108 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
ba£_size
, 
’d_time
);

110 ià(
buf
.
	`size
(è< 
ba£_size
)

111 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (6)");

114 
¡ršg
 
tmp_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + "tmp";

115 
¡ršg
 
ba£_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + ".ba£" + 
Ë‰”
;

116 #ifdeà
__WIN32__


117 
fd
 = 
	`msvc_posix_İ’
(
tmp_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

119 
fd
 = ::
	`İ’
(
tmp_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

121 ià(
fd
 == -1) {

122 
¡ršg
 
msg
 = "Failedo open ";

123 
msg
 +ğ
tmp_·th
;

124 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

127 
fdşo£r
 
	`şo£r
(
fd
);

129 
	`ch”t_io_wr™e
(
fd
, 
buf
.
	`d©a
(), 
ba£_size
);

130 
	`ch”t_io_sync
(
fd
);

132 #ià
defšed
 
__WIN32__


133 ià(
	`msvc_posix_»Çme
(
tmp_·th
.
	`c_¡r
(), 
ba£_·th
.c_str()) < 0) {

135 ià(
	`»Çme
(
tmp_·th
.
	`c_¡r
(), 
ba£_·th
.c_str()) < 0) {

142 
§ved_”ºo
 = 
”ºo
;

143 ià(
	`uÆšk
(
tmp_·th
è=ğ0 || 
”ºo
 !ğ
ENOENT
) {

144 
¡ršg
 
	`msg
("Couldn't update base file ");

145 
msg
 +ğ
bËÇme
;

146 
msg
 += ".base";

147 
msg
 +ğ
Ë‰”
;

148 
throw
 
	`D©aba£E¼Ü
(
msg
, 
§ved_”ºo
);

152 
buf
.
	`”a£
(0, 
ba£_size
);

153 
	}
}

156 
	gCh”tD©aba£R•liÿtÜ
::
	$´oûss_chªge£t_chunk_blocks
(cÚ¡ 
¡ršg
 & 
bËÇme
,

157 
¡ršg
 & 
buf
,

158 
RemÙeCÚÃùiÚ
 & 
cÚn
,

159 cÚ¡ 
OmTime
 & 
’d_time
) const

161 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

162 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

164 
chªge£t_blocksize
;

165 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
chªge£t_blocksize
))

166 
throw
 
	`N‘wÜkE¼Ü
("Invalid blocksize in changeset");

167 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

169 
¡ršg
 
db_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + ".DB";

170 #ifdeà
__WIN32__


171 
fd
 = 
	`msvc_posix_İ’
(
db_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_BINARY
);

173 
fd
 = ::
	`İ’
(
db_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_BINARY
, 0666);

175 ià(
fd
 == -1) {

176 
¡ršg
 
msg
 = "Failedo open ";

177 
msg
 +ğ
db_·th
;

178 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

181 
fdşo£r
 
	`şo£r
(
fd
);

183 
Œue
) {

184 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

185 
±r
 = 
buf
.
	`d©a
();

186 
’d
 = 
±r
 + 
buf
.
	`size
();

188 
ušt4
 
block_numb”
;

189 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
block_numb”
))

190 
throw
 
	`N‘wÜkE¼Ü
("Invalid block‚umber in changeset");

191 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

192 ià(
block_numb”
 == 0)

194 --
block_numb”
;

196 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
chªge£t_blocksize
, 
’d_time
);

197 ià(
buf
.
	`size
(è< 
chªge£t_blocksize
)

198 
throw
 
	`N‘wÜkE¼Ü
("Incomplete block in changeset");

202 ià(
	`l£ek
(
fd
, 
	`off_t
(
chªge£t_blocksize
è* 
block_numb”
, 
SEEK_SET
) == -1) {

203 
¡ršg
 
msg
 = "Failedo seeko block ";

204 
msg
 +ğ
	`om_to¡ršg
(
block_numb”
);

205 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

207 
	`ch”t_io_wr™e
(
fd
, 
buf
.
	`d©a
(), 
chªge£t_blocksize
);

209 
buf
.
	`”a£
(0, 
chªge£t_blocksize
);

211 
	`ch”t_io_sync
(
fd
);

213 
	}
}

215 
¡ršg


216 
	gCh”tD©aba£R•liÿtÜ
::
	$­¶y_chªge£t_äom_cÚn
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

217 cÚ¡ 
OmTime
 & 
’d_time
,

218 
boŞ
 
v®id
) const

220 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertDatabaseReplicator::apply_changeset_from_conn",

221 "cÚn,ƒnd_time, " << 
v®id
);

224 
FlštLock
 
	`lock
(
db_dœ
);

225 
¡ršg
 
ex¶ª©iÚ
;

226 
FlštLock
::
»asÚ
 
why
 = 
lock
.
	`lock
(
Œue
, 
ex¶ª©iÚ
);

227 ià(
why
 !ğ
FlštLock
::
SUCCESS
) {

228 
lock
.
	`throw_d©aba£lock”rÜ
(
why
, 
db_dœ
, 
ex¶ª©iÚ
);

231 
ty³
 = 
cÚn
.
	`g‘_mes§ge_chunked
(
’d_time
);

232 (è
ty³
;

233 
	`As£¹Eq
(
ty³
, 
REPL_REPLY_CHANGESET
);

235 
¡ršg
 
buf
;

239 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

241 ià(!
	`¡¬tsw™h
(
buf
, 
CHANGES_MAGIC_STRING
)) {

242 
throw
 
	`N‘wÜkE¼Ü
("Invalid ChangeSet magic string");

244 
buf
.
	`”a£
(0, 12);

245 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

246 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

248 
chªges_v”siÚ
;

249 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
chªges_v”siÚ
))

250 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid version‚umber from changeset");

251 ià(
chªges_v”siÚ
 !ğ
CHANGES_VERSION
)

252 
throw
 
	`N‘wÜkE¼Ü
("Unsupported changeset version");

254 
ch”t_»visiÚ_numb”_t
 
¡¬Œev
;

255 
ch”t_»visiÚ_numb”_t
 
’d»v
;

257 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
¡¬Œev
))

258 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid start„evision from changeset");

259 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
’d»v
))

260 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ validƒnd„evision from changeset");

262 ià(
’d»v
 <ğ
¡¬Œev
)

263 
throw
 
	`N‘wÜkE¼Ü
("End„evision in changeset is‚ot†aterhan start„evision");

265 ià(
±r
 =ğ
’d
)

266 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (1)");

268 ià(
v®id
) {

273 
Ch”tRecÜdTabË
 
	`»cÜd_bË
(
db_dœ
, 
Œue
);

274 
»cÜd_bË
.
	`İ’
();

275 ià(
¡¬Œev
 !ğ
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
())

276 
throw
 
	`N‘wÜkE¼Ü
("Changeset supplied is for wrong„evision‚umber");

279 
chªges_ty³
 = 
±r
[0];

280 ià(
chªges_ty³
 != 0) {

281 
throw
 
	`N‘wÜkE¼Ü
("Unsupported changesetype (got %d)",

282 
chªges_ty³
);

288 
buf
.
	`”a£
(0, 
±r
 + 1 - buf.
	`d©a
());

291 
Œue
) {

292 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

293 
±r
 = 
buf
.
	`d©a
();

294 
’d
 = 
±r
 + 
buf
.
	`size
();

297 ià(
±r
 =ğ
’d
)

298 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (2)");

299 
chunk_ty³
 = 
±r
[0];

300 ++
±r
;

301 ià(
chunk_ty³
 == 0)

305 
¡ršg
 
bËÇme
;

306 ià(!
	`uÅack_¡ršg
(&
±r
, 
’d
, 
bËÇme
))

307 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (3)");

308 ià(
bËÇme
.
	`em±y
())

309 
throw
 
	`N‘wÜkE¼Ü
("Missingablename in changeset");

310 ià(
bËÇme
.
	`fšd_fœ¡_nÙ_of
("abcdefghijklmnopqrstuvwxyz") !=

311 
bËÇme
.
Åos
)

312 
throw
 
	`N‘wÜkE¼Ü
("Invalid character inablename in changeset");

315 ià(
±r
 =ğ
’d
)

316 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (4)");

317 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

319 
chunk_ty³
) {

321 
	`´oûss_chªge£t_chunk_ba£
(
bËÇme
, 
buf
, 
cÚn
, 
’d_time
);

324 
	`´oûss_chªge£t_chunk_blocks
(
bËÇme
, 
buf
, 
cÚn
, 
’d_time
);

327 
throw
 
	`N‘wÜkE¼Ü
("Unrecognised itemype in changeset");

330 
ch”t_»visiÚ_numb”_t
 
»q»v
;

331 ià(!
	`uÅack_ušt
(&
±r
, 
’d
, &
»q»v
))

332 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid„equired„evision from changeset");

333 ià(
»q»v
 < 
’d»v
)

334 
throw
 
	`N‘wÜkE¼Ü
("Required„evision in changeset isƒarlierhanƒnd„evision");

335 ià(
±r
 !ğ
’d
)

336 
throw
 
	`N‘wÜkE¼Ü
("Junk found‡tƒnd of changeset");

338 
buf
.
	`»size
(0);

339 
	`·ck_ušt
(
buf
, 
»q»v
);

340 
	`RETURN
(
buf
);

341 
	}
}

343 
¡ršg


344 
	gCh”tD©aba£R•liÿtÜ
::
	$g‘_uuid
() const

346 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertDatabaseReplicator::get_uuid", "");

347 
Ch”tV”siÚ
 
	`v”siÚ_fe
(
db_dœ
);

348 
Œy
 {

349 
v”siÚ_fe
.
	`»ad_ªd_check
();

350 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
D©aba£E¼Ü
 &) {

351 
	`RETURN
(
	`¡ršg
());

353 
	`RETURN
(
v”siÚ_fe
.
	`g‘_uuid_¡ršg
());

354 
	}
}

	@backends/chert/chert_databasereplicator.h

22 #iâdeà
XAPIAN_INCLUDED_CHERT_DATABASEREPLICATOR_H


23 
	#XAPIAN_INCLUDED_CHERT_DATABASEREPLICATOR_H


	)

25 
	~"d©aba£»¶iÿtÜ.h
"

27 şas 
	cCh”tD©aba£R•liÿtÜ
 : 
public
 
X­Ÿn
::
D©aba£R•liÿtÜ
 {

28 
´iv©e
:

31 
¡d
::
¡ršg
 
db_dœ
;

35 
´oûss_chªge£t_chunk_ba£
(cÚ¡ 
¡d
::
¡ršg
 & 
bËÇme
,

36 
¡d
::
¡ršg
 & 
buf
,

37 
RemÙeCÚÃùiÚ
 & 
cÚn
,

38 cÚ¡ 
OmTime
 & 
’d_time
) const;

43 
´oûss_chªge£t_chunk_blocks
(cÚ¡ 
¡d
::
¡ršg
 & 
bËÇme
,

44 
¡d
::
¡ršg
 & 
buf
,

45 
RemÙeCÚÃùiÚ
 & 
cÚn
,

46 cÚ¡ 
OmTime
 & 
’d_time
) const;

48 
	mpublic
:

49 
Ch”tD©aba£R•liÿtÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
db_dœ_
);

53 
boŞ
 
check_»visiÚ_©_Ëa¡
(cÚ¡ 
¡d
::
¡ršg
 & 
»v
,

54 cÚ¡ 
¡d
::
¡ršg
 & 
rg‘
) const;

55 
	m¡d
::
¡ršg
 
	$­¶y_chªge£t_äom_cÚn
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

56 cÚ¡ 
OmTime
 & 
’d_time
,

57 
boŞ
 
v®id
) const;

58 
¡d
::
¡ršg
 
	$g‘_uuid
() const;

	@backends/chert/chert_dbstats.cc

21 
	~<cÚfig.h
>

23 
	~"ch”t_db¡©s.h
"

25 
	~"ch”t_po¡li¡.h
"

27 
usšg
 
Çme¥aû
 
	g¡d
;

30 cÚ¡ 
¡ršg
 
DATABASE_STATS_KEY
(1, '\0');

33 
	gCh”tD©aba£Sts
::
	$»ad
(
Ch”tPo¡Li¡TabË
 & 
po¡li¡_bË
)

35 
¡ršg
 
d©a
;

36 ià(!
po¡li¡_bË
.
	`g‘_exaù_’Œy
(
DATABASE_STATS_KEY
, 
d©a
)) {

38 
tÙ®_doş’
 = 0;

39 
Ï¡_docid
 = 0;

40 
doş’_lbound
 = 0;

41 
doş’_ubound
 = 0;

42 
wdf_ubound
 = 0;

46 cÚ¡ * 
p
 = 
d©a
.
	`d©a
();

47 cÚ¡ * 
’d
 = 
p
 + 
d©a
.
	`size
();

49 ià(
	`uÅack_ušt
(&
p
, 
’d
, &
Ï¡_docid
) &&

50 
	`uÅack_ušt
(&
p
, 
’d
, &
doş’_lbound
) &&

51 
	`uÅack_ušt
(&
p
, 
’d
, &
wdf_ubound
) &&

52 
	`uÅack_ušt
(&
p
, 
’d
, &
doş’_ubound
) &&

53 
	`uÅack_ušt_Ï¡
(&
p
, 
’d
, &
tÙ®_doş’
)) {

57 
doş’_ubound
 +ğ
wdf_ubound
;

61 ià(
p
)

62 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Badƒncoded DB stats (overflowed)");

64 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Badƒncoded DB stats (out of data)");

65 
	}
}

68 
	gCh”tD©aba£Sts
::
	$wr™e
(
Ch”tPo¡Li¡TabË
 & 
po¡li¡_bË
) const

70 
¡ršg
 
d©a
;

71 
	`·ck_ušt
(
d©a
, 
Ï¡_docid
);

72 
	`·ck_ušt
(
d©a
, 
doş’_lbound
);

73 
	`·ck_ušt
(
d©a
, 
wdf_ubound
);

77 
	`·ck_ušt
(
d©a
, 
doş’_ubound
 - 
wdf_ubound
);

81 
	`·ck_ušt_Ï¡
(
d©a
, 
tÙ®_doş’
);

82 
po¡li¡_bË
.
	`add
(
DATABASE_STATS_KEY
, 
d©a
);

83 
	}
}

	@backends/chert/chert_dbstats.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_DBSTATS_H


22 
	#XAPIAN_INCLUDED_CHERT_DBSTATS_H


	)

24 
	~"ch”t_ty³s.h
"

25 
	~"x­Ÿn/ty³s.h
"

27 
	~"š‹º®ty³s.h
"

29 
	~"omdebug.h
"

31 
şass
 
	gCh”tPo¡Li¡TabË
;

34 şas 
	cCh”tD©aba£Sts
 {

36 
	mİ”©Ü
=(cÚ¡ 
Ch”tD©aba£Sts
 &);

39 
Ch”tD©aba£Sts
(const ChertDatabaseStats &);

42 
tÙËn_t
 
	mtÙ®_doş’
;

45 
	mX­Ÿn
::
docid
 
Ï¡_docid
;

48 
	mX­Ÿn
::
‹rmcouÁ
 
doş’_lbound
;

51 
	mX­Ÿn
::
‹rmcouÁ
 
doş’_ubound
;

54 
	mX­Ÿn
::
‹rmcouÁ
 
wdf_ubound
;

56 
	mpublic
:

57 
	$Ch”tD©aba£Sts
()

58 : 
	`tÙ®_doş’
(0), 
	`Ï¡_docid
(0), 
	`doş’_lbound
(0), 
	`doş’_ubound
(0),

59 
	$wdf_ubound
(0) { }

61 
tÙËn_t
 
	$g‘_tÙ®_doş’
(ècÚ¡ {  
tÙ®_doş’
; 
	}
}

63 
	gX­Ÿn
::
docid
 
	$g‘_Ï¡_docid
(ècÚ¡ {  
Ï¡_docid
; 
	}
}

65 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_low”_bound
() const {

66  
doş’_lbound
;

67 
	}
}

69 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_uµ”_bound
() const {

70  
doş’_ubound
;

71 
	}
}

73 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf_uµ”_bound
(ècÚ¡ {  
wdf_ubound
; 
	}
}

75 
	$z”o
() {

76 
tÙ®_doş’
 = 0;

77 
Ï¡_docid
 = 0;

78 
doş’_lbound
 = 0;

79 
doş’_ubound
 = 0;

80 
wdf_ubound
 = 0;

81 
	}
}

83 
»ad
(
Ch”tPo¡Li¡TabË
 & 
po¡li¡_bË
);

85 
£t_Ï¡_docid
(
X­Ÿn
::
docid
 
did
è{ 
Ï¡_docid
 = did; }

87 
add_docum’t
(
X­Ÿn
::
‹rmcouÁ
 
doş’
) {

88 
LOGLINE
(
DB
, "Add doş’: " << 
doş’
 << "o chert db stats");

89 ià(
	gtÙ®_doş’
 =ğ0 || (
doş’
 && doş’ < 
doş’_lbound
))

90 
doş’_lbound
 = 
doş’
;

91 ià(
	gdoş’
 > 
	gdoş’_ubound
)

92 
	gdoş’_ubound
 = 
doş’
;

93 
	gtÙ®_doş’
 +ğ
doş’
;

96 
d–‘e_docum’t
(
X­Ÿn
::
‹rmcouÁ
 
doş’
) {

97 
tÙ®_doş’
 -ğ
doş’
;

100 ià(
	gtÙ®_doş’
 == 0) {

101 
doş’_lbound
 = 0;

102 
	gdoş’_ubound
 = 0;

103 
	gwdf_ubound
 = 0;

107 
check_wdf
(
X­Ÿn
::
‹rmcouÁ
 
wdf
) {

108 ià(
wdf
 > 
wdf_ubound
) wdf_ubound = wdf;

111 
	gX­Ÿn
::
docid
 
	$g‘_Ãxt_docid
(è{  ++
Ï¡_docid
; 
	}
}

113 
	$wr™e
(
Ch”tPo¡Li¡TabË
 & 
po¡li¡_bË
) const;

114 
	}
};

	@backends/chert/chert_document.cc

23 
	~<cÚfig.h
>

25 
	~"ch”t_docum’t.h
"

27 
	~"omdebug.h
"

28 
	~"ch”t_d©aba£.h
"

29 
	~"ch”t_v®ues.h
"

30 
	~"ch”t_»cÜd.h
"

36 
¡ršg


37 
	gCh”tDocum’t
::
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

39 
DEBUGCALL
(
DB
, 
¡ršg
, "Ch”tDocum’t::do_g‘_v®ue", 
¦Ù
);

40 
RETURN
(
v®ue_mªag”
->
g‘_v®ue
(
did
, 
¦Ù
));

46 
	gCh”tDocum’t
::
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const

48 
DEBUGCALL
(
DB
, , "ChertDocument::do_get_all_values", "[values_]");

49 
	gv®ue_mªag”
->
g‘_®l_v®ues
(
v®ues_
, 
did
);

54 
¡ršg


55 
	gCh”tDocum’t
::
	$do_g‘_d©a
() const

57 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertDocument::do_get_data", "");

58 
	`RETURN
(
»cÜd_bË
->
	`g‘_»cÜd
(
did
));

59 
	}
}

	@backends/chert/chert_document.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_DOCUMENT_H


22 
	#XAPIAN_INCLUDED_CHERT_DOCUMENT_H


	)

24 
	~"ch”t_»cÜd.h
"

25 
	~"ch”t_v®ues.h
"

26 
	~"d©aba£.h
"

27 
	~"docum’t.h
"

30 şas 
	cCh”tDocum’t
 : 
public
 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 {

32 
İ”©Ü
=(cÚ¡ 
Ch”tDocum’t
 &);

35 
Ch”tDocum’t
(const ChertDocument &);

38 cÚ¡ 
Ch”tV®ueMªag”
 *
	mv®ue_mªag”
;

41 cÚ¡ 
Ch”tRecÜdTabË
 *
	m»cÜd_bË
;

44 
ä›nd
 
şass
 
	mCh”tD©aba£
;

47 
Ch”tDocum’t
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
db
,

48 
X­Ÿn
::
docid
 
did_
,

49 cÚ¡ 
Ch”tV®ueMªag”
 *
v®ue_mªag”_
,

50 cÚ¡ 
Ch”tRecÜdTabË
 *
»cÜd_bË_
)

51 : 
X­Ÿn
::
Docum’t
::
IÁ”Çl
(
db
, 
did_
),

52 
v®ue_mªag”
(
v®ue_mªag”_
), 
	$»cÜd_bË
(
»cÜd_bË_
) { }

54 
public
:

56 
¡ršg
 
	`do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

57 
	`do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const;

58 
¡ršg
 
	$do_g‘_d©a
() const;

60 
	}
};

	@backends/chert/chert_io.cc

21 
	~<cÚfig.h
>

23 
	~"§ã”ºo.h
"

24 
	~"§ãuni¡d.h
"

26 
	~<x­Ÿn/”rÜ.h
>

28 
	~"ch”t_io.h
"

30 
	~"omdebug.h
"

32 
size_t
 
	$ch”t_io_»ad
(
fd
, * 
p
, 
size_t
 
n
, size_ˆ
mš
)

34 
size_t
 
tÙ®
 = 0;

35 
n
) {

36 
ssize_t
 
c
 = 
	`»ad
(
fd
, 
p
, 
n
);

37 ià(
c
 <= 0) {

38 ià(
c
 == 0) {

39 ià(
tÙ®
 >ğ
mš
) ;

40 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„eadƒnough (EOF)");

42 ià(
”ºo
 =ğ
EINTR
) ;

43 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("E¼Ü„—dšg from fe", 
”ºo
);

45 
p
 +ğ
c
;

46 
tÙ®
 +ğ
c
;

47 
n
 -ğ
c
;

49  
tÙ®
;

50 
	}
}

53 
	$ch”t_io_wr™e
(
fd
, cÚ¡ * 
p
, 
size_t
 
n
)

55 
	`LOGLINE
(
DB
, "Write‚ bytes from block…ointedo by…");

56 
n
) {

57 
ssize_t
 
c
 = 
	`wr™e
(
fd
, 
p
, 
n
);

58 ià(
c
 < 0) {

59 ià(
”ºo
 =ğ
EINTR
) ;

60 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("E¼Ü wr™šgØfe", 
”ºo
);

62 
p
 +ğ
c
;

63 
n
 -ğ
c
;

65 
	}
}

	@backends/chert/chert_io.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_IO_H


22 
	#XAPIAN_INCLUDED_CHERT_IO_H


	)

24 
	~<sys/ty³s.h
>

25 
	~"§ãfú.h
"

26 
	~"§ãuni¡d.h
"

33 
šlše
 
boŞ
 
	$ch”t_io_sync
(
fd
)

35 #ifdeà
F_FULLFSYNC


46 ià(
	`fú
(
fd
, 
F_FULLFSYNC
, 0) == 0)

47  
Œue
;

50 #ià
defšed
 
HAVE_FDATASYNC


53  
	`fd©async
(
fd
) == 0;

54 #–ià
defšed
 
HAVE_FSYNC


55  
	`fsync
(
fd
) == 0;

56 #–ià
defšed
 
__WIN32__


57  
	`_comm™
(
fd
) == 0;

59 #”rÜ 
CªnÙ
 
im¶em’t
 
	`ch”t_io_sync
(è
w™hout
 
	`fd©async
(), 
	`fsync
(), 
Ü
 
	`_comm™
()

61 
	}
}

70 
size_t
 
ch”t_io_»ad
(
fd
, * 
p
, size_ˆ
n
, size_ˆ
mš
);

73 
ch”t_io_wr™e
(
fd
, cÚ¡ * 
p
, 
size_t
 
n
);

	@backends/chert/chert_lazytable.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_LAZYTABLE_H


22 
	#XAPIAN_INCLUDED_CHERT_LAZYTABLE_H


	)

24 
	~"ch”t_bË.h
"

26 şas 
	cCh”tLazyTabË
 : 
public
 
Ch”tTabË
 {

27 
public
:

35 
Ch”tLazyTabË
(cÚ¡ * 
Çme_
, cÚ¡ 
¡d
::
¡ršg
 & 
·th
, 
boŞ
 
»adÚly
,

36 
z_¡¿‹gy
)

37 : 
	$Ch”tTabË
(
Çme_
, 
·th
, 
»adÚly
, 
z_¡¿‹gy
, 
Œue
) { }

44 
	$ü—‹_ªd_İ’
(
blocksize
) {

47 
Ch”tTabË
::
	`”a£
();

48 
Ch”tTabË
::
	`£t_block_size
(
blocksize
);

49 
	}
}

	@backends/chert/chert_metadata.cc

22 
	~<cÚfig.h
>

23 
	~"ch”t_m‘ad©a.h
"

25 
	~"d©aba£.h
"

26 
	~"omas£¹.h
"

27 
	~"¡ršguts.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
	gCh”tM‘ad©aT”mLi¡
::
Ch”tM‘ad©aT”mLi¡
(

32 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

33 
Ch”tCursÜ
 * 
cursÜ_
,

34 cÚ¡ 
¡ršg
 &
´efix_
)

35 : 
d©aba£
(
d©aba£_
), 
cursÜ
(
cursÜ_
), 
´efix
(
¡ršg
("\x00\xc0", 2è+ 
´efix_
)

37 
DEBUGCALL
(
DB
, , "ChertMetadataTermList", "<database>, <cursor>");

38 
As£¹
(
cursÜ
);

40 
	gcursÜ
->
fšd_’Œy_É
(
´efix
);

43 
	gCh”tM‘ad©aT”mLi¡
::~
	$Ch”tM‘ad©aT”mLi¡
()

45 
	`DEBUGCALL
(
DB
, , "~ChertMetadataTermList", "");

46 
d–‘e
 
cursÜ
;

47 
	}
}

49 
¡ršg


50 
	gCh”tM‘ad©aT”mLi¡
::
	$g‘_‹rmÇme
() const

52 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertMetadataTermList::get_termname", "");

53 
	`As£¹
(!
	`©_’d
());

54 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

55 
	`As£¹
(
	`¡¬tsw™h
(
cursÜ
->
cu¼’t_key
, 
´efix
));

56 
	`RETURN
(
cursÜ
->
cu¼’t_key
.
	`sub¡r
(2));

57 
	}
}

59 
	gX­Ÿn
::
doccouÁ


60 
Ch”tM‘ad©aT”mLi¡
::
	$g‘_‹rmäeq
() const

62 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("ChertMetadataTermList::get_termfreq()‚ot meaningful");

63 
	}
}

65 
	gX­Ÿn
::
‹rmcouÁ


66 
Ch”tM‘ad©aT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

68 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("ChertMetadataTermList::get_collection_freq()‚ot meaningful");

69 
	}
}

71 
T”mLi¡
 *

72 
	gCh”tM‘ad©aT”mLi¡
::
	$Ãxt
()

74 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "ChertMetadataTermList::next", "");

75 
	`As£¹
(!
	`©_’d
());

77 
cursÜ
->
	`Ãxt
();

78 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

80 
cursÜ
->
	`to_’d
();

83 
	`RETURN
(
NULL
);

84 
	}
}

86 
T”mLi¡
 *

87 
	gCh”tM‘ad©aT”mLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
key
)

89 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "Ch”tM‘ad©aT”mLi¡::sk_to", 
key
);

90 
	`As£¹
(!
	`©_’d
());

92 ià(!
cursÜ
->
	`fšd_’Œy_ge
(
	`¡ršg
("\x00\xc0", 2è+ 
key
)) {

95 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

97 
cursÜ
->
	`to_’d
();

100 
	`RETURN
(
NULL
);

101 
	}
}

103 
boŞ


104 
	gCh”tM‘ad©aT”mLi¡
::
	$©_’d
() const

106 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertMetadataTermList::at_end", "");

107 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

108 
	}
}

	@backends/chert/chert_metadata.h

22 #iâdeà
XAPIAN_INCLUDED_CHERT_METADATA_H


23 
	#XAPIAN_INCLUDED_CHERT_METADATA_H


	)

25 
	~<x­Ÿn/ba£.h
>

26 
	~<x­Ÿn/d©aba£.h
>

27 
	~<x­Ÿn/ty³s.h
>

29 
	~"®É”m¦i¡.h
"

30 
	~"ch”t_bË.h
"

31 
	~"omdebug.h
"

32 
	~"‹rmli¡.h
"

34 
	~<¡ršg
>

36 
şass
 
	gCh”tCursÜ
;

38 şas 
	cCh”tM‘ad©aT”mLi¡
 : 
public
 
AÎT”msLi¡
 {

40 
Ch”tM‘ad©aT”mLi¡
(const ChertMetadataTermList &);

43 
	mİ”©Ü
=(cÚ¡ 
Ch”tM‘ad©aT”mLi¡
 &);

46 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

50 
Ch”tCursÜ
 * 
	mcursÜ
;

54 
	m¡d
::
¡ršg
 
´efix
;

56 
	mpublic
:

57 
Ch”tM‘ad©aT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

58 
Ch”tCursÜ
 * 
cursÜ_
, cÚ¡ 
¡d
::
¡ršg
 &
´efix_
);

60 ~
Ch”tM‘ad©aT”mLi¡
();

67 
	m¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

73 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

79 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

82 
T”mLi¡
 * 
	`Ãxt
();

85 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
key
);

88 
boŞ
 
	$©_’d
() const;

	@backends/chert/chert_modifiedpostlist.cc

21 
	~<cÚfig.h
>

23 
	~"ch”t_d©aba£.h
"

24 
	~"ch”t_modif›dpo¡li¡.h
"

26 
	gCh”tModif›dPo¡Li¡
::~
	$Ch”tModif›dPo¡Li¡
()

28 
d–‘e
 
po¦i¡
;

29 
	}
}

32 
	gCh”tModif›dPo¡Li¡
::
sk_d–‘es
(
X­Ÿn
::
weight
 
w_mš
)

34 !
Ch”tPo¡Li¡
::
©_’d
()) {

35 
™
 !ğ
mods
.
’d
(è&& it->
£cÚd
.
fœ¡
 == 'D' &&

36 
™
->
fœ¡
 < 
Ch”tPo¡Li¡
::
g‘_docid
())

37 ++
™
;

38 ià(
	g™
 =ğ
mods
.
’d
()) ;

39 ià(
	g™
->
	gfœ¡
 !ğ
Ch”tPo¡Li¡
::
g‘_docid
()) ;

40 ià(
	g™
->
	g£cÚd
.
	gfœ¡
 != 'D') ;

41 ++
	g™
;

42 
	gCh”tPo¡Li¡
::
Ãxt
(
w_mš
);

44 
	g™
 !ğ
mods
.
’d
(è&& 
™
->
£cÚd
.
fœ¡
 == 'D') ++it;

47 
	gX­Ÿn
::
doccouÁ


48 
Ch”tModif›dPo¡Li¡
::
	$g‘_‹rmäeq
() const

50  
this_db
->
	`g‘_‹rmäeq
(
‹rm
);

51 
	}
}

53 
	gX­Ÿn
::
docid


54 
Ch”tModif›dPo¡Li¡
::
	$g‘_docid
() const

56 ià(
™
 =ğ
mods
.
	`’d
()è 
Ch”tPo¡Li¡
::
	`g‘_docid
();

57 ià(
Ch”tPo¡Li¡
::
	`©_’d
()è 
™
->
fœ¡
;

58 
	`As£¹
(
™
->
£cÚd
.
fœ¡
 != 'D');

59  
	`mš
(
™
->
fœ¡
, 
Ch”tPo¡Li¡
::
	`g‘_docid
());

60 
	}
}

62 
	gX­Ÿn
::
‹rmcouÁ


63 
Ch”tModif›dPo¡Li¡
::
	$g‘_doş’gth
() const

65 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertModifiedPostList::get_doclength", "");

66 ià(
™
 !ğ
mods
.
	`’d
(è&& (
Ch”tPo¡Li¡
::
	`©_’d
(è|| it->
fœ¡
 <ğCh”tPo¡Li¡::
	`g‘_docid
()))

67 
	`RETURN
(
this_db
->
	`g‘_doş’gth
(
™
->
fœ¡
));

68 
	`RETURN
(
Ch”tPo¡Li¡
::
	`g‘_doş’gth
());

69 
	}
}

71 
	gX­Ÿn
::
‹rmcouÁ


72 
Ch”tModif›dPo¡Li¡
::
	$g‘_wdf
() const

74 ià(
Ch”tPo¡Li¡
::
	`©_’d
()è 
™
->
£cÚd
.second;

75 
X­Ÿn
::
docid
 
unmod_did
 = 
Ch”tPo¡Li¡
::
	`g‘_docid
();

76 ià(
™
 !ğ
mods
.
	`’d
(è&& it->
fœ¡
 <ğ
unmod_did
) {

77 ià(
™
->
fœ¡
 < 
unmod_did
è it->
£cÚd
.second;

78  
™
->
£cÚd
.second;

80  
Ch”tPo¡Li¡
::
	`g‘_wdf
();

81 
	}
}

83 
Pos™iÚLi¡
 *

84 
	gCh”tModif›dPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

86 ià(
™
 !ğ
mods
.
	`’d
(è&& (
Ch”tPo¡Li¡
::
	`©_’d
(è|| it->
fœ¡
 <ğCh”tPo¡Li¡::
	`g‘_docid
())) {

87 ià(
po¦i¡
) {

88 
d–‘e
 
po¦i¡
;

89 
po¦i¡
 = 
NULL
;

91 
po¦i¡
 = 
this_db
->
	`İ’_pos™iÚ_li¡
(
™
->
fœ¡
, 
‹rm
);

92  
po¦i¡
;

94  
Ch”tPo¡Li¡
::
	`»ad_pos™iÚ_li¡
();

95 
	}
}

97 
Pos™iÚLi¡
 *

98 
	gCh”tModif›dPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

100 ià(
™
 !ğ
mods
.
	`’d
(è&& (
Ch”tPo¡Li¡
::
	`©_’d
(è|| it->
fœ¡
 <ğCh”tPo¡Li¡::
	`g‘_docid
())) {

101  
this_db
->
	`İ’_pos™iÚ_li¡
(
™
->
fœ¡
, 
‹rm
);

103  
Ch”tPo¡Li¡
::
	`İ’_pos™iÚ_li¡
();

104 
	}
}

106 
Po¡Li¡
 *

107 
	gCh”tModif›dPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

109 ià(
have_¡¬‹d
) {

110 ià(
Ch”tPo¡Li¡
::
©_’d
()) {

111 ++
™
;

112 
sk_d–‘es
(
w_mš
);

113  
	gNULL
;

115 
	gX­Ÿn
::
docid
 
unmod_did
 = 
Ch”tPo¡Li¡
::
g‘_docid
();

116 ià(
	g™
 !ğ
mods
.
’d
(è&& 
™
->
fœ¡
 <ğ
unmod_did
) {

117 ià(
™
->
fœ¡
 < 
unmod_did
 && it->
£cÚd
.first != 'D') {

118 ++
™
;

119 
sk_d–‘es
(
w_mš
);

120  
	gNULL
;

122 ++
	g™
;

125 
	gCh”tPo¡Li¡
::
Ãxt
(
w_mš
);

126 
sk_d–‘es
(
w_mš
);

127  
	gNULL
;

130 
Po¡Li¡
 *

131 
	gCh”tModif›dPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
)

133 ià(!
Ch”tPo¡Li¡
::
©_’d
()èCh”tPo¡Li¡::
sk_to
(
desœed_did
, 
w_mš
);

135 
	g™
 !ğ
mods
.
’d
(è&& 
™
->
fœ¡
 < 
desœed_did
) ++it;

136 
sk_d–‘es
(
w_mš
);

137  
	gNULL
;

140 
boŞ


141 
	gCh”tModif›dPo¡Li¡
::
	$©_’d
() const {

142  
™
 =ğ
mods
.
	`’d
(è&& 
Ch”tPo¡Li¡
::
	`©_’d
();

143 
	}
}

145 
	g¡d
::
¡ršg


146 
Ch”tModif›dPo¡Li¡
::
	$g‘_desütiÚ
() const

148 
¡d
::
¡ršg
 
desc
 = "ChertModifiedPostList(";

149 
desc
 +ğ
Ch”tPo¡Li¡
::
	`g‘_desütiÚ
();

150 
desc
 += ')';

151  
desc
;

152 
	}
}

	@backends/chert/chert_modifiedpostlist.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_MODIFIEDPOSTLIST_H


22 
	#XAPIAN_INCLUDED_CHERT_MODIFIEDPOSTLIST_H


	)

24 
	~<m­
>

25 
	~<¡ršg
>

27 
usšg
 
Çme¥aû
 
	g¡d
;

29 
	~"ch”t_po¡li¡.h
"

31 şas 
	cCh”tModif›dPo¡Li¡
 : 
public
 
Ch”tPo¡Li¡
 {

34 
m­
<
X­Ÿn
::
docid
, 
	m·œ
<, 
	mX­Ÿn
::
‹rmcouÁ
> > 
mods
;

35 
	mm­
<
	mX­Ÿn
::
docid
, 
	m·œ
<, X­Ÿn::
‹rmcouÁ
> >::
cÚ¡_™”©Ü
 
™
;

39 
Pos™iÚLi¡
 * 
	mpo¦i¡
;

42 
sk_d–‘es
(
X­Ÿn
::
weight
 
w_mš
);

44 
	mpublic
:

46 
Ch”tModif›dPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
this_db_
,

47 cÚ¡ 
¡ršg
 & 
‹rm_
,

48 cÚ¡ 
m­
<
X­Ÿn
::
docid
, 
·œ
<, X­Ÿn::
‹rmcouÁ
> > & 
mods_
)

49 : 
Ch”tPo¡Li¡
(
this_db_
, 
‹rm_
, 
Œue
),

50 
mods
(
mods_
), 
™
(mods.
begš
()), 
	$po¦i¡
(0)

53 ~
	`Ch”tModif›dPo¡Li¡
();

55 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

57 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

59 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

61 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

63 
Pos™iÚLi¡
 *
	`»ad_pos™iÚ_li¡
();

65 
Pos™iÚLi¡
 *
	$İ’_pos™iÚ_li¡
() const;

67 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

69 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
);

71 
boŞ
 
	$©_’d
() const;

73 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

74 
	}
};

	@backends/chert/chert_positionlist.cc

21 
	~<cÚfig.h
>

23 
	~"ch”t_pos™iÚli¡.h
"

25 
	~<x­Ÿn/ty³s.h
>

27 
	~"b™¡»am.h
"

28 
	~"omdebug.h
"

29 
	~"·ck.h
"

31 
	~<¡ršg
>

32 
	~<veùÜ
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	gCh”tPos™iÚLi¡TabË
::
£t_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
,

38 cÚ¡ 
¡ršg
 & 
Šame
,

39 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos
,

40 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 &
pos_’d
)

42 
DEBUGCALL
(
DB
, , "ChertPositionList::set_positionlist",

43 
did
 << ", " << 
Šame
 << ", " << 
pos
 << ", " << 
pos_’d
);

44 
As£¹
(
pos
 !ğ
pos_’d
);

47 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
> 
poscİy
(
pos
, 
pos_’d
);

49 
¡ršg
 
	gkey
 = 
make_key
(
did
, 
Šame
);

51 
¡ršg
 
	gs
;

52 
·ck_ušt
(
s
, 
poscİy
.
back
());

54 ià(
	gposcİy
.
size
() == 1) {

56 
add
(
key
, 
s
);

60 
B™Wr™”
 
wr
(
s
);

61 
	gwr
.
’code
(
poscİy
[0],…oscİy.
back
());

62 
	gwr
.
’code
(
poscİy
.
size
(è- 2,…oscİy.
back
() -…oscopy[0]);

63 
	gwr
.
’code_š‹½Ş©ive
(
poscİy
, 0,…oscİy.
size
() - 1);

64 
add
(
key
, 
wr
.
ä“ze
());

67 
	gX­Ÿn
::
‹rmcouÁ


68 
Ch”tPos™iÚLi¡TabË
::
pos™iÚli¡_couÁ
(
X­Ÿn
::
docid
 
did
,

69 cÚ¡ 
¡ršg
 & 
‹rm
) const

71 
DEBUGCALL
(
DB
, , "ChertPositionListTable::positionlist_count",

72 
did
 << ", " << 
‹rm
);

74 
¡ršg
 
	gd©a
;

75 ià(!
g‘_exaù_’Œy
(
make_key
(
did
, 
‹rm
), 
d©a
)) {

80 cÚ¡ * 
	gpos
 = 
d©a
.data();

81 cÚ¡ * 
	g’d
 = 
pos
 + 
d©a
.
size
();

82 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

83 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

84 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Position†ist data corrupt");

86 ià(
	gpos
 =ğ
’d
) {

92 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

93 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

94 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

95  
	gpos_size
;

100 
boŞ


101 
	gCh”tPos™iÚLi¡
::
»ad_d©a
(cÚ¡ 
Ch”tTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

102 cÚ¡ 
¡ršg
 & 
Šame
)

104 
DEBUGCALL
(
DB
, , "ChertPositionList::read_data",

105 
bË
 << ", " << 
did
 << ", " << 
Šame
);

107 
	ghave_¡¬‹d
 = 
çl£
;

108 
	gpos™iÚs
.
ş—r
();

110 
¡ršg
 
	gd©a
;

111 ià(!
	gbË
->
g‘_exaù_’Œy
(
Ch”tPos™iÚLi¡TabË
::
make_key
(
did
, 
Šame
), 
d©a
)) {

113 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

114  
	gçl£
;

117 cÚ¡ * 
	gpos
 = 
d©a
.data();

118 cÚ¡ * 
	g’d
 = 
pos
 + 
d©a
.
size
();

119 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

120 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

121 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Position†ist data corrupt");

123 ià(
	gpos
 =ğ
’d
) {

125 
pos™iÚs
.
push_back
(
pos_Ï¡
);

126 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

127  
	gŒue
;

130 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

131 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

132 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

133 
	gpos™iÚs
.
»size
(
pos_size
);

134 
	gpos™iÚs
[0] = 
pos_fœ¡
;

135 
	gpos™iÚs
.
back
(èğ
pos_Ï¡
;

136 
	grd
.
decode_š‹½Ş©ive
(
pos™iÚs
, 0, 
pos_size
 - 1);

138 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

139  
	gŒue
;

142 
	gX­Ÿn
::
‹rmcouÁ


143 
Ch”tPos™iÚLi¡
::
	$g‘_size
() const

145 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertPositionList::get_size", "");

146 
	`RETURN
(
pos™iÚs
.
	`size
());

147 
	}
}

149 
	gX­Ÿn
::
‹rmpos


150 
Ch”tPos™iÚLi¡
::
	$g‘_pos™iÚ
() const

152 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmpos
, "ChertPositionList::get_position", "");

153 
	`As£¹
(
have_¡¬‹d
);

154 
	`RETURN
(*
cu¼’t_pos
);

155 
	}
}

158 
	gCh”tPos™iÚLi¡
::
	$Ãxt
()

160 
	`DEBUGCALL
(
DB
, , "ChertPositionList::next", "");

162 ià(!
have_¡¬‹d
) {

163 
have_¡¬‹d
 = 
Œue
;

165 
	`As£¹
(!
	`©_’d
());

166 ++
cu¼’t_pos
;

168 
	}
}

171 
	gCh”tPos™iÚLi¡
::
sk_to
(
X­Ÿn
::
‹rmpos
ermpos)

173 
DEBUGCALL
(
DB
, , "Ch”tPos™iÚLi¡::sk_to", 
‹rmpos
);

174 ià(!
	ghave_¡¬‹d
) {

175 
	ghave_¡¬‹d
 = 
Œue
;

177 !
©_’d
(è&& *
	gcu¼’t_pos
 < 
	g‹rmpos
) ++current_pos;

180 
boŞ


181 
	gCh”tPos™iÚLi¡
::
	$©_’d
() const

183 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertPositionList::at_end", "");

184 
	`RETURN
(
cu¼’t_pos
 =ğ
pos™iÚs
.
	`’d
());

185 
	}
}

	@backends/chert/chert_positionlist.h

21 #iâdeà
XAPIAN_HGUARD_CHERT_POSITIONLIST_H


22 
	#XAPIAN_HGUARD_CHERT_POSITIONLIST_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"ch”t_ÏzybË.h
"

27 
	~"·ck.h
"

28 
	~"pos™iÚli¡.h
"

30 
	~<¡ršg
>

31 
	~<veùÜ
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 şas 
	cCh”tPos™iÚLi¡TabË
 : 
public
 
Ch”tLazyTabË
 {

36 
public
:

37 
¡ršg
 
make_key
(
X­Ÿn
::
docid
 
did
, cÚ¡ sŒšg & 
‹rm
) {

38 
¡ršg
 
	mkey
;

39 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

40 
	mkey
 +ğ
‹rm
;

41  
	mkey
;

52 
	$Ch”tPos™iÚLi¡TabË
(cÚ¡ 
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

53 : 
	`Ch”tLazyTabË
("pos™iÚ", 
dbdœ
 + "/pos™iÚ.", 
»adÚly
,

54 
DONT_COMPRESS
è{ 
	}
}

57 
£t_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
Šame
,

58 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos
,

59 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 &
pos_’d
);

62 
d–‘e_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
Šame
) {

63 
d–
(
make_key
(
did
, 
Šame
));

67 
	gX­Ÿn
::
‹rmcouÁ
 
pos™iÚli¡_couÁ
(
X­Ÿn
::
docid
 
did
,

68 cÚ¡ 
¡ršg
 & 
‹rm
) const;

72 şas 
	cCh”tPos™iÚLi¡
 : 
public
 
Pos™iÚLi¡
 {

74 
veùÜ
<
X­Ÿn
::
‹rmpos
> 
pos™iÚs
;

77 
	mveùÜ
<
	mX­Ÿn
::
‹rmpos
>::
cÚ¡_™”©Ü
 
cu¼’t_pos
;

80 
boŞ
 
	mhave_¡¬‹d
;

83 
Ãxt_š‹º®
();

86 
Ch”tPos™iÚLi¡
(const ChertPositionList &);

89 
	mİ”©Ü
=(cÚ¡ 
Ch”tPos™iÚLi¡
 &);

91 
	mpublic
:

93 
	$Ch”tPos™iÚLi¡
(è: 
	$have_¡¬‹d
(
çl£
) {}

96 
	`Ch”tPos™iÚLi¡
(cÚ¡ 
Ch”tTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

97 cÚ¡ 
¡ršg
 & 
Šame
) {

98 ()
	`»ad_d©a
(
bË
, 
did
, 
Šame
);

99 
	}
}

105 
boŞ
 
»ad_d©a
(cÚ¡ 
Ch”tTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

106 cÚ¡ 
¡ršg
 & 
Šame
);

109 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_size
() const;

116 
X­Ÿn
::
‹rmpos
 
	$g‘_pos™iÚ
() const;

119 
	`Ãxt
();

122 
	`sk_to
(
X­Ÿn
::
‹rmpos
ermpos);

125 
boŞ
 
	$©_’d
() const;

126 
	}
};

	@backends/chert/chert_postlist.cc

23 
	~<cÚfig.h
>

25 
	~"ch”t_po¡li¡.h
"

27 
	~"ch”t_cursÜ.h
"

28 
	~"ch”t_d©aba£.h
"

29 
	~"nÜ‘uº.h
"

30 
	~"omdebug.h
"

31 
	~"·ck.h
"

32 
	~"uts.h
"

34 
	gX­Ÿn
::
doccouÁ


35 
Ch”tPo¡Li¡TabË
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

37 
¡ršg
 
key
 = 
	`make_key
(
‹rm
);

38 
¡ršg
 
g
;

39 ià(!
	`g‘_exaù_’Œy
(
key
, 
g
))  0;

41 
X­Ÿn
::
doccouÁ
 
‹rmäeq
;

42 cÚ¡ * 
p
 = 
g
.
	`d©a
();

43 
Ch”tPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
,… + 
g
.
	`size
(), &
‹rmäeq
, 
NULL
);

44  
‹rmäeq
;

45 
	}
}

47 
	gX­Ÿn
::
‹rmcouÁ


48 
Ch”tPo¡Li¡TabË
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

50 
¡ršg
 
key
 = 
	`make_key
(
‹rm
);

51 
¡ršg
 
g
;

52 ià(!
	`g‘_exaù_’Œy
(
key
, 
g
))  0;

54 
X­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

55 cÚ¡ * 
p
 = 
g
.
	`d©a
();

56 
Ch”tPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
,… + 
g
.
	`size
(), 
NULL
, &
cŞläeq
);

57  
cŞläeq
;

58 
	}
}

60 
	gX­Ÿn
::
‹rmcouÁ


61 
Ch”tPo¡Li¡TabË
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
,

62 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db
) const {

63 ià(!
doş’_¶
.
g‘
()) {

66 
doş’_¶
.
»£t
(
Ãw
 
Ch”tPo¡Li¡
(
db
, 
¡ršg
(), 
çl£
));

68 ià(!
	gdoş’_¶
->
jump_to
(
did
))

69 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Docum’ˆ" + 
om_to¡ršg
(
did
) + "‚ot found");

70  
	gdoş’_¶
->
g‘_wdf
();

73 
boŞ


74 
	gCh”tPo¡Li¡TabË
::
docum’t_exi¡s
(
X­Ÿn
::
docid
 
did
,

75 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db
) const

77 ià(!
doş’_¶
.
g‘
()) {

80 
doş’_¶
.
»£t
(
Ãw
 
Ch”tPo¡Li¡
(
db
, 
¡ršg
(), 
çl£
));

82  (
	gdoş’_¶
->
jump_to
(
did
));

90 cÚ¡ 
	gCHUNKSIZE
 = 2000;

98 şas 
	cPo¡li¡ChunkWr™”
 {

99 
	mpublic
:

100 
Po¡li¡ChunkWr™”
(cÚ¡ 
¡ršg
 &
Üig_key_
,

101 
boŞ
 
is_fœ¡_chunk_
,

102 cÚ¡ 
¡ršg
 &
Šame_
,

103 
boŞ
 
is_Ï¡_chunk_
);

106 
­³nd
(
Ch”tTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

107 
X­Ÿn
::
‹rmcouÁ
 
wdf
);

110 
¿w_­³nd
(
X­Ÿn
::
docid
 
fœ¡_did_
, X­Ÿn::docid 
cu¼’t_did_
,

111 cÚ¡ 
¡ršg
 & 
s
) {

112 
As£¹
(!
¡¬‹d
);

113 
	mfœ¡_did
 = 
fœ¡_did_
;

114 
	mcu¼’t_did
 = 
cu¼’t_did_
;

115 ià(!
	ms
.
em±y
()) {

116 
	mchunk
.
­³nd
(
s
);

117 
	m¡¬‹d
 = 
Œue
;

125 
æush
(
Ch”tTabË
 *
bË
);

127 
	g´iv©e
:

128 
¡ršg
 
Üig_key
;

129 
¡ršg
 
	gŠame
;

130 
boŞ
 
	gis_fœ¡_chunk
;

131 
boŞ
 
	gis_Ï¡_chunk
;

132 
boŞ
 
	g¡¬‹d
;

134 
	gX­Ÿn
::
docid
 
fœ¡_did
;

135 
	gX­Ÿn
::
docid
 
cu¼’t_did
;

137 
¡ršg
 
	gchunk
;

143 
XAPIAN_NORETURN
(
»pÜt_»ad_”rÜ
(cÚ¡ * 
pos™iÚ
));

144 
	$»pÜt_»ad_”rÜ
(cÚ¡ * 
pos™iÚ
)

146 ià(
pos™iÚ
 == 0) {

148 
	`LOGLINE
(
DB
, "ChertPostList data„an out");

149 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Data„an out unexpectedly when„eading…osting†ist.");

152 
	`LOGLINE
(
DB
, "ChertPostList valueoo†arge");

153 
throw
 
X­Ÿn
::
	`RªgeE¼Ü
("Value in…osting†istoo†arge.");

154 
	}
}

156 
šlše
 
boŞ
 
	$g‘_Šame_äom_key
(cÚ¡ **
¤c
, cÚ¡ *
’d
,

157 
¡ršg
 &
Šame
)

159  
	`uÅack_¡ršg_´e£rvšg_sÜt
(
¤c
, 
’d
, 
Šame
);

160 
	}
}

162 
šlše
 
boŞ


163 
	$check_Šame_š_key_l™e
(cÚ¡ **
keypos
, cÚ¡ *
key’d
, cÚ¡ 
¡ršg
 &
Šame
)

165 
¡ršg
 
Šame_š_key
;

167 ià(
key’d
 - *
keypos
 >= 2 && (*keypos)[0] == '\0' && (*keypos)[1] == '\xe0') {

168 *
keypos
 += 2;

171 ià(!
	`g‘_Šame_äom_key
(
keypos
, 
key’d
, 
Šame_š_key
))

172 
	`»pÜt_»ad_”rÜ
(*
keypos
);

176  
Šame_š_key
 =ğ
Šame
;

177 
	}
}

179 
šlše
 
boŞ


180 
	$check_Šame_š_key
(cÚ¡ **
keypos
, cÚ¡ *
key’d
, cÚ¡ 
¡ršg
 &
Šame
)

182 ià(*
keypos
 =ğ
key’d
è 
çl£
;

184  
	`check_Šame_š_key_l™e
(
keypos
, 
key’d
, 
Šame
);

185 
	}
}

188 
	gX­Ÿn
::
docid


189 
»ad_¡¬t_of_fœ¡_chunk
(cÚ¡ ** 
po¥Œ
,

190 cÚ¡ * 
’d
,

191 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

192 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
)

194 
DEBUGCALL_STATIC
(
DB
, 
X­Ÿn
::
docid
, "read_start_of_first_chunk",

195 (cÚ¡ *)
po¥Œ
 << ", " <<

196 (cÚ¡ *)
’d
 << ", " <<

197 (*)
numb”_of_’Œ›s_±r
 << ", " <<

198 (*)
cŞËùiÚ_äeq_±r
);

200 
	gCh”tPo¡Li¡
::
»ad_numb”_of_’Œ›s
(
po¥Œ
, 
’d
,

201 
numb”_of_’Œ›s_±r
, 
cŞËùiÚ_äeq_±r
);

202 ià(
	gnumb”_of_’Œ›s_±r
)

203 
LOGVALUE
(
DB
, *
numb”_of_’Œ›s_±r
);

204 ià(
	gcŞËùiÚ_äeq_±r
)

205 
LOGVALUE
(
DB
, *
cŞËùiÚ_äeq_±r
);

207 
	gX­Ÿn
::
docid
 
did
;

209 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, &
did
))

210 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

211 ++
	gdid
;

212 
LOGVALUE
(
DB
, 
did
);

213 
RETURN
(
did
);

216 
šlše
 

217 
»ad_did_šü—£
(cÚ¡ ** 
po¥Œ
, cÚ¡ * 
’d
,

218 
X­Ÿn
::
docid
 * 
did_±r
)

220 
X­Ÿn
::
docid
 
did_šü—£
;

221 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, &
did_šü—£
)è
»pÜt_»ad_”rÜ
(*posptr);

222 *
	gdid_±r
 +ğ
did_šü—£
 + 1;

226 
šlše
 

227 
»ad_wdf
(cÚ¡ ** 
po¥Œ
, cÚ¡ * 
’d
, 
X­Ÿn
::
‹rmcouÁ
 * 
wdf_±r
)

229 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, 
wdf_±r
)è
»pÜt_»ad_”rÜ
(*posptr);

233 
	gX­Ÿn
::
docid


234 
»ad_¡¬t_of_chunk
(cÚ¡ ** 
po¥Œ
,

235 cÚ¡ * 
’d
,

236 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
,

237 
boŞ
 * 
is_Ï¡_chunk_±r
)

239 
DEBUGCALL_STATIC
(
DB
, 
X­Ÿn
::
docid
, "read_start_of_chunk",

240 
»š‹½»t_ÿ¡
<cÚ¡ *>(
po¥Œ
) << ", " <<

241 
»š‹½»t_ÿ¡
<cÚ¡ *>(
’d
) << ", " <<

242 
fœ¡_did_š_chunk
 << ", " <<

243 
»š‹½»t_ÿ¡
<cÚ¡ *>(
is_Ï¡_chunk_±r
));

246 ià(!
uÅack_boŞ
(
po¥Œ
, 
’d
, 
is_Ï¡_chunk_±r
))

247 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

248 ià(
	gis_Ï¡_chunk_±r
)

249 
LOGVALUE
(
DB
, *
is_Ï¡_chunk_±r
);

252 
	gX­Ÿn
::
docid
 
šü—£_to_Ï¡
;

253 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, &
šü—£_to_Ï¡
))

254 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

255 
	gX­Ÿn
::
docid
 
Ï¡_did_š_chunk
 = 
fœ¡_did_š_chunk
 + 
šü—£_to_Ï¡
;

256 
LOGVALUE
(
DB
, 
Ï¡_did_š_chunk
);

257 
RETURN
(
Ï¡_did_š_chunk
);

264 şas 
	cPo¡li¡ChunkR—d”
 {

265 
¡ršg
 
	md©a
;

267 cÚ¡ *
	mpos
;

268 cÚ¡ *
	m’d
;

270 
boŞ
 
	m©_’d
;

272 
	mX­Ÿn
::
docid
 
did
;

273 
	mX­Ÿn
::
‹rmcouÁ
 
wdf
;

275 
	mpublic
:

281 
Po¡li¡ChunkR—d”
(
X­Ÿn
::
docid
 
fœ¡_did
, cÚ¡ 
¡ršg
 & 
d©a_
)

282 : 
d©a
(
d©a_
), 
pos
(d©a.d©a()), 
’d
Õo + d©a.
Ëngth
()), 
©_’d
(d©a.
em±y
()), 
	$did
(
fœ¡_did
)

284 ià(!
©_’d
è
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

287 
X­Ÿn
::
docid
 
	$g‘_docid
() const {

288  
did
;

289 
	}
}

290 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const {

291  
wdf
;

292 
	}
}

294 
boŞ
 
	$is_©_’d
() const {

295  
©_’d
;

296 
	}
}

300 
Ãxt
();

304 
	gPo¡li¡ChunkR—d”
::
	$Ãxt
()

306 ià(
pos
 =ğ
’d
) {

307 
©_’d
 = 
Œue
;

309 
	`»ad_did_šü—£
(&
pos
, 
’d
, &
did
);

310 
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

312 
	}
}

314 
	gPo¡li¡ChunkWr™”
::
	$Po¡li¡ChunkWr™”
(cÚ¡ 
¡ršg
 &
Üig_key_
,

315 
boŞ
 
is_fœ¡_chunk_
,

316 cÚ¡ 
¡ršg
 &
Šame_
,

317 
boŞ
 
is_Ï¡_chunk_
)

318 : 
	`Üig_key
(
Üig_key_
),

319 
	`Šame
(
Šame_
), 
	`is_fœ¡_chunk
(
is_fœ¡_chunk_
),

320 
	`is_Ï¡_chunk
(
is_Ï¡_chunk_
),

321 
	$¡¬‹d
(
çl£
)

323 
	`DEBUGCALL
(
DB
, , "PostlistChunkWriter::PostlistChunkWriter",

324 
Üig_key_
 << ", " << 
is_fœ¡_chunk_
 << ", " << 
Šame_
 << ", " <<

325 
is_Ï¡_chunk_
);

326 
	}
}

329 
	gPo¡li¡ChunkWr™”
::
­³nd
(
Ch”tTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

330 
X­Ÿn
::
‹rmcouÁ
 
wdf
)

332 ià(!
¡¬‹d
) {

333 
¡¬‹d
 = 
Œue
;

334 
	gfœ¡_did
 = 
did
;

336 
As£¹
(
did
 > 
cu¼’t_did
);

338 ià(
	gchunk
.
size
(è>ğ
CHUNKSIZE
) {

339 
boŞ
 
§ve_is_Ï¡_chunk
 = 
is_Ï¡_chunk
;

340 
	gis_Ï¡_chunk
 = 
çl£
;

341 
æush
(
bË
);

342 
	gis_Ï¡_chunk
 = 
§ve_is_Ï¡_chunk
;

343 
	gis_fœ¡_chunk
 = 
çl£
;

344 
	gfœ¡_did
 = 
did
;

345 
	gchunk
.
»size
(0);

346 
	gÜig_key
 = 
Ch”tPo¡Li¡TabË
::
make_key
(
Šame
, 
fœ¡_did
);

348 
·ck_ušt
(
chunk
, 
did
 - 
cu¼’t_did
 - 1);

351 
	gcu¼’t_did
 = 
did
;

352 
·ck_ušt
(
chunk
, 
wdf
);

357 
šlše
 
¡ršg


358 
make_¡¬t_of_fœ¡_chunk
(
X­Ÿn
::
doccouÁ
 
’Œ›s
,

359 
X­Ÿn
::
‹rmcouÁ
 
cŞËùiÚäeq
,

360 
X­Ÿn
::
docid
 
Ãw_did
)

362 
¡ršg
 
chunk
;

363 
·ck_ušt
(
chunk
, 
’Œ›s
);

364 
·ck_ušt
(
chunk
, 
cŞËùiÚäeq
);

365 
·ck_ušt
(
chunk
, 
Ãw_did
 - 1);

366  
	gchunk
;

371 
šlše
 
¡ršg


372 
make_¡¬t_of_chunk
(
boŞ
 
Ãw_is_Ï¡_chunk
,

373 
X­Ÿn
::
docid
 
Ãw_fœ¡_did
,

374 
X­Ÿn
::
docid
 
Ãw_fš®_did
)

376 
As£¹
(
Ãw_fš®_did
 >ğ
Ãw_fœ¡_did
);

377 
¡ršg
 
	gchunk
;

378 
·ck_boŞ
(
chunk
, 
Ãw_is_Ï¡_chunk
);

379 
·ck_ušt
(
chunk
, 
Ãw_fš®_did
 - 
Ãw_fœ¡_did
);

380  
	gchunk
;

384 
wr™e_¡¬t_of_chunk
(
¡ršg
 & 
chunk
,

385 
¡¬t_of_chunk_h—d”
,

386 
’d_of_chunk_h—d”
,

387 
boŞ
 
is_Ï¡_chunk
,

388 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
,

389 
X­Ÿn
::
docid
 
Ï¡_did_š_chunk
)

391 
As£¹
((
size_t
)(
’d_of_chunk_h—d”
 - 
¡¬t_of_chunk_h—d”
è<ğ
chunk
.
size
());

393 
	gchunk
.
»¶aû
(
¡¬t_of_chunk_h—d”
,

394 
’d_of_chunk_h—d”
 - 
¡¬t_of_chunk_h—d”
,

395 
make_¡¬t_of_chunk
(
is_Ï¡_chunk
, 
fœ¡_did_š_chunk
,

396 
Ï¡_did_š_chunk
));

400 
	gPo¡li¡ChunkWr™”
::
	$æush
(
Ch”tTabË
 *
bË
)

402 
	`DEBUGCALL
(
DB
, , "Po¡li¡ChunkWr™”::æush", 
bË
);

412 ià(!
¡¬‹d
) {

421 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): deleting chunk");

422 
	`As£¹
(!
Üig_key
.
	`em±y
());

423 ià(
is_fœ¡_chunk
) {

424 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): deleting first chunk");

425 ià(
is_Ï¡_chunk
) {

429 
bË
->
	`d–
(
Üig_key
);

438 
AutoPŒ
<
Ch”tCursÜ
> 
	`cursÜ
(
bË
->
	`cursÜ_g‘
());

440 ià(!
cursÜ
->
	`fšd_’Œy
(
Üig_key
)) {

441 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("The key we're working on has disappeared");

453 
X­Ÿn
::
doccouÁ
 
num_’t
;

454 
X­Ÿn
::
‹rmcouÁ
 
cŞl_äeq
;

456 
cursÜ
->
	`»ad_g
();

457 cÚ¡ *
gpos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

458 cÚ¡ *
g’d
 = 
gpos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

460 ()
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

461 &
num_’t
, &
cŞl_äeq
);

465 
cursÜ
->
	`Ãxt
();

466 ià(
cursÜ
->
	`aá”_’d
()) {

467 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Expected‡nother key but found‚one");

469 cÚ¡ *
kpos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

470 cÚ¡ *
k’d
 = 
kpos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

471 ià(!
	`check_Šame_š_key
(&
kpos
, 
k’d
, 
Šame
)) {

472 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Expected‡nother key withhe sameerm‚ame but found‡ different one");

476 
X­Ÿn
::
docid
 
Ãw_fœ¡_did
;

477 ià(!
	`uÅack_ušt_´e£rvšg_sÜt
(&
kpos
, 
k’d
, &
Ãw_fœ¡_did
)) {

478 
	`»pÜt_»ad_”rÜ
(
kpos
);

481 
cursÜ
->
	`»ad_g
();

482 cÚ¡ *
gpos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

483 cÚ¡ *
g’d
 = 
gpos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

486 
boŞ
 
Ãw_is_Ï¡_chunk
;

487 
X­Ÿn
::
docid
 
Ãw_Ï¡_did_š_chunk
 =

488 
	`»ad_¡¬t_of_chunk
(&
gpos
, 
g’d
, 
Ãw_fœ¡_did
,

489 &
Ãw_is_Ï¡_chunk
);

491 
¡ršg
 
	`chunk_d©a
(
gpos
, 
g’d
);

494 
bË
->
	`d–
(
cursÜ
->
cu¼’t_key
);

497 
¡ršg
 
g
;

498 
g
 = 
	`make_¡¬t_of_fœ¡_chunk
(
num_’t
, 
cŞl_äeq
, 
Ãw_fœ¡_did
);

499 
g
 +ğ
	`make_¡¬t_of_chunk
(
Ãw_is_Ï¡_chunk
,

500 
Ãw_fœ¡_did
,

501 
Ãw_Ï¡_did_š_chunk
);

502 
g
 +ğ
chunk_d©a
;

503 
bË
->
	`add
(
Üig_key
, 
g
);

507 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): deleting secondary chunk");

511 
bË
->
	`d–
(
Üig_key
);

513 ià(
is_Ï¡_chunk
) {

514 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): deleting secondary†ast chunk");

516 
AutoPŒ
<
Ch”tCursÜ
> 
	`cursÜ
(
bË
->
	`cursÜ_g‘
());

520 ià(
cursÜ
->
	`fšd_’Œy
(
Üig_key
)) {

521 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Chert key‚ot deleted‡s weƒxpected");

524 cÚ¡ * 
keypos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

525 cÚ¡ * 
key’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

526 ià(!
	`check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

527 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Couldn't find chunk before delete chunk");

530 
boŞ
 
is_´ev_fœ¡_chunk
 = (
keypos
 =ğ
key’d
);

533 
cursÜ
->
	`»ad_g
();

534 
¡ršg
 
g
 = 
cursÜ
->
cu¼’t_g
;

536 cÚ¡ *
gpos
 = 
g
.
	`d©a
();

537 cÚ¡ *
g’d
 = 
gpos
 + 
g
.
	`size
();

540 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

541 ià(
is_´ev_fœ¡_chunk
) {

542 
fœ¡_did_š_chunk
 = 
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

545 ià(!
	`uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
fœ¡_did_š_chunk
))

546 
	`»pÜt_»ad_”rÜ
(
keypos
);

548 
boŞ
 
wrÚg_is_Ï¡_chunk
;

549 
¡ršg
::
size_ty³
 
¡¬t_of_chunk_h—d”
 = 
gpos
 - 
g
.
	`d©a
();

550 
X­Ÿn
::
docid
 
Ï¡_did_š_chunk
 =

551 
	`»ad_¡¬t_of_chunk
(&
gpos
, 
g’d
, 
fœ¡_did_š_chunk
,

552 &
wrÚg_is_Ï¡_chunk
);

553 
¡ršg
::
size_ty³
 
’d_of_chunk_h—d”
 = 
gpos
 - 
g
.
	`d©a
();

556 
	`wr™e_¡¬t_of_chunk
(
g
,

557 
¡¬t_of_chunk_h—d”
,

558 
’d_of_chunk_h—d”
,

559 
Œue
,

560 
fœ¡_did_š_chunk
,

561 
Ï¡_did_š_chunk
);

562 
bË
->
	`add
(
cursÜ
->
cu¼’t_key
, 
g
);

565 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): updating chunk which still has items in it");

572 
¡ršg
 
g
;

577 ià(
is_fœ¡_chunk
) {

581 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush():„ewritinghe first chunk, which still has items in it");

582 
¡ršg
 
key
 = 
Ch”tPo¡Li¡TabË
::
	`make_key
(
Šame
);

583 
boŞ
 
ok
 = 
bË
->
	`g‘_exaù_’Œy
(
key
, 
g
);

584 ()
ok
;

585 
	`As£¹
(
ok
);

586 
	`As£¹
(!
g
.
	`em±y
());

588 
X­Ÿn
::
doccouÁ
 
num_’t
;

589 
X­Ÿn
::
‹rmcouÁ
 
cŞl_äeq
;

591 cÚ¡ * 
gpos
 = 
g
.
	`d©a
();

592 cÚ¡ * 
g’d
 = 
gpos
 + 
g
.
	`size
();

593 ()
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

594 &
num_’t
, &
cŞl_äeq
);

597 
g
 = 
	`make_¡¬t_of_fœ¡_chunk
(
num_’t
, 
cŞl_äeq
, 
fœ¡_did
);

599 
g
 +ğ
	`make_¡¬t_of_chunk
(
is_Ï¡_chunk
, 
fœ¡_did
, 
cu¼’t_did
);

600 
g
 +ğ
chunk
;

601 
bË
->
	`add
(
key
, 
g
);

605 
	`LOGLINE
(
DB
, "PostlistChunkWriter::flush(): updating secondary chunk which still has items in it");

617 cÚ¡ *
keypos
 = 
Üig_key
.
	`d©a
();

618 cÚ¡ *
key’d
 = 
keypos
 + 
Üig_key
.
	`size
();

619 ià(!
	`check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

620 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Have invalid key writingo…ostlist");

622 
X­Ÿn
::
docid
 
š™Ÿl_did
;

623 ià(!
	`uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
š™Ÿl_did
)) {

624 
	`»pÜt_»ad_”rÜ
(
keypos
);

626 
¡ršg
 
Ãw_key
;

627 ià(
š™Ÿl_did
 !ğ
fœ¡_did
) {

632 
Ãw_key
 = 
Ch”tPo¡Li¡TabË
::
	`make_key
(
Šame
, 
fœ¡_did
);

633 
bË
->
	`d–
(
Üig_key
);

635 
Ãw_key
 = 
Üig_key
;

639 
g
 = 
	`make_¡¬t_of_chunk
(
is_Ï¡_chunk
, 
fœ¡_did
, 
cu¼’t_did
);

641 
g
 +ğ
chunk
;

642 
bË
->
	`add
(
Ãw_key
, 
g
);

644 
	}
}

650 
	gCh”tPo¡Li¡
::
»ad_numb”_of_’Œ›s
(cÚ¡ ** 
po¥Œ
,

651 cÚ¡ * 
’d
,

652 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

653 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
)

655 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, 
numb”_of_’Œ›s_±r
))

656 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

657 ià(!
uÅack_ušt
(
po¥Œ
, 
’d
, 
cŞËùiÚ_äeq_±r
))

658 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

680 
	gCh”tPo¡Li¡
::
Ch”tPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
this_db_
,

681 cÚ¡ 
¡ršg
 & 
‹rm_
,

682 
boŞ
 
k“p_»ã»nû
)

683 : 
L—fPo¡Li¡
(
‹rm_
),

684 
this_db
(
k“p_»ã»nû
 ? 
this_db_
 : 
NULL
),

685 
have_¡¬‹d
(
çl£
),

686 
cursÜ
(
this_db_
->
po¡li¡_bË
.
cursÜ_g‘
()),

687 
	$is_©_’d
(
çl£
)

689 
	`DEBUGCALL
(
DB
, , "ChertPostList::ChertPostList",

690 
this_db_
.
	`g‘
(è<< ", " << 
‹rm_
 << ", " << 
k“p_»ã»nû
);

691 
¡ršg
 
key
 = 
Ch”tPo¡Li¡TabË
::
	`make_key
(
‹rm
);

692 
found
 = 
cursÜ
->
	`fšd_’Œy
(
key
);

693 ià(!
found
) {

694 
	`LOGLINE
(
DB
, "postlist forerm‚ot found");

695 
numb”_of_’Œ›s
 = 0;

696 
is_©_’d
 = 
Œue
;

697 
pos
 = 0;

698 
’d
 = 0;

699 
fœ¡_did_š_chunk
 = 0;

700 
Ï¡_did_š_chunk
 = 0;

703 
cursÜ
->
	`»ad_g
();

704 
pos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

705 
’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

707 
did
 = 
	`»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, &
numb”_of_’Œ›s
, 
NULL
);

708 
fœ¡_did_š_chunk
 = 
did
;

709 
Ï¡_did_š_chunk
 = 
	`»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

710 &
is_Ï¡_chunk
);

711 
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

712 
	`LOGLINE
(
DB
, "In™ŸÈdocid " << 
did
);

713 
	}
}

715 
	gCh”tPo¡Li¡
::~
	$Ch”tPo¡Li¡
()

717 
	`DEBUGCALL
(
DB
, , "ChertPostList::~ChertPostList", "");

718 
	}
}

720 
	gX­Ÿn
::
‹rmcouÁ


721 
Ch”tPo¡Li¡
::
	$g‘_doş’gth
() const

723 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertPostList::get_doclength", "");

724 
	`As£¹
(
have_¡¬‹d
);

725 
	`As£¹
(
this_db
.
	`g‘
());

726 
	`RETURN
(
this_db
->
	`g‘_doş’gth
(
did
));

727 
	}
}

729 
boŞ


730 
	gCh”tPo¡Li¡
::
	$Ãxt_š_chunk
()

732 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertPostList::next_in_chunk", "");

733 ià(
pos
 =ğ
’d
è
	`RETURN
(
çl£
);

735 
	`»ad_did_šü—£
(&
pos
, 
’d
, &
did
);

736 
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

739 
	`As£¹
(
did
 <ğ
Ï¡_did_š_chunk
);

740 
	`As£¹
(
did
 < 
Ï¡_did_š_chunk
 || 
pos
 =ğ
’d
);

741 
	`As£¹
(
pos
 !ğ
’d
 || 
did
 =ğ
Ï¡_did_š_chunk
);

743 
	`RETURN
(
Œue
);

744 
	}
}

747 
	gCh”tPo¡Li¡
::
	$Ãxt_chunk
()

749 
	`DEBUGCALL
(
DB
, , "ChertPostList::next_chunk", "");

750 ià(
is_Ï¡_chunk
) {

751 
is_©_’d
 = 
Œue
;

755 
cursÜ
->
	`Ãxt
();

756 ià(
cursÜ
->
	`aá”_’d
()) {

757 
is_©_’d
 = 
Œue
;

758 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Unexpectedƒnd of…osting†ist for `" +

759 
‹rm
 + "'");

761 cÚ¡ * 
keypos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

762 cÚ¡ * 
key’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

764 ià(!
	`check_Šame_š_key_l™e
(&
keypos
, 
key’d
, 
‹rm
)) {

765 
is_©_’d
 = 
Œue
;

766 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Unexpectedƒnd of…osting†ist for `" +

767 
‹rm
 + "'");

770 
X­Ÿn
::
docid
 
Ãwdid
;

771 ià(!
	`uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
Ãwdid
)) {

772 
	`»pÜt_»ad_”rÜ
(
keypos
);

774 ià(
Ãwdid
 <ğ
did
) {

775 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Document ID in‚ew chunk of…ostlist (" +

776 
	`om_to¡ršg
(
Ãwdid
) +

778 
	`om_to¡ršg
(
did
) + ")");

780 
did
 = 
Ãwdid
;

782 
cursÜ
->
	`»ad_g
();

783 
pos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

784 
’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

786 
fœ¡_did_š_chunk
 = 
did
;

787 
Ï¡_did_š_chunk
 = 
	`»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

788 &
is_Ï¡_chunk
);

789 
	`»ad_wdf
(&
pos
, 
’d
, &
wdf
);

790 
	}
}

792 
Pos™iÚLi¡
 *

793 
	gCh”tPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

795 
	`DEBUGCALL
(
DB
, 
Pos™iÚLi¡
 *, "ChertPostList::read_position_list", "");

796 
	`As£¹
(
this_db
.
	`g‘
());

797 
pos™iÚli¡
.
	`»ad_d©a
(&
this_db
->
pos™iÚ_bË
, 
did
, 
‹rm
);

798 
	`RETURN
(&
pos™iÚli¡
);

799 
	}
}

801 
Pos™iÚLi¡
 *

802 
	gCh”tPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

804 
	`DEBUGCALL
(
DB
, 
Pos™iÚLi¡
 *, "ChertPostList::open_position_list", "");

805 
	`As£¹
(
this_db
.
	`g‘
());

806 
	`RETURN
(
Ãw
 
	`Ch”tPos™iÚLi¡
(&
this_db
->
pos™iÚ_bË
, 
did
, 
‹rm
));

807 
	}
}

809 
Po¡Li¡
 *

810 
	gCh”tPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

812 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *, "Ch”tPo¡Li¡::Ãxt", 
w_mš
);

813 ()
	gw_mš
;

815 ià(!
	ghave_¡¬‹d
) {

816 
	ghave_¡¬‹d
 = 
Œue
;

818 ià(!
Ãxt_š_chunk
()è
Ãxt_chunk
();

821 ià(
	gis_©_’d
) {

822 
LOGLINE
(
DB
, "Movedoƒnd");

824 
LOGLINE
(
DB
, "MovedØdocid " << 
did
 << ", wdàğ" << 
wdf
);

827 
RETURN
(
NULL
);

830 
boŞ


831 
	gCh”tPo¡Li¡
::
cu¼’t_chunk_cÚšs
(
X­Ÿn
::
docid
 
desœed_did
)

833 
DEBUGCALL
(
DB
, 
boŞ
, "Ch”tPo¡Li¡::cu¼’t_chunk_cÚšs", 
desœed_did
);

834 ià(
	gdesœed_did
 >ğ
fœ¡_did_š_chunk
 &&

835 
desœed_did
 <ğ
Ï¡_did_š_chunk
) {

836 
RETURN
(
Œue
);

838 
RETURN
(
çl£
);

842 
	gCh”tPo¡Li¡
::
move_to_chunk_cÚššg
(
X­Ÿn
::
docid
 
desœed_did
)

844 
DEBUGCALL
(
DB
, ,

845 "Ch”tPo¡Li¡::move_to_chunk_cÚššg", 
desœed_did
);

846 ()
	gcursÜ
->
fšd_’Œy
(
Ch”tPo¡Li¡TabË
::
make_key
(
‹rm
, 
desœed_did
));

847 
As£¹
(!
cursÜ
->
aá”_’d
());

849 cÚ¡ * 
	gkeypos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

850 cÚ¡ * 
	gkey’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
size
();

852 ià(!
check_Šame_š_key_l™e
(&
keypos
, 
key’d
, 
‹rm
)) {

854 
	gis_©_’d
 = 
Œue
;

855 
	gis_Ï¡_chunk
 = 
Œue
;

858 
	gis_©_’d
 = 
çl£
;

860 
	gcursÜ
->
»ad_g
();

861 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

862 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

864 ià(
	gkeypos
 =ğ
key’d
) {

866 #ifdeà
XAPIAN_ASSERTIONS


867 
X­Ÿn
::
doccouÁ
 
Şd_numb”_of_’Œ›s
 = 
numb”_of_’Œ›s
;

868 
	gdid
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, &
numb”_of_’Œ›s
, 
NULL
);

869 
As£¹
(
Şd_numb”_of_’Œ›s
 =ğ
numb”_of_’Œ›s
);

871 
	gdid
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, 
NULL
, NULL);

875 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
did
)) {

876 
»pÜt_»ad_”rÜ
(
keypos
);

880 
	gfœ¡_did_š_chunk
 = 
did
;

881 
	gÏ¡_did_š_chunk
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

882 &
is_Ï¡_chunk
);

883 
»ad_wdf
(&
pos
, 
’d
, &
wdf
);

887 ià(
	gdesœed_did
 > 
	gÏ¡_did_š_chunk
è
Ãxt_chunk
();

890 
boŞ


891 
	gCh”tPo¡Li¡
::
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
X­Ÿn
::
docid
 
desœed_did
)

893 
DEBUGCALL
(
DB
, 
boŞ
,

894 "Ch”tPo¡Li¡::move_fÜw¬d_š_chunk_to_©_Ëa¡", 
desœed_did
);

895 ià(
	gdid
 >ğ
desœed_did
)

896 
RETURN
(
Œue
);

898 ià(
	gdesœed_did
 <ğ
Ï¡_did_š_chunk
) {

899 
pos
 !ğ
’d
) {

900 
»ad_did_šü—£
(&
pos
, 
’d
, &
did
);

901 ià(
	gdid
 >ğ
desœed_did
) {

902 
»ad_wdf
(&
pos
, 
’d
, &
wdf
);

903 
RETURN
(
Œue
);

906 
»ad_wdf
(&
pos
, 
’d
, 
NULL
);

910 
As£¹
(
çl£
);

913 
	gpos
 = 
’d
;

914 
RETURN
(
çl£
);

917 
Po¡Li¡
 *

918 
	gCh”tPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
)

920 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *,

921 "Ch”tPo¡Li¡::sk_to", 
desœed_did
 << ", " << 
w_mš
);

922 ()
	gw_mš
;

925 
	ghave_¡¬‹d
 = 
Œue
;

928 ià(
	gis_©_’d
 || 
	gdesœed_did
 <ğ
did
è
RETURN
(
NULL
);

931 ià(!
cu¼’t_chunk_cÚšs
(
desœed_did
)) {

932 
move_to_chunk_cÚššg
(
desœed_did
);

935 ià(
	gis_©_’d
è
RETURN
(
NULL
);

939 
boŞ
 
	ghave_docum’t
 = 
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
desœed_did
);

940 ()
	ghave_docum’t
;

941 
As£¹
(
have_docum’t
);

943 ià(
	gis_©_’d
) {

944 
LOGLINE
(
DB
, "Skippedoƒnd");

946 
LOGLINE
(
DB
, "Sk³dØdocid " << 
did
 << ", wdàğ" << 
wdf
);

949 
RETURN
(
NULL
);

953 
boŞ


954 
	gCh”tPo¡Li¡
::
jump_to
(
X­Ÿn
::
docid
 
desœed_did
)

956 
DEBUGCALL
(
DB
, 
boŞ
, "Ch”tPo¡Li¡::jump_to", 
desœed_did
);

959 
	ghave_¡¬‹d
 = 
Œue
;

962 ià(
	gpos
 =ğ0è
RETURN
(
çl£
);

967 ià(
	gis_©_’d
 || !
cu¼’t_chunk_cÚšs
(
desœed_did
è|| 
	gdesœed_did
 < 
	gdid
) {

969 
	gis_©_’d
 = 
çl£
;

971 
move_to_chunk_cÚššg
(
desœed_did
);

974 ià(
	gis_©_’d
è
RETURN
(
çl£
);

978 ià(!
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
desœed_did
)è
RETURN
(
çl£
);

979 
RETURN
(
desœed_did
 =ğ
did
);

982 
¡ršg


983 
	gCh”tPo¡Li¡
::
	$g‘_desütiÚ
() const

985  
‹rm
 + ":" + 
	`om_to¡ršg
(
numb”_of_’Œ›s
);

986 
	}
}

989 
	gX­Ÿn
::
docid


990 
Ch”tPo¡Li¡TabË
::
g‘_chunk
(cÚ¡ 
¡ršg
 &
Šame
,

991 
X­Ÿn
::
docid
 
did
, 
boŞ
 
addšg
,

992 
Po¡li¡ChunkR—d”
 ** 
äom
, 
Po¡li¡ChunkWr™”
 **
to
)

994 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "Ch”tPo¡Li¡TabË::g‘_chunk", 
Šame
 << ", " << 
did
 << ", " << 
addšg
 << ", [from], [to]");

996 
¡ršg
 
	gkey
 = 
make_key
(
Šame
, 
did
);

999 
	gAutoPŒ
<
	gCh”tCursÜ
> 
cursÜ
(
cursÜ_g‘
());

1001 ()
	gcursÜ
->
fšd_’Œy
(
key
);

1002 
As£¹
(!
cursÜ
->
aá”_’d
());

1004 cÚ¡ * 
	gkeypos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

1005 cÚ¡ * 
	gkey’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
size
();

1007 ià(!
check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

1009 ià(!
	gaddšg
)

1010 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("A‰em±edØd–‘Ü modify‡À’Œy iÀ¨nÚ-exi¡’ˆpo¡šg†i¡ fÜ " + 
Šame
);

1012 *
	gäom
 = 
NULL
;

1013 *
	gto
 = 
Ãw
 
Po¡li¡ChunkWr™”
(
¡ršg
(), 
Œue
, 
Šame
,rue);

1014 
RETURN
(
X­Ÿn
::
docid
(-1));

1019 
boŞ
 
	gis_fœ¡_chunk
 = (
keypos
 =ğ
key’d
);

1020 
LOGVALUE
(
DB
, 
is_fœ¡_chunk
);

1022 
	gcursÜ
->
»ad_g
();

1023 cÚ¡ * 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

1024 cÚ¡ * 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

1025 
	gX­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

1026 ià(
	gis_fœ¡_chunk
) {

1027 
	gfœ¡_did_š_chunk
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, 
NULL
, NULL);

1029 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
fœ¡_did_š_chunk
)) {

1030 
»pÜt_»ad_”rÜ
(
keypos
);

1034 
boŞ
 
	gis_Ï¡_chunk
;

1035 
	gX­Ÿn
::
docid
 
Ï¡_did_š_chunk
;

1036 
	gÏ¡_did_š_chunk
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
, &
is_Ï¡_chunk
);

1037 *
	gto
 = 
Ãw
 
Po¡li¡ChunkWr™”
(
cursÜ
->
cu¼’t_key
, 
is_fœ¡_chunk
, 
Šame
,

1038 
is_Ï¡_chunk
);

1039 ià(
	gdid
 > 
	gÏ¡_did_š_chunk
) {

1043 *
	gäom
 = 
NULL
;

1044 (*
	gto
)->
¿w_­³nd
(
fœ¡_did_š_chunk
, 
Ï¡_did_š_chunk
,

1045 
¡ršg
(
pos
, 
’d
));

1047 *
	gäom
 = 
Ãw
 
Po¡li¡ChunkR—d”
(
fœ¡_did_š_chunk
, 
¡ršg
(
pos
, 
’d
));

1049 ià(
	gis_Ï¡_chunk
è
RETURN
(
X­Ÿn
::
docid
(-1));

1052 
	gcursÜ
->
Ãxt
();

1053 ià(
	gcursÜ
->
aá”_’d
()) {

1054 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Expected‡nother key but found‚one");

1056 cÚ¡ *
	gkpos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

1057 cÚ¡ *
	gk’d
 = 
kpos
 + 
cursÜ
->
cu¼’t_key
.
size
();

1058 ià(!
check_Šame_š_key
(&
kpos
, 
k’d
, 
Šame
)) {

1059 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Expected‡nother key withhe sameerm‚ame but found‡ different one");

1063 
	gX­Ÿn
::
docid
 
fœ¡_did_of_Ãxt_chunk
;

1064 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
kpos
, 
k’d
, &
fœ¡_did_of_Ãxt_chunk
)) {

1065 
»pÜt_»ad_”rÜ
(
kpos
);

1067 
RETURN
(
fœ¡_did_of_Ãxt_chunk
 - 1);

1071 
	gCh”tPo¡Li¡TabË
::
m”ge_chªges
(

1072 cÚ¡ 
m­
<
¡ršg
, m­<
X­Ÿn
::
docid
, 
·œ
<, X­Ÿn::
‹rmcouÁ
> > > & 
mod_¶i¡s
,

1073 cÚ¡ 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> & 
doş’s
,

1074 cÚ¡ 
m­
<
¡ršg
, 
·œ
<
X­Ÿn
::
‹rmcouÁ_diff
, X­Ÿn::‹rmcouÁ_diff> > & 
äeq_d–s
)

1076 
DEBUGCALL
(
DB
, , "ChertPostListTable::merge_changes", "mod_plists, doclens, freq_deltas");

1079 
	gdoş’_¶
.
»£t
(0);

1081 
LOGVALUE
(
DB
, 
doş’s
.
size
());

1082 ià(!
	gdoş’s
.
em±y
()) {

1084 
¡ršg
 
	gcu¼’t_key
 = 
make_key
(string());

1085 ià(!
key_exi¡s
(
cu¼’t_key
)) {

1086 
LOGLINE
(
DB
, "Adding dummy first chunk");

1087 
¡ršg
 
	gÃwg
 = 
make_¡¬t_of_fœ¡_chunk
(0, 0, 0);

1088 
	gÃwg
 +ğ
make_¡¬t_of_chunk
(
Œue
, 0, 0);

1089 
add
(
cu¼’t_key
, 
Ãwg
);

1092 
	gm­
<
	gX­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
j
;

1093 
	gj
 = 
doş’s
.
begš
();

1094 
As£¹
(
j
 !ğ
doş’s
.
’d
());

1096 
	gX­Ÿn
::
docid
 
max_did
;

1097 
Po¡li¡ChunkR—d”
 *
	gäom
;

1098 
Po¡li¡ChunkWr™”
 *
	gto
;

1099 
	gmax_did
 = 
g‘_chunk
(
¡ršg
(), 
j
->
fœ¡
, 
Œue
, &
äom
, &
to
);

1100 
LOGVALUE
(
DB
, 
max_did
);

1101  ; 
	gj
 !ğ
doş’s
.
’d
(); ++j) {

1102 
	gX­Ÿn
::
docid
 
did
 = 
j
->
fœ¡
;

1104 
	gÃxt_doş’_chunk
:

1105 
LOGLINE
(
DB
, "Upd©šg doş’s, did=" << 
did
);

1106 ià(
	gäom
è!äom->
is_©_’d
()) {

1107 
	gX­Ÿn
::
docid
 
cİy_did
 = 
äom
->
g‘_docid
();

1108 ià(
	gcİy_did
 >ğ
did
) {

1109 ià(
cİy_did
 =ğ
did
è
äom
->
Ãxt
();

1112 
	gto
->
­³nd
(
this
, 
cİy_did
, 
äom
->
g‘_wdf
());

1113 
	gäom
->
Ãxt
();

1115 ià((!
	gäom
 || from->
is_©_’d
()è&& 
	gdid
 > 
	gmax_did
) {

1116 
d–‘e
 
	gäom
;

1117 
	gto
->
æush
(
this
);

1118 
d–‘e
 
	gto
;

1119 
	gmax_did
 = 
g‘_chunk
(
¡ršg
(), 
did
, 
çl£
, &
äom
, &
to
);

1120 
	gÃxt_doş’_chunk
;

1123 
	gX­Ÿn
::
‹rmcouÁ
 
Ãw_doş’
 = 
j
->
£cÚd
;

1124 ià(
	gÃw_doş’
 !ğ
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(-1)) {

1125 
to
->
­³nd
(
this
, 
did
, 
Ãw_doş’
);

1129 ià(
	gäom
) {

1130 !
	gäom
->
is_©_’d
()) {

1131 
	gto
->
­³nd
(
this
, 
äom
->
g‘_docid
(), from->
g‘_wdf
());

1132 
	gäom
->
Ãxt
();

1134 
d–‘e
 
	gäom
;

1136 
	gto
->
æush
(
this
);

1137 
d–‘e
 
	gto
;

1140 
	gm­
<
	g¡ršg
, m­<
	gX­Ÿn
::
docid
, 
	g·œ
<, X­Ÿn::
‹rmcouÁ
> > >::
cÚ¡_™”©Ü
 
i
;

1141 
	gi
 = 
mod_¶i¡s
.
begš
(); i !ğmod_¶i¡s.
’d
(); ++i) {

1142 ià(
	gi
->
	g£cÚd
.
em±y
()) ;

1143 
¡ršg
 
	gŠame
 = 
i
->
fœ¡
;

1147 
	gm­
<
	g¡ršg
, 
	g·œ
<
	gX­Ÿn
::
‹rmcouÁ_diff
, X­Ÿn::‹rmcouÁ_diff> >::
cÚ¡_™”©Ü
 
d–s
 = 
äeq_d–s
.
fšd
(
Šame
);

1148 
As£¹
(
d–s
 !ğ
äeq_d–s
.
’d
());

1150 
¡ršg
 
	gcu¼’t_key
 = 
make_key
(
Šame
);

1151 
¡ršg
 
	gg
;

1152 ()
g‘_exaù_’Œy
(
cu¼’t_key
, 
g
);

1155 cÚ¡ *
	gpos
 = 
g
.
d©a
();

1156 cÚ¡ *
	g’d
 = 
pos
 + 
g
.
size
();

1157 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq
;

1158 
	gX­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

1159 
	gX­Ÿn
::
docid
 
fœ¡did
, 
	gÏ¡did
;

1160 
boŞ
 
	gi¦a¡
;

1161 ià(
	gpos
 =ğ
’d
) {

1162 
‹rmäeq
 = 0;

1163 
	gcŞläeq
 = 0;

1164 
	gfœ¡did
 = 0;

1165 
	gÏ¡did
 = 0;

1166 
	gi¦a¡
 = 
Œue
;

1168 
	gfœ¡did
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
,

1169 &
‹rmäeq
, &
cŞläeq
);

1171 
	gÏ¡did
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡did
, &
i¦a¡
);

1174 
	g‹rmäeq
 +ğ
d–s
->
£cÚd
.
fœ¡
;

1175 ià(
	g‹rmäeq
 == 0) {

1178 ià(
i¦a¡
) {

1180 
d–
(
cu¼’t_key
);

1183 
MubËCh”tCursÜ
 
cursÜ
(
this
);

1184 
boŞ
 
	gfound
 = 
cursÜ
.
fšd_’Œy
(
cu¼’t_key
);

1185 
As£¹
(
found
);

1186 ià(!
	gfound
) ;

1187 
	gcursÜ
.
d–
()) {

1188 cÚ¡ *
	gkpos
 = 
cursÜ
.
cu¼’t_key
.
d©a
();

1189 cÚ¡ *
	gk’d
 = 
kpos
 + 
cursÜ
.
cu¼’t_key
.
size
();

1190 ià(!
check_Šame_š_key_l™e
(&
kpos
, 
k’d
, 
Šame
)) ;

1194 
	gcŞläeq
 +ğ
d–s
->
£cÚd
.second;

1197 
¡ršg
 
	gÃwhdr
 = 
make_¡¬t_of_fœ¡_chunk
(
‹rmäeq
, 
cŞläeq
, 
fœ¡did
);

1198 
	gÃwhdr
 +ğ
make_¡¬t_of_chunk
(
i¦a¡
, 
fœ¡did
, 
Ï¡did
);

1199 ià(
	gpos
 =ğ
’d
) {

1200 
add
(
cu¼’t_key
, 
Ãwhdr
);

1202 
As£¹
((
size_t
)(
pos
 - 
g
.
d©a
()è<ğg.
size
());

1203 
	gg
.
»¶aû
(0, 
pos
 - 
g
.
d©a
(), 
Ãwhdr
);

1204 
add
(
cu¼’t_key
, 
g
);

1207 
	gm­
<
	gX­Ÿn
::
docid
, 
	g·œ
<, X­Ÿn::
‹rmcouÁ
> >::
cÚ¡_™”©Ü
 
j
;

1208 
	gj
 = 
i
->
£cÚd
.
begš
();

1209 
As£¹
(
j
 !ğ
i
->
£cÚd
.
’d
());

1211 
	gX­Ÿn
::
docid
 
max_did
;

1212 
Po¡li¡ChunkR—d”
 *
	gäom
;

1213 
Po¡li¡ChunkWr™”
 *
	gto
;

1214 
	gmax_did
 = 
g‘_chunk
(
Šame
, 
j
->
fœ¡
, j->
£cÚd
.first == 'A',

1215 &
äom
, &
to
);

1216  ; 
	gj
 !ğ
i
->
£cÚd
.
’d
(); ++j) {

1217 
	gX­Ÿn
::
docid
 
did
 = 
j
->
fœ¡
;

1219 
	gÃxt_chunk
:

1220 
LOGLINE
(
DB
, "Upd©šgÇme=" << 
Šame
 << ", did=" << 
did
);

1221 ià(
	gäom
è!äom->
is_©_’d
()) {

1222 
	gX­Ÿn
::
docid
 
cİy_did
 = 
äom
->
g‘_docid
();

1223 ià(
	gcİy_did
 >ğ
did
) {

1224 ià(
cİy_did
 =ğ
did
) {

1225 
As£¹
(
j
->
£cÚd
.
fœ¡
 != 'A');

1226 
	gäom
->
Ãxt
();

1230 
	gto
->
­³nd
(
this
, 
cİy_did
, 
äom
->
g‘_wdf
());

1231 
	gäom
->
Ãxt
();

1233 ià((!
	gäom
 || from->
is_©_’d
()è&& 
	gdid
 > 
	gmax_did
) {

1234 
d–‘e
 
	gäom
;

1235 
	gto
->
æush
(
this
);

1236 
d–‘e
 
	gto
;

1237 
	gmax_did
 = 
g‘_chunk
(
Šame
, 
did
, 
çl£
, &
äom
, &
to
);

1238 
	gÃxt_chunk
;

1241 ià(
	gj
->
	g£cÚd
.
	gfœ¡
 != 'D') {

1242 
X­Ÿn
::
‹rmcouÁ
 
Ãw_wdf
 = 
j
->
£cÚd
.second;

1243 
	gto
->
­³nd
(
this
, 
did
, 
Ãw_wdf
);

1247 ià(
	gäom
) {

1248 !
	gäom
->
is_©_’d
()) {

1249 
	gto
->
­³nd
(
this
, 
äom
->
g‘_docid
(), from->
g‘_wdf
());

1250 
	gäom
->
Ãxt
();

1252 
d–‘e
 
	gäom
;

1254 
	gto
->
æush
(
this
);

1255 
d–‘e
 
	gto
;

	@backends/chert/chert_postlist.h

24 #iâdeà
OM_HGUARD_CHERT_POSTLIST_H


25 
	#OM_HGUARD_CHERT_POSTLIST_H


	)

27 
	~<x­Ÿn/d©aba£.h
>

29 
	~"ch”t_ty³s.h
"

30 
	~"ch”t_pos™iÚli¡.h
"

31 
	~"Ëaåo¡li¡.h
"

32 
	~"omas£¹.h
"

33 
	~"omdebug.h
"

35 
	~"autİŒ.h
"

36 
	~<m­
>

37 
	~<¡ršg
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
şass
 
	gCh”tCursÜ
;

42 
şass
 
	gCh”tD©aba£
;

44 
şass
 
	gPo¡li¡ChunkR—d”
;

45 
şass
 
	gPo¡li¡ChunkWr™”
;

47 
şass
 
	gCh”tPo¡Li¡
;

49 şas 
	cCh”tPo¡Li¡TabË
 : 
public
 
Ch”tTabË
 {

51 
mubË
 
AutoPŒ
<
Ch”tPo¡Li¡
> 
doş’_¶
;

53 
	mpublic
:

66 
	$Ch”tPo¡Li¡TabË
(cÚ¡ 
¡ršg
 & 
·th_
, 
boŞ
 
»adÚly_
)

67 : 
	`Ch”tTabË
("po¡li¡", 
·th_
 + "/po¡li¡.", 
»adÚly_
),

68 
	$doş’_¶
()

71 
boŞ
 
	$İ’
(
ch”t_»visiÚ_numb”_t
 
»vno
) {

72 
doş’_¶
.
	`»£t
(0);

73  
Ch”tTabË
::
	`İ’
(
»vno
);

74 
	}
}

77 
m”ge_chªges
(

78 cÚ¡ 
m­
<
¡ršg
, m­<
X­Ÿn
::
docid
, 
·œ
<, X­Ÿn::
‹rmcouÁ
> > > & 
mod_¶i¡s
,

79 cÚ¡ 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> & 
doş’s
,

80 cÚ¡ 
m­
<
¡ršg
, 
·œ
<
X­Ÿn
::
‹rmcouÁ_diff
, X­Ÿn::‹rmcouÁ_diff> > & 
äeq_d–s
);

82 
	gX­Ÿn
::
docid
 
g‘_chunk
(cÚ¡ 
¡ršg
 &
Šame
,

83 
X­Ÿn
::
docid
 
did
, 
boŞ
 
addšg
,

84 
Po¡li¡ChunkR—d”
 ** 
äom
, 
Po¡li¡ChunkWr™”
 **
to
);

87 
¡ršg
 
make_key
(cÚ¡ sŒšg & 
‹rm
, 
X­Ÿn
::
docid
 
did
) {

88  
·ck_ch”t_po¡li¡_key
(
‹rm
, 
did
);

92 
¡ršg
 
	$make_key
(cÚ¡ 
¡ršg
 & 
‹rm
) {

93  
	`·ck_ch”t_po¡li¡_key
(
‹rm
);

94 
	}
}

96 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
‹rm
) const {

97  
	`key_exi¡s
(
	`make_key
(
‹rm
));

98 
	}
}

104 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

110 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

113 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
,

114 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db
) const;

117 
boŞ
 
docum’t_exi¡s
(
X­Ÿn
::
docid
 
did
,

118 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db
) const;

123 şas 
	cCh”tPo¡Li¡
 : 
public
 
L—fPo¡Li¡
 {

124 
´Ùeùed
:

129 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
this_db
;

132 
boŞ
 
	mhave_¡¬‹d
;

135 
Ch”tPos™iÚLi¡
 
	mpos™iÚli¡
;

137 
	m´iv©e
:

139 
AutoPŒ
<
Ch”tCursÜ
> 
cursÜ
;

142 
boŞ
 
	mis_Ï¡_chunk
;

145 
	mX­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

148 
	mX­Ÿn
::
docid
 
Ï¡_did_š_chunk
;

151 cÚ¡ * 
	mpos
;

154 cÚ¡ * 
	m’d
;

157 
	mX­Ÿn
::
docid
 
did
;

160 
	mX­Ÿn
::
‹rmcouÁ
 
wdf
;

163 
boŞ
 
	mis_©_’d
;

166 
	mX­Ÿn
::
doccouÁ
 
numb”_of_’Œ›s
;

169 
Ch”tPo¡Li¡
(const ChertPostList &);

172 
	mİ”©Ü
=(cÚ¡ 
Ch”tPo¡Li¡
 &);

177 
boŞ
 
Ãxt_š_chunk
();

184 
Ãxt_chunk
();

193 
boŞ
 
cu¼’t_chunk_cÚšs
(
X­Ÿn
::
docid
 
desœed_did
);

206 
move_to_chunk_cÚššg
(
X­Ÿn
::
docid
 
desœed_did
);

217 
boŞ
 
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
X­Ÿn
::
docid
 
desœed_did
);

219 
	mpublic
:

221 
Ch”tPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
this_db_
,

222 cÚ¡ 
¡ršg
 & 
‹rm
,

223 
boŞ
 
k“p_»ã»nû
);

226 ~
Ch”tPo¡Li¡
();

232 
boŞ
 
jump_to
(
X­Ÿn
::
docid
 
desœed_did
);

238 
	mX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(ècÚ¡ {  
numb”_of_’Œ›s
; }

241 
X­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ { 
	`As£¹
(
have_¡¬‹d
);  
did
; 
	}
}

244 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

249 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
(ècÚ¡ { 
	`As£¹
(
have_¡¬‹d
);  
wdf
; 
	}
}

253 
Pos™iÚLi¡
 *
»ad_pos™iÚ_li¡
();

257 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

260 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

263 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
);

266 
boŞ
 
	$©_’d
(ècÚ¡ {  
is_©_’d
; 
	}
}

269 
	g¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

272 
	`»ad_numb”_of_’Œ›s
(cÚ¡ ** 
po¥Œ
,

273 cÚ¡ * 
’d
,

274 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

275 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
);

276 
	}
};

	@backends/chert/chert_record.cc

22 
	~<cÚfig.h
>

24 
	~"ch”t_»cÜd.h
"

26 
	~<x­Ÿn/”rÜ.h
>

27 
	~"omas£¹.h
"

28 
	~"omdebug.h
"

29 
	~"·ck.h
"

30 
	~"uts.h
"

32 
usšg
 
	g¡d
::
¡ršg
;

34 
šlše
 
¡ršg


35 
make_key
(
X­Ÿn
::
docid
 
did
)

37 
LOGLINE
(
DB
, "make_key for ChertRecord");

38 
¡ršg
 
	gkey
;

39 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

40  
	gkey
;

43 
¡ršg


44 
	gCh”tRecÜdTabË
::
g‘_»cÜd
(
X­Ÿn
::
docid
 
did
) const

46 
DEBUGCALL
(
DB
, 
¡ršg
, "Ch”tRecÜdTabË::g‘_»cÜd", 
did
);

47 
¡ršg
 
	gg
;

49 ià(!
g‘_exaù_’Œy
(
make_key
(
did
), 
g
)) {

50 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Docum’ˆ" + 
om_to¡ršg
(
did
) + "‚ot found.");

53 
RETURN
(
g
);

56 
	gX­Ÿn
::
doccouÁ


57 
Ch”tRecÜdTabË
::
	$g‘_doccouÁ
() const

59 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "ChertRecordTable::get_doccount", "");

60 
ch”t_bËsize_t
 
couÁ
 = 
	`g‘_’Œy_couÁ
();

61 ià(
	`¿»
(
couÁ
 > 
	`ch”t_bËsize_t
(
X­Ÿn
::
	`doccouÁ
(-1)))) {

64 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Impossibly manyƒntries inhe„ecordable");

66 
	`RETURN
(
X­Ÿn
::
	`doccouÁ
(
couÁ
));

67 
	}
}

70 
	gCh”tRecÜdTabË
::
»¶aû_»cÜd
(cÚ¡ 
¡ršg
 & 
d©a
, 
X­Ÿn
::
docid
 
did
)

72 
DEBUGCALL
(
DB
, , "Ch”tRecÜdTabË::»¶aû_»cÜd", 
d©a
 << ", " << 
did
);

73 
LOGLINE
(
DB
, "First make key,hen‡dd");

74 
add
(
make_key
(
did
), 
d©a
);

78 
	gCh”tRecÜdTabË
::
d–‘e_»cÜd
(
X­Ÿn
::
docid
 
did
)

80 
DEBUGCALL
(
DB
, , "Ch”tRecÜdTabË::d–‘e_»cÜd", 
did
);

81 ià(!
d–
(
make_key
(
did
)))

82 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Cª'ˆd–‘nÚ-exi¡’ˆdocum’ˆ#" + 
om_to¡ršg
(
did
));

	@backends/chert/chert_record.h

23 #iâdeà
OM_HGUARD_CHERT_RECORD_H


24 
	#OM_HGUARD_CHERT_RECORD_H


	)

26 
	~<¡ršg
>

28 
	~<x­Ÿn/ty³s.h
>

29 
	~"ch”t_ty³s.h
"

30 
	~"ch”t_bË.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

36 şas 
	cCh”tRecÜdTabË
 : 
public
 
Ch”tTabË
 {

37 
public
:

50 
	$Ch”tRecÜdTabË
(cÚ¡ 
¡ršg
 & 
·th_
, 
boŞ
 
»adÚly_
)

51 : 
	`Ch”tTabË
("»cÜd", 
·th_
 + "/»cÜd.", 
»adÚly_
, 
Z_DEFAULT_STRATEGY
) { }

55 
¡ršg
 
	`g‘_»cÜd
(
X­Ÿn
::
docid
 
did
) const;

59 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

65 
	`»¶aû_»cÜd
(cÚ¡ 
¡ršg
 & 
d©a
, 
X­Ÿn
::
docid
 
did
);

69 
	`d–‘e_»cÜd
(
X­Ÿn
::
docid
 
did
);

70 
	}
};

	@backends/chert/chert_replicate_internal.h

22 #iâdeà
XAPIAN_INCLUDED_CHERT_REPLICATE_INTERNAL_H


23 
	#XAPIAN_INCLUDED_CHERT_REPLICATE_INTERNAL_H


	)

26 
	#CHANGES_MAGIC_STRING
 "Ch”tChªges"

	)

30 
	#CHANGES_VERSION
 1u

	)

34 
	#REASONABLE_CHANGESET_SIZE
 1024

	)

	@backends/chert/chert_spelling.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/”rÜ.h
>

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"ex·ndweight.h
"

27 
	~"ch”t_¥–lšg.h
"

28 
	~"omas£¹.h
"

29 
	~"Ü‹rmli¡.h
"

30 
	~"·ck.h
"

32 
	~<®gÜ™hm
>

33 
	~<m­
>

34 
	~<queue
>

35 
	~<veùÜ
>

36 
	~<£t
>

37 
	~<¡ršg
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

45 
	#MAGIC_XOR_VALUE
 96

	)

47 şas 
	cP»fixCom´es£dSŒšgItÜ
 {

48 cÚ¡ * 
	mp
;

49 
size_t
 
	mËá
;

50 
¡ršg
 
	mcu¼’t
;

52 
	$P»fixCom´es£dSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
,

53 cÚ¡ 
¡ršg
 &
cu¼’t_
)

54 : 
	`p
(
p_
), 
	`Ëá
(
Ëá_
), 
	$cu¼’t
(
cu¼’t_
) { }

56 
public
:

57 
	`P»fixCom´es£dSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

58 : 
	`p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
	`d©a
())),

59 
	`Ëá
(
s
.
	$size
()) {

60 ià(
Ëá
) {

61 
İ”©Ü
++();

63 
p
 = 
NULL
;

65 
	}
}

67 cÚ¡ 
	g¡ršg
 & 
	gİ”©Ü
*() const {

68  
	gcu¼’t
;

71 
P»fixCom´es£dSŒšgItÜ
 
	gİ”©Ü
++() {

72 cÚ¡ * 
	gŞd_p
 = 
p
;

73 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

74 
¡ršg
 
	gŞd_cu¼’t
 = 
cu¼’t
;

75 
	gİ”©Ü
++();

76  
P»fixCom´es£dSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
, 
Şd_cu¼’t
);

79 
	gP»fixCom´es£dSŒšgItÜ
 & 
	gİ”©Ü
++() {

80 ià(
	gËá
 == 0) {

81 
p
 = 
NULL
;

83 ià(!
	gcu¼’t
.
em±y
()) {

84 
	gcu¼’t
.
»size
(*
p
++ ^ 
MAGIC_XOR_VALUE
);

85 --
	gËá
;

87 
size_t
 
	gadd
;

88 ià(
	gËá
 =ğ0 || (
add
 = *
p
 ^ 
MAGIC_XOR_VALUE
è>ğ
Ëá
)

89 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling data (too†ittle†eft)");

90 
	gcu¼’t
.
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
add
);

91 
	gp
 +ğ
add
 + 1;

92 
	gËá
 -ğ
add
 + 1;

94  *
	gthis
;

97 
boŞ
 
	$©_’d
() const {

98  
p
 =ğ
NULL
;

99 
	}
}

102 şas 
	cP»fixCom´es£dSŒšgWr™”
 {

103 
¡ršg
 
	mcu¼’t
;

104 
	m¡ršg
 & 
	mout
;

106 
	mpublic
:

107 
	$P»fixCom´es£dSŒšgWr™”
(
¡ršg
 & 
out_
è: 
	$out
(
out_
) { }

109 
	$­³nd
(cÚ¡ 
¡ršg
 & 
wÜd
) {

112 ià(!
cu¼’t
.
	`em±y
()) {

113 
size_t
 
Ën
 = 
	`mš
(
cu¼’t
.
	`size
(), 
wÜd
.size());

114 
size_t
 
i
;

115 
i
 = 0; i < 
Ën
; ++i) {

116 ià(
cu¼’t
[
i
] !ğ
wÜd
[i]) ;

118 
out
 +ğ(
i
 ^ 
MAGIC_XOR_VALUE
);

119 
out
 +ğ((
wÜd
.
	`size
(è- 
i
è^ 
MAGIC_XOR_VALUE
);

120 
out
.
	`­³nd
(
wÜd
.
	`d©a
(è+ 
i
, wÜd.
	`size
() - i);

122 
out
 +ğ(
wÜd
.
	`size
(è^ 
MAGIC_XOR_VALUE
);

123 
out
 +ğ
wÜd
;

125 
cu¼’t
 = 
wÜd
;

126 
	}
}

130 
	gCh”tS³ÎšgTabË
::
	$m”ge_chªges
()

132 
m­
<
äagm’t
, 
£t
<
¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

133 
i
 = 
‹rmli¡_d–s
.
	`begš
(); i !ğ‹rmli¡_d–s.
	`’d
(); ++i) {

134 
¡ršg
 
key
 = 
i
->
fœ¡
;

135 cÚ¡ 
£t
<
¡ršg
> & 
chªges
 = 
i
->
£cÚd
;

137 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
d
 = 
chªges
.
	`begš
();

138 ià(
d
 =ğ
chªges
.
	`’d
()) ;

140 
¡ršg
 
upd©ed
;

141 
¡ršg
 
cu¼’t
;

142 
P»fixCom´es£dSŒšgWr™”
 
	`out
(
upd©ed
);

143 ià(
	`g‘_exaù_’Œy
(
key
, 
cu¼’t
)) {

144 
P»fixCom´es£dSŒšgItÜ
 
	`š
(
cu¼’t
);

145 
upd©ed
.
	`»£rve
(
cu¼’t
.
	`size
());

146 !
š
.
	`©_’d
(è&& 
d
 !ğ
chªges
.
	`’d
()) {

147 cÚ¡ 
¡ršg
 & 
wÜd
 = *
š
;

148 
	`As£¹
(
d
 !ğ
chªges
.
	`’d
());

149 
cmp
 = 
wÜd
.
	`com·»
(*
d
);

150 ià(
cmp
 < 0) {

151 
out
.
	`­³nd
(
wÜd
);

152 ++
š
;

153 } ià(
cmp
 > 0) {

154 
out
.
	`­³nd
(*
d
);

155 ++
d
;

159 ++
š
;

160 ++
d
;

163 ià(!
š
.
	`©_’d
()) {

165 !
š
.
	`©_’d
()) {

166 
out
.
	`­³nd
(*
š
++);

170 
d
 !ğ
chªges
.
	`’d
()) {

171 
out
.
	`­³nd
(*
d
++);

173 ià(!
upd©ed
.
	`em±y
()) {

174 
	`add
(
key
, 
upd©ed
);

176 
	`d–
(
key
);

179 
‹rmli¡_d–s
.
	`ş—r
();

181 
m­
<
¡ršg
, 
X­Ÿn
::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
j
;

182 
j
 = 
wÜdäeq_chªges
.
	`begš
(); j !ğwÜdäeq_chªges.
	`’d
(); ++j) {

183 
¡ršg
 
key
 = "W" + 
j
->
fœ¡
;

184 ià(
j
->
£cÚd
) {

185 
¡ršg
 
g
;

186 
	`·ck_ušt_Ï¡
(
g
, 
j
->
£cÚd
);

187 
	`add
(
key
, 
g
);

189 
	`d–
(
key
);

192 
wÜdäeq_chªges
.
	`ş—r
();

193 
	}
}

196 
	gCh”tS³ÎšgTabË
::
	$toggË_äagm’t
(
äagm’t
 
äag
, cÚ¡ 
¡ršg
 & 
wÜd
)

198 
m­
<
äagm’t
, 
£t
<
¡ršg
> >::
™”©Ü
 
i
 = 
‹rmli¡_d–s
.
	`fšd
(
äag
);

199 ià(
i
 =ğ
‹rmli¡_d–s
.
	`’d
()) {

200 
i
 = 
‹rmli¡_d–s
.
	`š£¹
(
	`make_·œ
(
äag
, 
£t
<
¡ršg
>())).
fœ¡
;

204 
·œ
<
£t
<
¡ršg
>::
™”©Ü
, 
boŞ
> 
»s
 = 
i
->
£cÚd
.
	`š£¹
(
wÜd
);

205 ià(!
»s
.
£cÚd
) {

207 
i
->
£cÚd
.
	`”a£
(
»s
.
fœ¡
);

209 
	}
}

212 
	gCh”tS³ÎšgTabË
::
add_wÜd
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
)

214 ià(
wÜd
.
size
() <= 1) ;

216 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
‹rmcouÁ
>::
™”©Ü
 
i
 = 
wÜdäeq_chªges
.
fšd
(
wÜd
);

217 ià(
	gi
 !ğ
wÜdäeq_chªges
.
’d
()) {

219 ià(
i
->
£cÚd
) {

220 
i
->
£cÚd
 +ğ
äeqšc
;

225 
	gi
->
	g£cÚd
 = 
äeqšc
;

227 
¡ršg
 
	gkey
 = "W" + 
wÜd
;

228 
¡ršg
 
	gd©a
;

229 ià(
g‘_exaù_’Œy
(
key
, 
d©a
)) {

231 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

232 cÚ¡ * 
	gp
 = 
d©a
.data();

233 ià(!
uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
size
(), &
äeq
è|| 
	gäeq
 == 0) {

234 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

236 
	gwÜdäeq_chªges
[
wÜd
] = 
äeq
 + 
äeqšc
;

239 
	gwÜdäeq_chªges
[
wÜd
] = 
äeqšc
;

244 
äagm’t
 
	gbuf
;

246 
	gbuf
[0] = 'H';

247 
	gbuf
[1] = 
wÜd
[0];

248 
	gbuf
[2] = 
wÜd
[1];

249 
	gbuf
[3] = '\0';

250 
toggË_äagm’t
(
buf
, 
wÜd
);

253 
	gbuf
[0] = 'T';

254 
	gbuf
[1] = 
wÜd
[wÜd.
size
() - 2];

255 
	gbuf
[2] = 
wÜd
[wÜd.
size
() - 1];

256 
	gbuf
[3] = '\0';

257 
toggË_äagm’t
(
buf
, 
wÜd
);

259 ià(
	gwÜd
.
size
() <= 4) {

266 
buf
[0] = 'B';

267 
	gbuf
[1] = 
wÜd
[0];

268 
	gbuf
[3] = '\0';

269 
toggË_äagm’t
(
buf
, 
wÜd
);

271 ià(
	gwÜd
.
size
() > 2) {

273 
	gbuf
[0] = 'M';

274 
size_t
 
	g¡¬t
 = 0; s¹ <ğ
wÜd
.
size
() - 3; ++start) {

275 
memıy
(
buf
.
d©a
 + 1, 
wÜd
.d©a(è+ 
¡¬t
, 3);

276 
toggË_äagm’t
(
buf
, 
wÜd
);

282 
	gCh”tS³ÎšgTabË
::
»move_wÜd
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
)

284 
m­
<
¡ršg
, 
	gX­Ÿn
::
‹rmcouÁ
>::
™”©Ü
 
i
 = 
wÜdäeq_chªges
.
fšd
(
wÜd
);

285 ià(
	gi
 !ğ
wÜdäeq_chªges
.
’d
()) {

286 ià(
i
->
£cÚd
 == 0) {

291 ià(
	gäeqdec
 < 
	gi
->
	g£cÚd
) {

292 
	gi
->
	g£cÚd
 -ğ
äeqdec
;

297 
	gi
->
	g£cÚd
 = 0;

299 
¡ršg
 
	gkey
 = "W" + 
wÜd
;

300 
¡ršg
 
	gd©a
;

301 ià(!
g‘_exaù_’Œy
(
key
, 
d©a
)) {

306 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

307 cÚ¡ *
	gp
 = 
d©a
.data();

308 ià(!
uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
size
(), &
äeq
)) {

309 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

311 ià(
	gäeqdec
 < 
	gäeq
) {

312 
	gwÜdäeq_chªges
[
wÜd
] = 
äeq
 - 
äeqdec
;

316 
	gwÜdäeq_chªges
[
wÜd
] = 0;

321 
äagm’t
 
	gbuf
;

323 
	gbuf
[0] = 'H';

324 
	gbuf
[1] = 
wÜd
[0];

325 
	gbuf
[2] = 
wÜd
[1];

326 
	gbuf
[3] = '\0';

327 
toggË_äagm’t
(
buf
, 
wÜd
);

330 
	gbuf
[0] = 'T';

331 
	gbuf
[1] = 
wÜd
[wÜd.
size
() - 2];

332 
	gbuf
[2] = 
wÜd
[wÜd.
size
() - 1];

333 
	gbuf
[3] = '\0';

334 
toggË_äagm’t
(
buf
, 
wÜd
);

336 ià(
	gwÜd
.
size
() <= 4) {

338 
buf
[0] = 'B';

339 
	gbuf
[1] = 
wÜd
[0];

340 
	gbuf
[3] = '\0';

341 
toggË_äagm’t
(
buf
, 
wÜd
);

343 ià(
	gwÜd
.
size
() > 2) {

345 
	gbuf
[0] = 'M';

346 
size_t
 
	g¡¬t
 = 0; s¹ <ğ
wÜd
.
size
() - 3; ++start) {

347 
memıy
(
buf
.
d©a
 + 1, 
wÜd
.d©a(è+ 
¡¬t
, 3);

348 
toggË_äagm’t
(
buf
, 
wÜd
);

353 
	sT”mLi¡G»©”AµroxSize
 {

354 
boŞ
 
İ”©Ü
()(cÚ¡ 
T”mLi¡
 *
	ma
, cÚ¡ T”mLi¡ *
	mb
) {

355  
	ma
->
g‘_­´ox_size
(è> 
	mb
->get_approx_size();

359 
T”mLi¡
 *

360 
	gCh”tS³ÎšgTabË
::
	$İ’_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
)

363 
	`As£¹R–
(
wÜd
.
	`size
(),>,1);

367 ià(!
wÜdäeq_chªges
.
	`em±y
()è
	`m”ge_chªges
();

371 
´iÜ™y_queue
<
T”mLi¡
*, 
veùÜ
<T”mLi¡*>, 
T”mLi¡G»©”AµroxSize
> 
pq
;

372 
Œy
 {

373 
¡ršg
 
d©a
;

374 
äagm’t
 
buf
;

377 
buf
[0] = 'H';

378 
buf
[1] = 
wÜd
[0];

379 
buf
[2] = 
wÜd
[1];

380 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

381 
pq
.
	`push
(
Ãw
 
	`Ch”tS³ÎšgT”mLi¡
(
d©a
));

384 
buf
[0] = 'T';

385 
buf
[1] = 
wÜd
[wÜd.
	`size
() - 2];

386 
buf
[2] = 
wÜd
[wÜd.
	`size
() - 1];

387 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

388 
pq
.
	`push
(
Ãw
 
	`Ch”tS³ÎšgT”mLi¡
(
d©a
));

390 ià(
wÜd
.
	`size
() <= 4) {

396 
buf
[0] = 'B';

397 
buf
[1] = 
wÜd
[0];

398 
buf
[3] = '\0';

399 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

400 
pq
.
	`push
(
Ãw
 
	`Ch”tS³ÎšgT”mLi¡
(
d©a
));

402 ià(
wÜd
.
	`size
() > 2) {

404 
buf
[0] = 'M';

405 
size_t
 
¡¬t
 = 0; s¹ <ğ
wÜd
.
	`size
() - 3; ++start) {

406 
	`memıy
(
buf
.
d©a
 + 1, 
wÜd
.
	`d©a
(è+ 
¡¬t
, 3);

407 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

408 
pq
.
	`push
(
Ãw
 
	`Ch”tS³ÎšgT”mLi¡
(
d©a
));

411 ià(
wÜd
.
	`size
() == 3) {

416 
buf
[1] = 
wÜd
[1];

417 
buf
[2] = 
wÜd
[0];

418 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

419 
pq
.
	`push
(
Ãw
 
	`Ch”tS³ÎšgT”mLi¡
(
d©a
));

421 
buf
[1] = 
wÜd
[0];

422 
buf
[2] = 
wÜd
[2];

423 
buf
[3] = 
wÜd
[1];

424 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

425 
pq
.
	`push
(
Ãw
 
	`Ch”tS³ÎšgT”mLi¡
(
d©a
));

428 
	`As£¹
(
wÜd
.
	`size
() == 2);

433 
buf
[0] = 'H';

434 
buf
[1] = 
wÜd
[1];

435 
buf
[2] = 
wÜd
[0];

436 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

437 
pq
.
	`push
(
Ãw
 
	`Ch”tS³ÎšgT”mLi¡
(
d©a
));

438 
buf
[0] = 'T';

439 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

440 
pq
.
	`push
(
Ãw
 
	`Ch”tS³ÎšgT”mLi¡
(
d©a
));

443 ià(
pq
.
	`em±y
()è 
NULL
;

452 
pq
.
	`size
() > 1) {

455 
T”mLi¡
 * 
‹rmli¡
 = 
pq
.
	`tİ
();

456 
pq
.
	`pİ
();

458 
‹rmli¡
 = 
Ãw
 
	`OrT”mLi¡
(
pq
.
	`tİ
(),ermlist);

459 
pq
.
	`pİ
();

460 
pq
.
	`push
(
‹rmli¡
);

463  
pq
.
	`tİ
();

464 } 
	`ÿtch
 (...) {

467 !
pq
.
	`em±y
()) {

468 
d–‘e
 
pq
.
	`tİ
();

469 
pq
.
	`pİ
();

471 
throw
;

473 
	}
}

475 
	gX­Ÿn
::
doccouÁ


476 
Ch”tS³ÎšgTabË
::
	$g‘_wÜd_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const

478 
m­
<
¡ršg
, 
X­Ÿn
::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
i
;

479 
i
 = 
wÜdäeq_chªges
.
	`fšd
(
wÜd
);

480 ià(
i
 !ğ
wÜdäeq_chªges
.
	`’d
()) {

482  
i
->
£cÚd
;

485 
¡ršg
 
key
 = "W" + 
wÜd
;

486 
¡ršg
 
d©a
;

487 ià(
	`g‘_exaù_’Œy
(
key
, 
d©a
)) {

489 
X­Ÿn
::
‹rmcouÁ
 
äeq
;

490 cÚ¡ *
p
 = 
d©a
.
	`d©a
();

491 ià(!
	`uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
	`size
(), &
äeq
)) {

492 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spelling word freq");

494  
äeq
;

498 
	}
}

502 
	gX­Ÿn
::
‹rmcouÁ


503 
Ch”tS³ÎšgT”mLi¡
::
	$g‘_­´ox_size
() const

507  
d©a
.
	`size
();

508 
	}
}

510 
	g¡d
::
¡ršg


511 
Ch”tS³ÎšgT”mLi¡
::
	$g‘_‹rmÇme
() const

513  
cu¼’t_‹rm
;

514 
	}
}

516 
	gX­Ÿn
::
‹rmcouÁ


517 
Ch”tS³ÎšgT”mLi¡
::
	$g‘_wdf
() const

520 
	}
}

522 
	gX­Ÿn
::
doccouÁ


523 
Ch”tS³ÎšgT”mLi¡
::
	$g‘_‹rmäeq
() const

526 
	}
}

528 
	gX­Ÿn
::
‹rmcouÁ


529 
Ch”tS³ÎšgT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

532 
	}
}

534 
T”mLi¡
 *

535 
	gCh”tS³ÎšgT”mLi¡
::
	$Ãxt
()

537 ià(
p
 =ğ
d©a
.
	`size
()) {

538 
p
 = 0;

539 
d©a
.
	`»size
(0);

540  
NULL
;

542 ià(!
cu¼’t_‹rm
.
	`em±y
()) {

543 ià(
p
 =ğ
d©a
.
	`size
())

544 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spellingermlist");

545 
cu¼’t_‹rm
.
	`»size
(
	`by‹
(
d©a
[
p
++]è^ 
MAGIC_XOR_VALUE
);

547 
size_t
 
add
;

548 ià(
p
 =ğ
d©a
.
	`size
() ||

549 (
add
 = 
	`by‹
(
d©a
[
p
]è^ 
MAGIC_XOR_VALUE
è>ğd©a.
	`size
() -…)

550 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spellingermlist");

551 
cu¼’t_‹rm
.
	`­³nd
(
d©a
.
	`d©a
(è+ 
p
 + 1, 
add
);

552 
p
 +ğ
add
 + 1;

553  
NULL
;

554 
	}
}

556 
boŞ


557 
	gCh”tS³ÎšgT”mLi¡
::
	$©_’d
() const

559  
d©a
.
	`em±y
();

560 
	}
}

562 
	gX­Ÿn
::
‹rmcouÁ


563 
Ch”tS³ÎšgT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

565 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("ChertSpellingTermList::positionlist_count()‚ot implemented");

566 
	}
}

568 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


569 
Ch”tS³ÎšgT”mLi¡
::
	$pos™iÚli¡_begš
() const

571 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("ChertSpellingTermList::positionlist_begin()‚ot implemented");

572 
	}
}

	@backends/chert/chert_spelling.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_SPELLING_H


22 
	#XAPIAN_INCLUDED_CHERT_SPELLING_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"ch”t_ÏzybË.h
"

27 
	~"‹rmli¡.h
"

29 
	~<m­
>

30 
	~<£t
>

31 
	~<¡ršg
>

32 
	~<c¡ršg
>

34 
	säagm’t
 {

35 
	md©a
[4];

38 
äagm’t
() { }

41 
äagm’t
(
d©a_
[4]è{ 
	m¡d
::
memıy
(
d©a
, data_, 4); }

43 & 
	mİ”©Ü
[] (
	mi
è{  
	md©a
[
i
]; }

44 cÚ¡ & 
	mİ”©Ü
[] (
	mi
ècÚ¡ {  
	md©a
[
i
]; }

46 
İ”©Ü
 
	m¡d
::
¡ršg
 () const {

47  
¡d
::
¡ršg
(
d©a
, data[0] == 'M' ? 4 : 3);

51 
šlše
 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gäagm’t
 &
	ga
, cÚ¡ f¿gm’ˆ&
	gb
) {

52  
	g¡d
::
memcmp
(
a
.
d©a
, 
b
.data, 4) < 0;

55 şas 
	cCh”tS³ÎšgTabË
 : 
public
 
Ch”tLazyTabË
 {

56 
toggË_äagm’t
(
äagm’t
 
äag
, cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
);

58 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mX­Ÿn
::
‹rmcouÁ
> 
wÜdäeq_chªges
;

59 
	m¡d
::
m­
<
äagm’t
, std::
£t
<
¡d
::
¡ršg
> > 
‹rmli¡_d–s
;

61 
	mpublic
:

70 
Ch”tS³ÎšgTabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

71 : 
Ch”tLazyTabË
("¥–lšg", 
dbdœ
 + "/¥–lšg.", 
»adÚly
,

72 
Z_DEFAULT_STRATEGY
) { }

75 
m”ge_chªges
();

77 
add_wÜd
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
);

78 
»move_wÜd
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
);

80 
T”mLi¡
 * 
İ’_‹rmli¡
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
);

82 
	gX­Ÿn
::
doccouÁ
 
g‘_wÜd_äequ’cy
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
) const;

91 
boŞ
 
	$is_modif›d
() const {

92  !
wÜdäeq_chªges
.
	`em±y
(è|| 
Ch”tTabË
::
	`is_modif›d
();

93 
	}
}

95 
	$æush_db
() {

96 
	`m”ge_chªges
();

97 
Ch”tTabË
::
	`æush_db
();

98 
	}
}

100 
	$ÿnûl
() {

102 
wÜdäeq_chªges
.
	`ş—r
();

103 
‹rmli¡_d–s
.
	`ş—r
();

105 
Ch”tTabË
::
	`ÿnûl
();

106 
	}
}

112 şas 
	cCh”tS³ÎšgT”mLi¡
 : 
public
 
T”mLi¡
 {

114 
¡d
::
¡ršg
 
d©a
;

117 
	mp
;

120 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

123 
Ch”tS³ÎšgT”mLi¡
(const ChertSpellingTermList &);

126 
	mİ”©Ü
=(cÚ¡ 
Ch”tS³ÎšgT”mLi¡
 &);

128 
	mpublic
:

130 
Ch”tS³ÎšgT”mLi¡
(cÚ¡ 
¡d
::
¡ršg
 & 
d©a_
)

131 : 
d©a
(
d©a_
), 
	$p
(0) { }

133 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

135 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

137 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

139 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

141 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

143 
T”mLi¡
 *
	`Ãxt
();

145 
boŞ
 
	$©_’d
() const;

147 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

149 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

150 
	}
};

	@backends/chert/chert_spellingwordslist.cc

23 
	~<cÚfig.h
>

25 
	~<x­Ÿn/”rÜ.h
>

26 
	~<x­Ÿn/ty³s.h
>

28 
	~"ch”t_¥–lšgwÜd¦i¡.h
"

29 
	~"·ck.h
"

30 
	~"¡ršguts.h
"

32 
	gCh”tS³ÎšgWÜdsLi¡
::~
	$Ch”tS³ÎšgWÜdsLi¡
()

34 
	`DEBUGCALL
(
DB
, , "~ChertSpellingWordsList", "");

35 
d–‘e
 
cursÜ
;

36 
	}
}

38 
¡ršg


39 
	gCh”tS³ÎšgWÜdsLi¡
::
	$g‘_‹rmÇme
() const

41 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertSpellingWordsList::get_termname", "");

42 
	`As£¹
(
cursÜ
);

43 
	`As£¹
(!
	`©_’d
());

44 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

45 
	`As£¹
(
cursÜ
->
cu¼’t_key
[0] == 'W');

46 
	`RETURN
(
cursÜ
->
cu¼’t_key
.
	`sub¡r
(1));

47 
	}
}

49 
	gX­Ÿn
::
doccouÁ


50 
Ch”tS³ÎšgWÜdsLi¡
::
	$g‘_‹rmäeq
() const

52 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertSpellingWordsList::get_termfreq", "");

53 
	`As£¹
(
cursÜ
);

54 
	`As£¹
(!
	`©_’d
());

55 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

56 
	`As£¹
(
cursÜ
->
cu¼’t_key
[0] == 'W');

57 
cursÜ
->
	`»ad_g
();

59 
X­Ÿn
::
‹rmcouÁ
 
äeq
;

60 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

61 ià(!
	`uÅack_ušt_Ï¡
(&
p
,… + 
cursÜ
->
cu¼’t_g
.
	`size
(), &
äeq
)) {

62 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spelling word freq");

64  
äeq
;

65 
	}
}

67 
	gX­Ÿn
::
‹rmcouÁ


68 
Ch”tS³ÎšgWÜdsLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

70 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("ChertSpellingWordsList::get_collection_freq()‚ot meaningful");

71 
	}
}

73 
T”mLi¡
 *

74 
	gCh”tS³ÎšgWÜdsLi¡
::
	$Ãxt
()

76 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "ChertSpellingWordsList::next", "");

77 
	`As£¹
(!
	`©_’d
());

79 
cursÜ
->
	`Ãxt
();

80 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 'W')) {

82 
cursÜ
->
	`to_’d
();

85 
	`RETURN
(
NULL
);

86 
	}
}

88 
T”mLi¡
 *

89 
	gCh”tS³ÎšgWÜdsLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
Šame
)

91 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "Ch”tS³ÎšgWÜdsLi¡::sk_to", 
Šame
);

92 
	`As£¹
(!
	`©_’d
());

94 ià(!
cursÜ
->
	`fšd_’Œy_ge
("W" + 
Šame
)) {

97 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 'W')) {

99 
cursÜ
->
	`to_’d
();

102 
	`RETURN
(
NULL
);

103 
	}
}

105 
boŞ


106 
	gCh”tS³ÎšgWÜdsLi¡
::
	$©_’d
() const

108 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertSpellingWordsList::at_end", "");

109 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

110 
	}
}

	@backends/chert/chert_spellingwordslist.h

21 #iâdeà
XAPIAN_HGUARD_CHERT_SPELLINGWORDSLIST_H


22 
	#XAPIAN_HGUARD_CHERT_SPELLINGWORDSLIST_H


	)

24 
	~"®É”m¦i¡.h
"

25 
	~"d©aba£.h
"

26 
	~"ch”t_¥–lšg.h
"

28 
şass
 
	gCh”tCursÜ
;

30 şas 
	cCh”tS³ÎšgWÜdsLi¡
 : 
public
 
AÎT”msLi¡
 {

32 
Ch”tS³ÎšgWÜdsLi¡
(const ChertSpellingWordsList &);

35 
	mİ”©Ü
=(cÚ¡ 
Ch”tS³ÎšgWÜdsLi¡
 &);

38 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

43 
Ch”tCursÜ
 * 
	mcursÜ
;

51 
mubË
 
	mX­Ÿn
::
‹rmcouÁ
 
‹rmäeq
;

54 
	$»ad_‹rmäeq
() const;

56 
public
:

57 
	`Ch”tS³ÎšgWÜdsLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

58 
Ch”tCursÜ
 * 
cursÜ_
)

59 : 
	`d©aba£
(
d©aba£_
), 
	`cursÜ
(
cursÜ_
), 
	$‹rmäeq
(0) {

62 
cursÜ
->
	`fšd_’Œy
(
¡d
::
	`¡ršg
("W", 1));

66 ~
	`Ch”tS³ÎšgWÜdsLi¡
();

73 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

80 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

87 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

90 
T”mLi¡
 * 
	`Ãxt
();

93 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
);

96 
boŞ
 
	$©_’d
() const;

97 
	}
};

	@backends/chert/chert_synonym.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/”rÜ.h
>

25 
	~"ch”t_cursÜ.h
"

26 
	~"ch”t_synÚym.h
"

27 
	~"¡ršguts.h
"

28 
	~"veùÜ‹rmli¡.h
"

30 
	~<£t
>

31 
	~<¡ršg
>

32 
	~<veùÜ
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	#MAGIC_XOR_VALUE
 96

	)

42 
	gCh”tSynÚymTabË
::
	$m”ge_chªges
()

44 ià(
Ï¡_‹rm
.
	`em±y
()) ;

46 ià(
Ï¡_synÚyms
.
	`em±y
()) {

47 
	`d–
(
Ï¡_‹rm
);

49 
¡ršg
 
g
;

51 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

52 
i
 = 
Ï¡_synÚyms
.
	`begš
(); i !ğÏ¡_synÚyms.
	`’d
(); ++i) {

53 cÚ¡ 
¡ršg
 & 
synÚym
 = *
i
;

54 
g
 +ğ
	`by‹
(
synÚym
.
	`size
(è^ 
MAGIC_XOR_VALUE
);

55 
g
 +ğ
synÚym
;

58 
	`add
(
Ï¡_‹rm
, 
g
);

59 
Ï¡_synÚyms
.
	`ş—r
();

61 
Ï¡_‹rm
.
	`»size
(0);

62 
	}
}

65 
	gCh”tSynÚymTabË
::
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
)

67 ià(
Ï¡_‹rm
 !ğ
‹rm
) {

68 
	`m”ge_chªges
();

69 
Ï¡_‹rm
 = 
‹rm
;

71 
¡ršg
 
g
;

72 ià(
	`g‘_exaù_’Œy
(
‹rm
, 
g
)) {

73 cÚ¡ * 
p
 = 
g
.
	`d©a
();

74 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

75 
p
 !ğ
’d
) {

76 
size_t
 
Ën
;

77 ià(
p
 =ğ
’d
 ||

78 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

79 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

80 ++
p
;

81 
Ï¡_synÚyms
.
	`š£¹
(
	`¡ršg
(
p
, 
Ën
));

82 
p
 +ğ
Ën
;

87 
Ï¡_synÚyms
.
	`š£¹
(
synÚym
);

88 
	}
}

91 
	gCh”tSynÚymTabË
::
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
)

93 ià(
Ï¡_‹rm
 !ğ
‹rm
) {

94 
	`m”ge_chªges
();

95 
Ï¡_‹rm
 = 
‹rm
;

97 
¡ršg
 
g
;

98 ià(
	`g‘_exaù_’Œy
(
‹rm
, 
g
)) {

99 cÚ¡ * 
p
 = 
g
.
	`d©a
();

100 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

101 
p
 !ğ
’d
) {

102 
size_t
 
Ën
;

103 ià(
p
 =ğ
’d
 ||

104 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

105 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

106 ++
p
;

107 
Ï¡_synÚyms
.
	`š£¹
(
	`¡ršg
(
p
, 
Ën
));

108 
p
 +ğ
Ën
;

113 
Ï¡_synÚyms
.
	`”a£
(
synÚym
);

114 
	}
}

117 
	gCh”tSynÚymTabË
::
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
‹rm
)

124 ià(
Ï¡_‹rm
 =ğ
‹rm
) {

125 
Ï¡_synÚyms
.
	`ş—r
();

127 
	`m”ge_chªges
();

128 
Ï¡_‹rm
 = 
‹rm
;

130 
	}
}

132 
T”mLi¡
 *

133 
	gCh”tSynÚymTabË
::
	$İ’_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
)

135 
veùÜ
<
¡ršg
> 
synÚyms
;

137 ià(
Ï¡_‹rm
 =ğ
‹rm
) {

138 ià(
Ï¡_synÚyms
.
	`em±y
()è 
NULL
;

140 
synÚyms
.
	`»£rve
(
Ï¡_synÚyms
.
	`size
());

141 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

142 
i
 = 
Ï¡_synÚyms
.
	`begš
(); i !ğÏ¡_synÚyms.
	`’d
(); ++i) {

143 
synÚyms
.
	`push_back
(*
i
);

146 
¡ršg
 
g
;

147 ià(!
	`g‘_exaù_’Œy
(
‹rm
, 
g
)è 
NULL
;

149 cÚ¡ * 
p
 = 
g
.
	`d©a
();

150 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

151 
p
 !ğ
’d
) {

152 
size_t
 
Ën
;

153 ià(
p
 =ğ
’d
 ||

154 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

155 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

156 ++
p
;

157 
synÚyms
.
	`push_back
(
	`¡ršg
(
p
, 
Ën
));

158 
p
 +ğ
Ën
;

162  
Ãw
 
	`VeùÜT”mLi¡
(
synÚyms
.
	`begš
(), synÚyms.
	`’d
());

163 
	}
}

167 
	gCh”tSynÚymT”mLi¡
::~
	$Ch”tSynÚymT”mLi¡
()

169 
	`DEBUGCALL
(
DB
, , "~ChertSynonymTermList", "");

170 
d–‘e
 
cursÜ
;

171 
	}
}

173 
¡ršg


174 
	gCh”tSynÚymT”mLi¡
::
	$g‘_‹rmÇme
() const

176 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertSynonymTermList::get_termname", "");

177 
	`As£¹
(
cursÜ
);

178 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

179 
	`As£¹
(!
	`©_’d
());

180 
	`RETURN
(
cursÜ
->
cu¼’t_key
);

181 
	}
}

183 
	gX­Ÿn
::
doccouÁ


184 
Ch”tSynÚymT”mLi¡
::
	$g‘_‹rmäeq
() const

186 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("ChertSynonymTermList::get_termfreq()‚ot meaningful");

187 
	}
}

189 
	gX­Ÿn
::
‹rmcouÁ


190 
Ch”tSynÚymT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

192 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("ChertSynonymTermList::get_collection_freq()‚ot meaningful");

193 
	}
}

195 
T”mLi¡
 *

196 
	gCh”tSynÚymT”mLi¡
::
	$Ãxt
()

198 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "ChertSynonymTermList::next", "");

199 
	`As£¹
(!
	`©_’d
());

201 
cursÜ
->
	`Ãxt
();

202 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

204 
cursÜ
->
	`to_’d
();

207 
	`RETURN
(
NULL
);

208 
	}
}

210 
T”mLi¡
 *

211 
	gCh”tSynÚymT”mLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
Šame
)

213 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "Ch”tSynÚymT”mLi¡::sk_to", 
Šame
);

214 
	`As£¹
(!
	`©_’d
());

216 ià(!
cursÜ
->
	`fšd_’Œy_ge
(
Šame
)) {

219 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

221 
cursÜ
->
	`to_’d
();

224 
	`RETURN
(
NULL
);

225 
	}
}

227 
boŞ


228 
	gCh”tSynÚymT”mLi¡
::
	$©_’d
() const

230 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertSynonymTermList::at_end", "");

231 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

232 
	}
}

	@backends/chert/chert_synonym.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_SYNONYM_H


22 
	#XAPIAN_INCLUDED_CHERT_SYNONYM_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"®É”m¦i¡.h
"

27 
	~"d©aba£.h
"

28 
	~"ch”t_ÏzybË.h
"

29 
	~"omdebug.h
"

30 
	~"‹rmli¡.h
"

32 
	~<£t
>

33 
	~<¡ršg
>

35 şas 
	cCh”tSynÚymTabË
 : 
public
 
Ch”tLazyTabË
 {

37 
mubË
 
¡d
::
¡ršg
 
Ï¡_‹rm
;

40 
mubË
 
	m¡d
::
£t
<
¡d
::
¡ršg
> 
Ï¡_synÚyms
;

42 
	mpublic
:

51 
Ch”tSynÚymTabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

52 : 
Ch”tLazyTabË
("synÚym", 
dbdœ
 + "/synÚym.", 
»adÚly
,

53 
Z_DEFAULT_STRATEGY
) { }

56 
m”ge_chªges
();

59 
	$disÿrd_chªges
() {

60 
Ï¡_‹rm
.
	`»size
(0);

61 
Ï¡_synÚyms
.
	`ş—r
();

62 
	}
}

68 
add_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, cÚ¡ std::¡ršg & 
synÚym
);

74 
»move_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, cÚ¡ std::¡ršg & 
synÚym
);

80 
ş—r_synÚyms
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
);

86 
T”mLi¡
 * 
İ’_‹rmli¡
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
);

95 
boŞ
 
	$is_modif›d
() const {

96  !
Ï¡_‹rm
.
	`em±y
(è|| 
Ch”tTabË
::
	`is_modif›d
();

97 
	}
}

99 
	$æush_db
() {

100 
	`m”ge_chªges
();

101 
Ch”tTabË
::
	`æush_db
();

102 
	}
}

104 
	$ÿnûl
() {

105 
	`disÿrd_chªges
();

106 
Ch”tTabË
::
	`ÿnûl
();

107 
	}
}

112 
şass
 
	gCh”tCursÜ
;

114 şas 
	cCh”tSynÚymT”mLi¡
 : 
public
 
AÎT”msLi¡
 {

116 
Ch”tSynÚymT”mLi¡
(const ChertSynonymTermList &);

119 
	mİ”©Ü
=(cÚ¡ 
Ch”tSynÚymT”mLi¡
 &);

122 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

127 
Ch”tCursÜ
 * 
	mcursÜ
;

130 
¡ršg
 
	m´efix
;

132 
	mpublic
:

133 
Ch”tSynÚymT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

134 
Ch”tCursÜ
 * 
cursÜ_
,

135 cÚ¡ 
¡ršg
 & 
´efix_
)

136 : 
d©aba£
(
d©aba£_
), 
cursÜ
(
cursÜ_
), 
	$´efix
(
´efix_
)

141 ià(
´efix
.
	`em±y
()) {

142 
cursÜ
->
	`fšd_’Œy
(
	`¡ršg
());

145 
cursÜ
->
	`fšd_’Œy_É
(
´efix
);

150 ~
	`Ch”tSynÚymT”mLi¡
();

157 
¡ršg
 
	$g‘_‹rmÇme
() const;

160 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

163 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

166 
T”mLi¡
 * 
	`Ãxt
();

169 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡ršg
 &
Šame
);

172 
boŞ
 
	$©_’d
() const;

173 
	}
};

	@backends/chert/chert_table.cc

24 
	~<cÚfig.h
>

26 
	~"ch”t_bË.h
"

28 
	~<x­Ÿn/”rÜ.h
>

30 
	~"§ã”ºo.h
"

31 #ifdeà
__WIN32__


32 
	~"msvc_posix_w¿µ”.h
"

35 
	~"omas£¹.h
"

36 
	~"¡ršguts.h
"

51 
	~<sys/ty³s.h
>

58 #ià
defšed
 
HAVE_PREAD
 && defšed 
PREAD_PROTOTYPE


59 
	gPREAD_PROTOTYPE


61 #ià
defšed
 
HAVE_PWRITE
 && defšed 
PWRITE_PROTOTYPE


62 
	gPWRITE_PROTOTYPE


65 
	~<c¡dio
>

66 
	~<c¡ršg
>

67 
	~<şim™s
>

69 
	~"ch”t_io.h
"

70 
	~"ch”t_bŒ“ba£.h
"

71 
	~"ch”t_cursÜ.h
"

73 
	~"omas£¹.h
"

74 
	~"omdebug.h
"

75 
	~"·ck.h
"

76 
	~"uÇligÃd.h
"

77 
	~"uts.h
"

79 
	~<®gÜ™hm
>

80 
	~<¡ršg
>

82 
usšg
 
Çme¥aû
 
	g¡d
;

85 cÚ¡ 
size_t
 
	gCOMPRESS_MIN
 = 4;

88 #undeà
BTREE_DEBUG_FULL


90 #ifdeà
BTREE_DEBUG_FULL


93 
´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
);

94 
´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
);

112 
	$sys_uÆšk
(cÚ¡ 
¡ršg
 &
f’ame
)

114 #ifdeà
__WIN32__


115 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

117 ià(
	`uÆšk
(
f’ame
) == -1) {

119 
¡ršg
 
mes§ge
 = "Failedo unlink ";

120 
mes§ge
 +ğ
f’ame
;

121 
mes§ge
 += ": ";

122 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

123 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
mes§ge
);

125 
	}
}

127 
šlše
 
by‹
 *
	$z”Ûd_Ãw
(
size_t
 
size
)

129 
by‹
 *
‹mp
 = 
Ãw
 by‹[
size
];

132 
	`As£¹
(
‹mp
);

133 
	`mem£t
(
‹mp
, 0, 
size
);

134  
‹mp
;

135 
	}
}

185 
	#SEQ_START_POINT
 (-10)

	)

189 
	#BLOCK_CAPACITY
 4

	)

204 
	#BYTE_PAIR_RANGE
 (1 << 2 * 
CHAR_BIT
)

	)

208 
	gCh”tTabË
::
	$»ad_block
(
ušt4
 
n
, 
by‹
 * 
p
) const

211 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::»ad_block", 
n
 << ", " << (*)
p
);

215 
	`As£¹
(
n
 / 
CHAR_BIT
 < 
ba£
.
	`g‘_b™_m­_size
());

217 #ifdeà
HAVE_PREAD


218 
off_t
 
off£t
 = 
	`off_t
(
block_size
è* 
n
;

219 
m
 = 
block_size
;

220 
Œue
) {

221 
ssize_t
 
by‹s_»ad
 = 
	`´—d
(
hªdË
, 
»š‹½»t_ÿ¡
<*>(
p
), 
m
,

222 
off£t
);

224 ià(
by‹s_»ad
 =ğ
m
) ;

225 ià(
by‹s_»ad
 == -1) {

226 ià(
”ºo
 =ğ
EINTR
) ;

227 
¡ršg
 
mes§ge
 = "E¼Ü„—dšg block " + 
	`om_to¡ršg
(
n
) + ": ";

228 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

229 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

230 } ià(
by‹s_»ad
 == 0) {

231 
¡ršg
 
mes§ge
 = "E¼Ü„—dšg block " + 
	`om_to¡ršg
(
n
) + ": gotƒnd of file";

232 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

233 } ià(
by‹s_»ad
 < 
m
) {

237 
m
 -ğ(
by‹s_»ad
);

238 
p
 +ğ
by‹s_»ad
;

239 
off£t
 +ğ
by‹s_»ad
;

243 ià(
	`l£ek
(
hªdË
, 
	`off_t
(
block_size
è* 
n
, 
SEEK_SET
) == -1) {

244 
¡ršg
 
mes§ge
 = "Error seekingo block: ";

245 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

246 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

249 
	`ch”t_io_»ad
(
hªdË
, 
»š‹½»t_ÿ¡
<*>(
p
), 
block_size
, block_size);

251 
	}
}

260 
	gCh”tTabË
::
	$wr™e_block
(
ušt4
 
n
, cÚ¡ 
by‹
 * 
p
) const

262 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::wr™e_block", 
n
 << ", " << 
p
);

263 
	`LOGLINE
(
DB
, "Write block‚ inhe DB file from‡ddress…");

264 
	`As£¹
(
wr™abË
);

266 
	`As£¹
(
n
 / 
CHAR_BIT
 < 
ba£
.
	`g‘_b™_m­_size
());

269 
	`As£¹P¬ªoid
(
ba£
.
	`block_ä“_©_¡¬t
(
n
));

272 
	`As£¹EqP¬ªoid
(
	`REVISION
(
p
), 
Ï‹¡_»visiÚ_numb”
 + 1);

274 ià(
bÙh_ba£s
) {

276 
	`LOGLINE
(
DB
, "deletehe old base file");

277 
	`sys_uÆšk
(
Çme
 + "ba£" + 
	`Ùh”_ba£_Ë‰”
());

278 
bÙh_ba£s
 = 
çl£
;

279 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

282 #ifdeà
HAVE_PWRITE


283 
off_t
 
off£t
 = 
	`off_t
(
block_size
è* 
n
;

284 
m
 = 
block_size
;

285 
Œue
) {

286 
ssize_t
 
by‹s_wr™‹n
 = 
	`pwr™e
(
hªdË
, 
p
, 
m
, 
off£t
);

287 ià(
by‹s_wr™‹n
 =ğ
m
) {

290 } ià(
by‹s_wr™‹n
 == -1) {

291 ià(
”ºo
 =ğ
EINTR
) ;

292 
¡ršg
 
mes§ge
 = "Error writing block: ";

293 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

294 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

295 } ià(
by‹s_wr™‹n
 == 0) {

296 
¡ršg
 
mes§ge
 = "Error writing block: wrote‚o data";

297 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

298 } ià(
by‹s_wr™‹n
 < 
m
) {

302 
m
 -ğ
by‹s_wr™‹n
;

303 
p
 +ğ
by‹s_wr™‹n
;

304 
off£t
 +ğ
by‹s_wr™‹n
;

308 ià(
	`l£ek
(
hªdË
, (
off_t
)
block_size
 * 
n
, 
SEEK_SET
) == -1) {

309 
¡ršg
 
mes§ge
 = "Error seekingo block: ";

310 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

311 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

313 
	`LOGLINE
(
DB
, "Call chert_io_write");

314 
	`ch”t_io_wr™e
(
hªdË
, 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
), 
block_size
);

316 
	}
}

341 
	gCh”tTabË
::
	$£t_ov”wr™‹n
() const

343 
	`LOGCALL_VOID
(
DB
, "ChertTable::set_overwritten", "");

346 ià(
wr™abË
)

347 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Db block overwritten -‡rehere multiple writers?");

348 
throw
 
X­Ÿn
::
	`D©aba£Modif›dE¼Ü
("The„evision being„ead has been discarded - you should call Xapian::Database::reopen()‡nd„etryhe operation");

349 
	}
}

362 
	gCh”tTabË
::
	$block_to_cursÜ
(
CursÜ
 * 
C_
, 
j
, 
ušt4
 
n
) const

364 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::block_to_cursÜ", (*)
C_
 << ", " << 
j
 << ", " << 
n
);

365 ià(
n
 =ğ
C_
[
j
].n) ;

366 
by‹
 * 
p
 = 
C_
[
j
].p;

367 
	`As£¹
(
p
);

370 ià(
C_
[
j
].
»wr™e
) {

371 
	`As£¹
(
wr™abË
);

372 
	`As£¹
(
C
 =ğ
C_
);

373 
	`wr™e_block
(
C_
[
j
].
n
, 
p
);

374 
C_
[
j
].
»wr™e
 = 
çl£
;

379 ià(
wr™abË
 && 
n
 =ğ
C
[
j
].n) {

380 
	`memıy
(
p
, 
C
[
j
].p, 
block_size
);

382 
	`»ad_block
(
n
, 
p
);

385 
C_
[
j
].
n
 =‚;

386 ià(
j
 < 
Ëv–
) {

388 ià(
	`¿»
(
	`REVISION
(
p
è> REVISION(
C_
[
j
 + 1].p))) {

389 
	`£t_ov”wr™‹n
();

394 ià(
	`¿»
(
j
 !ğ
	`GET_LEVEL
(
p
))) {

395 
¡ršg
 
msg
 = "Expected block ";

396 
msg
 +ğ
	`om_to¡ršg
(
n
);

397 
msg
 += "o be†evel ";

398 
msg
 +ğ
	`om_to¡ršg
(
j
);

399 
msg
 += ",‚ot ";

400 
msg
 +ğ
	`om_to¡ršg
(
	`GET_LEVEL
(
p
));

401 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

403 
	}
}

427 
	gCh”tTabË
::
	$®‹r
()

429 
	`LOGCALL_VOID
(
DB
, "ChertTable::alter", "");

430 
	`As£¹
(
wr™abË
);

431 #ifdeà
DANGEROUS


432 
C
[0].
»wr™e
 = 
Œue
;

434 
j
 = 0;

435 
by‹
 * 
p
 = 
C
[
j
].p;

436 
Œue
) {

437 ià(
C
[
j
].
»wr™e
) ;

438 
C
[
j
].
»wr™e
 = 
Œue
;

440 
ušt4
 
n
 = 
C
[
j
].n;

441 ià(
ba£
.
	`block_ä“_©_¡¬t
(
n
)) {

442 
	`As£¹
(
	`REVISION
(
p
è=ğ
Ï‹¡_»visiÚ_numb”
 + 1);

445 
	`As£¹
(
	`REVISION
(
p
è< 
Ï‹¡_»visiÚ_numb”
 + 1);

446 
ba£
.
	`ä“_block
(
n
);

447 
n
 = 
ba£
.
	`Ãxt_ä“_block
();

448 
C
[
j
].
n
 =‚;

449 
	`SET_REVISION
(
p
, 
Ï‹¡_»visiÚ_numb”
 + 1);

451 ià(
j
 =ğ
Ëv–
) ;

452 
j
++;

453 
p
 = 
C
[
j
].p;

454 
	`I‹m_wr
(
p
, 
C
[
j
].
c
).
	`£t_block_giv’_by
(
n
);

457 
	}
}

472 
	gCh”tTabË
::
	$fšd_š_block
(cÚ¡ 
by‹
 * 
p
, 
Key
 
key
, 
boŞ
 
Ëaf
, 
c
)

474 
	`LOGCALL_STATIC
(
DB
, , "Ch”tTabË::fšd_š_block", (*)
p
 << ", " << (cÚ¡ *)
key
.
	`g‘_add»ss
(è<< ", " << 
Ëaf
 << ", " << 
c
);

475 
i
 = 
DIR_START
;

476 ià(
Ëaf
è
i
 -ğ
D2
;

477 
j
 = 
	`DIR_END
(
p
);

479 ià(
c
 != -1) {

480 ià(
c
 < 
j
 && 
i
 < c && 
	`I‹m
(
p
, c).
	`key
(è<ğ
key
)

481 
i
 = 
c
;

482 
c
 +ğ
D2
;

483 ià(
c
 < 
j
 && 
i
 < c && 
key
 < 
	`I‹m
(
p
, c).
	`key
())

484 
j
 = 
c
;

487 
j
 - 
i
 > 
D2
) {

488 
k
 = 
i
 + ((
j
 - i)/(
D2
 * 2))*D2;

489 ià(
key
 < 
	`I‹m
(
p
, 
k
).
	`key
()è
j
 = k; 
i
 = k;

491 
	`RETURN
(
i
);

492 
	}
}

501 
boŞ


502 
	gCh”tTabË
::
	$fšd
(
CursÜ
 * 
C_
) const

504 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::fšd", (*)
C_
);

506 cÚ¡ 
by‹
 * 
p
;

507 
c
;

508 
Key
 
key
 = 
kt
.
	`key
();

510 
	`LOGLINE
(
DB
, "Tryoraversehe wholereeo findhe key");

511 
j
 = 
Ëv–
; j > 0; --j) {

512 
p
 = 
C_
[
j
].p;

513 
c
 = 
	`fšd_š_block
(
p
, 
key
, 
çl£
, 
C_
[
j
].c);

514 #ifdeà
BTREE_DEBUG_FULL


515 
	`´štf
("Block in ChertTable:find - code…osition 1");

516 
	`»pÜt_block_fuÎ
(
j
, 
C_
[j].
n
, 
p
);

518 
C_
[
j
].
c
 = c;

519 
	`block_to_cursÜ
(
C_
, 
j
 - 1, 
	`I‹m
(
p
, 
c
).
	`block_giv’_by
());

521 
p
 = 
C_
[0].p;

522 
c
 = 
	`fšd_š_block
(
p
, 
key
, 
Œue
, 
C_
[0].c);

523 #ifdeà
BTREE_DEBUG_FULL


524 
	`´štf
("Block in ChertTable:find - code…osition 2");

525 
	`»pÜt_block_fuÎ
(0, 
C_
[0].
n
, 
p
);

527 
C_
[0].
c
 = c;

528 ià(
c
 < 
DIR_START
è
	`RETURN
(
çl£
);

529 
	`RETURN
(
	`I‹m
(
p
, 
c
).
	`key
(è=ğ
key
);

530 
	}
}

538 
	gCh”tTabË
::
	$com·ù
(
by‹
 * 
p
)

540 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::com·ù", (*)
p
);

541 
	`As£¹
(
wr™abË
);

542 
e
 = 
block_size
;

543 
by‹
 * 
b
 = 
bufãr
;

544 
dœ_’d
 = 
	`DIR_END
(
p
);

545 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

546 
I‹m
 
	`™em
(
p
, 
c
);

547 
l
 = 
™em
.
	`size
();

548 
e
 -ğ
l
;

549 
	`memmove
(
b
 + 
e
, 
™em
.
	`g‘_add»ss
(), 
l
);

550 
	`£tD
(
p
, 
c
, 
e
);

552 
	`memmove
(
p
 + 
e
, 
b
 +ƒ, 
block_size
 -ƒ);

553 
e
 -ğ
dœ_’d
;

554 
	`SET_TOTAL_FREE
(
p
, 
e
);

555 
	`SET_MAX_FREE
(
p
, 
e
);

556 
	}
}

562 
	gCh”tTabË
::
	$¥l™_roÙ
(
ušt4
 
¥l™_n
)

564 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::¥l™_roÙ", 
¥l™_n
);

566 ++
Ëv–
;

570 ià(
Ëv–
 =ğ
BTREE_CURSOR_LEVELS
) {

571 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("BŒ“ ha growÀimpossibly†¬g("
	`STRINGIZE
(
BTREE_CURSOR_LEVELS
)"†evels)");

574 
by‹
 * 
q
 = 
	`z”Ûd_Ãw
(
block_size
);

575 
C
[
Ëv–
].
p
 = 
q
;

576 
C
[
Ëv–
].
c
 = 
DIR_START
;

577 
C
[
Ëv–
].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

578 
C
[
Ëv–
].
»wr™e
 = 
Œue
;

579 
	`SET_REVISION
(
q
, 
Ï‹¡_»visiÚ_numb”
 + 1);

580 
	`SET_LEVEL
(
q
, 
Ëv–
);

581 
	`SET_DIR_END
(
q
, 
DIR_START
);

582 
	`com·ù
(
q
);

585 
by‹
 
b
[10];

586 
I‹m_wr
 
	`™em
(
b
);

587 
™em
.
	`fÜm_nuÎ_key
(
¥l™_n
);

588 
	`add_™em
(
™em
, 
Ëv–
);

589 
	}
}

607 
	gCh”tTabË
::
	$’‹r_key
(
j
, 
Key
 
´evkey
, Key 
Ãwkey
)

609 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::’‹r_key", 
j
 << ",…revkey,‚ewkey");

610 
	`LOGLINE
(
DB
, "enter_key(j,…revkey,‚ewkey) is called‡fter‡ block split.");

612 
	`As£¹
(
wr™abË
);

613 
	`As£¹
(
´evkey
 < 
Ãwkey
);

614 
	`As£¹R–
(
j
,>=,1);

616 
ušt4
 
blocknumb”
 = 
C
[
j
 - 1].
n
;

620 cÚ¡ 
Ãwkey_Ën
 = 
Ãwkey
.
	`Ëngth
();

621 
	`As£¹R–
(
Ãwkey_Ën
,>,0);

622 
i
;

624 ià(
j
 == 1) {

627 
i
 = 0;

628 cÚ¡ 
mš_Ën
 = 
	`mš
(
Ãwkey_Ën
, 
´evkey
.
	`Ëngth
());

629 
i
 < 
mš_Ën
 && 
´evkey
[i] =ğ
Ãwkey
[i]) {

630 
i
++;

634 ià(
i
 < 
Ãwkey_Ën
) i++;

640 
i
 = 
Ãwkey_Ën
;

643 
by‹
 
b
[
UCHAR_MAX
 + 6];

644 
I‹m_wr
 
	`™em
(
b
);

645 
	`As£¹
(
i
 <ğ256 - 
I2
 - 
C2
);

646 
	`As£¹
(
i
 <ğ()(
b
è- 
I2
 - 
C2
 - 4);

647 
™em
.
	`£t_key_ªd_block
(
Ãwkey
, 
i
, 
blocknumb”
);

652 ià(
j
 > 1) {

653 
by‹
 * 
p
 = 
C
[
j
 - 1].p;

654 
ušt4
 
n
 = 
	`g‘št4
(
Ãwkey
.
	`g‘_add»ss
(), 
Ãwkey_Ën
 + 
K1
 + 
C2
);

655 
Ãw_tÙ®_ä“
 = 
	`TOTAL_FREE
(
p
è+ 
Ãwkey_Ën
 + 
C2
;

657 
	`I‹m_wr
(
cÚ¡_ÿ¡
<
by‹
*>(
Ãwkey
.
	`g‘_add»ss
()è- 
I2
).
	`fÜm_nuÎ_key
(
n
);

658 
	`SET_TOTAL_FREE
(
p
, 
Ãw_tÙ®_ä“
);

661 
C
[
j
].
c
 = 
	`fšd_š_block
(C[j].
p
, 
™em
.
	`key
(), 
çl£
, 0è+ 
D2
;

662 
C
[
j
].
»wr™e
 = 
Œue
;

663 
	`add_™em
(
™em
, 
j
);

664 
	}
}

671 
	gCh”tTabË
::
	$mid_pošt
(
by‹
 * 
p
)

673 
	`LOGCALL
(
DB
, , "Ch”tTabË::mid_pošt", (*)
p
);

674 
n
 = 0;

675 
dœ_’d
 = 
	`DIR_END
(
p
);

676 
size
 = 
block_size
 - 
	`TOTAL_FREE
(
p
è- 
dœ_’d
;

677 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

678 
l
 = 
	`I‹m
(
p
, 
c
).
	`size
();

679 
n
 +ğ2 * 
l
;

680 ià(
n
 >ğ
size
) {

681 ià(
l
 < 
n
 - 
size
è
	`RETURN
(
c
);

682 
	`RETURN
(
c
 + 
D2
);

687 
	`As£¹
(
çl£
);

688 
	`RETURN
(0);

689 
	}
}

701 
	gCh”tTabË
::
	$add_™em_to_block
(
by‹
 * 
p
, 
I‹m_wr
 
kt_
, 
c
)

703 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::add_™em_to_block", (*)
p
 << ", kt_, " << 
c
);

704 
	`LOGLINE
(
DB
, "Add itemo block‡t…");

705 
	`As£¹
(
wr™abË
);

706 
dœ_’d
 = 
	`DIR_END
(
p
);

707 
kt_Ën
 = 
kt_
.
	`size
();

708 
Ãeded
 = 
kt_Ën
 + 
D2
;

709 
Ãw_tÙ®
 = 
	`TOTAL_FREE
(
p
è- 
Ãeded
;

710 
Ãw_max
 = 
	`MAX_FREE
(
p
è- 
Ãeded
;

711 
	`LOGLINE
(
DB
, "Dœƒnd: " << 
dœ_’d
 << ", kt_Ën: " << 
kt_Ën


712 << ",‚“ded: " << 
Ãeded
);

714 
	`As£¹
(
Ãw_tÙ®
 >= 0);

716 
	`As£¹R–
(
	`MAX_FREE
(
p
),>=,
Ãeded
);

718 
	`As£¹
(
dœ_’d
 >ğ
c
);

720 
	`LOGLINE
(
DB
, "Block… befÜe: " << 
p
);

721 
	`memmove
(
p
 + 
c
 + 
D2
,… + c, 
dœ_’d
 - c);

722 
dœ_’d
 +ğ
D2
;

723 
	`SET_DIR_END
(
p
, 
dœ_’d
);

725 
o
 = 
dœ_’d
 + 
Ãw_max
;

726 
	`£tD
(
p
, 
c
, 
o
);

727 
	`memmove
(
p
 + 
o
, 
kt_
.
	`g‘_add»ss
(), 
kt_Ën
);

729 
	`SET_MAX_FREE
(
p
, 
Ãw_max
);

731 
	`SET_TOTAL_FREE
(
p
, 
Ãw_tÙ®
);

732 
	`LOGLINE
(
DB
, "Block…‡á” s‘tšg: " << 
p
);

733 
	}
}

741 
	gCh”tTabË
::
	$add_™em
(
I‹m_wr
 
kt_
, 
j
)

743 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::add_™em", "kt_, " << 
j
);

744 
	`LOGLINE
(
DB
, "Add itemo block‡t cursor†evel C[j]");

745 
	`As£¹
(
wr™abË
);

746 
by‹
 * 
p
 = 
C
[
j
].p;

747 
c
 = 
C
[
j
].c;

748 
ušt4
 
n
;

750 
Ãeded
 = 
kt_
.
	`size
(è+ 
D2
;

751 
	`LOGLINE
(
DB
, "TÙ® f»e: " << 
	`TOTAL_FREE
(
p
è<< ",‚“ded: " << 
Ãeded
);

752 ià(
	`TOTAL_FREE
(
p
è< 
Ãeded
) {

753 
	`LOGLINE
(
DB
, "Free space is‚otƒnough,„eadyo split currentree‚ode");

754 
m
;

760 ià(
£q_couÁ
 < 0) {

763 
m
 = 
	`mid_pošt
(
p
);

766 
m
 = 
c
;

769 
ušt4
 
¥l™_n
 = 
C
[
j
].
n
;

770 
	`LOGLINE
(
DB
, "Find‚ext free block call‚ext_free_block");

771 
C
[
j
].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

773 
	`LOGLINE
(
DB
, "BefÜ¥l™,… cÚ‹Á is: " << 
p
);

774 
	`memıy
(
¥l™_p
, 
p
, 
block_size
);

775 
	`SET_DIR_END
(
¥l™_p
, 
m
);

776 
	`com·ù
(
¥l™_p
);

779 
»sidue
 = 
	`DIR_END
(
p
è- 
m
;

780 
Ãw_dœ_’d
 = 
DIR_START
 + 
»sidue
;

781 
	`memmove
(
p
 + 
DIR_START
,… + 
m
, 
»sidue
);

782 
	`SET_DIR_END
(
p
, 
Ãw_dœ_’d
);

785 
	`com·ù
(
p
);

787 
boŞ
 
add_to_uµ”_h®f
;

788 ià(
£q_couÁ
 < 0) {

789 
add_to_uµ”_h®f
 = (
c
 >ğ
m
);

793 
add_to_uµ”_h®f
 = (
	`TOTAL_FREE
(
¥l™_p
è< 
Ãeded
);

796 ià(
add_to_uµ”_h®f
) {

797 
c
 -ğ(
m
 - 
DIR_START
);

798 
	`As£¹
(
£q_couÁ
 < 0 || 
c
 <ğ
DIR_START
 + 
D2
);

799 
	`As£¹
(
c
 >ğ
DIR_START
);

800 
	`As£¹
(
c
 <ğ
	`DIR_END
(
p
));

801 
	`add_™em_to_block
(
p
, 
kt_
, 
c
);

802 
n
 = 
C
[
j
].n;

804 
	`As£¹
(
c
 >ğ
DIR_START
);

805 
	`As£¹
(
c
 <ğ
	`DIR_END
(
¥l™_p
));

806 
	`add_™em_to_block
(
¥l™_p
, 
kt_
, 
c
);

807 
n
 = 
¥l™_n
;

809 
	`LOGLINE
(
DB
, "Aá” s¶™,… is: " << 
p
 << ",‡nd‚ew… is: " << 
¥l™_p
);

810 
	`LOGLINE
(
DB
, "Write‚ew‚odeo...");

811 
	`wr™e_block
(
¥l™_n
, 
¥l™_p
);

814 ià(
j
 =ğ
Ëv–
è
	`¥l™_roÙ
(
¥l™_n
);

818 
	`’‹r_key
(
j
 + 1,

819 
	`I‹m
(
¥l™_p
, 
	`DIR_END
(¥l™_pè- 
D2
).
	`key
(),

820 
	`I‹m
(
p
, 
DIR_START
).
	`key
());

822 
	`LOGLINE
(
DB
, "Just‡dd keyo block");

823 
	`As£¹R–
(
	`TOTAL_FREE
(
p
),>=,
Ãeded
);

825 ià(
	`MAX_FREE
(
p
è< 
Ãeded
) {

826 
	`com·ù
(
p
);

827 
	`As£¹R–
(
	`MAX_FREE
(
p
),>=,
Ãeded
);

829 
	`LOGLINE
(
DB
, "Add itemo block");

830 
	`add_™em_to_block
(
p
, 
kt_
, 
c
);

831 
n
 = 
C
[
j
].n;

833 ià(
j
 == 0) {

834 
chªged_n
 = 
n
;

835 
chªged_c
 = 
c
;

837 
	}
}

847 
	gCh”tTabË
::
	$d–‘e_™em
(
j
, 
boŞ
 
»³©edly
)

849 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::d–‘e_™em", 
j
 << ", " << 
»³©edly
);

850 
	`As£¹
(
wr™abË
);

851 
by‹
 * 
p
 = 
C
[
j
].p;

852 
c
 = 
C
[
j
].c;

853 
kt_Ën
 = 
	`I‹m
(
p
, 
c
).
	`size
();

854 
dœ_’d
 = 
	`DIR_END
(
p
è- 
D2
;

856 
	`memmove
(
p
 + 
c
,… + c + 
D2
, 
dœ_’d
 - c);

857 
	`SET_DIR_END
(
p
, 
dœ_’d
);

858 
	`SET_MAX_FREE
(
p
, 
	`MAX_FREE
Õè+ 
D2
);

859 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè+ 
kt_Ën
 + 
D2
);

861 ià(!
»³©edly
) ;

862 ià(
j
 < 
Ëv–
) {

863 ià(
dœ_’d
 =ğ
DIR_START
) {

864 
ba£
.
	`ä“_block
(
C
[
j
].
n
);

865 
C
[
j
].
»wr™e
 = 
çl£
;

866 
C
[
j
].
n
 = 
BLK_UNUSED
;

867 
C
[
j
 + 1].
»wr™e
 = 
Œue
;

868 
	`d–‘e_™em
(
j
 + 1, 
Œue
);

871 
	`As£¹
(
j
 =ğ
Ëv–
);

872 
dœ_’d
 =ğ
DIR_START
 + 
D2
 && 
Ëv–
 > 0) {

874 
ušt4
 
Ãw_roÙ
 = 
	`I‹m
(
p
, 
DIR_START
).
	`block_giv’_by
();

875 
d–‘e
 [] 
p
;

876 
C
[
Ëv–
].
p
 = 0;

877 
ba£
.
	`ä“_block
(
C
[
Ëv–
].
n
);

878 
C
[
Ëv–
].
»wr™e
 = 
çl£
;

879 
C
[
Ëv–
].
n
 = 
BLK_UNUSED
;

880 
Ëv–
--;

882 
	`block_to_cursÜ
(
C
, 
Ëv–
, 
Ãw_roÙ
);

884 
p
 = 
C
[
Ëv–
].p;

885 
dœ_’d
 = 
	`DIR_END
(
p
);

888 
	}
}

920 
	gCh”tTabË
::
	$add_kt
(
boŞ
 
found
)

922 
	`LOGCALL
(
DB
, , "Ch”tTabË::add_kt", 
found
);

923 
	`LOGLINE
(
DB
, "Tryo find key-tag in BTree‡nd‡dd or„eplace");

924 
	`As£¹
(
wr™abË
);

925 
compÚ’ts
 = 0;

933 
	`®‹r
();

935 ià(
found
) {

936 
	`LOGLINE
(
DB
, "Replace key-tag");

937 
£q_couÁ
 = 
SEQ_START_POINT
;

938 
£qu’tŸl
 = 
çl£
;

940 
by‹
 * 
p
 = 
C
[0].p;

941 
c
 = 
C
[0].c;

942 
I‹m
 
	`™em
(
p
, 
c
);

943 
kt_size
 = 
kt
.
	`size
();

944 
Ãeded
 = 
kt_size
 - 
™em
.
	`size
();

946 
compÚ’ts
 = 
™em
.
	`compÚ’ts_of
();

948 ià(
Ãeded
 <= 0) {

950 
	`memmove
(
cÚ¡_ÿ¡
<
by‹
 *>(
™em
.
	`g‘_add»ss
()),

951 
kt
.
	`g‘_add»ss
(), 
kt_size
);

952 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè- 
Ãeded
);

955 
Ãw_max
 = 
	`MAX_FREE
(
p
è- 
kt_size
;

956 ià(
Ãw_max
 >= 0) {

957 
o
 = 
	`DIR_END
(
p
è+ 
Ãw_max
;

958 
	`memmove
(
p
 + 
o
, 
kt
.
	`g‘_add»ss
(), 
kt_size
);

959 
	`£tD
(
p
, 
c
, 
o
);

960 
	`SET_MAX_FREE
(
p
, 
Ãw_max
);

961 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè- 
Ãeded
);

964 
	`d–‘e_™em
(0, 
çl£
);

965 
	`add_™em
(
kt
, 0);

969 
	`LOGLINE
(
DB
, "Add keyag");

971 ià(
chªged_n
 =ğ
C
[0].
n
 && 
chªged_c
 =ğC[0].
c
) {

972 ià(
£q_couÁ
 < 0) seq_count++;

974 
£q_couÁ
 = 
SEQ_START_POINT
;

975 
£qu’tŸl
 = 
çl£
;

977 
C
[0].
c
 +ğ
D2
;

978 
	`add_™em
(
kt
, 0);

980 
	`RETURN
(
compÚ’ts
);

981 
	}
}

989 
	gCh”tTabË
::
	$d–‘e_kt
()

991 
	`LOGCALL
(
DB
, , "ChertTable::delete_kt", "");

992 
	`As£¹
(
wr™abË
);

994 
boŞ
 
found
 = 
	`fšd
(
C
);

996 
compÚ’ts
 = 0;

997 
£q_couÁ
 = 
SEQ_START_POINT
;

998 
£qu’tŸl
 = 
çl£
;

1006 ià(
found
) {

1007 
compÚ’ts
 = 
	`I‹m
(
C
[0].
p
, C[0].
c
).
	`compÚ’ts_of
();

1008 
	`®‹r
();

1009 
	`d–‘e_™em
(0, 
Œue
);

1011 
	`RETURN
(
compÚ’ts
);

1012 
	}
}

1023 
	gCh”tTabË
::
	$fÜm_key
(cÚ¡ 
¡ršg
 & 
key
) const

1025 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::fÜm_key", 
key
);

1026 
kt
.
	`fÜm_key
(
key
);

1027 
	}
}

1053 
	gCh”tTabË
::
	$add
(cÚ¡ 
¡ršg
 &
key
, sŒšg 
g
, 
boŞ
 
®»ady_com´es£d
)

1055 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::add", 
key
 << ", " << 
g
 << ", " << 
®»ady_com´es£d
);

1056 
	`As£¹
(
wr™abË
);

1058 ià(
hªdË
 < 0è
	`ü—‹_ªd_İ’
(
block_size
);

1060 
	`LOGLINE
(
DB
, "form key");

1061 
	`fÜm_key
(
key
);

1062 
	`LOGLINE
(
DB
, "Ãw key is: " << 
key
);

1064 
boŞ
 
com´es£d
 = 
çl£
;

1065 ià(
®»ady_com´es£d
) {

1066 
com´es£d
 = 
Œue
;

1067 } ià(
com´ess_¡¿‹gy
 !ğ
DONT_COMPRESS
 && 
g
.
	`size
(è> 
COMPRESS_MIN
) {

1068 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_DEFAULT_STRATEGY
);

1069 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_FILTERED
);

1070 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_HUFFMAN_ONLY
);

1071 #ifdeà
Z_RLE


1072 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_RLE
);

1075 
	`Ïzy_®loc_deæ©e_z¡»am
();

1077 
deæ©e_z¡»am
->
Ãxt_š
 = (
By‹f
 *)
cÚ¡_ÿ¡
<*>(
g
.
	`d©a
());

1078 
deæ©e_z¡»am
->
ava_š
 = (
uIÁ
)
g
.
	`size
();

1081 
blk_Ën
 = 
g
.
	`size
() - 1;

1082 * 
blk
 = 
Ãw
 [
blk_Ën
];

1083 
deæ©e_z¡»am
->
Ãxt_out
 = 
blk
;

1084 
deæ©e_z¡»am
->
ava_out
 = (
uIÁ
)
blk_Ën
;

1086 
”r
 = 
	`deæ©e
(
deæ©e_z¡»am
, 
Z_FINISH
);

1087 ià(
”r
 =ğ
Z_STREAM_END
) {

1090 
g
.
	`assign
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
blk
), 
deæ©e_z¡»am
->
tÙ®_out
);

1091 
com´es£d
 = 
Œue
;

1096 
d–‘e
 [] 
blk
;

1100 cÚ¡ 
size_t
 
cd
 = 
kt
.
	`key
().
	`Ëngth
(è+ 
K1
 + 
I2
 + 
C2
 + C2;

1101 cÚ¡ 
size_t
 
L
 = 
max_™em_size
 - 
cd
;

1102 
size_t
 
fœ¡_L
 = 
L
;

1103 
boŞ
 
found
 = 
	`fšd
(
C
);

1104 ià(!
found
) {

1105 
by‹
 * 
p
 = 
C
[0].p;

1106 
size_t
 
n
 = 
	`TOTAL_FREE
(
p
è% (
max_™em_size
 + 
D2
);

1107 ià(
n
 > 
D2
 + 
cd
) {

1108 
n
 -ğ(
D2
 + 
cd
);

1121 
size_t
 
Ï¡
 = 
g
.
	`Ëngth
(è% 
L
;

1122 ià(
n
 >ğ
Ï¡
 || (
fuÎ_com·ùiÚ
 &&‚ >ğ
key
.
	`size
() + 34))

1123 
fœ¡_L
 = 
n
;

1128 
m
 = 
g
.
	`em±y
(è? 1 : (g.
	`Ëngth
(è- 
fœ¡_L
 + 
L
 - 1) / L + 1;

1133 ià(
m
 >ğ
BYTE_PAIR_RANGE
)

1134 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Can't handle insanely†argeags");

1136 
n
 = 0;

1138 
o
 = 0;

1139 
size_t
 
»sidue
 = 
g
.
	`Ëngth
();

1140 
»¶aûm’t
 = 
çl£
;

1141 
i
;

1142 
	`LOGLINE
(
DB
, "BefÜÿÎ kt.£t_compÚ’ts_of, m is: " << 
m
);

1143 
kt
.
	`£t_compÚ’ts_of
(
m
);

1144 
i
 = 1; i <ğ
m
; i++) {

1145 
size_t
 
l
 = (
i
 =ğ
m
 ? 
»sidue
 : (˜=ğ1 ? 
fœ¡_L
 : 
L
));

1146 
	`As£¹
(
cd
 + 
l
 <ğ
block_size
);

1147 
	`As£¹
(
¡ršg
::
	`size_ty³
(
o
 + 
l
è<ğ
g
.
	`Ëngth
());

1148 
	`LOGLINE
(
DB
, "g: " << 
g
.
	`d©a
()+
o
 << ", i: " << 
i
);

1149 
kt
.
	`£t_g
(
cd
, 
g
.
	`d©a
(è+ 
o
, 
l
, 
com´es£d
);

1150 
kt
.
	`£t_compÚ’t_of
(
i
);

1152 
o
 +ğ
l
;

1153 
»sidue
 -ğ
l
;

1155 ià(
i
 > 1è
found
 = 
	`fšd
(
C
);

1156 
n
 = 
	`add_kt
(
found
);

1157 ià(
n
 > 0è
»¶aûm’t
 = 
Œue
;

1160 
i
 = 
m
 + 1; i <ğ
n
; i++) {

1161 
kt
.
	`£t_compÚ’t_of
(
i
);

1162 
	`d–‘e_kt
();

1164 ià(!
»¶aûm’t
è++
™em_couÁ
;

1165 
BŒ“_modif›d
 = 
Œue
;

1166 
	}
}

1174 
boŞ


1175 
	gCh”tTabË
::
	$d–
(cÚ¡ 
¡ršg
 &
key
)

1177 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::d–", 
key
);

1178 
	`As£¹
(
wr™abË
);

1180 ià(
hªdË
 < 0) {

1181 ià(
hªdË
 == -2) {

1182 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

1184 
	`RETURN
(
çl£
);

1188 ià(
key
.
	`size
(è> 
CHERT_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1190 ià(
key
.
	`em±y
()è
	`RETURN
(
çl£
);

1191 
	`fÜm_key
(
key
);

1193 
n
 = 
	`d–‘e_kt
();

1194 ià(
n
 <ğ0è
	`RETURN
(
çl£
);

1196 
i
 = 2; i <ğ
n
; i++) {

1197 
kt
.
	`£t_compÚ’t_of
(
i
);

1198 
	`d–‘e_kt
();

1201 
™em_couÁ
--;

1202 
BŒ“_modif›d
 = 
Œue
;

1203 
	`RETURN
(
Œue
);

1204 
	}
}

1206 
boŞ


1207 
	gCh”tTabË
::
	$g‘_exaù_’Œy
(cÚ¡ 
¡ršg
 &
key
, sŒšg & 
g
) const

1209 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::g‘_exaù_’Œy", 
key
 << ", [&tag]");

1210 
	`As£¹
(!
key
.
	`em±y
());

1212 ià(
hªdË
 < 0) {

1213 ià(
hªdË
 == -2) {

1214 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

1216 
	`RETURN
(
çl£
);

1220 ià(
key
.
	`size
(è> 
CHERT_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1222 
	`fÜm_key
(
key
);

1223 ià(!
	`fšd
(
C
)è
	`RETURN
(
çl£
);

1225 ()
	`»ad_g
(
C
, &
g
, 
çl£
);

1226 
	`RETURN
(
Œue
);

1227 
	}
}

1229 
boŞ


1230 
	gCh”tTabË
::
	$key_exi¡s
(cÚ¡ 
¡ršg
 &
key
) const

1232 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::key_exi¡s", 
key
);

1233 
	`As£¹
(!
key
.
	`em±y
());

1236 ià(
key
.
	`size
(è> 
CHERT_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1238 
	`fÜm_key
(
key
);

1239 
	`RETURN
(
	`fšd
(
C
));

1240 
	}
}

1242 
boŞ


1243 
	gCh”tTabË
::
	$»ad_g
(
CursÜ
 * 
C_
, 
¡ršg
 *
g
, 
boŞ
 
k“p_com´es£d
) const

1245 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::»ad_g", "C_,ag, " << 
k“p_com´es£d
);

1246 
I‹m
 
	`™em
(
C_
[0].
p
, C_[0].
c
);

1249 
n
 = 
™em
.
	`compÚ’ts_of
();

1251 
g
->
	`»size
(0);

1254 ià(
n
 > 1è
g
->
	`»£rve
((
max_™em_size
 - (1 + 
K1
 + 
I2
 + 
C2
 + C2)) *‚);

1256 
™em
.
	`­³nd_chunk
(
g
);

1257 
boŞ
 
com´es£d
 = 
™em
.
	`g‘_com´es£d
();

1259 
i
 = 2; i <ğ
n
; i++) {

1260 ià(!
	`Ãxt
(
C_
, 0)) {

1261 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Unexpectedƒnd ofable when„eading continuation ofag");

1263 ()
	`I‹m
(
C_
[0].
p
, C_[0].
c
).
	`­³nd_chunk
(
g
);

1267 ià(!
com´es£d
 || 
k“p_com´es£d
è
	`RETURN
(compressed);

1273 
¡ršg
 
ug
;

1275 
ug
.
	`»£rve
(
g
->
	`size
() +ag->size() / 2);

1277 
By‹f
 
buf
[8192];

1279 
	`Ïzy_®loc_šæ©e_z¡»am
();

1281 
šæ©e_z¡»am
->
Ãxt_š
 = (
By‹f
*)
cÚ¡_ÿ¡
<*>(
g
->
	`d©a
());

1282 
šæ©e_z¡»am
->
ava_š
 = (
uIÁ
)
g
->
	`size
();

1284 
”r
 = 
Z_OK
;

1285 
”r
 !ğ
Z_STREAM_END
) {

1286 
šæ©e_z¡»am
->
Ãxt_out
 = 
buf
;

1287 
šæ©e_z¡»am
->
ava_out
 = (
uIÁ
)(
buf
);

1288 
”r
 = 
	`šæ©e
(
šæ©e_z¡»am
, 
Z_SYNC_FLUSH
);

1289 ià(
”r
 =ğ
Z_BUF_ERROR
 && 
šæ©e_z¡»am
->
ava_š
 == 0) {

1290 
	`LOGLINE
(
DB
, "Z_BUF_ERROR - fakšg checksum oà" << 
šæ©e_z¡»am
->
adËr
);

1291 
By‹f
 
h—d”2
[4];

1292 
	`£tšt4
(
h—d”2
, 0, 
šæ©e_z¡»am
->
adËr
);

1293 
šæ©e_z¡»am
->
Ãxt_š
 = 
h—d”2
;

1294 
šæ©e_z¡»am
->
ava_š
 = 4;

1295 
”r
 = 
	`šæ©e
(
šæ©e_z¡»am
, 
Z_SYNC_FLUSH
);

1296 ià(
”r
 =ğ
Z_STREAM_END
) ;

1299 ià(
”r
 !ğ
Z_OK
 &&ƒ¼ !ğ
Z_STREAM_END
) {

1300 ià(
”r
 =ğ
Z_MEM_ERROR
è
throw
 
¡d
::
	`bad_®loc
();

1301 
¡ršg
 
msg
 = "inflate failed";

1302 ià(
šæ©e_z¡»am
->
msg
) {

1303 
msg
 += " (";

1304 
msg
 +ğ
šæ©e_z¡»am
->msg;

1305 
msg
 += ')';

1307 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1310 
ug
.
	`­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
),

1311 
šæ©e_z¡»am
->
Ãxt_out
 - 
buf
);

1313 ià(
ug
.
	`size
(è!ğ
šæ©e_z¡»am
->
tÙ®_out
) {

1314 
¡ršg
 
msg
 = "compressedag didn'tƒxpandoheƒxpected size: ";

1315 
msg
 +ğ
	`om_to¡ršg
(
ug
.
	`size
());

1316 
msg
 += " != ";

1318 
msg
 +ğ
	`om_to¡ršg
((
size_t
)
šæ©e_z¡»am
->
tÙ®_out
);

1319 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

1322 
	`sw­
(*
g
, 
ug
);

1324 
	`RETURN
(
çl£
);

1325 
	}
}

1328 
	gCh”tTabË
::
	$£t_fuÎ_com·ùiÚ
(
boŞ
 
·r™y
)

1330 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::£t_fuÎ_com·ùiÚ", 
·r™y
);

1331 
	`As£¹
(
wr™abË
);

1333 ià(
·r™y
è
£q_couÁ
 = 0;

1334 
fuÎ_com·ùiÚ
 = 
·r™y
;

1335 
	}
}

1337 
Ch”tCursÜ
 * 
	gCh”tTabË
::
	$cursÜ_g‘
() const {

1338 
	`LOGCALL
(
DB
, 
Ch”tCursÜ
 *, "ChertTable::cursor_get", "");

1339 ià(
hªdË
 < 0) {

1340 ià(
hªdË
 == -2) {

1341 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

1343 
	`RETURN
(
NULL
);

1346 
	`RETURN
(
Ãw
 
	`Ch”tCursÜ
(
cÚ¡_ÿ¡
<
Ch”tTabË
 *>(
this
)));

1347 
	}
}

1351 
boŞ


1352 
	gCh”tTabË
::
	$basic_İ’
(
boŞ
 
»visiÚ_suµl›d
, 
ch”t_»visiÚ_numb”_t
 
»visiÚ_
)

1354 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::basic_İ’", 
»visiÚ_suµl›d
 << ", " << 
»visiÚ_
);

1355 
ch
 = 'X';

1358 cÚ¡ 
size_t
 
BTREE_BASES
 = 2;

1359 
¡ršg
 
”r_msg
;

1360 cÚ¡ 
ba£Çmes
[
BTREE_BASES
] = { 'A', 'B' };

1362 
Ch”tTabË_ba£
 
ba£s
[
BTREE_BASES
];

1363 
boŞ
 
ba£_ok
[
BTREE_BASES
];

1365 
bÙh_ba£s
 = 
Œue
;

1366 
boŞ
 
v®id_ba£
 = 
çl£
;

1368 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1369 
boŞ
 
ok
 = 
ba£s
[
i
].
	`»ad
(
Çme
, 
ba£Çmes
[i], 
”r_msg
);

1370 
ba£_ok
[
i
] = 
ok
;

1371 ià(
ok
) {

1372 
v®id_ba£
 = 
Œue
;

1374 
bÙh_ba£s
 = 
çl£
;

1379 ià(!
v®id_ba£
) {

1380 ià(
hªdË
 >= 0) {

1381 ::
	`şo£
(
hªdË
);

1382 
hªdË
 = -1;

1384 
¡ršg
 
mes§ge
 = "Error openingable `";

1385 
mes§ge
 +ğ
Çme
;

1386 
mes§ge
 += "':\n";

1387 
mes§ge
 +ğ
”r_msg
;

1388 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

1391 ià(
»visiÚ_suµl›d
) {

1392 
boŞ
 
found_»visiÚ
 = 
çl£
;

1393 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1394 ià(
ba£_ok
[
i
] && 
ba£s
[i].
	`g‘_»visiÚ
(è=ğ
»visiÚ_
) {

1395 
ch
 = 
ba£Çmes
[
i
];

1396 
found_»visiÚ
 = 
Œue
;

1400 ià(!
found_»visiÚ
) {

1405 
	`RETURN
(
çl£
);

1408 
ch”t_»visiÚ_numb”_t
 
highe¡_»visiÚ
 = 0;

1409 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1410 ià(
ba£_ok
[
i
] && 
ba£s
[i].
	`g‘_»visiÚ
(è>ğ
highe¡_»visiÚ
) {

1411 
ch
 = 
ba£Çmes
[
i
];

1412 
highe¡_»visiÚ
 = 
ba£s
[
i
].
	`g‘_»visiÚ
();

1417 
Ch”tTabË_ba£
 *
ba£p
 = 0;

1418 
Ch”tTabË_ba£
 *
Ùh”_ba£
 = 0;

1420 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1421 
	`LOGLINE
(
DB
, "Checkšg (ch =ğ" << 
ch
 << ")‡gainst "

1422 "ba£Çmes[" << 
i
 << "] =ğ" << 
ba£Çmes
[i]);

1423 
	`LOGLINE
(
DB
, "ba£s[" << 
i
 << "].get_revision() == " <<

1424 
ba£s
[
i
].
	`g‘_»visiÚ
());

1425 
	`LOGLINE
(
DB
, "ba£_ok[" << 
i
 << "] =ğ" << 
ba£_ok
[i]);

1426 ià(
ch
 =ğ
ba£Çmes
[
i
]) {

1427 
ba£p
 = &
ba£s
[
i
];

1430 
size_t
 
Ùh”ba£_num
 = 1-
i
;

1431 ià(
ba£_ok
[
Ùh”ba£_num
]) {

1432 
Ùh”_ba£
 = &
ba£s
[
Ùh”ba£_num
];

1437 
	`As£¹
(
ba£p
);

1444 
ba£
.
	`sw­
(*
ba£p
);

1446 
»visiÚ_numb”
 = 
ba£
.
	`g‘_»visiÚ
();

1447 
block_size
 = 
ba£
.
	`g‘_block_size
();

1448 
roÙ
 = 
ba£
.
	`g‘_roÙ
();

1449 
Ëv–
 = 
ba£
.
	`g‘_Ëv–
();

1451 
™em_couÁ
 = 
ba£
.
	`g‘_™em_couÁ
();

1452 
çked_roÙ_block
 = 
ba£
.
	`g‘_have_çk”oÙ
();

1453 
£qu’tŸl
 = 
ba£
.
	`g‘_£qu’tŸl
();

1455 ià(
Ùh”_ba£
 != 0) {

1456 
Ï‹¡_»visiÚ_numb”
 = 
Ùh”_ba£
->
	`g‘_»visiÚ
();

1457 ià(
»visiÚ_numb”
 > 
Ï‹¡_»visiÚ_numb”
)

1458 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1460 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1465 
kt
 = 
	`I‹m_wr
(
	`z”Ûd_Ãw
(
block_size
));

1467 
	`£t_max_™em_size
(
BLOCK_CAPACITY
);

1469 
ba£_Ë‰”
 = 
ch
;

1473 
	`RETURN
(
Œue
);

1474 
	}
}

1477 
	gCh”tTabË
::
	$»ad_roÙ
()

1479 
	`LOGCALL_VOID
(
DB
, "ChertTable::read_root", "");

1480 ià(
çked_roÙ_block
) {

1482 
by‹
 * 
p
 = 
C
[0].p;

1483 
	`As£¹
(
p
);

1488 
	`mem£t
(
p
, 0, 
block_size
);

1490 
o
 = 
block_size
 - 
I2
 - 
K1
 - 
C2
 - C2;

1491 
	`I‹m_wr
(
p
 + 
o
).
	`çke_roÙ_™em
();

1493 
	`£tD
(
p
, 
DIR_START
, 
o
);

1494 
	`SET_DIR_END
(
p
, 
DIR_START
 + 
D2
);

1496 
o
 -ğ(
DIR_START
 + 
D2
);

1497 
	`SET_MAX_FREE
(
p
, 
o
);

1498 
	`SET_TOTAL_FREE
(
p
, 
o
);

1499 
	`SET_LEVEL
(
p
, 0);

1501 ià(!
wr™abË
) {

1504 
	`SET_REVISION
(
p
, 0);

1505 
C
[0].
n
 = 0;

1508 
	`SET_REVISION
(
p
, 
Ï‹¡_»visiÚ_numb”
 + 1);

1509 
C
[0].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

1513 
	`block_to_cursÜ
(
C
, 
Ëv–
, 
roÙ
);

1515 ià(
	`REVISION
(
C
[
Ëv–
].
p
è> 
»visiÚ_numb”
è
	`£t_ov”wr™‹n
();

1518 
	}
}

1520 
boŞ


1521 
	gCh”tTabË
::
	$do_İ’_to_wr™e
(
boŞ
 
»visiÚ_suµl›d
,

1522 
ch”t_»visiÚ_numb”_t
 
»visiÚ_
,

1523 
boŞ
 
ü—‹_db
)

1525 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::do_İ’_to_wr™e", 
»visiÚ_suµl›d
 << ", " << 
»visiÚ_
 << ", " << 
ü—‹_db
);

1526 ià(
hªdË
 == -2) {

1527 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

1529 
æags
 = 
O_RDWR
 | 
O_BINARY
;

1530 ià(
ü—‹_db
è
æags
 |ğ
O_CREAT
 | 
O_TRUNC
;

1531 
hªdË
 = ::
	`İ’
((
Çme
 + "DB").
	`c_¡r
(), 
æags
, 0666);

1532 ià(
hªdË
 < 0) {

1535 ià(
Ïzy
 && !
ü—‹_db
 && 
”ºo
 =ğ
ENOENT
) {

1536 
»visiÚ_numb”
 = 
»visiÚ_
;

1537 
	`RETURN
(
Œue
);

1539 
¡ršg
 
	`mes§ge
(
ü—‹_db
 ? "Couldn't create " : "Couldn't open ");

1540 
mes§ge
 +ğ
Çme
;

1541 
mes§ge
 += "DB„ead/write: ";

1542 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

1543 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

1546 ià(!
	`basic_İ’
(
»visiÚ_suµl›d
, 
»visiÚ_
)) {

1547 ::
	`şo£
(
hªdË
);

1548 
hªdË
 = -1;

1549 ià(!
»visiÚ_suµl›d
) {

1550 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Failedo open for writing");

1555 
	`RETURN
(
çl£
);

1558 
wr™abË
 = 
Œue
;

1560 
j
 = 0; j <ğ
Ëv–
; j++) {

1561 
C
[
j
].
n
 = 
BLK_UNUSED
;

1562 
C
[
j
].
p
 = 
Ãw
 
by‹
[
block_size
];

1563 ià(
C
[
j
].
p
 == 0) {

1564 
throw
 
¡d
::
	`bad_®loc
();

1567 
¥l™_p
 = 
Ãw
 
by‹
[
block_size
];

1568 ià(
¥l™_p
 == 0) {

1569 
throw
 
¡d
::
	`bad_®loc
();

1571 
	`»ad_roÙ
();

1573 
bufãr
 = 
	`z”Ûd_Ãw
(
block_size
);

1575 
chªged_n
 = 0;

1576 
chªged_c
 = 
DIR_START
;

1577 
£q_couÁ
 = 
SEQ_START_POINT
;

1579 
	`RETURN
(
Œue
);

1580 
	}
}

1582 
	gCh”tTabË
::
	$Ch”tTabË
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡ršg
 & 
·th_
,

1583 
boŞ
 
»adÚly_
, 
com´ess_¡¿‹gy_
, boŞ 
Ïzy_
)

1584 : 
	`bËÇme
(
bËÇme_
),

1585 
	`»visiÚ_numb”
(0),

1586 
	`™em_couÁ
(0),

1587 
	`block_size
(0),

1588 
	`Ï‹¡_»visiÚ_numb”
(0),

1589 
	`bÙh_ba£s
(
çl£
),

1590 
	`ba£_Ë‰”
('A'),

1591 
	`çked_roÙ_block
(
Œue
),

1592 
	`£qu’tŸl
(
Œue
),

1593 
	`hªdË
(-1),

1594 
	`Ëv–
(0),

1595 
	`roÙ
(0),

1596 
	`kt
(0),

1597 
	`bufãr
(0),

1598 
	`ba£
(),

1599 
	`Çme
(
·th_
),

1600 
	`£q_couÁ
(0),

1601 
	`chªged_n
(0),

1602 
	`chªged_c
(0),

1603 
	`max_™em_size
(0),

1604 
	`BŒ“_modif›d
(
çl£
),

1605 
	`fuÎ_com·ùiÚ
(
çl£
),

1606 
	`wr™abË
(!
»adÚly_
),

1607 
	`¥l™_p
(0),

1608 
	`com´ess_¡¿‹gy
(
com´ess_¡¿‹gy_
),

1609 
	`deæ©e_z¡»am
(
NULL
),

1610 
	`šæ©e_z¡»am
(
NULL
),

1611 
	$Ïzy
(
Ïzy_
)

1613 
	`LOGCALL_CTOR
(
DB
, "ChertTable",

1614 
bËÇme_
 << "," << 
·th_
 << ", " << 
»adÚly_
 << ", " <<

1615 
com´ess_¡¿‹gy_
 << ", " << 
Ïzy_
);

1616 
	}
}

1618 
boŞ


1619 
	gCh”tTabË
::
	$»®ly_em±y
() const

1621 ià(
hªdË
 < 0) {

1622 ià(
hªdË
 == -2) {

1623 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

1625  
Œue
;

1627 
Ch”tCursÜ
 
	`cur
(
cÚ¡_ÿ¡
<
Ch”tTabË
*>(
this
));

1628 
cur
.
	`fšd_’Œy
(
	`¡ršg
());

1629  !
cur
.
	`Ãxt
();

1630 
	}
}

1633 
	gCh”tTabË
::
	$Ïzy_®loc_deæ©e_z¡»am
() const {

1634 ià(
	`usu®
(
deæ©e_z¡»am
)) {

1635 ià(
	`usu®
(
	`deæ©eRe£t
(
deæ©e_z¡»am
è=ğ
Z_OK
)) ;

1637 
d–‘e
 
deæ©e_z¡»am
;

1640 
deæ©e_z¡»am
 = 
Ãw
 
z_¡»am
;

1642 
deæ©e_z¡»am
->
z®loc
 = 
»š‹½»t_ÿ¡
<
®loc_func
>(0);

1643 
deæ©e_z¡»am
->
zä“
 = 
»š‹½»t_ÿ¡
<
ä“_func
>(0);

1644 
deæ©e_z¡»am
->
İaque
 = (
voidpf
)0;

1648 
”r
;

1649 
”r
 = 
	`deæ©eIn™2
(
deæ©e_z¡»am
, 
Z_DEFAULT_COMPRESSION
, 
Z_DEFLATED
,

1650 -15, 9, 
com´ess_¡¿‹gy
);

1651 ià(
	`¿»
(
”r
 !ğ
Z_OK
)) {

1652 ià(
”r
 =ğ
Z_MEM_ERROR
) {

1653 
d–‘e
 
deæ©e_z¡»am
;

1654 
deæ©e_z¡»am
 = 0;

1655 
throw
 
¡d
::
	`bad_®loc
();

1657 
¡ršg
 
msg
 = "deflateInit2 failed (";

1658 ià(
deæ©e_z¡»am
->
msg
) {

1659 
msg
 +ğ
deæ©e_z¡»am
->msg;

1661 
msg
 +ğ
	`om_to¡ršg
(
”r
);

1663 
msg
 += ')';

1664 
d–‘e
 
deæ©e_z¡»am
;

1665 
deæ©e_z¡»am
 = 0;

1666 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1668 
	}
}

1671 
	gCh”tTabË
::
	$Ïzy_®loc_šæ©e_z¡»am
() const {

1672 ià(
	`usu®
(
šæ©e_z¡»am
)) {

1673 ià(
	`usu®
(
	`šæ©eRe£t
(
šæ©e_z¡»am
è=ğ
Z_OK
)) ;

1675 
d–‘e
 
šæ©e_z¡»am
;

1678 
šæ©e_z¡»am
 = 
Ãw
 
z_¡»am
;

1680 
šæ©e_z¡»am
->
z®loc
 = 
»š‹½»t_ÿ¡
<
®loc_func
>(0);

1681 
šæ©e_z¡»am
->
zä“
 = 
»š‹½»t_ÿ¡
<
ä“_func
>(0);

1683 
šæ©e_z¡»am
->
Ãxt_š
 = 
Z_NULL
;

1684 
šæ©e_z¡»am
->
ava_š
 = 0;

1686 
”r
 = 
	`šæ©eIn™2
(
šæ©e_z¡»am
, -15);

1687 ià(
	`¿»
(
”r
 !ğ
Z_OK
)) {

1688 ià(
”r
 =ğ
Z_MEM_ERROR
) {

1689 
d–‘e
 
šæ©e_z¡»am
;

1690 
šæ©e_z¡»am
 = 0;

1691 
throw
 
¡d
::
	`bad_®loc
();

1693 
¡ršg
 
msg
 = "inflateInit2 failed (";

1694 ià(
šæ©e_z¡»am
->
msg
) {

1695 
msg
 +ğ
šæ©e_z¡»am
->msg;

1697 
msg
 +ğ
	`om_to¡ršg
(
”r
);

1699 
msg
 += ')';

1700 
d–‘e
 
šæ©e_z¡»am
;

1701 
šæ©e_z¡»am
 = 0;

1702 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1704 
	}
}

1706 
boŞ


1707 
	gCh”tTabË
::
	$exi¡s
() const {

1708 
	`LOGCALL
(
DB
, 
boŞ
, "ChertTable::exists", "");

1709  (
	`fe_exi¡s
(
Çme
 + "DB") &&

1710 (
	`fe_exi¡s
(
Çme
 + "baseA") || file_exists(name + "baseB")));

1711 
	}
}

1717 
	$sys_uÆšk_if_exi¡s
(cÚ¡ 
¡ršg
 & 
f’ame
)

1719 #ifdeà
__WIN32__


1720 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

1722 ià(
	`uÆšk
(
f’ame
) == -1) {

1724 ià(
”ºo
 =ğ
ENOENT
) ;

1725 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Cª'ˆd–‘fe: `" + 
f’ame
 +

1726 "': " + 
	`¡»¼Ü
(
”ºo
));

1728 
	}
}

1731 
	gCh”tTabË
::
	$”a£
()

1733 
	`LOGCALL_VOID
(
DB
, "ChertTable::erase", "");

1734 
	`şo£
();

1736 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseA");

1737 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseB");

1738 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "DB");

1739 
	}
}

1742 
	gCh”tTabË
::
	$£t_block_size
(
block_size_
)

1744 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::£t_block_size", 
block_size_
);

1746 ià(
block_size_
 < 2048 || block_size_ > 
BYTE_PAIR_RANGE
 ||

1747 (
block_size_
 & (block_size_ - 1)) != 0) {

1748 
block_size_
 = 
CHERT_DEFAULT_BLOCK_SIZE
;

1750 
block_size
 = 
block_size_
;

1751 
	}
}

1754 
	gCh”tTabË
::
	$ü—‹_ªd_İ’
(
block_size_
)

1756 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::ü—‹_ªd_İ’", 
block_size_
);

1757 ià(
hªdË
 == -2) {

1758 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

1760 
	`As£¹
(
wr™abË
);

1761 
	`şo£
();

1763 ià(
block_size_
 =ğ0è
	`abÜt
();

1764 
	`£t_block_size
(
block_size_
);

1773 
Ch”tTabË_ba£
 
ba£_
;

1774 
ba£_
.
	`£t_»visiÚ
(
»visiÚ_numb”
);

1775 
ba£_
.
	`£t_block_size
(
block_size_
);

1776 
ba£_
.
	`£t_have_çk”oÙ
(
Œue
);

1777 
ba£_
.
	`£t_£qu’tŸl
(
Œue
);

1778 
ba£_
.
	`wr™e_to_fe
(
Çme
 + "ba£A", 'A', 
	`¡ršg
(), -1, 
NULL
);

1781 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseB");

1784 ()
	`do_İ’_to_wr™e
(
çl£
, 0, 
Œue
);

1785 
	}
}

1787 
	gCh”tTabË
::~
	$Ch”tTabË
() {

1788 
	`LOGCALL_DTOR
(
DB
, "ChertTable");

1789 
Ch”tTabË
::
	`şo£
();

1791 ià(
deæ©e_z¡»am
) {

1794 (è
	`deæ©eEnd
(
deæ©e_z¡»am
);

1795 
d–‘e
 
deæ©e_z¡»am
;

1798 ià(
šæ©e_z¡»am
) {

1801 (è
	`šæ©eEnd
(
šæ©e_z¡»am
);

1802 
d–‘e
 
šæ©e_z¡»am
;

1804 
	}
}

1806 
	gCh”tTabË
::
	$şo£
(
boŞ
 
³rmª’t
) {

1807 
	`LOGCALL_VOID
(
DB
, "ChertTable::close", "");

1809 ià(
hªdË
 >= 0) {

1812 ()::
	`şo£
(
hªdË
);

1813 
hªdË
 = -1;

1816 ià(
³rmª’t
) {

1817 
hªdË
 = -2;

1822 
j
 = 
Ëv–
; j >= 0; j--) {

1823 
d–‘e
 [] 
C
[
j
].
p
;

1824 
C
[
j
].
p
 = 0;

1826 
d–‘e
 [] 
¥l™_p
;

1827 
¥l™_p
 = 0;

1829 
d–‘e
 [] 
kt
.
	`g‘_add»ss
();

1830 
kt
 = 0;

1831 
d–‘e
 [] 
bufãr
;

1832 
bufãr
 = 0;

1833 
	}
}

1836 
	gCh”tTabË
::
	$æush_db
()

1838 
	`LOGCALL_VOID
(
DB
, "ChertTable::flush_db", "");

1839 
	`As£¹
(
wr™abË
);

1840 ià(
hªdË
 < 0) {

1841 ià(
hªdË
 == -2) {

1842 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

1847 
j
 = 
Ëv–
; j >= 0; j--) {

1848 ià(
C
[
j
].
»wr™e
) {

1849 
	`wr™e_block
(
C
[
j
].
n
, C[j].
p
);

1853 ià(
BŒ“_modif›d
) {

1854 
çked_roÙ_block
 = 
çl£
;

1856 
	}
}

1859 
	gCh”tTabË
::
	$comm™
(
ch”t_»visiÚ_numb”_t
 
»visiÚ
, 
chªges_fd
,

1860 cÚ¡ 
¡ršg
 * 
chªges_
)

1862 
	`LOGCALL_VOID
(
DB
, "ChertTable::commit",

1863 
»visiÚ
 << ", " << 
chªges_fd
 << ", " << 
chªges_
);

1864 
	`As£¹
(
wr™abË
);

1866 ià(
»visiÚ
 <ğ
»visiÚ_numb”
) {

1867 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("New„evisionoo†ow");

1870 ià(
hªdË
 < 0) {

1871 ià(
hªdË
 == -2) {

1872 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

1874 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
 = 
»visiÚ
;

1878 
Œy
 {

1879 ià(
çked_roÙ_block
) {

1881 
ba£
.
	`ş—r_b™_m­
();

1884 
ba£
.
	`£t_»visiÚ
(
»visiÚ
);

1885 
ba£
.
	`£t_roÙ
(
C
[
Ëv–
].
n
);

1886 
ba£
.
	`£t_Ëv–
(
Ëv–
);

1887 
ba£
.
	`£t_™em_couÁ
(
™em_couÁ
);

1888 
ba£
.
	`£t_have_çk”oÙ
(
çked_roÙ_block
);

1889 
ba£
.
	`£t_£qu’tŸl
(
£qu’tŸl
);

1891 
ba£_Ë‰”
 = 
	`Ùh”_ba£_Ë‰”
();

1893 
bÙh_ba£s
 = 
Œue
;

1894 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
 = 
»visiÚ
;

1895 
roÙ
 = 
C
[
Ëv–
].
n
;

1897 
BŒ“_modif›d
 = 
çl£
;

1899 
i
 = 0; i < 
BTREE_CURSOR_LEVELS
; ++i) {

1900 
C
[
i
].
n
 = 
BLK_UNUSED
;

1901 
C
[
i
].
c
 = -1;

1902 
C
[
i
].
»wr™e
 = 
çl£
;

1907 ià(!
	`ch”t_io_sync
(
hªdË
)) {

1908 ()::
	`şo£
(
hªdË
);

1909 
hªdË
 = -1;

1910 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Can't commit‚ew„evision - failedo flush DBo disk");

1915 
¡ršg
 
tmp
 = 
Çme
;

1916 
tmp
 += "tmp";

1917 
¡ršg
 
ba£fe
 = 
Çme
;

1918 
ba£fe
 += "base";

1919 
ba£fe
 +ğ(
ba£_Ë‰”
);

1920 
ba£
.
	`wr™e_to_fe
(
tmp
, 
ba£_Ë‰”
, 
bËÇme
, 
chªges_fd
, 
chªges_
);

1921 #ià
defšed
 
__WIN32__


1922 ià(
	`msvc_posix_»Çme
(
tmp
.
	`c_¡r
(), 
ba£fe
.c_str()) < 0)

1924 ià(
	`»Çme
(
tmp
.
	`c_¡r
(), 
ba£fe
.c_str()) < 0)

1932 
§ved_”ºo
 = 
”ºo
;

1933 ià(
	`uÆšk
(
tmp
è=ğ0 || 
”ºo
 !ğ
ENOENT
) {

1934 
¡ršg
 
	`msg
("Couldn't update base file ");

1935 
msg
 +ğ
ba£fe
;

1936 
msg
 += ": ";

1937 
msg
 +ğ
	`¡»¼Ü
(
§ved_”ºo
);

1938 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1941 
ba£
.
	`comm™
();

1943 
	`»ad_roÙ
();

1945 
chªged_n
 = 0;

1946 
chªged_c
 = 
DIR_START
;

1947 
£q_couÁ
 = 
SEQ_START_POINT
;

1948 } 
	`ÿtch
 (...) {

1949 
Ch”tTabË
::
	`şo£
();

1950 
throw
;

1952 
	}
}

1955 
	gCh”tTabË
::
	$wr™e_chªged_blocks
(
chªges_fd
)

1957 
	`LOGCALL_VOID
(
DB
, "Ch”tTabË::wr™e_chªged_blocks", 
chªges_fd
);

1958 
	`As£¹
(
chªges_fd
 >= 0);

1959 ià(
hªdË
 < 0) ;

1960 ià(
çked_roÙ_block
) ;

1962 
¡ršg
 
buf
;

1963 
	`·ck_ušt
(
buf
, 2u);

1964 
	`·ck_¡ršg
(
buf
, 
bËÇme
);

1965 
	`·ck_ušt
(
buf
, 
block_size
);

1966 
	`ch”t_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1970 
ušt4
 
n
 = 0;

1971 
by‹
 * 
p
 = 
Ãw
 by‹[
block_size
];

1972 
Œy
 {

1973 
ba£
.
	`ÿlcuÏ‹_Ï¡_block
();

1974 
ba£
.
	`fšd_chªged_block
(&
n
)) {

1975 
buf
.
	`»size
(0);

1976 
	`·ck_ušt
(
buf
, 
n
 + 1);

1977 
	`ch”t_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1980 
	`»ad_block
(
n
, 
p
);

1983 
	`ch”t_io_wr™e
(
chªges_fd
, 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
),

1984 
block_size
);

1985 ++
n
;

1987 
d–‘e
[] 
p
;

1988 
p
 = 0;

1989 } 
	`ÿtch
 (...) {

1990 
d–‘e
[] 
p
;

1991 
throw
;

1993 
buf
.
	`»size
(0);

1994 
	`·ck_ušt
(
buf
, 0u);

1995 
	`ch”t_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1996 
	}
}

1999 
	gCh”tTabË
::
	$ÿnûl
()

2001 
	`LOGCALL_VOID
(
DB
, "ChertTable::cancel", "");

2002 
	`As£¹
(
wr™abË
);

2004 ià(
hªdË
 < 0) {

2005 ià(
hªdË
 == -2) {

2006 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

2008 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

2014 
¡ršg
 
”r_msg
;

2015 ià(!
ba£
.
	`»ad
(
Çme
, 
ba£_Ë‰”
, 
”r_msg
)) {

2016 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
	`¡ršg
("Couldn'ˆ»»ad ba£ "è+ 
ba£_Ë‰”
);

2019 
»visiÚ_numb”
 = 
ba£
.
	`g‘_»visiÚ
();

2020 
block_size
 = 
ba£
.
	`g‘_block_size
();

2021 
roÙ
 = 
ba£
.
	`g‘_roÙ
();

2022 
Ëv–
 = 
ba£
.
	`g‘_Ëv–
();

2024 
™em_couÁ
 = 
ba£
.
	`g‘_™em_couÁ
();

2025 
çked_roÙ_block
 = 
ba£
.
	`g‘_have_çk”oÙ
();

2026 
£qu’tŸl
 = 
ba£
.
	`g‘_£qu’tŸl
();

2028 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

2030 
j
 = 0; j <ğ
Ëv–
; j++) {

2031 
C
[
j
].
n
 = 
BLK_UNUSED
;

2032 
C
[
j
].
»wr™e
 = 
çl£
;

2034 
	`»ad_roÙ
();

2036 
chªged_n
 = 0;

2037 
chªged_c
 = 
DIR_START
;

2038 
£q_couÁ
 = 
SEQ_START_POINT
;

2039 
	}
}

2043 
boŞ


2044 
	gCh”tTabË
::
	$do_İ’_to_»ad
(
boŞ
 
»visiÚ_suµl›d
, 
ch”t_»visiÚ_numb”_t
 
»visiÚ_
)

2046 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::do_İ’_to_»ad", 
»visiÚ_suµl›d
 << ", " << 
»visiÚ_
);

2047 ià(
hªdË
 == -2) {

2048 
Ch”tTabË
::
	`throw_d©aba£_şo£d
();

2050 
hªdË
 = ::
	`İ’
((
Çme
 + "DB").
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

2051 ià(
hªdË
 < 0) {

2052 ià(
Ïzy
) {

2054 
»visiÚ_numb”
 = 
»visiÚ_
;

2055 
	`RETURN
(
Œue
);

2057 
¡ršg
 
	`mes§ge
("Couldn't open ");

2058 
mes§ge
 +ğ
Çme
;

2059 
mes§ge
 += "DBo„ead: ";

2060 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

2061 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

2064 ià(!
	`basic_İ’
(
»visiÚ_suµl›d
, 
»visiÚ_
)) {

2065 ::
	`şo£
(
hªdË
);

2066 
hªdË
 = -1;

2067 ià(
»visiÚ_suµl›d
) {

2072 
	`RETURN
(
çl£
);

2074 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Failedo openable for„eading");

2077 
j
 = 0; j <ğ
Ëv–
; j++) {

2078 
C
[
j
].
n
 = 
BLK_UNUSED
;

2079 
C
[
j
].
p
 = 
Ãw
 
by‹
[
block_size
];

2080 ià(
C
[
j
].
p
 == 0) {

2081 
throw
 
¡d
::
	`bad_®loc
();

2085 
	`»ad_roÙ
();

2086 
	`RETURN
(
Œue
);

2087 
	}
}

2090 
	gCh”tTabË
::
	$İ’
()

2092 
	`LOGCALL_VOID
(
DB
, "ChertTable::open", "");

2093 
	`LOGLINE
(
DB
, "İ’šg‡ˆ·th " << 
Çme
);

2094 
	`şo£
();

2096 ià(!
wr™abË
) {

2098 ()
	`do_İ’_to_»ad
(
çl£
, 0);

2103 ()
	`do_İ’_to_wr™e
(
çl£
, 0);

2104 
	}
}

2106 
boŞ


2107 
	gCh”tTabË
::
	$İ’
(
ch”t_»visiÚ_numb”_t
 
»visiÚ
)

2109 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::İ’", 
»visiÚ
);

2110 
	`LOGLINE
(
DB
, "İ’šg fÜ…¬ticuÏ¸»visiÚ‡ˆ·th " << 
Çme
);

2111 
	`şo£
();

2113 ià(!
wr™abË
) {

2114 ià(
	`do_İ’_to_»ad
(
Œue
, 
»visiÚ
)) {

2115 
	`As£¹Eq
(
»visiÚ_numb”
, 
»visiÚ
);

2116 
	`RETURN
(
Œue
);

2118 
	`şo£
();

2119 
	`RETURN
(
çl£
);

2123 ià(!
	`do_İ’_to_wr™e
(
Œue
, 
»visiÚ
)) {

2125 
	`şo£
();

2126 
	`RETURN
(
çl£
);

2129 
	`As£¹Eq
(
»visiÚ_numb”
, 
»visiÚ
);

2130 
	`RETURN
(
Œue
);

2131 
	}
}

2133 
boŞ


2134 
	gCh”tTabË
::
	$´ev_fÜ_£qu’tŸl
(
CursÜ
 * 
C_
, ) const

2136 
	`LOGCALL
(
DB
, 
boŞ
, "ChertTable::prev_for_sequential", "C_, UNUSED(int)");

2137 
c
 = 
C_
[0].c;

2138 ià(
c
 =ğ
DIR_START
) {

2139 
by‹
 * 
p
 = 
C_
[0].p;

2140 
	`As£¹
(
p
);

2141 
ušt4
 
n
 = 
C_
[0].n;

2142 
Œue
) {

2143 ià(
n
 =ğ0è
	`RETURN
(
çl£
);

2144 
n
--;

2145 ià(
wr™abË
) {

2146 ià(
n
 =ğ
C
[0].n) {

2149 
	`memıy
(
p
, 
C
[0].p, 
block_size
);

2156 
j
;

2157 
j
 = 1; j <ğ
Ëv–
; ++j) {

2158 ià(
n
 =ğ
C
[
j
].n) ;

2160 ià(
j
 <ğ
Ëv–
) ;

2165 
	`»ad_block
(
n
, 
p
);

2168 
	`»ad_block
(
n
, 
p
);

2170 ià(
wr™abË
è
	`As£¹Eq
(
»visiÚ_numb”
, 
Ï‹¡_»visiÚ_numb”
);

2171 ià(
	`REVISION
(
p
è> 
»visiÚ_numb”
 + 
wr™abË
) {

2172 
	`£t_ov”wr™‹n
();

2173 
	`RETURN
(
çl£
);

2175 ià(
	`GET_LEVEL
(
p
) == 0) ;

2177 
c
 = 
	`DIR_END
(
p
);

2178 
C_
[0].
n
 =‚;

2180 
c
 -ğ
D2
;

2181 
C_
[0].
c
 = c;

2182 
	`RETURN
(
Œue
);

2183 
	}
}

2185 
boŞ


2186 
	gCh”tTabË
::
	$Ãxt_fÜ_£qu’tŸl
(
CursÜ
 * 
C_
, ) const

2188 
	`LOGCALL
(
DB
, 
boŞ
, "ChertTable::next_for_sequential", "C_, UNUSED(int)");

2189 
by‹
 * 
p
 = 
C_
[0].p;

2190 
	`As£¹
(
p
);

2191 
c
 = 
C_
[0].c;

2192 
c
 +ğ
D2
;

2193 
	`As£¹
(()
c
 < 
block_size
);

2194 ià(
c
 =ğ
	`DIR_END
(
p
)) {

2195 
ušt4
 
n
 = 
C_
[0].n;

2196 
Œue
) {

2197 
n
++;

2198 ià(
n
 > 
ba£
.
	`g‘_Ï¡_block
()è
	`RETURN
(
çl£
);

2199 ià(
wr™abË
) {

2200 ià(
n
 =ğ
C
[0].n) {

2203 
	`memıy
(
p
, 
C
[0].p, 
block_size
);

2210 
j
;

2211 
j
 = 1; j <ğ
Ëv–
; ++j) {

2212 ià(
n
 =ğ
C
[
j
].n) ;

2214 ià(
j
 <ğ
Ëv–
) ;

2219 
	`»ad_block
(
n
, 
p
);

2222 
	`»ad_block
(
n
, 
p
);

2224 ià(
wr™abË
è
	`As£¹Eq
(
»visiÚ_numb”
, 
Ï‹¡_»visiÚ_numb”
);

2225 ià(
	`REVISION
(
p
è> 
»visiÚ_numb”
 + 
wr™abË
) {

2226 
	`£t_ov”wr™‹n
();

2227 
	`RETURN
(
çl£
);

2229 ià(
	`GET_LEVEL
(
p
) == 0) ;

2231 
c
 = 
DIR_START
;

2232 
C_
[0].
n
 =‚;

2234 
C_
[0].
c
 = c;

2235 
	`RETURN
(
Œue
);

2236 
	}
}

2238 
boŞ


2239 
	gCh”tTabË
::
	$´ev_deçuÉ
(
CursÜ
 * 
C_
, 
j
) const

2241 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::´ev_deçuÉ", "C_, " << 
j
);

2242 
by‹
 * 
p
 = 
C_
[
j
].p;

2243 
c
 = 
C_
[
j
].c;

2244 
	`As£¹
(
c
 >ğ
DIR_START
);

2245 
	`As£¹
(()
c
 < 
block_size
);

2246 
	`As£¹
(
c
 <ğ
	`DIR_END
(
p
));

2247 ià(
c
 =ğ
DIR_START
) {

2248 ià(
j
 =ğ
Ëv–
è
	`RETURN
(
çl£
);

2249 ià(!
	`´ev_deçuÉ
(
C_
, 
j
 + 1)è
	`RETURN
(
çl£
);

2250 
c
 = 
	`DIR_END
(
p
);

2252 
c
 -ğ
D2
;

2253 
C_
[
j
].
c
 = c;

2254 ià(
j
 > 0) {

2255 
	`block_to_cursÜ
(
C_
, 
j
 - 1, 
	`I‹m
(
p
, 
c
).
	`block_giv’_by
());

2257 
	`RETURN
(
Œue
);

2258 
	}
}

2260 
boŞ


2261 
	gCh”tTabË
::
	$Ãxt_deçuÉ
(
CursÜ
 * 
C_
, 
j
) const

2263 
	`LOGCALL
(
DB
, 
boŞ
, "Ch”tTabË::Ãxt_deçuÉ", "C_, " << 
j
);

2264 
by‹
 * 
p
 = 
C_
[
j
].p;

2265 
c
 = 
C_
[
j
].c;

2266 
	`As£¹
(
c
 >ğ
DIR_START
);

2267 
c
 +ğ
D2
;

2268 
	`As£¹
(()
c
 < 
block_size
);

2270 ià(
c
 >ğ
	`DIR_END
(
p
)) {

2271 ià(
j
 =ğ
Ëv–
è
	`RETURN
(
çl£
);

2272 ià(!
	`Ãxt_deçuÉ
(
C_
, 
j
 + 1)è
	`RETURN
(
çl£
);

2273 
c
 = 
DIR_START
;

2275 
C_
[
j
].
c
 = c;

2276 ià(
j
 > 0) {

2277 
	`block_to_cursÜ
(
C_
, 
j
 - 1, 
	`I‹m
(
p
, 
c
).
	`block_giv’_by
());

2278 #ifdeà
BTREE_DEBUG_FULL


2279 
	`´štf
("Block in ChertTable:next_default");

2280 
	`»pÜt_block_fuÎ
(
j
 - 1, 
C_
[j - 1].
n
, C_[j - 1].
p
);

2283 
	`RETURN
(
Œue
);

2284 
	}
}

2287 
	gCh”tTabË
::
	$throw_d©aba£_şo£d
()

2289 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

2290 
	}
}

2307 
boŞ
 
	gKey
::
İ”©Ü
<(
Key
 
key2
) const

2309 
LOGCALL
(
DB
, 
boŞ
, "Key::İ”©Ü<", 
¡©ic_ÿ¡
<cÚ¡ *>(
key2
.
p
));

2310 
	gkey1_Ën
 = 
Ëngth
();

2311 
	gkey2_Ën
 = 
key2
.
Ëngth
();

2312 ià(
	gkey1_Ën
 =ğ
key2_Ën
) {

2316 
RETURN
(
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
key1_Ën
 + 
C2
) < 0);

2319 
	gk_sm®Ër
 = (
key2_Ën
 < 
key1_Ën
 ? key2_len : key1_len);

2322 
	gdiff
 = 
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
k_sm®Ër
);

2323 ià(
	gdiff
 !ğ0è
RETURN
(
diff
 < 0);

2327 
RETURN
(
key1_Ën
 < 
key2_Ën
);

2330 
boŞ
 
	gKey
::
İ”©Ü
==(
Key
 
key2
) const

2332 
LOGCALL
(
DB
, 
boŞ
, "Key::İ”©Ü==", 
¡©ic_ÿ¡
<cÚ¡ *>(
key2
.
p
));

2333 
	gkey1_Ën
 = 
Ëngth
();

2334 ià(
	gkey1_Ën
 !ğ
key2
.
Ëngth
()è
RETURN
(
çl£
);

2338 
RETURN
(
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
key1_Ën
 + 
C2
) == 0);

	@backends/chert/chert_table.h

23 #iâdeà
OM_HGUARD_CHERT_TABLE_H


24 
	#OM_HGUARD_CHERT_TABLE_H


	)

26 
	~<x­Ÿn/”rÜ.h
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~"ch”t_ty³s.h
"

30 
	~"ch”t_bŒ“ba£.h
"

31 
	~"ch”t_cursÜ.h
"

33 
	~"nÜ‘uº.h
"

34 
	~"omas£¹.h
"

35 
	~"¡ršguts.h
"

36 
	~"uÇligÃd.h
"

37 
	~"uts.h
"

39 
	~"omdebug.h
"

41 
	~<®gÜ™hm
>

42 
	~<¡ršg
>

44 
	~<zlib.h
>

46 
	#DONT_COMPRESS
 -1

	)

53 
	#CHERT_BTREE_MAX_KEY_LEN
 252

	)

56 
	#BYTES_PER_BLOCK_NUMBER
 4

	)

68 
	#K1
 1

	)

69 
	#I2
 2

	)

70 
	#D2
 2

	)

71 
	#C2
 2

	)

75 
	#g‘K
(
p
, 
c
è
	`g‘št1
Õ, c)

	)

76 
	#£tD
(
p
, 
c
, 
x
è
	`£tšt2
Õ, c, x)

	)

98 
	#REVISION
(
b
è
¡©ic_ÿ¡
<>(
	`g‘št4
(b, 0))

	)

99 
	#GET_LEVEL
(
b
è
	`g‘št1
(b, 4)

	)

100 
	#MAX_FREE
(
b
è
	`g‘št2
(b, 5)

	)

101 
	#TOTAL_FREE
(
b
è
	`g‘št2
(b, 7)

	)

102 
	#DIR_END
(
b
è
	`g‘št2
(b, 9)

	)

103 
	#DIR_START
 11

	)

105 
	#SET_REVISION
(
b
, 
x
è
	`£tšt4
(b, 0, x)

	)

106 
	#SET_LEVEL
(
b
, 
x
è
	`£tšt1
(b, 4, x)

	)

107 
	#SET_MAX_FREE
(
b
, 
x
è
	`£tšt2
(b, 5, x)

	)

108 
	#SET_TOTAL_FREE
(
b
, 
x
è
	`£tšt2
(b, 7, x)

	)

109 
	#SET_DIR_END
(
b
, 
x
è
	`£tšt2
(b, 9, x)

	)

111 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mKey
 {

112 cÚ¡ 
by‹
 *
	mp
;

113 
	mpublic
:

114 
ex¶ic™
 
	$Key
(cÚ¡ 
by‹
 * 
p_
è: 
	$p
(
p_
) { }

115 cÚ¡ 
by‹
 * 
	$g‘_add»ss
(ècÚ¡ {  
p
; 
	}
}

116 
»ad
(
¡d
::
¡ršg
 * 
key
) const {

117 
key
->
assign
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 
K1
), 
Ëngth
());

119 
boŞ
 
	gİ”©Ü
==(
Key
 
key2
) const;

120 
boŞ
 
	gİ”©Ü
!=(
Key
 
key2
ècÚ¡ {  !(*
this
 == key2); }

121 
boŞ
 
	gİ”©Ü
<(
Key
 
	gkey2
) const;

122 
boŞ
 
	gİ”©Ü
>=(
Key
 
key2
ècÚ¡ {  !(*
this
 < key2); }

123 
boŞ
 
	gİ”©Ü
>(
Key
 
	gkey2
ècÚ¡ {  key2 < *
	gthis
; }

124 
boŞ
 
	gİ”©Ü
<=(
Key
 
key2
ècÚ¡ {  !(key2 < *
this
); }

125 
	$Ëngth
() const {

126 
	`As£¹R–
(
	`g‘K
(
p
, 0),>=,3);

127  
	`g‘K
(
p
, 0è- 
C2
 - 
K1
;

128 
	}
}

129 
	gİ”©Ü
[](
size_t
 
	gi
) const {

130 
As£¹R–
(
i
,<,(
size_t
)
Ëngth
());

131  
	gp
[
i
 + 
K1
];

137 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	cI‹m_ba£
 {

138 
	m´Ùeùed
:

139 
T
 
p
;

140 
	mpublic
:

142 
	$I‹m_ba£
(
T
 
p_
, 
c
è: 
	`p
Õ_ + 
	$g‘št2
(
p_
, 
c
)) { }

143 
	$I‹m_ba£
(
T
 
p_
è: 
	$p
(
p_
è{ 
	}
}

144 
T
 
	$g‘_add»ss
(ècÚ¡ {  
p
; 
	}
}

146 
	$size
() const {

147 
™em_size
 = 
	`g‘št2
(
p
, 0) & 0x7fff;

148 
	`As£¹R–
(
™em_size
,>=,5);

149  
™em_size
;

150 
	}
}

151 
boŞ
 
	$g‘_com´es£d
(ècÚ¡ {  *
p
 & 0x80; 
	}
}

152 
	$compÚ’t_of
() const {

153  
	`g‘št2
(
p
, 
	`g‘K
Õ, 
I2
è+ I2 - 
C2
);

154 
	}
}

155 
	$compÚ’ts_of
() const {

156  
	`g‘št2
(
p
, 
	`g‘K
Õ, 
I2
) + I2);

157 
	}
}

158 
Key
 
	$key
(ècÚ¡ {  
	`Key
(
p
 + 
I2
); 
	}
}

159 
­³nd_chunk
(
¡d
::
¡ršg
 * 
g
) const {

161 
cd
 = 
g‘K
(
p
, 
I2
è+ 
	gI2
 + 
	gC2
;

162 
	gl
 = 
size
(è- 
cd
;

163 
	gg
->
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 
cd
), 
l
);

168 
ušt4
 
	$block_giv’_by
() const {

169 
	`As£¹R–
(
	`size
(),>=,
BYTES_PER_BLOCK_NUMBER
);

170  
	`g‘št4
(
p
, 
	`size
(è- 
BYTES_PER_BLOCK_NUMBER
);

171 
	}
}

174 
şass
 
	gI‹m
 : 
public
 
I‹m_ba£
<cÚ¡ 
by‹
 *> {

175 
public
:

177 
I‹m
(cÚ¡ 
by‹
 * 
p_
, 
c
è: 
I‹m_ba£
<cÚ¡ by‹ *>Õ_, 
	gc
) { }

178 
I‹m
(cÚ¡ 
by‹
 * 
p_
è: 
I‹m_ba£
<const byte *>(p_) { }

181 
şass
 
	gI‹m_wr
 : 
public
 
I‹m_ba£
<
by‹
 *> {

182 
£t_key_Ën
(
x
è{ 
£tšt1
(
p
, 
I2
, x); }

183 
	gpublic
:

185 
I‹m_wr
(
by‹
 * 
p_
, 
c
è: 
I‹m_ba£
<by‹ *>Õ_, 
	gc
) { }

186 
I‹m_wr
(
by‹
 * 
p_
è: 
I‹m_ba£
<byte *>(p_) { }

187 
£t_compÚ’t_of
(
i
) {

188 
£tšt2
(
p
, 
g‘K
Õ, 
I2
è+ I2 - 
C2
, 
i
);

190 
£t_compÚ’ts_of
(
m
) {

191 
£tšt2
(
p
, 
g‘K
Õ, 
I2
è+ I2, 
m
);

194 
£t_key_ªd_block
(
Key
 
Ãwkey
, 
Œunÿ‹_size
, 
ušt4
 
n
) {

195 
LOGLINE
(
DB
, "set_key_and_block");

196 
LOGLINE
(
DB
, "Old…: " << 
p
);

198 
	gi
 = 
Œunÿ‹_size
;

201 
	gÃwkey_Ën
 = 
Ãwkey
.
Ëngth
();

202 
As£¹R–
(
i
,<=,
Ãwkey_Ën
);

203 
	gÃwsize
 = 
I2
 + 
K1
 + 
i
 + 
C2
;

205 
£tšt2
(
p
, 0, 
Ãwsize
 + 
BYTES_PER_BLOCK_NUMBER
);

207 
£tšt1
(
p
, 
I2
, 
Ãwsize
 - I2);

209 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
, 
Ãwkey
.
g‘_add»ss
(è+ K1, 
i
);

211 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
 + 
i
, 
Ãwkey
.
g‘_add»ss
(è+ K1 + 
Ãwkey_Ën
, 
C2
);

214 
£tšt4
(
p
, 
Ãwsize
, 
n
);

215 
LOGLINE
(
DB
, "New…: " << 
p
);

221 
£t_block_giv’_by
(
ušt4
 
n
) {

222 
£tšt4
(
p
, 
size
(è- 
BYTES_PER_BLOCK_NUMBER
, 
n
);

224 
£t_size
(
l
) {

225 
As£¹R–
(
l
,>=,5);

226 
£tšt2
(
p
, 0, 
l
);

230 
fÜm_nuÎ_key
(
ušt4
 
n
) {

231 
£tšt4
(
p
, 
I2
 + 
K1
, 
n
);

232 
£t_key_Ën
(
K1
);

233 
£t_size
(
I2
 + 
K1
 + 
BYTES_PER_BLOCK_NUMBER
);

235 
fÜm_key
(cÚ¡ 
¡d
::
¡ršg
 & 
key_
) {

236 
LOGLINE
(
DB
, "C®ÈfÜm_key, key is: " << 
key_
);

237 
	g¡d
::
¡ršg
::
size_ty³
 
key_Ën
 = 
key_
.
Ëngth
();

238 ià(
	gkey_Ën
 > 
	gCHERT_BTREE_MAX_KEY_LEN
) {

242 
	g¡d
::
¡ršg
 
msg
("Keyoo†ong:†ength was ");

243 
	gmsg
 +ğ
om_to¡ršg
(
key_Ën
);

244 
	gmsg
 += " bytes, maximum†ength of‡ key is "

245 
STRINGIZE
(
CHERT_BTREE_MAX_KEY_LEN
) " bytes";

246 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
(
msg
);

249 
LOGLINE
(
DB
, "set key†ength");

250 
£t_key_Ën
(
key_Ën
 + 
K1
 + 
C2
);

251 
LOGLINE
(
DB
, "block… befÜmemmove: " << 
p
);

252 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
, 
key_
.
d©a
(), 
key_Ën
);

253 
LOGLINE
(
DB
, "block…‡á” memmove: " << 
p
);

254 
£t_compÚ’t_of
(1);

257 
£t_g
(
cd
, cÚ¡ *
¡¬t
, 
Ën
, 
boŞ
 
com´es£d
) {

258 
	g¡d
::
memmove
(
p
 + 
cd
, 
¡¬t
, 
Ën
);

259 
£t_size
(
cd
 + 
Ën
);

260 ià(
	gcom´es£d
è*
	gp
 |= 0x80;

262 
çke_roÙ_™em
() {

263 
£t_key_Ën
(
K1
 + 
C2
);

264 
£t_size
(
I2
 + 
K1
 + 2 * 
C2
);

265 
£t_compÚ’t_of
(1);

266 
£t_compÚ’ts_of
(1);

273 
	#BTREE_CURSOR_LEVELS
 10

	)

295 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mCh”tTabË
 {

296 
ä›nd
 
şass
 
	mCh”tCursÜ
;

297 
	m´iv©e
:

299 
Ch”tTabË
(const ChertTable &);

302 
	mCh”tTabË
 & 
	mİ”©Ü
=(cÚ¡ 
Ch”tTabË
 &);

305 
boŞ
 
	$»®ly_em±y
() const;

307 
public
:

324 
	`Ch”tTabË
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡d
::
¡ršg
 & 
·th_
,

325 
boŞ
 
»adÚly_
, 
com´ess_¡¿‹gy_
 = 
DONT_COMPRESS
,

326 
boŞ
 
Ïzy
 = 
çl£
);

333 ~
	`Ch”tTabË
();

340 
	`şo£
(
boŞ
 
³rmª’t
=
çl£
);

344 
boŞ
 
	$exi¡s
() const;

354 
	`İ’
();

373 
boŞ
 
	`İ’
(
ch”t_»visiÚ_numb”_t
 
»visiÚ_
);

379 
boŞ
 
	$is_İ’
(ècÚ¡ {  
hªdË
 >= 0; }

386 
	`æush_db
();

404 
	`comm™
(
ch”t_»visiÚ_numb”_t
 
»visiÚ
, 
chªges_fd
 = -1,

405 cÚ¡ 
¡d
::
¡ršg
 * 
chªges_
 = 
NULL
);

411 
	`wr™e_chªged_blocks
(
chªges_fd
);

418 
	`ÿnûl
();

434 
boŞ
 
	`g‘_exaù_’Œy
(cÚ¡ 
¡d
::
¡ršg
 & 
key
, std::¡ršg & 
g
) const;

447 
boŞ
 
	`key_exi¡s
(cÚ¡ 
¡d
::
¡ršg
 &
key
) const;

457 
boŞ
 
	`»ad_g
(
CursÜ
 * 
C_
, 
¡d
::
¡ršg
 *
g
, boŞ 
k“p_com´es£d
) const;

475 
	`add
(cÚ¡ 
¡d
::
¡ršg
 &
key
, std::¡ršg 
g
, 
boŞ
 
®»ady_com´es£d
 = 
çl£
);

492 
boŞ
 
	`d–
(cÚ¡ 
¡d
::
¡ršg
 &
key
);

495 
	`”a£
();

501 
	`£t_block_size
(
block_size_
);

505 
	$g‘_block_size
(ècÚ¡ {  
block_size
; 
	}
}

530 
ü—‹_ªd_İ’
(
blocksize
);

532 
£t_fuÎ_com·ùiÚ
(
boŞ
 
·r™y
);

544 
ch”t_»visiÚ_numb”_t
 
	$g‘_Ï‹¡_»visiÚ_numb”
() const {

545  
Ï‹¡_»visiÚ_numb”
;

546 
	}
}

556 
ch”t_»visiÚ_numb”_t
 
	$g‘_İ’_»visiÚ_numb”
() const {

557  
»visiÚ_numb”
;

558 
	}
}

569 
ch”t_bËsize_t
 
	$g‘_’Œy_couÁ
() const {

570  
™em_couÁ
;

571 
	}
}

574 
boŞ
 
	$em±y
() const {

584  (
Ëv–
 =ğ0è&& 
	`»®ly_em±y
();

585 
	}
}

592 
Ch”tCursÜ
 * 
	$cursÜ_g‘
() const;

599 
boŞ
 
	$is_modif›d
(ècÚ¡ {  
BŒ“_modif›d
; 
	}
}

606 
	$£t_max_™em_size
(
size_t
 
block_ÿ·c™y
) {

607 ià(
block_ÿ·c™y
 > 4) block_capacity = 4;

608 
max_™em_size
 = (
block_size
 - 
DIR_START
 - 
block_ÿ·c™y
 * 
D2
)

609 / 
block_ÿ·c™y
;

610 
	}
}

612 
	g´Ùeùed
:

618 
boŞ
 
do_İ’_to_»ad
(boŞ 
»visiÚ_suµl›d
, 
ch”t_»visiÚ_numb”_t
 
»visiÚ_
);

624 
boŞ
 
do_İ’_to_wr™e
(boŞ 
»visiÚ_suµl›d
,

625 
ch”t_»visiÚ_numb”_t
 
»visiÚ_
,

626 
boŞ
 
ü—‹_db
 = 
çl£
);

627 
boŞ
 
basic_İ’
(boŞ 
»visiÚ_suµl›d
, 
ch”t_»visiÚ_numb”_t
 
»visiÚ
);

629 
boŞ
 
	$fšd
(
CursÜ
 *) const;

630 
	`d–‘e_kt
();

631 
	$»ad_block
(
ušt4
 
n
, 
by‹
 *
p
) const;

632 
	$wr™e_block
(
ušt4
 
n
, cÚ¡ 
by‹
 *
p
) const;

633 
	`XAPIAN_NORETURN
(
	$£t_ov”wr™‹n
() const);

634 
	$block_to_cursÜ
(
CursÜ
 *
C_
, 
j
, 
ušt4
 
n
) const;

635 
	`®‹r
();

636 
	`com·ù
(
by‹
 *
p
);

637 
	`’‹r_key
(
j
, 
Key
 
´evkey
, Key 
Ãwkey
);

638 
	`mid_pošt
(
by‹
 *
p
);

639 
	`add_™em_to_block
(
by‹
 *
p
, 
I‹m_wr
 
kt
, 
c
);

640 
	`add_™em
(
I‹m_wr
 
kt
, 
j
);

641 
	`d–‘e_™em
(
j
, 
boŞ
 
»³©edly
);

642 
	`add_kt
(
boŞ
 
found
);

643 
	`»ad_roÙ
();

644 
	`¥l™_roÙ
(
ušt4
 
¥l™_n
);

645 
	`fÜm_key
(cÚ¡ 
¡d
::
¡ršg
 & 
key
) const;

647 
	$Ùh”_ba£_Ë‰”
() const {

648  (
ba£_Ë‰”
 == 'A') ? 'B' : 'A';

649 
	}
}

652 cÚ¡ * 
	gbËÇme
;

655 
	$Ïzy_®loc_deæ©e_z¡»am
() const;

658 
	$Ïzy_®loc_šæ©e_z¡»am
() const;

661 
ch”t_»visiÚ_numb”_t
 
»visiÚ_numb”
;

664 
ch”t_bËsize_t
 
™em_couÁ
;

667 
block_size
;

672 
mubË
 
ch”t_»visiÚ_numb”_t
 
Ï‹¡_»visiÚ_numb”
;

678 
mubË
 
boŞ
 
bÙh_ba£s
;

681 
ba£_Ë‰”
;

687 
boŞ
 
çked_roÙ_block
;

692 
boŞ
 
£qu’tŸl
;

701 
hªdË
;

704 
Ëv–
;

707 
ušt4
 
roÙ
;

710 
mubË
 
I‹m_wr
 
kt
;

713 
by‹
 * 
bufãr
;

716 
Ch”tTabË_ba£
 
ba£
;

719 
¡d
::
¡ršg
 
Çme
;

724 
£q_couÁ
;

727 
ušt4
 
chªged_n
;

731 
chªged_c
;

734 
size_t
 
max_™em_size
;

737 
mubË
 
boŞ
 
BŒ“_modif›d
;

740 
boŞ
 
fuÎ_com·ùiÚ
;

743 
boŞ
 
wr™abË
;

746 
boŞ
 
	$´ev
(
CursÜ
 *
C_
, 
j
) const {

747 ià(
£qu’tŸl
è 
	`´ev_fÜ_£qu’tŸl
(
C_
, 
j
);

748  
	`´ev_deçuÉ
(
C_
, 
j
);

749 
	}
}

751 
boŞ
 
	$Ãxt
(
CursÜ
 *
C_
, 
j
) const {

752 ià(
£qu’tŸl
è 
	`Ãxt_fÜ_£qu’tŸl
(
C_
, 
j
);

753  
	`Ãxt_deçuÉ
(
C_
, 
j
);

754 
	}
}

757 
boŞ
 
	$´ev_deçuÉ
(
CursÜ
 *
C_
, 
j
) const;

758 
boŞ
 
	$Ãxt_deçuÉ
(
CursÜ
 *
C_
, 
j
) const;

761 
boŞ
 
	$´ev_fÜ_£qu’tŸl
(
CursÜ
 *
C_
, 
dummy
) const;

762 
boŞ
 
	$Ãxt_fÜ_£qu’tŸl
(
CursÜ
 *
C_
, 
dummy
) const;

764 
	`fšd_š_block
(cÚ¡ 
by‹
 * 
p
, 
Key
 
key
, 
boŞ
 
Ëaf
, 
c
);

769 
ušt4
 
	`block_giv’_by
(cÚ¡ 
by‹
 * 
p
, 
c
);

771 
mubË
 
CursÜ
 
C
[
BTREE_CURSOR_LEVELS
];

778 
by‹
 * 
¥l™_p
;

782 
com´ess_¡¿‹gy
;

785 
mubË
 
z_¡»am
 *
deæ©e_z¡»am
;

788 
mubË
 
z_¡»am
 *
šæ©e_z¡»am
;

791 
boŞ
 
Ïzy
;

797 
	`XAPIAN_NORETURN
(
	`throw_d©aba£_şo£d
());

798 
	}
};

	@backends/chert/chert_termlist.cc

23 
	~<cÚfig.h
>

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"ex·ndweight.h
"

28 
	~"ch”t_pos™iÚli¡.h
"

29 
	~"ch”t_‹rmli¡.h
"

30 
	~"omas£¹.h
"

31 
	~"·ck.h
"

32 
	~"uts.h
"

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	gCh”tT”mLi¡
::
Ch”tT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db_
,

37 
X­Ÿn
::
docid
 
did_
)

38 : 
db
(
db_
), 
did
(
did_
), 
cu¼’t_wdf
(0), 
	$cu¼’t_‹rmäeq
(0)

40 
	`DEBUGCALL
(
DB
, , "ChertTermList",

41 "[RefCÁPŒ<cÚ¡ Ch”tD©aba£>], " << 
did_
);

43 ià(!
db
->
‹rmli¡_bË
.
	`g‘_exaù_’Œy
(
Ch”tT”mLi¡TabË
::
	`make_key
(
did
),

44 
d©a
))

45 
throw
 
X­Ÿn
::
	`DocNÙFoundE¼Ü
("NØ‹rmli¡ fÜ docum’ˆ" + 
	`om_to¡ršg
(
did
));

47 
pos
 = 
d©a
.
	`d©a
();

48 
’d
 = 
pos
 + 
d©a
.
	`size
();

50 ià(
pos
 =ğ
’d
) {

51 
doş’
 = 0;

52 
‹rmli¡_size
 = 0;

57 ià(!
	`uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

58 cÚ¡ *
msg
;

59 ià(
pos
 == 0) {

60 
msg
 = "Too†ittle data for doclen inermlist";

62 
msg
 = "Overflowed value for doclen inermlist";

64 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

68 ià(!
	`uÅack_ušt
(&
pos
, 
’d
, &
‹rmli¡_size
)) {

69 cÚ¡ *
msg
;

70 ià(
pos
 == 0) {

71 
msg
 = "Too†ittle data for†ist size inermlist";

73 
msg
 = "Overflowed value for†ist size inermlist";

75 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

77 
	}
}

79 
ch”t_doş’_t


80 
	gCh”tT”mLi¡
::
	$g‘_doş’gth
() const

82 
	`DEBUGCALL
(
DB
, 
ch”t_doş’_t
, "ChertTermList::get_doclength", "");

83 
	`RETURN
(
doş’
);

84 
	}
}

86 
	gX­Ÿn
::
‹rmcouÁ


87 
Ch”tT”mLi¡
::
	$g‘_­´ox_size
() const

89 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertTermList::get_approx_size", "");

90 
	`RETURN
(
‹rmli¡_size
);

91 
	}
}

94 
	gCh”tT”mLi¡
::
accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const

96 
DEBUGCALL
(
DB
, , "ChertTermList::accumulate_stats", "[stats&]");

97 
As£¹
(!
©_’d
());

98 
	g¡©s
.
accumuÏ‹
(
cu¼’t_wdf
, 
doş’
, 
g‘_‹rmäeq
(), 
db
->
g‘_doccouÁ
());

101 
¡ršg


102 
	gCh”tT”mLi¡
::
	$g‘_‹rmÇme
() const

104 
	`DEBUGCALL
(
DB
, 
¡ršg
, "ChertTermList::get_termname", "");

105 
	`RETURN
(
cu¼’t_‹rm
);

106 
	}
}

108 
	gX­Ÿn
::
‹rmcouÁ


109 
Ch”tT”mLi¡
::
	$g‘_wdf
() const

111 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertTermList::get_wdf", "");

112 
	`RETURN
(
cu¼’t_wdf
);

113 
	}
}

115 
	gX­Ÿn
::
doccouÁ


116 
Ch”tT”mLi¡
::
	$g‘_‹rmäeq
() const

118 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "ChertTermList::get_termfreq", "");

119 ià(
cu¼’t_‹rmäeq
 == 0)

120 
cu¼’t_‹rmäeq
 = 
db
->
	`g‘_‹rmäeq
(
cu¼’t_‹rm
);

121 
	`RETURN
(
cu¼’t_‹rmäeq
);

122 
	}
}

124 
T”mLi¡
 *

125 
	gCh”tT”mLi¡
::
	$Ãxt
()

127 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "ChertTermList::next", "");

128 
	`As£¹
(!
	`©_’d
());

129 ià(
pos
 =ğ
’d
) {

130 
pos
 = 
NULL
;

131 
	`RETURN
(
NULL
);

135 
cu¼’t_‹rmäeq
 = 0;

137 
boŞ
 
wdf_š_»u£
 = 
çl£
;

138 ià(!
cu¼’t_‹rm
.
	`em±y
()) {

140 
size_t
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

141 ià(
Ën
 > 
cu¼’t_‹rm
.
	`size
()) {

143 
wdf_š_»u£
 = 
Œue
;

144 
size_t
 
divisÜ
 = 
cu¼’t_‹rm
.
	`size
() + 1;

145 
cu¼’t_wdf
 = 
Ën
 / 
divisÜ
 - 1;

146 
Ën
 %ğ
divisÜ
;

148 
cu¼’t_‹rm
.
	`»size
(
Ën
);

152 
size_t
 
­³nd_Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

153 
cu¼’t_‹rm
.
	`­³nd
(
pos
, 
­³nd_Ën
);

154 
pos
 +ğ
­³nd_Ën
;

157 ià(!
wdf_š_»u£
 && !
	`uÅack_ušt
(&
pos
, 
’d
, &
cu¼’t_wdf
)) {

158 cÚ¡ *
msg
;

159 ià(
pos
 == 0) {

160 
msg
 = "Too†ittle data for wdf inermlist";

162 
msg
 = "Overflowed value for wdf inermlist";

164 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

167 
	`RETURN
(
NULL
);

168 
	}
}

170 
boŞ


171 
	gCh”tT”mLi¡
::
	$©_’d
() const

173 
	`DEBUGCALL
(
DB
, 
boŞ
, "ChertTermList::at_end", "");

174 
	`RETURN
(
pos
 =ğ
NULL
);

175 
	}
}

177 
	gX­Ÿn
::
‹rmcouÁ


178 
Ch”tT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

180 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "ChertTermList::positionlist_count", "");

181 
	`RETURN
(
db
->
pos™iÚ_bË
.
	`pos™iÚli¡_couÁ
(
did
, 
cu¼’t_‹rm
));

182 
	}
}

184 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


185 
Ch”tT”mLi¡
::
	$pos™iÚli¡_begš
() const

187 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
Pos™iÚI‹¿tÜ
, "ChertTermList::positionlist_begin", "");

188  
X­Ÿn
::
	`Pos™iÚI‹¿tÜ
(

189 
Ãw
 
	`Ch”tPos™iÚLi¡
(&
db
->
pos™iÚ_bË
, 
did
, 
cu¼’t_‹rm
));

190 
	}
}

	@backends/chert/chert_termlist.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_TERMLIST_H


22 
	#XAPIAN_INCLUDED_CHERT_TERMLIST_H


	)

24 
	~<¡ršg
>

26 
	~<x­Ÿn/ba£.h
>

27 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

28 
	~<x­Ÿn/ty³s.h
>

30 
Çme¥aû
 
	gX­Ÿn
 {

31 
Çme¥aû
 
	gIÁ”Çl
 {

32 
şass
 
	gEx·ndSts
;

36 
	~"ch”t_d©aba£.h
"

37 
	~"‹rmli¡.h
"

38 
	~"ch”t_bË.h
"

41 şas 
	cCh”tT”mLi¡
 : 
public
 
T”mLi¡
 {

43 
İ”©Ü
=(cÚ¡ 
Ch”tT”mLi¡
 &);

46 
Ch”tT”mLi¡
(const ChertTermList &);

49 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db
;

52 
	mX­Ÿn
::
docid
 
did
;

55 
ch”t_doş’_t
 
	mdoş’
;

58 
	mX­Ÿn
::
‹rmcouÁ
 
‹rmli¡_size
;

61 
	m¡d
::
¡ršg
 
d©a
;

67 cÚ¡ *
	mpos
;

70 cÚ¡ *
	m’d
;

73 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

76 
	mX­Ÿn
::
‹rmcouÁ
 
cu¼’t_wdf
;

83 
mubË
 
	mX­Ÿn
::
doccouÁ
 
cu¼’t_‹rmäeq
;

85 
	mpublic
:

87 
Ch”tT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db_
,

88 
X­Ÿn
::
docid
 
did_
);

94 
ch”t_doş’_t
 
	$g‘_doş’gth
() const;

100 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

103 
	`accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const;

106 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

109 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

118 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

128 
T”mLi¡
 * 
	`Ãxt
();

131 
boŞ
 
	$©_’d
() const;

134 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

137 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

	@backends/chert/chert_termlisttable.cc

21 
	~<cÚfig.h
>

23 
	~"ch”t_‹rmli¡bË.h
"

25 
	~<x­Ÿn/docum’t.h
>

26 
	~<x­Ÿn/”rÜ.h
>

27 
	~<x­Ÿn/‹rm™”©Ü.h
>

29 
	~"omas£¹.h
"

30 
	~"omdebug.h
"

31 
	~"·ck.h
"

32 
	~"¡ršguts.h
"

33 
	~"uts.h
"

35 
	~<¡ršg
>

37 
usšg
 
Çme¥aû
 
	g¡d
;

40 
	gCh”tT”mLi¡TabË
::
£t_‹rmli¡
(
X­Ÿn
::
docid
 
did
,

41 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
,

42 
ch”t_doş’_t
 
doş’
)

44 
DEBUGCALL
(
DB
, , "ChertTermListTable::set_termlist",

45 
did
 << ", " << 
doc
 << ", " << 
doş’
);

47 
¡ršg
 
	gg
;

48 
·ck_ušt
(
g
, 
doş’
);

49 
LOGLINE
(
DB
, "Tag‡á”…ack_ušˆis: " << 
g
);

51 
	gX­Ÿn
::
doccouÁ
 
‹rmli¡_size
 = 
doc
.
‹rmli¡_couÁ
();

52 ià(
	g‹rmli¡_size
 == 0) {

54 
As£¹
(
doş’
 == 0);

55 
As£¹
(
doc
.
‹rmli¡_begš
(è=ğdoc.
‹rmli¡_’d
());

56 
add
(
make_key
(
did
), 
¡ršg
());

60 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
doc
.
‹rmli¡_begš
();

61 ià(
	gt
 !ğ
doc
.
‹rmli¡_’d
()) {

62 
LOGLINE
(
DB
, "T”m is: " << *
t
);

63 
·ck_ušt
(
g
, 
‹rmli¡_size
);

64 
LOGLINE
(
DB
, "·ck_ušt,”mli¡_size: " << 
‹rmli¡_size


65 << ",ag: " << 
g
);

66 
¡ršg
 
	g´ev_‹rm
 = *
t
;

68 
	gg
 +ğ
´ev_‹rm
.
size
();

69 
	gg
 +ğ
´ev_‹rm
;

70 
LOGLINE
(
DB
, "Tag‡á”‡ddšg…»_‹rm: " << 
g
);

71 
·ck_ušt
(
g
, 
t
.
g‘_wdf
());

72 
LOGLINE
(
DB
, "Tag‡á”‡ddšgag: " << 
g
);

73 --
	g‹rmli¡_size
;

75 ++
	gt
 !ğ
doc
.
‹rmli¡_’d
()) {

76 cÚ¡ 
¡ršg
 & 
‹rm
 = *
t
;

80 
LOGLINE
(
DB
, "Tryo find common…refix");

81 
LOGLINE
(
DB
, "T”m is: " << 
‹rm
 << ",…»v_‹rm: " << 
´ev_‹rm
);

82 
size_t
 
	g»u£
 = 
commÚ_´efix_Ëngth
(
´ev_‹rm
, 
‹rm
);

91 
size_t
 
	g·cked
 = 0;

92 
	gX­Ÿn
::
‹rmcouÁ
 
wdf
 = 
t
.
g‘_wdf
();

96 ià(
	gwdf
 < 127)

97 
	g·cked
 = (
wdf
 + 1è* (
´ev_‹rm
.
size
(è+ 1è+ 
»u£
;

99 ià(
	g·cked
 &&…acked < 256) {

101 
	gg
 +ğ(
·cked
);

102 
	gg
 +ğ(
‹rm
.
size
(è- 
»u£
);

103 
	gg
.
­³nd
(
‹rm
.
d©a
(è+ 
»u£
,”m.
size
() -„euse);

105 
	gg
 +ğ(
»u£
);

106 
	gg
 +ğ(
‹rm
.
size
(è- 
»u£
);

107 
	gg
.
­³nd
(
‹rm
.
d©a
(è+ 
»u£
,”m.
size
() -„euse);

110 
·ck_ušt
(
g
, 
wdf
);

112 
LOGLINE
(
DB
, "Newag is: " << 
g
 << ", wdàis: " << 
wdf
);

114 
	g´ev_‹rm
 = *
t
;

115 --
	g‹rmli¡_size
;

118 
As£¹
(
‹rmli¡_size
 == 0);

119 
LOGLINE
(
DB
, "Add key");

120 
add
(
make_key
(
did
), 
g
);

	@backends/chert/chert_termlisttable.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_TERMLISTTABLE_H


22 
	#XAPIAN_INCLUDED_CHERT_TERMLISTTABLE_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"ch”t_ÏzybË.h
"

27 
	~"·ck.h
"

29 
	~<¡ršg
>

31 
Çme¥aû
 
	gX­Ÿn
 {

32 
şass
 
	gDocum’t
;

35 şas 
	cCh”tT”mLi¡TabË
 : 
public
 
Ch”tLazyTabË
 {

36 
public
:

37 
¡d
::
¡ršg
 
make_key
(
X­Ÿn
::
docid
 
did
) {

38 
¡d
::
¡ršg
 
key
;

39 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

40  
	mkey
;

51 
Ch”tT”mLi¡TabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

52 : 
Ch”tLazyTabË
("‹rmli¡", 
dbdœ
 + "/‹rmli¡.", 
»adÚly
,

53 
Z_DEFAULT_STRATEGY
) { }

63 
£t_‹rmli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
doc
,

64 
ch”t_doş’_t
 
doş’
);

70 
d–‘e_‹rmli¡
(
X­Ÿn
::
docid
 
did
è{ 
d–
(
make_key
(did)); }

79 
	$ü—‹_ªd_İ’
(
blocksize
) {

80 
Ch”tTabË
::
	`ü—‹_ªd_İ’
(
blocksize
);

81 
	}
}

	@backends/chert/chert_types.h

22 #iâdeà
OM_HGUARD_CHERT_TYPES_H


23 
	#OM_HGUARD_CHERT_TYPES_H


	)

25 
	~"š‹º®ty³s.h
"

27 
	tch”t_blocksize_t
;

39 
	tch”t_»visiÚ_numb”_t
;

45 
	tch”t_bËsize_t
;

50 
	tch”t_doş’_t
;

56 
	#CHERT_DEFAULT_BLOCK_SIZE
 8192

	)

	@backends/chert/chert_valuelist.cc

21 
	~<cÚfig.h
>

23 
	~"ch”t_v®u–i¡.h
"

25 
	~"ch”t_cursÜ.h
"

26 
	~"ch”t_d©aba£.h
"

27 
	~"omas£¹.h
"

28 
	~"uts.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
boŞ


33 
	gCh”tV®ueLi¡
::
	$upd©e_»ad”
()

35 
X­Ÿn
::
docid
 
fœ¡_did
 = 
	`docid_äom_key
(
¦Ù
, 
cursÜ
->
cu¼’t_key
);

36 ià(!
fœ¡_did
è 
çl£
;

38 
cursÜ
->
	`»ad_g
();

39 cÚ¡ 
¡ršg
 & 
g
 = 
cursÜ
->
cu¼’t_g
;

40 
»ad”
.
	`assign
(
g
.
	`d©a
(),ag.
	`size
(), 
fœ¡_did
);

41  
Œue
;

42 
	}
}

44 
	gCh”tV®ueLi¡
::~
	$Ch”tV®ueLi¡
()

46 
d–‘e
 
cursÜ
;

47 
	}
}

49 
	gX­Ÿn
::
docid


50 
Ch”tV®ueLi¡
::
	$g‘_docid
() const

52 
	`As£¹
(!
	`©_’d
());

53  
»ad”
.
	`g‘_docid
();

54 
	}
}

56 
	gX­Ÿn
::
v®u’o


57 
Ch”tV®ueLi¡
::
	$g‘_v®u’o
() const

59  
¦Ù
;

60 
	}
}

62 
	g¡d
::
¡ršg


63 
Ch”tV®ueLi¡
::
	$g‘_v®ue
() const

65 
	`As£¹
(!
	`©_’d
());

66  
»ad”
.
	`g‘_v®ue
();

67 
	}
}

69 
boŞ


70 
	gCh”tV®ueLi¡
::
	$©_’d
() const

72  
cursÜ
 =ğ
NULL
;

73 
	}
}

76 
	gCh”tV®ueLi¡
::
	$Ãxt
()

78 ià(!
cursÜ
) {

79 
cursÜ
 = 
db
->
	`g‘_po¡li¡_cursÜ
();

80 ià(!
cursÜ
) ;

81 
cursÜ
->
	`fšd_’Œy_ge
(
	`make_v®uechunk_key
(
¦Ù
, 1));

82 } ià(!
»ad”
.
	`©_’d
()) {

83 
»ad”
.
	`Ãxt
();

84 ià(!
»ad”
.
	`©_’d
()) ;

85 
cursÜ
->
	`Ãxt
();

88 ià(!
cursÜ
->
	`aá”_’d
()) {

89 ià(
	`upd©e_»ad”
()) {

90 ià(!
»ad”
.
	`©_’d
()) ;

95 
d–‘e
 
cursÜ
;

96 
cursÜ
 = 
NULL
;

97 
	}
}

100 
	gCh”tV®ueLi¡
::
sk_to
(
X­Ÿn
::
docid
 
did
)

102 ià(!
cursÜ
) {

103 
cursÜ
 = 
db
->
g‘_po¡li¡_cursÜ
();

104 ià(!
	gcursÜ
) ;

105 } ià(!
	g»ad”
.
©_’d
()) {

106 
	g»ad”
.
sk_to
(
did
);

107 ià(!
	g»ad”
.
©_’d
()) ;

110 ià(!
	gcursÜ
->
fšd_’Œy
(
make_v®uechunk_key
(
¦Ù
, 
did
))) {

111 ià(
upd©e_»ad”
()) {

112 
	g»ad”
.
sk_to
(
did
);

113 ià(!
	g»ad”
.
©_’d
()) ;

116 
	gcursÜ
->
Ãxt
();

120 ià(!
	gcursÜ
->
aá”_’d
()) {

121 ià(
upd©e_»ad”
()) {

122 ià(!
	g»ad”
.
©_’d
()) ;

127 
d–‘e
 
	gcursÜ
;

128 
	gcursÜ
 = 
NULL
;

131 
boŞ


132 
	gCh”tV®ueLi¡
::
check
(
X­Ÿn
::
docid
 
did
)

134 ià(!
cursÜ
) {

135 
cursÜ
 = 
db
->
g‘_po¡li¡_cursÜ
();

136 ià(!
	gcursÜ
è 
	gŒue
;

137 } ià(!
	g»ad”
.
©_’d
()) {

139 
	g»ad”
.
sk_to
(
did
);

140 ià(!
	g»ad”
.
©_’d
()è 
	gŒue
;

144 ià(!
	gcursÜ
->
fšd_’Œy
(
make_v®uechunk_key
(
¦Ù
, 
did
))) {

146 ià(
upd©e_»ad”
()) {

147 
	g»ad”
.
sk_to
(
did
);

148 ià(!
	g»ad”
.
©_’d
()è 
	gŒue
;

150  
	gçl£
;

154 
As£¹
(!
cursÜ
->
aá”_’d
());

155 ià(!
upd©e_»ad”
()) {

158 
As£¹
(
çl£
);

161  
	gŒue
;

164 
¡ršg


165 
	gCh”tV®ueLi¡
::
	$g‘_desütiÚ
() const

167 
¡ršg
 
	`desc
("ChertValueList(slot=");

168 
desc
 +ğ
	`om_to¡ršg
(
¦Ù
);

169 
desc
 += ')';

170  
desc
;

171 
	}
}

	@backends/chert/chert_valuelist.h

21 #iâdeà
XAPIAN_INCLUDED_CHERT_VALUELIST_H


22 
	#XAPIAN_INCLUDED_CHERT_VALUELIST_H


	)

24 
	~"v®u–i¡.h
"

25 
	~"ch”t_v®ues.h
"

27 
şass
 
	gCh”tCursÜ
;

28 
şass
 
	gCh”tD©aba£
;

31 şas 
	cCh”tV®ueLi¡
 : 
public
 
X­Ÿn
::
V®ueI‹¿tÜ
::
IÁ”Çl
 {

33 
İ”©Ü
=(cÚ¡ 
Ch”tV®ueLi¡
 &);

36 
Ch”tV®ueLi¡
(const ChertValueList &);

38 
Ch”tCursÜ
 * 
	mcursÜ
;

40 
V®ueChunkR—d”
 
	m»ad”
;

42 
	mX­Ÿn
::
v®u’o
 
¦Ù
;

44 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db
;

47 
boŞ
 
upd©e_»ad”
();

49 
	mpublic
:

50 
Ch”tV®ueLi¡
(
X­Ÿn
::
v®u’o
 
¦Ù_
,

51 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Ch”tD©aba£
> 
db_
)

52 : 
cursÜ
(
NULL
), 
¦Ù
(
¦Ù_
), 
	$db
(
db_
) { }

54 ~
	`Ch”tV®ueLi¡
();

56 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

58 
X­Ÿn
::
v®u’o
 
	$g‘_v®u’o
() const;

60 
¡d
::
¡ršg
 
	$g‘_v®ue
() const;

62 
boŞ
 
	$©_’d
() const;

64 
	`Ãxt
();

66 
	`sk_to
(
X­Ÿn
::
docid
);

68 
boŞ
 
	`check
(
X­Ÿn
::
docid
 
did
);

70 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

71 
	}
};

	@backends/chert/chert_values.cc

22 
	~<cÚfig.h
>

24 
	~"ch”t_v®ues.h
"

26 
	~"ch”t_cursÜ.h
"

27 
	~"ch”t_po¡li¡.h
"

28 
	~"ch”t_‹rmli¡.h
"

29 
	~"docum’t.h
"

30 
	~"omdebug.h
"

31 
	~"·ck.h
"

33 
	~"x­Ÿn/”rÜ.h
"

34 
	~"x­Ÿn/v®ue™”©Ü.h
"

36 
	~<®gÜ™hm
>

37 
	~"autİŒ.h
"

39 
usšg
 
Çme¥aû
 
	g¡d
;

47 
šlše
 
¡ršg


48 
make_¦Ù_key
(
X­Ÿn
::
docid
 
did
)

50 
DEBUGCALL_STATIC
(
DB
, 
¡ršg
, "make_¦Ù_key", 
did
);

54 
¡ršg
 
	gkey
;

55 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

56 
	gkey
 += '\0';

57 
RETURN
(
key
);

61 
šlše
 
¡ršg


62 
make_v®ue¡©s_key
(
X­Ÿn
::
v®u’o
 
¦Ù
)

64 
DEBUGCALL_STATIC
(
DB
, 
¡ršg
, "make_v®ue¡©s_key", 
¦Ù
);

65 
¡ršg
 
key
("\0\xd0", 2);

66 
·ck_ušt_Ï¡
(
key
, 
¦Ù
);

67 
RETURN
(
key
);

71 
	gV®ueChunkR—d”
::
assign
(cÚ¡ * 
p_
, 
size_t
 
Ën
, 
X­Ÿn
::
docid
 
did_
)

73 
p
 = 
p_
;

74 
	g’d
 = 
p_
 + 
Ën
;

75 
	gdid
 = 
did_
;

76 ià(!
uÅack_¡ršg
(&
p
, 
’d
, 
v®ue
))

77 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Failedo unpack first value");

81 
	gV®ueChunkR—d”
::
	$Ãxt
()

83 ià(
p
 =ğ
’d
) {

84 
p
 = 
NULL
;

88 
X­Ÿn
::
docid
 
d–
;

89 ià(!
	`uÅack_ušt
(&
p
, 
’d
, &
d–
))

90 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Failedo unpack streamed value docid");

91 
did
 +ğ
d–
 + 1;

92 ià(!
	`uÅack_¡ršg
(&
p
, 
’d
, 
v®ue
))

93 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Failedo unpack streamed value");

94 
	}
}

97 
	gV®ueChunkR—d”
::
sk_to
(
X­Ÿn
::
docid
 
rg‘
)

99 ià(
p
 =ğ
NULL
 || 
rg‘
 <ğ
did
)

102 
size_t
 
	gv®ue_Ën
;

103 
	gp
 !ğ
’d
) {

105 
X­Ÿn
::
docid
 
d–
;

106 ià(
¿»
(!
uÅack_ušt
(&
p
, 
’d
, &
d–
)))

107 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Failedo unpack streamed value docid");

108 
	gdid
 +ğ
d–
 + 1;

111 ià(
¿»
(!
uÅack_ušt
(&
p
, 
’d
, &
v®ue_Ën
))) {

112 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Failedo unpack streamed value†ength");

116 ià(
¿»
(
v®ue_Ën
 > 
size_t
(
’d
 - 
p
))) {

117 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Failedo unpack streamed value");

121 ià(
	gdid
 >ğ
rg‘
) {

122 
v®ue
.
assign
(
p
, 
v®ue_Ën
);

123 
	gp
 +ğ
v®ue_Ën
;

126 
	gp
 +ğ
v®ue_Ën
;

128 
	gp
 = 
NULL
;

132 
	gCh”tV®ueMªag”
::
add_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
,

133 cÚ¡ 
¡ršg
 & 
v®
)

135 
	gm­
<
	gX­Ÿn
::
v®u’o
, m­<X­Ÿn::
docid
, 
	g¡ršg
> >::
™”©Ü
 
i
;

136 
	gi
 = 
chªges
.
fšd
(
¦Ù
);

137 ià(
	gi
 =ğ
chªges
.
’d
()) {

138 
i
 = 
chªges
.
š£¹
(
make_·œ
(
¦Ù
, 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>())).
	gfœ¡
;

140 
	gi
->
	g£cÚd
[
did
] = 
v®
;

144 
	gCh”tV®ueMªag”
::
»move_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
)

146 
m­
<
X­Ÿn
::
v®u’o
, 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> >::
™”©Ü
 
i
;

147 
	gi
 = 
chªges
.
fšd
(
¦Ù
);

148 ià(
	gi
 =ğ
chªges
.
’d
()) {

149 
i
 = 
chªges
.
š£¹
(
make_·œ
(
¦Ù
, 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>())).
	gfœ¡
;

151 
	gi
->
	g£cÚd
[
did
] = 
¡ršg
();

154 
	gX­Ÿn
::
docid


155 
Ch”tV®ueMªag”
::
g‘_chunk_cÚššg_did
(
X­Ÿn
::
v®u’o
 
¦Ù
,

156 
X­Ÿn
::
docid
 
did
,

157 
¡ršg
 &
chunk
) const

159 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "Ch”tV®ueMªag”::g‘_chunk_cÚššg_did", 
¦Ù
 << ", " << 
did
 << "[chunk]");

160 
	gAutoPŒ
<
	gCh”tCursÜ
> 
cursÜ
(
po¡li¡_bË
->
cursÜ_g‘
());

161 ià(!
	gcursÜ
.
g‘
())  0;

163 
boŞ
 
	gexaù
 = 
cursÜ
->
fšd_’Œy
(
make_v®uechunk_key
(
¦Ù
, 
did
));

164 ià(!
	gexaù
) {

167 cÚ¡ * 
	gp
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

168 cÚ¡ * 
	g’d
 = 
p
 + 
cursÜ
->
cu¼’t_key
.
size
();

171 ià(
	g’d
 - 
	gp
 < 2 || *p++ !ğ'\0' || *
p
++ != '\xd8')  0;

174 
	gX­Ÿn
::
v®u’o
 
v
;

175 ià(!
uÅack_ušt
(&
p
, 
’d
, &
v
)) {

176 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad value key");

178 ià(
	gv
 !ğ
¦Ù
)  0;

181 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
p
, 
’d
, &
did
è|| 
	gp
 !=ƒnd) {

182 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad value key");

186 
	gcursÜ
->
»ad_g
();

187 
sw­
(
chunk
, 
cursÜ
->
cu¼’t_g
);

189  
	gdid
;

192 cÚ¡ 
size_t
 
	gCHUNK_SIZE_THRESHOLD
 = 2000;

194 cÚ¡ 
	gX­Ÿn
::
docid
 
MAX_DOCID
 = 
¡©ic_ÿ¡
<
X­Ÿn
::docid>(-1);

196 şas 
	cV®ueUpd©”
 {

197 
Ch”tPo¡Li¡TabË
 * 
	mbË
;

199 
	mX­Ÿn
::
v®u’o
 
¦Ù
;

201 
¡ršg
 
	mùag
;

203 
V®ueChunkR—d”
 
	m»ad”
;

205 
¡ršg
 
	mg
;

207 
	mX­Ÿn
::
docid
 
´ev_did
;

209 
	mX­Ÿn
::
docid
 
fœ¡_did
;

211 
	mX­Ÿn
::
docid
 
Ãw_fœ¡_did
;

213 
	mX­Ÿn
::
docid
 
Ï¡_®lowed_did
;

215 
­³nd_to_¡»am
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
v®ue
) {

216 
As£¹
(
did
);

217 ià(
	mg
.
em±y
()) {

218 
	mÃw_fœ¡_did
 = 
did
;

220 
As£¹R–
(
did
,>,
´ev_did
);

221 
·ck_ušt
(
g
, 
did
 - 
´ev_did
 - 1);

223 
	m´ev_did
 = 
did
;

224 
·ck_¡ršg
(
g
, 
v®ue
);

225 ià(
	mg
.
size
(è>ğ
CHUNK_SIZE_THRESHOLD
è
wr™e_g
();

228 
	$wr™e_g
() {

230 ià(
fœ¡_did
 && 
Ãw_fœ¡_did
 != first_did) {

231 
bË
->
	`d–
(
	`make_v®uechunk_key
(
¦Ù
, 
fœ¡_did
));

233 ià(!
g
.
	`em±y
()) {

234 
bË
->
	`add
(
	`make_v®uechunk_key
(
¦Ù
, 
Ãw_fœ¡_did
), 
g
);

236 
fœ¡_did
 = 0;

237 
g
.
	`»size
(0);

238 
	}
}

240 
	gpublic
:

241 
V®ueUpd©”
(
Ch”tPo¡Li¡TabË
 * 
bË_
, 
X­Ÿn
::
v®u’o
 
¦Ù_
)

242 : 
bË
(
bË_
), 
¦Ù
(
¦Ù_
), 
fœ¡_did
(0), 
	$Ï¡_®lowed_did
(0è{ 
	}
}

244 ~
	$V®ueUpd©”
() {

245 !
»ad”
.
	`©_’d
()) {

247 
	`­³nd_to_¡»am
(
»ad”
.
	`g‘_docid
(),„—d”.
	`g‘_v®ue
());

248 
»ad”
.
	`Ãxt
();

250 
	`wr™e_g
();

251 
	}
}

253 
upd©e
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
v®ue
) {

254 ià(
	gÏ¡_®lowed_did
 && 
	gdid
 >†ast_allowed_did) {

260 !
	g»ad”
.
©_’d
()) {

262 
As£¹R–
(
»ad”
.
g‘_docid
(),<=,
Ï¡_®lowed_did
);

263 
­³nd_to_¡»am
(
»ad”
.
g‘_docid
(),„—d”.
g‘_v®ue
());

264 
	g»ad”
.
Ãxt
();

266 
wr™e_g
();

267 
	gÏ¡_®lowed_did
 = 0;

269 ià(
	gÏ¡_®lowed_did
 == 0) {

270 
Ï¡_®lowed_did
 = 
MAX_DOCID
;

271 
As£¹
(
g
.
em±y
());

272 
	gÃw_fœ¡_did
 = 0;

273 
	gAutoPŒ
<
	gCh”tCursÜ
> 
cursÜ
(
bË
->
cursÜ_g‘
());

274 ià(
	gcursÜ
->
fšd_’Œy
(
make_v®uechunk_key
(
¦Ù
, 
did
))) {

277 
	gfœ¡_did
 = 
did
;

279 
As£¹
(!
cursÜ
->
aá”_’d
());

283 
	gfœ¡_did
 = 
docid_äom_key
(
¦Ù
, 
cursÜ
->
cu¼’t_key
);

290 ià(
	gfœ¡_did
) {

292 
	gcursÜ
->
»ad_g
();

294 
	gùag
 = 
cursÜ
->
cu¼’t_g
;

295 
	g»ad”
.
assign
(
ùag
.
d©a
(), cg.
size
(), 
fœ¡_did
);

297 ià(
	gcursÜ
->
Ãxt
()) {

298 cÚ¡ 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

299 
	gX­Ÿn
::
docid
 
Ãxt_fœ¡_did
 = 
docid_äom_key
(
¦Ù
, 
key
);

300 ià(
	gÃxt_fœ¡_did
è
	gÏ¡_®lowed_did
 = 
Ãxt_fœ¡_did
 - 1;

301 
As£¹
(
Ï¡_®lowed_did
);

302 
As£¹R–
(
Ï¡_®lowed_did
,>=,
fœ¡_did
);

309 !
	g»ad”
.
©_’d
(è&&„—d”.
g‘_docid
(è< 
	gdid
) {

310 
­³nd_to_¡»am
(
»ad”
.
g‘_docid
(),„—d”.
g‘_v®ue
());

311 
	g»ad”
.
Ãxt
();

313 ià(!
	g»ad”
.
©_’d
(è&&„—d”.
g‘_docid
(è=ğ
did
è
»ad”
.
Ãxt
();

314 ià(!
	gv®ue
.
em±y
()) {

316 
­³nd_to_¡»am
(
did
, 
v®ue
);

322 
	gCh”tV®ueMªag”
::
	$m”ge_chªges
()

324 ià(
‹rmli¡_bË
->
	`is_İ’
()) {

325 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

326 
i
 = 
¦Ùs
.
	`begš
(); i !ğ¦Ùs.
	`’d
(); ++i) {

327 cÚ¡ 
¡ršg
 & 
’c
 = 
i
->
£cÚd
;

328 
¡ršg
 
key
 = 
	`make_¦Ù_key
(
i
->
fœ¡
);

329 ià(!
’c
.
	`em±y
()) {

330 
‹rmli¡_bË
->
	`add
(
key
, 
i
->
£cÚd
);

332 
‹rmli¡_bË
->
	`d–
(
key
);

335 
¦Ùs
.
	`ş—r
();

339 
m­
<
X­Ÿn
::
v®u’o
, m­<X­Ÿn::
docid
, 
¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

340 
i
 = 
chªges
.
	`begš
(); i !ğchªges.
	`’d
(); ++i) {

341 
X­Ÿn
::
v®u’o
 
¦Ù
 = 
i
->
fœ¡
;

342 
V®ueUpd©”
 
	`upd©”
(
po¡li¡_bË
, 
¦Ù
);

343 cÚ¡ 
m­
<
X­Ÿn
::
docid
, 
¡ršg
> & 
¦Ù_chªges
 = 
i
->
£cÚd
;

344 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>::
cÚ¡_™”©Ü
 
j
;

345 
j
 = 
¦Ù_chªges
.
	`begš
(); j !ğ¦Ù_chªges.
	`’d
(); ++j) {

346 
upd©”
.
	`upd©e
(
j
->
fœ¡
, j->
£cÚd
);

349 
chªges
.
	`ş—r
();

351 
	}
}

354 
	gCh”tV®ueMªag”
::
add_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 &
doc
,

355 
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
)

359 
¡ršg
 
	g¦Ùs_u£d
;

360 
	gX­Ÿn
::
v®u’o
 
´ev_¦Ù
 = 
¡©ic_ÿ¡
<
X­Ÿn
::valueno>(-1);

361 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
™
 = 
doc
.
v®ues_begš
();

362 
	g™
 !ğ
doc
.
v®ues_’d
()) {

363 
X­Ÿn
::
v®u’o
 
¦Ù
 = 
™
.
g‘_v®u’o
();

364 
¡ršg
 
	gv®ue
 = *
™
;

367 
	g¡d
::
·œ
<
m­
<
X­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
™”©Ü
, 
	gboŞ
> 
	gi
;

368 
	gi
 = 
v®ue_¡©s
.
š£¹
(
make_·œ
(
¦Ù
, 
V®ueSts
()));

369 
	gV®ueSts
 & 
	g¡©s
 = 
i
.
fœ¡
->
£cÚd
;

370 ià(
	gi
.
	g£cÚd
) {

372 
g‘_v®ue_¡©s
(
¦Ù
, 
¡©s
);

376 ià((
	g¡©s
.
	gäeq
)++ == 0) {

379 
¡©s
.
low”_bound
 = 
v®ue
;

380 
	g¡©s
.
	guµ”_bound
 = 
v®ue
;

383 ià(
	gv®ue
 < 
	g¡©s
.
	glow”_bound
) {

384 
	g¡©s
.
	glow”_bound
 = 
v®ue
;

385 } ià(
	gv®ue
 > 
	g¡©s
.
	guµ”_bound
) {

386 
	g¡©s
.
	guµ”_bound
 = 
v®ue
;

390 
add_v®ue
(
did
, 
¦Ù
, 
v®ue
);

391 ià(
	g‹rmli¡_bË
->
is_İ’
()) {

392 
·ck_ušt
(
¦Ùs_u£d
, 
¦Ù
 - 
´ev_¦Ù
 - 1);

393 
	g´ev_¦Ù
 = 
¦Ù
;

395 ++
	g™
;

397 ià(
	g¦Ùs_u£d
.
em±y
(è&& 
	g¦Ùs
.
fšd
(
did
è=ğ
¦Ùs
.
’d
()) {

400 
sw­
(
¦Ùs
[
did
], 
¦Ùs_u£d
);

405 
	gCh”tV®ueMªag”
::
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
,

406 
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
)

408 
As£¹
(
‹rmli¡_bË
->
is_İ’
());

409 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
>::
™”©Ü
 
™
 = 
¦Ùs
.
fšd
(
did
);

410 
¡ršg
 
	gs
;

411 ià(
	g™
 !ğ
¦Ùs
.
’d
()) {

412 
sw­
(
s
, 
™
->
£cÚd
);

415 ià(!
	g‹rmli¡_bË
->
g‘_exaù_’Œy
(
make_¦Ù_key
(
did
), 
s
)) ;

416 
	g¦Ùs
.
š£¹
(
make_·œ
(
did
, 
¡ršg
()));

418 cÚ¡ * 
	gp
 = 
s
.
d©a
();

419 cÚ¡ * 
	g’d
 = 
p
 + 
s
.
size
();

420 
	gX­Ÿn
::
v®u’o
 
´ev_¦Ù
 = 
¡©ic_ÿ¡
<
X­Ÿn
::valueno>(-1);

421 
	gp
 !ğ
’d
) {

422 
X­Ÿn
::
v®u’o
 
¦Ù
;

423 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
)) {

424 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Value slotƒncoding corrupt");

426 
	g¦Ù
 +ğ
´ev_¦Ù
 + 1;

427 
	g´ev_¦Ù
 = 
¦Ù
;

429 
	g¡d
::
·œ
<
m­
<
X­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
™”©Ü
, 
	gboŞ
> 
	gi
;

430 
	gi
 = 
v®ue_¡©s
.
š£¹
(
make_·œ
(
¦Ù
, 
V®ueSts
()));

431 
	gV®ueSts
 & 
	g¡©s
 = 
i
.
fœ¡
->
£cÚd
;

432 ià(
	gi
.
	g£cÚd
) {

434 
g‘_v®ue_¡©s
(
¦Ù
, 
¡©s
);

438 
As£¹R–P¬ªoid
(
¡©s
.
äeq
, >, 0);

439 ià(--(
	g¡©s
.
	gäeq
) == 0) {

440 
¡©s
.
low”_bound
.
»size
(0);

441 
	g¡©s
.
	guµ”_bound
.
»size
(0);

444 
»move_v®ue
(
did
, 
¦Ù
);

449 
	gCh”tV®ueMªag”
::
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

450 cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
,

451 
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
)

456 
	gdoc
.
	gš‹º®
->
Ãed_v®ues
();

457 
d–‘e_docum’t
(
did
, 
v®ue_¡©s
);

458 
add_docum’t
(
did
, 
doc
, 
v®ue_¡©s
);

461 
¡ršg


462 
	gCh”tV®ueMªag”
::
g‘_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
) const

464 
m­
<
X­Ÿn
::
v®u’o
, 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

465 
	gi
 = 
chªges
.
fšd
(
¦Ù
);

466 ià(
	gi
 !ğ
chªges
.
’d
()) {

467 
m­
<
X­Ÿn
::
docid
, 
¡ršg
>::
cÚ¡_™”©Ü
 
j
;

468 
	gj
 = 
i
->
£cÚd
.
fšd
(
did
);

469 ià(
	gj
 !ğ
i
->
£cÚd
.
’d
()è 
j
->second;

473 
¡ršg
 
	gchunk
;

474 
	gX­Ÿn
::
docid
 
fœ¡_did
;

475 
	gfœ¡_did
 = 
g‘_chunk_cÚššg_did
(
¦Ù
, 
did
, 
chunk
);

476 ià(
	gfœ¡_did
 =ğ0è 
¡ršg
();

478 
V®ueChunkR—d”
 
»ad”
(
chunk
.
d©a
(), chunk.
size
(), 
fœ¡_did
);

479 
	g»ad”
.
sk_to
(
did
);

480 ià(
	g»ad”
.
©_’d
(è||„—d”.
g‘_docid
(è!ğ
did
è 
¡ršg
();

481  
	g»ad”
.
g‘_v®ue
();

485 
	gCh”tV®ueMªag”
::
g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues
,

486 
X­Ÿn
::
docid
 
did
) const

488 
As£¹
(
v®ues
.
em±y
());

489 ià(!
	g‹rmli¡_bË
->
is_İ’
())

490 
throw
 
	gX­Ÿn
::
F—tu»UÇvaabËE¼Ü
("Database has‚oermlist");

491 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
 = 
¦Ùs
.
fšd
(
did
);

492 
¡ršg
 
	gs
;

493 ià(
	gi
 !ğ
¦Ùs
.
’d
()) {

494 
s
 = 
i
->
£cÚd
;

497 ià(!
	g‹rmli¡_bË
->
g‘_exaù_’Œy
(
make_¦Ù_key
(
did
), 
s
)) ;

499 cÚ¡ * 
	gp
 = 
s
.
d©a
();

500 cÚ¡ * 
	g’d
 = 
p
 + 
s
.
size
();

501 
	gX­Ÿn
::
v®u’o
 
´ev_¦Ù
 = 
¡©ic_ÿ¡
<
X­Ÿn
::valueno>(-1);

502 
	gp
 !ğ
’d
) {

503 
X­Ÿn
::
v®u’o
 
¦Ù
;

504 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
)) {

505 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Value slotƒncoding corrupt");

507 
	g¦Ù
 +ğ
´ev_¦Ù
 + 1;

508 
	g´ev_¦Ù
 = 
¦Ù
;

509 
	gv®ues
.
š£¹
(
make_·œ
(
¦Ù
, 
g‘_v®ue
(
did
, slot)));

514 
	gCh”tV®ueMªag”
::
g‘_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

516 
DEBUGCALL
(
DB
, , "Ch”tV®ueMªag”::g‘_v®ue_¡©s", 
¦Ù
);

518 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

519 
g‘_v®ue_¡©s
(
¦Ù
, 
mru_v®¡©s
);

520 
	gmru_v®no
 = 
¦Ù
;

524 
	gCh”tV®ueMªag”
::
g‘_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
¦Ù
, 
V®ueSts
 & 
¡©s
) const

526 
DEBUGCALL
(
DB
, , "Ch”tV®ueMªag”::g‘_v®ue_¡©s", 
¦Ù
 << ", [stats]");

528 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

530 
¡ršg
 
	gg
;

531 ià(
	gpo¡li¡_bË
->
g‘_exaù_’Œy
(
make_v®ue¡©s_key
(
¦Ù
), 
g
)) {

532 cÚ¡ * 
	gpos
 = 
g
.
d©a
();

533 cÚ¡ * 
	g’d
 = 
pos
 + 
g
.
size
();

535 ià(!
uÅack_ušt
(&
pos
, 
’d
, &(
¡©s
.
äeq
))) {

536 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete stats item in valueable");

537 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Frequency statistic in valueable isoo†arge");

539 ià(!
uÅack_¡ršg
(&
pos
, 
’d
, 
¡©s
.
low”_bound
)) {

540 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete stats item in valueable");

541 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Lower bound in valueable isoo†arge");

543 
size_t
 
	gËn
 = 
’d
 - 
pos
;

544 ià(
	gËn
 == 0) {

545 
¡©s
.
uµ”_bound
 = sts.
low”_bound
;

547 
	g¡©s
.
	guµ”_bound
.
assign
(
pos
, 
Ën
);

550 
	g¡©s
.
ş—r
();

553 
	gmru_v®no
 = 
¦Ù
;

557 
	gCh”tV®ueMªag”
::
£t_v®ue_¡©s
(
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
)

559 
DEBUGCALL
(
DB
, , "ChertValueManager::set_value_stats", "[value_stats]");

560 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
;

561 
	gi
 = 
v®ue_¡©s
.
begš
(); i !ğv®ue_¡©s.
’d
(); ++i) {

562 
¡ršg
 
	gkey
 = 
make_v®ue¡©s_key
(
i
->
fœ¡
);

563 cÚ¡ 
	gV®ueSts
 & 
	g¡©s
 = 
i
->
£cÚd
;

564 ià(
	g¡©s
.
	gäeq
 != 0) {

565 
¡ršg
 
Ãw_v®ue
;

566 
·ck_ušt
(
Ãw_v®ue
, 
¡©s
.
äeq
);

567 
·ck_¡ršg
(
Ãw_v®ue
, 
¡©s
.
low”_bound
);

571 ià(
	g¡©s
.
	glow”_bound
 !ğ
¡©s
.
uµ”_bound
)

572 
Ãw_v®ue
 +ğ
¡©s
.
uµ”_bound
;

573 
	gpo¡li¡_bË
->
add
(
key
, 
Ãw_v®ue
);

575 
	gpo¡li¡_bË
->
d–
(
key
);

578 
	gv®ue_¡©s
.
ş—r
();

579 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

	@backends/chert/chert_values.h

22 #iâdeà
XAPIAN_INCLUDED_CHERT_VALUES_H


23 
	#XAPIAN_INCLUDED_CHERT_VALUES_H


	)

25 
	~"·ck.h
"

26 
	~"v®ue¡©s.h
"

28 
	~"x­Ÿn/”rÜ.h
"

29 
	~"x­Ÿn/ty³s.h
"

31 
	~<m­
>

32 
	~<¡ršg
>

35 
šlše
 
	g¡d
::
¡ršg


36 
make_v®uechunk_key
(
X­Ÿn
::
v®u’o
 
¦Ù
, X­Ÿn::
docid
 
did
)

38 
¡d
::
¡ršg
 
key
("\0\xd8", 2);

39 
·ck_ušt
(
key
, 
¦Ù
);

40 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

41  
	gkey
;

44 
šlše
 
	gX­Ÿn
::
docid


45 
docid_äom_key
(
X­Ÿn
::
v®u’o
 
»quœed_¦Ù
, cÚ¡ 
¡d
::
¡ršg
 & 
key
)

47 cÚ¡ * 
p
 = 
key
.
d©a
();

48 cÚ¡ * 
	g’d
 = 
p
 + 
key
.
Ëngth
();

50 ià(
	g’d
 - 
	gp
 < 2 || *p++ !ğ'\0' || *
p
++ != '\xd8')  0;

51 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

52 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
))

53 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("bad value key");

55 ià(
	g¦Ù
 !ğ
»quœed_¦Ù
)  0;

56 
	gX­Ÿn
::
docid
 
did
;

57 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
p
, 
’d
, &
did
))

58 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("bad value key");

59  
	gdid
;

62 
Çme¥aû
 
	gX­Ÿn
 {

63 
şass
 
	gDocum’t
;

66 
şass
 
	gCh”tPo¡Li¡TabË
;

67 
şass
 
	gCh”tT”mLi¡TabË
;

68 
	gV®ueSts
;

70 şas 
	cCh”tV®ueMªag”
 {

76 
mubË
 
	mX­Ÿn
::
v®u’o
 
mru_v®no
;

79 
mubË
 
V®ueSts
 
	mmru_v®¡©s
;

81 
Ch”tPo¡Li¡TabË
 * 
	mpo¡li¡_bË
;

83 
Ch”tT”mLi¡TabË
 * 
	m‹rmli¡_bË
;

85 
	m¡d
::
m­
<
X­Ÿn
::
docid
, std::
¡ršg
> 
¦Ùs
;

87 
	m¡d
::
m­
<
X­Ÿn
::
v®u’o
, std::m­<X­Ÿn::
docid
, std::
¡ršg
> > 
chªges
;

89 
add_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
,

90 cÚ¡ 
¡d
::
¡ršg
 & 
v®
);

92 
»move_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
);

94 
	mX­Ÿn
::
docid
 
g‘_chunk_cÚššg_did
(
X­Ÿn
::
v®u’o
 
¦Ù
,

95 
X­Ÿn
::
docid
 
did
,

96 
¡d
::
¡ršg
 &
chunk
) const;

99 
g‘_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

101 
g‘_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
¦Ù
, 
V®ueSts
 & 
¡©s
) const;

103 
	mpublic
:

105 
	$Ch”tV®ueMªag”
(
Ch”tPo¡Li¡TabË
 * 
po¡li¡_bË_
,

106 
Ch”tT”mLi¡TabË
 * 
‹rmli¡_bË_
)

107 : 
	`mru_v®no
(
X­Ÿn
::
BAD_VALUENO
),

108 
	`po¡li¡_bË
(
po¡li¡_bË_
),

109 
	$‹rmli¡_bË
(
‹rmli¡_bË_
) { }

112 
	`m”ge_chªges
();

114 
	`add_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 &
doc
,

115 
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
);

117 
	`d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
,

118 
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
);

120 
	`»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 &
doc
,

121 
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
);

123 
¡d
::
¡ršg
 
	`g‘_v®ue
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
v®u’o
 
¦Ù
) const;

125 
	`g‘_®l_v®ues
(
¡d
::
m­
<
X­Ÿn
::
v®u’o
, std::
¡ršg
> & 
v®ues
,

126 
X­Ÿn
::
docid
 
did
) const;

128 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
¦Ù
) const {

129 ià(
mru_v®no
 !ğ
¦Ù
è
	`g‘_v®ue_¡©s
(slot);

130  
mru_v®¡©s
.
äeq
;

131 
	}
}

133 
	g¡d
::
¡ršg
 
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
¦Ù
) const {

134 ià(
mru_v®no
 !ğ
¦Ù
è
g‘_v®ue_¡©s
(slot);

135  
	gmru_v®¡©s
.
	glow”_bound
;

138 
	g¡d
::
¡ršg
 
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
¦Ù
) const {

139 ià(
mru_v®no
 !ğ
¦Ù
è
g‘_v®ue_¡©s
(slot);

140  
	gmru_v®¡©s
.
	guµ”_bound
;

150 
£t_v®ue_¡©s
(
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> & 
v®ue_¡©s
);

152 
	$»£t
() {

154 
mru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

155 
	}
}

157 
boŞ
 
	$is_modif›d
() const {

158  !
chªges
.
	`em±y
();

159 
	}
}

161 
	$ÿnûl
() {

163 
¦Ùs
.
	`ş—r
();

164 
chªges
.
	`ş—r
();

165 
	}
}

168 şas 
	cV®ueChunkR—d”
 {

169 cÚ¡ *
	mp
;

170 cÚ¡ *
	m’d
;

172 
	mX­Ÿn
::
docid
 
did
;

174 
	m¡d
::
¡ršg
 
v®ue
;

176 
	mpublic
:

178 
	$V®ueChunkR—d”
(è: 
	$p
(
NULL
) { }

180 
	`V®ueChunkR—d”
(cÚ¡ * 
p_
, 
size_t
 
Ën
, 
X­Ÿn
::
docid
 
did_
) {

181 
	`assign
(
p_
, 
Ën
, 
did_
);

182 
	}
}

184 
assign
(cÚ¡ * 
p_
, 
size_t
 
Ën
, 
X­Ÿn
::
docid
 
did_
);

186 
boŞ
 
	$©_’d
(ècÚ¡ {  
p
 =ğ
NULL
; 
	}
}

188 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
did
; 
	}
}

190 cÚ¡ 
	g¡d
::
¡ršg
 & 
	$g‘_v®ue
(ècÚ¡ {  
v®ue
; 
	}
}

192 
Ãxt
();

194 
sk_to
(
X­Ÿn
::
docid
 
rg‘
);

	@backends/chert/chert_version.cc

21 
	~<cÚfig.h
>

23 
	~"§ã”ºo.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"ch”t_io.h
"

28 
	~"ch”t_v”siÚ.h
"

29 
	~"omas£¹.h
"

30 
	~"¡ršguts.h
"

31 
	~"uts.h
"

33 #ifdeà
__WIN32__


34 
	~"msvc_posix_w¿µ”.h
"

37 
	~<c¡dio
>

38 
	~<c¡ršg
>

39 
	~<¡ršg
>

41 
	~"commÚ/§ãuuid.h
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

46 
	#CHERT_VERSION
 200912150

	)

51 
	#MAGIC_STRING
 "IAmCh”t"

	)

53 
	#MAGIC_LEN
 
	`CONST_STRLEN
(
MAGIC_STRING
)

	)

55 
	#VERSIONFILE_SIZE
 (
MAGIC_LEN
 + 4 + 16)

	)

60 
	#VERSIONFILE_SIZE_LITERAL
 28

	)

63 
	gCh”tV”siÚ
::
	$ü—‹
()

65 
buf
[
VERSIONFILE_SIZE
] = 
MAGIC_STRING
;

66 *
v
 = 
»š‹½»t_ÿ¡
<*>(
buf
è+ 
MAGIC_LEN
;

67 
v
[0] = 
¡©ic_ÿ¡
<>(
CHERT_VERSION
 & 0xff);

68 
v
[1] = 
¡©ic_ÿ¡
<>((
CHERT_VERSION
 >> 8) & 0xff);

69 
v
[2] = 
¡©ic_ÿ¡
<>((
CHERT_VERSION
 >> 16) & 0xff);

70 
v
[3] = 
¡©ic_ÿ¡
<>((
CHERT_VERSION
 >> 24) & 0xff);

72 
	`uuid_g’”©e
(
uuid
);

73 
	`memıy
(
buf
 + 
MAGIC_LEN
 + 4, (*)
uuid
, 16);

75 
fd
 = ::
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
|
O_CREAT
|
O_TRUNC
|
O_BINARY
, 0666);

77 ià(
fd
 < 0) {

78 
¡ršg
 
	`msg
("Failedo create chert version file: ");

79 
msg
 +ğ
f’ame
;

80 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

83 
Œy
 {

84 
	`ch”t_io_wr™e
(
fd
, 
buf
, 
VERSIONFILE_SIZE
);

85 } 
	`ÿtch
 (...) {

86 ()
	`şo£
(
fd
);

87 
throw
;

90 ià(
	`şo£
(
fd
) != 0) {

91 
¡ršg
 
	`msg
("Failedo create chert version file: ");

92 
msg
 +ğ
f’ame
;

93 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

95 
	}
}

98 
	gCh”tV”siÚ
::
	$»ad_ªd_check
()

100 
fd
 = ::
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_RDONLY
|
O_BINARY
);

102 ià(
fd
 < 0) {

103 
¡ršg
 
msg
 = 
f’ame
;

104 
msg
 += ": Failedo open chert version file for„eading";

105 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

109 
buf
[
VERSIONFILE_SIZE
 + 1];

110 
size_t
 
size
;

111 
Œy
 {

112 
size
 = 
	`ch”t_io_»ad
(
fd
, 
buf
, 
VERSIONFILE_SIZE
 + 1, 0);

113 } 
	`ÿtch
 (...) {

114 ()
	`şo£
(
fd
);

115 
throw
;

117 ()
	`şo£
(
fd
);

119 ià(
size
 !ğ
VERSIONFILE_SIZE
) {

120 
	`CompeTimeAs£¹
(
VERSIONFILE_SIZE
 =ğ
VERSIONFILE_SIZE_LITERAL
);

121 
¡ršg
 
msg
 = 
f’ame
;

122 
msg
 += ": Chert version file should be "

123 
	`STRINGIZE
(
VERSIONFILE_SIZE_LITERAL
)" bytes,‡ctually ";

124 
msg
 +ğ
	`om_to¡ršg
(
size
);

125 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

128 ià(
	`memcmp
(
buf
, 
MAGIC_STRING
, 
MAGIC_LEN
) != 0) {

129 
¡ršg
 
msg
 = 
f’ame
;

130 
msg
 += ": Chert version file doesn't containhe„ight magic string";

131 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

134 cÚ¡ *
v
;

135 
v
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
è+ 
MAGIC_LEN
;

136 
v”siÚ
 = 
v
[0] | (v[1] << 8) | (v[2] << 16) | (v[3] << 24);

137 ià(
v”siÚ
 !ğ
CHERT_VERSION
) {

138 
¡ršg
 
msg
 = 
f’ame
;

139 
msg
 += ": Chert version file is version ";

140 
msg
 +ğ
	`om_to¡ršg
(
v”siÚ
);

141 
msg
 +ğ" buˆI oÆy und”¡ªd "
	`STRINGIZE
(
CHERT_VERSION
);

142 
throw
 
X­Ÿn
::
	`D©aba£V”siÚE¼Ü
(
msg
);

145 
	`memıy
((*)
uuid
, 
buf
 + 
MAGIC_LEN
 + 4, 16);

146 
	}
}

	@backends/chert/chert_version.h

21 #iâdeà
OM_HGUARD_CHERT_VERSION_H


22 
	#OM_HGUARD_CHERT_VERSION_H


	)

24 
	~<c¡ršg
>

25 
	~<¡ršg
>

27 
	~"commÚ/§ãuuid.h
"

34 şas 
	cCh”tV”siÚ
 {

36 
	m¡d
::
¡ršg
 
f’ame
;

42 
mubË
 
uuid_t
 
	muuid
;

44 
	mpublic
:

45 
Ch”tV”siÚ
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
è: 
	$f’ame
(
dbdœ
) {

46 
f’ame
 += "/iamchert";

50 
	`ü—‹
();

56 
	`»ad_ªd_check
();

59 cÚ¡ * 
	$g‘_uuid
() const {

61  
»š‹½»t_ÿ¡
<cÚ¡ *>(
uuid
);

62 
	}
}

65 
	g¡d
::
¡ršg
 
	$g‘_uuid_¡ršg
() const {

66 
buf
[37];

67 
	`uuid_uÅ¬£_low”
(
uuid
, 
buf
);

68  
¡d
::
	`¡ršg
(
buf
, 36);

69 
	}
}

72 
	$£t_uuid
(* 
d©a
) {

73 
¡d
::
	`memıy
(
uuid
, 
d©a
, 16);

74 
	}
}

80 
boŞ
 
£t_uuid_¡ršg
(cÚ¡ 
¡d
::
¡ršg
 & 
s
) {

81  
uuid_·r£
(
s
.
c_¡r
(), 
uuid
);

	@backends/contiguousalldocspostlist.cc

21 
	~<cÚfig.h
>

23 
	~<¡ršg
>

25 
	~"cÚtiguou§Îdoc¥o¡li¡.h
"

27 
	~"omas£¹.h
"

28 
	~"uts.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	gX­Ÿn
::
doccouÁ


33 
CÚtiguousAÎDocsPo¡Li¡
::
	$g‘_‹rmäeq
() const

35  
doccouÁ
;

36 
	}
}

38 
	gX­Ÿn
::
docid


39 
CÚtiguousAÎDocsPo¡Li¡
::
	$g‘_docid
() const

41 
	`As£¹
(
did
 != 0);

42 
	`As£¹
(!
	`©_’d
());

43  
did
;

44 
	}
}

46 
	gX­Ÿn
::
‹rmcouÁ


47 
CÚtiguousAÎDocsPo¡Li¡
::
	$g‘_doş’gth
() const

49 
	`As£¹
(
did
 != 0);

50 
	`As£¹
(!
	`©_’d
());

51  
db
->
	`g‘_doş’gth
(
did
);

52 
	}
}

54 
	gX­Ÿn
::
‹rmcouÁ


55 
CÚtiguousAÎDocsPo¡Li¡
::
	$g‘_wdf
() const

57 
	`As£¹
(
did
 != 0);

58 
	`As£¹
(!
	`©_’d
());

60 
	}
}

62 
Pos™iÚLi¡
 *

63 
	gCÚtiguousAÎDocsPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

66  
CÚtiguousAÎDocsPo¡Li¡
::
	`İ’_pos™iÚ_li¡
();

67 
	}
}

69 
Pos™iÚLi¡
 *

70 
	gCÚtiguousAÎDocsPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

72 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Position†ists‚ot meaningful for ContiguousAllDocsPostList");

73 
	}
}

75 
Po¡Li¡
 *

76 
	gCÚtiguousAÎDocsPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
)

78 
As£¹
(!
©_’d
());

79 ià(
	gdid
 =ğ
doccouÁ
) {

80 
db
 = 
NULL
;

82 ++
	gdid
;

84  
	gNULL
;

87 
Po¡Li¡
 *

88 
	gCÚtiguousAÎDocsPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
rg‘
, X­Ÿn::
weight
)

90 
As£¹
(!
©_’d
());

91 ià(
	grg‘
 > 
	gdid
) {

92 ià(
	grg‘
 > 
	gdoccouÁ
) {

93 
	gdb
 = 
NULL
;

95 
	gdid
 = 
rg‘
;

98  
	gNULL
;

101 
boŞ


102 
	gCÚtiguousAÎDocsPo¡Li¡
::
	$©_’d
() const

104  
db
.
	`g‘
(è=ğ
NULL
;

105 
	}
}

107 
¡ršg


108 
	gCÚtiguousAÎDocsPo¡Li¡
::
	$g‘_desütiÚ
() const

110 
¡ršg
 
	`msg
("ContiguousAllDocsPostList(1..");

111 
msg
 +ğ
	`om_to¡ršg
(
doccouÁ
);

112 
msg
 += ')';

113  
msg
;

114 
	}
}

	@backends/database.cc

24 
	~<cÚfig.h
>

26 
	~"d©aba£.h
"

28 
	~"x­Ÿn/”rÜ.h
"

30 
	~"Ëaåo¡li¡.h
"

31 
	~"omas£¹.h
"

32 
	~"¦owv®u–i¡.h
"

34 
	~<®gÜ™hm
>

35 
	~<¡ršg
>

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
Çme¥aû
 
	gX­Ÿn
 {

41 
	gD©aba£
::
IÁ”Çl
::~Internal()

46 
D©aba£
::
IÁ”Çl
::
k“p_®ive
()

52 
X­Ÿn
::
doccouÁ


53 
D©aba£
::
IÁ”Çl
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
) const

55 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't support get_value_freq");

58 
¡ršg


59 
	gD©aba£
::
IÁ”Çl
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
) const

61  
¡ršg
();

64 
¡ršg


65 
	gD©aba£
::
IÁ”Çl
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
) const

67 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't support get_value_upper_bound");

70 
	gX­Ÿn
::
‹rmcouÁ


71 
D©aba£
::
IÁ”Çl
::
g‘_doş’gth_low”_bound
() const

78 
	gX­Ÿn
::
‹rmcouÁ


79 
D©aba£
::
IÁ”Çl
::
g‘_doş’gth_uµ”_bound
() const

83  
mš
(
g‘_tÙ®_Ëngth
(), 
tÙËn_t
(
X­Ÿn
::
‹rmcouÁ
(-1)));

86 
	gX­Ÿn
::
‹rmcouÁ


87 
D©aba£
::
IÁ”Çl
::
g‘_wdf_uµ”_bound
(cÚ¡ 
¡ršg
 & 
‹rm
) const

91  
g‘_cŞËùiÚ_äeq
(
‹rm
);

97 
	gD©aba£
::
IÁ”Çl
::
dtÜ_ÿÎed
()

99 
Œy
 {

100 ià(
Œª§ùiÚ_aùive
()) {

101 
ÿnûl_Œª§ùiÚ
();

102 } ià(
	gŒª§ùiÚ_¡©e
 =ğ
TRANSACTION_NONE
) {

103 
comm™
();

105 } 
ÿtch
 (...) {

112 
	gD©aba£
::
IÁ”Çl
::
comm™
()

115 
As£¹
(
çl£
);

119 
	gD©aba£
::
IÁ”Çl
::
ÿnûl
()

122 
As£¹
(
çl£
);

126 
	gD©aba£
::
IÁ”Çl
::
begš_Œª§ùiÚ
(
boŞ
 
æushed
)

128 ià(
Œª§ùiÚ_¡©e
 !ğ
TRANSACTION_NONE
) {

129 ià(
Œª§ùiÚ_¡©e
 =ğ
TRANSACTION_UNIMPLEMENTED
)

130 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implementransactions");

131 
throw
 
Inv®idO³¿tiÚE¼Ü
("Cannot beginransaction -ransaction‡lready in…rogress");

133 ià(
	gæushed
) {

136 
comm™
();

137 
	gŒª§ùiÚ_¡©e
 = 
TRANSACTION_FLUSHED
;

139 
	gŒª§ùiÚ_¡©e
 = 
TRANSACTION_UNFLUSHED
;

144 
	gD©aba£
::
IÁ”Çl
::
comm™_Œª§ùiÚ
()

146 ià(!
Œª§ùiÚ_aùive
()) {

147 ià(
Œª§ùiÚ_¡©e
 =ğ
TRANSACTION_UNIMPLEMENTED
)

148 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implementransactions");

149 
throw
 
Inv®idO³¿tiÚE¼Ü
("Cannot commitransaction -‚oransaction currently in…rogress");

151 
boŞ
 
	gæushed
 = (
Œª§ùiÚ_¡©e
 =ğ
TRANSACTION_FLUSHED
);

152 
	gŒª§ùiÚ_¡©e
 = 
TRANSACTION_NONE
;

155 ià(
	gæushed
è
comm™
();

159 
	gD©aba£
::
IÁ”Çl
::
ÿnûl_Œª§ùiÚ
()

161 ià(!
Œª§ùiÚ_aùive
()) {

162 ià(
Œª§ùiÚ_¡©e
 =ğ
TRANSACTION_UNIMPLEMENTED
)

163 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implementransactions");

164 
throw
 
Inv®idO³¿tiÚE¼Ü
("Cannot cancelransaction -‚oransaction currently in…rogress");

166 
	gŒª§ùiÚ_¡©e
 = 
TRANSACTION_NONE
;

167 
ÿnûl
();

170 
	gX­Ÿn
::
docid


171 
D©aba£
::
IÁ”Çl
::
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 &)

174 
As£¹
(
çl£
);

179 
	gD©aba£
::
IÁ”Çl
::
d–‘e_docum’t
(
X­Ÿn
::
docid
)

182 
As£¹
(
çl£
);

186 
	gD©aba£
::
IÁ”Çl
::
d–‘e_docum’t
(cÚ¡ 
¡ršg
 & 
unique_‹rm
)

189 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
L—fPo¡Li¡
> 
¶
(
İ’_po¡_li¡
(
unique_‹rm
));

190 
	g¶
->
Ãxt
(), !¶->
©_’d
()) {

191 
d–‘e_docum’t
(
¶
->
g‘_docid
());

196 
	gD©aba£
::
IÁ”Çl
::
»¶aû_docum’t
(
X­Ÿn
::
docid
, cÚ¡ X­Ÿn::
Docum’t
 &)

199 
As£¹
(
çl£
);

202 
	gX­Ÿn
::
docid


203 
D©aba£
::
IÁ”Çl
::
»¶aû_docum’t
(cÚ¡ 
¡ršg
 & 
unique_‹rm
,

204 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

207 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
L—fPo¡Li¡
> 
¶
(
İ’_po¡_li¡
(
unique_‹rm
));

208 
	g¶
->
Ãxt
();

209 ià(
	g¶
->
©_’d
()) {

210  
add_docum’t
(
docum’t
);

212 
	gX­Ÿn
::
docid
 
did
 = 
¶
->
g‘_docid
();

213 
»¶aû_docum’t
(
did
, 
docum’t
);

214 
	g¶
->
Ãxt
(), !¶->
©_’d
()) {

215 
d–‘e_docum’t
(
¶
->
g‘_docid
());

217  
	gdid
;

220 
V®ueLi¡
 *

221 
	gD©aba£
::
IÁ”Çl
::
İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

223  
Ãw
 
SlowV®ueLi¡
(
X­Ÿn
::
D©aba£
(
cÚ¡_ÿ¡
<D©aba£::
IÁ”Çl
*>(
this
)), 
¦Ù
);

226 
T”mLi¡
 *

227 
	gD©aba£
::
IÁ”Çl
::
İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 &) const

232  
NULL
;

235 
T”mLi¡
 *

236 
	gD©aba£
::
IÁ”Çl
::
İ’_¥–lšg_wÜdli¡
() const

241  
NULL
;

244 
	gX­Ÿn
::
doccouÁ


245 
D©aba£
::
IÁ”Çl
::
g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 &) const

254 
	gD©aba£
::
IÁ”Çl
::
add_¥–lšg
(cÚ¡ 
¡ršg
 &, 
X­Ÿn
::
‹rmcouÁ
) const

256 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implement spelling correction");

260 
	gD©aba£
::
IÁ”Çl
::
»move_¥–lšg
(cÚ¡ 
¡ršg
 &, 
X­Ÿn
::
‹rmcouÁ
) const

262 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implement spelling correction");

265 
T”mLi¡
 *

266 
	gD©aba£
::
IÁ”Çl
::
İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 &) const

271  
NULL
;

274 
T”mLi¡
 *

275 
	gD©aba£
::
IÁ”Çl
::
İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 &) const

280  
NULL
;

284 
	gD©aba£
::
IÁ”Çl
::
add_synÚym
(cÚ¡ 
¡ršg
 &, const string &) const

286 
throw
 
	gX­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implement synonyms");

290 
	gD©aba£
::
IÁ”Çl
::
»move_synÚym
(cÚ¡ 
¡ršg
 &, const string &) const

292 
throw
 
	gX­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implement synonyms");

296 
	gD©aba£
::
IÁ”Çl
::
ş—r_synÚyms
(cÚ¡ 
¡ršg
 &) const

298 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implement synonyms");

301 
¡ršg


302 
	gD©aba£
::
IÁ”Çl
::
g‘_m‘ad©a
(cÚ¡ 
¡ršg
 &) const

304  
¡ršg
();

307 
T”mLi¡
 *

308 
	gD©aba£
::
IÁ”Çl
::
İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡ršg
 &) const

312  
NULL
;

316 
	gD©aba£
::
IÁ”Çl
::
£t_m‘ad©a
(cÚ¡ 
¡ršg
 &, const string &)

318 
throw
 
	gX­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't implement metadata");

322 
	gD©aba£
::
IÁ”Çl
::
»İ’
()

329 
D©aba£
::
IÁ”Çl
::
»que¡_docum’t
(
X­Ÿn
::
docid
 ) const

333 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 *

334 
D©aba£
::
IÁ”Çl
::
cŞËù_docum’t
(
X­Ÿn
::
docid
 
did
) const

339  
İ’_docum’t
(
did
, 
Œue
);

343 
	gD©aba£
::
IÁ”Çl
::
wr™e_chªge£ts_to_fd
(, cÚ¡ 
¡ršg
 &, 
boŞ
, 
R•liÿtiÚInfo
 *)

345 
throw
 
	gX­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't…rovide changesets");

348 
¡ršg


349 
	gD©aba£
::
IÁ”Çl
::
g‘_»visiÚ_šfo
() const

351 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("This backend doesn't…rovide‡ccesso„evision information");

354 
¡ršg


355 
	gD©aba£
::
IÁ”Çl
::
g‘_uuid
() const

357  
¡ršg
();

361 
	gD©aba£
::
IÁ”Çl
::
šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::Internal *) const

366 
RemÙeD©aba£
 *

367 
D©aba£
::
IÁ”Çl
::
as_»mÙed©aba£
()

369  
NULL
;

	@backends/databasereplicator.cc

23 
	~<cÚfig.h
>

25 
	~"d©aba£»¶iÿtÜ.h
"

27 
	~"x­Ÿn/”rÜ.h
"

28 
	~"x­Ÿn/v”siÚ.h
"

30 
	~"omdebug.h
"

31 
	~"uts.h
"

33 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


34 
	~"b¿ss/b¿ss_d©aba£»¶iÿtÜ.h
"

36 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


37 
	~"ch”t/ch”t_d©aba£»¶iÿtÜ.h
"

39 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


40 
	~"æšt/æšt_d©aba£»¶iÿtÜ.h
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

45 
Çme¥aû
 
	gX­Ÿn
 {

47 
	gD©aba£R•liÿtÜ
::~
D©aba£R•liÿtÜ
()

51 
D©aba£R•liÿtÜ
 *

52 
D©aba£R•liÿtÜ
::
İ’
(cÚ¡ 
¡ršg
 & 
·th
)

54 
DEBUGCALL_STATIC
(
DB
, , "D©aba£R•liÿtÜ::D©aba£R•liÿtÜ", 
·th
);

56 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


57 ià(
fe_exi¡s
(
·th
 + "/iamchert")) {

58  
Ãw
 
Ch”tD©aba£R•liÿtÜ
(
·th
);

62 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


63 ià(
fe_exi¡s
(
·th
 + "/iamflint")) {

64  
Ãw
 
FlštD©aba£R•liÿtÜ
(
·th
);

68 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


69 ià(
fe_exi¡s
(
·th
 + "/iambrass")) {

70  
Ãw
 
B¿ssD©aba£R•liÿtÜ
(
·th
);

74 
throw
 
D©aba£O³nšgE¼Ü
("Couldn'ˆd‘eùy³ oàd©aba£: " + 
·th
);

	@backends/dbfactory.cc

23 
	~<cÚfig.h
>

25 
	~"x­Ÿn/dbçùÜy.h
"

27 
	~"x­Ÿn/d©aba£.h
"

28 
	~"x­Ÿn/”rÜ.h
"

29 
	~"x­Ÿn/v”siÚ.h
"

31 
	~"debuglog.h
"

32 
	~"feuts.h
"

33 
	~"¡r.h
"

34 
	~"uts.h
"

36 
	~"§ã”ºo.h
"

38 
	~"omdebug.h
"

40 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


41 
	~"b¿ss/b¿ss_d©aba£.h
"

43 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


44 
	~"ch”t/ch”t_d©aba£.h
"

46 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


47 
	~"æšt/æšt_d©aba£.h
"

49 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


50 
	~"šmemÜy/šmemÜy_d©aba£.h
"

53 
	~<f¡»am
>

54 
	~<¡ršg
>

56 
usšg
 
Çme¥aû
 
	g¡d
;

58 
Çme¥aû
 
	gX­Ÿn
 {

60 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


61 
D©aba£


62 
	gB¿ss
::
İ’
(cÚ¡ 
¡ršg
 &
dœ
) {

63 
LOGCALL_STATIC
(
API
, 
D©aba£
, "B¿ss::İ’", 
dœ
);

64 
RETURN
(
D©aba£
(
Ãw
 
B¿ssD©aba£
(
dœ
)));

67 
Wr™abËD©aba£


68 
	gB¿ss
::
İ’
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
) {

69 
LOGCALL_STATIC
(
API
, 
Wr™abËD©aba£
, "B¿ss::İ’", 
dœ
 << ", " << 
aùiÚ
 << ", " << 
block_size
);

70 
RETURN
(
Wr™abËD©aba£
(
Ãw
 
B¿ssWr™abËD©aba£
(
dœ
, 
aùiÚ
, 
block_size
)));

74 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


75 
D©aba£


76 
	gCh”t
::
İ’
(cÚ¡ 
¡ršg
 &
dœ
) {

77 
LOGCALL_STATIC
(
API
, 
D©aba£
, "Ch”t::İ’", 
dœ
);

78  
D©aba£
(
Ãw
 
Ch”tD©aba£
(
dœ
));

81 
Wr™abËD©aba£


82 
	gCh”t
::
İ’
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
) {

83 
LOGCALL_STATIC
(
API
, 
Wr™abËD©aba£
, "Ch”t::İ’", 
dœ
 << ", " <<

84 
aùiÚ
 << ", " << 
block_size
);

85  
Wr™abËD©aba£
(
Ãw
 
Ch”tWr™abËD©aba£
(
dœ
, 
aùiÚ
, 
block_size
));

89 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


90 
D©aba£


91 
	gFlšt
::
İ’
(cÚ¡ 
¡ršg
 &
dœ
) {

92 
LOGCALL_STATIC
(
API
, 
D©aba£
, "Flšt::İ’", 
dœ
);

93  
D©aba£
(
Ãw
 
FlštD©aba£
(
dœ
));

96 
Wr™abËD©aba£


97 
	gFlšt
::
İ’
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
) {

98 
LOGCALL_STATIC
(
API
, 
Wr™abËD©aba£
, "Flšt::İ’", 
dœ
 << ", " <<

99 
aùiÚ
 << ", " << 
block_size
);

100  
Wr™abËD©aba£
(
Ãw
 
FlštWr™abËD©aba£
(
dœ
, 
aùiÚ
, 
block_size
));

104 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


105 
Wr™abËD©aba£


106 
	gInMemÜy
::
İ’
() {

107 
LOGCALL_STATIC
(
API
, 
D©aba£
, "InMemory::open", "");

108  
Wr™abËD©aba£
(
Ãw
 
InMemÜyD©aba£
);

113 
İ’_¡ub
(
D©aba£
 &
db
, cÚ¡ 
¡ršg
 &
fe
)

122 
LOGLINE
(
DB
, "İ’ stub iÀdbçùÜy.cc, fÇme: " << 
fe
);

123 
if¡»am
 
¡ub
(
fe
.
c_¡r
());

124 
¡ršg
 
	g¡ubdœ
 = 
ÿlc_dœÇme
(
fe
);

125 
¡ršg
 
	glše
;

126 
	glše_no
 = 0;

127 
g‘lše
(
¡ub
, 
lše
)) {

128 ++
	glše_no
;

129 
LOGLINE
(
DB
, 
fe
 << " cÚ‹Á: " << 
lše
);

130 
LOGLINE
(
DB
, "Create db in open_stub");

131 ià(
	glše
.
em±y
() ||†ine[0] == '#')

133 
	g¡ršg
::
size_ty³
 
¥aû
 = 
lše
.
fšd
(' ');

134 ià(
	g¥aû
 =ğ
¡ršg
::
Åos
è
¥aû
 = 
lše
.
size
();

136 
¡ršg
 
ty³
(
lše
, 0, 
¥aû
);

137 
	glše
.
”a£
(0, 
¥aû
 + 1);

138 
LOGLINE
(
DB
, "ty³: " << 
ty³
);

139 ià(
	gty³
 == "auto") {

140 
db
.
add_d©aba£
(
D©aba£
(
još_·ths
(
¡ubdœ
, 
lše
)));

144 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


145 ià(
	gty³
 == "chert") {

146 
db
.
add_d©aba£
(
Ch”t
::
İ’
(
još_·ths
(
¡ubdœ
, 
lše
)));

151 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


152 ià(
	gty³
 == "flint") {

153 
db
.
add_d©aba£
(
Flšt
::
İ’
(
još_·ths
(
¡ubdœ
, 
lše
)));

158 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


159 ià(
	gty³
 == "brass") {

160 
db
.
add_d©aba£
(
B¿ss
::
İ’
(
još_·ths
(
¡ubdœ
, 
lše
)));

165 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


166 ià(
	gty³
 == "remote") {

167 
¡ršg
::
size_ty³
 
cŞÚ
 = 
lše
.
fšd
(':');

168 ià(
	gcŞÚ
 == 0) {

172 
¥aû
 = 
lše
.
fšd
(' ');

173 
¡ršg
 
	g¬gs
;

174 ià(
	g¥aû
 !ğ
¡ršg
::
Åos
) {

175 
¬gs
.
assign
(
lše
, 
¥aû
 + 1, 
¡ršg
::
Åos
);

176 
	glše
.
assign
(
lše
, 1, 
¥aû
 - 1);

178 
	glše
.
”a£
(0, 1);

180 
	gdb
.
add_d©aba£
(
RemÙe
::
İ’
(
lše
, 
¬gs
));

181 } ià(
	gcŞÚ
 !ğ
¡ršg
::
Åos
) {

184 
pÜt
 = 
©oi
(
lše
.
c_¡r
(è+ 
cŞÚ
 + 1);

185 
	glše
.
”a£
(
cŞÚ
);

186 
	gdb
.
add_d©aba£
(
RemÙe
::
İ’
(
lše
, 
pÜt
));

192 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


193 ià(
	gty³
 =ğ"šmemÜy" && 
lše
.
em±y
()) {

194 
db
.
add_d©aba£
(
InMemÜy
::
İ’
());

204 
throw
 
D©aba£O³nšgE¼Ü
(
fe
 + ':' + 
¡r
(
lše_no
) + ": Bad†ine");

214 
LOGLINE
(
DB
, "Return from open_stub");

218 
İ’_¡ub
(
Wr™abËD©aba£
 &
db
, cÚ¡ 
¡ršg
 &
fe
, 
aùiÚ
)

228 
if¡»am
 
¡ub
(
fe
.
c_¡r
());

229 
¡ršg
 
	g¡ubdœ
 = 
ÿlc_dœÇme
(
fe
);

230 
¡ršg
 
	glše
;

231 
	glše_no
 = 0;

232 
	gŒue
) {

233 ià(
	gdb
.
	gš‹º®
.
size
() > 1) {

234 
throw
 
D©aba£O³nšgE¼Ü
(
fe
 + ": Can't open‡ stub database†isting multiple databases‡s‡ WritableDatabase");

237 ià(!
g‘lše
(
¡ub
, 
lše
)) ;

239 ++
	glše_no
;

240 ià(
	glše
.
em±y
() ||†ine[0] == '#')

242 
	g¡ršg
::
size_ty³
 
¥aû
 = 
lše
.
fšd
(' ');

243 ià(
	g¥aû
 =ğ
¡ršg
::
Åos
è
¥aû
 = 
lše
.
size
();

245 
¡ršg
 
ty³
(
lše
, 0, 
¥aû
);

246 
	glše
.
”a£
(0, 
¥aû
 + 1);

248 ià(
	gty³
 == "auto") {

249 
db
.
add_d©aba£
(
Wr™abËD©aba£
(
još_·ths
(
¡ubdœ
, 
lše
),

250 
aùiÚ
));

254 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


255 ià(
	gty³
 == "chert") {

256 
db
.
add_d©aba£
(
Ch”t
::
İ’
(
još_·ths
(
¡ubdœ
, 
lše
), 
aùiÚ
));

261 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


262 ià(
	gty³
 == "flint") {

263 
db
.
add_d©aba£
(
Flšt
::
İ’
(
još_·ths
(
¡ubdœ
, 
lše
), 
aùiÚ
));

268 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


269 ià(
	gty³
 == "brass") {

270 
db
.
add_d©aba£
(
B¿ss
::
İ’
(
još_·ths
(
¡ubdœ
, 
lše
), 
aùiÚ
));

275 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


276 ià(
	gty³
 == "remote") {

277 
¡ršg
::
size_ty³
 
cŞÚ
 = 
lše
.
fšd
(':');

278 ià(
	gcŞÚ
 == 0) {

282 
¥aû
 = 
lše
.
fšd
(' ');

283 
¡ršg
 
	g¬gs
;

284 ià(
	g¥aû
 !ğ
¡ršg
::
Åos
) {

285 
¬gs
.
assign
(
lše
, 
¥aû
 + 1, 
¡ršg
::
Åos
);

286 
	glše
.
assign
(
lše
, 1, 
¥aû
 - 1);

288 
	glše
.
”a£
(0, 1);

290 
	gdb
.
add_d©aba£
(
RemÙe
::
İ’_wr™abË
(
lše
, 
¬gs
));

291 } ià(
	gcŞÚ
 !ğ
¡ršg
::
Åos
) {

294 
pÜt
 = 
©oi
(
lše
.
c_¡r
(è+ 
cŞÚ
 + 1);

295 
	glše
.
”a£
(
cŞÚ
);

296 
	gdb
.
add_d©aba£
(
RemÙe
::
İ’_wr™abË
(
lše
, 
pÜt
));

302 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


303 ià(
	gty³
 =ğ"šmemÜy" && 
lše
.
em±y
()) {

304 
db
.
add_d©aba£
(
InMemÜy
::
İ’
());

314 
throw
 
D©aba£O³nšgE¼Ü
(
fe
 + ':' + 
¡r
(
lše_no
) + ": Bad†ine");

317 ià(
	gdb
.
	gš‹º®
.
em±y
()) {

318 
throw
 
D©aba£O³nšgE¼Ü
(
fe
 + ": No databases†isted");

322 
D©aba£


323 
	gAuto
::
İ’_¡ub
(cÚ¡ 
¡ršg
 &
fe
)

325 
LOGCALL_STATIC
(
API
, 
D©aba£
, "Auto::İ’_¡ub", 
fe
);

326 
D©aba£
 
	gdb
;

327 
İ’_¡ub
(
db
, 
fe
);

328 
RETURN
(
db
);

331 
Wr™abËD©aba£


332 
	gAuto
::
İ’_¡ub
(cÚ¡ 
¡ršg
 &
fe
, 
aùiÚ
)

334 
LOGCALL_STATIC
(
API
, 
Wr™abËD©aba£
, "Auto::İ’_¡ub", 
fe
 << ", " << 
aùiÚ
);

335 
Wr™abËD©aba£
 
	gdb
;

336 
İ’_¡ub
(
db
, 
fe
, 
aùiÚ
);

337 
RETURN
(
db
);

340 
	gD©aba£
::
D©aba£
(cÚ¡ 
¡ršg
 &
·th
)

342 
LOGCALL_CTOR
(
API
, "D©aba£::D©aba£", 
·th
);

344 
¡©
 
	g¡©buf
;

345 ià(
¡©
(
·th
, &
¡©buf
) == -1) {

346 
throw
 
D©aba£O³nšgE¼Ü
("Couldn'ˆ¡© '" + 
·th
 + "'", 
”ºo
);

349 ià(
S_ISREG
(
¡©buf
.
¡_mode
)) {

351 
İ’_¡ub
(*
this
, 
·th
);

355 ià(
¿»
(!
S_ISDIR
(
¡©buf
.
¡_mode
))) {

356 
throw
 
D©aba£O³nšgE¼Ü
("NÙ‡„eguÏ¸fÜ dœeùÜy: '" + 
·th
 + "'");

359 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


360 ià(
fe_exi¡s
(
·th
 + "/iamchert")) {

361 
	gš‹º®
.
push_back
(
Ãw
 
Ch”tD©aba£
(
·th
));

366 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


367 ià(
fe_exi¡s
(
·th
 + "/iamflint")) {

368 
	gš‹º®
.
push_back
(
Ãw
 
FlštD©aba£
(
·th
));

373 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


374 ià(
fe_exi¡s
(
·th
 + "/iambrass")) {

375 
	gš‹º®
.
push_back
(
Ãw
 
B¿ssD©aba£
(
·th
));

381 
¡ršg
 
	g¡ub_fe
 = 
·th
;

382 
	g¡ub_fe
 += "/XAPIANDB";

383 ià(
¿»
(!
fe_exi¡s
(
¡ub_fe
))) {

384 
throw
 
D©aba£O³nšgE¼Ü
("Couldn't detectype of database");

387 
İ’_¡ub
(*
this
, 
¡ub_fe
);

390 #ià
defšed
 
XAPIAN_HAS_FLINT_BACKEND
 || \

391 
defšed
 
	gXAPIAN_HAS_CHERT_BACKEND
 || \

392 
defšed
 
	gXAPIAN_HAS_BRASS_BACKEND


393 
	#HAVE_DISK_BACKEND


	)

396 
	gWr™abËD©aba£
::
Wr™abËD©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
·th
, 
aùiÚ
)

397 : 
D©aba£
()

399 
LOGCALL_CTOR
(
API
, "Wr™abËD©aba£::Wr™abËD©aba£", 
·th
 << ", " << 
aùiÚ
);

400 #ifdeà
HAVE_DISK_BACKEND


402 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


403 
	gCHERT
,

405 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


406 
	gFLINT
,

408 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


409 
	gBRASS
,

411 
	gUNSET


412 } 
	gty³
 = 
UNSET
;

414 
¡©
 
	g¡©buf
;

415 ià(
¡©
(
·th
, &
¡©buf
) == -1) {

417 ià(
”ºo
 !ğ
ENOENT
)

418 
throw
 
D©aba£O³nšgE¼Ü
("Couldn'ˆ¡© '" + 
·th
 + "'", 
”ºo
);

422 ià(
S_ISREG
(
¡©buf
.
¡_mode
)) {

424 
İ’_¡ub
(*
this
, 
·th
, 
aùiÚ
);

428 ià(
¿»
(!
S_ISDIR
(
¡©buf
.
¡_mode
))) {

429 
throw
 
D©aba£O³nšgE¼Ü
("NÙ‡„eguÏ¸fÜ dœeùÜy: '" + 
·th
 + "'");

432 ià(
fe_exi¡s
(
·th
 + "/iamchert")) {

434 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


435 
	gty³
 = 
CHERT
;

437 
throw
 
F—tu»UÇvaabËE¼Ü
("Chert backend disabled");

439 } ià(
fe_exi¡s
(
·th
 + "/iamflint")) {

441 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


442 
	gty³
 = 
FLINT
;

444 
throw
 
F—tu»UÇvaabËE¼Ü
("Flint backend disabled");

446 } ià(
fe_exi¡s
(
·th
 + "/iambrass")) {

448 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


449 
	gty³
 = 
BRASS
;

451 
throw
 
F—tu»UÇvaabËE¼Ü
("Brass backend disabled");

455 
¡ršg
 
	g¡ub_fe
 = 
·th
;

456 
	g¡ub_fe
 += "/XAPIANDB";

457 ià(
usu®
(
fe_exi¡s
(
¡ub_fe
))) {

458 
İ’_¡ub
(*
this
, 
¡ub_fe
, 
aùiÚ
);

464 #ifdeà
HAVE_DISK_BACKEND


465 
	gty³
) {

466 
	gUNSET
: {

467 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


470 #ià
defšed
 
XAPIAN_HAS_CHERT_BACKEND
 || defšed 
XAPIAN_HAS_FLINT_BACKEND


473 cÚ¡ *
p
 = 
g‘’v
("XAPIAN_PREFER_BRASS");

474 ià(
	gp
 && *p)

475 
	gb¿ss
;

481 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


482 
	gCHERT
:

483 
š‹º®
.
push_back
(
Ãw
 
Ch”tWr™abËD©aba£
(
·th
, 
aùiÚ
, 8192));

486 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


487 
	gFLINT
:

488 
š‹º®
.
push_back
(
Ãw
 
FlštWr™abËD©aba£
(
·th
, 
aùiÚ
, 8192));

491 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


492 
	gBRASS
:

493 
b¿ss
:

494 
š‹º®
.
push_back
(
Ãw
 
B¿ssWr™abËD©aba£
(
·th
, 
aùiÚ
, 8192));

499 
throw
 
F—tu»UÇvaabËE¼Ü
("No disk-based writable backend isƒnabled");

	@backends/dbfactory_remote.cc

20 
	~<cÚfig.h
>

22 
	~<x­Ÿn/dbçùÜy.h
>

24 
	~"´ogş›Á.h
"

25 
	~"»mÙ‘ış›Á.h
"

27 
	~<¡ršg
>

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
Çme¥aû
 
	gX­Ÿn
 {

33 
D©aba£


34 
	gRemÙe
::
İ’
(cÚ¡ 
¡ršg
 &
ho¡
, 
pÜt
, 
X­Ÿn
::
timeout
imeout,

35 
X­Ÿn
::
timeout
 
cÚÃù_timeout
)

37 
DEBUGAPICALL_STATIC
(
D©aba£
, "Remote::open",

38 
ho¡
 << ", " << 
pÜt
 << ", " << 
timeout
 << ", " << 
cÚÃù_timeout
);

39  
D©aba£
(
Ãw
 
RemÙeTıCl›Á
(
ho¡
, 
pÜt
, 
timeout
, 
cÚÃù_timeout
, 
çl£
));

42 
Wr™abËD©aba£


43 
	gRemÙe
::
İ’_wr™abË
(cÚ¡ 
¡ršg
 &
ho¡
, 
pÜt
,

44 
X­Ÿn
::
timeout
imeout, X­Ÿn::timeouˆ
cÚÃù_timeout
)

46 
DEBUGAPICALL_STATIC
(
Wr™abËD©aba£
, "Remote::open_writable",

47 
ho¡
 << ", " << 
pÜt
 << ", " << 
timeout
 << ", " << 
cÚÃù_timeout
);

48  
Wr™abËD©aba£
(
Ãw
 
RemÙeTıCl›Á
(
ho¡
, 
pÜt
, 
timeout
, 
cÚÃù_timeout
, 
Œue
));

51 
D©aba£


52 
	gRemÙe
::
İ’
(cÚ¡ 
¡ršg
 &
´og¿m
, cÚ¡ sŒšg &
¬gs
, 
X­Ÿn
::
timeout
imeout)

54 
DEBUGAPICALL_STATIC
(
D©aba£
, "Remote::open",

55 
´og¿m
 << ", " << 
¬gs
 << ", " << 
timeout
);

56  
D©aba£
(
Ãw
 
ProgCl›Á
(
´og¿m
, 
¬gs
, 
timeout
, 
çl£
));

59 
Wr™abËD©aba£


60 
	gRemÙe
::
İ’_wr™abË
(cÚ¡ 
¡ršg
 &
´og¿m
, cÚ¡ sŒšg &
¬gs
,

61 
X­Ÿn
::
timeout
imeout)

63 
DEBUGAPICALL_STATIC
(
Wr™abËD©aba£
, "Remote::open_writable",

64 
´og¿m
 << ", " << 
¬gs
 << ", " << 
timeout
);

65  
Wr™abËD©aba£
(
Ãw
 
ProgCl›Á
(
´og¿m
, 
¬gs
, 
timeout
, 
Œue
));

	@backends/flint/flint_alldocspostlist.cc

21 
	~<cÚfig.h
>

23 
	~<¡ršg
>

25 
	~"æšt_d©aba£.h
"

26 
	~"æšt_®ldoc¥o¡li¡.h
"

28 
	~"uts.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	gX­Ÿn
::
doccouÁ


33 
FlštAÎDocsPo¡Li¡
::
	$g‘_‹rmäeq
() const

35  
doccouÁ
;

36 
	}
}

38 
	gX­Ÿn
::
docid


39 
FlštAÎDocsPo¡Li¡
::
	$g‘_docid
() const

41  
cu¼’t_did
;

42 
	}
}

44 
	gX­Ÿn
::
‹rmcouÁ


45 
FlštAÎDocsPo¡Li¡
::
	$g‘_doş’gth
() const

47 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintAllDocsPostList::get_doclength", "");

48 
	`As£¹
(
cu¼’t_did
);

50 
cursÜ
->
	`»ad_g
();

52 ià(
cursÜ
->
cu¼’t_g
.
	`em±y
()è
	`RETURN
(0);

54 cÚ¡ * 
pos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

55 cÚ¡ * 
’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

57 
æšt_doş’_t
 
doş’
;

58 ià(!
	`F_uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

59 cÚ¡ *
msg
;

60 ià(
pos
 == 0) {

61 
msg
 = "Too†ittle data for doclen inermlist";

63 
msg
 = "Overflowed value for doclen inermlist";

65 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

68 
	`RETURN
(
doş’
);

69 
	}
}

71 
	gX­Ÿn
::
‹rmcouÁ


72 
FlštAÎDocsPo¡Li¡
::
	$g‘_wdf
() const

74 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintAllDocsPostList::get_wdf", "");

75 
	`As£¹
(
cu¼’t_did
);

76 
	`RETURN
(1);

77 
	}
}

79 
Po¡Li¡
 *

80 
	gFlštAÎDocsPo¡Li¡
::
	$»ad_did_äom_cu¼’t_key
()

82 
	`DEBUGCALL
(
DB
, 
Po¡Li¡
 *, "FlintAllDocsPostList::read_did_from_current_key",

84 cÚ¡ 
¡ršg
 & 
key
 = 
cursÜ
->
cu¼’t_key
;

85 cÚ¡ * 
pos
 = 
key
.
	`d©a
();

86 cÚ¡ * 
’d
 = 
pos
 + 
key
.
	`size
();

87 ià(!
	`F_uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
cu¼’t_did
)) {

88 cÚ¡ *
msg
;

89 ià(
pos
 == 0) {

90 
msg
 = "Too†ittle data inermlist key";

92 
msg
 = "Overflowed value inermlist key";

94 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

98 
	`RETURN
(
NULL
);

99 
	}
}

101 
Po¡Li¡
 *

102 
	gFlštAÎDocsPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 )

104 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *, "FlintAllDocsPostList::next", "/*w_min*/");

105 
As£¹
(!
©_’d
());

106 ià(!
	gcursÜ
->
Ãxt
()è
RETURN
(
NULL
);

107 
RETURN
(
»ad_did_äom_cu¼’t_key
());

110 
Po¡Li¡
 *

111 
	gFlštAÎDocsPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 )

113 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *, "FlintAllDocsPostList::skip_to",

114 
did
 << ", /*w_min*/");

116 ià(
	gdid
 <ğ
cu¼’t_did
 || 
©_’d
()è
RETURN
(
NULL
);

118 ià(
	gcursÜ
->
fšd_’Œy_ge
(
F_·ck_ušt_´e£rvšg_sÜt
(
did
))) {

120 
	gcu¼’t_did
 = 
did
;

121 
RETURN
(
NULL
);

123 ià(
	gcursÜ
->
aá”_’d
()è
RETURN
(
NULL
);

125 
RETURN
(
»ad_did_äom_cu¼’t_key
());

128 
boŞ


129 
	gFlštAÎDocsPo¡Li¡
::
	$©_’d
() const {

130 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintAllDocsPostList::at_end", "");

131 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

132 
	}
}

134 
¡ršg


135 
	gFlštAÎDocsPo¡Li¡
::
	$g‘_desütiÚ
() const

137 
¡ršg
 
desc
 = "FlintAllDocsPostList(did=";

138 
desc
 +ğ
	`om_to¡ršg
(
cu¼’t_did
);

139 
desc
 += ",doccount=";

140 
desc
 +ğ
	`om_to¡ršg
(
doccouÁ
);

141 
desc
 += ')';

142  
desc
;

143 
	}
}

	@backends/flint/flint_alldocspostlist.h

22 #iâdeà
XAPIAN_INCLUDED_FLINT_ALLDOCSPOSTLIST_H


23 
	#XAPIAN_INCLUDED_FLINT_ALLDOCSPOSTLIST_H


	)

25 
	~<¡ršg
>

27 
	~"Ëaåo¡li¡.h
"

29 şas 
	cFlštAÎDocsPo¡Li¡
 : 
public
 
L—fPo¡Li¡
 {

31 
İ”©Ü
=(cÚ¡ 
FlštAÎDocsPo¡Li¡
 &);

34 
FlštAÎDocsPo¡Li¡
(const FlintAllDocsPostList &);

37 
Po¡Li¡
 * 
»ad_did_äom_cu¼’t_key
();

40 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
db
;

43 
	mX­Ÿn
::
doccouÁ
 doccount;

46 
	mAutoPŒ
<
	mFlštCursÜ
> 
	mcursÜ
;

49 
	mX­Ÿn
::
docid
 
cu¼’t_did
;

51 
	mpublic
:

52 
FlštAÎDocsPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
db_
,

53 
X­Ÿn
::
doccouÁ
 
doccouÁ_
)

54 : 
L—fPo¡Li¡
(
¡d
::
¡ršg
()),

55 
db
(
db_
), 
doccouÁ
(
doccouÁ_
), 
cursÜ
(db->
‹rmli¡_bË
.
cursÜ_g‘
()),

56 
	$cu¼’t_did
(0)

58 
cursÜ
->
	`fšd_’Œy
(
¡d
::
	`¡ršg
());

61 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

63 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

65 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

67 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

69 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

71 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
);

73 
boŞ
 
	$©_’d
() const;

75 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

76 
	}
};

	@backends/flint/flint_alltermslist.cc

21 
	~<cÚfig.h
>

23 
	~"æšt_®É”m¦i¡.h
"

24 
	~"æšt_po¡li¡.h
"

25 
	~"æšt_uts.h
"

27 
	~"¡ršguts.h
"

30 
	gFlštAÎT”msLi¡
::
	$»ad_‹rmäeq_ªd_cŞläeq
() const

32 
	`DEBUGCALL
(
DB
, , "FlintAllTermsList::read_termfreq_and_collfreq", "");

33 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

34 
	`As£¹
(!
	`©_’d
());

38 
cursÜ
->
	`»ad_g
();

39 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

40 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

41 
FlštPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
, 
³nd
, &
‹rmäeq
, &
cŞläeq
);

42 
	}
}

44 
	gFlštAÎT”msLi¡
::~
	$FlštAÎT”msLi¡
()

46 
	`DEBUGCALL
(
DB
, , "~FlintAllTermsList", "");

47 
d–‘e
 
cursÜ
;

48 
	}
}

50 
¡ršg


51 
	gFlštAÎT”msLi¡
::
	$g‘_‹rmÇme
() const

53 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintAllTermsList::get_termname", "");

54 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

55 
	`As£¹
(!
	`©_’d
());

56 
	`RETURN
(
cu¼’t_‹rm
);

57 
	}
}

59 
	gX­Ÿn
::
doccouÁ


60 
FlštAÎT”msLi¡
::
	$g‘_‹rmäeq
() const

62 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "FlintAllTermsList::get_termfreq", "");

63 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

64 
	`As£¹
(!
	`©_’d
());

65 ià(
‹rmäeq
 =ğ0è
	`»ad_‹rmäeq_ªd_cŞläeq
();

66 
	`RETURN
(
‹rmäeq
);

67 
	}
}

69 
	gX­Ÿn
::
‹rmcouÁ


70 
FlštAÎT”msLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

72 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintAllTermsList::get_collection_freq", "");

73 
	`As£¹
(!
cu¼’t_‹rm
.
	`em±y
());

74 
	`As£¹
(!
	`©_’d
());

75 ià(
‹rmäeq
 =ğ0è
	`»ad_‹rmäeq_ªd_cŞläeq
();

76 
	`RETURN
(
cŞläeq
);

77 
	}
}

79 
T”mLi¡
 *

80 
	gFlštAÎT”msLi¡
::
	$Ãxt
()

82 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlintAllTermsList::next", "");

83 
	`As£¹
(!
	`©_’d
());

86 
‹rmäeq
 = 0;

88 
Œue
) {

89 
cursÜ
->
	`Ãxt
();

90 ià(
cursÜ
->
	`aá”_’d
()) {

91 
cu¼’t_‹rm
.
	`»size
(0);

92 
	`RETURN
(
NULL
);

95 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

96 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

97 ià(!
	`F_uÅack_¡ršg_´e£rvšg_sÜt
(&
p
, 
³nd
, 
cu¼’t_‹rm
)) {

98 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("PostListable key has unexpected format");

104 ià(
p
 =ğ
³nd
) ;

107 ià(!
	`¡¬tsw™h
(
cu¼’t_‹rm
, 
´efix
)) {

109 
cursÜ
->
	`to_’d
();

110 
cu¼’t_‹rm
.
	`»size
(0);

113 
	`RETURN
(
NULL
);

114 
	}
}

116 
T”mLi¡
 *

117 
	gFlštAÎT”msLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
‹rm
)

119 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlštAÎT”msLi¡::sk_to", 
‹rm
);

120 
	`As£¹
(!
	`©_’d
());

123 
‹rmäeq
 = 0;

125 ià(
cursÜ
->
	`fšd_’Œy_ge
(
	`F_·ck_¡ršg_´e£rvšg_sÜt
(
‹rm
))) {

128 
cu¼’t_‹rm
 = 
‹rm
;

130 ià(
cursÜ
->
	`aá”_’d
()) {

131 
cu¼’t_‹rm
.
	`»size
(0);

132 
	`RETURN
(
NULL
);

135 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

136 cÚ¡ *
³nd
 = 
p
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

137 ià(!
	`F_uÅack_¡ršg_´e£rvšg_sÜt
(&
p
, 
³nd
, 
cu¼’t_‹rm
)) {

138 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("PostListable key has unexpected format");

142 ià(!
	`¡¬tsw™h
(
cu¼’t_‹rm
, 
´efix
)) {

144 
cursÜ
->
	`to_’d
();

145 
cu¼’t_‹rm
.
	`»size
(0);

148 
	`RETURN
(
NULL
);

149 
	}
}

151 
boŞ


152 
	gFlštAÎT”msLi¡
::
	$©_’d
() const

154 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintAllTermsList::at_end", "");

155 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

156 
	}
}

	@backends/flint/flint_alltermslist.h

21 #iâdeà
XAPIAN_INCLUDED_FLINT_ALLTERMSLIST_H


22 
	#XAPIAN_INCLUDED_FLINT_ALLTERMSLIST_H


	)

24 
	~"®É”m¦i¡.h
"

25 
	~"æšt_d©aba£.h
"

26 
	~"æšt_po¡li¡.h
"

28 
şass
 
	gFlštCursÜ
;

30 şas 
	cFlštAÎT”msLi¡
 : 
public
 
AÎT”msLi¡
 {

32 
FlštAÎT”msLi¡
(const FlintAllTermsList &);

35 
	mİ”©Ü
=(cÚ¡ 
FlštAÎT”msLi¡
 &);

38 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
d©aba£
;

43 
FlštCursÜ
 * 
	mcursÜ
;

46 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

49 
	m¡d
::
¡ršg
 
´efix
;

57 
mubË
 
	mX­Ÿn
::
doccouÁ
 
‹rmäeq
;

60 
mubË
 
	mX­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

63 
	$»ad_‹rmäeq_ªd_cŞläeq
() const;

65 
public
:

66 
	`FlštAÎT”msLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
d©aba£_
,

67 cÚ¡ 
¡d
::
¡ršg
 & 
´efix_
)

68 : 
	`d©aba£
(
d©aba£_
), 
	`´efix
(
´efix_
), 
	$‹rmäeq
(0) {

69 
cursÜ
 = 
d©aba£
->
po¡li¡_bË
.
	`cursÜ_g‘
();

70 
	`As£¹
(
cursÜ
);

75 ià(
´efix
.
	`em±y
()) {

76 
cursÜ
->
	`fšd_’Œy_É
(
¡d
::
	`¡ršg
("\x00\xff", 2));

78 
cursÜ
->
	`fšd_’Œy_É
(
	`F_·ck_¡ršg_´e£rvšg_sÜt
(
´efix
));

83 ~
	`FlštAÎT”msLi¡
();

90 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

97 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

104 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

107 
T”mLi¡
 * 
	`Ãxt
();

110 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
);

113 
boŞ
 
	$©_’d
() const;

114 
	}
};

	@backends/flint/flint_btreebase.cc

22 
	~<cÚfig.h
>

24 
	~"§ã”ºo.h
"

25 #ifdeà
__WIN32__


26 
	~"msvc_posix_w¿µ”.h
"

29 
	~"æšt_bŒ“ba£.h
"

30 
	~"æšt_io.h
"

31 
	~"æšt_uts.h
"

32 
	~"uts.h
"

33 
	~<x­Ÿn/”rÜ.h
>

34 
	~"omas£¹.h
"

36 
	~<şim™s
>

38 
	~<®gÜ™hm
>

39 
	~<c¡ršg
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

72 
	#CURR_FORMAT
 5U

	)

74 
	gFlštTabË_ba£
::
	$FlštTabË_ba£
()

75 : 
	`»visiÚ
(0),

76 
	`block_size
(0),

77 
	`roÙ
(0),

78 
	`Ëv–
(0),

79 
	`b™_m­_size
(0),

80 
	`™em_couÁ
(0),

81 
	`Ï¡_block
(0),

82 
	`have_çk”oÙ
(
çl£
),

83 
	`£qu’tŸl
(
çl£
),

84 
	`b™_m­_low
(0),

85 
	`b™_m­0
(0),

86 
	$b™_m­
(0)

88 
	}
}

90 
	gFlštTabË_ba£
::
	$FlštTabË_ba£
(cÚ¡ 
FlštTabË_ba£
 &
Ùh”
)

91 : 
	`»visiÚ
(
Ùh”
.
»visiÚ
),

92 
	`block_size
(
Ùh”
.
block_size
),

93 
	`roÙ
(
Ùh”
.
roÙ
),

94 
	`Ëv–
(
Ùh”
.
Ëv–
),

95 
	`b™_m­_size
(
Ùh”
.
b™_m­_size
),

96 
	`™em_couÁ
(
Ùh”
.
™em_couÁ
),

97 
	`Ï¡_block
(
Ùh”
.
Ï¡_block
),

98 
	`have_çk”oÙ
(
Ùh”
.
have_çk”oÙ
),

99 
	`£qu’tŸl
(
Ùh”
.
£qu’tŸl
),

100 
	`b™_m­_low
(
Ùh”
.
b™_m­_low
),

101 
	`b™_m­0
(0),

102 
	$b™_m­
(0)

104 
Œy
 {

105 
b™_m­0
 = 
Ãw
 
by‹
[
b™_m­_size
];

106 
b™_m­
 = 
Ãw
 
by‹
[
b™_m­_size
];

108 
	`memıy
(
b™_m­0
, 
Ùh”
.b™_m­0, 
b™_m­_size
);

109 
	`memıy
(
b™_m­
, 
Ùh”
.b™_m­, 
b™_m­_size
);

110 } 
	`ÿtch
 (...) {

111 
d–‘e
 [] 
b™_m­0
;

112 
d–‘e
 [] 
b™_m­
;

114 
	}
}

117 
	gFlštTabË_ba£
::
	$sw­
(
FlštTabË_ba£
 &
Ùh”
)

119 
¡d
::
	`sw­
(
»visiÚ
, 
Ùh”
.revision);

120 
¡d
::
	`sw­
(
block_size
, 
Ùh”
.block_size);

121 
¡d
::
	`sw­
(
roÙ
, 
Ùh”
.root);

122 
¡d
::
	`sw­
(
Ëv–
, 
Ùh”
.level);

123 
¡d
::
	`sw­
(
b™_m­_size
, 
Ùh”
.bit_map_size);

124 
¡d
::
	`sw­
(
™em_couÁ
, 
Ùh”
.item_count);

125 
¡d
::
	`sw­
(
Ï¡_block
, 
Ùh”
.last_block);

126 
¡d
::
	`sw­
(
have_çk”oÙ
, 
Ùh”
.have_fakeroot);

127 
¡d
::
	`sw­
(
£qu’tŸl
, 
Ùh”
.sequential);

128 
¡d
::
	`sw­
(
b™_m­_low
, 
Ùh”
.bit_map_low);

129 
¡d
::
	`sw­
(
b™_m­0
, 
Ùh”
.bit_map0);

130 
¡d
::
	`sw­
(
b™_m­
, 
Ùh”
.bit_map);

131 
	}
}

133 
	gFlštTabË_ba£
::~
	$FlštTabË_ba£
()

135 
d–‘e
 [] 
b™_m­
;

136 
b™_m­
 = 0;

137 
d–‘e
 [] 
b™_m­0
;

138 
b™_m­0
 = 0;

139 
	}
}

141 
boŞ


142 
	gFlštTabË_ba£
::
	$do_uÅack_ušt
(cÚ¡ **
¡¬t
, cÚ¡ *
’d
,

143 
ušt4
 *
de¡
, 
¡ršg
 &
”r_msg
,

144 cÚ¡ 
¡ršg
 &
ba£Çme
,

145 cÚ¡ *
v¬Çme
)

147 
boŞ
 
»suÉ
 = 
	`F_uÅack_ušt
(
¡¬t
, 
’d
, 
de¡
);

148 ià(!
»suÉ
) {

149 
”r_msg
 +ğ"UÇbËØ»ad " + 
	`¡ršg
(
v¬Çme
) + " from " +

150 
ba£Çme
 + "\n";

152  
»suÉ
;

153 
	}
}

155 
	#DO_UNPACK_UINT_ERRCHECK
(
¡¬t
, 
’d
, 
v¬
) \

157 ià(!
	`do_uÅack_ušt
(
¡¬t
, 
’d
, &
v¬
, 
”r_msg
, 
ba£Çme
, #var)) { \

158  
çl£
; \

160 } 0)

	)

168 
	#REASONABLE_BASE_SIZE
 1024

	)

170 
boŞ


171 
	gFlštTabË_ba£
::
	$»ad
(cÚ¡ 
¡ršg
 & 
Çme
, 
ch
, sŒšg &
”r_msg
)

173 
¡ršg
 
ba£Çme
 = 
Çme
 + "ba£" + 
ch
;

174 #ifdeà
__WIN32__


175 
h
 = 
	`msvc_posix_İ’
(
ba£Çme
.
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

177 
h
 = 
	`İ’
(
ba£Çme
.
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

180 ià(
h
 == -1) {

181 
”r_msg
 +ğ"Couldn'ˆİ’ " + 
ba£Çme
 + ": " + 
	`¡»¼Ü
(
”ºo
) + "\n";

182  
çl£
;

184 
fdşo£r
 
	`şo£fd
(
h
);

186 
buf
[
REASONABLE_BASE_SIZE
];

188 cÚ¡ *
¡¬t
 = 
buf
;

189 cÚ¡ *
’d
 = 
buf
 + 
	`æšt_io_»ad
(
h
, buf, 
REASONABLE_BASE_SIZE
, 0);

191 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
»visiÚ
);

192 
ušt4
 
fÜm©
;

193 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
fÜm©
);

194 ià(
fÜm©
 !ğ
CURR_FORMAT
) {

195 
”r_msg
 +ğ"Bad ba£ ffÜm© " + 
	`om_to¡ršg
(
fÜm©
) + " in " +

196 
ba£Çme
 + "\n";

197  
çl£
;

199 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
block_size
);

200 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
roÙ
);

201 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
Ëv–
);

202 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
b™_m­_size
);

203 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
™em_couÁ
);

204 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
Ï¡_block
);

205 
ušt4
 
have_çk”oÙ_
;

206 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
have_çk”oÙ_
);

207 
have_çk”oÙ
 = 
have_çk”oÙ_
;

209 
ušt4
 
£qu’tŸl_
;

210 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
£qu’tŸl_
);

211 
£qu’tŸl
 = 
£qu’tŸl_
;

213 ià(
have_çk”oÙ
 && !
£qu’tŸl
) {

214 
£qu’tŸl
 = 
Œue
;

224 
ušt4
 
»visiÚ2
;

225 
	`DO_UNPACK_UINT_ERRCHECK
(&
¡¬t
, 
’d
, 
»visiÚ2
);

226 ià(
»visiÚ
 !ğ
»visiÚ2
) {

227 
”r_msg
 += "Revision‚umber mismatch in " +

228 
ba£Çme
 + ": " +

229 
	`om_to¡ršg
(
»visiÚ
è+ " v " + om_to¡ršg(
»visiÚ2
) + "\n";

230  
çl£
;

234 
d–‘e
 [] 
b™_m­0
;

235 
b™_m­0
 = 0;

236 
d–‘e
 [] 
b™_m­
;

237 
b™_m­
 = 0;

239 
b™_m­0
 = 
Ãw
 
by‹
[
b™_m­_size
];

240 
b™_m­
 = 
Ãw
 
by‹
[
b™_m­_size
];

242 
size_t
 
n
 = 
’d
 - 
¡¬t
;

243 ià(
n
 < 
b™_m­_size
) {

244 
	`memıy
(
b™_m­0
, 
¡¬t
, 
n
);

245 ()
	`æšt_io_»ad
(
h
, 
»š‹½»t_ÿ¡
<*>(
b™_m­0
è+ 
n
,

246 
b™_m­_size
 - 
n
, bit_map_size -‚);

247 
n
 = 0;

249 
	`memıy
(
b™_m­0
, 
¡¬t
, 
b™_m­_size
);

250 
n
 -ğ
b™_m­_size
;

251 ià(
n
è
	`memmove
(
buf
, 
¡¬t
 + 
b™_m­_size
,‚);

253 
	`memıy
(
b™_m­
, 
b™_m­0
, 
b™_m­_size
);

255 
¡¬t
 = 
buf
;

256 
’d
 = 
buf
 + 
n
;

257 
’d
 +ğ
	`æšt_io_»ad
(
h
, 
buf
 + 
n
, 
REASONABLE_BASE_SIZE
 -‚, 0);

259 
ušt4
 
»visiÚ3
;

260 ià(!
	`F_uÅack_ušt
(&
¡¬t
, 
’d
, &
»visiÚ3
)) {

261 
”r_msg
 += "Couldn't„ead„evision3 from base file " +

262 
ba£Çme
 + "\n";

263  
çl£
;

266 ià(
»visiÚ
 !ğ
»visiÚ3
) {

267 
”r_msg
 += "Revision‚umber mismatch in " +

268 
ba£Çme
 + ": " +

269 
	`om_to¡ršg
(
»visiÚ
è+ " v " + om_to¡ršg(
»visiÚ3
) + "\n";

270  
çl£
;

273 ià(
¡¬t
 !ğ
’d
) {

274 
”r_msg
 +ğ"Junk‡ˆ’d oàba£ f" + 
ba£Çme
 + "\n";

275  
çl£
;

278  
Œue
;

279 
	}
}

282 
	gFlštTabË_ba£
::
	$wr™e_to_fe
(cÚ¡ 
¡ršg
 &
f’ame
,

283 
ba£_Ë‰”
,

284 cÚ¡ 
¡ršg
 &
bËÇme
,

285 
chªges_fd
,

286 cÚ¡ 
¡ršg
 * 
chªges_
)

288 
	`ÿlcuÏ‹_Ï¡_block
();

290 
¡ršg
 
buf
;

291 
buf
 +ğ
	`F_·ck_ušt
(
»visiÚ
);

292 
buf
 +ğ
	`F_·ck_ušt
(
CURR_FORMAT
);

293 
buf
 +ğ
	`F_·ck_ušt
(
block_size
);

294 
buf
 +ğ
	`F_·ck_ušt
(
¡©ic_ÿ¡
<
ušt4
>(
roÙ
));

295 
buf
 +ğ
	`F_·ck_ušt
(
¡©ic_ÿ¡
<
ušt4
>(
Ëv–
));

296 
buf
 +ğ
	`F_·ck_ušt
(
¡©ic_ÿ¡
<
ušt4
>(
b™_m­_size
));

297 
buf
 +ğ
	`F_·ck_ušt
(
¡©ic_ÿ¡
<
ušt4
>(
™em_couÁ
));

298 
buf
 +ğ
	`F_·ck_ušt
(
¡©ic_ÿ¡
<
ušt4
>(
Ï¡_block
));

299 
buf
 +ğ
	`F_·ck_ušt
(
have_çk”oÙ
);

300 
buf
 +ğ
	`F_·ck_ušt
(
£qu’tŸl
);

301 
buf
 +ğ
	`F_·ck_ušt
(
»visiÚ
);

302 ià(
b™_m­_size
 > 0) {

303 
buf
.
	`­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
b™_m­
), 
b™_m­_size
);

305 
buf
 +ğ
	`F_·ck_ušt
(
»visiÚ
);

307 #ifdeà
__WIN32__


308 
h
 = 
	`msvc_posix_İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

310 
h
 = 
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

312 ià(
h
 < 0) {

313 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open base ")

314 + 
f’ame
 + "Øwr™e: " + 
	`¡»¼Ü
(
”ºo
);

315 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

317 
fdşo£r
 
	`şo£fd
(
h
);

319 ià(
chªges_fd
 >= 0) {

320 
¡ršg
 
chªges_buf
;

321 
chªges_buf
 +ğ
	`F_·ck_ušt
(1u);

322 
chªges_buf
 +ğ
	`F_·ck_¡ršg
(
bËÇme
);

323 
chªges_buf
 +ğ
ba£_Ë‰”
;

324 
chªges_buf
 +ğ
	`F_·ck_ušt
(
buf
.
	`size
());

325 
	`æšt_io_wr™e
(
chªges_fd
, 
chªges_buf
.
	`d©a
(), chªges_buf.
	`size
());

326 
	`æšt_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

327 ià(
chªges_
 !ğ
NULL
) {

328 
	`æšt_io_wr™e
(
chªges_fd
, 
chªges_
->
	`d©a
(), chªges_->
	`size
());

330 
	`æšt_io_sync
(
chªges_fd
);

334 
	`æšt_io_wr™e
(
h
, 
buf
.
	`d©a
(), buf.
	`size
());

335 
	`æšt_io_sync
(
h
);

336 
	}
}

343 
boŞ


344 
	gFlštTabË_ba£
::
	$block_ä“_©_¡¬t
(
ušt4
 
n
) const

346 
size_t
 
i
 = 
n
 / 
CHAR_BIT
;

347 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

348  (
b™_m­0
[
i
] & 
b™
) == 0;

349 
	}
}

357 
	gFlštTabË_ba£
::
	$ä“_block
(
ušt4
 
n
)

359 
ušt4
 
i
 = 
n
 / 
CHAR_BIT
;

360 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

361 
b™_m­
[
i
] &ğ~ 
b™
;

363 ià(
b™_m­_low
 > 
i
)

364 ià((
b™_m­0
[
i
] & 
b™
) == 0)

365 
b™_m­_low
 = 
i
;

366 
	}
}

374 
	#BIT_MAP_INC
 1000

	)

378 
	gFlštTabË_ba£
::
	$ex‹nd_b™_m­
()

380 
n
 = 
b™_m­_size
 + 
BIT_MAP_INC
;

381 
by‹
 *
Ãw_b™_m­0
 = 0;

382 
by‹
 *
Ãw_b™_m­
 = 0;

384 
Œy
 {

385 
Ãw_b™_m­0
 = 
Ãw
 
by‹
[
n
];

386 
Ãw_b™_m­
 = 
Ãw
 
by‹
[
n
];

388 
	`memıy
(
Ãw_b™_m­0
, 
b™_m­0
, 
b™_m­_size
);

389 
	`mem£t
(
Ãw_b™_m­0
 + 
b™_m­_size
, 0, 
n
 - bit_map_size);

391 
	`memıy
(
Ãw_b™_m­
, 
b™_m­
, 
b™_m­_size
);

392 
	`mem£t
(
Ãw_b™_m­
 + 
b™_m­_size
, 0, 
n
 - bit_map_size);

393 } 
	`ÿtch
 (...) {

394 
d–‘e
 [] 
Ãw_b™_m­0
;

395 
d–‘e
 [] 
Ãw_b™_m­
;

396 
throw
;

398 
d–‘e
 [] 
b™_m­0
;

399 
b™_m­0
 = 
Ãw_b™_m­0
;

400 
d–‘e
 [] 
b™_m­
;

401 
b™_m­
 = 
Ãw_b™_m­
;

402 
b™_m­_size
 = 
n
;

403 
	}
}

415 
ušt4


416 
	gFlštTabË_ba£
::
	$Ãxt_ä“_block
()

418 
ušt4
 
i
;

419 
x
;

420 
i
 = 
b™_m­_low
;; i++) {

421 ià(
i
 >ğ
b™_m­_size
) {

422 
	`ex‹nd_b™_m­
();

424 
x
 = 
b™_m­0
[
i
] | 
b™_m­
[i];

425 ià(
x
 !ğ
UCHAR_MAX
) ;

427 
ušt4
 
n
 = 
i
 * 
CHAR_BIT
;

428 
d
 = 0x1;

429 (
x
 & 
d
è!ğ0è{ d <<ğ1; 
n
++; }

430 
b™_m­
[
i
] |ğ
d
;

431 
b™_m­_low
 = 
i
;

432 ià(
n
 > 
Ï¡_block
) {

433 
Ï¡_block
 = 
n
;

435  
n
;

436 
	}
}

438 
boŞ


439 
	gFlštTabË_ba£
::
	$fšd_chªged_block
(
ušt4
 * 
n
)

443 (*
n
è<ğ
Ï¡_block
) {

444 
size_t
 
off£t
 = (*
n
è/ 
CHAR_BIT
;

445 
b™
 = 0x1 << (*
n
è% 
CHAR_BIT
;

447 ià(((
b™_m­0
[
off£t
] & 
b™
è=ğ0è&& ((
b™_m­
[offset] & bit) != 0)) {

448  
Œue
;

450 ++(*
n
);

453  
çl£
;

454 
	}
}

456 
boŞ


457 
	gFlštTabË_ba£
::
	$block_ä“_now
(
ušt4
 
n
)

459 
ušt4
 
i
 = 
n
 / 
CHAR_BIT
;

460 
b™
 = 0x1 << 
n
 % 
CHAR_BIT
;

461  (
b™_m­
[
i
] & 
b™
) == 0;

462 
	}
}

465 
	gFlštTabË_ba£
::
	$ÿlcuÏ‹_Ï¡_block
()

467 ià(
b™_m­_size
 == 0) {

468 
Ï¡_block
 = 0;

471 
i
 = 
b™_m­_size
 - 1;

472 
b™_m­
[
i
] == 0 && i > 0) {

473 
i
--;

475 
b™_m­_size
 = 
i
 + 1;

477 
x
 = 
b™_m­
[
i
];

480 ià(
x
 == 0) {

481 
Ï¡_block
 = 0;

484 
ušt4
 
n
 = (
i
 + 1è* 
CHAR_BIT
 - 1;

485 
d
 = 0x1 << (
CHAR_BIT
 - 1);

486 (
x
 & 
d
è=ğ0è{ d >>ğ1; 
n
--; }

488 
Ï¡_block
 = 
n
;

489 
	}
}

491 
boŞ


492 
	gFlštTabË_ba£
::
	$is_em±y
() const

494 
ušt4
 
i
 = 0; i < 
b™_m­_size
; i++) {

495 ià(
b™_m­
[
i
] != 0) {

496  
çl£
;

499  
Œue
;

500 
	}
}

503 
	gFlštTabË_ba£
::
	$ş—r_b™_m­
()

505 
	`mem£t
(
b™_m­
, 0, 
b™_m­_size
);

506 
	}
}

510 
	gFlštTabË_ba£
::
	$comm™
()

512 
	`memıy
(
b™_m­0
, 
b™_m­
, 
b™_m­_size
);

513 
b™_m­_low
 = 0;

514 
	}
}

	@backends/flint/flint_btreebase.h

22 #iâdeà
OM_HGUARD_FLINT_BTREEBASE_H


23 
	#OM_HGUARD_FLINT_BTREEBASE_H


	)

25 
	~<¡ršg
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~"æšt_ty³s.h
"

31 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mFlštTabË_ba£
 {

32 
	mpublic
:

34 
FlštTabË_ba£
();

37 
FlštTabË_ba£
(cÚ¡ FlštTabË_ba£ &
Ùh”
);

40 ~
FlštTabË_ba£
();

52 
boŞ
 
»ad
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, 
ch
, std::¡ršg &
”r_msg
);

54 
ušt4
 
	$g‘_»visiÚ
(ècÚ¡ {  
»visiÚ
; }

55 
ušt4
 
	$g‘_block_size
(ècÚ¡ {  
block_size
; 
	}
}

56 
ušt4
 
	$g‘_roÙ
(ècÚ¡ {  
roÙ
; 
	}
}

57 
ušt4
 
	$g‘_Ëv–
(ècÚ¡ {  
Ëv–
; 
	}
}

58 
ušt4
 
	$g‘_b™_m­_size
(ècÚ¡ {  
b™_m­_size
; 
	}
}

59 
ušt4
 
	$g‘_™em_couÁ
(ècÚ¡ {  
™em_couÁ
; 
	}
}

60 
ušt4
 
	$g‘_Ï¡_block
(ècÚ¡ {  
Ï¡_block
; 
	}
}

61 
boŞ
 
	$g‘_have_çk”oÙ
(ècÚ¡ {  
have_çk”oÙ
; 
	}
}

62 
boŞ
 
	$g‘_£qu’tŸl
(ècÚ¡ {  
£qu’tŸl
; 
	}
}

64 
	$£t_»visiÚ
(
ušt4
 
»visiÚ_
) {

65 
»visiÚ
 = 
»visiÚ_
;

66 
	}
}

67 
	$£t_block_size
(
ušt4
 
block_size_
) {

68 
block_size
 = 
block_size_
;

69 
	}
}

70 
	$£t_roÙ
(
ušt4
 
roÙ_
) {

71 
roÙ
 = 
roÙ_
;

72 
	}
}

73 
	$£t_Ëv–
(
ušt4
 
Ëv–_
) {

74 
Ëv–
 = 
Ëv–_
;

75 
	}
}

76 
	$£t_™em_couÁ
(
ušt4
 
™em_couÁ_
) {

77 
™em_couÁ
 = 
™em_couÁ_
;

78 
	}
}

79 
	$£t_have_çk”oÙ
(
boŞ
 
have_çk”oÙ_
) {

80 
have_çk”oÙ
 = 
have_çk”oÙ_
;

81 
	}
}

82 
	$£t_£qu’tŸl
(
boŞ
 
£qu’tŸl_
) {

83 
£qu’tŸl
 = 
£qu’tŸl_
;

84 
	}
}

87 
wr™e_to_fe
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame
,

88 
ba£_Ë‰”
,

89 cÚ¡ 
¡d
::
¡ršg
 &
bËÇme
,

90 
chªges_fd
,

91 cÚ¡ 
¡d
::
¡ršg
 * 
chªges_
);

97 
boŞ
 
	$block_ä“_©_¡¬t
(
ušt4
 
n
) const;

99 
	`ä“_block
(
ušt4
 
n
);

101 
ušt4
 
	`Ãxt_ä“_block
();

107 
boŞ
 
	`fšd_chªged_block
(
ušt4
 * 
n
);

109 
boŞ
 
	`block_ä“_now
(
ušt4
 
n
);

111 
	`ÿlcuÏ‹_Ï¡_block
();

114 
	`ş—r_b™_m­
();

116 
	`comm™
();

119 
boŞ
 
	$is_em±y
() const;

121 
	`sw­
(
FlštTabË_ba£
 &
Ùh”
);

123 
´iv©e
:

125 
İ”©Ü
=(cÚ¡ 
FlštTabË_ba£
 &
Ùh”
);

127 
	`ex‹nd_b™_m­
();

130 
boŞ
 
	`do_uÅack_ušt
(cÚ¡ **
¡¬t
, cÚ¡ *
’d
,

131 
ušt4
 *
de¡
, 
¡d
::
¡ršg
 &
”r_msg
,

132 cÚ¡ 
¡d
::
¡ršg
 &
ba£Çme
,

133 cÚ¡ *
v¬Çme
);

136 
ušt4
 
»visiÚ
;

137 
ušt4
 
block_size
;

138 
ušt4
 
roÙ
;

139 
ušt4
 
Ëv–
;

140 
ušt4
 
b™_m­_size
;

141 
ušt4
 
™em_couÁ
;

142 
ušt4
 
Ï¡_block
;

143 
boŞ
 
have_çk”oÙ
;

144 
boŞ
 
£qu’tŸl
;

149 
ušt4
 
b™_m­_low
;

153 
by‹
 *
b™_m­0
;

156 
by‹
 *
b™_m­
;

157 
	}
};

	@backends/flint/flint_check.cc

24 
	~<cÚfig.h
>

26 
	~"æšt_check.h
"

28 
	~<şim™s
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	#REVISION
(
b
è
¡©ic_ÿ¡
<>(
	`g‘št4
(b, 0))

	)

33 
	#GET_LEVEL
(
b
è
	`g‘št1
(b, 4)

	)

34 
	#MAX_FREE
(
b
è
	`g‘št2
(b, 5)

	)

35 
	#TOTAL_FREE
(
b
è
	`g‘št2
(b, 7)

	)

36 
	#DIR_END
(
b
è
	`g‘št2
(b, 9)

	)

37 
	#DIR_START
 11

	)

39 
	gBŒ“Check
::
	$´št_¥aûs
(
n
) const

41 
n
--è
out
.
	`put
(' ');

42 
	}
}

44 
	gBŒ“Check
::
	$´št_by‹s
(
n
, cÚ¡ 
by‹
 * 
p
) const

46 
out
.
	`wr™e
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
), 
n
);

47 
	}
}

49 
	gBŒ“Check
::
	$´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const

51 
I‹m_
 
	`™em
(
p
, 
c
);

52 
¡ršg
 
key
;

53 ià(
™em
.
	`key
().
	`Ëngth
() >= 0)

54 
™em
.
	`key
().
	`»ad
(&
key
);

55 ià(
j
 == 0) {

56 
out
 << 
key
 << '/' << 
™em
.
	`compÚ’t_of
();

58 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
key
.
	`begš
(); i !ğkey.
	`’d
(); ++i) {

60 
ch
 = *
i
;

61 ià(
ch
 < 32è
out
 << '/' << (ch); out << ch;

64 
	}
}

66 
	gBŒ“Check
::
	$´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const

68 
I‹m_
 
	`™em
(
p
, 
c
);

69 
¡ršg
 
g
;

70 
™em
.
	`­³nd_chunk
(&
g
);

71 ià(
j
 == 0) {

72 
out
 << "/" << 
™em
.
	`compÚ’ts_of
(è<< 
g
;

74 
out
 << "--> [" << 
	`g‘št4
(
»š‹½»t_ÿ¡
<cÚ¡ 
by‹
*>(
g
.
	`d©a
()), 0)

77 
	}
}

79 
	gBŒ“Check
::
	$»pÜt_block_fuÎ
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const

81 
j
 = 
	`GET_LEVEL
(
p
);

82 
dœ_’d
 = 
	`DIR_END
(
p
);

83 
out
 << '\n';

84 
	`´št_¥aûs
(
m
);

85 
out
 << "Block [" << 
n
 << "]†ev– " << 
j
 << ",„evisiÚ *" << 
	`REVISION
(
p
)

86 << " i‹m (" << (
dœ_’d
 - 
DIR_START
)/
D2
 << ") usage "

87 << 
	`block_u§ge
(
p
) << "%:\n";

88 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

89 
	`´št_¥aûs
(
m
);

90 
	`´št_key
(
p
, 
c
, 
j
);

91 
out
 << ' ';

92 
	`´št_g
(
p
, 
c
, 
j
);

93 
out
 << '\n';

95 
	}
}

97 
	gBŒ“Check
::
	$block_u§ge
(cÚ¡ 
by‹
 * 
p
) const

99 
¥aû
 = 
block_size
 - 
	`DIR_END
(
p
);

100 
ä“
 = 
	`TOTAL_FREE
(
p
);

101  (
¥aû
 - 
ä“
) * 100 / space;

102 
	}
}

107 
	gBŒ“Check
::
	$»pÜt_block
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const

109 
j
 = 
	`GET_LEVEL
(
p
);

110 
dœ_’d
 = 
	`DIR_END
(
p
);

111 
c
;

112 
	`´št_¥aûs
(
m
);

113 
out
 << "[" << 
n
 << "] *" << 
	`REVISION
(
p
) << " ("

114 << (
dœ_’d
 - 
DIR_START
)/
D2
 << "è" << 
	`block_u§ge
(
p
) << "% ";

116 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

117 ià(
c
 =ğ
DIR_START
 + 6è
out
 << "... ";

118 ià(
c
 >ğ
DIR_START
 + 6 && c < 
dœ_’d
 - 6) ;

120 
	`´št_key
(
p
, 
c
, 
j
);

121 
out
 << ' ';

123 
out
 << 
’dl
;

124 
	}
}

126 
	gBŒ“Check
::
	$çu»
(
n
) const

128 
out
 << "B-Œ“ƒ¼Ü " << 
n
 << 
’dl
;

129 
throw
 "btreeƒrror";

130 
	}
}

133 
	gBŒ“Check
::
	$block_check
(
CursÜ_
 * 
C_
, 
j
, 
İts
)

135 
by‹
 * 
p
 = 
C_
[
j
].p;

136 
ušt4
 
n
 = 
C_
[
j
].n;

137 
size_t
 
c
;

138 
size_t
 
signifiÿÁ_c
 = 
j
 =ğ0 ? 
DIR_START
 : DIR_START + 
D2
;

141 
size_t
 
max_ä“
 = 
	`MAX_FREE
(
p
);

142 
size_t
 
dœ_’d
 = 
	`DIR_END
(
p
);

143 
tÙ®_ä“
 = 
block_size
 - 
dœ_’d
;

145 ià(
ba£
.
	`block_ä“_©_¡¬t
(
n
)è
	`çu»
(0);

146 ià(
ba£
.
	`block_ä“_now
(
n
)è
	`çu»
(1);

147 
ba£
.
	`ä“_block
(
n
);

149 ià(
j
 !ğ
	`GET_LEVEL
(
p
)è
	`çu»
(10);

150 ià(
dœ_’d
 <ğ
DIR_START
 || dœ_’d > 
block_size
è
	`çu»
(20);

152 ià(
İts
 & 
OPT_SHORT_TREE
è
	`»pÜt_block
(3*(
Ëv–
 - 
j
), 
n
, 
p
);

154 ià(
İts
 & 
OPT_FULL_TREE
è
	`»pÜt_block_fuÎ
(3*(
Ëv–
 - 
j
), 
n
, 
p
);

156 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

157 
I‹m_
 
	`™em
(
p
, 
c
);

158 
o
 = 
™em
.
	`g‘_add»ss
(è- 
p
;

159 ià(
o
 > (
block_size
)è
	`çu»
(21);

160 ià(
o
 - 
dœ_’d
 < 
max_ä“
è
	`çu»
(30);

162 
kt_Ën
 = 
™em
.
	`size
();

163 ià(
o
 + 
kt_Ën
 > (
block_size
)è
	`çu»
(40);

164 
tÙ®_ä“
 -ğ
kt_Ën
;

166 ià(
c
 > 
signifiÿÁ_c
 && 
	`I‹m_
(
p
, c - 
D2
).
	`key
(è>ğ
™em
.key())

167 
	`çu»
(50);

169 ià(
tÙ®_ä“
 !ğ
	`TOTAL_FREE
(
p
))

170 
	`çu»
(60);

172 ià(
j
 == 0) ;

173 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

174 
C_
[
j
].
c
 = c;

175 
	`block_to_cursÜ
(
C_
, 
j
 - 1, 
	`I‹m_
(
p
, 
c
).
	`block_giv’_by
());

177 
	`block_check
(
C_
, 
j
 - 1, 
İts
);

179 
by‹
 * 
q
 = 
C_
[
j
 - 1].
p
;

183 ià(
j
 =ğ1 && 
c
 > 
DIR_START
)

184 ià(
	`I‹m_
(
q
, 
DIR_START
).
	`key
(è< I‹m_(
p
, 
c
).key())

185 
	`çu»
(70);

190 ià(
j
 > 1 && 
c
 > 
DIR_START
 && 
	`DIR_END
(
q
è> DIR_START + 
D2
 &&

191 
	`I‹m_
(
q
, 
DIR_START
 + 
D2
).
	`key
(è< I‹m_(
p
, 
c
).key())

192 
	`çu»
(80);

197 ià(
c
 + 
D2
 < 
dœ_’d
 &&

198 (
j
 =ğ1 || 
DIR_START
 + 
D2
 < 
	`DIR_END
(
q
)) &&

199 
	`I‹m_
(
q
, 
	`DIR_END
(qè- 
D2
).
	`key
(è>ğI‹m_(
p
, 
c
 + D2).key())

200 
	`çu»
(90);

202 ià(
	`REVISION
(
q
è> REVISION(
p
)è
	`çu»
(91);

204 
	}
}

207 
	gBŒ“Check
::
	$check
(cÚ¡ * 
bËÇme
, cÚ¡ 
¡ršg
 & 
·th
, 
İts
,

208 
o¡»am
 &
out
)

210 
BŒ“Check
 
	`B
(
bËÇme
, 
·th
, 
çl£
, 
out
);

211 
B
.
	`İ’
();

212 
CursÜ_
 * 
C
 = 
B
.C;

214 ià(
İts
 & 
OPT_SHOW_STATS
) {

215 
out
 << "ba£" << ()
B
.
ba£_Ë‰”


216 << " blocksize=" << 
B
.
block_size
 / 1024 << "K"

217 " i‹ms=" << 
B
.
™em_couÁ


218 << "†a¡block=" << 
B
.
ba£
.
	`g‘_Ï¡_block
()

219 << "„evisiÚ=" << 
B
.
»visiÚ_numb”


220 << "†ev–s=" << 
B
.
Ëv–


222 ià(
B
.
çked_roÙ_block
)

223 
out
 << "(faked)";

225 
out
 << 
C
[
B
.
Ëv–
].
n
;

226 
out
 << 
’dl
;

229 
lim™
 = 
B
.
ba£
.
	`g‘_b™_m­_size
() - 1;

231 
lim™
 =†im™ * 
CHAR_BIT
 + CHAR_BIT - 1;

233 ià(
İts
 & 
OPT_SHOW_BITMAP
) {

234 
j
 = 0; j <ğ
lim™
; j++) {

235 
out
 << (
B
.
ba£
.
	`block_ä“_©_¡¬t
(
j
) ? '.' : '*');

236 ià(
j
 > 0) {

237 ià((
j
 + 1) % 100 == 0) {

238 
out
 << '\n';

239 } ià((
j
 + 1) % 10 == 0) {

240 
out
 << ' ';

244 
out
 << '\n' << 
’dl
;

247 ià(
B
.
çked_roÙ_block
) {

248 ià(
İts
è
out
 << "void ";

250 
B
.
	`block_check
(
C
, B.
Ëv–
, 
İts
);

254 ià(!
B
.
ba£
.
	`is_em±y
()) {

255 
B
.
	`çu»
(100);

258 ià(
İts
è
out
 << "B-Œ“ checked okay" << 
’dl
;

259 
	}
}

261 
	gBŒ“Check
::
	$»pÜt_cursÜ
(
N
, cÚ¡ 
CursÜ_
 * 
C_
) const

263 
out
 << 
N
 << ")\n";

264 
i
 = 0; i <ğ
Ëv–
; i++)

265 
out
 << "p=" << 
C_
[
i
].
p
 << ", c=" << C_[i].
c
 << ",‚=[" << C_[i].
n


266 << "],„ewr™e=" << 
C_
[
i
].
»wr™e
 << 
’dl
;

267 
	}
}

	@backends/flint/flint_check.h

24 #iâdeà
OM_HGUARD_FLINT_CHECK_H


25 
	#OM_HGUARD_FLINT_CHECK_H


	)

27 
	~"æšt_bË.h
"

28 
	~"nÜ‘uº.h
"

30 
	~<io¡»am
>

31 
	~<¡ršg
>

33 şas 
	cBŒ“Check
 : 
public
 
FlštTabË
 {

34 
public
:

35 
check
(cÚ¡ * 
bËÇme
, cÚ¡ 
¡d
::
¡ršg
 & 
·th
,

36 
İts
, 
¡d
::
o¡»am
 &
out
 = std::
cout
);

37 
	m´iv©e
:

38 
BŒ“Check
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡d
::
¡ršg
 &
·th_
,

39 
boŞ
 
»adÚly
, 
¡d
::
o¡»am
 &
out_
)

40 : 
FlštTabË
(
bËÇme_
, 
·th_
, 
»adÚly
), 
	$out
(
out_
) { }

42 
	`block_check
(
CursÜ_
 * 
C_
, 
j
, 
İts
);

43 
	$block_u§ge
(cÚ¡ 
by‹
 * 
p
) const;

44 
	$»pÜt_block
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const;

45 
	$»pÜt_block_fuÎ
(
m
, 
n
, cÚ¡ 
by‹
 * 
p
) const;

46 
	$»pÜt_cursÜ
(
N
, cÚ¡ 
CursÜ_
 *
C_
) const;

48 
	`XAPIAN_NORETURN
(
	$çu»
(
n
) const);

49 
	$´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const;

50 
	$´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
) const;

51 
	$´št_¥aûs
(
n
) const;

52 
	$´št_by‹s
(
n
, cÚ¡ 
by‹
 * 
p
) const;

54 
mubË
 
¡d
::
o¡»am
 &
out
;

55 
	}
};

57 
	#OPT_SHORT_TREE
 1

	)

58 
	#OPT_FULL_TREE
 2

	)

59 
	#OPT_SHOW_BITMAP
 4

	)

60 
	#OPT_SHOW_STATS
 8

	)

	@backends/flint/flint_cursor.cc

22 
	~<cÚfig.h
>

24 
	~"æšt_cursÜ.h
"

26 
	~"§ã”ºo.h
"

28 
	~<x­Ÿn/”rÜ.h
>

30 
	~"æšt_bË.h
"

31 
	~"omas£¹.h
"

32 
	~"omdebug.h
"

34 #ifdeà
XAPIAN_DEBUG_LOG


35 
¡ršg


36 
	$hex_di¥Ïy_’code
(cÚ¡ 
¡ršg
 & 
šput
)

38 cÚ¡ * 
bË
 = "0123456789abcdef";

39 
¡ršg
 
»suÉ
;

40 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
šput
.
	`begš
(); i !ğšput.
	`’d
(); ++i) {

41 
v®
 = *
i
;

42 
»suÉ
 += "\\x";

43 
»suÉ
 +ğ
bË
[
v®
/16];

44 
»suÉ
 +ğ
bË
[
v®
%16];

47  
»suÉ
;

48 
	}
}

51 
	#DIR_START
 11

	)

53 
	gFlštCursÜ
::
	$FlštCursÜ
(
FlštTabË
 *
B_
)

54 : 
	`is_pos™iÚed
(
çl£
),

55 
	`is_aá”_’d
(
çl£
),

56 
	`g_¡©us
(
UNREAD
),

57 
	`B
(
B_
),

58 
	`Ëv–
(
B_
->
Ëv–
)

60 
C
 = 
Ãw
 
CursÜ_
[
Ëv–
 + 1];

62 
j
 = 0; j < 
Ëv–
; j++) {

63 
C
[
j
].
n
 = 
BLK_UNUSED
;

64 
C
[
j
].
p
 = 
Ãw
 
by‹
[
B
->
block_size
];

66 
C
[
Ëv–
].
n
 = 
B
->C[level].n;

67 
C
[
Ëv–
].
p
 = 
B
->C[level].p;

68 
	}
}

70 
	gFlštCursÜ
::~
	$FlštCursÜ
()

74 
j
 = 0; j < 
Ëv–
; j++) {

75 
d–‘e
 [] 
C
[
j
].
p
;

77 
d–‘e
 [] 
C
;

78 
	}
}

80 
boŞ


81 
	gFlštCursÜ
::
	$´ev
()

83 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintCursor::prev", "");

84 
	`As£¹
(
B
->
Ëv–
 <=†evel);

85 
	`As£¹
(!
is_aá”_’d
);

87 ià(!
is_pos™iÚed
) {

91 ()
	`fšd_’Œy
(
cu¼’t_key
);

92 
g_¡©us
 = 
UNREAD
;

95 ià(
g_¡©us
 !ğ
UNREAD
) {

96 
Œue
) {

97 ià(! 
B
->
	`´ev
(
C
, 0)) {

98 
is_pos™iÚed
 = 
çl£
;

99 
	`RETURN
(
çl£
);

101 ià(
	`I‹m_
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

107 
Œue
) {

108 ià(! 
B
->
	`´ev
(
C
, 0)) {

109 
is_pos™iÚed
 = 
çl£
;

110 
	`RETURN
(
çl£
);

112 ià(
	`I‹m_
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

116 
	`g‘_key
(&
cu¼’t_key
);

117 
g_¡©us
 = 
UNREAD
;

119 
	`LOGLINE
(
DB
, "MovedØ’Œy: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

120 
	`RETURN
(
Œue
);

121 
	}
}

123 
boŞ


124 
	gFlštCursÜ
::
	$Ãxt
()

126 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintCursor::next", "");

127 
	`As£¹
(
B
->
Ëv–
 <=†evel);

128 
	`As£¹
(!
is_aá”_’d
);

129 ià(
g_¡©us
 =ğ
UNREAD
) {

130 
Œue
) {

131 ià(! 
B
->
	`Ãxt
(
C
, 0)) {

132 
is_pos™iÚed
 = 
çl£
;

135 ià(
	`I‹m_
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1) {

136 
is_pos™iÚed
 = 
Œue
;

142 ià(!
is_pos™iÚed
) {

143 
is_aá”_’d
 = 
Œue
;

144 
	`RETURN
(
çl£
);

147 
	`g‘_key
(&
cu¼’t_key
);

148 
g_¡©us
 = 
UNREAD
;

150 
	`LOGLINE
(
DB
, "MovedØ’Œy: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

151 
	`RETURN
(
Œue
);

152 
	}
}

154 
boŞ


155 
	gFlštCursÜ
::
	$fšd_’Œy
(cÚ¡ 
¡ršg
 &
key
)

157 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštCursÜ::fšd_’Œy", 
key
);

158 
	`As£¹
(
B
->
Ëv–
 <=†evel);

160 
is_aá”_’d
 = 
çl£
;

162 
boŞ
 
found
;

164 
is_pos™iÚed
 = 
Œue
;

165 ià(
key
.
	`size
(è> 
FLINT_BTREE_MAX_KEY_LEN
) {

168 
B
->
	`fÜm_key
(
key
.
	`sub¡r
(0, 
FLINT_BTREE_MAX_KEY_LEN
));

169 ()(
B
->
	`fšd
(
C
));

170 
found
 = 
çl£
;

172 
B
->
	`fÜm_key
(
key
);

173 
found
 = 
B
->
	`fšd
(
C
);

176 ià(!
found
) {

177 ià(
C
[0].
c
 < 
DIR_START
) {

178 
C
[0].
c
 = 
DIR_START
;

179 ià(! 
B
->
	`´ev
(
C
, 0)è
dÚe
;

181 
	`I‹m_
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() != 1) {

182 ià(! 
B
->
	`´ev
(
C
, 0)) {

183 
is_pos™iÚed
 = 
çl£
;

184 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("find_entry failedo find‡nyƒntry‡t‡ll!");

188 
dÚe
:

190 ià(
found
)

191 
cu¼’t_key
 = 
key
;

193 
	`g‘_key
(&
cu¼’t_key
);

194 
g_¡©us
 = 
UNREAD
;

196 
	`LOGLINE
(
DB
, "FoundƒÁry: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

197 
	`RETURN
(
found
);

198 
	}
}

200 
boŞ


201 
	gFlštCursÜ
::
	$fšd_’Œy_ge
(cÚ¡ 
¡ršg
 &
key
)

203 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštCursÜ::fšd_’Œy_ge", 
key
);

204 
	`As£¹
(
B
->
Ëv–
 <=†evel);

206 
is_aá”_’d
 = 
çl£
;

208 
boŞ
 
found
;

210 
is_pos™iÚed
 = 
Œue
;

211 ià(
key
.
	`size
(è> 
FLINT_BTREE_MAX_KEY_LEN
) {

214 
B
->
	`fÜm_key
(
key
.
	`sub¡r
(0, 
FLINT_BTREE_MAX_KEY_LEN
));

215 ()(
B
->
	`fšd
(
C
));

216 
found
 = 
çl£
;

218 
B
->
	`fÜm_key
(
key
);

219 
found
 = 
B
->
	`fšd
(
C
);

222 ià(
found
) {

223 
cu¼’t_key
 = 
key
;

225 ià(! 
B
->
	`Ãxt
(
C
, 0)) {

226 
is_aá”_’d
 = 
Œue
;

227 
is_pos™iÚed
 = 
çl£
;

228 
	`RETURN
(
çl£
);

230 
	`As£¹
(
	`I‹m_
(
C
[0].
p
, C[0].
c
).
	`compÚ’t_of
() == 1);

231 
	`g‘_key
(&
cu¼’t_key
);

233 
g_¡©us
 = 
UNREAD
;

235 
	`LOGLINE
(
DB
, "FoundƒÁry: key=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_key
));

236 
	`RETURN
(
found
);

237 
	}
}

240 
	gFlštCursÜ
::
	$g‘_key
(
¡ršg
 * 
key
) const

242 
	`As£¹
(
B
->
Ëv–
 <=†evel);

243 
	`As£¹
(
is_pos™iÚed
);

245 ()
	`I‹m_
(
C
[0].
p
, C[0].
c
).
	`key
().
	`»ad
(
key
);

246 
	}
}

248 
boŞ


249 
	gFlštCursÜ
::
	$»ad_g
(
boŞ
 
k“p_com´es£d
)

251 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštCursÜ::»ad_g", 
k“p_com´es£d
);

252 ià(
g_¡©us
 =ğ
UNREAD
) {

253 
	`As£¹
(
B
->
Ëv–
 <=†evel);

254 
	`As£¹
(
is_pos™iÚed
);

256 ià(
B
->
	`»ad_g
(
C
, &
cu¼’t_g
, 
k“p_com´es£d
)) {

257 
g_¡©us
 = 
COMPRESSED
;

259 
g_¡©us
 = 
UNCOMPRESSED
;

264 
is_pos™iÚed
 = 
B
->
	`Ãxt
(
C
, 0);

266 
	`LOGLINE
(
DB
, "g=" << 
	`hex_di¥Ïy_’code
(
cu¼’t_g
));

268 
	`RETURN
(
g_¡©us
 =ğ
COMPRESSED
);

269 
	}
}

271 
boŞ


272 
	gFlštCursÜ
::
	$d–
()

274 
	`As£¹
(!
is_aá”_’d
);

276 
B
->
	`d–
(
cu¼’t_key
);

283 ià(!
	`fšd_’Œy_ge
(
cu¼’t_key
)è 
is_pos™iÚed
;

284  
	`Ãxt
();

285 
	}
}

	@backends/flint/flint_cursor.h

22 #iâdeà
OM_HGUARD_FLINT_CURSOR_H


23 
	#OM_HGUARD_FLINT_CURSOR_H


	)

25 
	~<x­Ÿn/visib™y.h
>

27 
	~"æšt_ty³s.h
"

29 
	~<¡ršg
>

30 
usšg
 
	g¡d
::
¡ršg
;

32 
	#BLK_UNUSED
 
	`ušt4
(-1)

	)

34 şas 
	cCursÜ_
 {

35 
	m´iv©e
:

37 
CursÜ_
(const Cursor_ &);

38 
	mCursÜ_
 & 
	mİ”©Ü
=(cÚ¡ 
CursÜ_
 &);

40 
	mpublic
:

42 
	$CursÜ_
(è: 
	`p
(0), 
	`c
(-1), 
	`n
(
BLK_UNUSED
), 
	$»wr™e
(
çl£
)

46 
by‹
 * 
p
;

48 
c
;

57 
ušt4
 
n
;

59 
boŞ
 
»wr™e
;

60 
	}
};

62 
şass
 
	gFlštTabË
;

67 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mFlštCursÜ
 {

68 
	m´iv©e
:

70 
FlštCursÜ
(const FlintCursor &);

73 
	mFlštCursÜ
 & 
	mİ”©Ü
=(cÚ¡ 
FlštCursÜ
 &);

80 
boŞ
 
	mis_pos™iÚed
;

84 
boŞ
 
	mis_aá”_’d
;

87 ’um { 
	mUNREAD
, 
	mUNCOMPRESSED
, 
	mCOMPRESSED
 } 
	gg_¡©us
;

90 
FlštTabË
 * 
	gB
;

93 
CursÜ_
 * 
	gC
;

96 
	gËv–
;

117 
	$g‘_key
(
¡ršg
 * 
key
) const;

119 
public
:

131 
	`FlštCursÜ
(
FlštTabË
 *
B
);

134 ~
	`FlštCursÜ
();

138 
¡ršg
 
cu¼’t_key
;

143 
¡ršg
 
cu¼’t_g
;

157 
boŞ
 
	`»ad_g
(boŞ 
k“p_com´es£d
 = 
çl£
);

173 
boŞ
 
	`Ãxt
();

180 
boŞ
 
	`´ev
();

204 
boŞ
 
	`fšd_’Œy
(cÚ¡ 
¡ršg
 &
key
);

207 
	$fšd_’Œy_É
(cÚ¡ 
¡ršg
 &
key
) {

208 ià(
	`fšd_’Œy
(
key
)è
	`´ev
();

209 
	}
}

216 
boŞ
 
fšd_’Œy_ge
(cÚ¡ 
¡ršg
 &
key
);

220 
	$to_’d
(è{ 
is_aá”_’d
 = 
Œue
; 
	}
}

227 
boŞ
 
	$aá”_’d
(ècÚ¡ {  
is_aá”_’d
; 
	}
}

234 
boŞ
 
d–
();

237 
FlštTabË
 * 
	$g‘_bË
(ècÚ¡ {  
B
; 
	}
}

	@backends/flint/flint_database.cc

27 
	~<cÚfig.h
>

29 
	~"æšt_d©aba£.h
"

31 
	~<x­Ÿn/”rÜ.h
>

32 
	~<x­Ÿn/v®ue™”©Ü.h
>

34 
	~"cÚtiguou§Îdoc¥o¡li¡.h
"

35 
	~"æšt_®ldoc¥o¡li¡.h
"

36 
	~"æšt_®É”m¦i¡.h
"

37 
	~"æšt_docum’t.h
"

38 
	~"æšt_io.h
"

39 
	~"../æšt_lock.h
"

40 
	~"æšt_m‘ad©a.h
"

41 
	~"æšt_modif›dpo¡li¡.h
"

42 
	~"æšt_pos™iÚli¡.h
"

43 
	~"æšt_po¡li¡.h
"

44 
	~"æšt_»cÜd.h
"

45 
	~"æšt_»¶iÿ‹_š‹º®.h
"

46 
	~"æšt_¥–lšgwÜd¦i¡.h
"

47 
	~"æšt_‹rmli¡.h
"

48 
	~"æšt_uts.h
"

49 
	~"æšt_v®ues.h
"

50 
	~"omdebug.h
"

51 
	~"omtime.h
"

52 
	~"»mÙecÚÃùiÚ.h
"

53 
	~"»¶iÿtiÚ.h
"

54 
	~"»¶iÿtiÚ´ÙocŞ.h
"

55 
	~"£rŸli£.h
"

56 
	~"¡ršguts.h
"

57 
	~"uts.h
"

59 #ifdeà
__WIN32__


60 
	~"msvc_posix_w¿µ”.h
"

63 
	~"§ã”ºo.h
"

64 
	~"§ãsys¡©.h
"

65 
	~<sys/ty³s.h
>

67 
	~"autİŒ.h
"

68 
	~<c¡dio
>

69 
	~<li¡
>

70 
	~<¡ršg
>

72 
usšg
 
Çme¥aû
 
	g¡d
;

73 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

81 
	#MAX_SAFE_TERM_LENGTH
 245

	)

85 cÚ¡ 
¡ršg
 
METAINFO_KEY
(1, '\0');

91 
	$sys_uÆšk_if_exi¡s
(cÚ¡ 
¡ršg
 & 
f’ame
)

93 #ifdeà
__WIN32__


94 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

96 ià(
	`uÆšk
(
f’ame
) == -1) {

98 ià(
”ºo
 =ğ
ENOENT
) ;

99 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Cª'ˆd–‘fe: `" + 
f’ame
 + "'",

100 
”ºo
);

102 
	}
}

108 
	gFlštD©aba£
::
	$FlštD©aba£
(cÚ¡ 
¡ršg
 &
æšt_dœ
, 
aùiÚ
,

109 
block_size
)

110 : 
	`db_dœ
(
æšt_dœ
),

111 
	`»adÚly
(
aùiÚ
 =ğ
XAPIAN_DB_READONLY
),

112 
	`v”siÚ_fe
(
db_dœ
),

113 
	`po¡li¡_bË
(
db_dœ
, 
»adÚly
),

114 
	`pos™iÚ_bË
(
db_dœ
, 
»adÚly
),

115 
	`‹rmli¡_bË
(
db_dœ
, 
»adÚly
),

116 
	`v®ue_bË
(
db_dœ
, 
»adÚly
),

117 
	`synÚym_bË
(
db_dœ
, 
»adÚly
),

118 
	`¥–lšg_bË
(
db_dœ
, 
»adÚly
),

119 
	`»cÜd_bË
(
db_dœ
, 
»adÚly
),

120 
	`lock
(
db_dœ
),

121 
	`tÙ®_Ëngth
(0),

122 
	`Ï¡docid
(0),

123 
	$max_chªge£ts
(0)

125 
	`DEBUGCALL
(
DB
, , "FlštD©aba£", 
æšt_dœ
 << ", " << 
aùiÚ
 <<

126 ", " << 
block_size
);

128 ià(
aùiÚ
 =ğ
XAPIAN_DB_READONLY
) {

129 
	`İ’_bËs_cÚsi¡’t
();

133 cÚ¡ *
p
 = 
	`g‘’v
("XAPIAN_MAX_CHANGESETS");

134 ià(
p
)

135 
max_chªge£ts
 = 
	`©oi
(
p
);

137 ià(
aùiÚ
 !ğ
X­Ÿn
::
DB_OPEN
 && !
	`d©aba£_exi¡s
()) {

142 
boŞ
 
ç
 = 
çl£
;

143 
¡©
 
¡©buf
;

144 ià(
	`¡©
(
db_dœ
, &
¡©buf
) == 0) {

145 ià(!
	`S_ISDIR
(
¡©buf
.
¡_mode
)è
ç
 = 
Œue
;

146 } ià(
”ºo
 !ğ
ENOENT
 || 
	`mkdœ
(
db_dœ
, 0755) == -1) {

147 
ç
 = 
Œue
;

149 ià(
ç
) {

150 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Cannot create directory `" +

151 
db_dœ
 + "'", 
”ºo
);

153 
	`g‘_d©aba£_wr™e_lock
(
Œue
);

155 
	`ü—‹_ªd_İ’_bËs
(
block_size
);

159 ià(
aùiÚ
 =ğ
X­Ÿn
::
DB_CREATE
) {

160 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Can't create‚ew database‡t `" +

161 
db_dœ
 + "':‡ database‡lreadyƒxists‡nd I wasold "

165 
	`g‘_d©aba£_wr™e_lock
(
çl£
);

168 ià(
aùiÚ
 =ğ
X­Ÿn
::
DB_CREATE_OR_OVERWRITE
) {

169 
	`ü—‹_ªd_İ’_bËs
(
block_size
);

174 
	`İ’_bËs_cÚsi¡’t
();

179 ià(
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
() !=

180 
po¡li¡_bË
.
	`g‘_Ï‹¡_»visiÚ_numb”
()) {

181 
æšt_»visiÚ_numb”_t
 
Ãw_»visiÚ
 = 
	`g‘_Ãxt_»visiÚ_numb”
();

183 
	`£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

185 
	}
}

187 
	gFlštD©aba£
::~
	$FlštD©aba£
()

189 
	`DEBUGCALL
(
DB
, , "~FlintDatabase", "");

190 
	}
}

193 
	gFlštD©aba£
::
	$»ad_m‘ašfo
()

195 
	`DEBUGCALL
(
DB
, , "FlintDatabase::read_metainfo", "");

197 
¡ršg
 
g
;

198 ià(!
po¡li¡_bË
.
	`g‘_exaù_’Œy
(
METAINFO_KEY
, 
g
)) {

199 
Ï¡docid
 = 0;

200 
tÙ®_Ëngth
 = 0;

204 cÚ¡ * 
d©a
 = 
g
.
	`d©a
();

205 cÚ¡ * 
’d
 = 
d©a
 + 
g
.
	`size
();

206 ià(!
	`F_uÅack_ušt
(&
d©a
, 
’d
, &
Ï¡docid
) ||

207 !
	`F_uÅack_ušt_Ï¡
(&
d©a
, 
’d
, &
tÙ®_Ëngth
)) {

208 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Meta information is corrupt.");

210 
	}
}

212 
boŞ


213 
	gFlštD©aba£
::
	$d©aba£_exi¡s
() {

214 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintDatabase::database_exists", "");

215 
	`RETURN
(
»cÜd_bË
.
	`exi¡s
() &&

216 
po¡li¡_bË
.
	`exi¡s
() &&

217 
‹rmli¡_bË
.
	`exi¡s
());

218 
	}
}

221 
	gFlštD©aba£
::
	$ü—‹_ªd_İ’_bËs
(
block_size
)

223 
	`DEBUGCALL
(
DB
, , "FlintDatabase::create_and_open_tables", "");

229 
v”siÚ_fe
.
	`ü—‹
();

230 
po¡li¡_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

233 
pos™iÚ_bË
.
	`”a£
();

234 
pos™iÚ_bË
.
	`£t_block_size
(
block_size
);

236 
‹rmli¡_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

239 
v®ue_bË
.
	`”a£
();

240 
v®ue_bË
.
	`£t_block_size
(
block_size
);

242 
synÚym_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

243 
¥–lšg_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

244 
»cÜd_bË
.
	`ü—‹_ªd_İ’
(
block_size
);

246 
	`As£¹
(
	`d©aba£_exi¡s
());

249 
æšt_»visiÚ_numb”_t
 
»visiÚ
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

250 ià(
»visiÚ
 !ğ
‹rmli¡_bË
.
	`g‘_İ’_»visiÚ_numb”
() ||

251 
»visiÚ
 !ğ
po¡li¡_bË
.
	`g‘_İ’_»visiÚ_numb”
()) {

252 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Newly createdables‡re‚ot in consistent state");

255 
tÙ®_Ëngth
 = 0;

256 
Ï¡docid
 = 0;

257 
	}
}

260 
	gFlštD©aba£
::
	$İ’_bËs_cÚsi¡’t
()

262 
	`DEBUGCALL
(
DB
, , "FlintDatabase::open_tables_consistent", "");

271 
æšt_»visiÚ_numb”_t
 
cur_»v
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

274 ià(
cur_»v
 =ğ0è
v”siÚ_fe
.
	`»ad_ªd_check
(
»adÚly
);

276 
»cÜd_bË
.
	`İ’
();

277 
æšt_»visiÚ_numb”_t
 
»visiÚ
 = 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

279 ià(
cur_»v
 && cur_»v =ğ
»visiÚ
) {

287 
block_size
 = 
»cÜd_bË
.
	`g‘_block_size
();

288 
pos™iÚ_bË
.
	`£t_block_size
(
block_size
);

289 
v®ue_bË
.
	`£t_block_size
(
block_size
);

290 
synÚym_bË
.
	`£t_block_size
(
block_size
);

291 
¥–lšg_bË
.
	`£t_block_size
(
block_size
);

293 
boŞ
 
fuÎy_İ’ed
 = 
çl£
;

294 
Œ›s
 = 100;

295 
Œ›s_Ëá
 = 
Œ›s
;

296 !
fuÎy_İ’ed
 && (
Œ›s_Ëá
--) > 0) {

297 ià(
¥–lšg_bË
.
	`İ’
(
»visiÚ
) &&

298 
synÚym_bË
.
	`İ’
(
»visiÚ
) &&

299 
v®ue_bË
.
	`İ’
(
»visiÚ
) &&

300 
‹rmli¡_bË
.
	`İ’
(
»visiÚ
) &&

301 
pos™iÚ_bË
.
	`İ’
(
»visiÚ
) &&

302 
po¡li¡_bË
.
	`İ’
(
»visiÚ
)) {

304 
fuÎy_İ’ed
 = 
Œue
;

316 
»cÜd_bË
.
	`İ’
();

317 
æšt_»visiÚ_numb”_t
 
Ãw»visiÚ
 =

318 
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
();

319 ià(
»visiÚ
 =ğ
Ãw»visiÚ
) {

323 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Cannot openables‡t consistent„evisions");

325 
»visiÚ
 = 
Ãw»visiÚ
;

329 ià(!
fuÎy_İ’ed
) {

330 
throw
 
X­Ÿn
::
	`D©aba£Modif›dE¼Ü
("Cannot openables‡t stable„evision - changingoo fast");

333 
	`»ad_m‘ašfo
();

334 
	}
}

337 
	gFlštD©aba£
::
	$İ’_bËs
(
æšt_»visiÚ_numb”_t
 
»visiÚ
)

339 
	`DEBUGCALL
(
DB
, , "FlštD©aba£::İ’_bËs", 
»visiÚ
);

340 
v”siÚ_fe
.
	`»ad_ªd_check
(
»adÚly
);

341 
»cÜd_bË
.
	`İ’
(
»visiÚ
);

345 
block_size
 = 
»cÜd_bË
.
	`g‘_block_size
();

346 
pos™iÚ_bË
.
	`£t_block_size
(
block_size
);

347 
v®ue_bË
.
	`£t_block_size
(
block_size
);

348 
synÚym_bË
.
	`£t_block_size
(
block_size
);

349 
¥–lšg_bË
.
	`£t_block_size
(
block_size
);

351 
¥–lšg_bË
.
	`İ’
(
»visiÚ
);

352 
synÚym_bË
.
	`İ’
(
»visiÚ
);

353 
v®ue_bË
.
	`İ’
(
»visiÚ
);

354 
‹rmli¡_bË
.
	`İ’
(
»visiÚ
);

355 
pos™iÚ_bË
.
	`İ’
(
»visiÚ
);

356 
po¡li¡_bË
.
	`İ’
(
»visiÚ
);

357 
	}
}

359 
æšt_»visiÚ_numb”_t


360 
	gFlštD©aba£
::
	$g‘_»visiÚ_numb”
() const

362 
	`DEBUGCALL
(
DB
, 
æšt_»visiÚ_numb”_t
, "FlintDatabase::get_revision_number", "");

364 
	`RETURN
(
po¡li¡_bË
.
	`g‘_İ’_»visiÚ_numb”
());

365 
	}
}

367 
æšt_»visiÚ_numb”_t


368 
	gFlštD©aba£
::
	$g‘_Ãxt_»visiÚ_numb”
() const

370 
	`DEBUGCALL
(
DB
, 
æšt_»visiÚ_numb”_t
, "FlintDatabase::get_next_revision_number", "");

375 
æšt_»visiÚ_numb”_t
 
Ãw_»visiÚ
 =

376 
po¡li¡_bË
.
	`g‘_Ï‹¡_»visiÚ_numb”
();

377 ++
Ãw_»visiÚ
;

378 
	`RETURN
(
Ãw_»visiÚ
);

379 
	}
}

382 
	gFlštD©aba£
::
	$g‘_chªge£t_»visiÚs
(cÚ¡ 
¡ršg
 & 
·th
,

383 
æšt_»visiÚ_numb”_t
 * 
¡¬Œev
,

384 
æšt_»visiÚ_numb”_t
 * 
’d»v
) const

386 
chªges_fd
 = -1;

387 #ifdeà
__WIN32__


388 
chªges_fd
 = 
	`msvc_posix_İ’
(
·th
.
	`c_¡r
(), 
O_RDONLY
);

390 
chªges_fd
 = 
	`İ’
(
·th
.
	`c_¡r
(), 
O_RDONLY
);

392 
fdşo£r
 
	`şo£r
(
chªges_fd
);

394 ià(
chªges_fd
 < 0) {

395 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open changeset ")

396 + 
·th
 + "o„ead";

397 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
, 
”ºo
);

400 
buf
[
REASONABLE_CHANGESET_SIZE
];

401 cÚ¡ *
¡¬t
 = 
buf
;

402 cÚ¡ *
’d
 = 
buf
 + 
	`æšt_io_»ad
(
chªges_fd
, buf,

403 
REASONABLE_CHANGESET_SIZE
, 0);

404 ià(
	`¡ºcmp
(
¡¬t
, 
CHANGES_MAGIC_STRING
,

405 
	`CONST_STRLEN
(
CHANGES_MAGIC_STRING
)) != 0) {

406 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Changeset‡t ")

407 + 
·th
 + " does‚ot contain valid magic string";

408 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

410 
¡¬t
 +ğ
	`CONST_STRLEN
(
CHANGES_MAGIC_STRING
);

411 ià(
¡¬t
 >ğ
’d
)

412 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Chªge£ˆtoØshÜˆ© " + 
·th
);

414 
chªges_v”siÚ
;

415 ià(!
	`F_uÅack_ušt
(&
¡¬t
, 
’d
, &
chªges_v”siÚ
))

416 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ valid version‚umber for "

417 "chªge£ˆ© " + 
·th
);

418 ià(
chªges_v”siÚ
 !ğ
CHANGES_VERSION
)

419 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Don't support version of changeset‡t "

420 + 
·th
);

422 ià(!
	`F_uÅack_ušt
(&
¡¬t
, 
’d
, 
¡¬Œev
))

423 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ valid start„evision from "

424 "chªge£ˆ© " + 
·th
);

426 ià(!
	`F_uÅack_ušt
(&
¡¬t
, 
’d
, 
’d»v
))

427 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„ead‡ validƒnd„evision for "

428 "chªge£ˆ© " + 
·th
);

429 
	}
}

432 
	gFlštD©aba£
::
	$£t_»visiÚ_numb”
(
æšt_»visiÚ_numb”_t
 
Ãw_»visiÚ
)

434 
	`DEBUGCALL
(
DB
, , "FlštD©aba£::£t_»visiÚ_numb”", 
Ãw_»visiÚ
);

436 
po¡li¡_bË
.
	`æush_db
();

437 
pos™iÚ_bË
.
	`æush_db
();

438 
‹rmli¡_bË
.
	`æush_db
();

439 
v®ue_bË
.
	`æush_db
();

440 
synÚym_bË
.
	`æush_db
();

441 
¥–lšg_bË
.
	`æush_db
();

442 
»cÜd_bË
.
	`æush_db
();

444 
chªges_fd
 = -1;

445 
¡ršg
 
chªges_Çme
;

447 ià(
max_chªge£ts
 > 0) {

448 
æšt_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

449 ià(
Şd_»visiÚ
) {

451 
chªges_Çme
 = 
db_dœ
 + "/chªges" + 
	`om_to¡ršg
(
Şd_»visiÚ
);

452 #ifdeà
__WIN32__


453 
chªges_fd
 = 
	`msvc_posix_İ’
(
chªges_Çme
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

455 
chªges_fd
 = 
	`İ’
(
chªges_Çme
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

457 ià(
chªges_fd
 < 0) {

458 
¡ršg
 
mes§ge
 = 
	`¡ršg
("Couldn't open changeset ")

459 + 
chªges_Çme
 + "o write";

460 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
, 
”ºo
);

465 
Œy
 {

466 
fdşo£r
 
	`şo£fd
(
chªges_fd
);

467 ià(
chªges_fd
 >= 0) {

468 
¡ršg
 
buf
;

469 
æšt_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

470 
buf
 +ğ
CHANGES_MAGIC_STRING
;

471 
buf
 +ğ
	`F_·ck_ušt
(
CHANGES_VERSION
);

472 
buf
 +ğ
	`F_·ck_ušt
(
Şd_»visiÚ
);

473 
buf
 +ğ
	`F_·ck_ušt
(
Ãw_»visiÚ
);

476 
buf
 +ğ
	`F_·ck_ušt
(0u);

478 
	`æšt_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

484 
‹rmli¡_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

485 
synÚym_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

486 
¥–lšg_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

487 
»cÜd_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

488 
pos™iÚ_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

489 
v®ue_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

490 
po¡li¡_bË
.
	`wr™e_chªged_blocks
(
chªges_fd
);

493 
po¡li¡_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

494 
pos™iÚ_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

495 
‹rmli¡_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

496 
v®ue_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

497 
synÚym_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

498 
¥–lšg_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
);

500 
¡ršg
 
chªges_
;

501 ià(
chªges_fd
 >= 0) {

502 
chªges_
 += '\0';

503 
chªges_
 +ğ
	`F_·ck_ušt
(
Ãw_»visiÚ
);

505 
»cÜd_bË
.
	`comm™
(
Ãw_»visiÚ
, 
chªges_fd
, &
chªges_
);

507 } 
	`ÿtch
 (...) {

509 ià(
chªges_fd
 >= 0) {

510 
	`sys_uÆšk_if_exi¡s
(
chªges_Çme
);

513 
throw
;

515 
	}
}

518 
	gFlštD©aba£
::
	$»İ’
()

520 
	`DEBUGCALL
(
DB
, , "FlintDatabase::reopen", "");

521 ià(
»adÚly
) {

522 
	`İ’_bËs_cÚsi¡’t
();

524 
	}
}

527 
	gFlštD©aba£
::
	$şo£
()

529 
	`DEBUGCALL
(
DB
, , "FlintDatabase::close", "");

530 
po¡li¡_bË
.
	`şo£
(
Œue
);

531 
pos™iÚ_bË
.
	`şo£
(
Œue
);

532 
‹rmli¡_bË
.
	`şo£
(
Œue
);

533 
v®ue_bË
.
	`şo£
(
Œue
);

534 
synÚym_bË
.
	`şo£
(
Œue
);

535 
¥–lšg_bË
.
	`şo£
(
Œue
);

536 
»cÜd_bË
.
	`şo£
(
Œue
);

537 
lock
.
	`»Ëa£
();

538 
	}
}

541 
	gFlštD©aba£
::
	$g‘_d©aba£_wr™e_lock
(
boŞ
 
ü—tšg
)

543 
	`DEBUGCALL
(
DB
, , "FlštD©aba£::g‘_d©aba£_wr™e_lock", 
ü—tšg
);

544 
¡ršg
 
ex¶ª©iÚ
;

545 
FlštLock
::
»asÚ
 
why
 = 
lock
.
	`lock
(
Œue
, 
ex¶ª©iÚ
);

546 ià(
why
 !ğ
FlštLock
::
SUCCESS
) {

547 ià(
why
 =ğ
FlštLock
::
UNKNOWN
 && !
ü—tšg
 && !
	`d©aba£_exi¡s
()) {

548 
¡ršg
 
	`msg
("No flint database found‡t…ath `");

549 
msg
 +ğ
db_dœ
;

550 
msg
 += '\'';

551 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
);

553 
lock
.
	`throw_d©aba£lock”rÜ
(
why
, 
db_dœ
, 
ex¶ª©iÚ
);

555 
	}
}

558 
	gFlštD©aba£
::
	$£nd_whŞe_d©aba£
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

559 cÚ¡ 
OmTime
 & 
’d_time
)

561 
	`DEBUGCALL
(
DB
, , "FlintDatabase::send_whole_database",

565 
¡ršg
 
buf
;

566 
¡ršg
 
uuid
 = 
	`g‘_uuid
();

567 
buf
 +ğ
	`’code_Ëngth
(
uuid
.
	`size
());

568 
buf
 +ğ
uuid
;

569 
buf
 +ğ
	`F_·ck_ušt
(
	`g‘_»visiÚ_numb”
());

570 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_HEADER
, 
buf
, 
’d_time
);

574 cÚ¡ 
f’ames
[] =

584 
¡ršg
 
f•©h
 = 
db_dœ
;

585 
f•©h
 += '/';

586 cÚ¡ * 
p
 = 
f’ames
; *p;… += *p + 1) {

587 
¡ršg
 
	`Ëaf
(
p
 + 1, 
	`size_t
(
¡©ic_ÿ¡
<>(*p)));

588 
f•©h
.
	`»¶aû
(
db_dœ
.
	`size
(è+ 1, 
¡ršg
::
Åos
, 
Ëaf
);

589 ià(
	`fe_exi¡s
(
f•©h
)) {

592 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FILENAME
, 
Ëaf
, 
’d_time
);

593 
cÚn
.
	`£nd_fe
(
REPL_REPLY_DB_FILEDATA
, 
f•©h
, 
’d_time
);

596 
	}
}

599 
	gFlštD©aba£
::
	$wr™e_chªge£ts_to_fd
(
fd
,

600 cÚ¡ 
¡ršg
 & 
»visiÚ
,

601 
boŞ
 
Ãed_whŞe_db
,

602 
R•liÿtiÚInfo
 * 
šfo
)

604 
	`DEBUGCALL
(
DB
, , "FlintDatabase::write_changesets_to_fd",

605 
fd
 << ", " << 
»visiÚ
 << ", " << 
Ãed_whŞe_db
 << ", " << 
šfo
);

607 
whŞe_db_cİ›s_Ëá
 = 
MAX_DB_COPIES_PER_CONVERSATION
;

608 
æšt_»visiÚ_numb”_t
 
¡¬t_»v_num
 = 0;

609 
¡ršg
 
¡¬t_uuid
 = 
	`g‘_uuid
();

611 
æšt_»visiÚ_numb”_t
 
Ãeded_»v_num
 = 0;

613 cÚ¡ * 
»v_±r
 = 
»visiÚ
.
	`d©a
();

614 cÚ¡ * 
»v_’d
 = 
»v_±r
 + 
»visiÚ
.
	`size
();

615 ià(!
	`F_uÅack_ušt
(&
»v_±r
, 
»v_’d
, &
¡¬t_»v_num
)) {

616 
Ãed_whŞe_db
 = 
Œue
;

619 
RemÙeCÚÃùiÚ
 
	`cÚn
(-1, 
fd
, "");

620 
OmTime
 
’d_time
;

628 
Œue
) {

629 ià(
Ãed_whŞe_db
) {

633 ià(
whŞe_db_cİ›s_Ëá
 == 0) {

634 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_FAIL
,

636 
’d_time
);

639 
whŞe_db_cİ›s_Ëá
--;

642 
¡¬t_»v_num
 = 
	`g‘_»visiÚ_numb”
();

643 
¡¬t_uuid
 = 
	`g‘_uuid
();

645 
	`£nd_whŞe_d©aba£
(
cÚn
, 
’d_time
);

646 ià(
šfo
 !ğ
NULL
)

647 ++(
šfo
->
fuÎcİy_couÁ
);

649 
Ãed_whŞe_db
 = 
çl£
;

651 
	`»İ’
();

652 ià(
¡¬t_uuid
 =ğ
	`g‘_uuid
()) {

657 
¡ršg
 
buf
;

658 
Ãeded_»v_num
 = 
	`g‘_»visiÚ_numb”
();

659 
buf
 +ğ
	`F_·ck_ušt
(
Ãeded_»v_num
);

660 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FOOTER
, 
buf
, 
’d_time
);

661 ià(
šfo
 !ğ
NULL
 && 
¡¬t_»v_num
 =ğ
Ãeded_»v_num
)

662 
šfo
->
chªged
 = 
Œue
;

672 
¡ršg
 
buf
;

673 
buf
 +ğ
	`F_·ck_ušt
(
¡¬t_»v_num
 + 1);

674 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_DB_FOOTER
, 
buf
, 
’d_time
);

675 
Ãed_whŞe_db
 = 
Œue
;

679 ià(
¡¬t_»v_num
 >ğ
	`g‘_»visiÚ_numb”
()) {

680 
	`»İ’
();

681 ià(
¡¬t_uuid
 !ğ
	`g‘_uuid
()) {

682 
Ãed_whŞe_db
 = 
Œue
;

685 ià(
¡¬t_»v_num
 >ğ
	`g‘_»visiÚ_numb”
()) {

691 
¡ršg
 
chªges_Çme
 = 
db_dœ
 + "/chªges" + 
	`om_to¡ršg
(
¡¬t_»v_num
);

692 ià(
	`fe_exi¡s
(
chªges_Çme
)) {

695 
æšt_»visiÚ_numb”_t
 
chªge£t_¡¬t_»v_num
;

696 
æšt_»visiÚ_numb”_t
 
chªge£t_’d_»v_num
;

697 
	`g‘_chªge£t_»visiÚs
(
chªges_Çme
,

698 &
chªge£t_¡¬t_»v_num
,

699 &
chªge£t_’d_»v_num
);

700 ià(
chªge£t_¡¬t_»v_num
 !ğ
¡¬t_»v_num
) {

701 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Changeset start„evision does‚ot match changeset filename");

703 ià(
chªge£t_¡¬t_»v_num
 >ğ
chªge£t_’d_»v_num
) {

704 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Changeset start„evision is‚ot†esshanƒnd„evision");

709 
cÚn
.
	`£nd_fe
(
REPL_REPLY_CHANGESET
, 
chªges_Çme
, 
’d_time
);

710 
¡¬t_»v_num
 = 
chªge£t_’d_»v_num
;

711 ià(
šfo
 !ğ
NULL
) {

712 ++(
šfo
->
chªge£t_couÁ
);

713 ià(
¡¬t_»v_num
 >ğ
Ãeded_»v_num
)

714 
šfo
->
chªged
 = 
Œue
;

719 
Ãed_whŞe_db
 = 
Œue
;

723 
cÚn
.
	`£nd_mes§ge
(
REPL_REPLY_END_OF_CHANGES
, 
	`¡ršg
(), 
’d_time
);

724 
	}
}

727 
	gFlštD©aba£
::
	$modifiÿtiÚs_çed
(
æšt_»visiÚ_numb”_t
 
Şd_»visiÚ
,

728 
æšt_»visiÚ_numb”_t
 
Ãw_»visiÚ
,

729 cÚ¡ 
¡ršg
 & 
msg
)

732 
Œy
 {

735 
	`ÿnûl
();

738 
	`İ’_bËs
(
Şd_»visiÚ
);

742 ++
Ãw_»visiÚ
;

743 
	`£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

744 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

747 
FlštD©aba£
::
	`şo£
();

748 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("ModifiÿtiÚ çed (" + 
msg
 +

750 "»visiÚ‚umb”s: " + 
e
.
	`g‘_msg
());

752 
	}
}

755 
	gFlštD©aba£
::
	$­¶y
()

757 
	`DEBUGCALL
(
DB
, , "FlintDatabase::apply", "");

758 ià(!
po¡li¡_bË
.
	`is_modif›d
() &&

759 !
pos™iÚ_bË
.
	`is_modif›d
() &&

760 !
‹rmli¡_bË
.
	`is_modif›d
() &&

761 !
v®ue_bË
.
	`is_modif›d
() &&

762 !
synÚym_bË
.
	`is_modif›d
() &&

763 !
¥–lšg_bË
.
	`is_modif›d
() &&

764 !
»cÜd_bË
.
	`is_modif›d
()) {

768 
æšt_»visiÚ_numb”_t
 
Şd_»visiÚ
 = 
	`g‘_»visiÚ_numb”
();

769 
æšt_»visiÚ_numb”_t
 
Ãw_»visiÚ
 = 
	`g‘_Ãxt_»visiÚ_numb”
();

771 
Œy
 {

772 
	`£t_»visiÚ_numb”
(
Ãw_»visiÚ
);

773 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

774 
	`modifiÿtiÚs_çed
(
Şd_»visiÚ
, 
Ãw_»visiÚ
, 
e
.
	`g‘_desütiÚ
());

775 
throw
;

776 } 
	`ÿtch
 (...) {

777 
	`modifiÿtiÚs_çed
(
Şd_»visiÚ
, 
Ãw_»visiÚ
, "Unknownƒrror");

778 
throw
;

780 
	}
}

783 
	gFlštD©aba£
::
	$ÿnûl
()

785 
	`DEBUGCALL
(
DB
, , "FlintDatabase::cancel", "");

786 
po¡li¡_bË
.
	`ÿnûl
();

787 
pos™iÚ_bË
.
	`ÿnûl
();

788 
‹rmli¡_bË
.
	`ÿnûl
();

789 
v®ue_bË
.
	`ÿnûl
();

790 
synÚym_bË
.
	`ÿnûl
();

791 
¥–lšg_bË
.
	`ÿnûl
();

792 
»cÜd_bË
.
	`ÿnûl
();

793 
	}
}

795 
	gX­Ÿn
::
doccouÁ


796 
FlštD©aba£
::
	$g‘_doccouÁ
() const

798 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "FlintDatabase::get_doccount", "");

799 
	`RETURN
(
»cÜd_bË
.
	`g‘_doccouÁ
());

800 
	}
}

802 
	gX­Ÿn
::
docid


803 
FlštD©aba£
::
	$g‘_Ï¡docid
() const

805 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "FlintDatabase::get_lastdocid", "");

806 
	`RETURN
(
Ï¡docid
);

807 
	}
}

809 
tÙËn_t


810 
	gFlštD©aba£
::
	$g‘_tÙ®_Ëngth
() const

812 
	`DEBUGCALL
(
DB
, 
tÙËn_t
, "FlintDatabase::get_total_length", "");

813 
	`RETURN
(
tÙ®_Ëngth
);

814 
	}
}

816 
	gX­Ÿn
::
doş’gth


817 
FlštD©aba£
::
	$g‘_avËngth
() const

819 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doş’gth
, "FlintDatabase::get_avlength", "");

820 
X­Ÿn
::
doccouÁ
 doccouÁ = 
»cÜd_bË
.
	`g‘_doccouÁ
();

821 ià(
doccouÁ
 == 0) {

823 
	`RETURN
(0);

825 
	`RETURN
((
tÙ®_Ëngth
è/ 
doccouÁ
);

826 
	}
}

828 
	gX­Ÿn
::
‹rmcouÁ


829 
FlštD©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

831 
DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlštD©aba£::g‘_doş’gth", 
did
);

832 
As£¹
(
did
 != 0);

833 
RETURN
(
‹rmli¡_bË
.
g‘_doş’gth
(
did
));

836 
	gX­Ÿn
::
doccouÁ


837 
FlštD©aba£
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

839 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "FlštD©aba£::g‘_‹rmäeq", 
‹rm
);

840 
	`As£¹
(!
‹rm
.
	`em±y
());

841 
	`RETURN
(
po¡li¡_bË
.
	`g‘_‹rmäeq
(
‹rm
));

842 
	}
}

844 
	gX­Ÿn
::
‹rmcouÁ


845 
FlštD©aba£
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

847 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlštD©aba£::g‘_cŞËùiÚ_äeq", 
‹rm
);

848 
	`As£¹
(!
‹rm
.
	`em±y
());

849 
	`RETURN
(
po¡li¡_bË
.
	`g‘_cŞËùiÚ_äeq
(
‹rm
));

850 
	}
}

852 
boŞ


853 
	gFlštD©aba£
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
‹rm
) const

855 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštD©aba£::‹rm_exi¡s", 
‹rm
);

856 
	`As£¹
(!
‹rm
.
	`em±y
());

857  
po¡li¡_bË
.
	`‹rm_exi¡s
(
‹rm
);

858 
	}
}

860 
boŞ


861 
	gFlštD©aba£
::
	$has_pos™iÚs
() const

863  !
pos™iÚ_bË
.
	`em±y
();

864 
	}
}

866 
L—fPo¡Li¡
 *

867 
	gFlštD©aba£
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
& 
‹rm
) const

869 
	`DEBUGCALL
(
DB
, 
L—fPo¡Li¡
 *, "FlštD©aba£::İ’_po¡_li¡", 
‹rm
);

870 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
	`±¹Ùhis
(
this
);

872 ià(
‹rm
.
	`em±y
()) {

873 
X­Ÿn
::
doccouÁ
 doccouÁ = 
	`g‘_doccouÁ
();

874 ià(
Ï¡docid
 =ğ
doccouÁ
) {

875 
	`RETURN
(
Ãw
 
	`CÚtiguousAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

877 
	`RETURN
(
Ãw
 
	`FlštAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

880 
	`RETURN
(
Ãw
 
	`FlštPo¡Li¡
(
±¹Ùhis
, 
‹rm
));

881 
	}
}

883 
T”mLi¡
 *

884 
	gFlštD©aba£
::
İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const

886 
DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlštD©aba£::İ’_‹rm_li¡", 
did
);

887 
As£¹
(
did
 != 0);

889 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
±¹Ùhis
(
this
);

890 
RETURN
(
Ãw
 
FlštT”mLi¡
(
±¹Ùhis
, 
did
));

893 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

894 
FlštD©aba£
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const

896 
DEBUGCALL
(
DB
, 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 *, "FlintDatabase::open_document",

897 
did
 << ", " << 
Ïzy
);

898 
As£¹
(
did
 != 0);

900 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
±¹Ùhis
(
this
);

901 
RETURN
(
Ãw
 
FlštDocum’t
(
±¹Ùhis
,

902 &
v®ue_bË
,

903 &
»cÜd_bË
,

904 
did
, 
Ïzy
));

907 
Pos™iÚLi¡
 *

908 
	gFlštD©aba£
::
İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
‹rm
) const

910 
As£¹
(
did
 != 0);

912 
	gAutoPŒ
<
	gFlštPos™iÚLi¡
> 
po¦i¡
(
Ãw
 
FlštPos™iÚLi¡
);

913 ià(!
	gpo¦i¡
->
»ad_d©a
(&
pos™iÚ_bË
, 
did
, 
‹rm
)) {

919  
	gpo¦i¡
.
»Ëa£
();

922 
T”mLi¡
 *

923 
	gFlštD©aba£
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const

925 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlintDatabase::open_allterms", "");

926 
	`RETURN
(
Ãw
 
	`FlštAÎT”msLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
>(
this
),

927 
´efix
));

928 
	}
}

930 
T”mLi¡
 *

931 
	gFlštD©aba£
::
	$İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const

933  
¥–lšg_bË
.
	`İ’_‹rmli¡
(
wÜd
);

934 
	}
}

936 
T”mLi¡
 *

937 
	gFlštD©aba£
::
	$İ’_¥–lšg_wÜdli¡
() const

939 
FlštCursÜ
 * 
cursÜ
 = 
¥–lšg_bË
.
	`cursÜ_g‘
();

940 ià(!
cursÜ
è 
NULL
;

941  
Ãw
 
	`FlštS³ÎšgWÜdsLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
>(
this
),

942 
cursÜ
);

943 
	}
}

945 
	gX­Ÿn
::
doccouÁ


946 
FlštD©aba£
::
	$g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const

948  
¥–lšg_bË
.
	`g‘_wÜd_äequ’cy
(
wÜd
);

949 
	}
}

951 
T”mLi¡
 *

952 
	gFlštD©aba£
::
	$İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const

954  
synÚym_bË
.
	`İ’_‹rmli¡
(
‹rm
);

955 
	}
}

957 
T”mLi¡
 *

958 
	gFlštD©aba£
::
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const

960 
FlštCursÜ
 * 
cursÜ
 = 
synÚym_bË
.
	`cursÜ_g‘
();

961 ià(!
cursÜ
è 
NULL
;

962  
Ãw
 
	`FlštSynÚymT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
>(
this
),

963 
cursÜ
, 
´efix
);

964 
	}
}

966 
¡ršg


967 
	gFlštD©aba£
::
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const

969 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlštD©aba£::g‘_m‘ad©a", 
key
);

970 
¡ršg
 
	`bŒ“_key
("\x00\xc0", 2);

971 
bŒ“_key
 +ğ
key
;

972 
¡ršg
 
g
;

973 ()
po¡li¡_bË
.
	`g‘_exaù_’Œy
(
bŒ“_key
, 
g
);

974 
	`RETURN
(
g
);

975 
	}
}

977 
T”mLi¡
 *

978 
	gFlštD©aba£
::
İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const

980 
DEBUGCALL
(
DB
, 
¡ršg
, "FlintDatabase::open_metadata_keylist", "");

981 
FlštCursÜ
 * 
	gcursÜ
 = 
po¡li¡_bË
.
cursÜ_g‘
();

982 ià(!
	gcursÜ
è 
	gNULL
;

983  
Ãw
 
FlštM‘ad©aT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
>(
this
),

984 
cursÜ
, 
´efix
);

987 
¡ršg


988 
	gFlštD©aba£
::
	$g‘_»visiÚ_šfo
() const

990 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintDatabase::get_revision_info", "");

991 
¡ršg
 
buf
;

992 
buf
 +ğ
	`F_·ck_ušt
(
	`g‘_»visiÚ_numb”
());

993 
	`RETURN
(
buf
);

994 
	}
}

996 
¡ršg


997 
	gFlštD©aba£
::
	$g‘_uuid
() const

999 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintDatabase::get_uuid", "");

1000 
	`RETURN
(
v”siÚ_fe
.
	`g‘_uuid_¡ršg
());

1001 
	}
}

1005 
	gFlštWr™abËD©aba£
::
	$FlštWr™abËD©aba£
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
,

1006 
block_size
)

1007 : 
	`FlštD©aba£
(
dœ
, 
aùiÚ
, 
block_size
),

1008 
	`äeq_d–s
(),

1009 
	`doş’s
(),

1010 
	`mod_¶i¡s
(),

1011 
	`chªge_couÁ
(0),

1012 
	`æush_th»shŞd
(0),

1013 
	`modify_shÜtcut_docum’t
(
NULL
),

1014 
	$modify_shÜtcut_docid
(0)

1016 
	`DEBUGCALL
(
DB
, , "FlštWr™abËD©aba£", 
dœ
 << ", " << 
aùiÚ
 << ", "

1017 << 
block_size
);

1019 cÚ¡ *
p
 = 
	`g‘’v
("XAPIAN_FLUSH_THRESHOLD");

1020 ià(
p
)

1021 
æush_th»shŞd
 = 
	`©oi
(
p
);

1022 ià(
æush_th»shŞd
 == 0)

1023 
æush_th»shŞd
 = 10000;

1024 
	}
}

1026 
	gFlštWr™abËD©aba£
::~
	$FlštWr™abËD©aba£
()

1028 
	`DEBUGCALL
(
DB
, , "~FlintWritableDatabase", "");

1029 
	`dtÜ_ÿÎed
();

1030 
	}
}

1033 
	gFlštWr™abËD©aba£
::
	$comm™
()

1035 ià(
	`Œª§ùiÚ_aùive
())

1036 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Can't commit during‡ransaction");

1037 ià(
chªge_couÁ
è
	`æush_po¡li¡_chªges
();

1038 
	`­¶y
();

1039 
	}
}

1042 
	gFlštWr™abËD©aba£
::
	$æush_po¡li¡_chªges
() const

1044 
po¡li¡_bË
.
	`m”ge_chªges
(
mod_¶i¡s
, 
doş’s
, 
äeq_d–s
);

1047 
¡ršg
 
g
 = 
	`F_·ck_ušt
(
Ï¡docid
);

1048 
g
 +ğ
	`F_·ck_ušt_Ï¡
(
tÙ®_Ëngth
);

1049 
po¡li¡_bË
.
	`add
(
METAINFO_KEY
, 
g
);

1051 
äeq_d–s
.
	`ş—r
();

1052 
doş’s
.
	`ş—r
();

1053 
mod_¶i¡s
.
	`ş—r
();

1054 
chªge_couÁ
 = 0;

1055 
	}
}

1058 
	gFlštWr™abËD©aba£
::
	$şo£
()

1060 
	`DEBUGCALL
(
DB
, , "FlintWritableDatabase::close", "");

1061 ià(!
	`Œª§ùiÚ_aùive
()) {

1062 
	`comm™
();

1065 
FlštD©aba£
::
	`şo£
();

1066 
	}
}

1069 
	gFlštWr™abËD©aba£
::
add_äeq_d–
(cÚ¡ 
¡ršg
 & 
Šame
,

1070 
X­Ÿn
::
‹rmcouÁ_diff
 
tf_d–
,

1071 
X­Ÿn
::
‹rmcouÁ_diff
 
cf_d–
)

1073 
m­
<
¡ršg
, 
	g·œ
<
	g‹rmcouÁ_diff
,”mcouÁ_diff> >::
™”©Ü
 
i
;

1074 
	gi
 = 
äeq_d–s
.
fšd
(
Šame
);

1075 ià(
	gi
 =ğ
äeq_d–s
.
’d
()) {

1076 
äeq_d–s
.
š£¹
(
make_·œ
(
Šame
, make_·œ(
tf_d–
, 
cf_d–
)));

1078 
	gi
->
	g£cÚd
.
	gfœ¡
 +ğ
tf_d–
;

1079 
	gi
->
	g£cÚd
.£cÚd +ğ
cf_d–
;

1084 
	gFlštWr™abËD©aba£
::
š£¹_mod_¶i¡
(
X­Ÿn
::
docid
 
did
,

1085 cÚ¡ 
¡ršg
 & 
Šame
,

1086 
X­Ÿn
::
‹rmcouÁ
 
wdf
)

1089 
m­
<
¡ršg
, 
	gm­
<
	gdocid
, 
	g·œ
<, 
	g‹rmcouÁ
> > >::
™”©Ü
 
j
;

1090 
	gj
 = 
mod_¶i¡s
.
fšd
(
Šame
);

1091 ià(
	gj
 =ğ
mod_¶i¡s
.
’d
()) {

1092 
m­
<
docid
, 
·œ
<, 
‹rmcouÁ
> > 
m
;

1093 
	gj
 = 
mod_¶i¡s
.
š£¹
(
make_·œ
(
Šame
, 
m
)).
	gfœ¡
;

1095 
	gj
->
	g£cÚd
[
did
] = 
make_·œ
('A', 
wdf
);

1099 
	gFlštWr™abËD©aba£
::
upd©e_mod_¶i¡
(
X­Ÿn
::
docid
 
did
,

1100 cÚ¡ 
¡ršg
 & 
Šame
,

1101 
ty³
,

1102 
X­Ÿn
::
‹rmcouÁ
 
wdf
)

1105 
m­
<
¡ršg
, 
	gm­
<
	gdocid
, 
	g·œ
<, 
	g‹rmcouÁ
> > >::
™”©Ü
 
j
;

1106 
	gj
 = 
mod_¶i¡s
.
fšd
(
Šame
);

1107 ià(
	gj
 =ğ
mod_¶i¡s
.
’d
()) {

1108 
m­
<
docid
, 
·œ
<, 
‹rmcouÁ
> > 
m
;

1109 
	gj
 = 
mod_¶i¡s
.
š£¹
(
make_·œ
(
Šame
, 
m
)).
	gfœ¡
;

1112 
	gm­
<
	gdocid
, 
	g·œ
<, 
	g‹rmcouÁ
> >::
™”©Ü
 
k
;

1113 
	gk
 = 
j
->
£cÚd
.
fšd
(
did
);

1114 ià(
	gk
 =ğ
j
->
£cÚd
.
’d
()) {

1115 
j
->
£cÚd
.
š£¹
(
make_·œ
(
did
, make_·œ(
ty³
, 
wdf
)));

1117 ià(
	gty³
 == 'A') {

1119 
As£¹
(
k
->
£cÚd
.
fœ¡
 == 'D');

1120 
	gty³
 = 'M';

1122 
	gk
->
	g£cÚd
 = 
make_·œ
(
ty³
, 
wdf
);

1126 
	gX­Ÿn
::
docid


1127 
FlštWr™abËD©aba£
::
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1129 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
,

1130 "FlštWr™abËD©aba£::add_docum’t", 
docum’t
);

1132 ià(
	gÏ¡docid
 =ğ
X­Ÿn
::
docid
(-1))

1133 
throw
 
X­Ÿn
::
D©aba£E¼Ü
("Run out of docids - you'll haveo use copydatabaseoƒliminate‡ny gaps before you can‡dd more documents");

1135 
RETURN
(
add_docum’t_
(++
Ï¡docid
, 
docum’t
));

1138 
	gX­Ÿn
::
docid


1139 
FlštWr™abËD©aba£
::
add_docum’t_
(
X­Ÿn
::
docid
 
did
,

1140 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1142 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
,

1143 "FlštWr™abËD©aba£::add_docum’t_", 
did
 << ", " << 
docum’t
);

1144 
As£¹
(
did
 != 0);

1145 
	gŒy
 {

1147 
	g»cÜd_bË
.
»¶aû_»cÜd
(
docum’t
.
g‘_d©a
(), 
did
);

1151 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v®ue
 = 
docum’t
.
v®ues_begš
();

1152 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v®ue_’d
 = 
docum’t
.
v®ues_’d
();

1153 
¡ršg
 
	gs
;

1154 
	gv®ue_bË
.
’code_v®ues
(
s
, 
v®ue
, 
v®ue_’d
);

1155 
	gv®ue_bË
.
£t_’coded_v®ues
(
did
, 
s
);

1158 
æšt_doş’_t
 
	gÃw_doş’
 = 0;

1160 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm
 = 
docum’t
.
‹rmli¡_begš
();

1161 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm_’d
 = 
docum’t
.
‹rmli¡_’d
();

1162  ; 
	g‹rm
 !ğ
‹rm_’d
; ++term) {

1163 
‹rmcouÁ
 
	gwdf
 = 
‹rm
.
g‘_wdf
();

1165 
	gÃw_doş’
 +ğ
wdf
;

1167 
¡ršg
 
	gŠame
 = *
‹rm
;

1168 ià(
	gŠame
.
size
(è> 
	gMAX_SAFE_TERM_LENGTH
)

1169 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("T”moØlÚg (> "
STRINGIZE
(
MAX_SAFE_TERM_LENGTH
)"): " + 
Šame
);

1170 
add_äeq_d–
(
Šame
, 1, 
wdf
);

1171 
š£¹_mod_¶i¡
(
did
, 
Šame
, 
wdf
);

1173 ià(
	g‹rm
.
pos™iÚli¡_begš
(è!ğ
‹rm
.
pos™iÚli¡_’d
()) {

1174 
pos™iÚ_bË
.
£t_pos™iÚli¡
(

1175 
did
, 
Šame
,

1176 
‹rm
.
pos™iÚli¡_begš
(),”m.
pos™iÚli¡_’d
());

1180 
LOGLINE
(
DB
, "C®cuÏ‹d doş’ fÜ‚ew docum’ˆ" << 
did
 << "‡ " << 
Ãw_doş’
);

1183 
	g‹rmli¡_bË
.
£t_‹rmli¡
(
did
, 
docum’t
, 
Ãw_doş’
);

1186 
As£¹
(
doş’s
.
fšd
(
did
è=ğdoş’s.
’d
());

1187 
	gdoş’s
[
did
] = 
Ãw_doş’
;

1188 
	gtÙ®_Ëngth
 +ğ
Ãw_doş’
;

1189 } 
ÿtch
 (...) {

1194 
ÿnûl
();

1195 
	gthrow
;

1208 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1209 
æush_po¡li¡_chªges
();

1210 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1213 
RETURN
(
did
);

1217 
	gFlštWr™abËD©aba£
::
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
)

1219 
DEBUGCALL
(
DB
, , "FlštWr™abËD©aba£::d–‘e_docum’t", 
did
);

1220 
As£¹
(
did
 != 0);

1222 ià(
¿»
(
modify_shÜtcut_docid
 =ğ
did
)) {

1225 
modify_shÜtcut_docum’t
 = 
NULL
;

1226 
	gmodify_shÜtcut_docid
 = 0;

1232 
	g»cÜd_bË
.
d–‘e_»cÜd
(
did
);

1234 
	gŒy
 {

1236 
	gv®ue_bË
.
d–‘e_®l_v®ues
(
did
);

1239 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštWr™abËD©aba£
> 
±¹Ùhis
(
this
);

1240 
FlštT”mLi¡
 
‹rmli¡
(
±¹Ùhis
, 
did
);

1242 
	gtÙ®_Ëngth
 -ğ
‹rmli¡
.
g‘_doş’gth
();

1244 
	g‹rmli¡
.
Ãxt
();

1245 !
	g‹rmli¡
.
©_’d
()) {

1246 
¡ršg
 
	gŠame
 = 
‹rmli¡
.
g‘_‹rmÇme
();

1247 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, 
Šame
);

1248 
‹rmcouÁ
 
	gwdf
 = 
‹rmli¡
.
g‘_wdf
();

1250 
add_äeq_d–
(
Šame
, -1, -
wdf
);

1251 
upd©e_mod_¶i¡
(
did
, 
Šame
, 'D', 0u);

1253 
	g‹rmli¡
.
Ãxt
();

1257 
	g‹rmli¡_bË
.
d–‘e_‹rmli¡
(
did
);

1260 
	gdoş’s
.
”a£
(
did
);

1261 } 
ÿtch
 (...) {

1266 
ÿnûl
();

1267 
	gthrow
;

1270 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1271 
æush_po¡li¡_chªges
();

1272 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1280 
boŞ
 
pos™iÚli¡s_equ®
(
X­Ÿn
::
T”mI‹¿tÜ
 & 
‹rm™”
,

1281 
FlštT”mLi¡
 & 
‹rmli¡
)

1283 ià(
	g‹rm™”
.
pos™iÚli¡_couÁ
(è!ğ
‹rmli¡
.positionlist_count())

1284  
çl£
;

1286  
equ®
(
‹rm™”
.
pos™iÚli¡_begš
(),

1287 
‹rm™”
.
pos™iÚli¡_’d
(),

1288 
‹rmli¡
.
pos™iÚli¡_begš
());

1300 
£t_pos™iÚli¡
(
FlštPos™iÚLi¡TabË
 & 
pos™iÚ_bË
,

1301 
X­Ÿn
::
docid
 
did
,

1302 
X­Ÿn
::
T”mI‹¿tÜ
 & 
‹rm
)

1304 
Pos™iÚI‹¿tÜ
 
™
 = 
‹rm
.
pos™iÚli¡_begš
();

1305 
Pos™iÚI‹¿tÜ
 
	g™_’d
 = 
‹rm
.
pos™iÚli¡_’d
();

1306 ià(
	g™
 !ğ
™_’d
) {

1307 
pos™iÚ_bË
.
£t_pos™iÚli¡
(
did
, *
‹rm
, 
™
, 
™_’d
);

1309 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, *
‹rm
);

1314 
	gFlštWr™abËD©aba£
::
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

1315 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

1317 
DEBUGCALL
(
DB
, , "FlštWr™abËD©aba£::»¶aû_docum’t", 
did
 << ", " << 
docum’t
);

1318 
As£¹
(
did
 != 0);

1320 
	gŒy
 {

1321 ià(
	gdid
 > 
	gÏ¡docid
) {

1322 
	gÏ¡docid
 = 
did
;

1325 ()
add_docum’t_
(
did
, 
docum’t
);

1331 
boŞ
 
	gmodifyšg
 = 
çl£
;

1332 ià(
	gmodify_shÜtcut_docid
 &&

1333 
	gdocum’t
.
	gš‹º®
->
g‘_docid
(è=ğ
modify_shÜtcut_docid
) {

1334 ià(
docum’t
.
š‹º®
.
g‘
(è=ğ
modify_shÜtcut_docum’t
) {

1338 ià(!
docum’t
.
š‹º®
->
modif›d
()) {

1342 
	gmodifyšg
 = 
Œue
;

1343 
LOGLINE
(
DB
, "Detected…otential document modification shortcut.");

1348 
	gmodify_shÜtcut_docum’t
 = 
NULL
;

1349 
	gmodify_shÜtcut_docid
 = 0;

1353 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
‹rms_modif›d
()) {

1354 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštWr™abËD©aba£
> 
±¹Ùhis
(
this
);

1355 
FlštT”mLi¡
 
‹rmli¡
(
±¹Ùhis
, 
did
);

1356 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm
 = 
docum’t
.
‹rmli¡_begš
();

1363 
æšt_doş’_t
 
	gÃw_doş’
 = 0;

1364 ; 
	g‹rm
 !ğ
docum’t
.
‹rmli¡_’d
(); ++term) {

1365 
	gÃw_doş’
 +ğ
‹rm
.
g‘_wdf
();

1368 
	g‹rm
 = 
docum’t
.
‹rmli¡_begš
();

1369 
æšt_doş’_t
 
	gŞd_doş’
 = 
‹rmli¡
.
g‘_doş’gth
();

1370 
¡ršg
 
	gŞd_Šame
, 
	gÃw_Šame
;

1372 
	gtÙ®_Ëngth
 -ğ
Şd_doş’
;

1374 
	g‹rmli¡
.
Ãxt
();

1375 !
	g‹rmli¡
.
©_’d
(è|| 
	g‹rm
 !ğ
docum’t
.
‹rmli¡_’d
()) {

1376 
cmp
;

1377 ià(
	g‹rmli¡
.
©_’d
()) {

1378 
	gcmp
 = 1;

1379 
	gÃw_Šame
 = *
‹rm
;

1381 
	gŞd_Šame
 = 
‹rmli¡
.
g‘_‹rmÇme
();

1382 ià(
	g‹rm
 !ğ
docum’t
.
‹rmli¡_’d
()) {

1383 
Ãw_Šame
 = *
‹rm
;

1384 
	gcmp
 = 
Şd_Šame
.
com·»
(
Ãw_Šame
);

1386 
	gcmp
 = -1;

1390 ià(
	gcmp
 < 0) {

1392 
add_äeq_d–
(
Şd_Šame
, -1, -
‹rmli¡
.
g‘_wdf
());

1393 
	gpos™iÚ_bË
.
d–‘e_pos™iÚli¡
(
did
, 
Şd_Šame
);

1394 
upd©e_mod_¶i¡
(
did
, 
Şd_Šame
, 'D', 0u);

1395 
	g‹rmli¡
.
Ãxt
();

1396 } ià(
	gcmp
 > 0) {

1398 
‹rmcouÁ
 
	gÃw_wdf
 = 
‹rm
.
g‘_wdf
();

1399 ià(
	gÃw_Šame
.
size
(è> 
	gMAX_SAFE_TERM_LENGTH
)

1400 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("T”moØlÚg (> "
STRINGIZE
(
MAX_SAFE_TERM_LENGTH
)"): " + 
Ãw_Šame
);

1401 
add_äeq_d–
(
Ãw_Šame
, 1, 
Ãw_wdf
);

1402 
upd©e_mod_¶i¡
(
did
, 
Ãw_Šame
, 'A', 
Ãw_wdf
);

1403 
£t_pos™iÚli¡
(
pos™iÚ_bË
, 
did
, 
‹rm
);

1404 ++
	g‹rm
;

1407 
‹rmcouÁ
 
	gŞd_wdf
 = 
‹rmli¡
.
g‘_wdf
();

1408 
‹rmcouÁ
 
	gÃw_wdf
 = 
‹rm
.
g‘_wdf
();

1409 ià(
	gŞd_doş’
 !ğ
Ãw_doş’
 || 
Şd_wdf
 !ğ
Ãw_wdf
) {

1410 
add_äeq_d–
(
Ãw_Šame
, 0, 
Ãw_wdf
 - 
Şd_wdf
);

1411 
upd©e_mod_¶i¡
(
did
, 
Ãw_Šame
, 'M', 
Ãw_wdf
);

1414 ià(!
pos™iÚli¡s_equ®
(
‹rm
, 
‹rmli¡
))

1415 
£t_pos™iÚli¡
(
pos™iÚ_bË
, 
did
, 
‹rm
);

1417 
	g‹rmli¡
.
Ãxt
();

1418 ++
	g‹rm
;

1421 
LOGLINE
(
DB
, "C®cuÏ‹d doş’ fÜ„•Ïûm’ˆdocum’ˆ" << 
did
 << "‡ " << 
Ãw_doş’
);

1424 
	g‹rmli¡_bË
.
£t_‹rmli¡
(
did
, 
docum’t
, 
Ãw_doş’
);

1427 
	gdoş’s
[
did
] = 
Ãw_doş’
;

1428 
	gtÙ®_Ëngth
 +ğ
Ãw_doş’
;

1431 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
d©a_modif›d
()) {

1433 
	g»cÜd_bË
.
»¶aû_»cÜd
(
docum’t
.
g‘_d©a
(), 
did
);

1436 ià(!
	gmodifyšg
 || 
	gdocum’t
.
	gš‹º®
->
v®ues_modif›d
()) {

1440 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v®ue
 = 
docum’t
.
v®ues_begš
();

1441 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v®ue_’d
 = 
docum’t
.
v®ues_’d
();

1442 
¡ršg
 
	gs
;

1443 
	gv®ue_bË
.
’code_v®ues
(
s
, 
v®ue
, 
v®ue_’d
);

1446 
	gv®ue_bË
.
d–‘e_®l_v®ues
(
did
);

1447 
	gv®ue_bË
.
£t_’coded_v®ues
(
did
, 
s
);

1449 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
DocNÙFoundE¼Ü
 &) {

1450 ()
add_docum’t_
(
did
, 
docum’t
);

1452 } 
ÿtch
 (...) {

1457 
ÿnûl
();

1458 
	gthrow
;

1461 ià(++
	gchªge_couÁ
 >ğ
æush_th»shŞd
) {

1462 
æush_po¡li¡_chªges
();

1463 ià(!
Œª§ùiÚ_aùive
()è
­¶y
();

1467 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

1468 
FlštWr™abËD©aba£
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const

1470 
DEBUGCALL
(
DB
, 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 *, "FlintWritableDatabase::open_document",

1471 
did
 << ", " << 
Ïzy
);

1472 
	gmodify_shÜtcut_docum’t
 = 
FlštD©aba£
::
İ’_docum’t
(
did
, 
Ïzy
);

1475 
	gmodify_shÜtcut_docid
 = 
did
;

1476 
RETURN
(
modify_shÜtcut_docum’t
);

1479 
	gX­Ÿn
::
‹rmcouÁ


1480 
FlštWr™abËD©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

1482 
DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlštWr™abËD©aba£::g‘_doş’gth", 
did
);

1483 
	gm­
<
	gdocid
, 
	g‹rmcouÁ
>::
cÚ¡_™”©Ü
 
i
 = 
doş’s
.
fšd
(
did
);

1484 ià(
	gi
 !ğ
doş’s
.
’d
()è
RETURN
(
i
->
£cÚd
);

1486 
RETURN
(
FlštD©aba£
::
g‘_doş’gth
(
did
));

1489 
	gX­Ÿn
::
doccouÁ


1490 
FlštWr™abËD©aba£
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

1492 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "FlštWr™abËD©aba£::g‘_‹rmäeq", 
Šame
);

1493 
X­Ÿn
::
doccouÁ
 
‹rmäeq
 = 
FlštD©aba£
::
	`g‘_‹rmäeq
(
Šame
);

1494 
m­
<
¡ršg
, 
·œ
<
‹rmcouÁ_diff
,”mcouÁ_diff> >::
cÚ¡_™”©Ü
 
i
;

1495 
i
 = 
äeq_d–s
.
	`fšd
(
Šame
);

1496 ià(
i
 !ğ
äeq_d–s
.
	`’d
()è
‹rmäeq
 +ği->
£cÚd
.
fœ¡
;

1497 
	`RETURN
(
‹rmäeq
);

1498 
	}
}

1500 
	gX­Ÿn
::
‹rmcouÁ


1501 
FlštWr™abËD©aba£
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

1503 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlštWr™abËD©aba£::g‘_cŞËùiÚ_äeq", 
Šame
);

1504 
X­Ÿn
::
‹rmcouÁ
 
cŞläeq
 = 
FlštD©aba£
::
	`g‘_cŞËùiÚ_äeq
(
Šame
);

1506 
m­
<
¡ršg
, 
·œ
<
‹rmcouÁ_diff
,”mcouÁ_diff> >::
cÚ¡_™”©Ü
 
i
;

1507 
i
 = 
äeq_d–s
.
	`fšd
(
Šame
);

1508 ià(
i
 !ğ
äeq_d–s
.
	`’d
()è
cŞläeq
 +ği->
£cÚd
.second;

1510 
	`RETURN
(
cŞläeq
);

1511 
	}
}

1513 
boŞ


1514 
	gFlštWr™abËD©aba£
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const

1516 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštWr™abËD©aba£::‹rm_exi¡s", 
Šame
);

1517 
	`RETURN
(
	`g‘_‹rmäeq
(
Šame
) != 0);

1518 
	}
}

1520 
L—fPo¡Li¡
 *

1521 
	gFlštWr™abËD©aba£
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
& 
Šame
) const

1523 
	`DEBUGCALL
(
DB
, 
L—fPo¡Li¡
 *, "FlštWr™abËD©aba£::İ’_po¡_li¡", 
Šame
);

1524 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštWr™abËD©aba£
> 
	`±¹Ùhis
(
this
);

1526 ià(
Šame
.
	`em±y
()) {

1527 
X­Ÿn
::
doccouÁ
 doccouÁ = 
	`g‘_doccouÁ
();

1528 ià(
Ï¡docid
 =ğ
doccouÁ
) {

1529 
	`RETURN
(
Ãw
 
	`CÚtiguousAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

1531 
	`RETURN
(
Ãw
 
	`FlštAÎDocsPo¡Li¡
(
±¹Ùhis
, 
doccouÁ
));

1534 
m­
<
¡ršg
, m­<
docid
, 
·œ
<, 
‹rmcouÁ
> > >::
cÚ¡_™”©Ü
 
j
;

1535 
j
 = 
mod_¶i¡s
.
	`fšd
(
Šame
);

1536 ià(
j
 !ğ
mod_¶i¡s
.
	`’d
()) {

1539 
	`RETURN
(
Ãw
 
	`FlštModif›dPo¡Li¡
(
±¹Ùhis
, 
Šame
, 
j
->
£cÚd
));

1542 
	`RETURN
(
Ãw
 
	`FlštPo¡Li¡
(
±¹Ùhis
, 
Šame
));

1543 
	}
}

1545 
T”mLi¡
 *

1546 
	gFlštWr™abËD©aba£
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const

1548 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlintWritableDatabase::open_allterms", "");

1551 ià(
chªge_couÁ
è
	`æush_po¡li¡_chªges
();

1552 
	`RETURN
(
FlštD©aba£
::
	`İ’_®É”ms
(
´efix
));

1553 
	}
}

1556 
	gFlštWr™abËD©aba£
::
	$ÿnûl
()

1558 
FlštD©aba£
::
	`ÿnûl
();

1559 
	`»ad_m‘ašfo
();

1560 
äeq_d–s
.
	`ş—r
();

1561 
doş’s
.
	`ş—r
();

1562 
mod_¶i¡s
.
	`ş—r
();

1563 
chªge_couÁ
 = 0;

1564 
	}
}

1567 
	gFlštWr™abËD©aba£
::
add_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
,

1568 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const

1570 
¥–lšg_bË
.
add_wÜd
(
wÜd
, 
äeqšc
);

1574 
	gFlštWr™abËD©aba£
::
»move_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
,

1575 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const

1577 
¥–lšg_bË
.
»move_wÜd
(
wÜd
, 
äeqdec
);

1580 
T”mLi¡
 *

1581 
	gFlštWr™abËD©aba£
::
	$İ’_¥–lšg_wÜdli¡
() const

1583 
¥–lšg_bË
.
	`m”ge_chªges
();

1584  
FlštD©aba£
::
	`İ’_¥–lšg_wÜdli¡
();

1585 
	}
}

1587 
T”mLi¡
 *

1588 
	gFlštWr™abËD©aba£
::
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const

1590 
synÚym_bË
.
	`m”ge_chªges
();

1591  
FlštD©aba£
::
	`İ’_synÚym_keyli¡
(
´efix
);

1592 
	}
}

1595 
	gFlštWr™abËD©aba£
::
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
,

1596 cÚ¡ 
¡ršg
 & 
synÚym
) const

1598 
synÚym_bË
.
	`add_synÚym
(
‹rm
, 
synÚym
);

1599 
	}
}

1602 
	gFlštWr™abËD©aba£
::
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
,

1603 cÚ¡ 
¡ršg
 & 
synÚym
) const

1605 
synÚym_bË
.
	`»move_synÚym
(
‹rm
, 
synÚym
);

1606 
	}
}

1609 
	gFlštWr™abËD©aba£
::
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
‹rm
) const

1611 
synÚym_bË
.
	`ş—r_synÚyms
(
‹rm
);

1612 
	}
}

1615 
	gFlštWr™abËD©aba£
::
	$£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
)

1617 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintWritableDatabase::set_metadata",

1618 
key
 << ", " << 
v®ue
);

1619 
¡ršg
 
	`bŒ“_key
("\x00\xc0", 2);

1620 
bŒ“_key
 +ğ
key
;

1621 ià(
v®ue
.
	`em±y
()) {

1622 
po¡li¡_bË
.
	`d–
(
bŒ“_key
);

1624 
po¡li¡_bË
.
	`add
(
bŒ“_key
, 
v®ue
);

1626 
	}
}

1629 
	gFlštWr™abËD©aba£
::
šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const

1631 ià(
obj
 =ğ
modify_shÜtcut_docum’t
) {

1632 
modify_shÜtcut_docum’t
 = 
NULL
;

1633 
	gmodify_shÜtcut_docid
 = 0;

	@backends/flint/flint_database.h

24 #iâdeà
OM_HGUARD_FLINT_DATABASE_H


25 
	#OM_HGUARD_FLINT_DATABASE_H


	)

27 
	~"d©aba£.h
"

28 
	~"æšt_pos™iÚli¡.h
"

29 
	~"æšt_po¡li¡.h
"

30 
	~"æšt_»cÜd.h
"

31 
	~"æšt_¥–lšg.h
"

32 
	~"æšt_synÚym.h
"

33 
	~"æšt_‹rmli¡bË.h
"

34 
	~"æšt_v®ues.h
"

35 
	~"æšt_v”siÚ.h
"

36 
	~"../æšt_lock.h
"

38 
	~"æšt_ty³s.h
"

40 
	~<m­
>

42 
şass
 
	gFlštT”mLi¡
;

43 
şass
 
	gFlštAÎDocsPo¡Li¡
;

44 
şass
 
	gRemÙeCÚÃùiÚ
;

45 
şass
 
	gOmTime
;

50 şas 
	cFlštD©aba£
 : 
public
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 {

51 
ä›nd
 
şass
 
FlštWr™abËD©aba£
;

52 
ä›nd
 
şass
 
	mFlštT”mLi¡
;

53 
ä›nd
 
şass
 
	mFlštPo¡Li¡
;

54 
ä›nd
 
şass
 
	mFlštAÎT”msLi¡
;

55 
ä›nd
 
şass
 
	mFlštAÎDocsPo¡Li¡
;

56 
	m´iv©e
:

59 
¡d
::
¡ršg
 
db_dœ
;

63 
boŞ
 
	m»adÚly
;

69 
FlštV”siÚ
 
	mv”siÚ_fe
;

77 
mubË
 
FlštPo¡Li¡TabË
 
	mpo¡li¡_bË
;

81 
FlštPos™iÚLi¡TabË
 
	mpos™iÚ_bË
;

85 
FlštT”mLi¡TabË
 
	m‹rmli¡_bË
;

89 
FlštV®ueTabË
 
	mv®ue_bË
;

93 
mubË
 
FlštSynÚymTabË
 
	msynÚym_bË
;

97 
mubË
 
FlštS³ÎšgTabË
 
	m¥–lšg_bË
;

107 
FlštRecÜdTabË
 
	m»cÜd_bË
;

110 
FlštLock
 
	mlock
;

113 
mubË
 
tÙËn_t
 
	mtÙ®_Ëngth
;

116 
mubË
 
	mX­Ÿn
::
docid
 
Ï¡docid
;

120 
	mmax_chªge£ts
;

123 
»ad_m‘ašfo
();

128 
boŞ
 
d©aba£_exi¡s
();

133 
ü—‹_ªd_İ’_bËs
(
blocksize
);

140 
İ’_bËs_cÚsi¡’t
();

149 
g‘_d©aba£_wr™e_lock
(
boŞ
 
ü—tšg
);

156 
İ’_bËs
(
æšt_»visiÚ_numb”_t
 
»visiÚ
);

163 
æšt_»visiÚ_numb”_t
 
	$g‘_»visiÚ_numb”
() const;

170 
æšt_»visiÚ_numb”_t
 
	$g‘_Ãxt_»visiÚ_numb”
() const;

182 
	`£t_»visiÚ_numb”
(
æšt_»visiÚ_numb”_t
 
Ãw_»visiÚ
);

187 
	`»İ’
();

191 
	`şo£
();

198 
	`modifiÿtiÚs_çed
(
æšt_»visiÚ_numb”_t
 
Şd_»visiÚ
,

199 
æšt_»visiÚ_numb”_t
 
Ãw_»visiÚ
,

200 cÚ¡ 
¡d
::
¡ršg
 & 
msg
);

210 
	`­¶y
();

214 
	`ÿnûl
();

218 
	`£nd_whŞe_d©aba£
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

219 cÚ¡ 
OmTime
 & 
’d_time
);

223 
	$g‘_chªge£t_»visiÚs
(cÚ¡ 
¡ršg
 & 
·th
,

224 
æšt_»visiÚ_numb”_t
 * 
¡¬Œev
,

225 
æšt_»visiÚ_numb”_t
 * 
’d»v
) const;

226 
public
:

246 
	`FlštD©aba£
(cÚ¡ 
¡ršg
 &
db_dœ_
, 
aùiÚ
 = 
XAPIAN_DB_READONLY
,

247 
block_size
 = 0u);

249 ~
	`FlštD©aba£
();

253 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

254 
X­Ÿn
::
docid
 
	$g‘_Ï¡docid
() const;

255 
tÙËn_t
 
	$g‘_tÙ®_Ëngth
() const;

256 
X­Ÿn
::
doş’gth
 
	$g‘_avËngth
() const;

257 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

258 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

259 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

260 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

261 
boŞ
 
	$has_pos™iÚs
() const;

263 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

264 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`İ’_docum’t
(X­Ÿn::
docid
 
did
, 
boŞ
 
Ïzy
) const;

266 
Pos™iÚLi¡
 * 
	`İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
‹rm
) const;

267 
T”mLi¡
 * 
	`İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const;

268 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

270 
T”mLi¡
 * 
	$İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

271 
T”mLi¡
 * 
	$İ’_¥–lšg_wÜdli¡
() const;

272 
X­Ÿn
::
doccouÁ
 
	$g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

274 
T”mLi¡
 * 
	$İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

275 
T”mLi¡
 * 
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const;

277 
¡ršg
 
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const;

278 
T”mLi¡
 * 
	`İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const;

279 
	`wr™e_chªge£ts_to_fd
(
fd
,

280 cÚ¡ 
¡ršg
 & 
¡¬t_»visiÚ
,

281 
boŞ
 
Ãed_whŞe_db
,

282 
X­Ÿn
::
R•liÿtiÚInfo
 * 
šfo
);

283 
¡ršg
 
	$g‘_»visiÚ_šfo
() const;

284 
¡ršg
 
	$g‘_uuid
() const;

291 şas 
	cFlštWr™abËD©aba£
 : 
public
 
FlštD©aba£
 {

293 
mubË
 
m­
<
¡ršg
, 
·œ
<
X­Ÿn
::
‹rmcouÁ_diff
, Xapian::termcount_diff> >

294 
äeq_d–s
;

297 
mubË
 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> 
doş’s
;

300 
mubË
 
m­
<
¡ršg
, m­<
X­Ÿn
::
docid
,

301 
·œ
<, 
X­Ÿn
::
‹rmcouÁ
> > > 
mod_¶i¡s
;

306 
mubË
 
X­Ÿn
::
doccouÁ
 
chªge_couÁ
;

309 
X­Ÿn
::
doccouÁ
 
æush_th»shŞd
;

317 
mubË
 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
modify_shÜtcut_docum’t
;

321 
mubË
 
X­Ÿn
::
docid
 
modify_shÜtcut_docid
;

324 
	$æush_po¡li¡_chªges
() const;

327 
	`şo£
();

335 
	`add_äeq_d–
(cÚ¡ 
¡ršg
 & 
Šame
,

336 
X­Ÿn
::
‹rmcouÁ_diff
 
tf_d–
,

337 
X­Ÿn
::
‹rmcouÁ_diff
 
cf_d–
);

345 
	`š£¹_mod_¶i¡
(
X­Ÿn
::
docid
 
did
,

346 cÚ¡ 
¡ršg
 & 
Šame
,

347 
X­Ÿn
::
‹rmcouÁ
 
wdf
);

360 
	`upd©e_mod_¶i¡
(
X­Ÿn
::
docid
 
did
,

361 cÚ¡ 
¡ršg
 & 
Šame
,

362 
ty³
,

363 
X­Ÿn
::
‹rmcouÁ
 
wdf
);

369 
	`comm™
();

372 
	`ÿnûl
();

374 
X­Ÿn
::
docid
 
	`add_docum’t
(cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

375 
X­Ÿn
::
docid
 
	`add_docum’t_
(X­Ÿn::docid 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

381 #iâdeà
_MSC_VER


382 
usšg
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
::
d–‘e_docum’t
;

383 
usšg
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
::
»¶aû_docum’t
;

385 
	`d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
);

386 
	`»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

388 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`İ’_docum’t
(X­Ÿn::
docid
 
did
,

389 
boŞ
 
Ïzy
 = 
çl£
) const;

393 
public
:

405 
	`FlštWr™abËD©aba£
(cÚ¡ 
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
);

407 ~
	`FlštWr™abËD©aba£
();

411 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

412 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

413 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

414 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

416 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

417 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

419 
	`add_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const;

420 
	`»move_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const;

421 
T”mLi¡
 * 
	$İ’_¥–lšg_wÜdli¡
() const;

423 
T”mLi¡
 * 
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const;

424 
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
wÜd
, cÚ¡ sŒšg & 
synÚym
) const;

425 
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
wÜd
, cÚ¡ sŒšg & 
synÚym
) const;

426 
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

428 
	`£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
);

429 
	`šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const;

	@backends/flint/flint_databasereplicator.cc

23 
	~<cÚfig.h
>

25 
	~"æšt_d©aba£»¶iÿtÜ.h
"

27 
	~"x­Ÿn/”rÜ.h
"

29 
	~"æšt_io.h
"

30 
	~"../æšt_lock.h
"

31 
	~"æšt_»cÜd.h
"

32 
	~"æšt_»¶iÿ‹_š‹º®.h
"

33 
	~"æšt_ty³s.h
"

34 
	~"æšt_uts.h
"

35 
	~"æšt_v”siÚ.h
"

36 
	~"omdebug.h
"

37 
	~"omtime.h
"

38 
	~"»mÙecÚÃùiÚ.h
"

39 
	~"»¶iÿtiÚ´ÙocŞ.h
"

40 
	~"§ã”ºo.h
"

41 
	~"¡ršguts.h
"

42 
	~"uts.h
"

44 #ifdeà
__WIN32__


45 
	~"msvc_posix_w¿µ”.h
"

48 
	~<c¡dio
>

50 
usšg
 
Çme¥aû
 
	g¡d
;

51 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

53 
	gFlštD©aba£R•liÿtÜ
::
	$FlštD©aba£R•liÿtÜ
(cÚ¡ 
¡ršg
 & 
db_dœ_
)

54 : 
	$db_dœ
(
db_dœ_
)

56 
	}
}

58 
boŞ


59 
FlštD©aba£R•liÿtÜ
::
	$check_»visiÚ_©_Ëa¡
(cÚ¡ 
¡ršg
 & 
»v
,

60 cÚ¡ 
¡ršg
 & 
rg‘
) const

62 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintDatabaseReplicator::check_revision_at_least",

63 
»v
 << ", " << 
rg‘
);

65 
æšt_»visiÚ_numb”_t
 
»v_v®
;

66 
æšt_»visiÚ_numb”_t
 
rg‘_v®
;

68 cÚ¡ * 
±r
 = 
»v
.
	`d©a
();

69 cÚ¡ * 
’d
 = 
±r
 + 
»v
.
	`size
();

70 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
»v_v®
)) {

71 
throw
 
	`N‘wÜkE¼Ü
("Invalid„evision string suppliedo check_revision_at_least");

74 
±r
 = 
rg‘
.
	`d©a
();

75 
’d
 = 
±r
 + 
rg‘
.
	`size
();

76 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
rg‘_v®
)) {

77 
throw
 
	`N‘wÜkE¼Ü
("Invalid„evision string suppliedo check_revision_at_least");

80 
	`RETURN
(
»v_v®
 >ğ
rg‘_v®
);

81 
	}
}

84 
	gFlštD©aba£R•liÿtÜ
::
	$´oûss_chªge£t_chunk_ba£
(cÚ¡ 
¡ršg
 & 
bËÇme
,

85 
¡ršg
 & 
buf
,

86 
RemÙeCÚÃùiÚ
 & 
cÚn
,

87 cÚ¡ 
OmTime
 & 
’d_time
) const

89 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

90 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

93 
Ë‰”
 = 
±r
[0];

94 ià(
Ë‰”
 != 'A' &&†etter != 'B')

95 
throw
 
	`N‘wÜkE¼Ü
("Invalid base file†etter in changeset");

96 ++
±r
;

100 ià(
±r
 =ğ
’d
)

101 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (5)");

102 
¡ršg
::
size_ty³
 
ba£_size
;

103 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
ba£_size
))

104 
throw
 
	`N‘wÜkE¼Ü
("Invalid base file size in changeset");

107 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

108 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
ba£_size
, 
’d_time
);

110 ià(
buf
.
	`size
(è< 
ba£_size
)

111 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (6)");

114 
¡ršg
 
tmp_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + "tmp";

115 
¡ršg
 
ba£_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + ".ba£" + 
Ë‰”
;

116 #ifdeà
__WIN32__


117 
fd
 = 
	`msvc_posix_İ’
(
tmp_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
);

119 
fd
 = ::
	`İ’
(
tmp_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
 | 
O_BINARY
, 0666);

121 ià(
fd
 == -1) {

122 
¡ršg
 
msg
 = "Failedo open ";

123 
msg
 +ğ
tmp_·th
;

124 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

127 
fdşo£r
 
	`şo£r
(
fd
);

129 
	`æšt_io_wr™e
(
fd
, 
buf
.
	`d©a
(), 
ba£_size
);

130 
	`æšt_io_sync
(
fd
);

132 #ià
defšed
 
__WIN32__


133 ià(
	`msvc_posix_»Çme
(
tmp_·th
.
	`c_¡r
(), 
ba£_·th
.c_str()) < 0) {

135 ià(
	`»Çme
(
tmp_·th
.
	`c_¡r
(), 
ba£_·th
.c_str()) < 0) {

142 
§ved_”ºo
 = 
”ºo
;

143 ià(
	`uÆšk
(
tmp_·th
è=ğ0 || 
”ºo
 !ğ
ENOENT
) {

144 
¡ršg
 
	`msg
("Couldn't update base file ");

145 
msg
 +ğ
bËÇme
;

146 
msg
 += ".base";

147 
msg
 +ğ
Ë‰”
;

148 
throw
 
	`D©aba£E¼Ü
(
msg
, 
§ved_”ºo
);

152 
buf
.
	`”a£
(0, 
ba£_size
);

153 
	}
}

156 
	gFlštD©aba£R•liÿtÜ
::
	$´oûss_chªge£t_chunk_blocks
(cÚ¡ 
¡ršg
 & 
bËÇme
,

157 
¡ršg
 & 
buf
,

158 
RemÙeCÚÃùiÚ
 & 
cÚn
,

159 cÚ¡ 
OmTime
 & 
’d_time
) const

161 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

162 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

164 
chªge£t_blocksize
;

165 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
chªge£t_blocksize
))

166 
throw
 
	`N‘wÜkE¼Ü
("Invalid blocksize in changeset");

167 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

169 
¡ršg
 
db_·th
 = 
db_dœ
 + "/" + 
bËÇme
 + ".DB";

170 #ifdeà
__WIN32__


171 
fd
 = 
	`msvc_posix_İ’
(
db_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_BINARY
);

173 
fd
 = ::
	`İ’
(
db_·th
.
	`c_¡r
(), 
O_WRONLY
 | 
O_BINARY
, 0666);

175 ià(
fd
 == -1) {

176 
¡ršg
 
msg
 = "Failedo open ";

177 
msg
 +ğ
db_·th
;

178 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

181 
fdşo£r
 
	`şo£r
(
fd
);

183 
Œue
) {

184 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

185 
±r
 = 
buf
.
	`d©a
();

186 
’d
 = 
±r
 + 
buf
.
	`size
();

188 
ušt4
 
block_numb”
;

189 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
block_numb”
))

190 
throw
 
	`N‘wÜkE¼Ü
("Invalid block‚umber in changeset");

191 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

192 ià(
block_numb”
 == 0)

194 --
block_numb”
;

196 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
chªge£t_blocksize
, 
’d_time
);

197 ià(
buf
.
	`size
(è< 
chªge£t_blocksize
)

198 
throw
 
	`N‘wÜkE¼Ü
("Incomplete block in changeset");

202 ià(
	`l£ek
(
fd
, 
	`off_t
(
chªge£t_blocksize
è* 
block_numb”
, 
SEEK_SET
) == -1) {

203 
¡ršg
 
msg
 = "Failedo seeko block ";

204 
msg
 +ğ
	`om_to¡ršg
(
block_numb”
);

205 
throw
 
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

207 
	`æšt_io_wr™e
(
fd
, 
buf
.
	`d©a
(), 
chªge£t_blocksize
);

209 
buf
.
	`”a£
(0, 
chªge£t_blocksize
);

211 
	`æšt_io_sync
(
fd
);

213 
	}
}

215 
¡ršg


216 
	gFlštD©aba£R•liÿtÜ
::
	$­¶y_chªge£t_äom_cÚn
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

217 cÚ¡ 
OmTime
 & 
’d_time
,

218 
boŞ
 
v®id
) const

220 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintDatabaseReplicator::apply_changeset_from_conn",

221 "cÚn,ƒnd_time, " << 
v®id
);

224 
FlštLock
 
	`lock
(
db_dœ
);

225 
¡ršg
 
ex¶ª©iÚ
;

226 
FlštLock
::
»asÚ
 
why
 = 
lock
.
	`lock
(
Œue
, 
ex¶ª©iÚ
);

227 ià(
why
 !ğ
FlštLock
::
SUCCESS
) {

228 
lock
.
	`throw_d©aba£lock”rÜ
(
why
, 
db_dœ
, 
ex¶ª©iÚ
);

231 
ty³
 = 
cÚn
.
	`g‘_mes§ge_chunked
(
’d_time
);

232 (è
ty³
;

233 
	`As£¹Eq
(
ty³
, 
REPL_REPLY_CHANGESET
);

235 
¡ršg
 
buf
;

239 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

241 ià(!
	`¡¬tsw™h
(
buf
, 
CHANGES_MAGIC_STRING
)) {

242 
throw
 
	`N‘wÜkE¼Ü
("Invalid ChangeSet magic string");

244 
buf
.
	`”a£
(0, 12);

245 cÚ¡ *
±r
 = 
buf
.
	`d©a
();

246 cÚ¡ *
’d
 = 
±r
 + 
buf
.
	`size
();

248 
chªges_v”siÚ
;

249 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
chªges_v”siÚ
))

250 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid version‚umber from changeset");

251 ià(
chªges_v”siÚ
 !ğ
CHANGES_VERSION
)

252 
throw
 
	`N‘wÜkE¼Ü
("Unsupported changeset version");

254 
æšt_»visiÚ_numb”_t
 
¡¬Œev
;

255 
æšt_»visiÚ_numb”_t
 
’d»v
;

257 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
¡¬Œev
))

258 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid start„evision from changeset");

259 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
’d»v
))

260 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ validƒnd„evision from changeset");

262 ià(
’d»v
 <ğ
¡¬Œev
)

263 
throw
 
	`N‘wÜkE¼Ü
("End„evision in changeset is‚ot†aterhan start„evision");

265 ià(
±r
 =ğ
’d
)

266 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (1)");

268 ià(
v®id
) {

273 
FlštRecÜdTabË
 
	`»cÜd_bË
(
db_dœ
, 
Œue
);

274 
»cÜd_bË
.
	`İ’
();

275 ià(
¡¬Œev
 !ğ
»cÜd_bË
.
	`g‘_İ’_»visiÚ_numb”
())

276 
throw
 
	`N‘wÜkE¼Ü
("Changeset supplied is for wrong„evision‚umber");

279 
chªges_ty³
 = 
±r
[0];

280 ià(
chªges_ty³
 != 0) {

281 
throw
 
	`N‘wÜkE¼Ü
("Unsupported changesetype (got %d)",

282 
chªges_ty³
);

288 
buf
.
	`”a£
(0, 
±r
 + 1 - buf.
	`d©a
());

291 
Œue
) {

292 
cÚn
.
	`g‘_mes§ge_chunk
(
buf
, 
REASONABLE_CHANGESET_SIZE
, 
’d_time
);

293 
±r
 = 
buf
.
	`d©a
();

294 
’d
 = 
±r
 + 
buf
.
	`size
();

297 ià(
±r
 =ğ
’d
)

298 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (2)");

299 
chunk_ty³
 = 
±r
[0];

300 ++
±r
;

301 ià(
chunk_ty³
 == 0)

305 
¡ršg
 
bËÇme
;

306 ià(!
	`F_uÅack_¡ršg
(&
±r
, 
’d
, 
bËÇme
))

307 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (3)");

308 ià(
bËÇme
.
	`em±y
())

309 
throw
 
	`N‘wÜkE¼Ü
("Missingablename in changeset");

310 ià(
bËÇme
.
	`fšd_fœ¡_nÙ_of
("abcdefghijklmnopqrstuvwxyz") !=

311 
bËÇme
.
Åos
)

312 
throw
 
	`N‘wÜkE¼Ü
("Invalid character inablename in changeset");

315 ià(
±r
 =ğ
’d
)

316 
throw
 
	`N‘wÜkE¼Ü
("Unexpectedƒnd of changeset (4)");

317 
buf
.
	`”a£
(0, 
±r
 - buf.
	`d©a
());

319 
chunk_ty³
) {

321 
	`´oûss_chªge£t_chunk_ba£
(
bËÇme
, 
buf
, 
cÚn
, 
’d_time
);

324 
	`´oûss_chªge£t_chunk_blocks
(
bËÇme
, 
buf
, 
cÚn
, 
’d_time
);

327 
throw
 
	`N‘wÜkE¼Ü
("Unrecognised itemype in changeset");

330 
æšt_»visiÚ_numb”_t
 
»q»v
;

331 ià(!
	`F_uÅack_ušt
(&
±r
, 
’d
, &
»q»v
))

332 
throw
 
	`N‘wÜkE¼Ü
("Couldn't„ead‡ valid„equired„evision from changeset");

333 ià(
»q»v
 < 
’d»v
)

334 
throw
 
	`N‘wÜkE¼Ü
("Required„evision in changeset isƒarlierhanƒnd„evision");

335 ià(
±r
 !ğ
’d
)

336 
throw
 
	`N‘wÜkE¼Ü
("Junk found‡tƒnd of changeset");

338 
buf
 = 
	`F_·ck_ušt
(
»q»v
);

339 
	`RETURN
(
buf
);

340 
	}
}

342 
¡ršg


343 
	gFlštD©aba£R•liÿtÜ
::
	$g‘_uuid
() const

345 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintDatabaseReplicator::get_uuid", "");

346 
FlštV”siÚ
 
	`v”siÚ_fe
(
db_dœ
);

347 
Œy
 {

348 
v”siÚ_fe
.
	`»ad_ªd_check
(
Œue
);

349 } 
	`ÿtch
 (cÚ¡ 
D©aba£E¼Ü
 &) {

350 
	`RETURN
(
	`¡ršg
());

352 
	`RETURN
(
v”siÚ_fe
.
	`g‘_uuid_¡ršg
());

353 
	}
}

	@backends/flint/flint_databasereplicator.h

22 #iâdeà
XAPIAN_INCLUDED_FLINT_DATABASEREPLICATOR_H


23 
	#XAPIAN_INCLUDED_FLINT_DATABASEREPLICATOR_H


	)

25 
	~"d©aba£»¶iÿtÜ.h
"

27 şas 
	cFlštD©aba£R•liÿtÜ
 : 
public
 
X­Ÿn
::
D©aba£R•liÿtÜ
 {

28 
´iv©e
:

31 
¡d
::
¡ršg
 
db_dœ
;

35 
´oûss_chªge£t_chunk_ba£
(cÚ¡ 
¡d
::
¡ršg
 & 
bËÇme
,

36 
¡d
::
¡ršg
 & 
buf
,

37 
RemÙeCÚÃùiÚ
 & 
cÚn
,

38 cÚ¡ 
OmTime
 & 
’d_time
) const;

43 
´oûss_chªge£t_chunk_blocks
(cÚ¡ 
¡d
::
¡ršg
 & 
bËÇme
,

44 
¡d
::
¡ršg
 & 
buf
,

45 
RemÙeCÚÃùiÚ
 & 
cÚn
,

46 cÚ¡ 
OmTime
 & 
’d_time
) const;

48 
	mpublic
:

49 
FlštD©aba£R•liÿtÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
db_dœ_
);

53 
boŞ
 
check_»visiÚ_©_Ëa¡
(cÚ¡ 
¡d
::
¡ršg
 & 
»v
,

54 cÚ¡ 
¡d
::
¡ršg
 & 
rg‘
) const;

55 
	m¡d
::
¡ršg
 
	$­¶y_chªge£t_äom_cÚn
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

56 cÚ¡ 
OmTime
 & 
’d_time
,

57 
boŞ
 
v®id
) const;

58 
¡d
::
¡ršg
 
	$g‘_uuid
() const;

	@backends/flint/flint_document.cc

23 
	~<cÚfig.h
>

24 
	~"omdebug.h
"

25 
	~"æšt_d©aba£.h
"

26 
	~"æšt_docum’t.h
"

27 
	~"æšt_v®ues.h
"

28 
	~"æšt_»cÜd.h
"

33 
	gFlštDocum’t
::
FlštDocum’t
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

34 cÚ¡ 
FlštV®ueTabË
 *
v®ue_bË_
,

35 cÚ¡ 
FlštRecÜdTabË
 *
»cÜd_bË_
,

36 
X­Ÿn
::
docid
 
did_
, 
boŞ
 
Ïzy
)

37 : 
X­Ÿn
::
Docum’t
::
IÁ”Çl
(
d©aba£_
.
g‘
(), 
did_
),

38 
d©aba£
(
d©aba£_
),

39 
v®ue_bË
(
v®ue_bË_
),

40 
	$»cÜd_bË
(
»cÜd_bË_
)

42 
	`DEBUGCALL
(
DB
, , "FlštDocum’t", "[d©aba£_], " << 
v®ue_bË_
 << ", " << 
»cÜd_bË_
 << ", " << 
did_
 << ", " << 
Ïzy
);

45 ià(!
Ïzy
è()
»cÜd_bË
->
	`g‘_»cÜd
(
did
);

46 
	}
}

52 
¡ršg


53 
	gFlštDocum’t
::
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
v®ueid
) const

55 
DEBUGCALL
(
DB
, 
¡ršg
, "FlštDocum’t::do_g‘_v®ue", 
v®ueid
);

56 
¡ršg
 
	g»tv®
;

57 
	gv®ue_bË
->
g‘_v®ue
(
»tv®
, 
did
, 
v®ueid
);

58 
RETURN
(
»tv®
);

64 
	gFlštDocum’t
::
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const

66 
DEBUGCALL
(
DB
, , "FlintDocument::do_get_all_values", "[values_]");

67 
	gv®ue_bË
->
g‘_®l_v®ues
(
v®ues_
, 
did
);

72 
¡ršg


73 
	gFlštDocum’t
::
	$do_g‘_d©a
() const

75 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintDocument::do_get_data", "");

76 
	`RETURN
(
»cÜd_bË
->
	`g‘_»cÜd
(
did
));

77 
	}
}

	@backends/flint/flint_document.h

23 #iâdeà
OM_HGUARD_FLINT_DOCUMENT_H


24 
	#OM_HGUARD_FLINT_DOCUMENT_H


	)

26 
	~<x­Ÿn/ba£.h
>

27 
	~"docum’t.h
"

29 
şass
 
	gFlštD©aba£
;

32 şas 
	cFlštDocum’t
 : 
public
 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 {

33 
ä›nd
 
şass
 
FlštD©aba£
;

34 
ä›nd
 
şass
 
	mFlštWr™abËD©aba£
;

35 
	m´iv©e
:

36 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£
;

38 cÚ¡ 
FlštV®ueTabË
 *
	mv®ue_bË
;

39 cÚ¡ 
FlštRecÜdTabË
 *
	m»cÜd_bË
;

41 
FlštDocum’t
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

42 cÚ¡ 
FlštV®ueTabË
 *
v®ue_bË_
,

43 cÚ¡ 
FlštRecÜdTabË
 *
»cÜd_bË_
,

44 
X­Ÿn
::
docid
 
did_
, 
boŞ
 
Ïzy
);

47 
FlštDocum’t
(const FlintDocument &);

48 
	mFlštDocum’t
 & 
	mİ”©Ü
 = (cÚ¡ 
FlštDocum’t
 &);

49 
	mpublic
:

50 
¡ršg
 
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
v®ueid
) const;

51 
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const;

52 
¡ršg
 
	$do_g‘_d©a
() const;

	@backends/flint/flint_io.cc

21 
	~<cÚfig.h
>

23 
	~"§ã”ºo.h
"

24 
	~"§ãuni¡d.h
"

26 
	~<x­Ÿn/”rÜ.h
>

28 
	~"æšt_io.h
"

30 
size_t
 
	$æšt_io_»ad
(
fd
, * 
p
, 
size_t
 
n
, size_ˆ
mš
)

32 
size_t
 
tÙ®
 = 0;

33 
n
) {

34 
ssize_t
 
c
 = 
	`»ad
(
fd
, 
p
, 
n
);

35 ià(
c
 <= 0) {

36 ià(
c
 == 0) {

37 ià(
tÙ®
 >ğ
mš
) ;

38 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn't„eadƒnough (EOF)");

40 ià(
”ºo
 =ğ
EINTR
) ;

41 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("E¼Ü„—dšg from fe", 
”ºo
);

43 
p
 +ğ
c
;

44 
tÙ®
 +ğ
c
;

45 
n
 -ğ
c
;

47  
tÙ®
;

48 
	}
}

51 
	$æšt_io_wr™e
(
fd
, cÚ¡ * 
p
, 
size_t
 
n
)

53 
n
) {

54 
ssize_t
 
c
 = 
	`wr™e
(
fd
, 
p
, 
n
);

55 ià(
c
 < 0) {

56 ià(
”ºo
 =ğ
EINTR
) ;

57 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("E¼Ü wr™šgØfe", 
”ºo
);

59 
p
 +ğ
c
;

60 
n
 -ğ
c
;

62 
	}
}

	@backends/flint/flint_io.h

21 #iâdeà
XAPIAN_INCLUDED_FLINT_IO_H


22 
	#XAPIAN_INCLUDED_FLINT_IO_H


	)

24 
	~<sys/ty³s.h
>

25 
	~"§ãfú.h
"

26 
	~"§ãuni¡d.h
"

33 
šlše
 
boŞ
 
	$æšt_io_sync
(
fd
)

35 #ifdeà
F_FULLFSYNC


46 ià(
	`fú
(
fd
, 
F_FULLFSYNC
, 0) == 0)

47  
Œue
;

50 #ià
defšed
 
HAVE_FDATASYNC


53  
	`fd©async
(
fd
) == 0;

54 #–ià
defšed
 
HAVE_FSYNC


55  
	`fsync
(
fd
) == 0;

56 #–ià
defšed
 
__WIN32__


57  
	`_comm™
(
fd
) == 0;

59 #”rÜ 
CªnÙ
 
im¶em’t
 
	`æšt_io_sync
(è
w™hout
 
	`fd©async
(), 
	`fsync
(), 
Ü
 
	`_comm™
()

61 
	}
}

70 
size_t
 
æšt_io_»ad
(
fd
, * 
p
, size_ˆ
n
, size_ˆ
mš
);

73 
æšt_io_wr™e
(
fd
, cÚ¡ * 
p
, 
size_t
 
n
);

	@backends/flint/flint_metadata.cc

22 
	~<cÚfig.h
>

23 
	~"æšt_m‘ad©a.h
"

25 
	~"d©aba£.h
"

26 
	~"omas£¹.h
"

27 
	~"¡ršguts.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
	gFlštM‘ad©aT”mLi¡
::
FlštM‘ad©aT”mLi¡
(

32 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

33 
FlštCursÜ
 * 
cursÜ_
,

34 cÚ¡ 
¡ršg
 &
´efix_
)

35 : 
d©aba£
(
d©aba£_
), 
cursÜ
(
cursÜ_
), 
´efix
(
¡ršg
("\x00\xc0", 2è+ 
´efix_
)

37 
DEBUGCALL
(
DB
, , "FlintMetadataTermList", "<database>, <cursor>");

38 
As£¹
(
cursÜ
);

40 
	gcursÜ
->
fšd_’Œy_É
(
´efix
);

43 
	gFlštM‘ad©aT”mLi¡
::~
	$FlštM‘ad©aT”mLi¡
()

45 
	`DEBUGCALL
(
DB
, , "~FlintMetadataTermList", "");

46 
d–‘e
 
cursÜ
;

47 
	}
}

49 
¡ršg


50 
	gFlštM‘ad©aT”mLi¡
::
	$g‘_‹rmÇme
() const

52 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintMetadataTermList::get_termname", "");

53 
	`As£¹
(!
	`©_’d
());

54 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

55 
	`As£¹
(
	`¡¬tsw™h
(
cursÜ
->
cu¼’t_key
, 
´efix
));

56 
	`RETURN
(
cursÜ
->
cu¼’t_key
.
	`sub¡r
(2));

57 
	}
}

59 
	gX­Ÿn
::
doccouÁ


60 
FlštM‘ad©aT”mLi¡
::
	$g‘_‹rmäeq
() const

62 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("FlintMetadataTermList::get_termfreq()‚ot meaningful");

63 
	}
}

65 
	gX­Ÿn
::
‹rmcouÁ


66 
FlštM‘ad©aT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

68 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("FlintMetadataTermList::get_collection_freq()‚ot meaningful");

69 
	}
}

71 
T”mLi¡
 *

72 
	gFlštM‘ad©aT”mLi¡
::
	$Ãxt
()

74 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlintMetadataTermList::next", "");

75 
	`As£¹
(!
	`©_’d
());

77 
cursÜ
->
	`Ãxt
();

78 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

80 
cursÜ
->
	`to_’d
();

83 
	`RETURN
(
NULL
);

84 
	}
}

86 
T”mLi¡
 *

87 
	gFlštM‘ad©aT”mLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
key
)

89 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlštM‘ad©aT”mLi¡::sk_to", 
key
);

90 
	`As£¹
(!
	`©_’d
());

92 ià(!
cursÜ
->
	`fšd_’Œy_ge
(
	`¡ršg
("\x00\xc0", 2è+ 
key
)) {

95 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

97 
cursÜ
->
	`to_’d
();

100 
	`RETURN
(
NULL
);

101 
	}
}

103 
boŞ


104 
	gFlštM‘ad©aT”mLi¡
::
	$©_’d
() const

106 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintMetadataTermList::at_end", "");

107 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

108 
	}
}

	@backends/flint/flint_metadata.h

22 #iâdeà
XAPIAN_INCLUDED_FLINT_METADATA_H


23 
	#XAPIAN_INCLUDED_FLINT_METADATA_H


	)

25 
	~<x­Ÿn/ba£.h
>

26 
	~<x­Ÿn/d©aba£.h
>

27 
	~<x­Ÿn/ty³s.h
>

29 
	~"®É”m¦i¡.h
"

30 
	~"æšt_bË.h
"

31 
	~"omdebug.h
"

32 
	~"‹rmli¡.h
"

34 
	~<¡ršg
>

36 
şass
 
	gFlštCursÜ
;

38 şas 
	cFlštM‘ad©aT”mLi¡
 : 
public
 
AÎT”msLi¡
 {

40 
FlštM‘ad©aT”mLi¡
(const FlintMetadataTermList &);

43 
	mİ”©Ü
=(cÚ¡ 
FlštM‘ad©aT”mLi¡
 &);

46 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

50 
FlštCursÜ
 * 
	mcursÜ
;

54 
	m¡d
::
¡ršg
 
´efix
;

56 
	mpublic
:

57 
FlštM‘ad©aT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

58 
FlštCursÜ
 * 
cursÜ_
, cÚ¡ 
¡d
::
¡ršg
 &
´efix_
);

60 ~
FlštM‘ad©aT”mLi¡
();

67 
	m¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

73 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

79 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

82 
T”mLi¡
 * 
	`Ãxt
();

85 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
key
);

88 
boŞ
 
	$©_’d
() const;

	@backends/flint/flint_modifiedpostlist.cc

21 
	~<cÚfig.h
>

23 
	~"æšt_d©aba£.h
"

24 
	~"æšt_modif›dpo¡li¡.h
"

26 
	gFlštModif›dPo¡Li¡
::~
	$FlštModif›dPo¡Li¡
()

28 
d–‘e
 
po¦i¡
;

29 
	}
}

32 
	gFlštModif›dPo¡Li¡
::
sk_d–‘es
(
X­Ÿn
::
weight
 
w_mš
)

34 !
FlštPo¡Li¡
::
©_’d
()) {

35 
™
 !ğ
mods
.
’d
(è&& it->
£cÚd
.
fœ¡
 == 'D' &&

36 
™
->
fœ¡
 < 
FlštPo¡Li¡
::
g‘_docid
())

37 ++
™
;

38 ià(
	g™
 =ğ
mods
.
’d
()) ;

39 ià(
	g™
->
	gfœ¡
 !ğ
FlštPo¡Li¡
::
g‘_docid
()) ;

40 ià(
	g™
->
	g£cÚd
.
	gfœ¡
 != 'D') ;

41 ++
	g™
;

42 
	gFlštPo¡Li¡
::
Ãxt
(
w_mš
);

44 
	g™
 !ğ
mods
.
’d
(è&& 
™
->
£cÚd
.
fœ¡
 == 'D') ++it;

47 
	gX­Ÿn
::
doccouÁ


48 
FlštModif›dPo¡Li¡
::
	$g‘_‹rmäeq
() const

50  
this_db
->
	`g‘_‹rmäeq
(
‹rm
);

51 
	}
}

53 
	gX­Ÿn
::
docid


54 
FlštModif›dPo¡Li¡
::
	$g‘_docid
() const

56 ià(
™
 =ğ
mods
.
	`’d
()è 
FlštPo¡Li¡
::
	`g‘_docid
();

57 ià(
FlštPo¡Li¡
::
	`©_’d
()è 
™
->
fœ¡
;

58 
	`As£¹
(
™
->
£cÚd
.
fœ¡
 != 'D');

59  
	`mš
(
™
->
fœ¡
, 
FlštPo¡Li¡
::
	`g‘_docid
());

60 
	}
}

62 
	gX­Ÿn
::
‹rmcouÁ


63 
FlštModif›dPo¡Li¡
::
	$g‘_doş’gth
() const

65 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintModifiedPostList::get_doclength", "");

66 ià(
™
 !ğ
mods
.
	`’d
(è&& (
FlštPo¡Li¡
::
	`©_’d
(è|| it->
fœ¡
 <ğFlštPo¡Li¡::
	`g‘_docid
()))

67 
	`RETURN
(
this_db
->
	`g‘_doş’gth
(
™
->
fœ¡
));

68 
	`RETURN
(
FlštPo¡Li¡
::
	`g‘_doş’gth
());

69 
	}
}

71 
	gX­Ÿn
::
‹rmcouÁ


72 
FlštModif›dPo¡Li¡
::
	$g‘_wdf
() const

74 ià(
FlštPo¡Li¡
::
	`©_’d
()è 
™
->
£cÚd
.second;

75 
X­Ÿn
::
docid
 
unmod_did
 = 
FlštPo¡Li¡
::
	`g‘_docid
();

76 ià(
™
 !ğ
mods
.
	`’d
(è&& it->
fœ¡
 <ğ
unmod_did
) {

77 ià(
™
->
fœ¡
 < 
unmod_did
è it->
£cÚd
.second;

78  
™
->
£cÚd
.second;

80  
FlštPo¡Li¡
::
	`g‘_wdf
();

81 
	}
}

83 
Pos™iÚLi¡
 *

84 
	gFlštModif›dPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

86 ià(
™
 !ğ
mods
.
	`’d
(è&& (
FlštPo¡Li¡
::
	`©_’d
(è|| it->
fœ¡
 <ğFlštPo¡Li¡::
	`g‘_docid
())) {

87 ià(
po¦i¡
) {

88 
d–‘e
 
po¦i¡
;

89 
po¦i¡
 = 
NULL
;

91 
po¦i¡
 = 
this_db
->
	`İ’_pos™iÚ_li¡
(
™
->
fœ¡
, 
‹rm
);

92  
po¦i¡
;

94  
FlštPo¡Li¡
::
	`»ad_pos™iÚ_li¡
();

95 
	}
}

97 
Pos™iÚLi¡
 *

98 
	gFlštModif›dPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

100 ià(
™
 !ğ
mods
.
	`’d
(è&& (
FlštPo¡Li¡
::
	`©_’d
(è|| it->
fœ¡
 <ğFlštPo¡Li¡::
	`g‘_docid
())) {

101  
this_db
->
	`İ’_pos™iÚ_li¡
(
™
->
fœ¡
, 
‹rm
);

103  
FlštPo¡Li¡
::
	`İ’_pos™iÚ_li¡
();

104 
	}
}

106 
Po¡Li¡
 *

107 
	gFlštModif›dPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

109 ià(
have_¡¬‹d
) {

110 ià(
FlštPo¡Li¡
::
©_’d
()) {

111 ++
™
;

112 
sk_d–‘es
(
w_mš
);

113  
	gNULL
;

115 
	gX­Ÿn
::
docid
 
unmod_did
 = 
FlštPo¡Li¡
::
g‘_docid
();

116 ià(
	g™
 !ğ
mods
.
’d
(è&& 
™
->
fœ¡
 <ğ
unmod_did
) {

117 ià(
™
->
fœ¡
 < 
unmod_did
 && it->
£cÚd
.first != 'D') {

118 ++
™
;

119 
sk_d–‘es
(
w_mš
);

120  
	gNULL
;

122 ++
	g™
;

125 
	gFlštPo¡Li¡
::
Ãxt
(
w_mš
);

126 
sk_d–‘es
(
w_mš
);

127  
	gNULL
;

130 
Po¡Li¡
 *

131 
	gFlštModif›dPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
)

133 ià(!
FlštPo¡Li¡
::
©_’d
()èFlštPo¡Li¡::
sk_to
(
desœed_did
, 
w_mš
);

135 
	g™
 !ğ
mods
.
’d
(è&& 
™
->
fœ¡
 < 
desœed_did
) ++it;

136 
sk_d–‘es
(
w_mš
);

137  
	gNULL
;

140 
boŞ


141 
	gFlštModif›dPo¡Li¡
::
	$©_’d
() const {

142  
™
 =ğ
mods
.
	`’d
(è&& 
FlštPo¡Li¡
::
	`©_’d
();

143 
	}
}

145 
	g¡d
::
¡ršg


146 
FlštModif›dPo¡Li¡
::
	$g‘_desütiÚ
() const

148 
¡d
::
¡ršg
 
desc
 = "FlintModifiedPostList(";

149 
desc
 +ğ
FlštPo¡Li¡
::
	`g‘_desütiÚ
();

150 
desc
 += ')';

151  
desc
;

152 
	}
}

	@backends/flint/flint_modifiedpostlist.h

21 #iâdeà
XAPIAN_INCLUDED_FLINT_MODIFIEDPOSTLIST_H


22 
	#XAPIAN_INCLUDED_FLINT_MODIFIEDPOSTLIST_H


	)

24 
	~<m­
>

25 
	~<¡ršg
>

27 
usšg
 
Çme¥aû
 
	g¡d
;

29 
	~"æšt_po¡li¡.h
"

31 şas 
	cFlštModif›dPo¡Li¡
 : 
public
 
FlštPo¡Li¡
 {

34 
m­
<
X­Ÿn
::
docid
, 
	m·œ
<, 
	mX­Ÿn
::
‹rmcouÁ
> > 
mods
;

35 
	mm­
<
	mX­Ÿn
::
docid
, 
	m·œ
<, X­Ÿn::
‹rmcouÁ
> >::
cÚ¡_™”©Ü
 
™
;

39 
Pos™iÚLi¡
 * 
	mpo¦i¡
;

42 
sk_d–‘es
(
X­Ÿn
::
weight
 
w_mš
);

44 
	mpublic
:

46 
FlštModif›dPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
this_db_
,

47 cÚ¡ 
¡ršg
 & 
Šame_
,

48 cÚ¡ 
m­
<
X­Ÿn
::
docid
, 
·œ
<, X­Ÿn::
‹rmcouÁ
> > & 
mods_
)

49 : 
FlštPo¡Li¡
(
this_db_
, 
Šame_
),

50 
mods
(
mods_
), 
™
(mods.
begš
()), 
	$po¦i¡
(0)

53 ~
	`FlštModif›dPo¡Li¡
();

55 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

57 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

59 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

61 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

63 
Pos™iÚLi¡
 *
	`»ad_pos™iÚ_li¡
();

65 
Pos™iÚLi¡
 *
	$İ’_pos™iÚ_li¡
() const;

67 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

69 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
);

71 
boŞ
 
	$©_’d
() const;

73 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

74 
	}
};

	@backends/flint/flint_positionlist.cc

21 
	~<cÚfig.h
>

23 
	~"æšt_pos™iÚli¡.h
"

25 
	~<x­Ÿn/ty³s.h
>

27 
	~"b™¡»am.h
"

28 
	~"æšt_uts.h
"

29 
	~"omdebug.h
"

31 
	~<¡ršg
>

32 
	~<veùÜ
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	gFlštPos™iÚLi¡TabË
::
£t_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
,

38 cÚ¡ 
¡ršg
 & 
Šame
,

39 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos
,

40 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 &
pos_’d
)

42 
DEBUGCALL
(
DB
, , "FlintPositionList::set_positionlist",

43 
did
 << ", " << 
Šame
 << ", " << 
pos
 << ", " << 
pos_’d
);

44 
As£¹
(
pos
 !ğ
pos_’d
);

47 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
> 
poscİy
(
pos
, 
pos_’d
);

49 
¡ršg
 
	gkey
 = 
make_key
(
did
, 
Šame
);

51 ià(
	gposcİy
.
size
() == 1) {

53 
add
(
key
, 
F_·ck_ušt
(
poscİy
[0]));

57 
B™Wr™”
 
wr
(
F_·ck_ušt
(
poscİy
.
back
()));

59 
	gwr
.
’code
(
poscİy
[0],…oscİy.
back
());

60 
	gwr
.
’code
(
poscİy
.
size
(è- 2,…oscİy.
back
() -…oscopy[0]);

61 
	gwr
.
’code_š‹½Ş©ive
(
poscİy
, 0,…oscİy.
size
() - 1);

62 
add
(
key
, 
wr
.
ä“ze
());

65 
	gX­Ÿn
::
‹rmcouÁ


66 
FlštPos™iÚLi¡TabË
::
pos™iÚli¡_couÁ
(
X­Ÿn
::
docid
 
did
,

67 cÚ¡ 
¡ršg
 & 
‹rm
) const

69 
DEBUGCALL
(
DB
, , "FlintPositionListTable::positionlist_count",

70 
did
 << ", " << 
‹rm
);

72 
¡ršg
 
	gd©a
;

73 ià(!
g‘_exaù_’Œy
(
F_·ck_ušt_´e£rvšg_sÜt
(
did
è+ 
‹rm
, 
d©a
)) {

78 cÚ¡ * 
	gpos
 = 
d©a
.data();

79 cÚ¡ * 
	g’d
 = 
pos
 + 
d©a
.
size
();

80 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

81 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

82 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Position†ist data corrupt");

84 ià(
	gpos
 =ğ
’d
) {

90 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

91 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

92 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

93  
	gpos_size
;

98 
boŞ


99 
	gFlštPos™iÚLi¡
::
»ad_d©a
(cÚ¡ 
FlštTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

100 cÚ¡ 
¡ršg
 & 
Šame
)

102 
DEBUGCALL
(
DB
, , "FlintPositionList::read_data",

103 
bË
 << ", " << 
did
 << ", " << 
Šame
);

105 
	ghave_¡¬‹d
 = 
çl£
;

106 
	gpos™iÚs
.
ş—r
();

108 
¡ršg
 
	gd©a
;

109 ià(!
	gbË
->
g‘_exaù_’Œy
(
F_·ck_ušt_´e£rvšg_sÜt
(
did
è+ 
Šame
, 
d©a
)) {

111 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

112  
	gçl£
;

115 cÚ¡ * 
	gpos
 = 
d©a
.data();

116 cÚ¡ * 
	g’d
 = 
pos
 + 
d©a
.
size
();

117 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

118 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

119 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Position†ist data corrupt");

121 ià(
	gpos
 =ğ
’d
) {

123 
pos™iÚs
.
push_back
(
pos_Ï¡
);

124 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

125  
	gŒue
;

128 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

129 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

130 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

131 
	gpos™iÚs
.
»size
(
pos_size
);

132 
	gpos™iÚs
[0] = 
pos_fœ¡
;

133 
	gpos™iÚs
.
back
(èğ
pos_Ï¡
;

134 
	grd
.
decode_š‹½Ş©ive
(
pos™iÚs
, 0, 
pos_size
 - 1);

136 
	gcu¼’t_pos
 = 
pos™iÚs
.
begš
();

137  
	gŒue
;

140 
	gX­Ÿn
::
‹rmcouÁ


141 
FlštPos™iÚLi¡
::
	$g‘_size
() const

143 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintPositionList::get_size", "");

144 
	`RETURN
(
pos™iÚs
.
	`size
());

145 
	}
}

147 
	gX­Ÿn
::
‹rmpos


148 
FlštPos™iÚLi¡
::
	$g‘_pos™iÚ
() const

150 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmpos
, "FlintPositionList::get_position", "");

151 
	`As£¹
(
have_¡¬‹d
);

152 
	`RETURN
(*
cu¼’t_pos
);

153 
	}
}

156 
	gFlštPos™iÚLi¡
::
	$Ãxt
()

158 
	`DEBUGCALL
(
DB
, , "FlintPositionList::next", "");

160 ià(!
have_¡¬‹d
) {

161 
have_¡¬‹d
 = 
Œue
;

163 
	`As£¹
(!
	`©_’d
());

164 ++
cu¼’t_pos
;

166 
	}
}

169 
	gFlštPos™iÚLi¡
::
sk_to
(
X­Ÿn
::
‹rmpos
ermpos)

171 
DEBUGCALL
(
DB
, , "FlštPos™iÚLi¡::sk_to", 
‹rmpos
);

172 ià(!
	ghave_¡¬‹d
) {

173 
	ghave_¡¬‹d
 = 
Œue
;

175 !
©_’d
(è&& *
	gcu¼’t_pos
 < 
	g‹rmpos
) ++current_pos;

178 
boŞ


179 
	gFlštPos™iÚLi¡
::
	$©_’d
() const

181 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintPositionList::at_end", "");

182 
	`RETURN
(
cu¼’t_pos
 =ğ
pos™iÚs
.
	`’d
());

183 
	}
}

	@backends/flint/flint_positionlist.h

21 #iâdeà
XAPIAN_HGUARD_FLINT_POSITIONLIST_H


22 
	#XAPIAN_HGUARD_FLINT_POSITIONLIST_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"æšt_bË.h
"

27 
	~"æšt_uts.h
"

28 
	~"pos™iÚli¡.h
"

30 
	~<¡ršg
>

31 
	~<veùÜ
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 şas 
	cFlštPos™iÚLi¡TabË
 : 
public
 
FlštTabË
 {

36 
¡ršg
 
make_key
(
X­Ÿn
::
docid
 
did
, cÚ¡ sŒšg & 
Šame
) {

37  
F_·ck_ušt_´e£rvšg_sÜt
(
did
è+ 
	mŠame
;

40 
	gpublic
:

49 
	$FlštPos™iÚLi¡TabË
(cÚ¡ 
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

50 : 
	`FlštTabË
("pos™iÚ", 
dbdœ
 + "/pos™iÚ.", 
»adÚly
, 
DONT_COMPRESS
, 
Œue
è{ 
	}
}

53 
£t_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
Šame
,

54 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos
,

55 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 &
pos_’d
);

58 
d–‘e_pos™iÚli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
Šame
) {

59 
d–
(
make_key
(
did
, 
Šame
));

63 
	gX­Ÿn
::
‹rmcouÁ
 
pos™iÚli¡_couÁ
(
X­Ÿn
::
docid
 
did
,

64 cÚ¡ 
¡ršg
 & 
‹rm
) const;

68 şas 
	cFlštPos™iÚLi¡
 : 
public
 
Pos™iÚLi¡
 {

70 
veùÜ
<
X­Ÿn
::
‹rmpos
> 
pos™iÚs
;

73 
	mveùÜ
<
	mX­Ÿn
::
‹rmpos
>::
cÚ¡_™”©Ü
 
cu¼’t_pos
;

76 
boŞ
 
	mhave_¡¬‹d
;

79 
Ãxt_š‹º®
();

82 
FlštPos™iÚLi¡
(const FlintPositionList &);

85 
	mİ”©Ü
=(cÚ¡ 
FlštPos™iÚLi¡
 &);

87 
	mpublic
:

89 
	$FlštPos™iÚLi¡
(è: 
	$have_¡¬‹d
(
çl£
) {}

92 
	`FlštPos™iÚLi¡
(cÚ¡ 
FlštTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

93 cÚ¡ 
¡ršg
 & 
Šame
) {

94 ()
	`»ad_d©a
(
bË
, 
did
, 
Šame
);

95 
	}
}

101 
boŞ
 
»ad_d©a
(cÚ¡ 
FlštTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

102 cÚ¡ 
¡ršg
 & 
Šame
);

105 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_size
() const;

112 
X­Ÿn
::
‹rmpos
 
	$g‘_pos™iÚ
() const;

115 
	`Ãxt
();

118 
	`sk_to
(
X­Ÿn
::
‹rmpos
ermpos);

121 
boŞ
 
	$©_’d
() const;

122 
	}
};

	@backends/flint/flint_postlist.cc

23 
	~<cÚfig.h
>

24 
	~"æšt_po¡li¡.h
"

26 
	~"æšt_cursÜ.h
"

27 
	~"æšt_d©aba£.h
"

28 
	~"æšt_uts.h
"

29 
	~"nÜ‘uº.h
"

30 
	~"omdebug.h
"

31 
	~"uts.h
"

33 
	gX­Ÿn
::
doccouÁ


34 
FlštPo¡Li¡TabË
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

36 
¡ršg
 
key
 = 
	`make_key
(
‹rm
);

37 
¡ršg
 
g
;

38 ià(!
	`g‘_exaù_’Œy
(
key
, 
g
))  0;

40 
X­Ÿn
::
doccouÁ
 
‹rmäeq
;

41 cÚ¡ * 
p
 = 
g
.
	`d©a
();

42 
FlštPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
,… + 
g
.
	`size
(), &
‹rmäeq
, 
NULL
);

43  
‹rmäeq
;

44 
	}
}

46 
	gX­Ÿn
::
‹rmcouÁ


47 
FlštPo¡Li¡TabË
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

49 
¡ršg
 
key
 = 
	`make_key
(
‹rm
);

50 
¡ršg
 
g
;

51 ià(!
	`g‘_exaù_’Œy
(
key
, 
g
))  0;

53 
X­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

54 cÚ¡ * 
p
 = 
g
.
	`d©a
();

55 
FlštPo¡Li¡
::
	`»ad_numb”_of_’Œ›s
(&
p
,… + 
g
.
	`size
(), 
NULL
, &
cŞläeq
);

56  
cŞläeq
;

57 
	}
}

64 cÚ¡ 
	gCHUNKSIZE
 = 2000;

72 şas 
	cFlštPo¡li¡ChunkWr™”
 {

73 
	mpublic
:

74 
FlštPo¡li¡ChunkWr™”
(cÚ¡ 
¡ršg
 &
Üig_key_
,

75 
boŞ
 
is_fœ¡_chunk_
,

76 cÚ¡ 
¡ršg
 &
Šame_
,

77 
boŞ
 
is_Ï¡_chunk_
);

80 
­³nd
(
FlštTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

81 
X­Ÿn
::
‹rmcouÁ
 
wdf
, 
æšt_doş’_t
 
doş’
);

84 
¿w_­³nd
(
X­Ÿn
::
docid
 
fœ¡_did_
, X­Ÿn::docid 
cu¼’t_did_
,

85 cÚ¡ 
¡ršg
 & 
s
) {

86 
As£¹
(!
¡¬‹d
);

87 
	mfœ¡_did
 = 
fœ¡_did_
;

88 
	mcu¼’t_did
 = 
cu¼’t_did_
;

89 ià(!
	ms
.
em±y
()) {

90 
	mchunk
.
­³nd
(
s
);

91 
	m¡¬‹d
 = 
Œue
;

99 
æush
(
FlštTabË
 *
bË
);

101 
	g´iv©e
:

102 
¡ršg
 
Üig_key
;

103 
¡ršg
 
	gŠame
;

104 
boŞ
 
	gis_fœ¡_chunk
;

105 
boŞ
 
	gis_Ï¡_chunk
;

106 
boŞ
 
	g¡¬‹d
;

108 
	gX­Ÿn
::
docid
 
fœ¡_did
;

109 
	gX­Ÿn
::
docid
 
cu¼’t_did
;

111 
¡ršg
 
	gchunk
;

117 
XAPIAN_NORETURN
(
»pÜt_»ad_”rÜ
(cÚ¡ * 
pos™iÚ
));

118 
	$»pÜt_»ad_”rÜ
(cÚ¡ * 
pos™iÚ
)

120 ià(
pos™iÚ
 == 0) {

122 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Data„an out unexpectedly when„eading…osting†ist.");

125 
throw
 
X­Ÿn
::
	`RªgeE¼Ü
("Value in…osting†istoo†arge.");

126 
	}
}

128 
šlše
 
boŞ
 
	$g‘_Šame_äom_key
(cÚ¡ **
¤c
, cÚ¡ *
’d
,

129 
¡ršg
 &
Šame
)

131  
	`F_uÅack_¡ršg_´e£rvšg_sÜt
(
¤c
, 
’d
, 
Šame
);

132 
	}
}

134 
šlše
 
boŞ


135 
	$check_Šame_š_key_l™e
(cÚ¡ **
keypos
, cÚ¡ *
key’d
, cÚ¡ 
¡ršg
 &
Šame
)

137 
¡ršg
 
Šame_š_key
;

140 ià(!
	`g‘_Šame_äom_key
(
keypos
, 
key’d
, 
Šame_š_key
)) {

141 
	`»pÜt_»ad_”rÜ
(*
keypos
);

145  
Šame_š_key
 =ğ
Šame
;

146 
	}
}

148 
šlše
 
boŞ


149 
	$check_Šame_š_key
(cÚ¡ **
keypos
, cÚ¡ *
key’d
, cÚ¡ 
¡ršg
 &
Šame
)

151 ià(*
keypos
 =ğ
key’d
è 
çl£
;

153  
	`check_Šame_š_key_l™e
(
keypos
, 
key’d
, 
Šame
);

154 
	}
}

157 
	gX­Ÿn
::
docid


158 
»ad_¡¬t_of_fœ¡_chunk
(cÚ¡ ** 
po¥Œ
,

159 cÚ¡ * 
’d
,

160 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

161 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
)

163 
DEBUGCALL_STATIC
(
DB
, 
X­Ÿn
::
docid
, "read_start_of_first_chunk",

164 (cÚ¡ *)
po¥Œ
 << ", " <<

165 (cÚ¡ *)
’d
 << ", " <<

166 (*)
numb”_of_’Œ›s_±r
 << ", " <<

167 (*)
cŞËùiÚ_äeq_±r
);

169 
	gFlštPo¡Li¡
::
»ad_numb”_of_’Œ›s
(
po¥Œ
, 
’d
,

170 
numb”_of_’Œ›s_±r
, 
cŞËùiÚ_äeq_±r
);

171 ià(
	gnumb”_of_’Œ›s_±r
)

172 
LOGVALUE
(
DB
, *
numb”_of_’Œ›s_±r
);

173 ià(
	gcŞËùiÚ_äeq_±r
)

174 
LOGVALUE
(
DB
, *
cŞËùiÚ_äeq_±r
);

176 
	gX­Ÿn
::
docid
 
did
;

178 ià(!
F_uÅack_ušt
(
po¥Œ
, 
’d
, &
did
))

179 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

180 ++
	gdid
;

181 
LOGVALUE
(
DB
, 
did
);

182 
RETURN
(
did
);

185 
šlše
 
»ad_did_šü—£
(cÚ¡ ** 
po¥Œ
,

186 cÚ¡ * 
’d
,

187 
X­Ÿn
::
docid
 * 
did_±r
)

189 
X­Ÿn
::
docid
 
did_šü—£
;

190 ià(!
F_uÅack_ušt
(
po¥Œ
, 
’d
, &
did_šü—£
)è
»pÜt_»ad_”rÜ
(*posptr);

191 *
	gdid_±r
 +ğ
did_šü—£
 + 1;

195 
šlše
 
»ad_wdf_ªd_Ëngth
(cÚ¡ ** 
po¥Œ
,

196 cÚ¡ * 
’d
,

197 
X­Ÿn
::
‹rmcouÁ
 * 
wdf_±r
,

198 
æšt_doş’_t
 * 
doş’gth_±r
)

200 ià(!
F_uÅack_ušt
(
po¥Œ
, 
’d
, 
wdf_±r
)è
»pÜt_»ad_”rÜ
(*posptr);

201 ià(!
F_uÅack_ušt
(
po¥Œ
, 
’d
, 
doş’gth_±r
)è
»pÜt_»ad_”rÜ
(*posptr);

205 
	gX­Ÿn
::
docid


206 
»ad_¡¬t_of_chunk
(cÚ¡ ** 
po¥Œ
,

207 cÚ¡ * 
’d
,

208 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
,

209 
boŞ
 * 
is_Ï¡_chunk_±r
)

211 
DEBUGCALL_STATIC
(
DB
, 
X­Ÿn
::
docid
, "read_start_of_chunk",

212 
»š‹½»t_ÿ¡
<cÚ¡ *>(
po¥Œ
) << ", " <<

213 
»š‹½»t_ÿ¡
<cÚ¡ *>(
’d
) << ", " <<

214 
fœ¡_did_š_chunk
 << ", " <<

215 
»š‹½»t_ÿ¡
<cÚ¡ *>(
is_Ï¡_chunk_±r
));

218 ià(!
F_uÅack_boŞ
(
po¥Œ
, 
’d
, 
is_Ï¡_chunk_±r
))

219 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

220 ià(
	gis_Ï¡_chunk_±r
)

221 
LOGVALUE
(
DB
, *
is_Ï¡_chunk_±r
);

224 
	gX­Ÿn
::
docid
 
šü—£_to_Ï¡
;

225 ià(!
F_uÅack_ušt
(
po¥Œ
, 
’d
, &
šü—£_to_Ï¡
))

226 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

227 ++
	gšü—£_to_Ï¡
;

228 
	gX­Ÿn
::
docid
 
Ï¡_did_š_chunk
 = 
fœ¡_did_š_chunk
 + 
šü—£_to_Ï¡
;

229 
LOGVALUE
(
DB
, 
Ï¡_did_š_chunk
);

230 
RETURN
(
Ï¡_did_š_chunk
);

233 
¡ršg
 
make_wdf_ªd_Ëngth
(
X­Ÿn
::
‹rmcouÁ
 
wdf
, 
æšt_doş’_t
 
doş’gth
)

235  
F_·ck_ušt
(
wdf
è+ F_·ck_ušt(
doş’gth
);

238 
wr™e_¡¬t_of_chunk
(
¡ršg
 & 
chunk
,

239 
¡¬t_of_chunk_h—d”
,

240 
’d_of_chunk_h—d”
,

241 
boŞ
 
is_Ï¡_chunk
,

242 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
,

243 
X­Ÿn
::
docid
 
Ï¡_did_š_chunk
)

245 
As£¹
((
size_t
)(
’d_of_chunk_h—d”
 - 
¡¬t_of_chunk_h—d”
è<ğ
chunk
.
size
());

246 
As£¹
(
Ï¡_did_š_chunk
 >ğ
fœ¡_did_š_chunk
);

247 
	gX­Ÿn
::
docid
 
šü—£_to_Ï¡
 = 
Ï¡_did_š_chunk
 - 
fœ¡_did_š_chunk
;

249 
	gchunk
.
»¶aû
(
¡¬t_of_chunk_h—d”
,

250 
’d_of_chunk_h—d”
 - 
¡¬t_of_chunk_h—d”
,

251 
F_·ck_boŞ
(
is_Ï¡_chunk
è+ 
F_·ck_ušt
(
šü—£_to_Ï¡
 - 1));

261 şas 
	cFlštPo¡li¡ChunkR—d”
 {

262 
	mpublic
:

268 
FlštPo¡li¡ChunkR—d”
(
X­Ÿn
::
docid
 
fœ¡_did
, cÚ¡ 
¡ršg
 & 
d©a_
)

269 : 
d©a
(
d©a_
), 
pos
(d©a.d©a()), 
’d
Õo + d©a.
Ëngth
()), 
©_’d
(d©a.
em±y
()), 
	$did
(
fœ¡_did
)

271 ià(!
©_’d
è
	`»ad_wdf_ªd_Ëngth
(&
pos
, 
’d
, &
wdf
, &
doş’gth
);

274 
X­Ÿn
::
docid
 
	$g‘_docid
() const {

275  
did
;

276 
	}
}

277 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const {

278  
wdf
;

279 
	}
}

280 
æšt_doş’_t
 
	$g‘_doş’gth
() const {

281 
	`DEBUGCALL
(
DB
, 
æšt_doş’_t
, "FlintPostlistChunkReader::get_doclength", "");

282 
	`RETURN
(
doş’gth
);

283 
	}
}

285 
boŞ
 
	$is_©_’d
() const {

286  
©_’d
;

287 
	}
}

291 
Ãxt
();

293 
	g´iv©e
:

294 
¡ršg
 
d©a
;

296 cÚ¡ *
	gpos
;

297 cÚ¡ *
	g’d
;

299 
boŞ
 
	g©_’d
;

301 
	gX­Ÿn
::
docid
 
did
;

302 
	gX­Ÿn
::
‹rmcouÁ
 
wdf
;

303 
æšt_doş’_t
 
	gdoş’gth
;

307 
	gFlštPo¡li¡ChunkR—d”
::
	$Ãxt
()

309 ià(
pos
 =ğ
’d
) {

310 
©_’d
 = 
Œue
;

312 
	`»ad_did_šü—£
(&
pos
, 
’d
, &
did
);

313 
	`»ad_wdf_ªd_Ëngth
(&
pos
, 
’d
, &
wdf
, &
doş’gth
);

315 
	}
}

317 
	gFlštPo¡li¡ChunkWr™”
::
	$FlštPo¡li¡ChunkWr™”
(cÚ¡ 
¡ršg
 &
Üig_key_
,

318 
boŞ
 
is_fœ¡_chunk_
,

319 cÚ¡ 
¡ršg
 &
Šame_
,

320 
boŞ
 
is_Ï¡_chunk_
)

321 : 
	`Üig_key
(
Üig_key_
),

322 
	`Šame
(
Šame_
), 
	`is_fœ¡_chunk
(
is_fœ¡_chunk_
),

323 
	`is_Ï¡_chunk
(
is_Ï¡_chunk_
),

324 
	$¡¬‹d
(
çl£
)

326 
	`DEBUGCALL
(
DB
, , "FlintPostlistChunkWriter::FlintPostlistChunkWriter",

327 
Üig_key_
 << ", " << 
is_fœ¡_chunk_
 << ", " << 
Šame_
 << ", " <<

328 
is_Ï¡_chunk_
);

329 
	}
}

332 
	gFlštPo¡li¡ChunkWr™”
::
­³nd
(
FlštTabË
 * 
bË
, 
X­Ÿn
::
docid
 
did
,

333 
X­Ÿn
::
‹rmcouÁ
 
wdf
, 
æšt_doş’_t
 
doş’
)

335 ià(!
	g¡¬‹d
) {

336 
	g¡¬‹d
 = 
Œue
;

337 
	gfœ¡_did
 = 
did
;

339 
As£¹
(
did
 > 
cu¼’t_did
);

341 ià(
	gchunk
.
size
(è>ğ
CHUNKSIZE
) {

342 
boŞ
 
§ve_is_Ï¡_chunk
 = 
is_Ï¡_chunk
;

343 
	gis_Ï¡_chunk
 = 
çl£
;

344 
æush
(
bË
);

345 
	gis_Ï¡_chunk
 = 
§ve_is_Ï¡_chunk
;

346 
	gis_fœ¡_chunk
 = 
çl£
;

347 
	gfœ¡_did
 = 
did
;

348 
	gchunk
.
»size
(0);

349 
	gÜig_key
 = 
FlštPo¡Li¡TabË
::
make_key
(
Šame
, 
fœ¡_did
);

351 
	gchunk
.
­³nd
(
F_·ck_ušt
(
did
 - 
cu¼’t_did
 - 1));

354 
	gcu¼’t_did
 = 
did
;

355 
	gchunk
.
­³nd
(
make_wdf_ªd_Ëngth
(
wdf
, 
doş’
));

360 
šlše
 
¡ršg


361 
make_¡¬t_of_fœ¡_chunk
(
X­Ÿn
::
doccouÁ
 
’Œ›s
,

362 
X­Ÿn
::
‹rmcouÁ
 
cŞËùiÚäeq
,

363 
X­Ÿn
::
docid
 
Ãw_did
)

365  
F_·ck_ušt
(
’Œ›s
è+ F_·ck_ušt(
cŞËùiÚäeq
è+ F_·ck_ušt(
Ãw_did
 - 1);

370 
šlše
 
¡ršg


371 
make_¡¬t_of_chunk
(
boŞ
 
Ãw_is_Ï¡_chunk
,

372 
X­Ÿn
::
docid
 
Ãw_fœ¡_did
,

373 
X­Ÿn
::
docid
 
Ãw_fš®_did
)

375 
As£¹
(
Ãw_fš®_did
 >ğ
Ãw_fœ¡_did
);

376  
F_·ck_boŞ
(
Ãw_is_Ï¡_chunk
) +

377 
F_·ck_ušt
(
Ãw_fš®_did
 - 
Ãw_fœ¡_did
 - 1);

381 
	gFlštPo¡li¡ChunkWr™”
::
	$æush
(
FlštTabË
 *
bË
)

383 
	`DEBUGCALL
(
DB
, , "FlštPo¡li¡ChunkWr™”::æush", 
bË
);

393 ià(!
¡¬‹d
) {

402 
	`LOGLINE
(
DB
, "FlintPostlistChunkWriter::flush(): deleting chunk");

403 
	`As£¹
(!
Üig_key
.
	`em±y
());

404 ià(
is_fœ¡_chunk
) {

405 
	`LOGLINE
(
DB
, "FlintPostlistChunkWriter::flush(): deleting first chunk");

406 ià(
is_Ï¡_chunk
) {

410 
bË
->
	`d–
(
Üig_key
);

419 
AutoPŒ
<
FlštCursÜ
> 
	`cursÜ
(
bË
->
	`cursÜ_g‘
());

421 ià(!
cursÜ
->
	`fšd_’Œy
(
Üig_key
)) {

422 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("The key we're working on has disappeared");

427 
X­Ÿn
::
doccouÁ
 
num_’t
;

428 
X­Ÿn
::
‹rmcouÁ
 
cŞl_äeq
;

430 
cursÜ
->
	`»ad_g
();

431 cÚ¡ *
gpos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

432 cÚ¡ *
g’d
 = 
gpos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

434 ()
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

435 &
num_’t
, &
cŞl_äeq
);

439 
cursÜ
->
	`Ãxt
();

440 ià(
cursÜ
->
	`aá”_’d
()) {

441 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Expected‡nother key but found‚one");

443 cÚ¡ *
kpos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

444 cÚ¡ *
k’d
 = 
kpos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

445 ià(!
	`check_Šame_š_key
(&
kpos
, 
k’d
, 
Šame
)) {

446 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Expected‡nother key withhe sameerm‚ame but found‡ different one");

450 
X­Ÿn
::
docid
 
Ãw_fœ¡_did
;

451 ià(!
	`F_uÅack_ušt_´e£rvšg_sÜt
(&
kpos
, 
k’d
, &
Ãw_fœ¡_did
)) {

452 
	`»pÜt_»ad_”rÜ
(
kpos
);

455 
cursÜ
->
	`»ad_g
();

456 cÚ¡ *
gpos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

457 cÚ¡ *
g’d
 = 
gpos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

460 
boŞ
 
Ãw_is_Ï¡_chunk
;

461 
X­Ÿn
::
docid
 
Ãw_Ï¡_did_š_chunk
 =

462 
	`»ad_¡¬t_of_chunk
(&
gpos
, 
g’d
, 
Ãw_fœ¡_did
,

463 &
Ãw_is_Ï¡_chunk
);

465 
¡ršg
 
	`chunk_d©a
(
gpos
, 
g’d
);

468 
bË
->
	`d–
(
cursÜ
->
cu¼’t_key
);

471 
¡ršg
 
g
;

472 
g
 = 
	`make_¡¬t_of_fœ¡_chunk
(
num_’t
, 
cŞl_äeq
, 
Ãw_fœ¡_did
);

473 
g
 +ğ
	`make_¡¬t_of_chunk
(
Ãw_is_Ï¡_chunk
,

474 
Ãw_fœ¡_did
,

475 
Ãw_Ï¡_did_š_chunk
);

476 
g
 +ğ
chunk_d©a
;

477 
bË
->
	`add
(
Üig_key
, 
g
);

481 
	`LOGLINE
(
DB
, "FlintPostlistChunkWriter::flush(): deleting secondary chunk");

487 
bË
->
	`d–
(
Üig_key
);

489 ià(
is_Ï¡_chunk
) {

490 
	`LOGLINE
(
DB
, "FlintPostlistChunkWriter::flush(): deleting secondary†ast chunk");

492 
AutoPŒ
<
FlštCursÜ
> 
	`cursÜ
(
bË
->
	`cursÜ_g‘
());

496 ià(
cursÜ
->
	`fšd_’Œy
(
Üig_key
)) {

497 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Flint key‚ot deleted‡s weƒxpected");

500 cÚ¡ * 
keypos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

501 cÚ¡ * 
key’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

502 ià(!
	`check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

503 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Couldn't find chunk before delete chunk");

506 
boŞ
 
is_´ev_fœ¡_chunk
 = (
keypos
 =ğ
key’d
);

509 
cursÜ
->
	`»ad_g
();

510 
¡ršg
 
g
 = 
cursÜ
->
cu¼’t_g
;

512 cÚ¡ *
gpos
 = 
g
.
	`d©a
();

513 cÚ¡ *
g’d
 = 
gpos
 + 
g
.
	`size
();

516 
X­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

517 ià(
is_´ev_fœ¡_chunk
) {

518 
fœ¡_did_š_chunk
 = 
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

521 ià(!
	`F_uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
,

522 &
fœ¡_did_š_chunk
))

523 
	`»pÜt_»ad_”rÜ
(
keypos
);

525 
boŞ
 
wrÚg_is_Ï¡_chunk
;

526 
¡ršg
::
size_ty³
 
¡¬t_of_chunk_h—d”
 = 
gpos
 - 
g
.
	`d©a
();

527 
X­Ÿn
::
docid
 
Ï¡_did_š_chunk
 =

528 
	`»ad_¡¬t_of_chunk
(&
gpos
, 
g’d
, 
fœ¡_did_š_chunk
,

529 &
wrÚg_is_Ï¡_chunk
);

530 
¡ršg
::
size_ty³
 
’d_of_chunk_h—d”
 = 
gpos
 - 
g
.
	`d©a
();

533 
	`wr™e_¡¬t_of_chunk
(
g
,

534 
¡¬t_of_chunk_h—d”
,

535 
’d_of_chunk_h—d”
,

536 
Œue
,

537 
fœ¡_did_š_chunk
,

538 
Ï¡_did_š_chunk
);

539 
bË
->
	`add
(
cursÜ
->
cu¼’t_key
, 
g
);

542 
	`LOGLINE
(
DB
, "FlintPostlistChunkWriter::flush(): updating chunk which still has items in it");

549 
¡ršg
 
g
;

554 ià(
is_fœ¡_chunk
) {

558 
	`LOGLINE
(
DB
, "FlintPostlistChunkWriter::flush():„ewritinghe first chunk, which still has items in it");

559 
¡ršg
 
key
 = 
FlštPo¡Li¡TabË
::
	`make_key
(
Šame
);

560 
boŞ
 
ok
 = 
bË
->
	`g‘_exaù_’Œy
(
key
, 
g
);

561 ()
ok
;

562 
	`As£¹
(
ok
);

563 
	`As£¹
(!
g
.
	`em±y
());

565 
X­Ÿn
::
doccouÁ
 
num_’t
;

566 
X­Ÿn
::
‹rmcouÁ
 
cŞl_äeq
;

568 cÚ¡ * 
gpos
 = 
g
.
	`d©a
();

569 cÚ¡ * 
g’d
 = 
gpos
 + 
g
.
	`size
();

570 ()
	`»ad_¡¬t_of_fœ¡_chunk
(&
gpos
, 
g’d
,

571 &
num_’t
, &
cŞl_äeq
);

574 
g
 = 
	`make_¡¬t_of_fœ¡_chunk
(
num_’t
, 
cŞl_äeq
, 
fœ¡_did
);

576 
g
 +ğ
	`make_¡¬t_of_chunk
(
is_Ï¡_chunk
, 
fœ¡_did
, 
cu¼’t_did
);

577 
g
 +ğ
chunk
;

578 
bË
->
	`add
(
key
, 
g
);

582 
	`LOGLINE
(
DB
, "FlintPostlistChunkWriter::flush(): updating secondary chunk which still has items in it");

594 cÚ¡ *
keypos
 = 
Üig_key
.
	`d©a
();

595 cÚ¡ *
key’d
 = 
keypos
 + 
Üig_key
.
	`size
();

596 ià(!
	`check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

597 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Have invalid key writingo…ostlist");

599 
X­Ÿn
::
docid
 
š™Ÿl_did
;

600 ià(!
	`F_uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
š™Ÿl_did
)) {

601 
	`»pÜt_»ad_”rÜ
(
keypos
);

603 
¡ršg
 
Ãw_key
;

604 ià(
š™Ÿl_did
 !ğ
fœ¡_did
) {

609 
Ãw_key
 = 
FlštPo¡Li¡TabË
::
	`make_key
(
Šame
, 
fœ¡_did
);

610 
bË
->
	`d–
(
Üig_key
);

612 
Ãw_key
 = 
Üig_key
;

616 
g
 = 
	`make_¡¬t_of_chunk
(
is_Ï¡_chunk
, 
fœ¡_did
, 
cu¼’t_did
);

618 
g
 +ğ
chunk
;

619 
bË
->
	`add
(
Ãw_key
, 
g
);

621 
	}
}

627 
	gFlštPo¡Li¡
::
»ad_numb”_of_’Œ›s
(cÚ¡ ** 
po¥Œ
,

628 cÚ¡ * 
’d
,

629 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

630 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
)

632 ià(!
F_uÅack_ušt
(
po¥Œ
, 
’d
, 
numb”_of_’Œ›s_±r
))

633 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

634 ià(!
F_uÅack_ušt
(
po¥Œ
, 
’d
, 
cŞËùiÚ_äeq_±r
))

635 
»pÜt_»ad_”rÜ
(*
po¥Œ
);

657 
	gFlštPo¡Li¡
::
FlštPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
this_db_
,

658 cÚ¡ 
¡ršg
 & 
‹rm_
)

659 : 
L—fPo¡Li¡
(
‹rm_
),

660 
this_db
(
this_db_
),

661 
have_¡¬‹d
(
çl£
),

662 
cursÜ
(
this_db
->
po¡li¡_bË
.
cursÜ_g‘
()),

663 
	$is_©_’d
(
çl£
)

665 
	`DEBUGCALL
(
DB
, , "FlintPostList::FlintPostList",

666 
this_db_
.
	`g‘
(è<< ", " << 
‹rm_
);

667 
¡ršg
 
key
 = 
FlštPo¡Li¡TabË
::
	`make_key
(
‹rm
);

668 
found
 = 
cursÜ
->
	`fšd_’Œy
(
key
);

669 ià(!
found
) {

670 
numb”_of_’Œ›s
 = 0;

671 
is_©_’d
 = 
Œue
;

672 
pos
 = 0;

673 
’d
 = 0;

674 
fœ¡_did_š_chunk
 = 0;

675 
Ï¡_did_š_chunk
 = 0;

678 
cursÜ
->
	`»ad_g
();

679 
pos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

680 
’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

682 
did
 = 
	`»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, &
numb”_of_’Œ›s
, 
NULL
);

683 
fœ¡_did_š_chunk
 = 
did
;

684 
Ï¡_did_š_chunk
 = 
	`»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

685 &
is_Ï¡_chunk
);

686 
	`»ad_wdf_ªd_Ëngth
(&
pos
, 
’d
, &
wdf
, &
doş’gth
);

687 
	}
}

689 
	gFlštPo¡Li¡
::~
	$FlštPo¡Li¡
()

691 
	`DEBUGCALL
(
DB
, , "FlintPostList::~FlintPostList", "");

692 
	}
}

694 
boŞ


695 
	gFlštPo¡Li¡
::
	$Ãxt_š_chunk
()

697 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintPostList::next_in_chunk", "");

698 ià(
pos
 =ğ
’d
è
	`RETURN
(
çl£
);

700 
	`»ad_did_šü—£
(&
pos
, 
’d
, &
did
);

701 
	`»ad_wdf_ªd_Ëngth
(&
pos
, 
’d
, &
wdf
, &
doş’gth
);

704 
	`As£¹
(
did
 <ğ
Ï¡_did_š_chunk
);

705 
	`As£¹
(
did
 < 
Ï¡_did_š_chunk
 || 
pos
 =ğ
’d
);

706 
	`As£¹
(
pos
 !ğ
’d
 || 
did
 =ğ
Ï¡_did_š_chunk
);

708 
	`RETURN
(
Œue
);

709 
	}
}

712 
	gFlštPo¡Li¡
::
	$Ãxt_chunk
()

714 
	`DEBUGCALL
(
DB
, , "FlintPostList::next_chunk", "");

715 ià(
is_Ï¡_chunk
) {

716 
is_©_’d
 = 
Œue
;

720 
cursÜ
->
	`Ãxt
();

721 ià(
cursÜ
->
	`aá”_’d
()) {

722 
is_©_’d
 = 
Œue
;

723 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Unexpectedƒnd of…osting†ist for `" +

724 
‹rm
 + "'");

726 cÚ¡ * 
keypos
 = 
cursÜ
->
cu¼’t_key
.
	`d©a
();

727 cÚ¡ * 
key’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
	`size
();

729 ià(!
	`check_Šame_š_key_l™e
(&
keypos
, 
key’d
, 
‹rm
)) {

730 
is_©_’d
 = 
Œue
;

731 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Unexpectedƒnd of…osting†ist for `" +

732 
‹rm
 + "'");

735 
X­Ÿn
::
docid
 
Ãwdid
;

736 ià(!
	`F_uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
Ãwdid
)) {

737 
	`»pÜt_»ad_”rÜ
(
keypos
);

739 ià(
Ãwdid
 <ğ
did
) {

740 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Document ID in‚ew chunk of…ostlist (" +

741 
	`om_to¡ršg
(
Ãwdid
) +

743 
	`om_to¡ršg
(
did
) + ")");

745 
did
 = 
Ãwdid
;

747 
cursÜ
->
	`»ad_g
();

748 
pos
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

749 
’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
	`size
();

751 
fœ¡_did_š_chunk
 = 
did
;

752 
Ï¡_did_š_chunk
 = 
	`»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

753 &
is_Ï¡_chunk
);

754 
	`»ad_wdf_ªd_Ëngth
(&
pos
, 
’d
, &
wdf
, &
doş’gth
);

755 
	}
}

757 
Pos™iÚLi¡
 *

758 
	gFlštPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

760 
	`DEBUGCALL
(
DB
, 
Pos™iÚLi¡
 *, "FlintPostList::read_position_list", "");

761 
pos™iÚli¡
.
	`»ad_d©a
(&
this_db
->
pos™iÚ_bË
, 
did
, 
‹rm
);

762 
	`RETURN
(&
pos™iÚli¡
);

763 
	}
}

765 
Pos™iÚLi¡
 *

766 
	gFlštPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

768 
	`DEBUGCALL
(
DB
, 
Pos™iÚLi¡
 *, "FlintPostList::open_position_list", "");

769 
	`RETURN
(
Ãw
 
	`FlštPos™iÚLi¡
(&
this_db
->
pos™iÚ_bË
, 
did
, 
‹rm
));

770 
	}
}

772 
Po¡Li¡
 *

773 
	gFlštPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

775 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *, "FlštPo¡Li¡::Ãxt", 
w_mš
);

776 ()
	gw_mš
;

778 ià(!
	ghave_¡¬‹d
) {

779 
	ghave_¡¬‹d
 = 
Œue
;

781 ià(!
Ãxt_š_chunk
()è
Ãxt_chunk
();

784 ià(
	gis_©_’d
) {

785 
LOGLINE
(
DB
, "Movedoƒnd");

787 
LOGLINE
(
DB
, "MovedØdocid " << 
did
 << ", wdàğ" << 
wdf
 <<

788 ", doş’gth = " << 
doş’gth
);

791 
RETURN
(
NULL
);

794 
boŞ


795 
	gFlštPo¡Li¡
::
cu¼’t_chunk_cÚšs
(
X­Ÿn
::
docid
 
desœed_did
)

797 
DEBUGCALL
(
DB
, 
boŞ
, "FlštPo¡Li¡::cu¼’t_chunk_cÚšs", 
desœed_did
);

798 ià(
	gdesœed_did
 >ğ
fœ¡_did_š_chunk
 &&

799 
desœed_did
 <ğ
Ï¡_did_š_chunk
) {

800 
RETURN
(
Œue
);

802 
RETURN
(
çl£
);

806 
	gFlštPo¡Li¡
::
move_to_chunk_cÚššg
(
X­Ÿn
::
docid
 
desœed_did
)

808 
DEBUGCALL
(
DB
, ,

809 "FlštPo¡Li¡::move_to_chunk_cÚššg", 
desœed_did
);

810 ()
	gcursÜ
->
fšd_’Œy
(
FlštPo¡Li¡TabË
::
make_key
(
‹rm
, 
desœed_did
));

811 
As£¹
(!
cursÜ
->
aá”_’d
());

813 cÚ¡ * 
	gkeypos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

814 cÚ¡ * 
	gkey’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
size
();

816 ià(!
check_Šame_š_key_l™e
(&
keypos
, 
key’d
, 
‹rm
)) {

818 
	gis_©_’d
 = 
Œue
;

819 
	gis_Ï¡_chunk
 = 
Œue
;

822 
	gis_©_’d
 = 
çl£
;

824 
	gcursÜ
->
»ad_g
();

825 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

826 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

828 ià(
	gkeypos
 =ğ
key’d
) {

830 #ifdeà
XAPIAN_ASSERTIONS


831 
X­Ÿn
::
doccouÁ
 
Şd_numb”_of_’Œ›s
 = 
numb”_of_’Œ›s
;

832 
	gdid
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, &
numb”_of_’Œ›s
, 
NULL
);

833 
As£¹
(
Şd_numb”_of_’Œ›s
 =ğ
numb”_of_’Œ›s
);

835 
	gdid
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, 
NULL
, NULL);

839 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
, &
did
)) {

840 
»pÜt_»ad_”rÜ
(
keypos
);

844 
	gfœ¡_did_š_chunk
 = 
did
;

845 
	gÏ¡_did_š_chunk
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
,

846 &
is_Ï¡_chunk
);

847 
»ad_wdf_ªd_Ëngth
(&
pos
, 
’d
, &
wdf
, &
doş’gth
);

851 ià(
	gdesœed_did
 > 
	gÏ¡_did_š_chunk
è
Ãxt_chunk
();

854 
boŞ


855 
	gFlštPo¡Li¡
::
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
X­Ÿn
::
docid
 
desœed_did
)

857 
DEBUGCALL
(
DB
, 
boŞ
,

858 "FlštPo¡Li¡::move_fÜw¬d_š_chunk_to_©_Ëa¡", 
desœed_did
);

859 ià(
	gdesœed_did
 > 
	gÏ¡_did_š_chunk
) {

860 
	gpos
 = 
’d
;

861 
RETURN
(
çl£
);

863 
	gdid
 < 
	gdesœed_did
) {

866 
boŞ
 
	g©_’d_of_chunk
 = !
Ãxt_š_chunk
();

867 ià(
	g©_’d_of_chunk
è
RETURN
(
çl£
);

869 
RETURN
(
Œue
);

872 
Po¡Li¡
 *

873 
	gFlštPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
)

875 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *,

876 "FlštPo¡Li¡::sk_to", 
desœed_did
 << ", " << 
w_mš
);

877 ()
	gw_mš
;

880 
	ghave_¡¬‹d
 = 
Œue
;

883 ià(
	gis_©_’d
 || 
	gdesœed_did
 <ğ
did
è
RETURN
(
NULL
);

886 ià(!
cu¼’t_chunk_cÚšs
(
desœed_did
)) {

887 
move_to_chunk_cÚššg
(
desœed_did
);

890 ià(
	gis_©_’d
è
RETURN
(
NULL
);

894 
boŞ
 
	ghave_docum’t
 = 
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
desœed_did
);

895 ()
	ghave_docum’t
;

896 
As£¹
(
have_docum’t
);

898 ià(
	gis_©_’d
) {

899 
LOGLINE
(
DB
, "Skippedoƒnd");

901 
LOGLINE
(
DB
, "Sk³dØdocid " << 
did
 << ", wdàğ" << 
wdf
 <<

902 ", doş’gth = " << 
doş’gth
);

905 
RETURN
(
NULL
);

908 
¡ršg


909 
	gFlštPo¡Li¡
::
	$g‘_desütiÚ
() const

911  
‹rm
 + ":" + 
	`om_to¡ršg
(
numb”_of_’Œ›s
);

912 
	}
}

915 
	gX­Ÿn
::
docid


916 
FlštPo¡Li¡TabË
::
g‘_chunk
(cÚ¡ 
¡ršg
 &
Šame
,

917 
X­Ÿn
::
docid
 
did
, 
boŞ
 
addšg
,

918 
FlštPo¡li¡ChunkR—d”
 ** 
äom
, 
FlštPo¡li¡ChunkWr™”
 **
to
)

921 
¡ršg
 
	gkey
 = 
make_key
(
Šame
, 
did
);

924 
	gAutoPŒ
<
	gFlštCursÜ
> 
cursÜ
(
cursÜ_g‘
());

926 
	gcursÜ
->
fšd_’Œy
(
key
);

927 
As£¹
(!
cursÜ
->
aá”_’d
());

929 cÚ¡ * 
	gkeypos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

930 cÚ¡ * 
	gkey’d
 = 
keypos
 + 
cursÜ
->
cu¼’t_key
.
size
();

932 ià(!
check_Šame_š_key
(&
keypos
, 
key’d
, 
Šame
)) {

934 ià(!
	gaddšg
)

935 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("A‰em±edØd–‘Ü modify‡À’Œy iÀ¨nÚ-exi¡’ˆpo¡šg†i¡ fÜ " + 
Šame
);

937 *
	gäom
 = 
NULL
;

938 *
	gto
 = 
Ãw
 
FlštPo¡li¡ChunkWr™”
(
¡ršg
(), 
Œue
, 
Šame
,rue);

939  
	gX­Ÿn
::
docid
(-1);

944 
boŞ
 
	gis_fœ¡_chunk
 = (
keypos
 =ğ
key’d
);

946 
	gcursÜ
->
»ad_g
();

947 cÚ¡ * 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

948 cÚ¡ * 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

949 
	gX­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

950 ià(
	gis_fœ¡_chunk
) {

951 
	gfœ¡_did_š_chunk
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
, 
NULL
, NULL);

953 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
keypos
, 
key’d
,

954 &
fœ¡_did_š_chunk
)) {

955 
»pÜt_»ad_”rÜ
(
keypos
);

959 
boŞ
 
	gis_Ï¡_chunk
;

960 
	gX­Ÿn
::
docid
 
Ï¡_did_š_chunk
;

961 
	gÏ¡_did_š_chunk
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡_did_š_chunk
, &
is_Ï¡_chunk
);

962 *
	gto
 = 
Ãw
 
FlštPo¡li¡ChunkWr™”
(
cursÜ
->
cu¼’t_key
, 
is_fœ¡_chunk
, 
Šame
,

963 
is_Ï¡_chunk
);

964 ià(
	gdid
 > 
	gÏ¡_did_š_chunk
) {

968 *
	gäom
 = 
NULL
;

969 (*
	gto
)->
¿w_­³nd
(
fœ¡_did_š_chunk
, 
Ï¡_did_š_chunk
,

970 
¡ršg
(
pos
, 
’d
));

972 *
	gäom
 = 
Ãw
 
FlštPo¡li¡ChunkR—d”
(
fœ¡_did_š_chunk
, 
¡ršg
(
pos
, 
’d
));

974 ià(
	gis_Ï¡_chunk
è 
	gX­Ÿn
::
docid
(-1);

977 
	gcursÜ
->
Ãxt
();

978 ià(
	gcursÜ
->
aá”_’d
()) {

979 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Expected‡nother key but found‚one");

981 cÚ¡ *
	gkpos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

982 cÚ¡ *
	gk’d
 = 
kpos
 + 
cursÜ
->
cu¼’t_key
.
size
();

983 ià(!
check_Šame_š_key
(&
kpos
, 
k’d
, 
Šame
)) {

984 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Expected‡nother key withhe sameerm‚ame but found‡ different one");

988 
	gX­Ÿn
::
docid
 
fœ¡_did_of_Ãxt_chunk
;

989 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
kpos
, 
k’d
, &
fœ¡_did_of_Ãxt_chunk
)) {

990 
»pÜt_»ad_”rÜ
(
kpos
);

992  
	gfœ¡_did_of_Ãxt_chunk
 - 1;

996 
	gFlštPo¡Li¡TabË
::
m”ge_chªges
(

997 cÚ¡ 
m­
<
¡ršg
, m­<
X­Ÿn
::
docid
, 
·œ
<, X­Ÿn::
‹rmcouÁ
> > > & 
mod_¶i¡s
,

998 cÚ¡ 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> & 
doş’s
,

999 cÚ¡ 
m­
<
¡ršg
, 
·œ
<
X­Ÿn
::
‹rmcouÁ_diff
, X­Ÿn::‹rmcouÁ_diff> > & 
äeq_d–s
)

1001 
DEBUGCALL
(
DB
, , "FlintPostListTable::merge_changes", "mod_plists, doclens, freq_deltas");

1002 
	gm­
<
	g¡ršg
, m­<
	gX­Ÿn
::
docid
, 
	g·œ
<, X­Ÿn::
‹rmcouÁ
> > >::
cÚ¡_™”©Ü
 
i
;

1003 
	gi
 = 
mod_¶i¡s
.
begš
(); i !ğmod_¶i¡s.
’d
(); ++i) {

1004 ià(
	gi
->
	g£cÚd
.
em±y
()) ;

1005 
¡ršg
 
	gŠame
 = 
i
->
fœ¡
;

1009 
	gm­
<
	g¡ršg
, 
	g·œ
<
	gX­Ÿn
::
‹rmcouÁ_diff
, X­Ÿn::‹rmcouÁ_diff> >::
cÚ¡_™”©Ü
 
d–s
 = 
äeq_d–s
.
fšd
(
Šame
);

1010 
As£¹
(
d–s
 !ğ
äeq_d–s
.
’d
());

1012 
¡ršg
 
	gcu¼’t_key
 = 
make_key
(
Šame
);

1013 
¡ršg
 
	gg
;

1014 ()
g‘_exaù_’Œy
(
cu¼’t_key
, 
g
);

1017 cÚ¡ *
	gpos
 = 
g
.
d©a
();

1018 cÚ¡ *
	g’d
 = 
pos
 + 
g
.
size
();

1019 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq
;

1020 
	gX­Ÿn
::
‹rmcouÁ
 
cŞläeq
;

1021 
	gX­Ÿn
::
docid
 
fœ¡did
, 
	gÏ¡did
;

1022 
boŞ
 
	gi¦a¡
;

1023 ià(
	gpos
 =ğ
’d
) {

1024 
‹rmäeq
 = 0;

1025 
	gcŞläeq
 = 0;

1026 
	gfœ¡did
 = 0;

1027 
	gÏ¡did
 = 0;

1028 
	gi¦a¡
 = 
Œue
;

1030 
	gfœ¡did
 = 
»ad_¡¬t_of_fœ¡_chunk
(&
pos
, 
’d
,

1031 &
‹rmäeq
, &
cŞläeq
);

1033 
	gÏ¡did
 = 
»ad_¡¬t_of_chunk
(&
pos
, 
’d
, 
fœ¡did
, &
i¦a¡
);

1036 
	g‹rmäeq
 +ğ
d–s
->
£cÚd
.
fœ¡
;

1037 ià(
	g‹rmäeq
 == 0) {

1040 ià(
i¦a¡
) {

1042 
d–
(
cu¼’t_key
);

1045 
	gAutoPŒ
<
	gFlštCursÜ
> 
cursÜ
(
cursÜ_g‘
());

1046 
boŞ
 
	gfound
 = 
cursÜ
->
fšd_’Œy
(
cu¼’t_key
);

1047 
As£¹
(
found
);

1048 ià(!
	gfound
) ;

1049 
	gcursÜ
->
d–
()) {

1050 cÚ¡ *
	gkpos
 = 
cursÜ
->
cu¼’t_key
.
d©a
();

1051 cÚ¡ *
	gk’d
 = 
kpos
 + 
cursÜ
->
cu¼’t_key
.
size
();

1052 ià(!
check_Šame_š_key_l™e
(&
kpos
, 
k’d
, 
Šame
)) ;

1056 
	gcŞläeq
 +ğ
d–s
->
£cÚd
.second;

1059 
¡ršg
 
	gÃwhdr
 = 
make_¡¬t_of_fœ¡_chunk
(
‹rmäeq
, 
cŞläeq
, 
fœ¡did
);

1060 
	gÃwhdr
 +ğ
make_¡¬t_of_chunk
(
i¦a¡
, 
fœ¡did
, 
Ï¡did
);

1061 ià(
	gpos
 =ğ
’d
) {

1062 
add
(
cu¼’t_key
, 
Ãwhdr
);

1064 
As£¹
((
size_t
)(
pos
 - 
g
.
d©a
()è<ğg.
size
());

1065 
	gg
.
»¶aû
(0, 
pos
 - 
g
.
d©a
(), 
Ãwhdr
);

1066 
add
(
cu¼’t_key
, 
g
);

1069 
	gm­
<
	gX­Ÿn
::
docid
, 
	g·œ
<, X­Ÿn::
‹rmcouÁ
> >::
cÚ¡_™”©Ü
 
j
;

1070 
	gj
 = 
i
->
£cÚd
.
begš
();

1071 
As£¹
(
j
 !ğ
i
->
£cÚd
.
’d
());

1073 
	gX­Ÿn
::
docid
 
max_did
;

1074 
FlštPo¡li¡ChunkR—d”
 *
	gäom
;

1075 
FlštPo¡li¡ChunkWr™”
 *
	gto
;

1076 
	gmax_did
 = 
g‘_chunk
(
Šame
, 
j
->
fœ¡
, j->
£cÚd
.first == 'A',

1077 &
äom
, &
to
);

1078  ; 
	gj
 !ğ
i
->
£cÚd
.
’d
(); ++j) {

1079 
	gX­Ÿn
::
docid
 
did
 = 
j
->
fœ¡
;

1081 
	gÃxt_chunk
:

1082 
LOGLINE
(
DB
, "Upd©šgÇme=" << 
Šame
 << ", did=" << 
did
);

1083 ià(
	gäom
è!äom->
is_©_’d
()) {

1084 
	gX­Ÿn
::
docid
 
cİy_did
 = 
äom
->
g‘_docid
();

1085 ià(
	gcİy_did
 >ğ
did
) {

1086 ià(
cİy_did
 =ğ
did
) {

1087 
As£¹
(
j
->
£cÚd
.
fœ¡
 != 'A');

1088 
	gäom
->
Ãxt
();

1092 
	gto
->
­³nd
(
this
, 
cİy_did
,

1093 
äom
->
g‘_wdf
(), from->
g‘_doş’gth
());

1094 
	gäom
->
Ãxt
();

1096 ià((!
	gäom
 || from->
is_©_’d
()è&& 
	gdid
 > 
	gmax_did
) {

1097 
d–‘e
 
	gäom
;

1098 
	gto
->
æush
(
this
);

1099 
d–‘e
 
	gto
;

1100 
	gmax_did
 = 
g‘_chunk
(
Šame
, 
did
, 
çl£
, &
äom
, &
to
);

1101 
	gÃxt_chunk
;

1104 ià(
	gj
->
	g£cÚd
.
	gfœ¡
 != 'D') {

1105 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
k
 = 
doş’s
.
fšd
(
did
);

1106 
As£¹
(
k
 !ğ
doş’s
.
’d
());

1107 
	gX­Ÿn
::
‹rmcouÁ
 
Ãw_doş’
 = 
k
->
£cÚd
;

1108 
	gX­Ÿn
::
‹rmcouÁ
 
Ãw_wdf
 = 
j
->
£cÚd
.second;

1110 
	gto
->
­³nd
(
this
, 
did
, 
Ãw_wdf
, 
Ãw_doş’
);

1114 ià(
	gäom
) {

1115 !
	gäom
->
is_©_’d
()) {

1116 
	gto
->
­³nd
(
this
, 
äom
->
g‘_docid
(),

1117 
äom
->
g‘_wdf
(), from->
g‘_doş’gth
());

1118 
	gäom
->
Ãxt
();

1120 
d–‘e
 
	gäom
;

1122 
	gto
->
æush
(
this
);

1123 
d–‘e
 
	gto
;

	@backends/flint/flint_postlist.h

24 #iâdeà
OM_HGUARD_FLINT_POSTLIST_H


25 
	#OM_HGUARD_FLINT_POSTLIST_H


	)

27 
	~<x­Ÿn/d©aba£.h
>

29 
	~"æšt_ty³s.h
"

30 
	~"æšt_pos™iÚli¡.h
"

31 
	~"Ëaåo¡li¡.h
"

32 
	~"omas£¹.h
"

33 
	~"omdebug.h
"

35 
	~"autİŒ.h
"

36 
	~<m­
>

37 
	~<¡ršg
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
şass
 
	gFlštCursÜ
;

42 
şass
 
	gFlštD©aba£
;

44 
şass
 
	gFlštPo¡li¡ChunkR—d”
;

45 
şass
 
	gFlštPo¡li¡ChunkWr™”
;

47 şas 
	cFlštPo¡Li¡TabË
 : 
public
 
FlštTabË
 {

48 
public
:

61 
	$FlštPo¡Li¡TabË
(cÚ¡ 
¡ršg
 & 
·th_
, 
boŞ
 
»adÚly_
)

62 : 
	`FlštTabË
("po¡li¡", 
·th_
 + "/po¡li¡.", 
»adÚly_
) { }

65 
	`m”ge_chªges
(

66 cÚ¡ 
m­
<
¡ršg
, m­<
X­Ÿn
::
docid
, 
·œ
<, X­Ÿn::
‹rmcouÁ
> > > & 
mod_¶i¡s
,

67 cÚ¡ 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
‹rmcouÁ
> & 
doş’s
,

68 cÚ¡ 
m­
<
¡ršg
, 
·œ
<
X­Ÿn
::
‹rmcouÁ_diff
, X­Ÿn::‹rmcouÁ_diff> > & 
äeq_d–s
);

70 
X­Ÿn
::
docid
 
	`g‘_chunk
(cÚ¡ 
¡ršg
 &
Šame
,

71 
X­Ÿn
::
docid
 
did
, 
boŞ
 
addšg
,

72 
FlštPo¡li¡ChunkR—d”
 ** 
äom
, 
FlštPo¡li¡ChunkWr™”
 **
to
);

75 
¡ršg
 
	`make_key
(cÚ¡ sŒšg & 
‹rm
, 
X­Ÿn
::
docid
 
did
) {

76 
¡ršg
 
key
 = 
	`F_·ck_¡ršg_´e£rvšg_sÜt
(
‹rm
);

77 
key
 +ğ
	`F_·ck_ušt_´e£rvšg_sÜt
(
did
);

78  
key
;

79 
	}
}

82 
¡ršg
 
	$make_key
(cÚ¡ 
¡ršg
 & 
‹rm
) {

83  
	`F_·ck_¡ršg_´e£rvšg_sÜt
(
‹rm
);

84 
	}
}

86 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
‹rm
) const {

87  
	`key_exi¡s
(
	`make_key
(
‹rm
));

88 
	}
}

94 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

100 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

105 şas 
	cFlštPo¡Li¡
 : 
public
 
L—fPo¡Li¡
 {

106 
´Ùeùed
:

111 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
this_db
;

114 
boŞ
 
	mhave_¡¬‹d
;

117 
FlštPos™iÚLi¡
 
	mpos™iÚli¡
;

119 
	m´iv©e
:

121 
AutoPŒ
<
FlštCursÜ
> 
cursÜ
;

124 
boŞ
 
	mis_Ï¡_chunk
;

127 
	mX­Ÿn
::
docid
 
fœ¡_did_š_chunk
;

130 
	mX­Ÿn
::
docid
 
Ï¡_did_š_chunk
;

133 cÚ¡ * 
	mpos
;

136 cÚ¡ * 
	m’d
;

139 
	mX­Ÿn
::
docid
 
did
;

142 
æšt_doş’_t
 
	mdoş’gth
;

145 
	mX­Ÿn
::
‹rmcouÁ
 
wdf
;

148 
boŞ
 
	mis_©_’d
;

151 
	mX­Ÿn
::
doccouÁ
 
numb”_of_’Œ›s
;

154 
FlštPo¡Li¡
(const FlintPostList &);

157 
	mİ”©Ü
=(cÚ¡ 
FlštPo¡Li¡
 &);

162 
boŞ
 
Ãxt_š_chunk
();

169 
Ãxt_chunk
();

178 
boŞ
 
cu¼’t_chunk_cÚšs
(
X­Ÿn
::
docid
 
desœed_did
);

191 
move_to_chunk_cÚššg
(
X­Ÿn
::
docid
 
desœed_did
);

202 
boŞ
 
move_fÜw¬d_š_chunk_to_©_Ëa¡
(
X­Ÿn
::
docid
 
desœed_did
);

204 
	mpublic
:

206 
FlštPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
this_db_
,

207 cÚ¡ 
¡ršg
 & 
‹rm_
);

210 ~
FlštPo¡Li¡
();

216 
	mX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(ècÚ¡ {  
numb”_of_’Œ›s
; }

219 
X­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ { 
	`As£¹
(
have_¡¬‹d
);  
did
; 
	}
}

222 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const {

223 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintPostList::get_doclength", "");

224 
	`As£¹
(
have_¡¬‹d
);

225 
	`RETURN
(
¡©ic_ÿ¡
<
X­Ÿn
::
‹rmcouÁ
>(
doş’gth
));

226 
	}
}

231 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
(ècÚ¡ { 
	`As£¹
(
have_¡¬‹d
);  
wdf
; 
	}
}

235 
Pos™iÚLi¡
 *
»ad_pos™iÚ_li¡
();

239 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

242 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

245 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
desœed_did
, X­Ÿn::
weight
 
w_mš
);

248 
boŞ
 
	$©_’d
(ècÚ¡ {  
is_©_’d
; 
	}
}

251 
	g¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

254 
	`»ad_numb”_of_’Œ›s
(cÚ¡ ** 
po¥Œ
,

255 cÚ¡ * 
’d
,

256 
X­Ÿn
::
doccouÁ
 * 
numb”_of_’Œ›s_±r
,

257 
X­Ÿn
::
‹rmcouÁ
 * 
cŞËùiÚ_äeq_±r
);

258 
	}
};

	@backends/flint/flint_record.cc

22 
	~<cÚfig.h
>

23 
	~"æšt_»cÜd.h
"

24 
	~"æšt_uts.h
"

25 
	~"uts.h
"

26 
	~<x­Ÿn/”rÜ.h
>

27 
	~"omas£¹.h
"

28 
	~"omdebug.h
"

30 
usšg
 
	g¡d
::
¡ršg
;

32 
¡ršg


33 
	gFlštRecÜdTabË
::
g‘_»cÜd
(
X­Ÿn
::
docid
 
did
) const

35 
DEBUGCALL
(
DB
, 
¡ršg
, "FlštRecÜdTabË::g‘_»cÜd", 
did
);

36 
¡ršg
 
	gg
;

38 ià(!
g‘_exaù_’Œy
(
æšt_docid_to_key
(
did
), 
g
)) {

39 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Docum’ˆ" + 
om_to¡ršg
(
did
) + "‚ot found.");

42 
RETURN
(
g
);

45 
	gX­Ÿn
::
doccouÁ


46 
FlštRecÜdTabË
::
	$g‘_doccouÁ
() const

48 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "FlintRecordTable::get_doccount", "");

49 
	`STATIC_ASSERT_TYPE_DOMINATES
(
X­Ÿn
::
doccouÁ
, 
æšt_bËsize_t
);

50 
	`RETURN
(
	`g‘_’Œy_couÁ
());

51 
	}
}

54 
	gFlštRecÜdTabË
::
»¶aû_»cÜd
(cÚ¡ 
¡ršg
 & 
d©a
, 
X­Ÿn
::
docid
 
did
)

56 
DEBUGCALL
(
DB
, , "FlštRecÜdTabË::»¶aû_»cÜd", 
d©a
 << ", " << 
did
);

57 
add
(
æšt_docid_to_key
(
did
), 
d©a
);

61 
	gFlštRecÜdTabË
::
d–‘e_»cÜd
(
X­Ÿn
::
docid
 
did
)

63 
DEBUGCALL
(
DB
, , "FlštRecÜdTabË::d–‘e_»cÜd", 
did
);

64 ià(!
d–
(
æšt_docid_to_key
(
did
)))

65 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Cª'ˆd–‘nÚ-exi¡’ˆdocum’ˆ#" + 
om_to¡ršg
(
did
));

	@backends/flint/flint_record.h

23 #iâdeà
OM_HGUARD_FLINT_RECORD_H


24 
	#OM_HGUARD_FLINT_RECORD_H


	)

26 
	~<¡ršg
>

28 
	~<x­Ÿn/ty³s.h
>

29 
	~"æšt_ty³s.h
"

30 
	~"æšt_bË.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

36 şas 
	cFlštRecÜdTabË
 : 
public
 
FlštTabË
 {

37 
public
:

50 
	$FlštRecÜdTabË
(cÚ¡ 
¡ršg
 & 
·th_
, 
boŞ
 
»adÚly_
)

51 : 
	`FlštTabË
("»cÜd", 
·th_
 + "/»cÜd.", 
»adÚly_
, 
Z_DEFAULT_STRATEGY
) { }

55 
¡ršg
 
	`g‘_»cÜd
(
X­Ÿn
::
docid
 
did
) const;

59 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

65 
	`»¶aû_»cÜd
(cÚ¡ 
¡ršg
 & 
d©a
, 
X­Ÿn
::
docid
 
did
);

69 
	`d–‘e_»cÜd
(
X­Ÿn
::
docid
 
did
);

70 
	}
};

	@backends/flint/flint_replicate_internal.h

22 #iâdeà
XAPIAN_INCLUDED_FLINT_REPLICATE_INTERNAL_H


23 
	#XAPIAN_INCLUDED_FLINT_REPLICATE_INTERNAL_H


	)

26 
	#CHANGES_MAGIC_STRING
 "FlštChªges"

	)

30 
	#CHANGES_VERSION
 1u

	)

34 
	#REASONABLE_CHANGESET_SIZE
 1024

	)

	@backends/flint/flint_spelling.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/”rÜ.h
>

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"ex·ndweight.h
"

27 
	~"æšt_¥–lšg.h
"

28 
	~"æšt_uts.h
"

29 
	~"omas£¹.h
"

30 
	~"Ü‹rmli¡.h
"

32 
	~<®gÜ™hm
>

33 
	~<m­
>

34 
	~<queue
>

35 
	~<veùÜ
>

36 
	~<£t
>

37 
	~<¡ršg
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

45 
	#MAGIC_XOR_VALUE
 96

	)

47 şas 
	cP»fixCom´es£dSŒšgItÜ
 {

48 cÚ¡ * 
	mp
;

49 
size_t
 
	mËá
;

50 
¡ršg
 
	mcu¼’t
;

52 
	$P»fixCom´es£dSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
,

53 cÚ¡ 
¡ršg
 &
cu¼’t_
)

54 : 
	`p
(
p_
), 
	`Ëá
(
Ëá_
), 
	$cu¼’t
(
cu¼’t_
) { }

56 
public
:

57 
	`P»fixCom´es£dSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

58 : 
	`p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
	`d©a
())),

59 
	`Ëá
(
s
.
	$size
()) {

60 ià(
Ëá
) {

61 
İ”©Ü
++();

63 
p
 = 
NULL
;

65 
	}
}

67 cÚ¡ 
	g¡ršg
 & 
	gİ”©Ü
*() const {

68  
	gcu¼’t
;

71 
P»fixCom´es£dSŒšgItÜ
 
	gİ”©Ü
++() {

72 cÚ¡ * 
	gŞd_p
 = 
p
;

73 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

74 
¡ršg
 
	gŞd_cu¼’t
 = 
cu¼’t
;

75 
	gİ”©Ü
++();

76  
P»fixCom´es£dSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
, 
Şd_cu¼’t
);

79 
	gP»fixCom´es£dSŒšgItÜ
 & 
	gİ”©Ü
++() {

80 ià(
	gËá
 == 0) {

81 
p
 = 
NULL
;

83 ià(!
	gcu¼’t
.
em±y
()) {

84 
	gcu¼’t
.
»size
(*
p
++ ^ 
MAGIC_XOR_VALUE
);

85 --
	gËá
;

87 
size_t
 
	gadd
;

88 ià(
	gËá
 =ğ0 || (
add
 = *
p
 ^ 
MAGIC_XOR_VALUE
è>ğ
Ëá
)

89 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling data (too†ittle†eft)");

90 
	gcu¼’t
.
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
add
);

91 
	gp
 +ğ
add
 + 1;

92 
	gËá
 -ğ
add
 + 1;

94  *
	gthis
;

97 
boŞ
 
	$©_’d
() const {

98  
p
 =ğ
NULL
;

99 
	}
}

102 şas 
	cP»fixCom´es£dSŒšgWr™”
 {

103 
¡ršg
 
	mcu¼’t
;

104 
	m¡ršg
 & 
	mout
;

106 
	mpublic
:

107 
	$P»fixCom´es£dSŒšgWr™”
(
¡ršg
 & 
out_
è: 
	$out
(
out_
) { }

109 
	$­³nd
(cÚ¡ 
¡ršg
 & 
wÜd
) {

112 ià(!
cu¼’t
.
	`em±y
()) {

113 
size_t
 
Ën
 = 
	`mš
(
cu¼’t
.
	`size
(), 
wÜd
.size());

114 
size_t
 
i
;

115 
i
 = 0; i < 
Ën
; ++i) {

116 ià(
cu¼’t
[
i
] !ğ
wÜd
[i]) ;

118 
out
 +ğ(
i
 ^ 
MAGIC_XOR_VALUE
);

119 
out
 +ğ((
wÜd
.
	`size
(è- 
i
è^ 
MAGIC_XOR_VALUE
);

120 
out
.
	`­³nd
(
wÜd
.
	`d©a
(è+ 
i
, wÜd.
	`size
() - i);

122 
out
 +ğ(
wÜd
.
	`size
(è^ 
MAGIC_XOR_VALUE
);

123 
out
 +ğ
wÜd
;

125 
cu¼’t
 = 
wÜd
;

126 
	}
}

130 
	gFlštS³ÎšgTabË
::
	$m”ge_chªges
()

132 
m­
<
F_äagm’t
, 
£t
<
¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

133 
i
 = 
‹rmli¡_d–s
.
	`begš
(); i !ğ‹rmli¡_d–s.
	`’d
(); ++i) {

134 
¡ršg
 
key
 = 
i
->
fœ¡
;

135 cÚ¡ 
£t
<
¡ršg
> & 
chªges
 = 
i
->
£cÚd
;

137 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
d
 = 
chªges
.
	`begš
();

138 ià(
d
 =ğ
chªges
.
	`’d
()) ;

140 
¡ršg
 
upd©ed
;

141 
¡ršg
 
cu¼’t
;

142 
P»fixCom´es£dSŒšgWr™”
 
	`out
(
upd©ed
);

143 ià(
	`g‘_exaù_’Œy
(
key
, 
cu¼’t
)) {

144 
P»fixCom´es£dSŒšgItÜ
 
	`š
(
cu¼’t
);

145 
upd©ed
.
	`»£rve
(
cu¼’t
.
	`size
());

146 !
š
.
	`©_’d
(è&& 
d
 !ğ
chªges
.
	`’d
()) {

147 cÚ¡ 
¡ršg
 & 
wÜd
 = *
š
;

148 
	`As£¹
(
d
 !ğ
chªges
.
	`’d
());

149 
cmp
 = 
wÜd
.
	`com·»
(*
d
);

150 ià(
cmp
 < 0) {

151 
out
.
	`­³nd
(
wÜd
);

152 ++
š
;

153 } ià(
cmp
 > 0) {

154 
out
.
	`­³nd
(*
d
);

155 ++
d
;

159 ++
š
;

160 ++
d
;

163 ià(!
š
.
	`©_’d
()) {

165 !
š
.
	`©_’d
()) {

166 
out
.
	`­³nd
(*
š
++);

170 
d
 !ğ
chªges
.
	`’d
()) {

171 
out
.
	`­³nd
(*
d
++);

173 ià(!
upd©ed
.
	`em±y
()) {

174 
	`add
(
key
, 
upd©ed
);

176 
	`d–
(
key
);

179 
‹rmli¡_d–s
.
	`ş—r
();

181 
m­
<
¡ršg
, 
X­Ÿn
::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
j
;

182 
j
 = 
wÜdäeq_chªges
.
	`begš
(); j !ğwÜdäeq_chªges.
	`’d
(); ++j) {

183 
¡ršg
 
key
 = "W" + 
j
->
fœ¡
;

184 ià(
j
->
£cÚd
) {

185 
	`add
(
key
, 
	`F_·ck_ušt_Ï¡
(
j
->
£cÚd
));

187 
	`d–
(
key
);

190 
wÜdäeq_chªges
.
	`ş—r
();

191 
	}
}

194 
	gFlštS³ÎšgTabË
::
	$toggË_äagm’t
(
F_äagm’t
 
äag
, cÚ¡ 
¡ršg
 & 
wÜd
)

196 
m­
<
F_äagm’t
, 
£t
<
¡ršg
> >::
™”©Ü
 
i
 = 
‹rmli¡_d–s
.
	`fšd
(
äag
);

197 ià(
i
 =ğ
‹rmli¡_d–s
.
	`’d
()) {

198 
i
 = 
‹rmli¡_d–s
.
	`š£¹
(
	`make_·œ
(
äag
, 
£t
<
¡ršg
>())).
fœ¡
;

202 
·œ
<
£t
<
¡ršg
>::
™”©Ü
, 
boŞ
> 
»s
 = 
i
->
£cÚd
.
	`š£¹
(
wÜd
);

203 ià(!
»s
.
£cÚd
) {

205 
i
->
£cÚd
.
	`”a£
(
»s
.
fœ¡
);

207 
	}
}

210 
	gFlštS³ÎšgTabË
::
add_wÜd
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
)

212 ià(
wÜd
.
size
() <= 1) ;

214 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
‹rmcouÁ
>::
™”©Ü
 
i
 = 
wÜdäeq_chªges
.
fšd
(
wÜd
);

215 ià(
	gi
 !ğ
wÜdäeq_chªges
.
’d
()) {

217 ià(
i
->
£cÚd
) {

218 
i
->
£cÚd
 +ğ
äeqšc
;

223 
	gi
->
	g£cÚd
 = 
äeqšc
;

225 
¡ršg
 
	gkey
 = "W" + 
wÜd
;

226 
¡ršg
 
	gd©a
;

227 ià(
g‘_exaù_’Œy
(
key
, 
d©a
)) {

229 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

230 cÚ¡ * 
	gp
 = 
d©a
.data();

231 ià(!
F_uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
size
(), &
äeq
è|| 
	gäeq
 == 0) {

232 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

234 
	gwÜdäeq_chªges
[
wÜd
] = 
äeq
 + 
äeqšc
;

237 
	gwÜdäeq_chªges
[
wÜd
] = 
äeqšc
;

242 
F_äagm’t
 
	gbuf
;

244 
	gbuf
[0] = 'H';

245 
	gbuf
[1] = 
wÜd
[0];

246 
	gbuf
[2] = 
wÜd
[1];

247 
	gbuf
[3] = '\0';

248 
toggË_äagm’t
(
buf
, 
wÜd
);

251 
	gbuf
[0] = 'T';

252 
	gbuf
[1] = 
wÜd
[wÜd.
size
() - 2];

253 
	gbuf
[2] = 
wÜd
[wÜd.
size
() - 1];

254 
	gbuf
[3] = '\0';

255 
toggË_äagm’t
(
buf
, 
wÜd
);

257 ià(
	gwÜd
.
size
() <= 4) {

264 
buf
[0] = 'B';

265 
	gbuf
[1] = 
wÜd
[0];

266 
	gbuf
[3] = '\0';

267 
toggË_äagm’t
(
buf
, 
wÜd
);

269 ià(
	gwÜd
.
size
() > 2) {

271 
	gbuf
[0] = 'M';

272 
size_t
 
	g¡¬t
 = 0; s¹ <ğ
wÜd
.
size
() - 3; ++start) {

273 
memıy
(
buf
.
d©a
 + 1, 
wÜd
.d©a(è+ 
¡¬t
, 3);

274 
toggË_äagm’t
(
buf
, 
wÜd
);

280 
	gFlštS³ÎšgTabË
::
»move_wÜd
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
)

282 
m­
<
¡ršg
, 
	gX­Ÿn
::
‹rmcouÁ
>::
™”©Ü
 
i
 = 
wÜdäeq_chªges
.
fšd
(
wÜd
);

283 ià(
	gi
 !ğ
wÜdäeq_chªges
.
’d
()) {

284 ià(
i
->
£cÚd
 == 0) {

289 ià(
	gäeqdec
 < 
	gi
->
	g£cÚd
) {

290 
	gi
->
	g£cÚd
 -ğ
äeqdec
;

295 
	gi
->
	g£cÚd
 = 0;

297 
¡ršg
 
	gkey
 = "W" + 
wÜd
;

298 
¡ršg
 
	gd©a
;

299 ià(!
g‘_exaù_’Œy
(
key
, 
d©a
)) {

304 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

305 cÚ¡ *
	gp
 = 
d©a
.data();

306 ià(!
F_uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
size
(), &
äeq
)) {

307 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

309 ià(
	gäeqdec
 < 
	gäeq
) {

310 
	gwÜdäeq_chªges
[
wÜd
] = 
äeq
 - 
äeqdec
;

314 
	gwÜdäeq_chªges
[
wÜd
] = 0;

319 
F_äagm’t
 
	gbuf
;

321 
	gbuf
[0] = 'H';

322 
	gbuf
[1] = 
wÜd
[0];

323 
	gbuf
[2] = 
wÜd
[1];

324 
	gbuf
[3] = '\0';

325 
toggË_äagm’t
(
buf
, 
wÜd
);

328 
	gbuf
[0] = 'T';

329 
	gbuf
[1] = 
wÜd
[wÜd.
size
() - 2];

330 
	gbuf
[2] = 
wÜd
[wÜd.
size
() - 1];

331 
	gbuf
[3] = '\0';

332 
toggË_äagm’t
(
buf
, 
wÜd
);

334 ià(
	gwÜd
.
size
() <= 4) {

336 
buf
[0] = 'B';

337 
	gbuf
[1] = 
wÜd
[0];

338 
	gbuf
[3] = '\0';

339 
toggË_äagm’t
(
buf
, 
wÜd
);

341 ià(
	gwÜd
.
size
() > 2) {

343 
	gbuf
[0] = 'M';

344 
size_t
 
	g¡¬t
 = 0; s¹ <ğ
wÜd
.
size
() - 3; ++start) {

345 
memıy
(
buf
.
d©a
 + 1, 
wÜd
.d©a(è+ 
¡¬t
, 3);

346 
toggË_äagm’t
(
buf
, 
wÜd
);

351 
	sT”mLi¡G»©”AµroxSize
 {

352 
boŞ
 
İ”©Ü
()(cÚ¡ 
T”mLi¡
 *
	ma
, cÚ¡ T”mLi¡ *
	mb
) {

353  
	ma
->
g‘_­´ox_size
(è> 
	mb
->get_approx_size();

357 
T”mLi¡
 *

358 
	gFlštS³ÎšgTabË
::
	$İ’_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
)

361 
	`As£¹R–
(
wÜd
.
	`size
(),>,1);

365 ià(!
wÜdäeq_chªges
.
	`em±y
()è
	`m”ge_chªges
();

369 
´iÜ™y_queue
<
T”mLi¡
*, 
veùÜ
<T”mLi¡*>, 
T”mLi¡G»©”AµroxSize
> 
pq
;

370 
Œy
 {

371 
¡ršg
 
d©a
;

372 
F_äagm’t
 
buf
;

375 
buf
[0] = 'H';

376 
buf
[1] = 
wÜd
[0];

377 
buf
[2] = 
wÜd
[1];

378 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

379 
pq
.
	`push
(
Ãw
 
	`FlštS³ÎšgT”mLi¡
(
d©a
));

382 
buf
[0] = 'T';

383 
buf
[1] = 
wÜd
[wÜd.
	`size
() - 2];

384 
buf
[2] = 
wÜd
[wÜd.
	`size
() - 1];

385 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

386 
pq
.
	`push
(
Ãw
 
	`FlštS³ÎšgT”mLi¡
(
d©a
));

388 ià(
wÜd
.
	`size
() <= 4) {

394 
buf
[0] = 'B';

395 
buf
[1] = 
wÜd
[0];

396 
buf
[3] = '\0';

397 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

398 
pq
.
	`push
(
Ãw
 
	`FlštS³ÎšgT”mLi¡
(
d©a
));

400 ià(
wÜd
.
	`size
() > 2) {

402 
buf
[0] = 'M';

403 
size_t
 
¡¬t
 = 0; s¹ <ğ
wÜd
.
	`size
() - 3; ++start) {

404 
	`memıy
(
buf
.
d©a
 + 1, 
wÜd
.
	`d©a
(è+ 
¡¬t
, 3);

405 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

406 
pq
.
	`push
(
Ãw
 
	`FlštS³ÎšgT”mLi¡
(
d©a
));

409 ià(
wÜd
.
	`size
() == 3) {

414 
buf
[1] = 
wÜd
[1];

415 
buf
[2] = 
wÜd
[0];

416 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

417 
pq
.
	`push
(
Ãw
 
	`FlštS³ÎšgT”mLi¡
(
d©a
));

419 
buf
[1] = 
wÜd
[0];

420 
buf
[2] = 
wÜd
[2];

421 
buf
[3] = 
wÜd
[1];

422 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

423 
pq
.
	`push
(
Ãw
 
	`FlštS³ÎšgT”mLi¡
(
d©a
));

426 
	`As£¹
(
wÜd
.
	`size
() == 2);

431 
buf
[0] = 'H';

432 
buf
[1] = 
wÜd
[1];

433 
buf
[2] = 
wÜd
[0];

434 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

435 
pq
.
	`push
(
Ãw
 
	`FlštS³ÎšgT”mLi¡
(
d©a
));

436 
buf
[0] = 'T';

437 ià(
	`g‘_exaù_’Œy
(
	`¡ršg
(
buf
), 
d©a
))

438 
pq
.
	`push
(
Ãw
 
	`FlštS³ÎšgT”mLi¡
(
d©a
));

441 ià(
pq
.
	`em±y
()è 
NULL
;

450 
pq
.
	`size
() > 1) {

453 
T”mLi¡
 * 
‹rmli¡
 = 
pq
.
	`tİ
();

454 
pq
.
	`pİ
();

456 
‹rmli¡
 = 
Ãw
 
	`OrT”mLi¡
(
pq
.
	`tİ
(),ermlist);

457 
pq
.
	`pİ
();

458 
pq
.
	`push
(
‹rmli¡
);

461  
pq
.
	`tİ
();

462 } 
	`ÿtch
 (...) {

465 !
pq
.
	`em±y
()) {

466 
d–‘e
 
pq
.
	`tİ
();

467 
pq
.
	`pİ
();

469 
throw
;

471 
	}
}

473 
	gX­Ÿn
::
doccouÁ


474 
FlštS³ÎšgTabË
::
	$g‘_wÜd_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const

476 
m­
<
¡ršg
, 
X­Ÿn
::
‹rmcouÁ
>::
cÚ¡_™”©Ü
 
i
;

477 
i
 = 
wÜdäeq_chªges
.
	`fšd
(
wÜd
);

478 ià(
i
 !ğ
wÜdäeq_chªges
.
	`’d
()) {

480  
i
->
£cÚd
;

483 
¡ršg
 
key
 = "W" + 
wÜd
;

484 
¡ršg
 
d©a
;

485 ià(
	`g‘_exaù_’Œy
(
key
, 
d©a
)) {

487 
X­Ÿn
::
‹rmcouÁ
 
äeq
;

488 cÚ¡ *
p
 = 
d©a
.
	`d©a
();

489 ià(!
	`F_uÅack_ušt_Ï¡
(&
p
,… + 
d©a
.
	`size
(), &
äeq
)) {

490 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spelling word freq");

492  
äeq
;

496 
	}
}

500 
	gX­Ÿn
::
‹rmcouÁ


501 
FlštS³ÎšgT”mLi¡
::
	$g‘_­´ox_size
() const

505  
d©a
.
	`size
();

506 
	}
}

508 
	g¡d
::
¡ršg


509 
FlštS³ÎšgT”mLi¡
::
	$g‘_‹rmÇme
() const

511  
cu¼’t_‹rm
;

512 
	}
}

514 
	gX­Ÿn
::
‹rmcouÁ


515 
FlštS³ÎšgT”mLi¡
::
	$g‘_wdf
() const

518 
	}
}

520 
	gX­Ÿn
::
doccouÁ


521 
FlštS³ÎšgT”mLi¡
::
	$g‘_‹rmäeq
() const

524 
	}
}

526 
	gX­Ÿn
::
‹rmcouÁ


527 
FlštS³ÎšgT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

530 
	}
}

532 
T”mLi¡
 *

533 
	gFlštS³ÎšgT”mLi¡
::
	$Ãxt
()

535 ià(
p
 =ğ
d©a
.
	`size
()) {

536 
p
 = 0;

537 
d©a
.
	`»size
(0);

538  
NULL
;

540 ià(!
cu¼’t_‹rm
.
	`em±y
()) {

541 ià(
p
 =ğ
d©a
.
	`size
())

542 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spellingermlist");

543 
cu¼’t_‹rm
.
	`»size
(
	`by‹
(
d©a
[
p
++]è^ 
MAGIC_XOR_VALUE
);

545 
add
;

546 ià(
p
 =ğ
d©a
.
	`size
() ||

547 (
add
 = 
	`by‹
(
d©a
[
p
]è^ 
MAGIC_XOR_VALUE
è>ğd©a.
	`size
() -…)

548 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spellingermlist");

549 
cu¼’t_‹rm
.
	`­³nd
(
d©a
.
	`d©a
(è+ 
p
 + 1, 
add
);

550 
p
 +ğ
add
 + 1;

551  
NULL
;

552 
	}
}

554 
boŞ


555 
	gFlštS³ÎšgT”mLi¡
::
	$©_’d
() const

557  
d©a
.
	`em±y
();

558 
	}
}

560 
	gX­Ÿn
::
‹rmcouÁ


561 
FlštS³ÎšgT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

563 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("FlintSpellingTermList::positionlist_count()‚ot implemented");

564 
	}
}

566 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


567 
FlštS³ÎšgT”mLi¡
::
	$pos™iÚli¡_begš
() const

569 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("FlintSpellingTermList::positionlist_begin()‚ot implemented");

570 
	}
}

	@backends/flint/flint_spelling.h

21 #iâdeà
XAPIAN_INCLUDED_FLINT_SPELLING_H


22 
	#XAPIAN_INCLUDED_FLINT_SPELLING_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"æšt_bË.h
"

27 
	~"‹rmli¡.h
"

29 
	~<m­
>

30 
	~<£t
>

31 
	~<¡ršg
>

32 
	~<c¡ršg
>

34 
	sF_äagm’t
 {

35 
	md©a
[4];

38 
F_äagm’t
() { }

41 
F_äagm’t
(
d©a_
[4]è{ 
	m¡d
::
memıy
(
d©a
, data_, 4); }

43 & 
	mİ”©Ü
[] (
	mi
è{  
	md©a
[
i
]; }

44 cÚ¡ & 
	mİ”©Ü
[] (
	mi
ècÚ¡ {  
	md©a
[
i
]; }

46 
İ”©Ü
 
	m¡d
::
¡ršg
 () const {

47  
¡d
::
¡ršg
(
d©a
, data[0] == 'M' ? 4 : 3);

51 
šlše
 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gF_äagm’t
 &
	ga
, cÚ¡ F_äagm’ˆ&
	gb
) {

52  
	g¡d
::
memcmp
(
a
.
d©a
, 
b
.data, 4) < 0;

55 şas 
	cFlštS³ÎšgTabË
 : 
public
 
FlštTabË
 {

56 
toggË_äagm’t
(
F_äagm’t
 
äag
, cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
);

58 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mX­Ÿn
::
‹rmcouÁ
> 
wÜdäeq_chªges
;

59 
	m¡d
::
m­
<
F_äagm’t
, std::
£t
<
¡d
::
¡ršg
> > 
‹rmli¡_d–s
;

61 
	mpublic
:

70 
FlštS³ÎšgTabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

71 : 
FlštTabË
("¥–lšg", 
dbdœ
 + "/¥–lšg.", 
»adÚly
, 
Z_DEFAULT_STRATEGY
, 
Œue
) { }

74 
m”ge_chªges
();

76 
add_wÜd
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
);

77 
»move_wÜd
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
);

79 
T”mLi¡
 * 
İ’_‹rmli¡
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
);

81 
	gX­Ÿn
::
doccouÁ
 
g‘_wÜd_äequ’cy
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
) const;

90 
boŞ
 
	$is_modif›d
() const {

91  !
wÜdäeq_chªges
.
	`em±y
(è|| 
FlštTabË
::
	`is_modif›d
();

92 
	}
}

94 
	$ü—‹_ªd_İ’
(
blocksize
) {

97 
FlštTabË
::
	`”a£
();

98 
FlštTabË
::
	`£t_block_size
(
blocksize
);

99 
	}
}

101 
	$æush_db
() {

102 
	`m”ge_chªges
();

103 
FlštTabË
::
	`æush_db
();

104 
	}
}

106 
	$ÿnûl
() {

108 
wÜdäeq_chªges
.
	`ş—r
();

109 
‹rmli¡_d–s
.
	`ş—r
();

111 
FlštTabË
::
	`ÿnûl
();

112 
	}
}

118 şas 
	cFlštS³ÎšgT”mLi¡
 : 
public
 
T”mLi¡
 {

120 
¡d
::
¡ršg
 
d©a
;

123 
	mp
;

126 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

129 
FlštS³ÎšgT”mLi¡
(const FlintSpellingTermList &);

132 
	mİ”©Ü
=(cÚ¡ 
FlštS³ÎšgT”mLi¡
 &);

134 
	mpublic
:

136 
FlštS³ÎšgT”mLi¡
(cÚ¡ 
¡d
::
¡ršg
 & 
d©a_
)

137 : 
d©a
(
d©a_
), 
	$p
(0) { }

139 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

141 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

143 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

145 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

147 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

149 
T”mLi¡
 *
	`Ãxt
();

151 
boŞ
 
	$©_’d
() const;

153 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

155 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

156 
	}
};

	@backends/flint/flint_spellingwordslist.cc

23 
	~<cÚfig.h
>

25 
	~<x­Ÿn/”rÜ.h
>

26 
	~<x­Ÿn/ty³s.h
>

28 
	~"æšt_¥–lšgwÜd¦i¡.h
"

29 
	~"æšt_uts.h
"

30 
	~"¡ršguts.h
"

32 
	gFlštS³ÎšgWÜdsLi¡
::~
	$FlštS³ÎšgWÜdsLi¡
()

34 
	`DEBUGCALL
(
DB
, , "~FlintSpellingWordsList", "");

35 
d–‘e
 
cursÜ
;

36 
	}
}

38 
¡ršg


39 
	gFlštS³ÎšgWÜdsLi¡
::
	$g‘_‹rmÇme
() const

41 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintSpellingWordsList::get_termname", "");

42 
	`As£¹
(
cursÜ
);

43 
	`As£¹
(!
	`©_’d
());

44 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

45 
	`As£¹
(
cursÜ
->
cu¼’t_key
[0] == 'W');

46 
	`RETURN
(
cursÜ
->
cu¼’t_key
.
	`sub¡r
(1));

47 
	}
}

49 
	gX­Ÿn
::
doccouÁ


50 
FlštS³ÎšgWÜdsLi¡
::
	$g‘_‹rmäeq
() const

52 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintSpellingWordsList::get_termfreq", "");

53 
	`As£¹
(
cursÜ
);

54 
	`As£¹
(!
	`©_’d
());

55 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

56 
	`As£¹
(
cursÜ
->
cu¼’t_key
[0] == 'W');

57 
cursÜ
->
	`»ad_g
();

59 
X­Ÿn
::
‹rmcouÁ
 
äeq
;

60 cÚ¡ *
p
 = 
cursÜ
->
cu¼’t_g
.
	`d©a
();

61 ià(!
	`F_uÅack_ušt_Ï¡
(&
p
,… + 
cursÜ
->
cu¼’t_g
.
	`size
(), &
äeq
)) {

62 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad spelling word freq");

64  
äeq
;

65 
	}
}

67 
	gX­Ÿn
::
‹rmcouÁ


68 
FlštS³ÎšgWÜdsLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

70 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("FlintSpellingWordsList::get_collection_freq()‚ot meaningful");

71 
	}
}

73 
T”mLi¡
 *

74 
	gFlštS³ÎšgWÜdsLi¡
::
	$Ãxt
()

76 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlintSpellingWordsList::next", "");

77 
	`As£¹
(!
	`©_’d
());

79 
cursÜ
->
	`Ãxt
();

80 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 'W')) {

82 
cursÜ
->
	`to_’d
();

85 
	`RETURN
(
NULL
);

86 
	}
}

88 
T”mLi¡
 *

89 
	gFlštS³ÎšgWÜdsLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
Šame
)

91 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlštS³ÎšgWÜdsLi¡::sk_to", 
Šame
);

92 
	`As£¹
(!
	`©_’d
());

94 ià(!
cursÜ
->
	`fšd_’Œy_ge
("W" + 
Šame
)) {

97 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 'W')) {

99 
cursÜ
->
	`to_’d
();

102 
	`RETURN
(
NULL
);

103 
	}
}

105 
boŞ


106 
	gFlštS³ÎšgWÜdsLi¡
::
	$©_’d
() const

108 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintSpellingWordsList::at_end", "");

109 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

110 
	}
}

	@backends/flint/flint_spellingwordslist.h

21 #iâdeà
XAPIAN_HGUARD_FLINT_SPELLINGWORDSLIST_H


22 
	#XAPIAN_HGUARD_FLINT_SPELLINGWORDSLIST_H


	)

24 
	~"®É”m¦i¡.h
"

25 
	~"d©aba£.h
"

26 
	~"æšt_¥–lšg.h
"

28 
şass
 
	gFlštCursÜ
;

30 şas 
	cFlštS³ÎšgWÜdsLi¡
 : 
public
 
AÎT”msLi¡
 {

32 
FlštS³ÎšgWÜdsLi¡
(const FlintSpellingWordsList &);

35 
	mİ”©Ü
=(cÚ¡ 
FlštS³ÎšgWÜdsLi¡
 &);

38 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

43 
FlštCursÜ
 * 
	mcursÜ
;

51 
mubË
 
	mX­Ÿn
::
‹rmcouÁ
 
‹rmäeq
;

54 
	$»ad_‹rmäeq
() const;

56 
public
:

57 
	`FlštS³ÎšgWÜdsLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

58 
FlštCursÜ
 * 
cursÜ_
)

59 : 
	`d©aba£
(
d©aba£_
), 
	`cursÜ
(
cursÜ_
), 
	$‹rmäeq
(0) {

62 
cursÜ
->
	`fšd_’Œy
(
¡d
::
	`¡ršg
("W", 1));

66 ~
	`FlštS³ÎšgWÜdsLi¡
();

73 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

80 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

87 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

90 
T”mLi¡
 * 
	`Ãxt
();

93 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
);

96 
boŞ
 
	$©_’d
() const;

97 
	}
};

	@backends/flint/flint_synonym.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/”rÜ.h
>

25 
	~"æšt_cursÜ.h
"

26 
	~"æšt_synÚym.h
"

27 
	~"æšt_uts.h
"

28 
	~"¡ršguts.h
"

29 
	~"veùÜ‹rmli¡.h
"

31 
	~<£t
>

32 
	~<¡ršg
>

33 
	~<veùÜ
>

35 
usšg
 
Çme¥aû
 
	g¡d
;

40 
	#MAGIC_XOR_VALUE
 96

	)

43 
	gFlštSynÚymTabË
::
	$m”ge_chªges
()

45 ià(
Ï¡_‹rm
.
	`em±y
()) ;

47 ià(
Ï¡_synÚyms
.
	`em±y
()) {

48 
	`d–
(
Ï¡_‹rm
);

50 
¡ršg
 
g
;

52 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

53 
i
 = 
Ï¡_synÚyms
.
	`begš
(); i !ğÏ¡_synÚyms.
	`’d
(); ++i) {

54 cÚ¡ 
¡ršg
 & 
synÚym
 = *
i
;

55 
g
 +ğ
	`by‹
(
synÚym
.
	`size
(è^ 
MAGIC_XOR_VALUE
);

56 
g
 +ğ
synÚym
;

59 
	`add
(
Ï¡_‹rm
, 
g
);

60 
Ï¡_synÚyms
.
	`ş—r
();

62 
Ï¡_‹rm
.
	`»size
(0);

63 
	}
}

66 
	gFlštSynÚymTabË
::
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
)

68 ià(
Ï¡_‹rm
 !ğ
‹rm
) {

69 
	`m”ge_chªges
();

70 
Ï¡_‹rm
 = 
‹rm
;

72 
¡ršg
 
g
;

73 ià(
	`g‘_exaù_’Œy
(
‹rm
, 
g
)) {

74 cÚ¡ * 
p
 = 
g
.
	`d©a
();

75 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

76 
p
 !ğ
’d
) {

77 
size_t
 
Ën
;

78 ià(
p
 =ğ
’d
 ||

79 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

80 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

81 ++
p
;

82 
Ï¡_synÚyms
.
	`š£¹
(
	`¡ršg
(
p
, 
Ën
));

83 
p
 +ğ
Ën
;

88 
Ï¡_synÚyms
.
	`š£¹
(
synÚym
);

89 
	}
}

92 
	gFlštSynÚymTabË
::
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
)

94 ià(
Ï¡_‹rm
 !ğ
‹rm
) {

95 
	`m”ge_chªges
();

96 
Ï¡_‹rm
 = 
‹rm
;

98 
¡ršg
 
g
;

99 ià(
	`g‘_exaù_’Œy
(
‹rm
, 
g
)) {

100 cÚ¡ * 
p
 = 
g
.
	`d©a
();

101 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

102 
p
 !ğ
’d
) {

103 
size_t
 
Ën
;

104 ià(
p
 =ğ
’d
 ||

105 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

106 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

107 ++
p
;

108 
Ï¡_synÚyms
.
	`š£¹
(
	`¡ršg
(
p
, 
Ën
));

109 
p
 +ğ
Ën
;

114 
Ï¡_synÚyms
.
	`”a£
(
synÚym
);

115 
	}
}

118 
	gFlštSynÚymTabË
::
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
‹rm
)

125 ià(
Ï¡_‹rm
 =ğ
‹rm
) {

126 
Ï¡_synÚyms
.
	`ş—r
();

128 
	`m”ge_chªges
();

129 
Ï¡_‹rm
 = 
‹rm
;

131 
	}
}

133 
T”mLi¡
 *

134 
	gFlštSynÚymTabË
::
	$İ’_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
)

136 
veùÜ
<
¡ršg
> 
synÚyms
;

138 ià(
Ï¡_‹rm
 =ğ
‹rm
) {

139 ià(
Ï¡_synÚyms
.
	`em±y
()è 
NULL
;

141 
synÚyms
.
	`»£rve
(
Ï¡_synÚyms
.
	`size
());

142 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

143 
i
 = 
Ï¡_synÚyms
.
	`begš
(); i !ğÏ¡_synÚyms.
	`’d
(); ++i) {

144 
synÚyms
.
	`push_back
(*
i
);

147 
¡ršg
 
g
;

148 ià(!
	`g‘_exaù_’Œy
(
‹rm
, 
g
)è 
NULL
;

150 cÚ¡ * 
p
 = 
g
.
	`d©a
();

151 cÚ¡ * 
’d
 = 
p
 + 
g
.
	`size
();

152 
p
 !ğ
’d
) {

153 
size_t
 
Ën
;

154 ià(
p
 =ğ
’d
 ||

155 (
Ën
 = 
	`by‹
(*
p
è^ 
MAGIC_XOR_VALUE
è>ğ
	`size_t
(
’d
 -…))

156 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad synonym data");

157 ++
p
;

158 
synÚyms
.
	`push_back
(
	`¡ršg
(
p
, 
Ën
));

159 
p
 +ğ
Ën
;

163  
Ãw
 
	`VeùÜT”mLi¡
(
synÚyms
.
	`begš
(), synÚyms.
	`’d
());

164 
	}
}

168 
	gFlštSynÚymT”mLi¡
::~
	$FlštSynÚymT”mLi¡
()

170 
	`DEBUGCALL
(
DB
, , "~FlintSynonymTermList", "");

171 
d–‘e
 
cursÜ
;

172 
	}
}

174 
¡ršg


175 
	gFlštSynÚymT”mLi¡
::
	$g‘_‹rmÇme
() const

177 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintSynonymTermList::get_termname", "");

178 
	`As£¹
(
cursÜ
);

179 
	`As£¹
(!
cursÜ
->
cu¼’t_key
.
	`em±y
());

180 
	`As£¹
(!
	`©_’d
());

181 
	`RETURN
(
cursÜ
->
cu¼’t_key
);

182 
	}
}

184 
	gX­Ÿn
::
doccouÁ


185 
FlštSynÚymT”mLi¡
::
	$g‘_‹rmäeq
() const

187 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("FlintSynonymTermList::get_termfreq()‚ot meaningful");

188 
	}
}

190 
	gX­Ÿn
::
‹rmcouÁ


191 
FlštSynÚymT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

193 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("FlintSynonymTermList::get_collection_freq()‚ot meaningful");

194 
	}
}

196 
T”mLi¡
 *

197 
	gFlštSynÚymT”mLi¡
::
	$Ãxt
()

199 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlintSynonymTermList::next", "");

200 
	`As£¹
(!
	`©_’d
());

202 
cursÜ
->
	`Ãxt
();

203 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

205 
cursÜ
->
	`to_’d
();

208 
	`RETURN
(
NULL
);

209 
	}
}

211 
T”mLi¡
 *

212 
	gFlštSynÚymT”mLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
Šame
)

214 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlštSynÚymT”mLi¡::sk_to", 
Šame
);

215 
	`As£¹
(!
	`©_’d
());

217 ià(!
cursÜ
->
	`fšd_’Œy_ge
(
Šame
)) {

220 ià(!
cursÜ
->
	`aá”_’d
(è&& !
	`¡¬tsw™h
(cursÜ->
cu¼’t_key
, 
´efix
)) {

222 
cursÜ
->
	`to_’d
();

225 
	`RETURN
(
NULL
);

226 
	}
}

228 
boŞ


229 
	gFlštSynÚymT”mLi¡
::
	$©_’d
() const

231 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintSynonymTermList::at_end", "");

232 
	`RETURN
(
cursÜ
->
	`aá”_’d
());

233 
	}
}

	@backends/flint/flint_synonym.h

21 #iâdeà
XAPIAN_INCLUDED_FLINT_SYNONYM_H


22 
	#XAPIAN_INCLUDED_FLINT_SYNONYM_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"®É”m¦i¡.h
"

27 
	~"d©aba£.h
"

28 
	~"æšt_bË.h
"

29 
	~"omdebug.h
"

30 
	~"‹rmli¡.h
"

32 
	~<£t
>

33 
	~<¡ršg
>

35 şas 
	cFlštSynÚymTabË
 : 
public
 
FlštTabË
 {

37 
mubË
 
¡d
::
¡ršg
 
Ï¡_‹rm
;

40 
mubË
 
	m¡d
::
£t
<
¡d
::
¡ršg
> 
Ï¡_synÚyms
;

42 
	mpublic
:

51 
FlštSynÚymTabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

52 : 
FlštTabË
("synÚym", 
dbdœ
 + "/synÚym.", 
»adÚly
, 
Z_DEFAULT_STRATEGY
, 
Œue
) { }

55 
m”ge_chªges
();

58 
	$disÿrd_chªges
() {

59 
Ï¡_‹rm
.
	`»size
(0);

60 
Ï¡_synÚyms
.
	`ş—r
();

61 
	}
}

67 
add_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, cÚ¡ std::¡ršg & 
synÚym
);

73 
»move_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, cÚ¡ std::¡ršg & 
synÚym
);

79 
ş—r_synÚyms
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
);

85 
T”mLi¡
 * 
İ’_‹rmli¡
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
);

94 
boŞ
 
	$is_modif›d
() const {

95  !
Ï¡_‹rm
.
	`em±y
(è|| 
FlštTabË
::
	`is_modif›d
();

96 
	}
}

98 
	$ü—‹_ªd_İ’
(
blocksize
) {

101 
FlštTabË
::
	`”a£
();

102 
FlštTabË
::
	`£t_block_size
(
blocksize
);

103 
	}
}

105 
	$æush_db
() {

106 
	`m”ge_chªges
();

107 
FlštTabË
::
	`æush_db
();

108 
	}
}

110 
	$ÿnûl
() {

111 
	`disÿrd_chªges
();

112 
FlštTabË
::
	`ÿnûl
();

113 
	}
}

118 
şass
 
	gFlštCursÜ
;

120 şas 
	cFlštSynÚymT”mLi¡
 : 
public
 
AÎT”msLi¡
 {

122 
FlštSynÚymT”mLi¡
(const FlintSynonymTermList &);

125 
	mİ”©Ü
=(cÚ¡ 
FlštSynÚymT”mLi¡
 &);

128 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
d©aba£
;

133 
FlštCursÜ
 * 
	mcursÜ
;

136 
¡ršg
 
	m´efix
;

138 
	mpublic
:

139 
FlštSynÚymT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

140 
FlštCursÜ
 * 
cursÜ_
,

141 cÚ¡ 
¡ršg
 & 
´efix_
)

142 : 
d©aba£
(
d©aba£_
), 
cursÜ
(
cursÜ_
), 
	$´efix
(
´efix_
)

147 ià(
´efix
.
	`em±y
()) {

148 
cursÜ
->
	`fšd_’Œy
(
	`¡ršg
());

151 
cursÜ
->
	`fšd_’Œy_É
(
´efix
);

156 ~
	`FlštSynÚymT”mLi¡
();

163 
¡ršg
 
	$g‘_‹rmÇme
() const;

166 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

169 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

172 
T”mLi¡
 * 
	`Ãxt
();

175 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡ršg
 &
Šame
);

178 
boŞ
 
	$©_’d
() const;

179 
	}
};

	@backends/flint/flint_table.cc

24 
	~<cÚfig.h
>

26 
	~"æšt_bË.h
"

28 
	~<x­Ÿn/”rÜ.h
>

30 
	~"§ã”ºo.h
"

31 #ifdeà
__WIN32__


32 
	~"msvc_posix_w¿µ”.h
"

35 
	~"omas£¹.h
"

36 
	~"¡ršguts.h
"

51 
	~<sys/ty³s.h
>

58 #ià
defšed
 
HAVE_PREAD
 && defšed 
PREAD_PROTOTYPE


59 
	gPREAD_PROTOTYPE


61 #ià
defšed
 
HAVE_PWRITE
 && defšed 
PWRITE_PROTOTYPE


62 
	gPWRITE_PROTOTYPE


65 
	~<c¡dio
>

66 
	~<c¡ršg
>

67 
	~<şim™s
>

69 
	~"æšt_io.h
"

70 
	~"æšt_bŒ“ba£.h
"

71 
	~"æšt_cursÜ.h
"

72 
	~"æšt_uts.h
"

74 
	~"omas£¹.h
"

75 
	~"omdebug.h
"

76 
	~"uÇligÃd.h
"

77 
	~"uts.h
"

79 
	~<®gÜ™hm
>

80 
	~<¡ršg
>

82 
usšg
 
Çme¥aû
 
	g¡d
;

85 cÚ¡ 
size_t
 
	gCOMPRESS_MIN
 = 4;

88 #undeà
BTREE_DEBUG_FULL


90 #ifdeà
BTREE_DEBUG_FULL


93 
´št_key
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
);

94 
´št_g
(cÚ¡ 
by‹
 * 
p
, 
c
, 
j
);

112 
	$sys_uÆšk
(cÚ¡ 
¡ršg
 &
f’ame
)

114 #ifdeà
__WIN32__


115 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

117 ià(
	`uÆšk
(
f’ame
) == -1) {

119 
¡ršg
 
mes§ge
 = "Failedo unlink ";

120 
mes§ge
 +ğ
f’ame
;

121 
mes§ge
 += ": ";

122 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

123 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
mes§ge
);

125 
	}
}

127 
šlše
 
by‹
 *
	$z”Ûd_Ãw
(
size_t
 
size
)

129 
by‹
 *
‹mp
 = 
Ãw
 by‹[
size
];

132 
	`As£¹
(
‹mp
);

133 
	`mem£t
(
‹mp
, 0, 
size
);

134  
‹mp
;

135 
	}
}

183 
	#REVISION
(
b
è
¡©ic_ÿ¡
<>(
	`g‘št4
(b, 0))

	)

184 
	#GET_LEVEL
(
b
è
	`g‘št1
(b, 4)

	)

185 
	#MAX_FREE
(
b
è
	`g‘št2
(b, 5)

	)

186 
	#TOTAL_FREE
(
b
è
	`g‘št2
(b, 7)

	)

187 
	#DIR_END
(
b
è
	`g‘št2
(b, 9)

	)

188 
	#DIR_START
 11

	)

190 
	#SET_REVISION
(
b
, 
x
è
	`£tšt4
(b, 0, x)

	)

191 
	#SET_LEVEL
(
b
, 
x
è
	`£tšt1
(b, 4, x)

	)

192 
	#SET_MAX_FREE
(
b
, 
x
è
	`£tšt2
(b, 5, x)

	)

193 
	#SET_TOTAL_FREE
(
b
, 
x
è
	`£tšt2
(b, 7, x)

	)

194 
	#SET_DIR_END
(
b
, 
x
è
	`£tšt2
(b, 9, x)

	)

198 
	#SEQ_START_POINT
 (-10)

	)

202 
	#BLOCK_CAPACITY
 4

	)

218 
	#BYTE_PAIR_RANGE
 (1 << 2 * 
CHAR_BIT
)

	)

222 
	gFlštTabË
::
	$»ad_block
(
ušt4
 
n
, 
by‹
 * 
p
) const

225 
	`DEBUGCALL
(
DB
, , "FlštTabË::»ad_block", 
n
 << ", " << (*)
p
);

229 
	`As£¹
(
n
 / 
CHAR_BIT
 < 
ba£
.
	`g‘_b™_m­_size
());

231 #ifdeà
HAVE_PREAD


232 
off_t
 
off£t
 = 
	`off_t
(
block_size
è* 
n
;

233 
m
 = 
block_size
;

234 
Œue
) {

235 
ssize_t
 
by‹s_»ad
 = 
	`´—d
(
hªdË
, 
»š‹½»t_ÿ¡
<*>(
p
), 
m
,

236 
off£t
);

238 ià(
by‹s_»ad
 =ğ
m
) ;

239 ià(
by‹s_»ad
 == -1) {

240 ià(
”ºo
 =ğ
EINTR
) ;

241 
¡ršg
 
mes§ge
 = "E¼Ü„—dšg block " + 
	`om_to¡ršg
(
n
) + ": ";

242 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

243 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

244 } ià(
by‹s_»ad
 == 0) {

245 
¡ršg
 
mes§ge
 = "E¼Ü„—dšg block " + 
	`om_to¡ršg
(
n
) + ": gotƒnd of file";

246 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

247 } ià(
by‹s_»ad
 < 
m
) {

251 
m
 -ğ(
by‹s_»ad
);

252 
p
 +ğ
by‹s_»ad
;

253 
off£t
 +ğ
by‹s_»ad
;

257 ià(
	`l£ek
(
hªdË
, 
	`off_t
(
block_size
è* 
n
, 
SEEK_SET
) == -1) {

258 
¡ršg
 
mes§ge
 = "Error seekingo block: ";

259 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

260 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

263 
	`æšt_io_»ad
(
hªdË
, 
»š‹½»t_ÿ¡
<*>(
p
), 
block_size
, block_size);

265 
	}
}

274 
	gFlštTabË
::
	$wr™e_block
(
ušt4
 
n
, cÚ¡ 
by‹
 * 
p
) const

276 
	`DEBUGCALL
(
DB
, , "FlštTabË::wr™e_block", 
n
 << ", " << 
p
);

277 
	`As£¹
(
wr™abË
);

279 
	`As£¹
(
n
 / 
CHAR_BIT
 < 
ba£
.
	`g‘_b™_m­_size
());

282 
	`As£¹P¬ªoid
(
ba£
.
	`block_ä“_©_¡¬t
(
n
));

285 
	`As£¹EqP¬ªoid
(
	`REVISION
(
p
), 
Ï‹¡_»visiÚ_numb”
 + 1);

287 ià(
bÙh_ba£s
) {

289 
	`sys_uÆšk
(
Çme
 + "ba£" + 
	`Ùh”_ba£_Ë‰”
());

290 
bÙh_ba£s
 = 
çl£
;

291 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

294 #ifdeà
HAVE_PWRITE


295 
off_t
 
off£t
 = 
	`off_t
(
block_size
è* 
n
;

296 
m
 = 
block_size
;

297 
Œue
) {

298 
ssize_t
 
by‹s_wr™‹n
 = 
	`pwr™e
(
hªdË
, 
p
, 
m
, 
off£t
);

299 ià(
by‹s_wr™‹n
 =ğ
m
) {

302 } ià(
by‹s_wr™‹n
 == -1) {

303 ià(
”ºo
 =ğ
EINTR
) ;

304 
¡ršg
 
mes§ge
 = "Error writing block: ";

305 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

306 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

307 } ià(
by‹s_wr™‹n
 == 0) {

308 
¡ršg
 
mes§ge
 = "Error writing block: wrote‚o data";

309 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

310 } ià(
by‹s_wr™‹n
 < 
m
) {

314 
m
 -ğ(
by‹s_wr™‹n
);

315 
p
 +ğ
by‹s_wr™‹n
;

316 
off£t
 +ğ
by‹s_wr™‹n
;

320 ià(
	`l£ek
(
hªdË
, (
off_t
)
block_size
 * 
n
, 
SEEK_SET
) == -1) {

321 
¡ršg
 
mes§ge
 = "Error seekingo block: ";

322 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

323 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
mes§ge
);

326 
	`æšt_io_wr™e
(
hªdË
, 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
), 
block_size
);

328 
	}
}

353 
	gFlštTabË
::
	$£t_ov”wr™‹n
() const

355 
	`DEBUGCALL
(
DB
, , "FlintTable::set_overwritten", "");

358 ià(
wr™abË
)

359 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Db block overwritten -‡rehere multiple writers?");

360 
throw
 
X­Ÿn
::
	`D©aba£Modif›dE¼Ü
("The„evision being„ead has been discarded - you should call Xapian::Database::reopen()‡nd„etryhe operation");

361 
	}
}

374 
	gFlštTabË
::
	$block_to_cursÜ
(
CursÜ_
 * 
C_
, 
j
, 
ušt4
 
n
) const

376 
	`DEBUGCALL
(
DB
, , "FlštTabË::block_to_cursÜ", (*)
C_
 << ", " << 
j
 << ", " << 
n
);

377 ià(
n
 =ğ
C_
[
j
].n) ;

378 
by‹
 * 
p
 = 
C_
[
j
].p;

379 
	`As£¹
(
p
);

382 ià(
C_
[
j
].
»wr™e
) {

383 
	`As£¹
(
wr™abË
);

384 
	`As£¹
(
C
 =ğ
C_
);

385 
	`wr™e_block
(
C_
[
j
].
n
, 
p
);

386 
C_
[
j
].
»wr™e
 = 
çl£
;

390 ià(
wr™abË
 && 
n
 =ğ
C
[
j
].n) {

391 
	`memıy
(
p
, 
C
[
j
].p, 
block_size
);

393 
	`»ad_block
(
n
, 
p
);

396 
C_
[
j
].
n
 =‚;

397 ià(
j
 < 
Ëv–
) {

399 ià(
	`REVISION
(
p
è> REVISION(
C_
[
j
 + 1].p)) {

400 
	`£t_ov”wr™‹n
();

404 
	`As£¹Eq
(
j
, 
	`GET_LEVEL
(
p
));

405 
	}
}

429 
	gFlštTabË
::
	$®‹r
()

431 
	`DEBUGCALL
(
DB
, , "FlintTable::alter", "");

432 
	`As£¹
(
wr™abË
);

433 #ifdeà
DANGEROUS


434 
C
[0].
»wr™e
 = 
Œue
;

436 
j
 = 0;

437 
by‹
 * 
p
 = 
C
[
j
].p;

438 
Œue
) {

439 ià(
C
[
j
].
»wr™e
) ;

440 
C
[
j
].
»wr™e
 = 
Œue
;

442 
ušt4
 
n
 = 
C
[
j
].n;

443 ià(
ba£
.
	`block_ä“_©_¡¬t
(
n
)) {

444 
	`As£¹
(
	`REVISION
(
p
è=ğ
Ï‹¡_»visiÚ_numb”
 + 1);

447 
	`As£¹
(
	`REVISION
(
p
è< 
Ï‹¡_»visiÚ_numb”
 + 1);

448 
ba£
.
	`ä“_block
(
n
);

449 
n
 = 
ba£
.
	`Ãxt_ä“_block
();

450 
C
[
j
].
n
 =‚;

451 
	`SET_REVISION
(
p
, 
Ï‹¡_»visiÚ_numb”
 + 1);

453 ià(
j
 =ğ
Ëv–
) ;

454 
j
++;

455 
p
 = 
C
[
j
].p;

456 
	`I‹m_wr_
(
p
, 
C
[
j
].
c
).
	`£t_block_giv’_by
(
n
);

459 
	}
}

473 
	gFlštTabË
::
	$fšd_š_block
(cÚ¡ 
by‹
 * 
p
, 
Key_
 
key
, 
boŞ
 
Ëaf
, 
c
)

475 
	`DEBUGCALL_STATIC
(
DB
, , "FlštTabË::fšd_š_block", 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
è<< ", " <<„eš‹½»t_ÿ¡<cÚ¡ *>(
key
.
	`g‘_add»ss
()è<< ", " << 
Ëaf
 << ", " << 
c
);

476 
i
 = 
DIR_START
;

477 ià(
Ëaf
è
i
 -ğ
D2
;

478 
j
 = 
	`DIR_END
(
p
);

480 ià(
c
 != -1) {

481 ià(
c
 < 
j
 && 
i
 < c && 
	`I‹m_
(
p
, c).
	`key
(è<ğ
key
)

482 
i
 = 
c
;

483 
c
 +ğ
D2
;

484 ià(
c
 < 
j
 && 
i
 < c && 
key
 < 
	`I‹m_
(
p
, c).
	`key
())

485 
j
 = 
c
;

488 
j
 - 
i
 > 
D2
) {

489 
k
 = 
i
 + ((
j
 - i)/(
D2
 * 2))*D2;

490 ià(
key
 < 
	`I‹m_
(
p
, 
k
).
	`key
()è
j
 = k; 
i
 = k;

492 
	`RETURN
(
i
);

493 
	}
}

502 
boŞ


503 
	gFlštTabË
::
	$fšd
(
CursÜ_
 * 
C_
) const

505 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštTabË::fšd", (*)
C_
);

507 cÚ¡ 
by‹
 * 
p
;

508 
c
;

509 
Key_
 
key
 = 
kt
.
	`key
();

510 
j
 = 
Ëv–
; j > 0; --j) {

511 
p
 = 
C_
[
j
].p;

512 
c
 = 
	`fšd_š_block
(
p
, 
key
, 
çl£
, 
C_
[
j
].c);

513 #ifdeà
BTREE_DEBUG_FULL


514 
	`´štf
("Block in FlintTable:find - code…osition 1");

515 
	`»pÜt_block_fuÎ
(
j
, 
C_
[j].
n
, 
p
);

517 
C_
[
j
].
c
 = c;

518 
	`block_to_cursÜ
(
C_
, 
j
 - 1, 
	`I‹m_
(
p
, 
c
).
	`block_giv’_by
());

520 
p
 = 
C_
[0].p;

521 
c
 = 
	`fšd_š_block
(
p
, 
key
, 
Œue
, 
C_
[0].c);

522 #ifdeà
BTREE_DEBUG_FULL


523 
	`´štf
("Block in FlintTable:find - code…osition 2");

524 
	`»pÜt_block_fuÎ
(0, 
C_
[0].
n
, 
p
);

526 
C_
[0].
c
 = c;

527 ià(
c
 < 
DIR_START
è
	`RETURN
(
çl£
);

528 
	`RETURN
(
	`I‹m_
(
p
, 
c
).
	`key
(è=ğ
key
);

529 
	}
}

537 
	gFlštTabË
::
	$com·ù
(
by‹
 * 
p
)

539 
	`DEBUGCALL
(
DB
, , "FlštTabË::com·ù", (*)
p
);

540 
	`As£¹
(
wr™abË
);

541 
e
 = 
block_size
;

542 
by‹
 * 
b
 = 
bufãr
;

543 
dœ_’d
 = 
	`DIR_END
(
p
);

544 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

545 
I‹m_
 
	`™em
(
p
, 
c
);

546 
l
 = 
™em
.
	`size
();

547 
e
 -ğ
l
;

548 
	`memmove
(
b
 + 
e
, 
™em
.
	`g‘_add»ss
(), 
l
);

549 
	`£tD
(
p
, 
c
, 
e
);

551 
	`memmove
(
p
 + 
e
, 
b
 +ƒ, 
block_size
 -ƒ);

552 
e
 -ğ
dœ_’d
;

553 
	`SET_TOTAL_FREE
(
p
, 
e
);

554 
	`SET_MAX_FREE
(
p
, 
e
);

555 
	}
}

561 
	gFlštTabË
::
	$¥l™_roÙ
(
ušt4
 
¥l™_n
)

563 
	`DEBUGCALL
(
DB
, , "FlštTabË::¥l™_roÙ", 
¥l™_n
);

565 ++
Ëv–
;

569 ià(
Ëv–
 =ğ
BTREE_CURSOR_LEVELS
) {

570 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("BŒ“ ha growÀimpossibly†¬g("
	`STRINGIZE
(
BTREE_CURSOR_LEVELS
)"†evels)");

573 
by‹
 * 
q
 = 
	`z”Ûd_Ãw
(
block_size
);

574 
C
[
Ëv–
].
p
 = 
q
;

575 
C
[
Ëv–
].
c
 = 
DIR_START
;

576 
C
[
Ëv–
].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

577 
C
[
Ëv–
].
»wr™e
 = 
Œue
;

578 
	`SET_REVISION
(
q
, 
Ï‹¡_»visiÚ_numb”
 + 1);

579 
	`SET_LEVEL
(
q
, 
Ëv–
);

580 
	`SET_DIR_END
(
q
, 
DIR_START
);

581 
	`com·ù
(
q
);

584 
by‹
 
b
[10];

585 
I‹m_wr_
 
	`™em
(
b
);

586 
™em
.
	`fÜm_nuÎ_key
(
¥l™_n
);

587 
	`add_™em
(
™em
, 
Ëv–
);

588 
	}
}

606 
	gFlštTabË
::
	$’‹r_key
(
j
, 
Key_
 
´evkey
, Key_ 
Ãwkey
)

608 
	`As£¹
(
wr™abË
);

609 
	`As£¹
(
´evkey
 < 
Ãwkey
);

610 
	`As£¹
(
j
 >= 1);

612 
ušt4
 
blocknumb”
 = 
C
[
j
 - 1].
n
;

616 cÚ¡ 
Ãwkey_Ën
 = 
Ãwkey
.
	`Ëngth
();

617 
i
;

619 ià(
j
 == 1) {

622 
i
 = 0;

623 cÚ¡ 
mš_Ën
 = 
	`mš
(
Ãwkey_Ën
, 
´evkey
.
	`Ëngth
());

624 
i
 < 
mš_Ën
 && 
´evkey
[i] =ğ
Ãwkey
[i]) {

625 
i
++;

629 ià(
i
 < 
Ãwkey_Ën
) i++;

635 
i
 = 
Ãwkey_Ën
;

638 
by‹
 
b
[
UCHAR_MAX
 + 6];

639 
I‹m_wr_
 
	`™em
(
b
);

640 
	`As£¹
(
i
 <ğ256 - 
I2
 - 
C2
);

641 
	`As£¹
(
i
 <ğ()(
b
è- 
I2
 - 
C2
 - 4);

642 
™em
.
	`£t_key_ªd_block
(
Ãwkey
, 
i
, 
blocknumb”
);

647 ià(
j
 > 1) {

648 
by‹
 * 
p
 = 
C
[
j
 - 1].p;

649 
ušt4
 
n
 = 
	`g‘št4
(
Ãwkey
.
	`g‘_add»ss
(), 
Ãwkey_Ën
 + 
K1
 + 
C2
);

650 
Ãw_tÙ®_ä“
 = 
	`TOTAL_FREE
(
p
è+ 
Ãwkey_Ën
 + 
C2
;

652 
	`I‹m_wr_
(
cÚ¡_ÿ¡
<
by‹
*>(
Ãwkey
.
	`g‘_add»ss
()è- 
I2
).
	`fÜm_nuÎ_key
(
n
);

653 
	`SET_TOTAL_FREE
(
p
, 
Ãw_tÙ®_ä“
);

656 
C
[
j
].
c
 = 
	`fšd_š_block
(C[j].
p
, 
™em
.
	`key
(), 
çl£
, 0è+ 
D2
;

657 
C
[
j
].
»wr™e
 = 
Œue
;

658 
	`add_™em
(
™em
, 
j
);

659 
	}
}

666 
	gFlštTabË
::
	$mid_pošt
(
by‹
 * 
p
)

668 
n
 = 0;

669 
dœ_’d
 = 
	`DIR_END
(
p
);

670 
size
 = 
block_size
 - 
	`TOTAL_FREE
(
p
è- 
dœ_’d
;

671 
c
 = 
DIR_START
; c < 
dœ_’d
; c +ğ
D2
) {

672 
l
 = 
	`I‹m_
(
p
, 
c
).
	`size
();

673 
n
 +ğ2 * 
l
;

674 ià(
n
 >ğ
size
) {

675 ià(
l
 < 
n
 - 
size
è 
c
;

676  
c
 + 
D2
;

681 
	`As£¹
(
çl£
);

683 
	}
}

694 
	gFlštTabË
::
	$add_™em_to_block
(
by‹
 * 
p
, 
I‹m_wr_
 
kt_
, 
c
)

696 
	`As£¹
(
wr™abË
);

697 
dœ_’d
 = 
	`DIR_END
(
p
);

698 
kt_Ën
 = 
kt_
.
	`size
();

699 
Ãeded
 = 
kt_Ën
 + 
D2
;

700 
Ãw_tÙ®
 = 
	`TOTAL_FREE
(
p
è- 
Ãeded
;

701 
Ãw_max
 = 
	`MAX_FREE
(
p
è- 
Ãeded
;

703 
	`As£¹
(
Ãw_tÙ®
 >= 0);

705 ià(
Ãw_max
 < 0) {

706 
	`com·ù
(
p
);

707 
Ãw_max
 = 
	`MAX_FREE
(
p
è- 
Ãeded
;

708 
	`As£¹
(
Ãw_max
 >= 0);

710 
	`As£¹
(
dœ_’d
 >ğ
c
);

712 
	`memmove
(
p
 + 
c
 + 
D2
,… + c, 
dœ_’d
 - c);

713 
dœ_’d
 +ğ
D2
;

714 
	`SET_DIR_END
(
p
, 
dœ_’d
);

716 
o
 = 
dœ_’d
 + 
Ãw_max
;

717 
	`£tD
(
p
, 
c
, 
o
);

718 
	`memmove
(
p
 + 
o
, 
kt_
.
	`g‘_add»ss
(), 
kt_Ën
);

720 
	`SET_MAX_FREE
(
p
, 
Ãw_max
);

722 
	`SET_TOTAL_FREE
(
p
, 
Ãw_tÙ®
);

723 
	}
}

731 
	gFlštTabË
::
	$add_™em
(
I‹m_wr_
 
kt_
, 
j
)

733 
	`As£¹
(
wr™abË
);

734 
by‹
 * 
p
 = 
C
[
j
].p;

735 
c
 = 
C
[
j
].c;

736 
ušt4
 
n
;

738 
Ãeded
 = 
kt_
.
	`size
(è+ 
D2
;

739 ià(
	`TOTAL_FREE
(
p
è< 
Ãeded
) {

740 
m
;

746 ià(
£q_couÁ
 < 0) {

749 
m
 = 
	`mid_pošt
(
p
);

752 
m
 = 
c
;

755 
ušt4
 
¥l™_n
 = 
C
[
j
].
n
;

756 
C
[
j
].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

758 
	`memıy
(
¥l™_p
, 
p
, 
block_size
);

759 
	`SET_DIR_END
(
¥l™_p
, 
m
);

760 
	`com·ù
(
¥l™_p
);

763 
»sidue
 = 
	`DIR_END
(
p
è- 
m
;

764 
Ãw_dœ_’d
 = 
DIR_START
 + 
»sidue
;

765 
	`memmove
(
p
 + 
DIR_START
,… + 
m
, 
»sidue
);

766 
	`SET_DIR_END
(
p
, 
Ãw_dœ_’d
);

769 
	`com·ù
(
p
);

771 
boŞ
 
add_to_uµ”_h®f
;

772 ià(
£q_couÁ
 < 0) {

773 
add_to_uµ”_h®f
 = (
c
 >ğ
m
);

777 
add_to_uµ”_h®f
 = (
	`TOTAL_FREE
(
¥l™_p
è< 
Ãeded
);

780 ià(
add_to_uµ”_h®f
) {

781 
c
 -ğ(
m
 - 
DIR_START
);

782 
	`As£¹
(
£q_couÁ
 < 0 || 
c
 <ğ
DIR_START
 + 
D2
);

783 
	`As£¹
(
c
 >ğ
DIR_START
);

784 
	`As£¹
(
c
 <ğ
	`DIR_END
(
p
));

785 
	`add_™em_to_block
(
p
, 
kt_
, 
c
);

786 
n
 = 
C
[
j
].n;

788 
	`As£¹
(
c
 >ğ
DIR_START
);

789 
	`As£¹
(
c
 <ğ
	`DIR_END
(
¥l™_p
));

790 
	`add_™em_to_block
(
¥l™_p
, 
kt_
, 
c
);

791 
n
 = 
¥l™_n
;

793 
	`wr™e_block
(
¥l™_n
, 
¥l™_p
);

796 ià(
j
 =ğ
Ëv–
è
	`¥l™_roÙ
(
¥l™_n
);

800 
	`’‹r_key
(
j
 + 1,

801 
	`I‹m_
(
¥l™_p
, 
	`DIR_END
(¥l™_pè- 
D2
).
	`key
(),

802 
	`I‹m_
(
p
, 
DIR_START
).
	`key
());

804 
	`add_™em_to_block
(
p
, 
kt_
, 
c
);

805 
n
 = 
C
[
j
].n;

807 ià(
j
 == 0) {

808 
chªged_n
 = 
n
;

809 
chªged_c
 = 
c
;

811 
	}
}

821 
	gFlštTabË
::
	$d–‘e_™em
(
j
, 
boŞ
 
»³©edly
)

823 
	`As£¹
(
wr™abË
);

824 
by‹
 * 
p
 = 
C
[
j
].p;

825 
c
 = 
C
[
j
].c;

826 
kt_Ën
 = 
	`I‹m_
(
p
, 
c
).
	`size
();

827 
dœ_’d
 = 
	`DIR_END
(
p
è- 
D2
;

829 
	`memmove
(
p
 + 
c
,… + c + 
D2
, 
dœ_’d
 - c);

830 
	`SET_DIR_END
(
p
, 
dœ_’d
);

831 
	`SET_MAX_FREE
(
p
, 
	`MAX_FREE
Õè+ 
D2
);

832 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè+ 
kt_Ën
 + 
D2
);

834 ià(!
»³©edly
) ;

835 ià(
j
 < 
Ëv–
) {

836 ià(
dœ_’d
 =ğ
DIR_START
) {

837 
ba£
.
	`ä“_block
(
C
[
j
].
n
);

838 
C
[
j
].
»wr™e
 = 
çl£
;

839 
C
[
j
].
n
 = 
BLK_UNUSED
;

840 
C
[
j
 + 1].
»wr™e
 = 
Œue
;

841 
	`d–‘e_™em
(
j
 + 1, 
Œue
);

844 
	`As£¹
(
j
 =ğ
Ëv–
);

845 
dœ_’d
 =ğ
DIR_START
 + 
D2
 && 
Ëv–
 > 0) {

847 
ušt4
 
Ãw_roÙ
 = 
	`I‹m_
(
p
, 
DIR_START
).
	`block_giv’_by
();

848 
d–‘e
 [] 
p
;

849 
C
[
Ëv–
].
p
 = 0;

850 
ba£
.
	`ä“_block
(
C
[
Ëv–
].
n
);

851 
C
[
Ëv–
].
»wr™e
 = 
çl£
;

852 
C
[
Ëv–
].
n
 = 
BLK_UNUSED
;

853 
Ëv–
--;

855 
	`block_to_cursÜ
(
C
, 
Ëv–
, 
Ãw_roÙ
);

857 
p
 = 
C
[
Ëv–
].p;

858 
dœ_’d
 = 
	`DIR_END
(
p
);

861 
	}
}

893 
	gFlštTabË
::
	$add_kt
(
boŞ
 
found
)

895 
	`As£¹
(
wr™abË
);

896 
compÚ’ts
 = 0;

904 
	`®‹r
();

906 ià(
found
) {

907 
£q_couÁ
 = 
SEQ_START_POINT
;

908 
£qu’tŸl
 = 
çl£
;

910 
by‹
 * 
p
 = 
C
[0].p;

911 
c
 = 
C
[0].c;

912 
I‹m_
 
	`™em
(
p
, 
c
);

913 
kt_size
 = 
kt
.
	`size
();

914 
Ãeded
 = 
kt_size
 - 
™em
.
	`size
();

916 
compÚ’ts
 = 
	`I‹m_
(
p
, 
c
).
	`compÚ’ts_of
();

918 ià(
Ãeded
 <= 0) {

920 
	`memmove
(
cÚ¡_ÿ¡
<
by‹
 *>(
™em
.
	`g‘_add»ss
()),

921 
kt
.
	`g‘_add»ss
(), 
kt_size
);

922 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè- 
Ãeded
);

925 
Ãw_max
 = 
	`MAX_FREE
(
p
è- 
kt_size
;

926 ià(
Ãw_max
 >= 0) {

927 
o
 = 
	`DIR_END
(
p
è+ 
Ãw_max
;

928 
	`memmove
(
p
 + 
o
, 
kt
.
	`g‘_add»ss
(), 
kt_size
);

929 
	`£tD
(
p
, 
c
, 
o
);

930 
	`SET_MAX_FREE
(
p
, 
Ãw_max
);

931 
	`SET_TOTAL_FREE
(
p
, 
	`TOTAL_FREE
Õè- 
Ãeded
);

934 
	`d–‘e_™em
(0, 
çl£
);

935 
	`add_™em
(
kt
, 0);

940 ià(
chªged_n
 =ğ
C
[0].
n
 && 
chªged_c
 =ğC[0].
c
) {

941 ià(
£q_couÁ
 < 0) seq_count++;

943 
£q_couÁ
 = 
SEQ_START_POINT
;

944 
£qu’tŸl
 = 
çl£
;

946 
C
[0].
c
 +ğ
D2
;

947 
	`add_™em
(
kt
, 0);

949  
compÚ’ts
;

950 
	}
}

958 
	gFlštTabË
::
	$d–‘e_kt
()

960 
	`As£¹
(
wr™abË
);

962 
boŞ
 
found
 = 
	`fšd
(
C
);

964 
compÚ’ts
 = 0;

965 
£q_couÁ
 = 
SEQ_START_POINT
;

966 
£qu’tŸl
 = 
çl£
;

974 ià(
found
) {

975 
compÚ’ts
 = 
	`I‹m_
(
C
[0].
p
, C[0].
c
).
	`compÚ’ts_of
();

976 
	`®‹r
();

977 
	`d–‘e_™em
(0, 
Œue
);

979  
compÚ’ts
;

980 
	}
}

991 
	gFlštTabË
::
	$fÜm_key
(cÚ¡ 
¡ršg
 & 
key
) const

993 
kt
.
	`fÜm_key
(
key
);

994 
	}
}

1020 
	gFlštTabË
::
	$add
(cÚ¡ 
¡ršg
 &
key
, sŒšg 
g
, 
boŞ
 
®»ady_com´es£d
)

1022 
	`DEBUGCALL
(
DB
, , "FlštTabË::add", 
key
 << ", " << 
g
);

1023 
	`As£¹
(
wr™abË
);

1025 ià(
hªdË
 < 0è
	`ü—‹_ªd_İ’
(
block_size
);

1027 
	`fÜm_key
(
key
);

1029 
boŞ
 
com´es£d
 = 
çl£
;

1030 ià(
®»ady_com´es£d
) {

1031 
com´es£d
 = 
Œue
;

1032 } ià(
com´ess_¡¿‹gy
 !ğ
DONT_COMPRESS
 && 
g
.
	`size
(è> 
COMPRESS_MIN
) {

1033 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_DEFAULT_STRATEGY
);

1034 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_FILTERED
);

1035 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_HUFFMAN_ONLY
);

1036 #ifdeà
Z_RLE


1037 
	`CompeTimeAs£¹
(
DONT_COMPRESS
 !ğ
Z_RLE
);

1040 
	`Ïzy_®loc_deæ©e_z¡»am
();

1043 * 
nÚ_cÚ¡_g
 = 
cÚ¡_ÿ¡
<*>(
g
.
	`d©a
());

1044 
deæ©e_z¡»am
->
Ãxt_š
 = 
»š‹½»t_ÿ¡
<
By‹
 *>(
nÚ_cÚ¡_g
);

1045 
deæ©e_z¡»am
->
ava_š
 = 
	`uIÁ
(
g
.
	`size
());

1048 
blk_Ën
 = 
g
.
	`size
() - 1;

1049 * 
blk
 = 
Ãw
 [
blk_Ën
];

1050 
deæ©e_z¡»am
->
Ãxt_out
 = 
blk
;

1051 
deæ©e_z¡»am
->
ava_out
 = 
	`uIÁ
(
blk_Ën
);

1053 
”r
 = 
	`deæ©e
(
deæ©e_z¡»am
, 
Z_FINISH
);

1054 ià(
”r
 =ğ
Z_STREAM_END
) {

1057 
g
.
	`assign
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
blk
), 
deæ©e_z¡»am
->
tÙ®_out
);

1058 
com´es£d
 = 
Œue
;

1063 
d–‘e
 [] 
blk
;

1067 cÚ¡ 
size_t
 
cd
 = 
kt
.
	`key
().
	`Ëngth
(è+ 
K1
 + 
I2
 + 
C2
 + C2;

1068 cÚ¡ 
size_t
 
L
 = 
max_™em_size
 - 
cd
;

1069 
size_t
 
fœ¡_L
 = 
L
;

1070 
boŞ
 
found
 = 
	`fšd
(
C
);

1071 ià(!
found
) {

1072 
by‹
 * 
p
 = 
C
[0].p;

1073 
size_t
 
n
 = 
	`TOTAL_FREE
(
p
è% (
max_™em_size
 + 
D2
);

1074 ià(
n
 > 
D2
 + 
cd
) {

1075 
n
 -ğ(
D2
 + 
cd
);

1088 
size_t
 
Ï¡
 = 
g
.
	`Ëngth
(è% 
L
;

1089 ià(
n
 >ğ
Ï¡
 || (
fuÎ_com·ùiÚ
 &&‚ >ğ
key
.
	`size
() + 34))

1090 
fœ¡_L
 = 
n
;

1095 
m
 = 
g
.
	`em±y
(è? 1 : (g.
	`Ëngth
(è- 
fœ¡_L
 + 
L
 - 1) / L + 1;

1100 ià(
m
 >ğ
BYTE_PAIR_RANGE
)

1101 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Can't handle insanely†argeags");

1103 
n
 = 0;

1105 
o
 = 0;

1106 
size_t
 
»sidue
 = 
g
.
	`Ëngth
();

1107 
»¶aûm’t
 = 
çl£
;

1108 
i
;

1109 
kt
.
	`£t_compÚ’ts_of
(
m
);

1110 
i
 = 1; i <ğ
m
; i++) {

1111 
size_t
 
l
 = (
i
 =ğ
m
 ? 
»sidue
 : (˜=ğ1 ? 
fœ¡_L
 : 
L
));

1112 
	`As£¹
(
cd
 + 
l
 <ğ
block_size
);

1113 
	`As£¹
(
¡ršg
::
	`size_ty³
(
o
 + 
l
è<ğ
g
.
	`Ëngth
());

1114 
kt
.
	`£t_g
(
cd
, 
g
.
	`d©a
(è+ 
o
, 
l
, 
com´es£d
);

1115 
kt
.
	`£t_compÚ’t_of
(
i
);

1117 
o
 +ğ
l
;

1118 
»sidue
 -ğ
l
;

1120 ià(
i
 > 1è
found
 = 
	`fšd
(
C
);

1121 
n
 = 
	`add_kt
(
found
);

1122 ià(
n
 > 0è
»¶aûm’t
 = 
Œue
;

1125 
i
 = 
m
 + 1; i <ğ
n
; i++) {

1126 
kt
.
	`£t_compÚ’t_of
(
i
);

1127 
	`d–‘e_kt
();

1129 ià(!
»¶aûm’t
è++
™em_couÁ
;

1130 
BŒ“_modif›d
 = 
Œue
;

1131 
	}
}

1139 
boŞ


1140 
	gFlštTabË
::
	$d–
(cÚ¡ 
¡ršg
 &
key
)

1142 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštTabË::d–", 
key
);

1143 
	`As£¹
(
wr™abË
);

1145 ià(
hªdË
 < 0) {

1146 ià(
hªdË
 == -2) {

1147 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1149 
	`RETURN
(
çl£
);

1153 ià(
key
.
	`size
(è> 
FLINT_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1155 ià(
key
.
	`em±y
()è
	`RETURN
(
çl£
);

1156 
	`fÜm_key
(
key
);

1158 
n
 = 
	`d–‘e_kt
();

1159 ià(
n
 <ğ0è
	`RETURN
(
çl£
);

1161 
i
 = 2; i <ğ
n
; i++) {

1162 
kt
.
	`£t_compÚ’t_of
(
i
);

1163 
	`d–‘e_kt
();

1166 
™em_couÁ
--;

1167 
BŒ“_modif›d
 = 
Œue
;

1168 
	`RETURN
(
Œue
);

1169 
	}
}

1171 
boŞ


1172 
	gFlštTabË
::
	$g‘_exaù_’Œy
(cÚ¡ 
¡ršg
 &
key
, sŒšg & 
g
) const

1174 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštTabË::g‘_exaù_’Œy", 
key
 << ", [&tag]");

1175 
	`As£¹
(!
key
.
	`em±y
());

1177 ià(
hªdË
 < 0) {

1178 ià(
hªdË
 == -2) {

1179 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1181 
	`RETURN
(
çl£
);

1185 ià(
key
.
	`size
(è> 
FLINT_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1187 
	`fÜm_key
(
key
);

1188 ià(!
	`fšd
(
C
)è
	`RETURN
(
çl£
);

1190 ()
	`»ad_g
(
C
, &
g
, 
çl£
);

1191 
	`RETURN
(
Œue
);

1192 
	}
}

1194 
boŞ


1195 
	gFlštTabË
::
	$key_exi¡s
(cÚ¡ 
¡ršg
 &
key
) const

1197 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštTabË::key_exi¡s", 
key
);

1198 
	`As£¹
(!
key
.
	`em±y
());

1201 ià(
key
.
	`size
(è> 
FLINT_BTREE_MAX_KEY_LEN
è
	`RETURN
(
çl£
);

1203 
	`fÜm_key
(
key
);

1204 
	`RETURN
(
	`fšd
(
C
));

1205 
	}
}

1207 
boŞ


1208 
	gFlštTabË
::
	$»ad_g
(
CursÜ_
 * 
C_
, 
¡ršg
 *
g
, 
boŞ
 
k“p_com´es£d
) const

1210 
I‹m_
 
	`™em
(
C_
[0].
p
, C_[0].
c
);

1213 
n
 = 
™em
.
	`compÚ’ts_of
();

1215 
g
->
	`»size
(0);

1218 ià(
n
 > 1è
g
->
	`»£rve
((
max_™em_size
 - (1 + 
K1
 + 
I2
 + 
C2
 + C2)) *‚);

1220 
™em
.
	`­³nd_chunk
(
g
);

1221 
boŞ
 
com´es£d
 = 
™em
.
	`g‘_com´es£d
();

1223 
i
 = 2; i <ğ
n
; i++) {

1224 ià(!
	`Ãxt
(
C_
, 0)) {

1225 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Unexpectedƒnd ofable when„eading continuation ofag");

1227 ()
	`I‹m_
(
C_
[0].
p
, C_[0].
c
).
	`­³nd_chunk
(
g
);

1231 ià(!
com´es£d
 || 
k“p_com´es£d
)  compressed;

1237 
¡ršg
 
ug
;

1239 
ug
.
	`»£rve
(
g
->
	`size
() +ag->size() / 2);

1241 
By‹f
 
buf
[8192];

1243 
	`Ïzy_®loc_šæ©e_z¡»am
();

1246 * 
nÚ_cÚ¡_g
 = 
cÚ¡_ÿ¡
<*>(
g
->
	`d©a
());

1247 
šæ©e_z¡»am
->
Ãxt_š
 = 
»š‹½»t_ÿ¡
<
By‹
 *>(
nÚ_cÚ¡_g
);

1248 
šæ©e_z¡»am
->
ava_š
 = 
	`uIÁ
(
g
->
	`size
());

1250 
”r
 = 
Z_OK
;

1251 
”r
 !ğ
Z_STREAM_END
) {

1252 
šæ©e_z¡»am
->
Ãxt_out
 = 
buf
;

1253 
šæ©e_z¡»am
->
ava_out
 = 
	`uIÁ
((
buf
));

1254 
”r
 = 
	`šæ©e
(
šæ©e_z¡»am
, 
Z_SYNC_FLUSH
);

1255 ià(
”r
 =ğ
Z_BUF_ERROR
 && 
šæ©e_z¡»am
->
ava_š
 == 0) {

1256 
	`LOGLINE
(
DB
, "Z_BUF_ERROR - fakšg checksum oà" << 
šæ©e_z¡»am
->
adËr
);

1257 
By‹f
 
h—d”2
[4];

1258 
	`£tšt4
(
h—d”2
, 0, 
šæ©e_z¡»am
->
adËr
);

1259 
šæ©e_z¡»am
->
Ãxt_š
 = 
h—d”2
;

1260 
šæ©e_z¡»am
->
ava_š
 = 4;

1261 
”r
 = 
	`šæ©e
(
šæ©e_z¡»am
, 
Z_SYNC_FLUSH
);

1262 ià(
”r
 =ğ
Z_STREAM_END
) ;

1265 ià(
”r
 !ğ
Z_OK
 &&ƒ¼ !ğ
Z_STREAM_END
) {

1266 ià(
”r
 =ğ
Z_MEM_ERROR
è
throw
 
¡d
::
	`bad_®loc
();

1267 
¡ršg
 
msg
 = "inflate failed";

1268 ià(
šæ©e_z¡»am
->
msg
) {

1269 
msg
 += " (";

1270 
msg
 +ğ
šæ©e_z¡»am
->msg;

1271 
msg
 += ')';

1273 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1276 
ug
.
	`­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
),

1277 
šæ©e_z¡»am
->
Ãxt_out
 - 
buf
);

1279 ià(
ug
.
	`size
(è!ğ
šæ©e_z¡»am
->
tÙ®_out
) {

1280 
¡ršg
 
msg
 = "compressedag didn'tƒxpandoheƒxpected size: ";

1281 
msg
 +ğ
	`om_to¡ršg
(
ug
.
	`size
());

1282 
msg
 += " != ";

1284 
msg
 +ğ
	`om_to¡ršg
(
	`size_t
(
šæ©e_z¡»am
->
tÙ®_out
));

1285 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

1288 
	`sw­
(*
g
, 
ug
);

1290  
çl£
;

1291 
	}
}

1294 
	gFlštTabË
::
	$£t_fuÎ_com·ùiÚ
(
boŞ
 
·r™y
)

1296 
	`As£¹
(
wr™abË
);

1298 ià(
·r™y
è
£q_couÁ
 = 0;

1299 
fuÎ_com·ùiÚ
 = 
·r™y
;

1300 
	}
}

1302 
FlštCursÜ
 * 
	gFlštTabË
::
	$cursÜ_g‘
() const {

1303 ià(
hªdË
 < 0) {

1304 ià(
hªdË
 == -2) {

1305 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1307  
NULL
;

1310  
Ãw
 
	`FlštCursÜ
(
cÚ¡_ÿ¡
<
FlštTabË
 *>(
this
));

1311 
	}
}

1315 
boŞ


1316 
	gFlštTabË
::
	$basic_İ’
(
boŞ
 
»visiÚ_suµl›d
, 
æšt_»visiÚ_numb”_t
 
»visiÚ_
)

1318 
ch
 = 'X';

1321 cÚ¡ 
size_t
 
BTREE_BASES
 = 2;

1322 
¡ršg
 
”r_msg
;

1323 cÚ¡ 
ba£Çmes
[
BTREE_BASES
] = { 'A', 'B' };

1325 
FlštTabË_ba£
 
ba£s
[
BTREE_BASES
];

1326 
boŞ
 
ba£_ok
[
BTREE_BASES
];

1328 
bÙh_ba£s
 = 
Œue
;

1329 
boŞ
 
v®id_ba£
 = 
çl£
;

1331 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1332 
boŞ
 
ok
 = 
ba£s
[
i
].
	`»ad
(
Çme
, 
ba£Çmes
[i], 
”r_msg
);

1333 
ba£_ok
[
i
] = 
ok
;

1334 ià(
ok
) {

1335 
v®id_ba£
 = 
Œue
;

1337 
bÙh_ba£s
 = 
çl£
;

1342 ià(!
v®id_ba£
) {

1343 ià(
hªdË
 >= 0) {

1344 ::
	`şo£
(
hªdË
);

1345 
hªdË
 = -1;

1347 
¡ršg
 
mes§ge
 = "Error openingable `";

1348 
mes§ge
 +ğ
Çme
;

1349 
mes§ge
 += "':\n";

1350 
mes§ge
 +ğ
”r_msg
;

1351 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

1354 ià(
»visiÚ_suµl›d
) {

1355 
boŞ
 
found_»visiÚ
 = 
çl£
;

1356 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1357 ià(
ba£_ok
[
i
] && 
ba£s
[i].
	`g‘_»visiÚ
(è=ğ
»visiÚ_
) {

1358 
ch
 = 
ba£Çmes
[
i
];

1359 
found_»visiÚ
 = 
Œue
;

1363 ià(!
found_»visiÚ
) {

1368  
çl£
;

1371 
æšt_»visiÚ_numb”_t
 
highe¡_»visiÚ
 = 0;

1372 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1373 ià(
ba£_ok
[
i
] && 
ba£s
[i].
	`g‘_»visiÚ
(è>ğ
highe¡_»visiÚ
) {

1374 
ch
 = 
ba£Çmes
[
i
];

1375 
highe¡_»visiÚ
 = 
ba£s
[
i
].
	`g‘_»visiÚ
();

1380 
FlštTabË_ba£
 *
ba£p
 = 0;

1381 
FlštTabË_ba£
 *
Ùh”_ba£
 = 0;

1383 
size_t
 
i
 = 0; i < 
BTREE_BASES
; ++i) {

1384 
	`LOGLINE
(
DB
, "Checkšg (ch =ğ" << 
ch
 << ")‡gainst "

1385 "ba£Çmes[" << 
i
 << "] =ğ" << 
ba£Çmes
[i]);

1386 
	`LOGLINE
(
DB
, "ba£s[" << 
i
 << "].get_revision() == " <<

1387 
ba£s
[
i
].
	`g‘_»visiÚ
());

1388 
	`LOGLINE
(
DB
, "ba£_ok[" << 
i
 << "] =ğ" << 
ba£_ok
[i]);

1389 ià(
ch
 =ğ
ba£Çmes
[
i
]) {

1390 
ba£p
 = &
ba£s
[
i
];

1393 
size_t
 
Ùh”ba£_num
 = 1-
i
;

1394 ià(
ba£_ok
[
Ùh”ba£_num
]) {

1395 
Ùh”_ba£
 = &
ba£s
[
Ùh”ba£_num
];

1400 
	`As£¹
(
ba£p
);

1407 
ba£
.
	`sw­
(*
ba£p
);

1409 
»visiÚ_numb”
 = 
ba£
.
	`g‘_»visiÚ
();

1410 
block_size
 = 
ba£
.
	`g‘_block_size
();

1411 
roÙ
 = 
ba£
.
	`g‘_roÙ
();

1412 
Ëv–
 = 
ba£
.
	`g‘_Ëv–
();

1414 
™em_couÁ
 = 
ba£
.
	`g‘_™em_couÁ
();

1415 
çked_roÙ_block
 = 
ba£
.
	`g‘_have_çk”oÙ
();

1416 
£qu’tŸl
 = 
ba£
.
	`g‘_£qu’tŸl
();

1418 ià(
Ùh”_ba£
 != 0) {

1419 
Ï‹¡_»visiÚ_numb”
 = 
Ùh”_ba£
->
	`g‘_»visiÚ
();

1420 ià(
»visiÚ_numb”
 > 
Ï‹¡_»visiÚ_numb”
)

1421 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1423 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1428 
kt
 = 
	`I‹m_wr_
(
	`z”Ûd_Ãw
(
block_size
));

1430 
	`£t_max_™em_size
(
BLOCK_CAPACITY
);

1432 
ba£_Ë‰”
 = 
ch
;

1436  
Œue
;

1437 
	}
}

1440 
	gFlštTabË
::
	$»ad_roÙ
()

1442 ià(
çked_roÙ_block
) {

1444 
by‹
 * 
p
 = 
C
[0].p;

1445 
	`As£¹
(
p
);

1450 
	`mem£t
(
p
, 0, 
block_size
);

1452 
o
 = 
block_size
 - 
I2
 - 
K1
 - 
C2
 - C2;

1453 
	`I‹m_wr_
(
p
 + 
o
).
	`çke_roÙ_™em
();

1455 
	`£tD
(
p
, 
DIR_START
, 
o
);

1456 
	`SET_DIR_END
(
p
, 
DIR_START
 + 
D2
);

1458 
o
 -ğ(
DIR_START
 + 
D2
);

1459 
	`SET_MAX_FREE
(
p
, 
o
);

1460 
	`SET_TOTAL_FREE
(
p
, 
o
);

1461 
	`SET_LEVEL
(
p
, 0);

1463 ià(!
wr™abË
) {

1466 
	`SET_REVISION
(
p
, 0);

1467 
C
[0].
n
 = 0;

1470 
	`SET_REVISION
(
p
, 
Ï‹¡_»visiÚ_numb”
 + 1);

1471 
C
[0].
n
 = 
ba£
.
	`Ãxt_ä“_block
();

1475 
	`block_to_cursÜ
(
C
, 
Ëv–
, 
roÙ
);

1477 ià(
	`REVISION
(
C
[
Ëv–
].
p
è> 
»visiÚ_numb”
è
	`£t_ov”wr™‹n
();

1480 
	}
}

1482 
boŞ


1483 
	gFlštTabË
::
	$do_İ’_to_wr™e
(
boŞ
 
»visiÚ_suµl›d
,

1484 
æšt_»visiÚ_numb”_t
 
»visiÚ_
,

1485 
boŞ
 
ü—‹_db
)

1487 ià(
hªdË
 == -2) {

1488 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1490 
æags
 = 
O_RDWR
 | 
O_BINARY
;

1491 ià(
ü—‹_db
è
æags
 |ğ
O_CREAT
 | 
O_TRUNC
;

1492 
hªdË
 = ::
	`İ’
((
Çme
 + "DB").
	`c_¡r
(), 
æags
, 0666);

1493 ià(
hªdË
 < 0) {

1496 ià(
Ïzy
 && !
ü—‹_db
 && 
”ºo
 =ğ
ENOENT
) {

1497 
»visiÚ_numb”
 = 
»visiÚ_
;

1498  
Œue
;

1500 
¡ršg
 
	`mes§ge
(
ü—‹_db
 ? "Couldn't create " : "Couldn't open ");

1501 
mes§ge
 +ğ
Çme
;

1502 
mes§ge
 += "DB„ead/write: ";

1503 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

1504 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

1507 ià(!
	`basic_İ’
(
»visiÚ_suµl›d
, 
»visiÚ_
)) {

1508 ::
	`şo£
(
hªdË
);

1509 
hªdË
 = -1;

1510 ià(!
»visiÚ_suµl›d
) {

1511 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Failedo open for writing");

1516  
çl£
;

1519 
wr™abË
 = 
Œue
;

1521 
j
 = 0; j <ğ
Ëv–
; j++) {

1522 
C
[
j
].
n
 = 
BLK_UNUSED
;

1523 
C
[
j
].
p
 = 
Ãw
 
by‹
[
block_size
];

1524 ià(
C
[
j
].
p
 == 0) {

1525 
throw
 
¡d
::
	`bad_®loc
();

1528 
¥l™_p
 = 
Ãw
 
by‹
[
block_size
];

1529 ià(
¥l™_p
 == 0) {

1530 
throw
 
¡d
::
	`bad_®loc
();

1532 
	`»ad_roÙ
();

1534 
bufãr
 = 
	`z”Ûd_Ãw
(
block_size
);

1536 
chªged_n
 = 0;

1537 
chªged_c
 = 
DIR_START
;

1538 
£q_couÁ
 = 
SEQ_START_POINT
;

1540  
Œue
;

1541 
	}
}

1543 
	gFlštTabË
::
	$FlštTabË
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡ršg
 & 
·th_
,

1544 
boŞ
 
»adÚly_
, 
com´ess_¡¿‹gy_
, boŞ 
Ïzy_
)

1545 : 
	`bËÇme
(
bËÇme_
),

1546 
	`»visiÚ_numb”
(0),

1547 
	`™em_couÁ
(0),

1548 
	`block_size
(0),

1549 
	`Ï‹¡_»visiÚ_numb”
(0),

1550 
	`bÙh_ba£s
(
çl£
),

1551 
	`ba£_Ë‰”
('A'),

1552 
	`çked_roÙ_block
(
Œue
),

1553 
	`£qu’tŸl
(
Œue
),

1554 
	`hªdË
(-1),

1555 
	`Ëv–
(0),

1556 
	`roÙ
(0),

1557 
	`kt
(0),

1558 
	`bufãr
(0),

1559 
	`ba£
(),

1560 
	`Çme
(
·th_
),

1561 
	`£q_couÁ
(0),

1562 
	`chªged_n
(0),

1563 
	`chªged_c
(0),

1564 
	`max_™em_size
(0),

1565 
	`BŒ“_modif›d
(
çl£
),

1566 
	`fuÎ_com·ùiÚ
(
çl£
),

1567 
	`wr™abË
(!
»adÚly_
),

1568 
	`¥l™_p
(0),

1569 
	`com´ess_¡¿‹gy
(
com´ess_¡¿‹gy_
),

1570 
	`deæ©e_z¡»am
(
NULL
),

1571 
	`šæ©e_z¡»am
(
NULL
),

1572 
	$Ïzy
(
Ïzy_
)

1574 
	`DEBUGCALL
(
DB
, , "FlintTable::FlintTable",

1575 
bËÇme_
 << "," << 
·th_
 << ", " << 
»adÚly_
 << ", " <<

1576 
com´ess_¡¿‹gy_
 << ", " << 
Ïzy_
);

1577 
	}
}

1579 
boŞ


1580 
	gFlštTabË
::
	$»®ly_em±y
() const

1582 ià(
hªdË
 < 0) {

1583 ià(
hªdË
 == -2) {

1584 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1586  
Œue
;

1588 
FlštCursÜ
 
	`cur
(
cÚ¡_ÿ¡
<
FlštTabË
*>(
this
));

1589 
cur
.
	`fšd_’Œy
(
	`¡ršg
());

1590  !
cur
.
	`Ãxt
();

1591 
	}
}

1594 
	gFlštTabË
::
	$Ïzy_®loc_deæ©e_z¡»am
() const {

1595 ià(
	`usu®
(
deæ©e_z¡»am
)) {

1596 ià(
	`usu®
(
	`deæ©eRe£t
(
deæ©e_z¡»am
è=ğ
Z_OK
)) ;

1598 
d–‘e
 
deæ©e_z¡»am
;

1601 
deæ©e_z¡»am
 = 
Ãw
 
z_¡»am
;

1603 
deæ©e_z¡»am
->
z®loc
 = 
»š‹½»t_ÿ¡
<
®loc_func
>(0);

1604 
deæ©e_z¡»am
->
zä“
 = 
»š‹½»t_ÿ¡
<
ä“_func
>(0);

1605 
deæ©e_z¡»am
->
İaque
 = 
	`voidpf
(0);

1609 
”r
;

1610 
”r
 = 
	`deæ©eIn™2
(
deæ©e_z¡»am
, 
Z_DEFAULT_COMPRESSION
, 
Z_DEFLATED
,

1611 -15, 9, 
com´ess_¡¿‹gy
);

1612 ià(
	`¿»
(
”r
 !ğ
Z_OK
)) {

1613 ià(
”r
 =ğ
Z_MEM_ERROR
) {

1614 
d–‘e
 
deæ©e_z¡»am
;

1615 
deæ©e_z¡»am
 = 0;

1616 
throw
 
¡d
::
	`bad_®loc
();

1618 
¡ršg
 
msg
 = "deflateInit2 failed (";

1619 ià(
deæ©e_z¡»am
->
msg
) {

1620 
msg
 +ğ
deæ©e_z¡»am
->msg;

1622 
msg
 +ğ
	`om_to¡ršg
(
”r
);

1624 
msg
 += ')';

1625 
d–‘e
 
deæ©e_z¡»am
;

1626 
deæ©e_z¡»am
 = 0;

1627 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1629 
	}
}

1632 
	gFlštTabË
::
	$Ïzy_®loc_šæ©e_z¡»am
() const {

1633 ià(
	`usu®
(
šæ©e_z¡»am
)) {

1634 ià(
	`usu®
(
	`šæ©eRe£t
(
šæ©e_z¡»am
è=ğ
Z_OK
)) ;

1636 
d–‘e
 
šæ©e_z¡»am
;

1639 
šæ©e_z¡»am
 = 
Ãw
 
z_¡»am
;

1641 
šæ©e_z¡»am
->
z®loc
 = 
»š‹½»t_ÿ¡
<
®loc_func
>(0);

1642 
šæ©e_z¡»am
->
zä“
 = 
»š‹½»t_ÿ¡
<
ä“_func
>(0);

1644 
šæ©e_z¡»am
->
Ãxt_š
 = 
Z_NULL
;

1645 
šæ©e_z¡»am
->
ava_š
 = 0;

1647 
”r
 = 
	`šæ©eIn™2
(
šæ©e_z¡»am
, -15);

1648 ià(
	`¿»
(
”r
 !ğ
Z_OK
)) {

1649 ià(
”r
 =ğ
Z_MEM_ERROR
) {

1650 
d–‘e
 
šæ©e_z¡»am
;

1651 
šæ©e_z¡»am
 = 0;

1652 
throw
 
¡d
::
	`bad_®loc
();

1654 
¡ršg
 
msg
 = "inflateInit2 failed (";

1655 ià(
šæ©e_z¡»am
->
msg
) {

1656 
msg
 +ğ
šæ©e_z¡»am
->msg;

1658 
msg
 +ğ
	`om_to¡ršg
(
”r
);

1660 
msg
 += ')';

1661 
d–‘e
 
šæ©e_z¡»am
;

1662 
šæ©e_z¡»am
 = 0;

1663 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1665 
	}
}

1667 
boŞ


1668 
	gFlštTabË
::
	$exi¡s
() const {

1669 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintTable::exists", "");

1670  (
	`fe_exi¡s
(
Çme
 + "DB") &&

1671 (
	`fe_exi¡s
(
Çme
 + "baseA") || file_exists(name + "baseB")));

1672 
	}
}

1678 
	$sys_uÆšk_if_exi¡s
(cÚ¡ 
¡ršg
 & 
f’ame
)

1680 #ifdeà
__WIN32__


1681 ià(
	`msvc_posix_uÆšk
(
f’ame
.
	`c_¡r
()) == -1) {

1683 ià(
	`uÆšk
(
f’ame
) == -1) {

1685 ià(
”ºo
 =ğ
ENOENT
) ;

1686 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Cª'ˆd–‘fe: `" + 
f’ame
 +

1687 "': " + 
	`¡»¼Ü
(
”ºo
));

1689 
	}
}

1692 
	gFlštTabË
::
	$”a£
()

1694 
	`DEBUGCALL
(
DB
, , "FlintTable::erase", "");

1695 
	`şo£
();

1697 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseA");

1698 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseB");

1699 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "DB");

1700 
	}
}

1703 
	gFlštTabË
::
	$£t_block_size
(
block_size_
)

1705 
	`DEBUGCALL
(
DB
, , "FlštTabË::£t_block_size", 
block_size_
);

1707 ià(
block_size_
 < 2048 || block_size_ > 
BYTE_PAIR_RANGE
 ||

1708 (
block_size_
 & (block_size_ - 1)) != 0) {

1709 
block_size_
 = 
FLINT_DEFAULT_BLOCK_SIZE
;

1711 
block_size
 = 
block_size_
;

1712 
	}
}

1715 
	gFlštTabË
::
	$ü—‹_ªd_İ’
(
block_size_
)

1717 
	`DEBUGCALL
(
DB
, , "FlštTabË::ü—‹_ªd_İ’", 
block_size_
);

1718 ià(
hªdË
 == -2) {

1719 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1721 
	`As£¹
(
wr™abË
);

1722 
	`şo£
();

1724 ià(
block_size_
 =ğ0è
	`abÜt
();

1725 
	`£t_block_size
(
block_size_
);

1734 
FlštTabË_ba£
 
ba£_
;

1735 
ba£_
.
	`£t_»visiÚ
(
»visiÚ_numb”
);

1736 
ba£_
.
	`£t_block_size
(
block_size_
);

1737 
ba£_
.
	`£t_have_çk”oÙ
(
Œue
);

1738 
ba£_
.
	`£t_£qu’tŸl
(
Œue
);

1739 
ba£_
.
	`wr™e_to_fe
(
Çme
 + "ba£A", 'A', "", -1, 
NULL
);

1742 
	`sys_uÆšk_if_exi¡s
(
Çme
 + "baseB");

1745 ()
	`do_İ’_to_wr™e
(
çl£
, 0, 
Œue
);

1746 
	}
}

1748 
	gFlštTabË
::~
	$FlštTabË
() {

1749 
	`DEBUGCALL
(
DB
, , "FlintTable::~FlintTable", "");

1750 
FlštTabË
::
	`şo£
();

1752 ià(
deæ©e_z¡»am
) {

1755 (è
	`deæ©eEnd
(
deæ©e_z¡»am
);

1756 
d–‘e
 
deæ©e_z¡»am
;

1759 ià(
šæ©e_z¡»am
) {

1762 (è
	`šæ©eEnd
(
šæ©e_z¡»am
);

1763 
d–‘e
 
šæ©e_z¡»am
;

1765 
	}
}

1767 
	gFlštTabË
::
	$şo£
(
boŞ
 
³rmª’t
) {

1768 
	`DEBUGCALL
(
DB
, , "FlintTable::close", "");

1770 ià(
hªdË
 >= 0) {

1773 ()::
	`şo£
(
hªdË
);

1774 
hªdË
 = -1;

1777 ià(
³rmª’t
) {

1778 
hªdË
 = -2;

1784 
j
 = 
Ëv–
; j >= 0; j--) {

1785 
d–‘e
 [] 
C
[
j
].
p
;

1786 
C
[
j
].
p
 = 0;

1788 
d–‘e
 [] 
¥l™_p
;

1789 
¥l™_p
 = 0;

1791 
d–‘e
 [] 
kt
.
	`g‘_add»ss
();

1792 
kt
 = 0;

1793 
d–‘e
 [] 
bufãr
;

1794 
bufãr
 = 0;

1795 
	}
}

1798 
	gFlštTabË
::
	$æush_db
()

1800 
	`DEBUGCALL
(
DB
, , "FlintTable::flush_db", "");

1801 
	`As£¹
(
wr™abË
);

1802 ià(
hªdË
 < 0) {

1803 ià(
hªdË
 == -2) {

1804 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1809 
j
 = 
Ëv–
; j >= 0; j--) {

1810 ià(
C
[
j
].
»wr™e
) {

1811 
	`wr™e_block
(
C
[
j
].
n
, C[j].
p
);

1815 ià(
BŒ“_modif›d
) {

1816 
çked_roÙ_block
 = 
çl£
;

1818 
	}
}

1821 
	gFlštTabË
::
	$comm™
(
æšt_»visiÚ_numb”_t
 
»visiÚ
, 
chªges_fd
,

1822 cÚ¡ 
¡ršg
 * 
chªges_
)

1824 
	`DEBUGCALL
(
DB
, , "FlintTable::commit",

1825 
»visiÚ
 << ", " << 
chªges_fd
 << ", " << 
chªges_
);

1826 
	`As£¹
(
wr™abË
);

1828 ià(
»visiÚ
 <ğ
»visiÚ_numb”
) {

1829 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("New„evisionoo†ow");

1832 ià(
hªdË
 < 0) {

1833 ià(
hªdË
 == -2) {

1834 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1836 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
 = 
»visiÚ
;

1840 
Œy
 {

1841 ià(
çked_roÙ_block
) {

1843 
ba£
.
	`ş—r_b™_m­
();

1846 
ba£
.
	`£t_»visiÚ
(
»visiÚ
);

1847 
ba£
.
	`£t_roÙ
(
C
[
Ëv–
].
n
);

1848 
ba£
.
	`£t_Ëv–
(
Ëv–
);

1849 
ba£
.
	`£t_™em_couÁ
(
™em_couÁ
);

1850 
ba£
.
	`£t_have_çk”oÙ
(
çked_roÙ_block
);

1851 
ba£
.
	`£t_£qu’tŸl
(
£qu’tŸl
);

1853 
ba£_Ë‰”
 = 
	`Ùh”_ba£_Ë‰”
();

1855 
bÙh_ba£s
 = 
Œue
;

1856 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
 = 
»visiÚ
;

1857 
roÙ
 = 
C
[
Ëv–
].
n
;

1859 
BŒ“_modif›d
 = 
çl£
;

1861 
i
 = 0; i < 
BTREE_CURSOR_LEVELS
; ++i) {

1862 
C
[
i
].
n
 = 
BLK_UNUSED
;

1863 
C
[
i
].
c
 = -1;

1864 
C
[
i
].
»wr™e
 = 
çl£
;

1869 ià(!
	`æšt_io_sync
(
hªdË
)) {

1870 ()::
	`şo£
(
hªdË
);

1871 
hªdË
 = -1;

1872 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Can't commit‚ew„evision - failedo flush DBo disk");

1877 
¡ršg
 
tmp
 = 
Çme
;

1878 
tmp
 += "tmp";

1879 
¡ršg
 
ba£fe
 = 
Çme
;

1880 
ba£fe
 += "base";

1881 
ba£fe
 +ğ(
ba£_Ë‰”
);

1882 
ba£
.
	`wr™e_to_fe
(
tmp
, 
ba£_Ë‰”
, 
bËÇme
, 
chªges_fd
, 
chªges_
);

1883 #ià
defšed
 
__WIN32__


1884 ià(
	`msvc_posix_»Çme
(
tmp
.
	`c_¡r
(), 
ba£fe
.c_str()) < 0)

1886 ià(
	`»Çme
(
tmp
.
	`c_¡r
(), 
ba£fe
.c_str()) < 0)

1894 
§ved_”ºo
 = 
”ºo
;

1895 ià(
	`uÆšk
(
tmp
è=ğ0 || 
”ºo
 !ğ
ENOENT
) {

1896 
¡ršg
 
	`msg
("Couldn't update base file ");

1897 
msg
 +ğ
ba£fe
;

1898 
msg
 += ": ";

1899 
msg
 +ğ
	`¡»¼Ü
(
§ved_”ºo
);

1900 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
);

1903 
ba£
.
	`comm™
();

1905 
	`»ad_roÙ
();

1907 
chªged_n
 = 0;

1908 
chªged_c
 = 
DIR_START
;

1909 
£q_couÁ
 = 
SEQ_START_POINT
;

1910 } 
	`ÿtch
(...) {

1911 
FlštTabË
::
	`şo£
();

1912 
throw
;

1914 
	}
}

1917 
	gFlštTabË
::
	$wr™e_chªged_blocks
(
chªges_fd
)

1919 
	`As£¹
(
chªges_fd
 >= 0);

1920 ià(
hªdË
 < 0) ;

1921 ià(
çked_roÙ_block
) ;

1923 
¡ršg
 
buf
;

1924 
buf
 +ğ
	`F_·ck_ušt
(2u);

1925 
buf
 +ğ
	`F_·ck_ušt
(
	`¡¾’
(
bËÇme
));

1926 
buf
 +ğ
bËÇme
;

1927 
buf
 +ğ
	`F_·ck_ušt
(
block_size
);

1928 
	`æšt_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1932 
ušt4
 
n
 = 0;

1933 
by‹
 * 
p
 = 
Ãw
 by‹[
block_size
];

1934 
Œy
 {

1935 
ba£
.
	`ÿlcuÏ‹_Ï¡_block
();

1936 
ba£
.
	`fšd_chªged_block
(&
n
)) {

1937 
buf
 = 
	`F_·ck_ušt
(
n
 + 1);

1938 
	`æšt_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1941 
	`»ad_block
(
n
, 
p
);

1944 
	`æšt_io_wr™e
(
chªges_fd
, 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
),

1945 
block_size
);

1946 ++
n
;

1948 
d–‘e
[] 
p
;

1949 
p
 = 0;

1950 } 
	`ÿtch
 (...) {

1951 
d–‘e
[] 
p
;

1952 
throw
;

1954 
buf
 = 
	`F_·ck_ušt
(0u);

1955 
	`æšt_io_wr™e
(
chªges_fd
, 
buf
.
	`d©a
(), buf.
	`size
());

1956 
	}
}

1959 
	gFlštTabË
::
	$ÿnûl
()

1961 
	`DEBUGCALL
(
DB
, , "FlintTable::cancel", "");

1962 
	`As£¹
(
wr™abË
);

1964 ià(
hªdË
 < 0) {

1965 ià(
hªdË
 == -2) {

1966 
FlštTabË
::
	`throw_d©aba£_şo£d
();

1968 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1974 
¡ršg
 
”r_msg
;

1975 ià(!
ba£
.
	`»ad
(
Çme
, 
ba£_Ë‰”
, 
”r_msg
)) {

1976 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
	`¡ršg
("Couldn'ˆ»»ad ba£ "è+ 
ba£_Ë‰”
);

1979 
»visiÚ_numb”
 = 
ba£
.
	`g‘_»visiÚ
();

1980 
block_size
 = 
ba£
.
	`g‘_block_size
();

1981 
roÙ
 = 
ba£
.
	`g‘_roÙ
();

1982 
Ëv–
 = 
ba£
.
	`g‘_Ëv–
();

1984 
™em_couÁ
 = 
ba£
.
	`g‘_™em_couÁ
();

1985 
çked_roÙ_block
 = 
ba£
.
	`g‘_have_çk”oÙ
();

1986 
£qu’tŸl
 = 
ba£
.
	`g‘_£qu’tŸl
();

1988 
Ï‹¡_»visiÚ_numb”
 = 
»visiÚ_numb”
;

1990 
j
 = 0; j <ğ
Ëv–
; j++) {

1991 
C
[
j
].
n
 = 
BLK_UNUSED
;

1992 
C
[
j
].
»wr™e
 = 
çl£
;

1994 
	`»ad_roÙ
();

1996 
chªged_n
 = 0;

1997 
chªged_c
 = 
DIR_START
;

1998 
£q_couÁ
 = 
SEQ_START_POINT
;

1999 
	}
}

2003 
boŞ


2004 
	gFlštTabË
::
	$do_İ’_to_»ad
(
boŞ
 
»visiÚ_suµl›d
, 
æšt_»visiÚ_numb”_t
 
»visiÚ_
)

2006 ià(
hªdË
 == -2) {

2007 
FlštTabË
::
	`throw_d©aba£_şo£d
();

2009 
hªdË
 = ::
	`İ’
((
Çme
 + "DB").
	`c_¡r
(), 
O_RDONLY
 | 
O_BINARY
);

2010 ià(
hªdË
 < 0) {

2011 ià(
Ïzy
) {

2013 
»visiÚ_numb”
 = 
»visiÚ_
;

2014  
Œue
;

2016 
¡ršg
 
	`mes§ge
("Couldn't open ");

2017 
mes§ge
 +ğ
Çme
;

2018 
mes§ge
 += "DBo„ead: ";

2019 
mes§ge
 +ğ
	`¡»¼Ü
(
”ºo
);

2020 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
mes§ge
);

2023 ià(!
	`basic_İ’
(
»visiÚ_suµl›d
, 
»visiÚ_
)) {

2024 ::
	`şo£
(
hªdË
);

2025 
hªdË
 = -1;

2026 ià(
»visiÚ_suµl›d
) {

2031  
çl£
;

2033 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Failedo openable for„eading");

2036 
j
 = 0; j <ğ
Ëv–
; j++) {

2037 
C
[
j
].
n
 = 
BLK_UNUSED
;

2038 
C
[
j
].
p
 = 
Ãw
 
by‹
[
block_size
];

2039 ià(
C
[
j
].
p
 == 0) {

2040 
throw
 
¡d
::
	`bad_®loc
();

2044 
	`»ad_roÙ
();

2045  
Œue
;

2046 
	}
}

2049 
	gFlštTabË
::
	$İ’
()

2051 
	`DEBUGCALL
(
DB
, , "FlintTable::open", "");

2052 
	`LOGLINE
(
DB
, "İ’šg‡ˆ·th " << 
Çme
);

2053 
	`şo£
();

2055 ià(!
wr™abË
) {

2057 ()
	`do_İ’_to_»ad
(
çl£
, 0);

2062 ()
	`do_İ’_to_wr™e
(
çl£
, 0);

2063 
	}
}

2065 
boŞ


2066 
	gFlštTabË
::
	$İ’
(
æšt_»visiÚ_numb”_t
 
»visiÚ
)

2068 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlštTabË::İ’", 
»visiÚ
);

2069 
	`LOGLINE
(
DB
, "İ’šg fÜ…¬ticuÏ¸»visiÚ‡ˆ·th " << 
Çme
);

2070 
	`şo£
();

2072 ià(!
wr™abË
) {

2073 ià(
	`do_İ’_to_»ad
(
Œue
, 
»visiÚ
)) {

2074 
	`As£¹Eq
(
»visiÚ_numb”
, 
»visiÚ
);

2075 
	`RETURN
(
Œue
);

2077 
	`şo£
();

2078 
	`RETURN
(
çl£
);

2082 ià(!
	`do_İ’_to_wr™e
(
Œue
, 
»visiÚ
)) {

2084 
	`şo£
();

2085 
	`RETURN
(
çl£
);

2088 
	`As£¹Eq
(
»visiÚ_numb”
, 
»visiÚ
);

2089 
	`RETURN
(
Œue
);

2090 
	}
}

2092 
boŞ


2093 
	gFlštTabË
::
	$´ev_fÜ_£qu’tŸl
(
CursÜ_
 * 
C_
, ) const

2095 
c
 = 
C_
[0].c;

2096 ià(
c
 =ğ
DIR_START
) {

2097 
by‹
 * 
p
 = 
C_
[0].p;

2098 
	`As£¹
(
p
);

2099 
ušt4
 
n
 = 
C_
[0].n;

2100 
Œue
) {

2101 ià(
n
 =ğ0è 
çl£
;

2102 
n
--;

2103 ià(
wr™abË
) {

2104 ià(
n
 =ğ
C
[0].n) {

2107 
	`memıy
(
p
, 
C
[0].p, 
block_size
);

2114 
j
;

2115 
j
 = 1; j <ğ
Ëv–
; ++j) {

2116 ià(
n
 =ğ
C
[
j
].n) ;

2118 ià(
j
 <ğ
Ëv–
) ;

2123 
	`»ad_block
(
n
, 
p
);

2126 
	`»ad_block
(
n
, 
p
);

2129 ià(
wr™abË
è
	`As£¹Eq
(
»visiÚ_numb”
, 
Ï‹¡_»visiÚ_numb”
);

2130 ià(
	`REVISION
(
p
è> 
»visiÚ_numb”
 + 
wr™abË
) {

2131 
	`£t_ov”wr™‹n
();

2132  
çl£
;

2134 ià(
	`GET_LEVEL
(
p
) == 0) ;

2136 
c
 = 
	`DIR_END
(
p
);

2137 
C_
[0].
n
 =‚;

2139 
c
 -ğ
D2
;

2140 
C_
[0].
c
 = c;

2141  
Œue
;

2142 
	}
}

2144 
boŞ


2145 
	gFlštTabË
::
	$Ãxt_fÜ_£qu’tŸl
(
CursÜ_
 * 
C_
, ) const

2147 
by‹
 * 
p
 = 
C_
[0].p;

2148 
	`As£¹
(
p
);

2149 
c
 = 
C_
[0].c;

2150 
c
 +ğ
D2
;

2151 
	`As£¹
(()
c
 < 
block_size
);

2152 ià(
c
 =ğ
	`DIR_END
(
p
)) {

2153 
ušt4
 
n
 = 
C_
[0].n;

2154 
Œue
) {

2155 
n
++;

2156 ià(
n
 > 
ba£
.
	`g‘_Ï¡_block
()è 
çl£
;

2157 ià(
wr™abË
) {

2158 ià(
n
 =ğ
C
[0].n) {

2161 
	`memıy
(
p
, 
C
[0].p, 
block_size
);

2168 
j
;

2169 
j
 = 1; j <ğ
Ëv–
; ++j) {

2170 ià(
n
 =ğ
C
[
j
].n) ;

2172 ià(
j
 <ğ
Ëv–
) ;

2177 
	`»ad_block
(
n
, 
p
);

2180 
	`»ad_block
(
n
, 
p
);

2182 ià(
wr™abË
è
	`As£¹Eq
(
»visiÚ_numb”
, 
Ï‹¡_»visiÚ_numb”
);

2183 ià(
	`REVISION
(
p
è> 
»visiÚ_numb”
 + 
wr™abË
) {

2184 
	`£t_ov”wr™‹n
();

2185  
çl£
;

2187 ià(
	`GET_LEVEL
(
p
) == 0) ;

2189 
c
 = 
DIR_START
;

2190 
C_
[0].
n
 =‚;

2192 
C_
[0].
c
 = c;

2193  
Œue
;

2194 
	}
}

2196 
boŞ


2197 
	gFlštTabË
::
	$´ev_deçuÉ
(
CursÜ_
 * 
C_
, 
j
) const

2199 
by‹
 * 
p
 = 
C_
[
j
].p;

2200 
c
 = 
C_
[
j
].c;

2201 
	`As£¹
(
c
 >ğ
DIR_START
);

2202 
	`As£¹
(()
c
 < 
block_size
);

2203 
	`As£¹
(
c
 <ğ
	`DIR_END
(
p
));

2204 ià(
c
 =ğ
DIR_START
) {

2205 ià(
j
 =ğ
Ëv–
è 
çl£
;

2206 ià(!
	`´ev_deçuÉ
(
C_
, 
j
 + 1)è 
çl£
;

2207 
c
 = 
	`DIR_END
(
p
);

2209 
c
 -ğ
D2
;

2210 
C_
[
j
].
c
 = c;

2211 ià(
j
 > 0) {

2212 
	`block_to_cursÜ
(
C_
, 
j
 - 1, 
	`I‹m_
(
p
, 
c
).
	`block_giv’_by
());

2214  
Œue
;

2215 
	}
}

2217 
boŞ


2218 
	gFlštTabË
::
	$Ãxt_deçuÉ
(
CursÜ_
 * 
C_
, 
j
) const

2220 
by‹
 * 
p
 = 
C_
[
j
].p;

2221 
c
 = 
C_
[
j
].c;

2222 
	`As£¹
(
c
 >ğ
DIR_START
);

2223 
c
 +ğ
D2
;

2224 
	`As£¹
(()
c
 < 
block_size
);

2226 ià(
c
 >ğ
	`DIR_END
(
p
)) {

2227 ià(
j
 =ğ
Ëv–
è 
çl£
;

2228 ià(!
	`Ãxt_deçuÉ
(
C_
, 
j
 + 1)è 
çl£
;

2229 
c
 = 
DIR_START
;

2231 
C_
[
j
].
c
 = c;

2232 ià(
j
 > 0) {

2233 
	`block_to_cursÜ
(
C_
, 
j
 - 1, 
	`I‹m_
(
p
, 
c
).
	`block_giv’_by
());

2234 #ifdeà
BTREE_DEBUG_FULL


2235 
	`´štf
("Block in FlintTable:next_default");

2236 
	`»pÜt_block_fuÎ
(
j
 - 1, 
C_
[j - 1].
n
, C_[j - 1].
p
);

2239  
Œue
;

2240 
	}
}

2243 
	gFlštTabË
::
	$throw_d©aba£_şo£d
()

2245 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

2246 
	}
}

2263 
boŞ
 
	gKey_
::
İ”©Ü
<(
Key_
 
key2
) const

2265 
DEBUGCALL
(
DB
, 
boŞ
, "Key_::İ”©Ü<", 
¡©ic_ÿ¡
<cÚ¡ *>(
key2
.
p
));

2266 
	gkey1_Ën
 = 
Ëngth
();

2267 
	gkey2_Ën
 = 
key2
.
Ëngth
();

2268 ià(
	gkey1_Ën
 =ğ
key2_Ën
) {

2272 
RETURN
(
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
key1_Ën
 + 
C2
) < 0);

2275 
	gk_sm®Ër
 = (
key2_Ën
 < 
key1_Ën
 ? key2_len : key1_len);

2278 
	gdiff
 = 
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
k_sm®Ër
);

2279 ià(
	gdiff
 !ğ0è
RETURN
(
diff
 < 0);

2283 
RETURN
(
key1_Ën
 < 
key2_Ën
);

2286 
boŞ
 
	gKey_
::
İ”©Ü
==(
Key_
 
key2
) const

2288 
DEBUGCALL
(
DB
, 
boŞ
, "Key_::İ”©Ü==", 
¡©ic_ÿ¡
<cÚ¡ *>(
key2
.
p
));

2289 
	gkey1_Ën
 = 
Ëngth
();

2290 ià(
	gkey1_Ën
 !ğ
key2
.
Ëngth
()è 
çl£
;

2294 
RETURN
(
memcmp
(
p
 + 
K1
, 
key2
.°+ K1, 
key1_Ën
 + 
C2
) == 0);

	@backends/flint/flint_table.h

23 #iâdeà
OM_HGUARD_FLINT_TABLE_H


24 
	#OM_HGUARD_FLINT_TABLE_H


	)

26 
	~<x­Ÿn/”rÜ.h
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~"æšt_ty³s.h
"

30 
	~"æšt_bŒ“ba£.h
"

31 
	~"æšt_cursÜ.h
"

33 
	~"nÜ‘uº.h
"

34 
	~"¡ršguts.h
"

35 
	~"uÇligÃd.h
"

36 
	~"uts.h
"

38 
	~<®gÜ™hm
>

39 
	~<¡ršg
>

41 
	~<zlib.h
>

43 
	#DONT_COMPRESS
 -1

	)

50 
	#FLINT_BTREE_MAX_KEY_LEN
 252

	)

53 
	#BYTES_PER_BLOCK_NUMBER
 4

	)

65 
	#K1
 1

	)

66 
	#I2
 2

	)

67 
	#D2
 2

	)

68 
	#C2
 2

	)

72 
	#g‘K
(
p
, 
c
è
	`g‘št1
Õ, c)

	)

73 
	#£tD
(
p
, 
c
, 
x
è
	`£tšt2
Õ, c, x)

	)

95 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mKey_
 {

96 cÚ¡ 
by‹
 *
	mp
;

97 
	mpublic
:

98 
ex¶ic™
 
	$Key_
(cÚ¡ 
by‹
 * 
p_
è: 
	$p
(
p_
) { }

99 cÚ¡ 
by‹
 * 
	$g‘_add»ss
(ècÚ¡ {  
p
; 
	}
}

100 
»ad
(
¡d
::
¡ršg
 * 
key
) const {

101 
key
->
assign
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 
K1
), 
Ëngth
());

103 
boŞ
 
	gİ”©Ü
==(
Key_
 
key2
) const;

104 
boŞ
 
	gİ”©Ü
!=(
Key_
 
key2
ècÚ¡ {  !(*
this
 == key2); }

105 
boŞ
 
	gİ”©Ü
<(
Key_
 
	gkey2
) const;

106 
boŞ
 
	gİ”©Ü
>=(
Key_
 
key2
ècÚ¡ {  !(*
this
 < key2); }

107 
boŞ
 
	gİ”©Ü
>(
Key_
 
	gkey2
ècÚ¡ {  key2 < *
	gthis
; }

108 
boŞ
 
	gİ”©Ü
<=(
Key_
 
key2
ècÚ¡ {  !(key2 < *
this
); }

109 
	$Ëngth
() const {

110  
	`g‘K
(
p
, 0è- 
C2
 - 
K1
;

111 
	}
}

112 
	gİ”©Ü
[](
size_t
 
	gi
) const {

113  
	gp
[
i
 + 
K1
];

119 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	cI‹m_ba£_
 {

120 
	m´Ùeùed
:

121 
T
 
p
;

122 
	mpublic
:

124 
	$I‹m_ba£_
(
T
 
p_
, 
c
è: 
	`p
Õ_ + 
	$g‘št2
(
p_
, 
c
)) { }

125 
	$I‹m_ba£_
(
T
 
p_
è: 
	$p
(
p_
è{ 
	}
}

126 
T
 
	$g‘_add»ss
(ècÚ¡ {  
p
; 
	}
}

127 
	$size
(ècÚ¡ {  
	`g‘št2
(
p
, 0è& 0x7fff; 
	}
}

128 
boŞ
 
	$g‘_com´es£d
(ècÚ¡ {  *
p
 & 0x80; 
	}
}

129 
	$compÚ’t_of
() const {

130  
	`g‘št2
(
p
, 
	`g‘K
Õ, 
I2
è+ I2 - 
C2
);

131 
	}
}

132 
	$compÚ’ts_of
() const {

133  
	`g‘št2
(
p
, 
	`g‘K
Õ, 
I2
) + I2);

134 
	}
}

135 
Key_
 
	$key
(ècÚ¡ {  
	`Key_
(
p
 + 
I2
); 
	}
}

136 
­³nd_chunk
(
¡d
::
¡ršg
 * 
g
) const {

138 
cd
 = 
g‘K
(
p
, 
I2
è+ 
	gI2
 + 
	gC2
;

139 
	gl
 = 
size
(è- 
cd
;

140 
	gg
->
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 
cd
), 
l
);

145 
ušt4
 
	$block_giv’_by
() const {

146  
	`g‘št4
(
p
, 
	`size
(è- 
BYTES_PER_BLOCK_NUMBER
);

147 
	}
}

150 
şass
 
	gI‹m_
 : 
public
 
I‹m_ba£_
<cÚ¡ 
by‹
 *> {

151 
public
:

153 
I‹m_
(cÚ¡ 
by‹
 * 
p_
, 
c
è: 
I‹m_ba£_
<cÚ¡ by‹ *>Õ_, 
	gc
) { }

154 
I‹m_
(cÚ¡ 
by‹
 * 
p_
è: 
I‹m_ba£_
<const byte *>(p_) { }

157 
şass
 
	gI‹m_wr_
 : 
public
 
I‹m_ba£_
<
by‹
 *> {

158 
£t_key_Ën
(
x
è{ 
£tšt1
(
p
, 
I2
, x); }

159 
	gpublic
:

161 
I‹m_wr_
(
by‹
 * 
p_
, 
c
è: 
I‹m_ba£_
<by‹ *>Õ_, 
	gc
) { }

162 
I‹m_wr_
(
by‹
 * 
p_
è: 
I‹m_ba£_
<byte *>(p_) { }

163 
£t_compÚ’t_of
(
i
) {

164 
£tšt2
(
p
, 
g‘K
Õ, 
I2
è+ I2 - 
C2
, 
i
);

166 
£t_compÚ’ts_of
(
m
) {

167 
£tšt2
(
p
, 
g‘K
Õ, 
I2
è+ I2, 
m
);

170 
£t_key_ªd_block
(
Key_
 
Ãwkey
, 
Œunÿ‹_size
, 
ušt4
 
n
) {

171 
	gi
 = 
Œunÿ‹_size
;

174 
	gÃwkey_Ën
 = 
Ãwkey
.
Ëngth
();

175 
	gÃwsize
 = 
I2
 + 
K1
 + 
i
 + 
C2
;

177 
£tšt2
(
p
, 0, 
Ãwsize
 + 4);

179 
£tšt1
(
p
, 
I2
, 
Ãwsize
 - I2);

181 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
, 
Ãwkey
.
g‘_add»ss
(è+ K1, 
i
);

183 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
 + 
i
, 
Ãwkey
.
g‘_add»ss
(è+ K1 + 
Ãwkey_Ën
, 
C2
);

186 
£tšt4
(
p
, 
Ãwsize
, 
n
);

192 
£t_block_giv’_by
(
ušt4
 
n
) {

193 
£tšt4
(
p
, 
size
(è- 
BYTES_PER_BLOCK_NUMBER
, 
n
);

195 
£t_size
(
l
è{ 
£tšt2
(
p
, 0,†); }

198 
fÜm_nuÎ_key
(
ušt4
 
n
) {

199 
£tšt4
(
p
, 
I2
 + 
K1
, 
n
);

200 
£t_key_Ën
(
K1
);

201 
£t_size
(
I2
 + 
K1
 + 4);

203 
fÜm_key
(cÚ¡ 
¡d
::
¡ršg
 & 
key_
) {

204 
¡d
::
¡ršg
::
size_ty³
 
key_Ën
 = 
key_
.
Ëngth
();

205 ià(
	gkey_Ën
 > 
	gFLINT_BTREE_MAX_KEY_LEN
) {

209 
	g¡d
::
¡ršg
 
msg
("Keyoo†ong:†ength was ");

210 
	gmsg
 +ğ
om_to¡ršg
(
key_Ën
);

211 
	gmsg
 += " bytes, maximum†ength of‡ key is "

212 
STRINGIZE
(
FLINT_BTREE_MAX_KEY_LEN
) " bytes";

213 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
(
msg
);

216 
£t_key_Ën
(
key_Ën
 + 
K1
 + 
C2
);

217 
	g¡d
::
memmove
(
p
 + 
I2
 + 
K1
, 
key_
.
d©a
(), 
key_Ën
);

218 
£t_compÚ’t_of
(1);

221 
£t_g
(
cd
, cÚ¡ *
¡¬t
, 
Ën
, 
boŞ
 
com´es£d
) {

222 
	g¡d
::
memmove
(
p
 + 
cd
, 
¡¬t
, 
Ën
);

223 
£t_size
(
cd
 + 
Ën
);

224 ià(
	gcom´es£d
è*
	gp
 |= 0x80;

226 
çke_roÙ_™em
() {

227 
£t_key_Ën
(
K1
 + 
C2
);

228 
£t_size
(
I2
 + 
K1
 + 2 * 
C2
);

229 
£t_compÚ’t_of
(1);

230 
£t_compÚ’ts_of
(1);

237 
	#BTREE_CURSOR_LEVELS
 10

	)

259 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mFlštTabË
 {

260 
ä›nd
 
şass
 
	mFlštCursÜ
;

261 
	m´iv©e
:

263 
FlštTabË
(const FlintTable &);

266 
	mFlštTabË
 & 
	mİ”©Ü
=(cÚ¡ 
FlštTabË
 &);

269 
boŞ
 
	$»®ly_em±y
() const;

271 
public
:

288 
	`FlštTabË
(cÚ¡ * 
bËÇme_
, cÚ¡ 
¡d
::
¡ršg
 & 
·th_
,

289 
boŞ
 
»adÚly_
, 
com´ess_¡¿‹gy_
 = 
DONT_COMPRESS
,

290 
boŞ
 
Ïzy
 = 
çl£
);

297 ~
	`FlštTabË
();

304 
	`şo£
(
boŞ
 
³rmª’t
=
çl£
);

308 
boŞ
 
	$exi¡s
() const;

318 
	`İ’
();

337 
boŞ
 
	`İ’
(
æšt_»visiÚ_numb”_t
 
»visiÚ_
);

344 
	`æush_db
();

362 
	`comm™
(
æšt_»visiÚ_numb”_t
 
»visiÚ
, 
chªges_fd
 = -1,

363 cÚ¡ 
¡d
::
¡ršg
 * 
chªges_
 = 
NULL
);

369 
	`wr™e_chªged_blocks
(
chªges_fd
);

376 
	`ÿnûl
();

392 
boŞ
 
	`g‘_exaù_’Œy
(cÚ¡ 
¡d
::
¡ršg
 & 
key
, std::¡ršg & 
g
) const;

405 
boŞ
 
	`key_exi¡s
(cÚ¡ 
¡d
::
¡ršg
 &
key
) const;

415 
boŞ
 
	`»ad_g
(
CursÜ_
 * 
C_
, 
¡d
::
¡ršg
 *
g
, boŞ 
k“p_com´es£d
) const;

433 
	`add
(cÚ¡ 
¡d
::
¡ršg
 &
key
, std::¡ršg 
g
, 
boŞ
 
®»ady_com´es£d
 = 
çl£
);

450 
boŞ
 
	`d–
(cÚ¡ 
¡d
::
¡ršg
 &
key
);

453 
	`”a£
();

459 
	`£t_block_size
(
block_size_
);

463 
	$g‘_block_size
(ècÚ¡ {  
block_size
; }

488 
	`ü—‹_ªd_İ’
(
blocksize
);

490 
	`£t_fuÎ_com·ùiÚ
(
boŞ
 
·r™y
);

502 
æšt_»visiÚ_numb”_t
 
	$g‘_Ï‹¡_»visiÚ_numb”
() const {

503  
Ï‹¡_»visiÚ_numb”
;

504 
	}
}

514 
æšt_»visiÚ_numb”_t
 
	$g‘_İ’_»visiÚ_numb”
() const {

515  
»visiÚ_numb”
;

516 
	}
}

527 
æšt_bËsize_t
 
	$g‘_’Œy_couÁ
() const {

528  
™em_couÁ
;

529 
	}
}

532 
boŞ
 
	$em±y
() const {

542  (
Ëv–
 =ğ0è&& 
	`»®ly_em±y
();

543 
	}
}

550 
FlštCursÜ
 * 
	$cursÜ_g‘
() const;

557 
boŞ
 
	$is_modif›d
(ècÚ¡ {  
BŒ“_modif›d
; 
	}
}

564 
	$£t_max_™em_size
(
size_t
 
block_ÿ·c™y
) {

565 ià(
block_ÿ·c™y
 > 4) block_capacity = 4;

566 
max_™em_size
 = (
block_size
 - 11 - 
block_ÿ·c™y
 * 
D2
)

567 / 
block_ÿ·c™y
;

568 
	}
}

570 
	g´Ùeùed
:

576 
boŞ
 
do_İ’_to_»ad
(boŞ 
»visiÚ_suµl›d
, 
æšt_»visiÚ_numb”_t
 
»visiÚ_
);

582 
boŞ
 
do_İ’_to_wr™e
(boŞ 
»visiÚ_suµl›d
,

583 
æšt_»visiÚ_numb”_t
 
»visiÚ_
,

584 
boŞ
 
ü—‹_db
 = 
çl£
);

585 
boŞ
 
basic_İ’
(boŞ 
»visiÚ_suµl›d
, 
æšt_»visiÚ_numb”_t
 
»visiÚ
);

587 
boŞ
 
	$fšd
(
CursÜ_
 *) const;

588 
	`d–‘e_kt
();

589 
	$»ad_block
(
ušt4
 
n
, 
by‹
 *
p
) const;

590 
	$wr™e_block
(
ušt4
 
n
, cÚ¡ 
by‹
 *
p
) const;

591 
	`XAPIAN_NORETURN
(
	$£t_ov”wr™‹n
() const);

592 
	$block_to_cursÜ
(
CursÜ_
 *
C_
, 
j
, 
ušt4
 
n
) const;

593 
	`®‹r
();

594 
	`com·ù
(
by‹
 *
p
);

595 
	`’‹r_key
(
j
, 
Key_
 
´evkey
, Key_ 
Ãwkey
);

596 
	`mid_pošt
(
by‹
 *
p
);

597 
	`add_™em_to_block
(
by‹
 *
p
, 
I‹m_wr_
 
kt
, 
c
);

598 
	`add_™em
(
I‹m_wr_
 
kt
, 
j
);

599 
	`d–‘e_™em
(
j
, 
boŞ
 
»³©edly
);

600 
	`add_kt
(
boŞ
 
found
);

601 
	`»ad_roÙ
();

602 
	`¥l™_roÙ
(
ušt4
 
¥l™_n
);

603 
	`fÜm_key
(cÚ¡ 
¡d
::
¡ršg
 & 
key
) const;

606 cÚ¡ * 
bËÇme
;

608 
	$Ùh”_ba£_Ë‰”
() const {

609  (
ba£_Ë‰”
 == 'A') ? 'B' : 'A';

610 
	}
}

613 
	$Ïzy_®loc_deæ©e_z¡»am
() const;

616 
	$Ïzy_®loc_šæ©e_z¡»am
() const;

619 
æšt_»visiÚ_numb”_t
 
»visiÚ_numb”
;

622 
ušt4
 
™em_couÁ
;

625 
block_size
;

630 
mubË
 
æšt_»visiÚ_numb”_t
 
Ï‹¡_»visiÚ_numb”
;

636 
mubË
 
boŞ
 
bÙh_ba£s
;

639 
ba£_Ë‰”
;

645 
boŞ
 
çked_roÙ_block
;

650 
boŞ
 
£qu’tŸl
;

653 
hªdË
;

656 
Ëv–
;

659 
ušt4
 
roÙ
;

662 
mubË
 
I‹m_wr_
 
kt
;

665 
by‹
 * 
bufãr
;

668 
FlštTabË_ba£
 
ba£
;

671 
¡d
::
¡ršg
 
Çme
;

676 
£q_couÁ
;

679 
ušt4
 
chªged_n
;

683 
chªged_c
;

686 
size_t
 
max_™em_size
;

689 
mubË
 
boŞ
 
BŒ“_modif›d
;

692 
boŞ
 
fuÎ_com·ùiÚ
;

695 
boŞ
 
wr™abË
;

698 
boŞ
 
	$´ev
(
CursÜ_
 *
C_
, 
j
) const {

699 ià(
£qu’tŸl
è 
	`´ev_fÜ_£qu’tŸl
(
C_
, 
j
);

700  
	`´ev_deçuÉ
(
C_
, 
j
);

701 
	}
}

703 
boŞ
 
	$Ãxt
(
CursÜ_
 *
C_
, 
j
) const {

704 ià(
£qu’tŸl
è 
	`Ãxt_fÜ_£qu’tŸl
(
C_
, 
j
);

705  
	`Ãxt_deçuÉ
(
C_
, 
j
);

706 
	}
}

709 
boŞ
 
	$´ev_deçuÉ
(
CursÜ_
 *
C_
, 
j
) const;

710 
boŞ
 
	$Ãxt_deçuÉ
(
CursÜ_
 *
C_
, 
j
) const;

713 
boŞ
 
	$´ev_fÜ_£qu’tŸl
(
CursÜ_
 *
C_
, 
dummy
) const;

714 
boŞ
 
	$Ãxt_fÜ_£qu’tŸl
(
CursÜ_
 *
C_
, 
dummy
) const;

716 
	`fšd_š_block
(cÚ¡ 
by‹
 * 
p
, 
Key_
 
key
, 
boŞ
 
Ëaf
, 
c
);

721 
ušt4
 
	`block_giv’_by
(cÚ¡ 
by‹
 * 
p
, 
c
);

723 
mubË
 
CursÜ_
 
C
[
BTREE_CURSOR_LEVELS
];

730 
by‹
 * 
¥l™_p
;

734 
com´ess_¡¿‹gy
;

737 
mubË
 
z_¡»am
 *
deæ©e_z¡»am
;

740 
mubË
 
z_¡»am
 *
šæ©e_z¡»am
;

743 
boŞ
 
Ïzy
;

749 
	`XAPIAN_NORETURN
(
	`throw_d©aba£_şo£d
());

750 
	}
};

	@backends/flint/flint_termlist.cc

23 
	~<cÚfig.h
>

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"ex·ndweight.h
"

28 
	~"æšt_pos™iÚli¡.h
"

29 
	~"æšt_‹rmli¡.h
"

30 
	~"æšt_uts.h
"

31 
	~"omas£¹.h
"

32 
	~"uts.h
"

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	gFlštT”mLi¡
::
FlštT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
db_
,

37 
X­Ÿn
::
docid
 
did_
)

38 : 
db
(
db_
), 
did
(
did_
), 
cu¼’t_wdf
(0), 
	$cu¼’t_‹rmäeq
(0)

40 
	`DEBUGCALL
(
DB
, , "FlintTermList",

41 "[RefCÁPŒ<cÚ¡ FlštD©aba£>], " << 
did_
);

43 ià(!
db
->
‹rmli¡_bË
.
	`g‘_exaù_’Œy
(
	`æšt_docid_to_key
(
did
), 
d©a
))

44 
throw
 
X­Ÿn
::
	`DocNÙFoundE¼Ü
("NØ‹rmli¡ fÜ docum’ˆ" + 
	`om_to¡ršg
(
did
));

46 
pos
 = 
d©a
.
	`d©a
();

47 
’d
 = 
pos
 + 
d©a
.
	`size
();

49 ià(
pos
 =ğ
’d
) {

50 
doş’
 = 0;

51 
‹rmli¡_size
 = 0;

56 ià(!
	`F_uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

57 cÚ¡ *
msg
;

58 ià(
pos
 == 0) {

59 
msg
 = "Too†ittle data for doclen inermlist";

61 
msg
 = "Overflowed value for doclen inermlist";

63 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

67 ià(!
	`F_uÅack_ušt
(&
pos
, 
’d
, &
‹rmli¡_size
)) {

68 cÚ¡ *
msg
;

69 ià(
pos
 == 0) {

70 
msg
 = "Too†ittle data for†ist size inermlist";

72 
msg
 = "Overflowed value for†ist size inermlist";

74 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

79 ià(
pos
 !ğ
’d
 && *pos == '0') ++pos;

80 
	}
}

82 
æšt_doş’_t


83 
	gFlštT”mLi¡
::
	$g‘_doş’gth
() const

85 
	`DEBUGCALL
(
DB
, 
æšt_doş’_t
, "FlintTermList::get_doclength", "");

86 
	`RETURN
(
doş’
);

87 
	}
}

89 
	gX­Ÿn
::
‹rmcouÁ


90 
FlštT”mLi¡
::
	$g‘_­´ox_size
() const

92 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintTermList::get_approx_size", "");

93 
	`RETURN
(
‹rmli¡_size
);

94 
	}
}

97 
	gFlštT”mLi¡
::
accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const

99 
DEBUGCALL
(
DB
, , "FlintTermList::accumulate_stats", "[stats&]");

100 
As£¹
(!
©_’d
());

101 
	g¡©s
.
accumuÏ‹
(
cu¼’t_wdf
, 
doş’
, 
g‘_‹rmäeq
(), 
db
->
g‘_doccouÁ
());

104 
¡ršg


105 
	gFlštT”mLi¡
::
	$g‘_‹rmÇme
() const

107 
	`DEBUGCALL
(
DB
, 
¡ršg
, "FlintTermList::get_termname", "");

108 
	`RETURN
(
cu¼’t_‹rm
);

109 
	}
}

111 
	gX­Ÿn
::
‹rmcouÁ


112 
FlštT”mLi¡
::
	$g‘_wdf
() const

114 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintTermList::get_wdf", "");

115 
	`RETURN
(
cu¼’t_wdf
);

116 
	}
}

118 
	gX­Ÿn
::
doccouÁ


119 
FlštT”mLi¡
::
	$g‘_‹rmäeq
() const

121 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
doccouÁ
, "FlintTermList::get_termfreq", "");

122 ià(
cu¼’t_‹rmäeq
 == 0)

123 
cu¼’t_‹rmäeq
 = 
db
->
	`g‘_‹rmäeq
(
cu¼’t_‹rm
);

124 
	`RETURN
(
cu¼’t_‹rmäeq
);

125 
	}
}

127 
T”mLi¡
 *

128 
	gFlštT”mLi¡
::
	$Ãxt
()

130 
	`DEBUGCALL
(
DB
, 
T”mLi¡
 *, "FlintTermList::next", "");

131 
	`As£¹
(!
	`©_’d
());

132 ià(
pos
 =ğ
’d
) {

133 
pos
 = 
NULL
;

134 
	`RETURN
(
NULL
);

138 
cu¼’t_‹rmäeq
 = 0;

140 
boŞ
 
wdf_š_»u£
 = 
çl£
;

141 ià(!
cu¼’t_‹rm
.
	`em±y
()) {

143 
size_t
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

144 ià(
Ën
 > 
cu¼’t_‹rm
.
	`size
()) {

146 
wdf_š_»u£
 = 
Œue
;

147 
size_t
 
divisÜ
 = 
cu¼’t_‹rm
.
	`size
() + 1;

148 
cu¼’t_wdf
 = 
Ën
 / 
divisÜ
 - 1;

149 
Ën
 %ğ
divisÜ
;

151 
cu¼’t_‹rm
.
	`»size
(
Ën
);

155 
size_t
 
­³nd_Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

156 
cu¼’t_‹rm
.
	`­³nd
(
pos
, 
­³nd_Ën
);

157 
pos
 +ğ
­³nd_Ën
;

160 ià(!
wdf_š_»u£
 && !
	`F_uÅack_ušt
(&
pos
, 
’d
, &
cu¼’t_wdf
)) {

161 cÚ¡ *
msg
;

162 ià(
pos
 == 0) {

163 
msg
 = "Too†ittle data for wdf inermlist";

165 
msg
 = "Overflowed value for wdf inermlist";

167 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

170 
	`RETURN
(
NULL
);

171 
	}
}

173 
boŞ


174 
	gFlštT”mLi¡
::
	$©_’d
() const

176 
	`DEBUGCALL
(
DB
, 
boŞ
, "FlintTermList::at_end", "");

177 
	`RETURN
(
pos
 =ğ
NULL
);

178 
	}
}

180 
	gX­Ÿn
::
‹rmcouÁ


181 
FlštT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

183 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "FlintTermList::positionlist_count", "");

184 
	`RETURN
(
db
->
pos™iÚ_bË
.
	`pos™iÚli¡_couÁ
(
did
, 
cu¼’t_‹rm
));

185 
	}
}

187 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


188 
FlštT”mLi¡
::
	$pos™iÚli¡_begš
() const

190 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
Pos™iÚI‹¿tÜ
, "FlintTermList::positionlist_begin", "");

191  
X­Ÿn
::
	`Pos™iÚI‹¿tÜ
(

192 
Ãw
 
	`FlštPos™iÚLi¡
(&
db
->
pos™iÚ_bË
, 
did
, 
cu¼’t_‹rm
));

193 
	}
}

	@backends/flint/flint_termlist.h

21 #iâdeà
XAPIAN_INCLUDED_FLINT_TERMLIST_H


22 
	#XAPIAN_INCLUDED_FLINT_TERMLIST_H


	)

24 
	~<¡ršg
>

26 
	~<x­Ÿn/ba£.h
>

27 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

28 
	~<x­Ÿn/ty³s.h
>

30 
Çme¥aû
 
	gX­Ÿn
 {

31 
Çme¥aû
 
	gIÁ”Çl
 {

32 
şass
 
	gEx·ndSts
;

36 
	~"æšt_d©aba£.h
"

37 
	~"‹rmli¡.h
"

38 
	~"æšt_bË.h
"

41 şas 
	cFlštT”mLi¡
 : 
public
 
T”mLi¡
 {

43 
İ”©Ü
=(cÚ¡ 
FlštT”mLi¡
 &);

46 
FlštT”mLi¡
(const FlintTermList &);

49 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
db
;

52 
	mX­Ÿn
::
docid
 
did
;

55 
æšt_doş’_t
 
	mdoş’
;

58 
	mX­Ÿn
::
‹rmcouÁ
 
‹rmli¡_size
;

61 
	m¡d
::
¡ršg
 
d©a
;

67 cÚ¡ *
	mpos
;

70 cÚ¡ *
	m’d
;

73 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

76 
	mX­Ÿn
::
‹rmcouÁ
 
cu¼’t_wdf
;

83 
mubË
 
	mX­Ÿn
::
doccouÁ
 
cu¼’t_‹rmäeq
;

85 
	mpublic
:

87 
FlštT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
FlštD©aba£
> 
db_
,

88 
X­Ÿn
::
docid
 
did_
);

94 
æšt_doş’_t
 
	$g‘_doş’gth
() const;

100 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

103 
	`accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const;

106 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

109 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

118 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

128 
T”mLi¡
 * 
	`Ãxt
();

131 
boŞ
 
	$©_’d
() const;

134 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

137 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

	@backends/flint/flint_termlisttable.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/docum’t.h
>

24 
	~<x­Ÿn/”rÜ.h
>

25 
	~<x­Ÿn/‹rm™”©Ü.h
>

27 
	~"æšt_‹rmli¡bË.h
"

28 
	~"æšt_uts.h
"

29 
	~"omas£¹.h
"

30 
	~"omdebug.h
"

31 
	~"¡ršguts.h
"

32 
	~"uts.h
"

34 
	~<¡ršg
>

36 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	gFlštT”mLi¡TabË
::
£t_‹rmli¡
(
X­Ÿn
::
docid
 
did
,

40 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
,

41 
æšt_doş’_t
 
doş’
)

43 
DEBUGCALL
(
DB
, , "FlintTermListTable::set_termlist",

44 
did
 << ", " << 
doc
 << ", " << 
doş’
);

46 
	gX­Ÿn
::
doccouÁ
 
‹rmli¡_size
 = 
doc
.
‹rmli¡_couÁ
();

47 ià(
	g‹rmli¡_size
 == 0) {

49 
As£¹
(
doş’
 == 0);

50 
As£¹
(
doc
.
‹rmli¡_begš
(è=ğdoc.
‹rmli¡_’d
());

51 
add
(
æšt_docid_to_key
(
did
), 
¡ršg
());

55 
¡ršg
 
	gg
 = 
F_·ck_ušt
(
doş’
);

57 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
doc
.
‹rmli¡_begš
();

58 ià(
	gt
 !ğ
doc
.
‹rmli¡_’d
()) {

59 
g
 +ğ
F_·ck_ušt
(
‹rmli¡_size
);

60 
¡ršg
 
	g´ev_‹rm
 = *
t
;

70 ià(
	g´ev_‹rm
.
size
(è=ğ'0'è
g
 += '0';

72 
	gg
 +ğ(
´ev_‹rm
.
size
());

73 
	gg
 +ğ
´ev_‹rm
;

74 
	gg
 +ğ
F_·ck_ušt
(
t
.
g‘_wdf
());

75 --
	g‹rmli¡_size
;

77 ++
	gt
 !ğ
doc
.
‹rmli¡_’d
()) {

78 cÚ¡ 
¡ršg
 & 
‹rm
 = *
t
;

82 
size_t
 
	g»u£
 = 
commÚ_´efix_Ëngth
(
´ev_‹rm
, 
‹rm
);

91 
size_t
 
	g·cked
 = 0;

92 
	gX­Ÿn
::
‹rmcouÁ
 
wdf
 = 
t
.
g‘_wdf
();

96 ià(
	gwdf
 < 127)

97 
	g·cked
 = (
wdf
 + 1è* (
´ev_‹rm
.
size
(è+ 1è+ 
»u£
;

99 ià(
	g·cked
 &&…acked < 256) {

101 
	gg
 +ğ(
·cked
);

102 
	gg
 +ğ(
‹rm
.
size
(è- 
»u£
);

103 
	gg
.
­³nd
(
‹rm
.
d©a
(è+ 
»u£
,”m.
size
() -„euse);

105 
	gg
 +ğ(
»u£
);

106 
	gg
 +ğ(
‹rm
.
size
(è- 
»u£
);

107 
	gg
.
­³nd
(
‹rm
.
d©a
(è+ 
»u£
,”m.
size
() -„euse);

110 
	gg
 +ğ
F_·ck_ušt
(
wdf
);

113 
	g´ev_‹rm
 = *
t
;

114 --
	g‹rmli¡_size
;

117 
As£¹
(
‹rmli¡_size
 == 0);

118 
add
(
æšt_docid_to_key
(
did
), 
g
);

121 
æšt_doş’_t


122 
	gFlštT”mLi¡TabË
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

124 
DEBUGCALL
(
DB
, 
æšt_doş’_t
, "FlštT”mLi¡TabË::g‘_doş’gth", 
did
);

126 
¡ršg
 
	gg
;

127 ià(!
g‘_exaù_’Œy
(
æšt_docid_to_key
(
did
), 
g
))

128 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
("Noermlist found for document " +

129 
om_to¡ršg
(
did
));

131 ià(
	gg
.
em±y
()è
RETURN
(0);

133 cÚ¡ * 
	gpos
 = 
g
.
d©a
();

134 cÚ¡ * 
	g’d
 = 
pos
 + 
g
.
size
();

136 
æšt_doş’_t
 
	gdoş’
;

137 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

138 cÚ¡ *
	gmsg
;

139 ià(
	gpos
 == 0) {

140 
msg
 = "Too†ittle data for doclen inermlist";

142 
	gmsg
 = "Overflowed value for doclen inermlist";

144 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
(
msg
);

147 
RETURN
(
doş’
);

	@backends/flint/flint_termlisttable.h

21 #iâdeà
XAPIAN_INCLUDED_FLINT_TERMLISTTABLE_H


22 
	#XAPIAN_INCLUDED_FLINT_TERMLISTTABLE_H


	)

24 
	~<x­Ÿn/ty³s.h
>

26 
	~"æšt_bË.h
"

27 
	~"æšt_uts.h
"

29 
	~<¡ršg
>

31 
Çme¥aû
 
	gX­Ÿn
 {

32 
şass
 
	gDocum’t
;

35 şas 
	cFlštT”mLi¡TabË
 : 
public
 
FlštTabË
 {

36 
public
:

45 
FlštT”mLi¡TabË
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
, 
boŞ
 
»adÚly
)

46 : 
FlštTabË
("‹rmli¡", 
dbdœ
 + "/‹rmli¡.", 
»adÚly
, 
Z_DEFAULT_STRATEGY
) { }

56 
£t_‹rmli¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
doc
,

57 
æšt_doş’_t
 
doş’
);

63 
d–‘e_‹rmli¡
(
X­Ÿn
::
docid
 
did
è{ 
d–
(
æšt_docid_to_key
(did)); }

66 
æšt_doş’_t
 
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const;

	@backends/flint/flint_types.h

22 #iâdeà
OM_HGUARD_FLINT_TYPES_H


23 
	#OM_HGUARD_FLINT_TYPES_H


	)

25 
	~"š‹º®ty³s.h
"

27 
	tæšt_blocksize_t
;

39 
	tæšt_»visiÚ_numb”_t
;

45 
	tæšt_bËsize_t
;

50 
	tæšt_doş’_t
;

56 
	#FLINT_DEFAULT_BLOCK_SIZE
 8192

	)

	@backends/flint/flint_utils.h

23 #iâdeà
OM_HGUARD_FLINT_UTILS_H


24 
	#OM_HGUARD_FLINT_UTILS_H


	)

26 
	~"omas£¹.h
"

28 
	~<x­Ÿn/ty³s.h
>

30 
	~<¡ršg
>

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	tom_by‹
;

35 
	tom_ušt32
;

36 
	tom_št32
;

62 
	g‹m¶©e
<
şass
 
	gT
>

63 
boŞ


64 
	$F_uÅack_ušt
(cÚ¡ ** 
¤c
,

65 cÚ¡ * 
¤c_’d
,

66 
T
 * 
»suÉ±r
)

69 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
T
);

72 
	`STATIC_ASSERT
((
om_by‹
) == 1);

74 
shiá
 = 0;

75 
T
 
»suÉ
 = 0;

77 
Œue
) {

78 ià((*
¤c
è=ğ
¤c_’d
) {

79 *
¤c
 = 0;

80  
çl£
;

83 
om_by‹
 
·¹
 = 
¡©ic_ÿ¡
<om_by‹>(**
¤c
);

84 (*
¤c
)++;

87 ià(((
shiá
 > ((
T
) - 1) * 8 + 1) &&

88 ((
·¹
 & 0x7fè<< (
shiá
 % 8)) >= 0x100) ||

89 (
shiá
 >ğ(
T
) * 8)) {

91 
Œue
) {

92 ià((
·¹
 & 0x80è=ğ0è 
çl£
;

93 ià((*
¤c
è=ğ
¤c_’d
) {

94 *
¤c
 = 0;

95  
çl£
;

97 
·¹
 = 
¡©ic_ÿ¡
<
om_by‹
>(**
¤c
);

98 (*
¤c
)++;

102 
»suÉ
 +ğ
	`T
(
·¹
 & 0x7fè<< 
shiá
;

103 
shiá
 += 7;

105 ià((
·¹
 & 0x80) == 0) {

106 ià(
»suÉ±r
è*»suÉ±¸ğ
»suÉ
;

107  
Œue
;

110 
	}
}

119 
	g‹m¶©e
<
şass
 
	gT
>

120 
¡ršg


121 
	$F_·ck_ušt
(
T
 
v®ue
)

124 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
T
);

126 ià(
v®ue
 =ğ0è 
	`¡ršg
(1, '\0');

127 
¡ršg
 
»suÉ
;

129 
v®ue
 != 0) {

130 
om_by‹
 
·¹
 = 
¡©ic_ÿ¡
<om_by‹>(
v®ue
 & 0x7f);

131 
v®ue
 = value >> 7;

132 ià(
v®ue
è
·¹
 |= 0x80;

133 
»suÉ
.
	`­³nd
(1u, (
·¹
));

136  
»suÉ
;

137 
	}
}

147 
	g‹m¶©e
<>

148 
šlše
 
¡ršg


149 
	gF_·ck_ušt
<
	gboŞ
>(
boŞ
 
	gv®ue
)

151  
¡ršg
(1, 
¡©ic_ÿ¡
<>(
v®ue
));

171 
	g‹m¶©e
<
şass
 
	gT
>

172 
boŞ


173 
	$F_uÅack_ušt_Ï¡
(cÚ¡ ** 
¤c
, cÚ¡ * 
¤c_’d
, 
T
 * 
»suÉ±r
)

176 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
T
);

178 
	`STATIC_ASSERT
((
om_by‹
) == 1);

180 ià(
¤c_’d
 - *
¤c
 > ((
T
))) {

182 *
¤c
 = 
¤c_’d
;

183  
çl£
;

186 
T
 
»suÉ
 = 0;

187 
shiá
 = 0;

188 *
¤c
 !ğ
¤c_’d
) {

189 
»suÉ
 |ğ
¡©ic_ÿ¡
<
T
>(¡©ic_ÿ¡<
om_by‹
>(**
¤c
)è<< 
shiá
;

190 ++(*
¤c
);

191 
shiá
 += 8;

193 *
»suÉ±r
 = 
»suÉ
;

194  
Œue
;

195 
	}
}

206 
	g‹m¶©e
<
şass
 
	gT
>

207 
¡ršg


208 
	$F_·ck_ušt_Ï¡
(
T
 
v®ue
)

211 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
T
);

213 
¡ršg
 
»suÉ
;

214 
v®ue
) {

215 
»suÉ
 +ğ(
v®ue
);

216 
v®ue
 >>= 8;

218  
»suÉ
;

219 
	}
}

231 
	g‹m¶©e
<
şass
 
	gT
>

232 
¡ršg


233 
	$F_·ck_ušt_´e£rvšg_sÜt
(
T
 
v®ue
)

236 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
T
);

238 
¡ršg
 
»suÉ
;

239 
v®ue
 != 0) {

240 
om_by‹
 
·¹
 = 
¡©ic_ÿ¡
<om_by‹>(
v®ue
 & 0xff);

241 
v®ue
 = value >> 8;

242 
»suÉ
.
	`š£¹
(
¡ršg
::
	`size_ty³
(0), 1u, (
·¹
));

244 
»suÉ
.
	`š£¹
(
¡ršg
::
	`size_ty³
(0), 1u, ÔesuÉ.
	`size
()));

245  
»suÉ
;

246 
	}
}

267 
	g‹m¶©e
<
şass
 
	gT
>

268 
boŞ


269 
	$F_uÅack_ušt_´e£rvšg_sÜt
(cÚ¡ ** 
¤c
,

270 cÚ¡ * 
¤c_’d
,

271 
T
 * 
»suÉ±r
)

273 ià(*
¤c
 =ğ
¤c_’d
) {

274 *
¤c
 = 0;

275  
çl£
;

278 
Ëngth
 = 
¡©ic_ÿ¡
<
om_by‹
>(**
¤c
);

279 (*
¤c
)++;

281 ià(
Ëngth
 > (
T
)) {

282 *
¤c
 +ğ
Ëngth
;

283 ià(*
¤c
 > 
¤c_’d
) {

284 *
¤c
 = 0;

286  
çl£
;

290 
T
 
»suÉ
 = 0;

291 
Ëngth
 > 0) {

292 
»suÉ
 =„esult << 8;

293 
»suÉ
 +ğ
¡©ic_ÿ¡
<
om_by‹
>(**
¤c
);

294 (*
¤c
)++;

295 
Ëngth
--;

297 *
»suÉ±r
 = 
»suÉ
;

299  
Œue
;

300 
	}
}

302 
šlše
 
boŞ


303 
	$F_uÅack_¡ršg
(cÚ¡ ** 
¤c
,

304 cÚ¡ * 
¤c_’d
,

305 
¡ršg
 & 
»suÉ
)

307 
¡ršg
::
size_ty³
 
Ëngth
;

308 ià(!
	`F_uÅack_ušt
(
¤c
, 
¤c_’d
, &
Ëngth
)) {

309  
çl£
;

312 ià(
¤c_’d
 - *
¤c
 < 0 ||

313 
¡ršg
::
	`size_ty³
(
¤c_’d
 - *
¤c
è< 
Ëngth
) {

314 
¤c
 = 0;

315  
çl£
;

318 
»suÉ
.
	`assign
(*
¤c
, 
Ëngth
);

319 *
¤c
 +ğ
Ëngth
;

320  
Œue
;

321 
	}
}

323 
šlše
 
¡ršg


324 
	$F_·ck_¡ršg
(cÚ¡ 
¡ršg
 & 
v®ue
)

326  
	`F_·ck_ušt
(
v®ue
.
	`size
()) + value;

327 
	}
}

334 
šlše
 
¡ršg


335 
	$F_·ck_¡ršg_´e£rvšg_sÜt
(
¡ršg
 
v®ue
)

337 
¡ršg
::
size_ty³
 
i
 = 0, 
j
;

338 (
j
 = 
v®ue
.
	`fšd
('\0', 
i
)è!ğ
¡ršg
::
Åos
) {

339 
v®ue
.
	`»¶aû
(
j
, 1, "\0\xff", 2);

340 
i
 = 
j
 + 2;

342 
v®ue
 += '\0';

343  
v®ue
 + '\0';

344 
	}
}

346 
šlše
 
boŞ


347 
	$F_uÅack_¡ršg_´e£rvšg_sÜt
(cÚ¡ ** 
¤c
,

348 cÚ¡ * 
¤c_’d
,

349 
¡ršg
 & 
»suÉ
)

351 
»suÉ
.
	`»size
(0);

352 *
¤c
 < 
¤c_’d
) {

353 cÚ¡ *
begš
 = *
¤c
;

354 **
¤c
) {

355 ++(*
¤c
);

356 ià(*
¤c
 =ğ
¤c_’d
è 
çl£
;

358 
»suÉ
 +ğ
	`¡ršg
(
begš
, *
¤c
 - begin);

359 ++(*
¤c
);

360 ià(*
¤c
 =ğ
¤c_’d
è 
çl£
;

361 ià(**
¤c
 != '\xff') {

362 ++(*
¤c
);

363  
Œue
;

365 
»suÉ
 += '\0';

366 ++(*
¤c
);

368  
çl£
;

369 
	}
}

371 
šlše
 
boŞ


372 
	$F_uÅack_boŞ
(cÚ¡ ** 
¤c
,

373 cÚ¡ * 
¤c_’d
,

374 
boŞ
 * 
»suÉ±r
)

376 ià(*
¤c
 =ğ
¤c_’d
) {

377 *
¤c
 = 0;

378  
çl£
;

380 *((*
¤c
)++)) {

382 ià(
»suÉ±r
è*»suÉ±¸ğ
çl£
;

383  
Œue
;

385 ià(
»suÉ±r
è*»suÉ±¸ğ
Œue
;

386  
Œue
;

388 *
¤c
 = 0;

389  
çl£
;

390 
	}
}

392 
šlše
 
¡ršg


393 
	$F_·ck_boŞ
(
boŞ
 
v®ue
)

395  
v®ue
 ? "1" : "0";

396 
	}
}

401 
šlše
 
¡ršg


402 
æšt_docid_to_key
(
X­Ÿn
::
docid
 
did
)

404  
F_·ck_ušt_´e£rvšg_sÜt
(
did
);

	@backends/flint/flint_values.cc

23 
	~<cÚfig.h
>

24 
	~"æšt_v®ues.h
"

25 
	~"æšt_uts.h
"

26 
	~"uts.h
"

27 
	~<x­Ÿn/”rÜ.h
>

28 
usšg
 
	g¡d
::
¡ršg
;

29 
usšg
 
	g¡d
::
make_·œ
;

31 
	~"omdebug.h
"

34 
šlše
 

35 
make_key
(
¡ršg
 & 
key
, 
X­Ÿn
::
docid
 
did
)

37 
DEBUGCALL_STATIC
(
DB
, , "make_key", 
key
 << ", " << 
did
);

38 
	gkey
 = 
æšt_docid_to_key
(
did
);

42 
	gFlštV®ueTabË
::
uÅack_’Œy
(cÚ¡ ** 
pos
,

43 cÚ¡ * 
’d
,

44 
X­Ÿn
::
v®u’o
 * 
this_v®ue_no
,

45 
¡ršg
 & 
this_v®ue
)

47 
DEBUGCALL_STATIC
(
DB
, , "FlintValueTable::unpack_entry",

48 "[pos], [’d], " << 
this_v®ue_no
 << ", " << 
this_v®ue
);

49 ià(!
F_uÅack_ušt
(
pos
, 
’d
, 
this_v®ue_no
)) {

50 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete item in valueable");

51 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Value‚umber in valueable isoo†arge");

54 ià(!
F_uÅack_¡ršg
(
pos
, 
’d
, 
this_v®ue
)) {

55 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete item in valueable");

56 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Item in valueable isoo†arge");

59 
LOGLINE
(
DB
, "FlintValueTable::unpack_entry(): value‚o " <<

60 
this_v®ue_no
 << " i `" << 
this_v®ue
 << "'");

64 
	gFlštV®ueTabË
::
’code_v®ues
(
¡ršg
 & 
s
,

65 
X­Ÿn
::
V®ueI‹¿tÜ
 
™
,

66 cÚ¡ 
X­Ÿn
::
V®ueI‹¿tÜ
 & 
’d
)

68 
DEBUGCALL
(
DB
, , "FlštV®ueTabË::’code_v®ues", "[&s], " << 
™
 << ", " << 
’d
);

69 
	g™
 !ğ
’d
) {

70 
s
 +ğ
F_·ck_ušt
(
™
.
g‘_v®u’o
());

71 
	gs
 +ğ
F_·ck_¡ršg
(*
™
);

72 ++
	g™
;

77 
	gFlštV®ueTabË
::
£t_’coded_v®ues
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
’c
)

79 
DEBUGCALL
(
DB
, , "FlštV®ueTabË::£t_’coded_v®ues", 
did
 << ", " << 
’c
);

80 
¡ršg
 
	gkey
;

81 
make_key
(
key
, 
did
);

82 
add
(
key
, 
’c
);

86 
	gFlštV®ueTabË
::
g‘_v®ue
(
¡ršg
 & 
v®ue
,

87 
X­Ÿn
::
docid
 
did
,

88 
X­Ÿn
::
v®u’o
 valueno) const

90 
DEBUGCALL
(
DB
, , "FlštV®ueTabË::g‘_v®ue", 
v®ue
 << ", " << 
did
 << ", " << 
v®u’o
);

91 
¡ršg
 
	gkey
;

92 
make_key
(
key
, 
did
);

93 
¡ršg
 
	gg
;

94 
boŞ
 
	gfound
 = 
g‘_exaù_’Œy
(
key
, 
g
);

96 ià(
	gfound
) {

97 cÚ¡ * 
	gpos
 = 
g
.
d©a
();

98 cÚ¡ * 
	g’d
 = 
pos
 + 
g
.
size
();

100 
	gpos
 &&…o !ğ
’d
) {

101 
X­Ÿn
::
v®u’o
 
this_v®ue_no
;

102 
¡ršg
 
	gthis_v®ue
;

104 
uÅack_’Œy
(&
pos
, 
’d
, &
this_v®ue_no
, 
this_v®ue
);

106 ià(
	gthis_v®ue_no
 =ğ
v®u’o
) {

107 
v®ue
 = 
this_v®ue
;

112 ià(
	gthis_v®ue_no
 > 
	gv®u’o
) ;

115 
	gv®ue
 = "";

119 
	gFlštV®ueTabË
::
g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues
,

120 
X­Ÿn
::
docid
 
did
) const

122 
DEBUGCALL
(
DB
, , "FlštV®ueTabË::g‘_®l_v®ues", "[v®ues], " << 
did
);

123 
¡ršg
 
	gkey
;

124 
make_key
(
key
, 
did
);

125 
¡ršg
 
	gg
;

126 
boŞ
 
	gfound
 = 
g‘_exaù_’Œy
(
key
, 
g
);

128 
	gv®ues
.
ş—r
();

129 ià(!
	gfound
) ;

131 cÚ¡ * 
	gpos
 = 
g
.
d©a
();

132 cÚ¡ * 
	g’d
 = 
pos
 + 
g
.
size
();

134 
	gpos
 &&…o !ğ
’d
) {

135 
X­Ÿn
::
v®u’o
 
this_v®ue_no
;

136 
¡ršg
 
	gthis_v®ue
;

138 
uÅack_’Œy
(&
pos
, 
’d
, &
this_v®ue_no
, 
this_v®ue
);

139 
	gv®ues
.
š£¹
(
make_·œ
(
this_v®ue_no
, 
this_v®ue
));

144 
	gFlštV®ueTabË
::
d–‘e_®l_v®ues
(
X­Ÿn
::
docid
 
did
)

146 
DEBUGCALL
(
DB
, , "FlštV®ueTabË::d–‘e_®l_v®ues", 
did
);

147 
¡ršg
 
	gkey
;

148 
make_key
(
key
, 
did
);

149 
d–
(
key
);

	@backends/flint/flint_values.h

23 #iâdeà
OM_HGUARD_FLINT_VALUES_H


24 
	#OM_HGUARD_FLINT_VALUES_H


	)

26 
	~<m­
>

27 
	~<¡ršg
>

29 
	~<x­Ÿn/ty³s.h
>

30 
	~<x­Ÿn/v®ue™”©Ü.h
>

31 
	~"æšt_bË.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 şas 
	cFlštV®ueTabË
 : 
public
 
FlštTabË
 {

36 
´iv©e
:

40 
uÅack_’Œy
(cÚ¡ ** 
pos
,

41 cÚ¡ * 
’d
,

42 
X­Ÿn
::
v®u’o
 * 
this_v®ue_no
,

43 
¡ršg
 & 
this_v®ue
);

45 
	mpublic
:

58 
	$FlštV®ueTabË
(cÚ¡ 
¡ršg
 & 
·th_
, 
boŞ
 
»adÚly_
)

59 : 
	`FlštTabË
("v®ue", 
·th_
 + "/v®ue.", 
»adÚly_
, 
DONT_COMPRESS
, 
Œue
) { }

63 
	`’code_v®ues
(
¡ršg
 & 
s
,

64 
X­Ÿn
::
V®ueI‹¿tÜ
 
™
,

65 cÚ¡ 
X­Ÿn
::
V®ueI‹¿tÜ
 & 
’d
);

68 
	`£t_’coded_v®ues
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 & 
’c
);

74 
	`g‘_v®ue
(
¡ršg
 & 
v®ue
, 
X­Ÿn
::
docid
 
did
,

75 
X­Ÿn
::
v®u’o
 valueno) const;

83 
	`g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues
,

84 
X­Ÿn
::
docid
 
did
) const;

91 
	`d–‘e_®l_v®ues
(
X­Ÿn
::
docid
 
did
);

92 
	}
};

	@backends/flint/flint_version.cc

21 
	~<cÚfig.h
>

23 
	~"§ã”ºo.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"æšt_io.h
"

28 
	~"æšt_v”siÚ.h
"

29 
	~"¡ršguts.h
"

30 
	~"uts.h
"

32 #ifdeà
__WIN32__


33 
	~"msvc_posix_w¿µ”.h
"

36 
	~<c¡dio
>

37 
	~<c¡ršg
>

38 
	~<¡ršg
>

40 
	~"commÚ/§ãuuid.h
"

42 
usšg
 
Çme¥aû
 
	g¡d
;

45 
	#FLINT_VERSION
 200709120

	)

57 
	#MAGIC_STRING
 "IAmFlšt"

	)

59 
	#MAGIC_LEN
 
	`CONST_STRLEN
(
MAGIC_STRING
)

	)

60 
	#VERSIONFILE_SIZE
 (
MAGIC_LEN
 + 4)

	)

62 
	gFlštV”siÚ
::
	$ü—‹
()

64 
buf
[
VERSIONFILE_SIZE
] = 
MAGIC_STRING
;

65 *
v
 = 
»š‹½»t_ÿ¡
<*>(
buf
è+ 
MAGIC_LEN
;

66 
v
[0] = 
¡©ic_ÿ¡
<>(
FLINT_VERSION
 & 0xff);

67 
v
[1] = 
¡©ic_ÿ¡
<>((
FLINT_VERSION
 >> 8) & 0xff);

68 
v
[2] = 
¡©ic_ÿ¡
<>((
FLINT_VERSION
 >> 16) & 0xff);

69 
v
[3] = 
¡©ic_ÿ¡
<>((
FLINT_VERSION
 >> 24) & 0xff);

71 
fd
 = ::
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
|
O_CREAT
|
O_TRUNC
|
O_BINARY
, 0666);

73 ià(
fd
 < 0) {

74 
¡ršg
 
	`msg
("Failedo create flint version file: ");

75 
msg
 +ğ
f’ame
;

76 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

79 
Œy
 {

80 
	`æšt_io_wr™e
(
fd
, 
buf
, 
VERSIONFILE_SIZE
);

81 } 
	`ÿtch
 (...) {

82 ()
	`şo£
(
fd
);

83 
throw
;

86 ià(
	`şo£
(
fd
) != 0) {

87 
¡ršg
 
	`msg
("Failedo create flint version file: ");

88 
msg
 +ğ
f’ame
;

89 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

92 
	`uuid_ş—r
(
uuid
);

93 
	`’su»_uuid
();

94 
	}
}

96 
	gFlštV”siÚ
::
	$»ad_ªd_check
(
boŞ
 
»adÚly
)

98 
fd
 = ::
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_RDONLY
|
O_BINARY
);

100 ià(
fd
 < 0) {

101 
¡ršg
 
	`msg
("Failedo open flint version file for„eading: ");

102 
msg
 +ğ
f’ame
;

103 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
, 
”ºo
);

107 
buf
[
VERSIONFILE_SIZE
 + 1];

108 
size_t
 
size
;

109 
Œy
 {

110 
size
 = 
	`æšt_io_»ad
(
fd
, 
buf
, 
VERSIONFILE_SIZE
 + 1, 0);

111 } 
	`ÿtch
 (...) {

112 ()
	`şo£
(
fd
);

113 
throw
;

115 ()
	`şo£
(
fd
);

117 ià(
size
 !ğ
VERSIONFILE_SIZE
) {

118 
¡ršg
 
	`msg
("Flint version file ");

119 
msg
 +ğ
f’ame
;

120 
msg
 +ğ" should b"
	`STRINGIZE
(
VERSIONFILE_SIZE
)" bytes,‡ctually ";

121 
msg
 +ğ
	`om_to¡ršg
(
size
);

122 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

125 ià(
	`memcmp
(
buf
, 
MAGIC_STRING
, 
MAGIC_LEN
) != 0) {

126 
¡ršg
 
	`msg
("Flint version file doesn't containhe„ight magic string: ");

127 
msg
 +ğ
f’ame
;

128 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
(
msg
);

131 cÚ¡ *
v
;

132 
v
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
buf
è+ 
MAGIC_LEN
;

133 
v”siÚ
 = 
v
[0] | (v[1] << 8) | (v[2] << 16) | (v[3] << 24);

134 ià(
v”siÚ
 >= 200704230 && version < 200709120) {

135 ià(
»adÚly
) ;

138 
¡ršg
 
f’ame_§ve
 = 
f’ame
;

139 
f’ame
 += ".tmp";

140 
	`ü—‹
();

141 
»suÉ
;

142 #ifdeà
__WIN32__


143 
»suÉ
 = 
	`msvc_posix_»Çme
(
f’ame
.
	`c_¡r
(), 
f’ame_§ve
.c_str());

145 
»suÉ
 = 
	`»Çme
(
f’ame
.
	`c_¡r
(), 
f’ame_§ve
.c_str());

147 
f’ame
 = 
f’ame_§ve
;

148 ià(
»suÉ
 == -1) {

149 
¡ršg
 
	`msg
("Failedo update flint version file: ");

150 
msg
 +ğ
f’ame
;

151 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
(
msg
);

155 ià(
v”siÚ
 !ğ
FLINT_VERSION
) {

156 
¡ršg
 
	`msg
("Flint version file ");

157 
msg
 +ğ
f’ame
;

158 
msg
 += " is version ";

159 
msg
 +ğ
	`om_to¡ršg
(
v”siÚ
);

160 
msg
 +ğ" buˆI oÆy und”¡ªd "
	`STRINGIZE
(
FLINT_VERSION
);

161 
throw
 
X­Ÿn
::
	`D©aba£V”siÚE¼Ü
(
msg
);

164 
¡ršg
 
f
 = 
f’ame
;

165 
f
.
	`»size
(f.
	`size
(è- 
	`CONST_STRLEN
("iamflint"));

166 
f
 += "uuid";

167 
fd
 = ::
	`İ’
(
f
.
	`c_¡r
(), 
O_RDONLY
|
O_BINARY
);

169 ià(
fd
 < 0) {

170 
	`uuid_ş—r
(
uuid
);

174 
Œy
 {

175 ()
	`æšt_io_»ad
(
fd
, 
»š‹½»t_ÿ¡
<*>(
uuid
), 16, 16);

176 } 
	`ÿtch
 (...) {

177 
	`uuid_ş—r
(
uuid
);

178 ()
	`şo£
(
fd
);

179 
throw
;

181 ()
	`şo£
(
fd
);

182 
	}
}

185 
	gFlštV”siÚ
::
	$’su»_uuid
() const

187 ià(
	`uuid_is_nuÎ
(
uuid
)) {

188 
¡ršg
 
f
 = 
f’ame
;

189 
f
.
	`»size
(f.
	`size
(è- 
	`CONST_STRLEN
("iamflint"));

190 
f
 += "uuid";

191 
fd
 = ::
	`İ’
(
f
.
	`c_¡r
(), 
O_WRONLY
|
O_CREAT
|
O_TRUNC
|
O_BINARY
, 0666);

195 ià(
fd
 < 0) {

196 
¡©
 
¡©buf
;

197 ià(
	`¡©
(
f’ame
, &
¡©buf
) != 0) {

198 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Couldn'ˆ¡© " + 
f’ame
, 
”ºo
);

200 
mtime
 = 
¡©buf
.
¡_mtime
;

204 *
v
 = 
»š‹½»t_ÿ¡
<*>(
uuid
);

205 
v
[0] = 
¡©ic_ÿ¡
<>(
mtime
 & 0xff);

206 
v
[1] = 
¡©ic_ÿ¡
<>((
mtime
 >> 8) & 0xff);

207 
v
[2] = 
¡©ic_ÿ¡
<>((
mtime
 >> 16) & 0xff);

208 
v
[3] = 
¡©ic_ÿ¡
<>((
mtime
 >> 24) & 0xff);

212 
	`uuid_g’”©e
(
uuid
);

213 
Œy
 {

214 
	`æšt_io_wr™e
(
fd
, 
»š‹½»t_ÿ¡
<cÚ¡ *>(
uuid
), 16);

215 } 
	`ÿtch
 (...) {

216 ()
	`şo£
(
fd
);

217 
throw
;

220 ià(
	`şo£
(
fd
) != 0) {

221 
¡ršg
 
	`msg
("Failedo create flint uuid file: ");

222 
msg
 +ğ
f
;

223 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
(
msg
, 
”ºo
);

226 
	}
}

	@backends/flint/flint_version.h

21 #iâdeà
OM_HGUARD_FLINT_VERSION_H


22 
	#OM_HGUARD_FLINT_VERSION_H


	)

24 
	~<c¡ršg
>

25 
	~<¡ršg
>

27 
	~"commÚ/§ãuuid.h
"

34 şas 
	cFlštV”siÚ
 {

36 
	m¡d
::
¡ršg
 
f’ame
;

39 
mubË
 
uuid_t
 
	muuid
;

42 
	$’su»_uuid
() const;

44 
public
:

45 
	`FlštV”siÚ
(cÚ¡ 
¡d
::
¡ršg
 & 
dbdœ
)

46 : 
	`f’ame
(
dbdœ
 + "/iamflint") { }

49 
	`ü—‹
();

57 
	`»ad_ªd_check
(
boŞ
 
»adÚly
);

60 cÚ¡ * 
	$g‘_uuid
() const {

61 
	`’su»_uuid
();

62  
»š‹½»t_ÿ¡
<cÚ¡ *>(
uuid
);

63 
	}
}

66 
	g¡d
::
¡ršg
 
	$g‘_uuid_¡ršg
() const {

67 
buf
[37];

68 
	`’su»_uuid
();

69 
	`uuid_uÅ¬£_low”
(
uuid
, 
buf
);

70  
¡d
::
	`¡ršg
(
buf
, 36);

71 
	}
}

74 
	$£t_uuid
(* 
d©a
) {

75 
¡d
::
	`memıy
(
uuid
, 
d©a
, 16);

76 
	}
}

82 
boŞ
 
£t_uuid_¡ršg
(cÚ¡ 
¡d
::
¡ršg
 & 
s
) {

83  
uuid_·r£
(
s
.
c_¡r
(), 
uuid
);

	@backends/flint_lock.cc

22 
	~<cÚfig.h
>

24 
	~"æšt_lock.h
"

26 #iâdeà
__WIN32__


27 
	~"§ã”ºo.h
"

29 
	~"§ãfú.h
"

30 
	~<uni¡d.h
>

31 
	~<c¡dlib
>

32 
	~<sys/ty³s.h
>

33 
	~<sys/sock‘.h
>

34 
	~<sys/wa™.h
>

35 
	~<sigÇl.h
>

36 
	~<c¡ršg
>

39 
	~"omas£¹.h
"

41 #ifdeà
__CYGWIN__


42 
	~<sys/cygwš.h
>

45 
	~"x­Ÿn/”rÜ.h
"

47 
usšg
 
Çme¥aû
 
	g¡d
;

49 
	gFlštLock
::
»asÚ


50 
FlštLock
::
	$lock
(
boŞ
 
exşusive
, 
¡ršg
 & 
ex¶ª©iÚ
) {

52 ()
exşusive
;

53 
	`As£¹
(
exşusive
);

54 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


55 
	`As£¹
(
hFe
 =ğ
INVALID_HANDLE_VALUE
);

56 #ifdeà
__CYGWIN__


57 
âm
[
MAX_PATH
];

58 
	`cygwš_cÚv_to_wš32_·th
(
f’ame
.
	`c_¡r
(), 
âm
);

60 cÚ¡ *
âm
 = 
f’ame
.
	`c_¡r
();

62 
hFe
 = 
	`C»©eFe
(
âm
, 
GENERIC_WRITE
, 
FILE_SHARE_READ
,

63 
NULL
, 
OPEN_ALWAYS
, 
FILE_ATTRIBUTE_NORMAL
, NULL);

64 ià(
hFe
 !ğ
INVALID_HANDLE_VALUE
è 
SUCCESS
;

65 ià(
	`G‘La¡E¼Ü
(è=ğ
ERROR_ALREADY_EXISTS
è 
INUSE
;

66 
ex¶ª©iÚ
 = 
	`¡ršg
();

67  
UNKNOWN
;

68 #–ià
defšed
 
__EMX__


69 
APIRET
 
rc
;

70 
ULONG
 
ulAùiÚ
;

71 
rc
 = 
	`DosO³n
((
PCSZ
)
f’ame
.
	`c_¡r
(), &
hFe
, &
ulAùiÚ
, 0, 
FILE_NORMAL
,

72 
OPEN_ACTION_OPEN_IF_EXISTS
 | 
OPEN_ACTION_CREATE_IF_NEW
,

73 
OPEN_SHARE_DENYWRITE
 | 
OPEN_ACCESS_WRITEONLY
,

74 
NULL
);

75 ià(
rc
 =ğ
NO_ERROR
è 
SUCCESS
;

76 ià(
rc
 =ğ
ERROR_ACCESS_DENIED
è 
INUSE
;

77 
ex¶ª©iÚ
 = 
	`¡ršg
();

78  
UNKNOWN
;

80 
	`As£¹
(
fd
 == -1);

81 
lockfd
 = 
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
, 0666);

82 ià(
lockfd
 < 0) {

84 
ex¶ª©iÚ
 = 
	`¡ršg
("Couldn'ˆİ’†ockfe: "è+ 
	`¡»¼Ü
(
”ºo
);

85  ((
”ºo
 =ğ
EMFILE
 ||ƒ¼nØ=ğ
ENFILE
è? 
FDLIMIT
 : 
UNKNOWN
);

93 ià(
	`¿»
(
lockfd
 < 2)) {

96 
lockfd_dup
 = 
	`dup
(
lockfd
);

97 ià(
	`¿»
(
lockfd_dup
 < 2)) {

98 
’o
 = 0;

99 ià(
lockfd_dup
 < 0) {

100 
’o
 = 
”ºo
;

101 
	`şo£
(
lockfd
);

103 
lockfd_dup2
 = 
	`dup
(
lockfd
);

104 ià(
lockfd_dup2
 < 0) {

105 
’o
 = 
”ºo
;

107 
	`şo£
(
lockfd
);

108 
	`şo£
(
lockfd_dup
);

109 
lockfd
 = 
lockfd_dup2
;

111 ià(
’o
) {

112  ((
’o
 =ğ
EMFILE
 ||ƒnØ=ğ
ENFILE
è? 
FDLIMIT
 : 
UNKNOWN
);

115 
	`şo£
(
lockfd
);

116 
lockfd
 = 
lockfd_dup
;

120 
fds
[2];

121 ià(
	`sock‘·œ
(
AF_UNIX
, 
SOCK_STREAM
, 
PF_UNSPEC
, 
fds
) < 0) {

123 
ex¶ª©iÚ
 = 
	`¡ršg
("Couldn'ˆü—‹ sock‘·œ: "è+ 
	`¡»¼Ü
(
”ºo
);

124 
»asÚ
 
why
 = ((
”ºo
 =ğ
EMFILE
 ||ƒ¼nØ=ğ
ENFILE
è? 
FDLIMIT
 : 
UNKNOWN
);

125 ()
	`şo£
(
lockfd
);

126  
why
;

129 
pid_t
 
chd
 = 
	`fÜk
();

131 ià(
chd
 == 0) {

133 
	`şo£
(
fds
[0]);

135 
»asÚ
 
why
 = 
SUCCESS
;

137 
æock
 
æ
;

138 
æ
.
l_ty³
 = 
F_WRLCK
;

139 
æ
.
l_wh’û
 = 
SEEK_SET
;

140 
æ
.
l_¡¬t
 = 0;

141 
æ
.
l_Ën
 = 1;

142 
	`fú
(
lockfd
, 
F_SETLK
, &
æ
) == -1) {

143 ià(
”ºo
 !ğ
EINTR
) {

146 ià(
”ºo
 =ğ
EACCES
 ||ƒ¼nØ=ğ
EAGAIN
) {

147 
why
 = 
INUSE
;

148 } ià(
”ºo
 =ğ
ENOLCK
) {

149 
why
 = 
UNSUPPORTED
;

151 
	`_ex™
(0);

160 
ch
 = 
¡©ic_ÿ¡
<>(
why
);

161 
	`wr™e
(
fds
[1], &
ch
, 1) < 0) {

166 ià(
”ºo
 !ğ
EINTR
è
	`_ex™
(1);

168 ià(
why
 !ğ
SUCCESS
è
	`_ex™
(0);

172 
	`dup2
(
fds
[1], 0);

173 
	`dup2
(
fds
[1], 1);

177 ià(
	`chdœ
("/") < 0) {

188 
maxfd
 = 
¡©ic_ÿ¡
<>(
	`syscÚf
(
_SC_OPEN_MAX
));

189 
i
 = 2; i < 
maxfd
; ++i) {

190 ià(
i
 !ğ
lockfd
) {

193 
	`şo£
(
i
è< 0 && 
”ºo
 =ğ
EINTR
) { }

198 
	`exeş
("/bš/ÿt", "/bš/ÿt", 
¡©ic_ÿ¡
<*>(
NULL
));

200 
ch
;

201 
	`»ad
(0, &
ch
, 1) != 0) { }

202 
	`_ex™
(0);

205 
	`şo£
(
lockfd
);

206 
	`şo£
(
fds
[1]);

208 ià(
chd
 == -1) {

210 
ex¶ª©iÚ
 = 
	`¡ršg
("Couldn'ˆfÜk: "è+ 
	`¡»¼Ü
(
”ºo
);

211 
	`şo£
(
fds
[0]);

212  
UNKNOWN
;

215 
»asÚ
 
why
 = 
UNKNOWN
;

218 
Œue
) {

219 
ch
;

220 
ssize_t
 
n
 = 
	`»ad
(
fds
[0], &
ch
, 1);

221 ià(
n
 == 1) {

222 
why
 = 
¡©ic_ÿ¡
<
»asÚ
>(
ch
);

223 ià(
why
 !ğ
SUCCESS
) ;

225 
fd
 = 
fds
[0];

226 
pid
 = 
chd
;

227  
SUCCESS
;

229 ià(
n
 == 0) {

231 
ex¶ª©iÚ
.
	`assign
("Got EOF„eading from child…rocess");

234 ià(
”ºo
 !ğ
EINTR
) {

236 
ex¶ª©iÚ
 = 
	`¡ršg
("E¼Ü„—dšg from chd…roûss: "è+ 
	`¡»¼Ü
(
”ºo
);

241 
	`şo£
(
fds
[0]);

243 
¡©us
;

244 
	`wa™pid
(
chd
, &
¡©us
, 0) < 0) {

245 ià(
”ºo
 !ğ
EINTR
) ;

248  
why
;

250 
	}
}

253 
	gFlštLock
::
	$»Ëa£
() {

254 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


255 ià(
hFe
 =ğ
INVALID_HANDLE_VALUE
) ;

256 
	`Clo£HªdË
(
hFe
);

257 
hFe
 = 
INVALID_HANDLE_VALUE
;

258 #–ià
defšed
 
__EMX__


259 ià(
hFe
 =ğ
NULLHANDLE
) ;

260 
	`DosClo£
(
hFe
);

261 
hFe
 = 
NULLHANDLE
;

263 ià(
fd
 < 0) ;

264 
	`şo£
(
fd
);

265 
fd
 = -1;

270 ià(
	`kl
(
pid
, 
SIGHUP
) == 0) {

271 
¡©us
;

272 
	`wa™pid
(
pid
, &
¡©us
, 0) < 0) {

273 ià(
”ºo
 !ğ
EINTR
) ;

277 
	}
}

280 
	gFlštLock
::
throw_d©aba£lock”rÜ
(
FlštLock
::
»asÚ
 
why
,

281 cÚ¡ 
¡ršg
 & 
db_dœ
,

282 cÚ¡ 
¡ršg
 & 
ex¶ª©iÚ
)

284 
¡ršg
 
msg
("Unableo get write†ock on ");

285 
	gmsg
 +ğ
db_dœ
;

286 ià(
	gwhy
 =ğ
FlštLock
::
INUSE
) {

287 
msg
 += ":‡lready†ocked";

288 } ià(
	gwhy
 =ğ
FlštLock
::
UNSUPPORTED
) {

289 
msg
 += ":†ocking…robably‚ot supported byhis FS";

290 } ià(
	gwhy
 =ğ
FlštLock
::
FDLIMIT
) {

291 
msg
 += ":oo many open files";

292 } ià(
	gwhy
 =ğ
FlštLock
::
UNKNOWN
) {

293 ià(!
ex¶ª©iÚ
.
em±y
())

294 
msg
 +ğ": " + 
ex¶ª©iÚ
;

296 
throw
 
	gX­Ÿn
::
D©aba£LockE¼Ü
(
msg
);

	@backends/flint_lock.h

22 #iâdeà
XAPIAN_INCLUDED_FLINT_LOCK_H


23 
	#XAPIAN_INCLUDED_FLINT_LOCK_H


	)

25 
	~<¡ršg
>

27 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


28 
	~"§ãwšdows.h
"

29 #–ià
defšed
 
__EMX__


30 
	#INCL_DOS


	)

31 
	#INCL_DOSERRORS


	)

32 
	~<os2.h
>

34 
	~<sys/ty³s.h
>

37 şas 
	cFlštLock
 {

38 
	m¡d
::
¡ršg
 
f’ame
;

39 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


40 
HANDLE
 
	mhFe
;

41 #–ià
defšed
 
__EMX__


42 
HFILE
 
	mhFe
;

44 
	mfd
;

45 
pid_t
 
	mpid
;

48 
	mpublic
:

50 
SUCCESS
,

51 
	mINUSE
,

52 
	mUNSUPPORTED
,

53 
	mFDLIMIT
,

54 
	mUNKNOWN


55 } 
	t»asÚ
;

56 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


57 
FlštLock
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame_
)

58 : 
f’ame
(
f’ame_
), 
	$hFe
(
INVALID_HANDLE_VALUE
) {

63 
f’ame
 += "/flintlock";

64 
	}
}

65 
İ”©Ü
 
	$boŞ
(ècÚ¡ {  
hFe
 !ğ
INVALID_HANDLE_VALUE
; 
	}
}

66 #–ià
defšed
 
__EMX__


67 
FlštLock
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame_
)

68 : 
f’ame
(
f’ame_
), 
	$hFe
(
NULLHANDLE
) {

69 
f’ame
 += "/flintlock";

70 
	}
}

71 
İ”©Ü
 
	$boŞ
(ècÚ¡ {  
hFe
 !ğ
NULLHANDLE
; 
	}
}

73 
FlštLock
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame_
è: 
f’ame
(f’ame_), 
fd
(-1) {

74 
	gf’ame
 += "/flintlock";

76 
İ”©Ü
 
	$boŞ
(ècÚ¡ {  
fd
 !ğ-1; 
	}
}

79 ~
	$FlštLock
(è{ 
	`»Ëa£
(); 
	}
}

87 
»asÚ
 
lock
(
boŞ
 
exşusive
, 
¡d
::
¡ršg
 & 
ex¶ª©iÚ
);

90 
»Ëa£
();

93 
throw_d©aba£lock”rÜ
(
FlštLock
::
»asÚ
 
why
,

94 cÚ¡ 
¡d
::
¡ršg
 & 
db_dœ
,

95 cÚ¡ 
¡d
::
¡ršg
 & 
ex¶ª©iÚ
);

	@backends/inmemory/inmemory_alltermslist.cc

22 
	~<cÚfig.h
>

23 
	~"šmemÜy_®É”m¦i¡.h
"

25 
	~"¡ršguts.h
"

27 
¡ršg


28 
	gInMemÜyAÎT”msLi¡
::
	$g‘_‹rmÇme
() const

30 ià(
d©aba£
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

31 
	`As£¹
(!
	`©_’d
());

32 
	`As£¹
(!
™
->
fœ¡
.
	`em±y
());

33  
™
->
fœ¡
;

34 
	}
}

36 
	gX­Ÿn
::
doccouÁ


37 
InMemÜyAÎT”msLi¡
::
	$g‘_‹rmäeq
() const

39 ià(
d©aba£
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

40 
	`As£¹
(!
	`©_’d
());

41 
	`As£¹
(!
™
->
fœ¡
.
	`em±y
());

43  
™
->
£cÚd
.
docs
.
	`size
();

44 
	}
}

46 
	gX­Ÿn
::
‹rmcouÁ


47 
InMemÜyAÎT”msLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

49 ià(
d©aba£
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

50 
	`As£¹
(!
	`©_’d
());

51 
	`As£¹
(!
™
->
fœ¡
.
	`em±y
());

52 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Collection frequency‚ot implemented in InMemory backend");

53 
	}
}

55 
T”mLi¡
 *

56 
	gInMemÜyAÎT”msLi¡
::
	$sk_to
(cÚ¡ 
¡ršg
 &
Šame_
)

58 ià(
d©aba£
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

59 
¡ršg
 
	`Šame
(
Šame_
);

60 
	`As£¹
(
™
 !ğ
tm­
->
	`’d
());

61 ià(!
™
->
fœ¡
.
	`em±y
()) {

63 ià(
Šame
 <ğ
™
->
fœ¡
è 
NULL
;

66 ià(
Šame
 < 
´efix
) {

67 
Šame
 = 
´efix
;

68 } ià(
Šame
.
	`em±y
()) {

69 ++
™
;

70  
NULL
;

73 
™
 = 
tm­
->
	`low”_bound
(
Šame
);

74 
™
 !ğ
tm­
->
	`’d
(è&& it->
£cÚd
.
‹rm_äeq
 == 0) ++it;

75 ià(
™
 !ğ
tm­
->
	`’d
(è&& !
	`¡¬tsw™h
(™->
fœ¡
, 
´efix
))

76 
™
 = 
tm­
->
	`’d
();

77  
NULL
;

78 
	}
}

80 
T”mLi¡
 *

81 
	gInMemÜyAÎT”msLi¡
::
	$Ãxt
()

83 ià(
d©aba£
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

84 
	`As£¹
(
™
 !ğ
tm­
->
	`’d
());

85 ià(
™
->
fœ¡
.
	`em±y
(è&& !
´efix
.empty()) {

86 
™
 = 
tm­
->
	`low”_bound
(
´efix
);

88 ++
™
;

90 
™
 !ğ
tm­
->
	`’d
(è&& it->
£cÚd
.
‹rm_äeq
 == 0) ++it;

91 ià(
™
 !ğ
tm­
->
	`’d
(è&& !
	`¡¬tsw™h
(™->
fœ¡
, 
´efix
))

92 
™
 = 
tm­
->
	`’d
();

93  
NULL
;

94 
	}
}

96 
boŞ


97 
	gInMemÜyAÎT”msLi¡
::
	$©_’d
() const

99 ià(
d©aba£
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

100 
	`As£¹
(
™
 =ğ
tm­
->
	`’d
(è|| !™->
fœ¡
.
	`em±y
());

101  (
™
 =ğ
tm­
->
	`’d
());

102 
	}
}

	@backends/inmemory/inmemory_alltermslist.h

22 #iâdeà
OM_HGUARD_INMEMORY_ALLTERMSLIST_H


23 
	#OM_HGUARD_INMEMORY_ALLTERMSLIST_H


	)

25 
	~"®É”m¦i¡.h
"

26 
	~"šmemÜy_d©aba£.h
"

29 şas 
	cInMemÜyAÎT”msLi¡
 : 
public
 
AÎT”msLi¡


31 
´iv©e
:

33 
InMemÜyAÎT”msLi¡
(const InMemoryAllTermsList &);

36 
	mİ”©Ü
=(cÚ¡ 
InMemÜyAÎT”msLi¡
 &);

38 cÚ¡ 
	m¡d
::
m­
<
¡ršg
, 
	mInMemÜyT”m
> *
	mtm­
;

40 
	m¡d
::
m­
<
¡ršg
, 
	mInMemÜyT”m
>::
cÚ¡_™”©Ü
 
™
;

42 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
d©aba£
;

44 
¡ršg
 
	m´efix
;

46 
	mpublic
:

48 
InMemÜyAÎT”msLi¡
(cÚ¡ 
¡d
::
m­
<
¡ršg
, 
InMemÜyT”m
> *
tm­_
,

49 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
d©aba£_
,

50 cÚ¡ 
¡ršg
 & 
´efix_
)

51 : 
tm­
(
tm­_
), 
™
Ñm­->
begš
()), 
d©aba£
(
d©aba£_
),

52 
	$´efix
(
´efix_
)

57 
¡ršg
 
	$g‘_‹rmÇme
() const;

60 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

63 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

65 
T”mLi¡
 * 
	`sk_to
(cÚ¡ 
¡ršg
 &
Šame
);

69 
T”mLi¡
 * 
	`Ãxt
();

72 
boŞ
 
	$©_’d
() const;

73 
	}
};

	@backends/inmemory/inmemory_database.cc

24 
	~<cÚfig.h
>

26 
	~"šmemÜy_d©aba£.h
"

28 
	~"omdebug.h
"

30 
	~"ex·ndweight.h
"

31 
	~"šmemÜy_docum’t.h
"

32 
	~"šmemÜy_®É”m¦i¡.h
"

33 
	~"uts.h
"

34 
	~"v®ue¡©s.h
"

36 
	~<¡ršg
>

37 
	~<veùÜ
>

38 
	~<m­
>

40 
	~<x­Ÿn/”rÜ.h
>

41 
	~<x­Ÿn/v®ue™”©Ü.h
>

43 
usšg
 
	g¡d
::
make_·œ
;

45 
šlše
 

46 
	gInMemÜyT”m
::
	$add_po¡šg
(cÚ¡ 
InMemÜyPo¡šg
 & 
po¡
)

49 
veùÜ
<
InMemÜyPo¡šg
>::
™”©Ü
 
p
;

50 
p
 = 
	`low”_bound
(
docs
.
	`begš
(), docs.
	`’d
(),

51 
po¡
, 
	`InMemÜyPo¡šgLessThª
());

52 ià(
p
 =ğ
docs
.
	`’d
(è|| 
	`InMemÜyPo¡šgLessThª
()(
po¡
, *p)) {

53 
docs
.
	`š£¹
(
p
, 
po¡
);

54 } ià(!
p
->
v®id
) {

55 *
p
 = 
po¡
;

57 (*
p
).
	`m”ge
(
po¡
);

59 
	}
}

61 
šlše
 

62 
	gInMemÜyDoc
::
	$add_po¡šg
(cÚ¡ 
InMemÜyT”mEÁry
 & 
po¡
)

65 
veùÜ
<
InMemÜyT”mEÁry
>::
™”©Ü
 
p
;

66 
p
 = 
	`low”_bound
(
‹rms
.
	`begš
(),”ms.
	`’d
(),

67 
po¡
, 
	`InMemÜyT”mEÁryLessThª
());

68 ià(
p
 =ğ
‹rms
.
	`’d
(è|| 
	`InMemÜyT”mEÁryLessThª
()(
po¡
, *p)) {

69 
‹rms
.
	`š£¹
(
p
, 
po¡
);

71 (*
p
).
	`m”ge
(
po¡
);

73 
	}
}

79 
	gInMemÜyPo¡Li¡
::
InMemÜyPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db_
,

80 cÚ¡ 
InMemÜyT”m
 & 
im‹rm
,

81 cÚ¡ 
¡d
::
¡ršg
 & 
‹rm_
)

82 : 
L—fPo¡Li¡
(
‹rm_
),

83 
pos
(
im‹rm
.
docs
.
begš
()),

84 
’d
(
im‹rm
.
docs
.end()),

85 
‹rmäeq
(
im‹rm
.
‹rm_äeq
),

86 
¡¬‹d
(
çl£
),

87 
	$db
(
db_
)

89 
pos
 !ğ
’d
 && !pos->
v®id
) ++pos;

90 
	}
}

92 
	gX­Ÿn
::
doccouÁ


93 
InMemÜyPo¡Li¡
::
	$g‘_‹rmäeq
() const

95  
‹rmäeq
;

96 
	}
}

98 
	gX­Ÿn
::
docid


99 
InMemÜyPo¡Li¡
::
	$g‘_docid
() const

101 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

102 
	`As£¹
(
¡¬‹d
);

103 
	`As£¹
(!
	`©_’d
());

104  (*
pos
).
did
;

105 
	}
}

107 
Po¡Li¡
 *

108 
	gInMemÜyPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 )

110 ià(
db
->
is_şo£d
()è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

111 ià(
	g¡¬‹d
) {

112 
As£¹
(!
©_’d
());

113 ++
	gpos
;

114 
	gpos
 !ğ
’d
 && !
pos
->
v®id
) ++pos;

116 
	g¡¬‹d
 = 
Œue
;

118  
	gNULL
;

121 
Po¡Li¡
 *

122 
	gInMemÜyPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

124 ià(
db
->
is_şo£d
()è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

131 
	g¡¬‹d
 = 
Œue
;

132 
As£¹
(!
©_’d
());

133 !
©_’d
(è&& (*
	gpos
).
	gdid
 < did) {

134 (è
Ãxt
(
w_mš
);

136  
	gNULL
;

139 
boŞ


140 
	gInMemÜyPo¡Li¡
::
	$©_’d
() const

142 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

143  (
pos
 =ğ
’d
);

144 
	}
}

146 
¡ršg


147 
	gInMemÜyPo¡Li¡
::
	$g‘_desütiÚ
() const

149  "InMemÜyPo¡Li¡ " + 
	`om_to¡ršg
(
‹rmäeq
);

150 
	}
}

152 
	gX­Ÿn
::
‹rmcouÁ


153 
InMemÜyPo¡Li¡
::
	$g‘_doş’gth
() const

155 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

156  
db
->
	`g‘_doş’gth
(
	`g‘_docid
());

157 
	}
}

159 
Pos™iÚLi¡
 *

160 
	gInMemÜyPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

162 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

163 
mypos™iÚs
.
	`£t_d©a
(
pos
->
pos™iÚs
);

164  &
mypos™iÚs
;

165 
	}
}

167 
Pos™iÚLi¡
 *

168 
	gInMemÜyPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

170 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

171  
Ãw
 
	`InMemÜyPos™iÚLi¡
(
pos
->
pos™iÚs
);

172 
	}
}

174 
	gX­Ÿn
::
‹rmcouÁ


175 
InMemÜyPo¡Li¡
::
	$g‘_wdf
() const

177 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

178  (*
pos
).
wdf
;

179 
	}
}

185 
	gInMemÜyT”mLi¡
::
InMemÜyT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db_
,

186 
X­Ÿn
::
docid
 
did_
,

187 cÚ¡ 
InMemÜyDoc
 & 
doc
,

188 
X­Ÿn
::
‹rmcouÁ
 
Ën
)

189 : 
pos
(
doc
.
‹rms
.
begš
()), 
’d
(doc.‹rms.’d()),”ms(doc.‹rms.
size
()),

190 
¡¬‹d
(
çl£
), 
db
(
db_
), 
did
(
did_
), 
	$docum’t_Ëngth
(
Ën
)

192 
	`LOGLINE
(
DB
, "InMemoryTermList::InMemoryTermList(): " <<

193 
‹rms
 << "”m ¡¬tšg from " << 
pos
->
Šame
);

194 
	}
}

196 
	gX­Ÿn
::
‹rmcouÁ


197 
InMemÜyT”mLi¡
::
	$g‘_wdf
() const

199 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

200 
	`As£¹
(
¡¬‹d
);

201 
	`As£¹
(!
	`©_’d
());

202  (*
pos
).
wdf
;

203 
	}
}

205 
	gX­Ÿn
::
doccouÁ


206 
InMemÜyT”mLi¡
::
	$g‘_‹rmäeq
() const

208 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

209 
	`As£¹
(
¡¬‹d
);

210 
	`As£¹
(!
	`©_’d
());

212  
db
->
	`g‘_‹rmäeq
((*
pos
).
Šame
);

213 
	}
}

215 
	gX­Ÿn
::
‹rmcouÁ


216 
InMemÜyT”mLi¡
::
	$g‘_­´ox_size
() const

218 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

219  
‹rms
;

220 
	}
}

223 
	gInMemÜyT”mLi¡
::
accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const

225 ià(
db
->
is_şo£d
()è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

226 
As£¹
(
¡¬‹d
);

227 
As£¹
(!
©_’d
());

228 
	g¡©s
.
accumuÏ‹
(
InMemÜyT”mLi¡
::
g‘_wdf
(), 
docum’t_Ëngth
,

229 
InMemÜyT”mLi¡
::
g‘_‹rmäeq
(),

230 
db
->
g‘_doccouÁ
());

233 
¡ršg


234 
	gInMemÜyT”mLi¡
::
	$g‘_‹rmÇme
() const

236 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

237 
	`As£¹
(
¡¬‹d
);

238 
	`As£¹
(!
	`©_’d
());

239  (*
pos
).
Šame
;

240 
	}
}

242 
T”mLi¡
 *

243 
	gInMemÜyT”mLi¡
::
	$Ãxt
()

245 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

246 ià(
¡¬‹d
) {

247 
	`As£¹
(!
	`©_’d
());

248 
pos
++;

250 
¡¬‹d
 = 
Œue
;

252  
NULL
;

253 
	}
}

255 
boŞ


256 
	gInMemÜyT”mLi¡
::
	$©_’d
() const

258 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

259 
	`As£¹
(
¡¬‹d
);

260  (
pos
 =ğ
’d
);

261 
	}
}

263 
	gX­Ÿn
::
‹rmcouÁ


264 
InMemÜyT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

266 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

267  
db
->
	`pos™iÚli¡_couÁ
(
did
, (*
pos
).
Šame
);

268 
	}
}

270 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


271 
InMemÜyT”mLi¡
::
	$pos™iÚli¡_begš
() const

273 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

274  
X­Ÿn
::
	`Pos™iÚI‹¿tÜ
(
db
->
	`İ’_pos™iÚ_li¡
(
did
, (*
pos
).
Šame
));

275 
	}
}

281 
	gInMemÜyAÎDocsPo¡Li¡
::
InMemÜyAÎDocsPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db_
)

282 : 
L—fPo¡Li¡
(
¡d
::
¡ršg
()), 
did
(0), 
	$db
(
db_
)

284 
	}
}

286 
	gX­Ÿn
::
doccouÁ


287 
InMemÜyAÎDocsPo¡Li¡
::
	$g‘_‹rmäeq
() const

289 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

290  
db
->
tÙdocs
;

291 
	}
}

293 
	gX­Ÿn
::
docid


294 
InMemÜyAÎDocsPo¡Li¡
::
	$g‘_docid
() const

296 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

297 
	`As£¹
(
did
 > 0);

298 
	`As£¹
(
did
 <ğ
db
->
‹rmli¡s
.
	`size
());

299 
	`As£¹
(
db
->
‹rmli¡s
[
did
 - 1].
is_v®id
);

300  
did
;

301 
	}
}

303 
	gX­Ÿn
::
‹rmcouÁ


304 
InMemÜyAÎDocsPo¡Li¡
::
	$g‘_doş’gth
() const

306 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

307  
db
->
	`g‘_doş’gth
(
did
);

308 
	}
}

310 
	gX­Ÿn
::
‹rmcouÁ


311 
InMemÜyAÎDocsPo¡Li¡
::
	$g‘_wdf
() const

314 
	}
}

316 
Pos™iÚLi¡
 *

317 
	gInMemÜyAÎDocsPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

319 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Can't open…osition†ist for‡ll docs iterator");

320 
	}
}

322 
Pos™iÚLi¡
 *

323 
	gInMemÜyAÎDocsPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

325 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Can't open…osition†ist for‡ll docs iterator");

326 
	}
}

328 
Po¡Li¡
 *

329 
	gInMemÜyAÎDocsPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 )

331 ià(
db
->
is_şo£d
()è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

332 
As£¹
(!
©_’d
());

334 ++
	gdid
;

335 } 
	gdid
 <ğ
db
->
‹rmli¡s
.
size
(è&& !db->‹rmli¡s[
did
 - 1].
is_v®id
);

336  
	gNULL
;

339 
Po¡Li¡
 *

340 
	gInMemÜyAÎDocsPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did_
, X­Ÿn::
weight
 )

342 ià(
db
->
is_şo£d
()è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

343 
As£¹
(!
©_’d
());

344 ià(
	gdid
 <ğ
did_
) {

345 
did
 = 
did_
;

346 
	gdid
 <ğ
db
->
‹rmli¡s
.
size
(è&& !db->‹rmli¡s[
did
 - 1].
is_v®id
) {

347 ++
did
;

350  
	gNULL
;

353 
boŞ


354 
	gInMemÜyAÎDocsPo¡Li¡
::
	$©_’d
() const

356 ià(
db
->
	`is_şo£d
()è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

357  (
did
 > 
db
->
‹rmli¡s
.
	`size
());

358 
	}
}

360 
¡ršg


361 
	gInMemÜyAÎDocsPo¡Li¡
::
	$g‘_desütiÚ
() const

363  "InMemÜyAÎDocsPo¡Li¡ " + 
	`om_to¡ršg
(
did
);

364 
	}
}

370 
	gInMemÜyD©aba£
::
	$InMemÜyD©aba£
()

371 : 
	`tÙdocs
(0), 
	`tÙËn
(0), 
	`pos™iÚs_´e£Á
(
çl£
), 
	$şo£d
(
çl£
)

374 
Œª§ùiÚ_¡©e
 = 
TRANSACTION_UNIMPLEMENTED
;

378 
po¡li¡s
.
	`š£¹
(
	`make_·œ
(
	`¡ršg
(), 
	`InMemÜyT”m
()));

379 
	}
}

381 
	gInMemÜyD©aba£
::~
	$InMemÜyD©aba£
()

383 
	`dtÜ_ÿÎed
();

384 
	}
}

387 
	gInMemÜyD©aba£
::
	$»İ’
()

389 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

390 
	}
}

393 
	gInMemÜyD©aba£
::
	$şo£
()

396 
po¡li¡s
.
	`ş—r
();

397 
‹rmli¡s
.
	`ş—r
();

398 
doşi¡s
.
	`ş—r
();

399 
v®u–i¡s
.
	`ş—r
();

400 
v®ue¡©s
.
	`ş—r
();

401 
doş’gths
.
	`ş—r
();

402 
m‘ad©a
.
	`ş—r
();

403 
şo£d
 = 
Œue
;

404 
	}
}

406 
L—fPo¡Li¡
 *

407 
	gInMemÜyD©aba£
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const

409 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

410 ià(
Šame
.
	`em±y
()) {

411 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
	`±¹Ùhis
(
this
);

412  
Ãw
 
	`InMemÜyAÎDocsPo¡Li¡
(
±¹Ùhis
);

414 
m­
<
¡ršg
, 
InMemÜyT”m
>::
cÚ¡_™”©Ü
 
i
 = 
po¡li¡s
.
	`fšd
(
Šame
);

415 ià(
i
 =ğ
po¡li¡s
.
	`’d
(è|| i->
£cÚd
.
‹rm_äeq
 == 0) {

416 
i
 = 
po¡li¡s
.
	`begš
();

418 
	`As£¹
(
i
->
fœ¡
.
	`em±y
());

420 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
	`±¹Ùhis
(
this
);

421  
Ãw
 
	`InMemÜyPo¡Li¡
(
±¹Ùhis
, 
i
->
£cÚd
, 
Šame
);

422 
	}
}

424 
boŞ


425 
	gInMemÜyD©aba£
::
doc_exi¡s
(
X­Ÿn
::
docid
 
did
) const

427 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

428  (
	gdid
 > 0 && did <ğ
‹rmli¡s
.
size
(è&&”mli¡s[
did
 - 1].
is_v®id
);

431 
	gX­Ÿn
::
doccouÁ


432 
InMemÜyD©aba£
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

434 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

435 
m­
<
¡ršg
, 
InMemÜyT”m
>::
cÚ¡_™”©Ü
 
i
 = 
po¡li¡s
.
	`fšd
(
Šame
);

436 ià(
i
 =ğ
po¡li¡s
.
	`’d
())  0;

437  
i
->
£cÚd
.
‹rm_äeq
;

438 
	}
}

440 
	gX­Ÿn
::
‹rmcouÁ


441 
InMemÜyD©aba£
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 &
Šame
) const

443 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

444 
m­
<
¡ršg
, 
InMemÜyT”m
>::
cÚ¡_™”©Ü
 
i
 = 
po¡li¡s
.
	`fšd
(
Šame
);

445 ià(
i
 =ğ
po¡li¡s
.
	`’d
())  0;

446  
i
->
£cÚd
.
cŞËùiÚ_äeq
;

447 
	}
}

449 
	gX­Ÿn
::
doccouÁ


450 
InMemÜyD©aba£
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

452 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

453 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
 = 
v®ue¡©s
.
fšd
(
¦Ù
);

454 ià(
	gi
 =ğ
v®ue¡©s
.
’d
())  0;

455  
	gi
->
	g£cÚd
.
	gäeq
;

458 
	g¡d
::
¡ršg


459 
InMemÜyD©aba£
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

461 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

462 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
 = 
v®ue¡©s
.
fšd
(
¦Ù
);

463 ià(
	gi
 =ğ
v®ue¡©s
.
’d
()è 
¡ršg
();

464  
	gi
->
	g£cÚd
.
	glow”_bound
;

467 
	g¡d
::
¡ršg


468 
InMemÜyD©aba£
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

470 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

471 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
cÚ¡_™”©Ü
 
i
 = 
v®ue¡©s
.
fšd
(
¦Ù
);

472 ià(
	gi
 =ğ
v®ue¡©s
.
’d
()è 
¡ršg
();

473  
	gi
->
	g£cÚd
.
	guµ”_bound
;

476 
	gX­Ÿn
::
doccouÁ


477 
InMemÜyD©aba£
::
	$g‘_doccouÁ
() const

479 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

480  
tÙdocs
;

481 
	}
}

483 
	gX­Ÿn
::
docid


484 
InMemÜyD©aba£
::
	$g‘_Ï¡docid
() const

486 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

487  
‹rmli¡s
.
	`size
();

488 
	}
}

490 
tÙËn_t


491 
	gInMemÜyD©aba£
::
	$g‘_tÙ®_Ëngth
() const

493  
tÙËn
;

494 
	}
}

496 
	gX­Ÿn
::
doş’gth


497 
InMemÜyD©aba£
::
	$g‘_avËngth
() const

499 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

500 ià(
tÙdocs
 == 0)  0;

501  
X­Ÿn
::
	`doş’gth
(
tÙËn
è/ 
tÙdocs
;

502 
	}
}

504 
	gX­Ÿn
::
‹rmcouÁ


505 
InMemÜyD©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

507 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

508 ià(!
doc_exi¡s
(
did
)) {

509 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
(
¡ršg
("Docid "è+ 
om_to¡ršg
(
did
) +

510 
¡ršg
("‚ot found"));

512  
	gdoş’gths
[
did
 - 1];

515 
T”mLi¡
 *

516 
	gInMemÜyD©aba£
::
İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const

518 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

519 
As£¹
(
did
 != 0);

520 ià(!
doc_exi¡s
(
did
)) {

522 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
(
¡ršg
("Docid "è+ 
om_to¡ršg
(
did
) +

523 
¡ršg
("‚ot found"));

525  
Ãw
 
InMemÜyT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
>(
this
), 
did
,

526 
‹rmli¡s
[
did
 - 1], 
doş’gths
[did - 1]);

529 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

530 
InMemÜyD©aba£
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const

532 ià(
	gşo£d
è
	gInMemÜyD©aba£
::
throw_d©aba£_şo£d
();

533 
As£¹
(
did
 != 0);

534 ià(!
doc_exi¡s
(
did
)) {

535 ià(
	gÏzy
è 
	gNULL
;

537 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
(
¡ršg
("Docid "è+ 
om_to¡ršg
(
did
) +

538 
¡ršg
("‚ot found"));

540  
Ãw
 
InMemÜyDocum’t
(
this
, 
did
);

543 
	g¡d
::
¡ršg


544 
InMemÜyD©aba£
::
g‘_m‘ad©a
(cÚ¡ 
¡d
::
¡ršg
 & 
key
) const

546 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

547 
	gm­
<
	g¡ršg
, sŒšg>::
cÚ¡_™”©Ü
 
i
 = 
m‘ad©a
.
fšd
(
key
);

548 ià(
	gi
 =ğ
m‘ad©a
.
’d
())

549  
¡ršg
();

550  
	gi
->
	g£cÚd
;

553 
T”mLi¡
 *

554 
	gInMemÜyD©aba£
::
	$İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡ršg
 &) const

556 ià(
m‘ad©a
.
	`em±y
()è 
NULL
;

558 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("InMemory backend doesn't currently implement Database::metadata_keys_begin()");

559 
	}
}

562 
	gInMemÜyD©aba£
::
£t_m‘ad©a
(cÚ¡ 
¡d
::
¡ršg
 & 
key
,

563 cÚ¡ 
¡d
::
¡ršg
 & 
v®ue
)

565 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

566 ià(!
	gv®ue
.
em±y
()) {

567 
	gm‘ad©a
[
key
] = 
v®ue
;

569 
	gm‘ad©a
.
”a£
(
key
);

573 
	gX­Ÿn
::
‹rmcouÁ


574 
InMemÜyD©aba£
::
pos™iÚli¡_couÁ
(
X­Ÿn
::
docid
 
did
,

575 cÚ¡ 
¡ršg
 & 
Šame
) const

577 ià(
	gşo£d
è
	gInMemÜyD©aba£
::
throw_d©aba£_şo£d
();

578 ià(!
doc_exi¡s
(
did
)) {

581 cÚ¡ 
	gInMemÜyDoc
 &
	gdoc
 = 
‹rmli¡s
[
did
-1];

583 
	gveùÜ
<
	gInMemÜyT”mEÁry
>::
cÚ¡_™”©Ü
 
i
;

584 
	gi
 = 
doc
.
‹rms
.
begš
(); i !ğdoc.‹rms.
’d
(); ++i) {

585 ià(
	gi
->
	gŠame
 =ğ
Šame
) {

586  
i
->
pos™iÚs
.
size
();

592 
Pos™iÚLi¡
 *

593 
	gInMemÜyD©aba£
::
İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
,

594 cÚ¡ 
¡ršg
 & 
Šame
) const

596 ià(
	gşo£d
è
	gInMemÜyD©aba£
::
throw_d©aba£_şo£d
();

597 ià(
usu®
(
doc_exi¡s
(
did
))) {

598 cÚ¡ 
	gInMemÜyDoc
 &
	gdoc
 = 
‹rmli¡s
[
did
-1];

600 
	gveùÜ
<
	gInMemÜyT”mEÁry
>::
cÚ¡_™”©Ü
 
i
;

601 
	gi
 = 
doc
.
‹rms
.
begš
(); i !ğdoc.‹rms.
’d
(); ++i) {

602 ià(
	gi
->
	gŠame
 =ğ
Šame
) {

603  
Ãw
 
InMemÜyPos™iÚLi¡
(
i
->
pos™iÚs
);

607  
Ãw
 
InMemÜyPos™iÚLi¡
(
çl£
);

611 
	gInMemÜyD©aba£
::
add_v®ues
(
X­Ÿn
::
docid
 
did
,

612 cÚ¡ 
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> &
v®ues_
)

614 ià(
	gşo£d
è
	gInMemÜyD©aba£
::
throw_d©aba£_şo£d
();

615 ià(
	gdid
 > 
	gv®u–i¡s
.
size
()) {

616 
	gv®u–i¡s
.
»size
(
did
);

618 
	gv®u–i¡s
[
did
-1] = 
v®ues_
;

621 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	g¡ršg
>::
cÚ¡_™”©Ü
 
j
;

622 
	gj
 = 
v®ues_
.
begš
(); j !ğv®ues_.
’d
(); ++j) {

623 
	g¡d
::
·œ
<
m­
<
X­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
™”©Ü
, 
	gboŞ
> 
	gi
;

624 
	gi
 = 
v®ue¡©s
.
š£¹
(
make_·œ
(
j
->
fœ¡
, 
V®ueSts
()));

627 ià((
	gi
.
	gfœ¡
->
	g£cÚd
.
	gäeq
)++ == 0) {

630 
i
.
fœ¡
->
£cÚd
.
low”_bound
 = 
j
->second;

631 
	gi
.
	gfœ¡
->
	g£cÚd
.
	guµ”_bound
 = 
j
->
£cÚd
;

634 ià(
	gj
->
	g£cÚd
 < 
	gi
.
	gfœ¡
->£cÚd.
	glow”_bound
) {

635 
	gi
.
	gfœ¡
->
	g£cÚd
.
	glow”_bound
 = 
j
->
£cÚd
;

637 ià(
	gj
->
	g£cÚd
 > 
	gi
.
	gfœ¡
->£cÚd.
	guµ”_bound
) {

638 
	gi
.
	gfœ¡
->
	g£cÚd
.
	guµ”_bound
 = 
j
->
£cÚd
;

646 
	gInMemÜyD©aba£
::
	$comm™
()

648 
	}
}

652 
InMemÜyD©aba£
::
	$ÿnûl
()

654 
	}
}

657 
InMemÜyD©aba£
::
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
)

659 ià(
şo£d
è
InMemÜyD©aba£
::
throw_d©aba£_şo£d
();

660 ià(!
doc_exi¡s
(
did
)) {

661 
throw
 
	gX­Ÿn
::
DocNÙFoundE¼Ü
(
¡ršg
("Docid "è+ 
om_to¡ršg
(
did
) +

662 
¡ršg
("‚ot found"));

664 
	g‹rmli¡s
[
did
-1].
	gis_v®id
 = 
çl£
;

665 
	gdoşi¡s
[
did
-1] = "";

666 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	g¡ršg
>::
cÚ¡_™”©Ü
 
j
;

667 
	gj
 = 
v®u–i¡s
[
did
-1].
begš
(); j !ğv®u–i¡s[did-1].
’d
(); ++j) {

668 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
™”©Ü
 
i
;

669 
	gi
 = 
v®ue¡©s
.
fšd
(
j
->
fœ¡
);

670 ià(--(
	gi
->
	g£cÚd
.
	gäeq
) == 0) {

671 
i
->
£cÚd
.
low”_bound
.
»size
(0);

672 
	gi
->
	g£cÚd
.
	guµ”_bound
.
»size
(0);

675 
	gv®u–i¡s
[
did
-1].
ş—r
();

677 
	gtÙËn
 -ğ
doş’gths
[
did
-1];

678 
	gdoş’gths
[
did
-1] = 0;

679 
	gtÙdocs
--;

682 ià(
	gtÙdocs
 =ğ0è
pos™iÚs_´e£Á
 = 
çl£
;

684 
	gveùÜ
<
	gInMemÜyT”mEÁry
>::
cÚ¡_™”©Ü
 
i
;

685 
	gi
 = 
‹rmli¡s
[
did
 - 1].
‹rms
.
begš
();

686 
	gi
 !ğ
‹rmli¡s
[
did
 - 1].
‹rms
.
’d
();

687 ++
	gi
) {

688 
	gm­
<
	g¡ršg
, 
	gInMemÜyT”m
>::
™”©Ü
 
t
 = 
po¡li¡s
.
fšd
(
i
->
Šame
);

689 
As£¹
(
t
 !ğ
po¡li¡s
.
’d
());

690 
	gt
->
	g£cÚd
.
	gcŞËùiÚ_äeq
 -ğ
i
->
wdf
;

691 --
	gt
->
	g£cÚd
.
	g‹rm_äeq
;

692 
	gveùÜ
<
	gInMemÜyPo¡šg
>::
™”©Ü
 
po¡šg
 = 
t
->
£cÚd
.
docs
.
begš
();

693 
	gpo¡šg
 !ğ
t
->
£cÚd
.
docs
.
’d
()) {

697 ià(
po¡šg
->
did
 =ğdidèpo¡šg->
v®id
 = 
çl£
;

698 ++
	gpo¡šg
;

701 
	g‹rmli¡s
[
did
-1].
	g‹rms
.
ş—r
();

705 
	gInMemÜyD©aba£
::
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

706 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

708 
DEBUGCALL
(
DB
, , "InMemÜyD©aba£::»¶aû_docum’t", 
did
 << ", " << 
docum’t
);

710 ià(
	gşo£d
è
	gInMemÜyD©aba£
::
throw_d©aba£_şo£d
();

712 ià(
doc_exi¡s
(
did
)) {

713 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	g¡ršg
>::
cÚ¡_™”©Ü
 
j
;

714 
	gj
 = 
v®u–i¡s
[
did
-1].
begš
(); j !ğv®u–i¡s[did-1].
’d
(); ++j) {

715 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueSts
>::
™”©Ü
 
i
;

716 
	gi
 = 
v®ue¡©s
.
fšd
(
j
->
fœ¡
);

717 ià(--(
	gi
->
	g£cÚd
.
	gäeq
) == 0) {

718 
i
->
£cÚd
.
low”_bound
.
»size
(0);

719 
	gi
->
	g£cÚd
.
	guµ”_bound
.
»size
(0);

723 
	gtÙËn
 -ğ
doş’gths
[
did
 - 1];

724 
	gtÙdocs
--;

725 } ià(
	gdid
 > 
	g‹rmli¡s
.
size
()) {

726 
	g‹rmli¡s
.
»size
(
did
);

727 
	g‹rmli¡s
[
did
 - 1].
	gis_v®id
 = 
Œue
;

728 
	gdoş’gths
.
»size
(
did
);

729 
	gdoşi¡s
.
»size
(
did
);

730 
	gv®u–i¡s
.
»size
(
did
);

732 
	g‹rmli¡s
[
did
 - 1].
	gis_v®id
 = 
Œue
;

735 
	gveùÜ
<
	gInMemÜyT”mEÁry
>::
cÚ¡_™”©Ü
 
i
;

736 
	gi
 = 
‹rmli¡s
[
did
 - 1].
‹rms
.
begš
();

737 
	gi
 !ğ
‹rmli¡s
[
did
 - 1].
‹rms
.
’d
();

738 ++
	gi
) {

739 
	gm­
<
	g¡ršg
, 
	gInMemÜyT”m
>::
™”©Ü
 
t
 = 
po¡li¡s
.
fšd
(
i
->
Šame
);

740 
As£¹
(
t
 !ğ
po¡li¡s
.
’d
());

741 
	gt
->
	g£cÚd
.
	gcŞËùiÚ_äeq
 -ğ
i
->
wdf
;

742 --
	gt
->
	g£cÚd
.
	g‹rm_äeq
;

743 
	gveùÜ
<
	gInMemÜyPo¡šg
>::
™”©Ü
 
po¡šg
 = 
t
->
£cÚd
.
docs
.
begš
();

744 
	gpo¡šg
 !ğ
t
->
£cÚd
.
docs
.
’d
()) {

748 ià(
po¡šg
->
did
 =ğdidèpo¡šg->
v®id
 = 
çl£
;

749 ++
	gpo¡šg
;

753 
	gdoş’gths
[
did
 - 1] = 0;

754 
	gdoşi¡s
[
did
 - 1] = 
docum’t
.
g‘_d©a
();

756 
fšish_add_doc
(
did
, 
docum’t
);

759 
	gX­Ÿn
::
docid


760 
InMemÜyD©aba£
::
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
)

762 
DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "InMemÜyD©aba£::add_docum’t", 
docum’t
);

763 ià(
	gşo£d
è
	gInMemÜyD©aba£
::
throw_d©aba£_şo£d
();

765 
	gX­Ÿn
::
docid
 
did
 = 
make_doc
(
docum’t
.
g‘_d©a
());

767 
fšish_add_doc
(
did
, 
docum’t
);

769 
RETURN
(
did
);

773 
	gInMemÜyD©aba£
::
fšish_add_doc
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 &
docum’t
)

776 
m­
<
X­Ÿn
::
v®u’o
, 
	g¡ršg
> 
	gv®ues
;

777 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
k
 = 
docum’t
.
v®ues_begš
();

778  ; 
	gk
 !ğ
docum’t
.
v®ues_’d
(); ++k) {

779 
	gv®ues
.
š£¹
(
make_·œ
(
k
.
g‘_v®u’o
(), *k));

780 
LOGLINE
(
DB
, "InMemoryDatabase::finish_add_doc():‡dding value " <<

781 
k
.
g‘_v®u’o
() << " -> " << *k);

783 
add_v®ues
(
did
, 
v®ues
);

786 
InMemÜyDoc
 
doc
(
Œue
);

787 
	gX­Ÿn
::
T”mI‹¿tÜ
 
i
 = 
docum’t
.
‹rmli¡_begš
();

788 
	gX­Ÿn
::
T”mI‹¿tÜ
 
i_’d
 = 
docum’t
.
‹rmli¡_’d
();

789  ; 
	gi
 !ğ
i_’d
; ++i) {

790 
make_‹rm
(*
i
);

792 
LOGLINE
(
DB
, "InMemÜyD©aba£::fšish_add_doc():‡ddšg”m " << *
i
);

793 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
j
 = 
i
.
pos™iÚli¡_begš
();

794 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
j_’d
 = 
i
.
pos™iÚli¡_’d
();

796 ià(
	gj
 =ğ
j_’d
) {

798 
make_po¡šg
(&
doc
, *
i
, 
did
, 0, i.
g‘_wdf
(), 
çl£
);

800 
	gpos™iÚs_´e£Á
 = 
Œue
;

801  ; 
	gj
 !ğ
j_’d
; ++j) {

802 
make_po¡šg
(&
doc
, *
i
, 
did
, *
j
, i.
g‘_wdf
());

806 
As£¹
(
did
 > 0 && did <ğ
doş’gths
.
size
());

807 
	gdoş’gths
[
did
 - 1] +ğ
i
.
g‘_wdf
();

808 
	gtÙËn
 +ğ
i
.
g‘_wdf
();

809 
	gpo¡li¡s
[*
i
].
	gcŞËùiÚ_äeq
 +ği.
g‘_wdf
();

810 ++
	gpo¡li¡s
[*
i
].
	g‹rm_äeq
;

812 
sw­
(
‹rmli¡s
[
did
 - 1], 
doc
);

814 
	gtÙdocs
++;

818 
	gInMemÜyD©aba£
::
	$make_‹rm
(cÚ¡ 
¡ršg
 & 
Šame
)

820 
po¡li¡s
[
Šame
];

821 
	}
}

823 
	gX­Ÿn
::
docid


824 
InMemÜyD©aba£
::
	$make_doc
(cÚ¡ 
¡ršg
 & 
docd©a
)

826 
‹rmli¡s
.
	`push_back
(
	`InMemÜyDoc
(
Œue
));

827 
doş’gths
.
	`push_back
(0);

828 
doşi¡s
.
	`push_back
(
docd©a
);

830 
	`As£¹EqP¬ªoid
(
‹rmli¡s
.
	`size
(), 
doş’gths
.size());

832  
‹rmli¡s
.
	`size
();

833 
	}
}

835 
	gInMemÜyD©aba£
::
make_po¡šg
(
InMemÜyDoc
 * 
doc
,

836 cÚ¡ 
¡ršg
 & 
Šame
,

837 
X­Ÿn
::
docid
 
did
,

838 
X­Ÿn
::
‹rmpos
 
pos™iÚ
,

839 
X­Ÿn
::
‹rmcouÁ
 
wdf
,

840 
boŞ
 
u£_pos™iÚ
)

842 
As£¹
(
doc
);

843 
As£¹
(
po¡li¡s
.
fšd
(
Šame
è!ğpo¡li¡s.
’d
());

844 
As£¹
(
did
 > 0 && did <ğ
‹rmli¡s
.
size
());

845 
As£¹
(
did
 > 0 && did <ğ
doş’gths
.
size
());

846 
As£¹
(
doc_exi¡s
(
did
));

849 
InMemÜyPo¡šg
 
	gpo¡šg
;

850 
	gpo¡šg
.
	gdid
 = 
did
;

851 ià(
	gu£_pos™iÚ
) {

852 
	gpo¡šg
.
	gpos™iÚs
.
push_back
(
pos™iÚ
);

854 
	gpo¡šg
.
	gwdf
 = 
wdf
;

855 
	gpo¡šg
.
	gv®id
 = 
Œue
;

858 
	gpo¡li¡s
[
Šame
].
add_po¡šg
(
po¡šg
);

861 
InMemÜyT”mEÁry
 
	g‹rm’Œy
;

862 
	g‹rm’Œy
.
	gŠame
 = 
Šame
;

863 ià(
	gu£_pos™iÚ
) {

864 
	g‹rm’Œy
.
	gpos™iÚs
.
push_back
(
pos™iÚ
);

866 
	g‹rm’Œy
.
	gwdf
 = 
wdf
;

869 
	gdoc
->
add_po¡šg
(
‹rm’Œy
);

872 
boŞ


873 
	gInMemÜyD©aba£
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const

875 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

876 
	`As£¹
(!
Šame
.
	`em±y
());

877 
m­
<
¡ršg
, 
InMemÜyT”m
>::
cÚ¡_™”©Ü
 
i
 = 
po¡li¡s
.
	`fšd
(
Šame
);

878 ià(
i
 =ğ
po¡li¡s
.
	`’d
()è 
çl£
;

879  (
i
->
£cÚd
.
‹rm_äeq
 != 0);

880 
	}
}

882 
boŞ


883 
	gInMemÜyD©aba£
::
	$has_pos™iÚs
() const

885 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

886  
pos™iÚs_´e£Á
;

887 
	}
}

889 
T”mLi¡
 *

890 
	gInMemÜyD©aba£
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const

892 ià(
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

893  
Ãw
 
	`InMemÜyAÎT”msLi¡
(&
po¡li¡s
,

894 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
>(
this
),

895 
´efix
);

896 
	}
}

899 
	gInMemÜyD©aba£
::
	$throw_d©aba£_şo£d
()

901 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

902 
	}
}

	@backends/inmemory/inmemory_database.h

24 #iâdeà
OM_HGUARD_INMEMORY_DATABASE_H


25 
	#OM_HGUARD_INMEMORY_DATABASE_H


	)

27 
	~"Ëaåo¡li¡.h
"

28 
	~"‹rmli¡.h
"

29 
	~"d©aba£.h
"

30 
	~<m­
>

31 
	~<veùÜ
>

32 
	~<®gÜ™hm
>

33 
	~<x­Ÿn/docum’t.h
>

34 
	~"šmemÜy_pos™iÚli¡.h
"

35 
	~"š‹º®ty³s.h
"

36 
	~"omas£¹.h
"

37 
	~"nÜ‘uº.h
"

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
şass
 
	gV®ueSts
;

45 şas 
	cInMemÜyPo¡šg
 {

46 
	mpublic
:

47 
X­Ÿn
::
docid
 
did
;

48 
boŞ
 
	mv®id
;

49 
	mveùÜ
<
	mX­Ÿn
::
‹rmpos
> 
pos™iÚs
;

50 
	mX­Ÿn
::
‹rmcouÁ
 
wdf
;

53 
	$m”ge
(cÚ¡ 
InMemÜyPo¡šg
 & 
po¡
) {

54 
	`As£¹
(
did
 =ğ
po¡
.did);

56 
pos™iÚs
.
	`š£¹
Õos™iÚs.
	`’d
(),

57 
po¡
.
pos™iÚs
.
	`begš
(),

58 
po¡
.
pos™iÚs
.
	`’d
());

60 
	`sÜt
(
pos™iÚs
.
	`begš
(),…os™iÚs.
	`’d
());

62 
	}
};

64 şas 
	cInMemÜyT”mEÁry
 {

65 
	mpublic
:

66 
¡ršg
 
Šame
;

67 
	mveùÜ
<
	mX­Ÿn
::
‹rmpos
> 
pos™iÚs
;

68 
	mX­Ÿn
::
‹rmcouÁ
 
wdf
;

71 
	$m”ge
(cÚ¡ 
InMemÜyT”mEÁry
 & 
po¡
) {

72 
	`As£¹
(
Šame
 =ğ
po¡
.tname);

74 
pos™iÚs
.
	`š£¹
Õos™iÚs.
	`’d
(),

75 
po¡
.
pos™iÚs
.
	`begš
(),

76 
po¡
.
pos™iÚs
.
	`’d
());

78 
	`sÜt
(
pos™iÚs
.
	`begš
(),…os™iÚs.
	`’d
());

80 
	}
};

83 şas 
	cInMemÜyPo¡šgLessThª
 {

84 
	mpublic
:

85 
	$İ”©Ü
(è(cÚ¡ 
InMemÜyPo¡šg
 &
p1
, cÚ¡ InMemÜyPo¡šg &
p2
)

87  
p1
.
did
 < 
p2
.did;

89 
	}
};

92 şas 
	cInMemÜyT”mEÁryLessThª
 {

93 
	mpublic
:

94 
	$İ”©Ü
(è(cÚ¡ 
InMemÜyT”mEÁry
&
p1
, cÚ¡ InMemÜyT”mEÁry&
p2
)

96  
p1
.
Šame
 < 
p2
.tname;

98 
	}
};

101 şas 
	cInMemÜyT”m
 {

102 
	mpublic
:

104 
veùÜ
<
InMemÜyPo¡šg
> 
docs
;

106 
	mX­Ÿn
::
‹rmcouÁ
 
‹rm_äeq
;

107 
	mX­Ÿn
::
‹rmcouÁ
 
cŞËùiÚ_äeq
;

109 
	$InMemÜyT”m
(è: 
	`‹rm_äeq
(0), 
	$cŞËùiÚ_äeq
(0) {}

111 
	`add_po¡šg
(cÚ¡ 
InMemÜyPo¡šg
 & 
po¡
);

112 
	}
};

115 şas 
	cInMemÜyDoc
 {

116 
	mpublic
:

117 
boŞ
 
is_v®id
;

119 
	mveùÜ
<
	mInMemÜyT”mEÁry
> 
	m‹rms
;

123 
	$InMemÜyDoc
(è: 
	$is_v®id
(
çl£
) {}

126 
	$InMemÜyDoc
(
boŞ
 
is_v®id_
è: 
	$is_v®id
(
is_v®id_
è{
	}
}

128 
add_po¡šg
(cÚ¡ 
InMemÜyT”mEÁry
 & 
po¡
);

131 
şass
 
	gInMemÜyD©aba£
;

135 şas 
	cInMemÜyPo¡Li¡
 : 
public
 
L—fPo¡Li¡
 {

136 
ä›nd
 
şass
 
InMemÜyD©aba£
;

137 
	m´iv©e
:

138 
veùÜ
<
InMemÜyPo¡šg
>::
cÚ¡_™”©Ü
 
pos
;

139 
	mveùÜ
<
	mInMemÜyPo¡šg
>::
cÚ¡_™”©Ü
 
’d
;

140 
	mX­Ÿn
::
doccouÁ
 
‹rmäeq
;

141 
boŞ
 
	m¡¬‹d
;

146 
InMemÜyPos™iÚLi¡
 
	mmypos™iÚs
;

148 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db
;

150 
InMemÜyPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db
,

151 cÚ¡ 
InMemÜyT”m
 & 
im‹rm
, cÚ¡ 
¡d
::
¡ršg
 & 
‹rm_
);

152 
	mpublic
:

153 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

155 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

156 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

157 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

158 
Pos™iÚLi¡
 * 
	`»ad_pos™iÚ_li¡
();

159 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

161 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

163 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

166 
boŞ
 
	$©_’d
() const;

168 
¡ršg
 
	$g‘_desütiÚ
() const;

173 şas 
	cInMemÜyAÎDocsPo¡Li¡
 : 
public
 
L—fPo¡Li¡
 {

174 
ä›nd
 
şass
 
InMemÜyD©aba£
;

175 
´iv©e
:

176 
X­Ÿn
::
docid
 
did
;

178 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db
;

180 
	`InMemÜyAÎDocsPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db
);

181 
public
:

182 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

184 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

185 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

186 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

187 
Pos™iÚLi¡
 * 
	`»ad_pos™iÚ_li¡
();

188 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

190 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

192 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

195 
boŞ
 
	$©_’d
() const;

197 
¡ršg
 
	$g‘_desütiÚ
() const;

201 şas 
	cInMemÜyT”mLi¡
 : 
public
 
T”mLi¡
 {

202 
ä›nd
 
şass
 
InMemÜyD©aba£
;

203 
´iv©e
:

204 
veùÜ
<
InMemÜyT”mEÁry
>::
cÚ¡_™”©Ü
 
pos
;

205 
veùÜ
<
InMemÜyT”mEÁry
>::
cÚ¡_™”©Ü
 
’d
;

206 
X­Ÿn
::
‹rmcouÁ
 
‹rms
;

207 
boŞ
 
¡¬‹d
;

209 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db
;

210 
X­Ÿn
::
docid
 
did
;

211 
X­Ÿn
::
‹rmcouÁ
 
docum’t_Ëngth
;

213 
	`InMemÜyT”mLi¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
InMemÜyD©aba£
> 
db
,

214 
X­Ÿn
::
docid
 
did
,

215 cÚ¡ 
InMemÜyDoc
 & 
doc
,

216 
X­Ÿn
::
‹rmcouÁ
 
Ën
);

217 
public
:

218 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

221 
	`accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const;

223 
¡ršg
 
	$g‘_‹rmÇme
() const;

224 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

225 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

226 
T”mLi¡
 * 
	`Ãxt
();

227 
boŞ
 
	$©_’d
() const;

228 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

229 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

232 
şass
 
InMemÜyDocum’t
;

238 şas 
	cInMemÜyD©aba£
 : 
public
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 {

239 
ä›nd
 
şass
 
InMemÜyAÎDocsPo¡Li¡
;

240 
ä›nd
 
şass
 
InMemÜyDocum’t
;

242 
m­
<
¡ršg
, 
InMemÜyT”m
> 
po¡li¡s
;

243 
veùÜ
<
InMemÜyDoc
> 
‹rmli¡s
;

244 
veùÜ
<
¡d
::
¡ršg
> 
doşi¡s
;

245 
veùÜ
<
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> > 
v®u–i¡s
;

246 
¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
V®ueSts
> 
v®ue¡©s
;

248 
veùÜ
<
X­Ÿn
::
‹rmcouÁ
> 
doş’gths
;

250 
¡d
::
m­
<
¡ršg
, sŒšg> 
m‘ad©a
;

252 
X­Ÿn
::
doccouÁ
 
tÙdocs
;

254 
tÙËn_t
 
tÙËn
;

256 
boŞ
 
pos™iÚs_´e£Á
;

259 
boŞ
 
şo£d
;

262 
InMemÜyD©aba£
& 
İ”©Ü
=(const InMemoryDatabase &);

263 
	`InMemÜyD©aba£
(cÚ¡ 
InMemÜyD©aba£
 &);

265 
	`make_‹rm
(cÚ¡ 
¡ršg
 & 
Šame
);

267 
boŞ
 
	`doc_exi¡s
(
X­Ÿn
::
docid
 
did
) const;

268 
X­Ÿn
::
docid
 
	`make_doc
(cÚ¡ 
¡ršg
 & 
docd©a
);

271 
	`fšish_add_doc
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 &
docum’t
);

272 
	`add_v®ues
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
m­
<X­Ÿn::
v®u’o
, 
¡ršg
> &
v®ues_
);

274 
	`make_po¡šg
(
InMemÜyDoc
 * 
doc
,

275 cÚ¡ 
¡ršg
 & 
Šame
,

276 
X­Ÿn
::
docid
 
did
,

277 
X­Ÿn
::
‹rmpos
 
pos™iÚ
,

278 
X­Ÿn
::
‹rmcouÁ
 
wdf
,

279 
boŞ
 
u£_pos™iÚ
 = 
Œue
);

284 
	`comm™
();

285 
	`ÿnûl
();

287 
X­Ÿn
::
docid
 
	`add_docum’t
(cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

293 #iâdeà
_MSC_VER


294 
usšg
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
::
d–‘e_docum’t
;

295 
usšg
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
::
»¶aû_docum’t
;

297 
	`d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
);

298 
	`»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
docum’t
);

301 
public
:

306 
	`InMemÜyD©aba£
();

308 ~
	`InMemÜyD©aba£
();

310 
	`»İ’
();

311 
	`şo£
();

312 
boŞ
 
	$is_şo£d
(ècÚ¡ {  
şo£d
; }

314 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

316 
X­Ÿn
::
docid
 
	$g‘_Ï¡docid
() const;

318 
tÙËn_t
 
	$g‘_tÙ®_Ëngth
() const;

319 
X­Ÿn
::
doş’gth
 
	$g‘_avËngth
() const;

320 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

322 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

323 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

324 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
¦Ù
) const;

325 
¡d
::
¡ršg
 
	`g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

326 
¡d
::
¡ršg
 
	`g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

327 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

328 
boŞ
 
	$has_pos™iÚs
() const;

330 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

331 
T”mLi¡
 * 
	`İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const;

332 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`İ’_docum’t
(X­Ÿn::
docid
 
did
, 
boŞ
 
Ïzy
) const;

334 
¡d
::
¡ršg
 
	`g‘_m‘ad©a
(cÚ¡ std::¡ršg & 
key
) const;

335 
T”mLi¡
 * 
	`İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const;

336 
	`£t_m‘ad©a
(cÚ¡ 
¡d
::
¡ršg
 & 
key
, cÚ¡ std::¡ršg & 
v®ue
);

338 
X­Ÿn
::
‹rmcouÁ
 
	`pos™iÚli¡_couÁ
(X­Ÿn::
docid
 
did
,

339 cÚ¡ 
¡ršg
 & 
Šame
) const;

340 
Pos™iÚLi¡
 * 
	`İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
,

341 cÚ¡ 
¡ršg
 & 
Šame
) const;

342 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

344 
	`XAPIAN_NORETURN
(
	`throw_d©aba£_şo£d
());

345 
	}
};

	@backends/inmemory/inmemory_document.cc

21 
	~<cÚfig.h
>

23 
	~"šmemÜy_docum’t.h
"

25 
	~"šmemÜy_d©aba£.h
"

27 
	~"debuglog.h
"

29 
¡ršg


30 
	gInMemÜyDocum’t
::
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

32 
LOGCALL
(
DB
, 
¡ršg
, "InMemÜyDocum’t::do_g‘_v®ue", 
¦Ù
);

33 cÚ¡ 
InMemÜyD©aba£
 * 
	gdb
;

34 
	gdb
 = 
¡©ic_ÿ¡
<cÚ¡ 
InMemÜyD©aba£
*>(
d©aba£
.
g‘
());

35 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	g¡ršg
> 
	gv®ues_
 = 
db
->
v®u–i¡s
[
did
 - 1];

36 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
;

37 
	gi
 = 
v®ues_
.
fšd
(
¦Ù
);

38 ià(
	gi
 =ğ
v®ues_
.
’d
())

39 
RETURN
(
¡ršg
());

40 
RETURN
(
i
->
£cÚd
);

44 
	gInMemÜyDocum’t
::
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> &
v®ues_
) const

46 
LOGCALL_VOID
(
DB
, "InMemoryDocument::do_get_all_values", "[&values_]");

47 cÚ¡ 
InMemÜyD©aba£
 * 
	gdb
;

48 
	gdb
 = 
¡©ic_ÿ¡
<cÚ¡ 
InMemÜyD©aba£
*>(
d©aba£
.
g‘
());

49 ià(
	gdb
->
	gşo£d
è
	gInMemÜyD©aba£
::
throw_d©aba£_şo£d
();

50 
	gv®ues_
 = 
db
->
v®u–i¡s
[
did
 - 1];

53 
¡ršg


54 
	gInMemÜyDocum’t
::
	$do_g‘_d©a
() const

56 
	`LOGCALL
(
DB
, 
¡ršg
, "InMemoryDocument::do_get_data", "");

57 cÚ¡ 
InMemÜyD©aba£
 * 
db
;

58 
db
 = 
¡©ic_ÿ¡
<cÚ¡ 
InMemÜyD©aba£
*>(
d©aba£
.
	`g‘
());

59 ià(
db
->
şo£d
è
InMemÜyD©aba£
::
	`throw_d©aba£_şo£d
();

60 
	`RETURN
(
db
->
doşi¡s
[
did
 - 1]);

61 
	}
}

	@backends/inmemory/inmemory_document.h

21 #iâdeà
XAPIAN_INCLUDED_INMEMORY_DOCUMENT_H


22 
	#XAPIAN_INCLUDED_INMEMORY_DOCUMENT_H


	)

24 
	~"d©aba£.h
"

25 
	~"docum’t.h
"

28 şas 
	cInMemÜyDocum’t
 : 
public
 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 {

30 
İ”©Ü
=(cÚ¡ 
InMemÜyDocum’t
 &);

33 
InMemÜyDocum’t
(const InMemoryDocument &);

36 
ä›nd
 
şass
 
	mInMemÜyD©aba£
;

39 
InMemÜyDocum’t
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
db
, X­Ÿn::
docid
 
did_
)

40 : 
X­Ÿn
::
Docum’t
::
	$IÁ”Çl
(
db
, 
did_
) { }

42 
public
:

44 
¡ršg
 
	`do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

45 
	`do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const;

46 
¡ršg
 
	$do_g‘_d©a
() const;

48 
	}
};

	@backends/inmemory/inmemory_positionlist.cc

22 
	~<cÚfig.h
>

24 
	~"omas£¹.h
"

25 
	~"omdebug.h
"

26 
	~"šmemÜy_pos™iÚli¡.h
"

28 
	gInMemÜyPos™iÚLi¡
::
InMemÜyPos™iÚLi¡
(cÚ¡ 
OmDocum’tT”m
::
‹rm_pos™iÚs
 & 
pos™iÚs_
)

29 : 
pos™iÚs
(
pos™iÚs_
), 
mypos
Õos™iÚs.
begš
()),

30 
	$™”©šg_š_´og»ss
(
çl£
)

32 
	}
}

35 
	gInMemÜyPos™iÚLi¡
::
£t_d©a
(cÚ¡ 
OmDocum’tT”m
::
‹rm_pos™iÚs
 & 
pos™iÚs_
)

37 
pos™iÚs
 = 
pos™iÚs_
;

38 
	gmypos
 = 
pos™iÚs
.
begš
();

39 
	g™”©šg_š_´og»ss
 = 
çl£
;

42 
	gX­Ÿn
::
‹rmcouÁ


43 
InMemÜyPos™iÚLi¡
::
	$g‘_size
() const

45  
pos™iÚs
.
	`size
();

46 
	}
}

48 
	gX­Ÿn
::
‹rmpos


49 
InMemÜyPos™iÚLi¡
::
	$g‘_pos™iÚ
() const

51 
	`As£¹
(
™”©šg_š_´og»ss
);

52 
	`As£¹
(!
	`©_’d
());

53  *
mypos
;

54 
	}
}

57 
	gInMemÜyPos™iÚLi¡
::
	$Ãxt
()

59 ià(
™”©šg_š_´og»ss
) {

60 
	`As£¹
(!
	`©_’d
());

61 
mypos
++;

63 
™”©šg_š_´og»ss
 = 
Œue
;

65 
	}
}

68 
	gInMemÜyPos™iÚLi¡
::
sk_to
(
X­Ÿn
::
‹rmpos
ermpos)

70 ià(!
™”©šg_š_´og»ss
è™”©šg_š_´og»s ğ
Œue
;

71 !
©_’d
(è&& *
	gmypos
 < 
	g‹rmpos
) mypos++;

74 
boŞ


75 
	gInMemÜyPos™iÚLi¡
::
	$©_’d
() const

77 (
mypos
 =ğ
pos™iÚs
.
	`’d
());

78 
	}
}

	@backends/multi/multi_alltermslist.cc

21 
	~<cÚfig.h
>

23 
	~"muÉŸÎ‹rm¦i¡.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"omas£¹.h
"

29 
	~<®gÜ™hm
>

31 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	sCom·»T”mLi¡sByT”m
 {

36 
boŞ
 
İ”©Ü
()(cÚ¡ 
T”mLi¡
 *
	ma
, cÚ¡ T”mLi¡ *
	mb
) {

37  
	ma
->
g‘_‹rmÇme
(è> 
	mb
->get_termname();

41 
	g‹m¶©e
<
şass
 
	gCLASS
> 
	sd–‘e_±r
 {

42 
İ”©Ü
()(
CLASS
 *
	mp
è{ 
d–‘e
…; }

45 
	gMuÉiAÎT”msLi¡
::
MuÉiAÎT”msLi¡
(cÚ¡ 
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<X­Ÿn::
D©aba£
::IÁ”Çl> > & 
dbs
,

46 cÚ¡ 
¡ršg
 & 
´efix
)

49 
As£¹R–
(
dbs
.
size
(), >=, 2);

50 
	g‹rmli¡s
.
»£rve
(
dbs
.
size
());

51 
	gŒy
 {

52 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
X­Ÿn
::
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

53 
	gi
 = 
dbs
.
begš
(); i !ğdbs.
’d
(); ++i) {

54 
	g‹rmli¡s
.
push_back
((*
i
)->
İ’_®É”ms
(
´efix
));

56 } 
ÿtch
 (...) {

57 
fÜ_—ch
(
‹rmli¡s
.
begš
(),”mli¡s.
’d
(), 
d–‘e_±r
<
T”mLi¡
>());

58 
	gthrow
;

62 
	gMuÉiAÎT”msLi¡
::~
	$MuÉiAÎT”msLi¡
()

64 
	`fÜ_—ch
(
‹rmli¡s
.
	`begš
(),”mli¡s.
	`’d
(), 
d–‘e_±r
<
T”mLi¡
>());

65 
	}
}

67 
¡ršg


68 
	gMuÉiAÎT”msLi¡
::
	$g‘_‹rmÇme
() const

70  
cu¼’t_‹rm
;

71 
	}
}

73 
	gX­Ÿn
::
doccouÁ


74 
MuÉiAÎT”msLi¡
::
	$g‘_‹rmäeq
() const

76 ià(
‹rmli¡s
.
	`em±y
())  0;

77 
veùÜ
<
T”mLi¡
 *>::
cÚ¡_™”©Ü
 
i
 = 
‹rmli¡s
.
	`begš
();

78 
X­Ÿn
::
doccouÁ
 
tÙ®_tf
 = (*
i
)->
	`g‘_‹rmäeq
();

79 ++
i
 !ğ
‹rmli¡s
.
	`’d
()) {

80 ià((*
i
)->
	`g‘_‹rmÇme
(è=ğ
cu¼’t_‹rm
)

81 
tÙ®_tf
 +ğ(*
i
)->
	`g‘_‹rmäeq
();

83  
tÙ®_tf
;

84 
	}
}

86 
	gX­Ÿn
::
‹rmcouÁ


87 
MuÉiAÎT”msLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

89 ià(
‹rmli¡s
.
	`em±y
())  0;

90 
veùÜ
<
T”mLi¡
 *>::
cÚ¡_™”©Ü
 
i
 = 
‹rmli¡s
.
	`begš
();

91 
X­Ÿn
::
‹rmcouÁ
 
tÙ®_cf
 = (*
i
)->
	`g‘_cŞËùiÚ_äeq
();

92 ++
i
 !ğ
‹rmli¡s
.
	`’d
()) {

93 ià((*
i
)->
	`g‘_‹rmÇme
(è=ğ
cu¼’t_‹rm
)

94 
tÙ®_cf
 +ğ(*
i
)->
	`g‘_cŞËùiÚ_äeq
();

96  
tÙ®_cf
;

97 
	}
}

99 
T”mLi¡
 *

100 
	gMuÉiAÎT”msLi¡
::
	$Ãxt
()

102 ià(
cu¼’t_‹rm
.
	`em±y
()) {

105 
veùÜ
<
T”mLi¡
*>::
™”©Ü
 
i
 = 
‹rmli¡s
.
	`begš
();

106 
i
 !ğ
‹rmli¡s
.
	`’d
()) {

107 (*
i
)->
	`Ãxt
();

108 ià((*
i
)->
	`©_’d
()) {

109 
d–‘e
 *
i
;

110 
i
 = 
‹rmli¡s
.
	`”a£
(i);

112 ++
i
;

115 
	`make_h—p
(
‹rmli¡s
.
	`begš
(),”mli¡s.
	`’d
(),

116 
	`Com·»T”mLi¡sByT”m
());

120 
T”mLi¡
 * 

 = 
‹rmli¡s
.
	`äÚt
();

121 
	`pİ_h—p
(
‹rmli¡s
.
	`begš
(),”mli¡s.
	`’d
(),

122 
	`Com·»T”mLi¡sByT”m
());

123 

->
	`Ãxt
();

124 ià(

->
	`©_’d
()) {

125 
d–‘e
 

;

126 
‹rmli¡s
.
	`pİ_back
();

128 
‹rmli¡s
.
	`back
(èğ

;

129 
	`push_h—p
(
‹rmli¡s
.
	`begš
(),”mli¡s.
	`’d
(),

130 
	`Com·»T”mLi¡sByT”m
());

132 } !
‹rmli¡s
.
	`em±y
() &&

133 
‹rmli¡s
.
	`äÚt
()->
	`g‘_‹rmÇme
(è=ğ
cu¼’t_‹rm
);

136 ià(
‹rmli¡s
.
	`size
() <= 1) {

137 ià(
‹rmli¡s
.
	`em±y
()è 
NULL
;

138 
T”mLi¡
 * 

 = 
‹rmli¡s
[0];

139 
‹rmli¡s
.
	`ş—r
();

140  

;

143 
cu¼’t_‹rm
 = 
‹rmli¡s
.
	`äÚt
()->
	`g‘_‹rmÇme
();

144  
NULL
;

145 
	}
}

147 
T”mLi¡
 *

148 
	gMuÉiAÎT”msLi¡
::
sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
)

153 
veùÜ
<
T”mLi¡
*>::
™”©Ü
 
i
 = 
‹rmli¡s
.
begš
();

154 
	gi
 !ğ
‹rmli¡s
.
’d
()) {

155 (*
i
)->
sk_to
(
‹rm
);

156 ià((*
	gi
)->
©_’d
()) {

157 
d–‘e
 *
	gi
;

158 
	gi
 = 
‹rmli¡s
.
”a£
(
i
);

160 ++
	gi
;

164 ià(
	g‹rmli¡s
.
size
() <= 1) {

165 ià(
‹rmli¡s
.
em±y
()è 
NULL
;

166 
T”mLi¡
 * 
	g
 = 
‹rmli¡s
[0];

167 
	g‹rmli¡s
.
ş—r
();

168  
	g
;

171 
make_h—p
(
‹rmli¡s
.
begš
(),”mli¡s.
’d
(), 
Com·»T”mLi¡sByT”m
());

173 
	gcu¼’t_‹rm
 = 
‹rmli¡s
.
äÚt
()->
g‘_‹rmÇme
();

174  
	gNULL
;

177 
boŞ


178 
	gMuÉiAÎT”msLi¡
::
	$©_’d
() const

180  
‹rmli¡s
.
	`em±y
();

181 
	}
}

	@backends/multi/multi_postlist.cc

22 
	~<cÚfig.h
>

24 
	~"muÉi_po¡li¡.h
"

26 
	~"omas£¹.h
"

27 
	~"omdebug.h
"

28 
	~"uts.h
"

30 #ifdeà
XAPIAN_ASSERTIONS_PARANOID


31 
	~"x­Ÿn/d©aba£.h
"

34 
	gMuÉiPo¡Li¡
::
MuÉiPo¡Li¡
(
¡d
::
veùÜ
<
L—fPo¡Li¡
 *> & 
¶s
,

35 cÚ¡ 
X­Ÿn
::
D©aba£
 &
this_db_
)

36 : 
po¡li¡s
(
¶s
),

37 
this_db
(
this_db_
),

38 
fšished
(
çl£
),

39 
	$cu¼doc
(0)

41 
muÉl›r
 = 
¶s
.
	`size
();

42 
	}
}

45 
	gMuÉiPo¡Li¡
::~
	$MuÉiPo¡Li¡
()

47 
¡d
::
veùÜ
<
L—fPo¡Li¡
 *>::
™”©Ü
 
i
;

48 
i
 = 
po¡li¡s
.
	`begš
(); i !ğpo¡li¡s.
	`’d
(); i++) {

49 
d–‘e
 *
i
;

51 
po¡li¡s
.
	`ş—r
();

52 
	}
}

54 
	gX­Ÿn
::
doccouÁ


55 
MuÉiPo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

58 
	`As£¹
(
çl£
);

60 
	}
}

62 
	gX­Ÿn
::
doccouÁ


63 
MuÉiPo¡Li¡
::
	$g‘_‹rmäeq_max
() const

65  
MuÉiPo¡Li¡
::
	`g‘_‹rmäeq_mš
();

66 
	}
}

68 
	gX­Ÿn
::
doccouÁ


69 
MuÉiPo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

71  
MuÉiPo¡Li¡
::
	`g‘_‹rmäeq_mš
();

72 
	}
}

74 
	gX­Ÿn
::
weight


75 
MuÉiPo¡Li¡
::
	$g‘_maxweight
() const

77  
MuÉiPo¡Li¡
::
	`g‘_weight
();

78 
	}
}

80 
	gX­Ÿn
::
weight


81 
MuÉiPo¡Li¡
::
	$g‘_weight
() const

84 
	`As£¹
(
çl£
);

86 
	}
}

88 
	gX­Ÿn
::
weight


89 
MuÉiPo¡Li¡
::
	$»ÿlc_maxweight
()

91  
MuÉiPo¡Li¡
::
	`g‘_weight
();

92 
	}
}

94 
	gX­Ÿn
::
docid


95 
MuÉiPo¡Li¡
::
	$g‘_docid
() const

97 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
docid
, "MultiPostList::get_docid", "");

98 
	`As£¹
(!
	`©_’d
());

99 
	`As£¹
(
cu¼doc
 != 0);

100 
	`RETURN
(
cu¼doc
);

101 
	}
}

103 
	gX­Ÿn
::
‹rmcouÁ


104 
MuÉiPo¡Li¡
::
	$g‘_doş’gth
() const

106 
	`DEBUGCALL
(
DB
, 
X­Ÿn
::
‹rmcouÁ
, "MultiPostList::get_doclength", "");

107 
	`As£¹
(!
	`©_’d
());

108 
	`As£¹
(
cu¼doc
 != 0);

109 
X­Ÿn
::
‹rmcouÁ
 
»suÉ
 = 
po¡li¡s
[(
cu¼doc
 - 1è% 
muÉl›r
]->
	`g‘_doş’gth
();

110 
	`As£¹EqP¬ªoid
(
»suÉ
, 
this_db
.
	`g‘_doş’gth
(
	`g‘_docid
()));

111 
	`RETURN
(
»suÉ
);

112 
	}
}

114 
	gX­Ÿn
::
‹rmcouÁ


115 
MuÉiPo¡Li¡
::
	$g‘_wdf
() const

117  
po¡li¡s
[(
cu¼doc
 - 1è% 
muÉl›r
]->
	`g‘_wdf
();

118 
	}
}

120 
Pos™iÚLi¡
 *

121 
	gMuÉiPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

123  
po¡li¡s
[(
cu¼doc
 - 1è% 
muÉl›r
]->
	`İ’_pos™iÚ_li¡
();

124 
	}
}

126 
Po¡Li¡
 *

127 
	gMuÉiPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

129 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *, "MuÉiPo¡Li¡::Ãxt", 
w_mš
);

130 
As£¹
(!
©_’d
());

132 
	gX­Ÿn
::
docid
 
Ãwdoc
 = 0;

133 
	gX­Ÿn
::
docid
 
off£t
 = 1;

134 
	g¡d
::
veùÜ
<
L—fPo¡Li¡
 *>::
™”©Ü
 
i
;

135 
	gi
 = 
po¡li¡s
.
begš
(); i !ğpo¡li¡s.
’d
(); i++) {

136 ià(!(*
	gi
)->
©_’d
()) {

137 
	gX­Ÿn
::
docid
 
id
 = ((*
i
)->
g‘_docid
(è- 1è* 
muÉl›r
 + 
off£t
;

139 ià(
	gcu¼doc
 >ğ
id
) {

140 (*
i
)->
Ãxt
(
w_mš
);

141 ià(!(*
	gi
)->
©_’d
()) {

142 
	gid
 = ((*
i
)->
g‘_docid
(è- 1è* 
muÉl›r
 + 
off£t
;

143 ià(
	gÃwdoc
 =ğ0 || 
id
 < 
Ãwdoc
)‚ewdoc = id;

146 ià(
	gÃwdoc
 =ğ0 || 
id
 < 
Ãwdoc
)‚ewdoc = id;

149 
	goff£t
++;

151 ià(
	gÃwdoc
) {

152 
LOGLINE
(
DB
, "MuÉiPo¡Li¡::Ãxt(èÃwdoc=" << 
Ãwdoc
 <<

153 " (Şddoc=" << 
cu¼doc
 << ")");

154 
	gcu¼doc
 = 
Ãwdoc
;

156 
LOGLINE
(
DB
, "MultiPostList::next() finished" <<

157 " (Şddoc=" << 
cu¼doc
 << ")");

158 
	gfšished
 = 
Œue
;

160 
RETURN
(
NULL
);

163 
Po¡Li¡
 *

164 
	gMuÉiPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

166 
DEBUGCALL
(
DB
, 
Po¡Li¡
 *, "MuÉiPo¡Li¡::sk_to", 
did
 << ", " << 
w_mš
);

167 
As£¹
(!
©_’d
());

168 
	gX­Ÿn
::
docid
 
Ãwdoc
 = 0;

169 
	gX­Ÿn
::
docid
 
off£t
 = 0;

170 
	gX­Ÿn
::
docid
 
»®did
 = (
did
 - 1è/ 
muÉl›r
 + 2;

171 
	gX­Ÿn
::
doccouÁ
 
dbnumb”
 = (
did
 - 1è% 
muÉl›r
;

172 
	g¡d
::
veùÜ
<
L—fPo¡Li¡
 *>::
™”©Ü
 
i
;

173 
	gi
 = 
po¡li¡s
.
begš
(); i !ğpo¡li¡s.
’d
(); i++) {

174 ià(
	goff£t
 =ğ
dbnumb”
è--
»®did
;

175 ++
	goff£t
;

176 
As£¹
((
»®did
 - 1è* 
muÉl›r
 + 
off£t
 >ğ
did
);

177 
As£¹
((
»®did
 - 1è* 
muÉl›r
 + 
off£t
 < 
did
 + multiplier);

178 ià(!(*
	gi
)->
©_’d
()) {

179 (*
	gi
)->
sk_to
(
»®did
, 
w_mš
);

180 ià(!(*
	gi
)->
©_’d
()) {

181 
	gX­Ÿn
::
docid
 
id
 = ((*
i
)->
g‘_docid
(è- 1è* 
muÉl›r
 + 
off£t
;

182 ià(
	gÃwdoc
 =ğ0 || 
id
 < 
Ãwdoc
)‚ewdoc = id;

186 ià(
	gÃwdoc
) {

187 
	gcu¼doc
 = 
Ãwdoc
;

189 
	gfšished
 = 
Œue
;

191 
RETURN
(
NULL
);

194 
boŞ


195 
	gMuÉiPo¡Li¡
::
	$©_’d
() const

197  
fšished
;

198 
	}
}

200 
	g¡d
::
¡ršg


201 
MuÉiPo¡Li¡
::
	$g‘_desütiÚ
() const

203 
¡d
::
¡ršg
 
desc
;

205 
¡d
::
veùÜ
<
L—fPo¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
;

206 
i
 = 
po¡li¡s
.
	`begš
(); i !ğpo¡li¡s.
	`’d
(); i++) {

207 ià(!
desc
.
	`em±y
()) desc += ',';

208 
desc
 +ğ(*
i
)->
	`g‘_desütiÚ
();

211  
desc
;

212 
	}
}

	@backends/multi/multi_postlist.h

22 #iâdeà
OM_HGUARD_MULTI_POSTLIST_H


23 
	#OM_HGUARD_MULTI_POSTLIST_H


	)

25 
	~"Ëaåo¡li¡.h
"

26 
	~<veùÜ
>

28 şas 
	cMuÉiPo¡Li¡
 : 
public
 
Po¡Li¡
 {

29 
ä›nd
 
şass
 
X­Ÿn
::
D©aba£
;

30 
	m´iv©e
:

31 
¡d
::
veùÜ
<
L—fPo¡Li¡
 *> 
po¡li¡s
;

33 cÚ¡ 
	mX­Ÿn
::
D©aba£
 &
this_db
;

35 
boŞ
 
	mfšished
;

36 
	mX­Ÿn
::
docid
 
cu¼doc
;

38 
	mX­Ÿn
::
doccouÁ
 
muÉl›r
;

40 
MuÉiPo¡Li¡
(
¡d
::
veùÜ
<
L—fPo¡Li¡
 *> & 
¶s
,

41 cÚ¡ 
X­Ÿn
::
D©aba£
 &
this_db_
);

42 
	mpublic
:

43 ~
MuÉiPo¡Li¡
();

45 
	mX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

46 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

47 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

49 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

50 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

51 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

53 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

54 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

55 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

56 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

57 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

58 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

59 
boŞ
 
	$©_’d
() const;

61 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

	@backends/multi/multi_termlist.cc

22 
	~<cÚfig.h
>

24 
	~"ex·ndweight.h
"

25 
	~"omdebug.h
"

26 
	~"muÉi_‹rmli¡.h
"

27 
	~"d©aba£.h
"

29 
	gMuÉiT”mLi¡
::
MuÉiT”mLi¡
(
T”mLi¡
 * 
_
,

30 cÚ¡ 
X­Ÿn
::
D©aba£
 &
db_
,

31 
size_t
 
db_šdex_
)

32 : 

(
_
), 
db
(
db_
), 
	$db_šdex
(
db_šdex_
)

34 
‹rmäeq_çùÜ
 = (
db
.
	`g‘_doccouÁ
());

35 
‹rmäeq_çùÜ
 /ğ
db
.
š‹º®
[
db_šdex
]->
	`g‘_doccouÁ
();

36 
	`LOGLINE
(
DB
, "Aµroxim©iÚ faùÜ fÜ”mäeq: " << 
‹rmäeq_çùÜ
);

37 
	}
}

39 
	gMuÉiT”mLi¡
::~
	$MuÉiT”mLi¡
()

41 
d–‘e
 

;

42 
	}
}

44 
	gX­Ÿn
::
‹rmcouÁ


45 
MuÉiT”mLi¡
::
	$g‘_­´ox_size
() const

47  

->
	`g‘_­´ox_size
();

48 
	}
}

51 
	gMuÉiT”mLi¡
::
accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const

55 
¡©s
.
db_šdex
 = db_index;

56 
	g
->
accumuÏ‹_¡©s
(
¡©s
);

59 
¡ršg


60 
	gMuÉiT”mLi¡
::
	$g‘_‹rmÇme
() const

62  

->
	`g‘_‹rmÇme
();

63 
	}
}

65 
	gX­Ÿn
::
‹rmcouÁ
 
MuÉiT”mLi¡
::
	$g‘_wdf
() const

67  

->
	`g‘_wdf
();

68 
	}
}

70 
	gX­Ÿn
::
doccouÁ
 
MuÉiT”mLi¡
::
	$g‘_‹rmäeq
() const

73  
X­Ÿn
::
	`doccouÁ
(

->
	`g‘_‹rmäeq
(è* 
‹rmäeq_çùÜ
);

74 
	}
}

76 
T”mLi¡
 * 
	gMuÉiT”mLi¡
::
	$Ãxt
()

78  

->
	`Ãxt
();

79 
	}
}

81 
boŞ
 
	gMuÉiT”mLi¡
::
	$©_’d
() const

83  

->
	`©_’d
();

84 
	}
}

86 
	gX­Ÿn
::
‹rmcouÁ


87 
MuÉiT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

89  

->
	`pos™iÚli¡_couÁ
();

90 
	}
}

92 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


93 
MuÉiT”mLi¡
::
	$pos™iÚli¡_begš
() const

95  

->
	`pos™iÚli¡_begš
();

96 
	}
}

	@backends/multi/multi_termlist.h

22 #iâdeà
OM_HGUARD_MULTI_TERMLIST_H


23 
	#OM_HGUARD_MULTI_TERMLIST_H


	)

25 
	~"‹rmli¡.h
"

26 
	~"d©aba£.h
"

28 şas 
	cMuÉiT”mLi¡
 : 
public
 
T”mLi¡
 {

29 
ä›nd
 
şass
 
X­Ÿn
::
D©aba£
;

30 
	m´iv©e
:

31 
T”mLi¡
 *

;

32 cÚ¡ 
	mX­Ÿn
::
D©aba£
 & 
db
;

33 
size_t
 
	mdb_šdex
;

34 
	m‹rmäeq_çùÜ
;

36 
MuÉiT”mLi¡
(
T”mLi¡
 * 
_
,

37 cÚ¡ 
X­Ÿn
::
D©aba£
 &
db_
,

38 
size_t
 
db_šdex_
);

39 
	mpublic
:

40 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

43 
	`accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const;

45 
¡ršg
 
	$g‘_‹rmÇme
() const;

46 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

47 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

48 
T”mLi¡
 * 
	`Ãxt
();

49 
boŞ
 
	$©_’d
() const;

51 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

53 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

55 ~
	`MuÉiT”mLi¡
();

	@backends/multi/multi_valuelist.cc

21 
	~<cÚfig.h
>

23 
	~"muÉiv®u–i¡.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"omas£¹.h
"

29 
	~<®gÜ™hm
>

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	sSubV®ueLi¡
 {

34 
V®ueLi¡
 * 
	mv®u–i¡
;

35 
	mdb_idx
;

37 
SubV®ueLi¡
(
V®ueLi¡
 * 
vl
, 
db_idx_
)

38 : 
v®u–i¡
(
vl
), 
db_idx
(
db_idx_
) { }

40 ~
SubV®ueLi¡
() {

41 
d–‘e
 
	mv®u–i¡
;

44 
sk_to
(
X­Ÿn
::
docid
 
did
, 
size_t
 
muÉl›r
) {

46 
	mdid
 = (
did
 - 
db_idx
 - 2 + 
muÉl›r
) / multiplier + 1;

47 
	mv®u–i¡
->
sk_to
(
did
);

50 
	mX­Ÿn
::
docid
 
g‘_docid
() const {

51  
v®u–i¡
->
g‘_docid
();

54 
	mX­Ÿn
::
docid
 
g‘_m”ged_docid
(
muÉl›r
) const {

55  (
v®u–i¡
->
g‘_docid
(è- 1è* 
muÉl›r
 + 
db_idx
 + 1;

58 
	m¡d
::
¡ršg
 
g‘_v®ue
(ècÚ¡ {  
v®u–i¡
->get_value(); }

60 
Ãxt
() {

61 
	mv®u–i¡
->
Ãxt
();

64 
boŞ
 
©_’d
(ècÚ¡ {  
	mv®u–i¡
->at_end(); }

68 
	sCom·»SubV®ueLi¡sByDocId
 {

70 
boŞ
 
İ”©Ü
()(cÚ¡ 
SubV®ueLi¡
 *
	ma
, cÚ¡ SubV®ueLi¡ *
	mb
) {

71 
	mX­Ÿn
::
docid
 
did_a
 = 
a
->
g‘_docid
();

72 
	mX­Ÿn
::
docid
 
did_b
 = 
b
->
g‘_docid
();

73 ià(
	mdid_a
 > 
	mdid_b
è 
	mŒue
;

74 ià(
	mdid_a
 < 
	mdid_b
è 
	mçl£
;

75  
	ma
->
	mdb_idx
 > 
	mb
->db_idx;

79 
	g‹m¶©e
<
şass
 
	gCLASS
> 
	sd–‘e_±r
 {

80 
İ”©Ü
()(
CLASS
 *
	mp
è{ 
d–‘e
…; }

83 
	gMuÉiV®ueLi¡
::
MuÉiV®ueLi¡
(cÚ¡ 
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<X­Ÿn::
D©aba£
::IÁ”Çl> > & 
dbs
,

84 
X­Ÿn
::
v®u’o
 
¦Ù_
)

85 : 
cu¼’t_docid
(0), 
¦Ù
(
¦Ù_
), 
muÉl›r
(
dbs
.
	$size
())

88 
	`As£¹R–
(
muÉl›r
, >=, 2);

89 
v®u–i¡s
.
	`»£rve
(
muÉl›r
);

90 
Œy
 {

91 
db_idx
 = 0;

92 
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<X­Ÿn::
D©aba£
::IÁ”Çl> >::
cÚ¡_™”©Ü
 
i
;

93 
i
 = 
dbs
.
	`begš
(); i !ğdbs.
	`’d
(); ++i) {

94 
V®ueLi¡
 * 
vl
 = (*
i
)->
	`İ’_v®ue_li¡
(
¦Ù
);

95 
v®u–i¡s
.
	`push_back
(
Ãw
 
	`SubV®ueLi¡
(
vl
, 
db_idx
));

96 ++
db_idx
;

98 } 
	`ÿtch
 (...) {

99 
	`fÜ_—ch
(
v®u–i¡s
.
	`begš
(), v®u–i¡s.
	`’d
(), 
d–‘e_±r
<
SubV®ueLi¡
>());

100 
throw
;

102 
	}
}

104 
	gMuÉiV®ueLi¡
::~
	$MuÉiV®ueLi¡
()

106 
	`fÜ_—ch
(
v®u–i¡s
.
	`begš
(), v®u–i¡s.
	`’d
(), 
d–‘e_±r
<
SubV®ueLi¡
>());

107 
	}
}

109 
	gX­Ÿn
::
docid


110 
MuÉiV®ueLi¡
::
	$g‘_docid
() const

112 
	`As£¹
(!
	`©_’d
());

113  
cu¼’t_docid
;

114 
	}
}

116 
	g¡d
::
¡ršg


117 
MuÉiV®ueLi¡
::
	$g‘_v®ue
() const

119 
	`As£¹
(!
	`©_’d
());

120  
v®u–i¡s
.
	`äÚt
()->
	`g‘_v®ue
();

121 
	}
}

123 
	gX­Ÿn
::
v®u’o


124 
MuÉiV®ueLi¡
::
	$g‘_v®u’o
() const

126  
¦Ù
;

127 
	}
}

129 
boŞ


130 
	gMuÉiV®ueLi¡
::
	$©_’d
() const

132  
v®u–i¡s
.
	`em±y
();

133 
	}
}

136 
	gMuÉiV®ueLi¡
::
	$Ãxt
()

138 ià(
cu¼’t_docid
 == 0) {

141 
veùÜ
<
SubV®ueLi¡
 *>::
™”©Ü
 
i
 = 
v®u–i¡s
.
	`begš
();

142 
i
 !ğ
v®u–i¡s
.
	`’d
()) {

143 (*
i
)->
	`Ãxt
();

144 ià((*
i
)->
	`©_’d
()) {

145 
SubV®ueLi¡
 * 
vl
 = 
NULL
;

146 
	`sw­
(
vl
, *
i
);

147 
i
 = 
v®u–i¡s
.
	`”a£
(i);

148 
d–‘e
 
vl
;

150 ++
i
;

153 ià(
	`¿»
(
v®u–i¡s
.
	`em±y
()))

155 
	`make_h—p
(
v®u–i¡s
.
	`begš
(), v®u–i¡s.
	`’d
(),

156 
	`Com·»SubV®ueLi¡sByDocId
());

159 
	`pİ_h—p
(
v®u–i¡s
.
	`begš
(), v®u–i¡s.
	`’d
(),

160 
	`Com·»SubV®ueLi¡sByDocId
());

161 
SubV®ueLi¡
 * 
vl
 = 
v®u–i¡s
.
	`back
();

162 
vl
->
	`Ãxt
();

163 ià(
vl
->
	`©_’d
()) {

164 
d–‘e
 
vl
;

165 
v®u–i¡s
.
	`pİ_back
();

166 ià(
v®u–i¡s
.
	`em±y
()) ;

168 
	`push_h—p
(
v®u–i¡s
.
	`begš
(), v®u–i¡s.
	`’d
(),

169 
	`Com·»SubV®ueLi¡sByDocId
());

173 
cu¼’t_docid
 = 
v®u–i¡s
.
	`äÚt
()->
	`g‘_m”ged_docid
(
muÉl›r
);

174 
	}
}

177 
	gMuÉiV®ueLi¡
::
sk_to
(
X­Ÿn
::
docid
 
did
)

182 
veùÜ
<
SubV®ueLi¡
*>::
™”©Ü
 
i
 = 
v®u–i¡s
.
begš
();

183 
	gi
 !ğ
v®u–i¡s
.
’d
()) {

184 (*
i
)->
sk_to
(
did
, 
muÉl›r
);

185 ià((*
	gi
)->
©_’d
()) {

186 
SubV®ueLi¡
 * 
	gvl
 = 
NULL
;

187 
sw­
(
vl
, *
i
);

188 
	gi
 = 
v®u–i¡s
.
”a£
(
i
);

189 
d–‘e
 
	gvl
;

191 ++
	gi
;

195 ià(
	gv®u–i¡s
.
em±y
()) ;

197 
make_h—p
(
v®u–i¡s
.
begš
(), v®u–i¡s.
’d
(), 
Com·»SubV®ueLi¡sByDocId
());

199 
	gcu¼’t_docid
 = 
v®u–i¡s
.
äÚt
()->
g‘_m”ged_docid
(
muÉl›r
);

202 
boŞ


203 
	gMuÉiV®ueLi¡
::
check
(
X­Ÿn
::
docid
 
did
)

206 
sk_to
(
did
);

207  
	gŒue
;

210 
¡ršg


211 
	gMuÉiV®ueLi¡
::
	$g‘_desütiÚ
() const

214 
	}
}

	@backends/remote/net_postlist.cc

23 
	~<cÚfig.h
>

25 
	~"Ãt_po¡li¡.h
"

26 
	~"£rŸli£.h
"

28 
usšg
 
Çme¥aû
 
	g¡d
;

30 
	gX­Ÿn
::
doccouÁ


31 
N‘wÜkPo¡Li¡
::
	$g‘_‹rmäeq
() const

33  
‹rmäeq
;

34 
	}
}

36 
	gX­Ÿn
::
docid


37 
N‘wÜkPo¡Li¡
::
	$g‘_docid
() const

39  
Ï¡docid
;

40 
	}
}

42 
	gX­Ÿn
::
‹rmcouÁ


43 
N‘wÜkPo¡Li¡
::
	$g‘_doş’gth
() const

45  
db
->
	`g‘_doş’gth
(
Ï¡docid
);

46 
	}
}

48 
	gX­Ÿn
::
‹rmcouÁ


49 
N‘wÜkPo¡Li¡
::
	$g‘_wdf
() const

51  
Ï¡wdf
;

52 
	}
}

54 
Pos™iÚLi¡
 *

55 
	gN‘wÜkPo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

57 
Ï¡po¦i¡
 = 
db
->
	`İ’_pos™iÚ_li¡
(
Ï¡docid
, 
‹rm
);

58  
Ï¡po¦i¡
.
	`g‘
();

59 
	}
}

61 
Pos™iÚLi¡
 *

62 
	gN‘wÜkPo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

64  
db
->
	`İ’_pos™iÚ_li¡
(
Ï¡docid
, 
‹rm
);

65 
	}
}

67 
Po¡Li¡
 *

68 
	gN‘wÜkPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
)

70 ià(!
¡¬‹d
) {

71 
¡¬‹d
 = 
Œue
;

72 
	gpos
 = 
po¡šgs
.
d©a
();

73 
	gpos_’d
 = 
pos
 + 
po¡šgs
.
size
();

74 
	gÏ¡docid
 = 0;

77 ià(
	gpos
 =ğ
pos_’d
) {

78 
pos
 = 
NULL
;

80 
	gÏ¡docid
 +ğ
decode_Ëngth
(&
pos
, 
pos_’d
, 
çl£
) + 1;

81 
	gÏ¡wdf
 = 
decode_Ëngth
(&
pos
, 
pos_’d
, 
çl£
);

84  
	gNULL
;

87 
Po¡Li¡
 *

88 
	gN‘wÜkPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
mš_weight
)

90 ià(!
¡¬‹d
)

91 
Ãxt
(
mš_weight
);

92 
	gpos
 && 
	gÏ¡docid
 < 
	gdid
)

93 
Ãxt
(
mš_weight
);

94  
	gNULL
;

97 
boŞ


98 
	gN‘wÜkPo¡Li¡
::
	$©_’d
() const

100  (
pos
 =ğ
NULL
 && 
¡¬‹d
);

101 
	}
}

103 
¡ršg


104 
	gN‘wÜkPo¡Li¡
::
	$g‘_desütiÚ
() const

106 
¡ršg
 
desc
 = "NetworkPostList(";

107 
desc
 +ğ
‹rm
;

108 
desc
 += ')';

109  
desc
;

110 
	}
}

	@backends/remote/net_postlist.h

23 #iâdeà
XAPIAN_INCLUDED_NET_POSTLIST_H


24 
	#XAPIAN_INCLUDED_NET_POSTLIST_H


	)

26 
	~<¡ršg
>

28 
	~"Ëaåo¡li¡.h
"

29 
	~"omas£¹.h
"

30 
	~"»mÙe-d©aba£.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

36 şas 
	cN‘wÜkPo¡Li¡
 : 
public
 
L—fPo¡Li¡
 {

37 
ä›nd
 
şass
 
RemÙeD©aba£
;

39 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
RemÙeD©aba£
> 
db
;

41 
¡ršg
 
	mpo¡šgs
;

42 
boŞ
 
	m¡¬‹d
;

43 cÚ¡ * 
	mpos
;

44 cÚ¡ * 
	mpos_’d
;

46 
	mX­Ÿn
::
docid
 
Ï¡docid
;

47 
	mX­Ÿn
::
‹rmcouÁ
 
Ï¡wdf
;

48 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
Pos™iÚLi¡
> 
Ï¡po¦i¡
;

50 
	mX­Ÿn
::
doccouÁ
 
‹rmäeq
;

53 
	$­³nd_po¡šg
(cÚ¡ 
¡ršg
 & 
£rŸli£d
) {

54 
	`As£¹
(
pos
 =ğ
NULL
);

55 
	`As£¹
(!
¡¬‹d
);

56 
po¡šgs
.
	`­³nd
(
£rŸli£d
);

59 
public
:

61 
	`N‘wÜkPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
RemÙeD©aba£
> 
db_
,

62 cÚ¡ 
¡ršg
 & 
‹rm_
)

63 : 
	`L—fPo¡Li¡
(
‹rm_
),

64 
	`db
(
db_
), 
	`¡¬‹d
(
çl£
), 
	`pos
(
NULL
), 
	`pos_’d
(NULL),

65 
	`Ï¡docid
(0), 
	`Ï¡wdf
(0), 
	$‹rmäeq
(0)

67 
‹rmäeq
 = 
db
->
	`»ad_po¡_li¡
(
‹rm
, *
this
);

68 
	}
}

71 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

74 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

77 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

80 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

84 
Pos™iÚLi¡
 * 
	`»ad_pos™iÚ_li¡
();

88 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

92 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
);

96 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 weight);

99 
boŞ
 
	$©_’d
() const;

102 
¡ršg
 
	$g‘_desütiÚ
() const;

103 
	}
};

	@backends/remote/net_termlist.cc

22 
	~<cÚfig.h
>

24 
	~"Ãt_‹rmli¡.h
"

26 
	~"omas£¹.h
"

28 
	~<x­Ÿn/”rÜ.h
>

30 
	gN‘wÜkT”mLi¡
::
N‘wÜkT”mLi¡
(
X­Ÿn
::
‹rmcouÁ
 
docum’t_Ëngth_
,

31 
X­Ÿn
::
doccouÁ
 
d©aba£_size_
,

32 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
RemÙeD©aba£
> 
this_db_
,

33 
X­Ÿn
::
docid
 
did_
)

34 : 
™ems
(),

35 
cu¼’t_pos™iÚ
(
™ems
.
begš
()),

36 
¡¬‹d
(
çl£
),

37 
docum’t_Ëngth
(
docum’t_Ëngth_
),

38 
d©aba£_size
(
d©aba£_size_
),

39 
this_db
(
this_db_
),

40 
	$did
(
did_
)

42 
	}
}

44 
	gX­Ÿn
::
‹rmcouÁ


45 
N‘wÜkT”mLi¡
::
	$g‘_­´ox_size
() const

47  
™ems
.
	`size
();

48 
	}
}

51 
	gN‘wÜkT”mLi¡
::
accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const

53 
As£¹
(
¡¬‹d
);

54 
As£¹
(!
©_’d
());

56 
	g¡©s
.
accumuÏ‹
(
cu¼’t_pos™iÚ
->
wdf
,

57 
docum’t_Ëngth
,

58 
cu¼’t_pos™iÚ
->
‹rmäeq
,

59 
d©aba£_size
);

62 
¡ršg


63 
	gN‘wÜkT”mLi¡
::
	$g‘_‹rmÇme
() const

65 
	`As£¹
(
¡¬‹d
);

66 
	`As£¹
(!
	`©_’d
());

67  
cu¼’t_pos™iÚ
->
Šame
;

68 
	}
}

70 
	gX­Ÿn
::
‹rmcouÁ


71 
N‘wÜkT”mLi¡
::
	$g‘_wdf
() const

73 
	`As£¹
(
¡¬‹d
);

74 
	`As£¹
(!
	`©_’d
());

75  
cu¼’t_pos™iÚ
->
wdf
;

76 
	}
}

78 
	gX­Ÿn
::
doccouÁ


79 
N‘wÜkT”mLi¡
::
	$g‘_‹rmäeq
() const

81 
	`As£¹
(
¡¬‹d
);

82 
	`As£¹
(!
	`©_’d
());

83  
cu¼’t_pos™iÚ
->
‹rmäeq
;

84 
	}
}

86 
T”mLi¡
 *

87 
	gN‘wÜkT”mLi¡
::
	$Ãxt
()

89 ià(
¡¬‹d
) {

90 
	`As£¹
(!
	`©_’d
());

91 
cu¼’t_pos™iÚ
++;

93 
¡¬‹d
 = 
Œue
;

95  
NULL
;

96 
	}
}

98 
boŞ


99 
	gN‘wÜkT”mLi¡
::
	$©_’d
() const

101 
	`As£¹
(
¡¬‹d
);

102  (
cu¼’t_pos™iÚ
 =ğ
™ems
.
	`’d
());

103 
	}
}

105 
	gX­Ÿn
::
‹rmcouÁ


106 
N‘wÜkT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

108 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("NetworkTermList::positionlist_count()‚ot implemented");

109 
	}
}

111 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


112 
N‘wÜkT”mLi¡
::
	$pos™iÚli¡_begš
() const

114  
X­Ÿn
::
	`Pos™iÚI‹¿tÜ
(
this_db
->
	`İ’_pos™iÚ_li¡
(
did
, 
	`g‘_‹rmÇme
()));

115 
	}
}

	@backends/remote/net_termlist.h

22 #iâdeà
OM_HGUARD_NET_TERMLIST_H


23 
	#OM_HGUARD_NET_TERMLIST_H


	)

25 
	~<¡ršg
>

27 
	~<x­Ÿn/ty³s.h
>

28 
	~<x­Ÿn/”rÜ.h
>

29 
	~"‹rmli¡.h
"

30 
	~"ex·ndweight.h
"

31 
	~"»mÙe-d©aba£.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

37 şas 
	cN‘wÜkT”mLi¡I‹m
 {

38 
	mpublic
:

41 
¡ršg
 
Šame
;

47 
	mX­Ÿn
::
doccouÁ
 
‹rmäeq
;

54 
	mX­Ÿn
::
‹rmcouÁ
 
wdf
;

61 şas 
	cN‘wÜkT”mLi¡
 : 
public
 
T”mLi¡
 {

62 
ä›nd
 
şass
 
RemÙeD©aba£
;

63 
	m´iv©e
:

66 
veùÜ
<
N‘wÜkT”mLi¡I‹m
> 
™ems
;

70 
	mveùÜ
<
	mN‘wÜkT”mLi¡I‹m
>::
cÚ¡_™”©Ü
 
cu¼’t_pos™iÚ
;

74 
boŞ
 
	m¡¬‹d
;

80 
	mX­Ÿn
::
‹rmcouÁ
 
docum’t_Ëngth
;

88 
	mX­Ÿn
::
doccouÁ
 
d©aba£_size
;

91 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
RemÙeD©aba£
> 
this_db
;

94 
	mX­Ÿn
::
docid
 
did
;

104 
N‘wÜkT”mLi¡
(
X­Ÿn
::
‹rmcouÁ
 
docum’t_Ëngth_
,

105 
X­Ÿn
::
doccouÁ
 
d©aba£_size_
,

106 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
RemÙeD©aba£
> 
this_db_
,

107 
X­Ÿn
::
docid
 
did_
);

108 
	mpublic
:

112 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

115 
	`accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 &
¡©s
) const;

116 
¡ršg
 
	$g‘_‹rmÇme
() const;

117 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

118 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

119 
T”mLi¡
 * 
	`Ãxt
();

120 
boŞ
 
	$©_’d
() const;

122 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

123 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

	@backends/remote/remote-database.cc

22 
	~<cÚfig.h
>

24 
	~"»mÙe-d©aba£.h
"

26 
	~"§ã”ºo.h
"

27 
	~<sigÇl.h
>

29 
	~"autİŒ.h
"

30 
	~"em±ypo¡li¡.h
"

31 
	~"šmemÜy_pos™iÚli¡.h
"

32 
	~"Ãt_po¡li¡.h
"

33 
	~"Ãt_‹rmli¡.h
"

34 
	~"»mÙe-docum’t.h
"

35 
	~"omas£¹.h
"

36 
	~"£rŸli£.h
"

37 
	~"£rŸli£-doubË.h
"

38 
	~"¡ršguts.h
"

39 
	~"uts.h
"

40 
	~"weightš‹º®.h
"

42 
	~<¡ršg
>

43 
	~<veùÜ
>

45 
	~"x­Ÿn/”rÜ.h
"

46 
	~"x­Ÿn/m©ch¥y.h
"

48 
usšg
 
Çme¥aû
 
	g¡d
;

50 
	gRemÙeD©aba£
::
RemÙeD©aba£
(
fd
, 
X­Ÿn
::
timeout
 
timeout_
,

51 cÚ¡ 
¡ršg
 & 
cÚ‹xt_
, 
boŞ
 
wr™abË
)

52 : 
lšk
(
fd
, fd, 
cÚ‹xt_
),

53 
cÚ‹xt
(
cÚ‹xt_
),

54 
ÿched_¡©s_v®id
(),

55 
mru_v®¡©s
(),

56 
mru_v®no
(
X­Ÿn
::
BAD_VALUENO
),

57 
	$timeout
(
timeout_
)

59 #iâdeà
__WIN32__


62 ià(
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
è=ğ
SIG_ERR
) {

63 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Couldn'ˆ£ˆSIGPIPEØSIG_IGN", 
”ºo
);

67 ià(!
wr™abË
) {

73 
Œª§ùiÚ_¡©e
 = 
TRANSACTION_UNIMPLEMENTED
;

76 
¡ršg
 
mes§ge
;

77 
ty³
 = 
	`g‘_mes§ge
(
mes§ge
);

79 ià(
	`»¶y_ty³
(
ty³
è!ğ
REPLY_GREETING
 || 
mes§ge
.
	`size
() < 3) {

80 ià(
ty³
 =ğ'O' && 
mes§ge
.
	`size
(è=ğ
	`size_t
('M') && message[0] == ' ') {

84 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("S”v”…rÙocŞ v”siÚoØŞd", 
cÚ‹xt
);

86 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Hªdshakçed - i thi ¨X­ŸÀ£rv”?", 
cÚ‹xt
);

89 cÚ¡ *
p
 = 
mes§ge
.
	`c_¡r
();

90 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

94 
´ÙocŞ_majÜ
 = 
¡©ic_ÿ¡
<>(*
p
++);

95 
´ÙocŞ_mšÜ
 = 
¡©ic_ÿ¡
<>(*
p
++);

96 ià(
´ÙocŞ_majÜ
 !ğ
XAPIAN_REMOTE_PROTOCOL_MAJOR_VERSION
 ||

97 
´ÙocŞ_mšÜ
 < 
XAPIAN_REMOTE_PROTOCOL_MINOR_VERSION
) {

98 
¡ršg
 
	`”rmsg
("Unknown…rotocol version ");

99 
”rmsg
 +ğ
	`om_to¡ršg
(
´ÙocŞ_majÜ
);

100 
”rmsg
 += '.';

101 
”rmsg
 +ğ
	`om_to¡ršg
(
´ÙocŞ_mšÜ
);

102 
”rmsg
 +ğ" ("
	`STRINGIZE
(
XAPIAN_REMOTE_PROTOCOL_MAJOR_VERSION
)"."STRINGIZE(
XAPIAN_REMOTE_PROTOCOL_MINOR_VERSION
)" supported)";

103 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
(
”rmsg
, 
cÚ‹xt
);

106 
doccouÁ
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

107 
Ï¡docid
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

108 
doş’_lbound
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

109 
doş’_ubound
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

110 ià(
p
 =ğ
p_’d
) {

111 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Bad g»‘šg mes§g»ûived", 
cÚ‹xt
);

113 
has_pos™iÚ®_šfo
 = (*
p
++ == '1');

114 
tÙ®_Ëngth
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

115 
uuid
.
	`assign
(
p
, 
p_’d
);

117 ià(
wr™abË
è
	`upd©e_¡©s
(
MSG_WRITEACCESS
);

118 
	}
}

120 
RemÙeD©aba£
 *

121 
	gRemÙeD©aba£
::
	$as_»mÙed©aba£
()

123  
this
;

124 
	}
}

127 
	gRemÙeD©aba£
::
	$k“p_®ive
()

129 
	`£nd_mes§ge
(
MSG_KEEPALIVE
, 
	`¡ršg
());

130 
¡ršg
 
mes§ge
;

131 
	`g‘_mes§ge
(
mes§ge
, 
REPLY_DONE
);

132 
	}
}

134 
T”mLi¡
 *

135 
	gRemÙeD©aba£
::
İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const

137 
As£¹
(
did
);

140 ià(!
	gÿched_¡©s_v®id
è
upd©e_¡©s
();

142 
£nd_mes§ge
(
MSG_TERMLIST
, 
’code_Ëngth
(
did
));

144 
¡ršg
 
	gmes§ge
;

145 
g‘_mes§ge
(
mes§ge
, 
REPLY_DOCLENGTH
);

146 cÚ¡ * 
	gp
 = 
mes§ge
.
c_¡r
();

147 cÚ¡ * 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

148 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
 = 
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

149 ià(
	gp
 !ğ
p_’d
) {

150 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Bad REPLY_DOCLENGTH mes§g»ûived", 
cÚ‹xt
);

153 
	gAutoPŒ
<
	gN‘wÜkT”mLi¡
> 
i¡
(

154 
Ãw
 
N‘wÜkT”mLi¡
(
doş’
, 
doccouÁ
,

155 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
RemÙeD©aba£
>(
this
),

156 
did
));

157 
	gveùÜ
<
	gN‘wÜkT”mLi¡I‹m
> & 
	g™ems
 = 
i¡
->
™ems
;

159 
	gty³
;

160 (
	gty³
 = 
g‘_mes§ge
(
mes§ge
)è=ğ
REPLY_TERMLIST
) {

161 
N‘wÜkT”mLi¡I‹m
 
™em
;

162 
	gp
 = 
mes§ge
.
d©a
();

163 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

164 
	g™em
.
	gwdf
 = 
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

165 
	g™em
.
	g‹rmäeq
 = 
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

166 
	g™em
.
	gŠame
.
assign
(
p
, 
p_’d
);

167 
	g™ems
.
push_back
(
™em
);

169 ià(
	gty³
 !ğ
REPLY_DONE
) {

170 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Bad mes§g»ûived", 
cÚ‹xt
);

173 
	gi¡
->
	gcu¼’t_pos™iÚ
 = 
i¡
->
™ems
.
begš
();

174  
	gi¡
.
»Ëa£
();

177 
T”mLi¡
 *

178 
	gRemÙeD©aba£
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const {

180 ià(!
ÿched_¡©s_v®id
è
	`upd©e_¡©s
();

182 
	`£nd_mes§ge
(
MSG_ALLTERMS
, 
´efix
);

184 
AutoPŒ
<
N‘wÜkT”mLi¡
> 
	`i¡
(

185 
Ãw
 
	`N‘wÜkT”mLi¡
(0, 
doccouÁ
,

186 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
RemÙeD©aba£
>(
this
),

188 
veùÜ
<
N‘wÜkT”mLi¡I‹m
> & 
™ems
 = 
i¡
->items;

190 
¡ršg
 
mes§ge
;

191 
ty³
;

192 (
ty³
 = 
	`g‘_mes§ge
(
mes§ge
)è=ğ
REPLY_ALLTERMS
) {

193 
N‘wÜkT”mLi¡I‹m
 
™em
;

194 cÚ¡ * 
p
 = 
mes§ge
.
	`d©a
();

195 cÚ¡ * 
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

196 
™em
.
‹rmäeq
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

197 
™em
.
Šame
.
	`assign
(
p
, 
p_’d
);

198 
™ems
.
	`push_back
(
™em
);

200 ià(
ty³
 !ğ
REPLY_DONE
) {

201 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Bad mes§g»ûived", 
cÚ‹xt
);

204 
i¡
->
cu¼’t_pos™iÚ
 =li¡->
™ems
.
	`begš
();

205  
i¡
.
	`»Ëa£
();

206 
	}
}

208 
L—fPo¡Li¡
 *

209 
	gRemÙeD©aba£
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 &
‹rm
) const

211  
Ãw
 
	`N‘wÜkPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
RemÙeD©aba£
>(
this
), 
‹rm
);

212 
	}
}

214 
	gX­Ÿn
::
doccouÁ


215 
RemÙeD©aba£
::
	$»ad_po¡_li¡
(cÚ¡ 
¡ršg
 &
‹rm
, 
N‘wÜkPo¡Li¡
 & 
¶
) const

217 
	`£nd_mes§ge
(
MSG_POSTLIST
, 
‹rm
);

219 
¡ršg
 
mes§ge
;

220 
ty³
;

221 
	`g‘_mes§ge
(
mes§ge
, 
REPLY_POSTLISTSTART
);

223 cÚ¡ * 
p
 = 
mes§ge
.
	`d©a
();

224 cÚ¡ * 
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

225 
X­Ÿn
::
doccouÁ
 
‹rmäeq
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

227 (
ty³
 = 
	`g‘_mes§ge
(
mes§ge
)è=ğ
REPLY_POSTLISTITEM
) {

228 
¶
.
	`­³nd_po¡šg
(
mes§ge
);

230 ià(
ty³
 !ğ
REPLY_DONE
) {

231 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Bad mes§g»ûived", 
cÚ‹xt
);

234  
‹rmäeq
;

235 
	}
}

237 
Pos™iÚLi¡
 *

238 
	gRemÙeD©aba£
::
İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡ršg
 &
‹rm
) const

240 
£nd_mes§ge
(
MSG_POSITIONLIST
, 
’code_Ëngth
(
did
è+ 
‹rm
);

242 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
> 
pos™iÚs
;

244 
¡ršg
 
	gmes§ge
;

245 
	gty³
;

246 
	gX­Ÿn
::
‹rmpos
 
Ï¡pos
 = 
¡©ic_ÿ¡
<
X­Ÿn
::termpos>(-1);

247 (
	gty³
 = 
g‘_mes§ge
(
mes§ge
)è=ğ
REPLY_POSITIONLIST
) {

248 cÚ¡ * 
p
 = 
mes§ge
.
d©a
();

249 cÚ¡ * 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

250 
	gÏ¡pos
 +ğ
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
) + 1;

251 
	gpos™iÚs
.
push_back
(
Ï¡pos
);

253 ià(
	gty³
 !ğ
REPLY_DONE
) {

254 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Bad mes§g»ûived", 
cÚ‹xt
);

257  
Ãw
 
InMemÜyPos™iÚLi¡
(
pos™iÚs
);

260 
boŞ


261 
	gRemÙeD©aba£
::
	$has_pos™iÚs
() const

263 ià(!
ÿched_¡©s_v®id
è
	`upd©e_¡©s
();

264  
has_pos™iÚ®_šfo
;

265 
	}
}

268 
	gRemÙeD©aba£
::
	$»İ’
()

270 
	`upd©e_¡©s
(
MSG_REOPEN
);

271 
mru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

272 
	}
}

275 
	gRemÙeD©aba£
::
	$şo£
()

277 
	`do_şo£
();

278 
	}
}

287 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

288 
RemÙeD©aba£
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 ) const

290 
As£¹
(
did
);

292 
£nd_mes§ge
(
MSG_DOCUMENT
, 
’code_Ëngth
(
did
));

293 
¡ršg
 
	gdoc_d©a
;

294 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	g¡ršg
> 
	gv®ues
;

295 
g‘_mes§ge
(
doc_d©a
, 
REPLY_DOCDATA
);

297 
»¶y_ty³
 
	gty³
;

298 
¡ršg
 
	gmes§ge
;

299 (
	gty³
 = 
g‘_mes§ge
(
mes§ge
)è=ğ
REPLY_VALUE
) {

300 cÚ¡ * 
p
 = 
mes§ge
.
d©a
();

301 cÚ¡ * 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

302 
	gX­Ÿn
::
v®u’o
 v®u’Øğ
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

303 
	gv®ues
.
š£¹
(
make_·œ
(
v®u’o
, 
¡ršg
(
p
, 
p_’d
)));

305 ià(
	gty³
 !ğ
REPLY_DONE
) {

306 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Bad mes§g»ûived", 
cÚ‹xt
);

309  
Ãw
 
RemÙeDocum’t
(
this
, 
did
, 
doc_d©a
, 
v®ues
);

313 
	gRemÙeD©aba£
::
	$upd©e_¡©s
(
mes§ge_ty³
 
msg_code
) const

315 
	`£nd_mes§ge
(
msg_code
, 
	`¡ršg
());

316 
¡ršg
 
mes§ge
;

317 
	`g‘_mes§ge
(
mes§ge
, 
REPLY_UPDATE
);

318 cÚ¡ * 
p
 = 
mes§ge
.
	`c_¡r
();

319 cÚ¡ * 
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

320 
doccouÁ
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

321 
Ï¡docid
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

322 
doş’_lbound
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

323 
doş’_ubound
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

324 ià(
p
 =ğ
p_’d
) {

325 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Bad REPLY_UPDATE mes§g»ûived", 
cÚ‹xt
);

327 
has_pos™iÚ®_šfo
 = (*
p
++ == '1');

328 
tÙ®_Ëngth
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

329 
uuid
.
	`assign
(
p
, 
p_’d
);

330 
ÿched_¡©s_v®id
 = 
Œue
;

331 
	}
}

333 
	gX­Ÿn
::
doccouÁ


334 
RemÙeD©aba£
::
	$g‘_doccouÁ
() const

336 ià(!
ÿched_¡©s_v®id
è
	`upd©e_¡©s
();

337  
doccouÁ
;

338 
	}
}

340 
	gX­Ÿn
::
docid


341 
RemÙeD©aba£
::
	$g‘_Ï¡docid
() const

343 ià(!
ÿched_¡©s_v®id
è
	`upd©e_¡©s
();

344  
Ï¡docid
;

345 
	}
}

347 
tÙËn_t


348 
	gRemÙeD©aba£
::
	$g‘_tÙ®_Ëngth
() const

350 ià(!
ÿched_¡©s_v®id
è
	`upd©e_¡©s
();

351  
tÙ®_Ëngth
;

352 
	}
}

354 
	gX­Ÿn
::
doş’gth


355 
RemÙeD©aba£
::
	$g‘_avËngth
() const

357 ià(!
ÿched_¡©s_v®id
è
	`upd©e_¡©s
();

358  
X­Ÿn
::
	`doş’gth
(
tÙ®_Ëngth
è/ 
doccouÁ
;

359 
	}
}

361 
boŞ


362 
	gRemÙeD©aba£
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const

364 
	`As£¹
(!
Šame
.
	`em±y
());

365 
	`£nd_mes§ge
(
MSG_TERMEXISTS
, 
Šame
);

366 
¡ršg
 
mes§ge
;

367 
»¶y_ty³
 
ty³
 = 
	`g‘_mes§ge
(
mes§ge
);

368 ià(
ty³
 !ğ
REPLY_TERMEXISTS
 &&y³ !ğ
REPLY_TERMDOESNTEXIST
) {

369 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Bad mes§g»ûived", 
cÚ‹xt
);

371  (
ty³
 =ğ
REPLY_TERMEXISTS
);

372 
	}
}

374 
	gX­Ÿn
::
doccouÁ


375 
RemÙeD©aba£
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

377 
	`As£¹
(!
Šame
.
	`em±y
());

378 
	`£nd_mes§ge
(
MSG_TERMFREQ
, 
Šame
);

379 
¡ršg
 
mes§ge
;

380 
	`g‘_mes§ge
(
mes§ge
, 
REPLY_TERMFREQ
);

381 cÚ¡ * 
p
 = 
mes§ge
.
	`d©a
();

382 cÚ¡ * 
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

383  
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

384 
	}
}

386 
	gX­Ÿn
::
‹rmcouÁ


387 
RemÙeD©aba£
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

389 
	`As£¹
(!
Šame
.
	`em±y
());

390 
	`£nd_mes§ge
(
MSG_COLLFREQ
, 
Šame
);

391 
¡ršg
 
mes§ge
;

392 
	`g‘_mes§ge
(
mes§ge
, 
REPLY_COLLFREQ
);

393 cÚ¡ * 
p
 = 
mes§ge
.
	`d©a
();

394 cÚ¡ * 
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

395  
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

396 
	}
}

400 
	gRemÙeD©aba£
::
»ad_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
v®no
) const

402 ià(
mru_v®no
 !ğ
v®no
) {

403 
£nd_mes§ge
(
MSG_VALUESTATS
, 
’code_Ëngth
(
v®no
));

404 
¡ršg
 
	gmes§ge
;

405 
g‘_mes§ge
(
mes§ge
, 
REPLY_VALUESTATS
);

406 cÚ¡ * 
	gp
 = 
mes§ge
.
d©a
();

407 cÚ¡ * 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

408 
	gmru_v®no
 = 
v®no
;

409 
	gmru_v®¡©s
.
	gäeq
 = 
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

410 
size_t
 
	gËn
 = 
decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

411 
	gmru_v®¡©s
.
	glow”_bound
.
assign
(
p
, 
Ën
);

412 
	gp
 +ğ
Ën
;

413 
	gËn
 = 
decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

414 
	gmru_v®¡©s
.
	guµ”_bound
.
assign
(
p
, 
Ën
);

415 
	gp
 +ğ
Ën
;

416 ià(
	gp
 !ğ
p_’d
) {

417 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Bad REPLY_VALUESTATS mes§g»ûived", 
cÚ‹xt
);

422 
	gX­Ÿn
::
doccouÁ


423 
RemÙeD©aba£
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const

425 
»ad_v®ue_¡©s
(
v®no
);

426  
	gmru_v®¡©s
.
	gäeq
;

429 
	g¡d
::
¡ršg


430 
RemÙeD©aba£
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

432 
»ad_v®ue_¡©s
(
v®no
);

433  
	gmru_v®¡©s
.
	glow”_bound
;

436 
	g¡d
::
¡ršg


437 
RemÙeD©aba£
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

439 
»ad_v®ue_¡©s
(
v®no
);

440  
	gmru_v®¡©s
.
	guµ”_bound
;

443 
	gX­Ÿn
::
‹rmcouÁ


444 
RemÙeD©aba£
::
	$g‘_doş’gth_low”_bound
() const

446  
doş’_lbound
;

447 
	}
}

449 
	gX­Ÿn
::
‹rmcouÁ


450 
RemÙeD©aba£
::
	$g‘_doş’gth_uµ”_bound
() const

452  
doş’_ubound
;

453 
	}
}

455 
	gX­Ÿn
::
‹rmcouÁ


456 
RemÙeD©aba£
::
	$g‘_wdf_uµ”_bound
(cÚ¡ 
¡ršg
 &) const

462  
doş’_ubound
;

463 
	}
}

465 
	gX­Ÿn
::
‹rmcouÁ


466 
RemÙeD©aba£
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

468 
As£¹
(
did
 != 0);

469 
£nd_mes§ge
(
MSG_DOCLENGTH
, 
’code_Ëngth
(
did
));

470 
¡ršg
 
	gmes§ge
;

471 
g‘_mes§ge
(
mes§ge
, 
REPLY_DOCLENGTH
);

472 cÚ¡ * 
	gp
 = 
mes§ge
.
c_¡r
();

473 cÚ¡ * 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

474 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
 = 
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

475 ià(
	gp
 !ğ
p_’d
) {

476 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Bad REPLY_DOCLENGTH mes§g»ûived", 
cÚ‹xt
);

478  
	gdoş’
;

481 
»¶y_ty³


482 
	gRemÙeD©aba£
::
	$g‘_mes§ge
(
¡ršg
 &
»suÉ
, 
»¶y_ty³
 
»quœed_ty³
) const

484 
OmTime
 
’d_time
;

485 ià(
timeout
è
’d_time
 = 
OmTime
::
	`now
() +imeout;

487 
»¶y_ty³
 
ty³
 = 
¡©ic_ÿ¡
<»¶y_ty³>(
lšk
.
	`g‘_mes§ge
(
»suÉ
, 
’d_time
));

488 ià(
ty³
 =ğ
REPLY_EXCEPTION
) {

489 
	`un£rŸli£_”rÜ
(
»suÉ
, "REMOTE:", 
cÚ‹xt
);

491 ià(
»quœed_ty³
 !ğ
REPLY_MAX
 && 
ty³
 !=„equired_type) {

492 
¡ršg
 
	`”rmsg
("Expecting„eplyype ");

493 
”rmsg
 +ğ
	`om_to¡ršg
((
»quœed_ty³
));

494 
”rmsg
 += ", got ";

495 
”rmsg
 +ğ
	`om_to¡ršg
((
ty³
));

496 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
(
”rmsg
);

499  
ty³
;

500 
	}
}

503 
	gRemÙeD©aba£
::
	$£nd_mes§ge
(
mes§ge_ty³
 
ty³
, cÚ¡ 
¡ršg
 &
mes§ge
) const

505 
OmTime
 
’d_time
;

506 ià(
timeout
è
’d_time
 = 
OmTime
::
	`now
() +imeout;

508 
lšk
.
	`£nd_mes§ge
(
¡©ic_ÿ¡
<>(
ty³
), 
mes§ge
, 
’d_time
);

509 
	}
}

512 
	gRemÙeD©aba£
::
	$do_şo£
()

517 
boŞ
 
wr™abË
 = (
Œª§ùiÚ_¡©e
 !ğ
TRANSACTION_UNIMPLEMENTED
);

520 ià(
wr™abË
è
	`dtÜ_ÿÎed
();

526 
lšk
.
	`do_şo£
(
wr™abË
);

527 
	}
}

530 
	gRemÙeD©aba£
::
£t_qu”y
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
,

531 
X­Ÿn
::
‹rmcouÁ
 
qËn
,

532 
X­Ÿn
::
doccouÁ
 
cŞÏp£_max
,

533 
X­Ÿn
::
v®u’o
 
cŞÏp£_key
,

534 
X­Ÿn
::
Enquœe
::
docid_Üd”
 
Üd”
,

535 
X­Ÿn
::
v®u’o
 
sÜt_key
,

536 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
sÜt_by
,

537 
boŞ
 
sÜt_v®ue_fÜw¬d
,

538 
³rûÁ_cutoff
, 
X­Ÿn
::
weight
 
weight_cutoff
,

539 cÚ¡ 
X­Ÿn
::
Weight
 *
wtscheme
,

540 cÚ¡ 
X­Ÿn
::
RS‘
 &
omr£t
,

541 cÚ¡ 
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s
)

543 
¡ršg
 
tmp
 = 
qu”y
->
£rŸli£
();

544 
¡ršg
 
	gmes§ge
 = 
’code_Ëngth
(
tmp
.
size
());

545 
	gmes§ge
 +ğ
tmp
;

548 
	gmes§ge
 +ğ
’code_Ëngth
(
qËn
);

549 
	gmes§ge
 +ğ
’code_Ëngth
(
cŞÏp£_max
);

550 ià(
	gcŞÏp£_max
è
	gmes§ge
 +ğ
’code_Ëngth
(
cŞÏp£_key
);

551 
	gmes§ge
 +ğ('0' + 
Üd”
);

552 
	gmes§ge
 +ğ
’code_Ëngth
(
sÜt_key
);

553 
	gmes§ge
 +ğ('0' + 
sÜt_by
);

554 
	gmes§ge
 +ğ('0' + 
sÜt_v®ue_fÜw¬d
);

555 
	gmes§ge
 +ğ(
³rûÁ_cutoff
);

556 
	gmes§ge
 +ğ
£rŸli£_doubË
(
weight_cutoff
);

558 
	gtmp
 = 
wtscheme
->
Çme
();

559 
	gmes§ge
 +ğ
’code_Ëngth
(
tmp
.
size
());

560 
	gmes§ge
 +ğ
tmp
;

562 
	gtmp
 = 
wtscheme
->
£rŸli£
();

563 
	gmes§ge
 +ğ
’code_Ëngth
(
tmp
.
size
());

564 
	gmes§ge
 +ğ
tmp
;

566 
	gtmp
 = 
£rŸli£_r£t
(
omr£t
);

567 
	gmes§ge
 +ğ
’code_Ëngth
(
tmp
.
size
());

568 
	gmes§ge
 +ğ
tmp
;

570 
	gveùÜ
<
	gX­Ÿn
::
M©chSpy
 *>::
cÚ¡_™”©Ü
 
i
;

571 
	gi
 = 
m©ch¥›s
.
begš
(); i !ğm©ch¥›s.
’d
(); ++i) {

572 
	gtmp
 = (*
i
)->
Çme
();

573 ià(
	gtmp
.
em±y
()) {

574 
throw
 
	gX­Ÿn
::
Unim¶em’‹dE¼Ü
("MatchSpy‚ot suitable for use with„emote searches -‚ame() method„eturnedƒmpty string");

576 
	gmes§ge
 +ğ
’code_Ëngth
(
tmp
.
size
());

577 
	gmes§ge
 +ğ
tmp
;

579 
	gtmp
 = (*
i
)->
£rŸli£
();

580 
	gmes§ge
 +ğ
’code_Ëngth
(
tmp
.
size
());

581 
	gmes§ge
 +ğ
tmp
;

584 
£nd_mes§ge
(
MSG_QUERY
, 
mes§ge
);

587 
boŞ


588 
	gRemÙeD©aba£
::
g‘_»mÙe_¡©s
(
boŞ
 
nowa™
, 
X­Ÿn
::
Weight
::
IÁ”Çl
 &
out
)

590 ià(
nowa™
 && !
lšk
.
»ady_to_»ad
()è 
çl£
;

592 
¡ršg
 
	gmes§ge
;

593 
g‘_mes§ge
(
mes§ge
, 
REPLY_STATS
);

594 
	gout
 = 
un£rŸli£_¡©s
(
mes§ge
);

596  
	gŒue
;

600 
	gRemÙeD©aba£
::
£nd_glob®_¡©s
(
X­Ÿn
::
doccouÁ
 
fœ¡
,

601 
X­Ÿn
::
doccouÁ
 
max™ems
,

602 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

603 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 &
¡©s
)

605 
¡ršg
 
mes§ge
 = 
’code_Ëngth
(
fœ¡
);

606 
	gmes§ge
 +ğ
’code_Ëngth
(
max™ems
);

607 
	gmes§ge
 +ğ
’code_Ëngth
(
check_©_Ëa¡
);

608 
	gmes§ge
 +ğ
£rŸli£_¡©s
(
¡©s
);

609 
£nd_mes§ge
(
MSG_GETMSET
, 
mes§ge
);

613 
	gRemÙeD©aba£
::
g‘_m£t
(
X­Ÿn
::
MS‘
 &
m£t
,

614 cÚ¡ 
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s
)

616 
¡ršg
 
mes§ge
;

617 
g‘_mes§ge
(
mes§ge
, 
REPLY_RESULTS
);

618 cÚ¡ * 
	gp
 = 
mes§ge
.
d©a
();

619 cÚ¡ * 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

621 
	gveùÜ
<
	gX­Ÿn
::
M©chSpy
 *>::
cÚ¡_™”©Ü
 
i
;

622 
	gi
 = 
m©ch¥›s
.
begš
(); i !ğm©ch¥›s.
’d
(); ++i) {

623 ià(
	gp
 =ğ
p_’d
)

624 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Expected serialised matchspy");

625 
size_t
 
	gËn
 = 
decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

626 
¡ršg
 
¥y»suÉs
(
p
, 
Ën
);

627 
	gp
 +ğ
Ën
;

628 (*
	gi
)->
m”ge_»suÉs
(
¥y»suÉs
);

630 
	gm£t
 = 
un£rŸli£_m£t
(
p
, 
p_’d
);

634 
	gRemÙeD©aba£
::
	$comm™
()

636 
	`£nd_mes§ge
(
MSG_COMMIT
, 
	`¡ršg
());

639 
¡ršg
 
mes§ge
;

640 
	`g‘_mes§ge
(
mes§ge
, 
REPLY_DONE
);

641 
	}
}

644 
	gRemÙeD©aba£
::
	$ÿnûl
()

646 
ÿched_¡©s_v®id
 = 
çl£
;

647 
mru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

649 
	`£nd_mes§ge
(
MSG_CANCEL
, 
	`¡ršg
());

650 
	}
}

652 
	gX­Ÿn
::
docid


653 
RemÙeD©aba£
::
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
)

655 
ÿched_¡©s_v®id
 = 
çl£
;

656 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

658 
£nd_mes§ge
(
MSG_ADDDOCUMENT
, 
£rŸli£_docum’t
(
doc
));

660 
¡ršg
 
	gmes§ge
;

661 
g‘_mes§ge
(
mes§ge
, 
REPLY_ADDDOCUMENT
);

663 cÚ¡ * 
	gp
 = 
mes§ge
.
d©a
();

664 cÚ¡ * 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

665  
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

669 
	gRemÙeD©aba£
::
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
)

671 
ÿched_¡©s_v®id
 = 
çl£
;

672 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

674 
£nd_mes§ge
(
MSG_DELETEDOCUMENT
, 
’code_Ëngth
(
did
));

675 
¡ršg
 
	gdummy
;

676 
g‘_mes§ge
(
dummy
, 
REPLY_DONE
);

680 
	gRemÙeD©aba£
::
d–‘e_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
unique_‹rm
)

682 
ÿched_¡©s_v®id
 = 
çl£
;

683 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

685 
£nd_mes§ge
(
MSG_DELETEDOCUMENTTERM
, 
unique_‹rm
);

689 
	gRemÙeD©aba£
::
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

690 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
)

692 
ÿched_¡©s_v®id
 = 
çl£
;

693 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

695 
¡ršg
 
	gmes§ge
 = 
’code_Ëngth
(
did
);

696 
	gmes§ge
 +ğ
£rŸli£_docum’t
(
doc
);

698 
£nd_mes§ge
(
MSG_REPLACEDOCUMENT
, 
mes§ge
);

701 
	gX­Ÿn
::
docid


702 
RemÙeD©aba£
::
»¶aû_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
unique_‹rm
,

703 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
)

705 
ÿched_¡©s_v®id
 = 
çl£
;

706 
	gmru_v®no
 = 
X­Ÿn
::
BAD_VALUENO
;

708 
¡ršg
 
	gmes§ge
 = 
’code_Ëngth
(
unique_‹rm
.
size
());

709 
	gmes§ge
 +ğ
unique_‹rm
;

710 
	gmes§ge
 +ğ
£rŸli£_docum’t
(
doc
);

712 
£nd_mes§ge
(
MSG_REPLACEDOCUMENTTERM
, 
mes§ge
);

714 
g‘_mes§ge
(
mes§ge
, 
REPLY_ADDDOCUMENT
);

716 cÚ¡ * 
	gp
 = 
mes§ge
.
d©a
();

717 cÚ¡ * 
	gp_’d
 = 
p
 + 
mes§ge
.
size
();

718  
decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

721 
¡ršg


722 
	gRemÙeD©aba£
::
	$g‘_uuid
() const

724  
uuid
;

725 
	}
}

727 
¡ršg


728 
	gRemÙeD©aba£
::
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const

730 
	`£nd_mes§ge
(
MSG_GETMETADATA
, 
key
);

731 
¡ršg
 
m‘ad©a
;

732 
	`g‘_mes§ge
(
m‘ad©a
, 
REPLY_METADATA
);

733  
m‘ad©a
;

734 
	}
}

737 
	gRemÙeD©aba£
::
	$£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
)

739 
¡ršg
 
d©a
 = 
	`’code_Ëngth
(
key
.
	`size
());

740 
d©a
 +ğ
key
;

741 
d©a
 +ğ
v®ue
;

742 
	`£nd_mes§ge
(
MSG_SETMETADATA
, 
d©a
);

743 
	}
}

	@backends/remote/remote-document.cc

21 
	~<cÚfig.h
>

23 
	~"»mÙe-docum’t.h
"

25 
	~"debuglog.h
"

26 
	~"omas£¹.h
"

28 
¡ršg


29 
	gRemÙeDocum’t
::
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
) const

31 
LOGCALL
(
DB
, 
¡ršg
, "RemoteDocument::do_get_value", "[slot]");

33 
As£¹
(
çl£
);

34 
RETURN
(
¡ršg
());

38 
	gRemÙeDocum’t
::
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> &) const

40 
LOGCALL_VOID
(
DB
, "RemoteDocument::do_get_all_values", "[&values_]");

42 
As£¹
(
çl£
);

45 
¡ršg


46 
	gRemÙeDocum’t
::
	$do_g‘_d©a
() const

48 
	`LOGCALL
(
DB
, 
¡ršg
, "RemoteDocument::do_get_data", "");

50 
	`As£¹
(
çl£
);

51 
	`RETURN
(
	`¡ršg
());

52 
	}
}

	@backends/remote/remote-document.h

21 #iâdeà
XAPIAN_INCLUDED_REMOTE_DOCUMENT_H


22 
	#XAPIAN_INCLUDED_REMOTE_DOCUMENT_H


	)

24 
	~"d©aba£.h
"

25 
	~"docum’t.h
"

28 şas 
	cRemÙeDocum’t
 : 
public
 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 {

30 
İ”©Ü
=(cÚ¡ 
RemÙeDocum’t
 &);

33 
RemÙeDocum’t
(const RemoteDocument &);

36 
ä›nd
 
şass
 
	mRemÙeD©aba£
;

43 
RemÙeDocum’t
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
db
, X­Ÿn::
docid
 
did_
,

44 cÚ¡ 
¡ršg
 & 
d©a_
,

45 
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> &
v®ues_
)

46 : 
X­Ÿn
::
Docum’t
::
	$IÁ”Çl
(
db
, 
did_
)

48 
	`£t_d©a
(
d©a_
);

49 
	`£t_®l_v®ues
(
v®ues_
);

52 
public
:

54 
¡ršg
 
	`do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

55 
	`do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const;

56 
¡ršg
 
	$do_g‘_d©a
() const;

58 
	}
};

	@backends/slowvaluelist.cc

21 
	~<cÚfig.h
>

23 
	~"¦owv®u–i¡.h
"

25 
	~"docum’t.h
"

26 
	~"uts.h
"

28 
	~"x­Ÿn/”rÜ.h
"

30 
	~"autİŒ.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	gX­Ÿn
::
docid


35 
SlowV®ueLi¡
::
	$g‘_docid
() const

37  
cu¼’t_did
;

38 
	}
}

40 
¡ršg


41 
	gSlowV®ueLi¡
::
	$g‘_v®ue
() const

43  
cu¼’t_v®ue
;

44 
	}
}

46 
	gX­Ÿn
::
v®u’o


47 
SlowV®ueLi¡
::
	$g‘_v®u’o
() const

49  
¦Ù
;

50 
	}
}

52 
boŞ


53 
	gSlowV®ueLi¡
::
	$©_’d
() const

55  
Ï¡_docid
 == 0;

56 
	}
}

59 
	gSlowV®ueLi¡
::
	$Ãxt
()

64 
cu¼’t_did
++ < 
Ï¡_docid
) {

65 
Œy
 {

68 
AutoPŒ
<
X­Ÿn
::
Docum’t
::
IÁ”Çl
>

69 
	`doc
(
db
.
	`g‘_docum’t_Ïzy
(
cu¼’t_did
));

70 ià(!
doc
.
	`g‘
()) ;

71 
¡ršg
 
v®ue
 = 
doc
->
	`g‘_v®ue
(
¦Ù
);

72 ià(!
v®ue
.
	`em±y
()) {

73 
	`sw­
(
cu¼’t_v®ue
, 
v®ue
);

76 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
DocNÙFoundE¼Ü
 &) {

81 
Ï¡_docid
 = 0;

82 
	}
}

85 
	gSlowV®ueLi¡
::
sk_to
(
X­Ÿn
::
docid
 
did
)

87 ià(
did
 <ğ
cu¼’t_did
) ;

89 ià(
	gdid
 > 
	gÏ¡_docid
) {

91 
	gÏ¡_docid
 = 0;

95 
	gcu¼’t_did
 = 
did
 - 1;

96 
Ãxt
();

99 
boŞ


100 
	gSlowV®ueLi¡
::
check
(
X­Ÿn
::
docid
 
did
)

102 ià(
did
 <ğ
cu¼’t_did
è 
Œue
;

104 ià(
	gdid
 > 
	gÏ¡_docid
) {

106 
	gÏ¡_docid
 = 0;

107  
	gŒue
;

110 
	gcu¼’t_did
 = 
did
;

111 
	gŒy
 {

112 
	gAutoPŒ
<
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
>

113 
doc
(
db
.
g‘_docum’t_Ïzy
(
cu¼’t_did
));

114 ià(
	gdoc
.
g‘
()) {

115 
	gcu¼’t_v®ue
 = 
doc
->
g‘_v®ue
(
¦Ù
);

116 ià(!
	gcu¼’t_v®ue
.
em±y
()è 
	gŒue
;

118 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
DocNÙFoundE¼Ü
 &) {

120  
çl£
;

123 
¡ršg


124 
	gSlowV®ueLi¡
::
	$g‘_desütiÚ
() const

126 
¡ršg
 
desc
 = "SlowValueList(slot=";

127 
desc
 +ğ
	`om_to¡ršg
(
¦Ù
);

128 ià(
Ï¡_docid
 != 0) {

129 
desc
 += ", docid=";

130 
desc
 +ğ
	`om_to¡ršg
(
cu¼’t_did
);

131 
desc
 += ", value=\"";

132 
desc
 +ğ
cu¼’t_v®ue
;

133 
desc
 += "\")";

135 
desc
 += ",‡tend)";

137  
desc
;

138 
	}
}

	@backends/slowvaluelist.h

21 #iâdeà
XAPIAN_INCLUDED_SLOWVALUELIST_H


22 
	#XAPIAN_INCLUDED_SLOWVALUELIST_H


	)

24 
	~"v®u–i¡.h
"

26 
	~"x­Ÿn/d©aba£.h
"

32 şas 
	cSlowV®ueLi¡
 : 
public
 
V®ueLi¡
 {

34 
İ”©Ü
=(cÚ¡ 
SlowV®ueLi¡
 &);

37 
SlowV®ueLi¡
(const SlowValueList &);

40 
	mX­Ÿn
::
D©aba£
 
db
;

43 
	mX­Ÿn
::
docid
 
Ï¡_docid
;

46 
	mX­Ÿn
::
v®u’o
 
¦Ù
;

49 
	m¡d
::
¡ršg
 
cu¼’t_v®ue
;

52 
	mX­Ÿn
::
docid
 
cu¼’t_did
;

54 
	mpublic
:

55 
SlowV®ueLi¡
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db_
, X­Ÿn::
v®u’o
 
¦Ù_
)

56 : 
db
(
db_
), 
Ï¡_docid
(db.
g‘_Ï¡docid
()), 
¦Ù
(
¦Ù_
), 
	$cu¼’t_did
(0)

59 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

61 
¡d
::
¡ršg
 
	$g‘_v®ue
() const;

63 
X­Ÿn
::
v®u’o
 
	$g‘_v®u’o
() const;

65 
boŞ
 
	$©_’d
() const;

67 
	`Ãxt
();

69 
	`sk_to
(
X­Ÿn
::
docid
);

71 
boŞ
 
	`check
(
X­Ÿn
::
docid
 
did
);

73 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

74 
	}
};

	@backends/valuelist.cc

21 
	~<cÚfig.h
>

23 
	~"v®u–i¡.h
"

25 
Çme¥aû
 
	gX­Ÿn
 {

27 
	gV®ueI‹¿tÜ
::
IÁ”Çl
::~Internal() { }

29 
boŞ


30 
V®ueI‹¿tÜ
::
IÁ”Çl
::
check
(
X­Ÿn
::
docid
 
did
)

32 
sk_to
(
did
);

33  
	gŒue
;

	@bin/xapian-check-brass.cc

23 
	~<cÚfig.h
>

25 
	~"x­Ÿn-check-b¿ss.h
"

27 
	~"b™¡»am.h
"

29 
	~"š‹º®ty³s.h
"

31 
	~"b¿ss_check.h
"

32 
	~"b¿ss_cursÜ.h
"

33 
	~"b¿ss_bË.h
"

34 
	~"b¿ss_ty³s.h
"

35 
	~"·ck.h
"

36 
	~"v®ue¡©s.h
"

38 
	~<x­Ÿn.h
>

40 
	~"autİŒ.h
"

41 
	~<io¡»am
>

43 
usšg
 
Çme¥aû
 
	g¡d
;

45 
šlše
 
boŞ


46 
	$is_u£r_m‘ad©a_key
(cÚ¡ 
¡ršg
 & 
key
)

48  
key
.
	`size
() > 1 && key[0] == '\0' && key[1] == '\xc0';

49 
	}
}

51 
	gVSts
 : 
public
 
V®ueSts
 {

52 
X­Ÿn
::
doccouÁ
 
äeq_»®
;

54 
VSts
(è: 
V®ueSts
(), 
äeq_»®
(0) {}

57 
size_t


58 
check_b¿ss_bË
(cÚ¡ * 
bËÇme
, 
¡ršg
 
f’ame
, 
İts
,

59 
veùÜ
<
X­Ÿn
::
‹rmcouÁ
> & 
doş’s
,

60 
X­Ÿn
::
docid
 
db_Ï¡_docid
)

62 
f’ame
 += '.';

65 
	gB¿ssTabËCheck
::
check
(
bËÇme
, 
f’ame
, 
İts
);

68 
B¿ssTabË
 
bË
(
bËÇme
, 
f’ame
, 
Œue
);

69 
	gbË
.
İ’
();

70 
	gAutoPŒ
<
	gB¿ssCursÜ
> 
cursÜ
(
bË
.
cursÜ_g‘
());

72 
size_t
 
	g”rÜs
 = 0;

74 
	gcursÜ
->
fšd_’Œy
("");

75 
	gcursÜ
->
Ãxt
();

77 ià(
¡rcmp
(
bËÇme
, "postlist") == 0) {

79 
m­
<
X­Ÿn
::
v®u’o
, 
VSts
> 
v®ue¡©s
;

80 
¡ršg
 
	gcu¼’t_‹rm
;

81 
	gX­Ÿn
::
docid
 
Ï¡did
 = 0;

82 
	gX­Ÿn
::
‹rmcouÁ
 
‹rmäeq
 = 0, 
	gcŞläeq
 = 0;

83 
	gX­Ÿn
::
‹rmcouÁ
 
tf
 = 0, 
	gcf
 = 0;

84 
boŞ
 
	ghave_m‘ašfo_key
 = 
çl£
;

88 ià(!
	gcursÜ
->
aá”_’d
()) {

89 ià(
	gcursÜ
->
	gcu¼’t_key
 =ğ
¡ršg
("", 1)) {

90 
	ghave_m‘ašfo_key
 = 
Œue
;

91 
	gcursÜ
->
»ad_g
();

93 
tÙËn_t
 
	gtÙ®_doş’
;

94 
	gX­Ÿn
::
docid
 
Ï¡_docid
;

95 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_lbound
;

96 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_ubound
;

97 
	gX­Ÿn
::
‹rmcouÁ
 
wdf_ubound
;

99 cÚ¡ * 
	gd©a
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

100 cÚ¡ * 
	g’d
 = 
d©a
 + 
cursÜ
->
cu¼’t_g
.
size
();

101 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
Ï¡_docid
)) {

102 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»ad†a¡_docid)." << 
	g’dl
;

103 ++
	g”rÜs
;

104 } ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
doş’_lbound
)) {

105 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»ad doş’_lbound)." << 
	g’dl
;

106 ++
	g”rÜs
;

107 } ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
wdf_ubound
)) {

108 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»ad wdf_ubound)." << 
	g’dl
;

109 ++
	g”rÜs
;

110 } ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
doş’_ubound
)) {

111 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»ad doş’_ubound)." << 
	g’dl
;

112 ++
	g”rÜs
;

113 } ià(!
uÅack_ušt_Ï¡
(&
d©a
, 
’d
, &
tÙ®_doş’
)) {

114 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»adÙ®_doş’)." << 
	g’dl
;

115 ++
	g”rÜs
;

116 } ià(
	gd©a
 !ğ
’d
) {

117 
cout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (junk‡ˆ’d)." << 
’dl
;

118 ++
	g”rÜs
;

120 
	gcursÜ
->
Ãxt
();

124  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

125 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

127 ià(
is_u£r_m‘ad©a_key
(
key
)) {

130 
	gcursÜ
->
»ad_g
();

131 ià(
	gcursÜ
->
	gcu¼’t_g
.
em±y
()) {

132 
	gcout
 << "U£¸m‘ad©¨™em i em±y" << 
	g’dl
;

133 ++
	g”rÜs
;

138 ià(!
	ghave_m‘ašfo_key
) {

139 
	gcout
 << "METAINFO key missšg from…o¡li¡abË" << 
	g’dl
;

140 ++
	g”rÜs
;

143 ià(
	gkey
.
size
(è>ğ2 && 
key
[0] == '\0' && key[1] == '\xe0') {

145 cÚ¡ * 
pos
, * 
’d
;

146 
	gX­Ÿn
::
docid
 
did
 = 1;

147 ià(
	gkey
.
size
() > 2) {

149 
	gpos
 = 
key
.
d©a
();

150 
	g’d
 = 
pos
 + 
key
.
size
();

151 
	gpos
 += 2;

152 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

153 
	gcout
 << "E¼Ü uÅackšg docid from doş’ key" << 
	g’dl
;

154 ++
	g”rÜs
;

159 
	gcursÜ
->
»ad_g
();

160 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

161 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

162 ià(
	gkey
.
size
() == 2) {

164 ià(
’d
 - 
pos
 < 2 ||…os[0] ||…os[1]) {

165 
cout
 << "In™ŸÈdoş’ chunk ha nÚz”Ødummy f›lds" << 
’dl
;

166 ++
	g”rÜs
;

169 
	gpos
 += 2;

170 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
did
)) {

171 
	gcout
 << "FaedØuÅack fœ¡did fÜ doş’" << 
	g’dl
;

172 ++
	g”rÜs
;

175 ++
	gdid
;

176 ià(
	gdid
 <ğ
Ï¡did
) {

177 
cout
 << "First did inhis chunk is <=†ast in "

178 "´ev chunk" << 
’dl
;

179 ++
	g”rÜs
;

183 
boŞ
 
	gis_Ï¡_chunk
;

184 ià(!
uÅack_boŞ
(&
pos
, 
’d
, &
is_Ï¡_chunk
)) {

185 
	gcout
 << "FaedØuÅack†a¡ chunk fÏg fÜ doş’" << 
	g’dl
;

186 ++
	g”rÜs
;

190 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
Ï¡did
)) {

191 
	gcout
 << "FaedØuÅack inü—£ØÏ¡" << 
	g’dl
;

192 ++
	g”rÜs
;

195 
	gÏ¡did
 +ğ
did
;

196 
boŞ
 
	gbad
 = 
çl£
;

197 
	gŒue
) {

198 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
;

199 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

200 
	gcout
 << "FaedØuÅack doş’" << 
	g’dl
;

201 ++
	g”rÜs
;

202 
	gbad
 = 
Œue
;

206 ià(
	gdid
 > 
	gdb_Ï¡_docid
) {

207 
	gcout
 << "docum’ˆid " << 
	gdid
 << " in doclen stream "

209 << 
	gdb_Ï¡_docid
 << 
	g’dl
;

210 ++
	g”rÜs
;

213 ià(!
	gdoş’s
.
em±y
()) {

216 
	gX­Ÿn
::
‹rmcouÁ
 
‹rmli¡_doş’
 = 0;

217 ià(
	gdid
 < 
	gdoş’s
.
size
())

218 
	g‹rmli¡_doş’
 = 
doş’s
[
did
];

220 ià(
	gdoş’
 !ğ
‹rmli¡_doş’
) {

221 
cout
 << "doş’ " << 
doş’
 << " doesn't match "

222 << 
‹rmli¡_doş’


223 << " iÀth‹rmli¡abË" << 
’dl
;

224 ++
	g”rÜs
;

228 ià(
	gpos
 =ğ
’d
) ;

230 
	gX­Ÿn
::
docid
 
šc
;

231 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
šc
)) {

232 
	gcout
 << "FaedØuÅack docid inü—£" << 
	g’dl
;

233 ++
	g”rÜs
;

234 
	gbad
 = 
Œue
;

237 ++
	gšc
;

238 
	gdid
 +ğ
šc
;

239 ià(
	gdid
 > 
	gÏ¡did
) {

240 
	gcout
 << "docid " << 
	gdid
 << " >†a¡ docid " << 
	gÏ¡did


241 << 
	g’dl
;

242 ++
	g”rÜs
;

245 ià(
	gbad
) {

248 ià(
	gis_Ï¡_chunk
) {

249 ià(
	gdid
 !ğ
Ï¡did
) {

250 
cout
 << "Ï¡did " << 
Ï¡did
 << " !ğÏ¡ did " << 
did


251 << 
’dl
;

252 ++
	g”rÜs
;

259 ià(
	gkey
.
size
(è>ğ2 && 
key
[0] == '\0' && key[1] == '\xd0') {

261 cÚ¡ * 
p
 = 
key
.
d©a
();

262 cÚ¡ * 
	g’d
 = 
p
 + 
key
.
Ëngth
();

263 
	gp
 += 2;

264 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

265 ià(!
uÅack_ušt_Ï¡
(&
p
, 
’d
, &
¦Ù
)) {

266 
	gcout
 << "Bad v®ue¡© key (nØ¦Ù)" << 
	g’dl
;

267 ++
	g”rÜs
;

271 
	gcursÜ
->
»ad_g
();

272 
	gp
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

273 
	g’d
 = 
p
 + 
cursÜ
->
cu¼’t_g
.
size
();

275 
	gVSts
 & 
	gv
 = 
v®ue¡©s
[
¦Ù
];

276 ià(!
uÅack_ušt
(&
p
, 
’d
, &
v
.
äeq
)) {

277 ià(*
	gp
 == 0) {

278 
cout
 << "Incom¶‘¡© ™em iÀv®ubË" << 
’dl
;

280 
	gcout
 << "F»qu’cy sti¡iøš v®ubË i toØÏrge" << 
	g’dl
;

282 ++
	g”rÜs
;

285 ià(!
uÅack_¡ršg
(&
p
, 
’d
, 
v
.
low”_bound
)) {

286 ià(*
	gp
 == 0) {

287 
cout
 << "Incom¶‘¡© ™em iÀv®ubË" << 
’dl
;

289 
	gcout
 << "Low” bound sti¡iøš v®ubË i toØÏrge" << 
	g’dl
;

291 ++
	g”rÜs
;

294 
size_t
 
	gËn
 = 
’d
 - 
p
;

295 ià(
	gËn
 == 0) {

296 
v
.
uµ”_bound
 = v.
low”_bound
;

298 
	gv
.
	guµ”_bound
.
assign
(
p
, 
Ën
);

304 ià(
	gkey
.
size
(è>ğ2 && 
key
[0] == '\0' && key[1] == '\xd8') {

306 cÚ¡ * 
p
 = 
key
.
d©a
();

307 cÚ¡ * 
	g’d
 = 
p
 + 
key
.
Ëngth
();

308 
	gp
 += 2;

309 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

310 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
)) {

311 
	gcout
 << "Bad v®uchunk key (nØ¦Ù)" << 
	g’dl
;

312 ++
	g”rÜs
;

315 
	gX­Ÿn
::
docid
 
did
;

316 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
p
, 
’d
, &
did
)) {

317 
	gcout
 << "Bad v®uchunk key (nØdocid)" << 
	g’dl
;

318 ++
	g”rÜs
;

321 ià(
	gp
 !ğ
’d
) {

322 
cout
 << "Bad v®uchunk key (Œašg junk)" << 
’dl
;

323 ++
	g”rÜs
;

327 
	gVSts
 & 
	gv
 = 
v®ue¡©s
[
¦Ù
];

329 
	gcursÜ
->
»ad_g
();

330 
	gp
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

331 
	g’d
 = 
p
 + 
cursÜ
->
cu¼’t_g
.
size
();

333 
	gŒue
) {

334 
¡ršg
 
	gv®ue
;

335 ià(!
uÅack_¡ršg
(&
p
, 
’d
, 
v®ue
)) {

336 
	gcout
 << "FaedØuÅack v®uäom chunk" << 
	g’dl
;

337 ++
	g”rÜs
;

341 ++
	gv
.
	gäeq_»®
;

349 ià(
	gv®ue
 < 
	gv
.
	glow”_bound
) {

350 
	gcout
 << "V®u¦Ù " << 
	g¦Ù
 << " has value below "

351 "low” bound: '" << 
	gv®ue
 << "' < '"

352 << 
	gv
.
	glow”_bound
 << "'" << 
	g’dl
;

353 ++
	g”rÜs
;

354 } ià(
	gv®ue
 > 
	gv
.
	guµ”_bound
) {

355 
	gcout
 << "V®u¦Ù " << 
	g¦Ù
 << " has value‡bove "

356 "uµ” bound: '" << 
	gv®ue
 << "' > '"

357 << 
	gv
.
	guµ”_bound
 << "'" << 
	g’dl
;

358 ++
	g”rÜs
;

361 ià(
	gp
 =ğ
’d
) ;

362 
	gX­Ÿn
::
docid
 
d–
;

363 ià(!
uÅack_ušt
(&
p
, 
’d
, &
d–
)) {

364 
	gcout
 << "FaedØuÅack docid d– from chunk" << 
	g’dl
;

365 ++
	g”rÜs
;

368 
	gX­Ÿn
::
docid
 
Ãw_did
 = 
did
 + 
d–
 + 1;

369 ià(
	gÃw_did
 <ğ
did
) {

370 
cout
 << "docid ov”æowed iÀv®uchunk" << 
’dl
;

371 ++
	g”rÜs
;

374 
	gdid
 = 
Ãw_did
;

376 ià(
	gdid
 > 
	gdb_Ï¡_docid
) {

377 
	gcout
 << "docum’ˆid " << 
	gdid
 << " in value chunk "

379 << 
	gdb_Ï¡_docid
 << 
	g’dl
;

380 ++
	g”rÜs
;

386 cÚ¡ * 
	gpos
, * 
	g’d
;

389 
	gpos
 = 
key
.
d©a
();

390 
	g’d
 = 
pos
 + 
key
.
size
();

392 
¡ršg
 
	g‹rm
;

393 
	gX­Ÿn
::
docid
 
did
;

394 ià(!
uÅack_¡ršg_´e£rvšg_sÜt
(&
pos
, 
’d
, 
‹rm
)) {

395 
	gcout
 << "E¼Ü uÅackšg”mÇmäom key" << 
	g’dl
;

396 ++
	g”rÜs
;

399 ià(!
	gcu¼’t_‹rm
.
em±y
(è&& 
	g‹rm
 !ğ
cu¼’t_‹rm
) {

401 ià(
pos
 =ğ
’d
) {

402 
cout
 << "NØÏ¡ chunk fÜ”m `" << 
cu¼’t_‹rm


403 << "'" << 
’dl
;

404 
	gcu¼’t_‹rm
.
»size
(0);

406 
	gcout
 << "Mismatch in follow-on chunk in…osting "

407 "li¡ fÜ”m `" << 
	gcu¼’t_‹rm
 << "' (got `"

408 << 
	g‹rm
 << "')" << 
	g’dl
;

409 
	gcu¼’t_‹rm
 = 
‹rm
;

410 
	gtf
 = 
cf
 = 0;

411 
	gÏ¡did
 = 0;

413 ++
	g”rÜs
;

415 ià(
	gpos
 =ğ
’d
) {

417 ià(
‹rm
 =ğ
cu¼’t_‹rm
) {

419 
cout
 << "First…osting†ist chunk forerm `"

420 << 
‹rm
 << "' follows…revious chunk forhe same "

421 "‹rm" << 
’dl
;

422 ++
	g”rÜs
;

424 
	gcu¼’t_‹rm
 = 
‹rm
;

425 
	gtf
 = 
cf
 = 0;

428 
	gcursÜ
->
»ad_g
();

429 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

430 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

431 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
‹rmäeq
)) {

432 
	gcout
 << "FaedØuÅack”mäeq fÜ”m `" << 
	g‹rm


433 << "'" << 
	g’dl
;

434 ++
	g”rÜs
;

437 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
cŞläeq
)) {

438 
	gcout
 << "FaedØuÅack cŞläeq fÜ”m `" << 
	g‹rm


439 << "'" << 
	g’dl
;

440 ++
	g”rÜs
;

443 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
did
)) {

444 
	gcout
 << "FaedØuÅack fœ¡did fÜ”m `" << 
	g‹rm


445 << "'" << 
	g’dl
;

446 ++
	g”rÜs
;

449 ++
	gdid
;

452 ià(
	gcu¼’t_‹rm
.
em±y
()) {

453 
	gcout
 << "Fœ¡ chunk fÜ”m `" << 
	gcu¼’t_‹rm
 << "' "

454 "i ¨cÚtšu©iÚ chunk" << 
	g’dl
;

455 ++
	g”rÜs
;

456 
	gcu¼’t_‹rm
 = 
‹rm
;

458 
As£¹Eq
(
cu¼’t_‹rm
, 
‹rm
);

459 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

460 
	gcout
 << "FaedØuÅack did from key" << 
	g’dl
;

461 ++
	g”rÜs
;

464 ià(
	gdid
 <ğ
Ï¡did
) {

465 
cout
 << "First did inhis chunk is <=†ast in "

466 "´ev chunk" << 
’dl
;

467 ++
	g”rÜs
;

469 
	gcursÜ
->
»ad_g
();

470 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

471 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

474 
boŞ
 
	gis_Ï¡_chunk
;

475 ià(!
uÅack_boŞ
(&
pos
, 
’d
, &
is_Ï¡_chunk
)) {

476 
	gcout
 << "FaedØuÅack†a¡ chunk fÏg" << 
	g’dl
;

477 ++
	g”rÜs
;

481 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
Ï¡did
)) {

482 
	gcout
 << "FaedØuÅack inü—£ØÏ¡" << 
	g’dl
;

483 ++
	g”rÜs
;

486 
	gÏ¡did
 +ğ
did
;

487 
boŞ
 
	gbad
 = 
çl£
;

488 
	gŒue
) {

489 
	gX­Ÿn
::
‹rmcouÁ
 
wdf
;

490 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
wdf
)) {

491 
	gcout
 << "FaedØuÅack wdf" << 
	g’dl
;

492 ++
	g”rÜs
;

493 
	gbad
 = 
Œue
;

496 ++
	gtf
;

497 
	gcf
 +ğ
wdf
;

499 ià(
	gpos
 =ğ
’d
) ;

501 
	gX­Ÿn
::
docid
 
šc
;

502 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
šc
)) {

503 
	gcout
 << "FaedØuÅack docid inü—£" << 
	g’dl
;

504 ++
	g”rÜs
;

505 
	gbad
 = 
Œue
;

508 ++
	gšc
;

509 
	gdid
 +ğ
šc
;

510 ià(
	gdid
 > 
	gÏ¡did
) {

511 
	gcout
 << "docid " << 
	gdid
 << " >†a¡ docid " << 
	gÏ¡did


512 << 
	g’dl
;

513 ++
	g”rÜs
;

516 ià(
	gbad
) {

519 ià(
	gis_Ï¡_chunk
) {

520 ià(
	gtf
 !ğ
‹rmäeq
) {

521 
cout
 << "‹rmäeq " << 
‹rmäeq
 << " != # ofƒntries "

522 << 
tf
 << 
’dl
;

523 ++
	g”rÜs
;

525 ià(
	gcf
 !ğ
cŞläeq
) {

526 
cout
 << "cŞläeq " << 
cŞläeq
 << " !ğsum wdà" << 
cf


527 << 
’dl
;

528 ++
	g”rÜs
;

530 ià(
	gdid
 !ğ
Ï¡did
) {

531 
cout
 << "Ï¡did " << 
Ï¡did
 << " !ğÏ¡ did " << 
did


532 << 
’dl
;

533 ++
	g”rÜs
;

535 
	gcu¼’t_‹rm
.
»size
(0);

538 ià(!
	gcu¼’t_‹rm
.
em±y
()) {

539 
	gcout
 << "La¡”m `" << 
	gcu¼’t_‹rm
 << "' has‚o†ast chunk"

540 << 
	g’dl
;

541 ++
	g”rÜs
;

544 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gVSts
>::
cÚ¡_™”©Ü
 
i
;

545 
	gi
 = 
v®ue¡©s
.
begš
(); i !ğv®ue¡©s.
’d
(); ++i) {

546 ià(
	gi
->
	g£cÚd
.
	gäeq
 !ğ
i
->
£cÚd
.
äeq_»®
) {

547 
cout
 << "V®u¡© äequ’cy fÜ slÙ " << 
i
->
fœ¡
 << " is "

548 << 
i
->
£cÚd
.
äeq
 << " but„ecounting gives "

549 << 
i
->
£cÚd
.
äeq_»®
 << 
’dl
;

550 ++
	g”rÜs
;

553 } ià(
¡rcmp
(
bËÇme
, "record") == 0) {

556  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

557 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

560 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

561 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

563 
	gX­Ÿn
::
docid
 
did
;

564 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

565 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

566 ++
	g”rÜs
;

567 } ià(
	gpos
 !ğ
’d
) {

568 
cout
 << "ExŒ¨junk iÀkey" << 
’dl
;

569 ++
	g”rÜs
;

572 } ià(
¡rcmp
(
bËÇme
, "termlist") == 0) {

574  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

575 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

578 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

579 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

581 
	gX­Ÿn
::
docid
 
did
;

582 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

583 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

584 ++
	g”rÜs
;

588 ià(
	g’d
 - 
	gpos
 =ğ1 && *
pos
 == '\0') {

590 
cursÜ
->
»ad_g
();

592 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

593 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

595 ià(
	gpos
 =ğ
’d
) {

596 
cout
 << "Em±y v®u¦Ù u£dag" << 
’dl
;

597 ++
	g”rÜs
;

601 
	gX­Ÿn
::
v®u’o
 
´ev_¦Ù
;

602 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
´ev_¦Ù
)) {

603 
	gcout
 << "V®u¦Ùƒncodšg cÜru±" << 
	g’dl
;

604 ++
	g”rÜs
;

608 
	gpos
 !ğ
’d
) {

609 
X­Ÿn
::
v®u’o
 
¦Ù
;

610 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
¦Ù
)) {

611 
	gcout
 << "V®u¦Ùƒncodšg cÜru±" << 
	g’dl
;

612 ++
	g”rÜs
;

615 
	g¦Ù
 +ğ
´ev_¦Ù
 + 1;

616 ià(
	g¦Ù
 <ğ
´ev_¦Ù
) {

617 
cout
 << "V®u¦Ù‚umb” ov”æowed (" << 
´ev_¦Ù
 << " -> " << 
¦Ù
 << ")" << 
’dl
;

618 ++
	g”rÜs
;

620 
	g´ev_¦Ù
 = 
¦Ù
;

625 ià(
	gpos
 !ğ
’d
) {

626 
cout
 << "ExŒ¨junk iÀkey" << 
’dl
;

627 ++
	g”rÜs
;

631 
	gcursÜ
->
»ad_g
();

633 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

634 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

636 ià(
	gpos
 =ğ
’d
) {

641 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
, 
	g‹rmli¡_size
;

644 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

645 ià(
	gpos
 != 0) {

646 
cout
 << "doş’ ouˆoà¿nge" << 
’dl
;

648 
	gcout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg doş’" << 
	g’dl
;

650 ++
	g”rÜs
;

655 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
‹rmli¡_size
)) {

656 ià(
	gpos
 != 0) {

657 
cout
 << "‹rmli¡_sizouˆoà¿nge" << 
’dl
;

659 
	gcout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg”mli¡_size" << 
	g’dl
;

661 ++
	g”rÜs
;

665 
	gX­Ÿn
::
‹rmcouÁ
 
aùu®_doş’
 = 0, 
	gaùu®_‹rmli¡_size
 = 0;

666 
¡ršg
 
	gcu¼’t_Šame
;

668 
boŞ
 
	gbad
 = 
çl£
;

669 
	gpos
 !ğ
’d
) {

670 
X­Ÿn
::
doccouÁ
 
cu¼’t_wdf
 = 0;

671 
boŞ
 
	ggÙ_wdf
 = 
çl£
;

673 ià(!
	gcu¼’t_Šame
.
em±y
()) {

674 
	g¡ršg
::
size_ty³
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

675 ià(
	gËn
 > 
	gcu¼’t_Šame
.
Ëngth
()) {

677 
	gcu¼’t_wdf
 = 
Ën
 / (
cu¼’t_Šame
.
Ëngth
() + 1) - 1;

678 
	gËn
 %ğ(
cu¼’t_Šame
.
Ëngth
() + 1);

679 
	ggÙ_wdf
 = 
Œue
;

681 
	gcu¼’t_Šame
.
»size
(
Ën
);

685 
	g¡ršg
::
size_ty³
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

686 
	gcu¼’t_Šame
.
­³nd
(
pos
, 
Ën
);

687 
	gpos
 +ğ
Ën
;

689 ià(!
	ggÙ_wdf
) {

691 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
cu¼’t_wdf
)) {

692 ià(
	gpos
 == 0) {

693 
cout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg”mli¡ cu¼’t_wdf" << 
’dl
;

695 
	gcout
 << "Sizoàwdàouˆoà¿nge, iÀ‹rmli¡" << 
	g’dl
;

697 ++
	g”rÜs
;

698 
	gbad
 = 
Œue
;

703 ++
	gaùu®_‹rmli¡_size
;

704 
	gaùu®_doş’
 +ğ
cu¼’t_wdf
;

706 ià(
	gbad
) {

710 ià(
	g‹rmli¡_size
 !ğ
aùu®_‹rmli¡_size
) {

711 
cout
 << "‹rmli¡_siz!ğ# oà’Œ› š”mli¡" << 
’dl
;

712 ++
	g”rÜs
;

714 ià(
	gdoş’
 !ğ
aùu®_doş’
) {

715 
cout
 << "doş’ !ğsum(wdf)" << 
’dl
;

716 ++
	g”rÜs
;

720 ià(
	gdoş’s
.
size
(è<ğ
did
è
doş’s
.
»size
(did + 1);

721 
	gdoş’s
[
did
] = 
aùu®_doş’
;

723 } ià(
¡rcmp
(
bËÇme
, "position") == 0) {

725  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

726 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

729 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

730 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

732 
	gX­Ÿn
::
docid
 
did
;

733 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

734 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

735 ++
	g”rÜs
;

738 ià(
	gpos
 =ğ
’d
) {

739 
cout
 << "NØ‹rmÇmš key" << 
’dl
;

740 ++
	g”rÜs
;

744 
	gcursÜ
->
»ad_g
();

746 cÚ¡ 
	g¡ršg
 & 
	gd©a
 = 
cursÜ
->
cu¼’t_g
;

747 
	gpos
 = 
d©a
.data();

748 
	g’d
 = 
pos
 + 
d©a
.
size
();

750 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

751 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

752 
	gcout
 << 
	gbËÇme
 << "abË: Pos™iÚ†i¡ d©¨cÜru±" << 
	g’dl
;

753 ++
	g”rÜs
;

756 ià(
	gpos
 =ğ
’d
) {

760 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

761 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

762 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

763 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
> 
pos™iÚs
;

764 
	gpos™iÚs
.
»size
(
pos_size
);

765 
	gpos™iÚs
[0] = 
pos_fœ¡
;

766 
	gpos™iÚs
.
back
(èğ
pos_Ï¡
;

767 
	grd
.
decode_š‹½Ş©ive
(
pos™iÚs
, 0, 
pos_size
 - 1);

768 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
>::
cÚ¡_™”©Ü
 
cu¼’t_pos
 = 
pos™iÚs
.
begš
();

769 
	gX­Ÿn
::
‹rmpos
 
Ï¡pos
 = *
cu¼’t_pos
++;

770 
	gcu¼’t_pos
 !ğ
pos™iÚs
.
’d
()) {

771 
X­Ÿn
::
‹rmpos
”mpo ğ*
cu¼’t_pos
++;

772 ià(
	g‹rmpos
 <ğ
Ï¡pos
) {

773 
cout
 << 
bËÇme
 << "abË: Pos™iÚ nÙ sŒiùly mÚÙÚiÿÎy inü—sšg" << 
’dl
;

774 ++
	g”rÜs
;

777 
	gÏ¡pos
 = 
‹rmpos
;

782 
	gcout
 << 
	gbËÇme
 << "abË: DÚ'ˆknow howØcheck sŒuùu»\n" << 
	g’dl
;

783  
	g”rÜs
;

786 ià(!
	g”rÜs
)

787 
	gcout
 << 
	gbËÇme
 << "abË sŒuùu» checked OK\n" << 
	g’dl
;

789 
	gcout
 << 
	gbËÇme
 << "abËƒ¼Ü found: " << 
	g”rÜs
 << "\n" << 
	g’dl
;

791  
	g”rÜs
;

	@bin/xapian-check-brass.h

22 #iâdeà
XAPIAN_INCLUDED_XAPIAN_CHECK_BRASS_H


23 
	#XAPIAN_INCLUDED_XAPIAN_CHECK_BRASS_H


	)

25 
	~"x­Ÿn/ty³s.h
"

27 
	~<c¡ršg
>

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
size_t
 
check_b¿ss_bË
(cÚ¡ * 
bËÇme
, 
¡d
::
¡ršg
 
bË
, 
İts
,

32 
¡d
::
veùÜ
<
X­Ÿn
::
‹rmcouÁ
> & 
doş’s
,

33 
X­Ÿn
::
docid
 
db_Ï¡_docid
);

	@bin/xapian-check-chert.cc

23 
	~<cÚfig.h
>

25 
	~"x­Ÿn-check-ch”t.h
"

27 
	~"b™¡»am.h
"

29 
	~"š‹º®ty³s.h
"

31 
	~"ch”t_check.h
"

32 
	~"ch”t_cursÜ.h
"

33 
	~"ch”t_bË.h
"

34 
	~"ch”t_ty³s.h
"

35 
	~"·ck.h
"

36 
	~"v®ue¡©s.h
"

38 
	~<x­Ÿn.h
>

40 
	~"autİŒ.h
"

41 
	~<io¡»am
>

43 
usšg
 
Çme¥aû
 
	g¡d
;

45 
šlše
 
boŞ


46 
	$is_u£r_m‘ad©a_key
(cÚ¡ 
¡ršg
 & 
key
)

48  
key
.
	`size
() > 1 && key[0] == '\0' && key[1] == '\xc0';

49 
	}
}

51 
	gVSts
 : 
public
 
V®ueSts
 {

52 
X­Ÿn
::
doccouÁ
 
äeq_»®
;

54 
VSts
(è: 
V®ueSts
(), 
äeq_»®
(0) {}

57 
size_t


58 
check_ch”t_bË
(cÚ¡ * 
bËÇme
, 
¡ršg
 
f’ame
, 
İts
,

59 
veùÜ
<
X­Ÿn
::
‹rmcouÁ
> & 
doş’s
,

60 
X­Ÿn
::
docid
 
db_Ï¡_docid
)

62 
f’ame
 += '.';

65 
	gCh”tTabËCheck
::
check
(
bËÇme
, 
f’ame
, 
İts
);

68 
Ch”tTabË
 
bË
(
bËÇme
, 
f’ame
, 
Œue
);

69 
	gbË
.
İ’
();

70 
	gAutoPŒ
<
	gCh”tCursÜ
> 
cursÜ
(
bË
.
cursÜ_g‘
());

72 
size_t
 
	g”rÜs
 = 0;

74 
	gcursÜ
->
fšd_’Œy
("");

75 
	gcursÜ
->
Ãxt
();

77 ià(
¡rcmp
(
bËÇme
, "postlist") == 0) {

79 
m­
<
X­Ÿn
::
v®u’o
, 
VSts
> 
v®ue¡©s
;

80 
¡ršg
 
	gcu¼’t_‹rm
;

81 
	gX­Ÿn
::
docid
 
Ï¡did
 = 0;

82 
	gX­Ÿn
::
‹rmcouÁ
 
‹rmäeq
 = 0, 
	gcŞläeq
 = 0;

83 
	gX­Ÿn
::
‹rmcouÁ
 
tf
 = 0, 
	gcf
 = 0;

84 
boŞ
 
	ghave_m‘ašfo_key
 = 
çl£
;

88 ià(!
	gcursÜ
->
aá”_’d
()) {

89 ià(
	gcursÜ
->
	gcu¼’t_key
 =ğ
¡ršg
("", 1)) {

90 
	ghave_m‘ašfo_key
 = 
Œue
;

91 
	gcursÜ
->
»ad_g
();

93 
tÙËn_t
 
	gtÙ®_doş’
;

94 
	gX­Ÿn
::
docid
 
Ï¡_docid
;

95 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_lbound
;

96 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_ubound
;

97 
	gX­Ÿn
::
‹rmcouÁ
 
wdf_ubound
;

99 cÚ¡ * 
	gd©a
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

100 cÚ¡ * 
	g’d
 = 
d©a
 + 
cursÜ
->
cu¼’t_g
.
size
();

101 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
Ï¡_docid
)) {

102 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»ad†a¡_docid)." << 
	g’dl
;

103 ++
	g”rÜs
;

104 } ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
doş’_lbound
)) {

105 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»ad doş’_lbound)." << 
	g’dl
;

106 ++
	g”rÜs
;

107 } ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
wdf_ubound
)) {

108 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»ad wdf_ubound)." << 
	g’dl
;

109 ++
	g”rÜs
;

110 } ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
doş’_ubound
)) {

111 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»ad doş’_ubound)." << 
	g’dl
;

112 ++
	g”rÜs
;

113 } ià(!
uÅack_ušt_Ï¡
(&
d©a
, 
’d
, &
tÙ®_doş’
)) {

114 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (couldn'ˆ»adÙ®_doş’)." << 
	g’dl
;

115 ++
	g”rÜs
;

116 } ià(
	gd©a
 !ğ
’d
) {

117 
cout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru± (junk‡ˆ’d)." << 
’dl
;

118 ++
	g”rÜs
;

120 
	gcursÜ
->
Ãxt
();

124  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

125 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

127 ià(
is_u£r_m‘ad©a_key
(
key
)) {

130 
	gcursÜ
->
»ad_g
();

131 ià(
	gcursÜ
->
	gcu¼’t_g
.
em±y
()) {

132 
	gcout
 << "U£¸m‘ad©¨™em i em±y" << 
	g’dl
;

133 ++
	g”rÜs
;

138 ià(!
	ghave_m‘ašfo_key
) {

139 
	gcout
 << "METAINFO key missšg from…o¡li¡abË" << 
	g’dl
;

140 ++
	g”rÜs
;

143 ià(
	gkey
.
size
(è>ğ2 && 
key
[0] == '\0' && key[1] == '\xe0') {

145 cÚ¡ * 
pos
, * 
’d
;

146 
	gX­Ÿn
::
docid
 
did
 = 1;

147 ià(
	gkey
.
size
() > 2) {

149 
	gpos
 = 
key
.
d©a
();

150 
	g’d
 = 
pos
 + 
key
.
size
();

151 
	gpos
 += 2;

152 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

153 
	gcout
 << "E¼Ü uÅackšg docid from doş’ key" << 
	g’dl
;

154 ++
	g”rÜs
;

159 
	gcursÜ
->
»ad_g
();

160 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

161 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

162 ià(
	gkey
.
size
() == 2) {

164 ià(
’d
 - 
pos
 < 2 ||…os[0] ||…os[1]) {

165 
cout
 << "In™ŸÈdoş’ chunk ha nÚz”Ødummy f›lds" << 
’dl
;

166 ++
	g”rÜs
;

169 
	gpos
 += 2;

170 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
did
)) {

171 
	gcout
 << "FaedØuÅack fœ¡did fÜ doş’" << 
	g’dl
;

172 ++
	g”rÜs
;

175 ++
	gdid
;

176 ià(
	gdid
 <ğ
Ï¡did
) {

177 
cout
 << "First did inhis chunk is <=†ast in "

178 "´ev chunk" << 
’dl
;

179 ++
	g”rÜs
;

183 
boŞ
 
	gis_Ï¡_chunk
;

184 ià(!
uÅack_boŞ
(&
pos
, 
’d
, &
is_Ï¡_chunk
)) {

185 
	gcout
 << "FaedØuÅack†a¡ chunk fÏg fÜ doş’" << 
	g’dl
;

186 ++
	g”rÜs
;

190 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
Ï¡did
)) {

191 
	gcout
 << "FaedØuÅack inü—£ØÏ¡" << 
	g’dl
;

192 ++
	g”rÜs
;

195 
	gÏ¡did
 +ğ
did
;

196 
boŞ
 
	gbad
 = 
çl£
;

197 
	gŒue
) {

198 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
;

199 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

200 
	gcout
 << "FaedØuÅack doş’" << 
	g’dl
;

201 ++
	g”rÜs
;

202 
	gbad
 = 
Œue
;

206 ià(
	gdid
 > 
	gdb_Ï¡_docid
) {

207 
	gcout
 << "docum’ˆid " << 
	gdid
 << " in doclen stream "

209 << 
	gdb_Ï¡_docid
 << 
	g’dl
;

210 ++
	g”rÜs
;

213 ià(!
	gdoş’s
.
em±y
()) {

216 
	gX­Ÿn
::
‹rmcouÁ
 
‹rmli¡_doş’
 = 0;

217 ià(
	gdid
 < 
	gdoş’s
.
size
())

218 
	g‹rmli¡_doş’
 = 
doş’s
[
did
];

220 ià(
	gdoş’
 !ğ
‹rmli¡_doş’
) {

221 
cout
 << "doş’ " << 
doş’
 << " doesn't match "

222 << 
‹rmli¡_doş’


223 << " iÀth‹rmli¡abË" << 
’dl
;

224 ++
	g”rÜs
;

228 ià(
	gpos
 =ğ
’d
) ;

230 
	gX­Ÿn
::
docid
 
šc
;

231 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
šc
)) {

232 
	gcout
 << "FaedØuÅack docid inü—£" << 
	g’dl
;

233 ++
	g”rÜs
;

234 
	gbad
 = 
Œue
;

237 ++
	gšc
;

238 
	gdid
 +ğ
šc
;

239 ià(
	gdid
 > 
	gÏ¡did
) {

240 
	gcout
 << "docid " << 
	gdid
 << " >†a¡ docid " << 
	gÏ¡did


241 << 
	g’dl
;

242 ++
	g”rÜs
;

245 ià(
	gbad
) {

248 ià(
	gis_Ï¡_chunk
) {

249 ià(
	gdid
 !ğ
Ï¡did
) {

250 
cout
 << "Ï¡did " << 
Ï¡did
 << " !ğÏ¡ did " << 
did


251 << 
’dl
;

252 ++
	g”rÜs
;

259 ià(
	gkey
.
size
(è>ğ2 && 
key
[0] == '\0' && key[1] == '\xd0') {

261 cÚ¡ * 
p
 = 
key
.
d©a
();

262 cÚ¡ * 
	g’d
 = 
p
 + 
key
.
Ëngth
();

263 
	gp
 += 2;

264 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

265 ià(!
uÅack_ušt_Ï¡
(&
p
, 
’d
, &
¦Ù
)) {

266 
	gcout
 << "Bad v®ue¡© key (nØ¦Ù)" << 
	g’dl
;

267 ++
	g”rÜs
;

271 
	gcursÜ
->
»ad_g
();

272 
	gp
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

273 
	g’d
 = 
p
 + 
cursÜ
->
cu¼’t_g
.
size
();

275 
	gVSts
 & 
	gv
 = 
v®ue¡©s
[
¦Ù
];

276 ià(!
uÅack_ušt
(&
p
, 
’d
, &
v
.
äeq
)) {

277 ià(*
	gp
 == 0) {

278 
cout
 << "Incom¶‘¡© ™em iÀv®ubË" << 
’dl
;

280 
	gcout
 << "F»qu’cy sti¡iøš v®ubË i toØÏrge" << 
	g’dl
;

282 ++
	g”rÜs
;

285 ià(!
uÅack_¡ršg
(&
p
, 
’d
, 
v
.
low”_bound
)) {

286 ià(*
	gp
 == 0) {

287 
cout
 << "Incom¶‘¡© ™em iÀv®ubË" << 
’dl
;

289 
	gcout
 << "Low” bound sti¡iøš v®ubË i toØÏrge" << 
	g’dl
;

291 ++
	g”rÜs
;

294 
size_t
 
	gËn
 = 
’d
 - 
p
;

295 ià(
	gËn
 == 0) {

296 
v
.
uµ”_bound
 = v.
low”_bound
;

298 
	gv
.
	guµ”_bound
.
assign
(
p
, 
Ën
);

304 ià(
	gkey
.
size
(è>ğ2 && 
key
[0] == '\0' && key[1] == '\xd8') {

306 cÚ¡ * 
p
 = 
key
.
d©a
();

307 cÚ¡ * 
	g’d
 = 
p
 + 
key
.
Ëngth
();

308 
	gp
 += 2;

309 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

310 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
)) {

311 
	gcout
 << "Bad v®uchunk key (nØ¦Ù)" << 
	g’dl
;

312 ++
	g”rÜs
;

315 
	gX­Ÿn
::
docid
 
did
;

316 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
p
, 
’d
, &
did
)) {

317 
	gcout
 << "Bad v®uchunk key (nØdocid)" << 
	g’dl
;

318 ++
	g”rÜs
;

321 ià(
	gp
 !ğ
’d
) {

322 
cout
 << "Bad v®uchunk key (Œašg junk)" << 
’dl
;

323 ++
	g”rÜs
;

327 
	gVSts
 & 
	gv
 = 
v®ue¡©s
[
¦Ù
];

329 
	gcursÜ
->
»ad_g
();

330 
	gp
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

331 
	g’d
 = 
p
 + 
cursÜ
->
cu¼’t_g
.
size
();

333 
	gŒue
) {

334 
¡ršg
 
	gv®ue
;

335 ià(!
uÅack_¡ršg
(&
p
, 
’d
, 
v®ue
)) {

336 
	gcout
 << "FaedØuÅack v®uäom chunk" << 
	g’dl
;

337 ++
	g”rÜs
;

341 ++
	gv
.
	gäeq_»®
;

349 ià(
	gv®ue
 < 
	gv
.
	glow”_bound
) {

350 
	gcout
 << "V®u¦Ù " << 
	g¦Ù
 << " has value below "

351 "low” bound: '" << 
	gv®ue
 << "' < '"

352 << 
	gv
.
	glow”_bound
 << "'" << 
	g’dl
;

353 ++
	g”rÜs
;

354 } ià(
	gv®ue
 > 
	gv
.
	guµ”_bound
) {

355 
	gcout
 << "V®u¦Ù " << 
	g¦Ù
 << " has value‡bove "

356 "uµ” bound: '" << 
	gv®ue
 << "' > '"

357 << 
	gv
.
	guµ”_bound
 << "'" << 
	g’dl
;

358 ++
	g”rÜs
;

361 ià(
	gp
 =ğ
’d
) ;

362 
	gX­Ÿn
::
docid
 
d–
;

363 ià(!
uÅack_ušt
(&
p
, 
’d
, &
d–
)) {

364 
	gcout
 << "FaedØuÅack docid d– from chunk" << 
	g’dl
;

365 ++
	g”rÜs
;

368 
	gX­Ÿn
::
docid
 
Ãw_did
 = 
did
 + 
d–
 + 1;

369 ià(
	gÃw_did
 <ğ
did
) {

370 
cout
 << "docid ov”æowed iÀv®uchunk" << 
’dl
;

371 ++
	g”rÜs
;

374 
	gdid
 = 
Ãw_did
;

376 ià(
	gdid
 > 
	gdb_Ï¡_docid
) {

377 
	gcout
 << "docum’ˆid " << 
	gdid
 << " in value chunk "

379 << 
	gdb_Ï¡_docid
 << 
	g’dl
;

380 ++
	g”rÜs
;

386 cÚ¡ * 
	gpos
, * 
	g’d
;

389 
	gpos
 = 
key
.
d©a
();

390 
	g’d
 = 
pos
 + 
key
.
size
();

392 
¡ršg
 
	g‹rm
;

393 
	gX­Ÿn
::
docid
 
did
;

394 ià(!
uÅack_¡ršg_´e£rvšg_sÜt
(&
pos
, 
’d
, 
‹rm
)) {

395 
	gcout
 << "E¼Ü uÅackšg”mÇmäom key" << 
	g’dl
;

396 ++
	g”rÜs
;

399 ià(!
	gcu¼’t_‹rm
.
em±y
(è&& 
	g‹rm
 !ğ
cu¼’t_‹rm
) {

401 ià(
pos
 =ğ
’d
) {

402 
cout
 << "NØÏ¡ chunk fÜ”m `" << 
cu¼’t_‹rm


403 << "'" << 
’dl
;

404 
	gcu¼’t_‹rm
.
»size
(0);

406 
	gcout
 << "Mismatch in follow-on chunk in…osting "

407 "li¡ fÜ”m `" << 
	gcu¼’t_‹rm
 << "' (got `"

408 << 
	g‹rm
 << "')" << 
	g’dl
;

409 
	gcu¼’t_‹rm
 = 
‹rm
;

410 
	gtf
 = 
cf
 = 0;

411 
	gÏ¡did
 = 0;

413 ++
	g”rÜs
;

415 ià(
	gpos
 =ğ
’d
) {

417 ià(
‹rm
 =ğ
cu¼’t_‹rm
) {

419 
cout
 << "First…osting†ist chunk forerm `"

420 << 
‹rm
 << "' follows…revious chunk forhe same "

421 "‹rm" << 
’dl
;

422 ++
	g”rÜs
;

424 
	gcu¼’t_‹rm
 = 
‹rm
;

425 
	gtf
 = 
cf
 = 0;

428 
	gcursÜ
->
»ad_g
();

429 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

430 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

431 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
‹rmäeq
)) {

432 
	gcout
 << "FaedØuÅack”mäeq fÜ”m `" << 
	g‹rm


433 << "'" << 
	g’dl
;

434 ++
	g”rÜs
;

437 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
cŞläeq
)) {

438 
	gcout
 << "FaedØuÅack cŞläeq fÜ”m `" << 
	g‹rm


439 << "'" << 
	g’dl
;

440 ++
	g”rÜs
;

443 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
did
)) {

444 
	gcout
 << "FaedØuÅack fœ¡did fÜ”m `" << 
	g‹rm


445 << "'" << 
	g’dl
;

446 ++
	g”rÜs
;

449 ++
	gdid
;

452 ià(
	gcu¼’t_‹rm
.
em±y
()) {

453 
	gcout
 << "Fœ¡ chunk fÜ”m `" << 
	gcu¼’t_‹rm
 << "' "

454 "i ¨cÚtšu©iÚ chunk" << 
	g’dl
;

455 ++
	g”rÜs
;

456 
	gcu¼’t_‹rm
 = 
‹rm
;

458 
As£¹Eq
(
cu¼’t_‹rm
, 
‹rm
);

459 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

460 
	gcout
 << "FaedØuÅack did from key" << 
	g’dl
;

461 ++
	g”rÜs
;

464 ià(
	gdid
 <ğ
Ï¡did
) {

465 
cout
 << "First did inhis chunk is <=†ast in "

466 "´ev chunk" << 
’dl
;

467 ++
	g”rÜs
;

469 
	gcursÜ
->
»ad_g
();

470 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

471 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

474 
boŞ
 
	gis_Ï¡_chunk
;

475 ià(!
uÅack_boŞ
(&
pos
, 
’d
, &
is_Ï¡_chunk
)) {

476 
	gcout
 << "FaedØuÅack†a¡ chunk fÏg" << 
	g’dl
;

477 ++
	g”rÜs
;

481 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
Ï¡did
)) {

482 
	gcout
 << "FaedØuÅack inü—£ØÏ¡" << 
	g’dl
;

483 ++
	g”rÜs
;

486 
	gÏ¡did
 +ğ
did
;

487 
boŞ
 
	gbad
 = 
çl£
;

488 
	gŒue
) {

489 
	gX­Ÿn
::
‹rmcouÁ
 
wdf
;

490 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
wdf
)) {

491 
	gcout
 << "FaedØuÅack wdf" << 
	g’dl
;

492 ++
	g”rÜs
;

493 
	gbad
 = 
Œue
;

496 ++
	gtf
;

497 
	gcf
 +ğ
wdf
;

499 ià(
	gpos
 =ğ
’d
) ;

501 
	gX­Ÿn
::
docid
 
šc
;

502 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
šc
)) {

503 
	gcout
 << "FaedØuÅack docid inü—£" << 
	g’dl
;

504 ++
	g”rÜs
;

505 
	gbad
 = 
Œue
;

508 ++
	gšc
;

509 
	gdid
 +ğ
šc
;

510 ià(
	gdid
 > 
	gÏ¡did
) {

511 
	gcout
 << "docid " << 
	gdid
 << " >†a¡ docid " << 
	gÏ¡did


512 << 
	g’dl
;

513 ++
	g”rÜs
;

516 ià(
	gbad
) {

519 ià(
	gis_Ï¡_chunk
) {

520 ià(
	gtf
 !ğ
‹rmäeq
) {

521 
cout
 << "‹rmäeq " << 
‹rmäeq
 << " != # ofƒntries "

522 << 
tf
 << 
’dl
;

523 ++
	g”rÜs
;

525 ià(
	gcf
 !ğ
cŞläeq
) {

526 
cout
 << "cŞläeq " << 
cŞläeq
 << " !ğsum wdà" << 
cf


527 << 
’dl
;

528 ++
	g”rÜs
;

530 ià(
	gdid
 !ğ
Ï¡did
) {

531 
cout
 << "Ï¡did " << 
Ï¡did
 << " !ğÏ¡ did " << 
did


532 << 
’dl
;

533 ++
	g”rÜs
;

535 
	gcu¼’t_‹rm
.
»size
(0);

538 ià(!
	gcu¼’t_‹rm
.
em±y
()) {

539 
	gcout
 << "La¡”m `" << 
	gcu¼’t_‹rm
 << "' has‚o†ast chunk"

540 << 
	g’dl
;

541 ++
	g”rÜs
;

544 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gVSts
>::
cÚ¡_™”©Ü
 
i
;

545 
	gi
 = 
v®ue¡©s
.
begš
(); i !ğv®ue¡©s.
’d
(); ++i) {

546 ià(
	gi
->
	g£cÚd
.
	gäeq
 !ğ
i
->
£cÚd
.
äeq_»®
) {

547 
cout
 << "V®u¡© äequ’cy fÜ slÙ " << 
i
->
fœ¡
 << " is "

548 << 
i
->
£cÚd
.
äeq
 << " but„ecounting gives "

549 << 
i
->
£cÚd
.
äeq_»®
 << 
’dl
;

550 ++
	g”rÜs
;

553 } ià(
¡rcmp
(
bËÇme
, "record") == 0) {

556  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

557 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

560 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

561 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

563 
	gX­Ÿn
::
docid
 
did
;

564 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

565 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

566 ++
	g”rÜs
;

567 } ià(
	gpos
 !ğ
’d
) {

568 
cout
 << "ExŒ¨junk iÀkey" << 
’dl
;

569 ++
	g”rÜs
;

572 } ià(
¡rcmp
(
bËÇme
, "termlist") == 0) {

574  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

575 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

578 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

579 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

581 
	gX­Ÿn
::
docid
 
did
;

582 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

583 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

584 ++
	g”rÜs
;

588 ià(
	g’d
 - 
	gpos
 =ğ1 && *
pos
 == '\0') {

590 
cursÜ
->
»ad_g
();

592 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

593 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

595 ià(
	gpos
 =ğ
’d
) {

596 
cout
 << "Em±y v®u¦Ù u£dag" << 
’dl
;

597 ++
	g”rÜs
;

601 
	gX­Ÿn
::
v®u’o
 
´ev_¦Ù
;

602 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
´ev_¦Ù
)) {

603 
	gcout
 << "V®u¦Ùƒncodšg cÜru±" << 
	g’dl
;

604 ++
	g”rÜs
;

608 
	gpos
 !ğ
’d
) {

609 
X­Ÿn
::
v®u’o
 
¦Ù
;

610 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
¦Ù
)) {

611 
	gcout
 << "V®u¦Ùƒncodšg cÜru±" << 
	g’dl
;

612 ++
	g”rÜs
;

615 
	g¦Ù
 +ğ
´ev_¦Ù
 + 1;

616 ià(
	g¦Ù
 <ğ
´ev_¦Ù
) {

617 
cout
 << "V®u¦Ù‚umb” ov”æowed (" << 
´ev_¦Ù
 << " -> " << 
¦Ù
 << ")" << 
’dl
;

618 ++
	g”rÜs
;

620 
	g´ev_¦Ù
 = 
¦Ù
;

625 ià(
	gpos
 !ğ
’d
) {

626 
cout
 << "ExŒ¨junk iÀkey" << 
’dl
;

627 ++
	g”rÜs
;

631 
	gcursÜ
->
»ad_g
();

633 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

634 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

636 ià(
	gpos
 =ğ
’d
) {

641 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
, 
	g‹rmli¡_size
;

644 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

645 ià(
	gpos
 != 0) {

646 
cout
 << "doş’ ouˆoà¿nge" << 
’dl
;

648 
	gcout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg doş’" << 
	g’dl
;

650 ++
	g”rÜs
;

655 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
‹rmli¡_size
)) {

656 ià(
	gpos
 != 0) {

657 
cout
 << "‹rmli¡_sizouˆoà¿nge" << 
’dl
;

659 
	gcout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg”mli¡_size" << 
	g’dl
;

661 ++
	g”rÜs
;

665 
	gX­Ÿn
::
‹rmcouÁ
 
aùu®_doş’
 = 0, 
	gaùu®_‹rmli¡_size
 = 0;

666 
¡ršg
 
	gcu¼’t_Šame
;

668 
boŞ
 
	gbad
 = 
çl£
;

669 
	gpos
 !ğ
’d
) {

670 
X­Ÿn
::
doccouÁ
 
cu¼’t_wdf
 = 0;

671 
boŞ
 
	ggÙ_wdf
 = 
çl£
;

673 ià(!
	gcu¼’t_Šame
.
em±y
()) {

674 
	g¡ršg
::
size_ty³
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

675 ià(
	gËn
 > 
	gcu¼’t_Šame
.
Ëngth
()) {

677 
	gcu¼’t_wdf
 = 
Ën
 / (
cu¼’t_Šame
.
Ëngth
() + 1) - 1;

678 
	gËn
 %ğ(
cu¼’t_Šame
.
Ëngth
() + 1);

679 
	ggÙ_wdf
 = 
Œue
;

681 
	gcu¼’t_Šame
.
»size
(
Ën
);

685 
	g¡ršg
::
size_ty³
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

686 
	gcu¼’t_Šame
.
­³nd
(
pos
, 
Ën
);

687 
	gpos
 +ğ
Ën
;

689 ià(!
	ggÙ_wdf
) {

691 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
cu¼’t_wdf
)) {

692 ià(
	gpos
 == 0) {

693 
cout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg”mli¡ cu¼’t_wdf" << 
’dl
;

695 
	gcout
 << "Sizoàwdàouˆoà¿nge, iÀ‹rmli¡" << 
	g’dl
;

697 ++
	g”rÜs
;

698 
	gbad
 = 
Œue
;

703 ++
	gaùu®_‹rmli¡_size
;

704 
	gaùu®_doş’
 +ğ
cu¼’t_wdf
;

706 ià(
	gbad
) {

710 ià(
	g‹rmli¡_size
 !ğ
aùu®_‹rmli¡_size
) {

711 
cout
 << "‹rmli¡_siz!ğ# oà’Œ› š”mli¡" << 
’dl
;

712 ++
	g”rÜs
;

714 ià(
	gdoş’
 !ğ
aùu®_doş’
) {

715 
cout
 << "doş’ !ğsum(wdf)" << 
’dl
;

716 ++
	g”rÜs
;

720 ià(
	gdoş’s
.
size
(è<ğ
did
è
doş’s
.
»size
(did + 1);

721 
	gdoş’s
[
did
] = 
aùu®_doş’
;

723 } ià(
¡rcmp
(
bËÇme
, "position") == 0) {

725  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

726 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

729 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

730 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

732 
	gX­Ÿn
::
docid
 
did
;

733 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

734 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

735 ++
	g”rÜs
;

738 ià(
	gpos
 =ğ
’d
) {

739 
cout
 << "NØ‹rmÇmš key" << 
’dl
;

740 ++
	g”rÜs
;

744 
	gcursÜ
->
»ad_g
();

746 cÚ¡ 
	g¡ršg
 & 
	gd©a
 = 
cursÜ
->
cu¼’t_g
;

747 
	gpos
 = 
d©a
.data();

748 
	g’d
 = 
pos
 + 
d©a
.
size
();

750 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

751 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

752 
	gcout
 << 
	gbËÇme
 << "abË: Pos™iÚ†i¡ d©¨cÜru±" << 
	g’dl
;

753 ++
	g”rÜs
;

756 ià(
	gpos
 =ğ
’d
) {

760 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

761 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

762 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

763 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
> 
pos™iÚs
;

764 
	gpos™iÚs
.
»size
(
pos_size
);

765 
	gpos™iÚs
[0] = 
pos_fœ¡
;

766 
	gpos™iÚs
.
back
(èğ
pos_Ï¡
;

767 
	grd
.
decode_š‹½Ş©ive
(
pos™iÚs
, 0, 
pos_size
 - 1);

768 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
>::
cÚ¡_™”©Ü
 
cu¼’t_pos
 = 
pos™iÚs
.
begš
();

769 
	gX­Ÿn
::
‹rmpos
 
Ï¡pos
 = *
cu¼’t_pos
++;

770 
	gcu¼’t_pos
 !ğ
pos™iÚs
.
’d
()) {

771 
X­Ÿn
::
‹rmpos
”mpo ğ*
cu¼’t_pos
++;

772 ià(
	g‹rmpos
 <ğ
Ï¡pos
) {

773 
cout
 << 
bËÇme
 << "abË: Pos™iÚ nÙ sŒiùly mÚÙÚiÿÎy inü—sšg" << 
’dl
;

774 ++
	g”rÜs
;

777 
	gÏ¡pos
 = 
‹rmpos
;

782 
	gcout
 << 
	gbËÇme
 << "abË: DÚ'ˆknow howØcheck sŒuùu»\n" << 
	g’dl
;

783  
	g”rÜs
;

786 ià(!
	g”rÜs
)

787 
	gcout
 << 
	gbËÇme
 << "abË sŒuùu» checked OK\n" << 
	g’dl
;

789 
	gcout
 << 
	gbËÇme
 << "abËƒ¼Ü found: " << 
	g”rÜs
 << "\n" << 
	g’dl
;

791  
	g”rÜs
;

	@bin/xapian-check-chert.h

22 #iâdeà
XAPIAN_INCLUDED_XAPIAN_CHECK_CHERT_H


23 
	#XAPIAN_INCLUDED_XAPIAN_CHECK_CHERT_H


	)

25 
	~"x­Ÿn/ty³s.h
"

27 
	~<c¡ršg
>

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
size_t
 
check_ch”t_bË
(cÚ¡ * 
bËÇme
, 
¡d
::
¡ršg
 
bË
, 
İts
,

32 
¡d
::
veùÜ
<
X­Ÿn
::
‹rmcouÁ
> & 
doş’s
,

33 
X­Ÿn
::
docid
 
db_Ï¡_docid
);

	@bin/xapian-check-flint.cc

23 
	~<cÚfig.h
>

25 
	~"x­Ÿn-check-æšt.h
"

27 
	~"b™¡»am.h
"

29 
	~"š‹º®ty³s.h
"

31 
	~"æšt_check.h
"

32 
	~"æšt_cursÜ.h
"

33 
	~"æšt_bË.h
"

34 
	~"æšt_ty³s.h
"

35 
	~"æšt_uts.h
"

36 
	~"v®ue¡©s.h
"

38 
	~<x­Ÿn.h
>

40 
	~"autİŒ.h
"

41 
	~<io¡»am
>

43 
usšg
 
Çme¥aû
 
	g¡d
;

45 
šlše
 
boŞ


46 
	$is_u£r_m‘ad©a_key
(cÚ¡ 
¡ršg
 & 
key
)

48  
key
.
	`size
() > 1 && key[0] == '\0' && key[1] == '\xc0';

49 
	}
}

51 
size_t


52 
check_æšt_bË
(cÚ¡ * 
bËÇme
, 
¡ršg
 
f’ame
, 
İts
,

53 
veùÜ
<
X­Ÿn
::
‹rmcouÁ
> & 
doş’s
)

55 
f’ame
 += '.';

58 
	gBŒ“Check
::
check
(
bËÇme
, 
f’ame
, 
İts
);

61 
FlštTabË
 
bË
(
bËÇme
, 
f’ame
, 
Œue
);

62 
	gbË
.
İ’
();

63 
	gAutoPŒ
<
	gFlštCursÜ
> 
cursÜ
(
bË
.
cursÜ_g‘
());

65 
size_t
 
	g”rÜs
 = 0;

67 
	gcursÜ
->
fšd_’Œy
("");

68 
	gcursÜ
->
Ãxt
();

70 ià(
¡rcmp
(
bËÇme
, "postlist") == 0) {

72 
¡ršg
 
cu¼’t_‹rm
;

73 
	gX­Ÿn
::
docid
 
Ï¡did
 = 0;

74 
	gX­Ÿn
::
‹rmcouÁ
 
‹rmäeq
 = 0, 
	gcŞläeq
 = 0;

75 
	gX­Ÿn
::
‹rmcouÁ
 
tf
 = 0, 
	gcf
 = 0;

76 
boŞ
 
	ghave_m‘ašfo_key
 = 
çl£
;

80 ià(!
	gcursÜ
->
aá”_’d
()) {

81 ià(
	gcursÜ
->
	gcu¼’t_key
 =ğ
¡ršg
("", 1)) {

82 
	ghave_m‘ašfo_key
 = 
Œue
;

83 
	gcursÜ
->
»ad_g
();

85 
	gX­Ÿn
::
docid
 
did
;

86 
tÙËn_t
 
	gtÙËn
;

87 cÚ¡ * 
	gd©a
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

88 cÚ¡ * 
	g’d
 = 
d©a
 + 
cursÜ
->
cu¼’t_g
.
size
();

89 ià(!
F_uÅack_ušt
(&
d©a
, 
’d
, &
did
)) {

90 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru±." << 
	g’dl
;

91 ++
	g”rÜs
;

92 } ià(!
F_uÅack_ušt_Ï¡
(&
d©a
, 
’d
, &
tÙËn
)) {

93 
	gcout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru±." << 
	g’dl
;

94 ++
	g”rÜs
;

95 } ià(
	gd©a
 !ğ
’d
) {

96 
cout
 << "Tag cÚššg m‘¨šfÜm©iÚ i cÜru±." << 
’dl
;

97 ++
	g”rÜs
;

99 
	gcursÜ
->
Ãxt
();

103  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

104 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

106 ià(
is_u£r_m‘ad©a_key
(
key
)) {

109 
	gcursÜ
->
»ad_g
();

110 ià(
	gcursÜ
->
	gcu¼’t_g
.
em±y
()) {

111 
	gcout
 << "U£¸m‘ad©¨™em i em±y" << 
	g’dl
;

112 ++
	g”rÜs
;

117 ià(!
	ghave_m‘ašfo_key
) {

118 
	gcout
 << "METAINFO key missšg from…o¡li¡abË" << 
	g’dl
;

119 ++
	g”rÜs
;

122 ià(
	gkey
.
size
(è>ğ2 && 
key
[0] == '\0' && key[1] == '\xe0') {

124 cÚ¡ * 
pos
, * 
’d
;

125 
	gX­Ÿn
::
docid
 
did
 = 1;

126 ià(
	gkey
.
size
() > 2) {

128 
	gpos
 = 
key
.
d©a
();

129 
	g’d
 = 
pos
 + 
key
.
size
();

130 
	gpos
 += 2;

131 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

132 
	gcout
 << "E¼Ü uÅackšg docid from doş’ key" << 
	g’dl
;

133 ++
	g”rÜs
;

138 
	gcursÜ
->
»ad_g
();

139 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

140 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

141 ià(
	gkey
.
size
() == 2) {

143 ià(
’d
 - 
pos
 < 2 ||…os[0] ||…os[1]) {

144 
cout
 << "In™ŸÈdoş’ chunk ha nÚz”Ødummy f›lds" << 
’dl
;

145 ++
	g”rÜs
;

148 
	gpos
 += 2;

149 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
did
)) {

150 
	gcout
 << "FaedØuÅack fœ¡did fÜ doş’" << 
	g’dl
;

151 ++
	g”rÜs
;

154 ++
	gdid
;

155 ià(
	gdid
 <ğ
Ï¡did
) {

156 
cout
 << "First did inhis chunk is <=†ast in "

157 "´ev chunk" << 
’dl
;

158 ++
	g”rÜs
;

162 
boŞ
 
	gis_Ï¡_chunk
;

163 ià(!
F_uÅack_boŞ
(&
pos
, 
’d
, &
is_Ï¡_chunk
)) {

164 
	gcout
 << "FaedØuÅack†a¡ chunk fÏg fÜ doş’" << 
	g’dl
;

165 ++
	g”rÜs
;

169 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
Ï¡did
)) {

170 
	gcout
 << "FaedØuÅack inü—£ØÏ¡" << 
	g’dl
;

171 ++
	g”rÜs
;

174 
	gÏ¡did
 +ğ
did
;

175 
boŞ
 
	gbad
 = 
çl£
;

176 
	gŒue
) {

177 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
;

178 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

179 
	gcout
 << "FaedØuÅack doş’" << 
	g’dl
;

180 ++
	g”rÜs
;

181 
	gbad
 = 
Œue
;

185 ià(!
	gdoş’s
.
em±y
()) {

186 ià(
	gdid
 >ğ
doş’s
.
size
()) {

187 
cout
 << "docum’ˆid " << 
did
 << " i Ïrg”hª‡ny iÀth‹rmli¡abË!" << 
’dl
;

188 ++
	g”rÜs
;

189 } ià(
	gdoş’s
[
did
] !ğ
doş’
) {

190 
cout
 << "doş’ " << 
doş’
 << " dÛ¢'ˆm©ch " << 
doş’s
[
did
] << " iÀth‹rmli¡abË" << 
’dl
;

191 ++
	g”rÜs
;

195 ià(
	gpos
 =ğ
’d
) ;

197 
	gX­Ÿn
::
docid
 
šc
;

198 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
šc
)) {

199 
	gcout
 << "FaedØuÅack docid inü—£" << 
	g’dl
;

200 ++
	g”rÜs
;

201 
	gbad
 = 
Œue
;

204 ++
	gšc
;

205 
	gdid
 +ğ
šc
;

206 ià(
	gdid
 > 
	gÏ¡did
) {

207 
	gcout
 << "docid " << 
	gdid
 << " >†a¡ docid " << 
	gÏ¡did


208 << 
	g’dl
;

209 ++
	g”rÜs
;

212 ià(
	gbad
) {

215 ià(
	gis_Ï¡_chunk
) {

216 ià(
	gdid
 !ğ
Ï¡did
) {

217 
cout
 << "Ï¡did " << 
Ï¡did
 << " !ğÏ¡ did " << 
did


218 << 
’dl
;

219 ++
	g”rÜs
;

226 cÚ¡ * 
	gpos
, * 
	g’d
;

229 
	gpos
 = 
key
.
d©a
();

230 
	g’d
 = 
pos
 + 
key
.
size
();

232 
¡ršg
 
	g‹rm
;

233 
	gX­Ÿn
::
docid
 
did
;

234 ià(!
F_uÅack_¡ršg_´e£rvšg_sÜt
(&
pos
, 
’d
, 
‹rm
)) {

235 
	gcout
 << "E¼Ü uÅackšg”mÇmäom key" << 
	g’dl
;

236 ++
	g”rÜs
;

239 ià(
	gcu¼’t_‹rm
.
em±y
()) {

240 
	gcu¼’t_‹rm
 = 
‹rm
;

241 
	gtf
 = 
cf
 = 0;

242 ià(
	gpos
 !ğ
’d
) {

243 
cout
 << "Extra bytes‡fter key for first chunk of "

244 "po¡šg†i¡ fÜ”m `" << 
‹rm
 << "'" << 
’dl
;

245 ++
	g”rÜs
;

249 
	gcursÜ
->
»ad_g
();

250 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

251 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

252 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
‹rmäeq
)) {

253 
	gcout
 << "FaedØuÅack”mäeq fÜ”m `" << 
	g‹rm


254 << "'" << 
	g’dl
;

255 ++
	g”rÜs
;

258 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
cŞläeq
)) {

259 
	gcout
 << "FaedØuÅack cŞläeq fÜ”m `" << 
	g‹rm


260 << "'" << 
	g’dl
;

261 ++
	g”rÜs
;

264 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
did
)) {

265 
	gcout
 << "FaedØuÅack fœ¡did fÜ”m `" << 
	g‹rm


266 << "'" << 
	g’dl
;

267 ++
	g”rÜs
;

270 ++
	gdid
;

272 ià(
	g‹rm
 !ğ
cu¼’t_‹rm
) {

273 ià(
pos
 =ğ
’d
) {

274 
cout
 << "NØÏ¡ chunk fÜ”m `" << 
‹rm
 << "'"

275 << 
’dl
;

277 
	gcout
 << "Mismatch in follow-on chunk in…osting "

278 "li¡ fÜ”m `" << 
	gcu¼’t_‹rm
 << "' (got `"

279 << 
	g‹rm
 << "')" << 
	g’dl
;

281 ++
	g”rÜs
;

282 
	gcu¼’t_‹rm
 = 
‹rm
;

284 ià(
	gpos
 !ğ
’d
) {

285 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

286 
cout
 << "FaedØuÅack did from key" << 
’dl
;

287 ++
	g”rÜs
;

290 ià(
	gdid
 <ğ
Ï¡did
) {

291 
cout
 << "First did inhis chunk is <=†ast in "

292 "´ev chunk" << 
’dl
;

293 ++
	g”rÜs
;

296 
	gcursÜ
->
»ad_g
();

297 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

298 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

301 
boŞ
 
	gis_Ï¡_chunk
;

302 ià(!
F_uÅack_boŞ
(&
pos
, 
’d
, &
is_Ï¡_chunk
)) {

303 
	gcout
 << "FaedØuÅack†a¡ chunk fÏg" << 
	g’dl
;

304 ++
	g”rÜs
;

308 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
Ï¡did
)) {

309 
	gcout
 << "FaedØuÅack inü—£ØÏ¡" << 
	g’dl
;

310 ++
	g”rÜs
;

313 ++
	gÏ¡did
;

314 
	gÏ¡did
 +ğ
did
;

315 
boŞ
 
	gbad
 = 
çl£
;

316 
	gŒue
) {

317 
	gX­Ÿn
::
‹rmcouÁ
 
wdf
;

318 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
wdf
)) {

319 
	gcout
 << "FaedØuÅack wdf" << 
	g’dl
;

320 ++
	g”rÜs
;

321 
	gbad
 = 
Œue
;

324 ++
	gtf
;

325 
	gcf
 +ğ
wdf
;

327 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
;

328 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

329 
	gcout
 << "FaedØuÅack doøËngth" << 
	g’dl
;

330 ++
	g”rÜs
;

331 
	gbad
 = 
Œue
;

335 ià(!
	gdoş’s
.
em±y
()) {

336 ià(
	gdid
 >ğ
doş’s
.
size
()) {

337 
cout
 << "docum’ˆid " << 
did
 << " i Ïrg”hª‡ny iÀth‹rmli¡abË!" << 
’dl
;

338 } ià(
	gdoş’s
[
did
] !ğ
doş’
) {

339 
cout
 << "doş’ " << 
doş’
 << " dÛ¢'ˆm©ch " << 
doş’s
[
did
] << " iÀth‹rmli¡abË" << 
’dl
;

340 ++
	g”rÜs
;

343 ià(
	gpos
 =ğ
’d
) ;

345 
	gX­Ÿn
::
docid
 
šc
;

346 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
šc
)) {

347 
	gcout
 << "FaedØuÅack docid inü—£" << 
	g’dl
;

348 ++
	g”rÜs
;

349 
	gbad
 = 
Œue
;

352 ++
	gšc
;

353 
	gdid
 +ğ
šc
;

354 ià(
	gdid
 > 
	gÏ¡did
) {

355 
	gcout
 << "docid " << 
	gdid
 << " >†a¡ docid " << 
	gÏ¡did


356 << 
	g’dl
;

357 ++
	g”rÜs
;

360 ià(
	gbad
) {

363 ià(
	gis_Ï¡_chunk
) {

364 ià(
	gtf
 !ğ
‹rmäeq
) {

365 
cout
 << "‹rmäeq " << 
‹rmäeq
 << " != # ofƒntries "

366 << 
tf
 << 
’dl
;

367 ++
	g”rÜs
;

369 ià(
	gcf
 !ğ
cŞläeq
) {

370 
cout
 << "cŞläeq " << 
cŞläeq
 << " !ğsum wdà" << 
cf


371 << 
’dl
;

372 ++
	g”rÜs
;

374 ià(
	gdid
 !ğ
Ï¡did
) {

375 
cout
 << "Ï¡did " << 
Ï¡did
 << " !ğÏ¡ did " << 
did


376 << 
’dl
;

377 ++
	g”rÜs
;

379 
	gcu¼’t_‹rm
.
»size
(0);

382 ià(!
	gcu¼’t_‹rm
.
em±y
()) {

383 
	gcout
 << "La¡”m `" << 
	gcu¼’t_‹rm
 << "' has‚o†ast chunk"

384 << 
	g’dl
;

385 ++
	g”rÜs
;

387 } ià(
¡rcmp
(
bËÇme
, "record") == 0) {

390  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

391 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

394 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

395 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

397 
	gX­Ÿn
::
docid
 
did
;

398 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

399 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

400 ++
	g”rÜs
;

401 } ià(
	gpos
 !ğ
’d
) {

402 
cout
 << "ExŒ¨junk iÀkey" << 
’dl
;

403 ++
	g”rÜs
;

406 } ià(
¡rcmp
(
bËÇme
, "termlist") == 0) {

408  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

409 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

412 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

413 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

415 
	gX­Ÿn
::
docid
 
did
;

416 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

417 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

418 ++
	g”rÜs
;

422 ià(
	gpos
 !ğ
’d
) {

423 
cout
 << "ExŒ¨junk iÀkey" << 
’dl
;

424 ++
	g”rÜs
;

428 
	gcursÜ
->
»ad_g
();

430 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

431 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

433 ià(
	gpos
 =ğ
’d
) {

438 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
, 
	g‹rmli¡_size
;

441 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
doş’
)) {

442 ià(
	gpos
 != 0) {

443 
cout
 << "doş’ ouˆoà¿nge" << 
’dl
;

445 
	gcout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg doş’" << 
	g’dl
;

447 ++
	g”rÜs
;

452 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
‹rmli¡_size
)) {

453 ià(
	gpos
 != 0) {

454 
cout
 << "‹rmli¡_sizouˆoà¿nge" << 
’dl
;

456 
	gcout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg”mli¡_size" << 
	g’dl
;

458 ++
	g”rÜs
;

464 ià(
	gpos
 !ğ
’d
 && *
pos
 == '0') ++pos;

466 
	gX­Ÿn
::
‹rmcouÁ
 
aùu®_doş’
 = 0, 
	gaùu®_‹rmli¡_size
 = 0;

467 
¡ršg
 
	gcu¼’t_Šame
;

469 
boŞ
 
	gbad
 = 
çl£
;

470 
	gpos
 !ğ
’d
) {

471 
X­Ÿn
::
doccouÁ
 
cu¼’t_wdf
;

472 
boŞ
 
	ggÙ_wdf
 = 
çl£
;

474 ià(!
	gcu¼’t_Šame
.
em±y
()) {

475 
	g¡ršg
::
size_ty³
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

476 ià(
	gËn
 > 
	gcu¼’t_Šame
.
Ëngth
()) {

478 
	gcu¼’t_wdf
 = 
Ën
 / (
cu¼’t_Šame
.
Ëngth
() + 1) - 1;

479 
	gËn
 %ğ(
cu¼’t_Šame
.
Ëngth
() + 1);

480 
	ggÙ_wdf
 = 
Œue
;

482 
	gcu¼’t_Šame
.
»size
(
Ën
);

486 
	g¡ršg
::
size_ty³
 
Ën
 = 
¡©ic_ÿ¡
<>(*
pos
++);

487 
	gcu¼’t_Šame
.
­³nd
(
pos
, 
Ën
);

488 
	gpos
 +ğ
Ën
;

490 ià(!
	ggÙ_wdf
) {

492 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
cu¼’t_wdf
)) {

493 ià(
	gpos
 == 0) {

494 
cout
 << "UÃx³ùedƒnd oàd©¨wh’„—dšg”mli¡ cu¼’t_wdf" << 
’dl
;

496 
	gcout
 << "Sizoàwdàouˆoà¿nge, iÀ‹rmli¡" << 
	g’dl
;

498 ++
	g”rÜs
;

499 
	gbad
 = 
Œue
;

504 ++
	gaùu®_‹rmli¡_size
;

505 
	gaùu®_doş’
 +ğ
cu¼’t_wdf
;

507 ià(
	gbad
) {

511 ià(
	g‹rmli¡_size
 !ğ
aùu®_‹rmli¡_size
) {

512 
cout
 << "‹rmli¡_siz!ğ# oà’Œ› š”mli¡" << 
’dl
;

513 ++
	g”rÜs
;

515 ià(
	gdoş’
 !ğ
aùu®_doş’
) {

516 
cout
 << "doş’ !ğsum(wdf)" << 
’dl
;

517 ++
	g”rÜs
;

521 ià(
	gdoş’s
.
size
(è<ğ
did
è
doş’s
.
»size
(did + 1);

522 
	gdoş’s
[
did
] = 
aùu®_doş’
;

524 } ià(
¡rcmp
(
bËÇme
, "value") == 0) {

526  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

527 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

530 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

531 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

533 
	gX­Ÿn
::
docid
 
did
;

534 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

535 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

536 ++
	g”rÜs
;

537 } ià(
	gpos
 !ğ
’d
) {

538 
cout
 << "ExŒ¨junk iÀkey" << 
’dl
;

539 ++
	g”rÜs
;

542 
	gcursÜ
->
»ad_g
();

544 
	gpos
 = 
cursÜ
->
cu¼’t_g
.
d©a
();

545 
	g’d
 = 
pos
 + 
cursÜ
->
cu¼’t_g
.
size
();

547 
boŞ
 
	gfœ¡
 = 
Œue
;

548 
	gX­Ÿn
::
v®u’o
 
Ï¡_v®ue_no
 = 0;

549 
	gpos
 &&…o !ğ
’d
) {

550 
X­Ÿn
::
v®u’o
 
this_v®ue_no
;

551 
¡ršg
 
	gthis_v®ue
;

553 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
this_v®ue_no
)) {

554 ià(
	gpos
 == 0)

555 
cout
 << "Incom¶‘™em iÀv®ubË" << 
’dl
;

557 
	gcout
 << "V®unumb” iÀv®ubË i toØÏrge" << 
	g’dl
;

558 ++
	g”rÜs
;

562 ià(!
F_uÅack_¡ršg
(&
pos
, 
’d
, 
this_v®ue
)) {

563 ià(
	gpos
 == 0)

564 
cout
 << "Incom¶‘™em iÀv®ubË" << 
’dl
;

566 
	gcout
 << "I‹m iÀv®ubË i toØÏrge" << 
	g’dl
;

567 ++
	g”rÜs
;

571 ià(
	gfœ¡
) {

572 
	gfœ¡
 = 
çl£
;

573 } ià(
	gthis_v®ue_no
 <ğ
Ï¡_v®ue_no
) {

574 
cout
 << "V®ue nÙ iÀsÜ‹d ord” - v®u’Ø" << 
Ï¡_v®ue_no
 << " come befÜv®u’Ø" << 
this_v®ue_no
 << 
’dl
;

575 ++
	g”rÜs
;

577 
	gÏ¡_v®ue_no
 = 
this_v®ue_no
;

580 } ià(
¡rcmp
(
bËÇme
, "position") == 0) {

582  ; !
	gcursÜ
->
aá”_’d
(); cursÜ->
Ãxt
()) {

583 
	g¡ršg
 & 
	gkey
 = 
cursÜ
->
cu¼’t_key
;

586 cÚ¡ * 
	gpos
 = 
key
.
d©a
();

587 cÚ¡ * 
	g’d
 = 
pos
 + 
key
.
size
();

589 
	gX­Ÿn
::
docid
 
did
;

590 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
pos
, 
’d
, &
did
)) {

591 
	gcout
 << "E¼Ü uÅackšg docid from key" << 
	g’dl
;

592 ++
	g”rÜs
;

595 ià(
	gpos
 =ğ
’d
) {

596 
cout
 << "NØ‹rmÇmš key" << 
’dl
;

597 ++
	g”rÜs
;

601 
	gcursÜ
->
»ad_g
();

603 cÚ¡ 
	g¡ršg
 & 
	gd©a
 = 
cursÜ
->
cu¼’t_g
;

604 
	gpos
 = 
d©a
.data();

605 
	g’d
 = 
pos
 + 
d©a
.
size
();

607 
	gX­Ÿn
::
‹rmpos
 
pos_Ï¡
;

608 ià(!
F_uÅack_ušt
(&
pos
, 
’d
, &
pos_Ï¡
)) {

609 
	gcout
 << 
	gbËÇme
 << "abË: Pos™iÚ†i¡ d©¨cÜru±" << 
	g’dl
;

610 ++
	g”rÜs
;

613 ià(
	gpos
 =ğ
’d
) {

617 
B™R—d”
 
rd
(
d©a
, 
pos
 - data.data());

618 
	gX­Ÿn
::
‹rmpos
 
pos_fœ¡
 = 
rd
.
decode
(
pos_Ï¡
);

619 
	gX­Ÿn
::
‹rmpos
 
pos_size
 = 
rd
.
decode
(
pos_Ï¡
 - 
pos_fœ¡
) + 2;

620 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
> 
pos™iÚs
;

621 
	gpos™iÚs
.
»size
(
pos_size
);

622 
	gpos™iÚs
[0] = 
pos_fœ¡
;

623 
	gpos™iÚs
.
back
(èğ
pos_Ï¡
;

624 
	grd
.
decode_š‹½Ş©ive
(
pos™iÚs
, 0, 
pos_size
 - 1);

625 
	gveùÜ
<
	gX­Ÿn
::
‹rmpos
>::
cÚ¡_™”©Ü
 
cu¼’t_pos
 = 
pos™iÚs
.
begš
();

626 
	gX­Ÿn
::
‹rmpos
 
Ï¡pos
 = *
cu¼’t_pos
++;

627 
	gcu¼’t_pos
 !ğ
pos™iÚs
.
’d
()) {

628 
X­Ÿn
::
‹rmpos
”mpo ğ*
cu¼’t_pos
++;

629 ià(
	g‹rmpos
 <ğ
Ï¡pos
) {

630 
cout
 << 
bËÇme
 << "abË: Pos™iÚ nÙ sŒiùly mÚÙÚiÿÎy inü—sšg" << 
’dl
;

631 ++
	g”rÜs
;

634 
	gÏ¡pos
 = 
‹rmpos
;

639 
	gcout
 << 
	gbËÇme
 << "abË: DÚ'ˆknow howØcheck sŒuùu»\n" << 
	g’dl
;

640  
	g”rÜs
;

643 ià(!
	g”rÜs
)

644 
	gcout
 << 
	gbËÇme
 << "abË sŒuùu» checked OK\n" << 
	g’dl
;

646 
	gcout
 << 
	gbËÇme
 << "abËƒ¼Ü found: " << 
	g”rÜs
 << "\n" << 
	g’dl
;

648  
	g”rÜs
;

	@bin/xapian-check-flint.h

22 #iâdeà
XAPIAN_INCLUDED_XAPIAN_CHECK_FLINT_H


23 
	#XAPIAN_INCLUDED_XAPIAN_CHECK_FLINT_H


	)

25 
	~"x­Ÿn/ty³s.h
"

27 
	~<c¡ršg
>

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
size_t
 
check_æšt_bË
(cÚ¡ * 
bËÇme
, 
¡d
::
¡ršg
 
bË
, 
İts
,

32 
¡d
::
veùÜ
<
X­Ÿn
::
‹rmcouÁ
> & 
doş’s
);

	@bin/xapian-check.cc

23 
	~<cÚfig.h
>

25 
	~"x­Ÿn-check-b¿ss.h
"

26 
	~"x­Ÿn-check-ch”t.h
"

27 
	~"x­Ÿn-check-æšt.h
"

29 
	~"ch”t_check.h
"

30 
	~"¡ršguts.h
"

31 
	~"uts.h
"

33 
	~<x­Ÿn.h
>

35 
	~<io¡»am
>

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	#PROG_NAME
 "x­Ÿn-check"

	)

40 
	#PROG_DESC
 "CheckhcÚsi¡’cy oà¨d©aba£ o¸bË"

	)

46 
	$show_u§ge
() {

47 
cout
 << "U§ge: "
PROG_NAME
" <database directory>|<patho btree‡nd…refix> [[t][f][b][v][+]]\n\n"

54 "ƒ.g. "
PROG_NAME
" /var/lib/xapian/data/default\n"

55 " "
PROG_NAME
" /v¬/lib/x­Ÿn/d©a/deçuÉ/po¡li¡ fbv" << 
’dl
;

56 
	}
}

59 
	$maš
(
¬gc
, **
¬gv
)

61 ià(
¬gc
 > 1 && 
¬gv
[1][0] == '-') {

62 ià(
	`¡rcmp
(
¬gv
[1], "--help") == 0) {

63 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

64 
	`show_u§ge
();

65 
	`ex™
(0);

67 ià(
	`¡rcmp
(
¬gv
[1], "--version") == 0) {

68 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

69 
	`ex™
(0);

72 ià(
¬gc
 < 2 ||‡rgc > 3) {

73 
	`show_u§ge
();

74 
	`ex™
(1);

77 
İts
 = 0;

78 cÚ¡ * 
İt_¡ršg
 = 
¬gv
[2];

79 ià(!
İt_¡ršg
) opt_string = "v";

80 cÚ¡ *
p
 = 
İt_¡ršg
; *p; ++p) {

81 *
p
) {

82 't': 
İts
 |ğ
OPT_SHORT_TREE
; ;

83 'f': 
İts
 |ğ
OPT_FULL_TREE
; ;

84 'b': 
İts
 |ğ
OPT_SHOW_BITMAP
; ;

85 'v': 
İts
 |ğ
OPT_SHOW_STATS
; ;

87 
İts
 |ğ
OPT_SHORT_TREE
 | 
OPT_SHOW_BITMAP
 | 
OPT_SHOW_STATS
;

90 
û¼
 << "İtiÚ " << 
İt_¡ršg
 << " unknown\n";

91 
û¼
 << "use,f,b,v‡nd/or + inhe option string\n";

92 
	`ex™
(1);

96 
Œy
 {

97 
veùÜ
<
X­Ÿn
::
‹rmcouÁ
> 
doş’s
;

98 
size_t
 
”rÜs
 = 0;

99 
¡©
 
sb
;

100 
¡ršg
 
	`dœ
(
¬gv
[1]);

101 ià(
	`¡©
((
dœ
 + "/Ÿmæšt").
	`c_¡r
(), &
sb
) == 0) {

102 #iâdeà
XAPIAN_HAS_FLINT_BACKEND


103 
throw
 "Flint database support isn'tƒnabled";

106 
Œy
 {

107 
X­Ÿn
::
D©aba£
 
db
 = X­Ÿn::
Flšt
::
	`İ’
(
dœ
);

108 
doş’s
.
	`»£rve
(
db
.
	`g‘_Ï¡docid
() + 1);

109 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 & 
e
) {

111 
cout
 << "Database couldn't be opened for„eading: "

112 << 
e
.
	`g‘_desütiÚ
()

113 << "\nCÚtšušg check‡nyway" << 
’dl
;

114 ++
”rÜs
;

119 cÚ¡ * 
bËs
[] = {

123 cÚ¡ **
t
 = 
bËs
;

124 
t
 !ğ
bËs
 + (tables)/(tables[0]); ++t) {

125 
¡ršg
 
	`bË
(
dœ
);

126 
bË
 += '/';

127 
bË
 +ğ*
t
;

128 
cout
 << *
t
 << ":\n";

129 ià(
	`¡rcmp
(*
t
, "position") == 0 ||

130 
	`¡rcmp
(*
t
, "value") == 0 ||

131 
	`¡rcmp
(*
t
, "spelling") == 0 ||

132 
	`¡rcmp
(*
t
, "synonym") == 0) {

134 ià(!
	`fe_exi¡s
(
bË
 + ".DB")) {

135 
cout
 << "Lazy c»©ed,‡nd‚Ù y‘ u£d.\n" << 
’dl
;

139 
”rÜs
 +ğ
	`check_æšt_bË
(*
t
, 
bË
, 
İts
, 
doş’s
);

142 } ià(
	`¡©
((
dœ
 + "/Ÿmch”t").
	`c_¡r
(), &
sb
) == 0) {

143 #iâdeà
XAPIAN_HAS_CHERT_BACKEND


144 
throw
 "Chert database support isn'tƒnabled";

149 
X­Ÿn
::
docid
 
db_Ï¡_docid
 = 
¡©ic_ÿ¡
<Xapian::docid>(-1);

150 
Œy
 {

151 
X­Ÿn
::
D©aba£
 
db
 = X­Ÿn::
Ch”t
::
	`İ’
(
dœ
);

152 
db_Ï¡_docid
 = 
db
.
	`g‘_Ï¡docid
();

153 
doş’s
.
	`»£rve
(
db_Ï¡_docid
 + 1);

154 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 & 
e
) {

156 
cout
 << "Database couldn't be opened for„eading: "

157 << 
e
.
	`g‘_desütiÚ
()

158 << "\nCÚtšušg check‡nyway" << 
’dl
;

159 ++
”rÜs
;

164 cÚ¡ * 
bËs
[] = {

168 cÚ¡ **
t
 = 
bËs
;

169 
t
 !ğ
bËs
 + (tables)/(tables[0]); ++t) {

170 
¡ršg
 
	`bË
(
dœ
);

171 
bË
 += '/';

172 
bË
 +ğ*
t
;

173 
cout
 << *
t
 << ":\n";

174 ià(
	`¡rcmp
(*
t
, "record") != 0 && strcmp(*t, "postlist") != 0) {

176 ià(!
	`fe_exi¡s
(
bË
 + ".DB")) {

177 ià(
	`¡rcmp
(*
t
, "termlist") == 0) {

178 
cout
 << "Not…resent.\n";

180 
cout
 << "Lazily created,‡nd‚ot yet used.\n";

182 
cout
 << 
’dl
;

186 
”rÜs
 +ğ
	`check_ch”t_bË
(*
t
, 
bË
, 
İts
, 
doş’s
,

187 
db_Ï¡_docid
);

190 } ià(
	`¡©
((
dœ
 + "/Ÿmb¿ss").
	`c_¡r
(), &
sb
) == 0) {

191 #iâdeà
XAPIAN_HAS_BRASS_BACKEND


192 
throw
 "Brass database support isn'tƒnabled";

197 
X­Ÿn
::
docid
 
db_Ï¡_docid
 = 
¡©ic_ÿ¡
<Xapian::docid>(-1);

198 
Œy
 {

199 
X­Ÿn
::
D©aba£
 
db
 = X­Ÿn::
B¿ss
::
	`İ’
(
dœ
);

200 
db_Ï¡_docid
 = 
db
.
	`g‘_Ï¡docid
();

201 
doş’s
.
	`»£rve
(
db_Ï¡_docid
 + 1);

202 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 & 
e
) {

204 
cout
 << "Database couldn't be opened for„eading: "

205 << 
e
.
	`g‘_desütiÚ
()

206 << "\nCÚtšušg check‡nyway" << 
’dl
;

207 ++
”rÜs
;

212 cÚ¡ * 
bËs
[] = {

216 cÚ¡ **
t
 = 
bËs
;

217 
t
 !ğ
bËs
 + (tables)/(tables[0]); ++t) {

218 
¡ršg
 
	`bË
(
dœ
);

219 
bË
 += '/';

220 
bË
 +ğ*
t
;

221 
cout
 << *
t
 << ":\n";

222 ià(
	`¡rcmp
(*
t
, "record") != 0 && strcmp(*t, "postlist") != 0) {

224 ià(!
	`fe_exi¡s
(
bË
 + ".DB")) {

225 ià(
	`¡rcmp
(*
t
, "termlist") == 0) {

226 
cout
 << "Not…resent.\n";

228 
cout
 << "Lazily created,‡nd‚ot yet used.\n";

230 
cout
 << 
’dl
;

234 
”rÜs
 +ğ
	`check_b¿ss_bË
(*
t
, 
bË
, 
İts
, 
doş’s
,

235 
db_Ï¡_docid
);

239 ià(
	`¡©
((
dœ
 + "/»cÜd_DB").
	`c_¡r
(), &
sb
) == 0) {

241 
û¼
 << 
¬gv
[0] << ": '" << 
dœ
 << "' is‡ quartz database.\n"

242 "SuµÜˆfÜ qu¬tz wa drİ³d iÀX­ŸÀ1.1.0" << 
’dl
;

243 
	`ex™
(1);

248 
¡ršg
 
f’ame
 = 
dœ
;

249 ià(
	`’dsw™h
(
f’ame
, '.'))

250 
f’ame
.
	`»size
(f’ame.
	`size
() - 1);

251 ià(
	`’dsw™h
(
f’ame
, ".DB"))

252 
f’ame
.
	`»size
(f’ame.
	`size
() - 3);

254 
size_t
 
p
 = 
f’ame
.
	`fšd_Ï¡_of
('/');

255 #ià
defšed
 
__WIN32__
 || defšed 
__EMX__


256 ià(
p
 =ğ
¡ršg
::
Åos
)… = 0;

257 
p
 = 
f’ame
.
	`fšd_Ï¡_of
('\\',…);

259 ià(
p
 =ğ
¡ršg
::
Åos
)… = 0; ++p;

261 
¡ršg
 
	`·th
(
f’ame
, 0, 
p
);

263 
¡ršg
 
bËÇme
;

264 
p
 !ğ
f’ame
.
	`size
()) {

265 
bËÇme
 +ğ
	`tŞow”
(
¡©ic_ÿ¡
<>(
f’ame
[
p
++]));

270 ià(
	`fe_exi¡s
(
·th
 + "iamflint")) {

271 
”rÜs
 = 
	`check_æšt_bË
(
bËÇme
.
	`c_¡r
(), 
f’ame
, 
İts
,

272 
doş’s
);

273 } ià(
	`fe_exi¡s
(
·th
 + "iambrass")) {

275 
X­Ÿn
::
docid
 
db_Ï¡_docid
 = 
¡©ic_ÿ¡
<Xapian::docid>(-1);

276 
”rÜs
 = 
	`check_b¿ss_bË
(
bËÇme
.
	`c_¡r
(), 
f’ame
, 
İts
,

277 
doş’s
, 
db_Ï¡_docid
);

280 
X­Ÿn
::
docid
 
db_Ï¡_docid
 = 
¡©ic_ÿ¡
<Xapian::docid>(-1);

281 
”rÜs
 = 
	`check_ch”t_bË
(
bËÇme
.
	`c_¡r
(), 
f’ame
, 
İts
,

282 
doş’s
, 
db_Ï¡_docid
);

285 ià(
”rÜs
 > 0) {

286 
cout
 << "TÙ®ƒ¼Ü found: " << 
”rÜs
 << 
’dl
;

287 
	`ex™
(1);

289 
cout
 << "NØ”rÜ found" << 
’dl
;

290 } 
	`ÿtch
 (cÚ¡ *
”rÜ
) {

291 
û¼
 << 
¬gv
[0] << ": " << 
”rÜ
 << 
’dl
;

292 
	`ex™
(1);

293 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
”rÜ
) {

294 
û¼
 << 
¬gv
[0] << ": " << 
”rÜ
.
	`g‘_desütiÚ
(è<< 
’dl
;

295 
	`ex™
(1);

296 } 
	`ÿtch
 (...) {

297 
û¼
 << 
¬gv
[0] << ": UnknowÀexû±iÚ" << 
’dl
;

298 
	`ex™
(1);

300 
	}
}

	@bin/xapian-chert-update.cc

22 
	~<cÚfig.h
>

24 
	~"§ã”ºo.h
"

26 
	~<io¡»am
>

28 
	~<c¡dio
>

29 
	~<c¡dlib
>

30 
	~<c¡ršg
>

31 
	~"§ãsys¡©.h
"

32 
	~<sys/ty³s.h
>

33 
	~"uts.h
"

35 
	~"ch”t_bË.h
"

37 
	~"æšt_bË.h
"

38 
	~"æšt_cursÜ.h
"

39 
	~"æšt_uts.h
"

40 
	~"·ck.h
"

42 
	~"§ãuni¡d.h
"

43 
	~"§ãfú.h
"

45 #ifdeà
__WIN32__


46 
	~"§ãwšdows.h
"

49 
	~"¡ršguts.h
"

51 
	~<x­Ÿn.h
>

53 
	~"gnu_g‘İt.h
"

55 
usšg
 
Çme¥aû
 
	g¡d
;

57 
	#PROG_NAME
 "ch”t-upd©e"

	)

58 
	#PROG_DESC
 "Upd©¨ch”ˆd©aba£ØthÃw fÜm© keys"

	)

60 
	#OPT_HELP
 1

	)

61 
	#OPT_VERSION
 2

	)

62 
	#OPT_NO_RENUMBER
 3

	)

64 
	$show_u§ge
() {

65 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] SOURCE_DATABASE DESTINATION_DATABASE\n\n"

70 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

71 
	}
}

74 
boŞ


75 
	$­³nd_f’ame_¬gum’t
(
¡ršg
 & 
cmd
, cÚ¡ sŒšg & 
¬g
) {

76 #ifdeà
__WIN32__


77 
cmd
.
	`»£rve
(cmd.
	`size
(è+ 
¬g
.size() + 3);

78 
cmd
 += " \"";

79 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
¬g
.
	`begš
(); i !ğ¬g.
	`’d
(); ++i) {

80 ià(*
i
 == '/') {

84 
cmd
 += '\\';

85 } ià(*
i
 < 32 || 
	`¡rchr
("<>\"|*?", *i)) {

87  
çl£
;

89 
cmd
 +ğ*
i
;

92 
cmd
 += '"';

95 
cmd
.
	`»£rve
(cmd.
	`size
(è+ 
¬g
.size() + 10);

99 ià(
¬g
[0] == '-')

100 
cmd
 += " ./";

102 
cmd
 += ' ';

104 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
¬g
.
	`begš
(); i !ğ¬g.
	`’d
(); ++i) {

106 ià(!
	`C_i§Êum
(*
i
è&& 
	`¡rchr
("/._-", *iè=ğ
NULL
) {

107 
cmd
 += '\\';

109 
cmd
 +ğ*
i
;

112  
Œue
;

113 
	}
}

115 #ifdeà
__WIN32__


116 
boŞ
 
	$ruÂšg_Ú_wš9x
() {

117 
wš9x
 = -1;

118 ià(
wš9x
 == -1) {

119 
OSVERSIONINFO
 
šfo
;

120 
	`mem£t
(&
šfo
, 0, (
OSVERSIONINFO
));

121 
šfo
.
dwOSV”siÚInfoSize
 = (
OSVERSIONINFO
);

122 ià(
	`G‘V”siÚEx
(&
šfo
)) {

123 
wš9x
 = (
šfo
.
dwPÏtfÜmId
 =ğ
VER_PLATFORM_WIN32_WINDOWS
);

126  
wš9x
;

127 
	}
}

131 
	$rm_rf
(cÚ¡ 
¡ršg
 &
f’ame
) {

133 
¡©
 
sb
;

134 ià(
f’ame
.
	`em±y
(è|| 
	`¡©
(f’ame, &
sb
è!ğ0 || !
	`S_ISDIR
(sb.
¡_mode
))

137 #ifdeà
__WIN32__


138 
¡ršg
 
cmd
;

139 ià(
	`ruÂšg_Ú_wš9x
()) {

141 
cmd
 = "deltree /y";

144 
cmd
 = "rd /s /q";

147 
¡ršg
 
	`cmd
("rm -rf");

149 ià(!
	`­³nd_f’ame_¬gum’t
(
cmd
, 
f’ame
)) ;

150 
	`sy¡em
(
cmd
);

151 
	}
}

154 
	$cİy_pos™iÚ
(
FlštTabË
 &
š
, 
Ch”tTabË
 *
out
)

156 
š
.
	`İ’
();

157 ià(
š
.
	`em±y
()) ;

159 
FlštCursÜ
 
	`cur
(&
š
);

160 
cur
.
	`fšd_’Œy
("");

162 
¡ršg
 
Ãwkey
;

163 
cur
.
	`Ãxt
()) {

164 cÚ¡ 
¡ršg
 & 
key
 = 
cur
.
cu¼’t_key
;

165 cÚ¡ * 
d
 = 
key
.
	`d©a
();

166 cÚ¡ * 
e
 = 
d
 + 
key
.
	`size
();

167 
X­Ÿn
::
docid
 
did
;

168 ià(!
	`F_uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
did
) || d ==ƒ)

169 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad docid key");

170 
Ãwkey
.
	`»size
(0);

171 
	`·ck_ušt_´e£rvšg_sÜt
(
Ãwkey
, 
did
);

172 
Ãwkey
.
	`­³nd
(
d
, 
e
 - d);

173 
boŞ
 
com´es£d
 = 
cur
.
	`»ad_g
(
Œue
);

174 
out
->
	`add
(
Ãwkey
, 
cur
.
cu¼’t_g
, 
com´es£d
);

176 
	}
}

179 
	$cİy_po¡li¡
(
FlštTabË
 &
š
, 
Ch”tTabË
 *
out
)

181 cÚ¡ 
¡ršg
 
	`fœ¡chunk
("\0\xff", 2);

183 
š
.
	`İ’
();

184 ià(
š
.
	`em±y
()) ;

186 
FlštCursÜ
 
	`cur
(&
š
);

187 
cur
.
	`fšd_’Œy
("");

188 
Œue
) {

189 ià(!
cur
.
	`Ãxt
()) ;

190 ià(
cur
.
cu¼’t_key
 >ğ
fœ¡chunk
) ;

191 
boŞ
 
com´es£d
 = 
cur
.
	`»ad_g
(
Œue
);

192 
out
->
	`add
(
cur
.
cu¼’t_key
, cur.
cu¼’t_g
, 
com´es£d
);

195 
¡ršg
 
Ãwkey
;

197 cÚ¡ 
¡ršg
 & 
key
 = 
cur
.
cu¼’t_key
;

198 cÚ¡ * 
d
 = 
key
.
	`d©a
();

199 cÚ¡ * 
e
 = 
d
 + 
key
.
	`size
();

200 
¡ršg
 
‹rm
;

201 ià(!
	`F_uÅack_¡ršg_´e£rvšg_sÜt
(&
d
, 
e
, 
‹rm
))

202 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad…ostlist key");

203 ià(
d
 =ğ
e
) {

205 
Ãwkey
 = 
	`·ck_ch”t_po¡li¡_key
(
‹rm
);

208 
X­Ÿn
::
docid
 
fœ¡did
;

209 ià(!
	`F_uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
fœ¡did
) || d !=ƒ)

210 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad…ostlist key");

211 
Ãwkey
 = 
	`·ck_ch”t_po¡li¡_key
(
‹rm
, 
fœ¡did
);

213 
boŞ
 
com´es£d
 = 
cur
.
	`»ad_g
(
Œue
);

214 
out
->
	`add
(
Ãwkey
, 
cur
.
cu¼’t_g
, 
com´es£d
);

215 } 
cur
.
	`Ãxt
());

216 
	}
}

219 
	$cİy_unchªged
(
FlštTabË
 &
š
, 
Ch”tTabË
 *
out
)

221 
š
.
	`İ’
();

222 ià(
š
.
	`em±y
()) ;

224 
FlštCursÜ
 
	`cur
(&
š
);

225 
cur
.
	`fšd_’Œy
("");

226 
cur
.
	`Ãxt
()) {

227 
boŞ
 
com´es£d
 = 
cur
.
	`»ad_g
(
Œue
);

228 
out
->
	`add
(
cur
.
cu¼’t_key
, cur.
cu¼’t_g
, 
com´es£d
);

230 
	}
}

233 
	$cİy_docid_keyed
(
FlštTabË
 &
š
, 
Ch”tTabË
 *
out
)

235 
š
.
	`İ’
();

236 ià(
š
.
	`em±y
()) ;

238 
FlštCursÜ
 
	`cur
(&
š
);

239 
cur
.
	`fšd_’Œy
("");

241 
¡ršg
 
Ãwkey
;

242 
cur
.
	`Ãxt
()) {

243 cÚ¡ 
¡ršg
 & 
key
 = 
cur
.
cu¼’t_key
;

244 cÚ¡ * 
d
 = 
key
.
	`d©a
();

245 cÚ¡ * 
e
 = 
d
 + 
key
.
	`size
();

246 
X­Ÿn
::
docid
 
did
;

247 ià(!
	`F_uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
did
) || d !=ƒ)

248 
throw
 
X­Ÿn
::
	`D©aba£CÜru±E¼Ü
("Bad docid key");

249 
Ãwkey
.
	`»size
(0);

250 
	`·ck_ušt_´e£rvšg_sÜt
(
Ãwkey
, 
did
);

251 
boŞ
 
com´es£d
 = 
cur
.
	`»ad_g
(
Œue
);

252 
out
->
	`add
(
Ãwkey
, 
cur
.
cu¼’t_g
, 
com´es£d
);

254 
	}
}

257 
	$maš
(
¬gc
, **
¬gv
)

259 cÚ¡ * 
İts
 = "b";

260 cÚ¡ 
İtiÚ
 
lÚg_İts
[] = {

261 {"h–p", 
no_¬gum’t
, 0, 
OPT_HELP
},

262 {"v”siÚ", 
no_¬gum’t
, 0, 
OPT_VERSION
},

263 {
NULL
, 0, 0, 0}

266 
size_t
 
block_size
 = 8192;

268 
c
;

269 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, 
İts
, 
lÚg_İts
, 0)) != -1) {

270 
c
) {

272 *
p
;

273 
block_size
 = 
	`¡¹oul
(
İrg
, &
p
, 10);

274 ià(
block_size
 <ğ64 && (*
p
 == 'K' || *p == 'k')) {

275 ++
p
;

276 
block_size
 *= 1024;

278 ià(*
p
 || 
block_size
 < 2048 || block_size > 65536 ||

279 (
block_size
 & (block_size - 1)) != 0) {

280 
û¼
 << 
PROG_NAME
": Bad v®u'" << 
İrg


282 << 
’dl
;

283 
	`ex™
(1);

287 
OPT_HELP
:

288 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

289 
	`show_u§ge
();

290 
	`ex™
(0);

291 
OPT_VERSION
:

292 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

293 
	`ex™
(0);

295 
	`show_u§ge
();

296 
	`ex™
(1);

300 ià(
¬gc
 - 
İtšd
 != 2) {

301 
	`show_u§ge
();

302 
	`ex™
(1);

306 cÚ¡ *
de¡dœ
 = 
¬gv
[
¬gc
 - 1];

308 
Œy
 {

309 cÚ¡ *
¤cdœ
 = 
¬gv
[
İtšd
];

311 ià(
	`¡rcmp
(
¤cdœ
, 
de¡dœ
) == 0) {

312 
cout
 << 
¬gv
[0]

314 << 
’dl
;

315 
	`ex™
(1);

319 
¡©
 
sb
;

320 ià(
	`¡©
(
	`¡ršg
(
¤cdœ
è+ "/Ÿmch”t", &
sb
) != 0) {

321 
cout
 << 
¬gv
[0] << ": '" << 
¤cdœ


322 << "' i nÙ‡ ch”ˆd©aba£ dœeùÜy" << 
’dl
;

323 
	`ex™
(1);

325 
Œy
 {

327 
X­Ÿn
::
D©aba£
 
	`db
(
¤cdœ
);

328 
cout
 << 
¬gv
[0] << ": '" << 
¤cdœ


329 << "' i ®»adyhÏ‹¡ ch”ˆfÜm©" << 
’dl
;

330 
	`ex™
(1);

331 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
D©aba£V”siÚE¼Ü
 &) {

338 ià(
	`mkdœ
(
de¡dœ
, 0755) < 0) {

342 ià(
”ºo
 =ğ
EEXIST
) {

343 
¡©
 
sb
;

344 ià(
	`¡©
(
de¡dœ
, &
sb
è=ğ0 && 
	`S_ISDIR
(sb.
¡_mode
))

345 
”ºo
 = 0;

347 
”ºo
 = 
EEXIST
;

349 ià(
”ºo
) {

350 
û¼
 << 
¬gv
[0] << ": cannot create directory '"

351 << 
de¡dœ
 << "': " << 
	`¡»¼Ü
(
”ºo
è<< 
’dl
;

352 
	`ex™
(1);

356 
	ebË_ty³
 {

357 
POSTLIST
, 
RECORD
, 
TERMLIST
, 
POSITION
, 
SPELLING
, 
SYNONYM


359 
	sbË_li¡
 {

361 cÚ¡ * 
Çme
;

363 
bË_ty³
 
ty³
;

365 
com´ess_¡¿‹gy
;

367 
boŞ
 
Ïzy
;

370 cÚ¡ 
bË_li¡
 
bËs
[] = {

372 { "po¡li¡", 
POSTLIST
, 
DONT_COMPRESS
, 
çl£
 },

373 { "»cÜd", 
RECORD
, 
Z_DEFAULT_STRATEGY
, 
çl£
 },

374 { "‹rmli¡", 
TERMLIST
, 
Z_DEFAULT_STRATEGY
, 
çl£
 },

375 { "pos™iÚ", 
POSITION
, 
DONT_COMPRESS
, 
Œue
 },

376 { "¥–lšg", 
SPELLING
, 
Z_DEFAULT_STRATEGY
, 
Œue
 },

377 { "synÚym", 
SYNONYM
, 
Z_DEFAULT_STRATEGY
, 
Œue
 }

379 cÚ¡ 
bË_li¡
 * 
bËs_’d
 = 
bËs
 +

380 ((
bËs
) / (tables[0]));

382 cÚ¡ 
bË_li¡
 * 
t
 = 
bËs
; < 
bËs_’d
; ++t) {

383 
boŞ
 
bad_¡©
 = 
çl£
;

384 
off_t
 
š_size
 = 0;

389 
cout
 << 
t
->
Çme
 << " ..." << 
æush
;

391 
¡ršg
 
	`s
(
¤cdœ
);

392 
s
 += '/';

393 
s
 +ğ
t
->
Çme
;

394 
s
 += '.';

396 
¡©
 
sb
;

397 ià(
	`¡©
(
s
 + "DB", &
sb
) == 0) {

398 
š_size
 +ğ
sb
.
¡_size
 / 1024;

399 } ià(
”ºo
 !ğ
ENOENT
) {

401 
bad_¡©
 = 
Œue
;

402 } ià(
t
->
ty³
 =ğ
TERMLIST
) {

403 
cout
 << '\r' << 
t
->
Çme
 << ": dÛ¢'ˆexi¡" << 
’dl
;

408 
FlštTabË
 
	`š
(
t
->
Çme
, 
s
, 
Œue
, 
DONT_COMPRESS
,->
Ïzy
);

410 
¡ršg
 
de¡
 = 
de¡dœ
;

411 
de¡
 += '/';

412 
de¡
 +ğ
t
->
Çme
;

413 
de¡
 += '.';

415 
Ch”tTabË
 
	`out
(
t
->
Çme
, 
de¡
, 
çl£
,->
com´ess_¡¿‹gy
,->
Ïzy
);

416 ià(!
t
->
Ïzy
) {

417 
out
.
	`ü—‹_ªd_İ’
(
block_size
);

419 
out
.
	`”a£
();

420 
out
.
	`£t_block_size
(
block_size
);

423 
out
.
	`£t_fuÎ_com·ùiÚ
(
Œue
);

429 
t
->
ty³
) {

430 
POSITION
:

431 
	`cİy_pos™iÚ
(
š
, &
out
);

433 
POSTLIST
:

434 
	`cİy_po¡li¡
(
š
, &
out
);

436 
SPELLING
: 
SYNONYM
:

437 
	`cİy_unchªged
(
š
, &
out
);

441 
	`cİy_docid_keyed
(
š
, &
out
);

446 
out
.
	`æush_db
();

447 
out
.
	`comm™
(1);

449 
cout
 << '\r' << 
t
->
Çme
 << ": ";

450 
off_t
 
out_size
 = 0;

451 ià(!
bad_¡©
) {

452 
¡©
 
sb
;

453 ià(
	`¡©
(
de¡
 + "DB", &
sb
) == 0) {

454 
out_size
 = 
sb
.
¡_size
 / 1024;

456 
bad_¡©
 = (
”ºo
 !ğ
ENOENT
);

459 ià(
bad_¡©
) {

460 
cout
 << "Done (couldn't stat‡llhe DB files)";

462 ià(
out_size
 =ğ
š_size
) {

463 
cout
 << "Size unchanged (";

464 } ià(
out_size
 < 
š_size
) {

465 
cout
 << "Reduced by "

466 << 100 * (
š_size
 - 
out_size
) / in_size << "% "

467 << 
š_size
 - 
out_size
 << "K (" << in_size << "K -> ";

469 
cout
 << "INCREASED by "

470 << 100 * (
out_size
 - 
š_size
) / in_size << "% "

471 << 
out_size
 - 
š_size
 << "K (" << in_size << "K -> ";

473 
cout
 << 
out_size
 << "K)";

475 
cout
 << 
’dl
;

484 
¡ršg
 
dÚÜ
 = 
de¡dœ
;

485 
dÚÜ
 += "/donor.tmp";

487 ()
X­Ÿn
::
Ch”t
::
	`İ’
(
dÚÜ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

488 
¡ršg
 
äom
 = 
dÚÜ
;

489 
äom
 += "/iamchert";

490 
¡ršg
 
	`to
(
de¡dœ
);

491 
to
 += "/iamchert";

492 ià(
	`»Çme
(
äom
.
	`c_¡r
(), 
to
.c_str()) == -1) {

493 
û¼
 << 
¬gv
[0] << ": cªnÙ„’am'" << 
äom
 << "'o '"

494 << 
to
 << "': " << 
	`¡»¼Ü
(
”ºo
è<< 
’dl
;

495 
	`ex™
(1);

498 
	`rm_rf
(
dÚÜ
);

499 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
”rÜ
) {

500 
û¼
 << 
¬gv
[0] << ": " << 
”rÜ
.
	`g‘_desütiÚ
(è<< 
’dl
;

501 
	`ex™
(1);

502 } 
	`ÿtch
 (cÚ¡ * 
msg
) {

503 
û¼
 << 
¬gv
[0] << ": " << 
msg
 << 
’dl
;

504 
	`ex™
(1);

506 
	}
}

	@bin/xapian-compact-brass.cc

22 
	~<cÚfig.h
>

24 
	~"x­Ÿn-com·ù.h
"

26 
	~<®gÜ™hm
>

27 
	~<io¡»am
>

28 
	~<queue
>

30 
	~<c¡dio
>

32 
	~"§ã”ºo.h
"

33 
	~<sys/ty³s.h
>

34 
	~"§ãsys¡©.h
"

36 
	~"b¿ss_bË.h
"

37 
	~"b¿ss_cursÜ.h
"

38 
	~"š‹º®ty³s.h
"

39 
	~"·ck.h
"

40 
	~"uts.h
"

41 
	~"v®ue¡©s.h
"

43 
	~<x­Ÿn.h
>

45 
usšg
 
Çme¥aû
 
	g¡d
;

49 
Çme¥aû
 
	gB¿ssCom·ù
 {

51 
šlše
 
boŞ


52 
is_m‘ašfo_key
(cÚ¡ 
¡ršg
 & 
key
)

54  
	gkey
.
size
(è=ğ1 && 
key
[0] == '\0';

57 
šlše
 
boŞ


58 
is_u£r_m‘ad©a_key
(cÚ¡ 
¡ršg
 & 
key
)

60  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xc0';

63 
šlše
 
boŞ


64 
is_v®ue¡©s_key
(cÚ¡ 
¡ršg
 & 
key
)

66  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xd0';

69 
šlše
 
boŞ


70 
is_v®uechunk_key
(cÚ¡ 
¡ršg
 & 
key
)

72  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xd8';

75 
šlše
 
boŞ


76 
is_doş’chunk_key
(cÚ¡ 
¡ršg
 & 
key
)

78  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xe0';

81 şas 
	cPo¡li¡CursÜ
 : 
´iv©e
 
B¿ssCursÜ
 {

82 
X­Ÿn
::
docid
 
off£t
;

84 
	gpublic
:

85 
¡ršg
 
key
, 
	gg
;

86 
	gX­Ÿn
::
docid
 
fœ¡did
;

87 
	gX­Ÿn
::
‹rmcouÁ
 
tf
, 
	gcf
;

89 
Po¡li¡CursÜ
(
B¿ssTabË
 *
š
, 
X­Ÿn
::
docid
 
off£t_
)

90 : 
B¿ssCursÜ
(
š
), 
off£t
(
off£t_
), 
fœ¡did
(0)

92 
fšd_’Œy
(
¡ršg
());

93 
Ãxt
();

96 ~
Po¡li¡CursÜ
()

98 
d–‘e
 
	gB¿ssCursÜ
::
g‘_bË
();

101 
boŞ
 
Ãxt
() {

102 ià(!
	gB¿ssCursÜ
::
Ãxt
()è 
çl£
;

105 
»ad_g
();

106 
	gkey
 = 
cu¼’t_key
;

107 
	gg
 = 
cu¼’t_g
;

108 
	gtf
 = 
cf
 = 0;

109 ià(
is_m‘ašfo_key
(
key
)è 
	gŒue
;

110 ià(
is_u£r_m‘ad©a_key
(
key
)è 
	gŒue
;

111 ià(
is_v®ue¡©s_key
(
key
)è 
	gŒue
;

112 ià(
is_v®uechunk_key
(
key
)) {

113 cÚ¡ * 
	gp
 = 
key
.
d©a
();

114 cÚ¡ * 
	g’d
 = 
p
 + 
key
.
Ëngth
();

115 
	gp
 += 2;

116 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

117 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
))

118 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("bad value key");

119 
	gX­Ÿn
::
docid
 
did
;

120 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
p
, 
’d
, &
did
))

121 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("bad value key");

122 
	gdid
 +ğ
off£t
;

124 
	gkey
.
assign
("\0\xd8", 2);

125 
·ck_ušt
(
key
, 
¦Ù
);

126 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

127  
	gŒue
;

133 cÚ¡ * 
	gd
 = 
key
.
d©a
();

134 cÚ¡ * 
	ge
 = 
d
 + 
key
.
size
();

135 ià(
is_doş’chunk_key
(
key
)) {

136 
	gd
 += 2;

138 
¡ršg
 
	gŠame
;

139 ià(!
uÅack_¡ršg_´e£rvšg_sÜt
(&
d
, 
e
, 
Šame
))

140 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist key");

143 ià(
	gd
 =ğ
e
) {

145 
d
 = 
g
.
d©a
();

146 
	ge
 = 
d
 + 
g
.
size
();

147 ià(!
uÅack_ušt
(&
d
, 
e
, &
tf
) ||

148 !
uÅack_ušt
(&
d
, 
e
, &
cf
) ||

149 !
uÅack_ušt
(&
d
, 
e
, &
fœ¡did
)) {

150 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist key");

152 ++
	gfœ¡did
;

153 
	gg
.
”a£
(0, 
d
 - 
g
.
d©a
());

156 
size_t
 
	gtmp
 = 
d
 - 
key
.
d©a
();

157 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
fœ¡did
è|| 
	gd
 !=ƒ)

158 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist key");

159 ià(
is_doş’chunk_key
(
key
)) {

160 
	gkey
.
”a£
(
tmp
);

162 
	gkey
.
”a£
(
tmp
 - 1);

165 
	gfœ¡did
 +ğ
off£t
;

166  
	gŒue
;

170 şas 
	cPo¡li¡CursÜGt
 {

171 
	gpublic
:

174 
boŞ
 
İ”©Ü
()(cÚ¡ 
Po¡li¡CursÜ
 *
a
, cÚ¡ Po¡li¡CursÜ *
	gb
) {

175 ià(
	ga
->
	gkey
 > 
	gb
->keyè 
	gŒue
;

176 ià(
	ga
->
	gkey
 !ğ
b
->
key
è 
çl£
;

177  (
	ga
->
	gfœ¡did
 > 
	gb
->firstdid);

181 
¡ršg


182 
’code_v®ue¡©s
(
X­Ÿn
::
doccouÁ
 
äeq
,

183 cÚ¡ 
¡ršg
 & 
lbound
, cÚ¡ sŒšg & 
ubound
)

185 
¡ršg
 
	gv®ue
;

186 
·ck_ušt
(
v®ue
, 
äeq
);

187 
·ck_¡ršg
(
v®ue
, 
lbound
);

191 ià(
	glbound
 !ğ
ubound
è
v®ue
 += ubound;

192  
	gv®ue
;

196 
m”ge_po¡li¡s
(
B¿ssTabË
 * 
out
, 
veùÜ
<
X­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
off£t
,

197 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
, veùÜ<¡ršg>::cÚ¡_™”©Ü 
e
,

198 
X­Ÿn
::
docid
 
tÙ_off
)

200 
tÙËn_t
 
tÙ_tÙËn
 = 0;

201 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_lbound
 = 
¡©ic_ÿ¡
<
X­Ÿn
::termcount>(-1);

202 
	gX­Ÿn
::
‹rmcouÁ
 
wdf_ubound
 = 0;

203 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_ubound
 = 0;

204 
	g´iÜ™y_queue
<
	gPo¡li¡CursÜ
 *, 
	gveùÜ
<Po¡li¡CursÜ *>, 
	gPo¡li¡CursÜGt
> 
	gpq
;

205  ; 
	gb
 !ğ
e
; ++b, ++
	goff£t
) {

206 
B¿ssTabË
 *
	gš
 = 
Ãw
 B¿ssTabË("po¡li¡", *
b
, 
Œue
);

207 
	gš
->
İ’
();

208 ià(
	gš
->
em±y
()) {

210 
d–‘e
 
	gš
;

216 
Po¡li¡CursÜ
 * 
	gcur
 = 
Ãw
 Po¡li¡CursÜ(
š
, *
off£t
);

221 ià(
is_m‘ašfo_key
(
cur
->
key
)) {

222 cÚ¡ * 
	gd©a
 = 
cur
->
g
.
d©a
();

223 cÚ¡ * 
	g’d
 = 
d©a
 + 
cur
->
g
.
size
();

224 
	gX­Ÿn
::
docid
 
dummy_did
 = 0;

225 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
dummy_did
)) {

226 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

229 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_lbound_tmp
;

230 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
doş’_lbound_tmp
)) {

231 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

233 
	gdoş’_lbound
 = 
mš
(
doş’_lbound
, 
doş’_lbound_tmp
);

235 
	gX­Ÿn
::
‹rmcouÁ
 
wdf_ubound_tmp
;

236 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
wdf_ubound_tmp
)) {

237 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

239 
	gwdf_ubound
 = 
max
(
wdf_ubound
, 
wdf_ubound_tmp
);

241 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_ubound_tmp
;

242 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
doş’_ubound_tmp
)) {

243 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

245 
	gdoş’_ubound_tmp
 +ğ
wdf_ubound_tmp
;

246 
	gdoş’_ubound
 = 
max
(
doş’_ubound
, 
doş’_ubound_tmp
);

248 
tÙËn_t
 
	gtÙËn
 = 0;

249 ià(!
uÅack_ušt_Ï¡
(&
d©a
, 
’d
, &
tÙËn
)) {

250 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

252 
	gtÙ_tÙËn
 +ğ
tÙËn
;

253 ià(
	gtÙ_tÙËn
 < 
	gtÙËn
) {

254 
	gthrow
 "totlen wrapped!";

257 ià(
	gcur
->
Ãxt
()) {

258 
	gpq
.
push
(
cur
);

260 
d–‘e
 
	gcur
;

265 
¡ršg
 
	gg
;

266 
·ck_ušt
(
g
, 
tÙ_off
);

267 
·ck_ušt
(
g
, 
doş’_lbound
);

268 
·ck_ušt
(
g
, 
wdf_ubound
);

269 
·ck_ušt
(
g
, 
doş’_ubound
 - 
wdf_ubound
);

270 
·ck_ušt_Ï¡
(
g
, 
tÙ_tÙËn
);

271 
	gout
->
add
(
¡ršg
(1, '\0'), 
g
);

274 
¡ršg
 
	gÏ¡_key
;

277 
¡ršg
 
	gÏ¡_g
;

278 !
	gpq
.
em±y
()) {

279 
Po¡li¡CursÜ
 * 
	gcur
 = 
pq
.
tİ
();

280 cÚ¡ 
	g¡ršg
& 
	gkey
 = 
cur
->
key
;

281 ià(!
is_u£r_m‘ad©a_key
(
key
)) ;

283 cÚ¡ 
	g¡ršg
 & 
	gg
 = 
cur
->
g
;

284 ià(
	gkey
 =ğ
Ï¡_key
) {

285 ià(
g
 !ğ
Ï¡_g
)

286 
û¼
 << "W¬nšg: du¶iÿ‹ u£¸m‘ad©¨key w™h difã»Áag v®u-…ickšg‡rb™¿ryag v®ue" << 
’dl
;

288 
	gout
->
add
(
key
, 
g
);

289 
	gÏ¡_key
 = 
key
;

290 
	gÏ¡_g
 = 
g
;

293 
	gpq
.
pİ
();

294 ià(
	gcur
->
Ãxt
()) {

295 
	gpq
.
push
(
cur
);

297 
d–‘e
 
	gcur
;

304 
	gX­Ÿn
::
doccouÁ
 
äeq
 = 0;

305 
¡ršg
 
	glbound
, 
	gubound
;

307 
¡ršg
 
	gÏ¡_g
;

308 !
	gpq
.
em±y
()) {

309 
Po¡li¡CursÜ
 * 
	gcur
 = 
pq
.
tİ
();

310 cÚ¡ 
	g¡ršg
& 
	gkey
 = 
cur
->
key
;

311 ià(!
is_v®ue¡©s_key
(
key
)) ;

312 ià(
	gkey
 !ğ
Ï¡_key
) {

316 ià(
äeq
) {

317 
out
->
add
(
Ï¡_key
, 
’code_v®ue¡©s
(
äeq
, 
lbound
, 
ubound
));

318 
	gäeq
 = 0;

320 
	gÏ¡_key
 = 
key
;

323 cÚ¡ 
	g¡ršg
 & 
	gg
 = 
cur
->
g
;

325 cÚ¡ * 
	gpos
 = 
g
.
d©a
();

326 cÚ¡ * 
	g’d
 = 
pos
 + 
g
.
size
();

328 
	gX­Ÿn
::
doccouÁ
 
f
;

329 
¡ršg
 
	gl
, 
	gu
;

330 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
f
)) {

331 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete stats item in valueable");

332 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Frequency statistic in valueable isoo†arge");

334 ià(!
uÅack_¡ršg
(&
pos
, 
’d
, 
l
)) {

335 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete stats item in valueable");

336 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Lower bound in valueable isoo†arge");

338 
size_t
 
	gËn
 = 
’d
 - 
pos
;

339 ià(
	gËn
 == 0) {

340 
u
 = 
l
;

342 
	gu
.
assign
(
pos
, 
Ën
);

344 ià(
	gäeq
 == 0) {

345 
äeq
 = 
f
;

346 
	glbound
 = 
l
;

347 
	gubound
 = 
u
;

349 
	gäeq
 +ğ
f
;

350 ià(
	gl
 < 
	glbound
èlbound = 
l
;

351 ià(
	gu
 > 
	gubound
èubound = 
u
;

354 
	gpq
.
pİ
();

355 ià(
	gcur
->
Ãxt
()) {

356 
	gpq
.
push
(
cur
);

358 
d–‘e
 
	gcur
;

362 ià(
	gäeq
) {

363 
	gout
->
add
(
Ï¡_key
, 
’code_v®ue¡©s
(
äeq
, 
lbound
, 
ubound
));

368 !
	gpq
.
em±y
()) {

369 
Po¡li¡CursÜ
 * 
	gcur
 = 
pq
.
tİ
();

370 cÚ¡ 
	g¡ršg
 & 
	gkey
 = 
cur
->
key
;

371 ià(!
is_v®uechunk_key
(
key
)) ;

372 
As£¹
(!
is_u£r_m‘ad©a_key
(
key
));

373 
	gout
->
add
(
key
, 
cur
->
g
);

374 
	gpq
.
pİ
();

375 ià(
	gcur
->
Ãxt
()) {

376 
	gpq
.
push
(
cur
);

378 
d–‘e
 
	gcur
;

382 
	gX­Ÿn
::
‹rmcouÁ
 
tf
 = 0, 
	gcf
 = 0;

383 
	gveùÜ
<
	g·œ
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> > 
	ggs
;

384 
	gŒue
) {

385 
Po¡li¡CursÜ
 * 
	gcur
 = 
NULL
;

386 ià(!
	gpq
.
em±y
()) {

387 
	gcur
 = 
pq
.
tİ
();

388 
	gpq
.
pİ
();

390 
As£¹
(
cur
 =ğ
NULL
 || !
is_u£r_m‘ad©a_key
(cur->
key
));

391 ià(
	gcur
 =ğ
NULL
 || 
cur
->
key
 !ğ
Ï¡_key
) {

392 ià(!
gs
.
em±y
()) {

393 
¡ršg
 
fœ¡_g
;

394 
·ck_ušt
(
fœ¡_g
, 
tf
);

395 
·ck_ušt
(
fœ¡_g
, 
cf
);

396 
·ck_ušt
(
fœ¡_g
, 
gs
[0].
fœ¡
 - 1);

397 
¡ršg
 
	gg
 = 
gs
[0].
£cÚd
;

398 
	gg
[0] = (
gs
.
size
() == 1) ? '1' : '0';

399 
	gfœ¡_g
 +ğ
g
;

400 
	gout
->
add
(
Ï¡_key
, 
fœ¡_g
);

402 
¡ršg
 
	g‹rm
;

403 ià(!
is_doş’chunk_key
(
Ï¡_key
)) {

404 cÚ¡ * 
	gp
 = 
Ï¡_key
.
d©a
();

405 cÚ¡ * 
	g’d
 = 
p
 + 
Ï¡_key
.
size
();

406 ià(!
uÅack_¡ršg_´e£rvšg_sÜt
(&
p
, 
’d
, 
‹rm
è|| 
	gp
 !=ƒnd)

407 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist chunk key");

410 
	gveùÜ
<
	g·œ
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

411 
	gi
 = 
gs
.
begš
();

412 ++
	gi
 !ğ
gs
.
’d
()) {

413 
g
 = 
i
->
£cÚd
;

414 
	gg
[0] = (
i
 + 1 =ğ
gs
.
’d
()) ? '1' : '0';

415 
	gout
->
add
(
·ck_b¿ss_po¡li¡_key
(
‹rm
, 
i
->
fœ¡
), 
g
);

418 
	ggs
.
ş—r
();

419 ià(
	gcur
 =ğ
NULL
) ;

420 
	gtf
 = 
cf
 = 0;

421 
	gÏ¡_key
 = 
cur
->
key
;

423 
	gtf
 +ğ
cur
->
tf
;

424 
	gcf
 +ğ
cur
->
cf
;

425 
	ggs
.
push_back
(
make_·œ
(
cur
->
fœ¡did
, cur->
g
));

426 ià(
	gcur
->
Ãxt
()) {

427 
	gpq
.
push
(
cur
);

429 
d–‘e
 
	gcur
;

434 
	gM”geCursÜ
 : 
public
 
B¿ssCursÜ
 {

435 
M”geCursÜ
(
B¿ssTabË
 *
š
è: 
B¿ssCursÜ
(in) {

436 
fšd_’Œy
(
¡ršg
());

437 
Ãxt
();

440 ~
M”geCursÜ
() {

441 
d–‘e
 
	gB¿ssCursÜ
::
g‘_bË
();

445 
	sCursÜGt
 {

447 
boŞ
 
İ”©Ü
()(cÚ¡ 
B¿ssCursÜ
 *
	ga
, cÚ¡ B¿ssCursÜ *
	gb
) {

448 ià(
	gb
->
aá”_’d
()è 
	gçl£
;

449 ià(
	ga
->
aá”_’d
()è 
	gŒue
;

450  (
	ga
->
	gcu¼’t_key
 > 
	gb
->current_key);

454 
	#MAGIC_XOR_VALUE
 96

	)

457 şas 
	cP»fixCom´es£dSŒšgItÜ
 {

458 cÚ¡ * 
	gp
;

459 
size_t
 
	gËá
;

460 
¡ršg
 
	gcu¼’t
;

462 
P»fixCom´es£dSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
,

463 cÚ¡ 
¡ršg
 &
cu¼’t_
)

464 : 
p
(
p_
), 
Ëá
(
Ëá_
), 
cu¼’t
(
cu¼’t_
) { }

466 
	gpublic
:

467 
P»fixCom´es£dSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

468 : 
p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
d©a
())),

469 
Ëá
(
s
.
size
()) {

470 ià(
	gËá
) {

471 
	gİ”©Ü
++();

473 
	gp
 = 
NULL
;

477 cÚ¡ 
	g¡ršg
 & 
	gİ”©Ü
*() const {

478  
	gcu¼’t
;

481 
P»fixCom´es£dSŒšgItÜ
 
	gİ”©Ü
++() {

482 cÚ¡ * 
	gŞd_p
 = 
p
;

483 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

484 
¡ršg
 
	gŞd_cu¼’t
 = 
cu¼’t
;

485 
	gİ”©Ü
++();

486  
P»fixCom´es£dSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
, 
Şd_cu¼’t
);

489 
	gP»fixCom´es£dSŒšgItÜ
 & 
	gİ”©Ü
++() {

490 ià(
	gËá
 == 0) {

491 
p
 = 
NULL
;

493 ià(!
	gcu¼’t
.
em±y
()) {

494 
	gcu¼’t
.
»size
(*
p
++ ^ 
MAGIC_XOR_VALUE
);

495 --
	gËá
;

497 
size_t
 
	gadd
;

498 ià(
	gËá
 =ğ0 || (
add
 = *
p
 ^ 
MAGIC_XOR_VALUE
è>ğ
Ëá
)

499 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling data (too†ittle†eft)");

500 
	gcu¼’t
.
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
add
);

501 
	gp
 +ğ
add
 + 1;

502 
	gËá
 -ğ
add
 + 1;

504  *
	gthis
;

507 
boŞ
 
©_’d
() const {

508  
	gp
 =ğ
NULL
;

513 şas 
	cP»fixCom´es£dSŒšgWr™”
 {

514 
¡ršg
 
	gcu¼’t
;

515 
	g¡ršg
 & 
	gout
;

517 
	gpublic
:

518 
P»fixCom´es£dSŒšgWr™”
(
¡ršg
 & 
out_
è: 
out
(out_) { }

520 
­³nd
(cÚ¡ 
¡ršg
 & 
wÜd
) {

523 ià(!
cu¼’t
.
em±y
()) {

524 
size_t
 
Ën
 = 
mš
(
cu¼’t
.
size
(), 
wÜd
.size());

525 
size_t
 
	gi
;

526 
	gi
 = 0; i < 
	gËn
; ++i) {

527 ià(
	gcu¼’t
[
i
] !ğ
wÜd
[i]) ;

529 
	gout
 +ğ(
i
 ^ 
MAGIC_XOR_VALUE
);

530 
	gout
 +ğ((
wÜd
.
size
(è- 
i
è^ 
MAGIC_XOR_VALUE
);

531 
	gout
.
­³nd
(
wÜd
.
d©a
(è+ 
i
, wÜd.
size
() - i);

533 
	gout
 +ğ(
wÜd
.
size
(è^ 
MAGIC_XOR_VALUE
);

534 
	gout
 +ğ
wÜd
;

536 
	gcu¼’t
 = 
wÜd
;

540 
	sP»fixCom´es£dSŒšgItÜGt
 {

542 
boŞ
 
İ”©Ü
()(cÚ¡ 
P»fixCom´es£dSŒšgItÜ
 *
	ga
,

543 cÚ¡ 
P»fixCom´es£dSŒšgItÜ
 *
	gb
) {

544  (**
	ga
 > **
	gb
);

549 
m”ge_¥–lšgs
(
B¿ssTabË
 * 
out
,

550 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

551 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
e
)

553 
´iÜ™y_queue
<
M”geCursÜ
 *, 
	gveùÜ
<
	gM”geCursÜ
 *>, 
	gCursÜGt
> 
	gpq
;

554  ; 
	gb
 !ğ
e
; ++b) {

555 
B¿ssTabË
 *
	gš
 = 
Ãw
 B¿ssTabË("¥–lšg", *
b
, 
Œue
, 
DONT_COMPRESS
,rue);

556 
	gš
->
İ’
();

557 ià(!
	gš
->
em±y
()) {

560 
	gpq
.
push
(
Ãw
 
M”geCursÜ
(
š
));

562 
d–‘e
 
	gš
;

566 !
	gpq
.
em±y
()) {

567 
M”geCursÜ
 * 
	gcur
 = 
pq
.
tİ
();

568 
	gpq
.
pİ
();

570 
¡ršg
 
	gkey
 = 
cur
->
cu¼’t_key
;

571 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 > 
	gkey
) {

574 
boŞ
 
	gcom´es£d
 = 
cur
->
»ad_g
(
Œue
);

575 
	gout
->
add
(
key
, 
cur
->
cu¼’t_g
, 
com´es£d
);

576 ià(
	gcur
->
Ãxt
()) {

577 
	gpq
.
push
(
cur
);

579 
d–‘e
 
	gcur
;

585 
¡ršg
 
	gg
;

586 ià(
	gkey
[0] != 'W') {

589 
´iÜ™y_queue
<
P»fixCom´es£dSŒšgItÜ
 *,

590 
veùÜ
<
P»fixCom´es£dSŒšgItÜ
 *>,

591 
P»fixCom´es£dSŒšgItÜGt
> 
pqg
;

595 
	gveùÜ
<
	gM”geCursÜ
 *> 
	gvec
;

596 
	gvec
.
»£rve
(
pq
.
size
());

598 
	gŒue
) {

599 
	gcur
->
»ad_g
();

600 
	gpqg
.
push
(
Ãw
 
P»fixCom´es£dSŒšgItÜ
(
cur
->
cu¼’t_g
));

601 
	gvec
.
push_back
(
cur
);

602 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

603 
	gcur
 = 
pq
.
tİ
();

604 
	gpq
.
pİ
();

607 
P»fixCom´es£dSŒšgWr™”
 
wr
(
g
);

608 
¡ršg
 
	gÏ¡wÜd
;

609 !
	gpqg
.
em±y
()) {

610 
P»fixCom´es£dSŒšgItÜ
 * 
	g™
 = 
pqg
.
tİ
();

611 
¡ršg
 
	gwÜd
 = **
™
;

612 ià(
	gwÜd
 !ğ
Ï¡wÜd
) {

613 
Ï¡wÜd
 = 
wÜd
;

614 
	gwr
.
­³nd
(
Ï¡wÜd
);

616 ++*
	g™
;

617 
	gpqg
.
pİ
();

618 ià(!
	g™
->
©_’d
()) {

619 
	gpqg
.
push
(
™
);

621 
d–‘e
 
	g™
;

625 
	gveùÜ
<
	gM”geCursÜ
 *>::
cÚ¡_™”©Ü
 
i
;

626 
	gi
 = 
vec
.
begš
(); i !ğvec.
’d
(); ++i) {

627 
	gcur
 = *
i
;

628 ià(
	gcur
->
Ãxt
()) {

629 
	gpq
.
push
(
cur
);

631 
d–‘e
 
	gcur
;

636 
	gX­Ÿn
::
‹rmcouÁ
 
tÙ_äeq
 = 0;

637 
	gŒue
) {

638 
	gcur
->
»ad_g
();

639 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

640 cÚ¡ * 
	gp
 = 
cur
->
cu¼’t_g
.
d©a
();

641 cÚ¡ * 
	g’d
 = 
p
 + 
cur
->
cu¼’t_g
.
size
();

642 ià(!
uÅack_ušt_Ï¡
(&
p
, 
’d
, &
äeq
è|| 
	gäeq
 == 0) {

643 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

645 
	gtÙ_äeq
 +ğ
äeq
;

646 ià(
	gcur
->
Ãxt
()) {

647 
	gpq
.
push
(
cur
);

649 
d–‘e
 
	gcur
;

651 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

652 
	gcur
 = 
pq
.
tİ
();

653 
	gpq
.
pİ
();

655 
	gg
.
»size
(0);

656 
·ck_ušt_Ï¡
(
g
, 
tÙ_äeq
);

658 
	gout
->
add
(
key
, 
g
);

662 şas 
	cBy‹L’gthP»fixedSŒšgItÜ
 {

663 cÚ¡ * 
	gp
;

664 
size_t
 
	gËá
;

666 
By‹L’gthP»fixedSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
)

667 : 
p
(
p_
), 
Ëá
(
Ëá_
) { }

669 
	gpublic
:

670 
By‹L’gthP»fixedSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

671 : 
p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
d©a
())),

672 
Ëá
(
s
.
size
()) { }

674 
¡ršg
 
	gİ”©Ü
*() const {

675 
size_t
 
	gËn
 = *
p
 ^ 
MAGIC_XOR_VALUE
;

676  
¡ršg
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
Ën
);

679 
By‹L’gthP»fixedSŒšgItÜ
 
	gİ”©Ü
++() {

680 cÚ¡ * 
	gŞd_p
 = 
p
;

681 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

682 
	gİ”©Ü
++();

683  
By‹L’gthP»fixedSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
);

686 
	gBy‹L’gthP»fixedSŒšgItÜ
 & 
	gİ”©Ü
++() {

687 ià(!
	gËá
) {

688 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad synonym data (none†eft)");

690 
size_t
 
	gadd
 = (*
p
 ^ 
MAGIC_XOR_VALUE
) + 1;

691 ià(
	gËá
 < 
	gadd
) {

692 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad synonym data (too†ittle†eft)");

694 
	gp
 +ğ
add
;

695 
	gËá
 -ğ
add
;

696  *
	gthis
;

699 
boŞ
 
©_’d
() const {

700  
	gËá
 == 0;

704 
	sBy‹L’gthP»fixedSŒšgItÜGt
 {

706 
boŞ
 
İ”©Ü
()(cÚ¡ 
By‹L’gthP»fixedSŒšgItÜ
 *
	ga
,

707 cÚ¡ 
By‹L’gthP»fixedSŒšgItÜ
 *
	gb
) {

708  (**
	ga
 > **
	gb
);

713 
m”ge_synÚyms
(
B¿ssTabË
 * 
out
,

714 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

715 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
e
)

717 
´iÜ™y_queue
<
M”geCursÜ
 *, 
	gveùÜ
<
	gM”geCursÜ
 *>, 
	gCursÜGt
> 
	gpq
;

718  ; 
	gb
 !ğ
e
; ++b) {

719 
B¿ssTabË
 *
	gš
 = 
Ãw
 B¿ssTabË("synÚym", *
b
, 
Œue
, 
DONT_COMPRESS
,rue);

720 
	gš
->
İ’
();

721 ià(!
	gš
->
em±y
()) {

724 
	gpq
.
push
(
Ãw
 
M”geCursÜ
(
š
));

726 
d–‘e
 
	gš
;

730 !
	gpq
.
em±y
()) {

731 
M”geCursÜ
 * 
	gcur
 = 
pq
.
tİ
();

732 
	gpq
.
pİ
();

734 
¡ršg
 
	gkey
 = 
cur
->
cu¼’t_key
;

735 ià(
	gpq
.
tİ
()->
	gcu¼’t_key
 > 
	gkey
) {

738 
boŞ
 
	gcom´es£d
 = 
cur
->
»ad_g
(
Œue
);

739 
	gout
->
add
(
key
, 
cur
->
cu¼’t_g
, 
com´es£d
);

740 ià(
	gcur
->
Ãxt
()) {

741 
	gpq
.
push
(
cur
);

743 
d–‘e
 
	gcur
;

749 
¡ršg
 
	gg
;

753 
	g´iÜ™y_queue
<
	gBy‹L’gthP»fixedSŒšgItÜ
 *,

754 
	gveùÜ
<
	gBy‹L’gthP»fixedSŒšgItÜ
 *>,

755 
	gBy‹L’gthP»fixedSŒšgItÜGt
> 
	gpqg
;

756 
	gveùÜ
<
	gM”geCursÜ
 *> 
	gvec
;

758 
	gŒue
) {

759 
	gcur
->
»ad_g
();

760 
	gpqg
.
push
(
Ãw
 
By‹L’gthP»fixedSŒšgItÜ
(
cur
->
cu¼’t_g
));

761 
	gvec
.
push_back
(
cur
);

762 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

763 
	gcur
 = 
pq
.
tİ
();

764 
	gpq
.
pİ
();

767 
¡ršg
 
	gÏ¡wÜd
;

768 !
	gpqg
.
em±y
()) {

769 
By‹L’gthP»fixedSŒšgItÜ
 * 
	g™
 = 
pqg
.
tİ
();

770 ià(**
	g™
 !ğ
Ï¡wÜd
) {

771 
Ï¡wÜd
 = **
™
;

772 
	gg
 +ğ
by‹
(
Ï¡wÜd
.
size
(è^ 
MAGIC_XOR_VALUE
);

773 
	gg
 +ğ
Ï¡wÜd
;

775 ++*
	g™
;

776 
	gpqg
.
pİ
();

777 ià(!
	g™
->
©_’d
()) {

778 
	gpqg
.
push
(
™
);

780 
d–‘e
 
	g™
;

784 
	gveùÜ
<
	gM”geCursÜ
 *>::
cÚ¡_™”©Ü
 
i
;

785 
	gi
 = 
vec
.
begš
(); i !ğvec.
’d
(); ++i) {

786 
	gcur
 = *
i
;

787 ià(
	gcur
->
Ãxt
()) {

788 
	gpq
.
push
(
cur
);

790 
d–‘e
 
	gcur
;

794 
	gout
->
add
(
key
, 
g
);

799 
muÉim”ge_po¡li¡s
(
B¿ssTabË
 * 
out
, cÚ¡ * 
tmpdœ
,

800 
X­Ÿn
::
docid
 
tÙ_off
,

801 
veùÜ
<
¡ršg
> 
tmp
, veùÜ<
X­Ÿn
::
docid
> 
off
)

803 
c
 = 0;

804 
	gtmp
.
size
() > 3) {

805 
	gveùÜ
<
	g¡ršg
> 
	gtmpout
;

806 
	gtmpout
.
»£rve
(
tmp
.
size
() / 2);

807 
	gveùÜ
<
	gX­Ÿn
::
docid
> 
Ãwoff
;

808 
	gÃwoff
.
»size
(
tmp
.
size
() / 2);

809 
	gi
 = 0, 
	gj
; i < 
	gtmp
.
size
(); i = 
j
) {

810 
j
 = 
i
 + 2;

811 ià(
	gj
 =ğ
tmp
.
size
(è- 1è++
j
;

813 
¡ršg
 
	gde¡
 = 
tmpdœ
;

814 
	gbuf
[64];

815 
¥rštf
(
buf
, "/tmp%u_%u.", 
c
, 
i
 / 2);

816 
	gde¡
 +ğ
buf
;

820 
B¿ssTabË
 
tm±ab
("po¡li¡", 
de¡
, 
çl£
);

822 
	gtm±ab
.
ü—‹_ªd_İ’
(65536);

824 
m”ge_po¡li¡s
(&
tm±ab
, 
off
.
begš
(è+ 
i
, 
tmp
.begš(è+ i,mp.begš(è+ 
j
, 0);

825 ià(
	gc
 > 0) {

826 
	gk
 = 
i
; k < 
	gj
; ++k) {

827 
uÆšk
((
tmp
[
k
] + "DB").
c_¡r
());

828 
uÆšk
((
tmp
[
k
] + "ba£A").
c_¡r
());

829 
uÆšk
((
tmp
[
k
] + "ba£B").
c_¡r
());

832 
	gtmpout
.
push_back
(
de¡
);

833 
	gtm±ab
.
æush_db
();

834 
	gtm±ab
.
comm™
(1);

836 
sw­
(
tmp
, 
tmpout
);

837 
sw­
(
off
, 
Ãwoff
);

838 ++
	gc
;

840 
m”ge_po¡li¡s
(
out
, 
off
.
begš
(), 
tmp
.begš(),mp.
’d
(), 
tÙ_off
);

841 ià(
	gc
 > 0) {

842 
size_t
 
	gk
 = 0; k < 
	gtmp
.
size
(); ++k) {

843 
uÆšk
((
tmp
[
k
] + "DB").
c_¡r
());

844 
uÆšk
((
tmp
[
k
] + "ba£A").
c_¡r
());

845 
uÆšk
((
tmp
[
k
] + "ba£B").
c_¡r
());

851 
m”ge_docid_keyed
(cÚ¡ * 
bËÇme
,

852 
B¿ssTabË
 *
out
, cÚ¡ 
veùÜ
<
¡ršg
> & 
šputs
,

853 cÚ¡ 
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
boŞ
 
Ïzy
)

855 
size_t
 
	gi
 = 0; i < 
	gšputs
.
size
(); ++i) {

856 
	gX­Ÿn
::
docid
 
off
 = 
off£t
[
i
];

858 
B¿ssTabË
 
š
(
bËÇme
, 
šputs
[
i
], 
Œue
, 
DONT_COMPRESS
, 
Ïzy
);

859 
	gš
.
İ’
();

860 ià(
	gš
.
em±y
()) ;

862 
B¿ssCursÜ
 
cur
(&
š
);

863 
	gcur
.
fšd_’Œy
(
¡ršg
());

865 
¡ršg
 
	gkey
;

866 
	gcur
.
Ãxt
()) {

868 ià(
	goff
) {

869 
	gX­Ÿn
::
docid
 
did
;

870 cÚ¡ * 
	gd
 = 
cur
.
cu¼’t_key
.
d©a
();

871 cÚ¡ * 
	ge
 = 
d
 + 
cur
.
cu¼’t_key
.
size
();

872 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
did
)) {

873 
¡ršg
 
	gmsg
 = "Bad key in ";

874 
	gmsg
 +ğ
šputs
[
i
];

875 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
(
msg
);

877 
	gdid
 +ğ
off
;

878 
	gkey
.
»size
(0);

879 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

880 ià(
	gd
 !ğ
e
) {

882 
key
.
­³nd
(
d
, 
e
 - d);

885 
	gkey
 = 
cur
.
cu¼’t_key
;

887 
boŞ
 
	gcom´es£d
 = 
cur
.
»ad_g
(
Œue
);

888 
	gout
->
add
(
key
, 
cur
.
cu¼’t_g
, 
com´es£d
);

895 
usšg
 
Çme¥aû
 
	gB¿ssCom·ù
;

898 
com·ù_b¿ss
(cÚ¡ * 
de¡dœ
, cÚ¡ 
veùÜ
<
¡ršg
> & 
sourûs
,

899 cÚ¡ 
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
size_t
 
block_size
,

900 
com·ùiÚ_Ëv–
 
com·ùiÚ
, 
boŞ
 
muÉass
,

901 
X­Ÿn
::
docid
 
tÙ_off
) {

902 
	ebË_ty³
 {

903 
POSTLIST
, 
	gRECORD
, 
	gTERMLIST
, 
	gPOSITION
, 
	gVALUE
, 
	gSPELLING
, 
	gSYNONYM


905 
	sbË_li¡
 {

907 cÚ¡ * 
	gÇme
;

909 
bË_ty³
 
	gty³
;

911 
	gcom´ess_¡¿‹gy
;

913 
boŞ
 
	gÏzy
;

916 cÚ¡ 
bË_li¡
 
	gbËs
[] = {

918 { "po¡li¡", 
POSTLIST
, 
DONT_COMPRESS
, 
çl£
 },

919 { "»cÜd", 
RECORD
, 
Z_DEFAULT_STRATEGY
, 
çl£
 },

920 { "‹rmli¡", 
TERMLIST
, 
Z_DEFAULT_STRATEGY
, 
çl£
 },

921 { "pos™iÚ", 
POSITION
, 
DONT_COMPRESS
, 
Œue
 },

922 { "¥–lšg", 
SPELLING
, 
Z_DEFAULT_STRATEGY
, 
Œue
 },

923 { "synÚym", 
SYNONYM
, 
Z_DEFAULT_STRATEGY
, 
Œue
 }

925 cÚ¡ 
bË_li¡
 * 
	gbËs_’d
 = 
bËs
 +

926 ((
bËs
) / (tables[0]));

928 cÚ¡ 
bË_li¡
 * 
	gt
 = 
bËs
; < 
	gbËs_’d
; ++t) {

934 
	gcout
 << 
	gt
->
	gÇme
 << " ..." << 
	gæush
;

936 
¡ršg
 
	gde¡
 = 
de¡dœ
;

937 
	gde¡
 += '/';

938 
	gde¡
 +ğ
t
->
Çme
;

939 
	gde¡
 += '.';

941 
boŞ
 
	gouut_wl_exi¡
 = !
t
->
Ïzy
;

945 
boŞ
 
	gbad_¡©
 = 
çl£
;

947 
off_t
 
	gš_size
 = 0;

949 
	gveùÜ
<
	g¡ršg
> 
	gšputs
;

950 
	gšputs
.
»£rve
(
sourûs
.
size
());

951 
size_t
 
	gšputs_´e£Á
 = 0;

952 
	gveùÜ
<
	g¡ršg
>::
cÚ¡_™”©Ü
 
¤c
 = 
sourûs
.
begš
();

953 
	g¤c
 !ğ
sourûs
.
’d
(); ++src) {

954 
¡ršg
 
s
(*
¤c
);

955 
	gs
 +ğ
t
->
Çme
;

956 
	gs
 += '.';

958 
¡©
 
	gsb
;

959 ià(
¡©
(
s
 + "DB", &
sb
) == 0) {

960 
š_size
 +ğ
sb
.
¡_size
 / 1024;

961 
	gouut_wl_exi¡
 = 
Œue
;

962 ++
	gšputs_´e£Á
;

963 } ià(
	g”ºo
 !ğ
ENOENT
) {

965 
bad_¡©
 = 
Œue
;

966 
	gouut_wl_exi¡
 = 
Œue
;

967 ++
	gšputs_´e£Á
;

969 
	gšputs
.
push_back
(
s
);

972 ià(
	gšputs_´e£Á
 !ğ
sourûs
.
size
()) {

973 ià(
šputs_´e£Á
 != 0) {

974 
cout
 << '\r' << 
t
->
Çme
 << ": " << 
šputs_´e£Á


975 << " oà" << 
sourûs
.
size
() << " inputs…resent "

976 "sØsuµ»ssšg ouut" << 
’dl
;

979 
	gouut_wl_exi¡
 = 
çl£
;

982 ià(!
	gouut_wl_exi¡
) {

983 
	gcout
 << '\r' << 
	gt
->
	gÇme
 << ": dÛ¢'ˆexi¡" << 
	g’dl
;

987 
B¿ssTabË
 
out
(
t
->
Çme
, 
de¡
, 
çl£
,->
com´ess_¡¿‹gy
,->
Ïzy
);

988 ià(!
	gt
->
	gÏzy
) {

989 
	gout
.
ü—‹_ªd_İ’
(
block_size
);

991 
	gout
.
”a£
();

992 
	gout
.
£t_block_size
(
block_size
);

995 
	gout
.
£t_fuÎ_com·ùiÚ
(
com·ùiÚ
 !ğ
STANDARD
);

996 ià(
	gcom·ùiÚ
 =ğ
FULLER
è
out
.
£t_max_™em_size
(1);

998 
	gt
->
	gty³
) {

999 
	gPOSTLIST
:

1000 ià(
muÉass
 && 
šputs
.
size
() > 3) {

1001 
muÉim”ge_po¡li¡s
(&
out
, 
de¡dœ
, 
tÙ_off
,

1002 
šputs
, 
off£t
);

1004 
m”ge_po¡li¡s
(&
out
, 
off£t
.
begš
(),

1005 
šputs
.
begš
(), iÅuts.
’d
(),

1006 
tÙ_off
);

1009 
	gSPELLING
:

1010 
m”ge_¥–lšgs
(&
out
, 
šputs
.
begš
(), iÅuts.
’d
());

1012 
	gSYNONYM
:

1013 
m”ge_synÚyms
(&
out
, 
šputs
.
begš
(), iÅuts.
’d
());

1017 
m”ge_docid_keyed
(
t
->
Çme
, &
out
, 
šputs
, 
off£t
,->
Ïzy
);

1022 
	gout
.
æush_db
();

1023 
	gout
.
comm™
(1);

1025 
	gcout
 << '\r' << 
	gt
->
	gÇme
 << ": ";

1026 
off_t
 
	gout_size
 = 0;

1027 ià(!
	gbad_¡©
) {

1028 
¡©
 
	gsb
;

1029 ià(
¡©
(
de¡
 + "DB", &
sb
) == 0) {

1030 
out_size
 = 
sb
.
¡_size
 / 1024;

1032 
	gbad_¡©
 = (
”ºo
 !ğ
ENOENT
);

1035 ià(
	gbad_¡©
) {

1036 
	gcout
 << "Done (couldn't stat‡llhe DB files)";

1038 ià(
	gout_size
 =ğ
š_size
) {

1039 
cout
 << "Size unchanged (";

1040 } ià(
	gout_size
 < 
	gš_size
) {

1041 
	gcout
 << "Reduced by "

1042 << 100 * (
	gš_size
 - 
	gout_size
) / in_size << "% "

1043 << 
	gš_size
 - 
	gout_size
 << "K (" << in_size << "K -> ";

1045 
	gcout
 << "INCREASED by "

1046 << 100 * (
	gout_size
 - 
	gš_size
) / in_size << "% "

1047 << 
	gout_size
 - 
	gš_size
 << "K (" << in_size << "K -> ";

1049 
	gcout
 << 
	gout_size
 << "K)";

1051 
	gcout
 << 
	g’dl
;

	@bin/xapian-compact-chert.cc

22 
	~<cÚfig.h
>

24 
	~"x­Ÿn-com·ù.h
"

26 
	~<®gÜ™hm
>

27 
	~<io¡»am
>

28 
	~<queue
>

30 
	~<c¡dio
>

32 
	~"§ã”ºo.h
"

33 
	~<sys/ty³s.h
>

34 
	~"§ãsys¡©.h
"

36 
	~"ch”t_bË.h
"

37 
	~"ch”t_cursÜ.h
"

38 
	~"š‹º®ty³s.h
"

39 
	~"·ck.h
"

40 
	~"uts.h
"

41 
	~"v®ue¡©s.h
"

43 
	~<x­Ÿn.h
>

45 
usšg
 
Çme¥aû
 
	g¡d
;

49 
Çme¥aû
 
	gCh”tCom·ù
 {

51 
šlše
 
boŞ


52 
is_m‘ašfo_key
(cÚ¡ 
¡ršg
 & 
key
)

54  
	gkey
.
size
(è=ğ1 && 
key
[0] == '\0';

57 
šlše
 
boŞ


58 
is_u£r_m‘ad©a_key
(cÚ¡ 
¡ršg
 & 
key
)

60  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xc0';

63 
šlše
 
boŞ


64 
is_v®ue¡©s_key
(cÚ¡ 
¡ršg
 & 
key
)

66  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xd0';

69 
šlše
 
boŞ


70 
is_v®uechunk_key
(cÚ¡ 
¡ršg
 & 
key
)

72  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xd8';

75 
šlše
 
boŞ


76 
is_doş’chunk_key
(cÚ¡ 
¡ršg
 & 
key
)

78  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xe0';

81 şas 
	cPo¡li¡CursÜ
 : 
´iv©e
 
Ch”tCursÜ
 {

82 
X­Ÿn
::
docid
 
off£t
;

84 
	gpublic
:

85 
¡ršg
 
key
, 
	gg
;

86 
	gX­Ÿn
::
docid
 
fœ¡did
;

87 
	gX­Ÿn
::
‹rmcouÁ
 
tf
, 
	gcf
;

89 
Po¡li¡CursÜ
(
Ch”tTabË
 *
š
, 
X­Ÿn
::
docid
 
off£t_
)

90 : 
Ch”tCursÜ
(
š
), 
off£t
(
off£t_
), 
fœ¡did
(0)

92 
fšd_’Œy
(
¡ršg
());

93 
Ãxt
();

96 ~
Po¡li¡CursÜ
()

98 
d–‘e
 
	gCh”tCursÜ
::
g‘_bË
();

101 
boŞ
 
Ãxt
() {

102 ià(!
	gCh”tCursÜ
::
Ãxt
()è 
çl£
;

105 
»ad_g
();

106 
	gkey
 = 
cu¼’t_key
;

107 
	gg
 = 
cu¼’t_g
;

108 
	gtf
 = 
cf
 = 0;

109 ià(
is_m‘ašfo_key
(
key
)è 
	gŒue
;

110 ià(
is_u£r_m‘ad©a_key
(
key
)è 
	gŒue
;

111 ià(
is_v®ue¡©s_key
(
key
)è 
	gŒue
;

112 ià(
is_v®uechunk_key
(
key
)) {

113 cÚ¡ * 
	gp
 = 
key
.
d©a
();

114 cÚ¡ * 
	g’d
 = 
p
 + 
key
.
Ëngth
();

115 
	gp
 += 2;

116 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

117 ià(!
uÅack_ušt
(&
p
, 
’d
, &
¦Ù
))

118 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("bad value key");

119 
	gX­Ÿn
::
docid
 
did
;

120 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
p
, 
’d
, &
did
))

121 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("bad value key");

122 
	gdid
 +ğ
off£t
;

124 
	gkey
.
assign
("\0\xd8", 2);

125 
·ck_ušt
(
key
, 
¦Ù
);

126 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

127  
	gŒue
;

133 cÚ¡ * 
	gd
 = 
key
.
d©a
();

134 cÚ¡ * 
	ge
 = 
d
 + 
key
.
size
();

135 ià(
is_doş’chunk_key
(
key
)) {

136 
	gd
 += 2;

138 
¡ršg
 
	gŠame
;

139 ià(!
uÅack_¡ršg_´e£rvšg_sÜt
(&
d
, 
e
, 
Šame
))

140 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist key");

143 ià(
	gd
 =ğ
e
) {

145 
d
 = 
g
.
d©a
();

146 
	ge
 = 
d
 + 
g
.
size
();

147 ià(!
uÅack_ušt
(&
d
, 
e
, &
tf
) ||

148 !
uÅack_ušt
(&
d
, 
e
, &
cf
) ||

149 !
uÅack_ušt
(&
d
, 
e
, &
fœ¡did
)) {

150 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist key");

152 ++
	gfœ¡did
;

153 
	gg
.
”a£
(0, 
d
 - 
g
.
d©a
());

156 
size_t
 
	gtmp
 = 
d
 - 
key
.
d©a
();

157 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
fœ¡did
è|| 
	gd
 !=ƒ)

158 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist key");

159 ià(
is_doş’chunk_key
(
key
)) {

160 
	gkey
.
”a£
(
tmp
);

162 
	gkey
.
”a£
(
tmp
 - 1);

165 
	gfœ¡did
 +ğ
off£t
;

166  
	gŒue
;

170 şas 
	cPo¡li¡CursÜGt
 {

171 
	gpublic
:

174 
boŞ
 
İ”©Ü
()(cÚ¡ 
Po¡li¡CursÜ
 *
a
, cÚ¡ Po¡li¡CursÜ *
	gb
) {

175 ià(
	ga
->
	gkey
 > 
	gb
->keyè 
	gŒue
;

176 ià(
	ga
->
	gkey
 !ğ
b
->
key
è 
çl£
;

177  (
	ga
->
	gfœ¡did
 > 
	gb
->firstdid);

181 
¡ršg


182 
’code_v®ue¡©s
(
X­Ÿn
::
doccouÁ
 
äeq
,

183 cÚ¡ 
¡ršg
 & 
lbound
, cÚ¡ sŒšg & 
ubound
)

185 
¡ršg
 
	gv®ue
;

186 
·ck_ušt
(
v®ue
, 
äeq
);

187 
·ck_¡ršg
(
v®ue
, 
lbound
);

191 ià(
	glbound
 !ğ
ubound
è
v®ue
 += ubound;

192  
	gv®ue
;

196 
m”ge_po¡li¡s
(
Ch”tTabË
 * 
out
, 
veùÜ
<
X­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
off£t
,

197 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
, veùÜ<¡ršg>::cÚ¡_™”©Ü 
e
,

198 
X­Ÿn
::
docid
 
tÙ_off
)

200 
tÙËn_t
 
tÙ_tÙËn
 = 0;

201 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_lbound
 = 
¡©ic_ÿ¡
<
X­Ÿn
::termcount>(-1);

202 
	gX­Ÿn
::
‹rmcouÁ
 
wdf_ubound
 = 0;

203 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_ubound
 = 0;

204 
	g´iÜ™y_queue
<
	gPo¡li¡CursÜ
 *, 
	gveùÜ
<Po¡li¡CursÜ *>, 
	gPo¡li¡CursÜGt
> 
	gpq
;

205  ; 
	gb
 !ğ
e
; ++b, ++
	goff£t
) {

206 
Ch”tTabË
 *
	gš
 = 
Ãw
 Ch”tTabË("po¡li¡", *
b
, 
Œue
);

207 
	gš
->
İ’
();

208 ià(
	gš
->
em±y
()) {

210 
d–‘e
 
	gš
;

216 
Po¡li¡CursÜ
 * 
	gcur
 = 
Ãw
 Po¡li¡CursÜ(
š
, *
off£t
);

221 ià(
is_m‘ašfo_key
(
cur
->
key
)) {

222 cÚ¡ * 
	gd©a
 = 
cur
->
g
.
d©a
();

223 cÚ¡ * 
	g’d
 = 
d©a
 + 
cur
->
g
.
size
();

224 
	gX­Ÿn
::
docid
 
dummy_did
 = 0;

225 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
dummy_did
)) {

226 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

229 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_lbound_tmp
;

230 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
doş’_lbound_tmp
)) {

231 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

233 
	gdoş’_lbound
 = 
mš
(
doş’_lbound
, 
doş’_lbound_tmp
);

235 
	gX­Ÿn
::
‹rmcouÁ
 
wdf_ubound_tmp
;

236 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
wdf_ubound_tmp
)) {

237 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

239 
	gwdf_ubound
 = 
max
(
wdf_ubound
, 
wdf_ubound_tmp
);

241 
	gX­Ÿn
::
‹rmcouÁ
 
doş’_ubound_tmp
;

242 ià(!
uÅack_ušt
(&
d©a
, 
’d
, &
doş’_ubound_tmp
)) {

243 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

245 
	gdoş’_ubound_tmp
 +ğ
wdf_ubound_tmp
;

246 
	gdoş’_ubound
 = 
max
(
doş’_ubound
, 
doş’_ubound_tmp
);

248 
tÙËn_t
 
	gtÙËn
 = 0;

249 ià(!
uÅack_ušt_Ï¡
(&
d©a
, 
’d
, &
tÙËn
)) {

250 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

252 
	gtÙ_tÙËn
 +ğ
tÙËn
;

253 ià(
	gtÙ_tÙËn
 < 
	gtÙËn
) {

254 
	gthrow
 "totlen wrapped!";

257 ià(
	gcur
->
Ãxt
()) {

258 
	gpq
.
push
(
cur
);

260 
d–‘e
 
	gcur
;

265 
¡ršg
 
	gg
;

266 
·ck_ušt
(
g
, 
tÙ_off
);

267 
·ck_ušt
(
g
, 
doş’_lbound
);

268 
·ck_ušt
(
g
, 
wdf_ubound
);

269 
·ck_ušt
(
g
, 
doş’_ubound
 - 
wdf_ubound
);

270 
·ck_ušt_Ï¡
(
g
, 
tÙ_tÙËn
);

271 
	gout
->
add
(
¡ršg
(1, '\0'), 
g
);

274 
¡ršg
 
	gÏ¡_key
;

277 
¡ršg
 
	gÏ¡_g
;

278 !
	gpq
.
em±y
()) {

279 
Po¡li¡CursÜ
 * 
	gcur
 = 
pq
.
tİ
();

280 cÚ¡ 
	g¡ršg
& 
	gkey
 = 
cur
->
key
;

281 ià(!
is_u£r_m‘ad©a_key
(
key
)) ;

283 cÚ¡ 
	g¡ršg
 & 
	gg
 = 
cur
->
g
;

284 ià(
	gkey
 =ğ
Ï¡_key
) {

285 ià(
g
 !ğ
Ï¡_g
)

286 
û¼
 << "W¬nšg: du¶iÿ‹ u£¸m‘ad©¨key w™h difã»Áag v®u-…ickšg‡rb™¿ryag v®ue" << 
’dl
;

288 
	gout
->
add
(
key
, 
g
);

289 
	gÏ¡_key
 = 
key
;

290 
	gÏ¡_g
 = 
g
;

293 
	gpq
.
pİ
();

294 ià(
	gcur
->
Ãxt
()) {

295 
	gpq
.
push
(
cur
);

297 
d–‘e
 
	gcur
;

304 
	gX­Ÿn
::
doccouÁ
 
äeq
 = 0;

305 
¡ršg
 
	glbound
, 
	gubound
;

307 
¡ršg
 
	gÏ¡_g
;

308 !
	gpq
.
em±y
()) {

309 
Po¡li¡CursÜ
 * 
	gcur
 = 
pq
.
tİ
();

310 cÚ¡ 
	g¡ršg
& 
	gkey
 = 
cur
->
key
;

311 ià(!
is_v®ue¡©s_key
(
key
)) ;

312 ià(
	gkey
 !ğ
Ï¡_key
) {

316 ià(
äeq
) {

317 
out
->
add
(
Ï¡_key
, 
’code_v®ue¡©s
(
äeq
, 
lbound
, 
ubound
));

318 
	gäeq
 = 0;

320 
	gÏ¡_key
 = 
key
;

323 cÚ¡ 
	g¡ršg
 & 
	gg
 = 
cur
->
g
;

325 cÚ¡ * 
	gpos
 = 
g
.
d©a
();

326 cÚ¡ * 
	g’d
 = 
pos
 + 
g
.
size
();

328 
	gX­Ÿn
::
doccouÁ
 
f
;

329 
¡ršg
 
	gl
, 
	gu
;

330 ià(!
uÅack_ušt
(&
pos
, 
’d
, &
f
)) {

331 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete stats item in valueable");

332 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Frequency statistic in valueable isoo†arge");

334 ià(!
uÅack_¡ršg
(&
pos
, 
’d
, 
l
)) {

335 ià(*
	gpos
 =ğ0è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Incomplete stats item in valueable");

336 
throw
 
	gX­Ÿn
::
RªgeE¼Ü
("Lower bound in valueable isoo†arge");

338 
size_t
 
	gËn
 = 
’d
 - 
pos
;

339 ià(
	gËn
 == 0) {

340 
u
 = 
l
;

342 
	gu
.
assign
(
pos
, 
Ën
);

344 ià(
	gäeq
 == 0) {

345 
äeq
 = 
f
;

346 
	glbound
 = 
l
;

347 
	gubound
 = 
u
;

349 
	gäeq
 +ğ
f
;

350 ià(
	gl
 < 
	glbound
èlbound = 
l
;

351 ià(
	gu
 > 
	gubound
èubound = 
u
;

354 
	gpq
.
pİ
();

355 ià(
	gcur
->
Ãxt
()) {

356 
	gpq
.
push
(
cur
);

358 
d–‘e
 
	gcur
;

362 ià(
	gäeq
) {

363 
	gout
->
add
(
Ï¡_key
, 
’code_v®ue¡©s
(
äeq
, 
lbound
, 
ubound
));

368 !
	gpq
.
em±y
()) {

369 
Po¡li¡CursÜ
 * 
	gcur
 = 
pq
.
tİ
();

370 cÚ¡ 
	g¡ršg
 & 
	gkey
 = 
cur
->
key
;

371 ià(!
is_v®uechunk_key
(
key
)) ;

372 
As£¹
(!
is_u£r_m‘ad©a_key
(
key
));

373 
	gout
->
add
(
key
, 
cur
->
g
);

374 
	gpq
.
pİ
();

375 ià(
	gcur
->
Ãxt
()) {

376 
	gpq
.
push
(
cur
);

378 
d–‘e
 
	gcur
;

382 
	gX­Ÿn
::
‹rmcouÁ
 
tf
 = 0, 
	gcf
 = 0;

383 
	gveùÜ
<
	g·œ
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> > 
	ggs
;

384 
	gŒue
) {

385 
Po¡li¡CursÜ
 * 
	gcur
 = 
NULL
;

386 ià(!
	gpq
.
em±y
()) {

387 
	gcur
 = 
pq
.
tİ
();

388 
	gpq
.
pİ
();

390 
As£¹
(
cur
 =ğ
NULL
 || !
is_u£r_m‘ad©a_key
(cur->
key
));

391 ià(
	gcur
 =ğ
NULL
 || 
cur
->
key
 !ğ
Ï¡_key
) {

392 ià(!
gs
.
em±y
()) {

393 
¡ršg
 
fœ¡_g
;

394 
·ck_ušt
(
fœ¡_g
, 
tf
);

395 
·ck_ušt
(
fœ¡_g
, 
cf
);

396 
·ck_ušt
(
fœ¡_g
, 
gs
[0].
fœ¡
 - 1);

397 
¡ršg
 
	gg
 = 
gs
[0].
£cÚd
;

398 
	gg
[0] = (
gs
.
size
() == 1) ? '1' : '0';

399 
	gfœ¡_g
 +ğ
g
;

400 
	gout
->
add
(
Ï¡_key
, 
fœ¡_g
);

402 
¡ršg
 
	g‹rm
;

403 ià(!
is_doş’chunk_key
(
Ï¡_key
)) {

404 cÚ¡ * 
	gp
 = 
Ï¡_key
.
d©a
();

405 cÚ¡ * 
	g’d
 = 
p
 + 
Ï¡_key
.
size
();

406 ià(!
uÅack_¡ršg_´e£rvšg_sÜt
(&
p
, 
’d
, 
‹rm
è|| 
	gp
 !=ƒnd)

407 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist chunk key");

410 
	gveùÜ
<
	g·œ
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

411 
	gi
 = 
gs
.
begš
();

412 ++
	gi
 !ğ
gs
.
’d
()) {

413 
g
 = 
i
->
£cÚd
;

414 
	gg
[0] = (
i
 + 1 =ğ
gs
.
’d
()) ? '1' : '0';

415 
	gout
->
add
(
·ck_ch”t_po¡li¡_key
(
‹rm
, 
i
->
fœ¡
), 
g
);

418 
	ggs
.
ş—r
();

419 ià(
	gcur
 =ğ
NULL
) ;

420 
	gtf
 = 
cf
 = 0;

421 
	gÏ¡_key
 = 
cur
->
key
;

423 
	gtf
 +ğ
cur
->
tf
;

424 
	gcf
 +ğ
cur
->
cf
;

425 
	ggs
.
push_back
(
make_·œ
(
cur
->
fœ¡did
, cur->
g
));

426 ià(
	gcur
->
Ãxt
()) {

427 
	gpq
.
push
(
cur
);

429 
d–‘e
 
	gcur
;

434 
	gM”geCursÜ
 : 
public
 
Ch”tCursÜ
 {

435 
M”geCursÜ
(
Ch”tTabË
 *
š
è: 
Ch”tCursÜ
(in) {

436 
fšd_’Œy
(
¡ršg
());

437 
Ãxt
();

440 ~
M”geCursÜ
() {

441 
d–‘e
 
	gCh”tCursÜ
::
g‘_bË
();

445 
	sCursÜGt
 {

447 
boŞ
 
İ”©Ü
()(cÚ¡ 
Ch”tCursÜ
 *
	ga
, cÚ¡ Ch”tCursÜ *
	gb
) {

448 ià(
	gb
->
aá”_’d
()è 
	gçl£
;

449 ià(
	ga
->
aá”_’d
()è 
	gŒue
;

450  (
	ga
->
	gcu¼’t_key
 > 
	gb
->current_key);

454 
	#MAGIC_XOR_VALUE
 96

	)

457 şas 
	cP»fixCom´es£dSŒšgItÜ
 {

458 cÚ¡ * 
	gp
;

459 
size_t
 
	gËá
;

460 
¡ršg
 
	gcu¼’t
;

462 
P»fixCom´es£dSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
,

463 cÚ¡ 
¡ršg
 &
cu¼’t_
)

464 : 
p
(
p_
), 
Ëá
(
Ëá_
), 
cu¼’t
(
cu¼’t_
) { }

466 
	gpublic
:

467 
P»fixCom´es£dSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

468 : 
p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
d©a
())),

469 
Ëá
(
s
.
size
()) {

470 ià(
	gËá
) {

471 
	gİ”©Ü
++();

473 
	gp
 = 
NULL
;

477 cÚ¡ 
	g¡ršg
 & 
	gİ”©Ü
*() const {

478  
	gcu¼’t
;

481 
P»fixCom´es£dSŒšgItÜ
 
	gİ”©Ü
++() {

482 cÚ¡ * 
	gŞd_p
 = 
p
;

483 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

484 
¡ršg
 
	gŞd_cu¼’t
 = 
cu¼’t
;

485 
	gİ”©Ü
++();

486  
P»fixCom´es£dSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
, 
Şd_cu¼’t
);

489 
	gP»fixCom´es£dSŒšgItÜ
 & 
	gİ”©Ü
++() {

490 ià(
	gËá
 == 0) {

491 
p
 = 
NULL
;

493 ià(!
	gcu¼’t
.
em±y
()) {

494 
	gcu¼’t
.
»size
(*
p
++ ^ 
MAGIC_XOR_VALUE
);

495 --
	gËá
;

497 
size_t
 
	gadd
;

498 ià(
	gËá
 =ğ0 || (
add
 = *
p
 ^ 
MAGIC_XOR_VALUE
è>ğ
Ëá
)

499 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling data (too†ittle†eft)");

500 
	gcu¼’t
.
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
add
);

501 
	gp
 +ğ
add
 + 1;

502 
	gËá
 -ğ
add
 + 1;

504  *
	gthis
;

507 
boŞ
 
©_’d
() const {

508  
	gp
 =ğ
NULL
;

513 şas 
	cP»fixCom´es£dSŒšgWr™”
 {

514 
¡ršg
 
	gcu¼’t
;

515 
	g¡ršg
 & 
	gout
;

517 
	gpublic
:

518 
P»fixCom´es£dSŒšgWr™”
(
¡ršg
 & 
out_
è: 
out
(out_) { }

520 
­³nd
(cÚ¡ 
¡ršg
 & 
wÜd
) {

523 ià(!
cu¼’t
.
em±y
()) {

524 
size_t
 
Ën
 = 
mš
(
cu¼’t
.
size
(), 
wÜd
.size());

525 
size_t
 
	gi
;

526 
	gi
 = 0; i < 
	gËn
; ++i) {

527 ià(
	gcu¼’t
[
i
] !ğ
wÜd
[i]) ;

529 
	gout
 +ğ(
i
 ^ 
MAGIC_XOR_VALUE
);

530 
	gout
 +ğ((
wÜd
.
size
(è- 
i
è^ 
MAGIC_XOR_VALUE
);

531 
	gout
.
­³nd
(
wÜd
.
d©a
(è+ 
i
, wÜd.
size
() - i);

533 
	gout
 +ğ(
wÜd
.
size
(è^ 
MAGIC_XOR_VALUE
);

534 
	gout
 +ğ
wÜd
;

536 
	gcu¼’t
 = 
wÜd
;

540 
	sP»fixCom´es£dSŒšgItÜGt
 {

542 
boŞ
 
İ”©Ü
()(cÚ¡ 
P»fixCom´es£dSŒšgItÜ
 *
	ga
,

543 cÚ¡ 
P»fixCom´es£dSŒšgItÜ
 *
	gb
) {

544  (**
	ga
 > **
	gb
);

549 
m”ge_¥–lšgs
(
Ch”tTabË
 * 
out
,

550 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

551 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
e
)

553 
´iÜ™y_queue
<
M”geCursÜ
 *, 
	gveùÜ
<
	gM”geCursÜ
 *>, 
	gCursÜGt
> 
	gpq
;

554  ; 
	gb
 !ğ
e
; ++b) {

555 
Ch”tTabË
 *
	gš
 = 
Ãw
 Ch”tTabË("¥–lšg", *
b
, 
Œue
, 
DONT_COMPRESS
,rue);

556 
	gš
->
İ’
();

557 ià(!
	gš
->
em±y
()) {

560 
	gpq
.
push
(
Ãw
 
M”geCursÜ
(
š
));

562 
d–‘e
 
	gš
;

566 !
	gpq
.
em±y
()) {

567 
M”geCursÜ
 * 
	gcur
 = 
pq
.
tİ
();

568 
	gpq
.
pİ
();

570 
¡ršg
 
	gkey
 = 
cur
->
cu¼’t_key
;

571 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 > 
	gkey
) {

574 
boŞ
 
	gcom´es£d
 = 
cur
->
»ad_g
(
Œue
);

575 
	gout
->
add
(
key
, 
cur
->
cu¼’t_g
, 
com´es£d
);

576 ià(
	gcur
->
Ãxt
()) {

577 
	gpq
.
push
(
cur
);

579 
d–‘e
 
	gcur
;

585 
¡ršg
 
	gg
;

586 ià(
	gkey
[0] != 'W') {

589 
´iÜ™y_queue
<
P»fixCom´es£dSŒšgItÜ
 *,

590 
veùÜ
<
P»fixCom´es£dSŒšgItÜ
 *>,

591 
P»fixCom´es£dSŒšgItÜGt
> 
pqg
;

595 
	gveùÜ
<
	gM”geCursÜ
 *> 
	gvec
;

596 
	gvec
.
»£rve
(
pq
.
size
());

598 
	gŒue
) {

599 
	gcur
->
»ad_g
();

600 
	gpqg
.
push
(
Ãw
 
P»fixCom´es£dSŒšgItÜ
(
cur
->
cu¼’t_g
));

601 
	gvec
.
push_back
(
cur
);

602 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

603 
	gcur
 = 
pq
.
tİ
();

604 
	gpq
.
pİ
();

607 
P»fixCom´es£dSŒšgWr™”
 
wr
(
g
);

608 
¡ršg
 
	gÏ¡wÜd
;

609 !
	gpqg
.
em±y
()) {

610 
P»fixCom´es£dSŒšgItÜ
 * 
	g™
 = 
pqg
.
tİ
();

611 
¡ršg
 
	gwÜd
 = **
™
;

612 ià(
	gwÜd
 !ğ
Ï¡wÜd
) {

613 
Ï¡wÜd
 = 
wÜd
;

614 
	gwr
.
­³nd
(
Ï¡wÜd
);

616 ++*
	g™
;

617 
	gpqg
.
pİ
();

618 ià(!
	g™
->
©_’d
()) {

619 
	gpqg
.
push
(
™
);

621 
d–‘e
 
	g™
;

625 
	gveùÜ
<
	gM”geCursÜ
 *>::
cÚ¡_™”©Ü
 
i
;

626 
	gi
 = 
vec
.
begš
(); i !ğvec.
’d
(); ++i) {

627 
	gcur
 = *
i
;

628 ià(
	gcur
->
Ãxt
()) {

629 
	gpq
.
push
(
cur
);

631 
d–‘e
 
	gcur
;

636 
	gX­Ÿn
::
‹rmcouÁ
 
tÙ_äeq
 = 0;

637 
	gŒue
) {

638 
	gcur
->
»ad_g
();

639 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

640 cÚ¡ * 
	gp
 = 
cur
->
cu¼’t_g
.
d©a
();

641 cÚ¡ * 
	g’d
 = 
p
 + 
cur
->
cu¼’t_g
.
size
();

642 ià(!
uÅack_ušt_Ï¡
(&
p
, 
’d
, &
äeq
è|| 
	gäeq
 == 0) {

643 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

645 
	gtÙ_äeq
 +ğ
äeq
;

646 ià(
	gcur
->
Ãxt
()) {

647 
	gpq
.
push
(
cur
);

649 
d–‘e
 
	gcur
;

651 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

652 
	gcur
 = 
pq
.
tİ
();

653 
	gpq
.
pİ
();

655 
	gg
.
»size
(0);

656 
·ck_ušt_Ï¡
(
g
, 
tÙ_äeq
);

658 
	gout
->
add
(
key
, 
g
);

662 şas 
	cBy‹L’gthP»fixedSŒšgItÜ
 {

663 cÚ¡ * 
	gp
;

664 
size_t
 
	gËá
;

666 
By‹L’gthP»fixedSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
)

667 : 
p
(
p_
), 
Ëá
(
Ëá_
) { }

669 
	gpublic
:

670 
By‹L’gthP»fixedSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

671 : 
p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
d©a
())),

672 
Ëá
(
s
.
size
()) { }

674 
¡ršg
 
	gİ”©Ü
*() const {

675 
size_t
 
	gËn
 = *
p
 ^ 
MAGIC_XOR_VALUE
;

676  
¡ršg
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
Ën
);

679 
By‹L’gthP»fixedSŒšgItÜ
 
	gİ”©Ü
++() {

680 cÚ¡ * 
	gŞd_p
 = 
p
;

681 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

682 
	gİ”©Ü
++();

683  
By‹L’gthP»fixedSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
);

686 
	gBy‹L’gthP»fixedSŒšgItÜ
 & 
	gİ”©Ü
++() {

687 ià(!
	gËá
) {

688 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad synonym data (none†eft)");

690 
size_t
 
	gadd
 = (*
p
 ^ 
MAGIC_XOR_VALUE
) + 1;

691 ià(
	gËá
 < 
	gadd
) {

692 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad synonym data (too†ittle†eft)");

694 
	gp
 +ğ
add
;

695 
	gËá
 -ğ
add
;

696  *
	gthis
;

699 
boŞ
 
©_’d
() const {

700  
	gËá
 == 0;

704 
	sBy‹L’gthP»fixedSŒšgItÜGt
 {

706 
boŞ
 
İ”©Ü
()(cÚ¡ 
By‹L’gthP»fixedSŒšgItÜ
 *
	ga
,

707 cÚ¡ 
By‹L’gthP»fixedSŒšgItÜ
 *
	gb
) {

708  (**
	ga
 > **
	gb
);

713 
m”ge_synÚyms
(
Ch”tTabË
 * 
out
,

714 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

715 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
e
)

717 
´iÜ™y_queue
<
M”geCursÜ
 *, 
	gveùÜ
<
	gM”geCursÜ
 *>, 
	gCursÜGt
> 
	gpq
;

718  ; 
	gb
 !ğ
e
; ++b) {

719 
Ch”tTabË
 *
	gš
 = 
Ãw
 Ch”tTabË("synÚym", *
b
, 
Œue
, 
DONT_COMPRESS
,rue);

720 
	gš
->
İ’
();

721 ià(!
	gš
->
em±y
()) {

724 
	gpq
.
push
(
Ãw
 
M”geCursÜ
(
š
));

726 
d–‘e
 
	gš
;

730 !
	gpq
.
em±y
()) {

731 
M”geCursÜ
 * 
	gcur
 = 
pq
.
tİ
();

732 
	gpq
.
pİ
();

734 
¡ršg
 
	gkey
 = 
cur
->
cu¼’t_key
;

735 ià(
	gpq
.
tİ
()->
	gcu¼’t_key
 > 
	gkey
) {

738 
boŞ
 
	gcom´es£d
 = 
cur
->
»ad_g
(
Œue
);

739 
	gout
->
add
(
key
, 
cur
->
cu¼’t_g
, 
com´es£d
);

740 ià(
	gcur
->
Ãxt
()) {

741 
	gpq
.
push
(
cur
);

743 
d–‘e
 
	gcur
;

749 
¡ršg
 
	gg
;

753 
	g´iÜ™y_queue
<
	gBy‹L’gthP»fixedSŒšgItÜ
 *,

754 
	gveùÜ
<
	gBy‹L’gthP»fixedSŒšgItÜ
 *>,

755 
	gBy‹L’gthP»fixedSŒšgItÜGt
> 
	gpqg
;

756 
	gveùÜ
<
	gM”geCursÜ
 *> 
	gvec
;

758 
	gŒue
) {

759 
	gcur
->
»ad_g
();

760 
	gpqg
.
push
(
Ãw
 
By‹L’gthP»fixedSŒšgItÜ
(
cur
->
cu¼’t_g
));

761 
	gvec
.
push_back
(
cur
);

762 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

763 
	gcur
 = 
pq
.
tİ
();

764 
	gpq
.
pİ
();

767 
¡ršg
 
	gÏ¡wÜd
;

768 !
	gpqg
.
em±y
()) {

769 
By‹L’gthP»fixedSŒšgItÜ
 * 
	g™
 = 
pqg
.
tİ
();

770 ià(**
	g™
 !ğ
Ï¡wÜd
) {

771 
Ï¡wÜd
 = **
™
;

772 
	gg
 +ğ
by‹
(
Ï¡wÜd
.
size
(è^ 
MAGIC_XOR_VALUE
);

773 
	gg
 +ğ
Ï¡wÜd
;

775 ++*
	g™
;

776 
	gpqg
.
pİ
();

777 ià(!
	g™
->
©_’d
()) {

778 
	gpqg
.
push
(
™
);

780 
d–‘e
 
	g™
;

784 
	gveùÜ
<
	gM”geCursÜ
 *>::
cÚ¡_™”©Ü
 
i
;

785 
	gi
 = 
vec
.
begš
(); i !ğvec.
’d
(); ++i) {

786 
	gcur
 = *
i
;

787 ià(
	gcur
->
Ãxt
()) {

788 
	gpq
.
push
(
cur
);

790 
d–‘e
 
	gcur
;

794 
	gout
->
add
(
key
, 
g
);

799 
muÉim”ge_po¡li¡s
(
Ch”tTabË
 * 
out
, cÚ¡ * 
tmpdœ
,

800 
X­Ÿn
::
docid
 
tÙ_off
,

801 
veùÜ
<
¡ršg
> 
tmp
, veùÜ<
X­Ÿn
::
docid
> 
off
)

803 
c
 = 0;

804 
	gtmp
.
size
() > 3) {

805 
	gveùÜ
<
	g¡ršg
> 
	gtmpout
;

806 
	gtmpout
.
»£rve
(
tmp
.
size
() / 2);

807 
	gveùÜ
<
	gX­Ÿn
::
docid
> 
Ãwoff
;

808 
	gÃwoff
.
»size
(
tmp
.
size
() / 2);

809 
	gi
 = 0, 
	gj
; i < 
	gtmp
.
size
(); i = 
j
) {

810 
j
 = 
i
 + 2;

811 ià(
	gj
 =ğ
tmp
.
size
(è- 1è++
j
;

813 
¡ršg
 
	gde¡
 = 
tmpdœ
;

814 
	gbuf
[64];

815 
¥rštf
(
buf
, "/tmp%u_%u.", 
c
, 
i
 / 2);

816 
	gde¡
 +ğ
buf
;

820 
Ch”tTabË
 
tm±ab
("po¡li¡", 
de¡
, 
çl£
);

822 
	gtm±ab
.
ü—‹_ªd_İ’
(65536);

824 
m”ge_po¡li¡s
(&
tm±ab
, 
off
.
begš
(è+ 
i
, 
tmp
.begš(è+ i,mp.begš(è+ 
j
, 0);

825 ià(
	gc
 > 0) {

826 
	gk
 = 
i
; k < 
	gj
; ++k) {

827 
uÆšk
((
tmp
[
k
] + "DB").
c_¡r
());

828 
uÆšk
((
tmp
[
k
] + "ba£A").
c_¡r
());

829 
uÆšk
((
tmp
[
k
] + "ba£B").
c_¡r
());

832 
	gtmpout
.
push_back
(
de¡
);

833 
	gtm±ab
.
æush_db
();

834 
	gtm±ab
.
comm™
(1);

836 
sw­
(
tmp
, 
tmpout
);

837 
sw­
(
off
, 
Ãwoff
);

838 ++
	gc
;

840 
m”ge_po¡li¡s
(
out
, 
off
.
begš
(), 
tmp
.begš(),mp.
’d
(), 
tÙ_off
);

841 ià(
	gc
 > 0) {

842 
size_t
 
	gk
 = 0; k < 
	gtmp
.
size
(); ++k) {

843 
uÆšk
((
tmp
[
k
] + "DB").
c_¡r
());

844 
uÆšk
((
tmp
[
k
] + "ba£A").
c_¡r
());

845 
uÆšk
((
tmp
[
k
] + "ba£B").
c_¡r
());

851 
m”ge_docid_keyed
(cÚ¡ * 
bËÇme
,

852 
Ch”tTabË
 *
out
, cÚ¡ 
veùÜ
<
¡ršg
> & 
šputs
,

853 cÚ¡ 
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
boŞ
 
Ïzy
)

855 
size_t
 
	gi
 = 0; i < 
	gšputs
.
size
(); ++i) {

856 
	gX­Ÿn
::
docid
 
off
 = 
off£t
[
i
];

858 
Ch”tTabË
 
š
(
bËÇme
, 
šputs
[
i
], 
Œue
, 
DONT_COMPRESS
, 
Ïzy
);

859 
	gš
.
İ’
();

860 ià(
	gš
.
em±y
()) ;

862 
Ch”tCursÜ
 
cur
(&
š
);

863 
	gcur
.
fšd_’Œy
(
¡ršg
());

865 
¡ršg
 
	gkey
;

866 
	gcur
.
Ãxt
()) {

868 ià(
	goff
) {

869 
	gX­Ÿn
::
docid
 
did
;

870 cÚ¡ * 
	gd
 = 
cur
.
cu¼’t_key
.
d©a
();

871 cÚ¡ * 
	ge
 = 
d
 + 
cur
.
cu¼’t_key
.
size
();

872 ià(!
uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
did
)) {

873 
¡ršg
 
	gmsg
 = "Bad key in ";

874 
	gmsg
 +ğ
šputs
[
i
];

875 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
(
msg
);

877 
	gdid
 +ğ
off
;

878 
	gkey
.
»size
(0);

879 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

880 ià(
	gd
 !ğ
e
) {

882 
key
.
­³nd
(
d
, 
e
 - d);

885 
	gkey
 = 
cur
.
cu¼’t_key
;

887 
boŞ
 
	gcom´es£d
 = 
cur
.
»ad_g
(
Œue
);

888 
	gout
->
add
(
key
, 
cur
.
cu¼’t_g
, 
com´es£d
);

895 
usšg
 
Çme¥aû
 
	gCh”tCom·ù
;

898 
com·ù_ch”t
(cÚ¡ * 
de¡dœ
, cÚ¡ 
veùÜ
<
¡ršg
> & 
sourûs
,

899 cÚ¡ 
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
size_t
 
block_size
,

900 
com·ùiÚ_Ëv–
 
com·ùiÚ
, 
boŞ
 
muÉass
,

901 
X­Ÿn
::
docid
 
tÙ_off
) {

902 
	ebË_ty³
 {

903 
POSTLIST
, 
	gRECORD
, 
	gTERMLIST
, 
	gPOSITION
, 
	gVALUE
, 
	gSPELLING
, 
	gSYNONYM


905 
	sbË_li¡
 {

907 cÚ¡ * 
	gÇme
;

909 
bË_ty³
 
	gty³
;

911 
	gcom´ess_¡¿‹gy
;

913 
boŞ
 
	gÏzy
;

916 cÚ¡ 
bË_li¡
 
	gbËs
[] = {

918 { "po¡li¡", 
POSTLIST
, 
DONT_COMPRESS
, 
çl£
 },

919 { "»cÜd", 
RECORD
, 
Z_DEFAULT_STRATEGY
, 
çl£
 },

920 { "‹rmli¡", 
TERMLIST
, 
Z_DEFAULT_STRATEGY
, 
çl£
 },

921 { "pos™iÚ", 
POSITION
, 
DONT_COMPRESS
, 
Œue
 },

922 { "¥–lšg", 
SPELLING
, 
Z_DEFAULT_STRATEGY
, 
Œue
 },

923 { "synÚym", 
SYNONYM
, 
Z_DEFAULT_STRATEGY
, 
Œue
 }

925 cÚ¡ 
bË_li¡
 * 
	gbËs_’d
 = 
bËs
 +

926 ((
bËs
) / (tables[0]));

928 cÚ¡ 
bË_li¡
 * 
	gt
 = 
bËs
; < 
	gbËs_’d
; ++t) {

934 
	gcout
 << 
	gt
->
	gÇme
 << " ..." << 
	gæush
;

936 
¡ršg
 
	gde¡
 = 
de¡dœ
;

937 
	gde¡
 += '/';

938 
	gde¡
 +ğ
t
->
Çme
;

939 
	gde¡
 += '.';

941 
boŞ
 
	gouut_wl_exi¡
 = !
t
->
Ïzy
;

945 
boŞ
 
	gbad_¡©
 = 
çl£
;

947 
off_t
 
	gš_size
 = 0;

949 
	gveùÜ
<
	g¡ršg
> 
	gšputs
;

950 
	gšputs
.
»£rve
(
sourûs
.
size
());

951 
size_t
 
	gšputs_´e£Á
 = 0;

952 
	gveùÜ
<
	g¡ršg
>::
cÚ¡_™”©Ü
 
¤c
 = 
sourûs
.
begš
();

953 
	g¤c
 !ğ
sourûs
.
’d
(); ++src) {

954 
¡ršg
 
s
(*
¤c
);

955 
	gs
 +ğ
t
->
Çme
;

956 
	gs
 += '.';

958 
¡©
 
	gsb
;

959 ià(
¡©
(
s
 + "DB", &
sb
) == 0) {

960 
š_size
 +ğ
sb
.
¡_size
 / 1024;

961 
	gouut_wl_exi¡
 = 
Œue
;

962 ++
	gšputs_´e£Á
;

963 } ià(
	g”ºo
 !ğ
ENOENT
) {

965 
bad_¡©
 = 
Œue
;

966 
	gouut_wl_exi¡
 = 
Œue
;

967 ++
	gšputs_´e£Á
;

969 
	gšputs
.
push_back
(
s
);

972 ià(
	gšputs_´e£Á
 !ğ
sourûs
.
size
()) {

973 ià(
šputs_´e£Á
 != 0) {

974 
cout
 << '\r' << 
t
->
Çme
 << ": " << 
šputs_´e£Á


975 << " oà" << 
sourûs
.
size
() << " inputs…resent "

976 "sØsuµ»ssšg ouut" << 
’dl
;

979 
	gouut_wl_exi¡
 = 
çl£
;

982 ià(!
	gouut_wl_exi¡
) {

983 
	gcout
 << '\r' << 
	gt
->
	gÇme
 << ": dÛ¢'ˆexi¡" << 
	g’dl
;

987 
Ch”tTabË
 
out
(
t
->
Çme
, 
de¡
, 
çl£
,->
com´ess_¡¿‹gy
,->
Ïzy
);

988 ià(!
	gt
->
	gÏzy
) {

989 
	gout
.
ü—‹_ªd_İ’
(
block_size
);

991 
	gout
.
”a£
();

992 
	gout
.
£t_block_size
(
block_size
);

995 
	gout
.
£t_fuÎ_com·ùiÚ
(
com·ùiÚ
 !ğ
STANDARD
);

996 ià(
	gcom·ùiÚ
 =ğ
FULLER
è
out
.
£t_max_™em_size
(1);

998 
	gt
->
	gty³
) {

999 
	gPOSTLIST
:

1000 ià(
muÉass
 && 
šputs
.
size
() > 3) {

1001 
muÉim”ge_po¡li¡s
(&
out
, 
de¡dœ
, 
tÙ_off
,

1002 
šputs
, 
off£t
);

1004 
m”ge_po¡li¡s
(&
out
, 
off£t
.
begš
(),

1005 
šputs
.
begš
(), iÅuts.
’d
(),

1006 
tÙ_off
);

1009 
	gSPELLING
:

1010 
m”ge_¥–lšgs
(&
out
, 
šputs
.
begš
(), iÅuts.
’d
());

1012 
	gSYNONYM
:

1013 
m”ge_synÚyms
(&
out
, 
šputs
.
begš
(), iÅuts.
’d
());

1017 
m”ge_docid_keyed
(
t
->
Çme
, &
out
, 
šputs
, 
off£t
,->
Ïzy
);

1022 
	gout
.
æush_db
();

1023 
	gout
.
comm™
(1);

1025 
	gcout
 << '\r' << 
	gt
->
	gÇme
 << ": ";

1026 
off_t
 
	gout_size
 = 0;

1027 ià(!
	gbad_¡©
) {

1028 
¡©
 
	gsb
;

1029 ià(
¡©
(
de¡
 + "DB", &
sb
) == 0) {

1030 
out_size
 = 
sb
.
¡_size
 / 1024;

1032 
	gbad_¡©
 = (
”ºo
 !ğ
ENOENT
);

1035 ià(
	gbad_¡©
) {

1036 
	gcout
 << "Done (couldn't stat‡llhe DB files)";

1038 ià(
	gout_size
 =ğ
š_size
) {

1039 
cout
 << "Size unchanged (";

1040 } ià(
	gout_size
 < 
	gš_size
) {

1041 
	gcout
 << "Reduced by "

1042 << 100 * (
	gš_size
 - 
	gout_size
) / in_size << "% "

1043 << 
	gš_size
 - 
	gout_size
 << "K (" << in_size << "K -> ";

1045 
	gcout
 << "INCREASED by "

1046 << 100 * (
	gout_size
 - 
	gš_size
) / in_size << "% "

1047 << 
	gout_size
 - 
	gš_size
 << "K (" << in_size << "K -> ";

1049 
	gcout
 << 
	gout_size
 << "K)";

1051 
	gcout
 << 
	g’dl
;

	@bin/xapian-compact-flint.cc

22 
	~<cÚfig.h
>

24 
	~"x­Ÿn-com·ù.h
"

26 
	~<®gÜ™hm
>

27 
	~<io¡»am
>

28 
	~<queue
>

30 
	~<c¡dio
>

32 
	~"§ã”ºo.h
"

33 
	~<sys/ty³s.h
>

34 
	~"§ãsys¡©.h
"

36 
	~"æšt_bË.h
"

37 
	~"æšt_cursÜ.h
"

38 
	~"æšt_uts.h
"

39 
	~"š‹º®ty³s.h
"

40 
	~"uts.h
"

42 
	~<x­Ÿn.h
>

44 
usšg
 
Çme¥aû
 
	g¡d
;

48 
Çme¥aû
 
	gFlštCom·ù
 {

50 
šlše
 
boŞ


51 
is_m‘ašfo_key
(cÚ¡ 
¡ršg
 & 
key
)

53  
	gkey
.
size
(è=ğ1 && 
key
[0] == '\0';

56 
šlše
 
boŞ


57 
is_u£r_m‘ad©a_key
(cÚ¡ 
¡ršg
 & 
key
)

59  
	gkey
.
size
(è> 1 && key[0] =ğ'\0' && 
key
[1] == '\xc0';

62 şas 
	cPo¡li¡CursÜ
 : 
´iv©e
 
FlštCursÜ
 {

63 
X­Ÿn
::
docid
 
off£t
;

65 
	gpublic
:

66 
¡ršg
 
key
, 
	gg
;

67 
	gX­Ÿn
::
docid
 
fœ¡did
;

68 
	gX­Ÿn
::
‹rmcouÁ
 
tf
, 
	gcf
;

70 
Po¡li¡CursÜ
(
FlštTabË
 *
š
, 
X­Ÿn
::
docid
 
off£t_
)

71 : 
FlštCursÜ
(
š
), 
off£t
(
off£t_
), 
fœ¡did
(0)

73 
fšd_’Œy
(
¡ršg
());

74 
Ãxt
();

77 ~
Po¡li¡CursÜ
()

79 
d–‘e
 
	gFlštCursÜ
::
g‘_bË
();

82 
boŞ
 
Ãxt
() {

83 ià(!
	gFlštCursÜ
::
Ãxt
()è 
çl£
;

86 
»ad_g
();

87 
	gkey
 = 
cu¼’t_key
;

88 
	gg
 = 
cu¼’t_g
;

89 
	gtf
 = 
cf
 = 0;

90 ià(
is_m‘ašfo_key
(
key
)è 
	gŒue
;

91 ià(
is_u£r_m‘ad©a_key
(
key
)è 
	gŒue
;

95 cÚ¡ * 
	gd
 = 
key
.
d©a
();

96 cÚ¡ * 
	ge
 = 
d
 + 
key
.
size
();

97 
¡ršg
 
	gŠame
;

98 ià(!
F_uÅack_¡ršg_´e£rvšg_sÜt
(&
d
, 
e
, 
Šame
))

99 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist key");

100 ià(
	gd
 =ğ
e
) {

102 
d
 = 
g
.
d©a
();

103 
	ge
 = 
d
 + 
g
.
size
();

104 ià(!
F_uÅack_ušt
(&
d
, 
e
, &
tf
) ||

105 !
F_uÅack_ušt
(&
d
, 
e
, &
cf
) ||

106 !
F_uÅack_ušt
(&
d
, 
e
, &
fœ¡did
)) {

107 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlistag");

109 ++
	gfœ¡did
;

110 
	gg
.
”a£
(0, 
d
 - 
g
.
d©a
());

113 
size_t
 
	gtmp
 = 
d
 - 
key
.
d©a
();

114 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
fœ¡did
è|| 
	gd
 !=ƒ)

115 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad…ostlist key");

116 
	gkey
.
”a£
(
tmp
);

118 
	gfœ¡did
 +ğ
off£t
;

119  
	gŒue
;

123 şas 
	cPo¡li¡CursÜGt
 {

124 
	gpublic
:

127 
boŞ
 
İ”©Ü
()(cÚ¡ 
Po¡li¡CursÜ
 *
a
, cÚ¡ Po¡li¡CursÜ *
	gb
) {

128 ià(
	ga
->
	gkey
 > 
	gb
->keyè 
	gŒue
;

129 ià(
	ga
->
	gkey
 !ğ
b
->
key
è 
çl£
;

130  (
	ga
->
	gfœ¡did
 > 
	gb
->firstdid);

135 
m”ge_po¡li¡s
(
FlštTabË
 * 
out
, 
veùÜ
<
X­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
off£t
,

136 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
, veùÜ<¡ršg>::cÚ¡_™”©Ü 
e
,

137 
X­Ÿn
::
docid
 
tÙ_off
)

139 
tÙËn_t
 
tÙ_tÙËn
 = 0;

140 
	g´iÜ™y_queue
<
	gPo¡li¡CursÜ
 *, 
	gveùÜ
<Po¡li¡CursÜ *>, 
	gPo¡li¡CursÜGt
> 
	gpq
;

141  ; 
	gb
 !ğ
e
; ++b, ++
	goff£t
) {

142 
FlštTabË
 *
	gš
 = 
Ãw
 FlštTabË("po¡li¡", *
b
, 
Œue
);

143 
	gš
->
İ’
();

144 ià(
	gš
->
em±y
()) {

146 
d–‘e
 
	gš
;

152 
Po¡li¡CursÜ
 * 
	gcur
 = 
Ãw
 Po¡li¡CursÜ(
š
, *
off£t
);

157 ià(
is_m‘ašfo_key
(
cur
->
key
)) {

158 cÚ¡ * 
	gd©a
 = 
cur
->
g
.
d©a
();

159 cÚ¡ * 
	g’d
 = 
d©a
 + 
cur
->
g
.
size
();

160 
	gX­Ÿn
::
docid
 
dummy_did
 = 0;

161 ià(!
F_uÅack_ušt
(&
d©a
, 
’d
, &
dummy_did
)) {

162 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

164 
tÙËn_t
 
	gtÙËn
 = 0;

165 ià(!
F_uÅack_ušt_Ï¡
(&
d©a
, 
’d
, &
tÙËn
)) {

166 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Tag containing meta information is corrupt.");

168 
	gtÙ_tÙËn
 +ğ
tÙËn
;

169 ià(
	gtÙ_tÙËn
 < 
	gtÙËn
) {

170 
	gthrow
 "totlen wrapped!";

173 ià(
	gcur
->
Ãxt
()) {

174 
	gpq
.
push
(
cur
);

176 
d–‘e
 
	gcur
;

181 
¡ršg
 
	gg
 = 
F_·ck_ušt
(
tÙ_off
);

182 
	gg
 +ğ
F_·ck_ušt_Ï¡
(
tÙ_tÙËn
);

183 
	gout
->
add
(
¡ršg
(1, '\0'), 
g
);

186 
¡ršg
 
	gÏ¡_key
;

189 
¡ršg
 
	gÏ¡_g
;

190 !
	gpq
.
em±y
()) {

191 
Po¡li¡CursÜ
 * 
	gcur
 = 
pq
.
tİ
();

192 cÚ¡ 
	g¡ršg
& 
	gkey
 = 
cur
->
key
;

193 ià(!
is_u£r_m‘ad©a_key
(
key
)) ;

195 cÚ¡ 
	g¡ršg
 & 
	gg
 = 
cur
->
g
;

196 ià(
	gkey
 =ğ
Ï¡_key
) {

197 ià(
g
 !ğ
Ï¡_g
)

198 
û¼
 << "W¬nšg: du¶iÿ‹ u£¸m‘ad©¨key w™h difã»Áag v®u-…ickšg‡rb™¿ryag v®ue" << 
’dl
;

200 
	gout
->
add
(
key
, 
g
);

201 
	gÏ¡_key
 = 
key
;

202 
	gÏ¡_g
 = 
g
;

205 
	gpq
.
pİ
();

206 ià(
	gcur
->
Ãxt
()) {

207 
	gpq
.
push
(
cur
);

209 
d–‘e
 
	gcur
;

214 
	gX­Ÿn
::
‹rmcouÁ
 
tf
 = 0, 
	gcf
 = 0;

215 
	gveùÜ
<
	g·œ
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> > 
	ggs
;

216 
	gŒue
) {

217 
Po¡li¡CursÜ
 * 
	gcur
 = 
NULL
;

218 ià(!
	gpq
.
em±y
()) {

219 
	gcur
 = 
pq
.
tİ
();

220 
	gpq
.
pİ
();

222 
As£¹
(
cur
 =ğ
NULL
 || !
is_u£r_m‘ad©a_key
(cur->
key
));

223 ià(
	gcur
 =ğ
NULL
 || 
cur
->
key
 !ğ
Ï¡_key
) {

224 ià(!
gs
.
em±y
()) {

225 
¡ršg
 
fœ¡_g
 = 
F_·ck_ušt
(
tf
);

226 
	gfœ¡_g
 +ğ
F_·ck_ušt
(
cf
);

227 
	gfœ¡_g
 +ğ
F_·ck_ušt
(
gs
[0].
fœ¡
 - 1);

228 
¡ršg
 
	gg
 = 
gs
[0].
£cÚd
;

229 
	gg
[0] = (
gs
.
size
() == 1) ? '1' : '0';

230 
	gfœ¡_g
 +ğ
g
;

231 
	gout
->
add
(
Ï¡_key
, 
fœ¡_g
);

232 
	gveùÜ
<
	g·œ
<
	gX­Ÿn
::
docid
, 
	g¡ršg
> >::
cÚ¡_™”©Ü
 
i
;

233 
	gi
 = 
gs
.
begš
();

234 ++
	gi
 !ğ
gs
.
’d
()) {

235 
¡ršg
 
Ãw_key
 = 
Ï¡_key
;

236 
	gÃw_key
 +ğ
F_·ck_ušt_´e£rvšg_sÜt
(
i
->
fœ¡
);

237 
	gg
 = 
i
->
£cÚd
;

238 
	gg
[0] = (
i
 + 1 =ğ
gs
.
’d
()) ? '1' : '0';

239 
	gout
->
add
(
Ãw_key
, 
g
);

242 
	ggs
.
ş—r
();

243 ià(
	gcur
 =ğ
NULL
) ;

244 
	gtf
 = 
cf
 = 0;

245 
	gÏ¡_key
 = 
cur
->
key
;

247 
	gtf
 +ğ
cur
->
tf
;

248 
	gcf
 +ğ
cur
->
cf
;

249 
	ggs
.
push_back
(
make_·œ
(
cur
->
fœ¡did
, cur->
g
));

250 ià(
	gcur
->
Ãxt
()) {

251 
	gpq
.
push
(
cur
);

253 
d–‘e
 
	gcur
;

258 
	gM”geCursÜ
 : 
public
 
FlštCursÜ
 {

259 
M”geCursÜ
(
FlštTabË
 *
š
è: 
FlštCursÜ
(in) {

260 
fšd_’Œy
(
¡ršg
());

261 
Ãxt
();

264 ~
M”geCursÜ
() {

265 
d–‘e
 
	gFlštCursÜ
::
g‘_bË
();

269 
	sCursÜGt
 {

271 
boŞ
 
İ”©Ü
()(cÚ¡ 
FlštCursÜ
 *
	ga
, cÚ¡ FlštCursÜ *
	gb
) {

272 ià(
	gb
->
aá”_’d
()è 
	gçl£
;

273 ià(
	ga
->
aá”_’d
()è 
	gŒue
;

274  (
	ga
->
	gcu¼’t_key
 > 
	gb
->current_key);

278 
	#MAGIC_XOR_VALUE
 96

	)

281 şas 
	cP»fixCom´es£dSŒšgItÜ
 {

282 cÚ¡ * 
	gp
;

283 
size_t
 
	gËá
;

284 
¡ršg
 
	gcu¼’t
;

286 
P»fixCom´es£dSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
,

287 cÚ¡ 
¡ršg
 &
cu¼’t_
)

288 : 
p
(
p_
), 
Ëá
(
Ëá_
), 
cu¼’t
(
cu¼’t_
) { }

290 
	gpublic
:

291 
P»fixCom´es£dSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

292 : 
p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
d©a
())),

293 
Ëá
(
s
.
size
()) {

294 ià(
	gËá
) {

295 
	gİ”©Ü
++();

297 
	gp
 = 
NULL
;

301 cÚ¡ 
	g¡ršg
 & 
	gİ”©Ü
*() const {

302  
	gcu¼’t
;

305 
P»fixCom´es£dSŒšgItÜ
 
	gİ”©Ü
++() {

306 cÚ¡ * 
	gŞd_p
 = 
p
;

307 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

308 
¡ršg
 
	gŞd_cu¼’t
 = 
cu¼’t
;

309 
	gİ”©Ü
++();

310  
P»fixCom´es£dSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
, 
Şd_cu¼’t
);

313 
	gP»fixCom´es£dSŒšgItÜ
 & 
	gİ”©Ü
++() {

314 ià(
	gËá
 == 0) {

315 
p
 = 
NULL
;

317 ià(!
	gcu¼’t
.
em±y
()) {

318 
	gcu¼’t
.
»size
(*
p
++ ^ 
MAGIC_XOR_VALUE
);

319 --
	gËá
;

321 
size_t
 
	gadd
;

322 ià(
	gËá
 =ğ0 || (
add
 = *
p
 ^ 
MAGIC_XOR_VALUE
è>ğ
Ëá
)

323 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling data (too†ittle†eft)");

324 
	gcu¼’t
.
­³nd
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
add
);

325 
	gp
 +ğ
add
 + 1;

326 
	gËá
 -ğ
add
 + 1;

328  *
	gthis
;

331 
boŞ
 
©_’d
() const {

332  
	gp
 =ğ
NULL
;

337 şas 
	cP»fixCom´es£dSŒšgWr™”
 {

338 
¡ršg
 
	gcu¼’t
;

339 
	g¡ršg
 & 
	gout
;

341 
	gpublic
:

342 
P»fixCom´es£dSŒšgWr™”
(
¡ršg
 & 
out_
è: 
out
(out_) { }

344 
­³nd
(cÚ¡ 
¡ršg
 & 
wÜd
) {

347 ià(!
cu¼’t
.
em±y
()) {

348 
size_t
 
Ën
 = 
mš
(
cu¼’t
.
size
(), 
wÜd
.size());

349 
size_t
 
	gi
;

350 
	gi
 = 0; i < 
	gËn
; ++i) {

351 ià(
	gcu¼’t
[
i
] !ğ
wÜd
[i]) ;

353 
	gout
 +ğ(
i
 ^ 
MAGIC_XOR_VALUE
);

354 
	gout
 +ğ((
wÜd
.
size
(è- 
i
è^ 
MAGIC_XOR_VALUE
);

355 
	gout
.
­³nd
(
wÜd
.
d©a
(è+ 
i
, wÜd.
size
() - i);

357 
	gout
 +ğ(
wÜd
.
size
(è^ 
MAGIC_XOR_VALUE
);

358 
	gout
 +ğ
wÜd
;

360 
	gcu¼’t
 = 
wÜd
;

364 
	sP»fixCom´es£dSŒšgItÜGt
 {

366 
boŞ
 
İ”©Ü
()(cÚ¡ 
P»fixCom´es£dSŒšgItÜ
 *
	ga
,

367 cÚ¡ 
P»fixCom´es£dSŒšgItÜ
 *
	gb
) {

368  (**
	ga
 > **
	gb
);

373 
m”ge_¥–lšgs
(
FlštTabË
 * 
out
,

374 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

375 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
e
)

377 
´iÜ™y_queue
<
M”geCursÜ
 *, 
	gveùÜ
<
	gM”geCursÜ
 *>, 
	gCursÜGt
> 
	gpq
;

378  ; 
	gb
 !ğ
e
; ++b) {

379 
FlštTabË
 *
	gš
 = 
Ãw
 FlštTabË("¥–lšg", *
b
, 
Œue
, 
DONT_COMPRESS
,rue);

380 
	gš
->
İ’
();

381 ià(!
	gš
->
em±y
()) {

384 
	gpq
.
push
(
Ãw
 
M”geCursÜ
(
š
));

386 
d–‘e
 
	gš
;

390 !
	gpq
.
em±y
()) {

391 
M”geCursÜ
 * 
	gcur
 = 
pq
.
tİ
();

392 
	gpq
.
pİ
();

394 
¡ršg
 
	gkey
 = 
cur
->
cu¼’t_key
;

395 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 > 
	gkey
) {

398 
boŞ
 
	gcom´es£d
 = 
cur
->
»ad_g
(
Œue
);

399 
	gout
->
add
(
key
, 
cur
->
cu¼’t_g
, 
com´es£d
);

400 ià(
	gcur
->
Ãxt
()) {

401 
	gpq
.
push
(
cur
);

403 
d–‘e
 
	gcur
;

409 
¡ršg
 
	gg
;

410 ià(
	gkey
[0] != 'W') {

413 
´iÜ™y_queue
<
P»fixCom´es£dSŒšgItÜ
 *,

414 
veùÜ
<
P»fixCom´es£dSŒšgItÜ
 *>,

415 
P»fixCom´es£dSŒšgItÜGt
> 
pqg
;

419 
	gveùÜ
<
	gM”geCursÜ
 *> 
	gvec
;

420 
	gvec
.
»£rve
(
pq
.
size
());

422 
	gŒue
) {

423 
	gcur
->
»ad_g
();

424 
	gpqg
.
push
(
Ãw
 
P»fixCom´es£dSŒšgItÜ
(
cur
->
cu¼’t_g
));

425 
	gvec
.
push_back
(
cur
);

426 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

427 
	gcur
 = 
pq
.
tİ
();

428 
	gpq
.
pİ
();

431 
P»fixCom´es£dSŒšgWr™”
 
wr
(
g
);

432 
¡ršg
 
	gÏ¡wÜd
;

433 !
	gpqg
.
em±y
()) {

434 
P»fixCom´es£dSŒšgItÜ
 * 
	g™
 = 
pqg
.
tİ
();

435 
¡ršg
 
	gwÜd
 = **
™
;

436 ià(
	gwÜd
 !ğ
Ï¡wÜd
) {

437 
Ï¡wÜd
 = 
wÜd
;

438 
	gwr
.
­³nd
(
Ï¡wÜd
);

440 ++*
	g™
;

441 
	gpqg
.
pİ
();

442 ià(!
	g™
->
©_’d
()) {

443 
	gpqg
.
push
(
™
);

445 
d–‘e
 
	g™
;

449 
	gveùÜ
<
	gM”geCursÜ
 *>::
cÚ¡_™”©Ü
 
i
;

450 
	gi
 = 
vec
.
begš
(); i !ğvec.
’d
(); ++i) {

451 
	gcur
 = *
i
;

452 ià(
	gcur
->
Ãxt
()) {

453 
	gpq
.
push
(
cur
);

455 
d–‘e
 
	gcur
;

460 
	gX­Ÿn
::
‹rmcouÁ
 
tÙ_äeq
 = 0;

461 
	gŒue
) {

462 
	gcur
->
»ad_g
();

463 
	gX­Ÿn
::
‹rmcouÁ
 
äeq
;

464 cÚ¡ * 
	gp
 = 
cur
->
cu¼’t_g
.
d©a
();

465 cÚ¡ * 
	g’d
 = 
p
 + 
cur
->
cu¼’t_g
.
size
();

466 ià(!
F_uÅack_ušt_Ï¡
(&
p
, 
’d
, &
äeq
è|| 
	gäeq
 == 0) {

467 
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad spelling word freq");

469 
	gtÙ_äeq
 +ğ
äeq
;

470 ià(
	gcur
->
Ãxt
()) {

471 
	gpq
.
push
(
cur
);

473 
d–‘e
 
	gcur
;

475 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

476 
	gcur
 = 
pq
.
tİ
();

477 
	gpq
.
pİ
();

479 
	gg
 = 
F_·ck_ušt_Ï¡
(
tÙ_äeq
);

481 
	gout
->
add
(
key
, 
g
);

485 şas 
	cBy‹L’gthP»fixedSŒšgItÜ
 {

486 cÚ¡ * 
	gp
;

487 
size_t
 
	gËá
;

489 
By‹L’gthP»fixedSŒšgItÜ
(cÚ¡ * 
p_
, 
size_t
 
Ëá_
)

490 : 
p
(
p_
), 
Ëá
(
Ëá_
) { }

492 
	gpublic
:

493 
By‹L’gthP»fixedSŒšgItÜ
(cÚ¡ 
¡d
::
¡ršg
 & 
s
)

494 : 
p
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
s
.
d©a
())),

495 
Ëá
(
s
.
size
()) { }

497 
¡ršg
 
	gİ”©Ü
*() const {

498 
size_t
 
	gËn
 = *
p
 ^ 
MAGIC_XOR_VALUE
;

499  
¡ršg
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 + 1), 
Ën
);

502 
By‹L’gthP»fixedSŒšgItÜ
 
	gİ”©Ü
++() {

503 cÚ¡ * 
	gŞd_p
 = 
p
;

504 
size_t
 
	gŞd_Ëá
 = 
Ëá
;

505 
	gİ”©Ü
++();

506  
By‹L’gthP»fixedSŒšgItÜ
(
Şd_p
, 
Şd_Ëá
);

509 
	gBy‹L’gthP»fixedSŒšgItÜ
 & 
	gİ”©Ü
++() {

510 ià(!
	gËá
) {

511 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad synonym data (none†eft)");

513 
size_t
 
	gadd
 = (*
p
 ^ 
MAGIC_XOR_VALUE
) + 1;

514 ià(
	gËá
 < 
	gadd
) {

515 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
("Bad synonym data (too†ittle†eft)");

517 
	gp
 +ğ
add
;

518 
	gËá
 -ğ
add
;

519  *
	gthis
;

522 
boŞ
 
©_’d
() const {

523  
	gËá
 == 0;

527 
	sBy‹L’gthP»fixedSŒšgItÜGt
 {

529 
boŞ
 
İ”©Ü
()(cÚ¡ 
By‹L’gthP»fixedSŒšgItÜ
 *
	ga
,

530 cÚ¡ 
By‹L’gthP»fixedSŒšgItÜ
 *
	gb
) {

531  (**
	ga
 > **
	gb
);

536 
m”ge_synÚyms
(
FlštTabË
 * 
out
,

537 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

538 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
e
)

540 
´iÜ™y_queue
<
M”geCursÜ
 *, 
	gveùÜ
<
	gM”geCursÜ
 *>, 
	gCursÜGt
> 
	gpq
;

541  ; 
	gb
 !ğ
e
; ++b) {

542 
FlštTabË
 *
	gš
 = 
Ãw
 FlštTabË("synÚym", *
b
, 
Œue
, 
DONT_COMPRESS
,rue);

543 
	gš
->
İ’
();

544 ià(!
	gš
->
em±y
()) {

547 
	gpq
.
push
(
Ãw
 
M”geCursÜ
(
š
));

549 
d–‘e
 
	gš
;

553 !
	gpq
.
em±y
()) {

554 
M”geCursÜ
 * 
	gcur
 = 
pq
.
tİ
();

555 
	gpq
.
pİ
();

557 
¡ršg
 
	gkey
 = 
cur
->
cu¼’t_key
;

558 ià(
	gpq
.
tİ
()->
	gcu¼’t_key
 > 
	gkey
) {

561 
boŞ
 
	gcom´es£d
 = 
cur
->
»ad_g
(
Œue
);

562 
	gout
->
add
(
key
, 
cur
->
cu¼’t_g
, 
com´es£d
);

563 ià(
	gcur
->
Ãxt
()) {

564 
	gpq
.
push
(
cur
);

566 
d–‘e
 
	gcur
;

572 
¡ršg
 
	gg
;

576 
	g´iÜ™y_queue
<
	gBy‹L’gthP»fixedSŒšgItÜ
 *,

577 
	gveùÜ
<
	gBy‹L’gthP»fixedSŒšgItÜ
 *>,

578 
	gBy‹L’gthP»fixedSŒšgItÜGt
> 
	gpqg
;

579 
	gveùÜ
<
	gM”geCursÜ
 *> 
	gvec
;

581 
	gŒue
) {

582 
	gcur
->
»ad_g
();

583 
	gpqg
.
push
(
Ãw
 
By‹L’gthP»fixedSŒšgItÜ
(
cur
->
cu¼’t_g
));

584 
	gvec
.
push_back
(
cur
);

585 ià(
	gpq
.
em±y
(è||…q.
tİ
()->
	gcu¼’t_key
 !ğ
key
) ;

586 
	gcur
 = 
pq
.
tİ
();

587 
	gpq
.
pİ
();

590 
¡ršg
 
	gÏ¡wÜd
;

591 !
	gpqg
.
em±y
()) {

592 
By‹L’gthP»fixedSŒšgItÜ
 * 
	g™
 = 
pqg
.
tİ
();

593 ià(**
	g™
 !ğ
Ï¡wÜd
) {

594 
Ï¡wÜd
 = **
™
;

595 
	gg
 +ğ
by‹
(
Ï¡wÜd
.
size
(è^ 
MAGIC_XOR_VALUE
);

596 
	gg
 +ğ
Ï¡wÜd
;

598 ++*
	g™
;

599 
	gpqg
.
pİ
();

600 ià(!
	g™
->
©_’d
()) {

601 
	gpqg
.
push
(
™
);

603 
d–‘e
 
	g™
;

607 
	gveùÜ
<
	gM”geCursÜ
 *>::
cÚ¡_™”©Ü
 
i
;

608 
	gi
 = 
vec
.
begš
(); i !ğvec.
’d
(); ++i) {

609 
	gcur
 = *
i
;

610 ià(
	gcur
->
Ãxt
()) {

611 
	gpq
.
push
(
cur
);

613 
d–‘e
 
	gcur
;

617 
	gout
->
add
(
key
, 
g
);

622 
muÉim”ge_po¡li¡s
(
FlštTabË
 * 
out
, cÚ¡ * 
tmpdœ
,

623 
X­Ÿn
::
docid
 
tÙ_off
,

624 
veùÜ
<
¡ršg
> 
tmp
, veùÜ<
X­Ÿn
::
docid
> 
off
)

626 
c
 = 0;

627 
	gtmp
.
size
() > 3) {

628 
	gveùÜ
<
	g¡ršg
> 
	gtmpout
;

629 
	gtmpout
.
»£rve
(
tmp
.
size
() / 2);

630 
	gveùÜ
<
	gX­Ÿn
::
docid
> 
Ãwoff
;

631 
	gÃwoff
.
»size
(
tmp
.
size
() / 2);

632 
	gi
 = 0, 
	gj
; i < 
	gtmp
.
size
(); i = 
j
) {

633 
j
 = 
i
 + 2;

634 ià(
	gj
 =ğ
tmp
.
size
(è- 1è++
j
;

636 
¡ršg
 
	gde¡
 = 
tmpdœ
;

637 
	gbuf
[64];

638 
¥rštf
(
buf
, "/tmp%u_%u.", 
c
, 
i
 / 2);

639 
	gde¡
 +ğ
buf
;

643 
FlštTabË
 
tm±ab
("po¡li¡", 
de¡
, 
çl£
);

645 
	gtm±ab
.
ü—‹_ªd_İ’
(65536);

647 
m”ge_po¡li¡s
(&
tm±ab
, 
off
.
begš
(è+ 
i
, 
tmp
.begš(è+ i,mp.begš(è+ 
j
, 0);

648 ià(
	gc
 > 0) {

649 
	gk
 = 
i
; k < 
	gj
; ++k) {

650 
uÆšk
((
tmp
[
k
] + "DB").
c_¡r
());

651 
uÆšk
((
tmp
[
k
] + "ba£A").
c_¡r
());

652 
uÆšk
((
tmp
[
k
] + "ba£B").
c_¡r
());

655 
	gtmpout
.
push_back
(
de¡
);

656 
	gtm±ab
.
æush_db
();

657 
	gtm±ab
.
comm™
(1);

659 
sw­
(
tmp
, 
tmpout
);

660 
sw­
(
off
, 
Ãwoff
);

661 ++
	gc
;

663 
m”ge_po¡li¡s
(
out
, 
off
.
begš
(), 
tmp
.begš(),mp.
’d
(), 
tÙ_off
);

664 ià(
	gc
 > 0) {

665 
size_t
 
	gk
 = 0; k < 
	gtmp
.
size
(); ++k) {

666 
uÆšk
((
tmp
[
k
] + "DB").
c_¡r
());

667 
uÆšk
((
tmp
[
k
] + "ba£A").
c_¡r
());

668 
uÆšk
((
tmp
[
k
] + "ba£B").
c_¡r
());

674 
m”ge_docid_keyed
(cÚ¡ * 
bËÇme
,

675 
FlštTabË
 *
out
, cÚ¡ 
veùÜ
<
¡ršg
> & 
šputs
,

676 cÚ¡ 
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
boŞ
 
Ïzy
)

678 
size_t
 
	gi
 = 0; i < 
	gšputs
.
size
(); ++i) {

679 
	gX­Ÿn
::
docid
 
off
 = 
off£t
[
i
];

681 
FlštTabË
 
š
(
bËÇme
, 
šputs
[
i
], 
Œue
, 
DONT_COMPRESS
, 
Ïzy
);

682 
	gš
.
İ’
();

683 ià(
	gš
.
em±y
()) ;

685 
FlštCursÜ
 
cur
(&
š
);

686 
	gcur
.
fšd_’Œy
(
¡ršg
());

688 
¡ršg
 
	gkey
;

689 
	gcur
.
Ãxt
()) {

691 ià(
	goff
) {

692 
	gX­Ÿn
::
docid
 
did
;

693 cÚ¡ * 
	gd
 = 
cur
.
cu¼’t_key
.
d©a
();

694 cÚ¡ * 
	ge
 = 
d
 + 
cur
.
cu¼’t_key
.
size
();

695 ià(!
F_uÅack_ušt_´e£rvšg_sÜt
(&
d
, 
e
, &
did
)) {

696 
¡ršg
 
	gmsg
 = "Bad key in ";

697 
	gmsg
 +ğ
šputs
[
i
];

698 
throw
 
	gX­Ÿn
::
D©aba£CÜru±E¼Ü
(
msg
);

700 
	gdid
 +ğ
off
;

701 
	gkey
 = 
F_·ck_ušt_´e£rvšg_sÜt
(
did
);

702 ià(
	gd
 !ğ
e
) {

704 
key
.
­³nd
(
d
, 
e
 - d);

707 
	gkey
 = 
cur
.
cu¼’t_key
;

709 
boŞ
 
	gcom´es£d
 = 
cur
.
»ad_g
(
Œue
);

710 
	gout
->
add
(
key
, 
cur
.
cu¼’t_g
, 
com´es£d
);

717 
usšg
 
Çme¥aû
 
	gFlštCom·ù
;

720 
com·ù_æšt
(cÚ¡ * 
de¡dœ
, cÚ¡ 
veùÜ
<
¡ršg
> & 
sourûs
,

721 cÚ¡ 
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
size_t
 
block_size
,

722 
com·ùiÚ_Ëv–
 
com·ùiÚ
, 
boŞ
 
muÉass
,

723 
X­Ÿn
::
docid
 
tÙ_off
) {

724 
	ebË_ty³
 {

725 
POSTLIST
, 
	gRECORD
, 
	gTERMLIST
, 
	gPOSITION
, 
	gVALUE
, 
	gSPELLING
, 
	gSYNONYM


727 
	sbË_li¡
 {

729 cÚ¡ * 
	gÇme
;

731 
bË_ty³
 
	gty³
;

733 
	gcom´ess_¡¿‹gy
;

735 
boŞ
 
	gÏzy
;

738 cÚ¡ 
bË_li¡
 
	gbËs
[] = {

740 { "po¡li¡", 
POSTLIST
, 
DONT_COMPRESS
, 
çl£
 },

741 { "»cÜd", 
RECORD
, 
Z_DEFAULT_STRATEGY
, 
çl£
 },

742 { "‹rmli¡", 
TERMLIST
, 
Z_DEFAULT_STRATEGY
, 
çl£
 },

743 { "pos™iÚ", 
POSITION
, 
DONT_COMPRESS
, 
Œue
 },

744 { "v®ue", 
VALUE
, 
DONT_COMPRESS
, 
Œue
 },

745 { "¥–lšg", 
SPELLING
, 
Z_DEFAULT_STRATEGY
, 
Œue
 },

746 { "synÚym", 
SYNONYM
, 
Z_DEFAULT_STRATEGY
, 
Œue
 }

748 cÚ¡ 
bË_li¡
 * 
	gbËs_’d
 = 
bËs
 +

749 ((
bËs
) / (tables[0]));

751 cÚ¡ 
bË_li¡
 * 
	gt
 = 
bËs
; < 
	gbËs_’d
; ++t) {

757 
	gcout
 << 
	gt
->
	gÇme
 << " ..." << 
	gæush
;

759 
¡ršg
 
	gde¡
 = 
de¡dœ
;

760 
	gde¡
 += '/';

761 
	gde¡
 +ğ
t
->
Çme
;

762 
	gde¡
 += '.';

764 
boŞ
 
	gouut_wl_exi¡
 = !
t
->
Ïzy
;

768 
boŞ
 
	gbad_¡©
 = 
çl£
;

770 
off_t
 
	gš_size
 = 0;

772 
	gveùÜ
<
	g¡ršg
> 
	gšputs
;

773 
	gšputs
.
»£rve
(
sourûs
.
size
());

774 
size_t
 
	gšputs_´e£Á
 = 0;

775 
	gveùÜ
<
	g¡ršg
>::
cÚ¡_™”©Ü
 
¤c
 = 
sourûs
.
begš
();

776 
	g¤c
 !ğ
sourûs
.
’d
(); ++src) {

777 
¡ršg
 
s
(*
¤c
);

778 
	gs
 +ğ
t
->
Çme
;

779 
	gs
 += '.';

781 
¡©
 
	gsb
;

782 ià(
¡©
(
s
 + "DB", &
sb
) == 0) {

783 
š_size
 +ğ
sb
.
¡_size
 / 1024;

784 
	gouut_wl_exi¡
 = 
Œue
;

785 ++
	gšputs_´e£Á
;

786 } ià(
	g”ºo
 !ğ
ENOENT
) {

788 
bad_¡©
 = 
Œue
;

789 
	gouut_wl_exi¡
 = 
Œue
;

790 ++
	gšputs_´e£Á
;

792 
	gšputs
.
push_back
(
s
);

795 ià(!
	gouut_wl_exi¡
) {

796 
	gcout
 << '\r' << 
	gt
->
	gÇme
 << ": dÛ¢'ˆexi¡" << 
	g’dl
;

800 
FlštTabË
 
out
(
t
->
Çme
, 
de¡
, 
çl£
,->
com´ess_¡¿‹gy
,->
Ïzy
);

801 ià(!
	gt
->
	gÏzy
) {

802 
	gout
.
ü—‹_ªd_İ’
(
block_size
);

804 
	gout
.
”a£
();

805 
	gout
.
£t_block_size
(
block_size
);

808 
	gout
.
£t_fuÎ_com·ùiÚ
(
com·ùiÚ
 !ğ
STANDARD
);

809 ià(
	gcom·ùiÚ
 =ğ
FULLER
è
out
.
£t_max_™em_size
(1);

811 
	gt
->
	gty³
) {

812 
	gPOSTLIST
:

813 ià(
muÉass
 && 
šputs
.
size
() > 3) {

814 
muÉim”ge_po¡li¡s
(&
out
, 
de¡dœ
, 
tÙ_off
,

815 
šputs
, 
off£t
);

817 
m”ge_po¡li¡s
(&
out
, 
off£t
.
begš
(),

818 
šputs
.
begš
(), iÅuts.
’d
(),

819 
tÙ_off
);

822 
	gSPELLING
:

823 
m”ge_¥–lšgs
(&
out
, 
šputs
.
begš
(), iÅuts.
’d
());

825 
	gSYNONYM
:

826 
m”ge_synÚyms
(&
out
, 
šputs
.
begš
(), iÅuts.
’d
());

830 
m”ge_docid_keyed
(
t
->
Çme
, &
out
, 
šputs
, 
off£t
,->
Ïzy
);

835 
	gout
.
æush_db
();

836 
	gout
.
comm™
(1);

838 
	gcout
 << '\r' << 
	gt
->
	gÇme
 << ": ";

839 
off_t
 
	gout_size
 = 0;

840 ià(!
	gbad_¡©
) {

841 
¡©
 
	gsb
;

842 ià(
¡©
(
de¡
 + "DB", &
sb
) == 0) {

843 
out_size
 = 
sb
.
¡_size
 / 1024;

845 
	gbad_¡©
 = (
”ºo
 !ğ
ENOENT
);

848 ià(
	gbad_¡©
) {

849 
	gcout
 << "Done (couldn't stat‡llhe DB files)";

851 ià(
	gout_size
 =ğ
š_size
) {

852 
cout
 << "Size unchanged (";

853 } ià(
	gout_size
 < 
	gš_size
) {

854 
	gcout
 << "Reduced by "

855 << 100 * (
	gš_size
 - 
	gout_size
) / in_size << "% "

856 << 
	gš_size
 - 
	gout_size
 << "K (" << in_size << "K -> ";

858 
	gcout
 << "INCREASED by "

859 << 100 * (
	gout_size
 - 
	gš_size
) / in_size << "% "

860 << 
	gout_size
 - 
	gš_size
 << "K (" << in_size << "K -> ";

862 
	gcout
 << 
	gout_size
 << "K)";

864 
	gcout
 << 
	g’dl
;

	@bin/xapian-compact.cc

22 
	~<cÚfig.h
>

24 
	~"x­Ÿn-com·ù.h
"

26 
	~"§ã”ºo.h
"

28 
	~<®gÜ™hm
>

29 
	~<io¡»am
>

31 
	~<c¡dio
>

32 
	~<c¡dlib
>

33 
	~<c¡ršg
>

34 
	~"§ãsys¡©.h
"

35 
	~<sys/ty³s.h
>

36 
	~"uts.h
"

38 
	~"§ãuni¡d.h
"

39 
	~"§ãfú.h
"

41 #ifdeà
__WIN32__


42 
	~"§ãwšdows.h
"

45 
	~"¡ršguts.h
"

47 
	~<x­Ÿn.h
>

49 
	~"gnu_g‘İt.h
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
	#PROG_NAME
 "x­Ÿn-com·ù"

	)

54 
	#PROG_DESC
 "Com·ù‡ d©aba£, o¸m”gªd com·ù sev”®"

	)

56 
	#OPT_HELP
 1

	)

57 
	#OPT_VERSION
 2

	)

58 
	#OPT_NO_RENUMBER
 3

	)

60 
	$show_u§ge
() {

61 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] SOURCE_DATABASE... DESTINATION_DATABASE\n\n"

77 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

78 
	}
}

81 
boŞ


82 
	$­³nd_f’ame_¬gum’t
(
¡ršg
 & 
cmd
, cÚ¡ sŒšg & 
¬g
) {

83 #ifdeà
__WIN32__


84 
cmd
.
	`»£rve
(cmd.
	`size
(è+ 
¬g
.size() + 3);

85 
cmd
 += " \"";

86 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
¬g
.
	`begš
(); i !ğ¬g.
	`’d
(); ++i) {

87 ià(*
i
 == '/') {

91 
cmd
 += '\\';

92 } ià(*
i
 < 32 || 
	`¡rchr
("<>\"|*?", *i)) {

94  
çl£
;

96 
cmd
 +ğ*
i
;

99 
cmd
 += '"';

102 
cmd
.
	`»£rve
(cmd.
	`size
(è+ 
¬g
.size() + 10);

106 ià(
¬g
[0] == '-')

107 
cmd
 += " ./";

109 
cmd
 += ' ';

111 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
¬g
.
	`begš
(); i !ğ¬g.
	`’d
(); ++i) {

113 ià(!
	`C_i§Êum
(*
i
è&& 
	`¡rchr
("/._-", *iè=ğ
NULL
) {

114 
cmd
 += '\\';

116 
cmd
 +ğ*
i
;

119  
Œue
;

120 
	}
}

122 #ifdeà
__WIN32__


123 
boŞ
 
	$ruÂšg_Ú_wš9x
() {

124 
wš9x
 = -1;

125 ià(
wš9x
 == -1) {

126 
OSVERSIONINFO
 
šfo
;

127 
	`mem£t
(&
šfo
, 0, (
OSVERSIONINFO
));

128 
šfo
.
dwOSV”siÚInfoSize
 = (
OSVERSIONINFO
);

129 ià(
	`G‘V”siÚEx
(&
šfo
)) {

130 
wš9x
 = (
šfo
.
dwPÏtfÜmId
 =ğ
VER_PLATFORM_WIN32_WINDOWS
);

133  
wš9x
;

134 
	}
}

138 
	$rm_rf
(cÚ¡ 
¡ršg
 &
f’ame
) {

140 
¡©
 
sb
;

141 ià(
f’ame
.
	`em±y
(è|| 
	`¡©
(f’ame, &
sb
è!ğ0 || !
	`S_ISDIR
(sb.
¡_mode
))

144 #ifdeà
__WIN32__


145 
¡ršg
 
cmd
;

146 ià(
	`ruÂšg_Ú_wš9x
()) {

148 
cmd
 = "deltree /y";

151 
cmd
 = "rd /s /q";

154 
¡ršg
 
	`cmd
("rm -rf");

156 ià(!
	`­³nd_f’ame_¬gum’t
(
cmd
, 
f’ame
)) ;

157 
	`sy¡em
(
cmd
);

158 
	}
}

160 şas 
	cCmpByFœ¡U£d
 {

161 cÚ¡ 
	mveùÜ
<
	m·œ
<
	mX­Ÿn
::
docid
, X­Ÿn::docid> > & 
u£d_¿nges
;

163 
	mpublic
:

164 
CmpByFœ¡U£d
(cÚ¡ 
veùÜ
<
·œ
<
X­Ÿn
::
docid
, X­Ÿn::docid> > & 
ur
)

165 : 
	$u£d_¿nges
(
ur
) { }

167 
boŞ
 
	$İ”©Ü
()(
size_t
 
a
, size_ˆ
b
) {

168  
u£d_¿nges
[
a
].
fœ¡
 < u£d_¿nges[
b
].first;

169 
	}
}

173 
	$maš
(
¬gc
, **
¬gv
)

175 cÚ¡ * 
İts
 = "b:nFm";

176 cÚ¡ 
İtiÚ
 
lÚg_İts
[] = {

177 {"fuÎ”", 
no_¬gum’t
, 0, 'F'},

178 {"no-fuÎ", 
no_¬gum’t
, 0, 'n'},

179 {"muÉass", 
no_¬gum’t
, 0, 'm'},

180 {"blocksize", 
»quœed_¬gum’t
, 0, 'b'},

181 {"no-»numb”", 
no_¬gum’t
, 0, 
OPT_NO_RENUMBER
},

182 {"h–p", 
no_¬gum’t
, 0, 
OPT_HELP
},

183 {"v”siÚ", 
no_¬gum’t
, 0, 
OPT_VERSION
},

184 {
NULL
, 0, 0, 0}

187 
com·ùiÚ_Ëv–
 
com·ùiÚ
 = 
FULL
;

188 
size_t
 
block_size
 = 8192;

189 
boŞ
 
muÉass
 = 
çl£
;

190 
boŞ
 
»numb”
 = 
Œue
;

192 
c
;

193 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, 
İts
, 
lÚg_İts
, 0)) != -1) {

194 
c
) {

196 *
p
;

197 
block_size
 = 
	`¡¹oul
(
İrg
, &
p
, 10);

198 ià(
block_size
 <ğ64 && (*
p
 == 'K' || *p == 'k')) {

199 ++
p
;

200 
block_size
 *= 1024;

202 ià(*
p
 || 
block_size
 < 2048 || block_size > 65536 ||

203 (
block_size
 & (block_size - 1)) != 0) {

204 
û¼
 << 
PROG_NAME
": Bad v®u'" << 
İrg


206 << 
’dl
;

207 
	`ex™
(1);

212 
com·ùiÚ
 = 
STANDARD
;

215 
com·ùiÚ
 = 
FULLER
;

218 
muÉass
 = 
Œue
;

220 
OPT_NO_RENUMBER
:

221 
»numb”
 = 
çl£
;

223 
OPT_HELP
:

224 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

225 
	`show_u§ge
();

226 
	`ex™
(0);

227 
OPT_VERSION
:

228 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

229 
	`ex™
(0);

231 
	`show_u§ge
();

232 
	`ex™
(1);

236 ià(
¬gc
 - 
İtšd
 < 2) {

237 
	`show_u§ge
();

238 
	`ex™
(1);

242 cÚ¡ *
de¡dœ
 = 
¬gv
[
¬gc
 - 1];

244 
Œy
 {

245 
veùÜ
<
¡ršg
> 
sourûs
;

246 
veùÜ
<
X­Ÿn
::
docid
> 
off£t
;

247 
veùÜ
<
·œ
<
X­Ÿn
::
docid
, X­Ÿn::docid> > 
u£d_¿nges
;

248 
sourûs
.
	`»£rve
(
¬gc
 - 1 - 
İtšd
);

249 
off£t
.
	`»£rve
(
¬gc
 - 1 - 
İtšd
);

250 ià(!
»numb”
)

251 
u£d_¿nges
.
	`»£rve
(
¬gc
 - 1 - 
İtšd
);

252 
X­Ÿn
::
docid
 
tÙ_off
 = 0;

253 ’um { 
UNKNOWN
, 
BRASS
, 
CHERT
, 
FLINT
 } 
back’d
 = UNKNOWN;

254 cÚ¡ * 
back’d_Çmes
[] = {

255 
NULL
,

260 cÚ¡ * 
back’d_v”siÚ_fes
[] = {

261 
NULL
,

266 
i
 = 
İtšd
; i < 
¬gc
 - 1; ++i) {

267 cÚ¡ *
¤cdœ
 = 
¬gv
[
i
];

269 ià(
	`¡rcmp
(
¤cdœ
, 
de¡dœ
) == 0) {

270 
cout
 << 
¬gv
[0]

272 << 
’dl
;

273 
	`ex™
(1);

276 
¡©
 
sb
;

277 ià(
	`¡©
(
	`¡ršg
(
¤cdœ
è+ "/Ÿmæšt", &
sb
) == 0) {

278 ià(
back’d
 =ğ
UNKNOWN
) {

279 
back’d
 = 
FLINT
;

280 } ià(
back’d
 !ğ
FLINT
) {

281 
cout
 << 
¬gv
[0] << ": All databases must behe sameype.\n";

282 
cout
 << 
¬gv
[0] << ": '" <<‡rgv[
İtšd
] << "' is "

283 << 
back’d_Çmes
[
back’d
] << ", but "

284 "'" << 
¤cdœ
 << "' i æšt." << 
’dl
;

285 
	`ex™
(1);

287 } ià(
	`¡©
(
	`¡ršg
(
¤cdœ
è+ "/Ÿmch”t", &
sb
) == 0) {

288 ià(
back’d
 =ğ
UNKNOWN
) {

289 
back’d
 = 
CHERT
;

290 } ià(
back’d
 !ğ
CHERT
) {

291 
cout
 << 
¬gv
[0] << ": All databases must behe sameype.\n";

292 
cout
 << 
¬gv
[0] << ": '" <<‡rgv[
İtšd
] << "' is "

293 << 
back’d_Çmes
[
back’d
] << ", but "

294 "'" << 
¤cdœ
 << "' i ch”t." << 
’dl
;

295 
	`ex™
(1);

297 } ià(
	`¡©
(
	`¡ršg
(
¤cdœ
è+ "/Ÿmb¿ss", &
sb
) == 0) {

298 ià(
back’d
 =ğ
UNKNOWN
) {

299 
back’d
 = 
BRASS
;

300 } ià(
back’d
 !ğ
BRASS
) {

301 
cout
 << 
¬gv
[0] << ": All databases must behe sameype.\n";

302 
cout
 << 
¬gv
[0] << ": '" <<‡rgv[
İtšd
] << "' is "

303 << 
back’d_Çmes
[
back’d
] << ", but "

304 "'" << 
¤cdœ
 << "' i b¿ss." << 
’dl
;

305 
	`ex™
(1);

308 
cout
 << 
¬gv
[0] << ": '" << 
¤cdœ


309 << "' i nÙ‡ flšt, ch”ˆÜ b¿s d©aba£ dœeùÜy" << 
’dl
;

310 
	`ex™
(1);

313 
X­Ÿn
::
D©aba£
 
	`db
(
¤cdœ
);

314 
X­Ÿn
::
docid
 
fœ¡
 = 0, 
Ï¡
 = 0;

318 
X­Ÿn
::
doccouÁ
 
num_docs
 = 
db
.
	`g‘_doccouÁ
();

319 ià(
num_docs
 != 0) {

320 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
™
 = 
db
.
	`po¡li¡_begš
(
	`¡ršg
());

323 ià(
™
 =ğ
db
.
	`po¡li¡_’d
(
	`¡ršg
())) {

324 
û¼
 << 
¬gv
[0] << ": d©aba£ '" << 
¤cdœ
 << "' has "

325 << 
num_docs
 << " documents, but iterating‡ll "

326 "docum’t fšd nÚe" << 
’dl
;

327 
	`ex™
(1);

329 
fœ¡
 = *
™
;

331 ià(
»numb”
 && 
fœ¡
) {

337 
tÙ_off
 -ğ(
fœ¡
 - 1);

343 
Ï¡
 = 
db
.
	`g‘_Ï¡docid
();

344 
X­Ÿn
::
docid
 
Ï¡_lbound
 = 
fœ¡
 + 
num_docs
 - 1;

345 
Ï¡_lbound
 < 
Ï¡
) {

346 
X­Ÿn
::
docid
 
mid
;

347 
mid
 = 
Ï¡_lbound
 + (
Ï¡
 -†ast_lbound + 1) / 2;

348 
™
.
	`sk_to
(
mid
);

349 ià(
™
 =ğ
db
.
	`po¡li¡_’d
(
	`¡ršg
())) {

350 
Ï¡
 = 
mid
 - 1;

351 
™
 = 
db
.
	`po¡li¡_begš
(
	`¡ršg
());

354 
Ï¡_lbound
 = *
™
;

357 
off£t
.
	`push_back
(
tÙ_off
);

358 ià(
»numb”
)

359 
tÙ_off
 +ğ
Ï¡
;

360 
u£d_¿nges
.
	`push_back
(
	`make_·œ
(
fœ¡
, 
Ï¡
));

362 
sourûs
.
	`push_back
(
	`¡ršg
(
¤cdœ
) + '/');

365 ià(!
»numb”
 && 
sourûs
.
	`size
() > 1) {

370 
veùÜ
<
size_t
> 
Üd”
;

371 
Üd”
.
	`»£rve
(
sourûs
.
	`size
());

372 
size_t
 
i
 = 0; i < 
sourûs
.
	`size
(); ++i)

373 
Üd”
.
	`push_back
(
i
);

375 
	`sÜt
(
Üd”
.
	`begš
(), ord”.
	`’d
(), 
	`CmpByFœ¡U£d
(
u£d_¿nges
));

379 
veùÜ
<
¡ršg
> 
	`sourûs_
(
sourûs
.
	`size
());

380 
veùÜ
<
·œ
<
X­Ÿn
::
docid
, X­Ÿn::docid> > 
u£d_¿nges_
;

381 
u£d_¿nges_
.
	`»£rve
(
sourûs
.
	`size
());

383 
X­Ÿn
::
docid
 
Ï¡_¡¬t
 = 0, 
Ï¡_’d
 = 0;

384 
size_t
 
j
 = 0; j !ğ
Üd”
.
	`size
(); ++j) {

385 
size_t
 
n
 = 
Üd”
[
j
];

387 
	`sw­
(
sourûs_
[
j
], 
sourûs
[
n
]);

388 
u£d_¿nges_
.
	`push_back
(
u£d_¿nges
[
n
]);

390 cÚ¡ 
·œ
<
X­Ÿn
::
docid
, X­Ÿn::docid> 
p
 = 
u£d_¿nges
[
n
];

392 ià(
p
.
fœ¡
 =ğ0 &&….
£cÚd
 == 0)

395 ià(
p
.
fœ¡
 <ğ
Ï¡_’d
) {

396 
cout
 << 
¬gv
[0]

398 
cout
 << 
sourûs
[
Üd”
[
j
 - 1]] << " has„ange "

399 << 
Ï¡_¡¬t
 << "-" << 
Ï¡_’d
 << '\n';

400 
cout
 << 
sourûs
[
n
] << " has„ange "

401 << 
p
.
fœ¡
 << "-" <<….
£cÚd
 << 
’dl
;

402 
	`ex™
(1);

404 
Ï¡_¡¬t
 = 
p
.
fœ¡
;

405 
Ï¡_’d
 = 
p
.
£cÚd
;

408 
	`sw­
(
sourûs
, 
sourûs_
);

409 
	`sw­
(
u£d_¿nges
, 
u£d_¿nges_
);

413 ià(
	`mkdœ
(
de¡dœ
, 0755) < 0) {

417 ià(
”ºo
 =ğ
EEXIST
) {

418 
¡©
 
sb
;

419 ià(
	`¡©
(
de¡dœ
, &
sb
è=ğ0 && 
	`S_ISDIR
(sb.
¡_mode
))

420 
”ºo
 = 0;

422 
”ºo
 = 
EEXIST
;

424 ià(
”ºo
) {

425 
û¼
 << 
¬gv
[0] << ": cannot create directory '"

426 << 
de¡dœ
 << "': " << 
	`¡»¼Ü
(
”ºo
è<< 
’dl
;

427 
	`ex™
(1);

431 ià(
back’d
 =ğ
FLINT
) {

432 
	`com·ù_æšt
(
de¡dœ
, 
sourûs
, 
off£t
, 
block_size
, 
com·ùiÚ
,

433 
muÉass
, 
tÙ_off
);

434 } ià(
back’d
 =ğ
BRASS
) {

435 
	`com·ù_b¿ss
(
de¡dœ
, 
sourûs
, 
off£t
, 
block_size
, 
com·ùiÚ
,

436 
muÉass
, 
tÙ_off
);

438 
	`com·ù_ch”t
(
de¡dœ
, 
sourûs
, 
off£t
, 
block_size
, 
com·ùiÚ
,

439 
muÉass
, 
tÙ_off
);

448 
¡ršg
 
dÚÜ
 = 
de¡dœ
;

449 
dÚÜ
 += "/donor.tmp";

451 ià(
back’d
 =ğ
CHERT
) {

452 ()
X­Ÿn
::
Ch”t
::
	`İ’
(
dÚÜ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

453 } ià(
back’d
 =ğ
BRASS
) {

454 ()
X­Ÿn
::
B¿ss
::
	`İ’
(
dÚÜ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

456 ()
X­Ÿn
::
Flšt
::
	`İ’
(
dÚÜ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

457 
¡ršg
 
äom
 = 
dÚÜ
;

458 
äom
 += "/uuid";

459 
¡ršg
 
	`to
(
de¡dœ
);

460 
to
 += "/uuid";

461 ià(
	`»Çme
(
äom
.
	`c_¡r
(), 
to
.c_str()) == -1) {

462 
û¼
 << 
¬gv
[0] << ": cªnÙ„’am'" << 
äom
 << "'o '"

463 << 
to
 << "': " << 
	`¡»¼Ü
(
”ºo
è<< 
’dl
;

464 
	`ex™
(1);

467 
¡ršg
 
äom
 = 
dÚÜ
;

468 
äom
 +ğ
back’d_v”siÚ_fes
[
back’d
];

469 
¡ršg
 
	`to
(
de¡dœ
);

470 
to
 +ğ
back’d_v”siÚ_fes
[
back’d
];

471 ià(
	`»Çme
(
äom
.
	`c_¡r
(), 
to
.c_str()) == -1) {

472 
û¼
 << 
¬gv
[0] << ": cªnÙ„’am'" << 
äom
 << "'o '"

473 << 
to
 << "': " << 
	`¡»¼Ü
(
”ºo
è<< 
’dl
;

474 
	`ex™
(1);

477 
	`rm_rf
(
dÚÜ
);

478 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
”rÜ
) {

479 
û¼
 << 
¬gv
[0] << ": " << 
”rÜ
.
	`g‘_desütiÚ
(è<< 
’dl
;

480 
	`ex™
(1);

481 } 
	`ÿtch
 (cÚ¡ * 
msg
) {

482 
û¼
 << 
¬gv
[0] << ": " << 
msg
 << 
’dl
;

483 
	`ex™
(1);

485 
	}
}

	@bin/xapian-compact.h

22 #iâdeà
XAPIAN_INCLUDED_XAPIAN_COMPACT_H


23 
	#XAPIAN_INCLUDED_XAPIAN_COMPACT_H


	)

25 
	~<veùÜ
>

26 
	~<¡ršg
>

28 
	~"x­Ÿn/ty³s.h
"

30 ’um { 
	mSTANDARD
, 
	mFULL
, 
	mFULLER
 } 
	tcom·ùiÚ_Ëv–
;

33 
com·ù_b¿ss
(cÚ¡ * 
de¡dœ
, cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
sourûs
,

34 cÚ¡ 
¡d
::
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
size_t
 
block_size
,

35 
com·ùiÚ_Ëv–
 
com·ùiÚ
, 
boŞ
 
muÉass
,

36 
X­Ÿn
::
docid
 
tÙ_off
);

39 
com·ù_ch”t
(cÚ¡ * 
de¡dœ
, cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
sourûs
,

40 cÚ¡ 
¡d
::
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
size_t
 
block_size
,

41 
com·ùiÚ_Ëv–
 
com·ùiÚ
, 
boŞ
 
muÉass
,

42 
X­Ÿn
::
docid
 
tÙ_off
);

45 
com·ù_æšt
(cÚ¡ * 
de¡dœ
, cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
sourûs
,

46 cÚ¡ 
¡d
::
veùÜ
<
X­Ÿn
::
docid
> & 
off£t
, 
size_t
 
block_size
,

47 
com·ùiÚ_Ëv–
 
com·ùiÚ
, 
boŞ
 
muÉass
,

48 
X­Ÿn
::
docid
 
tÙ_off
);

	@bin/xapian-inspect.cc

21 
	~<cÚfig.h
>

23 
	~<iomª
>

24 
	~<io¡»am
>

25 
	~<¡ršg
>

26 
	~<c¡dio
>

28 
	~"æšt_bË.h
"

29 
	~"æšt_cursÜ.h
"

30 
	~"¡ršguts.h
"

32 
	~<x­Ÿn.h
>

34 
	~"gnu_g‘İt.h
"

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
	#PROG_NAME
 "x­Ÿn-š¥eù"

	)

39 
	#PROG_DESC
 "In¥eùhcÚ‹Á oà¨æšˆbË fÜ dev–İm’ˆÜ debuggšg"

	)

41 
	#OPT_HELP
 1

	)

42 
	#OPT_VERSION
 2

	)

44 
	$show_u§ge
() {

45 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] TABLE\n\n"

48 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

49 
	}
}

52 
	$di¥Ïy_niûly
(cÚ¡ 
¡ršg
 & 
d©a
) {

53 
¡ršg
::
cÚ¡_™”©Ü
 
i
;

54 
i
 = 
d©a
.
	`begš
(); i !ğd©a.
	`’d
(); ++i) {

55 
ch
 = *
i
;

56 ià(
ch
 < 32 || ch >= 127) {

57 
ch
) {

58 '\n': 
cout
 << "\\n"; ;

59 '\r': 
cout
 << "\\r"; ;

60 '\t': 
cout
 << "\\t"; ;

62 
buf
[20];

63 
	`¥rštf
(
buf
, "\\x%02x", ()
ch
);

64 
cout
 << 
buf
;

67 } ià(
ch
 == '\\') {

68 
cout
 << "\\\\";

70 
cout
 << 
ch
;

73 
	}
}

76 
	$show_h–p
()

78 
cout
 << "Commands:\n"

85 "qu™ : Qu™hi ut™y (®Ÿ 'q')" << 
’dl
;

86 
	}
}

89 
	$do_uÁ
(
FlštCursÜ
 & 
cursÜ
, cÚ¡ 
¡ršg
 & 
rg‘
)

91 ià(
cursÜ
.
	`aá”_’d
()) {

92 
cout
 << "Aˆ’d‡Ì—dy." << 
’dl
;

96 ià(!
rg‘
.
	`em±y
()) {

97 
cmp
 = 
rg‘
.
	`com·»
(
cursÜ
.
cu¼’t_key
);

98 ià(
cmp
 <= 0) {

99 ià(
cmp
)

100 
cout
 << "AÌ—dy‡á” s³cif›d key." << 
’dl
;

102 
cout
 << "AÌ—dy‡ˆ¥ecif›d key." << 
’dl
;

107 
cursÜ
.
	`Ãxt
()) {

108 
cmp
 = 1;

109 ià(!
rg‘
.
	`em±y
()) {

110 
cmp
 = 
rg‘
.
	`com·»
(
cursÜ
.
cu¼’t_key
);

111 ià(
cmp
 < 0) {

112 
cout
 << "NØexaù m©ch, stİpšg‡ˆ’Œy befÜe." << 
’dl
;

113 
cursÜ
.
	`´ev
();

117 
cout
 << "Key: ";

118 
	`di¥Ïy_niûly
(
cursÜ
.
cu¼’t_key
);

119 
cout
 << "\nTag: ";

120 
cursÜ
.
	`»ad_g
();

121 
	`di¥Ïy_niûly
(
cursÜ
.
cu¼’t_g
);

122 
cout
 << "\n";

123 ià(
cmp
 == 0) {

128 
cout
 << "R—chedƒnd." << 
’dl
;

129 
	}
}

132 
	$maš
(
¬gc
, **
¬gv
)

134 cÚ¡ 
İtiÚ
 
lÚg_İts
[] = {

135 {"h–p", 
no_¬gum’t
, 0, 
OPT_HELP
},

136 {"v”siÚ", 
no_¬gum’t
, 0, 
OPT_VERSION
},

137 {
NULL
, 0, 0, 0}

140 
c
;

141 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, "", 
lÚg_İts
, 0)) != -1) {

142 
c
) {

143 
OPT_HELP
:

144 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

145 
	`show_u§ge
();

146 
	`ex™
(0);

147 
OPT_VERSION
:

148 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

149 
	`ex™
(0);

151 
	`show_u§ge
();

152 
	`ex™
(1);

156 ià(
¬gc
 - 
İtšd
 != 1) {

157 
	`show_u§ge
();

158 
	`ex™
(1);

162 
¡ršg
 
	`bË_Çme
(
¬gv
[
İtšd
]);

163 
boŞ
 
¬g_is_dœeùÜy
 = 
	`dœ_exi¡s
(
bË_Çme
);

164 ià(
	`’dsw™h
(
bË_Çme
, ".DB"))

165 
bË_Çme
.
	`»size
ÑabË_Çme.
	`size
() - 2);

166 ià(!
	`’dsw™h
(
bË_Çme
, '.'))

167 
bË_Çme
 += '.';

168 ià(
¬g_is_dœeùÜy
 && !
	`fe_exi¡s
(
bË_Çme
 + "DB")) {

169 
û¼
 << 
¬gv
[0] << ": You‚“dØ¥ecify‡ sšgË BŒ“abË,‚Ù‡ d©aba£ dœeùÜy." << 
’dl
;

170 
	`ex™
(1);

173 
	`show_h–p
();

174 
cout
 << 
’dl
;

176 
İ’_difã»Á_bË
:

177 
Œy
 {

178 
FlštTabË
 
	`bË
("", 
bË_Çme
, 
Œue
);

179 
bË
.
	`İ’
();

180 ià(
bË
.
	`em±y
()) {

181 
cout
 << "NØ’Œ›s!" << 
’dl
;

182 
	`ex™
(0);

185 
FlštCursÜ
 
	`cursÜ
(&
bË
);

186 
cursÜ
.
	`fšd_’Œy
(
	`¡ršg
());

187 
cursÜ
.
	`Ãxt
();

189 !
cš
.
	`eof
()) {

190 
cout
 << "Key: ";

191 
	`di¥Ïy_niûly
(
cursÜ
.
cu¼’t_key
);

192 
cout
 << "\nTag: ";

193 
cursÜ
.
	`»ad_g
();

194 
	`di¥Ïy_niûly
(
cursÜ
.
cu¼’t_g
);

195 
cout
 << "\n";

196 
wa™_fÜ_šput
:

197 
cout
 << "? " << 
æush
;

199 
¡ršg
 
šput
;

200 
	`g‘lše
(
cš
, 
šput
);

201 ià(
cš
.
	`eof
()) ;

203 ià(
	`’dsw™h
(
šput
, '\r'))

204 
šput
.
	`»size
(šput.
	`size
() - 1);

206 ià(
šput
.
	`em±y
() || input == "n" || input == "next") {

207 ià(
cursÜ
.
	`aá”_’d
(è|| !cursÜ.
	`Ãxt
()) {

208 
cout
 << "Aˆ’d‡Ì—dy." << 
’dl
;

209 
wa™_fÜ_šput
;

212 } ià(
šput
 == "p" || input == "prev") {

215 ià(
cursÜ
.
	`aá”_’d
()ècursÜ.
	`fšd_’Œy
(cursÜ.
cu¼’t_key
);

216 ià(!
cursÜ
.
	`´ev
()) {

217 
cout
 << "Aˆ¡¬ˆ®»ady." << 
’dl
;

218 
wa™_fÜ_šput
;

221 } ià(
	`¡¬tsw™h
(
šput
, "u ")) {

222 
	`do_uÁ
(
cursÜ
, 
šput
.
	`sub¡r
(2));

223 
wa™_fÜ_šput
;

224 } ià(
	`¡¬tsw™h
(
šput
, "until ")) {

225 
	`do_uÁ
(
cursÜ
, 
šput
.
	`sub¡r
(6));

226 
wa™_fÜ_šput
;

227 } ià(
šput
 == "u" || input == "until") {

228 
	`do_uÁ
(
cursÜ
, 
	`¡ršg
());

229 
wa™_fÜ_šput
;

230 } ià(
	`¡¬tsw™h
(
šput
, "g ")) {

231 ià(!
cursÜ
.
	`fšd_’Œy
(
šput
.
	`sub¡r
(2))) {

232 
cout
 << "NØexaù m©ch, gošgØ’Œy befÜe." << 
’dl
;

235 } ià(
	`¡¬tsw™h
(
šput
, "goto ")) {

236 ià(!
cursÜ
.
	`fšd_’Œy
(
šput
.
	`sub¡r
(5))) {

237 
cout
 << "NØexaù m©ch, gošgØ’Œy befÜe." << 
’dl
;

240 } ià(
	`¡¬tsw™h
(
šput
, "o ")) {

241 
size_t
 
¦ash
 = 
bË_Çme
.
	`fšd_Ï¡_of
('/');

242 ià(
¦ash
 =ğ
¡ršg
::
Åos
)

243 
bË_Çme
.
	`»size
(0);

245 
bË_Çme
.
	`»size
(
¦ash
 + 1);

246 
bË_Çme
 +ğ
šput
.
	`sub¡r
(2);

247 ià(
	`’dsw™h
(
bË_Çme
, ".DB"))

248 
bË_Çme
.
	`»size
ÑabË_Çme.
	`size
() - 2);

249 ià(!
	`’dsw™h
(
bË_Çme
, '.'))

250 
bË_Çme
 += '.';

251 
İ’_difã»Á_bË
;

252 } ià(
	`¡¬tsw™h
(
šput
, "open ")) {

253 
size_t
 
¦ash
 = 
bË_Çme
.
	`fšd_Ï¡_of
('/');

254 ià(
¦ash
 =ğ
¡ršg
::
Åos
)

255 
bË_Çme
.
	`»size
(0);

257 
bË_Çme
.
	`»size
(
¦ash
 + 1);

258 
bË_Çme
 +ğ
šput
.
	`sub¡r
(5);

259 ià(
	`’dsw™h
(
bË_Çme
, ".DB"))

260 
bË_Çme
.
	`»size
ÑabË_Çme.
	`size
() - 2);

261 ià(!
	`’dsw™h
(
bË_Çme
, '.'))

262 
bË_Çme
 += '.';

263 
İ’_difã»Á_bË
;

264 } ià(
šput
 == "q" || input == "quit") {

266 } ià(
šput
 == "h" || input == "help" || input == "?") {

267 
	`show_h–p
();

268 
wa™_fÜ_šput
;

270 
cout
 << "UnknowÀcommªd." << 
’dl
;

271 
wa™_fÜ_šput
;

274 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
”rÜ
) {

275 
û¼
 << 
¬gv
[0] << ": " << 
”rÜ
.
	`g‘_desütiÚ
(è<< 
’dl
;

276 
	`ex™
(1);

278 
	}
}

	@bin/xapian-progsrv.cc

21 
	~<cÚfig.h
>

23 
	~"»mÙe£rv”.h
"

25 
	~"gnu_g‘İt.h
"

27 
	~<c¡dlib
>

28 
	~<io¡»am
>

29 
	~<¡ršg
>

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	#PROG_NAME
 "x­Ÿn-´og¤v"

	)

34 
	#PROG_DESC
 "Ped s”v” fÜ u£ w™h X­Ÿn' »mÙback’d"

	)

36 
	#OPT_HELP
 1

	)

37 
	#OPT_VERSION
 2

	)

39 cÚ¡ * 
	gİts
 = "t:w";

40 cÚ¡ 
İtiÚ
 
	glÚg_İts
[] = {

41 {"timeout", 
»quœed_¬gum’t
, 0, 't'},

42 {"wr™abË", 
no_¬gum’t
, 0, 'w'},

43 {"h–p", 
no_¬gum’t
, 0, 
OPT_HELP
},

44 {"v”siÚ", 
no_¬gum’t
, 0, 
OPT_VERSION
},

45 {
NULL
, 0, 0, 0}

48 
	$show_u§ge
() {

49 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] DATABASE_DIRECTORY...\n\n"

54 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

55 
	}
}

57 
	$maš
(
¬gc
, **
¬gv
)

59 
timeout
 = 60000;

60 
boŞ
 
wr™abË
 = 
çl£
;

61 
boŞ
 
syÁax_”rÜ
 = 
çl£
;

63 
c
;

64 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, 
İts
, 
lÚg_İts
, 
NULL
)) != -1) {

65 
c
) {

66 
OPT_HELP
:

67 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

68 
	`show_u§ge
();

69 
	`ex™
(0);

70 
OPT_VERSION
:

71 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

72 
	`ex™
(0);

74 
timeout
 = 
	`©oi
(
İrg
);

77 
wr™abË
 = 
Œue
;

80 
syÁax_”rÜ
 = 
Œue
;

84 ià(
syÁax_”rÜ
 || 
İtšd
 =ğ
¬gc
) {

85 
	`show_u§ge
();

86 
	`ex™
(1);

89 ià(
wr™abË
 && (
¬gc
 - 
İtšd
) != 1) {

90 
û¼
 << "Error: only one database directory‡llowed with '--writable'."

91 << 
’dl
;

92 
	`ex™
(1);

100 
veùÜ
<
¡ršg
> 
	`dbÇmes
(
¬gv
 + 
İtšd
,‡rgv + 
¬gc
);

102 
Œy
 {

105 
RemÙeS”v”
 
	`£rv”
(
dbÇmes
, 0, 1, 
timeout
,imeout, 
wr™abË
);

111 
£rv”
.
	`run
();

112 } 
	`ÿtch
 (...) {

122 
	}
}

	@bin/xapian-replicate-server.cc

22 
	~<cÚfig.h
>

24 
	~"»¶iÿ‹tı£rv”.h
"

26 
	~<x­Ÿn.h
>

28 
	~"gnu_g‘İt.h
"

30 
	~<c¡dlib
>

31 
	~<io¡»am
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
	#PROG_NAME
 "x­Ÿn-»¶iÿ‹-£rv”"

	)

36 
	#PROG_DESC
 "S”viû d©aba£„•liÿtiÚ„eque¡ äom cl›Ás"

	)

38 
	#OPT_HELP
 1

	)

39 
	#OPT_VERSION
 2

	)

41 
	$show_u§ge
() {

42 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] DATABASE_PARENT_DIRECTORY\n\n"

48 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

49 
	}
}

52 
	$maš
(
¬gc
, **
¬gv
)

54 cÚ¡ * 
İts
 = "I:p:o";

55 cÚ¡ 
İtiÚ
 
lÚg_İts
[] = {

56 {"š‹rçû", 
»quœed_¬gum’t
, 0, 'I'},

57 {"pÜt", 
»quœed_¬gum’t
, 0, 'p'},

58 {"Úe-shÙ", 
no_¬gum’t
, 0, 'o'},

59 {"h–p", 
no_¬gum’t
, 0, 
OPT_HELP
},

60 {"v”siÚ", 
no_¬gum’t
, 0, 
OPT_VERSION
},

61 {
NULL
, 0, 0, 0}

64 
¡ršg
 
ho¡
;

65 
pÜt
 = 0;

67 
boŞ
 
Úe_shÙ
 = 
çl£
;

69 
c
;

70 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, 
İts
, 
lÚg_İts
, 0)) != -1) {

71 
c
) {

73 
ho¡
.
	`assign
(
İrg
);

76 
pÜt
 = 
	`©oi
(
İrg
);

79 
Úe_shÙ
 = 
Œue
;

81 
OPT_HELP
:

82 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

83 
	`show_u§ge
();

84 
	`ex™
(0);

85 
OPT_VERSION
:

86 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

87 
	`ex™
(0);

89 
	`show_u§ge
();

90 
	`ex™
(1);

94 ià(
¬gc
 - 
İtšd
 != 1) {

95 
	`show_u§ge
();

96 
	`ex™
(1);

100 
¡ršg
 
	`db·th
(
¬gv
[
İtšd
]);

102 
Œy
 {

103 
R•liÿ‹TıS”v”
 
	`£rv”
(
ho¡
, 
pÜt
, 
db·th
);

104 ià(
Úe_shÙ
) {

105 
£rv”
.
	`run_Úû
();

107 
£rv”
.
	`run
();

109 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
”rÜ
) {

110 
û¼
 << 
¬gv
[0] << ": " << 
”rÜ
.
	`g‘_desütiÚ
(è<< 
’dl
;

111 
	`ex™
(1);

113 
	}
}

	@bin/xapian-replicate.cc

22 
	~<cÚfig.h
>

24 
	~"»¶iÿ‹tış›Á.h
"

26 
	~<x­Ÿn.h
>

28 
	~"gnu_g‘İt.h
"

29 
	~"¡ršguts.h
"

30 
	~"§ãuni¡d.h
"

32 
	~<io¡»am
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	#PROG_NAME
 "x­Ÿn-»¶iÿ‹"

	)

37 
	#PROG_DESC
 "R•liÿ‹‡ d©aba£ from‡ ma¡” s”v”Ø¨loÿÈcİy"

	)

39 
	#OPT_HELP
 1

	)

40 
	#OPT_VERSION
 2

	)

43 
	#DEFAULT_INTERVAL
 60

	)

45 
	$show_u§ge
() {

46 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] DATABASE\n\n"

52 " (deçuÉ: "
	`STRINGIZE
(
DEFAULT_INTERVAL
)")\n"

56 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

57 
	}
}

60 
	$maš
(
¬gc
, **
¬gv
)

62 cÚ¡ * 
İts
 = "h:p:m:i:ov";

63 cÚ¡ 
İtiÚ
 
lÚg_İts
[] = {

64 {"ho¡", 
»quœed_¬gum’t
, 0, 'h'},

65 {"pÜt", 
»quœed_¬gum’t
, 0, 'p'},

66 {"ma¡”", 
»quœed_¬gum’t
, 0, 'm'},

67 {"š‹rv®", 
»quœed_¬gum’t
, 0, 'i'},

68 {"Úe-shÙ", 
no_¬gum’t
, 0, 'o'},

69 {"v”bo£", 
no_¬gum’t
, 0, 'v'},

70 {"h–p", 
no_¬gum’t
, 0, 
OPT_HELP
},

71 {"v”siÚ", 
no_¬gum’t
, 0, 
OPT_VERSION
},

72 {
NULL
, 0, 0, 0}

75 
¡ršg
 
ho¡
;

76 
pÜt
 = 0;

77 
¡ršg
 
ma¡”db
;

78 
š‹rv®
 = 
DEFAULT_INTERVAL
;

79 
boŞ
 
Úe_shÙ
 = 
çl£
;

80 
boŞ
 
v”bo£
 = 
çl£
;

82 
c
;

83 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, 
İts
, 
lÚg_İts
, 0)) != -1) {

84 
c
) {

86 
ho¡
.
	`assign
(
İrg
);

89 
pÜt
 = 
	`©oi
(
İrg
);

92 
ma¡”db
.
	`assign
(
İrg
);

95 
š‹rv®
 = 
	`©oi
(
İrg
);

98 
Úe_shÙ
 = 
Œue
;

101 
v”bo£
 = 
Œue
;

103 
OPT_HELP
:

104 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

105 
	`show_u§ge
();

106 
	`ex™
(0);

107 
OPT_VERSION
:

108 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

109 
	`ex™
(0);

111 
	`show_u§ge
();

112 
	`ex™
(1);

116 ià(
¬gc
 - 
İtšd
 != 1) {

117 
	`show_u§ge
();

118 
	`ex™
(1);

122 
¡ršg
 
	`db·th
(
¬gv
[
İtšd
]);

124 
Œue
) {

125 
Œy
 {

126 ià(
v”bo£
) {

127 
cout
 << "CÚÃùšgØ" << 
ho¡
 << ":" << 
pÜt
 << 
’dl
;

129 
R•liÿ‹TıCl›Á
 
	`ş›Á
(
ho¡
, 
pÜt
, 10000);

130 ià(
v”bo£
) {

131 
cout
 << "G‘tšg upd©fÜ " << 
db·th
 << " from "

132 << 
ma¡”db
 << 
’dl
;

134 
X­Ÿn
::
R•liÿtiÚInfo
 
šfo
;

135 
ş›Á
.
	`upd©e_äom_ma¡”
(
db·th
, 
ma¡”db
, 
šfo
);

136 ià(
v”bo£
) {

137 
cout
 << "Update complete: " <<

138 
šfo
.
fuÎcİy_couÁ
 << " copies, " <<

139 
šfo
.
chªge£t_couÁ
 << " changesets, " <<

140 (
šfo
.
chªged
 ? "new†ive database" : "no changeso†ive database") <<

141 
’dl
;

143 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
N‘wÜkE¼Ü
 &
”rÜ
) {

147 
û¼
 << 
¬gv
[0] << ": " << 
”rÜ
.
	`g‘_desütiÚ
(è<< 
’dl
;

152 ià(
Úe_shÙ
)

153 
	`ex™
(1);

154 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
”rÜ
) {

155 
û¼
 << 
¬gv
[0] << ": " << 
”rÜ
.
	`g‘_desütiÚ
(è<< 
’dl
;

156 
	`ex™
(1);

157 } 
	`ÿtch
 (cÚ¡ 
exû±iÚ
 &
e
) {

158 
û¼
 << "Caughˆ¡ªd¬dƒxû±iÚ: " << 
e
.
	`wh©
(è<< 
’dl
;

159 
	`ex™
(1);

160 } 
	`ÿtch
 (...) {

161 
û¼
 << "CaughˆunknowÀexû±iÚ" << 
’dl
;

162 
	`ex™
(1);

164 ià(
Úe_shÙ
) ;

165 
	`¦“p
(
š‹rv®
);

167 
	}
}

	@bin/xapian-tcpsrv.cc

23 
	~<cÚfig.h
>

25 
	~<c¡dlib
>

27 
	~"§ã”ºo.h
"

29 
	~<io¡»am
>

30 
	~<¡ršg
>

32 
	~"gnu_g‘İt.h
"

34 
	~"x­Ÿn/”rÜ.h
"

35 
	~"»mÙ‘ı£rv”.h
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	$»gi¡”_u£r_weightšg_schemes
(
TıS”v”
 &
£rv”
) {

40 ()
£rv”
;

46 
	}
}

48 cÚ¡ 
	gMSECS_IDLE_TIMEOUT_DEFAULT
 = 60000;

49 cÚ¡ 
	gMSECS_ACTIVE_TIMEOUT_DEFAULT
 = 15000;

51 
	#PROG_NAME
 "x­Ÿn-tı¤v"

	)

52 
	#PROG_DESC
 "TCP d«mÚ fÜ u£ w™h X­Ÿn' »mÙback’d"

	)

54 
	#OPT_HELP
 1

	)

55 
	#OPT_VERSION
 2

	)

57 cÚ¡ * 
	gİts
 = "I:p:a:i:t:oqw";

58 cÚ¡ 
İtiÚ
 
	glÚg_İts
[] = {

59 {"š‹rçû", 
»quœed_¬gum’t
, 0, 'I'},

60 {"pÜt", 
»quœed_¬gum’t
, 0, 'p'},

61 {"aùive-timeout", 
»quœed_¬gum’t
, 0, 'a'},

62 {"idË-timeout", 
»quœed_¬gum’t
, 0, 'i'},

63 {"timeout", 
»quœed_¬gum’t
, 0, 't'},

64 {"Úe-shÙ", 
no_¬gum’t
, 0, 'o'},

65 {"qu›t", 
no_¬gum’t
, 0, 'q'},

66 {"wr™abË", 
no_¬gum’t
, 0, 'w'},

67 {"h–p", 
no_¬gum’t
, 0, 
OPT_HELP
},

68 {"v”siÚ", 
no_¬gum’t
, 0, 
OPT_VERSION
},

69 {
NULL
, 0, 0, 0}

72 
	$show_u§ge
() {

73 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] DATABASE_DIRECTORY...\n\n"

78 " --idË-timeouˆMSECS s‘imeouˆfÜ idË cÚÃùiÚ (deçuÉ " << 
MSECS_IDLE_TIMEOUT_DEFAULT
 << "ms)\n"

79 " --aùive-timeouˆMSECS s‘imeouˆfÜ‡ùivcÚÃùiÚ (deçuÉ " << 
MSECS_ACTIVE_TIMEOUT_DEFAULT
 << "ms)\n"

85 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

86 
	}
}

88 
	$maš
(
¬gc
, **
¬gv
) {

89 
¡ršg
 
ho¡
;

90 
pÜt
 = 0;

91 
m£cs_aùive_timeout
 = 
MSECS_ACTIVE_TIMEOUT_DEFAULT
;

92 
m£cs_idË_timeout
 = 
MSECS_IDLE_TIMEOUT_DEFAULT
;

94 
boŞ
 
Úe_shÙ
 = 
çl£
;

95 
boŞ
 
v”bo£
 = 
Œue
;

96 
boŞ
 
wr™abË
 = 
çl£
;

97 
boŞ
 
syÁax_”rÜ
 = 
çl£
;

99 
c
;

100 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, 
İts
, 
lÚg_İts
, 
NULL
)) != -1) {

101 
c
) {

102 
OPT_HELP
:

103 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

104 
	`show_u§ge
();

105 
	`ex™
(0);

106 
OPT_VERSION
:

107 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

108 
	`ex™
(0);

110 
ho¡
.
	`assign
(
İrg
);

113 
pÜt
 = 
	`©oi
(
İrg
);

116 
m£cs_aùive_timeout
 = 
	`©oi
(
İrg
);

119 
m£cs_idË_timeout
 = 
	`©oi
(
İrg
);

122 
m£cs_aùive_timeout
 = 
m£cs_idË_timeout
 = 
	`©oi
(
İrg
);

125 
Úe_shÙ
 = 
Œue
;

128 
v”bo£
 = 
çl£
;

131 
wr™abË
 = 
Œue
;

134 
syÁax_”rÜ
 = 
Œue
;

138 ià(
syÁax_”rÜ
 || 
¬gv
[
İtšd
] =ğ
NULL
) {

139 
	`show_u§ge
();

140 
	`ex™
(1);

143 ià(
pÜt
 <= 0 ||…ort >= 65536) {

144 
û¼
 << "Error: must specify‡ valid…ort‚umber (between 1‡nd 65535)."

145 " Waùu®ly gÙ " << 
pÜt
 << 
’dl
;

146 
	`ex™
(1);

149 ià(
wr™abË
 && (
¬gc
 - 
İtšd
) != 1) {

150 
û¼
 << "E¼Ü: oÆy oÃ d©aba£ dœeùÜy‡Îowed w™h '--wr™abË'." << 
’dl
;

151 
	`ex™
(1);

154 
Œy
 {

155 
veùÜ
<
¡ršg
> 
dbÇmes
;

158 ià(
wr™abË
) {

159 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
¬gv
[
İtšd
], X­Ÿn::
DB_CREATE_OR_OPEN
);

160 
dbÇmes
.
	`push_back
(
¬gv
[
İtšd
]);

162 
¬gv
[
İtšd
]) {

163 
dbÇmes
.
	`push_back
(
¬gv
[
İtšd
]);

164 
X­Ÿn
::
D©aba£
 
	`db
(
¬gv
[
İtšd
++]);

168 ià(
v”bo£
) {

169 
cout
 << "Starting";

170 ià(
wr™abË
)

171 
cout
 << " writable";

172 
cout
 << " server on";

173 ià(!
ho¡
.
	`em±y
())

174 
cout
 << " ho¡ " << 
ho¡
 << ",";

175 
cout
 << "…Üˆ" << 
pÜt
 << 
’dl
;

178 
RemÙeTıS”v”
 
	`£rv”
(
dbÇmes
, 
ho¡
, 
pÜt
, 
m£cs_aùive_timeout
,

179 
m£cs_idË_timeout
, 
wr™abË
, 
v”bo£
);

181 ià(
v”bo£
)

182 
cout
 << "Li¡’šg..." << 
’dl
;

184 
	`»gi¡”_u£r_weightšg_schemes
(
£rv”
);

186 ià(
Úe_shÙ
) {

187 
£rv”
.
	`run_Úû
();

189 
£rv”
.
	`run
();

191 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

192 
û¼
 << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

193 
	`ex™
(1);

194 } 
	`ÿtch
 (cÚ¡ 
exû±iÚ
 &
e
) {

195 
û¼
 << "Caughˆ¡ªd¬dƒxû±iÚ: " << 
e
.
	`wh©
(è<< 
’dl
;

196 
	`ex™
(1);

197 } 
	`ÿtch
 (...) {

198 
û¼
 << "CaughˆunknowÀexû±iÚ" << 
’dl
;

199 
	`ex™
(1);

201 
	}
}

	@common/alltermslist.h

21 #iâdeà
XAPIAN_INCLUDED_ALLTERMSLIST_H


22 
	#XAPIAN_INCLUDED_ALLTERMSLIST_H


	)

24 
	~"‹rmli¡.h
"

27 şas 
	cAÎT”msLi¡
 : 
public
 
T”mLi¡
 {

29 
İ”©Ü
=(cÚ¡ 
AÎT”msLi¡
 &);

32 
AÎT”msLi¡
(const AllTermsList &);

34 
	m´Ùeùed
:

36 
	$AÎT”msLi¡
() { }

38 
public
:

40 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

43 
vœtu®
 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const = 0;

50 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

53 
vœtu®
 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const = 0;

56 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const = 0;

59 
vœtu®
 
T”mLi¡
 *
	`Ãxt
() = 0;

66 
vœtu®
 
T”mLi¡
 *
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
) = 0;

69 
vœtu®
 
boŞ
 
	$©_’d
() const = 0;

76 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

83 
vœtu®
 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

84 
	}
};

	@common/autoptr.h

26 #iâdeà
AutoPŒ


27 
	~<memÜy
>

28 
	#AutoPŒ
 
¡d
::
auto_±r


	)

	@common/bitstream.cc

22 
	~<cÚfig.h
>

24 
	~"b™¡»am.h
"

26 
	~<x­Ÿn/ty³s.h
>

28 
	~"omas£¹.h
"

30 
	~<cm©h
>

31 
	~<veùÜ
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 cÚ¡ 
	gæ¡ab
[256] = {

55 
šlše
 
	$my_æs
(
mask
)

57 
»suÉ
 = 0;

58 ià(
mask
 >= 0x10000u) {

59 
mask
 >>= 16;

60 
»suÉ
 = 16;

62 ià(
mask
 >= 0x100u) {

63 
mask
 >>= 8;

64 
»suÉ
 += 8;

66  
»suÉ
 + 
æ¡ab
[
mask
];

67 
	}
}

69 
Çme¥aû
 
	gX­Ÿn
 {

72 
	gB™Wr™”
::
’code
(
size_t
 
v®ue
, size_ˆ
outof
)

74 
As£¹
(
v®ue
 < 
outof
);

75 
size_t
 
	gb™s
 = 
my_æs
(
outof
 - 1);

76 cÚ¡ 
size_t
 
	g¥¬e
 = (1 << 
b™s
è- 
outof
;

77 ià(
	g¥¬e
) {

78 cÚ¡ 
size_t
 
	gmid_¡¬t
 = (
outof
 - 
¥¬e
) / 2;

79 ià(
	gv®ue
 >ğ
mid_¡¬t
 + 
¥¬e
) {

80 
v®ue
 = (v®u- (
mid_¡¬t
 + 
¥¬e
)è| (1 << (
b™s
 - 1));

81 } ià(
	gv®ue
 >ğ
mid_¡¬t
) {

82 --
b™s
;

86 ià(
	gb™s
 + 
	gn_b™s
 > 32) {

90 
As£¹
(
b™s
 <= 32);

91 
	gacc
 |ğ(
v®ue
 << 
n_b™s
);

92 
	gbuf
 +ğ(
acc
);

93 
	gacc
 >>= 8;

94 
	gv®ue
 >>= 8;

95 
	gb™s
 -= 8;

97 
	gacc
 |ğ(
v®ue
 << 
n_b™s
);

98 
	gn_b™s
 +ğ
b™s
;

99 
	gn_b™s
 >= 8) {

100 
buf
 +ğ(
acc
);

101 
	gacc
 >>= 8;

102 
	gn_b™s
 -= 8;

107 
	gB™Wr™”
::
’code_š‹½Ş©ive
(cÚ¡ 
veùÜ
<
X­Ÿn
::
‹rmpos
> &
pos
, 
j
, 
k
)

109 
	gj
 + 1 < 
	gk
) {

110 cÚ¡ 
size_t
 
	gmid
 = (
j
 + 
k
) / 2;

114 cÚ¡ 
size_t
 
	goutof
 = 
pos
[
k
] -…os[
j
] + j - k + 1;

115 cÚ¡ 
size_t
 
	glowe¡
 = 
pos
[
j
] + 
mid
 - j;

116 
’code
(
pos
[
mid
] - 
lowe¡
, 
outof
);

117 
’code_š‹½Ş©ive
(
pos
, 
j
, 
mid
);

118 
	gj
 = 
mid
;

122 
	gX­Ÿn
::
‹rmpos


123 
B™R—d”
::
decode
(
X­Ÿn
::
‹rmpos
 
outof
)

125 
size_t
 
b™s
 = 
my_æs
(
outof
 - 1);

126 cÚ¡ 
size_t
 
	g¥¬e
 = (1 << 
b™s
è- 
outof
;

127 cÚ¡ 
size_t
 
	gmid_¡¬t
 = (
outof
 - 
¥¬e
) / 2;

128 
	gX­Ÿn
::
‹rmpos
 
p
;

129 ià(
	g¥¬e
) {

130 
	gp
 = 
»ad_b™s
(
b™s
 - 1);

131 ià(
	gp
 < 
	gmid_¡¬t
) {

132 ià(
»ad_b™s
(1)è
	gp
 +ğ
mid_¡¬t
 + 
¥¬e
;

135 
	gp
 = 
»ad_b™s
(
b™s
);

137 
As£¹
(
p
 < 
outof
);

138  
	gp
;

142 
	gB™R—d”
::
»ad_b™s
(
couÁ
)

144 
»suÉ
;

145 ià(
	gcouÁ
 > 25) {

150 
As£¹
(
couÁ
 <= 32);

151 
	g»suÉ
 = 
»ad_b™s
(16);

152  
	g»suÉ
 | (
»ad_b™s
(
couÁ
 - 16) << 16);

154 
	gn_b™s
 < 
	gcouÁ
) {

155 
As£¹
(
idx
 < 
buf
.
size
());

156 
	gacc
 |ğ
¡©ic_ÿ¡
<>(
buf
[
idx
++]è<< 
n_b™s
;

157 
	gn_b™s
 += 8;

159 
	g»suÉ
 = 
acc
 & ((1u << 
couÁ
) - 1);

160 
	gacc
 >>ğ
couÁ
;

161 
	gn_b™s
 -ğ
couÁ
;

162  
	g»suÉ
;

166 
	gB™R—d”
::
decode_š‹½Ş©ive
(
veùÜ
<
X­Ÿn
::
‹rmpos
> & 
pos
, 
j
, 
k
)

168 
	gj
 + 1 < 
	gk
) {

169 cÚ¡ 
size_t
 
	gmid
 = (
j
 + 
k
) / 2;

173 cÚ¡ 
size_t
 
	goutof
 = 
pos
[
k
] -…os[
j
] + j - k + 1;

174 
	gpos
[
mid
] = 
decode
(
outof
è+ (
pos
[
j
] + mid - j);

175 
decode_š‹½Ş©ive
(
pos
, 
j
, 
mid
);

176 
	gj
 = 
mid
;

	@common/bitstream.h

22 #iâdeà
XAPIAN_INCLUDED_BITSTREAM_H


23 
	#XAPIAN_INCLUDED_BITSTREAM_H


	)

25 
	~<x­Ÿn/ty³s.h
>

26 
	~<x­Ÿn/visib™y.h
>

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
Çme¥aû
 
	gX­Ÿn
 {

33 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gB™Wr™”
 {

34 
	g¡d
::
¡ršg
 
buf
;

35 
	gn_b™s
;

36 
	gacc
;

38 
	gpublic
:

39 
B™Wr™”
(è: 
n_b™s
(0), 
acc
(0) { }

41 
B™Wr™”
(cÚ¡ 
¡d
::
¡ršg
 & 
£ed
è: 
buf
(£ed), 
n_b™s
(0), 
acc
(0) { }

43 
’code
(
size_t
 
v®ue
, size_ˆ
outof
);

45 
	g¡d
::
¡ršg
 & 
ä“ze
() {

46 ià(
n_b™s
) {

47 
buf
 +ğ(
acc
);

48 
	gn_b™s
 = 0;

49 
	gacc
 = 0;

51  
	gbuf
;

54 
’code_š‹½Ş©ive
(cÚ¡ 
¡d
::
veùÜ
<
X­Ÿn
::
‹rmpos
> &
pos
, 
j
, 
k
);

57 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gB™R—d”
 {

58 
	g¡d
::
¡ršg
 
buf
;

59 
size_t
 
	gidx
;

60 
	gn_b™s
;

61 
	gacc
;

63 
»ad_b™s
(
couÁ
);

65 
	gpublic
:

66 
B™R—d”
(cÚ¡ 
¡d
::
¡ršg
 &
buf_
)

67 : 
buf
(
buf_
), 
idx
(0), 
n_b™s
(0), 
acc
(0) { }

69 
B™R—d”
(cÚ¡ 
¡d
::
¡ršg
 &
buf_
, 
size_t
 
sk
)

70 : 
buf
(
buf_
, 
sk
), 
idx
(0), 
n_b™s
(0), 
acc
(0) { }

72 
	gX­Ÿn
::
‹rmpos
 
decode
(
X­Ÿn
::‹rmpo 
outof
);

78 
boŞ
 
check_®l_gÚe
() const {

79  (
	gidx
 =ğ
buf
.
size
(è&& 
n_b™s
 < 7 && 
acc
 == 0);

82 
decode_š‹½Ş©ive
(
¡d
::
veùÜ
<
X­Ÿn
::
‹rmpos
> & 
pos
, 
j
, 
k
);

87 
usšg
 
	gX­Ÿn
::
B™Wr™”
;

88 
usšg
 
	gX­Ÿn
::
B™R—d”
;

	@common/const_database_wrapper.cc

23 
	~<cÚfig.h
>

25 
	~"cÚ¡_d©aba£_w¿µ”.h
"

27 
	~"x­Ÿn/”rÜ.h
"

30 
	gCÚ¡D©aba£W¿µ”
::
	$nÚcÚ¡_acûss
() const

32 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Accesso‚on-const method of database "

34 
	}
}

36 
	gCÚ¡D©aba£W¿µ”
::
CÚ¡D©aba£W¿µ”
(

37 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
»®db_
)

38 : 
	$»®db
(
»®db_
)

40 
	}
}

42 
X­Ÿn
::
doccouÁ


43 
CÚ¡D©aba£W¿µ”
::
	$g‘_doccouÁ
() const

45  
»®db
->
	`g‘_doccouÁ
();

46 
	}
}

48 
	gX­Ÿn
::
docid


49 
CÚ¡D©aba£W¿µ”
::
	$g‘_Ï¡docid
() const

51  
»®db
->
	`g‘_Ï¡docid
();

52 
	}
}

54 
tÙËn_t


55 
	gCÚ¡D©aba£W¿µ”
::
	$g‘_tÙ®_Ëngth
() const

57  
»®db
->
	`g‘_tÙ®_Ëngth
();

58 
	}
}

60 
	gX­Ÿn
::
doş’gth


61 
CÚ¡D©aba£W¿µ”
::
	$g‘_avËngth
() const

63  
»®db
->
	`g‘_avËngth
();

64 
	}
}

66 
	gX­Ÿn
::
‹rmcouÁ


67 
CÚ¡D©aba£W¿µ”
::
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const

69  
»®db
->
g‘_doş’gth
(
did
);

72 
	gX­Ÿn
::
doccouÁ


73 
CÚ¡D©aba£W¿µ”
::
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

75  
»®db
->
	`g‘_‹rmäeq
(
Šame
);

76 
	}
}

78 
	gX­Ÿn
::
‹rmcouÁ


79 
CÚ¡D©aba£W¿µ”
::
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const

81  
»®db
->
	`g‘_cŞËùiÚ_äeq
(
Šame
);

82 
	}
}

84 
	gX­Ÿn
::
doccouÁ


85 
CÚ¡D©aba£W¿µ”
::
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const

87  
»®db
->
g‘_v®ue_äeq
(
v®no
);

90 
	g¡d
::
¡ršg


91 
CÚ¡D©aba£W¿µ”
::
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

93  
»®db
->
g‘_v®ue_low”_bound
(
v®no
);

96 
	g¡d
::
¡ršg


97 
CÚ¡D©aba£W¿µ”
::
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const

99  
»®db
->
g‘_v®ue_uµ”_bound
(
v®no
);

102 
boŞ


103 
	gCÚ¡D©aba£W¿µ”
::
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const

105  
»®db
->
	`‹rm_exi¡s
(
Šame
);

106 
	}
}

108 
boŞ


109 
	gCÚ¡D©aba£W¿µ”
::
	$has_pos™iÚs
() const

111  
»®db
->
	`has_pos™iÚs
();

112 
	}
}

114 
L—fPo¡Li¡
 *

115 
	gCÚ¡D©aba£W¿µ”
::
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const

117  
»®db
->
	`İ’_po¡_li¡
(
Šame
);

118 
	}
}

120 
V®ueLi¡
 *

121 
	gCÚ¡D©aba£W¿µ”
::
İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

123  
»®db
->
İ’_v®ue_li¡
(
¦Ù
);

126 
T”mLi¡
 *

127 
	gCÚ¡D©aba£W¿µ”
::
İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const

129  
»®db
->
İ’_‹rm_li¡
(
did
);

132 
T”mLi¡
 *

133 
	gCÚ¡D©aba£W¿µ”
::
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const

135  
»®db
->
	`İ’_®É”ms
(
´efix
);

136 
	}
}

138 
Pos™iÚLi¡
 *

139 
	gCÚ¡D©aba£W¿µ”
::
İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
,

140 cÚ¡ 
¡ršg
 & 
Šame
) const

142  
	g»®db
->
İ’_pos™iÚ_li¡
(
did
, 
Šame
);

145 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

146 
CÚ¡D©aba£W¿µ”
::
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const

148  
	g»®db
->
İ’_docum’t
(
did
, 
Ïzy
);

151 
T”mLi¡
 *

152 
	gCÚ¡D©aba£W¿µ”
::
	$İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const

154  
»®db
->
	`İ’_¥–lšg_‹rmli¡
(
wÜd
);

155 
	}
}

157 
T”mLi¡
 *

158 
	gCÚ¡D©aba£W¿µ”
::
	$İ’_¥–lšg_wÜdli¡
() const

160  
»®db
->
	`İ’_¥–lšg_wÜdli¡
();

161 
	}
}

163 
	gX­Ÿn
::
doccouÁ


164 
CÚ¡D©aba£W¿µ”
::
	$g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const

166  
»®db
->
	`g‘_¥–lšg_äequ’cy
(
wÜd
);

167 
	}
}

169 
T”mLi¡
 *

170 
	gCÚ¡D©aba£W¿µ”
::
	$İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const

172  
»®db
->
	`İ’_synÚym_‹rmli¡
(
‹rm
);

173 
	}
}

175 
T”mLi¡
 *

176 
	gCÚ¡D©aba£W¿µ”
::
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const

178  
»®db
->
	`İ’_synÚym_keyli¡
(
´efix
);

179 
	}
}

181 
¡ršg


182 
	gCÚ¡D©aba£W¿µ”
::
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const

184  
»®db
->
	`g‘_m‘ad©a
(
key
);

185 
	}
}

187 
T”mLi¡
 *

188 
	gCÚ¡D©aba£W¿µ”
::
İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const

190  
»®db
->
İ’_m‘ad©a_keyli¡
(
´efix
);

194 
	gCÚ¡D©aba£W¿µ”
::
»que¡_docum’t
(
X­Ÿn
::
docid
 
did
) const

196  
»®db
->
»que¡_docum’t
(
did
);

199 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

200 
CÚ¡D©aba£W¿µ”
::
cŞËù_docum’t
(
X­Ÿn
::
docid
 
did
) const

202  
»®db
->
cŞËù_docum’t
(
did
);

205 
¡ršg


206 
	gCÚ¡D©aba£W¿µ”
::
	$g‘_»visiÚ_šfo
() const

208  
»®db
->
	`g‘_»visiÚ_šfo
();

209 
	}
}

211 
¡ršg


212 
	gCÚ¡D©aba£W¿µ”
::
	$g‘_uuid
() const

214  
»®db
->
	`g‘_uuid
();

215 
	}
}

218 
	gCÚ¡D©aba£W¿µ”
::
šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const

220  
»®db
->
šv®id©e_doc_objeù
(
obj
);

225 
	gCÚ¡D©aba£W¿µ”
::
add_¥–lšg
(cÚ¡ 
¡ršg
 &, 
X­Ÿn
::
‹rmcouÁ
) const

227 
nÚcÚ¡_acûss
();

231 
	gCÚ¡D©aba£W¿µ”
::
»move_¥–lšg
(cÚ¡ 
¡ršg
 &, 
X­Ÿn
::
‹rmcouÁ
) const

233 
nÚcÚ¡_acûss
();

237 
	gCÚ¡D©aba£W¿µ”
::
	$add_synÚym
(cÚ¡ 
¡ršg
 &, const string &) const

239 
	`nÚcÚ¡_acûss
();

240 
	}
}

243 
	gCÚ¡D©aba£W¿µ”
::
	$»move_synÚym
(cÚ¡ 
¡ršg
 &, const string &) const

245 
	`nÚcÚ¡_acûss
();

246 
	}
}

249 
	gCÚ¡D©aba£W¿µ”
::
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 &) const

251 
	`nÚcÚ¡_acûss
();

252 
	}
}

255 
	gCÚ¡D©aba£W¿µ”
::
	$£t_m‘ad©a
(cÚ¡ 
¡ršg
 &, const string &)

257 
	`nÚcÚ¡_acûss
();

258 
	}
}

261 
	gCÚ¡D©aba£W¿µ”
::
	$»İ’
()

263 
	`nÚcÚ¡_acûss
();

264 
	}
}

267 
	gCÚ¡D©aba£W¿µ”
::
	$şo£
()

269 
	`nÚcÚ¡_acûss
();

270 
	}
}

273 
	gCÚ¡D©aba£W¿µ”
::
	$comm™
()

275 
	`nÚcÚ¡_acûss
();

276 
	}
}

279 
	gCÚ¡D©aba£W¿µ”
::
	$ÿnûl
()

281 
	`nÚcÚ¡_acûss
();

282 
	}
}

285 
	gCÚ¡D©aba£W¿µ”
::
	$begš_Œª§ùiÚ
(
boŞ
)

287 
	`nÚcÚ¡_acûss
();

288 
	}
}

291 
	gCÚ¡D©aba£W¿µ”
::
	$comm™_Œª§ùiÚ
()

293 
	`nÚcÚ¡_acûss
();

294 
	}
}

297 
	gCÚ¡D©aba£W¿µ”
::
	$ÿnûl_Œª§ùiÚ
()

299 
	`nÚcÚ¡_acûss
();

300 
	}
}

302 
	gX­Ÿn
::
docid


303 
CÚ¡D©aba£W¿µ”
::
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 &)

305 
nÚcÚ¡_acûss
();

309 
	gCÚ¡D©aba£W¿µ”
::
d–‘e_docum’t
(
X­Ÿn
::
docid
)

311 
nÚcÚ¡_acûss
();

315 
	gCÚ¡D©aba£W¿µ”
::
	$d–‘e_docum’t
(cÚ¡ 
¡ršg
 &)

317 
	`nÚcÚ¡_acûss
();

318 
	}
}

321 
	gCÚ¡D©aba£W¿µ”
::
»¶aû_docum’t
(
X­Ÿn
::
docid
, cÚ¡ X­Ÿn::
Docum’t
 &)

323 
nÚcÚ¡_acûss
();

326 
	gX­Ÿn
::
docid


327 
CÚ¡D©aba£W¿µ”
::
»¶aû_docum’t
(cÚ¡ 
¡ršg
 &,

328 cÚ¡ 
X­Ÿn
::
Docum’t
 &)

330 
nÚcÚ¡_acûss
();

334 
	gCÚ¡D©aba£W¿µ”
::
wr™e_chªge£ts_to_fd
(, cÚ¡ 
¡d
::
¡ršg
 &, 
boŞ
,

335 
X­Ÿn
::
R•liÿtiÚInfo
 *)

337 
nÚcÚ¡_acûss
();

340 
RemÙeD©aba£
 *

341 
	gCÚ¡D©aba£W¿µ”
::
	$as_»mÙed©aba£
()

343 
	`nÚcÚ¡_acûss
();

344 
	}
}

	@common/const_database_wrapper.h

23 #iâdeà
XAPIAN_INCLUDED_CONST_DATABASE_WRAPPER_H


24 
	#XAPIAN_INCLUDED_CONST_DATABASE_WRAPPER_H


	)

26 
	~"x­Ÿn/ba£.h
"

27 
	~"d©aba£.h
"

28 
	~"nÜ‘uº.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

34 şas 
	cCÚ¡D©aba£W¿µ”
 : 
public
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 {

36 
CÚ¡D©aba£W¿µ”
(const ConstDatabaseWrapper &);

39 
	mİ”©Ü
=(cÚ¡ 
CÚ¡D©aba£W¿µ”
 &);

42 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
»®db
;

45 
XAPIAN_NORETURN
(
	$nÚcÚ¡_acûss
() const);

47 
public
:

48 
	`CÚ¡D©aba£W¿µ”
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
»®db_
);

51 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

52 
X­Ÿn
::
docid
 
	$g‘_Ï¡docid
() const;

53 
tÙËn_t
 
	$g‘_tÙ®_Ëngth
() const;

54 
X­Ÿn
::
doş’gth
 
	$g‘_avËngth
() const;

55 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

56 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

57 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

58 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
v®no
) const;

59 
¡d
::
¡ršg
 
	`g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

60 
¡d
::
¡ršg
 
	`g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

61 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

62 
boŞ
 
	$has_pos™iÚs
() const;

63 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

64 
V®ueLi¡
 * 
	`İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

65 
T”mLi¡
 * 
	`İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const;

66 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

67 
Pos™iÚLi¡
 * 
	`İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
,

68 cÚ¡ 
¡ršg
 & 
Šame
) const;

69 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 *

70 
	`İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const;

71 
T”mLi¡
 * 
	$İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

72 
T”mLi¡
 * 
	$İ’_¥–lšg_wÜdli¡
() const;

73 
X­Ÿn
::
doccouÁ
 
	$g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

74 
T”mLi¡
 * 
	$İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

75 
T”mLi¡
 * 
	$İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const;

76 
¡ršg
 
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const;

77 
T”mLi¡
 * 
	`İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const;

78 
	`»que¡_docum’t
(
X­Ÿn
::
docid
 
did
) const;

79 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`cŞËù_docum’t
(X­Ÿn::
docid
 
did
) const;

80 
¡ršg
 
	$g‘_»visiÚ_šfo
() const;

81 
¡ršg
 
	$g‘_uuid
() const;

82 
	`šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const;

85 
	`add_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const;

86 
	`»move_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
, 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const;

87 
	$add_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
) const;

88 
	$»move_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
) const;

89 
	$ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

90 
	`£t_m‘ad©a
(cÚ¡ 
¡ršg
 &, const string &);

91 
	`»İ’
();

92 
	`şo£
();

93 
	`comm™
();

94 
	`ÿnûl
();

95 
	`begš_Œª§ùiÚ
(
boŞ
);

96 
	`comm™_Œª§ùiÚ
();

97 
	`ÿnûl_Œª§ùiÚ
();

98 
X­Ÿn
::
docid
 
	`add_docum’t
(cÚ¡ X­Ÿn::
Docum’t
 &);

99 
	`d–‘e_docum’t
(
X­Ÿn
::
docid
);

100 
	`d–‘e_docum’t
(cÚ¡ 
¡ršg
 &);

101 
	`»¶aû_docum’t
(
X­Ÿn
::
docid
, cÚ¡ X­Ÿn::
Docum’t
 &);

102 
X­Ÿn
::
docid
 
	`»¶aû_docum’t
(cÚ¡ 
¡ršg
 &, cÚ¡ X­Ÿn::
Docum’t
 &);

103 
	`wr™e_chªge£ts_to_fd
(, cÚ¡ 
¡d
::
¡ršg
 &, 
boŞ
,

104 
X­Ÿn
::
R•liÿtiÚInfo
 *);

105 
RemÙeD©aba£
 * 
	`as_»mÙed©aba£
();

	@common/contiguousalldocspostlist.h

22 #iâdeà
XAPIAN_INCLUDED_FLINT_CONTIGUOUSALLDOCSPOSTLIST_H


23 
	#XAPIAN_INCLUDED_FLINT_CONTIGUOUSALLDOCSPOSTLIST_H


	)

25 
	~<¡ršg
>

27 
	~"d©aba£.h
"

28 
	~"Ëaåo¡li¡.h
"

31 şas 
	cCÚtiguousAÎDocsPo¡Li¡
 : 
public
 
L—fPo¡Li¡
 {

33 
İ”©Ü
=(cÚ¡ 
CÚtiguousAÎDocsPo¡Li¡
 &);

36 
CÚtiguousAÎDocsPo¡Li¡
(const ContiguousAllDocsPostList &);

39 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
X­Ÿn
::
D©aba£
::IÁ”Çl> 
db
;

42 
	mX­Ÿn
::
docid
 
did
;

45 
	mX­Ÿn
::
doccouÁ
 doccount;

47 
	mpublic
:

49 
CÚtiguousAÎDocsPo¡Li¡
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
db_
,

50 
X­Ÿn
::
doccouÁ
 
doccouÁ_
)

51 : 
L—fPo¡Li¡
(
¡d
::
¡ršg
()),

52 
db
(
db_
), 
did
(0), 
	$doccouÁ
(
doccouÁ_
) { }

59 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

62 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

65 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

68 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

71 
Pos™iÚLi¡
 *
	`»ad_pos™iÚ_li¡
();

74 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

77 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

80 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
 
rg‘
, X­Ÿn::
weight
 
w_mš
);

83 
boŞ
 
	$©_’d
() const;

86 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

87 
	}
};

	@common/database.h

24 #iâdeà
OM_HGUARD_DATABASE_H


25 
	#OM_HGUARD_DATABASE_H


	)

27 
	~<¡ršg
>

29 
	~"š‹º®ty³s.h
"

31 
	~<x­Ÿn/ba£.h
>

32 
	~<x­Ÿn/ty³s.h
>

33 
	~<x­Ÿn/d©aba£.h
>

34 
	~<x­Ÿn/docum’t.h
>

35 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

36 
	~<x­Ÿn/‹rm™”©Ü.h
>

37 
	~<x­Ÿn/v®ue™”©Ü.h
>

38 
	~"omdebug.h
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
şass
 
	gL—fPo¡Li¡
;

43 
şass
 
	gRemÙeD©aba£
;

45 
	gX­Ÿn
::
	tT”mI‹¿tÜ
::
	tIÁ”Çl
 
	tT”mLi¡
;

46 
	gX­Ÿn
::
	tPos™iÚI‹¿tÜ
::
	tIÁ”Çl
 
	tPos™iÚLi¡
;

47 
	gX­Ÿn
::
	tV®ueI‹¿tÜ
::
	tIÁ”Çl
 
	tV®ueLi¡
;

50 cÚ¡ 
	gXAPIAN_DB_READONLY
 = 0;

52 
Çme¥aû
 
	gX­Ÿn
 {

54 
	gR•liÿtiÚInfo
;

58 şas 
	cD©aba£
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

59 
´iv©e
:

61 
IÁ”Çl
(const Internal &);

64 
	gİ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

66 
	g´Ùeùed
:

69 
TRANSACTION_UNIMPLEMENTED
 = -1,

70 
	gTRANSACTION_NONE
 = 0,

71 
	gTRANSACTION_UNFLUSHED
 = 1,

72 
	gTRANSACTION_FLUSHED
 = 2

73 } 
	gŒª§ùiÚ_¡©e
;

75 
boŞ
 
Œª§ùiÚ_aùive
(ècÚ¡ {  (
	gŒª§ùiÚ_¡©e
) > 0; }

78 
IÁ”Çl
(è: 
Œª§ùiÚ_¡©e
(
TRANSACTION_NONE
) { }

90 
dtÜ_ÿÎed
();

92 
	gpublic
:

104 
vœtu®
 ~
IÁ”Çl
();

109 
vœtu®
 
k“p_®ive
();

117 
vœtu®
 
	gX­Ÿn
::
doccouÁ
 
g‘_doccouÁ
() const = 0;

121 
vœtu®
 
	gX­Ÿn
::
docid
 
g‘_Ï¡docid
() const = 0;

124 
vœtu®
 
tÙËn_t
 
g‘_tÙ®_Ëngth
() const = 0;

131 
vœtu®
 
	gX­Ÿn
::
doş’gth
 
g‘_avËngth
() const = 0;

143 
vœtu®
 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const = 0;

152 
vœtu®
 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const = 0;

162 
vœtu®
 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const = 0;

174 
vœtu®
 
	gX­Ÿn
::
doccouÁ
 
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const;

183 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

192 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

195 
vœtu®
 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth_low”_bound
() const;

198 
vœtu®
 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth_uµ”_bound
() const;

201 
vœtu®
 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_wdf_uµ”_bound
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

207 
vœtu®
 
boŞ
 
‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const = 0;

211 
vœtu®
 
boŞ
 
has_pos™iÚs
() const = 0;

231 
vœtu®
 
L—fPo¡Li¡
 * 
İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const = 0;

242 
vœtu®
 
V®ueLi¡
 * 
İ’_v®ue_li¡
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

254 
vœtu®
 
T”mLi¡
 * 
İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const = 0;

265 
vœtu®
 
T”mLi¡
 * 
İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const = 0;

278 
vœtu®
 
Pos™iÚLi¡
 * 
İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
,

279 cÚ¡ 
¡ršg
 & 
Šame
) const = 0;

296 
vœtu®
 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 *

297 
İ’_docum’t
(
X­Ÿn
::
docid
 
did
, 
boŞ
 
Ïzy
) const = 0;

305 
vœtu®
 
T”mLi¡
 * 
İ’_¥–lšg_‹rmli¡
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

312 
vœtu®
 
T”mLi¡
 * 
İ’_¥–lšg_wÜdli¡
() const;

315 
vœtu®
 
	gX­Ÿn
::
doccouÁ
 
g‘_¥–lšg_äequ’cy
(cÚ¡ 
¡ršg
 & 
wÜd
) const;

324 
vœtu®
 
add_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
,

325 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
) const;

335 
vœtu®
 
»move_¥–lšg
(cÚ¡ 
¡ršg
 & 
wÜd
,

336 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
) const;

342 
vœtu®
 
T”mLi¡
 * 
İ’_synÚym_‹rmli¡
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

349 
vœtu®
 
T”mLi¡
 * 
İ’_synÚym_keyli¡
(cÚ¡ 
¡ršg
 & 
´efix
) const;

356 
vœtu®
 
add_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
) const;

362 
vœtu®
 
»move_synÚym
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
synÚym
) const;

368 
vœtu®
 
ş—r_synÚyms
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

374 
vœtu®
 
¡ršg
 
g‘_m‘ad©a
(cÚ¡ sŒšg & 
key
) const;

384 
vœtu®
 
T”mLi¡
 * 
İ’_m‘ad©a_keyli¡
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
) const;

390 
vœtu®
 
£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
);

397 
vœtu®
 
»İ’
();

401 
vœtu®
 
şo£
() = 0;

411 
vœtu®
 
comm™
();

414 
vœtu®
 
ÿnûl
();

420 
begš_Œª§ùiÚ
(
boŞ
 
æushed
);

426 
comm™_Œª§ùiÚ
();

432 
ÿnûl_Œª§ùiÚ
();

438 
vœtu®
 
	gX­Ÿn
::
docid
 
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
);

444 
vœtu®
 
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
);

450 
vœtu®
 
d–‘e_docum’t
(cÚ¡ 
¡ršg
 & 
unique_‹rm
);

456 
vœtu®
 
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

457 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
);

463 
vœtu®
 
	gX­Ÿn
::
docid
 
»¶aû_docum’t
(cÚ¡ 
¡ršg
 & 
unique_‹rm
,

464 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
);

476 
vœtu®
 
»que¡_docum’t
(
X­Ÿn
::
docid
 ) const;

478 
vœtu®
 
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
cŞËù_docum’t
(
X­Ÿn
::
docid
 
did
) const;

486 
vœtu®
 
wr™e_chªge£ts_to_fd
(
fd
,

487 cÚ¡ 
¡d
::
¡ršg
 & 
¡¬t_»visiÚ
,

488 
boŞ
 
Ãed_whŞe_db
,

489 
X­Ÿn
::
R•liÿtiÚInfo
 * 
šfo
);

492 
vœtu®
 
¡ršg
 
g‘_»visiÚ_šfo
() const;

504 
vœtu®
 
¡ršg
 
g‘_uuid
() const;

513 
vœtu®
 
šv®id©e_doc_objeù
(
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
obj
) const;

525 
vœtu®
 
RemÙeD©aba£
 * 
as_»mÙed©aba£
();

	@common/databasereplicator.h

23 #iâdeà
XAPIAN_INCLUDED_DATABASEREPLICATOR_H


24 
	#XAPIAN_INCLUDED_DATABASEREPLICATOR_H


	)

26 
	~<¡ršg
>

28 
	~"x­Ÿn/ba£.h
"

29 
	~"x­Ÿn/ty³s.h
"

31 
şass
 
	gRemÙeCÚÃùiÚ
;

32 
şass
 
	gOmTime
;

34 
Çme¥aû
 
	gX­Ÿn
 {

40 şas 
	cD©aba£R•liÿtÜ
 {

41 
	g´iv©e
:

43 
D©aba£R•liÿtÜ
(const DatabaseReplicator &);

46 
	gİ”©Ü
=(cÚ¡ 
D©aba£R•liÿtÜ
 &);

48 
	g´Ùeùed
:

52 
D©aba£R•liÿtÜ
() { }

54 
public
:

57 
vœtu®
 ~
D©aba£R•liÿtÜ
();

63 
D©aba£R•liÿtÜ
 * 
İ’
(cÚ¡ 
¡d
::
¡ršg
 & 
·th
);

70 
vœtu®
 
boŞ
 
check_»visiÚ_©_Ëa¡
(cÚ¡ 
¡d
::
¡ršg
 & 
»v
,

71 cÚ¡ 
¡d
::
¡ršg
 & 
rg‘
) const = 0;

83 
vœtu®
 
	g¡d
::
¡ršg
 
­¶y_chªge£t_äom_cÚn
(
RemÙeCÚÃùiÚ
 & 
cÚn
,

84 cÚ¡ 
OmTime
 & 
’d_time
,

85 
boŞ
 
db_v®id
) const = 0;

93 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_uuid
() const = 0;

	@common/debuglog.cc

21 
	~<cÚfig.h
>

23 #ifdeà
XAPIAN_DEBUG_LOG


25 
	~"debuglog.h
"

27 
	~"¡r.h
"

29 
	~<sys/ty³s.h
>

30 
	~<sys/¡©.h
>

31 
	~"§ã”ºo.h
"

32 
	~"§ãfú.h
"

33 
	~"§ãuni¡d.h
"

35 
	~<c¡dlib
>

36 
	~<c¡ršg
>

37 
	~<¡ršg
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
DebugLogg”
 
	gx­Ÿn_debuglogg”__
;

46 #iâdeà
O_SYNC


47 
	#O_SYNC
 0

	)

50 
	gDebugLogg”
::~
	$DebugLogg”
()

52 
	`LOGLINE
(
ALWAYS
, 
PACKAGE_STRING
": debug†ogƒnded");

53 
	}
}

56 
	gDebugLogg”
::
	$š™Ÿli£_ÿ‹gÜ›s_mask
()

58 
fd
 = -2;

59 cÚ¡ * 
f
 = 
	`g‘’v
("XAPIAN_DEBUG_LOG");

60 ià(
f
 && *f) {

61 ià(
f
[0] == '-' && f[1] == '\0') {

63 
fd
 = 2;

65 
¡ršg
 
âm
, 
pid
;

66 *
f
) {

67 ià(*
f
 == '%' && f[1] == 'p') {

69 ià(
pid
.
	`em±y
()èpid = 
	`¡r
(
	`g‘pid
());

70 
âm
 +ğ
pid
;

71 
f
 += 2;

73 
âm
 +ğ*
f
++;

77 
fd
 = 
	`İ’
(
âm
.
	`c_¡r
(), 
O_CREAT
|
O_WRONLY
|
O_SYNC
|
O_APPEND
, 0644);

78 ià(
fd
 == -1) {

83 
fd
 = 2;

84 
	`LOGLINE
(
ALWAYS
, 
PACKAGE_STRING
": Failedo open debug†og '"

85 << 
âm
 << "' (" << 
	`¡»¼Ü
(
”ºo
) << ')');

86 
fd
 = -2;

90 ià(
fd
 >= 0) {

91 cÚ¡ * 
v
 = 
	`g‘’v
("XAPIAN_DEBUG_FLAGS");

92 ià(
v
) {

93 
boŞ
 
toggË
 = (*
v
 == '-');

94 ià(
toggË
è++
v
;

95 
ÿ‹gÜ›s_mask
 = 0;

96 *
v
) {

97 
ch
 = *
v
++ - '@';

98 ià(
ch
 > 0 && ch <ğ26è
ÿ‹gÜ›s_mask
 |= 1ul << ch;

100 ià(
toggË
è
ÿ‹gÜ›s_mask
 ^= 0xffffffff;

104 
	`LOGLINE
(
ALWAYS
, 
PACKAGE_STRING
": debug†og started");

105 
	}
}

108 
	gDebugLogg”
::
	$log_lše
(
debuglog_ÿ‹gÜ›s
 
ÿ‹gÜy
, cÚ¡ 
¡ršg
 & 
msg
)

110 ià(
fd
 < 0) ;

112 
¡ršg
 
lše
;

113 
lše
.
	`»£rve
(8 + 
šd’t_¡ršg
.
	`size
(è+ 
msg
.size());

114 
lše
 = (
ÿ‹gÜy
) + '@';

115 
lše
 += ' ';

116 
lše
 +ğ
	`¡r
(
	`g‘pid
());

117 
lše
 +ğ
šd’t_¡ršg
;

118 
lše
 +ğ
msg
;

119 
lše
 += '\n';

121 cÚ¡ * 
p
 = 
lše
.
	`d©a
();

122 
size_t
 
to_do
 = 
lše
.
	`size
();

123 
to_do
) {

124 
ssize_t
 
n
 = 
	`wr™e
(
fd
, 
p
, 
to_do
);

125 ià(
n
 < 0) {

127 ià(
”ºo
 =ğ
EINTR
) ;

131 ()
	`şo£
(
fd
);

132 
fd
 = 2;

133 
	`LOGLINE
(
ALWAYS
, 
PACKAGE_STRING
": Failedo write†og output ("

134 << 
	`¡»¼Ü
(
”ºo
) << ')');

135 
fd
 = -2;

138 
p
 +ğ
n
;

139 
to_do
 -ğ
n
;

141 
	}
}

	@common/debuglog.h

21 #iâdeà
XAPIAN_INCLUDED_DEBUGLOG_H


22 
	#XAPIAN_INCLUDED_DEBUGLOG_H


	)

24 #ifdeà
XAPIAN_DEBUG_LOG


26 
	~"ouut.h
"

28 
	~<s¡»am
>

31 
	edebuglog_ÿ‹gÜ›s
 {

33 
	mDEBUGLOG_CATEGORY_NEVER
 = 0,

36 
	mDEBUGLOG_CATEGORY_API
 = ('A' - '@'),

39 
	mDEBUGLOG_CATEGORY_APICALL
 = ('C' - '@'),

42 
	mDEBUGLOG_CATEGORY_DB
 = ('D' - '@'),

45 
	mDEBUGLOG_CATEGORY_EXCEPTION
 = ('X' - '@'),

48 
	mDEBUGLOG_CATEGORY_EXPAND
 = ('E' - '@'),

51 
	mDEBUGLOG_CATEGORY_MATCH
 = ('M' - '@'),

54 
	mDEBUGLOG_CATEGORY_QUERYPARSER
 = ('Q' - '@'),

57 
	mDEBUGLOG_CATEGORY_REMOTE
 = ('R' - '@'),

60 
	mDEBUGLOG_CATEGORY_SPELLING
 = ('S' - '@'),

63 
	mDEBUGLOG_CATEGORY_UNKNOWN
 = ('U' - '@'),

66 
	mDEBUGLOG_CATEGORY_WTCALC
 = ('W' - '@'),

69 
	mDEBUGLOG_CATEGORY_ALWAYS
 = 31

75 şas 
	cDebugLogg”
 {

77 
	mİ”©Ü
=(cÚ¡ 
DebugLogg”
 &);

80 
DebugLogg”
(const DebugLogger &);

83 
	mÿ‹gÜ›s_mask
;

86 
	mfd
;

89 
	m¡d
::
¡ršg
 
šd’t_¡ršg
;

92 
š™Ÿli£_ÿ‹gÜ›s_mask
();

94 
	mpublic
:

96 
	$DebugLogg”
()

97 : 
	`ÿ‹gÜ›s_mask
(1 << 
DEBUGLOG_CATEGORY_APICALL
), 
	`fd
(-1),

98 
	`šd’t_¡ršg
(" ")

102 ~
	`DebugLogg”
();

105 
boŞ
 
	$is_ÿ‹gÜy_wª‹d
(
debuglog_ÿ‹gÜ›s
 
ÿ‹gÜy
) {

109 ià(
ÿ‹gÜy
 =ğ
DEBUGLOG_CATEGORY_ALWAYS
è 
Œue
;

110 ià(
ÿ‹gÜy
 =ğ
DEBUGLOG_CATEGORY_NEVER
è 
çl£
;

111 ià(
fd
 =ğ-1è
	`š™Ÿli£_ÿ‹gÜ›s_mask
();

112  (
ÿ‹gÜ›s_mask
 >> 
ÿ‹gÜy
) & 1;

113 
	}
}

116 
log_lše
(
debuglog_ÿ‹gÜ›s
 
ÿ‹gÜy
, cÚ¡ 
¡d
::
¡ršg
 & 
msg
);

118 
	$šd’t
(è{ 
šd’t_¡ršg
 +ğ' '; 
	}
}

120 
	$outd’t
() {

121 ià(
šd’t_¡ršg
.
	`size
() > 1) {

122 
šd’t_¡ršg
.
	`»size
(šd’t_¡ršg.
	`size
() - 1);

124 
	}
}

127 
Çme¥aû
 
	gX­Ÿn
 {

133 ’um { 
	gNO_ARGS
 } 
	tNoArgum’ts_
;

136 
šlše
 
	g¡d
::
o¡»am
 & 
İ”©Ü
<<(
¡d
::o¡»am &
o
, 
	gX­Ÿn
::
NoArgum’ts_
) {

137  
o
;

140 
usšg
 
	gX­Ÿn
::
NO_ARGS
;

142 
DebugLogg”
 
x­Ÿn_debuglogg”__
;

146 
	#LOGLINE_
(
CATEGORY
, 
MSG
) do { \

147 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
CATEGORY
)) { \

148 
¡d
::
o¡ršg¡»am
 
x­Ÿn_debuglog_¡»am_
; \

149 
x­Ÿn_debuglog_¡»am_
 << 
¡d
::
boŞ®pha
 << 
MSG
; \

150 
x­Ÿn_debuglogg”__
.
	`log_lše
(
CATEGORY
, 
x­Ÿn_debuglog_¡»am_
.
	`¡r
()); \

152 } 
çl£
)

	)

163 şas 
	cDebugLogFunc
 {

165 cÚ¡ * 
	mthis_±r
;

168 
debuglog_ÿ‹gÜ›s
 
	mÿ‹gÜy
;

171 
	m¡d
::
¡ršg
 
func
;

174 
boŞ
 
	munÿught_exû±iÚ
;

176 
	mpublic
:

178 
DebugLogFunc
(cÚ¡ * 
this_±r_
, 
debuglog_ÿ‹gÜ›s
 
ÿ‹gÜy_
,

179 cÚ¡ * 
»tuº_ty³
, cÚ¡ * 
func_Çme
,

180 cÚ¡ 
¡d
::
¡ršg
 & 
·¿ms
)

181 : 
this_±r
(
this_±r_
), 
ÿ‹gÜy
(
ÿ‹gÜy_
),

182 
unÿught_exû±iÚ
(
¡d
::
	$unÿught_exû±iÚ
())

184 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
ÿ‹gÜy
)) {

185 
func
.
	`assign
(
»tuº_ty³
);

186 
func
 += ' ';

187 
func
 +ğ
func_Çme
;

188 
func
 += '(';

189 
func
 +ğ
·¿ms
;

190 
func
 += ')';

191 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
);

192 
x­Ÿn_debuglogg”__
.
	`šd’t
();

197 
	`log_»tuº_v®ue
(cÚ¡ 
¡d
::
¡ršg
 & 
»tuº_v®ue
) {

198 ià(!
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
ÿ‹gÜy
)) ;

199 
x­Ÿn_debuglogg”__
.
	`outd’t
();

200 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
 << "„eturned: " <<

201 
»tuº_v®ue
);

204 
ÿ‹gÜy
 = 
DEBUGLOG_CATEGORY_NEVER
;

205 
	}
}

212 ~
	$DebugLogFunc
() {

213 ià(!
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
ÿ‹gÜy
)) ;

214 
x­Ÿn_debuglogg”__
.
	`outd’t
();

215 ià(!
unÿught_exû±iÚ
 && 
¡d
::
	`unÿught_exû±iÚ
()) {

217 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
 <<

220 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
 <<

223 
	}
}

235 şas 
	cDebugLogFuncVoid
 {

237 cÚ¡ * 
	mthis_±r
;

240 
debuglog_ÿ‹gÜ›s
 
	mÿ‹gÜy
;

243 
	m¡d
::
¡ršg
 
func
;

246 
boŞ
 
	munÿught_exû±iÚ
;

248 
	mpublic
:

250 
DebugLogFuncVoid
(cÚ¡ * 
this_±r_
, 
debuglog_ÿ‹gÜ›s
 
ÿ‹gÜy_
,

251 cÚ¡ * 
func_Çme
,

252 cÚ¡ 
¡d
::
¡ršg
 & 
·¿ms
)

253 : 
this_±r
(
this_±r_
), 
ÿ‹gÜy
(
ÿ‹gÜy_
),

254 
unÿught_exû±iÚ
(
¡d
::
	$unÿught_exû±iÚ
())

256 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
ÿ‹gÜy
)) {

257 
func
.
	`assign
("void ");

258 
func
 +ğ
func_Çme
;

259 
func
 += '(';

260 
func
 +ğ
·¿ms
;

261 
func
 += ')';

262 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
);

263 
x­Ÿn_debuglogg”__
.
	`šd’t
();

268 
	`DebugLogFuncVoid
(cÚ¡ * 
this_±r_
, 
debuglog_ÿ‹gÜ›s
 
ÿ‹gÜy_
,

269 cÚ¡ 
¡d
::
¡ršg
 & 
·¿ms
,

270 cÚ¡ * 
şass_Çme
)

271 : 
	`this_±r
(
this_±r_
), 
	`ÿ‹gÜy
(
ÿ‹gÜy_
),

272 
	`unÿught_exû±iÚ
(
¡d
::
	$unÿught_exû±iÚ
())

274 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
ÿ‹gÜy
)) {

275 
func
.
	`assign
(
şass_Çme
);

276 
func
 += "::";

277 
func
 +ğ
şass_Çme
;

278 
func
 += '(';

279 
func
 +ğ
·¿ms
;

280 
func
 += ')';

281 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
);

282 
x­Ÿn_debuglogg”__
.
	`šd’t
();

284 
	}
}

287 
	$DebugLogFuncVoid
(cÚ¡ * 
this_±r_
, 
debuglog_ÿ‹gÜ›s
 
ÿ‹gÜy_
,

288 cÚ¡ * 
şass_Çme
)

289 : 
	`this_±r
(
this_±r_
), 
	`ÿ‹gÜy
(
ÿ‹gÜy_
),

290 
	`unÿught_exû±iÚ
(
¡d
::
	$unÿught_exû±iÚ
())

292 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
ÿ‹gÜy
)) {

293 
func
.
	`assign
(
şass_Çme
);

294 
func
 += "::~";

295 
func
 +ğ
şass_Çme
;

296 
func
 += "()";

297 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
);

298 
x­Ÿn_debuglogg”__
.
	`šd’t
();

300 
	}
}

304 
	$log_»tuº_void
() {

305 ià(!
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
ÿ‹gÜy
)) ;

306 
x­Ÿn_debuglogg”__
.
	`outd’t
();

307 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
 << "„eturned");

310 
ÿ‹gÜy
 = 
DEBUGLOG_CATEGORY_NEVER
;

311 
	}
}

319 ~
	$DebugLogFuncVoid
() {

320 ià(!
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
ÿ‹gÜy
)) ;

321 
x­Ÿn_debuglogg”__
.
	`outd’t
();

322 ià(!
unÿught_exû±iÚ
 && 
¡d
::
	`unÿught_exû±iÚ
()) {

324 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
 <<

327 
	`LOGLINE_
(
ÿ‹gÜy
, '[' << 
this_±r
 << "] " << 
func
 << "„eturned");

329 
	}
}

333 
	#LOGCALL
(
CATEGORY
, 
TYPE
, 
FUNC
, 
PARAMS
) \

334 
TYPE
 
	tx­Ÿn_logÿÎ_»tuº_ty³_
; \

335 
¡d
::
¡ršg
 
x­Ÿn_logÿÎ_·¿m‘”s_
; \

336 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
DEBUGLOG_CATEGORY_
##
CATEGORY
)) { \

337 
¡d
::
o¡ršg¡»am
 
x­Ÿn_logÿÎ_¡»am_
; \

338 
x­Ÿn_logÿÎ_¡»am_
 << 
¡d
::
boŞ®pha
 << 
PARAMS
; \

339 
x­Ÿn_logÿÎ_·¿m‘”s_
 = 
x­Ÿn_logÿÎ_¡»am_
.
	`¡r
(); \

341 
DebugLogFunc
 
	`x­Ÿn_logÿÎ_
(
¡©ic_ÿ¡
<cÚ¡ *>(
this
), 
DEBUGLOG_CATEGORY_
##
CATEGORY
, #TYPE, 
FUNC
, 
x­Ÿn_logÿÎ_·¿m‘”s_
)

	)

344 
	#LOGCALL_VOID
(
CATEGORY
, 
FUNC
, 
PARAMS
) \

345 
¡d
::
¡ršg
 
x­Ÿn_logÿÎ_·¿m‘”s_
; \

346 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
DEBUGLOG_CATEGORY_
##
CATEGORY
)) { \

347 
¡d
::
o¡ršg¡»am
 
x­Ÿn_logÿÎ_¡»am_
; \

348 
x­Ÿn_logÿÎ_¡»am_
 << 
¡d
::
boŞ®pha
 << 
PARAMS
; \

349 
x­Ÿn_logÿÎ_·¿m‘”s_
 = 
x­Ÿn_logÿÎ_¡»am_
.
	`¡r
(); \

351 
DebugLogFuncVoid
 
	`x­Ÿn_logÿÎ_
(
¡©ic_ÿ¡
<cÚ¡ *>(
this
), 
DEBUGLOG_CATEGORY_
##
CATEGORY
, 
FUNC
, 
x­Ÿn_logÿÎ_·¿m‘”s_
)

	)

354 
	#LOGCALL_CTOR
(
CATEGORY
, 
CLASS
, 
PARAMS
) \

355 
¡d
::
¡ršg
 
x­Ÿn_logÿÎ_·¿m‘”s_
; \

356 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
DEBUGLOG_CATEGORY_
##
CATEGORY
)) { \

357 
¡d
::
o¡ršg¡»am
 
x­Ÿn_logÿÎ_¡»am_
; \

358 
x­Ÿn_logÿÎ_¡»am_
 << 
¡d
::
boŞ®pha
 << 
PARAMS
; \

359 
x­Ÿn_logÿÎ_·¿m‘”s_
 = 
x­Ÿn_logÿÎ_¡»am_
.
	`¡r
(); \

361 
DebugLogFuncVoid
 
	`x­Ÿn_logÿÎ_
(
¡©ic_ÿ¡
<cÚ¡ *>(
this
), 
DEBUGLOG_CATEGORY_
##
CATEGORY
, 
x­Ÿn_logÿÎ_·¿m‘”s_
, 
CLASS
)

	)

364 
	#LOGCALL_DTOR
(
CATEGORY
, 
CLASS
) \

365 
DebugLogFuncVoid
 
	`x­Ÿn_logÿÎ_
(
¡©ic_ÿ¡
<cÚ¡ *>(
this
), 
DEBUGLOG_CATEGORY_
##
CATEGORY
, 
CLASS
)

	)

368 
	#LOGCALL_STATIC
(
CATEGORY
, 
TYPE
, 
FUNC
, 
PARAMS
) \

369 
TYPE
 
	tx­Ÿn_logÿÎ_»tuº_ty³_
; \

370 
¡d
::
¡ršg
 
x­Ÿn_logÿÎ_·¿m‘”s_
; \

371 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
DEBUGLOG_CATEGORY_
##
CATEGORY
)) { \

372 
¡d
::
o¡ršg¡»am
 
x­Ÿn_logÿÎ_¡»am_
; \

373 
x­Ÿn_logÿÎ_¡»am_
 << 
¡d
::
boŞ®pha
 << 
PARAMS
; \

374 
x­Ÿn_logÿÎ_·¿m‘”s_
 = 
x­Ÿn_logÿÎ_¡»am_
.
	`¡r
(); \

376 
DebugLogFunc
 
	`x­Ÿn_logÿÎ_
(0, 
DEBUGLOG_CATEGORY_
##
CATEGORY
, #TYPE, 
FUNC
, 
x­Ÿn_logÿÎ_·¿m‘”s_
)

	)

379 
	#LOGCALL_STATIC_VOID
(
CATEGORY
, 
FUNC
, 
PARAMS
) \

380 
¡d
::
¡ršg
 
x­Ÿn_logÿÎ_·¿m‘”s_
; \

381 ià(
x­Ÿn_debuglogg”__
.
	`is_ÿ‹gÜy_wª‹d
(
DEBUGLOG_CATEGORY_
##
CATEGORY
)) { \

382 
¡d
::
o¡ršg¡»am
 
x­Ÿn_logÿÎ_¡»am_
; \

383 
x­Ÿn_logÿÎ_¡»am_
 << 
¡d
::
boŞ®pha
 << 
PARAMS
; \

384 
x­Ÿn_logÿÎ_·¿m‘”s_
 = 
x­Ÿn_logÿÎ_¡»am_
.
	`¡r
(); \

386 
DebugLogFuncVoid
 
	`x­Ÿn_logÿÎ_
(0, 
DEBUGLOG_CATEGORY_
##
CATEGORY
, 
FUNC
, 
x­Ÿn_logÿÎ_·¿m‘”s_
)

	)

389 
	#RETURN
(
A
) do { \

390 
x­Ÿn_logÿÎ_»tuº_ty³_
 
x­Ÿn_logÿÎ_»tuº_
 = 
A
; \

391 
¡d
::
o¡ršg¡»am
 
x­Ÿn_logÿÎ_¡»am_
; \

392 
x­Ÿn_logÿÎ_¡»am_
 << 
¡d
::
boŞ®pha
 << 
x­Ÿn_logÿÎ_»tuº_
; \

393 
x­Ÿn_logÿÎ_
.
	`log_»tuº_v®ue
(
x­Ÿn_logÿÎ_¡»am_
.
	`¡r
()); \

394  
x­Ÿn_logÿÎ_»tuº_
; \

395 } 
çl£
)

	)

402 
	#RETURN_VOID
 do { \

403 
x­Ÿn_logÿÎ_
.
	`log_»tuº_void
(); \

405 } 
çl£
)

	)

413 
	#LOGLINE
(
a
,
b
è
	`LOGLINE_
(
DEBUGLOG_CATEGORY_
##a, b)

	)

416 
	#LOGVALUE
(
a
,
b
è
	`LOGLINE_
(
DEBUGLOG_CATEGORY_
##a, #b" = " << b)

	)

420 
	#LOGCALL
(
CATEGORY
, 
TYPE
, 
FUNC
, 
PARAMS
è()0

	)

421 
	#LOGCALL_VOID
(
CATEGORY
, 
FUNC
, 
PARAMS
è()0

	)

422 
	#LOGCALL_CTOR
(
CATEGORY
, 
CLASS
, 
PARAMS
è()0

	)

423 
	#LOGCALL_DTOR
(
CATEGORY
, 
CLASS
è()0

	)

424 
	#LOGCALL_STATIC
(
CATEGORY
, 
TYPE
, 
FUNC
, 
PARAMS
è()0

	)

425 
	#LOGCALL_STATIC_VOID
(
CATEGORY
, 
FUNC
, 
PARAMS
è()0

	)

426 
	#RETURN
(
A
è 
	)
A

428 
	#RETURN_VOID
 

	)

430 
	#LOGLINE
(
a
,
b
è()0

	)

431 
	#LOGVALUE
(
a
,
b
è()0

	)

	@common/document.h

23 #iâdeà
OM_HGUARD_DOCUMENT_H


24 
	#OM_HGUARD_DOCUMENT_H


	)

26 
	~<x­Ÿn/ba£.h
>

27 
	~<x­Ÿn/ty³s.h
>

28 
	~"‹rmli¡.h
"

29 
	~"d©aba£.h
"

30 
	~"docum’‰”m.h
"

31 
	~<m­
>

32 
	~<¡ršg
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
şass
 
	gDocum’tV®ueLi¡
;

37 
şass
 
	gV®ueSŒ—mDocum’t
;

40 şas 
	cX­Ÿn
::
Docum’t
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

41 
ä›nd
 
şass
 ::
Docum’tV®ueLi¡
;

42 
ä›nd
 
	mşass
 ::
V®ueSŒ—mDocum’t
;

43 
	mpublic
:

45 
m­
<
	tX­Ÿn
::
	tv®u’o
, 
	t¡ršg
> 
	tdocum’t_v®ues
;

48 
	mm­
<
	t¡ršg
, 
	tOmDocum’tT”m
> 
	tdocum’t_‹rms
;

50 
	m´Ùeùed
:

52 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£
;

54 
	m´iv©e
:

56 
IÁ”Çl
(const Internal &);

57 
	mIÁ”Çl
 & 
	mİ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

59 
boŞ
 
	md©a_h”e
;

60 
mubË
 
boŞ
 
	mv®ues_h”e
;

61 
mubË
 
boŞ
 
	m‹rms_h”e
;

64 
¡ršg
 
	md©a
;

67 
mubË
 
docum’t_v®ues
 
	mv®ues
;

70 
mubË
 
docum’t_‹rms
 
	m‹rms
;

72 
	m´Ùeùed
:

78 
X­Ÿn
::
docid
 
did
;

80 
	m´iv©e
:

82 
vœtu®
 
¡ršg
 
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 ) const {  string(); }

83 
vœtu®
 
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const {

84 
	gv®ues_
.
ş—r
();

86 
vœtu®
 
¡ršg
 
	$do_g‘_d©a
(ècÚ¡ {  
	`¡ršg
(); 
	}
}

88 
	gpublic
:

105 
¡ršg
 
g‘_v®ue
(
X­Ÿn
::
v®u’o
 
v®ueid
) const;

112 
£t_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) {

114 
sw­
(
v®ues
, 
v®ues_
);

115 
	gv®ues_h”e
 = 
Œue
;

118 
	gX­Ÿn
::
v®u’o
 
	$v®ues_couÁ
() const;

119 
	`add_v®ue
(
X­Ÿn
::
v®u’o
, cÚ¡ 
¡ršg
 &);

120 
	`»move_v®ue
(
X­Ÿn
::
v®u’o
);

121 
	`ş—r_v®ues
();

122 
	`add_po¡šg
(cÚ¡ 
¡ršg
 &, 
X­Ÿn
::
‹rmpos
, X­Ÿn::
‹rmcouÁ
);

123 
	`add_‹rm
(cÚ¡ 
¡ršg
 &, 
X­Ÿn
::
‹rmcouÁ
);

124 
	`»move_po¡šg
(cÚ¡ 
¡ršg
 &, 
X­Ÿn
::
‹rmpos
, X­Ÿn::
‹rmcouÁ
);

125 
	`»move_‹rm
(cÚ¡ 
¡ršg
 &);

126 
	`ş—r_‹rms
();

127 
X­Ÿn
::
‹rmcouÁ
 
	$‹rmli¡_couÁ
() const;

142 
¡ršg
 
	$g‘_d©a
() const;

144 
	`£t_d©a
(cÚ¡ 
¡ršg
 &);

154 
T”mLi¡
 * 
	$İ’_‹rm_li¡
() const;

156 
	$Ãed_v®ues
() const;

157 
	$Ãed_‹rms
() const;

161 
boŞ
 
	$d©a_modif›d
() const {

162  
d©a_h”e
;

163 
	}
}

167 
boŞ
 
	$v®ues_modif›d
() const {

168  
v®ues_h”e
;

169 
	}
}

173 
boŞ
 
	$‹rms_modif›d
() const {

174  
‹rms_h”e
;

175 
	}
}

178 
boŞ
 
	$modif›d
() const {

179  
‹rms_h”e
 || 
v®ues_h”e
 || 
d©a_h”e
;

180 
	}
}

191 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
did
; 
	}
}

194 
¡ršg
 
	$g‘_desütiÚ
() const;

201 
	`IÁ”Çl
(
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ X­Ÿn::
D©aba£
::IÁ”Çl> 
d©aba£_
,

202 
X­Ÿn
::
docid
 
did_
)

203 : 
	`d©aba£
(
d©aba£_
), 
	`d©a_h”e
(
çl£
), 
	`v®ues_h”e
(false),

204 
	`‹rms_h”e
(
çl£
), 
	$did
(
did_
è{ 
	}
}

206 
	$IÁ”Çl
()

207 : 
	`d©aba£
(0), 
	`d©a_h”e
(
çl£
), 
	`v®ues_h”e
(false),

208 
	$‹rms_h”e
(
çl£
è{ 
	}
}

215 
	gvœtu®
 ~
IÁ”Çl
();

	@common/documentterm.h

23 #iâdeà
OM_HGUARD_DOCUMENTTERM_H


24 
	#OM_HGUARD_DOCUMENTTERM_H


	)

26 
	~"omdebug.h
"

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
	~<x­Ÿn/ty³s.h
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

36 şas 
	cOmDocum’tT”m
 {

37 
	mpublic
:

43 
OmDocum’tT”m
(cÚ¡ 
¡ršg
 & 
Šame_
, 
X­Ÿn
::
‹rmcouÁ
 
wdf_
)

44 : 
Šame
(
Šame_
), 
	$wdf
(
wdf_
)

46 
	`DEBUGAPICALL
(, "OmDocumentTerm::OmDocumentTerm",

47 
Šame_
 << ", " << 
wdf_
);

52 
¡ršg
 
Šame
;

57 
X­Ÿn
::
‹rmcouÁ
 
wdf
;

59 
veùÜ
<
	tX­Ÿn
::
	t‹rmpos
> 
	t‹rm_pos™iÚs
;

74 
‹rm_pos™iÚs
 
pos™iÚs
;

86 
	`add_pos™iÚ
(
X­Ÿn
::
‹rmpos
 
os
);

97 
	`»move_pos™iÚ
(
X­Ÿn
::
‹rmpos
 
os
);

100 
	`šc_wdf
(
X­Ÿn
::
‹rmcouÁ
 
šc
è{ 
wdf
 +ğšc; 
	}
}

103 
dec_wdf
(
X­Ÿn
::
‹rmcouÁ
 
dec
) {

104 ià(
wdf
 <ğ
dec
) {

105 
wdf
 = 0;

107 
	gwdf
 -ğ
dec
;

112 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
(ècÚ¡ {  
wdf
; 
	}
}

115 
¡ršg
 
	$g‘_desütiÚ
() const;

116 
	}
};

	@common/emptypostlist.h

21 #iâdeà
XAPIAN_INCLUDED_EMPTYPOSTLIST_H


22 
	#XAPIAN_INCLUDED_EMPTYPOSTLIST_H


	)

24 
	~"po¡li¡.h
"

27 şas 
	cEm±yPo¡Li¡
 : 
public
 
Po¡Li¡
 {

29 
İ”©Ü
=(cÚ¡ 
Em±yPo¡Li¡
 &);

32 
Em±yPo¡Li¡
(const EmptyPostList &);

34 
	mpublic
:

36 
	$Em±yPo¡Li¡
() { }

38 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

39 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

40 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

42 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

43 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

44 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

45 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

46 
boŞ
 
	$©_’d
() const;

47 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

49 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

50 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
 
w_mš
);

52 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

53 
	}
};

	@common/esetinternal.h

21 #iâdeà
XAPIAN_INCLUDED_ESETINTERNAL_H


22 
	#XAPIAN_INCLUDED_ESETINTERNAL_H


	)

24 
	~"x­Ÿn/ba£.h
"

25 
	~"x­Ÿn/ty³s.h
"

26 
	~"x­Ÿn/’quœe.h
"

28 
	~<®gÜ™hm
>

29 
	~<¡ršg
>

30 
	~<veùÜ
>

32 
şass
 
	gRS‘I
;

34 
Çme¥aû
 
	gX­Ÿn
 {

35 
şass
 
	gD©aba£
;

36 
şass
 
	gEx·ndDecid”
;

38 
Çme¥aû
 
	gIÁ”Çl
 {

39 
şass
 
	gEx·ndWeight
;

42 şas 
	cEx·ndT”m
 {

43 
ä›nd
 
şass
 
	gX­Ÿn
::
ES‘I‹¿tÜ
;

44 
ä›nd
 
şass
 
	gX­Ÿn
::
ES‘
::
IÁ”Çl
;

47 
	gX­Ÿn
::
weight
 
wt
;

50 
	g¡d
::
¡ršg
 
‹rm
;

52 
	gpublic
:

54 
Ex·ndT”m
(
X­Ÿn
::
weight
 
wt_
, cÚ¡ 
¡d
::
¡ršg
 & 
‹rm_
)

55 : 
wt
(
wt_
), 
‹rm
(
‹rm_
) { }

58 
sw­
(
Ex·ndT”m
 & 
o
) {

59 
	g¡d
::
sw­
(
wt
, 
o
.wt);

60 
	g¡d
::
sw­
(
‹rm
, 
o
.term);

64 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gEx·ndT”m
 & 
	go
) const {

65 ià(
	gwt
 > 
	go
.wtè 
	gŒue
;

66 ià(
	gwt
 < 
	go
.wtè 
	gçl£
;

67  
	g‹rm
 > 
	go
.term;

71 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

77 şas 
	cES‘
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

78 
ä›nd
 
şass
 
ES‘
;

79 
ä›nd
 
şass
 
	gES‘I‹¿tÜ
;

86 
	gX­Ÿn
::
‹rmcouÁ
 
ebound
;

89 
	g¡d
::
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
Ex·ndT”m
> 
™ems
;

92 
	gİ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

95 
IÁ”Çl
(const Internal &);

97 
	gpublic
:

99 
IÁ”Çl
(è: 
ebound
(0) { }

102 
ex·nd
(
X­Ÿn
::
‹rmcouÁ
 
max_esize
,

103 cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
,

104 cÚ¡ 
RS‘I
 & 
r£t
,

105 cÚ¡ 
X­Ÿn
::
Ex·ndDecid”
 * 
edecid”
,

106 cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
Ex·ndWeight
 & 
eweight
);

109 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

	@common/expand.h

22 #iâdeà
OM_HGUARD_EXPAND_H


23 
	#OM_HGUARD_EXPAND_H


	)

25 
Çme¥aû
 
	gX­Ÿn
 {

26 
şass
 
	gES‘
;

27 
Çme¥aû
 
	gIÁ”Çl
 {

	@common/expandweight.h

21 #iâdeà
XAPIAN_INCLUDED_EXPANDWEIGHT_H


22 
	#XAPIAN_INCLUDED_EXPANDWEIGHT_H


	)

24 
	~<x­Ÿn/d©aba£.h
>

26 
	~"‹rmli¡.h
"

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
Çme¥aû
 
	gX­Ÿn
 {

32 
Çme¥aû
 
	gIÁ”Çl
 {

35 şas 
	cEx·ndSts
 {

37 
	g¡d
::
veùÜ
<
boŞ
> 
dbs_£’
;

40 
	gX­Ÿn
::
doş’gth
 
avËn
;

43 
	gex·nd_k
;

45 
	gpublic
:

47 
X­Ÿn
::
doccouÁ
 
dbsize
;

50 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq
;

53 
	gX­Ÿn
::
weight
 
muÉl›r
;

56 
	gX­Ÿn
::
doccouÁ
 
¹”mäeq
;

59 
size_t
 
	gdb_šdex
;

61 
Ex·ndSts
(
X­Ÿn
::
doş’gth
 
avËn_
, 
ex·nd_k_
)

62 : 
avËn
(
avËn_
), 
ex·nd_k
(
ex·nd_k_
),

63 
dbsize
(0), 
‹rmäeq
(0), 
muÉl›r
(0), 
¹”mäeq
(0), 
db_šdex
(0) {

66 
accumuÏ‹
(
X­Ÿn
::
‹rmcouÁ
 
wdf
, X­Ÿn::‹rmcouÁ 
doş’
,

67 
X­Ÿn
::
doccouÁ
 
subtf
, X­Ÿn::doccouÁ 
subdbsize
) {

70 ià(
wdf
 == 0) wdf = 1;

72 
	gmuÉl›r
 +ğ(
ex·nd_k
 + 1è* 
wdf
 / (ex·nd_k * 
doş’
 / 
avËn
 + wdf);

73 ++
	g¹”mäeq
;

77 ià(
	gdb_šdex
 >ğ
dbs_£’
.
size
(è|| !dbs_£’[
db_šdex
]) {

78 ià(
db_šdex
 >ğ
dbs_£’
.
size
()èdbs_£’.
»size
(db_index + 1);

79 
	gdbs_£’
[
db_šdex
] = 
Œue
;

80 
	gdbsize
 +ğ
subdbsize
;

81 
	g‹rmäeq
 +ğ
subtf
;

87 şas 
	cEx·ndWeight
 {

89 cÚ¡ 
	gX­Ÿn
::
D©aba£
 
db
;

92 
	gX­Ÿn
::
doccouÁ
 
dbsize
;

95 
	gX­Ÿn
::
doş’gth
 
avËn
;

98 
	gX­Ÿn
::
doccouÁ
 
rsize
;

110 
boŞ
 
	gu£_exaù_‹rmäeq
;

113 
	gex·nd_k
;

115 
	gpublic
:

126 
Ex·ndWeight
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db_
,

127 
X­Ÿn
::
doccouÁ
 
rsize_
,

128 
boŞ
 
u£_exaù_‹rmäeq_
,

129 
ex·nd_k_
)

130 : 
db
(
db_
), 
dbsize
(db.
g‘_doccouÁ
()), 
avËn
(db.
g‘_avËngth
()),

131 
rsize
(
rsize_
), 
u£_exaù_‹rmäeq
(
u£_exaù_‹rmäeq_
),

132 
ex·nd_k
(
ex·nd_k_
) { }

139 
	gX­Ÿn
::
weight
 
g‘_weight
(
T”mLi¡
 * 
m”g”
,

140 cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

	@common/fileutils.cc

22 
	~<cÚfig.h
>

23 
	~"feuts.h
"

25 
	~"¡ršguts.h
"

26 
	~<¡ršg
>

28 
usšg
 
Çme¥aû
 
	g¡d
;

30 
boŞ


31 
	$i§b¥©h
(cÚ¡ 
¡ršg
 & 
·th
)

34 ià(
·th
.
	`em±y
()è 
çl£
;

35 #ifdeà
__WIN32__


38 ià(
·th
.
	`size
() >= 2 &&…ath[1] == ':') {

39 ià(
·th
.
	`size
(è=ğ2è 
çl£
;

40 ià(
·th
[2] !ğ'/' &&…©h[2] !ğ'\\'è 
çl£
;

41  
Œue
;

43 ià(
·th
[0] !ğ'/' &&…©h[0] !ğ'\\'è 
çl£
;

44  
Œue
;

47 ià(
·th
[0] !ğ'/'è 
çl£
;

48  
Œue
;

50 
	}
}

52 
¡ršg


53 
	$ÿlc_dœÇme
(cÚ¡ 
¡ršg
 & 
f’ame
)

55 
¡ršg
::
size_ty³
 
¦ash
 = 
f’ame
.
	`rfšd
('/');

56 #ifdeà
__WIN32__


57 
¡ršg
::
size_ty³
 
back¦ash
 = 
f’ame
.
	`rfšd
('\\');

58 ià(
back¦ash
 !ğ
¡ršg
::
Åos
 && back¦ash > 
¦ash
) slash = backslash;

60 ià(
¦ash
 =ğ
¡ršg
::
Åos
)  "./";

61  (
f’ame
.
	`sub¡r
(0, 
¦ash
) + "/");

62 
	}
}

64 #ifdeà
__WIN32__


66 
boŞ


67 
	$has_drive
(cÚ¡ 
¡ršg
 &
·th
)

69  (
·th
.
	`size
() >= 2 &&…ath[1] == ':');

70 
	}
}

73 
boŞ


74 
	$is_drive
(cÚ¡ 
¡ršg
 &
·th
)

76 ià(!
	`has_drive
(
·th
)è 
çl£
;

77 ià(
·th
.
	`size
(è=ğ2è 
Œue
;

78 ià(
·th
.
	`size
(è=ğ3 && (·th[2] =ğ'\\' ||…©h[2] =ğ'/')è 
Œue
;

79  
çl£
;

80 
	}
}

83 
¡ršg


84 
	$još_·ths
(cÚ¡ 
¡ršg
 & 
·th1
, cÚ¡ sŒšg & 
·th2
)

86 ià(
·th1
.
	`em±y
()è 
·th2
;

87 #ifdeà
__WIN32__


88 ià(
	`i§b¥©h
(
·th2
)) {

92 ià(
	`has_drive
(
·th2
)) …ath2;

93 ià(
	`is_drive
(
·th1
)è…©h1.
	`sub¡r
(0, 2è+ 
·th2
;

94  
·th2
;

96 ià(
	`has_drive
(
·th2
)) …ath2;

97 ià(
	`’dsw™h
(
·th1
, '/') ||ƒndswith(path1, '\\'))

98  
·th1
 + 
·th2
;

99  
·th1
 + "\\" + 
·th2
;

102 ià(
	`i§b¥©h
(
·th2
)) …ath2;

103 ià(
·th1
[·th1.
	`size
(è- 1] =ğ'/'è…©h1 + 
·th2
;

104  
·th1
 + "/" + 
·th2
;

106 
	}
}

	@common/fileutils.h

22 #iâdeà
XAPIAN_INCLUDED_FILEUTILS_H


23 
	#XAPIAN_INCLUDED_FILEUTILS_H


	)

25 
	~"x­Ÿn/visib™y.h
"

27 
	~<¡ršg
>

33 
	g¡d
::
¡ršg
 
ÿlc_dœÇme
(cÚ¡ 
¡d
::¡ršg & 
f’ame
);

39 
	g¡d
::
¡ršg
 
još_·ths
(cÚ¡ 
¡d
::¡ršg & 
·th1
, cÚ¡ std::¡ršg & 
·th2
);

	@common/getopt.cc

26 #ifdeà
HAVE_CONFIG_H


27 
	~<cÚfig.h
>

30 
	~"gnu_g‘İt.h
"

36 #iâdeà
USE_GLIBC_GNUGETOPT


38 
	~<c¡dio
>

40 
usšg
 
	g¡d
::
årštf
;

42 #ifdeà
VMS


43 
	~<unixlib.h
>

46 #iâdeà
_


49 
	~<libš.h
>

50 #iâdeà
_


51 
	#_
(
msgid
è
	`g‘‹xt
 (msgid)

	)

54 
	#_
(
msgid
è(msgid)

	)

78 *
	gİrg
;

93 
	gİtšd
 = 1;

99 
	gg‘İt_š™Ÿlized
;

108 *
	gÃxtch¬
;

113 
	gİ‹¼
 = 1;

119 
	gİtİt
 = '?';

152 
	mREQUIRE_ORDER
, 
	mPERMUTE
, 
	mRETURN_IN_ORDER


153 } 
	gÜd”šg
;

156 *
	gposixly_cÜ»ù
;

158 
	~<c¡ršg
>

159 
usšg
 
	g¡d
::
¡¾’
;

160 
usšg
 
	g¡d
::
¡rcmp
;

161 
usšg
 
	g¡d
::
¡ºcmp
;

162 
usšg
 
	g¡d
::
¡rchr
;

164 
	~<c¡dlib
>

165 
usšg
 
	g¡d
::
g‘’v
;

174 
	gfœ¡_nÚİt
;

175 
	gÏ¡_nÚİt
;

187 
	$exchªge
 (**
¬gv
)

189 
bÙtom
 = 
fœ¡_nÚİt
;

190 
middË
 = 
Ï¡_nÚİt
;

191 
tİ
 = 
İtšd
;

192 *
‹m
;

199 
tİ
 > 
middË
 && middË > 
bÙtom
)

201 ià(
tİ
 - 
middË
 > middË - 
bÙtom
)

204 
Ën
 = 
middË
 - 
bÙtom
;

205 
i
;

208 
i
 = 0; i < 
Ën
; i++)

210 
‹m
 = 
¬gv
[
bÙtom
 + 
i
];

211 
¬gv
[
bÙtom
 + 
i
] =‡rgv[
tİ
 - (
middË
 - bottom) + i];

212 
¬gv
[
tİ
 - (
middË
 - 
bÙtom
è+ 
i
] = 
‹m
;

215 
tİ
 -ğ
Ën
;

220 
Ën
 = 
tİ
 - 
middË
;

221 
i
;

224 
i
 = 0; i < 
Ën
; i++)

226 
‹m
 = 
¬gv
[
bÙtom
 + 
i
];

227 
¬gv
[
bÙtom
 + 
i
] =‡rgv[
middË
 + i];

228 
¬gv
[
middË
 + 
i
] = 
‹m
;

231 
bÙtom
 +ğ
Ën
;

237 
fœ¡_nÚİt
 +ğ(
İtšd
 - 
Ï¡_nÚİt
);

238 
Ï¡_nÚİt
 = 
İtšd
;

239 
	}
}

244 
	$g‘İt_š™Ÿlize
 (
¬gc
, *cÚ¡ *
¬gv
, cÚ¡ *
İt¡ršg
)

247 ()
¬gc
;

248 ()
¬gv
;

254 
fœ¡_nÚİt
 = 
Ï¡_nÚİt
 = 
İtšd
;

256 
Ãxtch¬
 = 
NULL
;

258 
posixly_cÜ»ù
 = 
	`g‘’v
 ("POSIXLY_CORRECT");

262 ià(
İt¡ršg
[0] == '-')

264 
Üd”šg
 = 
RETURN_IN_ORDER
;

265 ++
İt¡ršg
;

267 ià(
İt¡ršg
[0] == '+')

269 
Üd”šg
 = 
REQUIRE_ORDER
;

270 ++
İt¡ršg
;

272 ià(
posixly_cÜ»ù
 !ğ
NULL
)

273 
Üd”šg
 = 
REQUIRE_ORDER
;

275 
Üd”šg
 = 
PERMUTE
;

277  
İt¡ršg
;

278 
	}
}

337 
	$gnu_g‘İt_š‹º®_
(
¬gc
, *cÚ¡ *
¬gv
, cÚ¡ *
İt¡ršg
, cÚ¡ 
İtiÚ
 *
lÚgİts
, *
lÚgšd
, 
lÚg_Úly
)

339 
´št_”rÜs
 = 
İ‹¼
;

340 ià(
İt¡ršg
[0] == ':')

341 
´št_”rÜs
 = 0;

343 ià(
¬gc
 < 1)

346 
İrg
 = 
NULL
;

348 ià(
İtšd
 =ğ0 || !
g‘İt_š™Ÿlized
)

350 ià(
İtšd
 == 0)

351 
İtšd
 = 1;

352 
İt¡ršg
 = 
	`g‘İt_š™Ÿlize
 (
¬gc
, 
¬gv
, optstring);

353 
g‘İt_š™Ÿlized
 = 1;

358 
	#NONOPTION_P
 (
¬gv
[
İtšd
][0] !ğ'-' ||‡rgv[İtšd][1] =ğ'\0')

	)

360 ià(
Ãxtch¬
 =ğ
NULL
 || *nextchar == '\0')

366 ià(
Ï¡_nÚİt
 > 
İtšd
)

367 
Ï¡_nÚİt
 = 
İtšd
;

368 ià(
fœ¡_nÚİt
 > 
İtšd
)

369 
fœ¡_nÚİt
 = 
İtšd
;

371 ià(
Üd”šg
 =ğ
PERMUTE
)

376 ià(
fœ¡_nÚİt
 !ğ
Ï¡_nÚİt
 &&†a¡_nÚİˆ!ğ
İtšd
)

377 
	`exchªge
 (
cÚ¡_ÿ¡
<**>(
¬gv
));

378 ià(
Ï¡_nÚİt
 !ğ
İtšd
)

379 
fœ¡_nÚİt
 = 
İtšd
;

384 
İtšd
 < 
¬gc
 && 
NONOPTION_P
)

385 
İtšd
++;

386 
Ï¡_nÚİt
 = 
İtšd
;

394 ià(
İtšd
 !ğ
¬gc
 && !
	`¡rcmp
 (
¬gv
[optind], "--"))

396 
İtšd
++;

398 ià(
fœ¡_nÚİt
 !ğ
Ï¡_nÚİt
 &&†a¡_nÚİˆ!ğ
İtšd
)

399 
	`exchªge
 (
cÚ¡_ÿ¡
<**>(
¬gv
));

400 ià(
fœ¡_nÚİt
 =ğ
Ï¡_nÚİt
)

401 
fœ¡_nÚİt
 = 
İtšd
;

402 
Ï¡_nÚİt
 = 
¬gc
;

404 
İtšd
 = 
¬gc
;

410 ià(
İtšd
 =ğ
¬gc
)

414 ià(
fœ¡_nÚİt
 !ğ
Ï¡_nÚİt
)

415 
İtšd
 = 
fœ¡_nÚİt
;

422 ià(
NONOPTION_P
)

424 ià(
Üd”šg
 =ğ
REQUIRE_ORDER
)

426 
İrg
 = 
¬gv
[
İtšd
++];

433 
Ãxtch¬
 = (
¬gv
[
İtšd
] + 1

434 + (
lÚgİts
 !ğ
NULL
 && 
¬gv
[
İtšd
][1] == '-'));

452 ià(
lÚgİts
 !ğ
NULL


453 && (
¬gv
[
İtšd
][1] == '-'

454 || (
lÚg_Úly
 && (
¬gv
[
İtšd
][2] || !
	`¡rchr
 (
İt¡ršg
,‡rgv[optind][1])))))

456 *
Çm“nd
;

457 cÚ¡ 
İtiÚ
 *
p
;

458 cÚ¡ 
İtiÚ
 *
pfound
 = 
NULL
;

459 
exaù
 = 0;

460 
ambig
 = 0;

461 
šdfound
 = -1;

462 
İtiÚ_šdex
;

464 
Çm“nd
 = 
Ãxtch¬
; *nameend && *nameend != '=';‚ameend++)

469 
p
 = 
lÚgİts
, 
İtiÚ_šdex
 = 0;…->
Çme
;…++, option_index++)

470 ià(!
	`¡ºcmp
 (
p
->
Çme
, 
Ãxtch¬
, 
Çm“nd
 -‚extchar))

472 ià((
Çm“nd
 - 
Ãxtch¬
è=ğ(
	`¡¾’
(
p
->
Çme
)))

475 
pfound
 = 
p
;

476 
šdfound
 = 
İtiÚ_šdex
;

477 
exaù
 = 1;

480 ià(
pfound
 =ğ
NULL
)

483 
pfound
 = 
p
;

484 
šdfound
 = 
İtiÚ_šdex
;

486 ià(
lÚg_Úly


487 || 
pfound
->
has_¬g
 !ğ
p
->has_arg

488 || 
pfound
->
æag
 !ğ
p
->flag

489 || 
pfound
->
v®
 !ğ
p
->val)

491 
ambig
 = 1;

494 ià(
ambig
 && !
exaù
)

496 ià(
´št_”rÜs
)

497 
	`årštf
 (
¡d”r
, 
	`_
("%s: option `%s' is‡mbiguous\n"),

498 
¬gv
[0],‡rgv[
İtšd
]);

499 
Ãxtch¬
 +ğ
	`¡¾’
 (nextchar);

500 
İtšd
++;

501 
İtİt
 = 0;

505 ià(
pfound
 !ğ
NULL
)

507 
İtiÚ_šdex
 = 
šdfound
;

508 
İtšd
++;

509 ià(*
Çm“nd
)

513 ià(
pfound
->
has_¬g
)

514 
İrg
 = 
Çm“nd
 + 1;

517 ià(
´št_”rÜs
)

519 ià(
¬gv
[
İtšd
 - 1][1] == '-')

521 
	`årštf
 (
¡d”r
,

522 
	`_
("%s: option `--%s' doesn't‡llow‡n‡rgument\n"),

523 
¬gv
[0], 
pfound
->
Çme
);

526 
	`årštf
 (
¡d”r
,

527 
	`_
("%s: option `%c%s' doesn't‡llow‡n‡rgument\n"),

528 
¬gv
[0],‡rgv[
İtšd
 - 1][0], 
pfound
->
Çme
);

531 
Ãxtch¬
 +ğ
	`¡¾’
 (nextchar);

533 
İtİt
 = 
pfound
->
v®
;

537 ià(
pfound
->
has_¬g
 == 1)

539 ià(
İtšd
 < 
¬gc
)

540 
İrg
 = 
¬gv
[
İtšd
++];

543 ià(
´št_”rÜs
)

544 
	`årštf
 (
¡d”r
,

545 
	`_
("%s: option `%s'„equires‡n‡rgument\n"),

546 
¬gv
[0],‡rgv[
İtšd
 - 1]);

547 
Ãxtch¬
 +ğ
	`¡¾’
 (nextchar);

548 
İtİt
 = 
pfound
->
v®
;

549  
İt¡ršg
[0] == ':' ? ':' : '?';

552 
Ãxtch¬
 +ğ
	`¡¾’
 (nextchar);

553 ià(
lÚgšd
 !ğ
NULL
)

554 *
lÚgšd
 = 
İtiÚ_šdex
;

555 ià(
pfound
->
æag
)

557 *(
pfound
->
æag
èğpfound->
v®
;

560  
pfound
->
v®
;

567 ià(!
lÚg_Úly
 || 
¬gv
[
İtšd
][1] == '-'

568 || 
	`¡rchr
 (
İt¡ršg
, *
Ãxtch¬
è=ğ
NULL
)

570 ià(
´št_”rÜs
)

572 ià(
¬gv
[
İtšd
][1] == '-')

574 
	`årštf
 (
¡d”r
, 
	`_
("%s: unrecognized option `--%s'\n"),

575 
¬gv
[0], 
Ãxtch¬
);

578 
	`årštf
 (
¡d”r
, 
	`_
("%s: unrecognized option `%c%s'\n"),

579 
¬gv
[0],‡rgv[
İtšd
][0], 
Ãxtch¬
);

581 
Ãxtch¬
 = 
cÚ¡_ÿ¡
<*>("");

582 
İtšd
++;

583 
İtİt
 = 0;

591 
c
 = *
Ãxtch¬
++;

592 cÚ¡ *
‹mp
 = 
	`¡rchr
 (
İt¡ršg
, 
c
);

595 ià(*
Ãxtch¬
 == '\0')

596 ++
İtšd
;

598 ià(
‹mp
 =ğ
NULL
 || 
c
 == ':')

600 ià(
´št_”rÜs
)

602 ià(
posixly_cÜ»ù
)

604 
	`årštf
 (
¡d”r
, 
	`_
("%s: illegal option -- %c\n"),

605 
¬gv
[0], 
c
);

607 
	`årštf
 (
¡d”r
, 
	`_
("%s: invalid option -- %c\n"),

608 
¬gv
[0], 
c
);

610 
İtİt
 = 
c
;

614 ià(
‹mp
[0] == 'W' &&emp[1] == ';')

616 *
Çm“nd
;

617 cÚ¡ 
İtiÚ
 *
p
;

618 cÚ¡ 
İtiÚ
 *
pfound
 = 
NULL
;

619 
exaù
 = 0;

620 
ambig
 = 0;

621 
šdfound
 = 0;

622 
İtiÚ_šdex
;

625 ià(*
Ãxtch¬
 != '\0')

627 
İrg
 = 
Ãxtch¬
;

630 
İtšd
++;

632 ià(
İtšd
 =ğ
¬gc
)

634 ià(
´št_”rÜs
)

637 
	`årštf
 (
¡d”r
, 
	`_
("%s: option„equires‡n‡rgument -- %c\n"),

638 
¬gv
[0], 
c
);

640 
İtİt
 = 
c
;

641 ià(
İt¡ršg
[0] == ':')

642 
c
 = ':';

644 
c
 = '?';

645  
c
;

650 
İrg
 = 
¬gv
[
İtšd
++];

655 
Ãxtch¬
 = 
Çm“nd
 = 
İrg
; *nameend && *nameend != '=';‚ameend++)

660 
p
 = 
lÚgİts
, 
İtiÚ_šdex
 = 0;…->
Çme
;…++, option_index++)

661 ià(!
	`¡ºcmp
 (
p
->
Çme
, 
Ãxtch¬
, 
Çm“nd
 -‚extchar))

663 ià((
Çm“nd
 - 
Ãxtch¬
è=ğ(
	`¡¾’
(
p
->
Çme
)))

666 
pfound
 = 
p
;

667 
šdfound
 = 
İtiÚ_šdex
;

668 
exaù
 = 1;

671 ià(
pfound
 =ğ
NULL
)

674 
pfound
 = 
p
;

675 
šdfound
 = 
İtiÚ_šdex
;

679 
ambig
 = 1;

681 ià(
ambig
 && !
exaù
)

683 ià(
´št_”rÜs
)

684 
	`årštf
 (
¡d”r
, 
	`_
("%s: option `-W %s' is‡mbiguous\n"),

685 
¬gv
[0],‡rgv[
İtšd
]);

686 
Ãxtch¬
 +ğ
	`¡¾’
 (nextchar);

687 
İtšd
++;

690 ià(
pfound
 !ğ
NULL
)

692 
İtiÚ_šdex
 = 
šdfound
;

693 ià(*
Çm“nd
)

697 ià(
pfound
->
has_¬g
)

698 
İrg
 = 
Çm“nd
 + 1;

701 ià(
´št_”rÜs
)

702 
	`årštf
 (
¡d”r
, 
	`_
("\
%s: option `-W %s' doesn't‡llow‡n‡rgument\n"),

704 
¬gv
[0], 
pfound
->
Çme
);

706 
Ãxtch¬
 +ğ
	`¡¾’
 (nextchar);

710 ià(
pfound
->
has_¬g
 == 1)

712 ià(
İtšd
 < 
¬gc
)

713 
İrg
 = 
¬gv
[
İtšd
++];

716 ià(
´št_”rÜs
)

717 
	`årštf
 (
¡d”r
,

718 
	`_
("%s: option `%s'„equires‡n‡rgument\n"),

719 
¬gv
[0],‡rgv[
İtšd
 - 1]);

720 
Ãxtch¬
 +ğ
	`¡¾’
 (nextchar);

721  
İt¡ršg
[0] == ':' ? ':' : '?';

724 
Ãxtch¬
 +ğ
	`¡¾’
 (nextchar);

725 ià(
lÚgšd
 !ğ
NULL
)

726 *
lÚgšd
 = 
İtiÚ_šdex
;

727 ià(
pfound
->
æag
)

729 *(
pfound
->
æag
èğpfound->
v®
;

732  
pfound
->
v®
;

734 
Ãxtch¬
 = 
NULL
;

737 ià(
‹mp
[1] == ':')

739 ià(
‹mp
[2] == ':')

742 ià(*
Ãxtch¬
 != '\0')

744 
İrg
 = 
Ãxtch¬
;

745 
İtšd
++;

748 
İrg
 = 
NULL
;

749 
Ãxtch¬
 = 
NULL
;

754 ià(*
Ãxtch¬
 != '\0')

756 
İrg
 = 
Ãxtch¬
;

759 
İtšd
++;

761 ià(
İtšd
 =ğ
¬gc
)

763 ià(
´št_”rÜs
)

766 
	`årštf
 (
¡d”r
,

767 
	`_
("%s: option„equires‡n‡rgument -- %c\n"),

768 
¬gv
[0], 
c
);

770 
İtİt
 = 
c
;

771 ià(
İt¡ršg
[0] == ':')

772 
c
 = ':';

774 
c
 = '?';

779 
İrg
 = 
¬gv
[
İtšd
++];

780 
Ãxtch¬
 = 
NULL
;

783  
c
;

785 
	}
}

	@common/gnu_getopt.h

22 #iâdeà
XAPIAN_INCLUDED_GNU_GETOPT_H


23 
	#XAPIAN_INCLUDED_GNU_GETOPT_H


	)

27 
	~<cùy³
>

29 
	#GNU_GETOPT_INTERFACE_VERSION
 2

	)

30 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

31 
	~<gnu-v”siÚs.h
>

32 #ià
_GNU_GETOPT_INTERFACE_VERSION
 =ğ
GNU_GETOPT_INTERFACE_VERSION


33 
	#USE_GLIBC_GNUGETOPT


	)

37 #ifdeà
USE_GLIBC_GNUGETOPT


39 
	~<g‘İt.h
>

41 
šlše
 

42 
	$gnu_g‘İt
(
¬gc_
, *cÚ¡ *
¬gv_
, cÚ¡ *
shÜtİts_
) {

43  
	`g‘İt
(
¬gc_
, 
¬gv_
, 
shÜtİts_
);

44 
	}
}

46 
šlše
 

47 
	$gnu_g‘İt_lÚg
(
¬gc_
, *cÚ¡ *
¬gv_
, cÚ¡ *
shÜtİts_
,

48 cÚ¡ 
İtiÚ
 *
lÚgİts_
, *
İtšd_
) {

49  
	`g‘İt_lÚg
(
¬gc_
, 
¬gv_
, 
shÜtİts_
, 
lÚgİts_
, 
İtšd_
);

50 
	}
}

52 
šlše
 

53 
	$gnu_g‘İt_lÚg_Úly
(
¬gc_
, *cÚ¡ *
¬gv_
, cÚ¡ *
shÜtİts_
,

54 cÚ¡ 
İtiÚ
 *
lÚgİts_
, *
İtšd_
) {

55  
	`g‘İt_lÚg_Úly
(
¬gc_
, 
¬gv_
, 
shÜtİts_
, 
lÚgİts_
, 
İtšd_
);

56 
	}
}

61 *
İrg
;

62 
İtšd
;

63 
İ‹¼
;

64 
İtİt
;

67 
	sİtiÚ
 {

68 cÚ¡ *
	mÇme
;

69 
	mhas_¬g
;

70 * 
	mæag
;

71 
	mv®
;

74 
	#no_¬gum’t
 0

	)

75 
	#»quœed_¬gum’t
 1

	)

76 
	#İtiÚ®_¬gum’t
 2

	)

80 
gnu_g‘İt_š‹º®_
(, *cÚ¡ *, cÚ¡ *, cÚ¡ 
İtiÚ
 *,

83 
šlše
 

84 
	$gnu_g‘İt
(
¬gc_
, *cÚ¡ *
¬gv_
, cÚ¡ *
shÜtİts_
) {

85  
	`gnu_g‘İt_š‹º®_
(
¬gc_
, 
¬gv_
, 
shÜtİts_
,

86 
»š‹½»t_ÿ¡
<cÚ¡ 
İtiÚ
 *>(0),

87 
»š‹½»t_ÿ¡
<*>(0), 0);

88 
	}
}

90 
šlše
 

91 
	$gnu_g‘İt_lÚg
(
¬gc_
, *cÚ¡ *
¬gv_
, cÚ¡ *
shÜtİts_
,

92 cÚ¡ 
İtiÚ
 *
lÚgİts_
, *
İtšd_
) {

93  
	`gnu_g‘İt_š‹º®_
(
¬gc_
, 
¬gv_
, 
shÜtİts_
, 
lÚgİts_
, 
İtšd_
, 0);

94 
	}
}

96 
šlše
 

97 
	$gnu_g‘İt_lÚg_Úly
(
¬gc_
, *cÚ¡ *
¬gv_
, cÚ¡ *
shÜtİts_
,

98 cÚ¡ 
İtiÚ
 *
lÚgİts_
, *
İtšd_
) {

99  
	`gnu_g‘İt_š‹º®_
(
¬gc_
, 
¬gv_
, 
shÜtİts_
, 
lÚgİts_
, 
İtšd_
, 1);

100 
	}
}

	@common/inmemory_positionlist.h

22 #iâdeà
OM_HGUARD_INMEMORY_POSITIONLIST_H


23 
	#OM_HGUARD_INMEMORY_POSITIONLIST_H


	)

25 
	~<x­Ÿn/ty³s.h
>

26 
	~<x­Ÿn/”rÜ.h
>

28 
	~<veùÜ
>

29 
	~"pos™iÚli¡.h
"

30 
	~"docum’‰”m.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

35 şas 
	cInMemÜyPos™iÚLi¡
 : 
public
 
Pos™iÚLi¡


37 
´iv©e
:

39 
veùÜ
<
X­Ÿn
::
‹rmpos
> 
pos™iÚs
;

42 
	mveùÜ
<
	mX­Ÿn
::
‹rmpos
>::
cÚ¡_™”©Ü
 
mypos
;

45 
boŞ
 
	m™”©šg_š_´og»ss
;

48 
InMemÜyPos™iÚLi¡
(const InMemoryPositionList &);

51 
	mİ”©Ü
=(cÚ¡ 
InMemÜyPos™iÚLi¡
 &);

53 
	mpublic
:

55 
	$InMemÜyPos™iÚLi¡
(è: 
	$™”©šg_š_´og»ss
(
çl£
) { }

58 
	$InMemÜyPos™iÚLi¡
(
boŞ
)

59 : 
	`mypos
(
pos™iÚs
.
	`begš
()), 
	$™”©šg_š_´og»ss
(
çl£
è{ 
	}
}

62 
InMemÜyPos™iÚLi¡
(cÚ¡ 
OmDocum’tT”m
::
‹rm_pos™iÚs
 & 
pos™iÚs_
);

65 
£t_d©a
(cÚ¡ 
OmDocum’tT”m
::
‹rm_pos™iÚs
 & 
pos™iÚs_
);

68 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_size
() const;

71 
X­Ÿn
::
‹rmpos
 
	$g‘_pos™iÚ
() const;

77 
	`Ãxt
();

83 
	`sk_to
(
X­Ÿn
::
‹rmpos
ermpos);

86 
boŞ
 
	$©_’d
() const;

87 
	}
};

	@common/internaltypes.h

22 #iâdeà
XAPIAN_INCLUDED_INTERNALTYPES_H


23 
	#XAPIAN_INCLUDED_INTERNALTYPES_H


	)

26 
	tby‹
;

28 #iâdeà
SIZEOF_INT


29 #”rÜ 
SIZEOF_INT
 
is
 
nÙ
 
defšed


31 #iâdeà
SIZEOF_LONG


32 #”rÜ 
SIZEOF_LONG
 
is
 
nÙ
 
defšed


34 #ià
SIZEOF_INT
 >= 4

35 
	tušt4
;

36 #–ià
SIZEOF_LONG
 >= 4

37 
	tušt4
;

39 #”rÜ 
Ty³
 
is
 
Ëss
 
thª
 32 
b™s
, 
which
 
ISO
 
dÛs
 
nÙ
 
®low
!

42 #ià
SIZEOF_LONG
 >= 8

43 
	tušt8
;

50 
	tušt8
;

54 
ušt8
 
	ttÙËn_t
;

	@common/leafpostlist.h

22 #iâdeà
XAPIAN_INCLUDED_LEAFPOSTLIST_H


23 
	#XAPIAN_INCLUDED_LEAFPOSTLIST_H


	)

25 
	~"po¡li¡.h
"

27 
	~<¡ršg
>

29 
Çme¥aû
 
	gX­Ÿn
 {

30 
şass
 
	gWeight
;

38 şas 
	cL—fPo¡Li¡
 : 
public
 
Po¡Li¡
 {

40 
İ”©Ü
=(cÚ¡ 
L—fPo¡Li¡
 &);

43 
L—fPo¡Li¡
(const LeafPostList &);

45 
	m´Ùeùed
:

46 cÚ¡ 
X­Ÿn
::
Weight
 * 
weight
;

48 
boŞ
 
	mÃed_doş’gth
;

51 
	m¡d
::
¡ršg
 
‹rm
;

54 
L—fPo¡Li¡
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm_
)

55 : 
weight
(0), 
Ãed_doş’gth
(
çl£
), 
	$‹rm
(
‹rm_
) { }

57 
public
:

58 ~
	`L—fPo¡Li¡
();

69 
	`£t_‹rmweight
(cÚ¡ 
X­Ÿn
::
Weight
 * 
weight_
);

76 
vœtu®
 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const = 0;

78 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

79 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

80 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

82 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

83 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

84 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

86 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

87 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

89 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

90 
	}
};

	@common/msvc_dirent.cc

25 
	~<cÚfig.h
>

26 #ifdeà
__WIN32__


28 
	~"msvc_dœ’t.h
"

29 
	~<û¼no
>

30 
	~<io.h
>

31 
	~<c¡dlib
>

32 
	~<c¡ršg
>

34 #ifdeà
__ılu¥lus


39 
	sDIR


41 
hªdË
;

42 
_fšdd©a_t
 
šfo
;

43 
dœ’t
 
»suÉ
;

44 *
Çme
;

47 
DIR
 *
İ’dœ
(cÚ¡ *
Çme
)

49 
DIR
 *
dœ
 = 0;

51 if(
Çme
 &&‚ame[0])

53 
size_t
 
ba£_Ëngth
 = 
¡¾’
(
Çme
);

54 cÚ¡ *
®l
 =

55 
¡rchr
("/\\", 
Çme
[
ba£_Ëngth
 - 1]) ? "*" : "/*";

57 if((
dœ
 = (
DIR
 *è
m®loc
( *dir)) != 0 &&

58 (
dœ
->
Çme
 = (*è
m®loc
(
ba£_Ëngth
 + 
¡¾’
(
®l
) + 1)) != 0)

60 
¡rÿt
(
¡rıy
(
dœ
->
Çme
,‚ame), 
®l
);

62 if((
dœ
->
hªdË
 = (è
_fšdfœ¡
(dœ->
Çme
, &dœ->
šfo
)) != -1)

64 
dœ
->
»suÉ
.
d_Çme
 = 0;

68 
ä“
(
dœ
->
Çme
);

69 
ä“
(
dœ
);

70 
dœ
 = 0;

75 
ä“
(
dœ
);

76 
dœ
 = 0;

77 
”ºo
 = 
ENOMEM
;

82 
”ºo
 = 
EINVAL
;

85  
dœ
;

88 
şo£dœ
(
DIR
 *
dœ
)

90 
»suÉ
 = -1;

92 if(
dœ
)

94 if(
dœ
->
hªdË
 != -1)

96 
»suÉ
 = 
_fšdşo£
(
dœ
->
hªdË
);

99 
ä“
(
dœ
->
Çme
);

100 
ä“
(
dœ
);

103 if(
»suÉ
 == -1)

105 
”ºo
 = 
EBADF
;

108  
»suÉ
;

111 
dœ’t
 *
»addœ
(
DIR
 *
dœ
)

113 
dœ’t
 *
»suÉ
 = 0;

115 if(
dœ
 && dœ->
hªdË
 != -1)

117 if(!
dœ
->
»suÉ
.
d_Çme
) {

118 
»suÉ
 = &
dœ
->result;

119 
»suÉ
->
d_Çme
 = 
dœ
->
šfo
.
Çme
;

121 
Üig_”ºo
 = 
”ºo
;

122 ià(
_fšdÃxt
(
dœ
->
hªdË
, &dœ->
šfo
) != -1) {

123 
»suÉ
 = &
dœ
->result;

124 
»suÉ
->
d_Çme
 = 
dœ
->
šfo
.
Çme
;

125 } ià(
”ºo
 =ğ
ENOENT
) {

130 
”ºo
 = 
Üig_”ºo
;

136 
”ºo
 = 
EBADF
;

139  
»suÉ
;

142 
»wšddœ
(
DIR
 *
dœ
)

144 if(
dœ
 && dœ->
hªdË
 != -1)

146 
_fšdşo£
(
dœ
->
hªdË
);

147 
dœ
->
hªdË
 = (è
_fšdfœ¡
(dœ->
Çme
, &dœ->
šfo
);

148 
dœ
->
»suÉ
.
d_Çme
 = 0;

152 
”ºo
 = 
EBADF
;

156 #ifdeà
__ılu¥lus


	@common/msvc_dirent.h

24 #iâdeà
XAPIAN_INCLUDED_MSVC_DIRENT_H


25 
	#XAPIAN_INCLUDED_MSVC_DIRENT_H


	)

27 #ifdeà
__ılu¥lus


32 
DIR
 
	tDIR
;

34 
	sdœ’t


36 *
d_Çme
;

39 
DIR
 *
İ’dœ
(const *);

40 
şo£dœ
(
DIR
 *);

41 
dœ’t
 *
»addœ
(
DIR
 *);

42 
»wšddœ
(
DIR
 *);

44 #ifdeà
__ılu¥lus


	@common/msvc_posix_wrapper.cc

23 
	~<cÚfig.h
>

25 #ifdeà
__WIN32__


27 
	~<io.h
>

29 
	~"§ã”ºo.h
"

30 
	~"§ãfú.h
"

31 
	~"§ãwšdows.h
"

35 
	$msvc_£t_”ºo_äom_g‘Ï¡”rÜ
()

37 
e
;

38 
wš”r
 = 
	`G‘La¡E¼Ü
();

39 
wš”r
) {

40 
ERROR_FILENAME_EXCED_RANGE
:

41 
ERROR_FILE_NOT_FOUND
:

42 
ERROR_PATH_NOT_FOUND
:

43 
ERROR_INVALID_DRIVE
:

44 
ERROR_NO_MORE_FILES
:

45 
ERROR_BAD_NETPATH
:

46 
ERROR_BAD_NET_NAME
:

47 
ERROR_BAD_PATHNAME
:

48 
e
 = 
ENOENT
;

50 
ERROR_ARENA_TRASHED
:

51 
ERROR_NOT_ENOUGH_MEMORY
:

52 
ERROR_INVALID_BLOCK
:

53 
ERROR_NOT_ENOUGH_QUOTA
:

54 
e
 = 
ENOMEM
;

56 
ERROR_LOCK_VIOLATION
:

57 
ERROR_LOCK_FAILED
:

58 
ERROR_SEEK_ON_DEVICE
:

59 
ERROR_NETWORK_ACCESS_DENIED
:

60 
ERROR_NOT_LOCKED
:

61 
ERROR_ACCESS_DENIED
:

62 
ERROR_CANNOT_MAKE
:

63 
ERROR_FAIL_I24
:

64 
ERROR_DRIVE_LOCKED
:

65 
ERROR_CURRENT_DIRECTORY
:

66 
e
 = 
EACCES
;

68 
ERROR_INVALID_FUNCTION
:

69 
ERROR_INVALID_ACCESS
:

70 
ERROR_NEGATIVE_SEEK
:

71 
ERROR_INVALID_DATA
:

72 
ERROR_INVALID_PARAMETER
:

73 
e
 = 
EINVAL
;

75 
ERROR_NO_PROC_SLOTS
:

76 
ERROR_NESTING_NOT_ALLOWED
:

77 
ERROR_MAX_THRDS_REACHED
:

78 
e
 = 
EAGAIN
;

80 
ERROR_INVALID_HANDLE
:

81 
ERROR_INVALID_TARGET_HANDLE
:

82 
ERROR_DIRECT_ACCESS_HANDLE
:

83 
e
 = 
EBADF
;

85 
ERROR_ALREADY_EXISTS
:

86 
ERROR_FILE_EXISTS
:

87 
e
 = 
EEXIST
;

89 
ERROR_BROKEN_PIPE
:

90 
e
 = 
EPIPE
;

92 
ERROR_DISK_FULL
:

93 
e
 = 
ENOSPC
;

95 
ERROR_TOO_MANY_OPEN_FILES
:

96 
e
 = 
EMFILE
;

98 
ERROR_WAIT_NO_CHILDREN
:

99 
ERROR_CHILD_NOT_COMPLETE
:

100 
e
 = 
ECHILD
;

102 
ERROR_DIR_NOT_EMPTY
:

103 
e
 = 
ENOTEMPTY
;

105 
ERROR_BAD_ENVIRONMENT
:

106 
e
 = 
E2BIG
;

108 
ERROR_BAD_FORMAT
:

109 
e
 = 
ENOEXEC
;

111 
ERROR_NOT_SAME_DEVICE
:

112 
e
 = 
EXDEV
;

115 ià(
wš”r
 >ğ
ERROR_WRITE_PROTECT
 && wš”¸<ğ
ERROR_SHARING_BUFFER_EXCEEDED
)

116 
e
 = 
EACCES
;

117 ià(
wš”r
 >ğ
ERROR_INVALID_STARTING_CODESEG
 && wš”¸<ğ
ERROR_INFLOOP_IN_RELOC_CHAIN
)

118 
e
 = 
ENOEXEC
;

120 
e
 = 
EINVAL
;

125 #ifdeà
_£t_”ºo


126 
	`_£t_”ºo
(
e
);

128 
”ºo
 = 
e
;

131 
	}
}

138 
	$msvc_posix_uÆšk
(cÚ¡ * 
f’ame
)

141 ià(
	`D–‘eFe
(
f’ame
) != 0) {

145  
	`msvc_£t_”ºo_äom_g‘Ï¡”rÜ
();

146 
	}
}

150 
	$msvc_posix_İ’
(cÚ¡ *
f’ame
, 
æags
)

153 
DWORD
 
dwDesœedAcûss
 = 
GENERIC_READ
;

154 
æags
 & (
O_RDONLY
 | 
O_RDWR
 | 
O_WRONLY
)) {

155 
O_RDONLY
:

156 
dwDesœedAcûss
 = 
GENERIC_READ
;

158 
O_RDWR
:

159 
dwDesœedAcûss
 = 
GENERIC_READ
 | 
GENERIC_WRITE
;

161 
O_WRONLY
:

162 
dwDesœedAcûss
 = 
GENERIC_WRITE
;

166 
DWORD
 
dwSh¬eMode
 = 
FILE_SHARE_READ
 | 
FILE_SHARE_WRITE
 | 
FILE_SHARE_DELETE
;

169 
DWORD
 
dwC»©iÚDi¥os™iÚ
 = 
OPEN_EXISTING
;

170 
æags
 & (
O_CREAT
 | 
O_TRUNC
 | 
O_EXCL
)) {

171 
O_EXCL
:

172 
dwC»©iÚDi¥os™iÚ
 = 
OPEN_EXISTING
;

175 
O_CREAT
:

176 
dwC»©iÚDi¥os™iÚ
 = 
OPEN_ALWAYS
;

179 
O_CREAT
 | 
O_TRUNC
:

180 
dwC»©iÚDi¥os™iÚ
 = 
CREATE_ALWAYS
;

183 
O_CREAT
 | 
O_EXCL
:

184 
O_CREAT
 | 
O_TRUNC
 | 
O_EXCL
:

185 
dwC»©iÚDi¥os™iÚ
 = 
CREATE_NEW
;

188 
O_TRUNC
:

189 
O_TRUNC
 | 
O_EXCL
:

190 
dwC»©iÚDi¥os™iÚ
 = 
TRUNCATE_EXISTING
;

194 
HANDLE
 
hªdËWš
 =

195 
	`C»©eFe
(
f’ame
,

196 
dwDesœedAcûss
,

197 
dwSh¬eMode
,

198 
NULL
,

199 
dwC»©iÚDi¥os™iÚ
,

200 
FILE_ATTRIBUTE_NORMAL
,

201 
NULL
);

202 ià(
hªdËWš
 =ğ
INVALID_HANDLE_VALUE
) {

203  
	`msvc_£t_”ºo_äom_g‘Ï¡”rÜ
();

207  
	`_İ’_osfhªdË
((
šŒ_t
)
hªdËWš
, 
æags
);

208 
	}
}

211 
	$msvc_posix_»Çme
(cÚ¡ *
äom
, cÚ¡ *
to
)

213 ià(
	`MoveFeEx
(
äom
, 
to
, 
MOVEFILE_REPLACE_EXISTING
) != 0) {

217  
	`msvc_£t_”ºo_äom_g‘Ï¡”rÜ
();

218 
	}
}

	@common/msvc_posix_wrapper.h

24 #iâdeà
XAPIAN_INCLUDED_MSVC_POSIX_WRAPPER_H


25 
	#XAPIAN_INCLUDED_MSVC_POSIX_WRAPPER_H


	)

31 
msvc_posix_uÆšk
(cÚ¡ * 
f’ame
);

34 
msvc_posix_İ’
(cÚ¡ *
f’ame
, 
æags
);

37 
msvc_posix_»Çme
(cÚ¡ *
äom
, cÚ¡ *
to
);

	@common/multialltermslist.h

21 #iâdeà
XAPIAN_INCLUDED_MULTIALLTERMSLIST_H


22 
	#XAPIAN_INCLUDED_MULTIALLTERMSLIST_H


	)

24 
	~"®É”m¦i¡.h
"

26 
	~"d©aba£.h
"

28 
	~<¡ršg
>

29 
	~<veùÜ
>

32 şas 
	cMuÉiAÎT”msLi¡
 : 
public
 
AÎT”msLi¡
 {

34 
İ”©Ü
=(cÚ¡ 
MuÉiAÎT”msLi¡
 &);

37 
MuÉiAÎT”msLi¡
(const MultiAllTermsList &);

40 
	m¡d
::
¡ršg
 
cu¼’t_‹rm
;

43 
	m¡d
::
veùÜ
<
T”mLi¡
 *> 
‹rmli¡s
;

45 
	mpublic
:

47 
MuÉiAÎT”msLi¡
(cÚ¡ 
¡d
::
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<X­Ÿn::
D©aba£
::IÁ”Çl> > & 
dbs
,

48 cÚ¡ 
¡d
::
¡ršg
 & 
´efix
);

51 ~
MuÉiAÎT”msLi¡
();

54 
	m¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

57 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

60 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

63 
T”mLi¡
 *
	`Ãxt
();

70 
T”mLi¡
 *
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
);

73 
boŞ
 
	$©_’d
() const;

	@common/multimatch.h

23 #iâdeà
OM_HGUARD_MULTIMATCH_H


24 
	#OM_HGUARD_MULTIMATCH_H


	)

26 
	~"omqu”yš‹º®.h
"

27 
	~"subm©ch.h
"

29 
	~<veùÜ
>

31 
	~"x­Ÿn/weight.h
"

33 şas 
	cMuÉiM©ch


35 
	m´iv©e
:

37 
¡d
::
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
SubM©ch
> > 
Ëaves
;

39 cÚ¡ 
	mX­Ÿn
::
D©aba£
 
db
;

41 cÚ¡ 
	mX­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
;

43 
	mX­Ÿn
::
doccouÁ
 
cŞÏp£_max
;

45 
	mX­Ÿn
::
v®u’o
 
cŞÏp£_key
;

47 
	m³rûÁ_cutoff
;

49 
	mX­Ÿn
::
weight
 
weight_cutoff
;

51 
	mX­Ÿn
::
Enquœe
::
docid_Üd”
 
Üd”
;

53 
	mX­Ÿn
::
v®u’o
 
sÜt_key
;

55 
	mX­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
sÜt_by
;

57 
boŞ
 
	msÜt_v®ue_fÜw¬d
;

60 
	mX­Ÿn
::
E¼ÜHªdËr
 * 
”rÜhªdËr
;

63 cÚ¡ 
	mX­Ÿn
::
Weight
 * 
weight
;

68 
boŞ
 
	m»ÿlcuÏ‹_w_max
;

71 
	mveùÜ
<
	mboŞ
> 
	mis_»mÙe
;

74 cÚ¡ 
	mveùÜ
<
	mX­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s
;

80 
	mX­Ÿn
::
weight
 
g‘Ü»ÿlc_maxweight
(
Po¡Li¡
 *
¶
);

83 
MuÉiM©ch
(const MultiMatch &);

86 
	mİ”©Ü
=(cÚ¡ 
MuÉiM©ch
 &);

88 
	mpublic
:

102 
MuÉiM©ch
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db_
,

103 cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qu”y
,

104 
X­Ÿn
::
‹rmcouÁ
 
qËn
,

105 cÚ¡ 
X­Ÿn
::
RS‘
 * 
omr£t
,

106 
X­Ÿn
::
doccouÁ
 
cŞÏp£_max_
,

107 
X­Ÿn
::
v®u’o
 
cŞÏp£_key_
,

108 
³rûÁ_cutoff_
,

109 
X­Ÿn
::
weight
 
weight_cutoff_
,

110 
X­Ÿn
::
Enquœe
::
docid_Üd”
 
Üd”_
,

111 
X­Ÿn
::
v®u’o
 
sÜt_key_
,

112 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
sÜt_by_
,

113 
boŞ
 
sÜt_v®ue_fÜw¬d_
,

114 
X­Ÿn
::
E¼ÜHªdËr
 * 
”rÜhªdËr
,

115 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
,

116 cÚ¡ 
X­Ÿn
::
Weight
 *
wtscheme
,

117 cÚ¡ 
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s_
,

118 
boŞ
 
have_sÜ‹r
, boŞ 
have_mdecid”
);

124 
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
,

125 
X­Ÿn
::
doccouÁ
 
max™ems
,

126 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

127 
X­Ÿn
::
MS‘
 & 
m£t
,

128 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
,

129 cÚ¡ 
X­Ÿn
::
M©chDecid”
 * 
mdecid”
,

130 cÚ¡ 
X­Ÿn
::
M©chDecid”
 * 
m©ch¥y_Ëgacy
,

131 cÚ¡ 
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
);

136 
	$»ÿlc_maxweight
() {

137 
»ÿlcuÏ‹_w_max
 = 
Œue
;

139 
	}
};

	@common/multivaluelist.h

21 #iâdeà
XAPIAN_INCLUDED_MULTIVALUELIST_H


22 
	#XAPIAN_INCLUDED_MULTIVALUELIST_H


	)

24 
	~"v®u–i¡.h
"

26 
	~"d©aba£.h
"

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
	gSubV®ueLi¡
;

34 şas 
	cMuÉiV®ueLi¡
 : 
public
 
V®ueLi¡
 {

36 
İ”©Ü
=(cÚ¡ 
MuÉiV®ueLi¡
 &);

39 
MuÉiV®ueLi¡
(const MultiValueList &);

42 
	mX­Ÿn
::
docid
 
cu¼’t_docid
;

45 
	m¡d
::
veùÜ
<
SubV®ueLi¡
 *> 
v®u–i¡s
;

48 
	mX­Ÿn
::
v®u’o
 
¦Ù
;

50 
size_t
 
	mmuÉl›r
;

52 
	mpublic
:

54 
MuÉiV®ueLi¡
(cÚ¡ 
¡d
::
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<X­Ÿn::
D©aba£
::IÁ”Çl> > & 
dbs
,

55 
X­Ÿn
::
v®u’o
 
¦Ù_
);

58 ~
MuÉiV®ueLi¡
();

61 
	mX­Ÿn
::
docid
 
	$g‘_docid
() const;

64 
¡d
::
¡ršg
 
	$g‘_v®ue
() const;

67 
X­Ÿn
::
v®u’o
 
	$g‘_v®u’o
() const;

70 
boŞ
 
	$©_’d
() const;

78 
	`Ãxt
();

85 
	`sk_to
(
X­Ÿn
::
docid
);

105 
boŞ
 
	`check
(
X­Ÿn
::
docid
 
did
);

108 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

	@common/noreturn.h

21 #iâdeà
XAPIAN_INCLUDED_NORETURN_H


22 
	#XAPIAN_INCLUDED_NORETURN_H


	)

25 #iâdeà
XAPIAN_NORETURN


26 #ià
defšed
 
__GNUC__


29 
	#XAPIAN_NORETURN
(
D
èD 
	`__©Œibu‹__
((
__nÜ‘uº__
))

	)

30 #–ià
defšed
 
_MSC_VER
 && _MSC_VER >= 1300

32 
	#XAPIAN_NORETURN
(
D
è
	`__deş¥ec
(
nÜ‘uº
è
	)
D

34 
	#XAPIAN_NORETURN
(
D
è
	)
D

	@common/omassert.h

26 #iâdeà
XAPIAN_INCLUDED_OMASSERT_H


27 
	#XAPIAN_INCLUDED_OMASSERT_H


	)

40 
	#CompeTimeAs£¹
(
COND
)\

42 
	tx­Ÿn_compe_time_check_
[(
COND
) ? 1 : -1];\

43 } 0)

	)

45 #iâdeà
XAPIAN_ASSERTIONS


48 #ifdeà
XAPIAN_ASSERTIONS_PARANOID


49 #”rÜ 
XAPIAN_ASSERTIONS_PARANOID
 
defšed
 
w™hout
 
XAPIAN_ASSERTIONS


53 
	~<x­Ÿn/”rÜ.h
>

55 
	~"¡r.h
"

56 
	~"uts.h
"

58 
	#XAPIAN_ASSERT_LOCATION__
(
LINE
,
MSG
è
__FILE__
":"#LINE": "#MSG

	)

59 
	#XAPIAN_ASSERT_LOCATION_
(
LINE
,
MSG
è
	`XAPIAN_ASSERT_LOCATION__
(LINE,MSG)

	)

60 
	#XAPIAN_ASSERT_LOCATION
(
MSG
è
	`XAPIAN_ASSERT_LOCATION_
(
__LINE__
,MSG)

	)

65 #ifdeà
XAPIAN_ASSERTIONS_PARANOID


66 
	#As£¹P¬ªoid
(
COND
è
	`As£¹
(COND)

	)

67 
	#As£¹R–P¬ªoid
(
A
,
REL
,
B
è
	`As£¹R–
(A,REL,B)

	)

68 
	#As£¹EqP¬ªoid
(
A
,
B
è
	`As£¹Eq
(A,B)

	)

69 
	#As£¹EqDoubËP¬ªoid
(
A
,
B
è
	`As£¹EqDoubË
(A,B)

	)

76 
	#As£¹
(
COND
) \

78 ià(
	`¿»
(!(
COND
)))\

79 
throw
 
X­Ÿn
::
	`As£¹iÚE¼Ü
(
	`XAPIAN_ASSERT_LOCATION
(
COND
));\

80 } 0)

	)

89 
	#As£¹R–
(
A
,
REL
,
B
) \

91 ià(
	`¿»
(!((
A
è
	`REL
 (
B
)))) {\

92 
¡d
::
¡ršg
 
	`x­Ÿn_as£¹iÚ_msg
(
	`XAPIAN_ASSERT_LOCATION
(
A
 
REL
 
B
));\

93 
x­Ÿn_as£¹iÚ_msg
 += " : values were ";\

94 
x­Ÿn_as£¹iÚ_msg
 +ğ
	`¡r
(
A
);\

95 
x­Ÿn_as£¹iÚ_msg
 += "‡nd ";\

96 
x­Ÿn_as£¹iÚ_msg
 +ğ
	`¡r
(
B
);\

97 
throw
 
X­Ÿn
::
	`As£¹iÚE¼Ü
(
x­Ÿn_as£¹iÚ_msg
);\

99 } 0)

	)

108 
	#As£¹Eq
(
A
,
B
è
	`As£¹R–
(A,==,B)

	)

111 
	#As£¹EqDoubË
(
A
,
B
) \

113 
usšg
 
X­Ÿn
::
IÁ”Çl
::
w™hš_DBL_EPSILON
;\

114 ià(
	`¿»
(
	`w™hš_DBL_EPSILON
(
A
,
B
))) {\

115 
¡d
::
¡ršg
 
	`x­Ÿn_as£¹iÚ_msg
(
	`XAPIAN_ASSERT_LOCATION
(
	`w™hš_DBL_EPSILON
(
A
,
B
)));\

116 
x­Ÿn_as£¹iÚ_msg
 += " : values were ";\

117 
x­Ÿn_as£¹iÚ_msg
 +ğ
	`¡r
(
A
);\

118 
x­Ÿn_as£¹iÚ_msg
 += "‡nd ";\

119 
x­Ÿn_as£¹iÚ_msg
 +ğ
	`¡r
(
B
);\

120 
throw
 
X­Ÿn
::
	`As£¹iÚE¼Ü
(
x­Ÿn_as£¹iÚ_msg
);\

122 } 0)

	)

131 #iâdeà
As£¹


132 
	#As£¹
(
COND
è()0

	)

133 
	#As£¹R–
(
A
,
REL
,
B
è()0

	)

134 
	#As£¹Eq
(
A
,
B
è()0

	)

135 
	#As£¹EqDoubË
(
A
,
B
è()0

	)

138 #iâdeà
As£¹P¬ªoid


139 
	#As£¹P¬ªoid
(
COND
è()0

	)

140 
	#As£¹R–P¬ªoid
(
A
,
REL
,
B
è()0

	)

141 
	#As£¹EqP¬ªoid
(
A
,
B
è()0

	)

142 
	#As£¹EqDoubËP¬ªoid
(
A
,
B
è()0

	)

159 
	#STATIC_ASSERT
(
COND
) \

161 
x­Ÿn_¡©ic_as£¹_çed
[(
COND
) ? 1 : -1]; \

162 ()
x­Ÿn_¡©ic_as£¹_çed
; \

163 } 0)

	)

166 
	#STATIC_ASSERT_UNSIGNED_TYPE
(
TYPE
) \

167 
	`STATIC_ASSERT
(
¡©ic_ÿ¡
<
TYPE
>(-1è> 0)

	)

180 
	#STATIC_ASSERT_TYPE_DOMINATES
(
T1
, 
T2
) \

181 
	`STATIC_ASSERT
(
¡©ic_ÿ¡
<
T1
>(-1) > 0 ? \

182 (
¡©ic_ÿ¡
<
T2
>(-1è> 0 && (
T1
) >= (T2)) : \

183 ((
T1
è>ğ(
T2
è+ (
¡©ic_ÿ¡
<T2>(-1è> 0)))

	)

	@common/omdebug.cc

23 
	~<cÚfig.h
>

25 #ifdeà
XAPIAN_DEBUG_PROFILE


27 
	~"omdebug.h
"

29 
timev®
 
	gX­Ÿn
::
IÁ”Çl
::
Tim”
::
·u£d
;

31 
timev®
 * 
	gX­Ÿn
::
IÁ”Çl
::
Tim”
::
p¡¬t
 = 
NULL
;

33 
	g¡d
::
li¡
<
X­Ÿn
::
IÁ”Çl
::
Tim”
 *> X­Ÿn::IÁ”Çl::Tim”::
¡ack
;

35 
	gX­Ÿn
::
IÁ”Çl
::
Tim”
::
d•th
 = 0;

	@common/omdebug.h

23 #iâdeà
OM_HGUARD_OMDEBUG_H


24 
	#OM_HGUARD_OMDEBUG_H


	)

26 
	~"debuglog.h
"

28 #ifdeà
XAPIAN_DEBUG_LOG


30 
	~"omtime.h
"

31 
	~"ouut.h
"

33 
	~<iomª
>

35 
šlše
 
	g¡d
::
o¡»am
 &

36 
İ”©Ü
<<(
¡d
::
o¡»am
 & 
os
, cÚ¡ 
	gOmTime
 & 
	gom_time
) {

37  
	gos
 << 
	gom_time
.
	g£c
 << '.' << 
	g¡d
::
£tw
(6è<< 
¡d
::
£tfl
('0'è<< 
om_time
.
u£c
;

43 
	#DEBUGCALL
(
t
,
r
,
a
,
b
è
	`LOGCALL
Ñ,r,a,b)

	)

46 
	#DEBUGCALL_STATIC
(
t
,
r
,
a
,
b
è
	`LOGCALL_STATIC
Ñ,r,a,b)

	)

48 #–ià
defšed
(
XAPIAN_DEBUG_PROFILE
)

50 
	#LOGLINE
(
a
,
b
è()0

	)

51 
	#RETURN
(
A
è 
	)
A

53 
	~<c¡dio
>

54 
	~<c¡dlib
>

55 
	~<sys/time.h
>

57 
	~<li¡
>

58 
	~<¡ršg
>

60 
Çme¥aû
 
	gX­Ÿn
 {

61 
Çme¥aû
 
	gIÁ”Çl
 {

63 şas 
	cTim”
 {

64 
	g´iv©e
:

65 
¡d
::
¡ršg
 
ÿÎ
;

68 
timev®
 
	g’Œy
;

71 
timev®
 
	g¡¬t
;

74 
timev®
 
	gd—d
;

77 
timev®
 
	gkids
;

80 
timev®
 
	g·u£d
;

83 
timev®
 * 
	gp¡¬t
;

85 
	g¡d
::
li¡
<
Tim”
 *> 
¡ack
;

87 
	gd•th
;

89 
	gpublic
:

90 
Tim”
(cÚ¡ 
¡d
::
¡ršg
 &
ÿÎ_
è: 
ÿÎ
(call_) {

91 
¡ack
.
push_back
(
this
);

92 
	gd•th
++;

93 
	g’Œy
 = 
·u£d
;

94 
	gp¡¬t
 = &
¡¬t
;

95 
tim”ş—r
(&
d—d
);

96 
tim”ş—r
(&
kids
);

99 ~
Tim”
() {

100 
g‘timeofday
(&
·u£d
, 
NULL
);

102 ià(
	g¡ack
.
em±y
()è
	g¡d
::
abÜt
();

103 
	g¡ack
.
pİ_back
();

104 
	gd•th
--;

107 
	grunu
 = 
·u£d
.
tv_u£c
 - 
¡¬t
.tv_u£ø- 
d—d
.tv_usec;

108 
	gruns
 = 
·u£d
.
tv_£c
 - 
¡¬t
.tv_£ø- 
d—d
.tv_sec;

109 
	gruns
 +ğ
runu
 / 1000000;

110 
	grunu
 %= 1000000;

111 ià(
	grunu
 < 0) {

112 
	grunu
 += 1000000;

113 
	gruns
--;

116 ià(!
	g¡ack
.
em±y
()) {

117 
timev®
 * 
	gk
 = &(
¡ack
.
back
()->
kids
);

118 
	gk
->
	gtv_£c
 +ğ
runs
;

119 
	gk
->
	gtv_u£c
 +ğ
runu
;

123 
	gmyu
 = 
runu
 - 
kids
.
tv_u£c
;

124 
	gmys
 = 
runs
 - 
kids
.
tv_£c
;

125 
	gmys
 +ğ
myu
 / 1000000;

126 
	gmyu
 %= 1000000;

127 ià(
	gmyu
 < 0) {

128 
	gmyu
 += 1000000;

129 
	gmys
--;

131 
	g¡d
::
årštf
(
¡d”r
, "% 5d.%06d % 5d.%06d %-*s%s\n",

132 
runs
, 
runu
, 
mys
, 
myu
, 
d•th
, "", 
ÿÎ
.
c_¡r
());

136 
	gu£c
 = 
¡¬t
.
tv_u£c
 - 
’Œy
.tv_usec;

137 
	g£c
 = 
¡¬t
.
tv_£c
 - 
’Œy
.tv_sec;

138 
	g£c
 +ğ
u£c
 / 1000000;

139 
	gu£c
 %= 1000000;

140 ià(
	gu£c
 < 0) {

141 
	gu£c
 += 1000000;

142 
	g£c
--;

146 
	gu£c
 +ğ
d—d
.
tv_u£c
;

147 
	g£c
 +ğ
d—d
.
tv_£c
;

150 
	gu£c
 -ğ
·u£d
.
tv_u£c
;

151 
	g£c
 -ğ
·u£d
.
tv_£c
;

153 
	gp¡¬t
 = 
NULL
;

154 
timev®
 * 
	gd
 = 
NULL
;

155 ià(!
	g¡ack
.
em±y
()) {

156 
	gd
 = &(
¡ack
.
back
()->
d—d
);

157 
	gd
->
	gtv_£c
 +ğ
£c
;

158 
	gd
->
	gtv_u£c
 +ğ
u£c
;

160 
g‘timeofday
(&
·u£d
, 
NULL
);

161 ià(
	gd
) {

162 
	gd
->
	gtv_£c
 +ğ
·u£d
.
tv_£c
;

163 
	gd
->
	gtv_u£c
 +ğ
·u£d
.
tv_u£c
;

167 
·u£
() {

168 
g‘timeofday
(&
·u£d
, 
NULL
);

171 
»sume
() {

172 ià(
	gp¡¬t
 =ğ
NULL
è
¡d
::
abÜt
();

173 
g‘timeofday
(
p¡¬t
, 
NULL
);

183 
	#DEBUGCALL
(
t
,
r
,
a
,
b
) \

184 
X­Ÿn
::
IÁ”Çl
::
Tim”
::
	`·u£
(); \

185 
X­Ÿn
::
IÁ”Çl
::
Tim”
 
	`om_time_ÿÎ
(
a
); \

186 
X­Ÿn
::
IÁ”Çl
::
Tim”
::
	`»sume
();

	)

188 
	#DEBUGCALL_STATIC
(
t
,
r
,
a
,
b
) \

189 
X­Ÿn
::
IÁ”Çl
::
Tim”
::
	`·u£
(); \

190 
X­Ÿn
::
IÁ”Çl
::
Tim”
 
	`om_time_ÿÎ
(
a
); \

191 
X­Ÿn
::
IÁ”Çl
::
Tim”
::
	`»sume
();

	)

195 
	#DEBUGCALL
(
r
,
t
,
a
,
b
è()0

	)

196 
	#DEBUGCALL_STATIC
(
r
,
t
,
a
,
b
è()0

	)

200 
	#DEBUGAPICALL
(
r
,
a
,
b
è
	`DEBUGCALL
(
APICALL
,r,a,b)

	)

201 
	#DEBUGAPICALL_STATIC
(
r
,
a
,
b
è
	`DEBUGCALL_STATIC
(
APICALL
,r,a,b)

	)

	@common/omenquireinternal.h

24 #iâdeà
OM_HGUARD_OMENQUIREINTERNAL_H


25 
	#OM_HGUARD_OMENQUIREINTERNAL_H


	)

27 
	~"x­Ÿn/d©aba£.h
"

28 
	~"x­Ÿn/docum’t.h
"

29 
	~"x­Ÿn/’quœe.h
"

30 
	~"x­Ÿn/qu”y.h
"

31 
	~"x­Ÿn/keymak”.h
"

33 
	~<®gÜ™hm
>

34 
	~<cm©h
>

35 
	~<m­
>

36 
	~<£t
>

38 
usšg
 
Çme¥aû
 
	g¡d
;

40 
şass
 
	gOmEx·nd
;

41 
şass
 
	gRS‘I
;

42 
şass
 
	gMuÉiM©ch
;

44 
Çme¥aû
 
	gX­Ÿn
 {

46 
şass
 
	gE¼ÜHªdËr
;

47 
şass
 
	gT”mI‹¿tÜ
;

49 
Çme¥aû
 
	gIÁ”Çl
 {

55 şas 
	cMS‘I‹m
 {

56 
	gpublic
:

57 
MS‘I‹m
(
X­Ÿn
::
weight
 
wt_
, X­Ÿn::
docid
 
did_
)

58 : 
wt
(
wt_
), 
did
(
did_
), 
cŞÏp£_couÁ
(0) {}

60 
MS‘I‹m
(
X­Ÿn
::
weight
 
wt_
, X­Ÿn::
docid
 
did_
, cÚ¡ 
¡ršg
 &
key_
)

61 : 
wt
(
wt_
), 
did
(
did_
), 
cŞÏp£_key
(
key_
), 
cŞÏp£_couÁ
(0) {}

63 
MS‘I‹m
(
X­Ÿn
::
weight
 
wt_
, X­Ÿn::
docid
 
did_
, cÚ¡ 
¡ršg
 &
key_
,

64 
X­Ÿn
::
doccouÁ
 
cŞÏp£_couÁ_
)

65 : 
wt
(
wt_
), 
did
(
did_
), 
cŞÏp£_key
(
key_
),

66 
cŞÏp£_couÁ
(
cŞÏp£_couÁ_
) {}

68 
sw­
(
MS‘I‹m
 & 
o
) {

69 
	g¡d
::
sw­
(
wt
, 
o
.wt);

70 
	g¡d
::
sw­
(
did
, 
o
.did);

71 
	g¡d
::
sw­
(
cŞÏp£_key
, 
o
.collapse_key);

72 
	g¡d
::
sw­
(
cŞÏp£_couÁ
, 
o
.collapse_count);

73 
	g¡d
::
sw­
(
sÜt_key
, 
o
.sort_key);

77 
	gX­Ÿn
::
weight
 
wt
;

80 
	gX­Ÿn
::
docid
 
did
;

93 
¡ršg
 
	gcŞÏp£_key
;

101 
	gX­Ÿn
::
doccouÁ
 
cŞÏp£_couÁ
;

105 
¡ršg
 
	gsÜt_key
;

108 
¡ršg
 
g‘_desütiÚ
() const;

117 şas 
	cEnquœe
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

118 
´iv©e
:

120 cÚ¡ 
X­Ÿn
::
D©aba£
 
db
;

123 
Qu”y
 
	gqu”y
;

126 
‹rmcouÁ
 
	gqËn
;

129 
IÁ”Çl
(const Internal &);

131 
	gİ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

133 
	gpublic
:

134 ’um { 
REL
, 
	gVAL
, 
	gVAL_REL
, 
	gREL_VAL
 } 
	tsÜt_£‰šg
;

136 
	gX­Ÿn
::
v®u’o
 
cŞÏp£_key
;

138 
	gX­Ÿn
::
doccouÁ
 
cŞÏp£_max
;

140 
	gX­Ÿn
::
Enquœe
::
docid_Üd”
 
Üd”
;

142 
³rûÁ
 
	g³rûÁ_cutoff
;

144 
	gX­Ÿn
::
weight
 
weight_cutoff
;

146 
	gX­Ÿn
::
v®u’o
 
sÜt_key
;

147 
sÜt_£‰šg
 
	gsÜt_by
;

148 
boŞ
 
	gsÜt_v®ue_fÜw¬d
;

150 
KeyMak”
 * 
	gsÜ‹r
;

154 
E¼ÜHªdËr
 * 
	g”rÜhªdËr
;

161 
mubË
 
Weight
 * 
	gweight
;

163 
	gveùÜ
<
	gM©chSpy
 *> 
	g¥›s
;

165 
IÁ”Çl
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
d©aba£s
, 
E¼ÜHªdËr
 * 
”rÜhªdËr_
);

166 ~
IÁ”Çl
();

170 
»que¡_doc
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
™em
) const;

174 
	gX­Ÿn
::
Docum’t
 
»ad_doc
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
™em
) const;

176 
£t_qu”y
(cÚ¡ 
Qu”y
 & 
qu”y_
, 
‹rmcouÁ
 
qËn_
);

177 cÚ¡ 
	gQu”y
 & 
g‘_qu”y
();

178 
MS‘
 
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
max™ems
,

179 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

180 cÚ¡ 
RS‘
 *
omr£t
,

181 cÚ¡ 
M©chDecid”
 *
mdecid”
,

182 cÚ¡ 
M©chDecid”
 *
m©ch¥y_Ëgacy
) const;

183 
ES‘
 
g‘_e£t
(
X­Ÿn
::
‹rmcouÁ
 
max™ems
, cÚ¡ 
RS‘
 & 
omr£t
, 
æags
,

184 
k
, cÚ¡ 
Ex·ndDecid”
 *
edecid”
) const;

186 
T”mI‹¿tÜ
 
g‘_m©chšg_‹rms
(
X­Ÿn
::
docid
 
did
) const;

187 
T”mI‹¿tÜ
 
g‘_m©chšg_‹rms
(cÚ¡ 
X­Ÿn
::
MS‘I‹¿tÜ
 &
™
) const;

189 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(cÚ¡ 
¡ršg
 &
Šame
) const;

191 
»gi¡”_m©ch_decid”
(cÚ¡ 
¡ršg
 &
Çme
,

192 cÚ¡ 
M©chDecid”
 *
mdecid”
);

194 
¡ršg
 
g‘_desütiÚ
() const;

197 şas 
	cMS‘
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

198 
public
:

200 
³rûÁ_çùÜ
;

202 
	g´iv©e
:

206 
mubË
 
£t
<
X­Ÿn
::
doccouÁ
> 
»que¡ed_docs
;

209 
mubË
 
	gm­
<
	gX­Ÿn
::
doccouÁ
, X­Ÿn::
Docum’t
> 
šdexeddocs
;

212 
»ad_docs
() const;

215 
IÁ”Çl
(const Internal &);

217 
	gİ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

219 
	gpublic
:

221 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
Enquœe
::IÁ”Çl> 
’quœe
;

226 
	sT”mF»qAndWeight
 {

227 
T”mF»qAndWeight
() { }

228 
T”mF»qAndWeight
(
X­Ÿn
::
doccouÁ
 
tf
, X­Ÿn::
weight
 
wt
)

229 : 
‹rmäeq
(
tf
), 
‹rmweight
(
wt
) { }

230 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq
;

231 
	gX­Ÿn
::
weight
 
‹rmweight
;

239 
	gm­
<
	g¡ršg
, 
	gT”mF»qAndWeight
> 
	g‹rmäeqªdwts
;

242 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
> 
™ems
;

245 
	gX­Ÿn
::
doccouÁ
 
fœ¡™em
;

247 
	gX­Ÿn
::
doccouÁ
 
m©ches_low”_bound
;

249 
	gX­Ÿn
::
doccouÁ
 
m©ches_e¡im©ed
;

251 
	gX­Ÿn
::
doccouÁ
 
m©ches_uµ”_bound
;

253 
	gX­Ÿn
::
doccouÁ
 
uncŞÏp£d_low”_bound
;

255 
	gX­Ÿn
::
doccouÁ
 
uncŞÏp£d_e¡im©ed
;

257 
	gX­Ÿn
::
doccouÁ
 
uncŞÏp£d_uµ”_bound
;

259 
	gX­Ÿn
::
weight
 
max_possibË
;

261 
	gX­Ÿn
::
weight
 
max_©šed
;

263 
IÁ”Çl
()

264 : 
³rûÁ_çùÜ
(0),

265 
fœ¡™em
(0),

266 
m©ches_low”_bound
(0),

267 
m©ches_e¡im©ed
(0),

268 
m©ches_uµ”_bound
(0),

269 
uncŞÏp£d_low”_bound
(0),

270 
uncŞÏp£d_e¡im©ed
(0),

271 
uncŞÏp£d_uµ”_bound
(0),

272 
max_possibË
(0),

273 
max_©šed
(0) {}

276 
IÁ”Çl
(
X­Ÿn
::
doccouÁ
 
fœ¡™em_
,

277 
X­Ÿn
::
doccouÁ
 
m©ches_uµ”_bound_
,

278 
X­Ÿn
::
doccouÁ
 
m©ches_low”_bound_
,

279 
X­Ÿn
::
doccouÁ
 
m©ches_e¡im©ed_
,

280 
X­Ÿn
::
doccouÁ
 
uncŞÏp£d_uµ”_bound_
,

281 
X­Ÿn
::
doccouÁ
 
uncŞÏp£d_low”_bound_
,

282 
X­Ÿn
::
doccouÁ
 
uncŞÏp£d_e¡im©ed_
,

283 
X­Ÿn
::
weight
 
max_possibË_
,

284 
X­Ÿn
::
weight
 
max_©šed_
,

285 
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
> &
™ems_
,

286 cÚ¡ 
m­
<
¡ršg
, 
T”mF»qAndWeight
> &
‹rmäeqªdwts_
,

287 
X­Ÿn
::
weight
 
³rûÁ_çùÜ_
)

288 : 
³rûÁ_çùÜ
(
³rûÁ_çùÜ_
),

289 
‹rmäeqªdwts
(
‹rmäeqªdwts_
),

290 
fœ¡™em
(
fœ¡™em_
),

291 
m©ches_low”_bound
(
m©ches_low”_bound_
),

292 
m©ches_e¡im©ed
(
m©ches_e¡im©ed_
),

293 
m©ches_uµ”_bound
(
m©ches_uµ”_bound_
),

294 
uncŞÏp£d_low”_bound
(
uncŞÏp£d_low”_bound_
),

295 
uncŞÏp£d_e¡im©ed
(
uncŞÏp£d_e¡im©ed_
),

296 
uncŞÏp£d_uµ”_bound
(
uncŞÏp£d_uµ”_bound_
),

297 
max_possibË
(
max_possibË_
),

298 
max_©šed
(
max_©šed_
) {

299 
	g¡d
::
sw­
(
™ems
, 
™ems_
);

303 
	gX­Ÿn
::
Docum’t
 
g‘_doc_by_šdex
(
X­Ÿn
::
doccouÁ
 
šdex
) const;

306 
³rûÁ
 
cÚv”t_to_³rûÁ_š‹º®
(
X­Ÿn
::
weight
 
wt
) const;

309 
¡ršg
 
g‘_desütiÚ
() const;

313 
ãtch_™ems
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
Ï¡
) const;

316 şas 
	cRS‘
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

317 
ä›nd
 
şass
 
X­Ÿn
::
RS‘
;

319 
	g´iv©e
:

321 
£t
<
X­Ÿn
::
docid
> 
™ems
;

323 
	gpublic
:

324 cÚ¡ 
£t
<
X­Ÿn
::
docid
> & 
g‘_™ems
(ècÚ¡ {  
™ems
; }

327 
¡ršg
 
g‘_desütiÚ
() const;

	@common/omqueryinternal.h

20 #iâdeà
XAPIAN_INCLUDED_OMQUERYINTERNAL_H


21 
	#XAPIAN_INCLUDED_OMQUERYINTERNAL_H


	)

25 
	~<x­Ÿn/qu”y.h
>

	@common/omtime.h

23 #iâdeà
OM_HGUARD_OMTIME_H


24 
	#OM_HGUARD_OMTIME_H


	)

26 #ifdeà
HAVE_GETTIMEOFDAY


27 
	~<sys/time.h
>

28 
	~<uni¡d.h
>

30 #ifdeà
HAVE_FTIME


31 
	~<sys/timeb.h
>

33 
	~<ùime
>

35 
	~<x­Ÿn/ty³s.h
>

38 şas 
	cOmTime
 {

39 
	mpublic
:

41 
	$OmTime
(è: 
	`£c
(0), 
	$u£c
(0) {}

44 
OmTime
 
	`now
();

47 
	$OmTime
(
m£c
è: 
	`£c
(m£ø/ 1000), 
	`u£c
((m£ø% 1000è* 1000è{
	}
}

48 
	$OmTime
(
£c_
, 
u£c_
è: 
	`£c
(£c_), 
	$u£c
(
u£c_
è{
	}
}

50 
	gİ”©Ü
+ğ(
X­Ÿn
::
timeout
 
m£cs
) {

51 
u£c
 +ğ
m£cs
 * 1000;

52 
	g£c
 +ğ
u£c
 / 1000000;

53 
	gu£c
 %= 1000000;

56 
	gİ”©Ü
+ğ(cÚ¡ 
OmTime
 &
add
) {

57 
u£c
 +ğ
add
.usec;

58 
	g£c
 +ğ
add
.
£c
 + 
u£c
 / 1000000;

59 
	gu£c
 %= 1000000;

62 
OmTime
 
	gİ”©Ü
+ (
	gX­Ÿn
::
timeout
 
m£cs
) const {

63 
OmTime
 
»suÉ
;

64 
	g»suÉ
.
	gu£c
 = 
u£c
 + 
m£cs
 * 1000;

65 
	g»suÉ
.
	g£c
 = 
£c
 + 
»suÉ
.
u£c
 / 1000000;

66 
	g»suÉ
.
	gu£c
 %= 1000000;

67  
	g»suÉ
;

70 
OmTime
 
	gİ”©Ü
+ (cÚ¡ 
	gOmTime
 &
	gadd
) const {

71 
OmTime
 
	g»suÉ
;

72 
	g»suÉ
.
	gu£c
 = 
u£c
 + 
add
.usec;

73 
	g»suÉ
.
	g£c
 = 
£c
 + 
add
.£ø+ 
»suÉ
.
u£c
 / 1000000;

74 
	g»suÉ
.
	gu£c
 %= 1000000;

75  
	g»suÉ
;

78 
OmTime
 
	gİ”©Ü
- (cÚ¡ 
	gOmTime
 &
	gsub
) const {

79 
OmTime
 
	g»suÉ
;

80 
	g»suÉ
.
	gu£c
 = 
u£c
 - 
sub
.usec;

81 
	g»suÉ
.
	g£c
 = 
£c
 - 
sub
.sec;

82 ià(
	g»suÉ
.
	gu£c
 < 0) {

83 
	g»suÉ
.
	gu£c
 += 1000000;

84 
	g»suÉ
.
	g£c
 -= 1;

86  
	g»suÉ
;

89 
boŞ
 
	gİ”©Ü
> (cÚ¡ 
	gOmTime
 &
	grhs
) const {

90 ià(
	g£c
 > 
	grhs
.£cè 
	gŒue
;

91 ià(
	g£c
 < 
	grhs
.£cè 
	gçl£
;

92  (
	gu£c
 > 
	grhs
.usec);

95 
boŞ
 
	$is_£t
(ècÚ¡ {  
£c
 !ğ0 || 
u£c
 !ğ0; 
	}
}

97 
	$as_doubË
() const {

98  (
£c
è+ ((
u£c
) / 1000000.0);

99 
	}
}

101 
	g£c
;

102 
	gu£c
;

105 
šlše
 
OmTime


106 
	gOmTime
::
	$now
()

108 
OmTime
 
»suÉ
;

109 #ifdeà
HAVE_GETTIMEOFDAY


110 
timev®
 
tv
;

111 ià(
	`g‘timeofday
(&
tv
, 0) == 0) {

112 
»suÉ
.
£c
 = 
tv
.
tv_£c
;

113 
»suÉ
.
u£c
 = 
tv
.
tv_u£c
;

114  
»suÉ
;

117 #ifdeà
FTIME_RETURNS_VOID


118 
timeb
 

;

119 
	`áime
(&

);

120 
»suÉ
.
£c
 = 

.
time
;

121 
»suÉ
.
u£c
 = 

.
ml™m
 * 1000;

122  
»suÉ
;

124 #ifdeà
HAVE_FTIME


125 
timeb
 

;

126 ià(
	`áime
(&

) == 0) {

127 
»suÉ
.
£c
 = 

.
time
;

128 
»suÉ
.
u£c
 = 

.
ml™m
 * 1000;

129  
»suÉ
;

132 
»suÉ
.
£c
 = 
	`time
(
NULL
);

133 
»suÉ
.
u£c
 = 0;

134  
»suÉ
;

136 
	}
}

	@common/ortermlist.h

21 #iâdeà
XAPIAN_INCLUDED_ORTERMLIST_H


22 
	#XAPIAN_INCLUDED_ORTERMLIST_H


	)

24 
	~"‹rmli¡.h
"

26 
Çme¥aû
 
	gX­Ÿn
 {

27 
Çme¥aû
 
	gIÁ”Çl
 {

28 
şass
 
	gEx·ndSts
;

32 şas 
	cOrT”mLi¡
 : 
public
 
T”mLi¡
 {

33 
´Ùeùed
:

35 
T”mLi¡
 *
Ëá
, *
	mright
;

43 
	m¡d
::
¡ršg
 
Ëá_cu¼’t
, 
	mright_cu¼’t
;

46 
	$check_¡¬‹d
() const;

48 
public
:

49 
	$OrT”mLi¡
(
T”mLi¡
 * 
Ëá_
, T”mLi¡ * 
right_
)

50 : 
	`Ëá
(
Ëá_
), 
	$right
(
right_
) { }

52 ~
	`OrT”mLi¡
();

54 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const;

56 
	`accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const;

58 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const;

60 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

62 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

65 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

68 
T”mLi¡
 *
	`Ãxt
();

70 
boŞ
 
	$©_’d
() const;

72 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const;

74 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const;

75 
	}
};

83 şas 
	cF»qAdd”OrT”mLi¡
 : 
public
 
OrT”mLi¡
 {

84 
public
:

85 
	$F»qAdd”OrT”mLi¡
(
T”mLi¡
 * 
Ëá_
, T”mLi¡ * 
right_
)

86 : 
	$OrT”mLi¡
(
Ëá_
, 
right_
)

89 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const;

90 
	}
};

	@common/output.h

26 #iâdeà
XAPIAN_INCLUDED_OUTPUT_H


27 
	#XAPIAN_INCLUDED_OUTPUT_H


	)

29 
	~<f¡»am
>

32 
	#XAPIAN_OUTPUT_FUNCTION
(
CLASS
) \

33 
šlše
 
¡d
::
o¡»am
 & \

34 
İ”©Ü
<<(
¡d
::
o¡»am
 & 
os
, cÚ¡ 
CLASS
 & 
objeù
) { \

35  
os
 << 
objeù
.
	`g‘_desütiÚ
(); \

36 }

	)

39 
	#XAPIAN_OUTPUT_FUNCTION_PTR
(
CLASS
) \

40 
šlše
 
¡d
::
o¡»am
 & \

41 
İ”©Ü
<<(
¡d
::
o¡»am
 & 
os
, cÚ¡ 
CLASS
 * 
objeù
) { \

42 ià(
objeù
 =ğ
NULL
è 
os
 << "(" #CLASS "*)0"; \

43  
os
 << 
objeù
->
	`g‘_desütiÚ
(); \

44 }

	)

46 
	~<x­Ÿn/d©aba£.h
>

47 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
D©aba£
)

48 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
Wr™abËD©aba£
)

50 
	~<x­Ÿn/docum’t.h
>

51 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
Docum’t
)

53 
	~<x­Ÿn/qu”y.h
>

54 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
Qu”y
)

55 
XAPIAN_OUTPUT_FUNCTION_PTR
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
)

57 
	~<x­Ÿn/’quœe.h
>

58 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
RS‘
)

59 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
MS‘I‹¿tÜ
)

60 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
MS‘
)

61 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
ES‘I‹¿tÜ
)

62 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
ES‘
)

63 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
Enquœe
)

65 
	~<x­Ÿn/¡em.h
>

66 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
S‹m
)

68 
	~<x­Ÿn/po¡šg™”©Ü.h
>

69 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
Po¡šgI‹¿tÜ
)

71 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

72 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
Pos™iÚI‹¿tÜ
)

74 
	~<x­Ÿn/‹rm™”©Ü.h
>

75 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
T”mI‹¿tÜ
)

77 
	~<x­Ÿn/v®ue™”©Ü.h
>

78 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
V®ueI‹¿tÜ
)

80 
	~"»¶iÿtiÚ.h
"

81 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
D©aba£Ma¡”
)

82 
XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
D©aba£R•liÿ
)

84 
	~"weightš‹º®.h
"

85 
	$XAPIAN_OUTPUT_FUNCTION
(
T”mF»qs
)

86 
	`XAPIAN_OUTPUT_FUNCTION
(
X­Ÿn
::
Weight
::
IÁ”Çl
)

	@common/pack.h

21 #iâdeà
XAPIAN_INCLUDED_PACK_H


22 
	#XAPIAN_INCLUDED_PACK_H


	)

24 
	~<c¡ršg
>

25 
	~<¡ršg
>

27 
	~"omas£¹.h
"

28 
	~"omdebug.h
"

30 
	~"x­Ÿn/ty³s.h
"

38 cÚ¡ 
	gSORTABLE_UINT_LOG2_MAX_BYTES
 = 2;

41 cÚ¡ 
	gSORTABLE_UINT_MAX_BYTES
 = 1 << 
SORTABLE_UINT_LOG2_MAX_BYTES
;

44 cÚ¡ 
	gSORTABLE_UINT_1ST_BYTE_MASK
 =

45 (0xffu >> 
SORTABLE_UINT_LOG2_MAX_BYTES
);

52 
šlše
 

53 
·ck_boŞ
(
¡d
::
¡ršg
 & 
s
, 
boŞ
 
v®ue
)

55 
	gs
 +ğ('0' | 
¡©ic_ÿ¡
<>(
v®ue
));

64 
šlše
 
boŞ


65 
	$uÅack_boŞ
(cÚ¡ ** 
p
, cÚ¡ * 
’d
, 
boŞ
 * 
»suÉ
)

67 
	`As£¹
(
»suÉ
);

68 cÚ¡ * & 
±r
 = *
p
;

69 
	`As£¹
(
±r
);

70 
ch
;

71 ià(
	`¿»
(
±r
 =ğ
’d
 || ((
ch
 = *ptr++ - '0') &~ 1))) {

72 
±r
 = 
NULL
;

73  
çl£
;

75 *
»suÉ
 = 
¡©ic_ÿ¡
<
boŞ
>(
ch
);

76  
Œue
;

77 
	}
}

87 
	g‹m¶©e
<
şass
 
	gU
>

88 
šlše
 

89 
·ck_ušt_Ï¡
(
¡d
::
¡ršg
 & 
s
, 
U
 
v®ue
)

92 
STATIC_ASSERT_UNSIGNED_TYPE
(
U
);

94 
	gv®ue
) {

95 
	gs
 +ğ(
v®ue
 & 0xff);

96 
	gv®ue
 >>= 8;

106 
	g‹m¶©e
<
şass
 
	gU
>

107 
šlše
 
boŞ


108 
	$uÅack_ušt_Ï¡
(cÚ¡ ** 
p
, cÚ¡ * 
’d
, 
U
 * 
»suÉ
)

111 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
U
);

112 
	`As£¹
(
»suÉ
);

114 cÚ¡ * 
±r
 = *
p
;

115 
	`As£¹
(
±r
);

116 *
p
 = 
’d
;

119 ià(
	`¿»
(
’d
 - 
±r
 > ((
U
)))) {

120  
çl£
;

123 *
»suÉ
 = 0;

124 
’d
 !ğ
±r
) {

125 *
»suÉ
 = (*»suÉ << 8è| 
	`U
(
¡©ic_ÿ¡
<>(*--
’d
));

128  
Œue
;

129 
	}
}

143 
	g‹m¶©e
<
şass
 
	gU
>

144 
šlše
 

145 
·ck_ušt_´e£rvšg_sÜt
(
¡d
::
¡ršg
 & 
s
, 
U
 
v®ue
)

147 
LOGLINE
(
DB
, "Call…ack_unit_preserving_sort");

148 
LOGLINE
(
DB
, "P¬am s: " << 
s
 << ", v®ue: " << 
v®ue
);

150 
STATIC_ASSERT_UNSIGNED_TYPE
(
U
);

151 
STATIC_ASSERT
((
U
è<ğ
SORTABLE_UINT_MAX_BYTES
);

153 
	gtmp
[(
U
) + 1];

154 * 
	gp
 = 
tmp
 + (tmp);

157 *--
	gp
 = (
v®ue
 & 0xff);

158 
	gv®ue
 >>= 8;

159 } 
	gv®ue
 &~ 
	gSORTABLE_UINT_1ST_BYTE_MASK
);

161 
	gËn
 = 
¡©ic_ÿ¡
<>(
tmp
 + Ñmpè- 
p
);

162 *--
	gp
 = ((
Ën
 - 1è<< (8 - 
SORTABLE_UINT_LOG2_MAX_BYTES
è| 
v®ue
);

163 
	gs
.
­³nd
(
p
, 
Ën
 + 1);

164 
LOGLINE
(
DB
, "Aá”‡µ’d, s is: " << 
s
);

176 
	g‹m¶©e
<
şass
 
	gU
>

177 
šlše
 
boŞ


178 
	$uÅack_ušt_´e£rvšg_sÜt
(cÚ¡ ** 
p
, cÚ¡ * 
’d
, 
U
 * 
»suÉ
)

181 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
U
);

182 
	`STATIC_ASSERT
((
U
) < 256);

183 
	`As£¹
(
»suÉ
);

185 cÚ¡ * 
±r
 = *
p
;

186 
	`As£¹
(
±r
);

188 ià(
	`¿»
(
±r
 =ğ
’d
)) {

189  
çl£
;

192 
Ën_by‹
 = 
¡©ic_ÿ¡
<>(*
±r
++);

193 *
»suÉ
 = 
Ën_by‹
 & 
SORTABLE_UINT_1ST_BYTE_MASK
;

194 
size_t
 
Ën
 = (
Ën_by‹
 >> (8 - 
SORTABLE_UINT_LOG2_MAX_BYTES
)) + 1;

196 ià(
	`¿»
(
	`size_t
(
’d
 - 
±r
è< 
Ën
)) {

197  
çl£
;

200 
’d
 = 
±r
 + 
Ën
;

201 *
p
 = 
’d
;

204 ià(
	`¿»
(
Ën
 > ((
U
)))) {

205  
çl£
;

208 
±r
 !ğ
’d
) {

209 *
»suÉ
 = (*»suÉ << 8è| 
	`U
(
¡©ic_ÿ¡
<>(*
±r
++));

212  
Œue
;

213 
	}
}

220 
	g‹m¶©e
<
şass
 
	gU
>

221 
šlše
 

222 
·ck_ušt
(
¡d
::
¡ršg
 & 
s
, 
U
 
v®ue
)

225 
STATIC_ASSERT_UNSIGNED_TYPE
(
U
);

227 
	gv®ue
 >= 128) {

228 
s
 +ğ
¡©ic_ÿ¡
<>(¡©ic_ÿ¡<>(
v®ue
) | 0x80);

229 
	gv®ue
 >>= 7;

231 
	gs
 +ğ
¡©ic_ÿ¡
<>(
v®ue
);

240 
	g‹m¶©e
<
şass
 
	gU
>

241 
šlše
 
boŞ


242 
	$uÅack_ušt
(cÚ¡ ** 
p
, cÚ¡ * 
’d
, 
U
 * 
»suÉ
)

245 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
U
);

247 cÚ¡ * 
±r
 = *
p
;

248 
	`As£¹
(
±r
);

249 cÚ¡ * 
¡¬t
 = 
±r
;

253 ià(
	`¿»
(
±r
 =ğ
’d
)) {

255 *
p
 = 
NULL
;

256  
çl£
;

258 } 
¡©ic_ÿ¡
<>(*
±r
++) >= 128);

260 *
p
 = 
±r
;

262 ià(!
»suÉ
è 
Œue
;

264 *
»suÉ
 = 
	`U
(*--
±r
);

265 ià(
±r
 =ğ
¡¬t
) {

267  
Œue
;

270 
size_t
 
maxb™s
 = 
	`size_t
(
±r
 - 
¡¬t
) * 7;

271 ià(
maxb™s
 <ğ(
U
) * 8) {

274 
chunk
 = 
¡©ic_ÿ¡
<>(*--
±r
) & 0x7f;

275 *
»suÉ
 = (*»suÉ << 7è| 
	`U
(
chunk
);

276 } 
±r
 !ğ
¡¬t
);

277  
Œue
;

280 
size_t
 
mšb™s
 = 
maxb™s
 - 6;

281 ià(
	`¿»
(
mšb™s
 > (
U
) * 8)) {

283  
çl£
;

286 --
±r
 !ğ
¡¬t
) {

287 
chunk
 = 
¡©ic_ÿ¡
<>(*--
±r
) & 0x7f;

288 *
»suÉ
 = (*»suÉ << 7è| 
	`U
(
chunk
);

291 
U
 
tmp
 = *
»suÉ
;

292 *
»suÉ
 <<= 7;

293 ià(
	`¿»
(*
»suÉ
 < 
tmp
)) {

295  
çl£
;

297 *
»suÉ
 |ğ
	`U
(
¡©ic_ÿ¡
<>(*
±r
) & 0x7f);

298  
Œue
;

299 
	}
}

306 
šlše
 

307 
·ck_¡ršg
(
¡d
::
¡ršg
 & 
s
, cÚ¡ std::¡ršg & 
v®ue
)

309 
·ck_ušt
(
s
, 
v®ue
.
size
());

310 
	gs
 +ğ
v®ue
;

318 
šlše
 

319 
·ck_¡ršg
(
¡d
::
¡ršg
 & 
s
, cÚ¡ * 
±r
)

321 
As£¹
(
±r
);

322 
size_t
 
	gËn
 = 
¡d
::
¡¾’
(
±r
);

323 
·ck_ušt
(
s
, 
Ën
);

324 
	gs
.
­³nd
(
±r
, 
Ën
);

333 
šlše
 
boŞ


334 
uÅack_¡ršg
(cÚ¡ ** 
p
, cÚ¡ * 
’d
, 
¡d
::
¡ršg
 & 
»suÉ
)

336 
size_t
 
Ën
;

337 ià(
¿»
(!
uÅack_ušt
(
p
, 
’d
, &
Ën
))) {

338  
	gçl£
;

341 cÚ¡ * & 
	g±r
 = *
p
;

342 ià(
¿»
(
Ën
 > 
size_t
(
’d
 - 
±r
))) {

343 
	g±r
 = 
NULL
;

344  
	gçl£
;

347 
	g»suÉ
.
assign
(
±r
, 
Ën
);

348 
	g±r
 +ğ
Ën
;

349  
	gŒue
;

368 
šlše
 

369 
·ck_¡ršg_´e£rvšg_sÜt
(
¡d
::
¡ršg
 & 
s
, cÚ¡ std::¡ršg & 
v®ue
,

370 
boŞ
 
Ï¡
 = 
çl£
)

372 
¡d
::
¡ršg
::
size_ty³
 
b
 = 0, 
	ge
;

373 (
	ge
 = 
v®ue
.
fšd
('\0', 
b
)è!ğ
¡d
::
¡ršg
::
Åos
) {

374 ++
e
;

375 
	gs
.
­³nd
(
v®ue
, 
b
, 
e
 - b);

376 
	gs
 += '\xff';

377 
	gb
 = 
e
;

379 
	gs
.
­³nd
(
v®ue
, 
b
, 
¡d
::
¡ršg
::
Åos
);

380 ià(!
	gÏ¡
è
	gs
 += '\0';

391 
šlše
 
boŞ


392 
uÅack_¡ršg_´e£rvšg_sÜt
(cÚ¡ ** 
p
, cÚ¡ * 
’d
,

393 
¡d
::
¡ršg
 & 
»suÉ
)

395 
»suÉ
.
»size
(0);

397 cÚ¡ *
	g±r
 = *
p
;

398 
As£¹
(
±r
);

400 
	g±r
 !ğ
’d
) {

401 
ch
 = *
±r
++;

402 ià(
¿»
(
ch
 == '\0')) {

403 ià(
usu®
(
±r
 =ğ
’d
 || *ptr != '\xff')) {

406 ++
	g±r
;

408 
	g»suÉ
 +ğ
ch
;

410 *
	gp
 = 
±r
;

411  
	gŒue
;

414 
šlše
 
	g¡d
::
¡ršg


415 
·ck_ch”t_po¡li¡_key
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
)

418 ià(
‹rm
.
em±y
())

419  
¡d
::
¡ršg
("\x00\xe0", 2);

421 
	g¡d
::
¡ršg
 
key
;

422 
·ck_¡ršg_´e£rvšg_sÜt
(
key
, 
‹rm
, 
Œue
);

423  
	gkey
;

426 
šlše
 
	g¡d
::
¡ršg


427 
·ck_ch”t_po¡li¡_key
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
, 
X­Ÿn
::
docid
 
did
)

430 ià(
‹rm
.
em±y
()) {

431 
¡d
::
¡ršg
 
key
("\x00\xe0", 2);

432 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

433  
	gkey
;

436 
	g¡d
::
¡ršg
 
key
;

437 
·ck_¡ršg_´e£rvšg_sÜt
(
key
, 
‹rm
);

438 
·ck_ušt_´e£rvšg_sÜt
(
key
, 
did
);

439  
	gkey
;

442 
šlše
 
	g¡d
::
¡ršg


443 
·ck_b¿ss_po¡li¡_key
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
)

445  
·ck_ch”t_po¡li¡_key
(
‹rm
);

448 
šlše
 
	g¡d
::
¡ršg


449 
·ck_b¿ss_po¡li¡_key
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
, 
X­Ÿn
::
docid
 
did
)

451  
·ck_ch”t_po¡li¡_key
(
‹rm
, 
did
);

	@common/positionlist.h

23 #iâdeà
OM_HGUARD_POSITIONLIST_H


24 
	#OM_HGUARD_POSITIONLIST_H


	)

26 
	~<x­Ÿn/ty³s.h
>

27 
	~<x­Ÿn/”rÜ.h
>

28 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

33 şas 
	cX­Ÿn
::
Pos™iÚI‹¿tÜ
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£


35 
´iv©e
:

37 
IÁ”Çl
(const Internal &);

40 
	mİ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

41 
	mpublic
:

43 
	$IÁ”Çl
() { }

46 
vœtu®
 ~
	$IÁ”Çl
(è{ 
	}
}

52 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_size
() const = 0;

55 
vœtu®
 
X­Ÿn
::
‹rmpos
 
	$g‘_pos™iÚ
() const = 0;

62 
vœtu®
 
	`Ãxt
() = 0;

69 
vœtu®
 
	`sk_to
(
X­Ÿn
::
‹rmpos
ermpos) = 0;

73 
vœtu®
 
boŞ
 
	$©_’d
() const = 0;

80 
X­Ÿn
::
‹rmcouÁ
 
šdex
;

81 
	}
};

83 
	gX­Ÿn
::
	tPos™iÚI‹¿tÜ
::
	tIÁ”Çl
 
	tPos™iÚLi¡
;

	@common/postlist.h

22 #iâdeà
XAPIAN_INCLUDED_POSTLIST_H


23 
	#XAPIAN_INCLUDED_POSTLIST_H


	)

25 
	~<¡ršg
>

27 
	~<x­Ÿn/ba£.h
>

28 
	~<x­Ÿn/ty³s.h
>

29 
	~<x­Ÿn/po¡šg™”©Ü.h
>

31 
	~"pos™iÚli¡.h
"

32 
	~"weightš‹º®.h
"

35 şas 
	cX­Ÿn
::
Po¡šgI‹¿tÜ
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

37 
İ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

40 
IÁ”Çl
(const Internal &);

42 
	m´Ùeùed
:

44 
	$IÁ”Çl
() { }

46 
public
:

50 
vœtu®
 ~
	`IÁ”Çl
();

53 
vœtu®
 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const = 0;

56 
vœtu®
 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const = 0;

63 
vœtu®
 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const = 0;

71 
vœtu®
 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

72 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

75 
vœtu®
 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const = 0;

78 
vœtu®
 
X­Ÿn
::
docid
 
	$g‘_docid
() const = 0;

81 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const = 0;

90 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

93 
vœtu®
 
X­Ÿn
::
weight
 
	$g‘_weight
() const = 0;

101 
vœtu®
 cÚ¡ 
¡d
::
¡ršg
 * 
	$g‘_cŞÏp£_key
() const;

104 
vœtu®
 
boŞ
 
	$©_’d
() const = 0;

114 
vœtu®
 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
() = 0;

121 
vœtu®
 
Pos™iÚLi¡
 * 
	`»ad_pos™iÚ_li¡
();

128 
vœtu®
 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

144 
vœtu®
 
IÁ”Çl
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
) = 0;

159 
vœtu®
 
IÁ”Çl
 * 
	`sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
 
w_mš
) = 0;

180 
vœtu®
 
IÁ”Çl
 * 
	`check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
,

181 
boŞ
 &
v®id
);

187 
IÁ”Çl
 * 
	$Ãxt
(è{  
	`Ãxt
(0.0); 
	}
}

193 
IÁ”Çl
 * 
sk_to
(
X­Ÿn
::
docid
 
did
) {  skip_to(did, 0.0); }

196 
vœtu®
 
	gX­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

199 
vœtu®
 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const = 0;

200 
	}
};

204 
	gX­Ÿn
::
	tPo¡šgI‹¿tÜ
::
	tIÁ”Çl
 
	tPo¡Li¡
;

	@common/progclient.h

21 #iâdeà
XAPIAN_INCLUDED_PROGCLIENT_H


22 
	#XAPIAN_INCLUDED_PROGCLIENT_H


	)

24 
	~<sys/ty³s.h
>

26 
	~"»mÙe-d©aba£.h
"

34 şas 
	cProgCl›Á
 : 
public
 
RemÙeD©aba£
 {

36 
İ”©Ü
=(cÚ¡ 
ProgCl›Á
 &);

39 
ProgCl›Á
(const ProgClient &);

41 #iâdeà
__WIN32__


43 
pid_t
 
	mpid
;

59 
run_´og¿m
(cÚ¡ 
¡d
::
¡ršg
 &
´ogÇme
,

60 cÚ¡ 
¡d
::
¡ršg
 &
¬gs


61 #iâdeà
__WIN32__


62 , 
pid_t
 &
pid


75 
	m¡d
::
¡ršg
 
g‘_´ogcÚ‹xt
(cÚ¡ 
¡d
::¡ršg &
´ogÇme
,

76 cÚ¡ 
¡d
::
¡ršg
 &
¬gs
);

78 
	mpublic
:

86 
ProgCl›Á
(cÚ¡ 
¡d
::
¡ršg
 &
´ogÇme
,

87 cÚ¡ 
¡d
::
¡ršg
 &
¬g
,

88 
m£cs_timeout
,

89 
boŞ
 
wr™abË
);

92 ~
ProgCl›Á
();

	@common/registryinternal.h

22 #iâdeà
XAPIAN_INCLUDED_REGISTRYINTERNAL_H


23 
	#XAPIAN_INCLUDED_REGISTRYINTERNAL_H


	)

25 
	~"x­Ÿn/ba£.h
"

26 
	~"x­Ÿn/»gi¡ry.h
"

28 
	~<m­
>

29 
	~<¡ršg
>

31 
Çme¥aû
 
	gX­Ÿn
 {

32 
şass
 
	gWeight
;

33 
şass
 
	gPo¡šgSourû
;

34 
şass
 
	gM©chSpy
;

37 şas 
	cX­Ÿn
::
Regi¡ry
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

38 
ä›nd
 
şass
 
X­Ÿn
::
Regi¡ry
;

41 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mX­Ÿn
::
Weight
 *> 
wtschemes
;

44 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mX­Ÿn
::
Po¡šgSourû
 *> 
po¡šgsourûs
;

47 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mX­Ÿn
::
M©chSpy
 *> 
m©ch¥›s
;

50 
add_deçuÉs
();

53 
ş—r_weightšg_schemes
();

56 
ş—r_po¡šg_sourûs
();

59 
ş—r_m©ch_¥›s
();

61 
	mpublic
:

62 
IÁ”Çl
();

63 ~
IÁ”Çl
();

	@common/remote-database.h

22 #iâdeà
XAPIAN_INCLUDED_REMOTE_DATABASE_H


23 
	#XAPIAN_INCLUDED_REMOTE_DATABASE_H


	)

25 
	~"d©aba£.h
"

26 
	~"om’quœeš‹º®.h
"

27 
	~"omqu”yš‹º®.h
"

28 
	~"omtime.h
"

29 
	~"»mÙecÚÃùiÚ.h
"

30 
	~"v®ue¡©s.h
"

31 
	~"x­Ÿn/weight.h
"

33 
Çme¥aû
 
	gX­Ÿn
 {

34 
şass
 
	gRS‘
;

37 
şass
 
	gN‘wÜkPo¡Li¡
;

45 şas 
	cRemÙeD©aba£
 : 
public
 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 {

47 
İ”©Ü
=(cÚ¡ 
RemÙeD©aba£
 &);

50 
RemÙeD©aba£
(const RemoteDatabase &);

53 
mubË
 
RemÙeCÚÃùiÚ
 
	mlšk
;

56 
mubË
 
	mX­Ÿn
::
doccouÁ
 doccount;

59 
mubË
 
	mX­Ÿn
::
docid
 
Ï¡docid
;

62 
mubË
 
	mX­Ÿn
::
‹rmcouÁ
 
doş’_lbound
;

65 
mubË
 
	mX­Ÿn
::
‹rmcouÁ
 
doş’_ubound
;

68 
mubË
 
tÙËn_t
 
	mtÙ®_Ëngth
;

71 
mubË
 
boŞ
 
	mhas_pos™iÚ®_šfo
;

74 
mubË
 
¡ršg
 
	muuid
;

77 
¡ršg
 
	mcÚ‹xt
;

79 
mubË
 
boŞ
 
	mÿched_¡©s_v®id
;

82 
mubË
 
V®ueSts
 
	mmru_v®¡©s
;

88 
mubË
 
	mX­Ÿn
::
v®u’o
 
mru_v®no
;

90 
	$upd©e_¡©s
(
mes§ge_ty³
 
msg_code
 = 
MSG_UPDATE
) const;

92 
´Ùeùed
:

106 
	`RemÙeD©aba£
(
fd
, 
X­Ÿn
::
timeout
 
timeout_
, cÚ¡ 
¡ršg
 & 
cÚ‹xt_
,

107 
boŞ
 
wr™abË
);

110 
»¶y_ty³
 
	$g‘_mes§ge
(
¡ršg
 & 
mes§ge
, 
»¶y_ty³
 
»quœed_ty³
 = 
REPLY_MAX
) const;

113 
	$£nd_mes§ge
(
mes§ge_ty³
 
ty³
, cÚ¡ 
¡ršg
 & 
d©a
) const;

116 
	`do_şo£
();

118 
boŞ
 
	`g‘_po¡šg
(
X­Ÿn
::
docid
 &
did
, X­Ÿn::
weight
 &
w
, 
¡ršg
 &
v®ue
);

121 
X­Ÿn
::
timeout
imeout;

123 
public
:

125 
RemÙeD©aba£
 * 
	`as_»mÙed©aba£
();

128 
	`k“p_®ive
();

148 
	`£t_qu”y
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
,

149 
X­Ÿn
::
‹rmcouÁ
 
qËn
,

150 
X­Ÿn
::
doccouÁ
 
cŞÏp£_max
,

151 
X­Ÿn
::
v®u’o
 
cŞÏp£_key
,

152 
X­Ÿn
::
Enquœe
::
docid_Üd”
 
Üd”
,

153 
X­Ÿn
::
v®u’o
 
sÜt_key
,

154 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
sÜt_by
,

155 
boŞ
 
sÜt_v®ue_fÜw¬d
,

156 
³rûÁ_cutoff
, 
X­Ÿn
::
weight
 
weight_cutoff
,

157 cÚ¡ 
X­Ÿn
::
Weight
 *
wtscheme
,

158 cÚ¡ 
X­Ÿn
::
RS‘
 &
omr£t
,

159 cÚ¡ 
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s
);

165 
boŞ
 
	`g‘_»mÙe_¡©s
(boŞ 
nowa™
, 
X­Ÿn
::
Weight
::
IÁ”Çl
 &
out
);

168 
	`£nd_glob®_¡©s
(
X­Ÿn
::
doccouÁ
 
fœ¡
,

169 
X­Ÿn
::
doccouÁ
 
max™ems
,

170 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

171 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 &
¡©s
);

174 
	`g‘_m£t
(
X­Ÿn
::
MS‘
 &
m£t
,

175 cÚ¡ 
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s
);

178 
T”mLi¡
 * 
	`İ’_‹rm_li¡
(
X­Ÿn
::
docid
 
did
) const;

181 
T”mLi¡
 * 
	$İ’_®É”ms
(cÚ¡ 
¡ršg
 & 
´efix
) const;

183 
boŞ
 
	$has_pos™iÚs
() const;

185 
	`»İ’
();

187 
	`şo£
();

189 
L—fPo¡Li¡
 * 
	$İ’_po¡_li¡
(cÚ¡ 
¡ršg
 & 
Šame
) const;

191 
X­Ÿn
::
doccouÁ
 
	$»ad_po¡_li¡
(cÚ¡ 
¡ršg
 &
‹rm
, 
N‘wÜkPo¡Li¡
 & 
¶
) const;

193 
Pos™iÚLi¡
 * 
	`İ’_pos™iÚ_li¡
(
X­Ÿn
::
docid
 
did
,

194 cÚ¡ 
¡ršg
 & 
Šame
) const;

197 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
	`İ’_docum’t
(X­Ÿn::
docid
 
did
, 
boŞ
 
Ïzy
) const;

200 
X­Ÿn
::
doccouÁ
 
	$g‘_doccouÁ
() const;

203 
X­Ÿn
::
docid
 
	$g‘_Ï¡docid
() const;

205 
tÙËn_t
 
	$g‘_tÙ®_Ëngth
() const;

208 
X­Ÿn
::
doş’gth
 
	$g‘_avËngth
() const;

210 
X­Ÿn
::
‹rmcouÁ
 
	`g‘_doş’gth
(X­Ÿn::
docid
 
did
) const;

213 
boŞ
 
	$‹rm_exi¡s
(cÚ¡ 
¡ršg
 & 
Šame
) const;

216 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

218 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡ršg
 & 
Šame
) const;

221 
	`»ad_v®ue_¡©s
(
X­Ÿn
::
v®u’o
 
v®no
) const;

222 
X­Ÿn
::
doccouÁ
 
	`g‘_v®ue_äeq
(X­Ÿn::
v®u’o
 
v®no
) const;

223 
¡d
::
¡ršg
 
	`g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

224 
¡d
::
¡ršg
 
	`g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

226 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_low”_bound
() const;

227 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth_uµ”_bound
() const;

228 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf_uµ”_bound
(cÚ¡ 
¡ršg
 & 
‹rm
) const;

230 
	`comm™
();

232 
	`ÿnûl
();

234 
X­Ÿn
::
docid
 
	`add_docum’t
(cÚ¡ X­Ÿn::
Docum’t
 & 
doc
);

236 
	`d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
);

237 
	`d–‘e_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
unique_‹rm
);

239 
	`»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
, cÚ¡ X­Ÿn::
Docum’t
 & 
doc
);

240 
X­Ÿn
::
docid
 
	`»¶aû_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
unique_‹rm
,

241 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
);

243 
¡d
::
¡ršg
 
	$g‘_uuid
() const;

245 
¡ršg
 
	$g‘_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
) const;

247 
	`£t_m‘ad©a
(cÚ¡ 
¡ršg
 & 
key
, cÚ¡ sŒšg & 
v®ue
);

	@common/remoteconnection.h

21 #iâdeà
XAPIAN_INCLUDED_REMOTECONNECTION_H


22 
	#XAPIAN_INCLUDED_REMOTECONNECTION_H


	)

24 
	~<¡ršg
>

26 
	~"»mÙ•rÙocŞ.h
"

27 
	~"§ãuni¡d.h
"

29 #ifdeà
__WIN32__


30 
	~"§ãwšsock2.h
"

32 
	~<x­Ÿn/”rÜ.h
>

47 
	sWšsockIn™Ÿliz”
 {

48 
WšsockIn™Ÿliz”
() {

49 
WSADATA
 
	mw§d©a
;

50 
	mw§”rÜ
 = 
WSAS¹up
(
MAKEWORD
(2,2), &
w§d©a
);

54 ià(
	mw§”rÜ
 != 0) {

55 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("FaedØš™Ÿlizwšsock", "", 
w§”rÜ
);

59 ~
WšsockIn™Ÿliz”
() {

60 
WSACËªup
();

72 
šlše
 
	$sock‘_”ºo
() {

73  -()
	`WSAG‘La¡E¼Ü
();

74 
	}
}

78 
	#EADDRINUSE
 (-(
WSAEADDRINUSE
))

	)

79 
	#ETIMEDOUT
 (-(
WSAETIMEDOUT
))

	)

80 
	#EINPROGRESS
 (-(
WSAEINPROGRESS
))

	)

84 
	#sock‘_”ºo
(è
”ºo


	)

87 
şass
 
	gOmTime
;

96 şas 
	cRemÙeCÚÃùiÚ
 {

98 
	mİ”©Ü
=(cÚ¡ 
RemÙeCÚÃùiÚ
 &);

101 
RemÙeCÚÃùiÚ
(const RemoteConnection &);

108 
	mfdš
;

116 
	mfdout
;

119 
	m¡d
::
¡ršg
 
bufãr
;

122 
off_t
 
	mchunked_d©a_Ëá
;

133 
»ad_©_Ëa¡
(
size_t
 
mš_Ën
, cÚ¡ 
OmTime
 & 
’d_time
);

135 #ifdeà
__WIN32__


141 
WSAOVERLAPPED
 
	mov”Ïµed
;

147 
DWORD
 
ÿlc_»ad_wa™_m£cs
(cÚ¡ 
OmTime
 & 
’d_time
);

150 
	m´Ùeùed
:

155 
¡d
::
¡ršg
 
cÚ‹xt
;

157 
	mpublic
:

159 
RemÙeCÚÃùiÚ
(
fdš_
, 
fdout_
, cÚ¡ 
¡d
::
¡ršg
 & 
cÚ‹xt_
);

161 ~
RemÙeCÚÃùiÚ
();

167 
boŞ
 
	$»ady_to_»ad
() const;

185 
	`¢iff_Ãxt_mes§ge_ty³
(cÚ¡ 
OmTime
 & 
’d_time
);

197 
	`g‘_mes§ge
(
¡d
::
¡ršg
 &
»suÉ
, cÚ¡ 
OmTime
 & 
’d_time
);

215 
	`g‘_mes§ge_chunked
(cÚ¡ 
OmTime
 & 
’d_time
);

235 
boŞ
 
	`g‘_mes§ge_chunk
(
¡d
::
¡ršg
 &
»suÉ
, 
size_t
 
©_Ëa¡
,

236 cÚ¡ 
OmTime
 & 
’d_time
);

249 
	`»ûive_fe
(cÚ¡ 
¡d
::
¡ršg
 &
fe
, cÚ¡ 
OmTime
 & 
’d_time
);

260 
	`£nd_mes§ge
(
ty³
, cÚ¡ 
¡d
::
¡ršg
 & 
s
, cÚ¡ 
OmTime
 & 
’d_time
);

271 
	`£nd_fe
(
ty³
, cÚ¡ 
¡d
::
¡ršg
 &
fe
, cÚ¡ 
OmTime
 & 
’d_time
);

278 
	`do_şo£
(
boŞ
 
wa™
);

	@common/remoteprotocol.h

22 #iâdeà
XAPIAN_INCLUDED_REMOTEPROTOCOL_H


23 
	#XAPIAN_INCLUDED_REMOTEPROTOCOL_H


	)

46 
	#XAPIAN_REMOTE_PROTOCOL_MAJOR_VERSION
 34

	)

47 
	#XAPIAN_REMOTE_PROTOCOL_MINOR_VERSION
 0

	)

54 
	emes§ge_ty³
 {

55 
	mMSG_ALLTERMS
,

56 
	mMSG_COLLFREQ
,

57 
	mMSG_DOCUMENT
,

58 
	mMSG_TERMEXISTS
,

59 
	mMSG_TERMFREQ
,

60 
	mMSG_VALUESTATS
,

61 
	mMSG_KEEPALIVE
,

62 
	mMSG_DOCLENGTH
,

63 
	mMSG_QUERY
,

64 
	mMSG_TERMLIST
,

65 
	mMSG_POSITIONLIST
,

66 
	mMSG_POSTLIST
,

67 
	mMSG_REOPEN
,

68 
	mMSG_UPDATE
,

69 
	mMSG_ADDDOCUMENT
,

70 
	mMSG_CANCEL
,

71 
	mMSG_DELETEDOCUMENTTERM
,

72 
	mMSG_COMMIT
,

73 
	mMSG_REPLACEDOCUMENT
,

74 
	mMSG_REPLACEDOCUMENTTERM
,

75 
	mMSG_DELETEDOCUMENT
,

76 
	mMSG_WRITEACCESS
,

77 
	mMSG_GETMETADATA
,

78 
	mMSG_SETMETADATA
,

79 
	mMSG_GETMSET
,

80 
	mMSG_SHUTDOWN
,

81 
	mMSG_MAX


85 
	e»¶y_ty³
 {

86 
	mREPLY_GREETING
,

87 
	mREPLY_EXCEPTION
,

88 
	mREPLY_DONE
,

89 
	mREPLY_ALLTERMS
,

90 
	mREPLY_COLLFREQ
,

91 
	mREPLY_DOCDATA
,

92 
	mREPLY_TERMDOESNTEXIST
,

93 
	mREPLY_TERMEXISTS
,

94 
	mREPLY_TERMFREQ
,

95 
	mREPLY_VALUESTATS
,

96 
	mREPLY_DOCLENGTH
,

97 
	mREPLY_STATS
,

98 
	mREPLY_TERMLIST
,

99 
	mREPLY_POSITIONLIST
,

100 
	mREPLY_POSTLISTSTART
,

101 
	mREPLY_POSTLISTITEM
,

102 
	mREPLY_UPDATE
,

103 
	mREPLY_VALUE
,

104 
	mREPLY_ADDDOCUMENT
,

105 
	mREPLY_RESULTS
,

106 
	mREPLY_METADATA
,

107 
	mREPLY_MAX


	@common/remoteserver.h

22 #iâdeà
XAPIAN_INCLUDED_REMOTESERVER_H


23 
	#XAPIAN_INCLUDED_REMOTESERVER_H


	)

25 
	~"x­Ÿn/d©aba£.h
"

26 
	~"x­Ÿn/po¡šgsourû.h
"

27 
	~"x­Ÿn/»gi¡ry.h
"

28 
	~"x­Ÿn/visib™y.h
"

29 
	~"x­Ÿn/weight.h
"

31 
	~"»mÙecÚÃùiÚ.h
"

33 
	~<¡ršg
>

36 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mRemÙeS”v”
 : 
´iv©e
 
RemÙeCÚÃùiÚ
 {

38 
İ”©Ü
=(cÚ¡ 
RemÙeS”v”
 &);

41 
RemÙeS”v”
(const RemoteServer &);

47 
	mX­Ÿn
::
D©aba£
 * 
db
;

50 
	mX­Ÿn
::
Wr™abËD©aba£
 * 
wdb
;

53 
boŞ
 
	mwr™abË
;

60 
	mX­Ÿn
::
timeout
 
aùive_timeout
;

67 
	mX­Ÿn
::
timeout
 
idË_timeout
;

70 
	mX­Ÿn
::
Regi¡ry
 
»g
;

73 
mes§ge_ty³
 
g‘_mes§ge
(
X­Ÿn
::
timeout
imeout, 
¡d
::
¡ršg
 & 
»suÉ
,

74 
mes§ge_ty³
 
»quœed_ty³
 = 
MSG_MAX
);

77 
£nd_mes§ge
(
»¶y_ty³
 
ty³
, cÚ¡ 
¡d
::
¡ršg
 &
mes§ge
);

80 
msg_®É”ms
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

83 
msg_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

86 
msg_‹rmexi¡s
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

89 
msg_cŞläeq
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

92 
msg_‹rmäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

95 
msg_v®ue¡©s
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

98 
msg_k“·live
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

101 
msg_doş’gth
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

104 
msg_qu”y
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

107 
msg_‹rmli¡
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

110 
msg_po¡li¡
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

113 
msg_pos™iÚli¡
(cÚ¡ 
¡d
::
¡ršg
 &
mes§ge
);

116 
msg_wr™—cûss
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

119 
msg_»İ’
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

122 
msg_upd©e
(cÚ¡ 
¡d
::
¡ršg
 &
mes§ge
);

125 
msg_comm™
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

128 
msg_ÿnûl
(cÚ¡ 
¡d
::
¡ršg
 &
mes§ge
);

131 
msg_adddocum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

134 
msg_d–‘edocum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

137 
msg_d–‘edocum’‰”m
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

140 
msg_»¶aûdocum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

143 
msg_»¶aûdocum’‰”m
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

146 
msg_g‘m‘ad©a
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

149 
msg_£tm‘ad©a
(cÚ¡ 
¡d
::
¡ršg
 & 
mes§ge
);

151 
	mpublic
:

164 
RemÙeS”v”
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
db·ths
,

165 
fdš
, 
fdout
,

166 
X­Ÿn
::
timeout
 
aùive_timeout_
,

167 
X­Ÿn
::
timeout
 
idË_timeout_
,

168 
boŞ
 
wr™abË
 = 
çl£
);

171 ~
RemÙeS”v”
();

178 
run
();

181 cÚ¡ 
	mX­Ÿn
::
Regi¡ry
 & 
	$g‘_»gi¡ry
(ècÚ¡ {  
»g
; }

184 
	`£t_»gi¡ry
(cÚ¡ 
X­Ÿn
::
Regi¡ry
 & 
»g_
è{ 
»g
 =„eg_; 
	}
}

	@common/remotetcpclient.h

21 #iâdeà
XAPIAN_INCLUDED_REMOTETCPCLIENT_H


22 
	#XAPIAN_INCLUDED_REMOTETCPCLIENT_H


	)

24 
	~"»mÙe-d©aba£.h
"

26 #ifdeà
__WIN32__


27 
	#SOCKET_INITIALIZER_MIXIN
 
´iv©e
 
WšsockIn™Ÿliz”
,

	)

29 
	#SOCKET_INITIALIZER_MIXIN


	)

36 şas 
	cRemÙeTıCl›Á
 : 
SOCKET_INITIALIZER_MIXIN
 
public
 
RemÙeD©aba£
 {

38 
İ”©Ü
=(cÚ¡ 
RemÙeTıCl›Á
 &);

41 
RemÙeTıCl›Á
(const RemoteTcpClient &);

53 
İ’_sock‘
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡Çme
, 
pÜt
,

54 
m£cs_timeout_cÚÃù
);

62 
	m¡d
::
¡ršg
 
g‘_tıcÚ‹xt
(cÚ¡ 
¡d
::¡ršg & 
ho¡Çme
, 
pÜt
);

64 
	mpublic
:

76 
RemÙeTıCl›Á
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡Çme
, 
pÜt
,

77 
m£cs_timeout
, 
m£cs_timeout_cÚÃù
, 
boŞ
 
wr™abË
)

78 : 
RemÙeD©aba£
(
İ’_sock‘
(
ho¡Çme
, 
pÜt
, 
m£cs_timeout_cÚÃù
),

79 
m£cs_timeout
, 
g‘_tıcÚ‹xt
(
ho¡Çme
, 
pÜt
),

80 
wr™abË
) { }

83 ~
RemÙeTıCl›Á
();

	@common/remotetcpserver.h

21 #iâdeà
XAPIAN_INCLUDED_REMOTETCPSERVER_H


22 
	#XAPIAN_INCLUDED_REMOTETCPSERVER_H


	)

24 
	~"tı£rv”.h
"

26 
	~<x­Ÿn/d©aba£.h
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~<¡ršg
>

30 
	~<veùÜ
>

36 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mRemÙeTıS”v”
 : 
public
 
TıS”v”
 {

38 
İ”©Ü
=(cÚ¡ 
RemÙeTıS”v”
 &);

41 
RemÙeTıS”v”
(const RemoteTcpServer &);

47 cÚ¡ 
	m¡d
::
veùÜ
<
¡d
::
¡ršg
> 
db·ths
;

50 
boŞ
 
	mwr™abË
;

53 
	mm£cs_aùive_timeout
;

56 
	mm£cs_idË_timeout
;

59 
acû±_cÚÃùiÚ
();

61 
	mpublic
:

77 
RemÙeTıS”v”
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
db·ths_
,

78 cÚ¡ 
¡d
::
¡ršg
 &
ho¡
, 
pÜt
,

79 
m£cs_aùive_timeout
,

80 
m£cs_idË_timeout
,

81 
boŞ
 
wr™abË
,

82 
boŞ
 
v”bo£
);

88 
hªdË_Úe_cÚÃùiÚ
(
sock‘
);

	@common/replicatetcpclient.h

21 #iâdeà
XAPIAN_INCLUDED_REPLICATETCPCLIENT_H


22 
	#XAPIAN_INCLUDED_REPLICATETCPCLIENT_H


	)

24 
	~"»mÙecÚÃùiÚ.h
"

26 
	~"x­Ÿn/visib™y.h
"

27 
	~"»¶iÿtiÚ.h
"

29 #ifdeà
__WIN32__


30 
	#SOCKET_INITIALIZER_MIXIN
 : 
´iv©e
 
WšsockIn™Ÿliz”


	)

32 
	#SOCKET_INITIALIZER_MIXIN


	)

36 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
R•liÿ‹TıCl›Á
 
	mSOCKET_INITIALIZER_MIXIN
 {

38 
	mİ”©Ü
=(cÚ¡ 
R•liÿ‹TıCl›Á
 &);

41 
R•liÿ‹TıCl›Á
(const ReplicateTcpClient &);

44 
	msock‘
;

47 
RemÙeCÚÃùiÚ
 
	m»mcÚn
;

59 
İ’_sock‘
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡Çme
, 
pÜt
,

60 
m£cs_timeout_cÚÃù
);

62 
	mpublic
:

71 
R•liÿ‹TıCl›Á
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡Çme
, 
pÜt
,

72 
m£cs_timeout_cÚÃù
);

74 
upd©e_äom_ma¡”
(cÚ¡ 
¡d
::
¡ršg
 & 
·th
,

75 cÚ¡ 
¡d
::
¡ršg
 & 
»mÙedb
,

76 
X­Ÿn
::
R•liÿtiÚInfo
 & 
šfo
);

79 ~
R•liÿ‹TıCl›Á
();

	@common/replicatetcpserver.h

21 #iâdeà
XAPIAN_INCLUDED_REPLICATETCPSERVER_H


22 
	#XAPIAN_INCLUDED_REPLICATETCPSERVER_H


	)

24 
	~"»mÙecÚÃùiÚ.h
"

25 
	~"tı£rv”.h
"

27 
	~"x­Ÿn/visib™y.h
"

28 
	~"»¶iÿtiÚ.h
"

30 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	mR•liÿ‹TıS”v”
 : 
public
 
TıS”v”
 {

32 
¡d
::
¡ršg
 
·th
;

34 
	mpublic
:

42 
R•liÿ‹TıS”v”
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡
, 
pÜt
,

43 cÚ¡ 
¡d
::
¡ršg
 & 
·th_
);

46 ~
R•liÿ‹TıS”v”
();

52 
hªdË_Úe_cÚÃùiÚ
(
sock‘
);

	@common/replication.h

23 #iâdeà
XAPIAN_INCLUDED_REPLICATION_H


24 
	#XAPIAN_INCLUDED_REPLICATION_H


	)

26 
	~"x­Ÿn/ba£.h
"

27 
	~"x­Ÿn/visib™y.h
"

29 
	~<¡ršg
>

31 
Çme¥aû
 
	gX­Ÿn
 {

34 
XAPIAN_VISIBILITY_DEFAULT
 
	gR•liÿtiÚInfo
 {

36 
	gchªge£t_couÁ
;

39 
	gfuÎcİy_couÁ
;

46 
boŞ
 
	gchªged
;

48 
R•liÿtiÚInfo
()

49 : 
chªge£t_couÁ
(0),

50 
fuÎcİy_couÁ
(0),

51 
chªged
(
çl£
)

54 
ş—r
() {

55 
	gchªge£t_couÁ
 = 0;

56 
	gfuÎcİy_couÁ
 = 0;

57 
	gchªged
 = 
çl£
;

62 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£Ma¡”
 {

64 
	g¡d
::
¡ršg
 
·th
;

66 
	gpublic
:

72 
D©aba£Ma¡”
(cÚ¡ 
¡d
::
¡ršg
 & 
·th_
è: 
·th
(path_) {}

102 
wr™e_chªge£ts_to_fd
(
fd
,

103 cÚ¡ 
¡d
::
¡ršg
 & 
¡¬t_»visiÚ
,

104 
R•liÿtiÚInfo
 * 
šfo
) const;

107 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

115 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£R•liÿ
 {

117 
şass
 
	gIÁ”Çl
;

119 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

121 
	gpublic
:

123 
D©aba£R•liÿ
(cÚ¡ D©aba£R•liÿ & 
Ùh”
);

126 
	gİ”©Ü
=(cÚ¡ 
D©aba£R•liÿ
 & 
Ùh”
);

129 
D©aba£R•liÿ
();

132 ~
D©aba£R•liÿ
();

146 
D©aba£R•liÿ
(cÚ¡ 
¡d
::
¡ršg
 & 
·th
);

156 
	g¡d
::
¡ršg
 
g‘_»visiÚ_šfo
() const;

165 
£t_»ad_fd
(
fd
);

194 
boŞ
 
­¶y_Ãxt_chªge£t
(
R•liÿtiÚInfo
 * 
šfo
);

203 
şo£
();

206 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

	@common/replicationprotocol.h

21 #iâdeà
XAPIAN_INCLUDED_REPLICATIONPROTOCOL_H


22 
	#XAPIAN_INCLUDED_REPLICATIONPROTOCOL_H


	)

26 
	#XAPIAN_REPLICATION_PROTOCOL_MAJOR_VERSION
 1

	)

27 
	#XAPIAN_REPLICATION_PROTOCOL_MINOR_VERSION
 0

	)

30 
	e»¶iÿ‹_»¶y_ty³
 {

31 
	mREPL_REPLY_END_OF_CHANGES
,

32 
	mREPL_REPLY_FAIL
,

33 
	mREPL_REPLY_DB_HEADER
,

34 
	mREPL_REPLY_DB_FILENAME
,

35 
	mREPL_REPLY_DB_FILEDATA
,

36 
	mREPL_REPLY_DB_FOOTER
,

37 
	mREPL_REPLY_CHANGESET


43 
	#MAX_DB_COPIES_PER_CONVERSATION
 5

	)

	@common/rset.h

23 #iâdeà
OM_HGUARD_RSET_H


24 
	#OM_HGUARD_RSET_H


	)

26 
	~<£t
>

27 
	~"omas£¹.h
"

28 
	~"omdebug.h
"

29 
	~"x­Ÿn/’quœe.h
"

30 
	~"om’quœeš‹º®.h
"

31 
	~"x­Ÿn/weight.h
"

32 
	~"weightš‹º®.h
"

39 şas 
	cRS‘I
 {

40 
	m´iv©e
:

42 
RS‘I
(const RSetI &);

43 
	mİ”©Ü
=(cÚ¡ 
RS‘I
 &);

46 cÚ¡ 
	mX­Ÿn
::
D©aba£
 
roÙ
;

47 cÚ¡ 
	mX­Ÿn
::
D©aba£
::
IÁ”Çl
 *
dbroÙ
;

49 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mX­Ÿn
::
doccouÁ
> 
»É”mäeqs
;

50 
boŞ
 
	mÿlcuÏ‹d_»É”mäeqs
;

56 
ÿlcuÏ‹_¡©s
();

57 
	mpublic
:

58 
¡d
::
£t
<
X­Ÿn
::
docid
> 
docum’ts
;

60 
RS‘I
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
roÙ_
, cÚ¡ X­Ÿn::
RS‘
 & 
r£t
);

61 
RS‘I
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
dbroÙ_
, cÚ¡ X­Ÿn::
RS‘
 & 
r£t
);

67 
wl_wªt_»É”mäeq
(cÚ¡ 
¡ršg
 & 
Šame
);

75 
cÚŒibu‹_¡©s
(
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
);

78 
	mX­Ÿn
::
doccouÁ
 
	$size
(ècÚ¡ {  
docum’ts
.
	`size
(); }

81 
boŞ
 
	$em±y
(ècÚ¡ {  
docum’ts
.
	`em±y
(); 
	}
}

89 
šlše


90 
	gRS‘I
::
RS‘I
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
roÙ_
, cÚ¡ X­Ÿn::
RS‘
 & 
r£t
)

91 : 
roÙ
(
roÙ_
), 
dbroÙ
(
NULL
), 
ÿlcuÏ‹d_»É”mäeqs
(
çl£
),

92 
docum’ts
(
r£t
.
š‹º®
->
	$g‘_™ems
())

94 
	}
}

97 
šlše


98 
	gRS‘I
::
RS‘I
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
dbroÙ_
, cÚ¡ X­Ÿn::
RS‘
 & 
r£t
)

99 : 
dbroÙ
(
dbroÙ_
), 
ÿlcuÏ‹d_»É”mäeqs
(
çl£
),

100 
docum’ts
(
r£t
.
š‹º®
->
	$g‘_™ems
())

102 
	}
}

104 
šlše
 

105 
	gRS‘I
::
	$wl_wªt_»É”mäeq
(cÚ¡ 
¡ršg
 & 
Šame
)

107 
»É”mäeqs
[
Šame
] = 0;

108 
	}
}

	@common/safe.cc

21 
	~<cÚfig.h
>

23 #ifdeà
__WIN32__


25 
	~"§ãwšdows.h
"

29 
	$x­Ÿn_¦“p_mli£cÚds
(
mli£cs
)

31 
	`SË•
(
mli£cs
);

32 
	}
}

	@common/safedirent.h

22 #iâdeà
XAPIAN_INCLUDED_SAFEDIRENT_H


23 
	#XAPIAN_INCLUDED_SAFEDIRENT_H


	)

25 #ifdeà
__WIN32__


26 
	~"msvc_dœ’t.h
"

28 
	~<dœ’t.h
>

	@common/safeerrno.h

21 #iâdeà
XAPIAN_INCLUDED_SAFEERRNO_H


22 
	#XAPIAN_INCLUDED_SAFEERRNO_H


	)

24 #iâdeà
PACKAGE


25 
You
 
mu¡
 #šşud
	~<cÚfig.h
> 
	gbefÜe
 #šşud"§ã”ºo.h"

31 #ià
defšed
 
__DECCXX
 && defšed 
HAVE_SYS_ERRNO_H


32 
	~<sys/”ºo.h
>

34 
	~<û¼no
>

	@common/safefcntl.h

21 #iâdeà
XAPIAN_INCLUDED_SAFEFCNTL_H


22 
	#XAPIAN_INCLUDED_SAFEFCNTL_H


	)

24 
	~<fú.h
>

26 #ià
defšed
 
__ılu¥lus
 && defšed 
İ’


34 #ifdeà
_MSC_VER


37 #undeà
İ’


40 
šlše
 
	$fú_İ’_
(cÚ¡ *
f’ame
, 
æags
, 
mode_t
 
mode
) {

41  
	`İ’
(
f’ame
, 
æags
, 
mode
);

42 
	}
}

44 
šlše
 
	$fú_İ’_
(cÚ¡ *
f’ame
, 
æags
) {

45  
	`İ’
(
f’ame
, 
æags
);

46 
	}
}

48 #undeà
İ’


50 
šlše
 
	$İ’
(cÚ¡ *
f’ame
, 
æags
, 
mode_t
 
mode
) {

51  
	`fú_İ’_
(
f’ame
, 
æags
, 
mode
);

52 
	}
}

54 
šlše
 
	$İ’
(cÚ¡ *
f’ame
, 
æags
) {

55  
	`fú_İ’_
(
f’ame
, 
æags
);

56 
	}
}

65 #iâdeà
__WIN32__


66 #iâdeà
O_BINARY


67 
	#O_BINARY
 0

	)

	@common/safesysselect.h

20 #iâdeà
XAPIAN_INCLUDED_SAFESYSSELECT_H


21 
	#XAPIAN_INCLUDED_SAFESYSSELECT_H


	)

23 #iâdeà
PACKAGE


24 
You
 
mu¡
 #šşud
	~<cÚfig.h
> 
	gbefÜe
 #šşud"§ãsys£Ëù.h"

27 #ifdeà
HAVE_SYS_SELECT_H


29 
	~<sys/£Ëù.h
>

32 
	~<sys/time.h
>

33 
	~<sys/ty³s.h
>

34 
	~<uni¡d.h
>

38 
	~<c¡ršg
>

	@common/safesysstat.h

21 #iâdeà
XAPIAN_INCLUDED_SAFESYSSTAT_H


22 
	#XAPIAN_INCLUDED_SAFESYSSTAT_H


	)

24 
	~<sys/¡©.h
>

30 #ifdeà
_MSC_VER


40 #ifdeà
¡©


41 #undeà
¡©


44 #ifdeà
f¡©


45 #undeà
f¡©


49 
	#¡©
 
_¡©i64


	)

50 
	#f¡©
(
FD
, 
BUF
è
	`_f¡©i64
(FD,BUF)

	)

54 #iâdeà
S_ISDIR


55 
	#S_ISDIR
(
m
è(((mè& 
_S_IFMT
è=ğ
_S_IFDIR
)

	)

57 #iâdeà
S_ISREG


58 
	#S_ISREG
(
m
è(((mè& 
_S_IFMT
è=ğ
_S_IFREG
)

	)

61 #ifdeà
__WIN32__


66 
	~<dœeù.h
>

70 
šlše
 (
mkdœ
)(cÚ¡ *
·thÇme
, 
mode_t
 ) {

71  
	`_mkdœ
(
·thÇme
);

72 
	}
}

	@common/safesyswait.h

22 #iâdeà
XAPIAN_INCLUDED_SAFESYSWAIT_H


23 
	#XAPIAN_INCLUDED_SAFESYSWAIT_H


	)

25 #iâdeà
__WIN32__


26 
	~<sys/wa™.h
>

31 #iâdeà
WIFEXITED


32 
	#WIFEXITED
(
STATUS
è(STATUS !ğ-1)

	)

34 #iâdeà
WEXITSTATUS


35 
	#WEXITSTATUS
(
STATUS
è(STATUS)

	)

	@common/safeunistd.h

21 #iâdeà
XAPIAN_INCLUDED_SAFEUNISTD_H


22 
	#XAPIAN_INCLUDED_SAFEUNISTD_H


	)

24 #iâdeà
_MSC_VER


25 
	~<uni¡d.h
>

30 
	~<sys/ty³s.h
>

35 
	~<io.h
>

37 #ifdeà
l£ek


38 #undeà
l£ek


41 #ifdeà
off_t


42 #undeà
off_t


45 
	#l£ek
(
FD
, 
OFF
, 
WHENCE
è
	`_l£eki64
(FD, OFF, WHENCE)

	)

46 
	#off_t
 
__št64


	)

49 
	~<´oûss.h
>

53 #ifdeà
__WIN32__


55 
šlše
 

56 
	$¦“p
(
£cÚds
)

59 
	`x­Ÿn_¦“p_mli£cÚds
(
mli£cs
);

68 ià(
£cÚds
 > 4294967u) {

69 
	`x­Ÿn_¦“p_mli£cÚds
(4294967000u);

70  
£cÚds
 - 4294967u;

72 
	`x­Ÿn_¦“p_mli£cÚds
(
£cÚds
 * 1000u);

74 
	}
}

	@common/safeuuid.h

22 #iâdeà
XAPIAN_INCLUDED_SAFEUUID_H


23 
	#XAPIAN_INCLUDED_SAFEUUID_H


	)

25 #ifdeà
__WIN32__


26 
	~"commÚ/wš32_uuid.h
"

28 
	~<uuid/uuid.h
>

36 #iâdeà
uuid_·r£


37 
	#uuid_·r£
(
IN
, 
UU
è(
uuid_·r£
)(
cÚ¡_ÿ¡
<*>(IN), (UU))

	)

40 #iâdeà
HAVE_UUID_UNPARSE_LOWER


44 
šlše
 
	$uuid_uÅ¬£_low”
(
uuid_t
 
uu
, *
out
) {

45 
	`uuid_uÅ¬£
(
uu
, 
out
);

49 
size_t
 
i
 = 0; i < 36; ++iè
out
[i] |= 0x20;

50 
	}
}

	@common/safewindows.h

21 #iâdeà
XAPIAN_INCLUDED_SAFEWINDOWS_H


22 
	#XAPIAN_INCLUDED_SAFEWINDOWS_H


	)

24 #ià!
defšed
 
__CYGWIN__
 && !defšed 
__WIN32__


25 #”rÜ 
Inşudšg
 
§ãwšdows
.
h
, 
but
 
Ã™h”
 
__CYGWIN__
 
nÜ
 
__WIN32__
 
defšed
!

29 #iâdeà
NOMINMAX


30 
	#NOMINMAX


	)

36 
	#WIN32_LEAN_AND_MEAN


	)

37 
	#NOGDI


	)

38 
	~<wšdows.h
>

41 #iâdeà
FOF_NOERRORUI


42 
	#FOF_NOERRORUI
 1024

	)

	@common/safewinsock2.h

21 #iâdeà
XAPIAN_INCLUDED_SAFEWINSOCK2_H


22 
	#XAPIAN_INCLUDED_SAFEWINSOCK2_H


	)

24 #iâdeà
__WIN32__


25 #”rÜ 
Inşudšg
 
§ãwšsock2
.
h
, 
but
 
__WIN32__
 
i¢
't defined!

30 
	~"§ãwšdows.h
"

32 
	~<wšsock2.h
>

	@common/serialise-double.cc

25 
	~<cÚfig.h
>

27 
	~<x­Ÿn/”rÜ.h
>

29 
	~"omas£¹.h
"

31 
	~"£rŸli£-doubË.h
"

33 
	~<cæßt
>

34 
	~<cm©h
>

36 
	~<®gÜ™hm
>

37 
	~<¡ršg
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

55 #ià
FLT_RADIX
 == 2

56 
	#MAX_MANTISSA_BYTES
 ((
DBL_MANT_DIG
 + 7 + 7è/ 8)

	)

57 
	#MAX_EXP
 ((
DBL_MAX_EXP
 + 1è/ 8)

	)

58 
	#MAX_MANTISSA
 (1 << (
DBL_MAX_EXP
 & 7))

	)

59 #–ià
FLT_RADIX
 == 16

60 
	#MAX_MANTISSA_BYTES
 ((
DBL_MANT_DIG
 + 1 + 1è/ 2)

	)

61 
	#MAX_EXP
 ((
DBL_MAX_EXP
 + 1è/ 2)

	)

62 
	#MAX_MANTISSA
 (1 << ((
DBL_MAX_EXP
 & 1è* 4))

	)

64 #”rÜ 
FLT_RADIX
 
is
 
a
 
v®ue
 
nÙ
 
cu¼’y
 
hªdËd
 (nÙ 2 
Ü
 16)

68 
	$ba£256ify_doubË
(&
v
) {

69 
exp
;

70 
v
 = 
	`äexp
(v, &
exp
);

72 --
exp
;

73 
v
 = 
	`ldexp
(v, (
exp
 & 7) + 1);

75 
exp
 >>= 3;

76  
exp
;

77 
	}
}

79 
	g¡d
::
¡ršg
 
	$£rŸli£_doubË
(
v
)

93 
boŞ
 
Ãg©ive
 = (
v
 < 0.0);

95 ià(
Ãg©ive
è
v
 = -v;

97 
exp
 = 
	`ba£256ify_doubË
(
v
);

99 
¡ršg
 
»suÉ
;

101 ià(
exp
 <= 6 &&ƒxp >= -7) {

102 
b
 = 
¡©ic_ÿ¡
<>(
exp
 + 7);

103 ià(
Ãg©ive
è
b
 |ğ
¡©ic_ÿ¡
<>(0x80);

104 
»suÉ
 +ğ(
b
);

106 ià(
exp
 >= -128 &&ƒxp < 127) {

107 
»suÉ
 +ğ
Ãg©ive
 ? (0x8e) : (0x0e);

108 
»suÉ
 +ğ(
exp
 + 128);

110 ià(
exp
 < -32768 ||ƒxp > 32767) {

111 
throw
 
X­Ÿn
::
	`IÁ”ÇlE¼Ü
("Insaneƒxponent in floating…oint‚umber");

113 
»suÉ
 +ğ
Ãg©ive
 ? (0x8f) : (0x0f);

114 
»suÉ
 +ğ((
exp
 + 32768) & 0xff);

115 
»suÉ
 +ğ((
exp
 + 32768) >> 8);

119 
maxby‹s
 = 
	`mš
(
MAX_MANTISSA_BYTES
, 8);

121 
size_t
 
n
 = 
»suÉ
.
	`size
();

123 
by‹
 = 
¡©ic_ÿ¡
<>(
v
);

124 
»suÉ
 +ğ(
by‹
);

125 
v
 -ğ(
by‹
);

126 
v
 *= 256.0;

127 } 
v
 !ğ0.0 && --
maxby‹s
);

129 
n
 = 
»suÉ
.
	`size
() -‚;

130 ià(
n
 > 1) {

131 
	`As£¹
(
n
 <= 8);

132 
»suÉ
[0] = 
¡©ic_ÿ¡
<>ÔesuÉ[0] | ((
n
 - 1) << 4));

135  
»suÉ
;

136 
	}
}

138 
	$un£rŸli£_doubË
(cÚ¡ ** 
p
, cÚ¡ *
’d
)

140 ià(
’d
 - *
p
 < 2) {

141 
throw
 
X­Ÿn
::
	`S”Ÿli§tiÚE¼Ü
("Badƒncoded double: insufficient data");

143 
fœ¡
 = *(*
p
)++;

144 ià(
fœ¡
 =ğ0 && *(*
p
) == 0) {

145 ++*
p
;

149 
boŞ
 
Ãg©ive
 = (
fœ¡
 & 0x80) != 0;

150 
size_t
 
mªtis§_Ën
 = ((
fœ¡
 >> 4) & 0x07) + 1;

152 
exp
 = 
fœ¡
 & 0x0f;

153 ià(
exp
 >= 14) {

154 
bigexp
 = 
¡©ic_ÿ¡
<>(*(*
p
)++);

155 ià(
exp
 == 15) {

156 ià(*
p
 =ğ
’d
) {

157 
throw
 
X­Ÿn
::
	`S”Ÿli§tiÚE¼Ü
("Badƒncoded double: short†argeƒxponent");

159 
exp
 = 
bigexp
 | (
¡©ic_ÿ¡
<>(*(*
p
)++) << 8);

160 
exp
 -= 32768;

162 
exp
 = 
bigexp
 - 128;

165 
exp
 -= 7;

168 ià(
	`size_t
(
’d
 - *
p
è< 
mªtis§_Ën
) {

169 
throw
 
X­Ÿn
::
	`S”Ÿli§tiÚE¼Ü
("Badƒncoded double: short mantissa");

172 
v
 = 0.0;

174 
dbl_max_mªtis§
 = 
DBL_MAX
;

175 
dbl_max_exp
 = 
	`ba£256ify_doubË
(
dbl_max_mªtis§
);

176 *
p
 +ğ
mªtis§_Ën
;

177 ià(
exp
 > 
dbl_max_exp
 ||

178 (
exp
 =ğ
dbl_max_exp
 && (**
p
è> 
dbl_max_mªtis§
)) {

181 
v
 = 
HUGE_VAL
;

183 cÚ¡ *
q
 = *
p
;

184 
mªtis§_Ën
--) {

185 
v
 *= 0.00390625;

186 
v
 +ğ(
¡©ic_ÿ¡
<>(*--
q
));

189 ià(
exp
è
v
 = 
	`ldexp
(v,ƒxp * 8);

192 ià(
v
 == 0.0) {

198 ià(
Ãg©ive
è
v
 = -v;

200  
v
;

201 
	}
}

	@common/serialise-double.h

25 #iâdeà
XAPIAN_INCLUDED_SERIALISE_DOUBLE_H


26 
	#XAPIAN_INCLUDED_SERIALISE_DOUBLE_H


	)

28 
	~<x­Ÿn/visib™y.h
>

30 
	~<¡ršg
>

38 
XAPIAN_VISIBILITY_DEFAULT


39 
	g¡d
::
¡ršg
 
£rŸli£_doubË
(
v
);

49 
XAPIAN_VISIBILITY_DEFAULT


50 
un£rŸli£_doubË
(cÚ¡ ** 
p
, cÚ¡ *
’d
);

	@common/serialise.h

21 #iâdeà
XAPIAN_INCLUDED_SERIALISE_H


22 
	#XAPIAN_INCLUDED_SERIALISE_H


	)

24 
	~<¡ršg
>

25 
	~"nÜ‘uº.h
"

26 
	~"x­Ÿn/visib™y.h
"

27 
	~"x­Ÿn/weight.h
"

31 
Çme¥aû
 
	gX­Ÿn
 {

32 
şass
 
	gDocum’t
;

33 
şass
 
	gE¼Ü
;

34 
şass
 
	gMS‘
;

35 
şass
 
	gRS‘
;

46 
	g‹m¶©e
<
şass
 
	gT
>

47 
	g¡d
::
¡ršg


48 
	$’code_Ëngth
(
T
 
Ën
)

50 
¡d
::
¡ršg
 
»suÉ
;

51 ià(
Ën
 < 255) {

52 
»suÉ
 +ğ
¡©ic_ÿ¡
<>(
Ën
);

54 
»suÉ
 += '\xff';

55 
Ën
 -= 255;

56 
Œue
) {

57 
by‹
 = 
¡©ic_ÿ¡
<>(
Ën
 & 0x7f);

58 
Ën
 >>= 7;

59 ià(!
Ën
) {

60 
»suÉ
 +ğ(
by‹
 | 
¡©ic_ÿ¡
<>(0x80));

63 
»suÉ
 +ğ
by‹
;

66  
»suÉ
;

67 
	}
}

79 
XAPIAN_VISIBILITY_DEFAULT


80 
size_t
 
decode_Ëngth
(cÚ¡ ** 
p
, cÚ¡ *
’d
, 
boŞ
 
check_»maššg
);

88 
XAPIAN_VISIBILITY_DEFAULT


89 
	g¡d
::
¡ršg
 
£rŸli£_”rÜ
(cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
);

103 
XAPIAN_VISIBILITY_DEFAULT


104 
XAPIAN_NORETURN
(

105 
un£rŸli£_”rÜ
(cÚ¡ 
¡d
::
¡ršg
 &
”rÜ_¡ršg
,

106 cÚ¡ 
¡d
::
¡ršg
 &
´efix
,

107 cÚ¡ 
¡d
::
¡ršg
 &
Ãw_cÚ‹xt
));

115 
	g¡d
::
¡ršg
 
£rŸli£_¡©s
(cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 &
¡©s
);

123 
	gX­Ÿn
::
Weight
::
IÁ”Çl
 
un£rŸli£_¡©s
(cÚ¡ 
¡d
::
¡ršg
 &
s
);

131 
	g¡d
::
¡ršg
 
£rŸli£_m£t
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t
);

140 
	gX­Ÿn
::
MS‘
 
un£rŸli£_m£t
(cÚ¡ * 
p
, cÚ¡ * 
p_’d
);

148 
	g¡d
::
¡ršg
 
£rŸli£_r£t
(cÚ¡ 
X­Ÿn
::
RS‘
 &
omr£t
);

156 
	gX­Ÿn
::
RS‘
 
un£rŸli£_r£t
(cÚ¡ 
¡d
::
¡ršg
 &
s
);

164 
XAPIAN_VISIBILITY_DEFAULT


165 
	g¡d
::
¡ršg
 
£rŸli£_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
);

173 
XAPIAN_VISIBILITY_DEFAULT


174 
	gX­Ÿn
::
Docum’t
 
un£rŸli£_docum’t
(cÚ¡ 
¡d
::
¡ršg
 &
s
);

	@common/socket_utils.cc

21 
	~<cÚfig.h
>

22 
	~"sock‘_uts.h
"

24 #ifdeà
__WIN32__


25 
	~"§ã”ºo.h
"

27 
	~<io.h
>

31 #ià
defšed
 
_MSC_VER
 && _MSC_VER >ğ1400 && defšed 
__STDC_SECURE_LIB__


32 
	~<c¡dlib
>

33 
	~<ütdbg.h
>

36 
	$dummy_hªdËr
(cÚ¡ 
wch¬_t
*,

37 cÚ¡ 
wch¬_t
*,

38 cÚ¡ 
wch¬_t
*,

40 
ušŒ_t
)

42 
	}
}

49 şas 
	cMSVCIgnÜeInv®idP¬am‘”
 {

50 
_šv®id_·¿m‘”_hªdËr
 
	mŞd_hªdËr
;

51 
	mŞd_»pÜt_mode
;

53 
	mpublic
:

54 
	$MSVCIgnÜeInv®idP¬am‘”
() {

56 
Şd_hªdËr
 = 
	`_£t_šv®id_·¿m‘”_hªdËr
(
dummy_hªdËr
);

58 
Şd_»pÜt_mode
 = 
	`_C¹S‘R•ÜtMode
(
_CRT_ASSERT
, 0);

61 ~
	$MSVCIgnÜeInv®idP¬am‘”
() {

63 
	`_£t_šv®id_·¿m‘”_hªdËr
(
Şd_hªdËr
);

64 
	`_C¹S‘R•ÜtMode
(
_CRT_ASSERT
, 
Şd_»pÜt_mode
);

65 
	}
}

71 
	sMSVCIgnÜeInv®idP¬am‘”
 {

75 
MSVCIgnÜeInv®idP¬am‘”
() { }

80 
HANDLE
 
	$fd_to_hªdË
(
fd
) {

81 
MSVCIgnÜeInv®idP¬am‘”
 
šv®id_hªdË_v®ue_is_ok
;

82 
HANDLE
 
hªdË
 = (HANDLE)
	`_g‘_osfhªdË
(
fd
);

85  (
hªdË
 !ğ
INVALID_HANDLE_VALUE
 ? hªdË : (
HANDLE
)
fd
);

86 
	}
}

89 
	$şo£_fd_Ü_sock‘
(
fd
) {

90 
MSVCIgnÜeInv®idP¬am‘”
 
šv®id_fd_v®ue_is_ok
;

91 ià(
	`şo£
(
fd
è=ğ-1 && 
”ºo
 =ğ
EBADF
) {

94 
	`şo£sock‘
(
fd
);

96 
	}
}

	@common/socket_utils.h

22 #iâdeà
XAPIAN_INCLUDED_SOCKET_UTILS_H


23 
	#XAPIAN_INCLUDED_SOCKET_UTILS_H


	)

25 
	~"§ãuni¡d.h
"

27 #ifdeà
__WIN32__


29 
	~"§ãwšsock2.h
"

32 
HANDLE
 
fd_to_hªdË
(
fd
);

35 
şo£_fd_Ü_sock‘
(
fd
);

38 
šlše
 
	$şo£_fd_Ü_sock‘
(
fd
è{ 
	`şo£
(fd); 
	}
}

	@common/str.cc

21 
	~<cÚfig.h
>

23 
	~"¡r.h
"

25 
	~"omas£¹.h
"

27 
	~<c¡dio
>

28 
	~<c¡dlib
>

29 
	~<¡ršg
>

31 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	g‹m¶©e
<
şass
 
	gT
>

35 
šlše
 
¡ršg


36 
	$to¡ršg_unsigÃd
(
T
 
v®ue
)

38 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
T
);

41 ià(
v®ue
 < 10è 
	`¡ršg
(1, '0' + (value));

42 
buf
[((
T
) * 5 + 1) / 2];

43 * 
p
 = 
buf
 + (buf);

45 
	`As£¹R–
(
p
,>,
buf
);

46 
	`ch
(
v®ue
 % 10);

47 
v®ue
 /= 10;

48 *(--
p
èğ
ch
 + '0';

49 } 
v®ue
);

50  
	`¡ršg
(
p
, 
buf
 + (buf) -…);

51 
	}
}

53 
	g‹m¶©e
<
şass
 
	gT
>

54 
šlše
 
¡ršg


55 
	$to¡ršg
(
T
 
v®ue
)

59 ià(
v®ue
 < 10 && v®u>ğ0è 
	`¡ršg
(1, '0' + (value));

61 
boŞ
 
Ãg©ive
 = (
v®ue
 < 0);

62 ià(
Ãg©ive
è
v®ue
 = -value;

64 
buf
[((
T
) * 5 + 1) / 2 + 1];

65 * 
p
 = 
buf
 + (buf);

67 
	`As£¹R–
(
p
,>,
buf
);

68 
	`ch
(
v®ue
 % 10);

69 
v®ue
 /= 10;

70 *(--
p
èğ
ch
 + '0';

71 } 
v®ue
);

73 ià(
Ãg©ive
) {

74 
	`As£¹R–
(
p
,>,
buf
);

75 *--
p
 = '-';

77  
	`¡ršg
(
p
, 
buf
 + (buf) -…);

78 
	}
}

80 
Çme¥aû
 
	gX­Ÿn
 {

81 
Çme¥aû
 
	gIÁ”Çl
 {

83 
¡ršg


84 
¡r
(
v®ue
)

86  
to¡ršg
(
v®ue
);

89 
¡ršg


90 
¡r
(
v®ue
)

92  
to¡ršg_unsigÃd
(
v®ue
);

95 
¡ršg


96 
¡r
(
v®ue
)

98  
to¡ršg
(
v®ue
);

101 
¡ršg


102 
¡r
(
v®ue
)

104  
to¡ršg_unsigÃd
(
v®ue
);

107 
¡ršg


108 
¡r
(
v®ue
)

110  
to¡ršg
(
v®ue
);

113 
¡ršg


114 
¡r
(
v®ue
)

116  
to¡ršg_unsigÃd
(
v®ue
);

119 
	g‹m¶©e
<
şass
 
	gT
>

120 
šlše
 
¡ršg


121 
fÜm©
(cÚ¡ * 
fmt
, 
T
 
v®ue
)

123 
	gbuf
[128];

124 #ifdeà
SNPRINTF


127 
size_t
 
	gsize
 = 
SNPRINTF_ISO
(
buf
, (buf), 
fmt
, 
v®ue
);

128 
As£¹R–
(
size
,<=,(
buf
));

129 ià(
	gsize
 > (
	gbuf
)èsizğ(
buf
);

131 
size_t
 
	gsize
 = 
¥rštf
(
buf
, 
fmt
, 
v®ue
);

133 ià(
	gsize
 >ğ(
buf
)è
abÜt
();

135  
¡ršg
(
buf
, 
size
);

138 
¡ršg


139 
¡r
(
v®ue
)

141  
fÜm©
("%.20g", 
v®ue
);

144 
¡ršg


145 
¡r
(cÚ¡ * 
v®ue
)

147  
fÜm©
("%p", 
v®ue
);

	@common/str.h

21 #iâdeà
XAPIAN_INCLUDED_STR_H


22 
	#XAPIAN_INCLUDED_STR_H


	)

24 
	~"x­Ÿn/visib™y.h
"

26 
	~<¡ršg
>

28 
Çme¥aû
 
	gX­Ÿn
 {

29 
Çme¥aû
 
	gIÁ”Çl
 {

32 
XAPIAN_VISIBILITY_DEFAULT


33 
	g¡d
::
¡ršg
 
¡r
(
v®ue
);

36 
XAPIAN_VISIBILITY_DEFAULT


37 
	g¡d
::
¡ršg
 
¡r
(
v®ue
);

40 
XAPIAN_VISIBILITY_DEFAULT


41 
	g¡d
::
¡ršg
 
¡r
(
v®ue
);

44 
XAPIAN_VISIBILITY_DEFAULT


45 
	g¡d
::
¡ršg
 
¡r
(
v®ue
);

48 
XAPIAN_VISIBILITY_DEFAULT


49 
	g¡d
::
¡ršg
 
¡r
(
v®ue
);

52 
XAPIAN_VISIBILITY_DEFAULT


53 
	g¡d
::
¡ršg
 
¡r
(
v®ue
);

56 
XAPIAN_VISIBILITY_DEFAULT


57 
	g¡d
::
¡ršg
 
¡r
(
v®ue
);

60 
XAPIAN_VISIBILITY_DEFAULT


61 
	g¡d
::
¡ršg
 
¡r
(cÚ¡ * 
v®ue
);

68 
šlše
 
	g¡d
::
¡ršg
 
¡r
(cÚ¡ 
¡d
::¡ršg & 
v®ue
) {  value; }

71 
šlše
 
	g¡d
::
¡ršg
 
¡r
(cÚ¡ * 
v®ue
) {  value; }

74 
šlše
 
	g¡d
::
¡ršg
 
¡r
(
boŞ
 
v®ue
) {

75  
¡d
::
¡ršg
(1, '0' | 
¡©ic_ÿ¡
<>(
v®ue
));

81 
usšg
 
	gX­Ÿn
::
IÁ”Çl
::
¡r
;

	@common/stringutils.cc

21 
	~<cÚfig.h
>

23 
	~"¡ršguts.h
"

25 
Çme¥aû
 
	gX­Ÿn
 {

26 
Çme¥aû
 
	gIÁ”Çl
 {

36 cÚ¡ 
	gis_b
[('\x20' == ' ') ? 256 : -1] = {

46  
IS_SPACE
,

47  
IS_SPACE
,

49  
IS_SPACE
,

50  
IS_SPACE
,

69  
IS_SPACE
,

80  
IS_SIGN
,

82  
IS_SIGN
,

85  
IS_DIGIT
|
IS_HEX
,

86  
IS_DIGIT
|
IS_HEX
,

87  
IS_DIGIT
|
IS_HEX
,

88  
IS_DIGIT
|
IS_HEX
,

89  
IS_DIGIT
|
IS_HEX
,

90  
IS_DIGIT
|
IS_HEX
,

91  
IS_DIGIT
|
IS_HEX
,

92  
IS_DIGIT
|
IS_HEX
,

93  
IS_DIGIT
|
IS_HEX
,

94  
IS_DIGIT
|
IS_HEX
,

102  
IS_UPPER
|
IS_HEX
,

103  
IS_UPPER
|
IS_HEX
,

104  
IS_UPPER
|
IS_HEX
,

105  
IS_UPPER
|
IS_HEX
,

106  
IS_UPPER
|
IS_HEX
,

107  
IS_UPPER
|
IS_HEX
,

108  
IS_UPPER
,

109  
IS_UPPER
,

110  
IS_UPPER
,

111  
IS_UPPER
,

112  
IS_UPPER
,

113  
IS_UPPER
,

114  
IS_UPPER
,

115  
IS_UPPER
,

116  
IS_UPPER
,

117  
IS_UPPER
,

118  
IS_UPPER
,

119  
IS_UPPER
,

120  
IS_UPPER
,

121  
IS_UPPER
,

122  
IS_UPPER
,

123  
IS_UPPER
,

124  
IS_UPPER
,

125  
IS_UPPER
,

126  
IS_UPPER
,

127  
IS_UPPER
,

134  
IS_LOWER
|
IS_HEX
,

135  
IS_LOWER
|
IS_HEX
,

136  
IS_LOWER
|
IS_HEX
,

137  
IS_LOWER
|
IS_HEX
,

138  
IS_LOWER
|
IS_HEX
,

139  
IS_LOWER
|
IS_HEX
,

140  
IS_LOWER
,

141  
IS_LOWER
,

142  
IS_LOWER
,

143  
IS_LOWER
,

144  
IS_LOWER
,

145  
IS_LOWER
,

146  
IS_LOWER
,

147  
IS_LOWER
,

148  
IS_LOWER
,

149  
IS_LOWER
,

150  
IS_LOWER
,

151  
IS_LOWER
,

152  
IS_LOWER
,

153  
IS_LOWER
,

154  
IS_LOWER
,

155  
IS_LOWER
,

156  
IS_LOWER
,

157  
IS_LOWER
,

158  
IS_LOWER
,

159  
IS_LOWER
,

299 cÚ¡ 
	glo_b
[257] =

314 cÚ¡ 
	gup_b
[257] =

	@common/stringutils.h

21 #iâdeà
XAPIAN_INCLUDED_STRINGUTILS_H


22 
	#XAPIAN_INCLUDED_STRINGUTILS_H


	)

24 
	~<x­Ÿn/visib™y.h
>

26 
	~<®gÜ™hm
>

27 
	~<¡ršg
>

28 
	~<c¡ršg
>

33 
	#STRINGIZE_
(
X
è#X

	)

36 
	#STRINGIZE
(
X
è
	`STRINGIZE_
(X)

	)

43 
	#CONST_STRLEN
(
S
è((S""è- 1)

	)

45 
šlše
 
boŞ


46 
¡¬tsw™h
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, 
pfx
)

48  !
	gs
.
em±y
(è&& s[0] =ğ
pfx
;

51 
šlše
 
boŞ


52 
¡¬tsw™h
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, cÚ¡ * 
pfx
, 
size_t
 
Ën
)

54  
	gs
.
size
(è>ğ
Ën
 && (
¡d
::
memcmp
(
s
.
d©a
(), 
pfx
,†en) == 0);

57 
šlše
 
boŞ


58 
¡¬tsw™h
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, cÚ¡ * 
pfx
)

60  
¡¬tsw™h
(
s
, 
pfx
, 
¡d
::
¡¾’
(pfx));

63 
šlše
 
boŞ


64 
¡¬tsw™h
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, cÚ¡ std::¡ršg & 
pfx
)

66  
¡¬tsw™h
(
s
, 
pfx
.
d©a
(),…fx.
size
());

69 
šlše
 
boŞ


70 
’dsw™h
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, 
sfx
)

72  !
	gs
.
em±y
(è&& s[
s
.
size
(è- 1] =ğ
sfx
;

75 
šlše
 
boŞ


76 
’dsw™h
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, cÚ¡ * 
sfx
, 
size_t
 
Ën
)

78  
	gs
.
size
(è>ğ
Ën
 && (
¡d
::
memcmp
(
s
.
d©a
(è+ s.size(è-†’, 
sfx
,†en) == 0);

81 
šlše
 
boŞ


82 
’dsw™h
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, cÚ¡ * 
sfx
)

84  
’dsw™h
(
s
, 
sfx
, 
¡d
::
¡¾’
(sfx));

87 
šlše
 
boŞ


88 
’dsw™h
(cÚ¡ 
¡d
::
¡ršg
 & 
s
, cÚ¡ std::¡ršg & 
sfx
)

90  
’dsw™h
(
s
, 
sfx
.
d©a
(), sfx.
size
());

93 
šlše
 
	g¡d
::
¡ršg
::
size_ty³


94 
commÚ_´efix_Ëngth
(cÚ¡ 
¡d
::
¡ršg
 &
a
, cÚ¡ std::¡ršg &
b
)

96 
¡d
::
¡ršg
::
size_ty³
 
mšËn
 = std::
mš
(
a
.
size
(), 
b
.size());

97 
	g¡d
::
¡ršg
::
size_ty³
 
commÚ
;

98 
	gcommÚ
 = 0; commÚ < 
	gmšËn
; ++common) {

99 ià(
	ga
[
commÚ
] !ğ
b
[common]) ;

101  
	gcommÚ
;

111 
Çme¥aû
 
	gX­Ÿn
 {

112 
Çme¥aû
 
	gIÁ”Çl
 {

113 cÚ¡ 
	gIS_DIGIT
 = 0x01;

114 cÚ¡ 
	gIS_LOWER
 = 0x02;

115 cÚ¡ 
	gIS_UPPER
 = 0x04;

116 cÚ¡ 
	gIS_HEX
 = 0x08;

117 cÚ¡ 
	gIS_SIGN
 = 0x10;

118 cÚ¡ 
	gIS_SPACE
 = 0x20;

119 
XAPIAN_VISIBILITY_DEFAULT


120 cÚ¡ 
is_b
[];

121 
XAPIAN_VISIBILITY_DEFAULT


122 cÚ¡ 
lo_b
[];

123 
XAPIAN_VISIBILITY_DEFAULT


124 cÚ¡ 
up_b
[];

132 
šlše
 
boŞ
 
	$C_isdig™
(
ch
) {

133 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

134  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & 
IS_DIGIT
);

135 
	}
}

137 
šlše
 
boŞ
 
	$C_isxdig™
(
ch
) {

138 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

139  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & 
IS_HEX
);

140 
	}
}

142 
šlše
 
boŞ
 
	$C_isuµ”
(
ch
) {

143 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

144  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & 
IS_UPPER
);

145 
	}
}

147 
šlše
 
boŞ
 
	$C_i¦ow”
(
ch
) {

148 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

149  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & 
IS_LOWER
);

150 
	}
}

152 
šlše
 
boŞ
 
	$C_i§Íha
(
ch
) {

153 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

154  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & (
IS_UPPER
|
IS_LOWER
));

155 
	}
}

157 
šlše
 
boŞ
 
	$C_i§Êum
(
ch
) {

158 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

159  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & (
IS_UPPER
|
IS_LOWER
|
IS_DIGIT
));

160 
	}
}

162 
šlše
 
boŞ
 
	$C_is¥aû
(
ch
) {

163 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

164  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & 
IS_SPACE
);

165 
	}
}

167 
šlše
 
boŞ
 
	$C_issign
(
ch
) {

168 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

169  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & 
IS_SIGN
);

170 
	}
}

172 
šlše
 
boŞ
 
	$C_isupdig
(
ch
) {

173 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

174  
	`boŞ
(
is_b
[
¡©ic_ÿ¡
<>(
ch
)] & (
IS_UPPER
|
IS_DIGIT
));

175 
	}
}

177 
šlše
 
boŞ
 
	$C_i¢Ùdig™
(
ch
è{  !
	`C_isdig™
(ch); 
	}
}

178 
šlše
 
boŞ
 
	$C_i¢Ùxdig™
(
ch
è{  !
	`C_isxdig™
(ch); 
	}
}

179 
šlše
 
boŞ
 
	$C_i¢Ùuµ”
(
ch
è{  !
	`C_isuµ”
(ch); 
	}
}

180 
šlše
 
boŞ
 
	$C_i¢Ùlow”
(
ch
è{  !
	`C_i¦ow”
(ch); 
	}
}

181 
šlše
 
boŞ
 
	$C_i¢Ù®pha
(
ch
è{  !
	`C_i§Íha
(ch); 
	}
}

182 
šlše
 
boŞ
 
	$C_i¢Ù®num
(
ch
è{  !
	`C_i§Êum
(ch); 
	}
}

183 
šlše
 
boŞ
 
	$C_i¢Ù¥aû
(
ch
è{  !
	`C_is¥aû
(ch); 
	}
}

184 
šlše
 
boŞ
 
	$C_i¢Ùsign
(
ch
è{  !
	`C_issign
(ch); 
	}
}

186 
šlše
 
	$C_tŞow”
(
ch
) {

187 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

188  
lo_b
[
¡©ic_ÿ¡
<>(
ch
)];

189 
	}
}

191 
šlše
 
	$C_touµ”
(
ch
) {

192 
usšg
 
Çme¥aû
 
X­Ÿn
::
IÁ”Çl
;

193  
up_b
[
¡©ic_ÿ¡
<>(
ch
)];

194 
	}
}

	@common/submatch.h

21 #iâdeà
XAPIAN_INCLUDED_SUBMATCH_H


22 
	#XAPIAN_INCLUDED_SUBMATCH_H


	)

24 
	~<x­Ÿn/ba£.h
>

25 
	~<x­Ÿn/ty³s.h
>

27 
	~"om’quœeš‹º®.h
"

28 
	~"po¡li¡.h
"

29 
	~"x­Ÿn/weight.h
"

31 şas 
	cSubM©ch
 : 
public
 
X­Ÿn
::
IÁ”Çl
::
RefCÁBa£
 {

32 
public
:

38 
vœtu®
 ~
	$SubM©ch
() { }

60 
vœtu®
 
boŞ
 
	`´•¬e_m©ch
(boŞ 
nowa™
,

61 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
) = 0;

70 
vœtu®
 
	`¡¬t_m©ch
(
X­Ÿn
::
doccouÁ
 
fœ¡
,

71 
X­Ÿn
::
doccouÁ
 
max™ems
,

72 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

73 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
) = 0;

76 
vœtu®
 
Po¡Li¡
 * 
	`g‘_po¡li¡_ªd_‹rm_šfo
(
MuÉiM©ch
 *
m©ch”
,

77 
¡d
::
m­
<¡d::
¡ršg
,

78 
X­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> *
‹rmäeqªdwts
,

79 
X­Ÿn
::
‹rmcouÁ
 * 
tÙ®_subqs_±r
)

81 
	}
};

	@common/tcpclient.h

21 #iâdeà
XAPIAN_INCLUDED_TCPCLIENT_H


22 
	#XAPIAN_INCLUDED_TCPCLIENT_H


	)

24 
	~<¡ršg
>

26 
Çme¥aû
 
	gTıCl›Á
 {

32 
İ’_sock‘
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡Çme
, 
pÜt
,

33 
m£cs_timeout_cÚÃù
, 
boŞ
 
tı_nod–ay
);

	@common/tcpserver.h

21 #iâdeà
XAPIAN_INCLUDED_TCPSERVER_H


22 
	#XAPIAN_INCLUDED_TCPSERVER_H


	)

24 #ifdeà
__WIN32__


25 
	~"»mÙecÚÃùiÚ.h
"

26 
	#SOCKET_INITIALIZER_MIXIN
 : 
´iv©e
 
WšsockIn™Ÿliz”


	)

28 
	#SOCKET_INITIALIZER_MIXIN


	)

31 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


32 
	~"§ãwšdows.h
"

35 
	~<x­Ÿn/visib™y.h
>

37 
	~<¡ršg
>

43 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
TıS”v”
 
	mSOCKET_INITIALIZER_MIXIN
 {

45 
	mİ”©Ü
=(cÚ¡ 
TıS”v”
 &);

48 
TıS”v”
(const TcpServer &);

50 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


52 
HANDLE
 
	mmu‹x
;

56 
	mli¡’_sock‘
;

65 
g‘_li¡’šg_sock‘
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡
, 
pÜt
,

66 
boŞ
 
tı_nod–ay


67 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


68 , 
HANDLE
 &
mu‹x


72 
	m´Ùeùed
:

74 
boŞ
 
v”bo£
;

77 
acû±_cÚÃùiÚ
();

79 
	mpublic
:

89 
TıS”v”
(cÚ¡ 
¡d
::
¡ršg
 &
ho¡
, 
pÜt
, 
boŞ
 
tı_nod–ay
,

90 
boŞ
 
v”bo£
);

93 
	mvœtu®
 ~
TıS”v”
();

101 
run
();

104 
run_Úû
();

107 
vœtu®
 
hªdË_Úe_cÚÃùiÚ
(
sock‘
) = 0;

	@common/termlist.h

21 #iâdeà
XAPIAN_INCLUDED_TERMLIST_H


22 
	#XAPIAN_INCLUDED_TERMLIST_H


	)

24 
	~<¡ršg
>

26 
	~<x­Ÿn/ba£.h
>

27 
	~<x­Ÿn/ty³s.h
>

28 
	~<x­Ÿn/‹rm™”©Ü.h
>

30 
Çme¥aû
 
	gX­Ÿn
 {

31 
şass
 
	gPos™iÚI‹¿tÜ
;

32 
Çme¥aû
 
	gIÁ”Çl
 {

33 
şass
 
	gEx·ndSts
;

38 şas 
	cX­Ÿn
::
T”mI‹¿tÜ
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

40 
İ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

43 
IÁ”Çl
(const Internal &);

45 
	m´Ùeùed
:

47 
	$IÁ”Çl
() { }

49 
public
:

53 
vœtu®
 ~
	`IÁ”Çl
();

56 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const = 0;

59 
vœtu®
 
	`accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const;

62 
vœtu®
 
¡d
::
¡ršg
 
	$g‘_‹rmÇme
() const = 0;

65 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const = 0;

68 
vœtu®
 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const = 0;

75 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_cŞËùiÚ_äeq
() const;

88 
vœtu®
 
IÁ”Çl
 * 
	`Ãxt
() = 0;

95 
vœtu®
 
IÁ”Çl
 * 
	`sk_to
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
);

98 
vœtu®
 
boŞ
 
	$©_’d
() const = 0;

101 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const = 0;

104 
vœtu®
 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const = 0;

105 
	}
};

109 
	gX­Ÿn
::
	tT”mI‹¿tÜ
::
	tIÁ”Çl
 
	tT”mLi¡
;

	@common/unaligned.h

22 #iâdeà
XAPIAN_INCLUDED_UNALIGNED_ACCESS_H


23 
	#XAPIAN_INCLUDED_UNALIGNED_ACCESS_H


	)

25 
	~"omas£¹.h
"

29 
šlše
 

30 
	$g‘št1
(cÚ¡ *
p
, 
c
)

32 
	`As£¹R–
(
c
, >=, 0);

33 
	`As£¹R–
(
c
, <, 65536);

34  
p
[
c
];

35 
	}
}

37 
šlše
 

38 
	$£tšt1
(*
p
, 
c
, 
x
)

40 
	`As£¹R–
(
c
, >=, 0);

41 
	`As£¹R–
(
c
, <, 65536);

42 
p
[
c
] = 
¡©ic_ÿ¡
<>(
x
);

43 
	}
}

45 
šlše
 

46 
	$g‘št2
(cÚ¡ *
p
, 
c
)

48 
	`As£¹R–
(
c
, >=, 0);

49 
	`As£¹R–
(
c
, <, 65536 - 1);

50  
p
[
c
] << 8 |…[c + 1];

51 
	}
}

53 
šlše
 

54 
	$£tšt2
(*
p
, 
c
, 
x
)

56 
	`As£¹R–
(
c
, >=, 0);

57 
	`As£¹R–
(
c
, <, 65536 - 1);

58 
p
[
c
] = 
¡©ic_ÿ¡
<>(
x
 >> 8);

59 
p
[
c
 + 1] = 
¡©ic_ÿ¡
<>(
x
);

60 
	}
}

62 
šlše
 

63 
	$g‘št4
(cÚ¡ *
p
, 
c
)

65 
	`As£¹R–
(
c
, >=, 0);

66 
	`As£¹R–
(
c
, <, 65536 - 3);

67  
p
[
c
] << 24 |…[c + 1] << 16 |…[c + 2] << 8 |…[c + 3];

68 
	}
}

70 
šlše
 

71 
	$£tšt4
(*
p
, 
c
, 
x
)

73 
	`As£¹R–
(
c
, >=, 0);

74 
	`As£¹R–
(
c
, <, 65536 - 3);

75 
p
[
c
] = 
¡©ic_ÿ¡
<>(
x
 >> 24);

76 
p
[
c
 + 1] = 
¡©ic_ÿ¡
<>(
x
 >> 16);

77 
p
[
c
 + 2] = 
¡©ic_ÿ¡
<>(
x
 >> 8);

78 
p
[
c
 + 3] = 
¡©ic_ÿ¡
<>(
x
);

79 
	}
}

	@common/utils.cc

23 
	~<cÚfig.h
>

25 
	~"uts.h
"

27 
	~"x­Ÿn/”rÜ.h
"

28 
	~"§ãdœ’t.h
"

29 
	~"§ã”ºo.h
"

31 
	~<sys/ty³s.h
>

32 
	~<cæßt
>

33 
	~<cm©h
>

35 
usšg
 
Çme¥aû
 
	g¡d
;

37 
boŞ


38 
	$fe_exi¡s
(cÚ¡ 
¡ršg
 &
âame
)

40 
¡©
 
sbuf
;

42  
	`¡©
(
âame
, &
sbuf
è=ğ0 && 
	`S_ISREG
(sbuf.
¡_mode
);

43 
	}
}

45 
boŞ


46 
	$dœ_exi¡s
(cÚ¡ 
¡ršg
 &
âame
)

48 
¡©
 
sbuf
;

50  
	`¡©
(
âame
, &
sbuf
è=ğ0 && 
	`S_ISDIR
(sbuf.
¡_mode
);

51 
	}
}

53 şas 
	cdœşo£r
 {

54 
DIR
 * 
	mdœ
;

55 
	mpublic
:

56 
	$dœşo£r
(
DIR
 * 
dœ_
è: 
	$dœ
(
dœ_
) {}

57 ~
	$dœşo£r
() {

58 ià(
dœ
 !ğ
NULL
) {

59 
	`şo£dœ
(
dœ
);

60 
dœ
 = 
NULL
;

62 
	}
}

66 
	$»movedœ
(cÚ¡ 
¡ršg
 &
dœÇme
)

68 
DIR
 * 
dœ
;

70 
dœ
 = 
	`İ’dœ
(
dœÇme
.
	`c_¡r
());

71 ià(
dœ
 =ğ
NULL
) {

72 ià(
”ºo
 =ğ
ENOENT
) ;

73 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("CªnÙ o³ÀdœeùÜy '" + 
dœÇme
 + "'", 
”ºo
);

77 
dœşo£r
 
	`dc
(
dœ
);

78 
Œue
) {

79 
”ºo
 = 0;

80 
dœ’t
 * 
’Œy
 = 
	`»addœ
(
dœ
);

81 ià(
’Œy
 =ğ
NULL
) {

82 ià(
”ºo
 == 0)

84 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("CªnÙ„—dƒÁry from dœeùÜy‡ˆ'" + 
dœÇme
 + "'", 
”ºo
);

86 
¡ršg
 
	`Çme
(
’Œy
->
d_Çme
);

87 ià(
Çme
 == "." ||‚ame == "..")

89 ià(
	`uÆšk
(
dœÇme
 + "/" + 
Çme
)) {

90 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("CªnÙ„emovf'" + 
	`¡ršg
(
’Œy
->
d_Çme
è+ "'", 
”ºo
);

94 ià(
	`rmdœ
(
dœÇme
)) {

95 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("CªnÙ„emovdœeùÜy '" + 
dœÇme
 + "'", 
”ºo
);

97 
	}
}

99 
Çme¥aû
 
	gX­Ÿn
 {

100 
Çme¥aû
 
	gIÁ”Çl
 {

102 
boŞ
 
w™hš_DBL_EPSILON
(
a
, 
b
) {

103  
çbs
(
a
 - 
b
è>ğ
DBL_EPSILON
;

	@common/utils.h

23 #iâdeà
OM_HGUARD_UTILS_H


24 
	#OM_HGUARD_UTILS_H


	)

26 
	~<x­Ÿn/visib™y.h
>

28 
	~<¡ršg
>

29 
usšg
 
	g¡d
::
¡ršg
;

31 
	~"¡r.h
"

33 
	~<c¡dlib
>

34 
	~<sys/ty³s.h
>

35 
	~"§ãsys¡©.h
"

36 
	~"§ãuni¡d.h
"

39 
	#om_to¡ršg
(
V
è
	`¡r
(V)

	)

43 
XAPIAN_VISIBILITY_DEFAULT


44 
boŞ
 
fe_exi¡s
(cÚ¡ 
¡ršg
 &
âame
);

48 
XAPIAN_VISIBILITY_DEFAULT


49 
boŞ
 
dœ_exi¡s
(cÚ¡ 
¡ršg
 &
dœÇme
);

52 
šlše
 
	$©oi
(cÚ¡ 
¡ršg
 &
s
è{  
	`©oi
(s.
	`c_¡r
()); 
	}
}

55 
šlše
 
	$uÆšk
(cÚ¡ 
¡ršg
 &
f’ame
è{  
	`uÆšk
(f’ame.
	`c_¡r
()); 
	}
}

58 
šlše
 
	$sy¡em
(cÚ¡ 
¡ršg
 &
commªd
è{  
	`sy¡em
(commªd.
	`c_¡r
()); 
	}
}

60 #ifdeà
HAVE_LINK


62 
šlše
 
	$lšk
(cÚ¡ 
¡ršg
 &
o
, cÚ¡ sŒšg &
n
) {

63  
	`lšk
(
o
.
	`c_¡r
(), 
n
.c_str());

64 
	}
}

68 
šlše
 
	$mkdœ
(cÚ¡ 
¡ršg
 &
f’ame
, 
mode_t
 
mode
) {

69  
	`mkdœ
(
f’ame
.
	`c_¡r
(), 
mode
);

70 
	}
}

73 
šlše
 
	$rmdœ
(cÚ¡ 
¡ršg
 &
f’ame
) {

74  
	`rmdœ
(
f’ame
.
	`c_¡r
());

75 
	}
}

78 
šlše
 
	$¡©
(cÚ¡ 
¡ršg
 &
f’ame
, 
¡©
 *
buf
) {

79  
	`¡©
(
f’ame
.
	`c_¡r
(), 
buf
);

80 
	}
}

89 
»movedœ
(cÚ¡ 
¡ršg
 &
dœÇme
);

91 
Çme¥aû
 
	gX­Ÿn
 {

92 
Çme¥aû
 
	gIÁ”Çl
 {

93 
boŞ
 
w™hš_DBL_EPSILON
(
a
, 
b
);

100 şas 
	cfdşo£r
 {

101 
	mpublic
:

102 
	$fdşo£r
(
fd_
è: 
	$fd
(
fd_
) {}

103 ~
	$fdşo£r
() {

104 ià(
fd
 >= 0) {

105 ()
	`şo£
(
fd
);

107 
	}
}

108 
	g´iv©e
:

109 
fd
;

	@common/valuelist.h

21 #iâdeà
XAPIAN_INCLUDED_VALUELIST_H


22 
	#XAPIAN_INCLUDED_VALUELIST_H


	)

24 
	~<¡ršg
>

26 
	~<x­Ÿn/ba£.h
>

27 
	~<x­Ÿn/ty³s.h
>

28 
	~<x­Ÿn/v®ue™”©Ü.h
>

31 şas 
	cX­Ÿn
::
V®ueI‹¿tÜ
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

33 
İ”©Ü
=(cÚ¡ 
IÁ”Çl
 &);

36 
IÁ”Çl
(const Internal &);

38 
	m´Ùeùed
:

40 
	$IÁ”Çl
() { }

42 
public
:

46 
vœtu®
 ~
	`IÁ”Çl
();

49 
vœtu®
 
X­Ÿn
::
docid
 
	$g‘_docid
() const = 0;

52 
vœtu®
 
¡d
::
¡ršg
 
	$g‘_v®ue
() const = 0;

55 
vœtu®
 
X­Ÿn
::
v®u’o
 
	$g‘_v®u’o
() const = 0;

58 
vœtu®
 
boŞ
 
	$©_’d
() const = 0;

66 
vœtu®
 
	`Ãxt
() = 0;

73 
vœtu®
 
	`sk_to
(
X­Ÿn
::
docid
) = 0;

93 
vœtu®
 
boŞ
 
	`check
(
X­Ÿn
::
docid
 
did
);

96 
vœtu®
 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const = 0;

97 
	}
};

101 
	gX­Ÿn
::
	tV®ueI‹¿tÜ
::
	tIÁ”Çl
 
	tV®ueLi¡
;

	@common/valuestats.h

21 #iâdeà
XAPIAN_INCLUDED_VALUESTATS_H


22 
	#XAPIAN_INCLUDED_VALUESTATS_H


	)

24 
	~<¡ršg
>

25 
	~"x­Ÿn/ty³s.h
"

28 
	sV®ueSts
 {

32 
	mX­Ÿn
::
doccouÁ
 
äeq
;

36 
	m¡d
::
¡ršg
 
low”_bound
;

40 
	m¡d
::
¡ršg
 
uµ”_bound
;

43 
V®ueSts
(è: 
äeq
(0), 
low”_bound
(), 
uµ”_bound
() {}

47 
ş—r
() {

48 
	mäeq
 = 0;

49 
	mlow”_bound
.
»size
(0);

50 
	muµ”_bound
.
»size
(0);

	@common/vectortermlist.h

22 #iâdeà
OM_HGUARD_VECTORTERMLIST_H


23 
	#OM_HGUARD_VECTORTERMLIST_H


	)

25 
	~<x­Ÿn/”rÜ.h
>

26 
	~"omas£¹.h
"

27 
	~"‹rmli¡.h
"

29 
	~<li¡
>

30 
	~<veùÜ
>

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 şas 
	cVeùÜT”mLi¡
 : 
public
 
T”mLi¡
 {

35 
´iv©e
:

36 
veùÜ
<
¡ršg
> 
‹rms
;

37 
	mveùÜ
<
	m¡ršg
>::
size_ty³
 
off£t
;

38 
boŞ
 
	mbefÜe_¡¬t
;

40 
	mpublic
:

41 
VeùÜT”mLi¡
(
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
begš
,

42 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
’d
)

43 : 
‹rms
(
begš
, 
’d
), 
off£t
(0), 
	$befÜe_¡¬t
(
Œue
)

47 
	`VeùÜT”mLi¡
(
li¡
<
¡ršg
>::
cÚ¡_™”©Ü
 
begš
,

48 
li¡
<
¡ršg
>::
cÚ¡_™”©Ü
 
’d
)

49 : 
	`‹rms
(
begš
, 
’d
), 
	`off£t
(0), 
	$befÜe_¡¬t
(
Œue
)

51 
	}
}

54 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_­´ox_size
() const {

55  
‹rms
.
	`size
();

56 
	}
}

59 
¡ršg
 
	$g‘_‹rmÇme
() const {

60 
	`As£¹
(!
befÜe_¡¬t
 && 
off£t
 < 
‹rms
.
	`size
());

61  
‹rms
[
off£t
];

62 
	}
}

65 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const {

66 
	`As£¹
(!
befÜe_¡¬t
 && 
off£t
 < 
‹rms
.
	`size
());

68 
	}
}

71 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq
() const {

72 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("VectorTermList::get_termfreq()‚ot supported");

73 
	}
}

82 
T”mLi¡
 * 
	$Ãxt
() {

83 
	`As£¹
(!
	`©_’d
());

84 ià(
befÜe_¡¬t
)

85 
befÜe_¡¬t
 = 
çl£
;

87 
off£t
++;

88  
NULL
;

89 
	}
}

91 
T”mLi¡
 *
	$sk_to
(cÚ¡ 
¡ršg
 & ) {

92 
	`As£¹
(!
	`©_’d
());

94 
	`As£¹
(
çl£
);

95 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("VectorTermList::skip_to()‚ot supported");

96 
	}
}

99 
boŞ
 
	$©_’d
() const {

100  !
befÜe_¡¬t
 && 
off£t
 =ğ
‹rms
.
	`size
();

101 
	}
}

103 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
	$pos™iÚli¡_begš
() const {

104 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("VectorTermList::positionlist_begin() isn't meaningful");

105 
	}
}

107 
	gX­Ÿn
::
‹rmcouÁ
 
	$pos™iÚli¡_couÁ
() const {

108 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("VectorTermList::positionlist_count() isn't meaningful");

109 
	}
}

	@common/weightinternal.h

22 #iâdeà
XAPIAN_INCLUDED_WEIGHTINTERNAL_H


23 
	#XAPIAN_INCLUDED_WEIGHTINTERNAL_H


	)

25 
	~"x­Ÿn/weight.h
"

27 
	~"x­Ÿn/d©aba£.h
"

29 
	~"š‹º®ty³s.h
"

31 
	~<m­
>

32 
	~<¡ršg
>

35 
	sT”mF»qs
 {

36 
	mX­Ÿn
::
doccouÁ
 
‹rmäeq
;

37 
	mX­Ÿn
::
doccouÁ
 
»É”mäeq
;

39 
T”mF»qs
(è: 
‹rmäeq
(0), 
»É”mäeq
(0) {}

40 
T”mF»qs
(
X­Ÿn
::
doccouÁ
 
‹rmäeq_
, X­Ÿn::doccouÁ 
»É”mäeq_
)

41 : 
‹rmäeq
(
‹rmäeq_
), 
»É”mäeq
(
»É”mäeq_
) {}

43 
	mİ”©Ü
 +=(cÚ¡ 
T”mF»qs
 & 
Ùh”
) {

44 
‹rmäeq
 +ğ
Ùh”
.termfreq;

45 
	m»É”mäeq
 +ğ
Ùh”
.
»É”mäeq
;

49 
	m¡d
::
¡ršg
 
g‘_desütiÚ
() const;

52 
Çme¥aû
 
	gX­Ÿn
 {

55 şas 
	cWeight
::
IÁ”Çl
 {

56 
public
:

58 
tÙËn_t
 
tÙ®_Ëngth
;

61 
	gX­Ÿn
::
doccouÁ
 
cŞËùiÚ_size
;

64 
	gX­Ÿn
::
doccouÁ
 
r£t_size
;

67 
	gX­Ÿn
::
D©aba£
 
db
;

71 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gT”mF»qs
> 
	g‹rmäeqs
;

73 
IÁ”Çl
(è: 
tÙ®_Ëngth
(0), 
cŞËùiÚ_size
(0), 
r£t_size
(0) { }

76 
	gIÁ”Çl
 & 
	gİ”©Ü
 +=(cÚ¡ 
IÁ”Çl
 & 
šc
);

83 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

86 
£t_‹rmäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, 
X­Ÿn
::
doccouÁ
 
täeq
);

93 
	gX­Ÿn
::
doccouÁ
 
g‘_»É”mäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

96 
£t_»É”mäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, 
X­Ÿn
::
doccouÁ
 
¹äeq
);

98 
	gX­Ÿn
::
doş’gth
 
g‘_av”age_Ëngth
() const {

99 ià(
¿»
(
cŞËùiÚ_size
 == 0))  0;

100  
	gX­Ÿn
::
doş’gth
(
tÙ®_Ëngth
è/ 
cŞËùiÚ_size
;

104 
£t_bounds_äom_db
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db_
è{ 
db
 = db_; }

107 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

	@common/win32_uuid.cc

21 
	~<cÚfig.h
>

23 
	~"wš32_uuid.h
"

25 
	~"x­Ÿn/”rÜ.h
"

27 
	~<c¡ršg
>

29 
usšg
 
Çme¥aû
 
	g¡d
;

32 cÚ¡ 
size_t
 
	gUUID_SIZE
 = 16;

35 cÚ¡ 
size_t
 
	gUUID_STRING_SIZE
 = 36;

38 
	$uuid_g’”©e
(
uuid_t
 
uu
)

40 
UUID
 
uuid
;

41 ià(
	`¿»
(
	`UuidC»©e
(&
uuid
è!ğ
RPC_S_OK
)) {

47 
throw
 
X­Ÿn
::
	`D©aba£C»©eE¼Ü
("Cannot create UUID");

49 
	`memıy
(
uu
, &
uuid
, 
UUID_SIZE
);

50 
	}
}

53 
	$uuid_·r£
(cÚ¡ * 
š
, 
uuid_t
 
uu
)

55 
UUID
 
uuid
;

56 ià(
	`UuidFromSŒšg
((*)
š
, &
uuid
è!ğ
RPC_S_OK
)

58 
	`memıy
(
uu
, &
uuid
, 
UUID_SIZE
);

60 
	}
}

62 
	$uuid_uÅ¬£_low”
(cÚ¡ 
uuid_t
 
uu
, * 
out
)

64 
UUID
 
uuid
;

65 *
uuid¡r
;

66 
	`memıy
(&
uuid
, 
uu
, 
UUID_SIZE
);

67 ià(
	`¿»
(
	`UuidToSŒšg
(&
uuid
, (**)(&
uuid¡r
)è!ğ
RPC_S_OK
)) {

70 
throw
 
¡d
::
	`bad_®loc
();

72 
	`memıy
(
out
, 
	`¡¾wr
(
uuid¡r
), 
UUID_STRING_SIZE
);

73 
out
[
UUID_STRING_SIZE
] = '\0';

74 
	`RpcSŒšgF»e
((**)(&
uuid¡r
));

75 
	}
}

77 
	$uuid_ş—r
(
uuid_t
 
uu
)

79 
	`mem£t
(
uu
, 0, 
UUID_SIZE
);

80 
	}
}

82 
	$uuid_is_nuÎ
(cÚ¡ 
uuid_t
 
uu
)

84 
i
 = 0;

85 
i
 < 
UUID_SIZE
) {

86 ià(
uu
[
i
++])

90 
	}
}

	@common/win32_uuid.h

21 #iâdeà
XAPIAN_INCLUDED_WIN32_UUID_H


22 
	#XAPIAN_INCLUDED_WIN32_UUID_H


	)

24 #ià!
defšed
 
__CYGWIN__
 && !defšed 
__WIN32__


25 #”rÜ 
Inşudšg
 
wš32_uuid
.
h
, 
but
 
Ã™h”
 
__CYGWIN__
 
nÜ
 
__WIN32__
 
defšed
!

28 
	~"§ãwšdows.h
"

29 
	~<½c.h
>

33 #undeà
uuid_t


34 
	tuuid_t
[16];

36 
uuid_g’”©e
(
uuid_t
 
uu
);

38 
uuid_·r£
(cÚ¡ * 
š
, 
uuid_t
 
uu
);

40 
uuid_uÅ¬£_low”
(cÚ¡ 
uuid_t
 
uu
, * 
out
);

42 
uuid_ş—r
(
uuid_t
 
uu
);

44 
uuid_is_nuÎ
(cÚ¡ 
uuid_t
 
uu
);

	@config.h

8 
	#HAVE_DLFCN_H
 1

	)

11 
	#HAVE_FCNTL_H
 1

	)

14 
	#HAVE_FORK
 1

	)

17 
	#HAVE_FSYNC
 1

	)

20 
	#HAVE_FTIME
 1

	)

23 
	#HAVE_GETHOSTNAME
 1

	)

26 
	#HAVE_GETRUSAGE
 1

	)

29 
	#HAVE_GETTIMEOFDAY
 1

	)

32 
	#HAVE_HSTRERROR
 1

	)

35 
	#HAVE_INTTYPES_H
 1

	)

38 
	#HAVE_LIMITS_H
 1

	)

41 
	#HAVE_LINK
 1

	)

44 
	#HAVE_MEMORY_H
 1

	)

47 
	#HAVE_PREAD
 1

	)

50 
	#HAVE_PWRITE
 1

	)

53 
	#HAVE_SOCKETPAIR
 1

	)

56 
	#HAVE_STDINT_H
 1

	)

59 
	#HAVE_STDLIB_H
 1

	)

62 
	#HAVE_STRERROR
 1

	)

65 
	#HAVE_STRINGS_H
 1

	)

68 
	#HAVE_STRING_H
 1

	)

71 
	#HAVE_SYSCONF
 1

	)

74 
	#HAVE_SYS_ERRNO_H
 1

	)

77 
	#HAVE_SYS_SELECT_H
 1

	)

80 
	#HAVE_SYS_STAT_H
 1

	)

83 
	#HAVE_SYS_TYPES_H
 1

	)

86 
	#HAVE_SYS_UTSNAME_H
 1

	)

89 
	#HAVE_TIMES
 1

	)

92 
	#HAVE_UNISTD_H
 1

	)

95 
	#HAVE_UUID_UNPARSE_LOWER
 1

	)

98 
	#HAVE_UUID_UUID_H
 1

	)

107 
	#HAVE_ZLIB_H
 1

	)

111 
	#LT_OBJDIR
 ".libs/"

	)

114 
	#PACKAGE
 "x­Ÿn-cÜe"

	)

117 
	#PACKAGE_BUGREPORT
 "h‰p://x­Ÿn.Üg/bugs"

	)

120 
	#PACKAGE_NAME
 "x­Ÿn-cÜe"

	)

123 
	#PACKAGE_STRING
 "x­Ÿn-cÜ1.1.4"

	)

126 
	#PACKAGE_TARNAME
 "x­Ÿn-cÜe"

	)

129 
	#PACKAGE_URL
 ""

	)

132 
	#PACKAGE_VERSION
 "1.1.4"

	)

141 
	#SIZEOF_INT
 4

	)

144 
	#SIZEOF_LONG
 4

	)

148 
	#SNPRINTF
 
¢´štf


	)

152 
	#SNPRINTF_ISO
 
¢´štf


	)

155 
	#SOCKLEN_T
 
sockËn_t


	)

158 
	#STDC_HEADERS
 1

	)

161 
	#USE_RTTI
 1

	)

164 
	#VERSION
 "1.1.4"

	)

182 
	#_FILE_OFFSET_BITS
 64

	)

197 #ifdeà
_MSC_VER


198 #´agm¨
w¬nšg
(
di§bË
:4800)

209 #ià
defšed
 
__GNUC__
 && !defšed 
_FORTIFY_SOURCE


210 
	#_FORTIFY_SOURCE
 2

	)

217 #ià
defšed
 
__GNUC__


222 
	#¿»
(
COND
è
	`__butš_ex³ù
(!!(COND), 0)

	)

223 
	#usu®
(
COND
è
	`__butš_ex³ù
(!!(COND), 1)

	)

225 
	#¿»
(
COND
è(COND)

	)

226 
	#usu®
(
COND
è(COND)

	)

	@examples/copydatabase.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn.h
>

25 
	~<iomª
>

26 
	~<io¡»am
>

28 
	~<cm©h
>

29 
	~<c¡dlib
>

30 
	~<c¡ršg
>

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	#PROG_NAME
 "cİyd©aba£"

	)

35 
	#PROG_DESC
 "P”fÜm‡ docum’t-by-docum’ˆcİy oàÚÜ mÜX­ŸÀd©aba£s"

	)

38 
	$show_u§ge
(
rc
)

40 
cout
 << "U§ge: "
PROG_NAME
" SOURCE_DATABASE... DESTINATION_DATABASE\n\n"

43 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

44 
	`ex™
(
rc
);

45 
	}
}

48 
	$maš
(
¬gc
, **
¬gv
)

49 
Œy
 {

50 ià(
¬gc
 > 1 && 
¬gv
[1][0] == '-') {

51 ià(
	`¡rcmp
(
¬gv
[1], "--help") == 0) {

52 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

53 
	`show_u§ge
(0);

55 ià(
	`¡rcmp
(
¬gv
[1], "--version") == 0) {

56 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

57 
	`ex™
(0);

63 ià(
¬gc
 < 3è
	`show_u§ge
(1);

68 cÚ¡ *
de¡
 = 
¬gv
[
¬gc
 - 1];

69 
X­Ÿn
::
Wr™abËD©aba£
 
	`db_out
(
de¡
, X­Ÿn::
DB_CREATE
);

71 
i
 = 1; i < 
¬gc
 - 1; ++i) {

72 * 
¤c
 = 
¬gv
[
i
];

73 ià(*
¤c
) {

75 & 
ch
 = 
¤c
[
	`¡¾’
(src) - 1];

76 ià(
ch
 == '/' || ch == '\\') ch = '\0';

80 
X­Ÿn
::
D©aba£
 
	`db_š
(
¤c
);

83 cÚ¡ * 
Ëaf
 = 
	`¡¼chr
(
¤c
, '/');

84 #ià
defšed
 
__WIN32__
 || defšed 
__EMX__


85 ià(!
Ëaf
èËaàğ
	`¡¼chr
(
¤c
, '\\');

87 ià(
Ëaf
è++Ëaf; Ëaàğ
¤c
;

90 
X­Ÿn
::
doccouÁ
 
dbsize
 = 
db_š
.
	`g‘_doccouÁ
();

91 ià(
dbsize
 == 0) {

92 
cout
 << 
Ëaf
 << ":ƒm±y!" << 
’dl
;

95 
width
 = 
¡©ic_ÿ¡
<>(
	`log10
((
dbsize
))) + 1;

97 
X­Ÿn
::
doccouÁ
 
c
 = 0;

98 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
™
 = 
db_š
.
	`po¡li¡_begš
("");

99 
™
 !ğ
db_š
.
	`po¡li¡_’d
("")) {

100 
db_out
.
	`add_docum’t
(
db_š
.
	`g‘_docum’t
(*
™
));

106 ++
c
;

107 ià(
c
 <ğ10 || (
dbsize
 - c) % 13 == 0) {

108 
cout
 << '\r' << 
Ëaf
 << ": ";

109 
cout
 << 
	`£tw
(
width
è<< 
c
 << '/' << 
dbsize
 << 
æush
;

112 ++
™
;

115 
cout
 << 
’dl
;

118 
cout
 << "Cİyšg s³Îšg d©a..." << 
æush
;

119 
X­Ÿn
::
T”mI‹¿tÜ
 
¥–lwÜd
 = 
db_š
.
	`¥–lšgs_begš
();

120 
¥–lwÜd
 !ğ
db_š
.
	`¥–lšgs_’d
()) {

121 
db_out
.
	`add_¥–lšg
(*
¥–lwÜd
, s³ÎwÜd.
	`g‘_‹rmäeq
());

122 ++
¥–lwÜd
;

124 
cout
 << " dÚe." << 
’dl
;

126 
cout
 << "Cİyšg synÚym d©a..." << 
æush
;

127 
X­Ÿn
::
T”mI‹¿tÜ
 
synkey
 = 
db_š
.
	`synÚym_keys_begš
();

128 
synkey
 !ğ
db_š
.
	`synÚym_keys_’d
()) {

129 
¡ršg
 
key
 = *
synkey
;

130 
X­Ÿn
::
T”mI‹¿tÜ
 
syn
 = 
db_š
.
	`synÚyms_begš
(
key
);

131 
syn
 !ğ
db_š
.
	`synÚyms_’d
(
key
)) {

132 
db_out
.
	`add_synÚym
(
key
, *
syn
);

133 ++
syn
;

135 ++
synkey
;

137 
cout
 << " dÚe." << 
’dl
;

139 
cout
 << "Cİyšg u£¸m‘ad©a..." << 
æush
;

140 
X­Ÿn
::
T”mI‹¿tÜ
 
m‘akey
 = 
db_š
.
	`m‘ad©a_keys_begš
();

141 
m‘akey
 !ğ
db_š
.
	`m‘ad©a_keys_’d
()) {

142 
¡ršg
 
key
 = *
m‘akey
;

143 
db_out
.
	`£t_m‘ad©a
(
key
, 
db_š
.
	`g‘_m‘ad©a
(key));

144 ++
m‘akey
;

146 
cout
 << " dÚe." << 
’dl
;

149 
cout
 << "Comm™tšg..." << 
æush
;

151 
db_out
.
	`comm™
();

152 
cout
 << " dÚe." << 
’dl
;

153 
	}
} 
ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 & 
e
) {

154 
û¼
 << '\n' << 
¬gv
[0] << ": " << 
e
.
g‘_desütiÚ
(è<< 
’dl
;

155 
ex™
(1);

	@examples/delve.cc

23 
	~<cÚfig.h
>

25 
	~<x­Ÿn.h
>

27 
	~<®gÜ™hm
>

28 
	~<io¡»am
>

29 
	~<veùÜ
>

31 
	~"gnu_g‘İt.h
"

33 
	~<c¡ršg
>

35 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
	g£·¿tÜ
 = ' ';

40 
boŞ
 
	gv”bo£
 = 
çl£
;

41 
boŞ
 
	gshowv®ues
 = 
çl£
;

42 
boŞ
 
	gshowdocd©a
 = 
çl£
;

44 
	#PROG_NAME
 "d–ve"

	)

45 
	#PROG_DESC
 "In¥eùhcÚ‹Á oà¨X­ŸÀd©aba£"

	)

47 
	$show_u§ge
() {

48 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] DATABASE...\n\n"

61 " --v”siÚ ouuˆv”siÚ infÜm©iÚ‡ndƒx™" << 
’dl
;

62 
	}
}

65 
	$show_db_¡©s
(
D©aba£
 &
db
)

68 
cout
 << "numb” oàdocum’t ğ" << 
db
.
	`g‘_doccouÁ
(è<< 
’dl
;

69 
cout
 << "av”agdocum’ˆËngth = " << 
db
.
	`g‘_avËngth
(è<< 
’dl
;

70 
cout
 << "docum’ˆËngth†ow” bound = " << 
db
.
	`g‘_doş’gth_low”_bound
()

71 << 
’dl
;

72 
cout
 << "docum’ˆËngth uµ” bound = " << 
db
.
	`g‘_doş’gth_uµ”_bound
()

73 << 
’dl
;

75 ià(
v”bo£
) {

79 
‹rmcouÁ
 
‹rms
 = 0;

80 
T”mI‹¿tÜ
 
t
 = 
db
.
	`®É”ms_begš
();

81 cÚ¡ 
T”mI‹¿tÜ
 
’d
 = 
db
.
	`®É”ms_’d
();

82 
t
 !ğ
’d
) {

83 ++
‹rms
;

84 ++
t
;

86 
cout
 << "numb” oàdi¡šù”m ğ" << 
‹rms
 << 
’dl
;

88 
	}
}

91 
	$show_v®ues
(
D©aba£
 &
db
, 
docid
 docid, 
£p
)

93 
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(
docid
);

94 
V®ueI‹¿tÜ
 
v
 = 
doc
.
	`v®ues_begš
();

95 
v
 !ğ
doc
.
	`v®ues_’d
()) {

96 
cout
 << 
£p
 << 
v
.
	`g‘_v®u’o
() << ':' << *v;

97 ++
v
;

99 
	}
}

102 
show_v®ues
(
D©aba£
 &
db
,

103 
veùÜ
<
docid
>::
cÚ¡_™”©Ü
 
i
,

104 
veùÜ
<
docid
>::
cÚ¡_™”©Ü
 
’d
)

106 
i
 !ğ
’d
) {

107 
cout
 << "V®ue fÜ„ecÜd #" << *
i
 << ':';

108 
show_v®ues
(
db
, *
i
, 
£·¿tÜ
);

109 
	gcout
 << 
	g’dl
;

110 ++
	gi
;

115 
	$show_docd©a
(
D©aba£
 &
db
, 
docid
 docid, 
£p
)

117 
cout
 << 
£p
 << "[" << 
db
.
	`g‘_docum’t
(
docid
).
	`g‘_d©a
() << ']';

118 
	}
}

121 
show_docd©a
(
D©aba£
 &
db
,

122 
veùÜ
<
docid
>::
cÚ¡_™”©Ü
 
i
,

123 
veùÜ
<
docid
>::
cÚ¡_™”©Ü
 
’d
)

125 
i
 !ğ
’d
) {

126 
cout
 << "D©¨fÜ„ecÜd #" << *
i
 << ':' << 
’dl
;

127 
	gcout
 << 
	gdb
.
g‘_docum’t
(*
i
).
g‘_d©a
(è<< 
	g’dl
;

128 ++
	gi
;

133 
show_‹rmli¡s
(
D©aba£
 &
db
,

134 
veùÜ
<
docid
>::
cÚ¡_™”©Ü
 
i
,

135 
veùÜ
<
docid
>::
cÚ¡_™”©Ü
 
’d
)

138 
i
 !ğ
’d
) {

139 
T”mI‹¿tÜ
 
t
 = 
db
.
‹rmli¡_begš
(*
i
);

140 
T”mI‹¿tÜ
 
	g‹nd
 = 
db
.
‹rmli¡_’d
(*
i
);

141 
	gcout
 << "T”m Li¡ fÜ„ecÜd #" << *
	gi
 << ':';

142 
	gt
 !ğ
‹nd
) {

143 
cout
 << 
£·¿tÜ
 << *
t
;

144 ià(
	gv”bo£
) {

145 
	gcout
 << ' ' << 
	gt
.
g‘_wdf
(è<< ' ' <<.
g‘_‹rmäeq
();

147 ++
	gt
;

149 
	gcout
 << 
	g’dl
;

150 ++
	gi
;

154 
S‹m
 
	g¡emm”
;

157 
	$maš
(
¬gc
, **
¬gv
è
Œy
 {

158 ià(
¬gc
 > 1 && 
¬gv
[1][0] == '-') {

159 ià(
	`¡rcmp
(
¬gv
[1], "--help") == 0) {

160 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

161 
	`show_u§ge
();

162 
	`ex™
(0);

164 ià(
	`¡rcmp
(
¬gv
[1], "--version") == 0) {

165 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

166 
	`ex™
(0);

170 
veùÜ
<
docid
> 
»úos
;

171 
veùÜ
<
¡ršg
> 
‹rms
;

172 
veùÜ
<
¡ršg
> 
dbs
;

174 
v®u’o
 
¦Ù
 = 0;

175 
boŞ
 
¦Ù_£t
 = 
çl£
;

177 
c
;

178 (
c
 = 
	`gnu_g‘İt
(
¬gc
, 
¬gv
, "r:t:s:1vkV::d")) != -1) {

179 
c
) {

181 
»úos
.
	`push_back
(
	`©oi
(
İrg
));

184 
‹rms
.
	`push_back
(
İrg
);

187 
¡emm”
 = 
	`S‹m
(
İrg
);

190 
£·¿tÜ
 = '\n';

193 
showv®ues
 = 
Œue
;

194 ià(
İrg
) {

195 
¦Ù
 = 
	`©oi
(
İrg
);

196 
¦Ù_£t
 = 
Œue
;

200 
showdocd©a
 = 
Œue
;

203 
v”bo£
 = 
Œue
;

206 
	`show_u§ge
();

207 
	`ex™
(1);

211 
¬gv
[
İtšd
]è
dbs
.
	`push_back
(argv[optind++]);

213 ià(
dbs
.
	`em±y
()) {

214 
	`show_u§ge
();

215 
	`ex™
(1);

218 
¡d
::
	`sÜt
(
»úos
.
	`begš
(),„eúos.
	`’d
());

220 
D©aba£
 
db
;

222 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

223 
i
 = 
dbs
.
	`begš
(); i !ğdbs.
	`’d
(); i++) {

224 
Œy
 {

225 
db
.
	`add_d©aba£
(
	`D©aba£
(*
i
));

226 } 
	`ÿtch
 (cÚ¡ 
E¼Ü
 &
e
) {

227 
cout
 << "E¼Ü o³nšg d©aba£ `" << *
i
 << "': ";

228 
cout
 << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

234 ià(
‹rms
.
	`em±y
(è&& 
»úos
.em±y(è&& !
¦Ù_£t
) {

236 
	`show_db_¡©s
(
db
);

240 ià(!
»úos
.
	`em±y
()) {

241 ià(
showv®ues
) {

242 
	`show_v®ues
(
db
, 
»úos
.
	`begš
(),„eúos.
	`’d
());

245 ià(
showdocd©a
) {

246 
	`show_docd©a
(
db
, 
»úos
.
	`begš
(),„eúos.
	`’d
());

250 ià(
¦Ù_£t
) {

251 
cout
 << "V®u" << 
¦Ù
 << " forƒach document:";

252 
V®ueI‹¿tÜ
 
™
 = 
db
.
	`v®ue¡»am_begš
(
¦Ù
);

253 
™
 !ğ
db
.
	`v®ue¡»am_’d
(
¦Ù
)) {

254 
cout
 << 
£·¿tÜ
 << 
™
.
	`g‘_docid
() << ':' << *it;

255 ++
™
;

257 
cout
 << 
’dl
;

260 ià(
‹rms
.
	`em±y
()) {

261 
	`show_‹rmli¡s
(
db
, 
»úos
.
	`begš
(),„eúos.
	`’d
());

265 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

266 
i
 = 
‹rms
.
	`begš
(); i !ğ‹rms.
	`’d
(); i++) {

267 
¡ršg
 
‹rm
 = 
	`¡emm”
(*
i
);

268 
Po¡šgI‹¿tÜ
 
p
 = 
db
.
	`po¡li¡_begš
(
‹rm
);

269 
Po¡šgI‹¿tÜ
 
³nd
 = 
db
.
	`po¡li¡_’d
(
‹rm
);

270 ià(
p
 =ğ
³nd
) {

271 
cout
 << "‹rm `" << 
‹rm
 << "'‚ot in database\n";

274 ià(
»úos
.
	`em±y
()) {

276 
cout
 << "Po¡šg Li¡ fÜ”m `" << 
‹rm
 << "' (termfreq "

277 << 
db
.
	`g‘_‹rmäeq
(
‹rm
) << ", collfreq "

278 << 
db
.
	`g‘_cŞËùiÚ_äeq
(
‹rm
) << ", wdf_max "

279 << 
db
.
	`g‘_wdf_uµ”_bound
(
‹rm
) << "):";

280 
p
 !ğ
³nd
) {

281 
cout
 << 
£·¿tÜ
 << *
p
;

282 ià(
v”bo£
) {

283 
cout
 << ' ' << 
p
.
	`g‘_wdf
()

284 << ' ' << 
p
.
	`g‘_doş’gth
();

286 ià(
showv®ues
è
	`show_v®ues
(
db
, *
p
, ' ');

287 ià(
showdocd©a
è
	`show_docd©a
(
db
, *
p
, ' ');

288 
p
++;

290 
cout
 << 
’dl
;

293 
veùÜ
<
docid
>::
cÚ¡_™”©Ü
 
j
;

294 
j
 = 
»úos
.
	`begš
(); j !ğ»úos.
	`’d
(); j++) {

295 
p
.
	`sk_to
(*
j
);

296 ià(
p
 =ğ
³nd
 || *°!ğ*
j
) {

297 
cout
 << "‹rm `" << 
‹rm
 <<

298 "' dÛ¢'ˆšdex docum’ˆ#" << *
j
 << 
’dl
;

300 
cout
 << "Pos™iÚ Li¡ fÜ”m `" << 
‹rm


301 << "',„ecÜd #" << *
j
 << ':';

302 
Œy
 {

303 
Pos™iÚI‹¿tÜ
 
pos
 = 
p
.
	`pos™iÚli¡_begš
();

304 
Pos™iÚI‹¿tÜ
 
po£nd
 = 
p
.
	`pos™iÚli¡_’d
();

305 
pos
 !ğ
po£nd
) {

306 
cout
 << 
£·¿tÜ
 << *
pos
;

307 ++
pos
;

309 
cout
 << 
’dl
;

310 } 
	`ÿtch
 (cÚ¡ 
E¼Ü
 &
e
) {

311 
cout
 << "E¼Ü: " << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

317 
	}
} 
	$ÿtch
 (cÚ¡ 
E¼Ü
 &
e
) {

318 
cout
 << "\nE¼Ü: " << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

320 
	}
}

	@examples/quest.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn.h
>

25 
	~<c¡dlib
>

27 
	~<io¡»am
>

29 
	~"gnu_g‘İt.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	#PROG_NAME
 "que¡"

	)

34 
	#PROG_DESC
 "X­ŸÀcommªd†š£¬choŞ"

	)

37 cÚ¡ * 
	gsw
[] = {

49 
	$show_u§ge
() {

50 
cout
 << "U§ge: "
PROG_NAME
" [OPTIONS] 'QUERY'\n"

59 
	}
}

62 
	$maš
(
¬gc
, **
¬gv
)

63 
Œy
 {

64 cÚ¡ * 
İts
 = "d:m:s:hv";

65 cÚ¡ 
İtiÚ
 
lÚg_İts
[] = {

66 { "db", 
»quœed_¬gum’t
, 0, 'd' },

67 { "msize", 
»quœed_¬gum’t
, 0, 'm' },

68 { "¡emm”", 
»quœed_¬gum’t
, 0, 's' },

69 { "h–p", 
no_¬gum’t
, 0, 'h' },

70 { "v”siÚ", 
no_¬gum’t
, 0, 'v' },

71 { 
NULL
, 0, 0, 0}

74 
X­Ÿn
::
Sim¶eStİ³r
 
	`my¡İ³r
(
sw
, sw + (sw) / (sw[0]));

75 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

76 
msize
 = 10;

78 
boŞ
 
have_d©aba£
 = 
çl£
;

80 
X­Ÿn
::
D©aba£
 
db
;

82 
c
;

83 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, 
İts
, 
lÚg_İts
, 0)) != -1) {

84 
c
) {

86 
msize
 = 
	`©oi
(
İrg
);

89 
db
.
	`add_d©aba£
(
X­Ÿn
::
	`D©aba£
(
İrg
));

90 
have_d©aba£
 = 
Œue
;

93 
Œy
 {

94 
¡emm”
 = 
X­Ÿn
::
	`S‹m
(
İrg
);

95 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Inv®idArgum’tE¼Ü
 &) {

96 
û¼
 << "UnknowÀ¡emmšg†ªguag'" << 
İrg


99 << 
X­Ÿn
::
S‹m
::
	`g‘_avaabË_Ïnguages
(è<< 
’dl
;

100 
	`ex™
(1);

104 
cout
 << 
PROG_NAME
" - "
PACKAGE_STRING
 << 
’dl
;

105 
	`ex™
(0);

107 
cout
 << 
PROG_NAME
" - "
PROG_DESC
"\n\n";

108 
	`show_u§ge
();

109 
	`ex™
(0);

112 
	`show_u§ge
();

113 
	`ex™
(1);

117 ià(
¬gc
 - 
İtšd
 != 1) {

118 
	`show_u§ge
();

119 
	`ex™
(1);

122 
X­Ÿn
::
Qu”yP¬£r
 
·r£r
;

123 
·r£r
.
	`£t_d©aba£
(
db
);

124 
·r£r
.
	`£t_deçuÉ_İ
(
X­Ÿn
::
Qu”y
::
OP_OR
);

125 
·r£r
.
	`£t_¡emm”
(
¡emm”
);

126 
·r£r
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

127 
·r£r
.
	`£t_¡İ³r
(&
my¡İ³r
);

129 
X­Ÿn
::
Qu”y
 
qu”y
 = 
·r£r
.
	`·r£_qu”y
(
¬gv
[
İtšd
]);

130 
cout
 << "Qu”y: " << 
qu”y
.
	`g‘_desütiÚ
(è<< 
’dl
;

132 ià(!
have_d©aba£
) {

133 
cout
 << "NØd©aba£ s³cif›d sØnÙ„uÂšghqu”y." << 
’dl
;

134 
	`ex™
(0);

137 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

138 
’quœe
.
	`£t_qu”y
(
qu”y
);

140 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 
msize
);

142 
cout
 << "MS‘:" << 
’dl
;

143 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t
.
	`begš
(); i !ğm£t.
	`’d
(); i++) {

144 
X­Ÿn
::
Docum’t
 
doc
 = 
i
.
	`g‘_docum’t
();

145 
¡ršg
 
d©a
 = 
doc
.
	`g‘_d©a
();

146 
cout
 << *
i
 << " [" << i.
	`g‘_³rûÁ
(è<< "%]\n" << 
d©a
 << "\n";

148 
cout
 << 
æush
;

149 
	}
} 
ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 & 
e
) {

150 
cout
 << "Couldn'ˆ·r£ qu”y: " << 
e
.
g‘_msg
(è<< 
’dl
;

151 
ex™
(1);

152 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 & 
”r
) {

153 
cout
 << 
”r
.
g‘_desütiÚ
(è<< 
’dl
;

154 
ex™
(1);

	@examples/simpleexpand.cc

21 
	~<x­Ÿn.h
>

23 
	~<io¡»am
>

24 
	~<¡ršg
>

26 
	~<c¡dlib
>

27 
	~<c¡ršg
>

29 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	$maš
(
¬gc
, **
¬gv
)

33 
Œy
 {

35 ià(
¬gc
 < 3) {

36 
rc
 = 1;

37 ià(
¬gv
[1]) {

38 ià(
	`¡rcmp
(
¬gv
[1], "--version") == 0) {

39 
cout
 << "sim¶“x·nd" << 
’dl
;

40 
	`ex™
(0);

42 ià(
	`¡rcmp
(
¬gv
[1], "--help") == 0) {

43 
rc
 = 0;

46 
cout
 << "U§ge: " << 
¬gv
[0] << " PATH_TO_DATABASE QUERY [-- [DOCID...]]" << 
’dl
;

47 
	`ex™
(
rc
);

51 
X­Ÿn
::
D©aba£
 
	`db
(
¬gv
[1]);

54 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

59 
¡ršg
 
	`qu”y_¡ršg
(
¬gv
[2]);

60 
¬gv
 += 3;

61 *
¬gv
 && 
	`¡rcmp
(*argv, "--") != 0) {

62 
qu”y_¡ršg
 += ' ';

63 
qu”y_¡ršg
 +ğ*
¬gv
++;

67 
X­Ÿn
::
RS‘
 
r£t
;

68 ià(*
¬gv
) {

69 *++
¬gv
) {

70 
r£t
.
	`add_docum’t
(
	`©oi
(*
¬gv
));

75 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

76 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

77 
qp
.
	`£t_¡emm”
(
¡emm”
);

78 
qp
.
	`£t_d©aba£
(
db
);

79 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

80 
X­Ÿn
::
Qu”y
 
qu”y
 = 
qp
.
	`·r£_qu”y
(
qu”y_¡ršg
);

81 
cout
 << "P¬£d qu”y is: " << 
qu”y
.
	`g‘_desütiÚ
(è<< 
’dl
;

84 
’quœe
.
	`£t_qu”y
(
qu”y
);

85 
X­Ÿn
::
MS‘
 
m©ches
 = 
’quœe
.
	`g‘_m£t
(0, 10, &
r£t
);

88 
cout
 << 
m©ches
.
	`g‘_m©ches_e¡im©ed
(è<< "„esuÉ found:" << 
’dl
;

90 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m©ches
.
	`begš
(); i !ğm©ches.
	`’d
(); ++i) {

91 
cout
 << 
i
.
	`g‘_¿nk
(è+ 1 << ": " << i.
	`g‘_³rûÁ
() << "% docid=" << *i

92 << " [" << 
i
.
	`g‘_docum’t
().
	`g‘_d©a
() << "]\n\n";

97 ià(
r£t
.
	`em±y
()) {

98 
c
 = 5;

99 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m©ches
.
	`begš
();

100 
c
-- && 
i
 !ğ
m©ches
.
	`’d
()) {

101 
r£t
.
	`add_docum’t
(*
i
);

102 ++
i
;

108 
X­Ÿn
::
ES‘
 
e£t
 = 
’quœe
.
	`g‘_e£t
(10, 
r£t
);

111 
X­Ÿn
::
ES‘I‹¿tÜ
 
t
;

112 
t
 = 
e£t
.
	`begš
(); !ğe£t.
	`’d
(); ++t) {

113 
cout
 << *
t
 << ": weighˆğ" <<.
	`g‘_weight
(è<< 
’dl
;

115 
	}
} 
ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

116 
cout
 << 
e
.
g‘_desütiÚ
(è<< 
’dl
;

117 
ex™
(1);

	@examples/simpleindex.cc

21 
	~<x­Ÿn.h
>

23 
	~<io¡»am
>

24 
	~<¡ršg
>

26 
	~<c¡dlib
>

27 
	~<c¡ršg
>

29 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	$maš
(
¬gc
, **
¬gv
)

33 
Œy
 {

34 ià(
¬gc
 !ğ2 || 
¬gv
[1][0] == '-') {

35 
rc
 = 1;

36 ià(
¬gv
[1]) {

37 ià(
	`¡rcmp
(
¬gv
[1], "--version") == 0) {

38 
cout
 << "sim¶ešdex" << 
’dl
;

39 
	`ex™
(0);

41 ià(
	`¡rcmp
(
¬gv
[1], "--help") == 0) {

42 
rc
 = 0;

45 
cout
 << "U§ge: " << 
¬gv
[0] << " PATH_TO_DATABASE" << 
’dl
;

46 
	`ex™
(
rc
);

50 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
¬gv
[1], X­Ÿn::
DB_CREATE_OR_OPEN
);

52 
X­Ÿn
::
T”mG’”©Ü
 
šdex”
;

53 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

54 
šdex”
.
	`£t_¡emm”
(
¡emm”
);

56 
¡ršg
 
·¿
;

57 
Œue
) {

58 
¡ršg
 
lše
;

59 ià(
cš
.
	`eof
()) {

60 ià(
·¿
.
	`em±y
()) ;

62 
	`g‘lše
(
cš
, 
lše
);

65 ià(
lše
.
	`em±y
()) {

66 ià(!
·¿
.
	`em±y
()) {

68 
X­Ÿn
::
Docum’t
 
doc
;

69 
doc
.
	`£t_d©a
(
·¿
);

71 
šdex”
.
	`£t_docum’t
(
doc
);

72 
šdex”
.
	`šdex_‹xt
(
·¿
);

75 
db
.
	`add_docum’t
(
doc
);

77 
·¿
 = "";

80 ià(!
·¿
.
	`em±y
())…ara += ' ';

81 
·¿
 +ğ
lše
;

84 
	}
} 
ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

85 
cout
 << 
e
.
g‘_desütiÚ
(è<< 
’dl
;

86 
ex™
(1);

	@examples/simplesearch.cc

23 
	~<x­Ÿn.h
>

25 
	~<io¡»am
>

26 
	~<¡ršg
>

28 
	~<c¡dlib
>

29 
	~<c¡ršg
>

31 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	$maš
(
¬gc
, **
¬gv
)

35 
Œy
 {

37 ià(
¬gc
 < 3) {

38 
rc
 = 1;

39 ià(
¬gv
[1]) {

40 ià(
	`¡rcmp
(
¬gv
[1], "--version") == 0) {

41 
cout
 << "sim¶“x·nd" << 
’dl
;

42 
	`ex™
(0);

44 ià(
	`¡rcmp
(
¬gv
[1], "--help") == 0) {

45 
rc
 = 0;

48 
cout
 << "U§ge: " << 
¬gv
[0] << " PATH_TO_DATABASE QUERY [-- [DOCID...]]" << 
’dl
;

49 
	`ex™
(
rc
);

53 
X­Ÿn
::
D©aba£
 
	`db
(
¬gv
[1]);

56 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

61 
¡ršg
 
	`qu”y_¡ršg
(
¬gv
[2]);

62 
¬gv
 += 3;

63 *
¬gv
) {

64 
qu”y_¡ršg
 += ' ';

65 
qu”y_¡ršg
 +ğ*
¬gv
++;

69 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

70 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

71 
qp
.
	`£t_¡emm”
(
¡emm”
);

72 
qp
.
	`£t_d©aba£
(
db
);

73 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

74 
X­Ÿn
::
Qu”y
 
qu”y
 = 
qp
.
	`·r£_qu”y
(
qu”y_¡ršg
);

75 
cout
 << "P¬£d qu”y is: " << 
qu”y
.
	`g‘_desütiÚ
(è<< 
’dl
;

78 
’quœe
.
	`£t_qu”y
(
qu”y
);

79 
X­Ÿn
::
MS‘
 
m©ches
 = 
’quœe
.
	`g‘_m£t
(0, 10);

82 
cout
 << 
m©ches
.
	`g‘_m©ches_e¡im©ed
() << "„esults found.\n";

83 
cout
 << "M©che 1-" << 
m©ches
.
	`size
(è<< ":\n" << 
’dl
;

85 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m©ches
.
	`begš
(); i !ğm©ches.
	`’d
(); ++i) {

86 
cout
 << 
i
.
	`g‘_¿nk
(è+ 1 << ": " << i.
	`g‘_³rûÁ
() << "% docid=" << *i

87 << " [" << 
i
.
	`g‘_docum’t
().
	`g‘_d©a
() << "]\n\n";

89 
	}
} 
ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

90 
cout
 << 
e
.
g‘_desütiÚ
(è<< 
’dl
;

91 
ex™
(1);

	@expand/esetinternal.cc

21 
	~<cÚfig.h
>

23 
	~"e£tš‹º®.h
"

25 
	~"x­Ÿn/ex·nddecid”.h
"

26 
	~"d©aba£.h
"

27 
	~"ex·ndweight.h
"

28 
	~"Ü‹rmli¡.h
"

29 
	~"r£t.h
"

30 
	~"‹rmli¡.h
"

31 
	~"uts.h
"

33 
	~"autİŒ.h
"

34 
	~<£t
>

35 
	~<¡ršg
>

36 
	~<veùÜ
>

38 
usšg
 
Çme¥aû
 
	g¡d
;

40 
Çme¥aû
 
	gX­Ÿn
 {

42 
¡ršg


43 
	gIÁ”Çl
::
Ex·ndT”m
::
g‘_desütiÚ
() const

45 
¡ršg
 
desc
("ExpandTerm(");

46 
	gdesc
 +ğ
om_to¡ršg
(
wt
);

47 
	gdesc
 += ", ";

48 
	gdesc
 +ğ
‹rm
;

49 
	gdesc
 += ')';

50  
	gdesc
;

53 
	g‹m¶©e
<
şass
 
	gCLASS
> 
	sd–‘e_±r
 {

54 
İ”©Ü
()(
CLASS
 *
	gp
è{ 
d–‘e
…; }

57 
	sCom·»T”mLi¡SizeAsûndšg
 {

58 
boŞ
 
İ”©Ü
()(cÚ¡ 
T”mLi¡
 *
	ga
, cÚ¡ T”mLi¡ *
	gb
) {

59  
	ga
->
g‘_­´ox_size
(è> 
	gb
->get_approx_size();

66 
T”mLi¡
 *

67 
bud_‹rmli¡_Œ“
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db
, cÚ¡ 
RS‘I
 & 
r£t
)

69 
As£¹
(!
r£t
.
em±y
());

71 cÚ¡ 
	g£t
<
	gX­Ÿn
::
docid
> & 
docids
 = 
r£t
.
docum’ts
;

73 
	gveùÜ
<
	gT”mLi¡
*> 
	g‹rmli¡s
;

74 
	g‹rmli¡s
.
»£rve
(
docids
.
size
());

76 
	gŒy
 {

77 cÚ¡ 
size_t
 
	gmuÉl›r
 = 
db
.
š‹º®
.
size
();

78 
	g£t
<
	gX­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
i
;

79 
	gi
 = 
docids
.
begš
(); i !ğdocids.
’d
(); ++i) {

80 
	gX­Ÿn
::
docid
 
»®did
 = (*
i
 - 1è/ 
muÉl›r
 + 1;

81 
	gX­Ÿn
::
doccouÁ
 
dbnumb”
 = (*
i
 - 1è% 
muÉl›r
;

85 
	g‹rmli¡s
.
push_back
(0);

86 
	g‹rmli¡s
.
back
(èğ
db
.
š‹º®
[
dbnumb”
]->
İ’_‹rm_li¡
(
»®did
);

89 
As£¹
(!
‹rmli¡s
.
em±y
());

90 ià(
	g‹rmli¡s
.
size
(è=ğ1è 
‹rmli¡s
[0];

94 
make_h—p
(
‹rmli¡s
.
begš
(),”mli¡s.
’d
(),

95 
Com·»T”mLi¡SizeAsûndšg
());

103 
	gŒue
) {

104 
As£¹R–
(
‹rmli¡s
.
size
(), >=, 2);

111 
T”mLi¡
 * 
	gr
 = 
‹rmli¡s
.
äÚt
();

112 
pİ_h—p
(
‹rmli¡s
.
begš
(),”mli¡s.
’d
(),

113 
Com·»T”mLi¡SizeAsûndšg
());

114 
	g‹rmli¡s
.
pİ_back
();

115 
T”mLi¡
 * 
	gl
 = 
‹rmli¡s
.
äÚt
();

117 
T”mLi¡
 * 
	g¶
 = 
Ãw
 
OrT”mLi¡
(
l
, 
r
);

119 ià(
	g‹rmli¡s
.
size
(è=ğ1è 
¶
;

121 
pİ_h—p
(
‹rmli¡s
.
begš
(),”mli¡s.
’d
(),

122 
Com·»T”mLi¡SizeAsûndšg
());

123 
	g‹rmli¡s
.
back
(èğ
¶
;

124 
push_h—p
(
‹rmli¡s
.
begš
(),”mli¡s.
’d
(),

125 
Com·»T”mLi¡SizeAsûndšg
());

127 } 
ÿtch
 (...) {

128 
fÜ_—ch
(
‹rmli¡s
.
begš
(),”mli¡s.
’d
(), 
d–‘e_±r
<
T”mLi¡
>());

129 
	gthrow
;

134 
	gES‘
::
IÁ”Çl
::
ex·nd
(
X­Ÿn
::
‹rmcouÁ
 
max_esize
,

135 cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
,

136 cÚ¡ 
RS‘I
 & 
r£t
,

137 cÚ¡ 
X­Ÿn
::
Ex·ndDecid”
 * 
edecid”
,

138 cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
Ex·ndWeight
 & 
eweight
)

140 
DEBUGCALL
(
EXPAND
, , "ESet::Internal::expand",

141 
max_esize
 << ", " << 
db
 << ", [rseti], " <<

142 
edecid”
 << ", [eweight]");

144 
As£¹
(
max_esize
);

145 
As£¹
(!
r£t
.
em±y
());

148 
As£¹
(
ebound
 == 0);

149 
As£¹
(
™ems
.
em±y
());

151 
	gX­Ÿn
::
weight
 
mš_wt
 = 0;

153 
	gAutoPŒ
<
	gT”mLi¡
> 
Œ“
(
bud_‹rmli¡_Œ“
(
db
, 
r£t
));

154 
As£¹
(
Œ“
.
g‘
());

156 
boŞ
 
	gis_h—p
 = 
çl£
;

157 
	gŒue
) {

159 
T”mLi¡
 * 
	gÃw_roÙ
 = 
Œ“
->
Ãxt
();

160 ià(
	gÃw_roÙ
) {

161 
LOGLINE
(
EXPAND
, "Replacinghe„oot ofheermlistree");

162 
	gŒ“
.
»£t
(
Ãw_roÙ
);

165 ià(
	gŒ“
->
©_’d
()) ;

167 
¡ršg
 
	g‹rm
 = 
Œ“
->
g‘_‹rmÇme
();

170 ià(
	gedecid”
 && !(*edecid”)(
	g‹rm
)) ;

172 ++
	gebound
;

174 
	gX­Ÿn
::
weight
 
wt
 = 
eweight
.
g‘_weight
(
Œ“
.
g‘
(), 
‹rm
);

177 ià(
	gwt
 <ğ
mš_wt
) ;

179 
	g™ems
.
push_back
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndT”m
(
wt
, 
‹rm
));

183 ià(
	g™ems
.
size
(è> 
	gmax_esize
) {

184 ià(
¿»
(!
is_h—p
)) {

185 
	gis_h—p
 = 
Œue
;

186 
make_h—p
(
™ems
.
begš
(), i‹ms.
’d
());

188 
push_h—p
(
™ems
.
begš
(), i‹ms.
’d
());

190 
pİ_h—p
(
™ems
.
begš
(), i‹ms.
’d
());

191 
	g™ems
.
pİ_back
();

192 
	gmš_wt
 = 
™ems
.
äÚt
().
wt
;

197 ià(
	gis_h—p
) {

198 
sÜt_h—p
(
™ems
.
begš
(), i‹ms.
’d
());

200 
sÜt
(
™ems
.
begš
(), i‹ms.
’d
());

204 
¡ršg


205 
	gES‘
::
IÁ”Çl
::
g‘_desütiÚ
() const

207 
¡ršg
 
desc
("ESet::Internal(ebound=");

208 
	gdesc
 +ğ
om_to¡ršg
(
ebound
);

210 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
Ex·ndT”m
>::
cÚ¡_™”©Ü
 
i
;

211 
	gi
 = 
™ems
.
begš
(); i !ğ™ems.
’d
(); ++i) {

212 
	gdesc
 += ", ";

213 
	gdesc
 +ğ
i
->
g‘_desütiÚ
();

215 
	gdesc
 += ')';

217  
	gdesc
;

	@expand/expandweight.cc

21 
	~<cÚfig.h
>

23 
	~"ex·ndweight.h
"

25 
	~"debuglog.h
"

26 
	~"omas£¹.h
"

27 
	~"‹rmli¡.h
"

29 
	~<cm©h
>

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
Çme¥aû
 
	gX­Ÿn
 {

34 
Çme¥aû
 
	gIÁ”Çl
 {

36 
	gX­Ÿn
::
weight


37 
Ex·ndWeight
::
g‘_weight
(
T”mLi¡
 * 
m”g”
, cÚ¡ 
¡ršg
 & 
‹rm
) const

39 
LOGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "Ex·ndWeight::g‘_weight", "[m”g”], " << 
‹rm
);

42 
Ex·ndSts
 
¡©s
(
avËn
, 
ex·nd_k
);

43 
	gm”g”
->
accumuÏ‹_¡©s
(
¡©s
);

45 
	g‹rmäeq
 = 
¡©s
.
‹rmäeq
;

46 
	g¹”mäeq
 = 
¡©s
.
¹”mäeq
;

48 
LOGVALUE
(
EXPAND
, 
rsize
);

49 
LOGVALUE
(
EXPAND
, 
¹”mäeq
);

51 
LOGVALUE
(
EXPAND
, 
dbsize
);

52 
LOGVALUE
(
EXPAND
, 
¡©s
.
dbsize
);

53 ià(
	g¡©s
.
	gdbsize
 =ğ
dbsize
) {

58 
As£¹EqP¬ªoid
(
‹rmäeq
, 
db
.
g‘_‹rmäeq
(
‹rm
));

60 
As£¹R–
(
¡©s
.
dbsize
,<,dbsize);

64 ià(
	gu£_exaù_‹rmäeq
) {

65 
LOGLINE
(
EXPAND
, "Hado„equestƒxactermfreq");

66 
	g‹rmäeq
 = 
db
.
g‘_‹rmäeq
(
‹rm
);

70 
	g‹rmäeq
 *ğ(
dbsize
è/ (
¡©s
.dbsize);

71 
LOGLINE
(
EXPAND
, "‹rmäeq i ­´ox " << 
¡©s
.
‹rmäeq
 << " * " <<

72 
dbsize
 << " / " << 
¡©s
.dbsize << " = " <<

73 
‹rmäeq
);

74 
LOGVALUE
(
EXPAND
, 
db
.
g‘_‹rmäeq
(
‹rm
));

75 ià(
	g‹rmäeq
 < 
	g¹”mäeq
) {

78 
LOGLINE
(
EXPAND
, "termfreq must be‡t†east„termfreq");

79 
	g‹rmäeq
 = 
¹”mäeq
;

88 
	g‹rmäeq_uµ”_bound
 = 
dbsize
 - (
rsize
 - 
¹”mäeq
);

89 ià(
	g‹rmäeq
 > 
	g‹rmäeq_uµ”_bound
) {

90 
LOGLINE
(
EXPAND
, "termfreq can't be morehan "

92 
	g‹rmäeq
 = 
‹rmäeq_uµ”_bound
;

97 
LOGVALUE
(
EXPAND
, 
‹rmäeq
);

99 
	g»ldocs_w™hout_‹rm
 = 
rsize
 - 
¹”mäeq
;

100 
	gnum
, 
	gd’om
;

101 
	gnum
 = (
¹”mäeq
 + 0.5è* (
dbsize
 - 
‹rmäeq
 - 
»ldocs_w™hout_‹rm
 + 0.5);

102 
As£¹R–
(
num
,>,0);

103 
	gd’om
 = (
‹rmäeq
 - 
¹”mäeq
 + 0.5è* (
»ldocs_w™hout_‹rm
 + 0.5);

104 
As£¹R–
(
d’om
,>,0);

107 ià(
¿»
(
num
 <ğ
d’om
)è
RETURN
(0.0);

109 
	gX­Ÿn
::
weight
 
tw
 = 
log
(
num
 / 
d’om
);

110 
LOGVALUE
(
EXPAND
, 
tw
);

111 
LOGVALUE
(
EXPAND
, 
¡©s
.
muÉl›r
);

112 
RETURN
(
¡©s
.
muÉl›r
 * 
tw
);

	@expand/ortermlist.cc

21 
	~<cÚfig.h
>

23 
	~"omas£¹.h
"

24 
	~"omdebug.h
"

26 
	~"Ü‹rmli¡.h
"

28 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gOrT”mLi¡
::
	$check_¡¬‹d
() const

35 
	`As£¹
(!
Ëá_cu¼’t
.
	`em±y
());

36 
	`As£¹
(!
right_cu¼’t
.
	`em±y
());

37 
	}
}

39 
	gOrT”mLi¡
::~
	$OrT”mLi¡
()

41 
d–‘e
 
Ëá
;

42 
d–‘e
 
right
;

43 
	}
}

45 
	gX­Ÿn
::
‹rmcouÁ


46 
OrT”mLi¡
::
	$g‘_­´ox_size
() const

48 
	`DEBUGCALL
(
EXPAND
, 
X­Ÿn
::
‹rmcouÁ
, "OrTermList::get_approx_size", "");

52 
	`RETURN
(
Ëá
->
	`g‘_­´ox_size
(è+ 
right
->get_approx_size());

53 
	}
}

56 
	gOrT”mLi¡
::
accumuÏ‹_¡©s
(
X­Ÿn
::
IÁ”Çl
::
Ex·ndSts
 & 
¡©s
) const

58 
DEBUGCALL
(
EXPAND
, , "OrTermList::accumulate_stats", "[stats&]");

59 
check_¡¬‹d
();

60 ià(
	gËá_cu¼’t
 <ğ
right_cu¼’t
è
Ëá
->
accumuÏ‹_¡©s
(
¡©s
);

61 ià(
	gËá_cu¼’t
 >ğ
right_cu¼’t
è
right
->
accumuÏ‹_¡©s
(
¡©s
);

64 
¡ršg


65 
	gOrT”mLi¡
::
	$g‘_‹rmÇme
() const

67 
	`DEBUGCALL
(
EXPAND
, 
¡ršg
, "OrTermList::get_termname", "");

68 
	`check_¡¬‹d
();

69 ià(
Ëá_cu¼’t
 < 
right_cu¼’t
è
	`RETURN
(left_current);

70 
	`RETURN
(
right_cu¼’t
);

71 
	}
}

73 
	gX­Ÿn
::
‹rmcouÁ


74 
OrT”mLi¡
::
	$g‘_wdf
() const

76 
	`DEBUGCALL
(
EXPAND
, 
X­Ÿn
::
‹rmcouÁ
, "OrTermList::get_wdf", "");

77 
	`check_¡¬‹d
();

78 ià(
Ëá_cu¼’t
 < 
right_cu¼’t
è
	`RETURN
(
Ëá
->
	`g‘_wdf
());

79 ià(
Ëá_cu¼’t
 > 
right_cu¼’t
è
	`RETURN
(
right
->
	`g‘_wdf
());

80 
	`RETURN
(
Ëá
->
	`g‘_wdf
(è+ 
right
->get_wdf());

81 
	}
}

83 
	gX­Ÿn
::
doccouÁ


84 
OrT”mLi¡
::
	$g‘_‹rmäeq
() const

86 
	`DEBUGCALL
(
EXPAND
, 
X­Ÿn
::
doccouÁ
, "OrTermList::get_termfreq", "");

87 
	`check_¡¬‹d
();

88 ià(
Ëá_cu¼’t
 < 
right_cu¼’t
è
	`RETURN
(
Ëá
->
	`g‘_‹rmäeq
());

89 
	`As£¹
(
Ëá_cu¼’t
 > 
right_cu¼’t
 || 
Ëá
->
	`g‘_‹rmäeq
(è=ğ
right
->get_termfreq());

90 
	`RETURN
(
right
->
	`g‘_‹rmäeq
());

91 
	}
}

94 
	gX­Ÿn
::
‹rmcouÁ


95 
OrT”mLi¡
::
	$g‘_cŞËùiÚ_äeq
() const

97 
	`DEBUGCALL
(
EXPAND
, 
X­Ÿn
::
‹rmcouÁ
, "OrTermList::get_collection_freq", "");

98 
	`check_¡¬‹d
();

99 ià(
Ëá_cu¼’t
 < 
right_cu¼’t
è
	`RETURN
(
Ëá
->
	`g‘_cŞËùiÚ_äeq
());

100 
	`As£¹
(
Ëá_cu¼’t
 > 
right_cu¼’t
 || 
Ëá
->
	`g‘_cŞËùiÚ_äeq
(è=ğ
right
->get_collection_freq());

101 
	`RETURN
(
right
->
	`g‘_cŞËùiÚ_äeq
());

102 
	}
}

106 
šlše
 

107 
	$hªdË_´uÃ
(
T”mLi¡
 *& 
Şd
, T”mLi¡ * 
»suÉ
)

109 ià(
»suÉ
) {

110 
d–‘e
 
Şd
;

111 
Şd
 = 
»suÉ
;

113 
	}
}

115 
T”mLi¡
 *

116 
	gOrT”mLi¡
::
	$Ãxt
()

118 
	`DEBUGCALL
(
EXPAND
, 
T”mLi¡
 *, "OrTermList::next", "");

122 ià(
Ëá_cu¼’t
 < 
right_cu¼’t
) {

123 
	`hªdË_´uÃ
(
Ëá
,†eá->
	`Ãxt
());

124 ià(
Ëá
->
	`©_’d
()) {

125 
T”mLi¡
 *
»t
 = 
right
;

126 
right
 = 
NULL
;

127 
	`RETURN
(
»t
);

129 
Ëá_cu¼’t
 = 
Ëá
->
	`g‘_‹rmÇme
();

130 } ià(
Ëá_cu¼’t
 > 
right_cu¼’t
) {

131 
	`hªdË_´uÃ
(
right
,„ight->
	`Ãxt
());

132 ià(
right
->
	`©_’d
()) {

133 
T”mLi¡
 *
»t
 = 
Ëá
;

134 
Ëá
 = 
NULL
;

135 
	`RETURN
(
»t
);

137 
right_cu¼’t
 = 
right
->
	`g‘_‹rmÇme
();

139 
	`As£¹Eq
(
Ëá_cu¼’t
, 
right_cu¼’t
);

140 
	`hªdË_´uÃ
(
Ëá
,†eá->
	`Ãxt
());

141 
	`hªdË_´uÃ
(
right
,„ight->
	`Ãxt
());

142 ià(
Ëá
->
	`©_’d
()) {

145 
T”mLi¡
 *
»t
 = 
right
;

146 
right
 = 
NULL
;

147 
	`RETURN
(
»t
);

149 ià(
right
->
	`©_’d
()) {

150 
T”mLi¡
 *
»t
 = 
Ëá
;

151 
Ëá
 = 
NULL
;

152 
	`RETURN
(
»t
);

154 
Ëá_cu¼’t
 = 
Ëá
->
	`g‘_‹rmÇme
();

155 
right_cu¼’t
 = 
right
->
	`g‘_‹rmÇme
();

157 
	`RETURN
(
NULL
);

158 
	}
}

160 
boŞ


161 
	gOrT”mLi¡
::
	$©_’d
() const

163 
	`DEBUGCALL
(
EXPAND
, 
boŞ
, "OrTermList::at_end", "");

164 
	`check_¡¬‹d
();

166 
	`As£¹
(!
Ëá
->
	`©_’d
());

167 
	`As£¹
(!
right
->
	`©_’d
());

168 
	`RETURN
(
çl£
);

169 
	}
}

171 
	gX­Ÿn
::
‹rmcouÁ


172 
OrT”mLi¡
::
	$pos™iÚli¡_couÁ
() const

174 
	`As£¹
(
çl£
);

176 
	}
}

178 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ


179 
OrT”mLi¡
::
	$pos™iÚli¡_begš
() const

181 
	`As£¹
(
çl£
);

182  
X­Ÿn
::
	`Pos™iÚI‹¿tÜ
(
NULL
);

183 
	}
}

186 
	gX­Ÿn
::
doccouÁ


187 
F»qAdd”OrT”mLi¡
::
	$g‘_‹rmäeq
() const

189 
	`DEBUGCALL
(
EXPAND
, 
X­Ÿn
::
doccouÁ
, "FreqAdderOrTermList::get_termfreq", "");

190 
	`check_¡¬‹d
();

191 ià(
Ëá_cu¼’t
 < 
right_cu¼’t
è
	`RETURN
(
Ëá
->
	`g‘_‹rmäeq
());

192 ià(
Ëá_cu¼’t
 > 
right_cu¼’t
è
	`RETURN
(
right
->
	`g‘_‹rmäeq
());

193 
	`RETURN
(
Ëá
->
	`g‘_‹rmäeq
(è+ 
right
->get_termfreq());

194 
	}
}

	@include/xapian.h

20 #iâdeà
XAPIAN_INCLUDED_XAPIAN_H


21 
	#XAPIAN_INCLUDED_XAPIAN_H


	)

24 
	~<x­Ÿn/v”siÚ.h
>

27 
	~<x­Ÿn/ty³s.h
>

30 
	~<x­Ÿn/”rÜ.h
>

31 
	~<x­Ÿn/”rÜhªdËr.h
>

34 
	~<x­Ÿn/d©aba£.h
>

35 
	~<x­Ÿn/dbçùÜy.h
>

36 
	~<x­Ÿn/docum’t.h
>

37 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

38 
	~<x­Ÿn/po¡šg™”©Ü.h
>

39 
	~<x­Ÿn/‹rm™”©Ü.h
>

40 
	~<x­Ÿn/v®ue™”©Ü.h
>

43 
	~<x­Ÿn/‹rmg’”©Ü.h
>

46 
	~<x­Ÿn/’quœe.h
>

47 
	~<x­Ÿn/ex·nddecid”.h
>

48 
	~<x­Ÿn/keymak”.h
>

49 
	~<x­Ÿn/m©ch¥y.h
>

50 
	~<x­Ÿn/po¡šgsourû.h
>

51 
	~<x­Ÿn/qu”y.h
>

52 
	~<x­Ÿn/qu”y·r£r.h
>

53 
	~<x­Ÿn/v®ue£tm©chdecid”.h
>

54 
	~<x­Ÿn/weight.h
>

57 
	~<x­Ÿn/¡em.h
>

60 
	~<x­Ÿn/»gi¡ry.h
>

63 
	~<x­Ÿn/unicode.h
>

66 
	~<x­Ÿn/visib™y.h
>

69 
Çme¥aû
 
	gX­Ÿn
 {

78 
XAPIAN_VISIBILITY_DEFAULT


79 cÚ¡ * 
v”siÚ_¡ršg
();

86 
XAPIAN_VISIBILITY_DEFAULT


87 
majÜ_v”siÚ
();

94 
XAPIAN_VISIBILITY_DEFAULT


95 
mšÜ_v”siÚ
();

102 
XAPIAN_VISIBILITY_DEFAULT


103 
»visiÚ
();

	@include/xapian/base.h

24 #iâdeà
XAPIAN_INCLUDED_BASE_H


25 
	#XAPIAN_INCLUDED_BASE_H


	)

27 
	~<x­Ÿn/d•»ÿ‹d.h
>

29 
Çme¥aû
 
	gX­Ÿn
 {

30 
Çme¥aû
 
	gIÁ”Çl
 {

36 şas 
	cRefCÁBa£
 {

40 
	g´Ùeùed
:

48 
RefCÁBa£
(cÚ¡ RefCÁBa£ &è: 
»f_couÁ
(0) { }

50 
public
:

52 
RefCÁBa£
(è: 
»f_couÁ
(0) { }

54 
	t»f_couÁ_t
;

59 
mubË
 
»f_couÁ_t
 
	g»f_couÁ
;

66 
	g‹m¶©e
 <
şass
 
	gT
>

67 şas 
	cRefCÁPŒ
 {

68 
	g´iv©e
:

69 
T
 *
de¡
;

71 
	gpublic
:

72 
T
 *
İ”©Ü
->() const;

73 
	gT
 &
	gİ”©Ü
*() const;

74 
T
 *
g‘
() const;

83 
RefCÁPŒ
(
T
 *
de¡_
);

84 
RefCÁPŒ
();

85 
RefCÁPŒ
(cÚ¡ RefCÁPŒ &
Ùh”
);

86 
	gİ”©Ü
=(cÚ¡ 
RefCÁPŒ
 &
Ùh”
);

87 
	gİ”©Ü
=(
T
 *
de¡_
);

88 ~
RefCÁPŒ
();

90 
	g‹m¶©e
 <
şass
 
	gU
>

91 
RefCÁPŒ
(cÚ¡ RefCÁPŒ<
U
> &
Ùh”
);

94 
	g‹m¶©e
 <
şass
 
	gT
>

95 
šlše
 
	gRefCÁPŒ
<
	gT
>::
RefCÁPŒ
(
T
 *
de¡_
è: 
de¡
(dest_)

97 ià(
de¡
è++de¡->
»f_couÁ
;

100 
	g‹m¶©e
 <
şass
 
	gT
>

101 
šlše
 
	gRefCÁPŒ
<
	gT
>::
RefCÁPŒ
(è: 
de¡
(0)

105 
‹m¶©e
 <
şass
 
T
>

106 
šlše
 
RefCÁPŒ
<
T
>::RefCÁPŒ(cÚ¡ RefCÁPŒ &
Ùh”
è: 
de¡
(other.dest)

108 ià(
de¡
è++de¡->
»f_couÁ
;

111 
	g‹m¶©e
 <
şass
 
	gT
>

112 
šlše
 
	gRefCÁPŒ
<
	gT
>::
İ”©Ü
=(cÚ¡ 
RefCÁPŒ
 &
Ùh”
) {

113 
İ”©Ü
=(
Ùh”
.
de¡
);

116 
	g‹m¶©e
 <
şass
 
	gT
>

117 
šlše
 
	gRefCÁPŒ
<
	gT
>::
İ”©Ü
=(
T
 *
de¡_
) {

119 ià(
de¡
 =ğ
de¡_
) ;

124 
T
 *
	gŞd_de¡
 = 
de¡
;

125 
	gde¡
 = 
de¡_
;

126 ià(
	gde¡
è++de¡->
	g»f_couÁ
;

127 ià(
	gŞd_de¡
 && --Şd_de¡->
	g»f_couÁ
 =ğ0è
d–‘e
 
Şd_de¡
;

130 
	g‹m¶©e
 <
şass
 
	gT
>

131 
šlše
 
	gRefCÁPŒ
<
	gT
>::~
RefCÁPŒ
()

133 ià(
de¡
 && --de¡->
»f_couÁ
 == 0) {

137 
T
 * 
cÚdemÃd
 = 
de¡
;

138 
	gde¡
 = 0;

139 
d–‘e
 
	gcÚdemÃd
;

143 
	g‹m¶©e
 <
şass
 
	gT
>

144 
	g‹m¶©e
 <
şass
 
	gU
>

145 
šlše


146 
	gRefCÁPŒ
<
	gT
>::
RefCÁPŒ
(cÚ¡ RefCÁPŒ<
U
> &
Ùh”
)

147 : 
de¡
(
Ùh”
.
g‘
())

149 ià(
de¡
è++de¡->
»f_couÁ
;

152 
	g‹m¶©e
 <
şass
 
	gT
>

153 
šlše
 
T
 *
	gRefCÁPŒ
<
	gT
>::
İ”©Ü
->() const

155  
de¡
;

158 
	g‹m¶©e
 <
şass
 
	gT
>

159 
šlše
 
	gT
 &
	gRefCÁPŒ
<T>::
İ”©Ü
*() const

161  *
de¡
;

164 
	g‹m¶©e
 <
şass
 
	gT
>

165 
šlše
 
T
 *
	gRefCÁPŒ
<
	gT
>::
g‘
() const

167  
de¡
;

	@include/xapian/database.h

25 #iâdeà
XAPIAN_INCLUDED_DATABASE_H


26 
	#XAPIAN_INCLUDED_DATABASE_H


	)

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
	~<x­Ÿn/ba£.h
>

32 
	~<x­Ÿn/docum’t.h
>

33 
	~<x­Ÿn/ty³s.h
>

34 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

35 
	~<x­Ÿn/po¡šg™”©Ü.h
>

36 
	~<x­Ÿn/‹rm™”©Ü.h
>

37 
	~<x­Ÿn/v®ue™”©Ü.h
>

38 
	~<x­Ÿn/visib™y.h
>

40 
Çme¥aû
 
	gX­Ÿn
 {

56 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£
 {

57 
	gpublic
:

58 
şass
 
IÁ”Çl
;

60 
	g¡d
::
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> > 
š‹º®
;

77 
	gDocum’t
::
IÁ”Çl
 * 
g‘_docum’t_Ïzy
(
X­Ÿn
::
docid
 
did
) const;

84 
add_d©aba£
(cÚ¡ 
D©aba£
 & 
d©aba£
);

88 
D©aba£
();

95 
ex¶ic™
 
D©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
·th
);

99 
ex¶ic™
 
D©aba£
(
IÁ”Çl
 *
š‹º®
);

106 
	gvœtu®
 ~
D©aba£
();

111 
D©aba£
(cÚ¡ D©aba£ &
Ùh”
);

116 
	gİ”©Ü
=(cÚ¡ 
D©aba£
 &
Ùh”
);

127 
»İ’
();

156 
vœtu®
 
şo£
();

159 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

169 
Po¡šgI‹¿tÜ
 
po¡li¡_begš
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
) const;

173 
Po¡šgI‹¿tÜ
 
po¡li¡_’d
(cÚ¡ 
¡d
::
¡ršg
 &) const {

174  
Po¡šgI‹¿tÜ
(
NULL
);

180 
T”mI‹¿tÜ
 
‹rmli¡_begš
(
X­Ÿn
::
docid
 
did
) const;

184 
T”mI‹¿tÜ
 
‹rmli¡_’d
(
X­Ÿn
::
docid
) const {

185  
T”mI‹¿tÜ
(
NULL
);

189 
boŞ
 
has_pos™iÚs
() const;

194 
Pos™iÚI‹¿tÜ
 
pos™iÚli¡_begš
(
X­Ÿn
::
docid
 
did
, cÚ¡ 
¡d
::
¡ršg
 &
Šame
) const;

198 
Pos™iÚI‹¿tÜ
 
pos™iÚli¡_’d
(
X­Ÿn
::
docid
, cÚ¡ 
¡d
::
¡ršg
 &) const {

199  
Pos™iÚI‹¿tÜ
(
NULL
);

204 
T”mI‹¿tÜ
 
®É”ms_begš
() const;

208 
T”mI‹¿tÜ
 
®É”ms_’d
() const {

209  
T”mI‹¿tÜ
(
NULL
);

223 
T”mI‹¿tÜ
 
®É”ms_begš
(cÚ¡ 
¡d
::
¡ršg
 & 
´efix
) const;

227 
T”mI‹¿tÜ
 
®É”ms_’d
(cÚ¡ 
¡d
::
¡ršg
 &) const {

228  
T”mI‹¿tÜ
(
NULL
);

232 
	gX­Ÿn
::
doccouÁ
 
g‘_doccouÁ
() const;

235 
	gX­Ÿn
::
docid
 
g‘_Ï¡docid
() const;

238 
	gX­Ÿn
::
doş’gth
 
g‘_avËngth
() const;

241 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
) const;

249 
boŞ
 
‹rm_exi¡s
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
) const;

260 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_cŞËùiÚ_äeq
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
) const;

272 
	gX­Ÿn
::
doccouÁ
 
g‘_v®ue_äeq
(
X­Ÿn
::
v®u’o
 
v®no
) const;

284 
	g¡d
::
¡ršg
 
g‘_v®ue_low”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

296 
	g¡d
::
¡ršg
 
g‘_v®ue_uµ”_bound
(
X­Ÿn
::
v®u’o
 
v®no
) const;

302 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth_low”_bound
() const;

305 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth_uµ”_bound
() const;

308 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_wdf_uµ”_bound
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

311 
V®ueI‹¿tÜ
 
v®ue¡»am_begš
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

314 
V®ueI‹¿tÜEnd_
 
v®ue¡»am_’d
(
X­Ÿn
::
v®u’o
) const {

315  
V®ueI‹¿tÜEnd_
();

319 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth
(
X­Ÿn
::
docid
 
did
) const;

325 
k“p_®ive
();

339 
	gX­Ÿn
::
Docum’t
 
g‘_docum’t
(
X­Ÿn
::
docid
 
did
) const;

349 
	g¡d
::
¡ršg
 
g‘_¥–lšg_sugge¡iÚ
(cÚ¡ 
¡d
::¡ršg &
wÜd
,

350 
max_ed™_di¡ªû
 = 2) const;

359 
	gX­Ÿn
::
T”mI‹¿tÜ
 
¥–lšgs_begš
() const;

362 
	gX­Ÿn
::
T”mI‹¿tÜ
 
¥–lšgs_’d
() const {

363  
X­Ÿn
::
T”mI‹¿tÜ
(
NULL
);

370 
	gX­Ÿn
::
T”mI‹¿tÜ
 
synÚyms_begš
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
) const;

373 
	gX­Ÿn
::
T”mI‹¿tÜ
 
synÚyms_’d
(cÚ¡ 
¡d
::
¡ršg
 &) const {

374  
X­Ÿn
::
T”mI‹¿tÜ
(
NULL
);

382 
	gX­Ÿn
::
T”mI‹¿tÜ
 
synÚym_keys_begš
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
 = std::string()) const;

385 
	gX­Ÿn
::
T”mI‹¿tÜ
 
synÚym_keys_’d
(cÚ¡ 
¡d
::
¡ršg
 & = std::string()) const {

386  
X­Ÿn
::
T”mI‹¿tÜ
(
NULL
);

413 
	g¡d
::
¡ršg
 
g‘_m‘ad©a
(cÚ¡ 
¡d
::¡ršg & 
key
) const;

433 
	gX­Ÿn
::
T”mI‹¿tÜ
 
m‘ad©a_keys_begš
(cÚ¡ 
¡d
::
¡ršg
 &
´efix
 = std::string()) const;

436 
	gX­Ÿn
::
T”mI‹¿tÜ
 
m‘ad©a_keys_’d
(cÚ¡ 
¡d
::
¡ršg
 & = std::string()) const {

437  
X­Ÿn
::
T”mI‹¿tÜ
(
NULL
);

454 
	g¡d
::
¡ršg
 
g‘_uuid
() const;

459 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gWr™abËD©aba£
 : 
public
 
D©aba£
 {

460 
public
:

467 
vœtu®
 ~
Wr™abËD©aba£
();

471 
Wr™abËD©aba£
();

495 
Wr™abËD©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
·th
, 
aùiÚ
);

499 
ex¶ic™
 
Wr™abËD©aba£
(
D©aba£
::
IÁ”Çl
 *
š‹º®
);

504 
Wr™abËD©aba£
(cÚ¡ Wr™abËD©aba£ &
Ùh”
);

513 
	gİ”©Ü
=(cÚ¡ 
Wr™abËD©aba£
 &
Ùh”
);

550 
comm™
();

557 
æush
(è{ 
comm™
(); }

597 
begš_Œª§ùiÚ
(
boŞ
 
æushed
=
Œue
);

624 
comm™_Œª§ùiÚ
();

644 
ÿnûl_Œª§ùiÚ
();

674 
	gX­Ÿn
::
docid
 
add_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
);

697 
d–‘e_docum’t
(
X­Ÿn
::
docid
 
did
);

718 
d–‘e_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
unique_‹rm
);

751 
»¶aû_docum’t
(
X­Ÿn
::
docid
 
did
,

752 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
);

792 
	gX­Ÿn
::
docid
 
»¶aû_docum’t
(cÚ¡ 
¡d
::
¡ršg
 & 
unique_‹rm
,

793 cÚ¡ 
X­Ÿn
::
Docum’t
 & 
docum’t
);

802 
add_¥–lšg
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
,

803 
X­Ÿn
::
‹rmcouÁ
 
äeqšc
 = 1) const;

813 
»move_¥–lšg
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
,

814 
X­Ÿn
::
‹rmcouÁ
 
äeqdec
 = 1) const;

821 
add_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
,

822 cÚ¡ 
¡d
::
¡ršg
 & 
synÚym
) const;

828 
»move_synÚym
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
,

829 cÚ¡ 
¡d
::
¡ršg
 & 
synÚym
) const;

835 
ş—r_synÚyms
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const;

881 
£t_m‘ad©a
(cÚ¡ 
¡d
::
¡ršg
 & 
key
, cÚ¡ std::¡ršg & 
v®ue
);

884 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

888 cÚ¡ 
	gDB_CREATE_OR_OPEN
 = 1;

890 cÚ¡ 
	gDB_CREATE
 = 2;

892 cÚ¡ 
	gDB_CREATE_OR_OVERWRITE
 = 3;

894 cÚ¡ 
	gDB_OPEN
 = 4;

	@include/xapian/dbfactory.h

22 #iâdeà
XAPIAN_INCLUDED_DBFACTORY_H


23 
	#XAPIAN_INCLUDED_DBFACTORY_H


	)

25 
	~<¡ršg
>

27 
	~<x­Ÿn/ty³s.h
>

28 
	~<x­Ÿn/v”siÚ.h
>

29 
	~<x­Ÿn/visib™y.h
>

31 
Çme¥aû
 
	gX­Ÿn
 {

33 
şass
 
	gD©aba£
;

34 
şass
 
	gWr™abËD©aba£
;

37 
Çme¥aû
 
	gAuto
 {

46 
XAPIAN_VISIBILITY_DEFAULT


47 
D©aba£
 
İ’_¡ub
(cÚ¡ 
¡d
::
¡ršg
 &
fe
);

56 
XAPIAN_VISIBILITY_DEFAULT


57 
Wr™abËD©aba£
 
İ’_¡ub
(cÚ¡ 
¡d
::
¡ršg
 &
fe
, 
aùiÚ
);

61 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


63 
Çme¥aû
 
	gInMemÜy
 {

70 
XAPIAN_VISIBILITY_DEFAULT


71 
Wr™abËD©aba£
 
İ’
();

76 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


78 
Çme¥aû
 
	gB¿ss
 {

84 
XAPIAN_VISIBILITY_DEFAULT


85 
D©aba£
 
İ’
(cÚ¡ 
¡d
::
¡ršg
 &
dœ
);

105 
XAPIAN_VISIBILITY_DEFAULT


106 
Wr™abËD©aba£


107 
İ’
(cÚ¡ 
¡d
::
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
 = 8192);

112 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


114 
Çme¥aû
 
	gCh”t
 {

120 
XAPIAN_VISIBILITY_DEFAULT


121 
D©aba£
 
İ’
(cÚ¡ 
¡d
::
¡ršg
 &
dœ
);

141 
XAPIAN_VISIBILITY_DEFAULT


142 
Wr™abËD©aba£


143 
İ’
(cÚ¡ 
¡d
::
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
 = 8192);

148 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


150 
Çme¥aû
 
	gFlšt
 {

156 
XAPIAN_VISIBILITY_DEFAULT


157 
D©aba£
 
İ’
(cÚ¡ 
¡d
::
¡ršg
 &
dœ
);

177 
XAPIAN_VISIBILITY_DEFAULT


178 
Wr™abËD©aba£


179 
İ’
(cÚ¡ 
¡d
::
¡ršg
 &
dœ
, 
aùiÚ
, 
block_size
 = 8192);

184 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


186 
Çme¥aû
 
	gRemÙe
 {

207 
XAPIAN_VISIBILITY_DEFAULT


208 
D©aba£
 
İ’
(cÚ¡ 
¡d
::
¡ršg
 &
ho¡
, 
pÜt
, 
X­Ÿn
::
timeout
imeouˆğ10000, X­Ÿn::timeouˆ
cÚÃù_timeout
 = 10000);

228 
XAPIAN_VISIBILITY_DEFAULT


229 
Wr™abËD©aba£
 
İ’_wr™abË
(cÚ¡ 
¡d
::
¡ršg
 &
ho¡
, 
pÜt
, 
X­Ÿn
::
timeout
imeouˆğ0, X­Ÿn::timeouˆ
cÚÃù_timeout
 = 10000);

245 
XAPIAN_VISIBILITY_DEFAULT


246 
D©aba£
 
İ’
(cÚ¡ 
¡d
::
¡ršg
 &
´og¿m
, cÚ¡ std::¡ršg &
¬gs
, 
X­Ÿn
::
timeout
imeout = 10000);

261 
XAPIAN_VISIBILITY_DEFAULT


262 
Wr™abËD©aba£
 
İ’_wr™abË
(cÚ¡ 
¡d
::
¡ršg
 &
´og¿m
, cÚ¡ std::¡ršg &
¬gs
, 
X­Ÿn
::
timeout
imeout = 0);

	@include/xapian/deprecated.h

20 #iâdeà
XAPIAN_INCLUDED_DEPRECATED_H


21 
	#XAPIAN_INCLUDED_DEPRECATED_H


	)

31 #iâdeà
XAPIAN_DEPRECATED


32 #ifdeà
__GNUC__


36 
	#XAPIAN_DEPRECATED
(
D
èD 
	`__©Œibu‹__
((
__d•»ÿ‹d__
))

	)

37 #–ià
defšed
 
_MSC_VER
 && _MSC_VER >= 1300

39 
	#XAPIAN_DEPRECATED
(
D
è
	`__deş¥ec
(
d•»ÿ‹d
è
	)
D

41 
	#XAPIAN_DEPRECATED
(
D
è
	)
D

	@include/xapian/derefwrapper.h

22 #iâdeà
XAPIAN_INCLUDED_DEREFWRAPPER_H


23 
	#XAPIAN_INCLUDED_DEREFWRAPPER_H


	)

25 
Çme¥aû
 
	gX­Ÿn
 {

33 
	g‹m¶©e
<
ty³Çme
 
	gT
>

34 şas 
	cD”efW¿µ”_
 {

36 
	gİ”©Ü
=(cÚ¡ 
D”efW¿µ”_
 &);

39 
T
 
	g»s
;

41 
	gpublic
:

42 
ex¶ic™
 
D”efW¿µ”_
(cÚ¡ 
T
 &
»s_
è: 
»s
(res_) { }

43 cÚ¡ 
T
 & 
İ”©Ü
*(ècÚ¡ {  
»s
; }

	@include/xapian/document.h

25 #iâdeà
XAPIAN_INCLUDED_DOCUMENT_H


26 
	#XAPIAN_INCLUDED_DOCUMENT_H


	)

28 
	~<¡ršg
>

30 
	~<x­Ÿn/ba£.h
>

31 
	~<x­Ÿn/ty³s.h
>

32 
	~<x­Ÿn/‹rm™”©Ü.h
>

33 
	~<x­Ÿn/v®ue™”©Ü.h
>

34 
	~<x­Ÿn/visib™y.h
>

36 
Çme¥aû
 
	gX­Ÿn
 {

56 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gDocum’t
 {

57 
	gpublic
:

58 
şass
 
IÁ”Çl
;

60 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

66 
ex¶ic™
 
Docum’t
(
IÁ”Çl
 *
š‹º®_
);

71 
Docum’t
(cÚ¡ Docum’ˆ&
Ùh”
);

76 
	gİ”©Ü
=(cÚ¡ 
Docum’t
 &
Ùh”
);

79 
Docum’t
();

82 ~
Docum’t
();

91 
	g¡d
::
¡ršg
 
g‘_v®ue
(
X­Ÿn
::
v®u’o
 valueno) const;

99 
add_v®ue
(
X­Ÿn
::
v®u’o
 v®u’o, cÚ¡ 
¡d
::
¡ršg
 &
v®ue
);

102 
»move_v®ue
(
X­Ÿn
::
v®u’o
 valueno);

105 
ş—r_v®ues
();

112 
	g¡d
::
¡ršg
 
g‘_d©a
() const;

115 
£t_d©a
(cÚ¡ 
¡d
::
¡ršg
 &
d©a
);

131 
add_po¡šg
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
,

132 
X­Ÿn
::
‹rmpos
 
os
,

133 
X­Ÿn
::
‹rmcouÁ
 
wdfšc
 = 1);

144 
add_‹rm
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
, 
X­Ÿn
::
‹rmcouÁ
 
wdfšc
 = 1);

162 
add_boŞ—n_‹rm
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
è{ 
add_‹rm
(term, 0); }

183 
»move_po¡šg
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
,

184 
X­Ÿn
::
‹rmpos
 
os
,

185 
X­Ÿn
::
‹rmcouÁ
 
wdfdec
 = 1);

194 
»move_‹rm
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
);

197 
ş—r_‹rms
();

202 
	gX­Ÿn
::
‹rmcouÁ
 
‹rmli¡_couÁ
() const;

205 
T”mI‹¿tÜ
 
‹rmli¡_begš
() const;

208 
T”mI‹¿tÜ
 
‹rmli¡_’d
() const {

209  
T”mI‹¿tÜ
(
NULL
);

213 
	gX­Ÿn
::
‹rmcouÁ
 
v®ues_couÁ
() const;

216 
V®ueI‹¿tÜ
 
v®ues_begš
() const;

219 
V®ueI‹¿tÜEnd_
 
v®ues_’d
() const {

220  
V®ueI‹¿tÜEnd_
();

232 
docid
 
g‘_docid
() const;

241 
	g¡d
::
¡ršg
 
£rŸli£
() const;

245 
Docum’t
 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
);

248 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

	@include/xapian/enquire.h

25 #iâdeà
XAPIAN_INCLUDED_ENQUIRE_H


26 
	#XAPIAN_INCLUDED_ENQUIRE_H


	)

28 
	~<¡ršg
>

30 
	~<x­Ÿn/ba£.h
>

31 
	~<x­Ÿn/d•»ÿ‹d.h
>

32 
	~<x­Ÿn/keymak”.h
>

33 
	~<x­Ÿn/ty³s.h
>

34 
	~<x­Ÿn/‹rm™”©Ü.h
>

35 
	~<x­Ÿn/visib™y.h
>

37 
Çme¥aû
 
	gX­Ÿn
 {

39 
şass
 
	gD©aba£
;

40 
şass
 
	gDocum’t
;

41 
şass
 
	gE¼ÜHªdËr
;

42 
şass
 
	gEx·ndDecid”
;

43 
şass
 
	gM©chSpy
;

44 
şass
 
	gMS‘I‹¿tÜ
;

45 
şass
 
	gQu”y
;

46 
şass
 
	gWeight
;

51 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gMS‘
 {

52 
	gpublic
:

53 
şass
 
IÁ”Çl
;

55 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

58 
ex¶ic™
 
MS‘
(MS‘::
IÁ”Çl
 * 
š‹º®_
);

61 
MS‘
();

64 ~
MS‘
();

67 
MS‘
(cÚ¡ MS‘ & 
Ùh”
);

70 
	gİ”©Ü
=(cÚ¡ 
MS‘
 &
Ùh”
);

87 
ãtch
(cÚ¡ 
MS‘I‹¿tÜ
 &
begš
, cÚ¡ MS‘I‹¿tÜ &
’d
) const;

91 
ãtch
(cÚ¡ 
MS‘I‹¿tÜ
 &
™em
) const;

95 
ãtch
() const;

101 
	gX­Ÿn
::
³rûÁ
 
cÚv”t_to_³rûÁ
(
X­Ÿn
::
weight
 
wt
) const;

104 
	gX­Ÿn
::
³rûÁ
 
cÚv”t_to_³rûÁ
(cÚ¡ 
MS‘I‹¿tÜ
 &
™
) const;

114 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
) const;

123 
	gX­Ÿn
::
weight
 
g‘_‹rmweight
(cÚ¡ 
¡d
::
¡ršg
 &
Šame
) const;

132 
	gX­Ÿn
::
doccouÁ
 
g‘_fœ¡™em
() const;

143 
	gX­Ÿn
::
doccouÁ
 
g‘_m©ches_low”_bound
() const;

157 
	gX­Ÿn
::
doccouÁ
 
g‘_m©ches_e¡im©ed
() const;

168 
	gX­Ÿn
::
doccouÁ
 
g‘_m©ches_uµ”_bound
() const;

173 
	gX­Ÿn
::
doccouÁ
 
g‘_uncŞÏp£d_m©ches_low”_bound
() const;

178 
	gX­Ÿn
::
doccouÁ
 
g‘_uncŞÏp£d_m©ches_e¡im©ed
() const;

183 
	gX­Ÿn
::
doccouÁ
 
g‘_uncŞÏp£d_m©ches_uµ”_bound
() const;

191 
	gX­Ÿn
::
weight
 
g‘_max_possibË
() const;

206 
	gX­Ÿn
::
weight
 
g‘_max_©šed
() const;

209 
	gX­Ÿn
::
doccouÁ
 
size
() const;

212 
	gX­Ÿn
::
doccouÁ
 
max_size
(ècÚ¡ {  
size
(); }

215 
boŞ
 
em±y
() const;

218 
sw­
(
MS‘
 & 
Ùh”
);

221 
MS‘I‹¿tÜ
 
begš
() const;

224 
MS‘I‹¿tÜ
 
’d
() const;

227 
MS‘I‹¿tÜ
 
back
() const;

238 
MS‘I‹¿tÜ
 
	gİ”©Ü
[](
	gX­Ÿn
::
doccouÁ
 
i
) const;

242 
MS‘I‹¿tÜ
 
	tv®ue_ty³
;

243 
MS‘I‹¿tÜ
 
	t™”©Ü
;

244 
MS‘I‹¿tÜ
 
	tcÚ¡_™”©Ü
;

245 
	gMS‘I‹¿tÜ
 & 
	t»ã»nû
;

246 
	gMS‘I‹¿tÜ
 & 
	tcÚ¡_»ã»nû
;

247 
MS‘I‹¿tÜ
 * 
	tpoš‹r
;

248 
	gX­Ÿn
::
	tdoccouÁ_diff
 
	tdifã»nû_ty³
;

249 
	gX­Ÿn
::
	tdoccouÁ
 
	tsize_ty³
;

253 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

259 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gMS‘I‹¿tÜ
 {

260 
	g´iv©e
:

261 
ä›nd
 
şass
 
MS‘
;

262 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
MS‘I‹¿tÜ
 &
a
, cÚ¡ 
	gMS‘I‹¿tÜ
 &
	gb
);

263 
ä›nd
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
MS‘I‹¿tÜ
 &
a
, cÚ¡ 
	gMS‘I‹¿tÜ
 &
	gb
);

265 
MS‘I‹¿tÜ
(
X­Ÿn
::
doccouÁ
 
šdex_
, cÚ¡ 
MS‘
 & 
m£t_
)

266 : 
šdex
(
šdex_
), 
m£t
(
m£t_
) { }

268 
	gX­Ÿn
::
doccouÁ
 
šdex
;

269 
MS‘
 
	gm£t
;

271 
	gpublic
:

275 
MS‘I‹¿tÜ
(è: 
šdex
(0), 
m£t
() { }

278 
MS‘I‹¿tÜ
(cÚ¡ MS‘I‹¿tÜ &
Ùh”
) {

279 
	gšdex
 = 
Ùh”
.
šdex
;

280 
	gm£t
 = 
Ùh”
.
m£t
;

284 
	gİ”©Ü
=(cÚ¡ 
MS‘I‹¿tÜ
 &
Ùh”
) {

285 
šdex
 = 
Ùh”
.index;

286 
	gm£t
 = 
Ùh”
.
m£t
;

290 
	gMS‘I‹¿tÜ
 & 
	gİ”©Ü
++() {

291 ++
	gšdex
;

292  *
	gthis
;

296 
MS‘I‹¿tÜ
 
	gİ”©Ü
++() {

297 
MS‘I‹¿tÜ
 
	gtmp
 = *
this
;

298 ++
	gšdex
;

299  
	gtmp
;

303 
	gMS‘I‹¿tÜ
 & 
	gİ”©Ü
--() {

304 --
	gšdex
;

305  *
	gthis
;

309 
MS‘I‹¿tÜ
 
	gİ”©Ü
--() {

310 
MS‘I‹¿tÜ
 
	gtmp
 = *
this
;

311 --
	gšdex
;

312  
	gtmp
;

316 
	gX­Ÿn
::
docid
 
İ”©Ü
*() const;

334 
	gX­Ÿn
::
Docum’t
 
g‘_docum’t
() const;

342 
	gX­Ÿn
::
doccouÁ
 
g‘_¿nk
() const {

343  
m£t
.
g‘_fœ¡™em
(è+ 
šdex
;

347 
	gX­Ÿn
::
weight
 
g‘_weight
() const;

351 
	g¡d
::
¡ršg
 
g‘_cŞÏp£_key
() const;

369 
	gX­Ÿn
::
doccouÁ
 
g‘_cŞÏp£_couÁ
() const;

386 
	gX­Ÿn
::
³rûÁ
 
g‘_³rûÁ
() const;

389 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

393 
	g¡d
::
	tbidœeùiÚ®_™”©Ü_g
 
	t™”©Ü_ÿ‹gÜy
;

394 
	gX­Ÿn
::
	tdocid
 
	tv®ue_ty³
;

395 
	gX­Ÿn
::
	tdoccouÁ_diff
 
	tdifã»nû_ty³
;

396 
	gX­Ÿn
::
	tdocid
 * 
	tpoš‹r
;

397 
	gX­Ÿn
::
	tdocid
 & 
	t»ã»nû
;

402 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
MS‘I‹¿tÜ
 &
a
, cÚ¡ 
	gMS‘I‹¿tÜ
 &
	gb
)

404  (
	ga
.
	gšdex
 =ğ
b
.
šdex
);

408 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
MS‘I‹¿tÜ
 &
a
, cÚ¡ 
	gMS‘I‹¿tÜ
 &
	gb
)

410  (
	ga
.
	gšdex
 !ğ
b
.
šdex
);

413 
şass
 
	gES‘I‹¿tÜ
;

419 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gES‘
 {

420 
	gpublic
:

421 
şass
 
IÁ”Çl
;

423 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

426 
ES‘
();

429 ~
ES‘
();

432 
ES‘
(cÚ¡ ES‘ & 
Ùh”
);

435 
	gİ”©Ü
=(cÚ¡ 
ES‘
 &
Ùh”
);

441 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_ebound
() const;

444 
	gX­Ÿn
::
‹rmcouÁ
 
size
() const;

447 
	gX­Ÿn
::
‹rmcouÁ
 
max_size
(ècÚ¡ {  
size
(); }

450 
boŞ
 
em±y
() const;

453 
sw­
(
ES‘
 & 
Ùh”
);

456 
ES‘I‹¿tÜ
 
begš
() const;

459 
ES‘I‹¿tÜ
 
’d
() const;

462 
ES‘I‹¿tÜ
 
back
() const;

465 
ES‘I‹¿tÜ
 
	gİ”©Ü
[](
	gX­Ÿn
::
‹rmcouÁ
 
i
) const;

468 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

472 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gES‘I‹¿tÜ
 {

473 
	g´iv©e
:

474 
ä›nd
 
şass
 
ES‘
;

475 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
ES‘I‹¿tÜ
 &
a
, cÚ¡ 
	gES‘I‹¿tÜ
 &
	gb
);

476 
ä›nd
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
ES‘I‹¿tÜ
 &
a
, cÚ¡ 
	gES‘I‹¿tÜ
 &
	gb
);

478 
ES‘I‹¿tÜ
(
X­Ÿn
::
‹rmcouÁ
 
šdex_
, cÚ¡ 
ES‘
 & 
e£t_
)

479 : 
šdex
(
šdex_
), 
e£t
(
e£t_
) { }

481 
	gX­Ÿn
::
‹rmcouÁ
 
šdex
;

482 
ES‘
 
	ge£t
;

484 
	gpublic
:

488 
ES‘I‹¿tÜ
(è: 
šdex
(0), 
e£t
() { }

491 
ES‘I‹¿tÜ
(cÚ¡ ES‘I‹¿tÜ &
Ùh”
) {

492 
	gšdex
 = 
Ùh”
.
šdex
;

493 
	ge£t
 = 
Ùh”
.
e£t
;

497 
	gİ”©Ü
=(cÚ¡ 
ES‘I‹¿tÜ
 &
Ùh”
) {

498 
šdex
 = 
Ùh”
.index;

499 
	ge£t
 = 
Ùh”
.
e£t
;

503 
	gES‘I‹¿tÜ
 & 
	gİ”©Ü
++() {

504 ++
	gšdex
;

505  *
	gthis
;

509 
ES‘I‹¿tÜ
 
	gİ”©Ü
++() {

510 
ES‘I‹¿tÜ
 
	gtmp
 = *
this
;

511 ++
	gšdex
;

512  
	gtmp
;

516 
	gES‘I‹¿tÜ
 & 
	gİ”©Ü
--() {

517 --
	gšdex
;

518  *
	gthis
;

522 
ES‘I‹¿tÜ
 
	gİ”©Ü
--() {

523 
ES‘I‹¿tÜ
 
	gtmp
 = *
this
;

524 --
	gšdex
;

525  
	gtmp
;

529 cÚ¡ 
	g¡d
::
¡ršg
 & 
İ”©Ü
 *() const;

532 
	gX­Ÿn
::
weight
 
g‘_weight
() const;

535 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

539 
	g¡d
::
	tbidœeùiÚ®_™”©Ü_g
 
	t™”©Ü_ÿ‹gÜy
;

540 
	g¡d
::
	t¡ršg
 
	tv®ue_ty³
;

541 
	gX­Ÿn
::
	t‹rmcouÁ_diff
 
	tdifã»nû_ty³
;

542 
	g¡d
::
	t¡ršg
 * 
	tpoš‹r
;

543 
	g¡d
::
	t¡ršg
 & 
	t»ã»nû
;

548 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
ES‘I‹¿tÜ
 &
a
, cÚ¡ 
	gES‘I‹¿tÜ
 &
	gb
)

550  (
	ga
.
	gšdex
 =ğ
b
.
šdex
);

554 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
ES‘I‹¿tÜ
 &
a
, cÚ¡ 
	gES‘I‹¿tÜ
 &
	gb
)

556  (
	ga
.
	gšdex
 !ğ
b
.
šdex
);

563 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gRS‘
 {

564 
	gpublic
:

566 
şass
 
IÁ”Çl
;

569 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

572 
RS‘
(cÚ¡ RS‘ &
r£t
);

575 
	gİ”©Ü
=(cÚ¡ 
RS‘
 &
r£t
);

578 
RS‘
();

581 ~
RS‘
();

584 
	gX­Ÿn
::
doccouÁ
 
size
() const;

587 
boŞ
 
em±y
() const;

590 
add_docum’t
(
X­Ÿn
::
docid
 
did
);

593 
add_docum’t
(cÚ¡ 
X­Ÿn
::
MS‘I‹¿tÜ
 & 
i
) {‡dd_document(*i); }

596 
»move_docum’t
(
X­Ÿn
::
docid
 
did
);

599 
»move_docum’t
(cÚ¡ 
X­Ÿn
::
MS‘I‹¿tÜ
 & 
i
) {„emove_document(*i); }

602 
boŞ
 
cÚšs
(
X­Ÿn
::
docid
 
did
) const;

605 
boŞ
 
cÚšs
(cÚ¡ 
X­Ÿn
::
MS‘I‹¿tÜ
 & 
i
) const {  contains(*i); }

608 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

613 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gM©chDecid”
 {

614 
	gpublic
:

620 
vœtu®
 
boŞ
 
İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
) const = 0;

623 
	gvœtu®
 ~
M©chDecid”
();

636 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gEnquœe
 {

637 
	gpublic
:

639 
Enquœe
(cÚ¡ Enquœ& 
Ùh”
);

642 
	gİ”©Ü
=(cÚ¡ 
Enquœe
 & 
Ùh”
);

644 
şass
 
	gIÁ”Çl
;

646 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

672 
ex¶ic™
 
Enquœe
(cÚ¡ 
D©aba£
 &
d©aba£
, 
E¼ÜHªdËr
 * 
”rÜhªdËr_
 = 0);

676 ~
Enquœe
();

684 
£t_qu”y
(cÚ¡ 
X­Ÿn
::
Qu”y
 & 
qu”y
, X­Ÿn::
‹rmcouÁ
 
qËn
 = 0);

692 cÚ¡ 
	gX­Ÿn
::
Qu”y
 & 
g‘_qu”y
() const;

714 
add_m©ch¥y
(
M©chSpy
 * 
¥y
);

718 
ş—r_m©ch¥›s
();

726 
£t_weightšg_scheme
(cÚ¡ 
Weight
 &
weight_
);

759 
£t_cŞÏp£_key
(
X­Ÿn
::
v®u’o
 
cŞÏp£_key
,

760 
X­Ÿn
::
doccouÁ
 
cŞÏp£_max
 = 1);

763 
	gASCENDING
 = 1,

764 
	gDESCENDING
 = 0,

765 
	gDONT_CARE
 = 2

766 } 
	tdocid_Üd”
;

791 
£t_docid_Üd”
(
docid_Üd”
 
Üd”
);

811 
£t_cutoff
(
X­Ÿn
::
³rûÁ
 
³rûÁ_cutoff
, X­Ÿn::
weight
 
weight_cutoff
 = 0);

817 
£t_sÜt_by_»Ëvªû
();

832 
£t_sÜt_by_v®ue
(
X­Ÿn
::
v®u’o
 
sÜt_key
, 
boŞ
 
»v”£
);

834 
XAPIAN_DEPRECATED
(
£t_sÜt_by_v®ue
(
X­Ÿn
::
v®u’o
 
sÜt_key
));

842 
£t_sÜt_by_key
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
, 
boŞ
 
»v”£
);

844 
XAPIAN_DEPRECATED
(
£t_sÜt_by_key
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
));

860 
£t_sÜt_by_v®ue_th’_»Ëvªû
(
X­Ÿn
::
v®u’o
 
sÜt_key
,

861 
boŞ
 
»v”£
);

863 
XAPIAN_DEPRECATED
(
£t_sÜt_by_v®ue_th’_»Ëvªû
(
X­Ÿn
::
v®u’o
 
sÜt_key
));

872 
£t_sÜt_by_key_th’_»Ëvªû
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
,

873 
boŞ
 
»v”£
);

875 
XAPIAN_DEPRECATED
(
£t_sÜt_by_key_th’_»Ëvªû
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
));

897 
£t_sÜt_by_»Ëvªû_th’_v®ue
(
X­Ÿn
::
v®u’o
 
sÜt_key
,

898 
boŞ
 
»v”£
);

900 
XAPIAN_DEPRECATED
(
£t_sÜt_by_»Ëvªû_th’_v®ue
(
X­Ÿn
::
v®u’o
 
sÜt_key
));

916 
£t_sÜt_by_»Ëvªû_th’_key
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
,

917 
boŞ
 
»v”£
);

919 
XAPIAN_DEPRECATED
(
£t_sÜt_by_»Ëvªû_th’_key
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
));

969 
MS‘
 
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
max™ems
,

970 
X­Ÿn
::
doccouÁ
 
check©Ëa¡
 = 0,

971 cÚ¡ 
RS‘
 * 
omr£t
 = 0,

972 cÚ¡ 
M©chDecid”
 * 
mdecid”
 = 0) const;

973 
XAPIAN_DEPRECATED
(

974 
MS‘
 
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
max™ems
,

975 
X­Ÿn
::
doccouÁ
 
check©Ëa¡
,

976 cÚ¡ 
RS‘
 * 
omr£t
,

977 cÚ¡ 
M©chDecid”
 * 
mdecid”
,

978 cÚ¡ 
M©chDecid”
 * 
m©ch¥y
) const);

979 
MS‘
 
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
max™ems
,

980 cÚ¡ 
RS‘
 * 
omr£t
,

981 cÚ¡ 
M©chDecid”
 * 
mdecid”
 = 0) const {

982  
g‘_m£t
(
fœ¡
, 
max™ems
, 0, 
omr£t
, 
mdecid”
);

985 cÚ¡ 
	gINCLUDE_QUERY_TERMS
 = 1;

986 cÚ¡ 
	gUSE_EXACT_TERMFREQ
 = 2;

1010 
ES‘
 
g‘_e£t
(
X­Ÿn
::
‹rmcouÁ
 
max™ems
,

1011 cÚ¡ 
RS‘
 & 
omr£t
,

1012 
æags
 = 0,

1013 
k
 = 1.0,

1014 cÚ¡ 
X­Ÿn
::
Ex·ndDecid”
 * 
edecid”
 = 0) const;

1029 
šlše
 
ES‘
 
g‘_e£t
(
X­Ÿn
::
‹rmcouÁ
 
max™ems
, cÚ¡ 
RS‘
 & 
omr£t
,

1030 cÚ¡ 
X­Ÿn
::
Ex·ndDecid”
 * 
edecid”
) const {

1031  
g‘_e£t
(
max™ems
, 
omr£t
, 0, 1.0, 
edecid”
);

1062 
T”mI‹¿tÜ
 
g‘_m©chšg_‹rms_begš
(
X­Ÿn
::
docid
 
did
) const;

1065 
T”mI‹¿tÜ
 
g‘_m©chšg_‹rms_’d
(
X­Ÿn
::
docid
 ) const {

1066  
T”mI‹¿tÜ
(
NULL
);

1091 
T”mI‹¿tÜ
 
g‘_m©chšg_‹rms_begš
(cÚ¡ 
MS‘I‹¿tÜ
 &
™
) const;

1094 
T”mI‹¿tÜ
 
g‘_m©chšg_‹rms_’d
(cÚ¡ 
MS‘I‹¿tÜ
 & ) const {

1095  
T”mI‹¿tÜ
(
NULL
);

1099 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

1104 
šlše
 

1105 
	gEnquœe
::
£t_sÜt_by_v®ue
(
X­Ÿn
::
v®u’o
 
sÜt_key
)

1107  
£t_sÜt_by_v®ue
(
sÜt_key
, 
Œue
);

1110 
šlše
 

1111 
	gEnquœe
::
£t_sÜt_by_key
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
)

1113  
£t_sÜt_by_key
(
sÜ‹r
, 
Œue
);

1116 
šlše
 

1117 
	gEnquœe
::
£t_sÜt_by_v®ue_th’_»Ëvªû
(
X­Ÿn
::
v®u’o
 
sÜt_key
)

1119  
£t_sÜt_by_v®ue_th’_»Ëvªû
(
sÜt_key
, 
Œue
);

1122 
šlše
 

1123 
	gEnquœe
::
£t_sÜt_by_key_th’_»Ëvªû
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
)

1125  
£t_sÜt_by_key_th’_»Ëvªû
(
sÜ‹r
, 
Œue
);

1128 
šlše
 

1129 
	gEnquœe
::
£t_sÜt_by_»Ëvªû_th’_v®ue
(
X­Ÿn
::
v®u’o
 
sÜt_key
)

1131  
£t_sÜt_by_»Ëvªû_th’_v®ue
(
sÜt_key
, 
Œue
);

1134 
šlše
 

1135 
	gEnquœe
::
£t_sÜt_by_»Ëvªû_th’_key
(
X­Ÿn
::
KeyMak”
 * 
sÜ‹r
)

1137  
£t_sÜt_by_»Ëvªû_th’_key
(
sÜ‹r
, 
Œue
);

	@include/xapian/error.h

22 #iâdeà
XAPIAN_INCLUDED_ERROR_H


23 
	#XAPIAN_INCLUDED_ERROR_H


	)

25 
	~<¡ršg
>

26 
	~<x­Ÿn/visib™y.h
>

28 
Çme¥aû
 
	gX­Ÿn
 {

30 
şass
 
	gE¼ÜHªdËr
;

37 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gE¼Ü
 {

39 
ä›nd
 
şass
 
	gE¼ÜHªdËr
;

42 
	g¡d
::
¡ršg
 
msg
;

51 
	g¡d
::
¡ršg
 
cÚ‹xt
;

54 cÚ¡ * 
	gty³
;

69 
	gmy_”ºo
;

75 
mubË
 
	g¡d
::
¡ršg
 
”rÜ_¡ršg
;

78 
boŞ
 
	g®»ady_hªdËd
;

81 
	gİ”©Ü
=(cÚ¡ 
E¼Ü
 &
o
);

83 
	g´Ùeùed
:

87 
E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
,

88 cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
);

93 
E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
,

94 cÚ¡ * 
ty³_
, 
”ºo_
)

95 : 
msg
(
msg_
), 
cÚ‹xt
(
cÚ‹xt_
), 
ty³
(
ty³_
), 
my_”ºo
(
”ºo_
),

96 
”rÜ_¡ršg
(), 
®»ady_hªdËd
(
çl£
) { }

98 
	gpublic
:

100 cÚ¡ * 
g‘_ty³
(ècÚ¡ {  
ty³
; }

103 cÚ¡ 
	g¡d
::
¡ršg
 & 
g‘_msg
(ècÚ¡ {  
msg
; }

112 cÚ¡ 
	g¡d
::
¡ršg
 & 
g‘_cÚ‹xt
(ècÚ¡ {  
cÚ‹xt
; }

120 cÚ¡ * 
g‘_”rÜ_¡ršg
() const;

123 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

131 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gLogicE¼Ü
 : 
public
 
E¼Ü
 {

132 
´Ùeùed
:

136 
LogicE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

137 : 
E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

142 
LogicE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

143 : 
E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

153 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gRuÁimeE¼Ü
 : 
public
 
E¼Ü
 {

154 
´Ùeùed
:

158 
RuÁimeE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

159 : 
E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

164 
RuÁimeE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

165 : 
E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

176 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gAs£¹iÚE¼Ü
 : 
public
 
LogicE¼Ü
 {

177 
public
:

183 
As£¹iÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

184 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, "As£¹iÚE¼Ü", 
”rÜ_¡ršg_
) {}

186 
ex¶ic™
 
As£¹iÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

187 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, "As£¹iÚE¼Ü", 
”ºo_
) {}

189 
As£¹iÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

190 : 
LogicE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "As£¹iÚE¼Ü", 
”ºo_
) {}

191 
	g´Ùeùed
:

195 
As£¹iÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

196 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

201 
As£¹iÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

202 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

207 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gInv®idArgum’tE¼Ü
 : 
public
 
LogicE¼Ü
 {

208 
public
:

214 
Inv®idArgum’tE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

215 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, "Inv®idArgum’tE¼Ü", 
”rÜ_¡ršg_
) {}

217 
ex¶ic™
 
Inv®idArgum’tE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

218 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, "Inv®idArgum’tE¼Ü", 
”ºo_
) {}

220 
Inv®idArgum’tE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

221 : 
LogicE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "Inv®idArgum’tE¼Ü", 
”ºo_
) {}

222 
	g´Ùeùed
:

226 
Inv®idArgum’tE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

227 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

232 
Inv®idArgum’tE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

233 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

238 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gInv®idO³¿tiÚE¼Ü
 : 
public
 
LogicE¼Ü
 {

239 
public
:

245 
Inv®idO³¿tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

246 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, "Inv®idO³¿tiÚE¼Ü", 
”rÜ_¡ršg_
) {}

248 
ex¶ic™
 
Inv®idO³¿tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

249 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, "Inv®idO³¿tiÚE¼Ü", 
”ºo_
) {}

251 
Inv®idO³¿tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

252 : 
LogicE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "Inv®idO³¿tiÚE¼Ü", 
”ºo_
) {}

253 
	g´Ùeùed
:

257 
Inv®idO³¿tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

258 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

263 
Inv®idO³¿tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

264 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

268 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gUnim¶em’‹dE¼Ü
 : 
public
 
LogicE¼Ü
 {

269 
public
:

275 
Unim¶em’‹dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

276 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, "Unim¶em’‹dE¼Ü", 
”rÜ_¡ršg_
) {}

278 
ex¶ic™
 
Unim¶em’‹dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

279 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, "Unim¶em’‹dE¼Ü", 
”ºo_
) {}

281 
Unim¶em’‹dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

282 : 
LogicE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "Unim¶em’‹dE¼Ü", 
”ºo_
) {}

283 
	g´Ùeùed
:

287 
Unim¶em’‹dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

288 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

293 
Unim¶em’‹dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

294 : 
LogicE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

298 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£E¼Ü
 : 
public
 
RuÁimeE¼Ü
 {

299 
public
:

305 
D©aba£E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

306 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£E¼Ü", 
”rÜ_¡ršg_
) {}

308 
ex¶ic™
 
D©aba£E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

309 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£E¼Ü", 
”ºo_
) {}

311 
D©aba£E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

312 : 
RuÁimeE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "D©aba£E¼Ü", 
”ºo_
) {}

313 
	g´Ùeùed
:

317 
D©aba£E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

318 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

323 
D©aba£E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

324 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

328 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£CÜru±E¼Ü
 : 
public
 
D©aba£E¼Ü
 {

329 
public
:

335 
D©aba£CÜru±E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

336 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£CÜru±E¼Ü", 
”rÜ_¡ršg_
) {}

338 
ex¶ic™
 
D©aba£CÜru±E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

339 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£CÜru±E¼Ü", 
”ºo_
) {}

341 
D©aba£CÜru±E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

342 : 
D©aba£E¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "D©aba£CÜru±E¼Ü", 
”ºo_
) {}

343 
	g´Ùeùed
:

347 
D©aba£CÜru±E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

348 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

353 
D©aba£CÜru±E¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

354 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

358 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£C»©eE¼Ü
 : 
public
 
D©aba£E¼Ü
 {

359 
public
:

365 
D©aba£C»©eE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

366 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£C»©eE¼Ü", 
”rÜ_¡ršg_
) {}

368 
ex¶ic™
 
D©aba£C»©eE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

369 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£C»©eE¼Ü", 
”ºo_
) {}

371 
D©aba£C»©eE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

372 : 
D©aba£E¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "D©aba£C»©eE¼Ü", 
”ºo_
) {}

373 
	g´Ùeùed
:

377 
D©aba£C»©eE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

378 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

383 
D©aba£C»©eE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

384 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

388 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£LockE¼Ü
 : 
public
 
D©aba£E¼Ü
 {

389 
public
:

395 
D©aba£LockE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

396 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£LockE¼Ü", 
”rÜ_¡ršg_
) {}

398 
ex¶ic™
 
D©aba£LockE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

399 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£LockE¼Ü", 
”ºo_
) {}

401 
D©aba£LockE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

402 : 
D©aba£E¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "D©aba£LockE¼Ü", 
”ºo_
) {}

403 
	g´Ùeùed
:

407 
D©aba£LockE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

408 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

413 
D©aba£LockE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

414 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

423 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£Modif›dE¼Ü
 : 
public
 
D©aba£E¼Ü
 {

424 
public
:

430 
D©aba£Modif›dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

431 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£Modif›dE¼Ü", 
”rÜ_¡ršg_
) {}

433 
ex¶ic™
 
D©aba£Modif›dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

434 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£Modif›dE¼Ü", 
”ºo_
) {}

436 
D©aba£Modif›dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

437 : 
D©aba£E¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "D©aba£Modif›dE¼Ü", 
”ºo_
) {}

438 
	g´Ùeùed
:

442 
D©aba£Modif›dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

443 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

448 
D©aba£Modif›dE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

449 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

453 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£O³nšgE¼Ü
 : 
public
 
D©aba£E¼Ü
 {

454 
public
:

460 
D©aba£O³nšgE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

461 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£O³nšgE¼Ü", 
”rÜ_¡ršg_
) {}

463 
ex¶ic™
 
D©aba£O³nšgE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

464 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£O³nšgE¼Ü", 
”ºo_
) {}

466 
D©aba£O³nšgE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

467 : 
D©aba£E¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "D©aba£O³nšgE¼Ü", 
”ºo_
) {}

468 
	g´Ùeùed
:

472 
D©aba£O³nšgE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

473 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

478 
D©aba£O³nšgE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

479 : 
D©aba£E¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

493 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©aba£V”siÚE¼Ü
 : 
public
 
D©aba£O³nšgE¼Ü
 {

494 
public
:

500 
D©aba£V”siÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

501 : 
D©aba£O³nšgE¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£V”siÚE¼Ü", 
”rÜ_¡ršg_
) {}

503 
ex¶ic™
 
D©aba£V”siÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

504 : 
D©aba£O³nšgE¼Ü
(
msg_
, 
cÚ‹xt_
, "D©aba£V”siÚE¼Ü", 
”ºo_
) {}

506 
D©aba£V”siÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

507 : 
D©aba£O³nšgE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "D©aba£V”siÚE¼Ü", 
”ºo_
) {}

508 
	g´Ùeùed
:

512 
D©aba£V”siÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

513 : 
D©aba£O³nšgE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

518 
D©aba£V”siÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

519 : 
D©aba£O³nšgE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

523 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gDocNÙFoundE¼Ü
 : 
public
 
RuÁimeE¼Ü
 {

524 
public
:

530 
DocNÙFoundE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

531 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "DocNÙFoundE¼Ü", 
”rÜ_¡ršg_
) {}

533 
ex¶ic™
 
DocNÙFoundE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

534 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "DocNÙFoundE¼Ü", 
”ºo_
) {}

536 
DocNÙFoundE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

537 : 
RuÁimeE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "DocNÙFoundE¼Ü", 
”ºo_
) {}

538 
	g´Ùeùed
:

542 
DocNÙFoundE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

543 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

548 
DocNÙFoundE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

549 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

557 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gF—tu»UÇvaabËE¼Ü
 : 
public
 
RuÁimeE¼Ü
 {

558 
public
:

564 
F—tu»UÇvaabËE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

565 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "F—tu»UÇvaabËE¼Ü", 
”rÜ_¡ršg_
) {}

567 
ex¶ic™
 
F—tu»UÇvaabËE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

568 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "F—tu»UÇvaabËE¼Ü", 
”ºo_
) {}

570 
F—tu»UÇvaabËE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

571 : 
RuÁimeE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "F—tu»UÇvaabËE¼Ü", 
”ºo_
) {}

572 
	g´Ùeùed
:

576 
F—tu»UÇvaabËE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

577 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

582 
F—tu»UÇvaabËE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

583 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

587 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gIÁ”ÇlE¼Ü
 : 
public
 
RuÁimeE¼Ü
 {

588 
public
:

594 
IÁ”ÇlE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

595 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "IÁ”ÇlE¼Ü", 
”rÜ_¡ršg_
) {}

597 
ex¶ic™
 
IÁ”ÇlE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

598 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "IÁ”ÇlE¼Ü", 
”ºo_
) {}

600 
IÁ”ÇlE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

601 : 
RuÁimeE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "IÁ”ÇlE¼Ü", 
”ºo_
) {}

602 
	g´Ùeùed
:

606 
IÁ”ÇlE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

607 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

612 
IÁ”ÇlE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

613 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

617 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gN‘wÜkE¼Ü
 : 
public
 
RuÁimeE¼Ü
 {

618 
public
:

624 
N‘wÜkE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

625 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "N‘wÜkE¼Ü", 
”rÜ_¡ršg_
) {}

627 
ex¶ic™
 
N‘wÜkE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

628 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "N‘wÜkE¼Ü", 
”ºo_
) {}

630 
N‘wÜkE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

631 : 
RuÁimeE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "N‘wÜkE¼Ü", 
”ºo_
) {}

632 
	g´Ùeùed
:

636 
N‘wÜkE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

637 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

642 
N‘wÜkE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

643 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

647 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gN‘wÜkTimeoutE¼Ü
 : 
public
 
N‘wÜkE¼Ü
 {

648 
public
:

654 
N‘wÜkTimeoutE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

655 : 
N‘wÜkE¼Ü
(
msg_
, 
cÚ‹xt_
, "N‘wÜkTimeoutE¼Ü", 
”rÜ_¡ršg_
) {}

657 
ex¶ic™
 
N‘wÜkTimeoutE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

658 : 
N‘wÜkE¼Ü
(
msg_
, 
cÚ‹xt_
, "N‘wÜkTimeoutE¼Ü", 
”ºo_
) {}

660 
N‘wÜkTimeoutE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

661 : 
N‘wÜkE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "N‘wÜkTimeoutE¼Ü", 
”ºo_
) {}

662 
	g´Ùeùed
:

666 
N‘wÜkTimeoutE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

667 : 
N‘wÜkE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

672 
N‘wÜkTimeoutE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

673 : 
N‘wÜkE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

677 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gQu”yP¬£rE¼Ü
 : 
public
 
RuÁimeE¼Ü
 {

678 
public
:

684 
Qu”yP¬£rE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

685 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "Qu”yP¬£rE¼Ü", 
”rÜ_¡ršg_
) {}

687 
ex¶ic™
 
Qu”yP¬£rE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

688 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "Qu”yP¬£rE¼Ü", 
”ºo_
) {}

690 
Qu”yP¬£rE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

691 : 
RuÁimeE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "Qu”yP¬£rE¼Ü", 
”ºo_
) {}

692 
	g´Ùeùed
:

696 
Qu”yP¬£rE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

697 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

702 
Qu”yP¬£rE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

703 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

707 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gS”Ÿli§tiÚE¼Ü
 : 
public
 
RuÁimeE¼Ü
 {

708 
public
:

714 
S”Ÿli§tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

715 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "S”Ÿli§tiÚE¼Ü", 
”rÜ_¡ršg_
) {}

717 
ex¶ic™
 
S”Ÿli§tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

718 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "S”Ÿli§tiÚE¼Ü", 
”ºo_
) {}

720 
S”Ÿli§tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

721 : 
RuÁimeE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "S”Ÿli§tiÚE¼Ü", 
”ºo_
) {}

722 
	g´Ùeùed
:

726 
S”Ÿli§tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

727 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

732 
S”Ÿli§tiÚE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

733 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

738 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gRªgeE¼Ü
 : 
public
 
RuÁimeE¼Ü
 {

739 
public
:

745 
RªgeE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
”rÜ_¡ršg_
)

746 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "RªgeE¼Ü", 
”rÜ_¡ršg_
) {}

748 
ex¶ic™
 
RªgeE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
 = std::¡ršg(), 
”ºo_
 = 0)

749 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, "RªgeE¼Ü", 
”ºo_
) {}

751 
RªgeE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, 
”ºo_
)

752 : 
RuÁimeE¼Ü
(
msg_
, 
¡d
::
¡ršg
(), "RªgeE¼Ü", 
”ºo_
) {}

753 
	g´Ùeùed
:

757 
RªgeE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, cÚ¡ * 
”rÜ_¡ršg_
)

758 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”rÜ_¡ršg_
) {}

763 
RªgeE¼Ü
(cÚ¡ 
¡d
::
¡ršg
 &
msg_
, cÚ¡ std::¡ršg &
cÚ‹xt_
, cÚ¡ * 
ty³_
, 
”ºo_
)

764 : 
RuÁimeE¼Ü
(
msg_
, 
cÚ‹xt_
, 
ty³_
, 
”ºo_
) {}

	@include/xapian/errordispatch.h

25 #iâdeà
DOXYGEN


26 ià(
	gty³
 =ğ"As£¹iÚE¼Ü"è
throw
 
X­Ÿn
::
As£¹iÚE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

27 ià(
	gty³
 =ğ"Inv®idArgum’tE¼Ü"è
throw
 
X­Ÿn
::
Inv®idArgum’tE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

28 ià(
	gty³
 =ğ"Inv®idO³¿tiÚE¼Ü"è
throw
 
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

29 ià(
	gty³
 =ğ"Unim¶em’‹dE¼Ü"è
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

30 ià(
	gty³
 =ğ"D©aba£E¼Ü"è
throw
 
X­Ÿn
::
D©aba£E¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

31 ià(
	gty³
 =ğ"D©aba£CÜru±E¼Ü"è
throw
 
X­Ÿn
::
D©aba£CÜru±E¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

32 ià(
	gty³
 =ğ"D©aba£C»©eE¼Ü"è
throw
 
X­Ÿn
::
D©aba£C»©eE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

33 ià(
	gty³
 =ğ"D©aba£LockE¼Ü"è
throw
 
X­Ÿn
::
D©aba£LockE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

34 ià(
	gty³
 =ğ"D©aba£Modif›dE¼Ü"è
throw
 
X­Ÿn
::
D©aba£Modif›dE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

35 ià(
	gty³
 =ğ"D©aba£O³nšgE¼Ü"è
throw
 
X­Ÿn
::
D©aba£O³nšgE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

36 ià(
	gty³
 =ğ"D©aba£V”siÚE¼Ü"è
throw
 
X­Ÿn
::
D©aba£V”siÚE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

37 ià(
	gty³
 =ğ"DocNÙFoundE¼Ü"è
throw
 
X­Ÿn
::
DocNÙFoundE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

38 ià(
	gty³
 =ğ"F—tu»UÇvaabËE¼Ü"è
throw
 
X­Ÿn
::
F—tu»UÇvaabËE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

39 ià(
	gty³
 =ğ"IÁ”ÇlE¼Ü"è
throw
 
X­Ÿn
::
IÁ”ÇlE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

40 ià(
	gty³
 =ğ"N‘wÜkE¼Ü"è
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

41 ià(
	gty³
 =ğ"N‘wÜkTimeoutE¼Ü"è
throw
 
X­Ÿn
::
N‘wÜkTimeoutE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

42 ià(
	gty³
 =ğ"Qu”yP¬£rE¼Ü"è
throw
 
X­Ÿn
::
Qu”yP¬£rE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

43 ià(
	gty³
 =ğ"S”Ÿli§tiÚE¼Ü"è
throw
 
X­Ÿn
::
S”Ÿli§tiÚE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

44 ià(
	gty³
 =ğ"RªgeE¼Ü"è
throw
 
X­Ÿn
::
RªgeE¼Ü
(
msg
, 
cÚ‹xt
, 
”rÜ_¡ršg
);

	@include/xapian/errorhandler.h

21 #iâdeà
XAPIAN_INCLUDED_ERRORHANDLER_H


22 
	#XAPIAN_INCLUDED_ERRORHANDLER_H


	)

24 
	~<x­Ÿn/visib™y.h
>

26 
Çme¥aû
 
	gX­Ÿn
 {

28 
şass
 
	gE¼Ü
;

43 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gE¼ÜHªdËr
 {

45 
	gİ”©Ü
=(cÚ¡ 
E¼ÜHªdËr
 &);

48 
E¼ÜHªdËr
(cÚ¡ 
X­Ÿn
::ErrorHandler &);

69 
vœtu®
 
boŞ
 
hªdË_”rÜ
(
X­Ÿn
::
E¼Ü
 &
”rÜ
) = 0;

71 
	gpublic
:

73 
E¼ÜHªdËr
() {}

76 
vœtu®
 ~
E¼ÜHªdËr
();

88 
İ”©Ü
()(
	gX­Ÿn
::
E¼Ü
 &
”rÜ
);

	@include/xapian/expanddecider.h

21 #iâdeà
XAPIAN_INCLUDED_EXPANDDECIDER_H


22 
	#XAPIAN_INCLUDED_EXPANDDECIDER_H


	)

24 
	~<£t
>

25 
	~<¡ršg
>

27 
	~<x­Ÿn/visib™y.h
>

29 
Çme¥aû
 
	gX­Ÿn
 {

32 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gEx·ndDecid”
 {

33 
	gpublic
:

35 
vœtu®
 
boŞ
 
İ”©Ü
()(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
) const = 0;

38 
	gvœtu®
 ~
Ex·ndDecid”
();

46 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gEx·ndDecid”And
 : 
public
 
Ex·ndDecid”
 {

47 cÚ¡ 
Ex·ndDecid”
 &
fœ¡
, &
	g£cÚd
;

49 
	gpublic
:

53 
Ex·ndDecid”And
(cÚ¡ 
Ex·ndDecid”
 &
fœ¡_
,

54 cÚ¡ 
Ex·ndDecid”
 &
£cÚd_
)

55 : 
fœ¡
(
fœ¡_
), 
£cÚd
(
£cÚd_
) { }

58 
Ex·ndDecid”And
(cÚ¡ 
Ex·ndDecid”
 *
fœ¡_
,

59 cÚ¡ 
Ex·ndDecid”
 *
£cÚd_
)

60 : 
fœ¡
(*
fœ¡_
), 
£cÚd
(*
£cÚd_
) { }

62 
vœtu®
 
boŞ
 
İ”©Ü
()(cÚ¡ 
	g¡d
::
¡ršg
 &
‹rm
) const;

70 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gEx·ndDecid”F‹rT”ms
 : 
public
 
Ex·ndDecid”
 {

71 
¡d
::
£t
<¡d::
¡ršg
> 
»jeùs
;

73 
	gpublic
:

79 
‹m¶©e
 <
şass
 
I‹¿tÜ
>

80 
Ex·ndDecid”F‹rT”ms
(
I‹¿tÜ
 
»jeù_begš
, I‹¿tÜ 
»jeù_’d
)

81 : 
»jeùs
(
»jeù_begš
, 
»jeù_’d
) { }

83 
vœtu®
 
boŞ
 
İ”©Ü
()(cÚ¡ 
	g¡d
::
¡ršg
 &
‹rm
) const;

	@include/xapian/keymaker.h

21 #iâdeà
XAPIAN_INCLUDED_KEYMAKER_H


22 
	#XAPIAN_INCLUDED_KEYMAKER_H


	)

24 
	~<¡ršg
>

25 
	~<veùÜ
>

27 
	~<x­Ÿn/d•»ÿ‹d.h
>

28 
	~<x­Ÿn/ty³s.h
>

29 
	~<x­Ÿn/visib™y.h
>

31 
Çme¥aû
 
	gX­Ÿn
 {

33 
şass
 
	gDocum’t
;

36 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gKeyMak”
 {

37 
	gpublic
:

42 
vœtu®
 
¡d
::
¡ršg
 
İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
) const = 0;

45 
	gvœtu®
 ~
KeyMak”
();

63 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gMuÉiV®ueKeyMak”
 : 
public
 
KeyMak”
 {

64 
¡d
::
veùÜ
<¡d::
·œ
<
X­Ÿn
::
v®u’o
, 
	gboŞ
> > 
	gv®nos
;

66 
	gpublic
:

67 
MuÉiV®ueKeyMak”
() { }

69 
‹m¶©e
 <
şass
 
I‹¿tÜ
>

70 
MuÉiV®ueKeyMak”
(
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
) {

71 
	gbegš
 !ğ
’d
è
add_v®ue
(*
begš
++);

74 
vœtu®
 
	g¡d
::
¡ršg
 
İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
) const;

76 
add_v®ue
(
X­Ÿn
::
v®u’o
 
v®no
, 
boŞ
 
»v”£
 = 
çl£
) {

77 
v®nos
.
push_back
(
¡d
::
make_·œ
(
v®no
, 
»v”£
));

82 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	$XAPIAN_DEPRECATED
(è
SÜ‹r
 : 
public
 
KeyMak”
 { 
	}
};

109 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	$XAPIAN_DEPRECATED
(è
MuÉiV®ueSÜ‹r
 : 
public
 
SÜ‹r
 {

110 
¡d
::
veùÜ
<¡d::
·œ
<
X­Ÿn
::
v®u’o
, 
boŞ
> > 
v®nos
;

112 
public
:

113 
	`MuÉiV®ueSÜ‹r
() { }

115 
‹m¶©e
 <
şass
 
I‹¿tÜ
>

116 
	`MuÉiV®ueSÜ‹r
(
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
) {

117 
begš
 !ğ
’d
è
	`add
(*begin++);

120 
vœtu®
 
¡d
::
¡ršg
 
	`İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
) const;

122 
	`add
(
X­Ÿn
::
v®u’o
 
v®no
, 
boŞ
 
fÜw¬d
 = 
Œue
) {

123 
v®nos
.
	`push_back
(
¡d
::
	`make_·œ
(
v®no
, 
fÜw¬d
));

125 
	}
};

	@include/xapian/matchspy.h

23 #iâdeà
XAPIAN_INCLUDED_MATCHSPY_H


24 
	#XAPIAN_INCLUDED_MATCHSPY_H


	)

26 
	~<x­Ÿn/ba£.h
>

27 
	~<x­Ÿn/’quœe.h
>

28 
	~<x­Ÿn/‹rm™”©Ü.h
>

29 
	~<x­Ÿn/visib™y.h
>

31 
	~<¡ršg
>

32 
	~<m­
>

33 
	~<£t
>

34 
	~<¡ršg
>

35 
	~<veùÜ
>

37 
Çme¥aû
 
	gX­Ÿn
 {

39 
şass
 
	gDocum’t
;

40 
şass
 
	gRegi¡ry
;

48 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gM©chSpy
 {

49 
	g´iv©e
:

51 
İ”©Ü
=(cÚ¡ 
M©chSpy
 &);

54 
M©chSpy
(const MatchSpy &);

56 
	g´Ùeùed
:

58 
M©chSpy
() {}

60 
public
:

62 
vœtu®
 ~
M©chSpy
();

75 
vœtu®
 
İ”©Ü
()(cÚ¡ 
	gX­Ÿn
::
Docum’t
 &
doc
,

76 
	gX­Ÿn
::
weight
 
wt
) = 0;

91 
vœtu®
 
M©chSpy
 * 
şÚe
() const;

107 
vœtu®
 
	g¡d
::
¡ršg
 
Çme
() const;

115 
vœtu®
 
	g¡d
::
¡ršg
 
£rŸli£
() const;

129 
vœtu®
 
M©chSpy
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
,

130 cÚ¡ 
Regi¡ry
 & 
cÚ‹xt
) const;

138 
vœtu®
 
	g¡d
::
¡ršg
 
£rŸli£_»suÉs
() const;

150 
vœtu®
 
m”ge_»suÉs
(cÚ¡ 
¡d
::
¡ršg
 & 
s
);

159 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

168 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gV®ueCouÁM©chSpy
 : 
public
 
M©chSpy
 {

169 
public
:

170 
IÁ”Çl
;

172 #iâdeà
SWIG


173 
XAPIAN_VISIBILITY_DEFAULT
 
	gIÁ”Çl


174 : 
public
 
X­Ÿn
::
IÁ”Çl
::
RefCÁBa£


177 
X­Ÿn
::
v®u’o
 
¦Ù
;

180 
	gX­Ÿn
::
doccouÁ
 
tÙ®
;

183 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gX­Ÿn
::
doccouÁ
> 
v®ues
;

185 
IÁ”Çl
(è: 
¦Ù
(
X­Ÿn
::
BAD_VALUENO
), 
tÙ®
(0) {}

186 
IÁ”Çl
(
X­Ÿn
::
v®u’o
 
¦Ù_
è: 
¦Ù
(¦Ù_), 
tÙ®
(0) {}

190 
	g´Ùeùed
:

191 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

193 
	gpublic
:

195 
V®ueCouÁM©chSpy
(è: 
š‹º®
() {}

198 
V®ueCouÁM©chSpy
(
X­Ÿn
::
v®u’o
 
¦Ù_
)

199 : 
š‹º®
(
Ãw
 
IÁ”Çl
(
¦Ù_
)) {}

202 
size_t
 
g‘_tÙ®
() const {

203  
š‹º®
->
tÙ®
;

213 
T”mI‹¿tÜ
 
v®ues_begš
() const;

216 
T”mI‹¿tÜ
 
v®ues_’d
() const {

217  
T”mI‹¿tÜ
(
NULL
);

230 
T”mI‹¿tÜ
 
tİ_v®ues_begš
(
size_t
 
maxv®ues
) const;

233 
T”mI‹¿tÜ
 
tİ_v®ues_’d
(
size_t
) const {

234  
T”mI‹¿tÜ
(
NULL
);

241 
İ”©Ü
()(cÚ¡ 
	gX­Ÿn
::
Docum’t
 &
doc
, X­Ÿn::
weight
 
wt
);

243 
vœtu®
 
M©chSpy
 * 
şÚe
() const;

244 
vœtu®
 
	g¡d
::
¡ršg
 
Çme
() const;

245 
vœtu®
 
	g¡d
::
¡ršg
 
£rŸli£
() const;

246 
vœtu®
 
M©chSpy
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
,

247 cÚ¡ 
Regi¡ry
 & 
cÚ‹xt
) const;

248 
vœtu®
 
	g¡d
::
¡ršg
 
£rŸli£_»suÉs
() const;

249 
vœtu®
 
m”ge_»suÉs
(cÚ¡ 
¡d
::
¡ršg
 & 
s
);

250 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

	@include/xapian/positioniterator.h

24 #iâdeà
XAPIAN_INCLUDED_POSITIONITERATOR_H


25 
	#XAPIAN_INCLUDED_POSITIONITERATOR_H


	)

27 
	~<™”©Ü
>

28 
	~<¡ršg
>

30 
	~<x­Ÿn/ba£.h
>

31 
	~<x­Ÿn/d”efw¿µ”.h
>

32 
	~<x­Ÿn/ty³s.h
>

33 
	~<x­Ÿn/visib™y.h
>

35 
Çme¥aû
 
	gX­Ÿn
 {

37 
şass
 
	gD©aba£
;

38 
şass
 
	gPo¡šgI‹¿tÜ
;

39 
şass
 
	gT”mI‹¿tÜ
;

43 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gPos™iÚI‹¿tÜ
 {

44 
	g´iv©e
:

46 
ä›nd
 
şass
 
Po¡šgI‹¿tÜ
;

47 
ä›nd
 
şass
 
	gT”mI‹¿tÜ
;

48 
ä›nd
 
şass
 
	gD©aba£
;

50 
	gpublic
:

51 
şass
 
IÁ”Çl
;

53 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

55 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Pos™iÚI‹¿tÜ
 &
a
, cÚ¡ 
	gPos™iÚI‹¿tÜ
 &
	gb
);

58 
ex¶ic™
 
Pos™iÚI‹¿tÜ
(
IÁ”Çl
 *
š‹º®_
);

61 
Pos™iÚI‹¿tÜ
();

64 ~
Pos™iÚI‹¿tÜ
();

69 
Pos™iÚI‹¿tÜ
(cÚ¡ Pos™iÚI‹¿tÜ &
o
);

74 
	gİ”©Ü
=(cÚ¡ 
Pos™iÚI‹¿tÜ
 &
o
);

76 
	gX­Ÿn
::
‹rmpos
 
İ”©Ü
 *() const;

78 
	gPos™iÚI‹¿tÜ
 & 
	gİ”©Ü
++();

80 
	gD”efW¿µ”_
<
	g‹rmpos
> 
	gİ”©Ü
++() {

81 
	gX­Ÿn
::
‹rmpos
 
tmp
 = **
this
;

82 
	gİ”©Ü
++();

83  
	gD”efW¿µ”_
<
	g‹rmpos
>(
	gtmp
);

87 
sk_to
(
X­Ÿn
::
‹rmpos
 
pos
);

90 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

93 
	g¡d
::
	tšput_™”©Ü_g
 
	t™”©Ü_ÿ‹gÜy
;

94 
	gX­Ÿn
::
	t‹rmpos
 
	tv®ue_ty³
;

95 
	gX­Ÿn
::
	t‹rmpos_diff
 
	tdifã»nû_ty³
;

96 
	gX­Ÿn
::
	t‹rmpos
 * 
	tpoš‹r
;

97 
	gX­Ÿn
::
	t‹rmpos
 & 
	t»ã»nû
;

101 
šlše
 
boŞ


102 
	gİ”©Ü
==(cÚ¡ 
Pos™iÚI‹¿tÜ
 &
a
, cÚ¡ 
	gPos™iÚI‹¿tÜ
 &
	gb
)

104  (
	ga
.
	gš‹º®
.
g‘
(è=ğ
b
.
š‹º®
.get());

108 
šlše
 
boŞ


109 
	gİ”©Ü
!=(cÚ¡ 
Pos™iÚI‹¿tÜ
 &
a
, cÚ¡ 
	gPos™iÚI‹¿tÜ
 &
	gb
)

111  !(
	ga
 =ğ
b
);

	@include/xapian/postingiterator.h

24 #iâdeà
XAPIAN_INCLUDED_POSTINGITERATOR_H


25 
	#XAPIAN_INCLUDED_POSTINGITERATOR_H


	)

27 
	~<™”©Ü
>

28 
	~<¡ršg
>

30 
	~<x­Ÿn/ba£.h
>

31 
	~<x­Ÿn/d”efw¿µ”.h
>

32 
	~<x­Ÿn/ty³s.h
>

33 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

34 
	~<x­Ÿn/visib™y.h
>

36 
Çme¥aû
 
	gX­Ÿn
 {

38 
şass
 
	gD©aba£
;

42 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gPo¡šgI‹¿tÜ
 {

43 
	gpublic
:

44 
şass
 
IÁ”Çl
;

46 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

48 
	g´iv©e
:

49 
ä›nd
 
şass
 
D©aba£
;

51 
ex¶ic™
 
Po¡šgI‹¿tÜ
(
IÁ”Çl
 *
š‹º®_
);

53 
	gpublic
:

54 
ä›nd
 
boŞ
 
İ”©Ü
==(cÚ¡ 
Po¡šgI‹¿tÜ
 &
a
,

55 cÚ¡ 
	gPo¡šgI‹¿tÜ
 &
	gb
);

58 
Po¡šgI‹¿tÜ
();

61 ~
Po¡šgI‹¿tÜ
();

66 
Po¡šgI‹¿tÜ
(cÚ¡ Po¡šgI‹¿tÜ &
Ùh”
);

71 
	gİ”©Ü
=(cÚ¡ 
Po¡šgI‹¿tÜ
 &
Ùh”
);

73 
	gPo¡šgI‹¿tÜ
 & 
	gİ”©Ü
++();

75 
	gD”efW¿µ”_
<
	gdocid
> 
	gİ”©Ü
++() {

76 
	gX­Ÿn
::
docid
 
tmp
 = **
this
;

77 
	gİ”©Ü
++();

78  
	gD”efW¿µ”_
<
	gdocid
>(
	gtmp
);

84 
sk_to
(
X­Ÿn
::
docid
 
did
);

87 
	gX­Ÿn
::
docid
 
İ”©Ü
 *() const;

98 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth
() const;

103 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_wdf
() const;

108 
Pos™iÚI‹¿tÜ
 
pos™iÚli¡_begš
() const;

113 
Pos™iÚI‹¿tÜ
 
pos™iÚli¡_’d
() const {

114  
Pos™iÚI‹¿tÜ
(
NULL
);

123 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

127 
	g¡d
::
	tšput_™”©Ü_g
 
	t™”©Ü_ÿ‹gÜy
;

128 
	gX­Ÿn
::
	tdocid
 
	tv®ue_ty³
;

129 
	gX­Ÿn
::
	tdoccouÁ_diff
 
	tdifã»nû_ty³
;

130 
	gX­Ÿn
::
	tdocid
 * 
	tpoš‹r
;

131 
	gX­Ÿn
::
	tdocid
 & 
	t»ã»nû
;

136 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Po¡šgI‹¿tÜ
 &
a
, cÚ¡ 
	gPo¡šgI‹¿tÜ
 &
	gb
)

138  (
	ga
.
	gš‹º®
.
g‘
(è=ğ
b
.
š‹º®
.get());

142 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Po¡šgI‹¿tÜ
 &
a
, cÚ¡ 
	gPo¡šgI‹¿tÜ
 &
	gb
)

144  !(
	ga
 =ğ
b
);

	@include/xapian/postingsource.h

22 #iâdeà
XAPIAN_INCLUDED_POSTINGSOURCE_H


23 
	#XAPIAN_INCLUDED_POSTINGSOURCE_H


	)

25 
	~<x­Ÿn/d©aba£.h
>

26 
	~<x­Ÿn/ty³s.h
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~<¡ršg
>

30 
	~<m­
>

32 
Çme¥aû
 
	gX­Ÿn
 {

39 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gPo¡šgSourû
 {

41 
	gİ”©Ü
=(cÚ¡ 
Po¡šgSourû
 &);

44 
Po¡šgSourû
(const PostingSource &);

47 
	gmax_weight_
;

54 * 
	gm©ch”_
;

56 
	g´Ùeùed
:

58 
Po¡šgSourû
(è: 
max_weight_
(0), 
m©ch”_
(
NULL
) { }

78 
£t_maxweight
(
X­Ÿn
::
weight
 
max_weight
);

80 
	gpublic
:

87 
»gi¡”_m©ch”_
(* 
m©ch”
è{ 
m©ch”_
 = matcher; }

90 
	gvœtu®
 ~
Po¡šgSourû
();

97 
vœtu®
 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_mš
() const = 0;

108 
vœtu®
 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_e¡
() const = 0;

115 
vœtu®
 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_max
() const = 0;

118 
	gX­Ÿn
::
weight
 
g‘_maxweight
(ècÚ¡ {  
max_weight_
; }

133 
vœtu®
 
	gX­Ÿn
::
weight
 
g‘_weight
() const;

144 
vœtu®
 
	gX­Ÿn
::
docid
 
g‘_docid
() const = 0;

158 
vœtu®
 
Ãxt
(
X­Ÿn
::
weight
 
mš_wt
) = 0;

186 
vœtu®
 
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
mš_wt
);

219 
vœtu®
 
boŞ
 
check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
mš_wt
);

226 
vœtu®
 
boŞ
 
©_’d
() const = 0;

245 
vœtu®
 
Po¡šgSourû
 * 
şÚe
() const;

263 
vœtu®
 
	g¡d
::
¡ršg
 
Çme
() const;

274 
vœtu®
 
	g¡d
::
¡ršg
 
£rŸli£
() const;

286 
vœtu®
 
Po¡šgSourû
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
) const;

310 
vœtu®
 
š™
(cÚ¡ 
D©aba£
 & 
db
) = 0;

319 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

333 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gV®uePo¡šgSourû
 : 
public
 
Po¡šgSourû
 {

334 
´Ùeùed
:

336 
X­Ÿn
::
D©aba£
 
db
;

339 
	gX­Ÿn
::
v®u’o
 
¦Ù
;

342 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v®ue_™
;

345 
boŞ
 
	g¡¬‹d
;

352 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq_mš
;

359 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq_e¡
;

366 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq_max
;

368 
	gpublic
:

373 
V®uePo¡šgSourû
(
X­Ÿn
::
v®u’o
 
¦Ù_
);

375 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_mš
() const;

376 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_e¡
() const;

377 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_max
() const;

379 
Ãxt
(
X­Ÿn
::
weight
 
mš_wt
);

380 
sk_to
(
X­Ÿn
::
docid
 
mš_docid
, X­Ÿn::
weight
 
mš_wt
);

381 
boŞ
 
check
(
X­Ÿn
::
docid
 
mš_docid
, X­Ÿn::
weight
 
mš_wt
);

383 
boŞ
 
©_’d
() const;

385 
	gX­Ÿn
::
docid
 
g‘_docid
() const;

387 
š™
(cÚ¡ 
D©aba£
 & 
db_
);

409 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gV®ueWeightPo¡šgSourû


410 : 
public
 
V®uePo¡šgSourû
 {

411 
public
:

416 
V®ueWeightPo¡šgSourû
(
X­Ÿn
::
v®u’o
 
¦Ù_
);

418 
	gX­Ÿn
::
weight
 
g‘_weight
() const;

419 
V®ueWeightPo¡šgSourû
 * 
şÚe
() const;

420 
	g¡d
::
¡ršg
 
Çme
() const;

421 
	g¡d
::
¡ršg
 
£rŸli£
() const;

422 
V®ueWeightPo¡šgSourû
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
) const;

423 
š™
(cÚ¡ 
D©aba£
 & 
db_
);

425 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

448 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gDeü—sšgV®ueWeightPo¡šgSourû


449 : 
public
 
X­Ÿn
::
V®ueWeightPo¡šgSourû
 {

450 
´Ùeùed
:

451 
X­Ÿn
::
docid
 
¿nge_¡¬t
;

452 
	gX­Ÿn
::
docid
 
¿nge_’d
;

453 
	gcu¼_weight
;

456 
boŞ
 
	g™ems_©_’d
;

459 
sk_if_š_¿nge
(
X­Ÿn
::
weight
 
mš_wt
);

461 
	gpublic
:

462 
Deü—sšgV®ueWeightPo¡šgSourû
(
X­Ÿn
::
v®u’o
 
¦Ù_
,

463 
X­Ÿn
::
docid
 
¿nge_¡¬t_
 = 0,

464 
X­Ÿn
::
docid
 
¿nge_’d_
 = 0);

466 
	gX­Ÿn
::
weight
 
g‘_weight
() const;

467 
Deü—sšgV®ueWeightPo¡šgSourû
 * 
şÚe
() const;

468 
	g¡d
::
¡ršg
 
Çme
() const;

469 
	g¡d
::
¡ršg
 
£rŸli£
() const;

470 
Deü—sšgV®ueWeightPo¡šgSourû
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
) const;

471 
š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db_
);

473 
Ãxt
(
X­Ÿn
::
weight
 
mš_wt
);

474 
sk_to
(
X­Ÿn
::
docid
 
mš_docid
, X­Ÿn::
weight
 
mš_wt
);

475 
boŞ
 
check
(
X­Ÿn
::
docid
 
mš_docid
, X­Ÿn::
weight
 
mš_wt
);

477 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

489 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gV®ueM­Po¡šgSourû


490 : 
public
 
V®uePo¡šgSourû
 {

492 
deçuÉ_weight
;

495 
	gmax_weight_š_m­
;

498 
	g¡d
::
m­
<
¡d
::
¡ršg
, > 
	gweight_m­
;

500 
	gpublic
:

505 
V®ueM­Po¡šgSourû
(
X­Ÿn
::
v®u’o
 
¦Ù_
);

512 
add_m­pšg
(cÚ¡ 
¡d
::
¡ršg
 &
key
, 
weight
);

515 
ş—r_m­pšgs
();

518 
£t_deçuÉ_weight
(
wt
);

520 
	gX­Ÿn
::
weight
 
g‘_weight
() const;

521 
V®ueM­Po¡šgSourû
 * 
şÚe
() const;

522 
	g¡d
::
¡ršg
 
Çme
() const;

523 
	g¡d
::
¡ršg
 
£rŸli£
() const;

524 
V®ueM­Po¡šgSourû
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
) const;

525 
š™
(cÚ¡ 
D©aba£
 & 
db_
);

527 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

536 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gFixedWeightPo¡šgSourû
 : 
public
 
Po¡šgSourû
 {

538 
X­Ÿn
::
D©aba£
 
db
;

541 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq
;

544 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 
™
;

547 
boŞ
 
	g¡¬‹d
;

550 
	gX­Ÿn
::
docid
 
check_docid
;

552 
	gpublic
:

557 
FixedWeightPo¡šgSourû
(
X­Ÿn
::
weight
 
wt
);

559 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_mš
() const;

560 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_e¡
() const;

561 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq_max
() const;

563 
	gX­Ÿn
::
weight
 
g‘_weight
() const;

565 
Ãxt
(
X­Ÿn
::
weight
 
mš_wt
);

566 
sk_to
(
X­Ÿn
::
docid
 
mš_docid
, X­Ÿn::
weight
 
mš_wt
);

567 
boŞ
 
check
(
X­Ÿn
::
docid
 
mš_docid
, X­Ÿn::
weight
 
mš_wt
);

569 
boŞ
 
©_’d
() const;

571 
	gX­Ÿn
::
docid
 
g‘_docid
() const;

573 
FixedWeightPo¡šgSourû
 * 
şÚe
() const;

574 
	g¡d
::
¡ršg
 
Çme
() const;

575 
	g¡d
::
¡ršg
 
£rŸli£
() const;

576 
FixedWeightPo¡šgSourû
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
) const;

577 
š™
(cÚ¡ 
D©aba£
 & 
db_
);

579 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

	@include/xapian/query.h

25 #iâdeà
XAPIAN_INCLUDED_QUERY_H


26 
	#XAPIAN_INCLUDED_QUERY_H


	)

28 
	~<¡ršg
>

29 
	~<veùÜ
>

31 
	~<x­Ÿn/ba£.h
>

32 
	~<x­Ÿn/ty³s.h
>

33 
	~<x­Ÿn/‹rm™”©Ü.h
>

34 
	~<x­Ÿn/visib™y.h
>

39 
şass
 
	gLoÿlSubM©ch
;

40 
şass
 
	gMuÉiM©ch
;

41 
şass
 
	gQu”yO±imi£r
;

42 
	gSÜtPosName
;

44 
Çme¥aû
 
	gX­Ÿn
 {

46 
şass
 
	gPo¡šgSourû
;

47 
şass
 
	gRegi¡ry
;

53 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gQu”y
 {

54 
	gpublic
:

56 
şass
 
IÁ”Çl
;

58 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

63 
	gOP_AND
,

66 
	gOP_OR
,

69 
	gOP_AND_NOT
,

72 
	gOP_XOR
,

75 
	gOP_AND_MAYBE
,

78 
	gOP_FILTER
,

89 
	gOP_NEAR
,

100 
	gOP_PHRASE
,

103 
	gOP_VALUE_RANGE
,

113 
	gOP_SCALE_WEIGHT
,

118 
	gOP_ELITE_SET
,

121 
	gOP_VALUE_GE
,

124 
	gOP_VALUE_LE
,

141 
	gOP_SYNONYM


142 } 
	tİ
;

145 
Qu”y
(cÚ¡ Qu”y & 
cİyme
);

148 
	gQu”y
 & 
	gİ”©Ü
=(cÚ¡ 
Qu”y
 & 
cİyme
);

158 
Qu”y
();

161 ~
Qu”y
();

164 
Qu”y
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame_
, 
X­Ÿn
::
‹rmcouÁ
 
wqf_
 = 1,

165 
X­Ÿn
::
‹rmpos
 
pos_
 = 0);

168 
Qu”y
(Qu”y::
İ
 
İ_
, cÚ¡ Qu”y & 
Ëá
, cÚ¡ Qu”y & 
right
);

171 
Qu”y
(Qu”y::
İ
 
İ_
,

172 cÚ¡ 
¡d
::
¡ršg
 & 
Ëá
, cÚ¡ std::¡ršg & 
right
);

189 
	g‹m¶©e
 <
şass
 
	gI‹¿tÜ
>

190 
Qu”y
(Qu”y::
İ
 
İ_
, 
I‹¿tÜ
 
qbegš
, I‹¿tÜ 
q’d
,

191 
X­Ÿn
::
‹rmcouÁ
 
·¿m‘”
 = 0);

196 
Qu”y
(Qu”y::
İ
 
İ_
, 
X­Ÿn
::Qu”y 
q
, 
·¿m‘”
);

211 
Qu”y
(Qu”y::
İ
 
İ_
, 
X­Ÿn
::
v®u’o
 
v®no
,

212 cÚ¡ 
¡d
::
¡ršg
 &
begš
, cÚ¡ std::¡ršg &
’d
);

225 
Qu”y
(Qu”y::
İ
 
İ_
, 
X­Ÿn
::
v®u’o
 
v®no
, cÚ¡ 
¡d
::
¡ršg
 &
v®ue
);

237 
ex¶ic™
 
Qu”y
(
X­Ÿn
::
Po¡šgSourû
 * 
ex‹º®_sourû
);

240 cÚ¡ 
	gX­Ÿn
::
Qu”y
 
M©chAÎ
;

243 cÚ¡ 
	gX­Ÿn
::
Qu”y
 
M©chNÙhšg
;

249 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_Ëngth
() const;

256 
T”mI‹¿tÜ
 
g‘_‹rms_begš
() const;

261 
T”mI‹¿tÜ
 
g‘_‹rms_’d
() const {

262  
T”mI‹¿tÜ
(
NULL
);

268 
boŞ
 
em±y
() const;

277 
	g¡d
::
¡ršg
 
£rŸli£
() const;

286 
Qu”y
 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
);

298 
Qu”y
 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
,

299 cÚ¡ 
Regi¡ry
 & 
»gi¡ry
);

302 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

304 
	g´iv©e
:

305 
add_subqu”y
(cÚ¡ 
Qu”y
 & 
subq
);

306 
add_subqu”y
(cÚ¡ 
Qu”y
 * 
subq
);

307 
add_subqu”y
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
);

308 
¡¬t_cÚ¡ruùiÚ
(
Qu”y
::
İ
 
İ_
, 
X­Ÿn
::
‹rmcouÁ
 
·¿m‘”
);

309 
’d_cÚ¡ruùiÚ
();

310 
abÜt_cÚ¡ruùiÚ
();

313 
	g‹m¶©e
 <
şass
 
	gI‹¿tÜ
>

314 
	gQu”y
::
Qu”y
(Qu”y::
İ
 
İ_
, 
I‹¿tÜ
 
qbegš
, I‹¿tÜ 
q’d
, 
‹rmcouÁ
 
·¿m‘”
)

315 : 
	$š‹º®
(0)

317 
Œy
 {

318 
	`¡¬t_cÚ¡ruùiÚ
(
İ_
, 
·¿m‘”
);

321 
qbegš
 !ğ
q’d
) {

322 
	`add_subqu”y
(*
qbegš
);

323 ++
qbegš
;

326 
	`’d_cÚ¡ruùiÚ
();

327 } 
	`ÿtch
 (...) {

328 
	`abÜt_cÚ¡ruùiÚ
();

329 
throw
;

331 
	}
}

333 #iâdeà
SWIG


336 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gQu”y
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

337 
ä›nd
 
şass
 ::
LoÿlSubM©ch
;

338 
ä›nd
 
	gşass
 ::
MuÉiM©ch
;

339 
ä›nd
 
	gşass
 ::
Qu”yO±imi£r
;

340 
ä›nd
 ::
SÜtPosName
;

341 
ä›nd
 
şass
 
	gQu”y
;

342 
	gpublic
:

343 cÚ¡ 
OP_LEAF
 = -1;

344 cÚ¡ 
	gOP_EXTERNAL_SOURCE
 = -2;

347 
	g¡d
::
	tveùÜ
<
	tIÁ”Çl
 *> 
	tsubqu”y_li¡
;

350 
	tİ_t
;

352 
	g´iv©e
:

354 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
;

357 
subqu”y_li¡
 
	gsubqs
;

368 
	gX­Ÿn
::
‹rmcouÁ
 
·¿m‘”
;

376 
	g¡d
::
¡ršg
 
Šame
;

379 
	g¡d
::
¡ršg
 
¡r_·¿m‘”
;

382 
	gX­Ÿn
::
‹rmpos
 
‹rm_pos
;

385 
	gX­Ÿn
::
Po¡šgSourû
 * 
ex‹º®_sourû
;

388 
boŞ
 
	gex‹º®_sourû_owÃd
;

391 
š™Ÿli£_äom_cİy
(cÚ¡ 
Qu”y
::
IÁ”Çl
 & 
cİyme
);

393 
accumuÏ‹_‹rms
(

394 
¡d
::
veùÜ
<¡d::
·œ
<¡d::
¡ršg
, 
X­Ÿn
::
‹rmpos
> > &
‹rms
) const;

400 
IÁ”Çl
 * 
sim¶ify_qu”y
();

407 
v®id©e_qu”y
() const;

414 
boŞ
 
sim¶ify_m©chnÙhšg
();

418 
	g¡d
::
¡ršg
 
g‘_İ_Çme
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
);

422 
cŞÏp£_subqs
();

427 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
æ©‹n_subqs
();

431 
	g¡d
::
¡ršg
 
£rŸli£
(
X­Ÿn
::
‹rmpos
 & 
cu½os
) const;

433 
	gpublic
:

435 
IÁ”Çl
(cÚ¡ 
Qu”y
::IÁ”ÇÈ& 
cİyme
);

438 
	gİ”©Ü
=(cÚ¡ 
Qu”y
::
IÁ”Çl
 & 
cİyme
);

441 
ex¶ic™
 
IÁ”Çl
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame_
, 
X­Ÿn
::
‹rmcouÁ
 
wqf_
 = 1,

442 
X­Ÿn
::
‹rmpos
 
‹rm_pos_
 = 0);

445 
IÁ”Çl
(
İ_t
 
İ_
, 
X­Ÿn
::
‹rmcouÁ
 
·¿m‘”
);

448 
IÁ”Çl
(
İ_t
 
İ_
, 
X­Ÿn
::
v®u’o
 
v®no
,

449 cÚ¡ 
¡d
::
¡ršg
 &
begš
, cÚ¡ std::¡ršg &
’d
);

453 
IÁ”Çl
(
İ_t
 
İ_
, 
X­Ÿn
::
v®u’o
 
v®no
, cÚ¡ 
¡d
::
¡ršg
 &
v®ue
);

456 
ex¶ic™
 
IÁ”Çl
(
X­Ÿn
::
Po¡šgSourû
 * 
ex‹º®_sourû_
, 
boŞ
 
owÃd
);

459 ~
IÁ”Çl
();

461 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 &
s
,

462 cÚ¡ 
Regi¡ry
 & 
»gi¡ry
);

465 
add_subqu”y
(cÚ¡ 
Qu”y
::
IÁ”Çl
 * 
subq
);

471 
add_subqu”y_nocİy
(
Qu”y
::
IÁ”Çl
 * 
subq
);

473 
£t_dbl_·¿m‘”
(
dbl_·¿m‘”_
);

475 
g‘_dbl_·¿m‘”
() const;

479 
	gQu”y
::
IÁ”Çl
 * 
’d_cÚ¡ruùiÚ
();

484 
	g¡d
::
¡ršg
 
£rŸli£
() const {

485 
X­Ÿn
::
‹rmpos
 
cu½os
 = 1;

486  
£rŸli£
(
cu½os
);

490 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

499 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_·¿m‘”
(ècÚ¡ {  
·¿m‘”
; }

501 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_wqf
(ècÚ¡ {  
·¿m‘”
; }

507 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_Ëngth
() const;

514 
T”mI‹¿tÜ
 
g‘_‹rms
() const;

	@include/xapian/queryparser.h

22 #iâdeà
XAPIAN_INCLUDED_QUERYPARSER_H


23 
	#XAPIAN_INCLUDED_QUERYPARSER_H


	)

25 
	~<x­Ÿn/ba£.h
>

26 
	~<x­Ÿn/qu”y.h
>

27 
	~<x­Ÿn/‹rm™”©Ü.h
>

28 
	~<x­Ÿn/visib™y.h
>

30 
	~<£t
>

31 
	~<¡ršg
>

33 
Çme¥aû
 
	gX­Ÿn
 {

35 
şass
 
	gS‹m
;

38 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gStİ³r
 {

39 
	gpublic
:

41 
vœtu®
 
boŞ
 
İ”©Ü
()(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
) const = 0;

44 
	gvœtu®
 ~
Stİ³r
() { }

47 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

51 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gSim¶eStİ³r
 : 
public
 
Stİ³r
 {

52 
¡d
::
£t
<¡d::
¡ršg
> 
¡İ_wÜds
;

54 
	gpublic
:

56 
Sim¶eStİ³r
() { }

59 #iâdeà
__SUNPRO_CC


60 
‹m¶©e
 <
şass
 
I‹¿tÜ
>

61 
Sim¶eStİ³r
(
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
è: 
¡İ_wÜds
(begin,ƒnd) { }

64 
	g‹m¶©e
 <
şass
 
	gI‹¿tÜ
>

65 
Sim¶eStİ³r
(
I‹¿tÜ
 
begš
, I‹¿tÜ 
’d
) {

66 
	gbegš
 !ğ
’d
è
¡İ_wÜds
.
š£¹
(*
begš
++);

71 
add
(cÚ¡ 
¡d
::
¡ršg
 & 
wÜd
è{ 
¡İ_wÜds
.
š£¹
(word); }

74 
vœtu®
 
boŞ
 
İ”©Ü
()(cÚ¡ 
	g¡d
::
¡ršg
 & 
‹rm
) const {

75  
¡İ_wÜds
.
fšd
(
‹rm
è!ğ¡İ_wÜds.
’d
();

79 
vœtu®
 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

83 
XAPIAN_VISIBILITY_DEFAULT
 
	gV®ueRªgeProûssÜ
 {

85 
	gvœtu®
 ~
V®ueRªgeProûssÜ
();

93 
vœtu®
 
	gX­Ÿn
::
v®u’o
 
İ”©Ü
()(
¡d
::
¡ršg
 &
begš
, 
	g¡d
::¡ršg &
’d
) = 0;

100 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gSŒšgV®ueRªgeProûssÜ
 : 
public
 
V®ueRªgeProûssÜ
 {

101 
´Ùeùed
:

102 
X­Ÿn
::
v®u’o
 
v®no
;

104 
	g´iv©e
:

105 
boŞ
 
´efix
;

106 
	g¡d
::
¡ršg
 
¡r
;

108 
	gpublic
:

113 
SŒšgV®ueRªgeProûssÜ
(
X­Ÿn
::
v®u’o
 
v®no_
)

114 : 
v®no
(
v®no_
), 
¡r
() { }

124 
SŒšgV®ueRªgeProûssÜ
(
X­Ÿn
::
v®u’o
 
v®no_
, cÚ¡ 
¡d
::
¡ršg
 &
¡r_
,

125 
boŞ
 
´efix_
 = 
Œue
)

126 : 
v®no
(
v®no_
), 
´efix
(
´efix_
), 
¡r
(
¡r_
) { }

136 
	gX­Ÿn
::
v®u’o
 
İ”©Ü
()(
¡d
::
¡ršg
 &, 
	g¡d
::string &);

143 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gD©eV®ueRªgeProûssÜ
 : 
public
 
SŒšgV®ueRªgeProûssÜ
 {

144 
boŞ
 
´eãr_mdy
;

145 
	g•och_y—r
;

147 
	gpublic
:

158 
D©eV®ueRªgeProûssÜ
(
X­Ÿn
::
v®u’o
 
v®no_
, 
boŞ
 
´eãr_mdy_
 = 
çl£
,

159 
•och_y—r_
 = 1970)

160 : 
SŒšgV®ueRªgeProûssÜ
(
v®no_
),

161 
´eãr_mdy
(
´eãr_mdy_
), 
•och_y—r
(
•och_y—r_
) { }

200 
D©eV®ueRªgeProûssÜ
(
X­Ÿn
::
v®u’o
 
v®no_
, cÚ¡ 
¡d
::
¡ršg
 &
¡r_
,

201 
boŞ
 
´efix_
 = 
Œue
,

202 
boŞ
 
´eãr_mdy_
 = 
çl£
, 
•och_y—r_
 = 1970)

203 : 
SŒšgV®ueRªgeProûssÜ
(
v®no_
, 
¡r_
, 
´efix_
),

204 
´eãr_mdy
(
´eãr_mdy_
), 
•och_y—r
(
•och_y—r_
) { }

212 
	gX­Ÿn
::
v®u’o
 
İ”©Ü
()(
¡d
::
¡ršg
 &
begš
, 
	g¡d
::¡ršg &
’d
);

222 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gNumb”V®ueRªgeProûssÜ
 : 
public
 
SŒšgV®ueRªgeProûssÜ
 {

223 
public
:

228 
Numb”V®ueRªgeProûssÜ
(
X­Ÿn
::
v®u’o
 
v®no_
)

229 : 
SŒšgV®ueRªgeProûssÜ
(
v®no_
) { }

263 
Numb”V®ueRªgeProûssÜ
(
X­Ÿn
::
v®u’o
 
v®no_
, cÚ¡ 
¡d
::
¡ršg
 &
¡r_
,

264 
boŞ
 
´efix_
 = 
Œue
)

265 : 
SŒšgV®ueRªgeProûssÜ
(
v®no_
, 
¡r_
, 
´efix_
) { }

276 
	gX­Ÿn
::
v®u’o
 
İ”©Ü
()(
¡d
::
¡ršg
 &
begš
, 
	g¡d
::¡ršg &
’d
);

280 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gQu”yP¬£r
 {

281 
	gpublic
:

283 
şass
 
IÁ”Çl
;

285 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

290 
	gFLAG_BOOLEAN
 = 1,

292 
	gFLAG_PHRASE
 = 2,

294 
	gFLAG_LOVEHATE
 = 4,

296 
	gFLAG_BOOLEAN_ANY_CASE
 = 8,

302 
	gFLAG_WILDCARD
 = 16,

309 
	gFLAG_PURE_NOT
 = 32,

321 
	gFLAG_PARTIAL
 = 64,

336 
	gFLAG_SPELLING_CORRECTION
 = 128,

342 
	gFLAG_SYNONYM
 = 256,

348 
	gFLAG_AUTO_SYNONYMS
 = 512,

355 
	gFLAG_AUTO_MULTIWORD_SYNONYMS
 = 1024 | 
FLAG_AUTO_SYNONYMS
,

363 
	gFLAG_DEFAULT
 = 
FLAG_PHRASE
|
FLAG_BOOLEAN
|
FLAG_LOVEHATE


364 } 
	tã©u»_æag
;

366 ’um { 
	gSTEM_NONE
, 
	gSTEM_SOME
, 
	gSTEM_ALL
 } 
	t¡em_¡¿‹gy
;

369 
Qu”yP¬£r
(cÚ¡ Qu”yP¬£¸& 
o
);

372 
	gQu”yP¬£r
 & 
	gİ”©Ü
=(cÚ¡ 
Qu”yP¬£r
 & 
o
);

375 
Qu”yP¬£r
();

378 ~
Qu”yP¬£r
();

388 
£t_¡emm”
(cÚ¡ 
X­Ÿn
::
S‹m
 & 
¡emm”
);

407 
£t_¡emmšg_¡¿‹gy
(
¡em_¡¿‹gy
 
¡¿‹gy
);

410 
£t_¡İ³r
(cÚ¡ 
Stİ³r
 *
¡İ
 = 
NULL
);

423 
£t_deçuÉ_İ
(
Qu”y
::
İ
 
deçuÉ_İ
);

426 
	gQu”y
::
İ
 
g‘_deçuÉ_İ
() const;

429 
£t_d©aba£
(cÚ¡ 
D©aba£
 &
db
);

440 
Qu”y
 
·r£_qu”y
(cÚ¡ 
¡d
::
¡ršg
 &
qu”y_¡ršg
,

441 
æags
 = 
FLAG_DEFAULT
,

442 cÚ¡ 
¡d
::
¡ršg
 &
deçuÉ_´efix
 = std::string());

483 
add_´efix
(cÚ¡ 
¡d
::
¡ršg
 &
f›ld
, cÚ¡ std::¡ršg &
´efix
);

530 
add_boŞ—n_´efix
(cÚ¡ 
¡d
::
¡ršg
 & 
f›ld
, cÚ¡ std::¡ršg &
´efix
);

533 
T”mI‹¿tÜ
 
¡İli¡_begš
() const;

534 
T”mI‹¿tÜ
 
¡İli¡_’d
() const {

535  
T”mI‹¿tÜ
(
NULL
);

539 
T”mI‹¿tÜ
 
un¡em_begš
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
) const;

540 
T”mI‹¿tÜ
 
un¡em_’d
(cÚ¡ 
¡d
::
¡ršg
 &) const {

541  
T”mI‹¿tÜ
(
NULL
);

545 
add_v®u”ªg•roûssÜ
(
X­Ÿn
::
V®ueRªgeProûssÜ
 * 
v½roc
);

554 
	g¡d
::
¡ršg
 
g‘_cÜ»ùed_qu”y_¡ršg
() const;

557 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

584 
XAPIAN_VISIBILITY_DEFAULT


585 
	g¡d
::
¡ršg
 
sÜbË_£rŸli£
(
v®ue
);

599 
XAPIAN_VISIBILITY_DEFAULT


600 
sÜbË_un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
v®ue
);

	@include/xapian/registry.h

23 #iâdeà
XAPIAN_INCLUDED_REGISTRY_H


24 
	#XAPIAN_INCLUDED_REGISTRY_H


	)

26 
	~<x­Ÿn/ba£.h
>

27 
	~<x­Ÿn/visib™y.h
>

28 
	~<¡ršg
>

30 
Çme¥aû
 
	gX­Ÿn
 {

33 
şass
 
	gM©chSpy
;

34 
şass
 
	gPo¡šgSourû
;

35 
şass
 
	gWeight
;

42 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gRegi¡ry
 {

43 
	gpublic
:

45 
şass
 
IÁ”Çl
;

47 
	g´iv©e
:

49 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

51 
	gpublic
:

56 
Regi¡ry
(cÚ¡ Regi¡ry & 
Ùh”
);

62 
	gRegi¡ry
 & 
	gİ”©Ü
=(cÚ¡ 
Regi¡ry
 & 
Ùh”
);

69 
Regi¡ry
();

71 ~
Regi¡ry
();

74 
»gi¡”_weightšg_scheme
(cÚ¡ 
X­Ÿn
::
Weight
 &
wt
);

82 cÚ¡ 
	gX­Ÿn
::
Weight
 *

83 
g‘_weightšg_scheme
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
) const;

86 
»gi¡”_po¡šg_sourû
(cÚ¡ 
X­Ÿn
::
Po¡šgSourû
 &
sourû
);

94 cÚ¡ 
	gX­Ÿn
::
Po¡šgSourû
 *

95 
g‘_po¡šg_sourû
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
) const;

98 
»gi¡”_m©ch_¥y
(cÚ¡ 
X­Ÿn
::
M©chSpy
 &
¥y
);

106 cÚ¡ 
	gX­Ÿn
::
M©chSpy
 *

107 
g‘_m©ch_¥y
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
) const;

	@include/xapian/stem.h

21 #iâdeà
XAPIAN_INCLUDED_STEM_H


22 
	#XAPIAN_INCLUDED_STEM_H


	)

24 
	~<x­Ÿn/ba£.h
>

25 
	~<x­Ÿn/visib™y.h
>

27 
	~<¡ršg
>

29 
Çme¥aû
 
	gX­Ÿn
 {

32 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gS‹m
 {

33 
	gpublic
:

35 
şass
 
IÁ”Çl
;

37 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

40 
S‹m
(cÚ¡ S‹m & 
o
);

43 
	gİ”©Ü
=(cÚ¡ 
S‹m
 & 
o
);

49 
S‹m
();

79 
ex¶ic™
 
S‹m
(cÚ¡ 
¡d
::
¡ršg
 &
Ïnguage
);

82 ~
S‹m
();

89 
	g¡d
::
¡ršg
 
İ”©Ü
()(cÚ¡ 
¡d
::¡ršg &
wÜd
) const;

92 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

104 
	g¡d
::
¡ršg
 
g‘_avaabË_Ïnguages
();

	@include/xapian/termgenerator.h

21 #iâdeà
XAPIAN_INCLUDED_TERMGENERATOR_H


22 
	#XAPIAN_INCLUDED_TERMGENERATOR_H


	)

24 
	~<x­Ÿn/ba£.h
>

25 
	~<x­Ÿn/ty³s.h
>

26 
	~<x­Ÿn/unicode.h
>

27 
	~<x­Ÿn/visib™y.h
>

29 
	~<¡ršg
>

31 
Çme¥aû
 
	gX­Ÿn
 {

33 
şass
 
	gDocum’t
;

34 
şass
 
	gS‹m
;

35 
şass
 
	gStİ³r
;

36 
şass
 
	gWr™abËD©aba£
;

44 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gT”mG’”©Ü
 {

45 
	gpublic
:

47 
şass
 
IÁ”Çl
;

49 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

52 
T”mG’”©Ü
(cÚ¡ T”mG’”©Ü & 
o
);

55 
	gT”mG’”©Ü
 & 
	gİ”©Ü
=(cÚ¡ 
T”mG’”©Ü
 & 
o
);

58 
T”mG’”©Ü
();

61 ~
T”mG’”©Ü
();

64 
£t_¡emm”
(cÚ¡ 
X­Ÿn
::
S‹m
 & 
¡emm”
);

67 
£t_¡İ³r
(cÚ¡ 
X­Ÿn
::
Stİ³r
 *
¡İ
 = 
NULL
);

70 
£t_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
);

73 cÚ¡ 
	gX­Ÿn
::
Docum’t
 & 
g‘_docum’t
() const;

76 
£t_d©aba£
(cÚ¡ 
X­Ÿn
::
Wr™abËD©aba£
 &
db
);

79 
	eæags
 {

81 
	gFLAG_SPELLING
 = 128

96 
æags
 
£t_æags
(æag 
toggË
, fÏg 
mask
 = flags(0));

103 
šdex_‹xt
(cÚ¡ 
X­Ÿn
::
Utf8I‹¿tÜ
 & 
™Ü
,

104 
X­Ÿn
::
‹rmcouÁ
 
weight
 = 1,

105 cÚ¡ 
¡d
::
¡ršg
 & 
´efix
 = std::string());

112 
šdex_‹xt
(cÚ¡ 
¡d
::
¡ršg
 & 
‹xt
,

113 
X­Ÿn
::
‹rmcouÁ
 
weight
 = 1,

114 cÚ¡ 
¡d
::
¡ršg
 & 
´efix
 = std::string()) {

115  
šdex_‹xt
(
Utf8I‹¿tÜ
(
‹xt
), 
weight
, 
´efix
);

124 
šdex_‹xt_w™hout_pos™iÚs
(cÚ¡ 
X­Ÿn
::
Utf8I‹¿tÜ
 & 
™Ü
,

125 
X­Ÿn
::
‹rmcouÁ
 
weight
 = 1,

126 cÚ¡ 
¡d
::
¡ršg
 & 
´efix
 = std::string());

134 
šdex_‹xt_w™hout_pos™iÚs
(cÚ¡ 
¡d
::
¡ršg
 & 
‹xt
,

135 
X­Ÿn
::
‹rmcouÁ
 
weight
 = 1,

136 cÚ¡ 
¡d
::
¡ršg
 & 
´efix
 = std::string()) {

137  
šdex_‹xt_w™hout_pos™iÚs
(
Utf8I‹¿tÜ
(
‹xt
), 
weight
, 
´efix
);

145 
šü—£_‹rmpos
(
X­Ÿn
::
‹rmcouÁ
 
d–
 = 100);

148 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_‹rmpos
() const;

151 
£t_‹rmpos
(
X­Ÿn
::
‹rmcouÁ
 
‹rmpos
);

154 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

	@include/xapian/termiterator.h

24 #iâdeà
XAPIAN_INCLUDED_TERMITERATOR_H


25 
	#XAPIAN_INCLUDED_TERMITERATOR_H


	)

27 
	~<™”©Ü
>

28 
	~<¡ršg
>

30 
	~<x­Ÿn/ba£.h
>

31 
	~<x­Ÿn/d”efw¿µ”.h
>

32 
	~<x­Ÿn/ty³s.h
>

33 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

34 
	~<x­Ÿn/visib™y.h
>

36 
Çme¥aû
 
	gX­Ÿn
 {

38 
şass
 
	gD©aba£
;

42 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gT”mI‹¿tÜ
 {

43 
	gpublic
:

44 
şass
 
IÁ”Çl
;

46 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

49 
ex¶ic™
 
T”mI‹¿tÜ
(
IÁ”Çl
 *
š‹º®_
);

52 
T”mI‹¿tÜ
();

55 ~
T”mI‹¿tÜ
();

60 
T”mI‹¿tÜ
(cÚ¡ T”mI‹¿tÜ &
Ùh”
);

65 
	gİ”©Ü
=(cÚ¡ 
T”mI‹¿tÜ
 &
Ùh”
);

68 
	g¡d
::
¡ršg
 
İ”©Ü
 *() const;

70 
	gT”mI‹¿tÜ
 & 
	gİ”©Ü
++();

72 
	gD”efW¿µ”_
<
	g¡d
::
¡ršg
> 
İ”©Ü
++() {

73 cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
(**
this
);

74 
	gİ”©Ü
++();

75  
	gD”efW¿µ”_
<
	g¡d
::
¡ršg
>(
‹rm
);

81 
sk_to
(cÚ¡ 
¡d
::
¡ršg
 & 
Šame
);

88 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_wdf
() const;

94 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
() const;

98 
	gX­Ÿn
::
‹rmcouÁ
 
pos™iÚli¡_couÁ
() const;

103 
Pos™iÚI‹¿tÜ
 
pos™iÚli¡_begš
() const;

108 
Pos™iÚI‹¿tÜ
 
pos™iÚli¡_’d
() const {

109  
Pos™iÚI‹¿tÜ
(
NULL
);

113 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

117 
	g¡d
::
	tšput_™”©Ü_g
 
	t™”©Ü_ÿ‹gÜy
;

118 
	g¡d
::
	t¡ršg
 
	tv®ue_ty³
;

119 
	gX­Ÿn
::
	t‹rmcouÁ_diff
 
	tdifã»nû_ty³
;

120 
	g¡d
::
	t¡ršg
 * 
	tpoš‹r
;

121 
	g¡d
::
	t¡ršg
 & 
	t»ã»nû
;

126 
šlše
 
boŞ


127 
	gİ”©Ü
==(cÚ¡ 
T”mI‹¿tÜ
 &
a
, cÚ¡ 
	gT”mI‹¿tÜ
 &
	gb
)

129  (
	ga
.
	gš‹º®
.
g‘
(è=ğ
b
.
š‹º®
.get());

133 
šlše
 
boŞ


134 
	gİ”©Ü
!=(cÚ¡ 
T”mI‹¿tÜ
 &
a
, cÚ¡ 
	gT”mI‹¿tÜ
 &
	gb
)

136  !(
	ga
 =ğ
b
);

	@include/xapian/types.h

21 #iâdeà
XAPIAN_INCLUDED_TYPES_H


22 
	#XAPIAN_INCLUDED_TYPES_H


	)

24 
Çme¥aû
 
	gX­Ÿn
 {

31 
	tdoccouÁ
;

38 
	tdoccouÁ_diff
;

45 
	tdocid
;

52 
	tdoş’gth
;

55 
	t³rûÁ
;

61 
	t‹rmcouÁ
;

68 
	t‹rmcouÁ_diff
;

72 
	t‹rmpos
;

79 
	t‹rmpos_diff
;

86 
	ttimeout
;

92 
	tv®u’o
;

99 
	tv®u’o_diff
;

102 
	tweight
;

105 cÚ¡ 
v®u’o
 
	gBAD_VALUENO
 = 
¡©ic_ÿ¡
<valueno>(-1);

	@include/xapian/unicode.h

21 #iâdeà
XAPIAN_INCLUDED_UNICODE_H


22 
	#XAPIAN_INCLUDED_UNICODE_H


	)

24 
	~<x­Ÿn/visib™y.h
>

26 
	~<¡ršg
>

28 
Çme¥aû
 
	gX­Ÿn
 {

33 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gUtf8I‹¿tÜ
 {

34 cÚ¡ *
	gp
;

35 cÚ¡ *
	g’d
;

36 
mubË
 
	g£qËn
;

38 
ÿlcuÏ‹_£qu’û_Ëngth
() const;

40 
g‘_ch¬
() const;

42 
Utf8I‹¿tÜ
(cÚ¡ *
p_
, cÚ¡ *
’d_
, 
£qËn_
)

43 : 
p
(
p_
), 
’d
(
’d_
), 
£qËn
(
£qËn_
) { }

45 
	gpublic
:

47 cÚ¡ * 
¿w
() const {

48  
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
 ?… : 
’d
);

52 
size_t
 
Ëá
(ècÚ¡ {  
	gp
 ? 
	g’d
 -… : 0; }

65 
assign
(cÚ¡ *
p_
, 
size_t
 
Ën
) {

66 ià(
	gËn
) {

67 
	gp
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p_
);

68 
	g’d
 = 
p
 + 
Ën
;

69 
	g£qËn
 = 0;

71 
	gp
 = 
NULL
;

85 
assign
(cÚ¡ 
¡d
::
¡ršg
 &
s
è{‡ssign(s.
d©a
(), s.
size
()); }

95 
ex¶ic™
 
Utf8I‹¿tÜ
(cÚ¡ *
p_
);

107 
Utf8I‹¿tÜ
(cÚ¡ *
p_
, 
size_t
 
Ën
è{ 
assign
(p_,†en); }

118 
Utf8I‹¿tÜ
(cÚ¡ 
¡d
::
¡ršg
 &
s
è{ 
assign
(s.
d©a
(), s.
size
()); }

125 
Utf8I‹¿tÜ
(è: 
p
(
NULL
), 
’d
(0), 
£qËn
(0) { }

131 
	gİ”©Ü
*() const;

137 
Utf8I‹¿tÜ
 
	gİ”©Ü
++() {

139 ià(
	g£qËn
 =ğ0è
ÿlcuÏ‹_£qu’û_Ëngth
();

140 cÚ¡ *
	gŞd_p
 = 
p
;

141 
	gŞd_£qËn
 = 
£qËn
;

142 
	gp
 +ğ
£qËn
;

143 ià(
	gp
 =ğ
’d
è
p
 = 
NULL
;

144 
	g£qËn
 = 0;

145  
Utf8I‹¿tÜ
(
Şd_p
, 
’d
, 
Şd_£qËn
);

152 
	gUtf8I‹¿tÜ
 & 
	gİ”©Ü
++() {

153 ià(
	g£qËn
 =ğ0è
ÿlcuÏ‹_£qu’û_Ëngth
();

154 
	gp
 +ğ
£qËn
;

155 ià(
	gp
 =ğ
’d
è
p
 = 
NULL
;

156 
	g£qËn
 = 0;

157  *
	gthis
;

164 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Utf8I‹¿tÜ
 &
Ùh”
ècÚ¡ {  
p
 == other.p; }

170 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Utf8I‹¿tÜ
 &
Ùh”
ècÚ¡ {  
p
 != other.p; }

174 
	g¡d
::
	tšput_™”©Ü_g
 
	t™”©Ü_ÿ‹gÜy
;

175 
	tv®ue_ty³
;

176 
size_t
 
	tdifã»nû_ty³
;

177 cÚ¡ * 
	tpoš‹r
;

178 cÚ¡ & 
	t»ã»nû
;

183 
Çme¥aû
 
	gUnicode
 {

187 
	gUNASSIGNED
,

188 
	gUPPERCASE_LETTER
,

189 
	gLOWERCASE_LETTER
,

190 
	gTITLECASE_LETTER
,

191 
	gMODIFIER_LETTER
,

192 
	gOTHER_LETTER
,

193 
	gNON_SPACING_MARK
,

194 
	gENCLOSING_MARK
,

195 
	gCOMBINING_SPACING_MARK
,

196 
	gDECIMAL_DIGIT_NUMBER
,

197 
	gLETTER_NUMBER
,

198 
	gOTHER_NUMBER
,

199 
	gSPACE_SEPARATOR
,

200 
	gLINE_SEPARATOR
,

201 
	gPARAGRAPH_SEPARATOR
,

202 
	gCONTROL
,

203 
	gFORMAT
,

204 
	gPRIVATE_USE
,

205 
	gSURROGATE
,

206 
	gCONNECTOR_PUNCTUATION
,

207 
	gDASH_PUNCTUATION
,

208 
	gOPEN_PUNCTUATION
,

209 
	gCLOSE_PUNCTUATION
,

210 
	gINITIAL_QUOTE_PUNCTUATION
,

211 
	gFINAL_QUOTE_PUNCTUATION
,

212 
	gOTHER_PUNCTUATION
,

213 
	gMATH_SYMBOL
,

214 
	gCURRENCY_SYMBOL
,

215 
	gMODIFIER_SYMBOL
,

216 
	gOTHER_SYMBOL


217 } 
	tÿ‹gÜy
;

219 
Çme¥aû
 
	gIÁ”Çl
 {

225 
XAPIAN_VISIBILITY_DEFAULT


226 
g‘_ch¬aù”_šfo
(
ch
);

231 
šlše
 
g‘_ÿ£_ty³
(
šfo
è{  ((
	gšfo
 & 0xe0) >> 5); }

234 
šlše
 
ÿ‹gÜy
 
g‘_ÿ‹gÜy
(
šfo
è{  
	g¡©ic_ÿ¡
<
	gÿ‹gÜy
>(
	gšfo
 & 0x1f); }

239 
šlše
 
g‘_d–
(
šfo
) {

245  (
	gšfo
 >ğ0è? (
šfo
 >> 15) : (~(~info >> 15));

258 
XAPIAN_VISIBILITY_DEFAULT


259 
nÚascii_to_utf8
(
ch
, * 
buf
);

268 
šlše
 
to_utf8
(
ch
, *
buf
) {

269 ià(
	gch
 < 128) {

270 *
	gbuf
 = 
¡©ic_ÿ¡
<>(
ch
);

273  
	gX­Ÿn
::
Unicode
::
nÚascii_to_utf8
(
ch
, 
buf
);

279 
šlše
 
­³nd_utf8
(
¡d
::
¡ršg
 &
s
, 
ch
) {

280 
	gbuf
[4];

281 
	gs
.
­³nd
(
buf
, 
to_utf8
(
ch
, buf));

285 
šlše
 
ÿ‹gÜy
 
g‘_ÿ‹gÜy
(
ch
) {

287 ià(
	gch
 >ğ0x110000è 
X­Ÿn
::
Unicode
::
UNASSIGNED
;

288  
	gIÁ”Çl
::
g‘_ÿ‹gÜy
(
IÁ”Çl
::
g‘_ch¬aù”_šfo
(
ch
));

292 
šlše
 
boŞ
 
is_wÜdch¬
(
ch
) {

293 cÚ¡ 
	gWORDCHAR_MASK
 =

294 (1 << 
X­Ÿn
::
Unicode
::
UPPERCASE_LETTER
) |

295 (1 << 
X­Ÿn
::
Unicode
::
LOWERCASE_LETTER
) |

296 (1 << 
X­Ÿn
::
Unicode
::
TITLECASE_LETTER
) |

297 (1 << 
X­Ÿn
::
Unicode
::
MODIFIER_LETTER
) |

298 (1 << 
X­Ÿn
::
Unicode
::
OTHER_LETTER
) |

299 (1 << 
X­Ÿn
::
Unicode
::
NON_SPACING_MARK
) |

300 (1 << 
X­Ÿn
::
Unicode
::
ENCLOSING_MARK
) |

301 (1 << 
X­Ÿn
::
Unicode
::
COMBINING_SPACING_MARK
) |

302 (1 << 
X­Ÿn
::
Unicode
::
DECIMAL_DIGIT_NUMBER
) |

303 (1 << 
X­Ÿn
::
Unicode
::
LETTER_NUMBER
) |

304 (1 << 
X­Ÿn
::
Unicode
::
OTHER_NUMBER
) |

305 (1 << 
X­Ÿn
::
Unicode
::
CONNECTOR_PUNCTUATION
);

306  ((
	gWORDCHAR_MASK
 >> 
g‘_ÿ‹gÜy
(
ch
)) & 1);

310 
šlše
 
boŞ
 
is_wh™e¥aû
(
ch
) {

311 cÚ¡ 
	gWHITESPACE_MASK
 =

312 (1 << 
X­Ÿn
::
Unicode
::
CONTROL
) |

313 (1 << 
X­Ÿn
::
Unicode
::
SPACE_SEPARATOR
) |

314 (1 << 
X­Ÿn
::
Unicode
::
LINE_SEPARATOR
) |

315 (1 << 
X­Ÿn
::
Unicode
::
PARAGRAPH_SEPARATOR
);

316  ((
	gWHITESPACE_MASK
 >> 
g‘_ÿ‹gÜy
(
ch
)) & 1);

320 
šlše
 
boŞ
 
is_cu¼’cy
(
ch
) {

321  (
g‘_ÿ‹gÜy
(
ch
è=ğ
X­Ÿn
::
Unicode
::
CURRENCY_SYMBOL
);

325 
šlše
 
tŞow”
(
ch
) {

326 
	gšfo
;

328 ià(
	gch
 >ğ0x110000 || !(
IÁ”Çl
::
g‘_ÿ£_ty³
((
šfo
 = 
X­Ÿn
::
Unicode
::IÁ”Çl::
g‘_ch¬aù”_šfo
(
ch
))) & 2))

329  
ch
;

330  
	gch
 + 
	gIÁ”Çl
::
g‘_d–
(
šfo
);

334 
šlše
 
touµ”
(
ch
) {

335 
	gšfo
;

337 ià(
	gch
 >ğ0x110000 || !(
IÁ”Çl
::
g‘_ÿ£_ty³
((
šfo
 = 
X­Ÿn
::
Unicode
::IÁ”Çl::
g‘_ch¬aù”_šfo
(
ch
))) & 4))

338  
ch
;

339  
	gch
 - 
	gIÁ”Çl
::
g‘_d–
(
šfo
);

343 
šlše
 
	g¡d
::
¡ršg


344 
tŞow”
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
)

346 
¡d
::
¡ršg
 
»suÉ
;

347 
	g»suÉ
.
»£rve
(
‹rm
.
size
());

348 
Utf8I‹¿tÜ
 
i
(
‹rm
); 
	gi
 != Utf8Iterator(); ++i) {

349 
­³nd_utf8
(
»suÉ
, 
tŞow”
(*
i
));

351  
	g»suÉ
;

355 
šlše
 
	g¡d
::
¡ršg


356 
touµ”
(cÚ¡ 
¡d
::
¡ršg
 &
‹rm
)

358 
¡d
::
¡ršg
 
»suÉ
;

359 
	g»suÉ
.
»£rve
(
‹rm
.
size
());

360 
Utf8I‹¿tÜ
 
i
(
‹rm
); 
	gi
 != Utf8Iterator(); ++i) {

361 
­³nd_utf8
(
»suÉ
, 
touµ”
(*
i
));

363  
	g»suÉ
;

	@include/xapian/valueiterator.h

22 #iâdeà
XAPIAN_INCLUDED_VALUEITERATOR_H


23 
	#XAPIAN_INCLUDED_VALUEITERATOR_H


	)

25 
	~<™”©Ü
>

26 
	~<¡ršg
>

28 
	~<x­Ÿn/ba£.h
>

29 
	~<x­Ÿn/d”efw¿µ”.h
>

30 
	~<x­Ÿn/ty³s.h
>

31 
	~<x­Ÿn/visib™y.h
>

33 
Çme¥aû
 
	gX­Ÿn
 {

36 şas 
	cV®ueI‹¿tÜEnd_
 { };

39 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gV®ueI‹¿tÜ
 {

40 
	gpublic
:

42 
şass
 
IÁ”Çl
;

44 
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<IÁ”Çl> 
š‹º®
;

47 
ex¶ic™
 
V®ueI‹¿tÜ
(
IÁ”Çl
 *
š‹º®_
);

50 
V®ueI‹¿tÜ
(cÚ¡ V®ueI‹¿tÜ & 
o
);

53 
V®ueI‹¿tÜ
(cÚ¡ 
V®ueI‹¿tÜEnd_
 &);

56 
	gV®ueI‹¿tÜ
 & 
	gİ”©Ü
=(cÚ¡ 
V®ueI‹¿tÜ
 & 
o
);

59 
	gV®ueI‹¿tÜ
 & 
	gİ”©Ü
=(cÚ¡ 
V®ueI‹¿tÜEnd_
 &);

66 
V®ueI‹¿tÜ
();

69 ~
V®ueI‹¿tÜ
();

72 
	g¡d
::
¡ršg
 
İ”©Ü
*() const;

75 
	gV®ueI‹¿tÜ
 & 
	gİ”©Ü
++();

78 
	gD”efW¿µ”_
<
	g¡d
::
¡ršg
> 
İ”©Ü
++() {

79 cÚ¡ 
¡d
::
¡ršg
 & 
v®ue
(**
this
);

80 
	gİ”©Ü
++();

81  
	gD”efW¿µ”_
<
	g¡d
::
¡ršg
>(
v®ue
);

89 
	gX­Ÿn
::
docid
 
g‘_docid
() const;

97 
	gX­Ÿn
::
v®u’o
 
g‘_v®u’o
() const;

115 
sk_to
(
X­Ÿn
::
docid
 
docid_Ü_¦Ù
);

139 
boŞ
 
check
(
X­Ÿn
::
docid
 docid);

142 
	g¡d
::
¡ršg
 
g‘_desütiÚ
() const;

156 
	g¡d
::
	tšput_™”©Ü_g
 
	t™”©Ü_ÿ‹gÜy
;

158 
	g¡d
::
	t¡ršg
 
	tv®ue_ty³
;

160 
	gX­Ÿn
::
	tdoccouÁ_diff
 
	tdifã»nû_ty³
;

162 
	g¡d
::
	t¡ršg
 * 
	tpoš‹r
;

164 
	g¡d
::
	t¡ršg
 & 
	t»ã»nû
;

169 
šlše
 
boŞ


170 
	gİ”©Ü
==(cÚ¡ 
V®ueI‹¿tÜ
 &
a
, cÚ¡ 
	gV®ueI‹¿tÜ
 &
	gb
)

174  
	ga
.
	gš‹º®
.
g‘
(è=ğ
b
.
š‹º®
.get();

178 
šlše
 
boŞ


179 
	gİ”©Ü
==(cÚ¡ 
V®ueI‹¿tÜ
 &
a
, cÚ¡ 
	gV®ueI‹¿tÜEnd_
 &)

181  
	ga
.
	gš‹º®
.
g‘
(è=ğ
NULL
;

185 
šlše
 
boŞ


186 
	gİ”©Ü
==(cÚ¡ 
V®ueI‹¿tÜEnd_
 &
a
, cÚ¡ 
	gV®ueI‹¿tÜ
 &
	gb
)

188  
	gb
 =ğ
a
;

192 
šlše
 
boŞ


193 
	gİ”©Ü
==(cÚ¡ 
V®ueI‹¿tÜEnd_
 &, cÚ¡ 
	gV®ueI‹¿tÜEnd_
 &)

195  
	gŒue
;

199 
šlše
 
boŞ


200 
	gİ”©Ü
!=(cÚ¡ 
V®ueI‹¿tÜ
 &
a
, cÚ¡ 
	gV®ueI‹¿tÜ
 &
	gb
)

202  !(
	ga
 =ğ
b
);

206 
šlše
 
boŞ


207 
	gİ”©Ü
!=(cÚ¡ 
V®ueI‹¿tÜ
 &
a
, cÚ¡ 
	gV®ueI‹¿tÜEnd_
 &
	gb
)

209  !(
	ga
 =ğ
b
);

213 
šlše
 
boŞ


214 
	gİ”©Ü
!=(cÚ¡ 
V®ueI‹¿tÜEnd_
 &
a
, cÚ¡ 
	gV®ueI‹¿tÜ
 &
	gb
)

216  !(
	ga
 =ğ
b
);

220 
šlše
 
boŞ


221 
	gİ”©Ü
!=(cÚ¡ 
V®ueI‹¿tÜEnd_
 &
a
, cÚ¡ 
	gV®ueI‹¿tÜEnd_
 &
	gb
)

223  !(
	ga
 =ğ
b
);

	@include/xapian/valuesetmatchdecider.h

23 #iâdeà
XAPIAN_INCLUDED_VALUESETMATCHDECIDER_H


24 
	#XAPIAN_INCLUDED_VALUESETMATCHDECIDER_H


	)

26 
	~<x­Ÿn/’quœe.h
>

27 
	~<x­Ÿn/ty³s.h
>

29 
	~<¡ršg
>

30 
	~<£t
>

32 
Çme¥aû
 
	gX­Ÿn
 {

34 
şass
 
	gDocum’t
;

39 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gV®ueS‘M©chDecid”
 : 
public
 
M©chDecid”
 {

41 
¡d
::
£t
<¡d::
¡ršg
> 
‹¡£t
;

44 
v®u’o
 
	gv®u’um
;

51 
boŞ
 
	gšşusive
;

53 
	gpublic
:

63 
V®ueS‘M©chDecid”
(
X­Ÿn
::
v®u’o
 
¦Ù
, 
boŞ
 
šşusive_
)

64 : 
v®u’um
(
¦Ù
), 
šşusive
(
šşusive_
) { }

70 
add_v®ue
(cÚ¡ 
¡d
::
¡ršg
& 
v®ue
)

72 
‹¡£t
.
š£¹
(
v®ue
);

79 
»move_v®ue
(cÚ¡ 
¡d
::
¡ršg
& 
v®ue
)

81 
‹¡£t
.
”a£
(
v®ue
);

89 
boŞ
 
İ”©Ü
()(cÚ¡ 
	gX­Ÿn
::
Docum’t
& 
doc
) const;

	@include/xapian/version.h

20 #iâdeà
XAPIAN_INCLUDED_VERSION_H


21 
	#XAPIAN_INCLUDED_VERSION_H


	)

23 #ifdeà
__GNUC__


24 #ià
__GNUC__
 < 3 || (__GNUC__ =ğ3 && 
__GNUC_MINOR__
 == 0)

25 #”rÜ 
X­Ÿn
 
no
 
lÚg”
 
suµÜts
 
GCC
 < 3.1

27 #ià!
defšed
(
__GXX_ABI_VERSION
) || __GXX_ABI_VERSION != 1002

28 #”rÜ 
The
 
C
++ 
ABI
 
v”siÚ
 
of
 
comp”
 
you
 
¬e
 
usšg
 
dÛs
 
nÙ
 
m©ch


29 #”rÜ 
th©
 
of
 
the
 
comp”
 
u£d
 
to
 
bud
h
lib¿ry
. 
The
 
v”siÚs


30 #”rÜ 
mu¡
 
m©ch
 
Ü
 
your
 
´og¿m
 
wl
 
nÙ
 
wÜk
 
cÜ»ùly
.

31 #”rÜ 
The
 
X­Ÿn
 
lib¿ry
 
was
 
but
 
w™h
 
g
++ 4.3.2

34 #ifdeà
_GLIBCXX_DEBUG


35 #”rÜ 
You
 
¬e
 
compšg
 
w™h
 
_GLIBCXX_DEBUG
 
defšed
, 
but
 
the
 
lib¿ry


36 #”rÜ 
was
 
nÙ
 
comped
 
w™h
 
this
 
æag
. 
The
 
£‰šgs
 
mu¡
 
m©ch
 
Ü
 
your


37 #”rÜ 
´og¿m
 
wl
 
nÙ
 
wÜk
 
cÜ»ùly
.

43 
	#XAPIAN_VERSION
 "1.1.4"

	)

48 
	#XAPIAN_MAJOR_VERSION
 1

	)

53 
	#XAPIAN_MINOR_VERSION
 1

	)

58 
	#XAPIAN_REVISION
 4

	)

61 
	#XAPIAN_HAS_BRASS_BACKEND
 1

	)

64 
	#XAPIAN_HAS_CHERT_BACKEND
 1

	)

67 
	#XAPIAN_HAS_FLINT_BACKEND
 1

	)

70 
	#XAPIAN_HAS_INMEMORY_BACKEND
 1

	)

73 
	#XAPIAN_HAS_REMOTE_BACKEND
 1

	)

	@include/xapian/version_h.cc

3 
	~<cÚfig.h
>

4 cÚ¡ * 
	gdummy
[] = {

26 #ifdeà
__GNUC__


47 
	#V2
(
A
,
B
è
	`J2
(A,B)

	)

48 
	#J2
(
A
,
B
è
g
++ A##.##
	)
B

49 
	#V3
(
A
,
B
,
C
è
	`J3
(A,B,C)

	)

50 
	#J3
(
A
,
B
,
C
è
g
++ A##.##B##.##
	)
C

56 #iâdeà
__GXX_ABI_VERSION


57 #”rÜ 
GCC
 
dÛs
 
nÙ
 
have
 
__GXX_ABI_VERSION
 
defšed


61 "#ià!defšed(__GXX_ABI_VERSIONè|| __GXX_ABI_VERSION !ğ",
__GXX_ABI_VERSION
,

65 #ifdeà
__GNUC_PATCHLEVEL__


66 "#”rÜ ThX­ŸÀlib¿ry wa buˆw™h ",
V3
(
__GNUC__
,
__GNUC_MINOR__
,
__GNUC_PATCHLEVEL__
),

68 "#”rÜ ThX­ŸÀlib¿ry wa buˆw™h ",
V2
(
__GNUC__
,
__GNUC_MINOR__
),

74 #ià(
__GNUC__
 =ğ3 && 
__GNUC_MINOR__
 >= 4) || __GNUC__ >= 4

75 #ifdeà
_GLIBCXX_DEBUG


94 "#defšXAPIAN_VERSION ",
STRING_VERSION
,

99 "#defšXAPIAN_MAJOR_VERSION ",
MAJOR_VERSION
,

104 "#defšXAPIAN_MINOR_VERSION ",
MINOR_VERSION
,

109 "#defšXAPIAN_REVISION ",
REVISION
,

112 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


119 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


126 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


133 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


140 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


	@include/xapian/visibility.h

20 #iâdeà
XAPIAN_INCLUDED_VISIBILITY_H


21 
	#XAPIAN_INCLUDED_VISIBILITY_H


	)

23 #ià
defšed
 
__GNUC__
 && (__GNUC__ >ğ4è&& !defšed 
XAPIAN_DISABLE_VISIBILITY


25 
	#XAPIAN_VISIBILITY_DEFAULT
 
	`__©Œibu‹__
((
	`visib™y
("deçuÉ")))

	)

27 
	#XAPIAN_VISIBILITY_DEFAULT


	)

	@include/xapian/weight.h

22 #iâdeà
XAPIAN_INCLUDED_WEIGHT_H


23 
	#XAPIAN_INCLUDED_WEIGHT_H


	)

25 
	~<¡ršg
>

27 
	~<x­Ÿn/ty³s.h
>

28 
	~<x­Ÿn/visib™y.h
>

30 
Çme¥aû
 
	gX­Ÿn
 {

33 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gWeight
 {

34 
	g´Ùeùed
:

37 
COLLECTION_SIZE
 = 1,

38 
	gRSET_SIZE
 = 2,

39 
	gAVERAGE_LENGTH
 = 4,

40 
	gTERMFREQ
 = 8,

41 
	gRELTERMFREQ
 = 16,

42 
	gQUERY_LENGTH
 = 32,

43 
	gWQF
 = 64,

44 
	gWDF
 = 128,

45 
	gDOC_LENGTH
 = 256,

46 
	gDOC_LENGTH_MIN
 = 512,

47 
	gDOC_LENGTH_MAX
 = 1024,

48 
	gWDF_MAX
 = 2048

49 } 
	t¡©_æags
;

60 
Ãed_¡©
(
¡©_æags
 
æag
) {

61 
	g¡©s_Ãeded
 = 
¡©_æags
(
¡©s_Ãeded
 | 
æag
);

68 
vœtu®
 
š™
(
çùÜ
) = 0;

70 
	g´iv©e
:

72 
İ”©Ü
=(cÚ¡ 
Weight
 &);

75 
¡©_æags
 
	g¡©s_Ãeded
;

78 
	gX­Ÿn
::
doccouÁ
 
cŞËùiÚ_size_
;

81 
	gX­Ÿn
::
doccouÁ
 
r£t_size_
;

84 
	gX­Ÿn
::
doş’gth
 
av”age_Ëngth_
;

87 
	gX­Ÿn
::
doccouÁ
 
‹rmäeq_
;

90 
	gX­Ÿn
::
doccouÁ
 
»É”mäeq_
;

93 
	gX­Ÿn
::
‹rmcouÁ
 
qu”y_Ëngth_
;

96 
	gX­Ÿn
::
‹rmcouÁ
 
wqf_
;

99 
	gX­Ÿn
::
‹rmcouÁ
 
doş’gth_low”_bound_
;

102 
	gX­Ÿn
::
‹rmcouÁ
 
doş’gth_uµ”_bound_
;

105 
	gX­Ÿn
::
‹rmcouÁ
 
wdf_uµ”_bound_
;

107 
	gpublic
:

108 
şass
 
IÁ”Çl
;

111 
	gvœtu®
 ~
Weight
();

125 
vœtu®
 
Weight
 * 
şÚe
() const = 0;

140 
vœtu®
 
	g¡d
::
¡ršg
 
Çme
() const;

147 
vœtu®
 
	g¡d
::
¡ršg
 
£rŸli£
() const;

160 
vœtu®
 
Weight
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
) const;

170 
vœtu®
 
	gX­Ÿn
::
weight
 
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
 
wdf
,

171 
X­Ÿn
::
‹rmcouÁ
 
doş’
) const = 0;

178 
vœtu®
 
	gX­Ÿn
::
weight
 
g‘_max·¹
() const = 0;

187 
vœtu®
 
	gX­Ÿn
::
weight
 
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
 
doş’
) const = 0;

195 
vœtu®
 
	gX­Ÿn
::
weight
 
g‘_maxexŒa
() const = 0;

206 
š™_
(cÚ¡ 
IÁ”Çl
 & 
¡©s
, 
X­Ÿn
::
‹rmcouÁ
 
qu”y_Ën_
,

207 cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
, 
X­Ÿn
::
‹rmcouÁ
 
wqf_
,

208 
çùÜ
);

219 
š™_
(cÚ¡ 
IÁ”Çl
 & 
¡©s
, 
X­Ÿn
::
‹rmcouÁ
 
qu”y_Ën_
,

220 
çùÜ
, 
X­Ÿn
::
doccouÁ
 
‹rmäeq
,

221 
X­Ÿn
::
doccouÁ
 
»É”mäeq
);

229 
š™_
(cÚ¡ 
IÁ”Çl
 & 
¡©s
, 
X­Ÿn
::
‹rmcouÁ
 
qu”y_Ën_
);

237 
boŞ
 
g‘_sum·¹_Ãeds_doş’gth_
() const {

238  
	g¡©s_Ãeded
 & 
	gDOC_LENGTH
;

246 
boŞ
 
g‘_sum·¹_Ãeds_wdf_
() const {

247  
	g¡©s_Ãeded
 & 
	gWDF
;

250 
	g´Ùeùed
:

252 
Weight
(const Weight &);

255 
Weight
(è: 
¡©s_Ãeded
() { }

258 
X­Ÿn
::
doccouÁ
 
g‘_cŞËùiÚ_size
(ècÚ¡ {  
cŞËùiÚ_size_
; }

261 
	gX­Ÿn
::
doccouÁ
 
g‘_r£t_size
(ècÚ¡ {  
r£t_size_
; }

264 
	gX­Ÿn
::
doş’gth
 
g‘_av”age_Ëngth
(ècÚ¡ {  
av”age_Ëngth_
; }

267 
	gX­Ÿn
::
doccouÁ
 
g‘_‹rmäeq
(ècÚ¡ {  
‹rmäeq_
; }

270 
	gX­Ÿn
::
doccouÁ
 
g‘_»É”mäeq
(ècÚ¡ {  
»É”mäeq_
; }

273 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_qu”y_Ëngth
(ècÚ¡ {  
qu”y_Ëngth_
; }

276 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_wqf
(ècÚ¡ {  
wqf_
; }

282 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth_uµ”_bound
() const {

283  
doş’gth_uµ”_bound_
;

290 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_doş’gth_low”_bound
() const {

291  
doş’gth_low”_bound_
;

298 
	gX­Ÿn
::
‹rmcouÁ
 
g‘_wdf_uµ”_bound
() const {

299  
wdf_uµ”_bound_
;

307 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gBoŞWeight
 : 
public
 
Weight
 {

308 
BoŞWeight
 * 
şÚe
() const;

310 
š™
(
çùÜ
);

312 
	gpublic
:

314 
BoŞWeight
() { }

316 
¡d
::
¡ršg
 
Çme
() const;

318 
	g¡d
::
¡ršg
 
£rŸli£
() const;

319 
BoŞWeight
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
) const;

321 
	gX­Ÿn
::
weight
 
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
 
wdf
,

322 
X­Ÿn
::
‹rmcouÁ
 
doş’
) const;

323 
	gX­Ÿn
::
weight
 
g‘_max·¹
() const;

325 
	gX­Ÿn
::
weight
 
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
 
doş’
) const;

326 
	gX­Ÿn
::
weight
 
g‘_maxexŒa
() const;

330 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gBM25Weight
 : 
public
 
Weight
 {

332 
mubË
 
X­Ÿn
::
doş’gth
 
Ën_çùÜ
;

335 
mubË
 
	gX­Ÿn
::
weight
 
‹rmweight
;

338 
	g·¿m_k1
, 
	g·¿m_k2
, 
	g·¿m_k3
, 
	g·¿m_b
;

341 
	gX­Ÿn
::
doş’gth
 
·¿m_mš_nÜmËn
;

343 
BM25Weight
 * 
şÚe
() const;

345 
š™
(
çùÜ
);

347 
	gpublic
:

375 
BM25Weight
(
k1
, 
k2
, 
k3
, 
b
, 
mš_nÜmËn
)

376 : 
·¿m_k1
(
k1
), 
·¿m_k2
(
k2
), 
·¿m_k3
(
k3
), 
·¿m_b
(
b
),

377 
·¿m_mš_nÜmËn
(
mš_nÜmËn
)

379 ià(
	g·¿m_k1
 < 0)…aram_k1 = 0;

380 ià(
	g·¿m_k2
 < 0)…aram_k2 = 0;

381 ià(
	g·¿m_k3
 < 0)…aram_k3 = 0;

382 ià(
	g·¿m_b
 < 0) {

383 
	g·¿m_b
 = 0;

384 } ià(
	g·¿m_b
 > 1) {

385 
	g·¿m_b
 = 1;

387 
Ãed_¡©
(
COLLECTION_SIZE
);

388 
Ãed_¡©
(
RSET_SIZE
);

389 
Ãed_¡©
(
TERMFREQ
);

390 
Ãed_¡©
(
RELTERMFREQ
);

391 
Ãed_¡©
(
WDF
);

392 
Ãed_¡©
(
WDF_MAX
);

393 
Ãed_¡©
(
WDF
);

394 ià(
	g·¿m_k2
 !ğ0 || (
·¿m_k1
 !ğ0 && 
·¿m_b
 != 0)) {

395 
Ãed_¡©
(
DOC_LENGTH_MIN
);

396 
Ãed_¡©
(
AVERAGE_LENGTH
);

398 ià(
	g·¿m_k1
 !ğ0 && 
·¿m_b
 !ğ0è
Ãed_¡©
(
DOC_LENGTH
);

399 ià(
	g·¿m_k2
 !ğ0è
Ãed_¡©
(
QUERY_LENGTH
);

400 ià(
	g·¿m_k3
 !ğ0è
Ãed_¡©
(
WQF
);

403 
BM25Weight
()

404 : 
·¿m_k1
(1), 
·¿m_k2
(0), 
·¿m_k3
(1), 
·¿m_b
(0.5),

405 
·¿m_mš_nÜmËn
(0.5)

407 
Ãed_¡©
(
COLLECTION_SIZE
);

408 
Ãed_¡©
(
RSET_SIZE
);

409 
Ãed_¡©
(
TERMFREQ
);

410 
Ãed_¡©
(
RELTERMFREQ
);

411 
Ãed_¡©
(
WDF
);

412 
Ãed_¡©
(
WDF_MAX
);

413 
Ãed_¡©
(
WDF
);

414 
Ãed_¡©
(
DOC_LENGTH_MIN
);

415 
Ãed_¡©
(
AVERAGE_LENGTH
);

416 
Ãed_¡©
(
DOC_LENGTH
);

417 
Ãed_¡©
(
WQF
);

420 
	g¡d
::
¡ršg
 
Çme
() const;

422 
	g¡d
::
¡ršg
 
£rŸli£
() const;

423 
BM25Weight
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
) const;

425 
	gX­Ÿn
::
weight
 
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
 
wdf
,

426 
X­Ÿn
::
‹rmcouÁ
 
doş’
) const;

427 
	gX­Ÿn
::
weight
 
g‘_max·¹
() const;

429 
	gX­Ÿn
::
weight
 
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
 
doş’
) const;

430 
	gX­Ÿn
::
weight
 
g‘_maxexŒa
() const;

442 şas 
	cXAPIAN_VISIBILITY_DEFAULT
 
	gT¿dWeight
 : 
public
 
Weight
 {

444 
mubË
 
X­Ÿn
::
doş’gth
 
Ën_çùÜ
;

447 
mubË
 
	gX­Ÿn
::
weight
 
‹rmweight
;

450 
	g·¿m_k
;

452 
T¿dWeight
 * 
şÚe
() const;

454 
š™
(
çùÜ
);

456 
	gpublic
:

464 
ex¶ic™
 
T¿dWeight
(
k
 = 1.0è: 
·¿m_k
(k) {

465 ià(
·¿m_k
 < 0)…aram_k = 0;

466 ià(
	g·¿m_k
 != 0.0) {

467 
Ãed_¡©
(
AVERAGE_LENGTH
);

468 
Ãed_¡©
(
DOC_LENGTH
);

470 
Ãed_¡©
(
COLLECTION_SIZE
);

471 
Ãed_¡©
(
RSET_SIZE
);

472 
Ãed_¡©
(
TERMFREQ
);

473 
Ãed_¡©
(
RELTERMFREQ
);

474 
Ãed_¡©
(
DOC_LENGTH_MIN
);

475 
Ãed_¡©
(
WDF
);

476 
Ãed_¡©
(
WDF_MAX
);

477 
Ãed_¡©
(
WDF
);

480 
	g¡d
::
¡ršg
 
Çme
() const;

482 
	g¡d
::
¡ršg
 
£rŸli£
() const;

483 
T¿dWeight
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
) const;

485 
	gX­Ÿn
::
weight
 
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
 
wdf
,

486 
X­Ÿn
::
‹rmcouÁ
 
doş’
) const;

487 
	gX­Ÿn
::
weight
 
g‘_max·¹
() const;

489 
	gX­Ÿn
::
weight
 
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
 
doş’
) const;

490 
	gX­Ÿn
::
weight
 
g‘_maxexŒa
() const;

	@languages/allsnowballheaders.h

22 #iâdeà
XAPIAN_INCLUDED_ALLSNOWBALLHEADERS_H


23 
	#XAPIAN_INCLUDED_ALLSNOWBALLHEADERS_H


	)

25 
	~"Ïnguages/dªish.h
"

26 
	~"Ïnguages/dutch.h
"

27 
	~"Ïnguages/’glish.h
"

28 
	~"Ïnguages/fšnish.h
"

29 
	~"Ïnguages/ä’ch.h
"

30 
	~"Ïnguages/g”mª.h
"

31 
	~"Ïnguages/g”mª2.h
"

32 
	~"Ïnguages/hung¬Ÿn.h
"

33 
	~"Ïnguages/™®Ÿn.h
"

34 
	~"Ïnguages/k¿aij_pohlmªn.h
"

35 
	~"Ïnguages/lovšs.h
"

36 
	~"Ïnguages/nÜwegŸn.h
"

37 
	~"Ïnguages/pÜ‹r.h
"

38 
	~"Ïnguages/pÜtugue£.h
"

39 
	~"Ïnguages/romªŸn.h
"

40 
	~"Ïnguages/russŸn.h
"

41 
	~"Ïnguages/¥ªish.h
"

42 
	~"Ïnguages/swedish.h
"

43 
	~"Ïnguages/turkish.h
"

45 
	#LANGSTRING
 "dªish dutchƒnglish fšnish f»nch g”mª g”mª2 hung¬ŸÀ™®ŸÀk¿aij_pohlmªÀlovš nÜwegŸÀpÜ‹¸pÜtugue£„omªŸÀrussŸÀ¥ªish swedishurkish"

	)

	@languages/compiler/analyser.c

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<¡ršg.h
>

5 
	~"h—d”.h
"

9 
»ad_´og¿m_
(
ª®y£r
 * 
a
, 
‹rmš©Ü
);

10 
node
 * 
»ad_C
(
ª®y£r
 * 
a
);

11 
node
 * 
C_¡yË
(
ª®y£r
 * 
a
, * 
s
, 
tok’
);

14 
	$çuÉ
(
n
è{ 
	`årštf
(
¡d”r
, "çuÉ %d\n",‚); 
	`ex™
(1); 
	}
}

16 
	$´št_node_
(
node
 * 
p
, 
n
, * 
s
) {

18 
i
;

19 
i
 = 0; i < 
n
; i++è
	`åuts
(˜=ğÀ- 1 ? 
s
 : " ", 
¡dout
);

20 
	`´štf
("% ", 
	`Çme_of_tok’
(
p
->
ty³
));

21 
	`uÆess
 (
p
->
Çme
 =ğ0è
	`»pÜt_b
(
¡dout
,…->Çme->
b
);

22 
	`uÆess
 (
p
->
l™”®¡ršg
 == 0) {

23 
	`´štf
("'");

24 
	`»pÜt_b
(
¡dout
, 
p
->
l™”®¡ršg
);

25 
	`´štf
("'");

27 
	`´štf
("\n");

28 
	`uÆess
 (
p
->
AE
 =ğ0è
	`´št_node_
Õ->AE, 
n
+1, "# ");

29 
	`uÆess
 (
p
->
Ëá
 =ğ0è
	`´št_node_
Õ->Ëá, 
n
+1, " ");

30 
	`uÆess
 (
p
->
right
 =ğ0è
	`´št_node_
Õ->right, 
n
, " ");

31 ià(
p
->
aux
 !ğ0è
	`´št_node_
Õ->aux, 
n
+1, "@ ");

32 
	}
}

34 
	$´št_´og¿m
(
ª®y£r
 * 
a
) {

35 
	`´št_node_
(
a
->
´og¿m
, 0, " ");

36 
	}
}

38 
node
 * 
	$Ãw_node
(
ª®y£r
 * 
a
, 
ty³
) {

39 
	`NEW
(
node
, 
p
);

40 
p
->
Ãxt
 = 
a
->
nodes
;‡->nodes =…;

41 
p
->
Ëá
 = 0;

42 
p
->
right
 = 0;

43 
p
->
aux
 = 0;

44 
p
->
AE
 = 0;

45 
p
->
Çme
 = 0;

46 
p
->
l™”®¡ršg
 = 0;

47 
p
->
mode
 = 
a
->mode;

48 
p
->
lše_numb”
 = 
a
->
tok’i£r
->line_number;

49 
p
->
ty³
 =ype;

50  
p
;

51 
	}
}

53 * 
	$Çme_of_mode
(
n
) {

54 
n
) {

55 : 
	`çuÉ
(0);

56 
m_backw¬d
:  "string backward";

57 
m_fÜw¬d
:  "string forward";

60 
	}
}

62 * 
	$Çme_of_ty³
(
n
) {

63 
n
) {

64 : 
	`çuÉ
(1);

71 
	}
}

73 
	$couÁ_”rÜ
(
ª®y£r
 * 
a
) {

74 
tok’i£r
 * 
t
 = 
a
->tokeniser;

75 ià(
t
->
”rÜ_couÁ
 >ğ20è{ 
	`årštf
(
¡d”r
, "...ƒtc\n"); 
	`ex™
(1); }

76 
t
->
”rÜ_couÁ
++;

77 
	}
}

79 
	$”rÜ2
(
ª®y£r
 * 
a
, 
n
, 
x
) {

80 
tok’i£r
 * 
t
 = 
a
->tokeniser;

81 
	`couÁ_”rÜ
(
a
);

82 
	`årštf
(
¡d”r
, "Lš%d", 
t
->
lše_numb”
);

83 ià(
t
->
g‘_d•th
 > 0è
	`årštf
(
¡d”r
, " (of included file)");

84 
	`årštf
(
¡d”r
, ": ");

85 ià(
n
 >ğ30è
	`»pÜt_b
(
¡d”r
, 
t
->
b
);

86 
n
) {

88 
	`årštf
(
¡d”r
, "% om™‹d", 
	`Çme_of_tok’
(
t
->
omissiÚ
)); ;

90 
	`årštf
(
¡d”r
, "in‡mong(...), ");

92 
	`årštf
(
¡d”r
, "uÃx³ùed %s", 
	`Çme_of_tok’
(
t
->
tok’
));

93 ià(
t
->
tok’
 =ğ
c_numb”
è
	`årštf
(
¡d”r
, " %d",->
numb”
);

94 ià(
t
->
tok’
 =ğ
c_Çme
) {

95 
	`årštf
(
¡d”r
, " ");

96 
	`»pÜt_b
(
¡d”r
, 
t
->
b
);

99 
	`årštf
(
¡d”r
, "string omitted"); ;

102 
	`årštf
(
¡d”r
, "uÄesŞved sub¡ršg oÀlš%d", 
x
); ;

104 
	`årštf
(
¡d”r
, "% nÙ‡Îowed insid»v”£(...)", 
	`Çme_of_tok’
(
t
->
tok’
)); ;

106 
	`årštf
(
¡d”r
, "empty grouping"); ;

108 
	`årštf
(
¡d”r
, "backwards used when‡lready inhis mode"); ;

110 
	`årštf
(
¡d”r
, "empty‡mong(...)"); ;

112 
	`årštf
(
¡d”r
, "two‡djacent bracketedƒxpressions in‡mong(...)"); ;

114 
	`årštf
(
¡d”r
, "sub¡ršg…»ûded by‡nÙh” sub¡ršg oÀlš%d", 
x
); ;

117 
	`årštf
(
¡d”r
, "„e-declared"); ;

119 
	`årštf
(
¡d”r
, " undeclared"); ;

121 
	`årštf
(
¡d”r
, " declared‡s %s mode; used‡s %s mode",

122 
	`Çme_of_mode
(
a
->
mode
),‚ame_of_mode(
x
)); ;

124 
	`årštf
(
¡d”r
, "‚Ù oàty³ %s", 
	`Çme_of_ty³
(
x
)); ;

126 
	`årštf
(
¡d”r
, "‚ot ofype string or integer"); ;

128 
	`årštf
(
¡d”r
, " misplaced"); ;

130 
	`årštf
(
¡d”r
, "„edefined"); ;

132 
	`årštf
(
¡d”r
, " mis-used‡s %s mode",

133 
	`Çme_of_mode
(
x
)); ;

135 
	`årštf
(
¡d”r
, "ƒ¼Ü %d", 
n
); ;

138 ià(
n
 <ğ13 && 
t
->
´evious_tok’
 > 0)

139 
	`årštf
(
¡d”r
, "‡á” %s", 
	`Çme_of_tok’
(
t
->
´evious_tok’
));

140 
	`årštf
(
¡d”r
, "\n");

141 
	}
}

143 
	$”rÜ
(
ª®y£r
 * 
a
, 
n
è{ 
	`”rÜ2
×,‚, 0); 
	}
}

145 
	$”rÜ3
(
ª®y£r
 * 
a
, 
node
 * 
p
, 
symbŞ
 * 
b
) {

146 
	`couÁ_”rÜ
(
a
);

147 
	`årštf
(
¡d”r
, "amÚg(...èÚ†š%d ha »³©ed sŒšg '", 
p
->
lše_numb”
);

148 
	`»pÜt_b
(
¡d”r
, 
b
);

149 
	`årštf
(
¡d”r
, "'\n");

150 
	}
}

152 
	$”rÜ4
(
ª®y£r
 * 
a
, 
Çme
 * 
q
) {

153 
	`couÁ_”rÜ
(
a
);

154 
	`»pÜt_b
(
¡d”r
, 
q
->
b
);

155 
	`årštf
(
¡d”r
, " undefined\n");

156 
	}
}

158 
	$omissiÚ_”rÜ
(
ª®y£r
 * 
a
, 
n
) {

159 
a
->
tok’i£r
->
omissiÚ
 = 
n
;

160 
	`”rÜ
(
a
, 0);

161 
	}
}

163 
	$check_tok’
(
ª®y£r
 * 
a
, 
code
) {

164 
tok’i£r
 * 
t
 = 
a
->tokeniser;

165 ià(
t
->
tok’
 !ğ
code
è{ 
	`omissiÚ_”rÜ
(
a
, code);  
çl£
; }

166  
Œue
;

167 
	}
}

169 
	$g‘_tok’
(
ª®y£r
 * 
a
, 
code
) {

170 
tok’i£r
 * 
t
 = 
a
->tokeniser;

171 
	`»ad_tok’
(
t
);

173 
x
 = 
	`check_tok’
(
a
, 
code
);

174 
	`uÆess
 (
x
è
t
->
tok’_h–d
 = 
Œue
;

175  
x
;

177 
	}
}

179 
Çme
 * 
	$look_fÜ_Çme
(
ª®y£r
 * 
a
) {

180 
Çme
 * 
p
 = 
a
->
Çmes
;

181 
symbŞ
 * 
q
 = 
a
->
tok’i£r
->
b
;

182 
»³©
 {

183 ià(
p
 == 0)  0;

184 { 
symbŞ
 * 
b
 = 
p
->b;

185 
n
 = 
	`SIZE
(
b
);

186 ià(
n
 =ğ
	`SIZE
(
q
è&& 
	`memcmp
(q, 
b
,‚ * (
symbŞ
)) == 0) {

187 
p
->
»ã»nûd
 = 
Œue
;

188  
p
;

191 
p
 =…->
Ãxt
;

193 
	}
}

195 
Çme
 * 
	$fšd_Çme
(
ª®y£r
 * 
a
) {

196 
Çme
 * 
p
 = 
	`look_fÜ_Çme
(
a
);

197 ià(
p
 =ğ0è
	`”rÜ
(
a
, 31);

198  
p
;

199 
	}
}

201 
	$check_routše_mode
(
ª®y£r
 * 
a
, 
Çme
 * 
p
, 
mode
) {

202 ià(
p
->
mode
 < 0)…->mode = mode; 

203 
	`uÆess
 (
p
->
mode
 =ğmodeè
	`”rÜ2
(
a
, 37, mode);

204 
	}
}

206 
	$check_Çme_ty³
(
ª®y£r
 * 
a
, 
Çme
 * 
p
, 
ty³
) {

207 
ty³
) {

208 's': ià(
p
->
ty³
 =ğ
t_¡ršg
) ; ;

209 'i': ià(
p
->
ty³
 =ğ
t_š‹g”
) ; ;

210 'b': ià(
p
->
ty³
 =ğ
t_boŞ—n
) ; ;

211 'R': ià(
p
->
ty³
 =ğ
t_groupšg
) ;

212 'r': ià(
p
->
ty³
 =ğ
t_routše
 ||

213 
p
->
ty³
 =ğ
t_ex‹º®
) ; ;

214 'g': ià(
p
->
ty³
 =ğ
t_groupšg
) ; ;

216 
	`”rÜ2
(
a
, 33, 
ty³
);

217 
	}
}

219 
	$»ad_Çmes
(
ª®y£r
 * 
a
, 
ty³
) {

220 
tok’i£r
 * 
t
 = 
a
->tokeniser;

221 
	`uÆess
 (
	`g‘_tok’
(
a
, 
c_b¿
)) ;

222 
»³©
 {

223 ià(
	`»ad_tok’
(
t
è!ğ
c_Çme
) ;

224 ià(
	`look_fÜ_Çme
(
a
è!ğ0è
	`”rÜ
(a, 30); {

225 
	`NEW
(
Çme
, 
p
);

226 
p
->
b
 = 
	`cİy_b
(
t
->b);

227 
p
->
ty³
 =ype;

228 
p
->
mode
 = -1;

229 
p
->
couÁ
 = 
a
->
Çme_couÁ
[
ty³
];

230 
p
->
»ã»nûd
 = 
çl£
;

231 
p
->
u£d
 = 
çl£
;

232 
p
->
groupšg
 = 0;

233 
p
->
defš™iÚ
 = 0;

234 
p
->
routše_ÿÎed_äom_amÚg
 = 
çl£
;

235 
a
->
Çme_couÁ
[
ty³
] ++;

236 
p
->
Ãxt
 = 
a
->
Çmes
;

237 
a
->
Çmes
 = 
p
;

240 
	`uÆess
 (
	`check_tok’
(
a
, 
c_k‘
)è
t
->
tok’_h–d
 = 
Œue
;

241 
	}
}

243 
symbŞ
 * 
	$Ãw_l™”®¡ršg
(
ª®y£r
 * 
a
) {

244 
	`NEW
(
l™”®¡ršg
, 
p
);

245 
p
->
b
 = 
	`cİy_b
(
a
->
tok’i£r
->b);

246 
p
->
Ãxt
 = 
a
->
l™”®¡ršgs
;

247 
a
->
l™”®¡ršgs
 = 
p
;

248  
p
->
b
;

249 
	}
}

251 
	$»ad_AE_‹¡
(
ª®y£r
 * 
a
) {

253 
tok’i£r
 * 
t
 = 
a
->tokeniser;

254 
	`»ad_tok’
(
t
)) {

255 
c_assign
:  
c_m©hassign
;

256 
c_¶u§ssign
:

257 
c_mšu§ssign
:

258 
c_muÉlyassign
:

259 
c_divid—ssign
:

260 
c_eq
:

261 
c_Ã
:

262 
c_gr
:

263 
c_ge
:

264 
c_ls
:

265 
c_Ë
:  
t
->
tok’
;

266 : 
	`”rÜ
(
a
, 1); 
t
->
tok’_h–d
 = 
Œue
;  
c_eq
;

268 
	}
}

270 
	$bšdšg
(
t
) {

271 
t
) {

272 
c_¶us
: 
c_mšus
:  1;

273 
c_muÉly
: 
c_divide
:  2;

276 
	}
}

278 
	$Çme_to_node
(
ª®y£r
 * 
a
, 
node
 * 
p
, 
ty³
) {

279 
Çme
 * 
q
 = 
	`fšd_Çme
(
a
);

280 
	`uÆess
 (
q
 == 0) {

281 
	`check_Çme_ty³
(
a
, 
q
, 
ty³
);

282 
q
->
u£d
 = 
Œue
;

284 
p
->
Çme
 = 
q
;

285 
	}
}

287 
node
 * 
	$»ad_AE
(
ª®y£r
 * 
a
, 
B
) {

288 
tok’i£r
 * 
t
 = 
a
->tokeniser;

289 
node
 * 
p
;

290 
node
 * 
q
;

291 
	`»ad_tok’
(
t
)) {

292 
c_mšus
:

293 
p
 = 
	`Ãw_node
(
a
, 
c_Ãg
);

294 
p
->
right
 = 
	`»ad_AE
(
a
, 100);

296 
c_b¿
:

297 
p
 = 
	`»ad_AE
(
a
, 0);

298 
	`g‘_tok’
(
a
, 
c_k‘
);

300 
c_Çme
:

301 
p
 = 
	`Ãw_node
(
a
, 
c_Çme
);

302 
	`Çme_to_node
(
a
, 
p
, 'i');

304 
c_maxšt
:

305 
c_mššt
:

306 
c_cursÜ
:

307 
c_lim™
:

308 
c_size
:

309 
p
 = 
	`Ãw_node
(
a
, 
t
->
tok’
);

311 
c_numb”
:

312 
p
 = 
	`Ãw_node
(
a
, 
c_numb”
);

313 
p
->
numb”
 = 
t
->number;

315 
c_sizeof
:

316 
p
 = 
	`C_¡yË
(
a
, "s", 
c_sizeof
);

319 
	`”rÜ
(
a
, 1);

320 
t
->
tok’_h–d
 = 
Œue
;

323 
»³©
 {

324 
tok’
 = 
	`»ad_tok’
(
t
);

325 
b
 = 
	`bšdšg
(
tok’
);

326 
	`uÆess
 (
	`bšdšg
(
tok’
è> 
B
) {

327 
t
->
tok’_h–d
 = 
Œue
;

328  
p
;

330 
q
 = 
	`Ãw_node
(
a
, 
tok’
);

331 
q
->
Ëá
 = 
p
;

332 
q
->
right
 = 
	`»ad_AE
(
a
, 
b
);

333 
p
 = 
q
;

335 
	}
}

337 
node
 * 
	$»ad_C_cÚÃùiÚ
(
ª®y£r
 * 
a
, 
node
 * 
q
, 
İ
) {

338 
tok’i£r
 * 
t
 = 
a
->tokeniser;

339 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
İ
);

340 
node
 * 
p_’d
 = 
q
;

341 
p
->
Ëá
 = 
q
;

342 
»³©
 {

343 
q
 = 
	`»ad_C
(
a
);

344 
p_’d
->
right
 = 
q
;…_end = q;

345 ià(
	`»ad_tok’
(
t
è!ğ
İ
) {

346 
t
->
tok’_h–d
 = 
Œue
;

350  
p
;

351 
	}
}

353 
node
 * 
	$»ad_C_li¡
(
ª®y£r
 * 
a
) {

354 
tok’i£r
 * 
t
 = 
a
->tokeniser;

355 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
c_b¿
);

356 
node
 * 
p_’d
 = 0;

357 
»³©
 {

358 
tok’
 = 
	`»ad_tok’
(
t
);

359 ià(
tok’
 =ğ
c_k‘
è 
p
;

360 ià(
tok’
 < 0è{ 
	`omissiÚ_”rÜ
(
a
, 
c_k‘
);  
p
; }

361 
t
->
tok’_h–d
 = 
Œue
;

363 
node
 * 
q
 = 
	`»ad_C
(
a
);

364 
»³©
 {

365 
tok’
 = 
	`»ad_tok’
(
t
);

366 ià(
tok’
 !ğ
c_ªd
 &&ok’ !ğ
c_Ü
) {

367 
t
->
tok’_h–d
 = 
Œue
;

370 
q
 = 
	`»ad_C_cÚÃùiÚ
(
a
, q, 
tok’
);

372 ià(
p_’d
 =ğ0è
p
->
Ëá
 = 
q
; p_’d->
right
 = q;

373 
p_’d
 = 
q
;

376 
	}
}

378 
node
 * 
	$C_¡yË
(
ª®y£r
 * 
a
, * 
s
, 
tok’
) {

379 
i
;

380 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
tok’
);

381 
i
 = 0; 
s
[i] != 0; i++) s[i]) {

383 
p
->
Ëá
 = 
	`»ad_C
(
a
); ;

385 
p
->
aux
 = 
	`»ad_C
(
a
); ;

387 
p
->
AE
 = 
	`»ad_AE
(
a
, 0); ;

389 
	`g‘_tok’
(
a
, 
c_fÜ
); ;

392 
¡r_tok’
 = 
	`»ad_tok’
(
a
->
tok’i£r
);

393 ià(
¡r_tok’
 =ğ
c_Çme
è
	`Çme_to_node
(
a
, 
p
, 's'); 

394 ià(
¡r_tok’
 =ğ
c_l™”®¡ršg
è
p
->
l™”®¡ršg
 = 
	`Ãw_l™”®¡ršg
(
a
);

395 
	`”rÜ
(
a
, 2);

401 ià(
	`g‘_tok’
(
a
, 
c_Çme
)è
	`Çme_to_node
×, 
p
, 
s
[
i
]);

404  
p
;

405 
	}
}

407 
node
 * 
	$»ad_l™”®¡ršg
(
ª®y£r
 * 
a
) {

408 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
c_l™”®¡ršg
);

409 
p
->
l™”®¡ršg
 = 
	`Ãw_l™”®¡ršg
(
a
);

410  
p
;

411 
	}
}

413 
	$»v”£_b
(
symbŞ
 * 
b
) {

414 
i
 = 0; 
j
 = 
	`SIZE
(
b
) - 1;

415 
	`uÁ
 (
i
 >ğ
j
) {

416 
ch1
 = 
b
[
i
]; 
ch2
 = b[
j
];

417 
b
[
i
++] = 
ch2
; b[
j
--] = 
ch1
;

419 
	}
}

421 
	$com·»_amÚgvec
(cÚ¡ *
pv
, cÚ¡ *
qv
) {

422 cÚ¡ 
amÚgvec
 * 
p
 = (cÚ¡ amÚgvec*)
pv
;

423 cÚ¡ 
amÚgvec
 * 
q
 = (cÚ¡ amÚgvec*)
qv
;

424 
symbŞ
 * 
b_p
 = 
p
->
b
; 
p_size
 =…->
size
;

425 
symbŞ
 * 
b_q
 = 
q
->
b
; 
q_size
 = q->
size
;

426 
sm®Ër_size
 = 
p_size
 < 
q_size
 ?…_size : q_size;

427 
i
;

428 
i
 = 0; i < 
sm®Ër_size
; i++)

429 ià(
b_p
[
i
] !ğ
b_q
[i])  b_p[i] - b_q[i];

430  
p_size
 - 
q_size
;

431 
	}
}

433 
	$make_amÚg
(
ª®y£r
 * 
a
, 
node
 * 
p
, nod* 
sub¡ršg
) {

435 
	`NEW
(
amÚg
, 
x
);

436 
	`NEWVEC
(
amÚgvec
, 
v
, 
p
->
numb”
);

437 
node
 * 
q
 = 
p
->
Ëá
;

438 
amÚgvec
 * 
w0
 = 
v
;

439 
amÚgvec
 * 
w1
 = 
v
;

440 
»suÉ
 = 1;

442 
dœeùiÚ
 = 
sub¡ršg
 !ğ0 ? sub¡ršg->
mode
 : 
p
->mode;

443 
backw¬d
 = 
dœeùiÚ
 =ğ
m_backw¬d
;

445 ià(
a
->
amÚgs
 =ğ0èa->amÚg ğ
x
; a->
amÚgs_’d
->
Ãxt
 = x;

446 
a
->
amÚgs_’d
 = 
x
;

447 
x
->
Ãxt
 = 0;

448 
x
->
b
 = 
v
;

449 
x
->
numb”
 = 
a
->
amÚg_couÁ
++;

450 
x
->
¡¬‹r
 = 0;

452 ià(
q
->
ty³
 =ğ
c_b¿
è{ 
x
->
¡¬‹r
 = q; q = q->
right
; }

454 
	`uÁ
 (
q
 == 0) {

455 ià(
q
->
ty³
 =ğ
c_l™”®¡ršg
) {

456 
symbŞ
 * 
b
 = 
q
->
l™”®¡ršg
;

457 
w1
->
b
 = b;

458 
w1
->
p
 = 0;

459 
w1
->
size
 = 
	`SIZE
(
b
);

460 
w1
->
i
 = -1;

461 
w1
->
»suÉ
 = -1;

462 
w1
->
funùiÚ
 = 
q
->
Ëá
 =ğ0 ? 0 : q->Ëá->
Çme
;

463 
	`uÆess
 (
w1
->
funùiÚ
 == 0) {

464 
	`check_routše_mode
(
a
, 
w1
->
funùiÚ
, 
dœeùiÚ
);

465 
w1
->
funùiÚ
->
routše_ÿÎed_äom_amÚg
 = 
Œue
;

467 
w1
++;

470 ià(
q
->
Ëá
 == 0)

471 
w0
 = 
w1
;

473 
	`uÁ
 (
w0
 =ğ
w1
) {

474 
w0
->
p
 = 
q
;

475 
w0
->
»suÉ
 =„esult;

476 
w0
++;

478 
»suÉ
++;

480 
q
 = q->
right
;

482 
	`uÆess
 (
w1
-
v
 =ğ
p
->
numb”
è{ 
	`årštf
(
¡d”r
, "oh! %d %d\n", ()(w1-v),…->numb”); 
	`ex™
(1); }

483 ià(
backw¬d
è
w0
 = 
v
; w0 < 
w1
; w0++è
	`»v”£_b
(w0->
b
);

484 
	`qsÜt
(
v
, 
w1
 - v, (
amÚgvec
), 
com·»_amÚgvec
);

487 
w0
 = 
w1
 - 1; w0 >ğ
v
; w0--) {

488 
symbŞ
 * 
b
 = 
w0
->b;

489 
size
 = 
w0
->size;

490 
amÚgvec
 * 
w
;

492 
w
 = 
w0
 - 1; w >ğ
v
; w--) {

493 ià(
w
->
size
 < siz&& 
	`memcmp
(w->
b
, b, w->siz* (
symbŞ
)) == 0) {

494 
w0
->
i
 = 
w
 - 
v
;

499 ià(
backw¬d
è
w0
 = 
v
; w0 < 
w1
; w0++è
	`»v”£_b
(w0->
b
);

501 
w0
 = 
v
; w0 < 
w1
 - 1; w0++)

502 ià(
w0
->
size
 == (w0 + 1)->size &&

503 
	`memcmp
(
w0
->
b
, (w0 + 1)->b, w0->
size
 * (
symbŞ
)è=ğ0è
	`”rÜ3
(
a
, 
p
, w0->b);

505 
x
->
l™”®¡ršg_couÁ
 = 
p
->
numb”
;

506 
x
->
commªd_couÁ
 = 
»suÉ
 - 1;

507 
p
->
amÚg
 = 
x
;

509 
x
->
sub¡ršg
 = substring;

510 ià(
sub¡ršg
 !ğ0èsub¡ršg->
amÚg
 = 
x
;

511 
	`uÆess
 (
x
->
commªd_couÁ
 =ğ0 && x->
¡¬‹r
 =ğ0è
a
->
amÚgv¬_Ãeded
 = 
Œue
;

512 
	}
}

514 
node
 * 
	$»ad_amÚg
(
ª®y£r
 * 
a
) {

515 
tok’i£r
 * 
t
 = 
a
->tokeniser;

516 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
c_amÚg
);

517 
node
 * 
p_’d
 = 0;

518 
´evious_tok’
 = -1;

519 
node
 * 
sub¡ršg
 = 
a
->substring;

521 
a
->
sub¡ršg
 = 0;

522 
p
->
numb”
 = 0;

523 
	`uÆess
 (
	`g‘_tok’
(
a
, 
c_b¿
)è 
p
;

524 
»³©
 {

525 
node
 * 
q
;

526 
tok’
 = 
	`»ad_tok’
(
t
);

527 
tok’
) {

528 
c_l™”®¡ršg
:

529 
q
 = 
	`»ad_l™”®¡ršg
(
a
);

530 ià(
	`»ad_tok’
(
t
è=ğ
c_Çme
) {

531 
node
 * 
r
 = 
	`Ãw_node
(
a
, 
c_Çme
);

532 
	`Çme_to_node
(
a
, 
r
, 'r');

533 
q
->
Ëá
 = 
r
;

535 
t
->
tok’_h–d
 = 
Œue
;

536 
p
->
numb”
++; ;

537 
c_b¿
:

538 ià(
´evious_tok’
 =ğ
c_b¿
è
	`”rÜ
(
a
, 19);

539 
q
 = 
	`»ad_C_li¡
(
a
); ;

541 
	`”rÜ
(
a
, 3);

542 
c_k‘
:

543 ià(
p
->
numb”
 =ğ0è
	`”rÜ
(
a
, 18);

544 ià(
t
->
”rÜ_couÁ
 =ğ0è
	`make_amÚg
(
a
, 
p
, 
sub¡ršg
);

545  
p
;

547 
´evious_tok’
 = 
tok’
;

548 ià(
p_’d
 =ğ0è
p
->
Ëá
 = 
q
; p_’d->
right
 = q;

549 
p_’d
 = 
q
;

551 
	}
}

553 
node
 * 
	$»ad_sub¡ršg
(
ª®y£r
 * 
a
) {

555 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
c_sub¡ršg
);

556 ià(
a
->
sub¡ršg
 !ğ0è
	`”rÜ2
×, 20,‡->sub¡ršg->
lše_numb”
);

557 
a
->
sub¡ršg
 = 
p
;

558  
p
;

559 
	}
}

561 
	$check_modifyabË
(
ª®y£r
 * 
a
) {

562 
	`uÆess
 (
a
->
modifyabË
è
	`”rÜ
(a, 15);

563 
	}
}

565 
node
 * 
	$»ad_C
(
ª®y£r
 * 
a
) {

566 
tok’i£r
 * 
t
 = 
a
->tokeniser;

567 
tok’
 = 
	`»ad_tok’
(
t
);

568 
tok’
) {

569 
c_b¿
:

570  
	`»ad_C_li¡
(
a
);

571 
c_backw¬ds
:

573 
mode
 = 
a
->mode;

574 ià(
a
->
mode
 =ğ
m_backw¬d
è
	`”rÜ
(a, 17); a->mode = m_backward;

575 { 
node
 * 
p
 = 
	`C_¡yË
(
a
, "C", 
tok’
);

576 
a
->
mode
 = mode;

577  
p
;

580 
c_»v”£
:

582 
mode
 = 
a
->mode;

583 
modifyabË
 = 
a
->modifyable;

584 
a
->
modifyabË
 = 
çl£
;

585 
a
->
mode
 = mod=ğ
m_fÜw¬d
 ? 
m_backw¬d
 : m_forward;

587 
node
 * 
p
 = 
	`C_¡yË
(
a
, "C", 
tok’
);

588 
a
->
mode
 = mode;

589 
a
->
modifyabË
 = modifyable;

590  
p
;

593 
c_nÙ
:

594 
c_Œy
:

595 
c_ç
:

596 
c_‹¡
:

597 
c_do
:

598 
c_gÙo
:

599 
c_gİa¡
:

600 
c_»³©
:

601  
	`C_¡yË
(
a
, "C", 
tok’
);

602 
c_loİ
:

603 
c_©Ëa¡
:

604  
	`C_¡yË
(
a
, "AC", 
tok’
);

605 
c_£tm¬k
:

606  
	`C_¡yË
(
a
, "i", 
tok’
);

607 
c_tom¬k
:

608 
c_©m¬k
:

609 
c_hİ
:

610  
	`C_¡yË
(
a
, "A", 
tok’
);

611 
c_d–‘e
:

612 
	`check_modifyabË
(
a
);

613 
c_Ãxt
:

614 
c_tŞim™
:

615 
c_©lim™
:

616 
c_Ëá¦iû
:

617 
c_right¦iû
:

618 
c_Œue
:

619 
c_çl£
:

620 
c_debug
:

621  
	`C_¡yË
(
a
, "", 
tok’
);

622 
c_assigÁo
:

623 
c_¦iûto
:

624 
	`check_modifyabË
(
a
);

625  
	`C_¡yË
(
a
, "s", 
tok’
);

626 
c_assign
:

627 
c_š£¹
:

628 
c_©ch
:

629 
c_¦iûäom
:

630 
	`check_modifyabË
(
a
);

631  
	`C_¡yË
(
a
, "S", 
tok’
);

632 
c_£im™
:

633  
	`C_¡yË
(
a
, "CfD", 
tok’
);

634 
c_£t
:

635 
c_un£t
:

636  
	`C_¡yË
(
a
, "b", 
tok’
);

637 
c_dŞÏr
:

638 
	`g‘_tok’
(
a
, 
c_Çme
);

640 
node
 * 
p
;

641 
Çme
 * 
q
 = 
	`fšd_Çme
(
a
);

642 
mode
 = 
a
->mode;

643 
modifyabË
 = 
a
->modifyable;

644 
q
 ? q->
ty³
 : 
t_¡ršg
)

647 : 
	`”rÜ
(
a
, 34);

648 
t_¡ršg
:

649 
a
->
mode
 = 
m_fÜw¬d
;

650 
a
->
modifyabË
 = 
Œue
;

651 
p
 = 
	`Ãw_node
(
a
, 
c_dŞÏr
);

652 
p
->
Ëá
 = 
	`»ad_C
(
a
); ;

653 
t_š‹g”
:

655 
p
 = 
	`Ãw_node
(
a
, 
	`»ad_AE_‹¡
(a));

656 
p
->
AE
 = 
	`»ad_AE
(
a
, 0); ;

658 
p
->
Çme
 = 
q
;

659 
a
->
mode
 = mode;

660 
a
->
modifyabË
 = modifyable;

661  
p
;

663 
c_Çme
:

665 
Çme
 * 
q
 = 
	`fšd_Çme
(
a
);

666 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
c_Çme
);

667 
	`uÆess
 (
q
 == 0) {

668 
q
->
u£d
 = 
Œue
;

669 
q
->
ty³
) {

670 
t_boŞ—n
:

671 
p
->
ty³
 = 
c_boŞ‹¡
; ;

672 
t_š‹g”
:

673 
	`”rÜ
(
a
, 35);

674 
t_¡ršg
:

676 
t_routše
:

677 
t_ex‹º®
:

678 
p
->
ty³
 = 
c_ÿÎ
;

679 
	`check_routše_mode
(
a
, 
q
,‡->
mode
);

681 
t_groupšg
:

682 
p
->
ty³
 = 
c_groupšg
; ;

685 
p
->
Çme
 = 
q
;

686  
p
;

688 
c_nÚ
:

690 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
tok’
);

691 
	`»ad_tok’
(
t
);

692 ià(
t
->
tok’
 =ğ
c_mšus
è
	`»ad_tok’
(t);

693 
	`uÆess
 (
	`check_tok’
(
a
, 
c_Çme
)è{ 
	`omissiÚ_”rÜ
×, c_Çme);  
p
; }

694 
	`Çme_to_node
(
a
, 
p
, 'g');

695  
p
;

697 
c_l™”®¡ršg
:

698  
	`»ad_l™”®¡ršg
(
a
);

699 
c_amÚg
:  
	`»ad_amÚg
(
a
);

700 
c_sub¡ršg
:  
	`»ad_sub¡ršg
(
a
);

701 : 
	`”rÜ
(
a
, 1);  0;

703 
	}
}

705 
	$Ãxt_symbŞ
(
symbŞ
 * 
p
, symbŞ * 
W
, 
utf8
) {

706 ià(
utf8
) {

707 
ch
;

708 
j
 = 
	`g‘_utf8
(
p
, & 
ch
);

709 
W
[0] = 
ch
;  
j
;

711 
W
[0] = 
p
[0];  1;

713 
	}
}

715 
symbŞ
 * 
	$®‹r_groupšg
(
symbŞ
 * 
p
, symbŞ * 
q
, 
¡yË
, 
utf8
) {

716 
j
 = 0;

717 
symbŞ
 
W
[1];

718 
width
;

719 ià(
¡yË
 =ğ
c_¶us
) {

720 
j
 < 
	`SIZE
(
q
)) {

721 
width
 = 
	`Ãxt_symbŞ
(
q
 + 
j
, 
W
, 
utf8
);

722 
p
 = 
	`add_to_b
Õ, 1, 
W
);

723 
j
 +ğ
width
;

726 
j
 < 
	`SIZE
(
q
)) {

727 
i
;

728 
width
 = 
	`Ãxt_symbŞ
(
q
 + 
j
, 
W
, 
utf8
);

729 
i
 = 0; i < 
	`SIZE
(
p
); i++) {

730 ià(
p
[
i
] =ğ
W
[0]) {

731 
	`memmove
(
p
 + 
i
,… + i + 1, (
	`SIZE
Õè- i - 1è* (
symbŞ
));

732 
	`SIZE
(
p
)--;

735 
j
 +ğ
width
;

738  
p
;

739 
	}
}

741 
	$»ad_defše_groupšg
(
ª®y£r
 * 
a
, 
Çme
 * 
q
) {

742 
tok’i£r
 * 
t
 = 
a
->tokeniser;

743 
¡yË
 = 
c_¶us
;

745 
	`NEW
(
groupšg
, 
p
);

746 ià(
a
->
groupšgs
 =ğ0èa->groupšg ğ
p
; a->
groupšgs_’d
->
Ãxt
 =…;

747 
a
->
groupšgs_’d
 = 
p
;

748 
q
->
groupšg
 = 
p
;

749 
p
->
Ãxt
 = 0;

750 
p
->
Çme
 = 
q
;

751 
p
->
numb”
 = 
q
->
couÁ
;

752 
p
->
b
 = 
	`ü—‹_b
(0);

753 
»³©
 {

754 
	`»ad_tok’
(
t
)) {

755 
c_Çme
:

757 
Çme
 * 
r
 = 
	`fšd_Çme
(
a
);

758 
	`uÆess
 (
r
 == 0) {

759 
	`check_Çme_ty³
(
a
, 
r
, 'g');

760 
p
->
b
 = 
	`®‹r_groupšg
Õ->b, 
r
->
groupšg
->b, 
¡yË
, 
çl£
);

764 
c_l™”®¡ršg
:

765 
p
->
b
 = 
	`®‹r_groupšg
Õ->b, 
t
->b, 
¡yË
, 
a
->
utf8
);

767 : 
	`”rÜ
(
a
, 1); ;

769 
	`»ad_tok’
(
t
)) {

770 
c_¶us
:

771 
c_mšus
: 
¡yË
 = 
t
->
tok’
; ;

772 : 
Ïb–0
;

775 
Ïb–0
:

777 
i
;

778 
max
 = 0;

779 
mš
 = 1<<16;

780 
i
 = 0; i < 
	`SIZE
(
p
->
b
); i++) {

781 ià(
p
->
b
[
i
] > 
max
) max =…->b[i];

782 ià(
p
->
b
[
i
] < 
mš
) min =…->b[i];

784 
p
->
Ïrge¡_ch
 = 
max
;

785 
p
->
sm®Ë¡_ch
 = 
mš
;

786 ià(
mš
 =ğ1<<16è
	`”rÜ
(
a
, 16);

788 
t
->
tok’_h–d
 = 
Œue
; ;

790 
	}
}

792 
	$»ad_defše_routše
(
ª®y£r
 * 
a
, 
Çme
 * 
q
) {

793 
node
 * 
p
 = 
	`Ãw_node
(
a
, 
c_defše
);

794 
a
->
amÚgv¬_Ãeded
 = 
çl£
;

795 
	`uÆess
 (
q
 == 0) {

796 
	`check_Çme_ty³
(
a
, 
q
, 'R');

797 ià(
q
->
defš™iÚ
 !ğ0è
	`”rÜ
(
a
, 36);

798 ià(
q
->
mode
 < 0èq->modğ
a
->mode; 

799 ià(
q
->
mode
 !ğ
a
->modeè
	`”rÜ2
(a, 32, q->mode);

801 
p
->
Çme
 = 
q
;

802 ià(
a
->
´og¿m
 =ğ0èa->´og¿m = 
p
; a->
´og¿m_’d
->
right
 =…;

803 
a
->
´og¿m_’d
 = 
p
;

804 
	`g‘_tok’
(
a
, 
c_as
);

805 
p
->
Ëá
 = 
	`»ad_C
(
a
);

806 
	`uÆess
 (
q
 =ğ0èq->
defš™iÚ
 = 
p
->
Ëá
;

808 ià(
a
->
sub¡ršg
 != 0) {

809 
	`”rÜ2
(
a
, 14,‡->
sub¡ršg
->
lše_numb”
);

810 
a
->
sub¡ršg
 = 0;

812 
p
->
amÚgv¬_Ãeded
 = 
a
->amongvar_needed;

813 
	}
}

815 
	$»ad_defše
(
ª®y£r
 * 
a
) {

816 
	`uÆess
 (
	`g‘_tok’
(
a
, 
c_Çme
)) ;

818 
Çme
 * 
q
 = 
	`fšd_Çme
(
a
);

819 ià(
q
 !ğ0 && q->
ty³
 =ğ
t_groupšg
è
	`»ad_defše_groupšg
(
a
, q);

820 
	`»ad_defše_routše
(
a
, 
q
);

822 
	}
}

824 
	$»ad_backw¬dmode
(
ª®y£r
 * 
a
) {

825 
mode
 = 
a
->mode;

826 
a
->
mode
 = 
m_backw¬d
;

827 ià(
	`g‘_tok’
(
a
, 
c_b¿
)) {

828 
	`»ad_´og¿m_
(
a
, 
c_k‘
);

829 
	`check_tok’
(
a
, 
c_k‘
);

831 
a
->
mode
 = mode;

832 
	}
}

834 
	$»ad_´og¿m_
(
ª®y£r
 * 
a
, 
‹rmš©Ü
) {

835 
tok’i£r
 * 
t
 = 
a
->tokeniser;

836 
»³©
 {

837 
	`»ad_tok’
(
t
)) {

838 
c_¡ršgs
: 
	`»ad_Çmes
(
a
, 
t_¡ršg
); ;

839 
c_boŞ—ns
: 
	`»ad_Çmes
(
a
, 
t_boŞ—n
); ;

840 
c_š‹g”s
: 
	`»ad_Çmes
(
a
, 
t_š‹g”
); ;

841 
c_routšes
: 
	`»ad_Çmes
(
a
, 
t_routše
); ;

842 
c_ex‹º®s
: 
	`»ad_Çmes
(
a
, 
t_ex‹º®
); ;

843 
c_groupšgs
: 
	`»ad_Çmes
(
a
, 
t_groupšg
); ;

844 
c_defše
: 
	`»ad_defše
(
a
); ;

845 
c_backw¬dmode
:
	`»ad_backw¬dmode
(
a
); ;

846 
c_k‘
:

847 ià(
‹rmš©Ü
 =ğ
c_k‘
) ;

849 
	`”rÜ
(
a
, 1); ;

851 
	`uÆess
 (
‹rmš©Ü
 < 0è
	`omissiÚ_”rÜ
(
a
, 
c_k‘
);

855 
	}
}

857 
	$»ad_´og¿m
(
ª®y£r
 * 
a
) {

858 
	`»ad_´og¿m_
(
a
, -1);

860 
Çme
 * 
q
 = 
a
->
Çmes
;

861 
	`uÁ
 (
q
 == 0) {

862 
q
->
ty³
) {

863 
t_ex‹º®
: 
t_routše
:

864 ià(
q
->
u£d
 && q->
defš™iÚ
 =ğ0è
	`”rÜ4
(
a
, q); ;

865 
t_groupšg
:

866 ià(
q
->
u£d
 && q->
groupšg
 =ğ0è
	`”rÜ4
(
a
, q); ;

868 
q
 = q->
Ãxt
;

872 ià(
a
->
tok’i£r
->
”rÜ_couÁ
 == 0) {

873 
Çme
 * 
q
 = 
a
->
Çmes
;

874 
w¬Ãd
 = 
çl£
;

875 
	`uÁ
 (
q
 == 0) {

876 
	`uÆess
 (
q
->
»ã»nûd
) {

877 
	`uÆess
 (
w¬Ãd
) {

878 
	`årštf
(
¡d”r
, "Declared but‚ot used:");

879 
w¬Ãd
 = 
Œue
;

881 
	`årštf
(
¡d”r
, " "); 
	`»pÜt_b
(¡d”r, 
q
->
b
);

883 
q
 = q->
Ãxt
;

885 ià(
w¬Ãd
è
	`årštf
(
¡d”r
, "\n");

887 
q
 = 
a
->
Çmes
;

888 
w¬Ãd
 = 
çl£
;

889 
	`uÁ
 (
q
 == 0) {

890 ià(! 
q
->
u£d
 && (q->
ty³
 =ğ
t_routše
 ||

891 
q
->
ty³
 =ğ
t_groupšg
)) {

892 
	`uÆess
 (
w¬Ãd
) {

893 
	`årštf
(
¡d”r
, "Declared‡nd defined but‚ot used:");

894 
w¬Ãd
 = 
Œue
;

896 
	`årštf
(
¡d”r
, " "); 
	`»pÜt_b
(¡d”r, 
q
->
b
);

898 
q
 = q->
Ãxt
;

900 ià(
w¬Ãd
è
	`årštf
(
¡d”r
, "\n");

902 
	}
}

904 
ª®y£r
 * 
	$ü—‹_ª®y£r
(
tok’i£r
 * 
t
) {

905 
	`NEW
(
ª®y£r
, 
a
);

906 
a
->
tok’i£r
 = 
t
;

907 
a
->
nodes
 = 0;

908 
a
->
Çmes
 = 0;

909 
a
->
l™”®¡ršgs
 = 0;

910 
a
->
´og¿m
 = 0;

911 
a
->
amÚgs
 = 0;

912 
a
->
amÚg_couÁ
 = 0;

913 
a
->
groupšgs
 = 0;

914 
a
->
mode
 = 
m_fÜw¬d
;

915 
a
->
modifyabË
 = 
Œue
;

916 { 
i
; ˜ğ0; i < 
t_size
; i++è
a
->
Çme_couÁ
[i] = 0; }

917 
a
->
sub¡ršg
 = 0;

918  
a
;

919 
	}
}

921 
	$şo£_ª®y£r
(
ª®y£r
 * 
a
) {

923 
node
 * 
q
 = 
a
->
nodes
;

924 
	`uÁ
 (
q
 == 0) {

925 
node
 * 
q_Ãxt
 = 
q
->
Ãxt
;

926 
	`FREE
(
q
);

927 
q
 = 
q_Ãxt
;

931 
Çme
 * 
q
 = 
a
->
Çmes
;

932 
	`uÁ
 (
q
 == 0) {

933 
Çme
 * 
q_Ãxt
 = 
q
->
Ãxt
;

934 
	`lo£_b
(
q
->
b
); 
	`FREE
(q);

935 
q
 = 
q_Ãxt
;

939 
l™”®¡ršg
 * 
q
 = 
a
->
l™”®¡ršgs
;

940 
	`uÁ
 (
q
 == 0) {

941 
l™”®¡ršg
 * 
q_Ãxt
 = 
q
->
Ãxt
;

942 
	`lo£_b
(
q
->
b
); 
	`FREE
(q);

943 
q
 = 
q_Ãxt
;

947 
amÚg
 * 
q
 = 
a
->
amÚgs
;

948 
	`uÁ
 (
q
 == 0) {

949 
amÚg
 * 
q_Ãxt
 = 
q
->
Ãxt
;

950 
	`FREE
(
q
->
b
); FREE(q);

951 
q
 = 
q_Ãxt
;

955 
groupšg
 * 
q
 = 
a
->
groupšgs
;

956 
	`uÁ
 (
q
 == 0) {

957 
groupšg
 * 
q_Ãxt
 = 
q
->
Ãxt
;

958 
	`lo£_b
(
q
->
b
); 
	`FREE
(q);

959 
q
 = 
q_Ãxt
;

962 
	`FREE
(
a
);

963 
	}
}

	@languages/compiler/driver.c

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<¡ršg.h
>

5 
	~"h—d”.h
"

7 
	$eq
(* 
s1
, * 
s2
) {

8 
s1_Ën
 = 
	`¡¾’
(
s1
);

9 
s2_Ën
 = 
	`¡¾’
(
s2
);

10  
s1_Ën
 =ğ
s2_Ën
 && 
	`memcmp
(
s1
, 
s2
, s1_len) == 0;

11 
	}
}

13 
	$´št_¬gli¡
() {

14 
	`årštf
(
¡d”r
, "Usage: snowball <file> [options]\n\n"

17 #iâdeà
DISABLE_JAVA


30 
	`ex™
(1);

31 
	}
}

33 
	$check_lim
(
i
, 
¬gc
) {

34 ià(
i
 >ğ
¬gc
) {

35 
	`årštf
(
¡d”r
, "argument†ist is one short\n");

36 
	`´št_¬gli¡
();

38 
	}
}

40 
FILE
 * 
	$g‘_ouut
(
symbŞ
 * 
b
) {

41 * 
s
 = 
	`b_to_s
(
b
);

42 
FILE
 * 
ouut
 = 
	`fİ’
(
s
, "w");

43 ià(
ouut
 == 0) {

44 
	`årštf
(
¡d”r
, "Cª'ˆİ’ ouuˆ%s\n", 
s
);

45 
	`ex™
(1);

47 
	`ä“
(
s
);

48  
ouut
;

49 
	}
}

51 
	$»ad_İtiÚs
(
İtiÚs
 * 
o
, 
¬gc
, * 
¬gv
[]) {

52 * 
s
;

53 
i
 = 2;

57 
o
->
ouut_fe
 = 0;

58 
o
->
syÁax_Œ“
 = 
çl£
;

59 
o
->
ex‹º®s_´efix
 = "";

60 
o
->
v¬ŸbËs_´efix
 = 0;

61 
o
->
ruÁime_·th
 = 0;

62 
o
->
·»Á_şass_Çme
 = 0;

63 
o
->
Çme
 = "";

64 
o
->
make_Ïng
 = 
LANG_C
;

65 
o
->
widech¬s
 = 
çl£
;

66 
o
->
šşudes
 = 0;

67 
o
->
šşudes_’d
 = 0;

68 
o
->
utf8
 = 
çl£
;

72 
»³©
 {

73 ià(
i
 >ğ
¬gc
) ;

74 
s
 = 
¬gv
[
i
++];

75 { ià(
	`eq
(
s
, "-o") ||ƒq(s, "-output")) {

76 
	`check_lim
(
i
, 
¬gc
);

77 
o
->
ouut_fe
 = 
¬gv
[
i
++];

80 ià(
	`eq
(
s
, "-n") ||ƒq(s, "-name")) {

81 
	`check_lim
(
i
, 
¬gc
);

82 
o
->
Çme
 = 
¬gv
[
i
++];

85 #iâdeà
DISABLE_JAVA


86 ià(
	`eq
(
s
, "-j") ||ƒq(s, "-java")) {

87 
o
->
make_Ïng
 = 
LANG_JAVA
;

88 
o
->
widech¬s
 = 
Œue
;

92 ià(
	`eq
(
s
, "-c++")) {

93 
o
->
make_Ïng
 = 
LANG_CPLUSPLUS
;

96 ià(
	`eq
(
s
, "-w") ||ƒq(s, "-widechars")) {

97 
o
->
widech¬s
 = 
Œue
;

98 
o
->
utf8
 = 
çl£
;

101 ià(
	`eq
(
s
, "-s") ||ƒq(s, "-syntax")) {

102 
o
->
syÁax_Œ“
 = 
Œue
;

105 ià(
	`eq
(
s
, "-ep") ||ƒq(s, "-eprefix")) {

106 
	`check_lim
(
i
, 
¬gc
);

107 
o
->
ex‹º®s_´efix
 = 
¬gv
[
i
++];

110 ià(
	`eq
(
s
, "-vp") ||ƒq(s, "-vprefix")) {

111 
	`check_lim
(
i
, 
¬gc
);

112 
o
->
v¬ŸbËs_´efix
 = 
¬gv
[
i
++];

115 ià(
	`eq
(
s
, "-i") ||ƒq(s, "-include")) {

116 
	`check_lim
(
i
, 
¬gc
);

119 
	`NEW
(
šşude
, 
p
);

120 
symbŞ
 * 
b
 = 
	`add_s_to_b
(0, 
¬gv
[
i
++]);

121 
b
 = 
	`add_s_to_b
(b, "/");

122 
p
->
Ãxt
 = 0;…->
b
 = b;

124 ià(
o
->
šşudes
 =ğ0èo->šşude ğ
p
; 

125 
o
->
šşudes_’d
->
Ãxt
 = 
p
;

126 
o
->
šşudes_’d
 = 
p
;

130 ià(
	`eq
(
s
, "-r") ||ƒq(s, "-runtime")) {

131 
	`check_lim
(
i
, 
¬gc
);

132 
o
->
ruÁime_·th
 = 
¬gv
[
i
++];

135 ià(
	`eq
(
s
, "-u") ||ƒq(s, "-utf8")) {

136 
o
->
utf8
 = 
Œue
;

137 
o
->
widech¬s
 = 
çl£
;

140 ià(
	`eq
(
s
, "-p") ||ƒq(s, "-parentclassname")) {

141 
	`check_lim
(
i
, 
¬gc
);

142 
o
->
·»Á_şass_Çme
 = 
¬gv
[
i
++];

145 
	`årštf
(
¡d”r
, "'%s' mi¥Ïûd\n", 
s
);

146 
	`´št_¬gli¡
();

149 
	}
}

151 
	$maš
(
¬gc
, * 
¬gv
[]) {

153 
	`NEW
(
İtiÚs
, 
o
);

154 ià(
¬gc
 =ğ1è
	`´št_¬gli¡
();

155 
	`»ad_İtiÚs
(
o
, 
¬gc
, 
¬gv
);

157 
symbŞ
 * 
f’ame
 = 
	`add_s_to_b
(0, 
¬gv
[1]);

158 
symbŞ
 * 
u
 = 
	`g‘_šput
(
f’ame
);

159 ià(
u
 == 0) {

160 
	`årštf
(
¡d”r
, "Cª'ˆİ’ iÅuˆ%s\n", 
¬gv
[1]);

161 
	`ex™
(1);

164 
tok’i£r
 * 
t
 = 
	`ü—‹_tok’i£r
(
u
);

165 
ª®y£r
 * 
a
 = 
	`ü—‹_ª®y£r
(
t
);

166 
t
->
widech¬s
 = 
o
->widechars;

167 
t
->
šşudes
 = 
o
->includes;

168 
a
->
utf8
 = 
t
->utf8 = 
o
->utf8;

169 
	`»ad_´og¿m
(
a
);

170 ià(
t
->
”rÜ_couÁ
 > 0è
	`ex™
(1);

171 ià(
o
->
syÁax_Œ“
è
	`´št_´og¿m
(
a
);

172 
	`şo£_tok’i£r
(
t
);

173 
	`uÆess
 (
o
->
syÁax_Œ“
) {

174 
g’”©Ü
 * 
g
;

176 * 
s
 = 
o
->
ouut_fe
;

177 
	`uÆess
 (
s
) {

178 
	`årštf
(
¡d”r
, "Please includehe -o option\n");

179 
	`´št_¬gli¡
();

180 
	`ex™
(1);

182 ià(
o
->
make_Ïng
 =ğ
LANG_C
 || o->make_Ïng =ğ
LANG_CPLUSPLUS
) {

183 
symbŞ
 * 
b
 = 
	`add_s_to_b
(0, 
s
);

184 
b
 = 
	`add_s_to_b
(b, ".h");

185 
o
->
ouut_h
 = 
	`g‘_ouut
(
b
);

186 
b
[
	`SIZE
(b) - 1] = 'c';

187 ià(
o
->
make_Ïng
 =ğ
LANG_CPLUSPLUS
) {

188 
b
 = 
	`add_s_to_b
(b, "c");

190 
o
->
ouut_c
 = 
	`g‘_ouut
(
b
);

191 
	`lo£_b
(
b
);

193 
g
 = 
	`ü—‹_g’”©Ü_c
(
a
, 
o
);

194 
	`g’”©e_´og¿m_c
(
g
);

195 
	`şo£_g’”©Ü_c
(
g
);

196 
	`fşo£
(
o
->
ouut_c
);

197 
	`fşo£
(
o
->
ouut_h
);

199 #iâdeà
DISABLE_JAVA


200 ià(
o
->
make_Ïng
 =ğ
LANG_JAVA
) {

201 
symbŞ
 * 
b
 = 
	`add_s_to_b
(0, 
s
);

202 
b
 = 
	`add_s_to_b
(b, ".java");

203 
o
->
ouut_java
 = 
	`g‘_ouut
(
b
);

204 
	`lo£_b
(
b
);

205 
g
 = 
	`ü—‹_g’”©Ü_java
(
a
, 
o
);

206 
	`g’”©e_´og¿m_java
(
g
);

207 
	`şo£_g’”©Ü_java
(
g
);

208 
	`fşo£
(
o
->
ouut_java
);

212 
	`şo£_ª®y£r
(
a
);

214 
	`lo£_b
(
u
);

215 
	`lo£_b
(
f’ame
);

217 { 
šşude
 * 
p
 = 
o
->
šşudes
;

218 
	`uÁ
 (
p
 == 0)

219 { 
šşude
 * 
q
 = 
p
->
Ãxt
;

220 
	`lo£_b
(
p
->
b
); 
	`FREE
Õ);… = 
q
;

223 
	`FREE
(
o
);

224 
	`uÆess
 (
¥aû_couÁ
 =ğ0è
	`årštf
(
¡d”r
, "%d blocks unfreed\n", space_count);

226 
	}
}

	@languages/compiler/generator.c

2 
	~<lim™s.h
>

3 
	~<¡dio.h
>

4 
	~<¡dlib.h
>

5 
	~<¡ršg.h
>

6 
	~"h—d”.h
"

13 
g’”©e
(
g’”©Ü
 * 
g
, 
node
 * 
p
);

15 
	e¥ecŸl_Ïb–s
 {

17 
	mx_»tuº
 = -1

21 
	$Ãw_Ïb–
(
g’”©Ü
 * 
g
) {

22  
g
->
Ãxt_Ïb–
++;

23 
	}
}

26 
	$ouut_¡r
(
FILE
 * 
outfe
, 
¡r
 * str) {

28 * 
s
 = 
	`b_to_s
(
	`¡r_d©a
(
¡r
));

29 
	`årštf
(
outfe
, "%s", 
s
);

30 
	`ä“
(
s
);

31 
	}
}

33 
	$wch
(
g’”©Ü
 * 
g
, 
ch
) {

34 
	`¡r_­³nd_ch
(
g
->
outbuf
, 
ch
);

35 
	}
}

37 
	$wÆ
(
g’”©Ü
 * 
g
) {

38 
	`¡r_­³nd_ch
(
g
->
outbuf
, '\n');

39 
g
->
lše_couÁ
++;

40 
	}
}

42 
	$ws
(
g’”©Ü
 * 
g
, cÚ¡ * 
s
) {

43 
	`¡r_­³nd_¡ršg
(
g
->
outbuf
, 
s
);

44 
	}
}

46 
	$wi
(
g’”©Ü
 * 
g
, 
i
) {

47 
	`¡r_­³nd_št
(
g
->
outbuf
, 
i
);

48 
	}
}

50 
	$wh_ch
(
g’”©Ü
 * 
g
, 
i
) {

51 
	`¡r_­³nd_ch
(
g
->
outbuf
, "0123456789ABCDEF"[
i
 & 0xF]);

52 
	}
}

54 
	$wh
(
g’”©Ü
 * 
g
, 
i
) {

55 ià(
i
 >> 4è
	`wh
(
g
, i >> 4);

56 
	`wh_ch
(
g
, 
i
);

57 
	}
}

59 
	$wi3
(
g’”©Ü
 * 
g
, 
i
) {

60 ià(
i
 < 100è
	`wch
(
g
, ' ');

61 ià(
i
 < 10è
	`wch
(
g
, ' ');

62 
	`wi
(
g
, 
i
);

63 
	}
}

65 
	$wvn
(
g’”©Ü
 * 
g
, 
Çme
 * 
p
) {

67 
ch
 = "SBIrxg"[
p
->
ty³
];

68 
p
->
ty³
) {

69 
t_ex‹º®
:

70 
	`ws
(
g
, g->
İtiÚs
->
ex‹º®s_´efix
); ;

71 
t_¡ršg
:

72 
t_boŞ—n
:

73 
t_š‹g”
:

74 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
) {

75 
	`wch
(
g
, 
ch
); wch(g, '['); 
	`wi
(g, 
p
->
couÁ
); wch(g, ']'); ;

79 
	`wch
(
g
, 
ch
); wch(g, '_');

81 
	`¡r_­³nd_b
(
g
->
outbuf
, 
p
->
b
);

82 
	}
}

84 
	$wv
(
g’”©Ü
 * 
g
, 
Çme
 * 
p
) {

85 ià(
p
->
ty³
 < 
t_routše
 && 
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
è
	`ws
(g, "z->");

86 
	`wvn
(
g
, 
p
);

87 
	}
}

89 
	$wl™¬¿y
(
g’”©Ü
 * 
g
, 
symbŞ
 * 
p
) {

92 
i
;

93 
i
 = 0; i < 
	`SIZE
(
p
); i++) {

94 
ch
 = 
p
[
i
];

95 ià(32 <ğ
ch
 && ch < 127) {

96 
	`wch
(
g
, '\'');

97 
ch
) {

99 '\\': 
	`wch
(
g
, '\\');

100 : 
	`wch
(
g
, 
ch
);

102 
	`wch
(
g
, '\'');

104 
	`wch
(
g
, '0'); wch(g, 'x'); 
	`wh
(g, 
ch
);

106 ià(
i
 < 
	`SIZE
(
p
è- 1è
	`ws
(
g
, ", ");

109 
	}
}

111 
	$wl™»f
(
g’”©Ü
 * 
g
, 
symbŞ
 * 
p
) {

113 ià(
	`SIZE
(
p
è=ğ0è
	`ws
(
g
, "0"); {

114 
¡r
 * 
s
 = 
g
->
outbuf
;

115 
g
->
outbuf
 = g->
deş¬©iÚs
;

116 
	`ws
(
g
, "¡©iøcÚ¡ symbŞ s_"); 
	`wi
(g, g->
l™”®¡ršg_couÁ
); ws(g, "[] = { ");

117 
	`wl™¬¿y
(
g
, 
p
);

118 
	`ws
(
g
, " };\n");

119 
g
->
outbuf
 = 
s
;

120 
	`ws
(
g
, "s_"); 
	`wi
(g, g->
l™”®¡ršg_couÁ
);

121 
g
->
l™”®¡ršg_couÁ
++;

123 
	}
}

126 
	$wm
(
g’”©Ü
 * 
g
) {

127 
i
;

128 
i
 = 0; i < 
g
->
m¬gš
; i++è
	`ws
(g, " ");

129 
	}
}

131 
	$wc
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

133 
	`ws
(
g
, " /* ");

134 
p
->
ty³
) {

135 
c_m©hassign
:

136 
c_¶u§ssign
:

137 
c_mšu§ssign
:

138 
c_muÉlyassign
:

139 
c_divid—ssign
:

140 
c_eq
:

141 
c_Ã
:

142 
c_gr
:

143 
c_ge
:

144 
c_ls
:

145 
c_Ë
:

146 ià(
p
->
Çme
) {

147 
	`¡r_­³nd_b
(
g
->
outbuf
, 
p
->
Çme
->
b
);

148 
	`ws
(
g
, " ");

150 
	`ws
(
g
, (*è
	`Çme_of_tok’
(
p
->
ty³
));

151 
	`ws
(
g
, " <integerƒxpression>");

154 
	`ws
(
g
, (*è
	`Çme_of_tok’
(
p
->
ty³
));

155 ià(
p
->
Çme
) {

156 
	`ws
(
g
, " ");

157 
	`¡r_­³nd_b
(
g
->
outbuf
, 
p
->
Çme
->
b
);

160 
	`ws
(
g
, ",†š"); 
	`wi
(g, 
p
->
lše_numb”
); ws(g, " */");

161 
	`wÆ
(
g
);

162 
	}
}

164 
	$wms
(
g’”©Ü
 * 
g
, cÚ¡ * 
s
) {

165 
	`wm
(
g
); 
	`ws
(g, 
s
); 
	}
}

167 
	$wbs
(
g’”©Ü
 * 
g
) {

168 
	`wms
(
g
, "{ ");

169 
g
->
m¬gš
++;

170 
	}
}

172 
	$wbe
(
g’”©Ü
 * 
g
) {

174 ià(
g
->
lše_Ïb–Ëd
 =ğg->
lše_couÁ
è{ 
	`wms
(g, ";"); 
	`wÆ
(g); }

175 
g
->
m¬gš
--;

176 
	`wms
(
g
, "}"); 
	`wÆ
(g);

177 
	}
}

179 
w
(
g’”©Ü
 * 
g
, cÚ¡ * 
s
);

181 
	$wk
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

182 ++
g
->
k“p_couÁ
;

183 ià(
p
->
mode
 =ğ
m_fÜw¬d
) {

184 
	`ws
(
g
, "šˆc"); 
	`wi
(g, g->
k“p_couÁ
); 
	`w
(g, " = ~zc;");

186 
	`ws
(
g
, "šˆm"); 
	`wi
(g, g->
k“p_couÁ
); 
	`w
(g, " = ~zl - ~zc; (void)m");

187 
	`wi
(
g
, g->
k“p_couÁ
); 
	`ws
(g, ";");

189 
	}
}

191 
	$w»¡Üe
(
g’”©Ü
 * 
g
, 
node
 * 
p
, 
k“p_tok’
) {

192 ià(
p
->
mode
 =ğ
m_fÜw¬d
) {

193 
	`w
(
g
, "~zc = c");

195 
	`w
(
g
, "~zc = ~zl - m");

197 
	`wi
(
g
, 
k“p_tok’
); 
	`ws
(g, ";");

198 
	}
}

200 
	$w»¡Ü–im™
(
g’”©Ü
 * 
g
, 
node
 * 
p
, 
k“p_tok’
) {

201 ià(
p
->
mode
 =ğ
m_fÜw¬d
) {

202 
	`w
(
g
, "~zl += mlimit");

204 
	`w
(
g
, "~zlb = mlimit");

206 
	`wi
(
g
, 
k“p_tok’
); 
	`ws
(g, ";");

207 
	}
}

209 
	$wšc
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

210 
	`w
(
g
, 
p
->
mode
 =ğ
m_fÜw¬d
 ? "~zc++;" :

212 
	}
}

214 
	$w£
(
g’”©Ü
 * 
g
, 
n
) {

216 
g
->
m¬gš
--;

217 
	`wms
(
g
, "Ïb"); 
	`wi
(g, 
n
); 
	`wch
(g, ':'); 
	`wÆ
(g);

218 
g
->
lše_Ïb–Ëd
 = g->
lše_couÁ
;

219 
g
->
m¬gš
++;

220 
	}
}

222 
	$wgÙŞ
(
g’”©Ü
 * 
g
, 
n
) {

223 
	`wms
(
g
, "gÙØÏb"); 
	`wi
(g, 
n
); 
	`wch
(g, ';'); 
	`wÆ
(g);

224 
	}
}

226 
	$wf
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

227 ià(
g
->
çu»_k“p_couÁ
 != 0) {

228 
	`ws
(
g
, "{ ");

229 ià(
g
->
çu»_k“p_couÁ
 > 0) {

230 
	`w»¡Üe
(
g
, 
p
, g->
çu»_k“p_couÁ
);

232 
	`w»¡Ü–im™
(
g
, 
p
, -g->
çu»_k“p_couÁ
);

234 
	`wch
(
g
, ' ');

236 
g
->
çu»_Ïb–
)

238 
x_»tuº
:

239 
	`ws
(
g
, "return 0;");

242 
	`ws
(
g
, "goto†ab");

243 
	`wi
(
g
, g->
çu»_Ïb–
);

244 
	`wch
(
g
, ';');

245 
g
->
Ïb–_u£d
 = 1;

247 ià(
g
->
çu»_k“p_couÁ
 !ğ0è
	`ws
(g, " }");

248 
	}
}

250 
	$wlim
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

252 
	`w
(
g
, 
p
->
mode
 =ğ
m_fÜw¬d
 ? "if (~zc >= ~zl) " :

254 
	`wf
(
g
, 
p
);

255 
	}
}

257 
	$wp
(
g’”©Ü
 * 
g
, cÚ¡ * 
s
, 
node
 * 
p
) {

258 
i
 = 0;

259 
l
 = 
	`¡¾’
(
s
);

260 
	`uÁ
 (
i
 >ğ
l
) {

261 
ch
 = 
s
[
i
++];

262 ià(
ch
 !ğ'~'è
	`wch
(
g
, ch); 

263 
s
[
i
++]) {

264 : 
	`wch
(
g
, 
s
[
i
 - 1]); ;

265 'C': 
	`wc
(
g
, 
p
); ;

266 'k': 
	`wk
(
g
, 
p
); ;

267 'i': 
	`wšc
(
g
, 
p
); ;

268 'l': 
	`wlim
(
g
, 
p
); ;

269 'f': 
	`wf
(
g
, 
p
); ;

270 'M': 
	`wm
(
g
); ;

271 'N': 
	`wÆ
(
g
); ;

272 '{': 
	`wbs
(
g
); ;

273 '}': 
	`wbe
(
g
); ;

274 'S': 
	`ws
(
g
, g->
S
[
s
[
i
++] - '0']); ;

275 'I': 
	`wi
(
g
, g->
I
[
s
[
i
++] - '0']); ;

276 'J': 
	`wi3
(
g
, g->
I
[
s
[
i
++] - '0']); ;

277 'V': 
	`wv
(
g
, g->
V
[
s
[
i
++] - '0']); ;

278 'W': 
	`wvn
(
g
, g->
V
[
s
[
i
++] - '0']); ;

279 'L': 
	`wl™»f
(
g
, g->
L
[
s
[
i
++] - '0']); ;

280 'A': 
	`wl™¬¿y
(
g
, g->
L
[
s
[
i
++] - '0']); ;

281 '+': 
g
->
m¬gš
++; ;

282 '-': 
g
->
m¬gš
--; ;

284 
	`wch
(
g
, 
p
->
l™”®¡ršg
 == 0 ? 'v' : 's');

286 'p': 
	`ws
(
g
, g->
İtiÚs
->
ex‹º®s_´efix
); ;

288 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
è
	`ws
(g, "z->");

291 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
è
	`ws
(g, 
s
[
i
] == ')' ? "z" : "z, ");

295 
	}
}

297 
	$w
(
g’”©Ü
 * 
g
, cÚ¡ * 
s
è{ 
	`wp
(g, s, 0); 
	}
}

299 
	$g’”©e_AE
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

300 * 
s
;

301 
p
->
ty³
) {

302 
c_Çme
:

303 
	`wv
(
g
, 
p
->
Çme
); ;

304 
c_numb”
:

305 
	`wi
(
g
, 
p
->
numb”
); ;

306 
c_maxšt
:

307 
	`ws
(
g
, "MAXINT"); ;

308 
c_mššt
:

309 
	`ws
(
g
, "MININT"); ;

310 
c_Ãg
:

311 
	`wch
(
g
, '-'); 
	`g’”©e_AE
(g, 
p
->
right
); ;

312 
c_muÉly
:

313 
s
 = " * "; 
Ïb–0
;

314 
c_¶us
:

315 
s
 = " + "; 
Ïb–0
;

316 
c_mšus
:

317 
s
 = " - "; 
Ïb–0
;

318 
c_divide
:

319 
s
 = " / ";

320 
Ïb–0
:

321 
	`wch
(
g
, '('); 
	`g’”©e_AE
(g, 
p
->
Ëá
);

322 
	`ws
(
g
, 
s
); 
	`g’”©e_AE
(g, 
p
->
right
); 
	`wch
(g, ')'); ;

323 
c_sizeof
:

324 
g
->
V
[0] = 
p
->
Çme
;

325 
	`w
(
g
, "SIZE(~V0)"); ;

326 
c_cursÜ
:

327 
	`w
(
g
, "~zc"); ;

328 
c_lim™
:

329 
	`w
(
g
, 
p
->
mode
 =ğ
m_fÜw¬d
 ? "~zl" : "~zlb"); ;

330 
c_size
:

331 
	`w
(
g
, "SIZE(~zp)"); ;

334 
	}
}

341 
	$K_Ãeded
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

342 
	`uÁ
 (
p
 == 0) {

343 
p
->
ty³
) {

344 
c_dŞÏr
:

345 
c_Ëá¦iû
:

346 
c_right¦iû
:

347 
c_m©hassign
:

348 
c_¶u§ssign
:

349 
c_mšu§ssign
:

350 
c_muÉlyassign
:

351 
c_divid—ssign
:

352 
c_eq
:

353 
c_Ã
:

354 
c_gr
:

355 
c_ge
:

356 
c_ls
:

357 
c_Ë
:

358 
c_¦iûto
:

359 
c_Œue
:

360 
c_çl£
:

361 
c_debug
:

364 
c_ÿÎ
:

365 ià(
	`K_Ãeded
(
g
, 
p
->
Çme
->
defš™iÚ
)è 
Œue
;

368 
c_b¿
:

369 ià(
	`K_Ãeded
(
g
, 
p
->
Ëá
)è 
Œue
;

372 :  
Œue
;

374 
p
 =…->
right
;

376  
çl£
;

377 
	}
}

379 
	$»³©_scÜe
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

380 
scÜe
 = 0;

381 
	`uÁ
 (
p
 == 0)

383 
p
->
ty³
) {

384 
c_dŞÏr
:

385 
c_Ëá¦iû
:

386 
c_right¦iû
:

387 
c_m©hassign
:

388 
c_¶u§ssign
:

389 
c_mšu§ssign
:

390 
c_muÉlyassign
:

391 
c_divid—ssign
:

392 
c_eq
:

393 
c_Ã
:

394 
c_gr
:

395 
c_ge
:

396 
c_ls
:

397 
c_Ë
:

398 
c_¦iûto
:

399 
c_debug
:

402 
c_ÿÎ
:

403 
scÜe
 +ğ
	`»³©_scÜe
(
g
, 
p
->
Çme
->
defš™iÚ
);

406 
c_b¿
:

407 
scÜe
 +ğ
	`»³©_scÜe
(
g
, 
p
->
Ëá
);

410 
c_Çme
:

411 
c_l™”®¡ršg
:

412 
c_Ãxt
:

413 
c_groupšg
:

414 
c_nÚ
:

415 
c_hİ
:

416 
scÜe
 = score + 1; ;

418 : 
scÜe
 = 2; ;

420 
p
 =…->
right
;

422  
scÜe
;

423 
	}
}

427 
	$»³©_»¡Üe
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

428  
	`»³©_scÜe
(
g
, 
p
) >= 2;

429 
	}
}

431 
	$g’”©e_b¿
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

432 
p
 =…->
Ëá
;

433 
	`uÁ
 (
p
 =ğ0è{ 
	`g’”©e
(
g
,…);… =…->
right
; }

434 
	}
}

436 
	$g’”©e_ªd
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

437 
k“p_c
 = 0;

438 ià(
	`K_Ãeded
(
g
, 
p
->
Ëá
)) {

439 
	`wp
(
g
, "~{~k~C", 
p
);

440 
k“p_c
 = 
g
->
k“p_couÁ
;

442 
	`wp
(
g
, "~M~C", 
p
);

444 
p
 =…->
Ëá
;

445 
	`uÁ
 (
p
 == 0) {

446 
	`g’”©e
(
g
, 
p
);

447 ià(
k“p_c
 && 
p
->
right
 != 0) {

448 
	`w
(
g
, "~M"); 
	`w»¡Üe
(g, 
p
, 
k“p_c
); w(g, "~N");

450 
p
 =…->
right
;

452 ià(
k“p_c
è
	`w
(
g
, "~}");

453 
	}
}

455 
	$g’”©e_Ü
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

456 
k“p_c
 = 0;

458 
u£d
 = 
g
->
Ïb–_u£d
;

459 
a0
 = 
g
->
çu»_Ïb–
;

460 
a1
 = 
g
->
çu»_k“p_couÁ
;

462 
out_Ïb
 = 
	`Ãw_Ïb–
(
g
);

464 ià(
	`K_Ãeded
(
g
, 
p
->
Ëá
)) {

465 
	`wp
(
g
, "~{~k~C", 
p
);

466 
k“p_c
 = 
g
->
k“p_couÁ
;

468 
	`wp
(
g
, "~M~C", 
p
);

470 
p
 =…->
Ëá
;

471 
g
->
çu»_k“p_couÁ
 = 0;

472 
	`uÁ
 (
p
->
right
 == 0) {

473 
g
->
çu»_Ïb–
 = 
	`Ãw_Ïb–
(g);

474 
g
->
Ïb–_u£d
 = 0;

475 
	`g’”©e
(
g
, 
p
);

476 
	`wgÙŞ
(
g
, 
out_Ïb
);

477 ià(
g
->
Ïb–_u£d
)

478 
	`w£
(
g
, g->
çu»_Ïb–
);

479 ià(
k“p_c
) {

480 
	`w
(
g
, "~M"); 
	`w»¡Üe
(g, 
p
, 
k“p_c
); w(g, "~N");

482 
p
 =…->
right
;

484 
g
->
Ïb–_u£d
 = 
u£d
;

485 
g
->
çu»_Ïb–
 = 
a0
;

486 
g
->
çu»_k“p_couÁ
 = 
a1
;

488 
	`g’”©e
(
g
, 
p
);

489 ià(
k“p_c
è
	`w
(
g
, "~}");

490 
	`w£
(
g
, 
out_Ïb
);

491 
	}
}

493 
	$g’”©e_backw¬ds
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

495 
	`wp
(
g
,"~M~zlb = ~zc; ~zøğ~zl;~C~N", 
p
);

496 
	`g’”©e
(
g
, 
p
->
Ëá
);

497 
	`w
(
g
, "~M~zc = ~zlb;~N");

498 
	}
}

501 
	$g’”©e_nÙ
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

502 
k“p_c
 = 0;

504 
u£d
 = 
g
->
Ïb–_u£d
;

505 
a0
 = 
g
->
çu»_Ïb–
;

506 
a1
 = 
g
->
çu»_k“p_couÁ
;

508 ià(
	`K_Ãeded
(
g
, 
p
->
Ëá
)) {

509 
	`wp
(
g
, "~{~k~C", 
p
);

510 
k“p_c
 = 
g
->
k“p_couÁ
;

512 
	`wp
(
g
, "~M~C", 
p
);

515 
g
->
çu»_Ïb–
 = 
	`Ãw_Ïb–
(g);

516 
g
->
Ïb–_u£d
 = 0;

517 
g
->
çu»_k“p_couÁ
 = 0;

518 
	`g’”©e
(
g
, 
p
->
Ëá
);

521 
l
 = 
g
->
çu»_Ïb–
;

522 
u
 = 
g
->
Ïb–_u£d
;

524 
g
->
Ïb–_u£d
 = 
u£d
;

525 
g
->
çu»_Ïb–
 = 
a0
;

526 
g
->
çu»_k“p_couÁ
 = 
a1
;

528 
	`wp
(
g
, "~M~f~N", 
p
);

529 ià(
u
)

530 
	`w£
(
g
, 
l
);

532 ià(
k“p_c
) {

533 
	`w
(
g
, "~M"); 
	`w»¡Üe
(g, 
p
, 
k“p_c
); w(g, "~N~}");

535 
	}
}

538 
	$g’”©e_Œy
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

539 
k“p_c
 = 0;

540 ià(
	`K_Ãeded
(
g
, 
p
->
Ëá
)) {

541 
	`wp
(
g
, "~{~k~C", 
p
);

542 
k“p_c
 = 
g
->
k“p_couÁ
;

544 
	`wp
(
g
, "~-~M ~+~C", 
p
);

546 
g
->
çu»_k“p_couÁ
 = 
k“p_c
;

548 
g
->
çu»_Ïb–
 = 
	`Ãw_Ïb–
(g);

549 
g
->
Ïb–_u£d
 = 0;

550 
	`g’”©e
(
g
, 
p
->
Ëá
);

552 ià(
g
->
Ïb–_u£d
)

553 
	`w£
(
g
, g->
çu»_Ïb–
);

555 ià(
k“p_c
è
	`w
(
g
, "~}");

556 
	}
}

558 
	$g’”©e_£t
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

559 
g
->
V
[0] = 
p
->
Çme
; 
	`wp
(g, "~M~V0 = 1;~C",…);

560 
	}
}

562 
	$g’”©e_un£t
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

563 
g
->
V
[0] = 
p
->
Çme
; 
	`wp
(g, "~M~V0 = 0;~C",…);

564 
	}
}

566 
	$g’”©e_ç
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

567 
	`g’”©e
(
g
, 
p
->
Ëá
);

568 
	`wp
(
g
, "~M~f~C", 
p
);

569 
	}
}

573 
	$g’”©e_‹¡
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

574 
k“p_c
 = 0;

575 ià(
	`K_Ãeded
(
g
, 
p
->
Ëá
)) {

576 
k“p_c
 = ++
g
->
k“p_couÁ
;

577 
	`w
(
g
, 
p
->
mode
 =ğ
m_fÜw¬d
 ? "~{int c_test" :

579 
	`wi
(
g
, 
k“p_c
);

580 
	`w
(
g
, 
p
->
mode
 =ğ
m_fÜw¬d
 ? " = ~zc;" :

582 
	`wp
(
g
, "~C", 
p
);

583 } 
	`wp
(
g
, "~M~C", 
p
);

585 
	`g’”©e
(
g
, 
p
->
Ëá
);

587 ià(
k“p_c
) {

588 
	`w
(
g
, 
p
->
mode
 =ğ
m_fÜw¬d
 ? "~M~zc = c_test" :

590 
	`wi
(
g
, 
k“p_c
);

591 
	`wp
(
g
, ";~N~}", 
p
);

593 
	}
}

595 
	$g’”©e_do
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

596 
k“p_c
 = 0;

597 ià(
	`K_Ãeded
(
g
, 
p
->
Ëá
)) {

598 
	`wp
(
g
, "~{~k~C", 
p
);

599 
k“p_c
 = 
g
->
k“p_couÁ
;

601 
	`wp
(
g
, "~M~C", 
p
);

604 
g
->
çu»_Ïb–
 = 
	`Ãw_Ïb–
(g);

605 
g
->
Ïb–_u£d
 = 0;

606 
g
->
çu»_k“p_couÁ
 = 0;

607 
	`g’”©e
(
g
, 
p
->
Ëá
);

609 ià(
g
->
Ïb–_u£d
)

610 
	`w£
(
g
, g->
çu»_Ïb–
);

611 ià(
k“p_c
) {

612 
	`w
(
g
, "~M"); 
	`w»¡Üe
(g, 
p
, 
k“p_c
);

613 
	`w
(
g
, "~N~}");

615 
	}
}

617 
	$g’”©e_Ãxt
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

618 ià(
g
->
İtiÚs
->
utf8
) {

619 ià(
p
->
mode
 =ğ
m_fÜw¬d
)

620 
	`w
(
g
, "~{int„et = skip_utf8(~zp, ~zc, 0, ~zl, 1");

622 
	`w
(
g
, "~{int„et = skip_utf8(~zp, ~zc, ~zlb, 0, -1");

623 
	`wp
(
g
, ");~N"

626 "~}", 
p
);

628 
	`wp
(
g
, "~M~l~N"

629 "~M~i~C", 
p
);

630 
	}
}

632 
	$g’”©e_GO_groupšg
(
g’”©Ü
 * 
g
, 
node
 * 
p
, 
is_gÙo
, 
com¶em’t
) {

634 
groupšg
 * 
q
 = 
p
->
Çme
->grouping;

635 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "" : "_b";

636 
g
->
S
[1] = 
com¶em’t
 ? "in" : "out";

637 
g
->
S
[2] = g->
İtiÚs
->
utf8
 ? "_U" : "";

638 
g
->
V
[0] = 
p
->
Çme
;

639 
g
->
I
[0] = 
q
->
sm®Ë¡_ch
;

640 
g
->
I
[1] = 
q
->
Ïrge¡_ch
;

641 ià(
is_gÙo
) {

642 
	`wp
(
g
, "~Mià(~S1_groupšg~S0~S2(~Z~V0, ~I0, ~I1, 1è< 0è~à/* gÙØ*/~C", 
p
);

644 
	`wp
(
g
, "~{int„et = ~S1_grouping~S0~S2(~Z~V0, ~I0, ~I1, 1); /* gopast */~C"

645 "~MiàÔ‘ < 0è~f~N", 
p
);

646 ià(
p
->
mode
 =ğ
m_fÜw¬d
)

647 
	`w
(
g
, "~M~zc +=„et;~N");

649 
	`w
(
g
, "~M~zc -=„et;~N");

650 
	`w
(
g
, "~}");

652 
	}
}

654 
	$g’”©e_GO
(
g’”©Ü
 * 
g
, 
node
 * 
p
, 
¡yË
) {

655 
k“p_c
 = 0;

657 
u£d
 = 
g
->
Ïb–_u£d
;

658 
a0
 = 
g
->
çu»_Ïb–
;

659 
a1
 = 
g
->
çu»_k“p_couÁ
;

661 ià(
p
->
Ëá
->
ty³
 =ğ
c_groupšg
 ||…->Ëá->ty³ =ğ
c_nÚ
) {

665 #ifdeà
OPTIMISATION_WARNINGS


666 
	`´štf
("O±imisšg % %s\n", 
¡yË
 ? "gÙo" : "gİa¡", 
p
->
Ëá
->
ty³
 =ğ
c_nÚ
 ? "non" : "grouping");

668 
	`g’”©e_GO_groupšg
(
g
, 
p
->
Ëá
, 
¡yË
,…->Ëá->
ty³
 =ğ
c_nÚ
);

672 
	`w
(
g
, "~Mwhe(1è{"); 
	`wp
(g, "~C~+", 
p
);

674 ià(
¡yË
 =ğ1 || 
	`»³©_»¡Üe
(
g
, 
p
->
Ëá
)) {

675 
	`wp
(
g
, "~M~k~N", 
p
);

676 
k“p_c
 = 
g
->
k“p_couÁ
;

679 
g
->
çu»_Ïb–
 = 
	`Ãw_Ïb–
(g);

680 
g
->
Ïb–_u£d
 = 0;

681 
	`g’”©e
(
g
, 
p
->
Ëá
);

683 ià(
¡yË
 == 1) {

685 
	`w
(
g
, "~M"); 
	`w»¡Üe
(g, 
p
, 
k“p_c
); w(g, "~N");

687 
	`w
(
g
, "~Mbreak;~N");

688 ià(
g
->
Ïb–_u£d
)

689 
	`w£
(
g
, g->
çu»_Ïb–
);

690 ià(
k“p_c
) {

691 
	`w
(
g
, "~M"); 
	`w»¡Üe
(g, 
p
, 
k“p_c
); w(g, "~N");

694 
g
->
Ïb–_u£d
 = 
u£d
;

695 
g
->
çu»_Ïb–
 = 
a0
;

696 
g
->
çu»_k“p_couÁ
 = 
a1
;

700 
	`g’”©e_Ãxt
(
g
, 
p
);

701 
	`w
(
g
, "~}");

702 
	}
}

704 
	$g’”©e_loİ
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

705 
	`w
(
g
, "~{šˆi; fÜ (˜ğ"); 
	`g’”©e_AE
(g, 
p
->
AE
); 
	`wp
(g, "; i > 0; i--)~C"

706 "~{", 
p
);

708 
	`g’”©e
(
g
, 
p
->
Ëá
);

710 
	`w
(
g
, "~}"

712 
	}
}

714 
	$g’”©e_»³©
(
g’”©Ü
 * 
g
, 
node
 * 
p
, 
©Ëa¡_ÿ£
) {

715 
k“p_c
 = 0;

716 
	`wp
(
g
, "~Mwhe(1è{~C~+", 
p
);

718 ià(
	`»³©_»¡Üe
(
g
, 
p
->
Ëá
)) {

719 
	`wp
(
g
, "~M~k~N", 
p
);

720 
k“p_c
 = 
g
->
k“p_couÁ
;

723 
g
->
çu»_Ïb–
 = 
	`Ãw_Ïb–
(g);

724 
g
->
Ïb–_u£d
 = 0;

725 
g
->
çu»_k“p_couÁ
 = 0;

726 
	`g’”©e
(
g
, 
p
->
Ëá
);

728 ià(
©Ëa¡_ÿ£
è
	`w
(
g
, "~Mi--;~N");

730 
	`w
(
g
, "~Mcontinue;~N");

731 ià(
g
->
Ïb–_u£d
)

732 
	`w£
(
g
, g->
çu»_Ïb–
);

734 ià(
k“p_c
) {

735 
	`w
(
g
, "~M"); 
	`w»¡Üe
(g, 
p
, 
k“p_c
); w(g, "~N");

738 
	`w
(
g
, "~Mbreak;~N"

740 
	}
}

742 
	$g’”©e_©Ëa¡
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

743 
	`w
(
g
, "~{šˆ˜ğ"); 
	`g’”©e_AE
(g, 
p
->
AE
); w(g, ";~N");

745 
u£d
 = 
g
->
Ïb–_u£d
;

746 
a0
 = 
g
->
çu»_Ïb–
;

747 
a1
 = 
g
->
çu»_k“p_couÁ
;

749 
	`g’”©e_»³©
(
g
, 
p
, 
Œue
);

751 
g
->
Ïb–_u£d
 = 
u£d
;

752 
g
->
çu»_Ïb–
 = 
a0
;

753 
g
->
çu»_k“p_couÁ
 = 
a1
;

755 
	`wp
(
g
, "~Mif (i > 0) ~f~N"

756 "~}", 
p
);

757 
	}
}

759 
	$g’”©e_£tm¬k
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

760 
g
->
V
[0] = 
p
->
Çme
;

761 
	`wp
(
g
, "~M~V0 = ~zc;~C", 
p
);

762 
	}
}

764 
	$g’”©e_tom¬k
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

765 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? ">" : "<";

767 
	`w
(
g
, "~Mià(~zø~S0 "); 
	`g’”©e_AE
(g, 
p
->
AE
); 
	`wp
(g, ") ~f~N",…);

768 
	`w
(
g
, "~M~zøğ"); 
	`g’”©e_AE
(g, 
p
->
AE
); 
	`wp
(g, ";~C",…);

769 
	}
}

771 
	$g’”©e_©m¬k
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

773 
	`w
(
g
, "~Mià(~zø!ğ"); 
	`g’”©e_AE
(g, 
p
->
AE
); 
	`wp
(g, ") ~f~C",…);

774 
	}
}

776 
	$g’”©e_hİ
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

777 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "+" : "-";

778 
g
->
S
[1] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "0" :

779 (
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
 ? "z->lb" : "lb");

780 ià(
g
->
İtiÚs
->
utf8
) {

781 
	`w
(
g
, "~{int„et = skip_utf8(~zp, ~zc, ~S1, ~zl, ~S0 ");

782 
	`g’”©e_AE
(
g
, 
p
->
AE
); 
	`wp
(g, ");~C",…);

783 
	`wp
(
g
, "~MiàÔ‘ < 0è~f~N", 
p
);

785 
	`w
(
g
, "~{int„et = ~zc ~S0 ");

786 
	`g’”©e_AE
(
g
, 
p
->
AE
); 
	`wp
(g, ";~C",…);

787 
	`wp
(
g
, "~Mià(~S1 >„‘ ||„‘ > ~zlè~f~N", 
p
);

789 
	`wp
(
g
, "~M~zc =„et;~N"

790 "~}", 
p
);

791 
	}
}

793 
	$g’”©e_d–‘e
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

795 
	`wp
(
g
, "~Mià(¦iû_d–(~Zè=ğ-1è»tuº -1;~C", 
p
);

797 
	`wp
(
g
, "~{šˆ»ˆğ¦iû_d–(~Z);~C", 
p
);

798 
	`wp
(
g
, "~Mif (ret < 0)„eturn„et;~N"

799 "~}", 
p
);

801 
	}
}

803 
	$g’”©e_tŞim™
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

804 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "" : "b";

805 
	`wp
(
g
, "~M~zøğ~zl~S0;~C", 
p
);

806 
	}
}

808 
	$g’”©e_©lim™
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

809 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "" : "b";

810 
g
->
S
[1] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "<" : ">";

811 
	`wp
(
g
, "~Mià(~zø~S1 ~zl~S0è~f~C", 
p
);

812 
	}
}

814 
	$g’”©e_Ëá¦iû
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

815 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "bra" : "ket";

816 
	`wp
(
g
, "~M~z~S0 = ~zc;~C", 
p
);

817 
	}
}

819 
	$g’”©e_right¦iû
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

820 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "ket" : "bra";

821 
	`wp
(
g
, "~M~z~S0 = ~zc;~C", 
p
);

822 
	}
}

824 
	$g’”©e_assigÁo
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

825 
g
->
V
[0] = 
p
->
Çme
;

826 
	`wp
(
g
, "~M~V0 =‡ssign_to(~Z~V0);~C", 
p
);

827 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

828 
	`wp
(
g
, "~Mià(~V0 =ğ0è»tuº -1;~C", 
p
);

829 
	}
}

831 
	$g’”©e_¦iûto
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

832 
g
->
V
[0] = 
p
->
Çme
;

833 
	`wp
(
g
, "~{symbol *„et = slice_to(~Z~V0);~C"

836 "~}", 
p
);

837 
	}
}

839 
	$g’”©e_d©a_add»ss
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

841 
symbŞ
 * 
b
 = 
p
->
l™”®¡ršg
;

842 ià(
b
 != 0) {

843 
	`wi
(
g
, 
	`SIZE
(
b
)); 
	`w
(g, ", ");

844 
	`wl™»f
(
g
, 
b
);

846 
	`wv
(
g
, 
p
->
Çme
);

847 
	}
}

849 
	$g’”©e_š£¹
(
g’”©Ü
 * 
g
, 
node
 * 
p
, 
¡yË
) {

851 
k“p_c
 = 
¡yË
 =ğ
c_©ch
;

852 ià(
p
->
mode
 =ğ
m_backw¬d
è
k“p_c
 = !keep_c;

853 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

854 
	`wp
(
g
, "~{šˆ»t;~N", 
p
);

855 ià(
k“p_c
è
	`w
(
g
, "~{int saved_c = ~zc;~N");

856 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

857 
	`wp
(
g
, "~M»ˆğš£¹_~$(~Z~zc, ~zc, ", 
p
);

859 
	`wp
(
g
, "~Mš£¹_~$(~Z~zc, ~zc, ", 
p
);

860 
	`g’”©e_d©a_add»ss
(
g
, 
p
);

861 
	`wp
(
g
, ");~C", 
p
);

862 ià(
k“p_c
è
	`w
(
g
, "~M~zc = saved_c;~N~}");

863 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

864 
	`wp
(
g
, "~Mif (ret < 0)„eturn„et;~N"

865 "~}", 
p
);

866 
	}
}

868 
	$g’”©e_assignäom
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

870 
k“p_c
 = 
p
->
mode
 =ğ
m_fÜw¬d
;

871 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

872 
	`wp
(
g
, "~{šˆ»t;~N", 
p
);

873 ià(
k“p_c
è
	`wp
(
g
, "~{šˆ§ved_øğ~zc;~N", 
p
);

874 
	`w
(
g
, g->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
 ? "~Mret =" : "~M");

875 
	`wp
(
g
, 
k“p_c
 ? "š£¹_~$(~Z~zc, ~zl, " : "š£¹_~$(~Z~zlb, ~zc, ", 
p
);

876 
	`g’”©e_d©a_add»ss
(
g
, 
p
);

877 
	`wp
(
g
, ");~C", 
p
);

878 ià(
k“p_c
è
	`w
(
g
, "~M~zc = saved_c;~N~}");

879 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

880 
	`wp
(
g
, "~Mif (ret < 0)„eturn„et;~N"

881 "~}", 
p
);

882 
	}
}

886 
	$g’”©e_¦iûäom
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

889 
	`wp
(
g
, "~{šˆ»ˆğ¦iû_äom_~$(~Z", 
p
);

890 
	`g’”©e_d©a_add»ss
(
g
, 
p
);

891 
	`wp
(
g
, ");~C", 
p
);

892 
	`wp
(
g
, "~Mif (ret < 0)„eturn„et;~N"

893 "~}", 
p
);

894 
	}
}

896 
	$g’”©e_£im™
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

897 
k“p_c
;

898 
	`wp
(
g
, "~{~k~C", 
p
);

899 
k“p_c
 = 
g
->
k“p_couÁ
;

900 
	`w
(
g
, "~Mint mlimit");

901 
	`wi
(
g
, 
k“p_c
);

902 
	`w
(
g
, ";~N");

903 
	`g’”©e
(
g
, 
p
->
Ëá
);

905 
	`w
(
g
, "~Mmlimit");

906 
	`wi
(
g
, 
k“p_c
);

907 ià(
p
->
mode
 =ğ
m_fÜw¬d
è
	`w
(
g
, " = ~zl - ~zc; ~zl = ~zc;~N");

908 
	`w
(
g
, " = ~zlb; ~zlb = ~zc;~N");

909 
	`w
(
g
, "~M"); 
	`w»¡Üe
(g, 
p
, 
k“p_c
); w(g, "~N");

910 
g
->
çu»_k“p_couÁ
 = -
k“p_c
;

911 
	`g’”©e
(
g
, 
p
->
aux
);

912 
	`w
(
g
, "~M");

913 
	`w»¡Ü–im™
(
g
, 
p
, -g->
çu»_k“p_couÁ
);

914 
	`w
(
g
, "~N"

916 
	}
}

918 cÚ¡ * 
	gv¬s
[] = { "p", "c", "l", "lb", "b¿", "k‘", 
NULL
 };

920 
	$g’”©e_dŞÏr
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

922 
u£d
 = 
g
->
Ïb–_u£d
;

923 
a0
 = 
g
->
çu»_Ïb–
;

924 
a1
 = 
g
->
çu»_k“p_couÁ
;

925 
k“p_tok’
;

926 
g
->
çu»_Ïb–
 = 
	`Ãw_Ïb–
(g);

927 
g
->
Ïb–_u£d
 = 0;

928 
g
->
çu»_k“p_couÁ
 = 0;

930 
k“p_tok’
 = ++
g
->
k“p_couÁ
;

931 
g
->
I
[0] = 
k“p_tok’
;

932 ià(
g
->
İtiÚs
->
make_Ïng
 !ğ
LANG_C
) {

933 cÚ¡ ** 
v¬
;

934 
	`wp
(
g
, "~{~C", 
p
);

935 
v¬
 = 
v¬s
; *var; ++var) {

936 
g
->
S
[0] = *
v¬
;

937 
	`w
(
g
, "~Mint ~S0~I0 = ~S0;~N");

940 
	`wp
(
g
, "~{¡ruù SN_’vƒnv~I0 = * z;~C", 
p
);

942 
g
->
V
[0] = 
p
->
Çme
;

943 
	`wp
(
g
, "~Mint failure = 1; /*‡ssume failure */~N"

946 "~M~zÈğSIZE(~zp);~N", 
p
);

947 
	`g’”©e
(
g
, 
p
->
Ëá
);

948 
	`w
(
g
, "~Mfailure = 0; /* mark success */~N");

949 ià(
g
->
Ïb–_u£d
)

950 
	`w£
(
g
, g->
çu»_Ïb–
);

951 
g
->
V
[0] = 
p
->
Çme
;

953 
g
->
Ïb–_u£d
 = 
u£d
;

954 
g
->
çu»_Ïb–
 = 
a0
;

955 
g
->
çu»_k“p_couÁ
 = 
a1
;

957 
g
->
I
[0] = 
k“p_tok’
;

958 ià(
g
->
İtiÚs
->
make_Ïng
 !ğ
LANG_C
) {

959 cÚ¡ ** 
v¬
;

960 
	`w
(
g
, "~M~V0 = ~zp;~N");

961 
v¬
 = 
v¬s
; *var; ++var) {

962 
g
->
S
[0] = *
v¬
;

963 
	`w
(
g
, "~M~S0 = ~S0~I0;~N");

965 
	`wp
(
g
, "~Mià(çu»è~f~N~}", 
p
);

967 
	`wp
(
g
, "~M~V0 = z->p;~N"

969 "~Mià(çu»è~f~N~}", 
p
);

971 
	}
}

973 
	$g’”©e_š‹g”_assign
(
g’”©Ü
 * 
g
, 
node
 * 
p
, * 
s
) {

975 
g
->
V
[0] = 
p
->
Çme
;

976 
g
->
S
[0] = 
s
;

977 
	`w
(
g
, "~M~V0 ~S0 "); 
	`g’”©e_AE
(g, 
p
->
AE
); 
	`wp
(g, ";~C",…);

978 
	}
}

980 
	$g’”©e_š‹g”_‹¡
(
g’”©Ü
 * 
g
, 
node
 * 
p
, * 
s
) {

982 
g
->
V
[0] = 
p
->
Çme
;

983 
g
->
S
[0] = 
s
;

984 
	`w
(
g
, "~Mià(!(~V0 ~S0 "); 
	`g’”©e_AE
(g, 
p
->
AE
); 
	`wp
(g, ")) ~f~C",…);

985 
	}
}

987 
	$g’”©e_ÿÎ
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

989 
g
->
V
[0] = 
p
->
Çme
;

990 
	`wp
(
g
, "~{šˆ»ˆğ~V0(~Z);~C", 
p
);

991 ià(
g
->
çu»_k“p_couÁ
 =ğ0 && g->
çu»_Ïb–
 =ğ
x_»tuº
) {

994 
	`wp
(
g
, "~MiàÔ‘ <ğ0è»tuº„‘;~N~}", 
p
);

996 
	`wp
(
g
, "~Mif (ret == 0) ~f~N"

997 "~MiàÔ‘ < 0è»tuº„‘;~N~}", 
p
);

999 
	}
}

1001 
	$g’”©e_groupšg
(
g’”©Ü
 * 
g
, 
node
 * 
p
, 
com¶em’t
) {

1003 
groupšg
 * 
q
 = 
p
->
Çme
->grouping;

1004 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "" : "_b";

1005 
g
->
S
[1] = 
com¶em’t
 ? "out" : "in";

1006 
g
->
S
[2] = g->
İtiÚs
->
utf8
 ? "_U" : "";

1007 
g
->
V
[0] = 
p
->
Çme
;

1008 
g
->
I
[0] = 
q
->
sm®Ë¡_ch
;

1009 
g
->
I
[1] = 
q
->
Ïrge¡_ch
;

1010 
	`wp
(
g
, "~Mià(~S1_groupšg~S0~S2(~Z~V0, ~I0, ~I1, 0)è~f~C", 
p
);

1011 
	}
}

1013 
	$g’”©e_Çmed¡ršg
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1015 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "" : "_b";

1016 
g
->
V
[0] = 
p
->
Çme
;

1017 
	`wp
(
g
, "~Mià(!Óq_v~S0(~Z~V0))è~f~C", 
p
);

1018 
	}
}

1020 
	$g’”©e_l™”®¡ršg
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1021 
symbŞ
 * 
b
 = 
p
->
l™”®¡ršg
;

1022 ià(
	`SIZE
(
b
) == 1 && *b < 128) {

1026 
buf
[8];

1027 ià(*
b
 < 32 || *b == 127 || *b == '\'' || *b == '\\') {

1028 
	`¥rštf
(
buf
, "%d", ()*
b
);

1030 
	`¥rštf
(
buf
, "'%c'", ()*
b
);

1032 
g
->
S
[0] = 
buf
;

1033 ià(
p
->
mode
 =ğ
m_fÜw¬d
) {

1034 
	`wp
(
g
, "~Mif (c ==† ||…[c] != ~S0) ~f~N"

1035 "~Mc++;~N", 
p
);

1037 
	`wp
(
g
, "~Mif (c <=†b ||…[c - 1] != ~S0) ~f~N"

1038 "~Mc--;~N", 
p
);

1041 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "" : "_b";

1042 
g
->
I
[0] = 
	`SIZE
(
b
);

1043 
g
->
L
[0] = 
b
;

1045 
	`wp
(
g
, "~Mià(!Óq_s~S0(~Z~I0, ~L0))è~f~C", 
p
);

1047 
	}
}

1049 
	$g’”©e_defše
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1050 
Çme
 * 
q
 = 
p
->name;

1051 
g
->
Ãxt_Ïb–
 = 0;

1053 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

1054 
g
->
S
[0] = 
q
->
ty³
 =ğ
t_routše
 ? "static" : "extern";

1056 
g
->
S
[0] = g->
İtiÚs
->
Çme
;

1057 
g
->
V
[0] = 
q
;

1059 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

1060 
	`w
(
g
, "~N~S0 int ~V0(struct SN_env * z) {");

1062 
	`w
(
g
, "~Nint Xapian::~S0::~V0() {");

1063 
	`ws
(
g
, 
p
->
mode
 =ğ
m_fÜw¬d
 ? " /* forwardmode */" : " /* backwardmode */");

1064 
	`w
(
g
, "~N~+");

1065 ià(
p
->
amÚgv¬_Ãeded
è
	`w
(
g
, "~Mint‡mong_var;~N");

1066 
g
->
çu»_k“p_couÁ
 = 0;

1067 
g
->
çu»_Ïb–
 = 
x_»tuº
;

1068 
g
->
Ïb–_u£d
 = 0;

1069 
g
->
k“p_couÁ
 = 0;

1070 
	`g’”©e
(
g
, 
p
->
Ëá
);

1071 
	`w
(
g
, "~Mreturn 1;~N~}");

1072 
	}
}

1074 
	$g’”©e_sub¡ršg
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1076 
amÚg
 * 
x
 = 
p
->among;

1077 
block
 = -1;

1078 
b™m­
 = 0;

1079 
amÚgvec
 * 
amÚg_ÿ£s
 = 
x
->
b
;

1080 
c
;

1081 
em±y_ÿ£
 = -1;

1082 
n_ÿ£s
 = 0;

1083 
symbŞ
 
ÿ£s
[2];

1084 
shÜ‹¡_size
 = 
INT_MAX
;

1085 
shown_comm’t
 = 0;

1087 
g
->
S
[0] = 
p
->
mode
 =ğ
m_fÜw¬d
 ? "" : "_b";

1088 
g
->
I
[0] = 
x
->
numb”
;

1089 
g
->
I
[1] = 
x
->
l™”®¡ršg_couÁ
;

1098 
c
 = 0; c < 
x
->
l™”®¡ršg_couÁ
; ++c) {

1099 
size
 = 
amÚg_ÿ£s
[
c
].size;

1100 ià(
size
 !ğ0 && siz< 
shÜ‹¡_size
) {

1101 
shÜ‹¡_size
 = 
size
;

1105 
c
 = 0; c < 
x
->
l™”®¡ršg_couÁ
; ++c) {

1106 
symbŞ
 
ch
;

1107 ià(
amÚg_ÿ£s
[
c
].
size
 == 0) {

1108 
em±y_ÿ£
 = 
c
;

1111 ià(
p
->
mode
 =ğ
m_fÜw¬d
) {

1112 
ch
 = 
amÚg_ÿ£s
[
c
].
b
[
shÜ‹¡_size
 - 1];

1114 
ch
 = 
amÚg_ÿ£s
[
c
].
b
[amÚg_ÿ£s[c].
size
 - 1];

1116 ià(
n_ÿ£s
 == 0) {

1117 
block
 = 
ch
 >> 5;

1118 } ià(
ch
 >> 5 !ğ
block
) {

1119 
block
 = -1;

1120 ià(
n_ÿ£s
 > 2) ;

1122 ià(
block
 == -1) {

1123 ià(
ch
 =ğ
ÿ£s
[0]) ;

1124 ià(
n_ÿ£s
 < 2) {

1125 
ÿ£s
[
n_ÿ£s
++] = 
ch
;

1126 } ià(
ch
 !ğ
ÿ£s
[1]) {

1127 ++
n_ÿ£s
;

1131 ià((
b™m­
 & (1u << (
ch
 & 0x1f))) == 0) {

1132 
b™m­
 |ğ1u << (
ch
 & 0x1f);

1133 ià(
n_ÿ£s
 < 2)

1134 
ÿ£s
[
n_ÿ£s
] = 
ch
;

1135 ++
n_ÿ£s
;

1140 ià(
block
 !ğ-1 || 
n_ÿ£s
 <= 2) {

1141 
buf
[64];

1142 
g
->
I
[2] = 
block
;

1143 
g
->
I
[3] = 
b™m­
;

1144 
g
->
I
[4] = 
shÜ‹¡_size
 - 1;

1145 ià(
p
->
mode
 =ğ
m_fÜw¬d
) {

1146 cÚ¡ * 
z
 = 
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
 ? "z->" : "";

1147 
	`¥rštf
(
buf
, "%¥[%sø+ %d]", 
z
, z, 
shÜ‹¡_size
 - 1);

1148 
g
->
S
[1] = 
buf
;

1149 ià(
shÜ‹¡_size
 == 1) {

1150 
	`wp
(
g
, "~Mià(~zø>ğ~zÈ|| ", 
p
);

1152 
	`wp
(
g
, "~Mià(~zø+ ~I4 >ğ~zÈ|| ", 
p
);

1155 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

1156 
g
->
S
[1] = "z->p[z->c - 1]";

1158 
g
->
S
[1] = "p[c - 1]";

1159 ià(
shÜ‹¡_size
 == 1) {

1160 
	`wp
(
g
, "~Mià(~zø<ğ~zlb || ", 
p
);

1162 
	`wp
(
g
, "~Mià(~zø- ~I4 <ğ~zlb || ", 
p
);

1165 ià(
n_ÿ£s
 == 0) {

1170 
	`wp
(
g
, "0", 
p
);

1171 } ià(
n_ÿ£s
 == 1) {

1172 
g
->
I
[4] = 
ÿ£s
[0];

1173 
	`wp
(
g
, "~S1 !ğ~I4", 
p
);

1174 } ià(
n_ÿ£s
 == 2) {

1175 
g
->
I
[4] = 
ÿ£s
[0];

1176 
g
->
I
[5] = 
ÿ£s
[1];

1177 
	`wp
(
g
, "(~S1 !ğ~I4 && ~S1 !ğ~I5)", 
p
);

1179 
	`wp
(
g
, "~S1 >> 5 !ğ~I2 || !((~I3 >> (~S1 & 0x1f)è& 1)", 
p
);

1181 
	`ws
(
g
, ") ");

1182 ià(
em±y_ÿ£
 != -1) {

1186 
g
->
I
[4] = 
amÚg_ÿ£s
[
em±y_ÿ£
].
»suÉ
;

1187 
	`wp
(
g
, "amÚg_v¬ = ~I4;ƒl£~C", 
p
);

1189 
	`wp
(
g
, "~f~C", 
p
);

1191 
shown_comm’t
 = 1;

1193 #ifdeà
OPTIMISATION_WARNINGS


1194 
	`´štf
("Couldn'ˆshÜtcuˆamÚg %d\n", 
x
->
numb”
);

1198 ià(
x
->
commªd_couÁ
 =ğ0 && x->
¡¬‹r
 == 0) {

1199 
	`w
(
g
, "~Mif (!(find_among~S0(s_pool, ~Za_~I0, ~I1, ");

1200 ià(
x
->
have_funcs
) {

1201 
	`w
(
g
, "af_~I0,‡f");

1203 
	`ws
(
g
, "0, 0");

1205 
	`wp
(
g
, "))è~f", 
p
);

1206 
	`wp
(
g
, 
shown_comm’t
 ? "~N" : "~C", 
p
);

1208 
	`w
(
g
, "~Mamong_var = find_among~S0(s_pool, ~Za_~I0, ~I1, ");

1209 ià(
x
->
have_funcs
) {

1210 
	`w
(
g
, "af_~I0,‡f");

1212 
	`ws
(
g
, "0, 0");

1214 
	`wp
(
g
, ");", 
p
);

1215 
	`wp
(
g
, 
shown_comm’t
 ? "~N" : "~C", 
p
);

1216 
	`wp
(
g
, "~Mià(!×mÚg_v¬)è~f~N", 
p
);

1218 
	}
}

1220 
	$g’”©e_amÚg
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1222 
amÚg
 * 
x
 = 
p
->among;

1223 
ÿ£_numb”
 = 1;

1225 ià(
x
->
sub¡ršg
 =ğ0è
	`g’”©e_sub¡ršg
(
g
, 
p
);

1226 ià(
x
->
commªd_couÁ
 =ğ0 && x->
¡¬‹r
 == 0) ;

1228 
	`uÆess
 (
x
->
¡¬‹r
 =ğ0è
	`g’”©e
(
g
, x->starter);

1230 
	`wp
(
g
, "~Mswitch(among_var) {~C~+"

1231 "~Mÿ£ 0: ~f~N", 
p
);

1233 
p
 =…->
Ëá
;

1234 ià(
p
 !ğ0 &&…->
ty³
 !ğ
c_l™”®¡ršg
è°ğp->
right
;

1236 
	`uÁ
 (
p
 == 0) {

1237 ià(
p
->
ty³
 =ğ
c_b¿
 &&…->
Ëá
 != 0) {

1238 
g
->
I
[0] = 
ÿ£_numb”
++;

1239 
	`w
(
g
, "~Mÿ£ ~I0:~N~+"); 
	`g’”©e
(g, 
p
); w(g, "~Mbreak;~N~-");

1241 
p
 =…->
right
;

1243 
	`w
(
g
, "~}");

1244 
	}
}

1246 
	$g’”©e_boŞ‹¡
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1248 
g
->
V
[0] = 
p
->
Çme
;

1249 
	`wp
(
g
, "~Mià(!(~V0)è~f~C", 
p
);

1250 
	}
}

1252 
	$g’”©e_çl£
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1254 
	`wp
(
g
, "~M~f~C", 
p
);

1255 
	}
}

1257 
	$g’”©e_debug
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1259 
g
->
I
[0] = g->
debug_couÁ
++;

1260 
g
->
I
[1] = 
p
->
lše_numb”
;

1261 
	`wp
(
g
, "~Mdebug(~Z~I0, ~I1);~C", 
p
);

1263 
	}
}

1265 
	$g’”©e
(
g’”©Ü
 * 
g
, 
node
 * 
p
) {

1267 
u£d
 = 
g
->
Ïb–_u£d
;

1268 
a0
 = 
g
->
çu»_Ïb–
;

1269 
a1
 = 
g
->
çu»_k“p_couÁ
;

1271 
p
->
ty³
)

1273 
c_defše
: 
	`g’”©e_defše
(
g
, 
p
); ;

1274 
c_b¿
: 
	`g’”©e_b¿
(
g
, 
p
); ;

1275 
c_ªd
: 
	`g’”©e_ªd
(
g
, 
p
); ;

1276 
c_Ü
: 
	`g’”©e_Ü
(
g
, 
p
); ;

1277 
c_backw¬ds
: 
	`g’”©e_backw¬ds
(
g
, 
p
); ;

1278 
c_nÙ
: 
	`g’”©e_nÙ
(
g
, 
p
); ;

1279 
c_£t
: 
	`g’”©e_£t
(
g
, 
p
); ;

1280 
c_un£t
: 
	`g’”©e_un£t
(
g
, 
p
); ;

1281 
c_Œy
: 
	`g’”©e_Œy
(
g
, 
p
); ;

1282 
c_ç
: 
	`g’”©e_ç
(
g
, 
p
); ;

1283 
c_»v”£
:

1284 
c_‹¡
: 
	`g’”©e_‹¡
(
g
, 
p
); ;

1285 
c_do
: 
	`g’”©e_do
(
g
, 
p
); ;

1286 
c_gÙo
: 
	`g’”©e_GO
(
g
, 
p
, 1); ;

1287 
c_gİa¡
: 
	`g’”©e_GO
(
g
, 
p
, 0); ;

1288 
c_»³©
: 
	`g’”©e_»³©
(
g
, 
p
, 
çl£
); ;

1289 
c_loİ
: 
	`g’”©e_loİ
(
g
, 
p
); ;

1290 
c_©Ëa¡
: 
	`g’”©e_©Ëa¡
(
g
, 
p
); ;

1291 
c_£tm¬k
: 
	`g’”©e_£tm¬k
(
g
, 
p
); ;

1292 
c_tom¬k
: 
	`g’”©e_tom¬k
(
g
, 
p
); ;

1293 
c_©m¬k
: 
	`g’”©e_©m¬k
(
g
, 
p
); ;

1294 
c_hİ
: 
	`g’”©e_hİ
(
g
, 
p
); ;

1295 
c_d–‘e
: 
	`g’”©e_d–‘e
(
g
, 
p
); ;

1296 
c_Ãxt
: 
	`g’”©e_Ãxt
(
g
, 
p
); ;

1297 
c_tŞim™
: 
	`g’”©e_tŞim™
(
g
, 
p
); ;

1298 
c_©lim™
: 
	`g’”©e_©lim™
(
g
, 
p
); ;

1299 
c_Ëá¦iû
: 
	`g’”©e_Ëá¦iû
(
g
, 
p
); ;

1300 
c_right¦iû
: 
	`g’”©e_right¦iû
(
g
, 
p
); ;

1301 
c_assigÁo
: 
	`g’”©e_assigÁo
(
g
, 
p
); ;

1302 
c_¦iûto
: 
	`g’”©e_¦iûto
(
g
, 
p
); ;

1303 
c_assign
: 
	`g’”©e_assignäom
(
g
, 
p
); ;

1304 
c_š£¹
:

1305 
c_©ch
: 
	`g’”©e_š£¹
(
g
, 
p
,…->
ty³
); ;

1306 
c_¦iûäom
: 
	`g’”©e_¦iûäom
(
g
, 
p
); ;

1307 
c_£im™
: 
	`g’”©e_£im™
(
g
, 
p
); ;

1308 
c_dŞÏr
: 
	`g’”©e_dŞÏr
(
g
, 
p
); ;

1309 
c_m©hassign
: 
	`g’”©e_š‹g”_assign
(
g
, 
p
, "="); ;

1310 
c_¶u§ssign
: 
	`g’”©e_š‹g”_assign
(
g
, 
p
, "+="); ;

1311 
c_mšu§ssign
: 
	`g’”©e_š‹g”_assign
(
g
, 
p
, "-="); ;

1312 
c_muÉlyassign
:
	`g’”©e_š‹g”_assign
(
g
, 
p
, "*="); ;

1313 
c_divid—ssign
: 
	`g’”©e_š‹g”_assign
(
g
, 
p
, "/="); ;

1314 
c_eq
: 
	`g’”©e_š‹g”_‹¡
(
g
, 
p
, "=="); ;

1315 
c_Ã
: 
	`g’”©e_š‹g”_‹¡
(
g
, 
p
, "!="); ;

1316 
c_gr
: 
	`g’”©e_š‹g”_‹¡
(
g
, 
p
, ">"); ;

1317 
c_ge
: 
	`g’”©e_š‹g”_‹¡
(
g
, 
p
, ">="); ;

1318 
c_ls
: 
	`g’”©e_š‹g”_‹¡
(
g
, 
p
, "<"); ;

1319 
c_Ë
: 
	`g’”©e_š‹g”_‹¡
(
g
, 
p
, "<="); ;

1320 
c_ÿÎ
: 
	`g’”©e_ÿÎ
(
g
, 
p
); ;

1321 
c_groupšg
: 
	`g’”©e_groupšg
(
g
, 
p
, 
çl£
); ;

1322 
c_nÚ
: 
	`g’”©e_groupšg
(
g
, 
p
, 
Œue
); ;

1323 
c_Çme
: 
	`g’”©e_Çmed¡ršg
(
g
, 
p
); ;

1324 
c_l™”®¡ršg
: 
	`g’”©e_l™”®¡ršg
(
g
, 
p
); ;

1325 
c_amÚg
: 
	`g’”©e_amÚg
(
g
, 
p
); ;

1326 
c_sub¡ršg
: 
	`g’”©e_sub¡ršg
(
g
, 
p
); ;

1327 
c_boŞ‹¡
: 
	`g’”©e_boŞ‹¡
(
g
, 
p
); ;

1328 
c_çl£
: 
	`g’”©e_çl£
(
g
, 
p
); ;

1329 
c_Œue
: ;

1330 
c_debug
: 
	`g’”©e_debug
(
g
, 
p
); ;

1331 : 
	`årštf
(
¡d”r
, "%dƒncouÁ”ed\n", 
p
->
ty³
);

1332 
	`ex™
(1);

1335 ià(
g
->
çu»_Ïb–
 !ğ
a0
)

1336 
g
->
Ïb–_u£d
 = 
u£d
;

1337 
g
->
çu»_Ïb–
 = 
a0
;

1338 
g
->
çu»_k“p_couÁ
 = 
a1
;

1339 
	}
}

1341 
	$g’”©e_¡¬t_comm’t
(
g’”©Ü
 * 
g
) {

1343 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
)

1344 
	`w
(
g
, "~N/* This file was generated‡utomatically byhe Snowballo ANSI C compiler */~N");

1346 
	`w
(
g
, "/* This file was generated‡utomatically byhe Snowballo ISO C++ compiler */~N");

1347 
	}
}

1349 
	$g’”©e_h—d
(
g’”©Ü
 * 
g
) {

1351 ià(
g
->
İtiÚs
->
make_Ïng
 !ğ
LANG_C
) {

1352 cÚ¡ * 
s
 = 
g
->
İtiÚs
->
ouut_fe
;

1353 cÚ¡ * 
Ëaf
;

1354 
	`w
(
g
, "~N"

1356 ià(!
s
è
	`abÜt
();

1357 
Ëaf
 = 
	`¡¼chr
(
s
, '/');

1358 ià(
Ëaf
è++Ëaf; Ëaàğ
s
;

1359 
	`ws
(
g
, "#include \"");

1360 
	`ws
(
g
, 
Ëaf
);

1361 
	`w
(
g
, ".h\"~N~N");

1365 ià(
g
->
İtiÚs
->
ruÁime_·th
 == 0) {

1366 
	`w
(
g
, "~N#include \"header.h\"~N~N");

1368 
	`w
(
g
, "~N#include \"");

1369 
	`ws
(
g
, g->
İtiÚs
->
ruÁime_·th
);

1370 ià(
g
->
İtiÚs
->
ruÁime_·th
[
	`¡¾’
(g->options->runtime_path) - 1] != '/')

1371 
	`wch
(
g
, '/');

1372 
	`w
(
g
, "header.h\"~N~N");

1374 
	}
}

1376 
	$g’”©e_routše_h—d”s
(
g’”©Ü
 * 
g
) {

1377 
Çme
 * 
q
;

1378 ià(
g
->
İtiÚs
->
make_Ïng
 !ğ
LANG_C
) ;

1380 
q
 = 
g
->
ª®y£r
->
Çmes
;

1381 
	`uÁ
 (
q
 == 0) {

1382 
g
->
V
[0] = 
q
;

1383 
q
->
ty³
) {

1384 
t_routše
:

1385 
	`w
(
g
, "static int ~W0(struct SN_env * z);~N");

1387 
t_ex‹º®
:

1388 
	`w
(
g
,

1399 
q
 = q->
Ãxt
;

1401 
	}
}

1403 
	gpoŞ_size
 = 0;

1405 
	$g’”©e_amÚg_poŞ
(
g’”©Ü
 * 
g
, 
amÚg
 * 
x
) {

1407 
x
) {

1408 
amÚgvec
 * 
v
 = 
x
->
b
;

1409 
have_funcs
 = 0;

1410 
i
;

1411 * 
dÚe
 = 
	`check_m®loc
(
x
->
l™”®¡ršg_couÁ
);

1412 
	`mem£t
(
dÚe
, 0, 
x
->
l™”®¡ršg_couÁ
);

1414 
g
->
I
[0] = 
x
->
numb”
;

1416 
i
 = 0; i < 
x
->
l™”®¡ršg_couÁ
; i++, 
v
++)

1418 
j
;

1419 ià(
v
->
size
 =ğ0 || 
dÚe
[
i
]) ;

1420 
g
->
I
[1] = 
i
;

1422 
j
 = 0; j < 
x
->
l™”®¡ršg_couÁ
; j++) {

1423 ià(
j
 =ğ
i
) ;

1424 ià(
v
->
size
 <ğv[
j
 - 
i
].size) {

1425 
size_t
 
off£t
 = 
v
[
j
 - 
i
].
size
 - v->size;

1426 
size_t
 
Ën
 = 
v
->
size
 * (
symbŞ
);

1428 ià(
	`memcmp
(
v
->
b
, v[
j
 - 
i
].b + 
off£t
, 
Ën
) == 0) {

1429 
g
->
I
[2] = 
j
;

1430 ià(
off£t
) {

1431 
g
->
I
[3] = 
off£t
;

1432 
	`w
(
g
, "#define s_~I0_~I1 (s_~I0_~I2 + ~I3)~N");

1434 
	`w
(
g
, "#define s_~I0_~I1 s_~I0_~I2~N");

1436 
dÚe
;

1438 } 
off£t
--);

1441 
	`uÆess
 (
v
->
size
 == 0) {

1442 ià(
poŞ_size
 == 0) {

1443 
	`w
(
g
, "static const symbol s_pool[] = {~N");

1445 
g
->
I
[2] = 
poŞ_size
;

1446 
	`w
(
g
, "#define s_~I0_~I1 ~I2~N");

1447 
g
->
L
[0] = 
v
->
b
;

1448 
	`w
(
g
, "~A0,~N");

1449 
poŞ_size
 +ğ
v
->
size
;

1451 
dÚe
: ;

1454 
	`check_ä“
(
dÚe
);

1455 
x
 = x->
Ãxt
;

1457 ià(
poŞ_size
 != 0) {

1458 
	`w
(
g
, "};~N~N");

1460 
	}
}

1462 
	$g’”©e_amÚg_bË
(
g’”©Ü
 * 
g
, 
amÚg
 * 
x
) {

1464 
amÚgvec
 * 
v
 = 
x
->
b
;

1465 
have_funcs
 = 0;

1467 
g
->
I
[0] = 
x
->
numb”
;

1468 
g
->
I
[1] = 
x
->
l™”®¡ršg_couÁ
;

1469 
	`w
(
g
, "~N~Mstatic const struct‡mong‡_~I0[~I1] =~N{~N");

1471 
v
 = 
x
->
b
;

1473 
i
;

1474 
i
 = 0; i < 
x
->
l™”®¡ršg_couÁ
; i++) {

1475 
g
->
I
[1] = 
i
;

1476 
g
->
I
[2] = 
v
->
size
;

1477 
g
->
I
[3] = 
v
->
i
;

1478 
g
->
I
[4] = 
v
->
»suÉ
;

1479 
g
->
S
[0] = 
i
 < 
x
->
l™”®¡ršg_couÁ
 - 1 ? "," : "";

1481 
	`w
(
g
, "/*~J1 */ { ~I2, ");

1482 ià(
v
->
size
 =ğ0è
	`w
(
g
, "0,");

1483 
	`w
(
g
, "s_~I0_~I1,");

1484 
	`w
(
g
, " ~I3, ~I4");

1485 ià(
v
->
funùiÚ
è
have_funcs
 = 1;

1486 
	`w
(
g
, "}~S0~N");

1487 
v
++;

1490 
	`w
(
g
, "};~N~N");

1492 
x
->
have_funcs
 = have_funcs;

1493 ià(
have_funcs
) {

1494 
g
->
I
[1] = 
x
->
l™”®¡ršg_couÁ
;

1495 
	`w
(
g
, "~Mstatic const unsigned char‡f_~I0[~I1] =~N{~N");

1497 
v
 = 
x
->
b
;

1499 
i
;

1500 
i
 = 0; i < 
x
->
l™”®¡ršg_couÁ
; i++) {

1501 
g
->
I
[1] = 
i
;

1503 
	`w
(
g
, "/*~J1 */ ");

1504 ià(
v
[
i
].
funùiÚ
 == 0) {

1505 
	`w
(
g
, "0");

1507 
	`wi
(
g
, 
v
[
i
].
funùiÚ
->
amÚg_func_couÁ
);

1508 
g
->
V
[0] = 
v
[
i
].
funùiÚ
;

1509 
	`w
(
g
, " /*~W0 */");

1511 ià(
i
 < 
x
->
l™”®¡ršg_couÁ
 - 1è
	`w
(
g
, ",~N");

1514 
	`w
(
g
, "~N};~N~N");

1516 
	}
}

1518 
	$g’”©e_amÚgs
(
g’”©Ü
 * 
g
) {

1519 
amÚg
 * 
x
 = 
g
->
ª®y£r
->
amÚgs
;

1520 
Çme
 * 
q
;

1521 
amÚg_func_couÁ
 = 0;

1523 
g
->
S
[0] = g->
İtiÚs
->
Çme
;

1524 
q
 = 
g
->
ª®y£r
->
Çmes
; q; q = q->
Ãxt
) {

1525 ià(
q
->
ty³
 =ğ
t_routše
 && q->
routše_ÿÎed_äom_amÚg
) {

1526 
q
->
amÚg_func_couÁ
 = ++among_func_count;

1527 
g
->
V
[0] = 
q
;

1528 
	`w
(
g
, "static int~V0(Xapian::Stem::Internal *his_ptr) {~N"

1535 ià(
amÚg_func_couÁ
) {

1536 
g
->
I
[0] = 
amÚg_func_couÁ
;

1537 
	`w
(
g
, "~Mstatic const‡mong_function‡f[~I0] =~N{~N");

1539 
q
 = 
g
->
ª®y£r
->
Çmes
;

1540 
g
->
S
[0] = g->
İtiÚs
->
Çme
;

1541 
q
 = 
g
->
ª®y£r
->
Çmes
; q; q = q->
Ãxt
) {

1542 ià(
q
->
ty³
 =ğ
t_routše
 && q->
routše_ÿÎed_äom_amÚg
) {

1543 
g
->
V
[0] = 
q
;

1544 
g
->
I
[0] = 
q
->
amÚg_func_couÁ
;

1545 
	`w
(
g
, "/*~J0 */~V0");

1546 ià(
q
->
amÚg_func_couÁ
 <‡mÚg_func_couÁè
	`w
(
g
, ",~N"); w(g, "~N");

1550 
	`w
(
g
, "};~N~N");

1553 
	`g’”©e_amÚg_poŞ
(
g
, 
x
);

1555 
	`uÁ
 (
x
 == 0) {

1556 
	`g’”©e_amÚg_bË
(
g
, 
x
);

1557 
x
 = x->
Ãxt
;

1559 
	}
}

1561 
	$£t_b™
(
symbŞ
 * 
b
, 
i
è{ b[i/8] |ğ1 << i%8; 
	}
}

1563 
	$g’”©e_groupšg_bË
(
g’”©Ü
 * 
g
, 
groupšg
 * 
q
) {

1565 
¿nge
 = 
q
->
Ïrge¡_ch
 - q->
sm®Ë¡_ch
 + 1;

1566 
size
 = (
¿nge
 + 7)/ 8;

1567 
symbŞ
 * 
b
 = 
q
->b;

1568 
symbŞ
 * 
m­
 = 
	`ü—‹_b
(
size
);

1569 
i
;

1570 
i
 = 0; i < 
size
; i++è
m­
[i] = 0;

1572 
i
 = 0; i < 
	`SIZE
(
b
); i++è
	`£t_b™
(
m­
, b[i] - 
q
->
sm®Ë¡_ch
);

1575 
g
->
V
[0] = 
q
->
Çme
;

1577 
	`w
(
g
, "static const unsigned char ~V0[] = { ");

1578 
i
 = 0; i < 
size
; i++) {

1579 
	`wi
(
g
, 
m­
[
i
]);

1580 ià(
i
 < 
size
 - 1è
	`w
(
g
, ", ");

1582 
	`w
(
g
, " };~N~N");

1584 
	`lo£_b
(
m­
);

1585 
	}
}

1587 
	$g’”©e_groupšgs
(
g’”©Ü
 * 
g
) {

1588 
groupšg
 * 
q
 = 
g
->
ª®y£r
->
groupšgs
;

1589 
	`uÁ
 (
q
 == 0) {

1590 
	`g’”©e_groupšg_bË
(
g
, 
q
);

1591 
q
 = q->
Ãxt
;

1593 
	}
}

1595 
	$g’”©e_ü—‹
(
g’”©Ü
 * 
g
) {

1597 * 
p
 = 
g
->
ª®y£r
->
Çme_couÁ
;

1599 ià(
g
->
İtiÚs
->
make_Ïng
 !ğ
LANG_C
) {

1600 
Çme
 * 
q
 = 
g
->
ª®y£r
->
Çmes
;

1601 
fœ¡
 = 
Œue
;

1602 cÚ¡ * 
dtÜ
;

1603 
g
->
S
[0] = g->
İtiÚs
->
Çme
;

1604 
dtÜ
 = 
	`¡¼chr
(
g
->
İtiÚs
->
Çme
, ':');

1605 ià(
dtÜ
è++dtÜ; dtÜ = 
g
->
İtiÚs
->
Çme
;

1606 
g
->
S
[1] = 
dtÜ
;

1607 
	`w
(
g
, "~N"

1609 
q
) {

1610 ià(
q
->
ty³
 < 
t_routše
) {

1611 
	`w
(
g
, 
fœ¡
 ? "~N : " : ", ");

1612 
fœ¡
 = 
çl£
;

1613 
g
->
V
[0] = 
q
;

1614 
	`w
(
g
, "~W0(0)");

1616 
q
 = q->
Ãxt
;

1618 
	`w
(
g
, "~N{~N");

1619 
q
 = 
g
->
ª®y£r
->
Çmes
;

1620 
q
) {

1621 ià(
q
->
ty³
 =ğ
t_¡ršg
) {

1622 
g
->
V
[0] = 
q
;

1623 
	`w
(
g
, " ~W0 = create_s();~N");

1625 
q
 = q->
Ãxt
;

1627 
	`w
(
g
, "}~N");

1632 
g
->
I
[0] = 
p
[
t_¡ršg
];

1633 
g
->
I
[1] = 
p
[
t_š‹g”
];

1634 
g
->
I
[2] = 
p
[
t_boŞ—n
];

1635 
	`w
(
g
, "~N"

1638 
	}
}

1640 
	$g’”©e_şo£
(
g’”©Ü
 * 
g
) {

1642 * 
p
 = 
g
->
ª®y£r
->
Çme_couÁ
;

1643 ià(
g
->
İtiÚs
->
make_Ïng
 !ğ
LANG_C
) {

1644 
Çme
 * 
q
 = 
g
->
ª®y£r
->
Çmes
;

1645 cÚ¡ * 
dtÜ
;

1646 cÚ¡ * 
Ïng
;

1647 
g
->
S
[0] = g->
İtiÚs
->
Çme
;

1648 
dtÜ
 = 
	`¡¼chr
(
g
->
İtiÚs
->
Çme
, ':');

1649 ià(
dtÜ
è++dtÜ; dtÜ = 
g
->
İtiÚs
->
Çme
;

1650 
g
->
S
[1] = 
dtÜ
;

1651 
Ïng
 = 
	`¡¼chr
(
g
->
İtiÚs
->
ouut_fe
, '/');

1652 ià(
Ïng
è++Ïng; Ïng = 
g
->
İtiÚs
->
ouut_fe
;

1653 
g
->
S
[2] = 
Ïng
;

1654 
	`w
(
g
, "~N"

1657 
q
) {

1658 ià(
q
->
ty³
 =ğ
t_¡ršg
) {

1659 
g
->
V
[0] = 
q
;

1660 
	`w
(
g
, "†ose_s(~W0);~N");

1662 
q
 = q->
Ãxt
;

1664 
	`w
(
g
, "}~N");

1666 
	`w
(
g
, "~N"

1675 
g
->
I
[0] = 
p
[
t_¡ršg
];

1676 
	`w
(
g
, "~Nextern void ~pclose_env(struct SN_env * z) { SN_close_env(z, ~I0); }~N~N");

1677 
	}
}

1679 
	$g’”©e_ü—‹_ªd_şo£_‹m¶©es
(
g’”©Ü
 * 
g
) {

1680 
	`w
(
g
, "~N"

1684 
	}
}

1686 
	$g’”©e_h—d”_fe
(
g’”©Ü
 * 
g
) {

1688 
Çme
 * 
q
 = 
g
->
ª®y£r
->
Çmes
;

1689 * 
vp
 = 
g
->
İtiÚs
->
v¬ŸbËs_´efix
;

1690 
g
->
S
[0] = 
vp
;

1692 ià(
g
->
İtiÚs
->
make_Ïng
 !ğ
LANG_C
) {

1693 cÚ¡ * 
p
;

1694 
	`w
(
g
, "~N"

1700 
g
->
S
[1] = g->
İtiÚs
->
Çme
;

1701 
	`w
(
g
, "class ~S1 ");

1702 ià(
g
->
İtiÚs
->
·»Á_şass_Çme
) {

1703 
g
->
S
[1] = g->
İtiÚs
->
·»Á_şass_Çme
;

1704 
	`w
(
g
, ":…ublic ~S1 ");

1706 
	`w
(
g
, "{~N");

1707 
q
 = 
g
->
ª®y£r
->
Çmes
; q; q = q->
Ãxt
) {

1708 
q
->
ty³
) {

1709 
t_¡ršg
: 
g
->
S
[1] = "symbŞ *"; 
Ïb–1
;

1710 
t_š‹g”
: 
g
->
S
[1] = "št"; 
Ïb–1
;

1711 
t_boŞ—n
: 
g
->
S
[1] = "unsigned char";

1712 
Ïb–1
:

1713 
g
->
V
[0] = 
q
;

1714 
	`w
(
g
, " ~S1 ~W0;~N");

1721 
	`w
(
g
, "…ublic:~N");

1722 
q
 = 
g
->
ª®y£r
->
Çmes
; q; q = q->
Ãxt
) {

1723 ià(
q
->
ty³
 =ğ
t_routše
) {

1724 
g
->
V
[0] = 
q
;

1725 
	`w
(
g
, " int ~W0();~N");

1729 
	`w
(
g
, "~N");

1730 
p
 = 
	`¡¼chr
(
g
->
İtiÚs
->
Çme
, ':');

1731 ià(
p
è++p; °ğ
g
->
İtiÚs
->
Çme
;

1732 
g
->
S
[1] = 
p
;

1733 
	`w
(
g
, " ~S1();~N"

1735 
q
 = 
g
->
ª®y£r
->
Çmes
; q; q = q->
Ãxt
) {

1736 ià(
q
->
ty³
 =ğ
t_ex‹º®
) {

1737 
g
->
V
[0] = 
q
;

1738 
	`w
(
g
, " int ~W0();~N");

1742 
	`w
(
g
, " const char * get_description() const;~N"

1750 
	`w
(
g
, "~N"

1755 
	`g’”©e_ü—‹_ªd_şo£_‹m¶©es
(
g
);

1756 
	`uÁ
 (
q
 == 0) {

1757 
g
->
V
[0] = 
q
;

1758 
q
->
ty³
)

1760 
t_ex‹º®
:

1761 
	`w
(
g
, "extern int ~W0(struct SN_env * z);~N");

1763 
t_¡ršg
: 
g
->
S
[1] = "S"; 
Ïb–0
;

1764 
t_š‹g”
: 
g
->
S
[1] = "I"; 
Ïb–0
;

1765 
t_boŞ—n
: 
g
->
S
[1] = "B";

1766 
Ïb–0
:

1767 ià(
vp
) {

1768 
g
->
I
[0] = 
q
->
couÁ
;

1769 
	`w
(
g
, "#define ~S0");

1770 
	`¡r_­³nd_b
(
g
->
outbuf
, 
q
->
b
);

1771 
	`w
(
g
, " (~S1[~I0])~N");

1775 
q
 = q->
Ãxt
;

1778 
	`w
(
g
, "~N"

1783 
	`w
(
g
, "~N");

1784 
	}
}

1786 
	$g’”©e_´og¿m_c
(
g’”©Ü
 * 
g
) {

1788 
g
->
outbuf
 = 
	`¡r_Ãw
();

1789 
	`g’”©e_¡¬t_comm’t
(
g
);

1790 
	`g’”©e_h—d
(
g
);

1791 
	`g’”©e_routše_h—d”s
(
g
);

1792 ià(
g
->
İtiÚs
->
make_Ïng
 =ğ
LANG_C
) {

1793 
	`w
(
g
, "#ifdef __cplusplus~N"

1797 
	`g’”©e_ü—‹_ªd_şo£_‹m¶©es
(
g
);

1798 
	`w
(
g
, "~N"

1803 
	`g’”©e_amÚgs
(
g
);

1804 
	`g’”©e_groupšgs
(
g
);

1805 
g
->
deş¬©iÚs
 = g->
outbuf
;

1806 
g
->
outbuf
 = 
	`¡r_Ãw
();

1807 
g
->
l™”®¡ršg_couÁ
 = 0;

1809 
node
 * 
p
 = 
g
->
ª®y£r
->
´og¿m
;

1810 
	`uÁ
 (
p
 =ğ0è{ 
	`g’”©e
(
g
,…);… =…->
right
; }

1812 
	`g’”©e_ü—‹
(
g
);

1813 
	`g’”©e_şo£
(
g
);

1814 
	`ouut_¡r
(
g
->
İtiÚs
->
ouut_c
, g->
deş¬©iÚs
);

1815 
	`¡r_d–‘e
(
g
->
deş¬©iÚs
);

1816 
	`ouut_¡r
(
g
->
İtiÚs
->
ouut_c
, g->
outbuf
);

1817 
	`¡r_ş—r
(
g
->
outbuf
);

1819 
	`g’”©e_¡¬t_comm’t
(
g
);

1820 
	`g’”©e_h—d”_fe
(
g
);

1821 
	`ouut_¡r
(
g
->
İtiÚs
->
ouut_h
, g->
outbuf
);

1822 
	`¡r_d–‘e
(
g
->
outbuf
);

1823 
	}
}

1825 
g’”©Ü
 * 
	$ü—‹_g’”©Ü_c
(
ª®y£r
 * 
a
, 
İtiÚs
 * 
o
) {

1826 
	`NEW
(
g’”©Ü
, 
g
);

1827 
g
->
ª®y£r
 = 
a
;

1828 
g
->
İtiÚs
 = 
o
;

1829 
g
->
m¬gš
 = 0;

1830 
g
->
debug_couÁ
 = 0;

1831 
g
->
lše_couÁ
 = 0;

1832  
g
;

1833 
	}
}

1835 
	$şo£_g’”©Ü_c
(
g’”©Ü
 * 
g
) {

1837 
	`FREE
(
g
);

1838 
	}
}

	@languages/compiler/header.h

2 
	tby‹
;

3 
	tsymbŞ
;

5 
	#Œue
 1

	)

6 
	#çl£
 0

	)

7 
	#»³©
 
Œue
)

	)

8 
	#uÆess
(
C
èif(!(C))

	)

9 
	#uÁ
(
C
è!(C))

	)

11 
	#MALLOC
 
check_m®loc


	)

12 
	#FREE
 
check_ä“


	)

14 
	#NEW
(
ty³
, 
p
èty³ *… = (ty³ *è
	`MALLOC
((ty³))

	)

15 
	#NEWVEC
(
ty³
, 
p
, 
n
èty³ *… = (ty³ *è
	`MALLOC
((ty³è*‚)

	)

17 
	#STARTSIZE
 10

	)

18 
	#SIZE
(
p
è((*)Õ))[-1]

	)

19 
	#CAPACITY
(
p
è((*)Õ))[-2]

	)

21 
symbŞ
 * 
ü—‹_b
(
n
);

22 
»pÜt_b
(
FILE
 * 
out
, 
symbŞ
 * 
p
);

23 
lo£_b
(
symbŞ
 * 
p
);

24 
symbŞ
 * 
šü—£_ÿ·c™y
(symbŞ * 
p
, 
n
);

25 
symbŞ
 * 
move_to_b
(symbŞ * 
p
, 
n
, symbŞ * 
q
);

26 
symbŞ
 * 
add_to_b
(symbŞ * 
p
, 
n
, symbŞ * 
q
);

27 
symbŞ
 * 
cİy_b
(symbŞ * 
p
);

28 * 
b_to_s
(
symbŞ
 * 
p
);

29 
symbŞ
 * 
add_s_to_b
(symbŞ * 
p
, cÚ¡ * 
s
);

31 
	g¡r
;

33 
¡r
 * 
¡r_Ãw
();

34 
¡r_d–‘e
(
¡r
 * str);

35 
¡r_­³nd
(
¡r
 * sŒ, ¡¸* 
add
);

36 
¡r_­³nd_ch
(
¡r
 * sŒ, 
add
);

37 
¡r_­³nd_b
(
¡r
 * sŒ, 
symbŞ
 * 
q
);

38 
¡r_­³nd_¡ršg
(
¡r
 * sŒ, cÚ¡ * 
s
);

39 
¡r_­³nd_št
(
¡r
 * sŒ, 
i
);

40 
¡r_ş—r
(
¡r
 * str);

41 
¡r_assign
(
¡r
 * sŒ, * 
s
);

42 
¡r
 * 
¡r_cİy
(¡¸* 
Şd
);

43 
symbŞ
 * 
¡r_d©a
(
¡r
 * str);

44 
¡r_Ën
(
¡r
 * str);

45 
g‘_utf8
(cÚ¡ 
symbŞ
 * 
p
, * 
¦Ù
);

46 
put_utf8
(
ch
, 
symbŞ
 * 
p
);

48 
	sm_·œ
 {

50 
m_·œ
 * 
	mÃxt
;

51 
symbŞ
 * 
	mÇme
;

52 
symbŞ
 * 
	mv®ue
;

56 
	sšput
 {

58 
šput
 * 
	mÃxt
;

59 
symbŞ
 * 
	mp
;

60 
	mc
;

61 
	mlše_numb”
;

65 
	sšşude
 {

67 
šşude
 * 
	mÃxt
;

68 
symbŞ
 * 
	mb
;

72 
	stok’i£r
 {

74 
šput
 * 
	mÃxt
;

75 
symbŞ
 * 
	mp
;

76 
	mc
;

77 
	mlše_numb”
;

78 
symbŞ
 * 
	mb
;

79 
symbŞ
 * 
	mb2
;

80 
	mnumb”
;

81 
	mm_¡¬t
;

82 
	mm_’d
;

83 
m_·œ
 * 
	mm_·œs
;

84 
	mg‘_d•th
;

85 
	m”rÜ_couÁ
;

86 
	mtok’
;

87 
	m´evious_tok’
;

88 
by‹
 
	mtok’_h–d
;

89 
by‹
 
	mwidech¬s
;

90 
by‹
 
	mutf8
;

92 
	momissiÚ
;

93 
šşude
 * 
	mšşudes
;

97 
symbŞ
 * 
g‘_šput
(symbŞ * 
p
);

98 
tok’i£r
 * 
ü—‹_tok’i£r
(
symbŞ
 * 
b
);

99 
»ad_tok’
(
tok’i£r
 * 
t
);

100 
by‹
 * 
Çme_of_tok’
(
code
);

101 
şo£_tok’i£r
(
tok’i£r
 * 
t
);

103 
	etok’_codes
 {

105 
	~"syswÜds2.h
"

107 
	mc_m©hassign
,

108 
	mc_Çme
,

109 
	mc_numb”
,

110 
	mc_l™”®¡ršg
,

111 
	mc_Ãg
,

112 
	mc_ÿÎ
,

113 
	mc_groupšg
,

114 
	mc_boŞ‹¡


117 
¥aû_couÁ
;

118 * 
check_m®loc
(
n
);

119 
check_ä“
(* 
p
);

121 
	gnode
;

123 
	sÇme
 {

125 
Çme
 * 
	mÃxt
;

126 
symbŞ
 * 
	mb
;

127 
	mty³
;

128 
	mmode
;

129 
node
 * 
	mdefš™iÚ
;

130 
	mcouÁ
;

131 
	mamÚg_func_couÁ
;

132 
groupšg
 * 
	mgroupšg
;

133 
by‹
 
	m»ã»nûd
;

134 
by‹
 
	mu£d
;

135 
by‹
 
	mroutše_ÿÎed_äom_amÚg
;

139 
	sl™”®¡ršg
 {

141 
l™”®¡ršg
 * 
	mÃxt
;

142 
symbŞ
 * 
	mb
;

146 
	samÚgvec
 {

148 
symbŞ
 * 
	mb
;

149 
	msize
;

150 
node
 * 
	mp
;

151 
	mi
;

152 
	m»suÉ
;

153 
Çme
 * 
	mfunùiÚ
;

157 
	samÚg
 {

159 
amÚg
 * 
	mÃxt
;

160 
amÚgvec
 * 
	mb
;

161 
	mnumb”
;

162 
	ml™”®¡ršg_couÁ
;

163 
	mcommªd_couÁ
;

164 
	mhave_funcs
;

165 
node
 * 
	m¡¬‹r
;

166 
node
 * 
	msub¡ršg
;

169 
	sgroupšg
 {

171 
groupšg
 * 
	mÃxt
;

172 
	mnumb”
;

173 
symbŞ
 * 
	mb
;

174 
	mÏrge¡_ch
;

175 
	msm®Ë¡_ch
;

176 
by‹
 
	mno_g­s
;

177 
Çme
 * 
	mÇme
;

180 
	snode
 {

182 
node
 * 
	mÃxt
;

183 
node
 * 
	mËá
;

184 
node
 * 
	maux
;

185 
amÚg
 * 
	mamÚg
;

186 
node
 * 
	mright
;

187 
	mty³
;

188 
	mmode
;

189 
node
 * 
	mAE
;

190 
Çme
 * 
	mÇme
;

191 
symbŞ
 * 
	ml™”®¡ršg
;

192 
	mnumb”
;

193 
	mlše_numb”
;

194 
	mamÚgv¬_Ãeded
;

197 
	eÇme_ty³s
 {

199 
	mt_size
 = 6,

201 
	mt_¡ršg
 = 0, 
	mt_boŞ—n
 = 1, 
	mt_š‹g”
 = 2, 
	mt_routše
 = 3, 
	mt_ex‹º®
 = 4,

202 
	mt_groupšg
 = 5

218 
	sª®y£r
 {

220 
tok’i£r
 * 
	mtok’i£r
;

221 
node
 * 
	mnodes
;

222 
Çme
 * 
	mÇmes
;

223 
l™”®¡ršg
 * 
	ml™”®¡ršgs
;

224 
	mmode
;

225 
by‹
 
	mmodifyabË
;

226 
node
 * 
	m´og¿m
;

227 
node
 * 
	m´og¿m_’d
;

228 
	mÇme_couÁ
[
t_size
];

229 
amÚg
 * 
	mamÚgs
;

230 
amÚg
 * 
	mamÚgs_’d
;

231 
	mamÚg_couÁ
;

232 
	mamÚgv¬_Ãeded
;

233 
groupšg
 * 
	mgroupšgs
;

234 
groupšg
 * 
	mgroupšgs_’d
;

235 
node
 * 
	msub¡ršg
;

236 
by‹
 
	mutf8
;

239 
	eª®y£r_modes
 {

241 
	mm_fÜw¬d
 = 0, 
	mm_backw¬d


245 
´št_´og¿m
(
ª®y£r
 * 
a
);

246 
ª®y£r
 * 
ü—‹_ª®y£r
(
tok’i£r
 * 
t
);

247 
şo£_ª®y£r
(
ª®y£r
 * 
a
);

249 
»ad_´og¿m
(
ª®y£r
 * 
a
);

251 
	sg’”©Ü
 {

253 
ª®y£r
 * 
	mª®y£r
;

254 
İtiÚs
 * 
	mİtiÚs
;

255 
	muÄ—chabË
;

257 
	mv¬_numb”
;

258 
¡r
 * 
	moutbuf
;

259 
¡r
 * 
	mdeş¬©iÚs
;

260 
	mÃxt_Ïb–
;

261 
	mm¬gš
;

263 
	mçu»_k“p_couÁ
;

264 #iâdeà
DISABLE_JAVA


265 
¡r
 * 
	mçu»_¡r
;

268 
	mÏb–_u£d
;

269 
	mçu»_Ïb–
;

270 
	mdebug_couÁ
;

272 cÚ¡ * 
	mS
[10];

273 
symbŞ
 * 
	mB
[10];

274 
	mI
[10];

275 
Çme
 * 
	mV
[5];

276 
symbŞ
 * 
	mL
[5];

278 
	mlše_couÁ
;

279 
	mlše_Ïb–Ëd
;

280 
	ml™”®¡ršg_couÁ
;

281 
	mk“p_couÁ
;

284 
	sİtiÚs
 {

288 * 
	mouut_fe
;

289 * 
	mÇme
;

290 
FILE
 * 
	mouut_c
;

291 
FILE
 * 
	mouut_h
;

292 #iâdeà
DISABLE_JAVA


293 
FILE
 * 
	mouut_java
;

295 
by‹
 
	msyÁax_Œ“
;

296 
by‹
 
	mwidech¬s
;

297 ’um { 
	mLANG_JAVA
, 
	mLANG_C
, 
	mLANG_CPLUSPLUS
 } 
	mmake_Ïng
;

298 * 
	mex‹º®s_´efix
;

299 * 
	mv¬ŸbËs_´efix
;

300 * 
	mruÁime_·th
;

301 * 
	m·»Á_şass_Çme
;

302 
šşude
 * 
	mšşudes
;

303 
šşude
 * 
	mšşudes_’d
;

304 
by‹
 
	mutf8
;

308 
g’”©Ü
 * 
ü—‹_g’”©Ü_c
(
ª®y£r
 * 
a
, 
İtiÚs
 * 
o
);

309 
şo£_g’”©Ü_c
(
g’”©Ü
 * 
g
);

311 
g’”©e_´og¿m_c
(
g’”©Ü
 * 
g
);

313 #iâdeà
DISABLE_JAVA


315 
g’”©Ü
 * 
ü—‹_g’”©Ü_java
(
ª®y£r
 * 
a
, 
İtiÚs
 * 
o
);

316 
şo£_g’”©Ü_java
(
g’”©Ü
 * 
g
);

318 
g’”©e_´og¿m_java
(
g’”©Ü
 * 
g
);

	@languages/compiler/space.c

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<¡ršg.h
>

6 
	~"h—d”.h
"

8 
	#HEAD
 2*()

	)

9 
	#EXTENDER
 40

	)

53 
symbŞ
 * 
	$ü—‹_b
(
n
) {

54 
symbŞ
 * 
p
 = (symbŞ *è(
HEAD
 + (*è
	`MALLOC
(HEAD + (
n
 + 1) * (symbol)));

55 
	`CAPACITY
(
p
èğ
n
;

56 
	`SIZE
(
p
) = 0;

57  
p
;

58 
	}
}

60 
	$»pÜt_b
(
FILE
 * 
out
, 
symbŞ
 * 
p
) {

61 
i
;

62 
i
 = 0; i < 
	`SIZE
(
p
); i++è
	`årštf
(
out
, "%c",…[i]);

63 
	}
}

65 
	$lo£_b
(
symbŞ
 * 
p
) {

66 ià(
p
 == 0) ;

67 
	`FREE
((*è
p
 - 
HEAD
);

68 
	}
}

70 
symbŞ
 * 
	$šü—£_ÿ·c™y
(
symbŞ
 * 
p
, 
n
) {

71 
symbŞ
 * 
q
 = 
	`ü—‹_b
(
	`CAPACITY
(
p
è+ 
n
 + 
EXTENDER
);

72 
	`memmove
(
q
, 
p
, 
	`CAPACITY
Õè* (
symbŞ
));

73 
	`SIZE
(
q
èğSIZE(
p
);

74 
	`lo£_b
(
p
);  
q
;

75 
	}
}

77 
symbŞ
 * 
	$move_to_b
(
symbŞ
 * 
p
, 
n
, symbŞ * 
q
) {

78 
x
 = 
n
 - 
	`CAPACITY
(
p
);

79 ià(
x
 > 0è
p
 = 
	`šü—£_ÿ·c™y
(p, x);

80 
	`memmove
(
p
, 
q
, 
n
 * (
symbŞ
)); 
	`SIZE
(p) =‚; …;

81 
	}
}

83 
symbŞ
 * 
	$add_to_b
(
symbŞ
 * 
p
, 
n
, symbŞ * 
q
) {

84 
x
 = 
	`SIZE
(
p
è+ 
n
 - 
	`CAPACITY
(p);

85 ià(
x
 > 0è
p
 = 
	`šü—£_ÿ·c™y
(p, x);

86 
	`memmove
(
p
 + 
	`SIZE
Õ), 
q
, 
n
 * (
symbŞ
)); SIZE(p) +=‚; …;

87 
	}
}

89 
symbŞ
 * 
	$cİy_b
(
symbŞ
 * 
p
) {

90 
n
 = 
	`SIZE
(
p
);

91 
symbŞ
 * 
q
 = 
	`ü—‹_b
(
n
);

92 
	`move_to_b
(
q
, 
n
, 
p
);

93  
q
;

94 
	}
}

96 
¥aû_couÁ
 = 0;

98 * 
	$check_m®loc
(
n
) {

99 
¥aû_couÁ
++;

100  
	`m®loc
(
n
);

101 
	}
}

103 
	$check_ä“
(* 
p
) {

104 
¥aû_couÁ
--;

105 
	`ä“
(
p
);

106 
	}
}

110 * 
	$b_to_s
(
symbŞ
 * 
p
) {

111 
n
 = 
	`SIZE
(
p
);

112 * 
s
 = (*)
	`m®loc
(
n
 + 1);

114 
i
;

115 
i
 = 0; i < 
n
; i++) {

116 ià(
p
[
i
] > 255) {

117 
	`´štf
("IÀb_to_s, cª'ˆcÚv”ˆp[%d]Øch¬ beÿu£ it' 0x%02x\n", 
i
, ()
p
[i]);

118 
	`ex™
(1);

120 
s
[
i
] = ()
p
[i];

123 
s
[
n
] = 0;

124  
s
;

125 
	}
}

130 
symbŞ
 * 
	$add_s_to_b
(
symbŞ
 * 
p
, cÚ¡ * 
s
) {

131 
n
 = 
	`¡¾’
(
s
);

132 
k
;

133 ià(
p
 =ğ0è°ğ
	`ü—‹_b
(
n
);

134 
k
 = 
	`SIZE
(
p
);

136 
x
 = 
k
 + 
n
 - 
	`CAPACITY
(
p
);

137 ià(
x
 > 0è
p
 = 
	`šü—£_ÿ·c™y
(p, x);

140 
i
;

141 
i
 = 0; i < 
n
; i++è
p
[˜+ 
k
] = 
s
[i];

143 
	`SIZE
(
p
è+ğ
n
;

144  
p
;

145 
	}
}

151 
	s¡r
 {

152 
symbŞ
 * 
d©a
;

156 
¡r
 * 
	$¡r_Ãw
() {

158 
¡r
 * 
ouut
 = (¡¸*è
	`m®loc
((str));

159 
ouut
->
d©a
 = 
	`ü—‹_b
(0);

160  
ouut
;

161 
	}
}

164 
	$¡r_d–‘e
(
¡r
 * str) {

166 
	`lo£_b
(
¡r
->
d©a
);

167 
	`ä“
(
¡r
);

168 
	}
}

171 
	$¡r_­³nd
(
¡r
 * sŒ, ¡¸* 
add
) {

173 
symbŞ
 * 
q
 = 
add
->
d©a
;

174 
¡r
->
d©a
 = 
	`add_to_b
(¡r->d©a, 
	`SIZE
(
q
), q);

175 
	}
}

178 
	$¡r_­³nd_ch
(
¡r
 * sŒ, 
add
) {

180 
symbŞ
 
q
[1];

181 
q
[0] = 
add
;

182 
¡r
->
d©a
 = 
	`add_to_b
(¡r->d©a, 1, 
q
);

183 
	}
}

186 
	$¡r_­³nd_b
(
¡r
 * sŒ, 
symbŞ
 * 
q
) {

188 
¡r
->
d©a
 = 
	`add_to_b
(¡r->d©a, 
	`SIZE
(
q
), q);

189 
	}
}

192 
	$¡r_­³nd_¡ršg
(
¡r
 * sŒ, cÚ¡ * 
s
) {

194 
¡r
->
d©a
 = 
	`add_s_to_b
(¡r->d©a, 
s
);

195 
	}
}

198 
	$¡r_­³nd_št
(
¡r
 * sŒ, 
i
) {

200 
s
[30];

201 
	`¥rštf
(
s
, "%d", 
i
);

202 
	`¡r_­³nd_¡ršg
(
¡r
, 
s
);

203 
	}
}

206 
	$¡r_ş—r
(
¡r
 * str) {

208 
	`SIZE
(
¡r
->
d©a
) = 0;

209 
	}
}

212 
	$¡r_assign
(
¡r
 * sŒ, * 
s
) {

214 
	`¡r_ş—r
(
¡r
);

215 
	`¡r_­³nd_¡ršg
(
¡r
, 
s
);

216 
	}
}

219 
¡r
 * 
	$¡r_cİy
(
¡r
 * 
Şd
) {

221 
¡r
 * 
Ãw¡r
 = 
	`¡r_Ãw
();

222 
	`¡r_­³nd
(
Ãw¡r
, 
Şd
);

223  
Ãw¡r
;

224 
	}
}

227 
symbŞ
 * 
	$¡r_d©a
(
¡r
 * str) {

229  
¡r
->
d©a
;

230 
	}
}

233 
	$¡r_Ën
(
¡r
 * str) {

235  
	`SIZE
(
¡r
->
d©a
);

236 
	}
}

238 
	$g‘_utf8
(cÚ¡ 
symbŞ
 * 
p
, * 
¦Ù
) {

239 
b0
, 
b1
;

240 
b0
 = *
p
++;

241 ià(
b0
 < 0xC0) {

242 * 
¦Ù
 = 
b0
;  1;

244 
b1
 = *
p
++;

245 ià(
b0
 < 0xE0) {

246 * 
¦Ù
 = (
b0
 & 0x1Fè<< 6 | (
b1
 & 0x3F);  2;

248 * 
¦Ù
 = (
b0
 & 0xFè<< 12 | (
b1
 & 0x3Fè<< 6 | (*
p
 & 0x3F);  3;

249 
	}
}

251 
	$put_utf8
(
ch
, 
symbŞ
 * 
p
) {

252 ià(
ch
 < 0x80) {

253 
p
[0] = 
ch
;  1;

255 ià(
ch
 < 0x800) {

256 
p
[0] = (
ch
 >> 6) | 0xC0;

257 
p
[1] = (
ch
 & 0x3F) | 0x80;  2;

259 
p
[0] = (
ch
 >> 12) | 0xE0;

260 
p
[1] = ((
ch
 >> 6) & 0x3F) | 0x80;

261 
p
[2] = (
ch
 & 0x3F) | 0x80;  3;

262 
	}
}

	@languages/compiler/syswords.h

1 
sy¡em_wÜd
 
	gvoÿb
[80+1] = {

2 { 0, (
by‹
 *)"", 80+1},

4 { 1, (
by‹
 *)"$", 
c_dŞÏr
 },

5 { 1, (
by‹
 *)"(", 
c_b¿
 },

6 { 1, (
by‹
 *)")", 
c_k‘
 },

7 { 1, (
by‹
 *)"*", 
c_muÉly
 },

8 { 1, (
by‹
 *)"+", 
c_¶us
 },

9 { 1, (
by‹
 *)"-", 
c_mšus
 },

10 { 1, (
by‹
 *)"/", 
c_divide
 },

11 { 1, (
by‹
 *)"<", 
c_ls
 },

12 { 1, (
by‹
 *)"=", 
c_assign
 },

13 { 1, (
by‹
 *)">", 
c_gr
 },

14 { 1, (
by‹
 *)"?", 
c_debug
 },

15 { 1, (
by‹
 *)"[", 
c_Ëá¦iû
 },

16 { 1, (
by‹
 *)"]", 
c_right¦iû
 },

17 { 2, (
by‹
 *)"!=", 
c_Ã
 },

18 { 2, (
by‹
 *)"*=", 
c_muÉlyassign
 },

19 { 2, (
by‹
 *)"+=", 
c_¶u§ssign
 },

20 { 2, (
by‹
 *)"-=", 
c_mšu§ssign
 },

21 { 2, (
by‹
 *)"->", 
c_¦iûto
 },

22 { 2, (
by‹
 *)"/*", 
c_comm’t2
 },

23 { 2, (
by‹
 *)"//", 
c_comm’t1
 },

24 { 2, (
by‹
 *)"/=", 
c_divid—ssign
 },

25 { 2, (
by‹
 *)"<+", 
c_š£¹
 },

26 { 2, (
by‹
 *)"<-", 
c_¦iûäom
 },

27 { 2, (
by‹
 *)"<=", 
c_Ë
 },

28 { 2, (
by‹
 *)"==", 
c_eq
 },

29 { 2, (
by‹
 *)"=>", 
c_assigÁo
 },

30 { 2, (
by‹
 *)">=", 
c_ge
 },

31 { 2, (
by‹
 *)"as", 
c_as
 },

32 { 2, (
by‹
 *)"do", 
c_do
 },

33 { 2, (
by‹
 *)"Ü", 
c_Ü
 },

34 { 3, (
by‹
 *)"ªd", 
c_ªd
 },

35 { 3, (
by‹
 *)"fÜ", 
c_fÜ
 },

36 { 3, (
by‹
 *)"g‘", 
c_g‘
 },

37 { 3, (
by‹
 *)"hex", 
c_hex
 },

38 { 3, (
by‹
 *)"hİ", 
c_hİ
 },

39 { 3, (
by‹
 *)"nÚ", 
c_nÚ
 },

40 { 3, (
by‹
 *)"nÙ", 
c_nÙ
 },

41 { 3, (
by‹
 *)"£t", 
c_£t
 },

42 { 3, (
by‹
 *)"Œy", 
c_Œy
 },

43 { 4, (
by‹
 *)"ç", 
c_ç
 },

44 { 4, (
by‹
 *)"gÙo", 
c_gÙo
 },

45 { 4, (
by‹
 *)"loİ", 
c_loİ
 },

46 { 4, (
by‹
 *)"Ãxt", 
c_Ãxt
 },

47 { 4, (
by‹
 *)"size", 
c_size
 },

48 { 4, (
by‹
 *)"‹¡", 
c_‹¡
 },

49 { 4, (
by‹
 *)"Œue", 
c_Œue
 },

50 { 5, (
by‹
 *)"amÚg", 
c_amÚg
 },

51 { 5, (
by‹
 *)"çl£", 
c_çl£
 },

52 { 5, (
by‹
 *)"lim™", 
c_lim™
 },

53 { 5, (
by‹
 *)"un£t", 
c_un£t
 },

54 { 6, (
by‹
 *)"©m¬k", 
c_©m¬k
 },

55 { 6, (
by‹
 *)"©ch", 
c_©ch
 },

56 { 6, (
by‹
 *)"cursÜ", 
c_cursÜ
 },

57 { 6, (
by‹
 *)"defše", 
c_defše
 },

58 { 6, (
by‹
 *)"d–‘e", 
c_d–‘e
 },

59 { 6, (
by‹
 *)"gİa¡", 
c_gİa¡
 },

60 { 6, (
by‹
 *)"š£¹", 
c_š£¹
 },

61 { 6, (
by‹
 *)"maxšt", 
c_maxšt
 },

62 { 6, (
by‹
 *)"mššt", 
c_mššt
 },

63 { 6, (
by‹
 *)"»³©", 
c_»³©
 },

64 { 6, (
by‹
 *)"sizeof", 
c_sizeof
 },

65 { 6, (
by‹
 *)"tom¬k", 
c_tom¬k
 },

66 { 7, (
by‹
 *)"©Ëa¡", 
c_©Ëa¡
 },

67 { 7, (
by‹
 *)"©lim™", 
c_©lim™
 },

68 { 7, (
by‹
 *)"decim®", 
c_decim®
 },

69 { 7, (
by‹
 *)"»v”£", 
c_»v”£
 },

70 { 7, (
by‹
 *)"£tm¬k", 
c_£tm¬k
 },

71 { 7, (
by‹
 *)"¡ršgs", 
c_¡ršgs
 },

72 { 7, (
by‹
 *)"tŞim™", 
c_tŞim™
 },

73 { 8, (
by‹
 *)"boŞ—ns", 
c_boŞ—ns
 },

74 { 8, (
by‹
 *)"š‹g”s", 
c_š‹g”s
 },

75 { 8, (
by‹
 *)"routšes", 
c_routšes
 },

76 { 8, (
by‹
 *)"£im™", 
c_£im™
 },

77 { 9, (
by‹
 *)"backw¬ds", 
c_backw¬ds
 },

78 { 9, (
by‹
 *)"ex‹º®s", 
c_ex‹º®s
 },

79 { 9, (
by‹
 *)"groupšgs", 
c_groupšgs
 },

80 { 9, (
by‹
 *)"¡ršgdef", 
c_¡ršgdef
 },

81 { 9, (
by‹
 *)"sub¡ršg", 
c_sub¡ršg
 },

82 { 12, (
by‹
 *)"backw¬dmode", 
c_backw¬dmode
 },

83 { 13, (
by‹
 *)"¡ršgesÿ³s", 
c_¡ršgesÿ³s
 }

	@languages/compiler/syswords2.h

1 
	gc_amÚg
 = 4, 
	gc_ªd
, 
	gc_as
, 
	gc_assign
, 
	gc_assigÁo
, 
	gc_©Ëa¡
,

2 
	gc_©lim™
, 
	gc_©m¬k
, 
	gc_©ch
, 
	gc_backw¬dmode
, 
	gc_backw¬ds
,

3 
	gc_boŞ—ns
, 
	gc_b¿
, 
	gc_comm’t1
, 
	gc_comm’t2
, 
	gc_cursÜ
, 
	gc_debug
,

4 
	gc_decim®
, 
	gc_defše
, 
	gc_d–‘e
, 
	gc_divide
, 
	gc_divid—ssign
, 
	gc_do
,

5 
	gc_dŞÏr
, 
	gc_eq
, 
	gc_ex‹º®s
, 
	gc_ç
, 
	gc_çl£
, 
	gc_fÜ
, 
	gc_ge
, 
	gc_g‘
,

6 
	gc_gİa¡
, 
	gc_gÙo
, 
	gc_gr
, 
	gc_groupšgs
, 
	gc_hex
, 
	gc_hİ
, 
	gc_š£¹
,

7 
	gc_š‹g”s
, 
	gc_k‘
, 
	gc_Ë
, 
	gc_Ëá¦iû
, 
	gc_lim™
, 
	gc_loİ
, 
	gc_ls
,

8 
	gc_maxšt
, 
	gc_mššt
, 
	gc_mšus
, 
	gc_mšu§ssign
, 
	gc_muÉly
,

9 
	gc_muÉlyassign
, 
	gc_Ã
, 
	gc_Ãxt
, 
	gc_nÚ
, 
	gc_nÙ
, 
	gc_Ü
, 
	gc_¶us
,

10 
	gc_¶u§ssign
, 
	gc_»³©
, 
	gc_»v”£
, 
	gc_right¦iû
, 
	gc_routšes
,

11 
	gc_£t
, 
	gc_£im™
, 
	gc_£tm¬k
, 
	gc_size
, 
	gc_sizeof
, 
	gc_¦iûäom
,

12 
	gc_¦iûto
, 
	gc_¡ršgdef
, 
	gc_¡ršgesÿ³s
, 
	gc_¡ršgs
, 
	gc_sub¡ršg
,

13 
	gc_‹¡
, 
	gc_tŞim™
, 
	gc_tom¬k
, 
	gc_Œue
, 
	gc_Œy
, 
	gc_un£t
,

	@languages/compiler/tokeniser.c

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<¡ršg.h
>

5 
	~<ùy³.h
>

6 
	~"h—d”.h
"

8 
	ssy¡em_wÜd
 {

9 
	ms_size
;

10 
by‹
 * 
	ms
;

11 
	mcode
;

17 
	~"syswÜds.h
"

19 
	$sm®Ër
(
a
, 
b
è{ ‡ < b ?‡ : b; 
	}
}

21 
symbŞ
 * 
	$g‘_šput
(
symbŞ
 * 
p
) {

23 * 
s
 = 
	`b_to_s
(
p
);

25 
FILE
 * 
šput
 = 
	`fİ’
(
s
, "r");

26 
	`ä“
(
s
);

27 ià(
šput
 == 0)  0;

29 
symbŞ
 * 
u
 = 
	`ü—‹_b
(
STARTSIZE
);

30 
size
 = 0;

31 
»³©


32 { 
ch
 = 
	`g‘c
(
šput
);

33 ià(
ch
 =ğ
EOF
) ;

34 ià(
size
 >ğ
	`CAPACITY
(
u
)èu = 
	`šü—£_ÿ·c™y
(u, size/2);

35 
u
[
size
++] = 
ch
;

37 
	`fşo£
(
šput
);

38 
	`SIZE
(
u
èğ
size
;  u;

41 
	}
}

43 
	$”rÜ
(
tok’i£r
 * 
t
, * 
s1
, 
n
, 
symbŞ
 * 
p
, * 
s2
) {

44 ià(
t
->
”rÜ_couÁ
 =ğ20è{ 
	`årštf
(
¡d”r
, "...ƒtc\n"); 
	`ex™
(1); }

45 
	`årštf
(
¡d”r
, "Lš%d", 
t
->
lše_numb”
);

46 ià(
t
->
g‘_d•th
 > 0è
	`årštf
(
¡d”r
, " (of included file)");

47 
	`årštf
(
¡d”r
, ": ");

48 
	`uÆess
 (
s1
 =ğ0è
	`årštf
(
¡d”r
, "%s", s1);

49 
	`uÆess
 (
p
 == 0) {

50 
i
;

51 
i
 = 0; i < 
n
; i++è
	`årštf
(
¡d”r
, "%c", 
p
[i]);

53 
	`uÆess
 (
s2
 =ğ0è
	`årštf
(
¡d”r
, "%s", s2);

54 
	`årštf
(
¡d”r
, "\n");

55 
t
->
”rÜ_couÁ
++;

56 
	}
}

58 
	$”rÜ1
(
tok’i£r
 * 
t
, * 
s
) {

59 
	`”rÜ
(
t
, 
s
, 0,0, 0);

60 
	}
}

62 
	$”rÜ2
(
tok’i£r
 * 
t
, * 
s
) {

63 
	`”rÜ
(
t
, "uÃx³ùedƒnd oà‹xˆaá” ", 0,0, 
s
);

64 
	}
}

66 
	$com·»_wÜds
(
m
, 
symbŞ
 * 
p
, 
n
, 
by‹
 * 
q
) {

67 
	`uÆess
 (
m
 =ğ
n
)  m -‚;

69 
i
; ˜ğ0; i < 
n
; i++) {

70 
diff
 = 
p
[
i
] - 
q
[i];

71 
	`uÆess
 (
diff
 == 0)  diff;

75 
	}
}

77 
	$fšd_wÜd
(
n
, 
symbŞ
 * 
p
) {

78 
i
 = 0; 
j
 = 
voÿb
->
code
;

79 
»³©
 {

80 
k
 = 
i
 + (
j
 - i)/2;

81 
sy¡em_wÜd
 * 
w
 = 
voÿb
 + 
k
;

82 
diff
 = 
	`com·»_wÜds
(
n
, 
p
, 
w
->
s_size
, w->
s
);

83 ià(
diff
 =ğ0è 
w
->
code
;

84 ià(
diff
 < 0è
j
 = 
k
; 
i
 = k;

85 ià(
j
 - 
i
 == 1) ;

88 
	}
}

90 
	$g‘_numb”
(
n
, 
symbŞ
 * 
p
) {

91 
x
 = 0;

92 
i
; ˜ğ0; i < 
n
; i++è
x
 = 10*x + 
p
[i] - '0';

93  
x
;

94 
	}
}

96 
	$eq_s
(
tok’i£r
 * 
t
, * 
s
) {

97 
l
 = 
	`¡¾’
(
s
);

98 ià(
	`SIZE
(
t
->
p
è-->
c
 < 
l
è 
çl£
;

100 
i
;

101 
i
 = 0; i < 
l
; i++èià(
t
->
p
[t->
c
 + i] !ğ
s
[i]è 
çl£
;

103 
t
->
c
 +ğ
l
;  
Œue
;

104 
	}
}

106 
	$wh™e_¥aû
(
tok’i£r
 * 
t
, 
ch
) {

107 
ch
) {

108 '\n': 
t
->
lše_numb”
++;

111 ' ':  
Œue
;

113  
çl£
;

114 
	}
}

116 
symbŞ
 * 
	$fšd_š_m
(
tok’i£r
 * 
t
, 
n
, 
symbŞ
 * 
p
) {

117 
m_·œ
 * 
q
 = 
t
->
m_·œs
;

118 
»³©
 {

119 ià(
q
 == 0)  0;

121 
symbŞ
 * 
Çme
 = 
q
->name;

122 ià(
n
 =ğ
	`SIZE
(
Çme
è&& 
	`memcmp
Òame, 
p
,‚ * (
symbŞ
)è=ğ0è 
q
->
v®ue
;

124 
q
 = q->
Ãxt
;

126 
	}
}

128 
	$»ad_l™”®_¡ršg
(
tok’i£r
 * 
t
, 
c
) {

129 
symbŞ
 * 
p
 = 
t
->p;

130 
ch
;

131 
	`SIZE
(
t
->
b
) = 0;

132 
»³©
 {

133 ià(
c
 >ğ
	`SIZE
(
p
)è{ 
	`”rÜ2
(
t
, "'");  c; }

134 
ch
 = 
p
[
c
];

135 ià(
ch
 =ğ'\n'è{ 
	`”rÜ1
(
t
, "¡ršg‚Ù”mš©ed");  
c
; }

136 
c
++;

137 ià(
ch
 =ğ
t
->
m_¡¬t
) {

138 
c0
 = 
c
;

139 
Ãwlšes
 = 
çl£
;

140 
bÏck_found
 = 
çl£
;

141 
»³©
 {

142 ià(
c
 >ğ
	`SIZE
(
p
)è{ 
	`”rÜ2
(
t
, "'");  c; }

143 
ch
 = 
p
[
c
]; c++;

144 ià(
ch
 =ğ
t
->
m_’d
) ;

145 
	`uÆess
 (
	`wh™e_¥aû
(
t
, 
ch
)è
bÏck_found
 = 
Œue
;

146 ià(
ch
 =ğ'\n'è
Ãwlšes
 = 
Œue
;

147 ià(
Ãwlšes
 && 
bÏck_found
) {

148 
	`”rÜ1
(
t
, "string‚oterminated");

149  
c
;

152 
	`uÆess
 (
Ãwlšes
) {

153 
n
 = 
c
 - 
c0
 - 1;

154 
fœ¡ch
 = 
p
[
c0
];

155 
symbŞ
 * 
q
 = 
	`fšd_š_m
(
t
, 
n
, 
p
 + 
c0
);

156 ià(
q
 == 0) {

157 ià(
n
 =ğ1 && (
fœ¡ch
 =ğ'\'' || fœ¡ch =ğ
t
->
m_¡¬t
))

158 
t
->
b
 = 
	`add_to_b
Ñ->b, 1, 
p
 + 
c0
);

160 
	`”rÜ
(
t
, "¡ršg maüØ'", 
n
, 
p
 + 
c0
, "' undeclared");

162 
t
->
b
 = 
	`add_to_b
Ñ->b, 
	`SIZE
(
q
), q);

165 ià(
ch
 =ğ'\''è 
c
;

166 
t
->
b
 = 
	`add_to_b
Ñ->b, 1, 
p
 + 
c
 - 1);

169 
	}
}

171 
	$Ãxt_tok’
(
tok’i£r
 * 
t
) {

172 
symbŞ
 * 
p
 = 
t
->p;

173 
c
 = 
t
->c;

174 
ch
;

175 
code
 = -1;

176 
»³©
 {

177 ià(
c
 >ğ
	`SIZE
(
p
)è{ 
t
->c = c;  -1; }

178 
ch
 = 
p
[
c
];

179 ià(
	`wh™e_¥aû
(
t
, 
ch
)è{ 
c
++; ; }

180 ià(
	`i§Íha
(
ch
)) {

181 
c0
 = 
c
;

182 
c
 < 
	`SIZE
(
p
è&& (
	`i§Êum
(p[c]) ||…[c] == '_')) c++;

183 
code
 = 
	`fšd_wÜd
(
c
 - 
c0
, 
p
 + c0);

184 ià(
code
 < 0) {

185 
t
->
b
 = 
	`move_to_b
Ñ->b, 
c
 - 
c0
, 
p
 + c0);

186 
code
 = 
c_Çme
;

189 ià(
	`isdig™
(
ch
)) {

190 
c0
 = 
c
;

191 
c
 < 
	`SIZE
(
p
è&& 
	`isdig™
(p[c])) c++;

192 
t
->
numb”
 = 
	`g‘_numb”
(
c
 - 
c0
, 
p
 + c0);

193 
code
 = 
c_numb”
;

195 ià(
ch
 == '\'') {

196 
c
 = 
	`»ad_l™”®_¡ršg
(
t
, c + 1);

197 
code
 = 
c_l™”®¡ršg
;

200 
lim
 = 
	`sm®Ër
(2, 
	`SIZE
(
p
è- 
c
);

201 
i
;

202 
i
 = 
lim
; i > 0; i--) {

203 
code
 = 
	`fšd_wÜd
(
i
, 
p
 + 
c
);

204 ià(
code
 >ğ0è{ 
c
 +ğ
i
; ; }

207 ià(
code
 >= 0) {

208 
t
->
c
 = c;

209  
code
;

211 
	`”rÜ
(
t
, "'", 1, 
p
 + 
c
, "' unknown");

212 
c
++;

215 
	}
}

217 
	$Ãxt_ch¬
(
tok’i£r
 * 
t
) {

218 ià(
t
->
c
 >ğ
	`SIZE
Ñ->
p
))  -1;

219  
t
->
p
[t->
c
++];

220 
	}
}

222 
	$Ãxt_»®_ch¬
(
tok’i£r
 * 
t
) {

223 
»³©
 {

224 
ch
 = 
	`Ãxt_ch¬
(
t
);

225 ià(
	`wh™e_¥aû
(
t
, 
ch
)) ;

226  
ch
;

228 
	}
}

230 
	$»ad_ch¬s
(
tok’i£r
 * 
t
) {

231 
ch
 = 
	`Ãxt_»®_ch¬
(
t
);

232 ià(
ch
 < 0è{ 
	`”rÜ2
(
t
, "stringdef"); ; }

234 
c0
 = 
t
->
c
-1;

235 
»³©
 {

236 
ch
 = 
	`Ãxt_ch¬
(
t
);

237 ià(
	`wh™e_¥aû
(
t
, 
ch
) || ch < 0) ;

239 
t
->
b2
 = 
	`move_to_b
Ñ->b2,->
c
 - 
c0
 - 1,->
p
 + c0);

241 
	}
}

243 
	$decim®_to_num
(
ch
) {

244 ià('0' <ğ
ch
 && ch <= '9')  ch - '0';

246 
	}
}

248 
	$hex_to_num
(
ch
) {

249 ià('0' <ğ
ch
 && ch <= '9')  ch - '0';

250 ià('a' <ğ
ch
 && ch <= 'f')  ch - 'a' + 10;

252 
	}
}

254 
	$cÚv”t_num”ic_¡ršg
(
tok’i£r
 * 
t
, 
symbŞ
 * 
p
, 
ba£
) {

255 
c
 = 0; 
d
 = 0;

256 
»³©
 {

257 
c
 < 
	`SIZE
(
p
) &&…[c] == ' ') c++;

258 ià(
c
 =ğ
	`SIZE
(
p
)) ;

260 
numb”
 = 0;

261 
»³©
 {

262 
ch
 = 
p
[
c
];

263 ià(
c
 =ğ
	`SIZE
(
p
è|| 
ch
 == ' ') ;

264 ià(
ba£
 == 10) {

265 
ch
 = 
	`decim®_to_num
(ch);

266 ià(
ch
 < 0) {

267 
	`”rÜ1
(
t
, "decimal string contains‚on-digits");

271 
ch
 = 
	`hex_to_num
(
	`tŞow”
(ch));

272 ià(
ch
 < 0) {

273 
	`”rÜ1
(
t
, "hex string contains‚on-hex characters");

277 
numb”
 = 
ba£
 *‚umb” + 
ch
;

278 
c
++;

280 ià(
t
->
widech¬s
 ||->
utf8
) {

281 
	`uÆess
 (0 <ğ
numb”
 &&‚umber <= 0xffff) {

282 
	`”rÜ1
(
t
, "character valuesƒxceed 64K");

286 
	`uÆess
 (0 <ğ
numb”
 &&‚umber <= 0xff) {

287 
	`”rÜ1
(
t
, "character valuesƒxceed 256");

291 ià(
t
->
utf8
)

292 
d
 +ğ
	`put_utf8
(
numb”
, 
p
 + d);

294 
p
[
d
++] = 
numb”
;

297 
	`SIZE
(
p
èğ
d
;

298 
	}
}

300 
	$»ad_tok’
(
tok’i£r
 * 
t
) {

301 
symbŞ
 * 
p
 = 
t
->p;

302 
h–d
 = 
t
->
tok’_h–d
;

303 
t
->
tok’_h–d
 = 
çl£
;

304 ià(
h–d
è 
t
->
tok’
;

305 
»³©
 {

306 
code
 = 
	`Ãxt_tok’
(
t
);

307 
code
) {

308 
c_comm’t1
:

309 
t
->
c
 < 
	`SIZE
(
p
) &&…[t->c] != '\n')->c++;

311 
c_comm’t2
:

312 
»³©
 {

313 ià(
t
->
c
 >ğ
	`SIZE
(
p
)) {

314 
	`”rÜ1
(
t
, "/* comment‚oterminated");

315 
t
->
tok’
 = -1;

318 ià(
p
[
t
->
c
] =ğ'\n'èt->
lše_numb”
++;

319 ià(
	`eq_s
(
t
, "*/")) ;

320 
t
->
c
++;

323 
c_¡ršgesÿ³s
:

325 
ch1
 = 
	`Ãxt_»®_ch¬
(
t
);

326 
ch2
 = 
	`Ãxt_»®_ch¬
(
t
);

327 ià(
ch2
 < 0)

328 { 
	`”rÜ2
(
t
, "stringescapes"); ; }

329 ià(
ch1
 == '\'')

330 { 
	`”rÜ1
(
t
, "first stringescape cannot be '"); ; }

331 
t
->
m_¡¬t
 = 
ch1
;

332 
t
->
m_’d
 = 
ch2
;

335 
c_¡ršgdef
:

337 
ba£
 = 0;

338 
	`»ad_ch¬s
(
t
);

339 
code
 = 
	`»ad_tok’
(
t
);

340 ià(
code
 =ğ
c_hex
è{ 
ba£
 = 16; codğ
	`»ad_tok’
(
t
); } 

341 ià(
code
 =ğ
c_decim®
è{ 
ba£
 = 10; codğ
	`»ad_tok’
(
t
); }

342 
	`uÆess
 (
code
 =ğ
c_l™”®¡ršg
)

343 { 
	`”rÜ1
(
t
, "string omitted‡fter stringdef"); ; }

344 ià(
ba£
 > 0è
	`cÚv”t_num”ic_¡ršg
(
t
,->
b
, base);

345 { 
	`NEW
(
m_·œ
, 
q
);

346 
q
->
Ãxt
 = 
t
->
m_·œs
;

347 
q
->
Çme
 = 
	`cİy_b
(
t
->
b2
);

348 
q
->
v®ue
 = 
	`cİy_b
(
t
->
b
);

349 
t
->
m_·œs
 = 
q
;

353 
c_g‘
:

354 
code
 = 
	`»ad_tok’
(
t
);

355 
	`uÆess
 (
code
 =ğ
c_l™”®¡ršg
) {

356 
	`”rÜ1
(
t
, "string omitted‡fter get"); ;

358 
t
->
g‘_d•th
++;

359 ià(
t
->
g‘_d•th
 > 10) {

360 
	`årštf
(
¡d”r
, "get directives go 10 deep. Looping?\n");

361 
	`ex™
(1);

364 
	`NEW
(
šput
, 
q
);

365 
symbŞ
 * 
u
 = 
	`g‘_šput
(
t
->
b
);

366 ià(
u
 == 0) {

367 
šşude
 * 
r
 = 
t
->
šşudes
;

368 
	`uÁ
 (
r
 == 0) {

369 
symbŞ
 * 
b
 = 
	`cİy_b
(
r
->b);

370 
b
 = 
	`add_to_b
(b, 
	`SIZE
(
t
->b),->b);

371 
u
 = 
	`g‘_šput
(
b
);

372 
	`lo£_b
(
b
);

373 
	`uÆess
 (
u
 == 0) ;

374 
r
 =„->
Ãxt
;

377 ià(
u
 == 0) {

378 
	`”rÜ
(
t
, "Cª'ˆg‘ '", 
	`SIZE
Ñ->
b
),->b, "'");

379 
	`ex™
(1);

381 
	`memmove
(
q
, 
t
, (
šput
));

382 
t
->
Ãxt
 = 
q
;

383 
t
->
p
 = 
u
;

384 
t
->
c
 = 0;

385 
t
->
lše_numb”
 = 1;

387 
p
 = 
t
->p;

390 
	`uÆess
 (
t
->
Ãxt
 == 0) {

391 
	`lo£_b
(
p
);

393 
šput
 * 
q
 = 
t
->
Ãxt
;

394 
	`memmove
(
t
, 
q
, (
šput
)); 
p
 =->p;

395 
	`FREE
(
q
);

397 
t
->
g‘_d•th
--;

402 
t
->
´evious_tok’
 =->
tok’
;

403 
t
->
tok’
 = 
code
;

404  
code
;

407 
	}
}

409 
by‹
 * 
	$Çme_of_tok’
(
code
) {

410 
i
;

411 
i
 = 1; i < 
voÿb
->
code
; i++)

412 ià((
voÿb
 + 
i
)->
code
 =ğcodeè (voÿb + i)->
s
;

413 
code
) {

414 
c_m©hassign
:  (
by‹
 *) "=";

415 
c_Çme
:  (
by‹
 *) "name";

416 
c_numb”
:  (
by‹
 *) "number";

417 
c_l™”®¡ršg
: (
by‹
 *) "literal";

418 
c_Ãg
:  (
by‹
 *) "neg";

419 
c_groupšg
:  (
by‹
 *) "grouping";

420 
c_ÿÎ
:  (
by‹
 *) "call";

421 
c_boŞ‹¡
:  (
by‹
 *) "Booleanest";

422 -2:  (
by‹
 *) "start ofext";

423 -1:  (
by‹
 *) "end ofext";

424 :  (
by‹
 *) "?";

426 
	}
}

428 
tok’i£r
 * 
	$ü—‹_tok’i£r
(
symbŞ
 * 
p
) {

429 
	`NEW
(
tok’i£r
, 
t
);

430 
t
->
Ãxt
 = 0;

431 
t
->
p
 =…;

432 
t
->
c
 = 0;

433 
t
->
lše_numb”
 = 1;

434 
t
->
b
 = 
	`ü—‹_b
(0);

435 
t
->
b2
 = 
	`ü—‹_b
(0);

436 
t
->
m_¡¬t
 = -1;

437 
t
->
m_·œs
 = 0;

438 
t
->
g‘_d•th
 = 0;

439 
t
->
”rÜ_couÁ
 = 0;

440 
t
->
tok’_h–d
 = 
çl£
;

441 
t
->
tok’
 = -2;

442 
t
->
´evious_tok’
 = -2;

443  
t
;

444 
	}
}

446 
	$şo£_tok’i£r
(
tok’i£r
 * 
t
) {

447 
	`lo£_b
(
t
->
b
);

448 
	`lo£_b
(
t
->
b2
);

450 
m_·œ
 * 
q
 = 
t
->
m_·œs
;

451 
	`uÁ
 (
q
 == 0) {

452 
m_·œ
 * 
q_Ãxt
 = 
q
->
Ãxt
;

453 
	`lo£_b
(
q
->
Çme
);

454 
	`lo£_b
(
q
->
v®ue
);

455 
	`FREE
(
q
);

456 
q
 = 
q_Ãxt
;

460 
šput
 * 
q
 = 
t
->
Ãxt
;

461 
	`uÁ
 (
q
 == 0) {

462 
šput
 * 
q_Ãxt
 = 
q
->
Ãxt
;

463 
	`FREE
(
q
);

464 
q
 = 
q_Ãxt
;

467 
	`FREE
(
t
);

468 
	}
}

	@languages/danish.cc

3 
	~<lim™s.h
>

4 
	~"dªish.h
"

6 
	#s_0_0
 (
s_0_1
 + 2)

	)

7 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

8 
	#s_0_1
 0

	)

10 
	#s_0_2
 
s_0_4


	)

11 
	#s_0_3
 (
s_0_0
 + 1)

	)

12 
	#s_0_4
 5

	)

14 
	#s_0_5
 (
s_0_6
 + 2)

	)

15 
	#s_0_6
 
s_0_20


	)

16 
	#s_0_7
 
s_0_21


	)

17 
	#s_0_8
 
s_0_22


	)

18 
	#s_0_9
 
s_0_2


	)

19 
	#s_0_10
 
s_0_5


	)

20 
	#s_0_11
 
s_0_25


	)

21 
	#s_0_12
 
s_0_6


	)

22 
	#s_0_13
 
s_0_2


	)

23 
	#s_0_14
 10

	)

25 
	#s_0_15
 15

	)

27 
	#s_0_16
 (
s_0_17
 + 3)

	)

28 
	#s_0_17
 19

	)

30 
	#s_0_18
 (
s_0_19
 + 3)

	)

31 
	#s_0_19
 (
s_0_20
 + 2)

	)

32 
	#s_0_20
 23

	)

34 
	#s_0_21
 30

	)

36 
	#s_0_22
 34

	)

38 
	#s_0_23
 39

	)

40 
	#s_0_24
 (
s_0_25
 + 3)

	)

41 
	#s_0_25
 43

	)

43 
	#s_0_26
 49

	)

45 
	#s_0_27
 54

	)

47 
	#s_0_28
 (
s_0_29
 + 2)

	)

48 
	#s_0_29
 57

	)

50 
	#s_0_30
 
s_0_1


	)

51 
	#s_0_31
 
s_0_29


	)

52 
	#s_1_0
 62

	)

54 
	#s_1_1
 64

	)

56 
	#s_1_2
 66

	)

58 
	#s_1_3
 68

	)

60 
	#s_2_0
 (
s_2_1
 + 1)

	)

61 
	#s_2_1
 (
s_2_2
 + 1)

	)

62 
	#s_2_2
 70

	)

64 
	#s_2_3
 74

	)

66 
	#s_2_4
 77

	)

71 cÚ¡ 
amÚg
 
	ga_0
[32] =

73  { 3, 
s_0_0
, -1, 1},

74  { 5, 
s_0_1
, 0, 1},

75  { 4, 
s_0_2
, -1, 1},

76  { 1, 
s_0_3
, -1, 1},

77  { 5, 
s_0_4
, 3, 1},

78  { 4, 
s_0_5
, 3, 1},

79  { 6, 
s_0_6
, 5, 1},

80  { 3, 
s_0_7
, 3, 1},

81  { 4, 
s_0_8
, 3, 1},

82  { 3, 
s_0_9
, 3, 1},

83  { 2, 
s_0_10
, -1, 1},

84  { 5, 
s_0_11
, 10, 1},

85  { 4, 
s_0_12
, 10, 1},

86  { 2, 
s_0_13
, -1, 1},

87  { 5, 
s_0_14
, 13, 1},

88  { 4, 
s_0_15
, 13, 1},

89  { 1, 
s_0_16
, -1, 2},

90  { 4, 
s_0_17
, 16, 1},

91  { 2, 
s_0_18
, 16, 1},

92  { 5, 
s_0_19
, 18, 1},

93  { 7, 
s_0_20
, 19, 1},

94  { 4, 
s_0_21
, 18, 1},

95  { 5, 
s_0_22
, 18, 1},

96  { 4, 
s_0_23
, 18, 1},

97  { 3, 
s_0_24
, 16, 1},

98  { 6, 
s_0_25
, 24, 1},

99  { 5, 
s_0_26
, 24, 1},

100  { 3, 
s_0_27
, 16, 1},

101  { 3, 
s_0_28
, 16, 1},

102  { 5, 
s_0_29
, 28, 1},

103  { 2, 
s_0_30
, -1, 1},

104  { 4, 
s_0_31
, 30, 1}

108 cÚ¡ 
amÚg
 
	ga_1
[4] =

110  { 2, 
s_1_0
, -1, -1},

111  { 2, 
s_1_1
, -1, -1},

112  { 2, 
s_1_2
, -1, -1},

113  { 2, 
s_1_3
, -1, -1}

117 cÚ¡ 
amÚg
 
	ga_2
[5] =

119  { 2, 
s_2_0
, -1, 1},

120  { 3, 
s_2_1
, 0, 1},

121  { 4, 
s_2_2
, 1, 1},

122  { 3, 
s_2_3
, -1, 1},

123  { 5, 
s_2_4
, -1, 2}

126 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 48, 0, 128 };

128 cÚ¡ 
	gg_s_’dšg
[] = { 239, 254, 42, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16 };

130 cÚ¡ 
symbŞ
 
	gs_0
[] = { 's', 't' };

131 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'i', 'g' };

132 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'l', 0xC3, 0xB8, 's' };

134 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::
	$r_m¬k_»giÚs
() {

135 
I_p1
 = 
l
;

136 { 
c_‹¡1
 = 
c
;

137 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 3);

138 ià(
»t
 < 0)  0;

139 
c
 = 
»t
;

141 
I_x
 = 
c
;

142 
c
 = 
c_‹¡1
;

144 ià(
	`out_groupšg_U
(
g_v
, 97, 248, 1) < 0)  0;

145 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 248, 1);

146 ià(
»t
 < 0)  0;

147 
c
 +ğ
»t
;

149 
I_p1
 = 
c
;

151 ià(!(
I_p1
 < 
I_x
)è
Ïb0
;

152 
I_p1
 = 
I_x
;

153 
Ïb0
:

155 
	}
}

157 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::
	$r_maš_suffix
() {

158 
amÚg_v¬
;

159 { 
m1
 = 
l
 - 
c
; ()m1;

160 
mlim™1
;

161 ià(
c
 < 
I_p1
)  0;

162 
c
 = 
I_p1
;

163 
mlim™1
 = 
lb
;†b = 
c
;

164 
c
 = 
l
 - 
m1
;

165 
k‘
 = 
c
;

166 ià(
c
 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1851440 >> (p[ø- 1] & 0x1f)è& 1)è{†b = 
mlim™1
;  0; }

167 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 32, 0, 0);

168 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

169 
b¿
 = 
c
;

170 
lb
 = 
mlim™1
;

172 
amÚg_v¬
) {

175 ià(
	`¦iû_d–
() == -1)  -1;

178 ià(
	`š_groupšg_b_U
(
g_s_’dšg
, 97, 229, 0))  0;

179 ià(
	`¦iû_d–
() == -1)  -1;

183 
	}
}

185 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::
	$r_cÚsÚªt_·œ
() {

186 { 
m_‹¡1
 = 
l
 - 
c
;

187 { 
m2
 = 
l
 - 
c
; ()m2;

188 
mlim™2
;

189 ià(
c
 < 
I_p1
)  0;

190 
c
 = 
I_p1
;

191 
mlim™2
 = 
lb
;†b = 
c
;

192 
c
 = 
l
 - 
m2
;

193 
k‘
 = 
c
;

194 ià(
c
 - 1 <ğ
lb
 || (
p
[ø- 1] !ğ100 &&…[ø- 1] !ğ116)è{†b = 
mlim™2
;  0; }

195 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 4, 0, 0))è{ 
lb
 = 
mlim™2
;  0; }

196 
b¿
 = 
c
;

197 
lb
 = 
mlim™2
;

199 
c
 = 
l
 - 
m_‹¡1
;

201 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

202 ià(
»t
 < 0)  0;

203 
c
 = 
»t
;

205 
b¿
 = 
c
;

206 ià(
	`¦iû_d–
() == -1)  -1;

208 
	}
}

210 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::
	$r_Ùh”_suffix
() {

211 
amÚg_v¬
;

212 { 
m1
 = 
l
 - 
c
; ()m1;

213 
k‘
 = 
c
;

214 ià(!(
	`eq_s_b
(2, 
s_0
))è
Ïb0
;

215 
b¿
 = 
c
;

216 ià(!(
	`eq_s_b
(2, 
s_1
))è
Ïb0
;

217 ià(
	`¦iû_d–
() == -1)  -1;

218 
Ïb0
:

219 
c
 = 
l
 - 
m1
;

221 { 
m2
 = 
l
 - 
c
; ()m2;

222 
mlim™2
;

223 ià(
c
 < 
I_p1
)  0;

224 
c
 = 
I_p1
;

225 
mlim™2
 = 
lb
;†b = 
c
;

226 
c
 = 
l
 - 
m2
;

227 
k‘
 = 
c
;

228 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1572992 >> (p[ø- 1] & 0x1f)è& 1)è{†b = 
mlim™2
;  0; }

229 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 5, 0, 0);

230 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™2
;  0; }

231 
b¿
 = 
c
;

232 
lb
 = 
mlim™2
;

234 
amÚg_v¬
) {

237 ià(
	`¦iû_d–
() == -1)  -1;

238 { 
m3
 = 
l
 - 
c
; ()m3;

239 { 
»t
 = 
	`r_cÚsÚªt_·œ
();

240 ià(
»t
 =ğ0è
Ïb1
;

241 ià(
»t
 < 0) „et;

243 
Ïb1
:

244 
c
 = 
l
 - 
m3
;

248 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_2
);

249 ià(
»t
 < 0) „et;

254 
	}
}

256 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::
	$r_undoubË
() {

257 { 
m1
 = 
l
 - 
c
; ()m1;

258 
mlim™1
;

259 ià(
c
 < 
I_p1
)  0;

260 
c
 = 
I_p1
;

261 
mlim™1
 = 
lb
;†b = 
c
;

262 
c
 = 
l
 - 
m1
;

263 
k‘
 = 
c
;

264 ià(
	`out_groupšg_b_U
(
g_v
, 97, 248, 0)è{ 
lb
 = 
mlim™1
;  0; }

265 
b¿
 = 
c
;

266 { 
symbŞ
 * 
»t
 = 
	`¦iû_to
(
S_ch
);

267 ià(
»t
 == 0)  -1;

268 
S_ch
 = 
»t
;

270 
lb
 = 
mlim™1
;

272 ià(!(
	`eq_v_b
(
S_ch
)))  0;

273 ià(
	`¦iû_d–
() == -1)  -1;

275 
	}
}

277 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::
	$¡em
() {

278 { 
c1
 = 
c
;

279 { 
»t
 = 
	`r_m¬k_»giÚs
();

280 ià(
»t
 =ğ0è
Ïb0
;

281 ià(
»t
 < 0) „et;

283 
Ïb0
:

284 
c
 = 
c1
;

286 
lb
 = 
c
; c = 
l
;

288 { 
m2
 = 
l
 - 
c
; ()m2;

289 { 
»t
 = 
	`r_maš_suffix
();

290 ià(
»t
 =ğ0è
Ïb1
;

291 ià(
»t
 < 0) „et;

293 
Ïb1
:

294 
c
 = 
l
 - 
m2
;

296 { 
m3
 = 
l
 - 
c
; ()m3;

297 { 
»t
 = 
	`r_cÚsÚªt_·œ
();

298 ià(
»t
 =ğ0è
Ïb2
;

299 ià(
»t
 < 0) „et;

301 
Ïb2
:

302 
c
 = 
l
 - 
m3
;

304 { 
m4
 = 
l
 - 
c
; ()m4;

305 { 
»t
 = 
	`r_Ùh”_suffix
();

306 ià(
»t
 =ğ0è
Ïb3
;

307 ià(
»t
 < 0) „et;

309 
Ïb3
:

310 
c
 = 
l
 - 
m4
;

312 { 
m5
 = 
l
 - 
c
; ()m5;

313 { 
»t
 = 
	`r_undoubË
();

314 ià(
»t
 =ğ0è
Ïb4
;

315 ià(
»t
 < 0) „et;

317 
Ïb4
:

318 
c
 = 
l
 - 
m5
;

320 
c
 = 
lb
;

322 
	}
}

324 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::
	$IÁ”ÇlS‹mDªish
()

325 : 
	`I_x
(0), 
	`I_p1
(0), 
	$S_ch
(0)

327 
S_ch
 = 
	`ü—‹_s
();

328 
	}
}

330 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::~
	$IÁ”ÇlS‹mDªish
()

332 
	`lo£_s
(
S_ch
);

333 
	}
}

336 
	gX­Ÿn
::
IÁ”ÇlS‹mDªish
::
	$g‘_desütiÚ
() const

339 
	}
}

	@languages/danish.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mDªish
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_x
;

9 
	gI_p1
;

10 
symbŞ
 * 
	gS_ch
;

11 
	gpublic
:

12 
r_undoubË
();

13 
r_Ùh”_suffix
();

14 
r_cÚsÚªt_·œ
();

15 
r_maš_suffix
();

16 
r_m¬k_»giÚs
();

18 
IÁ”ÇlS‹mDªish
();

19 ~
IÁ”ÇlS‹mDªish
();

20 
¡em
();

21 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/dutch.cc

3 
	~<lim™s.h
>

4 
	~"dutch.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_1
 0

	)

9 
	#s_0_2
 2

	)

11 
	#s_0_3
 4

	)

13 
	#s_0_4
 6

	)

15 
	#s_0_5
 8

	)

17 
	#s_0_6
 10

	)

19 
	#s_0_7
 12

	)

21 
	#s_0_8
 14

	)

23 
	#s_0_9
 16

	)

25 
	#s_0_10
 18

	)

27 
	#s_1_1
 20

	)

29 
	#s_1_2
 21

	)

31 
	#s_2_0
 22

	)

33 
	#s_2_1
 24

	)

35 
	#s_2_2
 26

	)

37 
	#s_3_0
 28

	)

39 
	#s_3_1
 31

	)

41 
	#s_3_2
 
s_3_0


	)

42 
	#s_3_3
 33

	)

44 
	#s_3_4
 
s_3_1


	)

45 
	#s_4_0
 38

	)

47 
	#s_4_1
 41

	)

49 
	#s_4_2
 43

	)

51 
	#s_4_3
 46

	)

53 
	#s_4_4
 50

	)

55 
	#s_4_5
 54

	)

57 
	#s_5_0
 57

	)

59 
	#s_5_1
 59

	)

61 
	#s_5_2
 61

	)

63 
	#s_5_3
 63

	)

68 cÚ¡ 
amÚg
 
	ga_0
[11] =

71  { 2, 
s_0_1
, 0, 1},

72  { 2, 
s_0_2
, 0, 1},

73  { 2, 
s_0_3
, 0, 2},

74  { 2, 
s_0_4
, 0, 2},

75  { 2, 
s_0_5
, 0, 3},

76  { 2, 
s_0_6
, 0, 3},

77  { 2, 
s_0_7
, 0, 4},

78  { 2, 
s_0_8
, 0, 4},

79  { 2, 
s_0_9
, 0, 5},

80  { 2, 
s_0_10
, 0, 5}

84 cÚ¡ 
amÚg
 
	ga_1
[3] =

87  { 1, 
s_1_1
, 0, 2},

88  { 1, 
s_1_2
, 0, 1}

92 cÚ¡ 
amÚg
 
	ga_2
[3] =

94  { 2, 
s_2_0
, -1, -1},

95  { 2, 
s_2_1
, -1, -1},

96  { 2, 
s_2_2
, -1, -1}

100 cÚ¡ 
amÚg
 
	ga_3
[5] =

102  { 3, 
s_3_0
, -1, 2},

103  { 2, 
s_3_1
, -1, 3},

104  { 2, 
s_3_2
, -1, 2},

105  { 5, 
s_3_3
, 2, 1},

106  { 1, 
s_3_4
, -1, 3}

110 cÚ¡ 
amÚg
 
	ga_4
[6] =

112  { 3, 
s_4_0
, -1, 1},

113  { 2, 
s_4_1
, -1, 2},

114  { 3, 
s_4_2
, -1, 1},

115  { 4, 
s_4_3
, -1, 3},

116  { 4, 
s_4_4
, -1, 4},

117  { 3, 
s_4_5
, -1, 5}

121 cÚ¡ 
amÚg
 
	ga_5
[4] =

123  { 2, 
s_5_0
, -1, -1},

124  { 2, 
s_5_1
, -1, -1},

125  { 2, 
s_5_2
, -1, -1},

126  { 2, 
s_5_3
, -1, -1}

129 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128 };

131 cÚ¡ 
	gg_v_I
[] = { 1, 0, 0, 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128 };

133 cÚ¡ 
	gg_v_j
[] = { 17, 67, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128 };

135 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'a' };

136 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'e' };

137 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'i' };

138 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'o' };

139 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'u' };

140 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'Y' };

141 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'I' };

142 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'Y' };

143 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'y' };

144 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'i' };

145 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'g', 'e', 'm' };

146 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'h', 'e', 'i', 'd' };

147 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'h', 'e', 'i', 'd' };

148 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'e', 'n' };

149 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'i', 'g' };

151 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_´–ude
() {

152 
amÚg_v¬
;

153 { 
c_‹¡1
 = 
c
;

155 
c2
 = 
c
;

156 
b¿
 = 
c
;

157 ià(
c
 + 1 >ğ
l
 || 
p
[ø+ 1] >> 5 !ğ5 || !((340306450 >> (p[ø+ 1] & 0x1f)è& 1)è
amÚg_v¬
 = 6; 

158 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 11, 0, 0);

159 ià(!(
amÚg_v¬
)è
Ïb0
;

160 
k‘
 = 
c
;

161 
amÚg_v¬
) {

162 0: 
Ïb0
;

164 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_0
);

165 ià(
»t
 < 0) „et;

169 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_1
);

170 ià(
»t
 < 0) „et;

174 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_2
);

175 ià(
»t
 < 0) „et;

179 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_3
);

180 ià(
»t
 < 0) „et;

184 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_4
);

185 ià(
»t
 < 0) „et;

189 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

190 ià(
»t
 < 0è
Ïb0
;

191 
c
 = 
»t
;

196 
Ïb0
:

197 
c
 = 
c2
;

200 
c
 = 
c_‹¡1
;

202 { 
c3
 = 
c
;

203 
b¿
 = 
c
;

204 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è{ c = 
c3
; 
Ïb1
; }

205 
c
++;

206 
k‘
 = 
c
;

207 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_5
);

208 ià(
»t
 < 0) „et;

210 
Ïb1
:

214 
c4
 = 
c
;

216 
c5
 = 
c
;

217 ià(
	`š_groupšg_U
(
g_v
, 97, 232, 0)è
Ïb3
;

218 
b¿
 = 
c
;

219 { 
c6
 = 
c
;

220 ià(
c
 =ğ
l
 || 
p
[c] !ğ'i'è
Ïb5
;

221 
c
++;

222 
k‘
 = 
c
;

223 ià(
	`š_groupšg_U
(
g_v
, 97, 232, 0)è
Ïb5
;

224 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_6
);

225 ià(
»t
 < 0) „et;

227 
Ïb4
;

228 
Ïb5
:

229 
c
 = 
c6
;

230 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb3
;

231 
c
++;

232 
k‘
 = 
c
;

233 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_7
);

234 ià(
»t
 < 0) „et;

237 
Ïb4
:

238 
c
 = 
c5
;

240 
Ïb3
:

241 
c
 = 
c5
;

242 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

243 ià(
»t
 < 0è
Ïb2
;

244 
c
 = 
»t
;

248 
Ïb2
:

249 
c
 = 
c4
;

253 
	}
}

255 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_m¬k_»giÚs
() {

256 
I_p1
 = 
l
;

257 
I_p2
 = 
l
;

258 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 232, 1);

259 ià(
»t
 < 0)  0;

260 
c
 +ğ
»t
;

262 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 232, 1);

263 ià(
»t
 < 0)  0;

264 
c
 +ğ
»t
;

266 
I_p1
 = 
c
;

268 ià(!(
I_p1
 < 3)è
Ïb0
;

269 
I_p1
 = 3;

270 
Ïb0
:

271 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 232, 1);

272 ià(
»t
 < 0)  0;

273 
c
 +ğ
»t
;

275 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 232, 1);

276 ià(
»t
 < 0)  0;

277 
c
 +ğ
»t
;

279 
I_p2
 = 
c
;

281 
	}
}

283 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_po¡lude
() {

284 
amÚg_v¬
;

286 
c1
 = 
c
;

287 
b¿
 = 
c
;

288 ià(
c
 >ğ
l
 || (
p
[ø+ 0] !ğ73 &&…[ø+ 0] !ğ89)è
amÚg_v¬
 = 3; 

289 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_1
, 3, 0, 0);

290 ià(!(
amÚg_v¬
)è
Ïb0
;

291 
k‘
 = 
c
;

292 
amÚg_v¬
) {

293 0: 
Ïb0
;

295 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_8
);

296 ià(
»t
 < 0) „et;

300 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_9
);

301 ià(
»t
 < 0) „et;

305 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

306 ià(
»t
 < 0è
Ïb0
;

307 
c
 = 
»t
;

312 
Ïb0
:

313 
c
 = 
c1
;

317 
	}
}

319 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_R1
() {

320 ià(!(
I_p1
 <ğ
c
))  0;

322 
	}
}

324 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_R2
() {

325 ià(!(
I_p2
 <ğ
c
))  0;

327 
	}
}

329 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_undoubË
() {

330 { 
m_‹¡1
 = 
l
 - 
c
;

331 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((1050640 >> (p[c - 1] & 0x1f)) & 1))  0;

332 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 3, 0, 0)))  0;

333 
c
 = 
l
 - 
m_‹¡1
;

335 
k‘
 = 
c
;

336 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

337 ià(
»t
 < 0)  0;

338 
c
 = 
»t
;

340 
b¿
 = 
c
;

341 ià(
	`¦iû_d–
() == -1)  -1;

343 
	}
}

345 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_e_’dšg
() {

346 
B_e_found
 = 0;

347 
k‘
 = 
c
;

348 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'e')  0;

349 
c
--;

350 
b¿
 = 
c
;

351 { 
»t
 = 
	`r_R1
();

352 ià(
»t
 <= 0) „et;

354 { 
m_‹¡1
 = 
l
 - 
c
;

355 ià(
	`out_groupšg_b_U
(
g_v
, 97, 232, 0))  0;

356 
c
 = 
l
 - 
m_‹¡1
;

358 ià(
	`¦iû_d–
() == -1)  -1;

359 
B_e_found
 = 1;

360 { 
»t
 = 
	`r_undoubË
();

361 ià(
»t
 <= 0) „et;

364 
	}
}

366 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_’_’dšg
() {

367 { 
»t
 = 
	`r_R1
();

368 ià(
»t
 <= 0) „et;

370 { 
m1
 = 
l
 - 
c
; ()m1;

371 ià(
	`out_groupšg_b_U
(
g_v
, 97, 232, 0))  0;

372 
c
 = 
l
 - 
m1
;

373 { 
m2
 = 
l
 - 
c
; ()m2;

374 ià(!(
	`eq_s_b
(3, 
s_10
))è
Ïb0
;

376 
Ïb0
:

377 
c
 = 
l
 - 
m2
;

380 ià(
	`¦iû_d–
() == -1)  -1;

381 { 
»t
 = 
	`r_undoubË
();

382 ià(
»t
 <= 0) „et;

385 
	}
}

387 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$r_¡ªd¬d_suffix
() {

388 
amÚg_v¬
;

389 { 
m1
 = 
l
 - 
c
; ()m1;

390 
k‘
 = 
c
;

391 ià(
c
 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((540704 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb0
;

392 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 5, 0, 0);

393 ià(!(
amÚg_v¬
)è
Ïb0
;

394 
b¿
 = 
c
;

395 
amÚg_v¬
) {

396 0: 
Ïb0
;

398 { 
»t
 = 
	`r_R1
();

399 ià(
»t
 =ğ0è
Ïb0
;

400 ià(
»t
 < 0) „et;

402 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_11
);

403 ià(
»t
 < 0) „et;

407 { 
»t
 = 
	`r_’_’dšg
();

408 ià(
»t
 =ğ0è
Ïb0
;

409 ià(
»t
 < 0) „et;

413 { 
»t
 = 
	`r_R1
();

414 ià(
»t
 =ğ0è
Ïb0
;

415 ià(
»t
 < 0) „et;

417 ià(
	`out_groupšg_b_U
(
g_v_j
, 97, 232, 0)è
Ïb0
;

418 ià(
	`¦iû_d–
() == -1)  -1;

421 
Ïb0
:

422 
c
 = 
l
 - 
m1
;

424 { 
m2
 = 
l
 - 
c
; ()m2;

425 { 
»t
 = 
	`r_e_’dšg
();

426 ià(
»t
 =ğ0è
Ïb1
;

427 ià(
»t
 < 0) „et;

429 
Ïb1
:

430 
c
 = 
l
 - 
m2
;

432 { 
m3
 = 
l
 - 
c
; ()m3;

433 
k‘
 = 
c
;

434 ià(!(
	`eq_s_b
(4, 
s_12
))è
Ïb2
;

435 
b¿
 = 
c
;

436 { 
»t
 = 
	`r_R2
();

437 ià(
»t
 =ğ0è
Ïb2
;

438 ià(
»t
 < 0) „et;

440 { 
m4
 = 
l
 - 
c
; ()m4;

441 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'c'è
Ïb3
;

442 
c
--;

443 
Ïb2
;

444 
Ïb3
:

445 
c
 = 
l
 - 
m4
;

447 ià(
	`¦iû_d–
() == -1)  -1;

448 
k‘
 = 
c
;

449 ià(!(
	`eq_s_b
(2, 
s_13
))è
Ïb2
;

450 
b¿
 = 
c
;

451 { 
»t
 = 
	`r_’_’dšg
();

452 ià(
»t
 =ğ0è
Ïb2
;

453 ià(
»t
 < 0) „et;

455 
Ïb2
:

456 
c
 = 
l
 - 
m3
;

458 { 
m5
 = 
l
 - 
c
; ()m5;

459 
k‘
 = 
c
;

460 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((264336 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb4
;

461 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 6, 0, 0);

462 ià(!(
amÚg_v¬
)è
Ïb4
;

463 
b¿
 = 
c
;

464 
amÚg_v¬
) {

465 0: 
Ïb4
;

467 { 
»t
 = 
	`r_R2
();

468 ià(
»t
 =ğ0è
Ïb4
;

469 ià(
»t
 < 0) „et;

471 ià(
	`¦iû_d–
() == -1)  -1;

472 { 
m6
 = 
l
 - 
c
; ()m6;

473 
k‘
 = 
c
;

474 ià(!(
	`eq_s_b
(2, 
s_14
))è
Ïb6
;

475 
b¿
 = 
c
;

476 { 
»t
 = 
	`r_R2
();

477 ià(
»t
 =ğ0è
Ïb6
;

478 ià(
»t
 < 0) „et;

480 { 
m7
 = 
l
 - 
c
; ()m7;

481 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb7
;

482 
c
--;

483 
Ïb6
;

484 
Ïb7
:

485 
c
 = 
l
 - 
m7
;

487 ià(
	`¦iû_d–
() == -1)  -1;

488 
Ïb5
;

489 
Ïb6
:

490 
c
 = 
l
 - 
m6
;

491 { 
»t
 = 
	`r_undoubË
();

492 ià(
»t
 =ğ0è
Ïb4
;

493 ià(
»t
 < 0) „et;

496 
Ïb5
:

499 { 
»t
 = 
	`r_R2
();

500 ià(
»t
 =ğ0è
Ïb4
;

501 ià(
»t
 < 0) „et;

503 { 
m8
 = 
l
 - 
c
; ()m8;

504 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb8
;

505 
c
--;

506 
Ïb4
;

507 
Ïb8
:

508 
c
 = 
l
 - 
m8
;

510 ià(
	`¦iû_d–
() == -1)  -1;

513 { 
»t
 = 
	`r_R2
();

514 ià(
»t
 =ğ0è
Ïb4
;

515 ià(
»t
 < 0) „et;

517 ià(
	`¦iû_d–
() == -1)  -1;

518 { 
»t
 = 
	`r_e_’dšg
();

519 ià(
»t
 =ğ0è
Ïb4
;

520 ià(
»t
 < 0) „et;

524 { 
»t
 = 
	`r_R2
();

525 ià(
»t
 =ğ0è
Ïb4
;

526 ià(
»t
 < 0) „et;

528 ià(
	`¦iû_d–
() == -1)  -1;

531 { 
»t
 = 
	`r_R2
();

532 ià(
»t
 =ğ0è
Ïb4
;

533 ià(
»t
 < 0) „et;

535 ià(!(
B_e_found
)è
Ïb4
;

536 ià(
	`¦iû_d–
() == -1)  -1;

539 
Ïb4
:

540 
c
 = 
l
 - 
m5
;

542 { 
m9
 = 
l
 - 
c
; ()m9;

543 ià(
	`out_groupšg_b_U
(
g_v_I
, 73, 232, 0)è
Ïb9
;

544 { 
m_‹¡10
 = 
l
 - 
c
;

545 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((2129954 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb9
;

546 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 4, 0, 0))è
Ïb9
;

547 ià(
	`out_groupšg_b_U
(
g_v
, 97, 232, 0)è
Ïb9
;

548 
c
 = 
l
 - 
m_‹¡10
;

550 
k‘
 = 
c
;

551 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

552 ià(
»t
 < 0è
Ïb9
;

553 
c
 = 
»t
;

555 
b¿
 = 
c
;

556 ià(
	`¦iû_d–
() == -1)  -1;

557 
Ïb9
:

558 
c
 = 
l
 - 
m9
;

561 
	}
}

563 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$¡em
() {

564 { 
c1
 = 
c
;

565 { 
»t
 = 
	`r_´–ude
();

566 ià(
»t
 =ğ0è
Ïb0
;

567 ià(
»t
 < 0) „et;

569 
Ïb0
:

570 
c
 = 
c1
;

572 { 
c2
 = 
c
;

573 { 
»t
 = 
	`r_m¬k_»giÚs
();

574 ià(
»t
 =ğ0è
Ïb1
;

575 ià(
»t
 < 0) „et;

577 
Ïb1
:

578 
c
 = 
c2
;

580 
lb
 = 
c
; c = 
l
;

582 { 
m3
 = 
l
 - 
c
; ()m3;

583 { 
»t
 = 
	`r_¡ªd¬d_suffix
();

584 ià(
»t
 =ğ0è
Ïb2
;

585 ià(
»t
 < 0) „et;

587 
Ïb2
:

588 
c
 = 
l
 - 
m3
;

590 
c
 = 
lb
;

591 { 
c4
 = 
c
;

592 { 
»t
 = 
	`r_po¡lude
();

593 ià(
»t
 =ğ0è
Ïb3
;

594 ià(
»t
 < 0) „et;

596 
Ïb3
:

597 
c
 = 
c4
;

600 
	}
}

602 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$IÁ”ÇlS‹mDutch
()

603 : 
	`I_p2
(0), 
	`I_p1
(0), 
	$B_e_found
(0)

605 
	}
}

607 
	gX­Ÿn
::
IÁ”ÇlS‹mDutch
::~
	$IÁ”ÇlS‹mDutch
()

609 
	}
}

612 
X­Ÿn
::
IÁ”ÇlS‹mDutch
::
	$g‘_desütiÚ
() const

615 
	}
}

	@languages/dutch.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mDutch
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_p2
;

9 
	gI_p1
;

10 
	gB_e_found
;

11 
	gpublic
:

12 
r_¡ªd¬d_suffix
();

13 
r_undoubË
();

14 
r_R2
();

15 
r_R1
();

16 
r_m¬k_»giÚs
();

17 
r_’_’dšg
();

18 
r_e_’dšg
();

19 
r_po¡lude
();

20 
r_´–ude
();

22 
IÁ”ÇlS‹mDutch
();

23 ~
IÁ”ÇlS‹mDutch
();

24 
¡em
();

25 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/english.cc

3 
	~<lim™s.h
>

4 
	~"’glish.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_0
 0

	)

9 
	#s_0_1
 5

	)

11 
	#s_0_2
 11

	)

13 
	#s_1_0
 (
s_1_1
 + 2)

	)

14 
	#s_1_1
 16

	)

16 
	#s_1_2
 
s_1_1


	)

17 
	#s_2_0
 19

	)

19 
	#s_2_1
 (
s_2_2
 + 2)

	)

20 
	#s_2_2
 22

	)

22 
	#s_2_3
 25

	)

24 
	#s_2_4
 
s_2_3


	)

25 
	#s_2_5
 29

	)

27 
	#s_3_1
 31

	)

29 
	#s_3_2
 33

	)

31 
	#s_3_3
 35

	)

33 
	#s_3_4
 37

	)

35 
	#s_3_5
 39

	)

37 
	#s_3_6
 41

	)

39 
	#s_3_7
 43

	)

41 
	#s_3_8
 45

	)

43 
	#s_3_9
 47

	)

45 
	#s_3_10
 49

	)

47 
	#s_3_11
 51

	)

49 
	#s_3_12
 53

	)

51 
	#s_4_0
 (
s_4_1
 + 1)

	)

52 
	#s_4_1
 
s_4_4


	)

53 
	#s_4_2
 
s_4_5


	)

54 
	#s_4_3
 (
s_4_4
 + 1)

	)

55 
	#s_4_4
 55

	)

57 
	#s_4_5
 60

	)

59 
	#s_5_0
 65

	)

61 
	#s_5_1
 69

	)

63 
	#s_5_2
 73

	)

65 
	#s_5_3
 (
s_5_4
 + 1)

	)

66 
	#s_5_4
 (
s_5_5
 + 1)

	)

67 
	#s_5_5
 76

	)

69 
	#s_5_6
 80

	)

71 
	#s_5_7
 84

	)

73 
	#s_5_8
 89

	)

75 
	#s_5_9
 95

	)

77 
	#s_5_10
 100

	)

79 
	#s_5_11
 105

	)

81 
	#s_5_12
 110

	)

83 
	#s_5_13
 116

	)

85 
	#s_5_14
 (
s_5_15
 + 1)

	)

86 
	#s_5_15
 121

	)

88 
	#s_5_16
 128

	)

90 
	#s_5_17
 
s_5_15


	)

91 
	#s_5_18
 133

	)

93 
	#s_5_19
 140

	)

95 
	#s_5_20
 144

	)

97 
	#s_5_21
 148

	)

99 
	#s_5_22
 155

	)

101 
	#s_5_23
 162

	)

103 
	#s_6_0
 169

	)

105 
	#s_6_1
 174

	)

107 
	#s_6_2
 179

	)

109 
	#s_6_3
 184

	)

111 
	#s_6_4
 189

	)

113 
	#s_6_5
 (
s_6_6
 + 1)

	)

114 
	#s_6_6
 193

	)

116 
	#s_6_7
 200

	)

118 
	#s_6_8
 203

	)

120 
	#s_7_0
 207

	)

122 
	#s_7_1
 209

	)

124 
	#s_7_2
 213

	)

126 
	#s_7_3
 217

	)

128 
	#s_7_4
 221

	)

130 
	#s_7_5
 225

	)

132 
	#s_7_6
 228

	)

134 
	#s_7_7
 231

	)

136 
	#s_7_8
 234

	)

138 
	#s_7_9
 237

	)

140 
	#s_7_10
 239

	)

142 
	#s_7_11
 242

	)

144 
	#s_7_12
 245

	)

146 
	#s_7_13
 247

	)

148 
	#s_7_14
 250

	)

150 
	#s_7_15
 (
s_7_16
 + 1)

	)

151 
	#s_7_16
 (
s_7_17
 + 1)

	)

152 
	#s_7_17
 253

	)

154 
	#s_8_0
 258

	)

156 
	#s_8_1
 259

	)

158 
	#s_9_0
 260

	)

160 
	#s_9_1
 267

	)

162 
	#s_9_2
 274

	)

164 
	#s_9_3
 280

	)

166 
	#s_9_4
 287

	)

168 
	#s_9_5
 293

	)

170 
	#s_9_6
 300

	)

172 
	#s_9_7
 307

	)

174 
	#s_10_0
 313

	)

176 
	#s_10_1
 318

	)

178 
	#s_10_2
 323

	)

180 
	#s_10_3
 327

	)

182 
	#s_10_4
 333

	)

184 
	#s_10_5
 338

	)

186 
	#s_10_6
 343

	)

188 
	#s_10_7
 349

	)

190 
	#s_10_8
 353

	)

192 
	#s_10_9
 357

	)

194 
	#s_10_10
 362

	)

196 
	#s_10_11
 366

	)

198 
	#s_10_12
 370

	)

200 
	#s_10_13
 376

	)

202 
	#s_10_14
 381

	)

204 
	#s_10_15
 385

	)

206 
	#s_10_16
 388

	)

208 
	#s_10_17
 393

	)

213 cÚ¡ 
amÚg
 
	ga_0
[3] =

215  { 5, 
s_0_0
, -1, -1},

216  { 6, 
s_0_1
, -1, -1},

217  { 5, 
s_0_2
, -1, -1}

221 cÚ¡ 
amÚg
 
	ga_1
[3] =

223  { 1, 
s_1_0
, -1, 1},

224  { 3, 
s_1_1
, 0, 1},

225  { 2, 
s_1_2
, -1, 1}

229 cÚ¡ 
amÚg
 
	ga_2
[6] =

231  { 3, 
s_2_0
, -1, 2},

232  { 1, 
s_2_1
, -1, 3},

233  { 3, 
s_2_2
, 1, 2},

234  { 4, 
s_2_3
, 1, 1},

235  { 2, 
s_2_4
, 1, -1},

236  { 2, 
s_2_5
, 1, -1}

240 cÚ¡ 
amÚg
 
	ga_3
[13] =

243  { 2, 
s_3_1
, 0, 2},

244  { 2, 
s_3_2
, 0, 2},

245  { 2, 
s_3_3
, 0, 2},

246  { 2, 
s_3_4
, 0, 2},

247  { 2, 
s_3_5
, 0, 1},

248  { 2, 
s_3_6
, 0, 2},

249  { 2, 
s_3_7
, 0, 2},

250  { 2, 
s_3_8
, 0, 2},

251  { 2, 
s_3_9
, 0, 2},

252  { 2, 
s_3_10
, 0, 1},

253  { 2, 
s_3_11
, 0, 2},

254  { 2, 
s_3_12
, 0, 1}

258 cÚ¡ 
amÚg
 
	ga_4
[6] =

260  { 2, 
s_4_0
, -1, 2},

261  { 3, 
s_4_1
, 0, 1},

262  { 3, 
s_4_2
, -1, 2},

263  { 4, 
s_4_3
, -1, 2},

264  { 5, 
s_4_4
, 3, 1},

265  { 5, 
s_4_5
, -1, 2}

269 cÚ¡ 
amÚg
 
	ga_5
[24] =

271  { 4, 
s_5_0
, -1, 3},

272  { 4, 
s_5_1
, -1, 2},

273  { 3, 
s_5_2
, -1, 13},

274  { 2, 
s_5_3
, -1, 16},

275  { 3, 
s_5_4
, 3, 12},

276  { 4, 
s_5_5
, 4, 4},

277  { 4, 
s_5_6
, 3, 8},

278  { 5, 
s_5_7
, 3, 14},

279  { 6, 
s_5_8
, 3, 15},

280  { 5, 
s_5_9
, 3, 10},

281  { 5, 
s_5_10
, 3, 5},

282  { 5, 
s_5_11
, -1, 8},

283  { 6, 
s_5_12
, -1, 12},

284  { 5, 
s_5_13
, -1, 11},

285  { 6, 
s_5_14
, -1, 1},

286  { 7, 
s_5_15
, 14, 7},

287  { 5, 
s_5_16
, -1, 8},

288  { 5, 
s_5_17
, -1, 7},

289  { 7, 
s_5_18
, 17, 6},

290  { 4, 
s_5_19
, -1, 6},

291  { 4, 
s_5_20
, -1, 7},

292  { 7, 
s_5_21
, -1, 11},

293  { 7, 
s_5_22
, -1, 9},

294  { 7, 
s_5_23
, -1, 10}

298 cÚ¡ 
amÚg
 
	ga_6
[9] =

300  { 5, 
s_6_0
, -1, 4},

301  { 5, 
s_6_1
, -1, 6},

302  { 5, 
s_6_2
, -1, 3},

303  { 5, 
s_6_3
, -1, 4},

304  { 4, 
s_6_4
, -1, 4},

305  { 6, 
s_6_5
, -1, 1},

306  { 7, 
s_6_6
, 5, 2},

307  { 3, 
s_6_7
, -1, 5},

308  { 4, 
s_6_8
, -1, 5}

312 cÚ¡ 
amÚg
 
	ga_7
[18] =

314  { 2, 
s_7_0
, -1, 1},

315  { 4, 
s_7_1
, -1, 1},

316  { 4, 
s_7_2
, -1, 1},

317  { 4, 
s_7_3
, -1, 1},

318  { 4, 
s_7_4
, -1, 1},

319  { 3, 
s_7_5
, -1, 1},

320  { 3, 
s_7_6
, -1, 1},

321  { 3, 
s_7_7
, -1, 1},

322  { 3, 
s_7_8
, -1, 1},

323  { 2, 
s_7_9
, -1, 1},

324  { 3, 
s_7_10
, -1, 1},

325  { 3, 
s_7_11
, -1, 2},

326  { 2, 
s_7_12
, -1, 1},

327  { 3, 
s_7_13
, -1, 1},

328  { 3, 
s_7_14
, -1, 1},

329  { 3, 
s_7_15
, -1, 1},

330  { 4, 
s_7_16
, 15, 1},

331  { 5, 
s_7_17
, 16, 1}

335 cÚ¡ 
amÚg
 
	ga_8
[2] =

337  { 1, 
s_8_0
, -1, 1},

338  { 1, 
s_8_1
, -1, 2}

342 cÚ¡ 
amÚg
 
	ga_9
[8] =

344  { 7, 
s_9_0
, -1, -1},

345  { 7, 
s_9_1
, -1, -1},

346  { 6, 
s_9_2
, -1, -1},

347  { 7, 
s_9_3
, -1, -1},

348  { 6, 
s_9_4
, -1, -1},

349  { 7, 
s_9_5
, -1, -1},

350  { 7, 
s_9_6
, -1, -1},

351  { 6, 
s_9_7
, -1, -1}

355 cÚ¡ 
amÚg
 
	ga_10
[18] =

357  { 5, 
s_10_0
, -1, -1},

358  { 5, 
s_10_1
, -1, -1},

359  { 4, 
s_10_2
, -1, -1},

360  { 6, 
s_10_3
, -1, -1},

361  { 5, 
s_10_4
, -1, 3},

362  { 5, 
s_10_5
, -1, 9},

363  { 6, 
s_10_6
, -1, 7},

364  { 4, 
s_10_7
, -1, -1},

365  { 4, 
s_10_8
, -1, 6},

366  { 5, 
s_10_9
, -1, 4},

367  { 4, 
s_10_10
, -1, -1},

368  { 4, 
s_10_11
, -1, 10},

369  { 6, 
s_10_12
, -1, 11},

370  { 5, 
s_10_13
, -1, 2},

371  { 4, 
s_10_14
, -1, 1},

372  { 3, 
s_10_15
, -1, -1},

373  { 5, 
s_10_16
, -1, 5},

374  { 4, 
s_10_17
, -1, 8}

377 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1 };

379 cÚ¡ 
	gg_v_WXY
[] = { 1, 17, 65, 208, 1 };

381 cÚ¡ 
	gg_v®id_LI
[] = { 55, 141, 2 };

383 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'Y' };

384 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'Y' };

385 cÚ¡ 
symbŞ
 
	gs_2
[] = { 's', 's' };

386 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'i' };

387 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'i', 'e' };

388 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'e', 'e' };

389 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'e' };

390 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'e' };

391 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'i' };

392 cÚ¡ 
symbŞ
 
	gs_9
[] = { 't', 'i', 'o', 'n' };

393 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'e', 'n', 'c', 'e' };

394 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'a', 'n', 'c', 'e' };

395 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'a', 'b', 'l', 'e' };

396 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'e', 'n', 't' };

397 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'i', 'z', 'e' };

398 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'a', 't', 'e' };

399 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'a', 'l' };

400 cÚ¡ 
symbŞ
 
	gs_17
[] = { 'f', 'u', 'l' };

401 cÚ¡ 
symbŞ
 
	gs_18
[] = { 'o', 'u', 's' };

402 cÚ¡ 
symbŞ
 
	gs_19
[] = { 'i', 'v', 'e' };

403 cÚ¡ 
symbŞ
 
	gs_20
[] = { 'b', 'l', 'e' };

404 cÚ¡ 
symbŞ
 
	gs_21
[] = { 'o', 'g' };

405 cÚ¡ 
symbŞ
 
	gs_22
[] = { 'f', 'u', 'l' };

406 cÚ¡ 
symbŞ
 
	gs_23
[] = { 'l', 'e', 's', 's' };

407 cÚ¡ 
symbŞ
 
	gs_24
[] = { 't', 'i', 'o', 'n' };

408 cÚ¡ 
symbŞ
 
	gs_25
[] = { 'a', 't', 'e' };

409 cÚ¡ 
symbŞ
 
	gs_26
[] = { 'a', 'l' };

410 cÚ¡ 
symbŞ
 
	gs_27
[] = { 'i', 'c' };

411 cÚ¡ 
symbŞ
 
	gs_28
[] = { 's', 'k', 'i' };

412 cÚ¡ 
symbŞ
 
	gs_29
[] = { 's', 'k', 'y' };

413 cÚ¡ 
symbŞ
 
	gs_30
[] = { 'd', 'i', 'e' };

414 cÚ¡ 
symbŞ
 
	gs_31
[] = { 'l', 'i', 'e' };

415 cÚ¡ 
symbŞ
 
	gs_32
[] = { 't', 'i', 'e' };

416 cÚ¡ 
symbŞ
 
	gs_33
[] = { 'i', 'd', 'l' };

417 cÚ¡ 
symbŞ
 
	gs_34
[] = { 'g', 'e', 'n', 't', 'l' };

418 cÚ¡ 
symbŞ
 
	gs_35
[] = { 'u', 'g', 'l', 'i' };

419 cÚ¡ 
symbŞ
 
	gs_36
[] = { 'e', 'a', 'r', 'l', 'i' };

420 cÚ¡ 
symbŞ
 
	gs_37
[] = { 'o', 'n', 'l', 'i' };

421 cÚ¡ 
symbŞ
 
	gs_38
[] = { 's', 'i', 'n', 'g', 'l' };

422 cÚ¡ 
symbŞ
 
	gs_39
[] = { 'y' };

424 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_´–ude
() {

425 
B_Y_found
 = 0;

426 { 
c1
 = 
c
;

427 
b¿
 = 
c
;

428 ià(
c
 =ğ
l
 || 
p
[c] !ğ39è
Ïb0
;

429 
c
++;

430 
k‘
 = 
c
;

431 ià(
	`¦iû_d–
() == -1)  -1;

432 
Ïb0
:

433 
c
 = 
c1
;

435 { 
c2
 = 
c
;

436 
b¿
 = 
c
;

437 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb1
;

438 
c
++;

439 
k‘
 = 
c
;

440 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_0
);

441 ià(
»t
 < 0) „et;

443 
B_Y_found
 = 1;

444 
Ïb1
:

445 
c
 = 
c2
;

447 { 
c3
 = 
c
;

449 
c4
 = 
c
;

451 
c5
 = 
c
;

452 ià(
	`š_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb4
;

453 
b¿
 = 
c
;

454 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb4
;

455 
c
++;

456 
k‘
 = 
c
;

457 
c
 = 
c5
;

459 
Ïb4
:

460 
c
 = 
c5
;

461 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

462 ià(
»t
 < 0è
Ïb3
;

463 
c
 = 
»t
;

466 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_1
);

467 ià(
»t
 < 0) „et;

469 
B_Y_found
 = 1;

471 
Ïb3
:

472 
c
 = 
c4
;

475 
c
 = 
c3
;

478 
	}
}

480 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_m¬k_»giÚs
() {

481 
I_p1
 = 
l
;

482 
I_p2
 = 
l
;

483 { 
c1
 = 
c
;

484 { 
c2
 = 
c
;

485 ià(
c
 + 4 >ğ
l
 || 
p
[ø+ 4] >> 5 !ğ3 || !((2375680 >> (p[ø+ 4] & 0x1f)è& 1)è
Ïb2
;

486 ià(!(
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 3, 0, 0))è
Ïb2
;

487 
Ïb1
;

488 
Ïb2
:

489 
c
 = 
c2
;

490 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 121, 1);

491 ià(
»t
 < 0è
Ïb0
;

492 
c
 +ğ
»t
;

494 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 121, 1);

495 ià(
»t
 < 0è
Ïb0
;

496 
c
 +ğ
»t
;

499 
Ïb1
:

500 
I_p1
 = 
c
;

501 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 121, 1);

502 ià(
»t
 < 0è
Ïb0
;

503 
c
 +ğ
»t
;

505 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 121, 1);

506 ià(
»t
 < 0è
Ïb0
;

507 
c
 +ğ
»t
;

509 
I_p2
 = 
c
;

510 
Ïb0
:

511 
c
 = 
c1
;

514 
	}
}

516 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_shÜtv
() {

517 { 
m1
 = 
l
 - 
c
; ()m1;

518 ià(
	`out_groupšg_b_U
(
g_v_WXY
, 89, 121, 0)è
Ïb1
;

519 ià(
	`š_groupšg_b_U
(
g_v
, 97, 121, 0)è
Ïb1
;

520 ià(
	`out_groupšg_b_U
(
g_v
, 97, 121, 0)è
Ïb1
;

521 
Ïb0
;

522 
Ïb1
:

523 
c
 = 
l
 - 
m1
;

524 ià(
	`out_groupšg_b_U
(
g_v
, 97, 121, 0))  0;

525 ià(
	`š_groupšg_b_U
(
g_v
, 97, 121, 0))  0;

526 ià(
c
 > 
lb
)  0;

528 
Ïb0
:

530 
	}
}

532 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_R1
() {

533 ià(!(
I_p1
 <ğ
c
))  0;

535 
	}
}

537 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_R2
() {

538 ià(!(
I_p2
 <ğ
c
))  0;

540 
	}
}

542 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_S‹p_1a
() {

543 
amÚg_v¬
;

544 { 
m1
 = 
l
 - 
c
; ()m1;

545 
k‘
 = 
c
;

546 ià(
c
 <ğ
lb
 || (
p
[ø- 1] !ğ39 &&…[ø- 1] !ğ115)è{ c = 
l
 - 
m1
; 
Ïb0
; }

547 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 3, 0, 0);

548 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

549 
b¿
 = 
c
;

550 
amÚg_v¬
) {

551 0: { 
c
 = 
l
 - 
m1
; 
Ïb0
; }

553 ià(
	`¦iû_d–
() == -1)  -1;

556 
Ïb0
:

559 
k‘
 = 
c
;

560 ià(
c
 <ğ
lb
 || (
p
[c - 1] != 100 &&…[c - 1] != 115))  0;

561 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 6, 0, 0);

562 ià(!(
amÚg_v¬
))  0;

563 
b¿
 = 
c
;

564 
amÚg_v¬
) {

567 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_2
);

568 ià(
»t
 < 0) „et;

572 { 
m2
 = 
l
 - 
c
; ()m2;

573 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

574 ià(
»t
 < 0è
Ïb2
;

575 
c
 = 
»t
;

577 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_3
);

578 ià(
»t
 < 0) „et;

580 
Ïb1
;

581 
Ïb2
:

582 
c
 = 
l
 - 
m2
;

583 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_4
);

584 ià(
»t
 < 0) „et;

587 
Ïb1
:

590 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

591 ià(
»t
 < 0)  0;

592 
c
 = 
»t
;

594 { 
»t
 = 
	`out_groupšg_b_U
(
g_v
, 97, 121, 1);

595 ià(
»t
 < 0)  0;

596 
c
 -ğ
»t
;

598 ià(
	`¦iû_d–
() == -1)  -1;

602 
	}
}

604 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_S‹p_1b
() {

605 
amÚg_v¬
;

606 
k‘
 = 
c
;

607 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((33554576 >> (p[c - 1] & 0x1f)) & 1))  0;

608 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 6, 0, 0);

609 ià(!(
amÚg_v¬
))  0;

610 
b¿
 = 
c
;

611 
amÚg_v¬
) {

614 { 
»t
 = 
	`r_R1
();

615 ià(
»t
 <= 0) „et;

617 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_5
);

618 ià(
»t
 < 0) „et;

622 { 
m_‹¡1
 = 
l
 - 
c
;

623 { 
»t
 = 
	`out_groupšg_b_U
(
g_v
, 97, 121, 1);

624 ià(
»t
 < 0)  0;

625 
c
 -ğ
»t
;

627 
c
 = 
l
 - 
m_‹¡1
;

629 ià(
	`¦iû_d–
() == -1)  -1;

630 { 
m_‹¡2
 = 
l
 - 
c
;

631 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((68514004 >> (p[ø- 1] & 0x1f)è& 1)è
amÚg_v¬
 = 3; 

632 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 13, 0, 0);

633 ià(!(
amÚg_v¬
))  0;

634 
c
 = 
l
 - 
m_‹¡2
;

636 
amÚg_v¬
) {

639 { 
§ved_c
 = 
c
;

640 
	`š£¹_s
(
c
, c, 1, 
s_6
);

641 
c
 = 
§ved_c
;

645 
k‘
 = 
c
;

646 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

647 ià(
»t
 < 0)  0;

648 
c
 = 
»t
;

650 
b¿
 = 
c
;

651 ià(
	`¦iû_d–
() == -1)  -1;

654 ià(
c
 !ğ
I_p1
)  0;

655 { 
m_‹¡3
 = 
l
 - 
c
;

656 { 
»t
 = 
	`r_shÜtv
();

657 ià(
»t
 <= 0) „et;

659 
c
 = 
l
 - 
m_‹¡3
;

661 { 
§ved_c
 = 
c
;

662 
	`š£¹_s
(
c
, c, 1, 
s_7
);

663 
c
 = 
§ved_c
;

670 
	}
}

672 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_S‹p_1c
() {

673 
k‘
 = 
c
;

674 { 
m1
 = 
l
 - 
c
; ()m1;

675 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'y'è
Ïb1
;

676 
c
--;

677 
Ïb0
;

678 
Ïb1
:

679 
c
 = 
l
 - 
m1
;

680 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'Y')  0;

681 
c
--;

683 
Ïb0
:

684 
b¿
 = 
c
;

685 ià(
	`out_groupšg_b_U
(
g_v
, 97, 121, 0))  0;

686 { 
m2
 = 
l
 - 
c
; ()m2;

687 ià(
c
 > 
lb
è
Ïb2
;

689 
Ïb2
:

690 
c
 = 
l
 - 
m2
;

692 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_8
);

693 ià(
»t
 < 0) „et;

696 
	}
}

698 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_S‹p_2
() {

699 
amÚg_v¬
;

700 
k‘
 = 
c
;

701 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((815616 >> (p[c - 1] & 0x1f)) & 1))  0;

702 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 24, 0, 0);

703 ià(!(
amÚg_v¬
))  0;

704 
b¿
 = 
c
;

705 { 
»t
 = 
	`r_R1
();

706 ià(
»t
 <= 0) „et;

708 
amÚg_v¬
) {

711 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_9
);

712 ià(
»t
 < 0) „et;

716 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_10
);

717 ià(
»t
 < 0) „et;

721 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_11
);

722 ià(
»t
 < 0) „et;

726 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_12
);

727 ià(
»t
 < 0) „et;

731 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_13
);

732 ià(
»t
 < 0) „et;

736 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_14
);

737 ià(
»t
 < 0) „et;

741 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_15
);

742 ià(
»t
 < 0) „et;

746 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_16
);

747 ià(
»t
 < 0) „et;

751 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_17
);

752 ià(
»t
 < 0) „et;

756 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_18
);

757 ià(
»t
 < 0) „et;

761 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_19
);

762 ià(
»t
 < 0) „et;

766 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_20
);

767 ià(
»t
 < 0) „et;

771 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'l')  0;

772 
c
--;

773 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_21
);

774 ià(
»t
 < 0) „et;

778 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_22
);

779 ià(
»t
 < 0) „et;

783 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_23
);

784 ià(
»t
 < 0) „et;

788 ià(
	`š_groupšg_b_U
(
g_v®id_LI
, 99, 116, 0))  0;

789 ià(
	`¦iû_d–
() == -1)  -1;

793 
	}
}

795 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_S‹p_3
() {

796 
amÚg_v¬
;

797 
k‘
 = 
c
;

798 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((528928 >> (p[c - 1] & 0x1f)) & 1))  0;

799 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 9, 0, 0);

800 ià(!(
amÚg_v¬
))  0;

801 
b¿
 = 
c
;

802 { 
»t
 = 
	`r_R1
();

803 ià(
»t
 <= 0) „et;

805 
amÚg_v¬
) {

808 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_24
);

809 ià(
»t
 < 0) „et;

813 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_25
);

814 ià(
»t
 < 0) „et;

818 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_26
);

819 ià(
»t
 < 0) „et;

823 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_27
);

824 ià(
»t
 < 0) „et;

828 ià(
	`¦iû_d–
() == -1)  -1;

831 { 
»t
 = 
	`r_R2
();

832 ià(
»t
 <= 0) „et;

834 ià(
	`¦iû_d–
() == -1)  -1;

838 
	}
}

840 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_S‹p_4
() {

841 
amÚg_v¬
;

842 
k‘
 = 
c
;

843 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((1864232 >> (p[c - 1] & 0x1f)) & 1))  0;

844 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 18, 0, 0);

845 ià(!(
amÚg_v¬
))  0;

846 
b¿
 = 
c
;

847 { 
»t
 = 
	`r_R2
();

848 ià(
»t
 <= 0) „et;

850 
amÚg_v¬
) {

853 ià(
	`¦iû_d–
() == -1)  -1;

856 { 
m1
 = 
l
 - 
c
; ()m1;

857 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb1
;

858 
c
--;

859 
Ïb0
;

860 
Ïb1
:

861 
c
 = 
l
 - 
m1
;

862 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 't')  0;

863 
c
--;

865 
Ïb0
:

866 ià(
	`¦iû_d–
() == -1)  -1;

870 
	}
}

872 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_S‹p_5
() {

873 
amÚg_v¬
;

874 
k‘
 = 
c
;

875 ià(
c
 <ğ
lb
 || (
p
[c - 1] != 101 &&…[c - 1] != 108))  0;

876 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_8
, 2, 0, 0);

877 ià(!(
amÚg_v¬
))  0;

878 
b¿
 = 
c
;

879 
amÚg_v¬
) {

882 { 
m1
 = 
l
 - 
c
; ()m1;

883 { 
»t
 = 
	`r_R2
();

884 ià(
»t
 =ğ0è
Ïb1
;

885 ià(
»t
 < 0) „et;

887 
Ïb0
;

888 
Ïb1
:

889 
c
 = 
l
 - 
m1
;

890 { 
»t
 = 
	`r_R1
();

891 ià(
»t
 <= 0) „et;

893 { 
m2
 = 
l
 - 
c
; ()m2;

894 { 
»t
 = 
	`r_shÜtv
();

895 ià(
»t
 =ğ0è
Ïb2
;

896 ià(
»t
 < 0) „et;

899 
Ïb2
:

900 
c
 = 
l
 - 
m2
;

903 
Ïb0
:

904 ià(
	`¦iû_d–
() == -1)  -1;

907 { 
»t
 = 
	`r_R2
();

908 ià(
»t
 <= 0) „et;

910 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'l')  0;

911 
c
--;

912 ià(
	`¦iû_d–
() == -1)  -1;

916 
	}
}

918 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_exû±iÚ2
() {

919 
k‘
 = 
c
;

920 ià(
c
 - 5 <ğ
lb
 || (
p
[c - 1] != 100 &&…[c - 1] != 103))  0;

921 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_9
, 8, 0, 0)))  0;

922 
b¿
 = 
c
;

923 ià(
c
 > 
lb
)  0;

925 
	}
}

927 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_exû±iÚ1
() {

928 
amÚg_v¬
;

929 
b¿
 = 
c
;

930 ià(
c
 + 2 >ğ
l
 || 
p
[c + 2] >> 5 != 3 || !((42750482 >> (p[c + 2] & 0x1f)) & 1))  0;

931 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_10
, 18, 0, 0);

932 ià(!(
amÚg_v¬
))  0;

933 
k‘
 = 
c
;

934 ià(
c
 < 
l
)  0;

935 
amÚg_v¬
) {

938 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_28
);

939 ià(
»t
 < 0) „et;

943 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_29
);

944 ià(
»t
 < 0) „et;

948 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_30
);

949 ià(
»t
 < 0) „et;

953 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_31
);

954 ià(
»t
 < 0) „et;

958 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_32
);

959 ià(
»t
 < 0) „et;

963 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_33
);

964 ià(
»t
 < 0) „et;

968 { 
»t
 = 
	`¦iû_äom_s
(5, 
s_34
);

969 ià(
»t
 < 0) „et;

973 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_35
);

974 ià(
»t
 < 0) „et;

978 { 
»t
 = 
	`¦iû_äom_s
(5, 
s_36
);

979 ià(
»t
 < 0) „et;

983 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_37
);

984 ià(
»t
 < 0) „et;

988 { 
»t
 = 
	`¦iû_äom_s
(5, 
s_38
);

989 ià(
»t
 < 0) „et;

994 
	}
}

996 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$r_po¡lude
() {

997 ià(!(
B_Y_found
))  0;

999 
c1
 = 
c
;

1001 
c2
 = 
c
;

1002 
b¿
 = 
c
;

1003 ià(
c
 =ğ
l
 || 
p
[c] !ğ'Y'è
Ïb1
;

1004 
c
++;

1005 
k‘
 = 
c
;

1006 
c
 = 
c2
;

1008 
Ïb1
:

1009 
c
 = 
c2
;

1010 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

1011 ià(
»t
 < 0è
Ïb0
;

1012 
c
 = 
»t
;

1015 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_39
);

1016 ià(
»t
 < 0) „et;

1019 
Ïb0
:

1020 
c
 = 
c1
;

1024 
	}
}

1026 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$¡em
() {

1027 { 
c1
 = 
c
;

1028 { 
»t
 = 
	`r_exû±iÚ1
();

1029 ià(
»t
 =ğ0è
Ïb1
;

1030 ià(
»t
 < 0) „et;

1032 
Ïb0
;

1033 
Ïb1
:

1034 
c
 = 
c1
;

1035 { 
c2
 = 
c
;

1036 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 3);

1037 ià(
»t
 < 0è
Ïb3
;

1038 
c
 = 
»t
;

1040 
Ïb2
;

1041 
Ïb3
:

1042 
c
 = 
c2
;

1044 
Ïb0
;

1045 
Ïb2
:

1046 
c
 = 
c1
;

1047 { 
c3
 = 
c
;

1048 { 
»t
 = 
	`r_´–ude
();

1049 ià(
»t
 =ğ0è
Ïb4
;

1050 ià(
»t
 < 0) „et;

1052 
Ïb4
:

1053 
c
 = 
c3
;

1055 { 
c4
 = 
c
;

1056 { 
»t
 = 
	`r_m¬k_»giÚs
();

1057 ià(
»t
 =ğ0è
Ïb5
;

1058 ià(
»t
 < 0) „et;

1060 
Ïb5
:

1061 
c
 = 
c4
;

1063 
lb
 = 
c
; c = 
l
;

1065 { 
m5
 = 
l
 - 
c
; ()m5;

1066 { 
»t
 = 
	`r_S‹p_1a
();

1067 ià(
»t
 =ğ0è
Ïb6
;

1068 ià(
»t
 < 0) „et;

1070 
Ïb6
:

1071 
c
 = 
l
 - 
m5
;

1073 { 
m6
 = 
l
 - 
c
; ()m6;

1074 { 
»t
 = 
	`r_exû±iÚ2
();

1075 ià(
»t
 =ğ0è
Ïb8
;

1076 ià(
»t
 < 0) „et;

1078 
Ïb7
;

1079 
Ïb8
:

1080 
c
 = 
l
 - 
m6
;

1081 { 
m7
 = 
l
 - 
c
; ()m7;

1082 { 
»t
 = 
	`r_S‹p_1b
();

1083 ià(
»t
 =ğ0è
Ïb9
;

1084 ià(
»t
 < 0) „et;

1086 
Ïb9
:

1087 
c
 = 
l
 - 
m7
;

1089 { 
m8
 = 
l
 - 
c
; ()m8;

1090 { 
»t
 = 
	`r_S‹p_1c
();

1091 ià(
»t
 =ğ0è
Ïb10
;

1092 ià(
»t
 < 0) „et;

1094 
Ïb10
:

1095 
c
 = 
l
 - 
m8
;

1097 { 
m9
 = 
l
 - 
c
; ()m9;

1098 { 
»t
 = 
	`r_S‹p_2
();

1099 ià(
»t
 =ğ0è
Ïb11
;

1100 ià(
»t
 < 0) „et;

1102 
Ïb11
:

1103 
c
 = 
l
 - 
m9
;

1105 { 
m10
 = 
l
 - 
c
; ()m10;

1106 { 
»t
 = 
	`r_S‹p_3
();

1107 ià(
»t
 =ğ0è
Ïb12
;

1108 ià(
»t
 < 0) „et;

1110 
Ïb12
:

1111 
c
 = 
l
 - 
m10
;

1113 { 
m11
 = 
l
 - 
c
; ()m11;

1114 { 
»t
 = 
	`r_S‹p_4
();

1115 ià(
»t
 =ğ0è
Ïb13
;

1116 ià(
»t
 < 0) „et;

1118 
Ïb13
:

1119 
c
 = 
l
 - 
m11
;

1121 { 
m12
 = 
l
 - 
c
; ()m12;

1122 { 
»t
 = 
	`r_S‹p_5
();

1123 ià(
»t
 =ğ0è
Ïb14
;

1124 ià(
»t
 < 0) „et;

1126 
Ïb14
:

1127 
c
 = 
l
 - 
m12
;

1130 
Ïb7
:

1131 
c
 = 
lb
;

1132 { 
c13
 = 
c
;

1133 { 
»t
 = 
	`r_po¡lude
();

1134 ià(
»t
 =ğ0è
Ïb15
;

1135 ià(
»t
 < 0) „et;

1137 
Ïb15
:

1138 
c
 = 
c13
;

1141 
Ïb0
:

1143 
	}
}

1145 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$IÁ”ÇlS‹mEnglish
()

1146 : 
	`B_Y_found
(0), 
	`I_p2
(0), 
	$I_p1
(0)

1148 
	}
}

1150 
	gX­Ÿn
::
IÁ”ÇlS‹mEnglish
::~
	$IÁ”ÇlS‹mEnglish
()

1152 
	}
}

1155 
X­Ÿn
::
IÁ”ÇlS‹mEnglish
::
	$g‘_desütiÚ
() const

1158 
	}
}

	@languages/english.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mEnglish
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
B_Y_found
;

9 
	gI_p2
;

10 
	gI_p1
;

11 
	gpublic
:

12 
r_exû±iÚ2
();

13 
r_exû±iÚ1
();

14 
r_S‹p_5
();

15 
r_S‹p_4
();

16 
r_S‹p_3
();

17 
r_S‹p_2
();

18 
r_S‹p_1c
();

19 
r_S‹p_1b
();

20 
r_S‹p_1a
();

21 
r_R2
();

22 
r_R1
();

23 
r_shÜtv
();

24 
r_m¬k_»giÚs
();

25 
r_po¡lude
();

26 
r_´–ude
();

28 
IÁ”ÇlS‹mEnglish
();

29 ~
IÁ”ÇlS‹mEnglish
();

30 
¡em
();

31 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/finnish.cc

3 
	~<lim™s.h
>

4 
	~"fšnish.h
"

6 
Œ_VI
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

7  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mFšnish
 *>(
this_±r
))->
r_VI
();

10 
Œ_LONG
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

11  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mFšnish
 *>(
this_±r
))->
r_LONG
();

14 cÚ¡ 
amÚg_funùiÚ
 
	gaf
[2] =

16  
Œ_VI
,

17  
Œ_LONG


20 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

21 
	#s_0_0
 0

	)

23 
	#s_0_1
 2

	)

25 
	#s_0_2
 5

	)

27 
	#s_0_3
 9

	)

29 
	#s_0_4
 12

	)

31 
	#s_0_5
 15

	)

33 
	#s_0_6
 19

	)

35 
	#s_0_7
 25

	)

37 
	#s_0_8
 27

	)

39 
	#s_0_9
 30

	)

41 
	#s_1_0
 33

	)

43 
	#s_1_1
 36

	)

45 
	#s_1_2
 38

	)

47 
	#s_1_3
 (
s_1_4
 + 1)

	)

48 
	#s_1_4
 41

	)

50 
	#s_1_5
 44

	)

52 
	#s_2_0
 47

	)

54 
	#s_2_1
 51

	)

56 
	#s_2_2
 54

	)

58 
	#s_2_3
 (
s_2_4
 + 1)

	)

59 
	#s_2_4
 58

	)

61 
	#s_2_5
 62

	)

63 
	#s_3_0
 66

	)

65 
	#s_3_1
 69

	)

67 
	#s_4_0
 72

	)

69 
	#s_4_1
 75

	)

71 
	#s_4_2
 78

	)

73 
	#s_4_3
 81

	)

75 
	#s_4_4
 83

	)

77 
	#s_4_5
 85

	)

79 
	#s_4_6
 87

	)

81 
	#s_4_7
 89

	)

83 
	#s_4_8
 92

	)

85 
	#s_5_0
 96

	)

87 
	#s_5_1
 98

	)

89 
	#s_5_2
 100

	)

91 
	#s_5_3
 102

	)

93 
	#s_5_4
 104

	)

95 
	#s_5_5
 106

	)

97 
	#s_5_6
 110

	)

99 
	#s_6_0
 (
s_6_1
 + 2)

	)

100 
	#s_6_1
 114

	)

102 
	#s_6_2
 117

	)

104 
	#s_6_3
 119

	)

106 
	#s_6_4
 (
s_6_5
 + 1)

	)

107 
	#s_6_5
 122

	)

109 
	#s_6_6
 125

	)

111 
	#s_6_7
 128

	)

113 
	#s_6_8
 131

	)

115 
	#s_6_9
 134

	)

117 
	#s_6_10
 137

	)

119 
	#s_6_11
 
s_6_2


	)

120 
	#s_6_12
 140

	)

122 
	#s_6_13
 143

	)

124 
	#s_6_14
 146

	)

126 
	#s_6_15
 150

	)

128 
	#s_6_16
 153

	)

130 
	#s_6_17
 157

	)

132 
	#s_6_18
 160

	)

134 
	#s_6_19
 164

	)

136 
	#s_6_20
 167

	)

138 
	#s_6_21
 171

	)

140 
	#s_6_22
 (
s_6_20
 + 1)

	)

141 
	#s_6_23
 175

	)

143 
	#s_6_24
 179

	)

145 
	#s_6_25
 182

	)

147 
	#s_6_26
 (
s_6_27
 + 1)

	)

148 
	#s_6_27
 186

	)

150 
	#s_6_28
 190

	)

152 
	#s_6_29
 194

	)

154 
	#s_7_0
 198

	)

156 
	#s_7_1
 (
s_7_2
 + 1)

	)

157 
	#s_7_2
 201

	)

159 
	#s_7_3
 (
s_7_4
 + 1)

	)

160 
	#s_7_4
 205

	)

162 
	#s_7_5
 (
s_7_6
 + 1)

	)

163 
	#s_7_6
 209

	)

165 
	#s_7_7
 (
s_7_8
 + 1)

	)

166 
	#s_7_8
 213

	)

168 
	#s_7_9
 217

	)

170 
	#s_7_10
 (
s_7_11
 + 1)

	)

171 
	#s_7_11
 221

	)

173 
	#s_7_12
 (
s_7_13
 + 1)

	)

174 
	#s_7_13
 226

	)

176 
	#s_8_0
 231

	)

178 
	#s_8_1
 232

	)

180 
	#s_9_0
 (
s_9_1
 + 1)

	)

181 
	#s_9_1
 233

	)

186 cÚ¡ 
amÚg
 
	ga_0
[10] =

188  { 2, 
s_0_0
, -1, 1},

189  { 3, 
s_0_1
, -1, 2},

190  { 4, 
s_0_2
, -1, 1},

191  { 3, 
s_0_3
, -1, 1},

192  { 3, 
s_0_4
, -1, 1},

193  { 4, 
s_0_5
, -1, 1},

194  { 6, 
s_0_6
, -1, 1},

195  { 2, 
s_0_7
, -1, 1},

196  { 3, 
s_0_8
, -1, 1},

197  { 3, 
s_0_9
, -1, 1}

201 cÚ¡ 
amÚg
 
	ga_1
[6] =

203  { 3, 
s_1_0
, -1, -1},

204  { 2, 
s_1_1
, -1, -1},

205  { 3, 
s_1_2
, -1, -1},

206  { 2, 
s_1_3
, -1, -1},

207  { 3, 
s_1_4
, 3, -1},

208  { 3, 
s_1_5
, 3, -1}

212 cÚ¡ 
amÚg
 
	ga_2
[6] =

214  { 4, 
s_2_0
, -1, -1},

215  { 3, 
s_2_1
, -1, -1},

216  { 4, 
s_2_2
, -1, -1},

217  { 3, 
s_2_3
, -1, -1},

218  { 4, 
s_2_4
, 3, -1},

219  { 4, 
s_2_5
, 3, -1}

223 cÚ¡ 
amÚg
 
	ga_3
[2] =

225  { 3, 
s_3_0
, -1, -1},

226  { 3, 
s_3_1
, -1, -1}

230 cÚ¡ 
amÚg
 
	ga_4
[9] =

232  { 3, 
s_4_0
, -1, 3},

233  { 3, 
s_4_1
, -1, 3},

234  { 3, 
s_4_2
, -1, 3},

235  { 2, 
s_4_3
, -1, 2},

236  { 2, 
s_4_4
, -1, 1},

237  { 2, 
s_4_5
, -1, 4},

238  { 2, 
s_4_6
, -1, 6},

239  { 3, 
s_4_7
, -1, 5},

240  { 4, 
s_4_8
, -1, 3}

244 cÚ¡ 
amÚg
 
	ga_5
[7] =

246  { 2, 
s_5_0
, -1, -1},

247  { 2, 
s_5_1
, -1, -1},

248  { 2, 
s_5_2
, -1, -1},

249  { 2, 
s_5_3
, -1, -1},

250  { 2, 
s_5_4
, -1, -1},

251  { 4, 
s_5_5
, -1, -1},

252  { 4, 
s_5_6
, -1, -1}

256 cÚ¡ 
amÚg
 
	ga_6
[30] =

258  { 1, 
s_6_0
, -1, 8},

259  { 3, 
s_6_1
, 0, -1},

260  { 2, 
s_6_2
, 0, -1},

261  { 3, 
s_6_3
, 0, -1},

262  { 2, 
s_6_4
, 0, -1},

263  { 3, 
s_6_5
, 4, -1},

264  { 3, 
s_6_6
, 4, -1},

265  { 3, 
s_6_7
, 4, 9},

266  { 3, 
s_6_8
, -1, -1},

267  { 3, 
s_6_9
, -1, -1},

268  { 3, 
s_6_10
, -1, -1},

269  { 1, 
s_6_11
, -1, 7},

270  { 3, 
s_6_12
, 11, 1},

271  { 3, 
s_6_13
, 11, -1},

272  { 4, 
s_6_14
, 11, -1},

273  { 3, 
s_6_15
, 11, 2},

274  { 4, 
s_6_16
, 11, -1},

275  { 3, 
s_6_17
, 11, 3},

276  { 4, 
s_6_18
, 11, -1},

277  { 3, 
s_6_19
, 11, 4},

278  { 4, 
s_6_20
, 11, 5},

279  { 4, 
s_6_21
, 11, 6},

280  { 2, 
s_6_22
, -1, 8},

281  { 4, 
s_6_23
, 22, -1},

282  { 3, 
s_6_24
, 22, -1},

283  { 4, 
s_6_25
, 22, -1},

284  { 3, 
s_6_26
, 22, -1},

285  { 4, 
s_6_27
, 26, -1},

286  { 4, 
s_6_28
, 26, -1},

287  { 4, 
s_6_29
, 26, 9}

290 cÚ¡ 
	gaf_6
[30] =

325 cÚ¡ 
amÚg
 
	ga_7
[14] =

327  { 3, 
s_7_0
, -1, -1},

328  { 3, 
s_7_1
, -1, 1},

329  { 4, 
s_7_2
, 1, -1},

330  { 3, 
s_7_3
, -1, 1},

331  { 4, 
s_7_4
, 3, -1},

332  { 3, 
s_7_5
, -1, 1},

333  { 4, 
s_7_6
, 5, -1},

334  { 3, 
s_7_7
, -1, 1},

335  { 4, 
s_7_8
, 7, -1},

336  { 4, 
s_7_9
, -1, -1},

337  { 4, 
s_7_10
, -1, 1},

338  { 5, 
s_7_11
, 10, -1},

339  { 4, 
s_7_12
, -1, 1},

340  { 5, 
s_7_13
, 12, -1}

344 cÚ¡ 
amÚg
 
	ga_8
[2] =

346  { 1, 
s_8_0
, -1, -1},

347  { 1, 
s_8_1
, -1, -1}

351 cÚ¡ 
amÚg
 
	ga_9
[2] =

353  { 3, 
s_9_0
, -1, 1},

354  { 4, 
s_9_1
, 0, -1}

357 cÚ¡ 
	gg_AEI
[] = { 17, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8 };

359 cÚ¡ 
	gg_V1
[] = { 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 32 };

361 cÚ¡ 
	gg_V2
[] = { 17, 65, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 32 };

363 cÚ¡ 
	gg_·¹işe_’d
[] = { 17, 97, 24, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 32 };

365 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'k', 's', 'e' };

366 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'k', 's', 'i' };

367 cÚ¡ 
symbŞ
 
	gs_2
[] = { 0xC3, 0xA4 };

368 cÚ¡ 
symbŞ
 
	gs_3
[] = { 0xC3, 0xB6 };

369 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'i', 'e' };

370 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'p', 'o' };

371 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'p', 'o' };

373 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_m¬k_»giÚs
() {

374 
I_p1
 = 
l
;

375 
I_p2
 = 
l
;

376 ià(
	`out_groupšg_U
(
g_V1
, 97, 246, 1) < 0)  0;

377 { 
»t
 = 
	`š_groupšg_U
(
g_V1
, 97, 246, 1);

378 ià(
»t
 < 0)  0;

379 
c
 +ğ
»t
;

381 
I_p1
 = 
c
;

382 ià(
	`out_groupšg_U
(
g_V1
, 97, 246, 1) < 0)  0;

383 { 
»t
 = 
	`š_groupšg_U
(
g_V1
, 97, 246, 1);

384 ià(
»t
 < 0)  0;

385 
c
 +ğ
»t
;

387 
I_p2
 = 
c
;

389 
	}
}

391 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_R2
() {

392 ià(!(
I_p2
 <ğ
c
))  0;

394 
	}
}

396 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_·¹işe_‘c
() {

397 
amÚg_v¬
;

398 { 
m1
 = 
l
 - 
c
; ()m1;

399 
mlim™1
;

400 ià(
c
 < 
I_p1
)  0;

401 
c
 = 
I_p1
;

402 
mlim™1
 = 
lb
;†b = 
c
;

403 
c
 = 
l
 - 
m1
;

404 
k‘
 = 
c
;

405 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 10, 0, 0);

406 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

407 
b¿
 = 
c
;

408 
lb
 = 
mlim™1
;

410 
amÚg_v¬
) {

413 ià(
	`š_groupšg_b_U
(
g_·¹işe_’d
, 97, 246, 0))  0;

416 { 
»t
 = 
	`r_R2
();

417 ià(
»t
 <= 0) „et;

421 ià(
	`¦iû_d–
() == -1)  -1;

423 
	}
}

425 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_pos£ssive
() {

426 
amÚg_v¬
;

427 { 
m1
 = 
l
 - 
c
; ()m1;

428 
mlim™1
;

429 ià(
c
 < 
I_p1
)  0;

430 
c
 = 
I_p1
;

431 
mlim™1
 = 
lb
;†b = 
c
;

432 
c
 = 
l
 - 
m1
;

433 
k‘
 = 
c
;

434 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 9, 0, 0);

435 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

436 
b¿
 = 
c
;

437 
lb
 = 
mlim™1
;

439 
amÚg_v¬
) {

442 { 
m2
 = 
l
 - 
c
; ()m2;

443 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'k'è
Ïb0
;

444 
c
--;

446 
Ïb0
:

447 
c
 = 
l
 - 
m2
;

449 ià(
	`¦iû_d–
() == -1)  -1;

452 ià(
	`¦iû_d–
() == -1)  -1;

453 
k‘
 = 
c
;

454 ià(!(
	`eq_s_b
(3, 
s_0
)))  0;

455 
b¿
 = 
c
;

456 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_1
);

457 ià(
»t
 < 0) „et;

461 ià(
	`¦iû_d–
() == -1)  -1;

464 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] != 97)  0;

465 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 6, 0, 0)))  0;

466 ià(
	`¦iû_d–
() == -1)  -1;

469 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] != 164)  0;

470 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 6, 0, 0)))  0;

471 ià(
	`¦iû_d–
() == -1)  -1;

474 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] != 101)  0;

475 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 2, 0, 0)))  0;

476 ià(
	`¦iû_d–
() == -1)  -1;

480 
	}
}

482 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_LONG
() {

483 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 7, 0, 0)))  0;

485 
	}
}

487 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_VI
() {

488 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'i')  0;

489 
c
--;

490 ià(
	`š_groupšg_b_U
(
g_V2
, 97, 246, 0))  0;

492 
	}
}

494 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_ÿ£_’dšg
() {

495 
amÚg_v¬
;

496 { 
m1
 = 
l
 - 
c
; ()m1;

497 
mlim™1
;

498 ià(
c
 < 
I_p1
)  0;

499 
c
 = 
I_p1
;

500 
mlim™1
 = 
lb
;†b = 
c
;

501 
c
 = 
l
 - 
m1
;

502 
k‘
 = 
c
;

503 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 30, 
af_6
, 
af
);

504 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

505 
b¿
 = 
c
;

506 
lb
 = 
mlim™1
;

508 
amÚg_v¬
) {

511 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'a')  0;

512 
c
--;

515 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'e')  0;

516 
c
--;

519 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'i')  0;

520 
c
--;

523 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'o')  0;

524 
c
--;

527 ià(!(
	`eq_s_b
(2, 
s_2
)))  0;

530 ià(!(
	`eq_s_b
(2, 
s_3
)))  0;

533 { 
m2
 = 
l
 - 
c
; ()m2;

534 { 
m3
 = 
l
 - 
c
; ()m3;

535 { 
m4
 = 
l
 - 
c
; ()m4;

536 { 
»t
 = 
	`r_LONG
();

537 ià(
»t
 =ğ0è
Ïb2
;

538 ià(
»t
 < 0) „et;

540 
Ïb1
;

541 
Ïb2
:

542 
c
 = 
l
 - 
m4
;

543 ià(!(
	`eq_s_b
(2, 
s_4
))è{ 
c
 = 
l
 - 
m2
; 
Ïb0
; }

545 
Ïb1
:

546 
c
 = 
l
 - 
m3
;

547 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

548 ià(
»t
 < 0è{ 
c
 = 
l
 - 
m2
; 
Ïb0
; }

549 
c
 = 
»t
;

552 
b¿
 = 
c
;

553 
Ïb0
:

558 ià(
	`š_groupšg_b_U
(
g_V1
, 97, 246, 0))  0;

559 ià(
	`out_groupšg_b_U
(
g_V1
, 97, 246, 0))  0;

562 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'e')  0;

563 
c
--;

566 ià(
	`¦iû_d–
() == -1)  -1;

567 
B_’dšg_»moved
 = 1;

569 
	}
}

571 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_Ùh”_’dšgs
() {

572 
amÚg_v¬
;

573 { 
m1
 = 
l
 - 
c
; ()m1;

574 
mlim™1
;

575 ià(
c
 < 
I_p2
)  0;

576 
c
 = 
I_p2
;

577 
mlim™1
 = 
lb
;†b = 
c
;

578 
c
 = 
l
 - 
m1
;

579 
k‘
 = 
c
;

580 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 14, 0, 0);

581 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

582 
b¿
 = 
c
;

583 
lb
 = 
mlim™1
;

585 
amÚg_v¬
) {

588 { 
m2
 = 
l
 - 
c
; ()m2;

589 ià(!(
	`eq_s_b
(2, 
s_5
))è
Ïb0
;

591 
Ïb0
:

592 
c
 = 
l
 - 
m2
;

596 ià(
	`¦iû_d–
() == -1)  -1;

598 
	}
}

600 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_i_¶u¿l
() {

601 { 
m1
 = 
l
 - 
c
; ()m1;

602 
mlim™1
;

603 ià(
c
 < 
I_p1
)  0;

604 
c
 = 
I_p1
;

605 
mlim™1
 = 
lb
;†b = 
c
;

606 
c
 = 
l
 - 
m1
;

607 
k‘
 = 
c
;

608 ià(
c
 <ğ
lb
 || (
p
[ø- 1] !ğ105 &&…[ø- 1] !ğ106)è{†b = 
mlim™1
;  0; }

609 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_8
, 2, 0, 0))è{ 
lb
 = 
mlim™1
;  0; }

610 
b¿
 = 
c
;

611 
lb
 = 
mlim™1
;

613 ià(
	`¦iû_d–
() == -1)  -1;

615 
	}
}

617 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_t_¶u¿l
() {

618 
amÚg_v¬
;

619 { 
m1
 = 
l
 - 
c
; ()m1;

620 
mlim™1
;

621 ià(
c
 < 
I_p1
)  0;

622 
c
 = 
I_p1
;

623 
mlim™1
 = 
lb
;†b = 
c
;

624 
c
 = 
l
 - 
m1
;

625 
k‘
 = 
c
;

626 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ't'è{†b = 
mlim™1
;  0; }

627 
c
--;

628 
b¿
 = 
c
;

629 { 
m_‹¡2
 = 
l
 - 
c
;

630 ià(
	`š_groupšg_b_U
(
g_V1
, 97, 246, 0)è{ 
lb
 = 
mlim™1
;  0; }

631 
c
 = 
l
 - 
m_‹¡2
;

633 ià(
	`¦iû_d–
() == -1)  -1;

634 
lb
 = 
mlim™1
;

636 { 
m3
 = 
l
 - 
c
; ()m3;

637 
mlim™3
;

638 ià(
c
 < 
I_p2
)  0;

639 
c
 = 
I_p2
;

640 
mlim™3
 = 
lb
;†b = 
c
;

641 
c
 = 
l
 - 
m3
;

642 
k‘
 = 
c
;

643 ià(
c
 - 2 <ğ
lb
 || 
p
[ø- 1] !ğ97è{†b = 
mlim™3
;  0; }

644 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_9
, 2, 0, 0);

645 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™3
;  0; }

646 
b¿
 = 
c
;

647 
lb
 = 
mlim™3
;

649 
amÚg_v¬
) {

652 { 
m4
 = 
l
 - 
c
; ()m4;

653 ià(!(
	`eq_s_b
(2, 
s_6
))è
Ïb0
;

655 
Ïb0
:

656 
c
 = 
l
 - 
m4
;

660 ià(
	`¦iû_d–
() == -1)  -1;

662 
	}
}

664 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$r_tidy
() {

665 { 
m1
 = 
l
 - 
c
; ()m1;

666 
mlim™1
;

667 ià(
c
 < 
I_p1
)  0;

668 
c
 = 
I_p1
;

669 
mlim™1
 = 
lb
;†b = 
c
;

670 
c
 = 
l
 - 
m1
;

671 { 
m2
 = 
l
 - 
c
; ()m2;

672 { 
m3
 = 
l
 - 
c
; ()m3;

673 { 
»t
 = 
	`r_LONG
();

674 ià(
»t
 =ğ0è
Ïb0
;

675 ià(
»t
 < 0) „et;

677 
c
 = 
l
 - 
m3
;

678 
k‘
 = 
c
;

679 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

680 ià(
»t
 < 0è
Ïb0
;

681 
c
 = 
»t
;

683 
b¿
 = 
c
;

684 ià(
	`¦iû_d–
() == -1)  -1;

686 
Ïb0
:

687 
c
 = 
l
 - 
m2
;

689 { 
m4
 = 
l
 - 
c
; ()m4;

690 
k‘
 = 
c
;

691 ià(
	`š_groupšg_b_U
(
g_AEI
, 97, 228, 0)è
Ïb1
;

692 
b¿
 = 
c
;

693 ià(
	`out_groupšg_b_U
(
g_V1
, 97, 246, 0)è
Ïb1
;

694 ià(
	`¦iû_d–
() == -1)  -1;

695 
Ïb1
:

696 
c
 = 
l
 - 
m4
;

698 { 
m5
 = 
l
 - 
c
; ()m5;

699 
k‘
 = 
c
;

700 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'j'è
Ïb2
;

701 
c
--;

702 
b¿
 = 
c
;

703 { 
m6
 = 
l
 - 
c
; ()m6;

704 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'o'è
Ïb4
;

705 
c
--;

706 
Ïb3
;

707 
Ïb4
:

708 
c
 = 
l
 - 
m6
;

709 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è
Ïb2
;

710 
c
--;

712 
Ïb3
:

713 ià(
	`¦iû_d–
() == -1)  -1;

714 
Ïb2
:

715 
c
 = 
l
 - 
m5
;

717 { 
m7
 = 
l
 - 
c
; ()m7;

718 
k‘
 = 
c
;

719 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'o'è
Ïb5
;

720 
c
--;

721 
b¿
 = 
c
;

722 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'j'è
Ïb5
;

723 
c
--;

724 ià(
	`¦iû_d–
() == -1)  -1;

725 
Ïb5
:

726 
c
 = 
l
 - 
m7
;

728 
lb
 = 
mlim™1
;

730 ià(
	`š_groupšg_b_U
(
g_V1
, 97, 246, 1) < 0)  0;

731 
k‘
 = 
c
;

732 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

733 ià(
»t
 < 0)  0;

734 
c
 = 
»t
;

736 
b¿
 = 
c
;

737 { 
symbŞ
 * 
»t
 = 
	`¦iû_to
(
S_x
);

738 ià(
»t
 == 0)  -1;

739 
S_x
 = 
»t
;

741 ià(!(
	`eq_v_b
(
S_x
)))  0;

742 ià(
	`¦iû_d–
() == -1)  -1;

744 
	}
}

746 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$¡em
() {

747 { 
c1
 = 
c
;

748 { 
»t
 = 
	`r_m¬k_»giÚs
();

749 ià(
»t
 =ğ0è
Ïb0
;

750 ià(
»t
 < 0) „et;

752 
Ïb0
:

753 
c
 = 
c1
;

755 
B_’dšg_»moved
 = 0;

756 
lb
 = 
c
; c = 
l
;

758 { 
m2
 = 
l
 - 
c
; ()m2;

759 { 
»t
 = 
	`r_·¹işe_‘c
();

760 ià(
»t
 =ğ0è
Ïb1
;

761 ià(
»t
 < 0) „et;

763 
Ïb1
:

764 
c
 = 
l
 - 
m2
;

766 { 
m3
 = 
l
 - 
c
; ()m3;

767 { 
»t
 = 
	`r_pos£ssive
();

768 ià(
»t
 =ğ0è
Ïb2
;

769 ià(
»t
 < 0) „et;

771 
Ïb2
:

772 
c
 = 
l
 - 
m3
;

774 { 
m4
 = 
l
 - 
c
; ()m4;

775 { 
»t
 = 
	`r_ÿ£_’dšg
();

776 ià(
»t
 =ğ0è
Ïb3
;

777 ià(
»t
 < 0) „et;

779 
Ïb3
:

780 
c
 = 
l
 - 
m4
;

782 { 
m5
 = 
l
 - 
c
; ()m5;

783 { 
»t
 = 
	`r_Ùh”_’dšgs
();

784 ià(
»t
 =ğ0è
Ïb4
;

785 ià(
»t
 < 0) „et;

787 
Ïb4
:

788 
c
 = 
l
 - 
m5
;

790 { 
m6
 = 
l
 - 
c
; ()m6;

791 ià(!(
B_’dšg_»moved
)è
Ïb6
;

792 { 
m7
 = 
l
 - 
c
; ()m7;

793 { 
»t
 = 
	`r_i_¶u¿l
();

794 ià(
»t
 =ğ0è
Ïb7
;

795 ià(
»t
 < 0) „et;

797 
Ïb7
:

798 
c
 = 
l
 - 
m7
;

800 
Ïb5
;

801 
Ïb6
:

802 
c
 = 
l
 - 
m6
;

803 { 
m8
 = 
l
 - 
c
; ()m8;

804 { 
»t
 = 
	`r_t_¶u¿l
();

805 ià(
»t
 =ğ0è
Ïb8
;

806 ià(
»t
 < 0) „et;

808 
Ïb8
:

809 
c
 = 
l
 - 
m8
;

812 
Ïb5
:

813 { 
m9
 = 
l
 - 
c
; ()m9;

814 { 
»t
 = 
	`r_tidy
();

815 ià(
»t
 =ğ0è
Ïb9
;

816 ià(
»t
 < 0) „et;

818 
Ïb9
:

819 
c
 = 
l
 - 
m9
;

821 
c
 = 
lb
;

823 
	}
}

825 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$IÁ”ÇlS‹mFšnish
()

826 : 
	`B_’dšg_»moved
(0), 
	`S_x
(0), 
	`I_p2
(0), 
	$I_p1
(0)

828 
S_x
 = 
	`ü—‹_s
();

829 
	}
}

831 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::~
	$IÁ”ÇlS‹mFšnish
()

833 
	`lo£_s
(
S_x
);

834 
	}
}

837 
	gX­Ÿn
::
IÁ”ÇlS‹mFšnish
::
	$g‘_desütiÚ
() const

840 
	}
}

	@languages/finnish.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mFšnish
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
B_’dšg_»moved
;

9 
symbŞ
 * 
	gS_x
;

10 
	gI_p2
;

11 
	gI_p1
;

12 
	gpublic
:

13 
r_tidy
();

14 
r_Ùh”_’dšgs
();

15 
r_t_¶u¿l
();

16 
r_i_¶u¿l
();

17 
r_ÿ£_’dšg
();

18 
r_VI
();

19 
r_LONG
();

20 
r_pos£ssive
();

21 
r_·¹işe_‘c
();

22 
r_R2
();

23 
r_m¬k_»giÚs
();

25 
IÁ”ÇlS‹mFšnish
();

26 ~
IÁ”ÇlS‹mFšnish
();

27 
¡em
();

28 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/french.cc

3 
	~<lim™s.h
>

4 
	~"ä’ch.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_0
 0

	)

9 
	#s_0_1
 3

	)

11 
	#s_0_2
 6

	)

13 
	#s_1_1
 9

	)

15 
	#s_1_2
 10

	)

17 
	#s_1_3
 11

	)

19 
	#s_2_0
 12

	)

21 
	#s_2_1
 15

	)

23 
	#s_2_2
 18

	)

25 
	#s_2_3
 22

	)

27 
	#s_2_4
 26

	)

29 
	#s_2_5
 29

	)

31 
	#s_3_0
 31

	)

33 
	#s_3_1
 33

	)

35 
	#s_3_2
 37

	)

37 
	#s_4_0
 
s_4_15


	)

38 
	#s_4_1
 
s_4_16


	)

39 
	#s_4_2
 
s_4_17


	)

40 
	#s_4_3
 
s_4_18


	)

41 
	#s_4_4
 
s_4_19


	)

42 
	#s_4_5
 
s_4_20


	)

43 
	#s_4_6
 
s_4_21


	)

44 
	#s_4_7
 
s_4_22


	)

45 
	#s_4_8
 
s_4_23


	)

46 
	#s_4_9
 
s_4_24


	)

47 
	#s_4_10
 
s_4_25


	)

48 
	#s_4_11
 
s_4_26


	)

49 
	#s_4_12
 
s_4_27


	)

50 
	#s_4_13
 
s_4_28


	)

51 
	#s_4_14
 
s_4_29


	)

52 
	#s_4_15
 39

	)

54 
	#s_4_16
 44

	)

56 
	#s_4_17
 51

	)

58 
	#s_4_18
 56

	)

60 
	#s_4_19
 61

	)

62 
	#s_4_20
 67

	)

64 
	#s_4_21
 72

	)

66 
	#s_4_22
 77

	)

68 
	#s_4_23
 82

	)

70 
	#s_4_24
 87

	)

72 
	#s_4_25
 91

	)

74 
	#s_4_26
 94

	)

76 
	#s_4_27
 100

	)

78 
	#s_4_28
 106

	)

80 
	#s_4_29
 112

	)

82 
	#s_4_30
 (
s_4_31
 + 1)

	)

83 
	#s_4_31
 (
s_4_32
 + 3)

	)

84 
	#s_4_32
 118

	)

86 
	#s_4_33
 127

	)

88 
	#s_4_34
 
s_4_30


	)

89 
	#s_4_35
 
s_4_31


	)

90 
	#s_4_36
 
s_4_32


	)

91 
	#s_4_37
 132

	)

93 
	#s_4_38
 138

	)

95 
	#s_4_39
 (
s_4_40
 + 1)

	)

96 
	#s_4_40
 144

	)

98 
	#s_4_41
 148

	)

100 
	#s_4_42
 
s_4_33


	)

101 
	#s_5_0
 
s_5_5


	)

102 
	#s_5_1
 
s_5_8


	)

103 
	#s_5_2
 
s_5_10


	)

104 
	#s_5_3
 
s_5_11


	)

105 
	#s_5_4
 
s_5_0


	)

106 
	#s_5_5
 
s_5_14


	)

107 
	#s_5_6
 
s_5_0


	)

108 
	#s_5_7
 151

	)

110 
	#s_5_8
 155

	)

112 
	#s_5_9
 158

	)

114 
	#s_5_10
 163

	)

116 
	#s_5_11
 168

	)

118 
	#s_5_12
 176

	)

120 
	#s_5_13
 
s_5_2


	)

121 
	#s_5_14
 181

	)

123 
	#s_5_15
 186

	)

125 
	#s_5_16
 192

	)

127 
	#s_5_17
 198

	)

129 
	#s_5_18
 205

	)

131 
	#s_5_19
 210

	)

133 
	#s_5_20
 216

	)

135 
	#s_5_21
 (
s_5_22
 + 3)

	)

136 
	#s_5_22
 223

	)

138 
	#s_5_23
 228

	)

140 
	#s_5_24
 
s_5_3


	)

141 
	#s_5_25
 234

	)

143 
	#s_5_26
 241

	)

145 
	#s_5_27
 249

	)

147 
	#s_5_28
 254

	)

149 
	#s_5_29
 260

	)

151 
	#s_5_30
 
s_5_12


	)

152 
	#s_5_31
 265

	)

154 
	#s_5_32
 270

	)

156 
	#s_5_33
 276

	)

158 
	#s_5_34
 280

	)

160 
	#s_6_0
 (
s_6_1
 + 2)

	)

161 
	#s_6_1
 
s_6_6


	)

162 
	#s_6_2
 
s_6_11


	)

163 
	#s_6_3
 
s_6_12


	)

164 
	#s_6_4
 
s_6_14


	)

165 
	#s_6_5
 (
s_6_6
 + 2)

	)

166 
	#s_6_6
 
s_6_16


	)

167 
	#s_6_7
 
s_6_1


	)

168 
	#s_6_8
 
s_6_2


	)

169 
	#s_6_9
 285

	)

171 
	#s_6_10
 289

	)

173 
	#s_6_11
 294

	)

175 
	#s_6_12
 299

	)

177 
	#s_6_13
 304

	)

179 
	#s_6_14
 309

	)

181 
	#s_6_15
 (
s_6_16
 + 2)

	)

182 
	#s_6_16
 313

	)

184 
	#s_6_17
 (
s_6_18
 + 2)

	)

185 
	#s_6_18
 318

	)

187 
	#s_6_19
 324

	)

189 
	#s_6_20
 331

	)

191 
	#s_6_21
 336

	)

193 
	#s_6_22
 340

	)

195 
	#s_6_23
 (
s_6_24
 + 2)

	)

196 
	#s_6_24
 343

	)

198 
	#s_6_25
 
s_6_3


	)

199 
	#s_6_26
 (
s_6_27
 + 2)

	)

200 
	#s_6_27
 348

	)

202 
	#s_6_28
 355

	)

204 
	#s_6_29
 361

	)

206 
	#s_6_30
 367

	)

208 
	#s_6_31
 
s_6_13


	)

209 
	#s_6_32
 (
s_6_33
 + 1)

	)

210 
	#s_6_33
 (
s_6_34
 + 2)

	)

211 
	#s_6_34
 372

	)

213 
	#s_6_35
 377

	)

215 
	#s_6_36
 383

	)

217 
	#s_6_37
 
s_6_4


	)

218 
	#s_7_0
 (
s_7_1
 + 4)

	)

219 
	#s_7_1
 387

	)

221 
	#s_7_2
 392

	)

223 
	#s_7_3
 397

	)

225 
	#s_7_4
 400

	)

227 
	#s_7_5
 403

	)

229 
	#s_7_6
 406

	)

231 
	#s_8_0
 408

	)

233 
	#s_8_1
 411

	)

235 
	#s_8_2
 415

	)

237 
	#s_8_3
 418

	)

239 
	#s_8_4
 421

	)

244 cÚ¡ 
amÚg
 
	ga_0
[3] =

246  { 3, 
s_0_0
, -1, -1},

247  { 3, 
s_0_1
, -1, -1},

248  { 3, 
s_0_2
, -1, -1}

252 cÚ¡ 
amÚg
 
	ga_1
[4] =

255  { 1, 
s_1_1
, 0, 1},

256  { 1, 
s_1_2
, 0, 2},

257  { 1, 
s_1_3
, 0, 3}

261 cÚ¡ 
amÚg
 
	ga_2
[6] =

263  { 3, 
s_2_0
, -1, 3},

264  { 3, 
s_2_1
, -1, 3},

265  { 4, 
s_2_2
, -1, 4},

266  { 4, 
s_2_3
, -1, 4},

267  { 3, 
s_2_4
, -1, 2},

268  { 2, 
s_2_5
, -1, 1}

272 cÚ¡ 
amÚg
 
	ga_3
[3] =

274  { 2, 
s_3_0
, -1, 2},

275  { 4, 
s_3_1
, -1, 1},

276  { 2, 
s_3_2
, -1, 3}

280 cÚ¡ 
amÚg
 
	ga_4
[43] =

282  { 4, 
s_4_0
, -1, 1},

283  { 6, 
s_4_1
, -1, 2},

284  { 4, 
s_4_2
, -1, 1},

285  { 4, 
s_4_3
, -1, 5},

286  { 5, 
s_4_4
, -1, 3},

287  { 4, 
s_4_5
, -1, 1},

288  { 4, 
s_4_6
, -1, 1},

289  { 4, 
s_4_7
, -1, 11},

290  { 4, 
s_4_8
, -1, 1},

291  { 3, 
s_4_9
, -1, 8},

292  { 2, 
s_4_10
, -1, 8},

293  { 5, 
s_4_11
, -1, 4},

294  { 5, 
s_4_12
, -1, 2},

295  { 5, 
s_4_13
, -1, 4},

296  { 5, 
s_4_14
, -1, 2},

297  { 5, 
s_4_15
, -1, 1},

298  { 7, 
s_4_16
, -1, 2},

299  { 5, 
s_4_17
, -1, 1},

300  { 5, 
s_4_18
, -1, 5},

301  { 6, 
s_4_19
, -1, 3},

302  { 5, 
s_4_20
, -1, 1},

303  { 5, 
s_4_21
, -1, 1},

304  { 5, 
s_4_22
, -1, 11},

305  { 5, 
s_4_23
, -1, 1},

306  { 4, 
s_4_24
, -1, 8},

307  { 3, 
s_4_25
, -1, 8},

308  { 6, 
s_4_26
, -1, 4},

309  { 6, 
s_4_27
, -1, 2},

310  { 6, 
s_4_28
, -1, 4},

311  { 6, 
s_4_29
, -1, 2},

312  { 5, 
s_4_30
, -1, 15},

313  { 6, 
s_4_31
, 30, 6},

314  { 9, 
s_4_32
, 31, 12},

315  { 5, 
s_4_33
, -1, 7},

316  { 4, 
s_4_34
, -1, 15},

317  { 5, 
s_4_35
, 34, 6},

318  { 8, 
s_4_36
, 35, 12},

319  { 6, 
s_4_37
, 34, 13},

320  { 6, 
s_4_38
, 34, 14},

321  { 3, 
s_4_39
, -1, 10},

322  { 4, 
s_4_40
, 39, 9},

323  { 3, 
s_4_41
, -1, 1},

324  { 4, 
s_4_42
, -1, 7}

328 cÚ¡ 
amÚg
 
	ga_5
[35] =

330  { 3, 
s_5_0
, -1, 1},

331  { 2, 
s_5_1
, -1, 1},

332  { 4, 
s_5_2
, -1, 1},

333  { 7, 
s_5_3
, -1, 1},

334  { 1, 
s_5_4
, -1, 1},

335  { 4, 
s_5_5
, 4, 1},

336  { 2, 
s_5_6
, -1, 1},

337  { 4, 
s_5_7
, -1, 1},

338  { 3, 
s_5_8
, -1, 1},

339  { 5, 
s_5_9
, -1, 1},

340  { 5, 
s_5_10
, -1, 1},

341  { 8, 
s_5_11
, -1, 1},

342  { 5, 
s_5_12
, -1, 1},

343  { 2, 
s_5_13
, -1, 1},

344  { 5, 
s_5_14
, 13, 1},

345  { 6, 
s_5_15
, 13, 1},

346  { 6, 
s_5_16
, -1, 1},

347  { 7, 
s_5_17
, -1, 1},

348  { 5, 
s_5_18
, -1, 1},

349  { 6, 
s_5_19
, -1, 1},

350  { 7, 
s_5_20
, -1, 1},

351  { 2, 
s_5_21
, -1, 1},

352  { 5, 
s_5_22
, 21, 1},

353  { 6, 
s_5_23
, 21, 1},

354  { 6, 
s_5_24
, -1, 1},

355  { 7, 
s_5_25
, -1, 1},

356  { 8, 
s_5_26
, -1, 1},

357  { 5, 
s_5_27
, -1, 1},

358  { 6, 
s_5_28
, -1, 1},

359  { 5, 
s_5_29
, -1, 1},

360  { 3, 
s_5_30
, -1, 1},

361  { 5, 
s_5_31
, -1, 1},

362  { 6, 
s_5_32
, -1, 1},

363  { 4, 
s_5_33
, -1, 1},

364  { 5, 
s_5_34
, -1, 1}

368 cÚ¡ 
amÚg
 
	ga_6
[38] =

370  { 1, 
s_6_0
, -1, 3},

371  { 3, 
s_6_1
, 0, 2},

372  { 4, 
s_6_2
, -1, 3},

373  { 4, 
s_6_3
, -1, 3},

374  { 3, 
s_6_4
, -1, 2},

375  { 2, 
s_6_5
, -1, 3},

376  { 4, 
s_6_6
, 5, 2},

377  { 2, 
s_6_7
, -1, 2},

378  { 2, 
s_6_8
, -1, 3},

379  { 4, 
s_6_9
, 8, 2},

380  { 5, 
s_6_10
, -1, 3},

381  { 5, 
s_6_11
, -1, 3},

382  { 5, 
s_6_12
, -1, 3},

383  { 5, 
s_6_13
, -1, 3},

384  { 4, 
s_6_14
, -1, 2},

385  { 3, 
s_6_15
, -1, 3},

386  { 5, 
s_6_16
, 15, 2},

387  { 4, 
s_6_17
, -1, 1},

388  { 6, 
s_6_18
, 17, 2},

389  { 7, 
s_6_19
, 17, 3},

390  { 5, 
s_6_20
, -1, 2},

391  { 4, 
s_6_21
, -1, 3},

392  { 3, 
s_6_22
, -1, 2},

393  { 3, 
s_6_23
, -1, 3},

394  { 5, 
s_6_24
, 23, 2},

395  { 3, 
s_6_25
, -1, 3},

396  { 5, 
s_6_26
, -1, 3},

397  { 7, 
s_6_27
, 26, 2},

398  { 6, 
s_6_28
, -1, 2},

399  { 6, 
s_6_29
, -1, 3},

400  { 5, 
s_6_30
, -1, 2},

401  { 3, 
s_6_31
, -1, 3},

402  { 2, 
s_6_32
, -1, 2},

403  { 3, 
s_6_33
, 32, 2},

404  { 5, 
s_6_34
, 33, 2},

405  { 6, 
s_6_35
, 33, 3},

406  { 4, 
s_6_36
, 32, 2},

407  { 2, 
s_6_37
, -1, 2}

411 cÚ¡ 
amÚg
 
	ga_7
[7] =

413  { 1, 
s_7_0
, -1, 3},

414  { 5, 
s_7_1
, 0, 2},

415  { 5, 
s_7_2
, 0, 2},

416  { 3, 
s_7_3
, -1, 1},

417  { 3, 
s_7_4
, -1, 2},

418  { 3, 
s_7_5
, -1, 2},

419  { 2, 
s_7_6
, -1, 4}

423 cÚ¡ 
amÚg
 
	ga_8
[5] =

425  { 3, 
s_8_0
, -1, -1},

426  { 4, 
s_8_1
, -1, -1},

427  { 3, 
s_8_2
, -1, -1},

428  { 3, 
s_8_3
, -1, -1},

429  { 3, 
s_8_4
, -1, -1}

432 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 130, 103, 8, 5 };

434 cÚ¡ 
	gg_k“p_w™h_s
[] = { 1, 65, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128 };

436 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'U' };

437 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'I' };

438 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'Y' };

439 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'Y' };

440 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'U' };

441 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'i' };

442 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'u' };

443 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'y' };

444 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'i', 'c' };

445 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'i', 'q', 'U' };

446 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'l', 'o', 'g' };

447 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'u' };

448 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'e', 'n', 't' };

449 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'a', 't' };

450 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'e', 'u', 'x' };

451 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'i' };

452 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'a', 'b', 'l' };

453 cÚ¡ 
symbŞ
 
	gs_17
[] = { 'i', 'q', 'U' };

454 cÚ¡ 
symbŞ
 
	gs_18
[] = { 'a', 't' };

455 cÚ¡ 
symbŞ
 
	gs_19
[] = { 'i', 'c' };

456 cÚ¡ 
symbŞ
 
	gs_20
[] = { 'i', 'q', 'U' };

457 cÚ¡ 
symbŞ
 
	gs_21
[] = { 'e', 'a', 'u' };

458 cÚ¡ 
symbŞ
 
	gs_22
[] = { 'a', 'l' };

459 cÚ¡ 
symbŞ
 
	gs_23
[] = { 'e', 'u', 'x' };

460 cÚ¡ 
symbŞ
 
	gs_24
[] = { 'a', 'n', 't' };

461 cÚ¡ 
symbŞ
 
	gs_25
[] = { 'e', 'n', 't' };

462 cÚ¡ 
symbŞ
 
	gs_26
[] = { 'i' };

463 cÚ¡ 
symbŞ
 
	gs_27
[] = { 'g', 'u' };

464 cÚ¡ 
symbŞ
 
	gs_28
[] = { 0xC3, 0xA9 };

465 cÚ¡ 
symbŞ
 
	gs_29
[] = { 0xC3, 0xA8 };

466 cÚ¡ 
symbŞ
 
	gs_30
[] = { 'e' };

467 cÚ¡ 
symbŞ
 
	gs_31
[] = { 'i' };

468 cÚ¡ 
symbŞ
 
	gs_32
[] = { 0xC3, 0xA7 };

469 cÚ¡ 
symbŞ
 
	gs_33
[] = { 'c' };

471 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_´–ude
() {

473 
c1
 = 
c
;

475 
c2
 = 
c
;

476 { 
c3
 = 
c
;

477 ià(
	`š_groupšg_U
(
g_v
, 97, 251, 0)è
Ïb3
;

478 
b¿
 = 
c
;

479 { 
c4
 = 
c
;

480 ià(
c
 =ğ
l
 || 
p
[c] !ğ'u'è
Ïb5
;

481 
c
++;

482 
k‘
 = 
c
;

483 ià(
	`š_groupšg_U
(
g_v
, 97, 251, 0)è
Ïb5
;

484 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_0
);

485 ià(
»t
 < 0) „et;

487 
Ïb4
;

488 
Ïb5
:

489 
c
 = 
c4
;

490 ià(
c
 =ğ
l
 || 
p
[c] !ğ'i'è
Ïb6
;

491 
c
++;

492 
k‘
 = 
c
;

493 ià(
	`š_groupšg_U
(
g_v
, 97, 251, 0)è
Ïb6
;

494 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_1
);

495 ià(
»t
 < 0) „et;

497 
Ïb4
;

498 
Ïb6
:

499 
c
 = 
c4
;

500 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb3
;

501 
c
++;

502 
k‘
 = 
c
;

503 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_2
);

504 ià(
»t
 < 0) „et;

507 
Ïb4
:

508 
Ïb2
;

509 
Ïb3
:

510 
c
 = 
c3
;

511 
b¿
 = 
c
;

512 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb7
;

513 
c
++;

514 
k‘
 = 
c
;

515 ià(
	`š_groupšg_U
(
g_v
, 97, 251, 0)è
Ïb7
;

516 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_3
);

517 ià(
»t
 < 0) „et;

519 
Ïb2
;

520 
Ïb7
:

521 
c
 = 
c3
;

522 ià(
c
 =ğ
l
 || 
p
[c] !ğ'q'è
Ïb1
;

523 
c
++;

524 
b¿
 = 
c
;

525 ià(
c
 =ğ
l
 || 
p
[c] !ğ'u'è
Ïb1
;

526 
c
++;

527 
k‘
 = 
c
;

528 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_4
);

529 ià(
»t
 < 0) „et;

532 
Ïb2
:

533 
c
 = 
c2
;

535 
Ïb1
:

536 
c
 = 
c2
;

537 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

538 ià(
»t
 < 0è
Ïb0
;

539 
c
 = 
»t
;

543 
Ïb0
:

544 
c
 = 
c1
;

548 
	}
}

550 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_m¬k_»giÚs
() {

551 
I_pV
 = 
l
;

552 
I_p1
 = 
l
;

553 
I_p2
 = 
l
;

554 { 
c1
 = 
c
;

555 { 
c2
 = 
c
;

556 ià(
	`š_groupšg_U
(
g_v
, 97, 251, 0)è
Ïb2
;

557 ià(
	`š_groupšg_U
(
g_v
, 97, 251, 0)è
Ïb2
;

558 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

559 ià(
»t
 < 0è
Ïb2
;

560 
c
 = 
»t
;

562 
Ïb1
;

563 
Ïb2
:

564 
c
 = 
c2
;

565 ià(
c
 + 2 >ğ
l
 || 
p
[ø+ 2] >> 5 !ğ3 || !((331776 >> (p[ø+ 2] & 0x1f)è& 1)è
Ïb3
;

566 ià(!(
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 3, 0, 0))è
Ïb3
;

567 
Ïb1
;

568 
Ïb3
:

569 
c
 = 
c2
;

570 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

571 ià(
»t
 < 0è
Ïb0
;

572 
c
 = 
»t
;

574 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 251, 1);

575 ià(
»t
 < 0è
Ïb0
;

576 
c
 +ğ
»t
;

579 
Ïb1
:

580 
I_pV
 = 
c
;

581 
Ïb0
:

582 
c
 = 
c1
;

584 { 
c3
 = 
c
;

585 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 251, 1);

586 ià(
»t
 < 0è
Ïb4
;

587 
c
 +ğ
»t
;

589 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 251, 1);

590 ià(
»t
 < 0è
Ïb4
;

591 
c
 +ğ
»t
;

593 
I_p1
 = 
c
;

594 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 251, 1);

595 ià(
»t
 < 0è
Ïb4
;

596 
c
 +ğ
»t
;

598 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 251, 1);

599 ià(
»t
 < 0è
Ïb4
;

600 
c
 +ğ
»t
;

602 
I_p2
 = 
c
;

603 
Ïb4
:

604 
c
 = 
c3
;

607 
	}
}

609 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_po¡lude
() {

610 
amÚg_v¬
;

612 
c1
 = 
c
;

613 
b¿
 = 
c
;

614 ià(
c
 >ğ
l
 || 
p
[ø+ 0] >> 5 !ğ2 || !((35652096 >> (p[ø+ 0] & 0x1f)è& 1)è
amÚg_v¬
 = 4; 

615 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_1
, 4, 0, 0);

616 ià(!(
amÚg_v¬
)è
Ïb0
;

617 
k‘
 = 
c
;

618 
amÚg_v¬
) {

619 0: 
Ïb0
;

621 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_5
);

622 ià(
»t
 < 0) „et;

626 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_6
);

627 ià(
»t
 < 0) „et;

631 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_7
);

632 ià(
»t
 < 0) „et;

636 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

637 ià(
»t
 < 0è
Ïb0
;

638 
c
 = 
»t
;

643 
Ïb0
:

644 
c
 = 
c1
;

648 
	}
}

650 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_RV
() {

651 ià(!(
I_pV
 <ğ
c
))  0;

653 
	}
}

655 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_R1
() {

656 ià(!(
I_p1
 <ğ
c
))  0;

658 
	}
}

660 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_R2
() {

661 ià(!(
I_p2
 <ğ
c
))  0;

663 
	}
}

665 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_¡ªd¬d_suffix
() {

666 
amÚg_v¬
;

667 
k‘
 = 
c
;

668 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 43, 0, 0);

669 ià(!(
amÚg_v¬
))  0;

670 
b¿
 = 
c
;

671 
amÚg_v¬
) {

674 { 
»t
 = 
	`r_R2
();

675 ià(
»t
 <= 0) „et;

677 ià(
	`¦iû_d–
() == -1)  -1;

680 { 
»t
 = 
	`r_R2
();

681 ià(
»t
 <= 0) „et;

683 ià(
	`¦iû_d–
() == -1)  -1;

684 { 
m1
 = 
l
 - 
c
; ()m1;

685 
k‘
 = 
c
;

686 ià(!(
	`eq_s_b
(2, 
s_8
))è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

687 
b¿
 = 
c
;

688 { 
m2
 = 
l
 - 
c
; ()m2;

689 { 
»t
 = 
	`r_R2
();

690 ià(
»t
 =ğ0è
Ïb2
;

691 ià(
»t
 < 0) „et;

693 ià(
	`¦iû_d–
() == -1)  -1;

694 
Ïb1
;

695 
Ïb2
:

696 
c
 = 
l
 - 
m2
;

697 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_9
);

698 ià(
»t
 < 0) „et;

701 
Ïb1
:

702 
Ïb0
:

707 { 
»t
 = 
	`r_R2
();

708 ià(
»t
 <= 0) „et;

710 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_10
);

711 ià(
»t
 < 0) „et;

715 { 
»t
 = 
	`r_R2
();

716 ià(
»t
 <= 0) „et;

718 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_11
);

719 ià(
»t
 < 0) „et;

723 { 
»t
 = 
	`r_R2
();

724 ià(
»t
 <= 0) „et;

726 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_12
);

727 ià(
»t
 < 0) „et;

731 { 
»t
 = 
	`r_RV
();

732 ià(
»t
 <= 0) „et;

734 ià(
	`¦iû_d–
() == -1)  -1;

735 { 
m3
 = 
l
 - 
c
; ()m3;

736 
k‘
 = 
c
;

737 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 6, 0, 0);

738 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m3
; 
Ïb3
; }

739 
b¿
 = 
c
;

740 
amÚg_v¬
) {

741 0: { 
c
 = 
l
 - 
m3
; 
Ïb3
; }

743 { 
»t
 = 
	`r_R2
();

744 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb3
; }

745 ià(
»t
 < 0) „et;

747 ià(
	`¦iû_d–
() == -1)  -1;

748 
k‘
 = 
c
;

749 ià(!(
	`eq_s_b
(2, 
s_13
))è{ 
c
 = 
l
 - 
m3
; 
Ïb3
; }

750 
b¿
 = 
c
;

751 { 
»t
 = 
	`r_R2
();

752 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb3
; }

753 ià(
»t
 < 0) „et;

755 ià(
	`¦iû_d–
() == -1)  -1;

758 { 
m4
 = 
l
 - 
c
; ()m4;

759 { 
»t
 = 
	`r_R2
();

760 ià(
»t
 =ğ0è
Ïb5
;

761 ià(
»t
 < 0) „et;

763 ià(
	`¦iû_d–
() == -1)  -1;

764 
Ïb4
;

765 
Ïb5
:

766 
c
 = 
l
 - 
m4
;

767 { 
»t
 = 
	`r_R1
();

768 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb3
; }

769 ià(
»t
 < 0) „et;

771 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_14
);

772 ià(
»t
 < 0) „et;

775 
Ïb4
:

778 { 
»t
 = 
	`r_R2
();

779 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb3
; }

780 ià(
»t
 < 0) „et;

782 ià(
	`¦iû_d–
() == -1)  -1;

785 { 
»t
 = 
	`r_RV
();

786 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb3
; }

787 ià(
»t
 < 0) „et;

789 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_15
);

790 ià(
»t
 < 0) „et;

794 
Ïb3
:

799 { 
»t
 = 
	`r_R2
();

800 ià(
»t
 <= 0) „et;

802 ià(
	`¦iû_d–
() == -1)  -1;

803 { 
m5
 = 
l
 - 
c
; ()m5;

804 
k‘
 = 
c
;

805 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((4198408 >> (p[ø- 1] & 0x1f)è& 1)è{ c = 
l
 - 
m5
; 
Ïb6
; }

806 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 3, 0, 0);

807 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m5
; 
Ïb6
; }

808 
b¿
 = 
c
;

809 
amÚg_v¬
) {

810 0: { 
c
 = 
l
 - 
m5
; 
Ïb6
; }

812 { 
m6
 = 
l
 - 
c
; ()m6;

813 { 
»t
 = 
	`r_R2
();

814 ià(
»t
 =ğ0è
Ïb8
;

815 ià(
»t
 < 0) „et;

817 ià(
	`¦iû_d–
() == -1)  -1;

818 
Ïb7
;

819 
Ïb8
:

820 
c
 = 
l
 - 
m6
;

821 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_16
);

822 ià(
»t
 < 0) „et;

825 
Ïb7
:

828 { 
m7
 = 
l
 - 
c
; ()m7;

829 { 
»t
 = 
	`r_R2
();

830 ià(
»t
 =ğ0è
Ïb10
;

831 ià(
»t
 < 0) „et;

833 ià(
	`¦iû_d–
() == -1)  -1;

834 
Ïb9
;

835 
Ïb10
:

836 
c
 = 
l
 - 
m7
;

837 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_17
);

838 ià(
»t
 < 0) „et;

841 
Ïb9
:

844 { 
»t
 = 
	`r_R2
();

845 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m5
; 
Ïb6
; }

846 ià(
»t
 < 0) „et;

848 ià(
	`¦iû_d–
() == -1)  -1;

851 
Ïb6
:

856 { 
»t
 = 
	`r_R2
();

857 ià(
»t
 <= 0) „et;

859 ià(
	`¦iû_d–
() == -1)  -1;

860 { 
m8
 = 
l
 - 
c
; ()m8;

861 
k‘
 = 
c
;

862 ià(!(
	`eq_s_b
(2, 
s_18
))è{ 
c
 = 
l
 - 
m8
; 
Ïb11
; }

863 
b¿
 = 
c
;

864 { 
»t
 = 
	`r_R2
();

865 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m8
; 
Ïb11
; }

866 ià(
»t
 < 0) „et;

868 ià(
	`¦iû_d–
() == -1)  -1;

869 
k‘
 = 
c
;

870 ià(!(
	`eq_s_b
(2, 
s_19
))è{ 
c
 = 
l
 - 
m8
; 
Ïb11
; }

871 
b¿
 = 
c
;

872 { 
m9
 = 
l
 - 
c
; ()m9;

873 { 
»t
 = 
	`r_R2
();

874 ià(
»t
 =ğ0è
Ïb13
;

875 ià(
»t
 < 0) „et;

877 ià(
	`¦iû_d–
() == -1)  -1;

878 
Ïb12
;

879 
Ïb13
:

880 
c
 = 
l
 - 
m9
;

881 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_20
);

882 ià(
»t
 < 0) „et;

885 
Ïb12
:

886 
Ïb11
:

891 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_21
);

892 ià(
»t
 < 0) „et;

896 { 
»t
 = 
	`r_R1
();

897 ià(
»t
 <= 0) „et;

899 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_22
);

900 ià(
»t
 < 0) „et;

904 { 
m10
 = 
l
 - 
c
; ()m10;

905 { 
»t
 = 
	`r_R2
();

906 ià(
»t
 =ğ0è
Ïb15
;

907 ià(
»t
 < 0) „et;

909 ià(
	`¦iû_d–
() == -1)  -1;

910 
Ïb14
;

911 
Ïb15
:

912 
c
 = 
l
 - 
m10
;

913 { 
»t
 = 
	`r_R1
();

914 ià(
»t
 <= 0) „et;

916 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_23
);

917 ià(
»t
 < 0) „et;

920 
Ïb14
:

923 { 
»t
 = 
	`r_R1
();

924 ià(
»t
 <= 0) „et;

926 ià(
	`out_groupšg_b_U
(
g_v
, 97, 251, 0))  0;

927 ià(
	`¦iû_d–
() == -1)  -1;

930 { 
»t
 = 
	`r_RV
();

931 ià(
»t
 <= 0) „et;

933 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_24
);

934 ià(
»t
 < 0) „et;

939 { 
»t
 = 
	`r_RV
();

940 ià(
»t
 <= 0) „et;

942 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_25
);

943 ià(
»t
 < 0) „et;

948 { 
m_‹¡11
 = 
l
 - 
c
;

949 ià(
	`š_groupšg_b_U
(
g_v
, 97, 251, 0))  0;

950 { 
»t
 = 
	`r_RV
();

951 ià(
»t
 <= 0) „et;

953 
c
 = 
l
 - 
m_‹¡11
;

955 ià(
	`¦iû_d–
() == -1)  -1;

960 
	}
}

962 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_i_v”b_suffix
() {

963 
amÚg_v¬
;

964 { 
m1
 = 
l
 - 
c
; ()m1;

965 
mlim™1
;

966 ià(
c
 < 
I_pV
)  0;

967 
c
 = 
I_pV
;

968 
mlim™1
 = 
lb
;†b = 
c
;

969 
c
 = 
l
 - 
m1
;

970 
k‘
 = 
c
;

971 ià(
c
 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((68944418 >> (p[ø- 1] & 0x1f)è& 1)è{†b = 
mlim™1
;  0; }

972 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 35, 0, 0);

973 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

974 
b¿
 = 
c
;

975 
amÚg_v¬
) {

976 0: { 
lb
 = 
mlim™1
;  0; }

978 ià(
	`out_groupšg_b_U
(
g_v
, 97, 251, 0)è{ 
lb
 = 
mlim™1
;  0; }

979 ià(
	`¦iû_d–
() == -1)  -1;

982 
lb
 = 
mlim™1
;

985 
	}
}

987 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_v”b_suffix
() {

988 
amÚg_v¬
;

989 { 
m1
 = 
l
 - 
c
; ()m1;

990 
mlim™1
;

991 ià(
c
 < 
I_pV
)  0;

992 
c
 = 
I_pV
;

993 
mlim™1
 = 
lb
;†b = 
c
;

994 
c
 = 
l
 - 
m1
;

995 
k‘
 = 
c
;

996 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 38, 0, 0);

997 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

998 
b¿
 = 
c
;

999 
amÚg_v¬
) {

1000 0: { 
lb
 = 
mlim™1
;  0; }

1002 { 
»t
 = 
	`r_R2
();

1003 ià(
»t
 =ğ0è{ 
lb
 = 
mlim™1
;  0; }

1004 ià(
»t
 < 0) „et;

1006 ià(
	`¦iû_d–
() == -1)  -1;

1009 ià(
	`¦iû_d–
() == -1)  -1;

1012 ià(
	`¦iû_d–
() == -1)  -1;

1013 { 
m2
 = 
l
 - 
c
; ()m2;

1014 
k‘
 = 
c
;

1015 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è{ c = 
l
 - 
m2
; 
Ïb0
; }

1016 
c
--;

1017 
b¿
 = 
c
;

1018 ià(
	`¦iû_d–
() == -1)  -1;

1019 
Ïb0
:

1024 
lb
 = 
mlim™1
;

1027 
	}
}

1029 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_»sidu®_suffix
() {

1030 
amÚg_v¬
;

1031 { 
m1
 = 
l
 - 
c
; ()m1;

1032 
k‘
 = 
c
;

1033 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è{ c = 
l
 - 
m1
; 
Ïb0
; }

1034 
c
--;

1035 
b¿
 = 
c
;

1036 { 
m_‹¡2
 = 
l
 - 
c
;

1037 ià(
	`out_groupšg_b_U
(
g_k“p_w™h_s
, 97, 232, 0)è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

1038 
c
 = 
l
 - 
m_‹¡2
;

1040 ià(
	`¦iû_d–
() == -1)  -1;

1041 
Ïb0
:

1044 { 
m3
 = 
l
 - 
c
; ()m3;

1045 
mlim™3
;

1046 ià(
c
 < 
I_pV
)  0;

1047 
c
 = 
I_pV
;

1048 
mlim™3
 = 
lb
;†b = 
c
;

1049 
c
 = 
l
 - 
m3
;

1050 
k‘
 = 
c
;

1051 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 7, 0, 0);

1052 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™3
;  0; }

1053 
b¿
 = 
c
;

1054 
amÚg_v¬
) {

1055 0: { 
lb
 = 
mlim™3
;  0; }

1057 { 
»t
 = 
	`r_R2
();

1058 ià(
»t
 =ğ0è{ 
lb
 = 
mlim™3
;  0; }

1059 ià(
»t
 < 0) „et;

1061 { 
m4
 = 
l
 - 
c
; ()m4;

1062 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb2
;

1063 
c
--;

1064 
Ïb1
;

1065 
Ïb2
:

1066 
c
 = 
l
 - 
m4
;

1067 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ't'è{†b = 
mlim™3
;  0; }

1068 
c
--;

1070 
Ïb1
:

1071 ià(
	`¦iû_d–
() == -1)  -1;

1074 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_26
);

1075 ià(
»t
 < 0) „et;

1079 ià(
	`¦iû_d–
() == -1)  -1;

1082 ià(!(
	`eq_s_b
(2, 
s_27
))è{ 
lb
 = 
mlim™3
;  0; }

1083 ià(
	`¦iû_d–
() == -1)  -1;

1086 
lb
 = 
mlim™3
;

1089 
	}
}

1091 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_un_doubË
() {

1092 { 
m_‹¡1
 = 
l
 - 
c
;

1093 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((1069056 >> (p[c - 1] & 0x1f)) & 1))  0;

1094 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_8
, 5, 0, 0)))  0;

1095 
c
 = 
l
 - 
m_‹¡1
;

1097 
k‘
 = 
c
;

1098 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

1099 ià(
»t
 < 0)  0;

1100 
c
 = 
»t
;

1102 
b¿
 = 
c
;

1103 ià(
	`¦iû_d–
() == -1)  -1;

1105 
	}
}

1107 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$r_un_acûÁ
() {

1108 { 
i
 = 1;

1110 ià(
	`out_groupšg_b_U
(
g_v
, 97, 251, 0)è
Ïb0
;

1111 
i
--;

1113 
Ïb0
:

1116 ià(
i
 > 0)  0;

1118 
k‘
 = 
c
;

1119 { 
m1
 = 
l
 - 
c
; ()m1;

1120 ià(!(
	`eq_s_b
(2, 
s_28
))è
Ïb2
;

1121 
Ïb1
;

1122 
Ïb2
:

1123 
c
 = 
l
 - 
m1
;

1124 ià(!(
	`eq_s_b
(2, 
s_29
)))  0;

1126 
Ïb1
:

1127 
b¿
 = 
c
;

1128 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_30
);

1129 ià(
»t
 < 0) „et;

1132 
	}
}

1134 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$¡em
() {

1135 { 
c1
 = 
c
;

1136 { 
»t
 = 
	`r_´–ude
();

1137 ià(
»t
 =ğ0è
Ïb0
;

1138 ià(
»t
 < 0) „et;

1140 
Ïb0
:

1141 
c
 = 
c1
;

1143 { 
c2
 = 
c
;

1144 { 
»t
 = 
	`r_m¬k_»giÚs
();

1145 ià(
»t
 =ğ0è
Ïb1
;

1146 ià(
»t
 < 0) „et;

1148 
Ïb1
:

1149 
c
 = 
c2
;

1151 
lb
 = 
c
; c = 
l
;

1153 { 
m3
 = 
l
 - 
c
; ()m3;

1154 { 
m4
 = 
l
 - 
c
; ()m4;

1155 { 
m5
 = 
l
 - 
c
; ()m5;

1156 { 
m6
 = 
l
 - 
c
; ()m6;

1157 { 
»t
 = 
	`r_¡ªd¬d_suffix
();

1158 ià(
»t
 =ğ0è
Ïb6
;

1159 ià(
»t
 < 0) „et;

1161 
Ïb5
;

1162 
Ïb6
:

1163 
c
 = 
l
 - 
m6
;

1164 { 
»t
 = 
	`r_i_v”b_suffix
();

1165 ià(
»t
 =ğ0è
Ïb7
;

1166 ià(
»t
 < 0) „et;

1168 
Ïb5
;

1169 
Ïb7
:

1170 
c
 = 
l
 - 
m6
;

1171 { 
»t
 = 
	`r_v”b_suffix
();

1172 ià(
»t
 =ğ0è
Ïb4
;

1173 ià(
»t
 < 0) „et;

1176 
Ïb5
:

1177 
c
 = 
l
 - 
m5
;

1178 { 
m7
 = 
l
 - 
c
; ()m7;

1179 
k‘
 = 
c
;

1180 { 
m8
 = 
l
 - 
c
; ()m8;

1181 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'Y'è
Ïb10
;

1182 
c
--;

1183 
b¿
 = 
c
;

1184 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_31
);

1185 ià(
»t
 < 0) „et;

1187 
Ïb9
;

1188 
Ïb10
:

1189 
c
 = 
l
 - 
m8
;

1190 ià(!(
	`eq_s_b
(2, 
s_32
))è{ 
c
 = 
l
 - 
m7
; 
Ïb8
; }

1191 
b¿
 = 
c
;

1192 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_33
);

1193 ià(
»t
 < 0) „et;

1196 
Ïb9
:

1197 
Ïb8
:

1201 
Ïb3
;

1202 
Ïb4
:

1203 
c
 = 
l
 - 
m4
;

1204 { 
»t
 = 
	`r_»sidu®_suffix
();

1205 ià(
»t
 =ğ0è
Ïb2
;

1206 ià(
»t
 < 0) „et;

1209 
Ïb3
:

1210 
Ïb2
:

1211 
c
 = 
l
 - 
m3
;

1213 { 
m9
 = 
l
 - 
c
; ()m9;

1214 { 
»t
 = 
	`r_un_doubË
();

1215 ià(
»t
 =ğ0è
Ïb11
;

1216 ià(
»t
 < 0) „et;

1218 
Ïb11
:

1219 
c
 = 
l
 - 
m9
;

1221 { 
m10
 = 
l
 - 
c
; ()m10;

1222 { 
»t
 = 
	`r_un_acûÁ
();

1223 ià(
»t
 =ğ0è
Ïb12
;

1224 ià(
»t
 < 0) „et;

1226 
Ïb12
:

1227 
c
 = 
l
 - 
m10
;

1229 
c
 = 
lb
;

1230 { 
c11
 = 
c
;

1231 { 
»t
 = 
	`r_po¡lude
();

1232 ià(
»t
 =ğ0è
Ïb13
;

1233 ià(
»t
 < 0) „et;

1235 
Ïb13
:

1236 
c
 = 
c11
;

1239 
	}
}

1241 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$IÁ”ÇlS‹mF»nch
()

1242 : 
	`I_p2
(0), 
	`I_p1
(0), 
	$I_pV
(0)

1244 
	}
}

1246 
	gX­Ÿn
::
IÁ”ÇlS‹mF»nch
::~
	$IÁ”ÇlS‹mF»nch
()

1248 
	}
}

1251 
X­Ÿn
::
IÁ”ÇlS‹mF»nch
::
	$g‘_desütiÚ
() const

1254 
	}
}

	@languages/french.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mF»nch
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_p2
;

9 
	gI_p1
;

10 
	gI_pV
;

11 
	gpublic
:

12 
r_un_acûÁ
();

13 
r_un_doubË
();

14 
r_»sidu®_suffix
();

15 
r_v”b_suffix
();

16 
r_i_v”b_suffix
();

17 
r_¡ªd¬d_suffix
();

18 
r_R2
();

19 
r_R1
();

20 
r_RV
();

21 
r_m¬k_»giÚs
();

22 
r_po¡lude
();

23 
r_´–ude
();

25 
IÁ”ÇlS‹mF»nch
();

26 ~
IÁ”ÇlS‹mF»nch
();

27 
¡em
();

28 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/german.cc

3 
	~<lim™s.h
>

4 
	~"g”mª.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_1
 0

	)

9 
	#s_0_2
 1

	)

11 
	#s_0_3
 2

	)

13 
	#s_0_4
 4

	)

15 
	#s_0_5
 6

	)

17 
	#s_1_0
 
s_1_1


	)

18 
	#s_1_1
 8

	)

20 
	#s_1_2
 10

	)

22 
	#s_1_3
 12

	)

24 
	#s_1_4
 
s_1_3


	)

25 
	#s_1_5
 (
s_1_6
 + 1)

	)

26 
	#s_1_6
 15

	)

28 
	#s_2_0
 17

	)

30 
	#s_2_1
 19

	)

32 
	#s_2_2
 (
s_2_3
 + 1)

	)

33 
	#s_2_3
 21

	)

35 
	#s_3_0
 24

	)

37 
	#s_3_1
 26

	)

39 
	#s_4_0
 30

	)

41 
	#s_4_1
 33

	)

43 
	#s_4_2
 35

	)

45 
	#s_4_3
 38

	)

47 
	#s_4_4
 42

	)

49 
	#s_4_5
 46

	)

51 
	#s_4_6
 48

	)

53 
	#s_4_7
 52

	)

58 cÚ¡ 
amÚg
 
	ga_0
[6] =

61  { 1, 
s_0_1
, 0, 2},

62  { 1, 
s_0_2
, 0, 1},

63  { 2, 
s_0_3
, 0, 3},

64  { 2, 
s_0_4
, 0, 4},

65  { 2, 
s_0_5
, 0, 5}

69 cÚ¡ 
amÚg
 
	ga_1
[7] =

71  { 1, 
s_1_0
, -1, 2},

72  { 2, 
s_1_1
, -1, 1},

73  { 2, 
s_1_2
, -1, 2},

74  { 3, 
s_1_3
, -1, 1},

75  { 2, 
s_1_4
, -1, 1},

76  { 1, 
s_1_5
, -1, 3},

77  { 2, 
s_1_6
, 5, 2}

81 cÚ¡ 
amÚg
 
	ga_2
[4] =

83  { 2, 
s_2_0
, -1, 1},

84  { 2, 
s_2_1
, -1, 1},

85  { 2, 
s_2_2
, -1, 2},

86  { 3, 
s_2_3
, 2, 1}

90 cÚ¡ 
amÚg
 
	ga_3
[2] =

92  { 2, 
s_3_0
, -1, 1},

93  { 4, 
s_3_1
, -1, 1}

97 cÚ¡ 
amÚg
 
	ga_4
[8] =

99  { 3, 
s_4_0
, -1, 1},

100  { 2, 
s_4_1
, -1, 2},

101  { 3, 
s_4_2
, -1, 1},

102  { 4, 
s_4_3
, -1, 3},

103  { 4, 
s_4_4
, -1, 2},

104  { 2, 
s_4_5
, -1, 2},

105  { 4, 
s_4_6
, -1, 3},

106  { 4, 
s_4_7
, -1, 4}

109 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 32, 8 };

111 cÚ¡ 
	gg_s_’dšg
[] = { 117, 30, 5 };

113 cÚ¡ 
	gg_¡_’dšg
[] = { 117, 30, 4 };

115 cÚ¡ 
symbŞ
 
	gs_0
[] = { 0xC3, 0x9F };

116 cÚ¡ 
symbŞ
 
	gs_1
[] = { 's', 's' };

117 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'U' };

118 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'Y' };

119 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'y' };

120 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'u' };

121 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'a' };

122 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'o' };

123 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'u' };

124 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'n', 'i', 's' };

125 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'i', 'g' };

126 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'e', 'r' };

127 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'e', 'n' };

129 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$r_´–ude
() {

130 { 
c_‹¡1
 = 
c
;

132 
c2
 = 
c
;

133 { 
c3
 = 
c
;

134 
b¿
 = 
c
;

135 ià(!(
	`eq_s
(2, 
s_0
))è
Ïb2
;

136 
k‘
 = 
c
;

137 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_1
);

138 ià(
»t
 < 0) „et;

140 
Ïb1
;

141 
Ïb2
:

142 
c
 = 
c3
;

143 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

144 ià(
»t
 < 0è
Ïb0
;

145 
c
 = 
»t
;

148 
Ïb1
:

150 
Ïb0
:

151 
c
 = 
c2
;

154 
c
 = 
c_‹¡1
;

157 
c4
 = 
c
;

159 
c5
 = 
c
;

160 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb4
;

161 
b¿
 = 
c
;

162 { 
c6
 = 
c
;

163 ià(
c
 =ğ
l
 || 
p
[c] !ğ'u'è
Ïb6
;

164 
c
++;

165 
k‘
 = 
c
;

166 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb6
;

167 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_2
);

168 ià(
»t
 < 0) „et;

170 
Ïb5
;

171 
Ïb6
:

172 
c
 = 
c6
;

173 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb4
;

174 
c
++;

175 
k‘
 = 
c
;

176 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb4
;

177 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_3
);

178 ià(
»t
 < 0) „et;

181 
Ïb5
:

182 
c
 = 
c5
;

184 
Ïb4
:

185 
c
 = 
c5
;

186 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

187 ià(
»t
 < 0è
Ïb3
;

188 
c
 = 
»t
;

192 
Ïb3
:

193 
c
 = 
c4
;

197 
	}
}

199 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$r_m¬k_»giÚs
() {

200 
I_p1
 = 
l
;

201 
I_p2
 = 
l
;

202 { 
c_‹¡1
 = 
c
;

203 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 3);

204 ià(
»t
 < 0)  0;

205 
c
 = 
»t
;

207 
I_x
 = 
c
;

208 
c
 = 
c_‹¡1
;

210 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

211 ià(
»t
 < 0)  0;

212 
c
 +ğ
»t
;

214 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 252, 1);

215 ià(
»t
 < 0)  0;

216 
c
 +ğ
»t
;

218 
I_p1
 = 
c
;

220 ià(!(
I_p1
 < 
I_x
)è
Ïb0
;

221 
I_p1
 = 
I_x
;

222 
Ïb0
:

223 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

224 ià(
»t
 < 0)  0;

225 
c
 +ğ
»t
;

227 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 252, 1);

228 ià(
»t
 < 0)  0;

229 
c
 +ğ
»t
;

231 
I_p2
 = 
c
;

233 
	}
}

235 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$r_po¡lude
() {

236 
amÚg_v¬
;

238 
c1
 = 
c
;

239 
b¿
 = 
c
;

240 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 6, 0, 0);

241 ià(!(
amÚg_v¬
)è
Ïb0
;

242 
k‘
 = 
c
;

243 
amÚg_v¬
) {

244 0: 
Ïb0
;

246 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_4
);

247 ià(
»t
 < 0) „et;

251 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_5
);

252 ià(
»t
 < 0) „et;

256 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_6
);

257 ià(
»t
 < 0) „et;

261 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_7
);

262 ià(
»t
 < 0) „et;

266 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_8
);

267 ià(
»t
 < 0) „et;

271 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

272 ià(
»t
 < 0è
Ïb0
;

273 
c
 = 
»t
;

278 
Ïb0
:

279 
c
 = 
c1
;

283 
	}
}

285 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$r_R1
() {

286 ià(!(
I_p1
 <ğ
c
))  0;

288 
	}
}

290 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$r_R2
() {

291 ià(!(
I_p2
 <ğ
c
))  0;

293 
	}
}

295 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$r_¡ªd¬d_suffix
() {

296 
amÚg_v¬
;

297 { 
m1
 = 
l
 - 
c
; ()m1;

298 
k‘
 = 
c
;

299 ià(
c
 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((811040 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb0
;

300 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 7, 0, 0);

301 ià(!(
amÚg_v¬
)è
Ïb0
;

302 
b¿
 = 
c
;

303 { 
»t
 = 
	`r_R1
();

304 ià(
»t
 =ğ0è
Ïb0
;

305 ià(
»t
 < 0) „et;

307 
amÚg_v¬
) {

308 0: 
Ïb0
;

310 ià(
	`¦iû_d–
() == -1)  -1;

313 ià(
	`¦iû_d–
() == -1)  -1;

314 { 
m2
 = 
l
 - 
c
; ()m2;

315 
k‘
 = 
c
;

316 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è{ c = 
l
 - 
m2
; 
Ïb1
; }

317 
c
--;

318 
b¿
 = 
c
;

319 ià(!(
	`eq_s_b
(3, 
s_9
))è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

320 ià(
	`¦iû_d–
() == -1)  -1;

321 
Ïb1
:

326 ià(
	`š_groupšg_b_U
(
g_s_’dšg
, 98, 116, 0)è
Ïb0
;

327 ià(
	`¦iû_d–
() == -1)  -1;

330 
Ïb0
:

331 
c
 = 
l
 - 
m1
;

333 { 
m3
 = 
l
 - 
c
; ()m3;

334 
k‘
 = 
c
;

335 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1327104 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb2
;

336 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 4, 0, 0);

337 ià(!(
amÚg_v¬
)è
Ïb2
;

338 
b¿
 = 
c
;

339 { 
»t
 = 
	`r_R1
();

340 ià(
»t
 =ğ0è
Ïb2
;

341 ià(
»t
 < 0) „et;

343 
amÚg_v¬
) {

344 0: 
Ïb2
;

346 ià(
	`¦iû_d–
() == -1)  -1;

349 ià(
	`š_groupšg_b_U
(
g_¡_’dšg
, 98, 116, 0)è
Ïb2
;

350 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

351 ià(
»t
 < 0è
Ïb2
;

352 
c
 = 
»t
;

354 ià(
	`¦iû_d–
() == -1)  -1;

357 
Ïb2
:

358 
c
 = 
l
 - 
m3
;

360 { 
m4
 = 
l
 - 
c
; ()m4;

361 
k‘
 = 
c
;

362 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1051024 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb3
;

363 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 8, 0, 0);

364 ià(!(
amÚg_v¬
)è
Ïb3
;

365 
b¿
 = 
c
;

366 { 
»t
 = 
	`r_R2
();

367 ià(
»t
 =ğ0è
Ïb3
;

368 ià(
»t
 < 0) „et;

370 
amÚg_v¬
) {

371 0: 
Ïb3
;

373 ià(
	`¦iû_d–
() == -1)  -1;

374 { 
m5
 = 
l
 - 
c
; ()m5;

375 
k‘
 = 
c
;

376 ià(!(
	`eq_s_b
(2, 
s_10
))è{ 
c
 = 
l
 - 
m5
; 
Ïb4
; }

377 
b¿
 = 
c
;

378 { 
m6
 = 
l
 - 
c
; ()m6;

379 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb5
;

380 
c
--;

381 { 
c
 = 
l
 - 
m5
; 
Ïb4
; }

382 
Ïb5
:

383 
c
 = 
l
 - 
m6
;

385 { 
»t
 = 
	`r_R2
();

386 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m5
; 
Ïb4
; }

387 ià(
»t
 < 0) „et;

389 ià(
	`¦iû_d–
() == -1)  -1;

390 
Ïb4
:

395 { 
m7
 = 
l
 - 
c
; ()m7;

396 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb6
;

397 
c
--;

398 
Ïb3
;

399 
Ïb6
:

400 
c
 = 
l
 - 
m7
;

402 ià(
	`¦iû_d–
() == -1)  -1;

405 ià(
	`¦iû_d–
() == -1)  -1;

406 { 
m8
 = 
l
 - 
c
; ()m8;

407 
k‘
 = 
c
;

408 { 
m9
 = 
l
 - 
c
; ()m9;

409 ià(!(
	`eq_s_b
(2, 
s_11
))è
Ïb9
;

410 
Ïb8
;

411 
Ïb9
:

412 
c
 = 
l
 - 
m9
;

413 ià(!(
	`eq_s_b
(2, 
s_12
))è{ 
c
 = 
l
 - 
m8
; 
Ïb7
; }

415 
Ïb8
:

416 
b¿
 = 
c
;

417 { 
»t
 = 
	`r_R1
();

418 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m8
; 
Ïb7
; }

419 ià(
»t
 < 0) „et;

421 ià(
	`¦iû_d–
() == -1)  -1;

422 
Ïb7
:

427 ià(
	`¦iû_d–
() == -1)  -1;

428 { 
m10
 = 
l
 - 
c
; ()m10;

429 
k‘
 = 
c
;

430 ià(
c
 - 1 <ğ
lb
 || (
p
[ø- 1] !ğ103 &&…[ø- 1] !ğ104)è{ c = 
l
 - 
m10
; 
Ïb10
; }

431 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 2, 0, 0);

432 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m10
; 
Ïb10
; }

433 
b¿
 = 
c
;

434 { 
»t
 = 
	`r_R2
();

435 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m10
; 
Ïb10
; }

436 ià(
»t
 < 0) „et;

438 
amÚg_v¬
) {

439 0: { 
c
 = 
l
 - 
m10
; 
Ïb10
; }

441 ià(
	`¦iû_d–
() == -1)  -1;

444 
Ïb10
:

449 
Ïb3
:

450 
c
 = 
l
 - 
m4
;

453 
	}
}

455 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$¡em
() {

456 { 
c1
 = 
c
;

457 { 
»t
 = 
	`r_´–ude
();

458 ià(
»t
 =ğ0è
Ïb0
;

459 ià(
»t
 < 0) „et;

461 
Ïb0
:

462 
c
 = 
c1
;

464 { 
c2
 = 
c
;

465 { 
»t
 = 
	`r_m¬k_»giÚs
();

466 ià(
»t
 =ğ0è
Ïb1
;

467 ià(
»t
 < 0) „et;

469 
Ïb1
:

470 
c
 = 
c2
;

472 
lb
 = 
c
; c = 
l
;

474 { 
m3
 = 
l
 - 
c
; ()m3;

475 { 
»t
 = 
	`r_¡ªd¬d_suffix
();

476 ià(
»t
 =ğ0è
Ïb2
;

477 ià(
»t
 < 0) „et;

479 
Ïb2
:

480 
c
 = 
l
 - 
m3
;

482 
c
 = 
lb
;

483 { 
c4
 = 
c
;

484 { 
»t
 = 
	`r_po¡lude
();

485 ià(
»t
 =ğ0è
Ïb3
;

486 ià(
»t
 < 0) „et;

488 
Ïb3
:

489 
c
 = 
c4
;

492 
	}
}

494 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$IÁ”ÇlS‹mG”mª
()

495 : 
	`I_x
(0), 
	`I_p2
(0), 
	$I_p1
(0)

497 
	}
}

499 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª
::~
	$IÁ”ÇlS‹mG”mª
()

501 
	}
}

504 
X­Ÿn
::
IÁ”ÇlS‹mG”mª
::
	$g‘_desütiÚ
() const

507 
	}
}

	@languages/german.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mG”mª
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_x
;

9 
	gI_p2
;

10 
	gI_p1
;

11 
	gpublic
:

12 
r_¡ªd¬d_suffix
();

13 
r_R2
();

14 
r_R1
();

15 
r_m¬k_»giÚs
();

16 
r_po¡lude
();

17 
r_´–ude
();

19 
IÁ”ÇlS‹mG”mª
();

20 ~
IÁ”ÇlS‹mG”mª
();

21 
¡em
();

22 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/german2.cc

3 
	~<lim™s.h
>

4 
	~"g”mª2.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_1
 0

	)

9 
	#s_0_2
 2

	)

11 
	#s_0_3
 4

	)

13 
	#s_0_4
 6

	)

15 
	#s_0_5
 8

	)

17 
	#s_1_1
 10

	)

19 
	#s_1_2
 11

	)

21 
	#s_1_3
 12

	)

23 
	#s_1_4
 14

	)

25 
	#s_1_5
 16

	)

27 
	#s_2_0
 
s_2_1


	)

28 
	#s_2_1
 18

	)

30 
	#s_2_2
 20

	)

32 
	#s_2_3
 22

	)

34 
	#s_2_4
 
s_2_3


	)

35 
	#s_2_5
 (
s_2_6
 + 1)

	)

36 
	#s_2_6
 25

	)

38 
	#s_3_0
 27

	)

40 
	#s_3_1
 29

	)

42 
	#s_3_2
 (
s_3_3
 + 1)

	)

43 
	#s_3_3
 31

	)

45 
	#s_4_0
 34

	)

47 
	#s_4_1
 36

	)

49 
	#s_5_0
 40

	)

51 
	#s_5_1
 43

	)

53 
	#s_5_2
 45

	)

55 
	#s_5_3
 48

	)

57 
	#s_5_4
 52

	)

59 
	#s_5_5
 56

	)

61 
	#s_5_6
 58

	)

63 
	#s_5_7
 62

	)

68 cÚ¡ 
amÚg
 
	ga_0
[6] =

71  { 2, 
s_0_1
, 0, 2},

72  { 2, 
s_0_2
, 0, 3},

73  { 2, 
s_0_3
, 0, 5},

74  { 2, 
s_0_4
, 0, 4},

75  { 2, 
s_0_5
, 0, 1}

79 cÚ¡ 
amÚg
 
	ga_1
[6] =

82  { 1, 
s_1_1
, 0, 2},

83  { 1, 
s_1_2
, 0, 1},

84  { 2, 
s_1_3
, 0, 3},

85  { 2, 
s_1_4
, 0, 4},

86  { 2, 
s_1_5
, 0, 5}

90 cÚ¡ 
amÚg
 
	ga_2
[7] =

92  { 1, 
s_2_0
, -1, 2},

93  { 2, 
s_2_1
, -1, 1},

94  { 2, 
s_2_2
, -1, 2},

95  { 3, 
s_2_3
, -1, 1},

96  { 2, 
s_2_4
, -1, 1},

97  { 1, 
s_2_5
, -1, 3},

98  { 2, 
s_2_6
, 5, 2}

102 cÚ¡ 
amÚg
 
	ga_3
[4] =

104  { 2, 
s_3_0
, -1, 1},

105  { 2, 
s_3_1
, -1, 1},

106  { 2, 
s_3_2
, -1, 2},

107  { 3, 
s_3_3
, 2, 1}

111 cÚ¡ 
amÚg
 
	ga_4
[2] =

113  { 2, 
s_4_0
, -1, 1},

114  { 4, 
s_4_1
, -1, 1}

118 cÚ¡ 
amÚg
 
	ga_5
[8] =

120  { 3, 
s_5_0
, -1, 1},

121  { 2, 
s_5_1
, -1, 2},

122  { 3, 
s_5_2
, -1, 1},

123  { 4, 
s_5_3
, -1, 3},

124  { 4, 
s_5_4
, -1, 2},

125  { 2, 
s_5_5
, -1, 2},

126  { 4, 
s_5_6
, -1, 3},

127  { 4, 
s_5_7
, -1, 4}

130 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 32, 8 };

132 cÚ¡ 
	gg_s_’dšg
[] = { 117, 30, 5 };

134 cÚ¡ 
	gg_¡_’dšg
[] = { 117, 30, 4 };

136 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'U' };

137 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'Y' };

138 cÚ¡ 
symbŞ
 
	gs_2
[] = { 's', 's' };

139 cÚ¡ 
symbŞ
 
	gs_3
[] = { 0xC3, 0xA4 };

140 cÚ¡ 
symbŞ
 
	gs_4
[] = { 0xC3, 0xB6 };

141 cÚ¡ 
symbŞ
 
	gs_5
[] = { 0xC3, 0xBC };

142 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'y' };

143 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'u' };

144 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'a' };

145 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'o' };

146 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'u' };

147 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'n', 'i', 's' };

148 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'i', 'g' };

149 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'e', 'r' };

150 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'e', 'n' };

152 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$r_´–ude
() {

153 
amÚg_v¬
;

154 { 
c_‹¡1
 = 
c
;

156 
c2
 = 
c
;

158 
c3
 = 
c
;

159 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb1
;

160 
b¿
 = 
c
;

161 { 
c4
 = 
c
;

162 ià(
c
 =ğ
l
 || 
p
[c] !ğ'u'è
Ïb3
;

163 
c
++;

164 
k‘
 = 
c
;

165 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb3
;

166 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_0
);

167 ià(
»t
 < 0) „et;

169 
Ïb2
;

170 
Ïb3
:

171 
c
 = 
c4
;

172 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb1
;

173 
c
++;

174 
k‘
 = 
c
;

175 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb1
;

176 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_1
);

177 ià(
»t
 < 0) „et;

180 
Ïb2
:

181 
c
 = 
c3
;

183 
Ïb1
:

184 
c
 = 
c3
;

185 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

186 ià(
»t
 < 0è
Ïb0
;

187 
c
 = 
»t
;

191 
Ïb0
:

192 
c
 = 
c2
;

195 
c
 = 
c_‹¡1
;

198 
c5
 = 
c
;

199 
b¿
 = 
c
;

200 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 6, 0, 0);

201 ià(!(
amÚg_v¬
)è
Ïb4
;

202 
k‘
 = 
c
;

203 
amÚg_v¬
) {

204 0: 
Ïb4
;

206 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_2
);

207 ià(
»t
 < 0) „et;

211 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_3
);

212 ià(
»t
 < 0) „et;

216 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_4
);

217 ià(
»t
 < 0) „et;

221 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_5
);

222 ià(
»t
 < 0) „et;

226 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 2);

227 ià(
»t
 < 0è
Ïb4
;

228 
c
 = 
»t
;

232 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

233 ià(
»t
 < 0è
Ïb4
;

234 
c
 = 
»t
;

239 
Ïb4
:

240 
c
 = 
c5
;

244 
	}
}

246 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$r_m¬k_»giÚs
() {

247 
I_p1
 = 
l
;

248 
I_p2
 = 
l
;

249 { 
c_‹¡1
 = 
c
;

250 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 3);

251 ià(
»t
 < 0)  0;

252 
c
 = 
»t
;

254 
I_x
 = 
c
;

255 
c
 = 
c_‹¡1
;

257 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

258 ià(
»t
 < 0)  0;

259 
c
 +ğ
»t
;

261 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 252, 1);

262 ià(
»t
 < 0)  0;

263 
c
 +ğ
»t
;

265 
I_p1
 = 
c
;

267 ià(!(
I_p1
 < 
I_x
)è
Ïb0
;

268 
I_p1
 = 
I_x
;

269 
Ïb0
:

270 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

271 ià(
»t
 < 0)  0;

272 
c
 +ğ
»t
;

274 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 252, 1);

275 ià(
»t
 < 0)  0;

276 
c
 +ğ
»t
;

278 
I_p2
 = 
c
;

280 
	}
}

282 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$r_po¡lude
() {

283 
amÚg_v¬
;

285 
c1
 = 
c
;

286 
b¿
 = 
c
;

287 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_1
, 6, 0, 0);

288 ià(!(
amÚg_v¬
)è
Ïb0
;

289 
k‘
 = 
c
;

290 
amÚg_v¬
) {

291 0: 
Ïb0
;

293 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_6
);

294 ià(
»t
 < 0) „et;

298 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_7
);

299 ià(
»t
 < 0) „et;

303 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_8
);

304 ià(
»t
 < 0) „et;

308 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_9
);

309 ià(
»t
 < 0) „et;

313 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_10
);

314 ià(
»t
 < 0) „et;

318 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

319 ià(
»t
 < 0è
Ïb0
;

320 
c
 = 
»t
;

325 
Ïb0
:

326 
c
 = 
c1
;

330 
	}
}

332 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$r_R1
() {

333 ià(!(
I_p1
 <ğ
c
))  0;

335 
	}
}

337 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$r_R2
() {

338 ià(!(
I_p2
 <ğ
c
))  0;

340 
	}
}

342 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$r_¡ªd¬d_suffix
() {

343 
amÚg_v¬
;

344 { 
m1
 = 
l
 - 
c
; ()m1;

345 
k‘
 = 
c
;

346 ià(
c
 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((811040 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb0
;

347 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 7, 0, 0);

348 ià(!(
amÚg_v¬
)è
Ïb0
;

349 
b¿
 = 
c
;

350 { 
»t
 = 
	`r_R1
();

351 ià(
»t
 =ğ0è
Ïb0
;

352 ià(
»t
 < 0) „et;

354 
amÚg_v¬
) {

355 0: 
Ïb0
;

357 ià(
	`¦iû_d–
() == -1)  -1;

360 ià(
	`¦iû_d–
() == -1)  -1;

361 { 
m2
 = 
l
 - 
c
; ()m2;

362 
k‘
 = 
c
;

363 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è{ c = 
l
 - 
m2
; 
Ïb1
; }

364 
c
--;

365 
b¿
 = 
c
;

366 ià(!(
	`eq_s_b
(3, 
s_11
))è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

367 ià(
	`¦iû_d–
() == -1)  -1;

368 
Ïb1
:

373 ià(
	`š_groupšg_b_U
(
g_s_’dšg
, 98, 116, 0)è
Ïb0
;

374 ià(
	`¦iû_d–
() == -1)  -1;

377 
Ïb0
:

378 
c
 = 
l
 - 
m1
;

380 { 
m3
 = 
l
 - 
c
; ()m3;

381 
k‘
 = 
c
;

382 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1327104 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb2
;

383 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 4, 0, 0);

384 ià(!(
amÚg_v¬
)è
Ïb2
;

385 
b¿
 = 
c
;

386 { 
»t
 = 
	`r_R1
();

387 ià(
»t
 =ğ0è
Ïb2
;

388 ià(
»t
 < 0) „et;

390 
amÚg_v¬
) {

391 0: 
Ïb2
;

393 ià(
	`¦iû_d–
() == -1)  -1;

396 ià(
	`š_groupšg_b_U
(
g_¡_’dšg
, 98, 116, 0)è
Ïb2
;

397 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

398 ià(
»t
 < 0è
Ïb2
;

399 
c
 = 
»t
;

401 ià(
	`¦iû_d–
() == -1)  -1;

404 
Ïb2
:

405 
c
 = 
l
 - 
m3
;

407 { 
m4
 = 
l
 - 
c
; ()m4;

408 
k‘
 = 
c
;

409 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1051024 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb3
;

410 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 8, 0, 0);

411 ià(!(
amÚg_v¬
)è
Ïb3
;

412 
b¿
 = 
c
;

413 { 
»t
 = 
	`r_R2
();

414 ià(
»t
 =ğ0è
Ïb3
;

415 ià(
»t
 < 0) „et;

417 
amÚg_v¬
) {

418 0: 
Ïb3
;

420 ià(
	`¦iû_d–
() == -1)  -1;

421 { 
m5
 = 
l
 - 
c
; ()m5;

422 
k‘
 = 
c
;

423 ià(!(
	`eq_s_b
(2, 
s_12
))è{ 
c
 = 
l
 - 
m5
; 
Ïb4
; }

424 
b¿
 = 
c
;

425 { 
m6
 = 
l
 - 
c
; ()m6;

426 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb5
;

427 
c
--;

428 { 
c
 = 
l
 - 
m5
; 
Ïb4
; }

429 
Ïb5
:

430 
c
 = 
l
 - 
m6
;

432 { 
»t
 = 
	`r_R2
();

433 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m5
; 
Ïb4
; }

434 ià(
»t
 < 0) „et;

436 ià(
	`¦iû_d–
() == -1)  -1;

437 
Ïb4
:

442 { 
m7
 = 
l
 - 
c
; ()m7;

443 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb6
;

444 
c
--;

445 
Ïb3
;

446 
Ïb6
:

447 
c
 = 
l
 - 
m7
;

449 ià(
	`¦iû_d–
() == -1)  -1;

452 ià(
	`¦iû_d–
() == -1)  -1;

453 { 
m8
 = 
l
 - 
c
; ()m8;

454 
k‘
 = 
c
;

455 { 
m9
 = 
l
 - 
c
; ()m9;

456 ià(!(
	`eq_s_b
(2, 
s_13
))è
Ïb9
;

457 
Ïb8
;

458 
Ïb9
:

459 
c
 = 
l
 - 
m9
;

460 ià(!(
	`eq_s_b
(2, 
s_14
))è{ 
c
 = 
l
 - 
m8
; 
Ïb7
; }

462 
Ïb8
:

463 
b¿
 = 
c
;

464 { 
»t
 = 
	`r_R1
();

465 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m8
; 
Ïb7
; }

466 ià(
»t
 < 0) „et;

468 ià(
	`¦iû_d–
() == -1)  -1;

469 
Ïb7
:

474 ià(
	`¦iû_d–
() == -1)  -1;

475 { 
m10
 = 
l
 - 
c
; ()m10;

476 
k‘
 = 
c
;

477 ià(
c
 - 1 <ğ
lb
 || (
p
[ø- 1] !ğ103 &&…[ø- 1] !ğ104)è{ c = 
l
 - 
m10
; 
Ïb10
; }

478 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 2, 0, 0);

479 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m10
; 
Ïb10
; }

480 
b¿
 = 
c
;

481 { 
»t
 = 
	`r_R2
();

482 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m10
; 
Ïb10
; }

483 ià(
»t
 < 0) „et;

485 
amÚg_v¬
) {

486 0: { 
c
 = 
l
 - 
m10
; 
Ïb10
; }

488 ià(
	`¦iû_d–
() == -1)  -1;

491 
Ïb10
:

496 
Ïb3
:

497 
c
 = 
l
 - 
m4
;

500 
	}
}

502 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$¡em
() {

503 { 
c1
 = 
c
;

504 { 
»t
 = 
	`r_´–ude
();

505 ià(
»t
 =ğ0è
Ïb0
;

506 ià(
»t
 < 0) „et;

508 
Ïb0
:

509 
c
 = 
c1
;

511 { 
c2
 = 
c
;

512 { 
»t
 = 
	`r_m¬k_»giÚs
();

513 ià(
»t
 =ğ0è
Ïb1
;

514 ià(
»t
 < 0) „et;

516 
Ïb1
:

517 
c
 = 
c2
;

519 
lb
 = 
c
; c = 
l
;

521 { 
m3
 = 
l
 - 
c
; ()m3;

522 { 
»t
 = 
	`r_¡ªd¬d_suffix
();

523 ià(
»t
 =ğ0è
Ïb2
;

524 ià(
»t
 < 0) „et;

526 
Ïb2
:

527 
c
 = 
l
 - 
m3
;

529 
c
 = 
lb
;

530 { 
c4
 = 
c
;

531 { 
»t
 = 
	`r_po¡lude
();

532 ià(
»t
 =ğ0è
Ïb3
;

533 ià(
»t
 < 0) „et;

535 
Ïb3
:

536 
c
 = 
c4
;

539 
	}
}

541 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$IÁ”ÇlS‹mG”mª2
()

542 : 
	`I_x
(0), 
	`I_p2
(0), 
	$I_p1
(0)

544 
	}
}

546 
	gX­Ÿn
::
IÁ”ÇlS‹mG”mª2
::~
	$IÁ”ÇlS‹mG”mª2
()

548 
	}
}

551 
X­Ÿn
::
IÁ”ÇlS‹mG”mª2
::
	$g‘_desütiÚ
() const

554 
	}
}

	@languages/german2.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mG”mª2
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_x
;

9 
	gI_p2
;

10 
	gI_p1
;

11 
	gpublic
:

12 
r_¡ªd¬d_suffix
();

13 
r_R2
();

14 
r_R1
();

15 
r_m¬k_»giÚs
();

16 
r_po¡lude
();

17 
r_´–ude
();

19 
IÁ”ÇlS‹mG”mª2
();

20 ~
IÁ”ÇlS‹mG”mª2
();

21 
¡em
();

22 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/hungarian.cc

3 
	~<lim™s.h
>

4 
	~"hung¬Ÿn.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_0
 0

	)

9 
	#s_0_1
 2

	)

11 
	#s_0_2
 5

	)

13 
	#s_0_3
 7

	)

15 
	#s_0_4
 9

	)

17 
	#s_0_5
 11

	)

19 
	#s_0_6
 13

	)

21 
	#s_0_7
 (
s_0_1
 + 1)

	)

22 
	#s_1_0
 15

	)

24 
	#s_1_1
 17

	)

26 
	#s_2_0
 19

	)

28 
	#s_2_1
 
s_2_12


	)

29 
	#s_2_2
 21

	)

31 
	#s_2_3
 23

	)

33 
	#s_2_4
 
s_2_17


	)

34 
	#s_2_5
 25

	)

36 
	#s_2_6
 27

	)

38 
	#s_2_7
 
s_2_18


	)

39 
	#s_2_8
 29

	)

41 
	#s_2_9
 
s_2_19


	)

42 
	#s_2_10
 31

	)

44 
	#s_2_11
 33

	)

46 
	#s_2_12
 35

	)

48 
	#s_2_13
 
s_2_21


	)

49 
	#s_2_14
 38

	)

51 
	#s_2_15
 
s_2_20


	)

52 
	#s_2_16
 41

	)

54 
	#s_2_17
 43

	)

56 
	#s_2_18
 46

	)

58 
	#s_2_19
 49

	)

60 
	#s_2_20
 52

	)

62 
	#s_2_21
 55

	)

64 
	#s_2_22
 
s_2_14


	)

65 
	#s_3_0
 58

	)

67 
	#s_3_1
 60

	)

69 
	#s_4_0
 
s_4_21


	)

70 
	#s_4_1
 62

	)

72 
	#s_4_2
 
s_4_23


	)

73 
	#s_4_3
 64

	)

75 
	#s_4_4
 66

	)

77 
	#s_4_5
 68

	)

79 
	#s_4_6
 71

	)

81 
	#s_4_7
 74

	)

83 
	#s_4_8
 77

	)

85 
	#s_4_9
 80

	)

87 
	#s_4_10
 82

	)

89 
	#s_4_11
 86

	)

91 
	#s_4_12
 90

	)

93 
	#s_4_13
 94

	)

95 
	#s_4_14
 98

	)

97 
	#s_4_15
 102

	)

99 
	#s_4_16
 106

	)

101 
	#s_4_17
 110

	)

103 
	#s_4_18
 114

	)

105 
	#s_4_19
 
s_4_5


	)

106 
	#s_4_20
 (
s_4_21
 + 1)

	)

107 
	#s_4_21
 117

	)

109 
	#s_4_22
 (
s_4_23
 + 1)

	)

110 
	#s_4_23
 120

	)

112 
	#s_4_24
 123

	)

114 
	#s_4_25
 
s_4_35


	)

115 
	#s_4_26
 130

	)

117 
	#s_4_27
 
s_4_24


	)

118 
	#s_4_28
 133

	)

120 
	#s_4_29
 
s_4_14


	)

121 
	#s_4_30
 136

	)

123 
	#s_4_31
 138

	)

125 
	#s_4_32
 (
s_4_33
 + 2)

	)

126 
	#s_4_33
 140

	)

128 
	#s_4_34
 147

	)

130 
	#s_4_35
 154

	)

132 
	#s_4_36
 161

	)

134 
	#s_4_37
 163

	)

136 
	#s_4_38
 167

	)

138 
	#s_4_39
 170

	)

140 
	#s_4_40
 173

	)

142 
	#s_4_41
 176

	)

144 
	#s_4_42
 180

	)

146 
	#s_4_43
 183

	)

148 
	#s_5_0
 
s_5_2


	)

149 
	#s_5_1
 (
s_5_2
 + 4)

	)

150 
	#s_5_2
 186

	)

152 
	#s_6_0
 (
s_6_1
 + 1)

	)

153 
	#s_6_1
 194

	)

155 
	#s_6_2
 199

	)

157 
	#s_6_3
 (
s_6_4
 + 1)

	)

158 
	#s_6_4
 205

	)

160 
	#s_6_5
 211

	)

162 
	#s_7_0
 218

	)

164 
	#s_7_1
 220

	)

166 
	#s_8_0
 (
s_8_1
 + 1)

	)

167 
	#s_8_1
 222

	)

169 
	#s_8_2
 224

	)

171 
	#s_8_3
 226

	)

173 
	#s_8_4
 228

	)

175 
	#s_8_5
 231

	)

177 
	#s_8_6
 234

	)

179 
	#s_9_0
 (
s_9_1
 + 2)

	)

180 
	#s_9_1
 237

	)

182 
	#s_9_2
 242

	)

184 
	#s_9_3
 
s_9_0


	)

185 
	#s_9_4
 (
s_9_5
 + 1)

	)

186 
	#s_9_5
 247

	)

188 
	#s_9_6
 251

	)

190 
	#s_9_7
 255

	)

192 
	#s_9_8
 259

	)

194 
	#s_9_9
 264

	)

196 
	#s_9_10
 269

	)

198 
	#s_9_11
 
s_9_2


	)

199 
	#s_10_0
 (
s_10_1
 + 1)

	)

200 
	#s_10_1
 274

	)

202 
	#s_10_2
 (
s_10_3
 + 1)

	)

203 
	#s_10_3
 276

	)

205 
	#s_10_4
 278

	)

207 
	#s_10_5
 280

	)

209 
	#s_10_6
 282

	)

211 
	#s_10_7
 285

	)

213 
	#s_10_8
 288

	)

215 
	#s_10_9
 
s_10_4


	)

216 
	#s_10_10
 291

	)

218 
	#s_10_11
 (
s_10_12
 + 1)

	)

219 
	#s_10_12
 293

	)

221 
	#s_10_13
 296

	)

223 
	#s_10_14
 300

	)

225 
	#s_10_15
 304

	)

227 
	#s_10_16
 (
s_10_17
 + 1)

	)

228 
	#s_10_17
 (
s_10_18
 + 2)

	)

229 
	#s_10_18
 308

	)

231 
	#s_10_19
 (
s_10_20
 + 1)

	)

232 
	#s_10_20
 (
s_10_21
 + 2)

	)

233 
	#s_10_21
 313

	)

235 
	#s_10_22
 (
s_10_23
 + 1)

	)

236 
	#s_10_23
 319

	)

238 
	#s_10_24
 321

	)

240 
	#s_10_25
 323

	)

242 
	#s_10_26
 325

	)

244 
	#s_10_27
 328

	)

246 
	#s_10_28
 
s_10_5


	)

247 
	#s_10_29
 
s_10_6


	)

248 
	#s_10_30
 
s_10_7


	)

249 
	#s_11_0
 (
s_11_1
 + 1)

	)

250 
	#s_11_1
 (
s_11_2
 + 1)

	)

251 
	#s_11_2
 331

	)

253 
	#s_11_3
 (
s_11_4
 + 1)

	)

254 
	#s_11_4
 335

	)

256 
	#s_11_5
 339

	)

258 
	#s_11_6
 343

	)

260 
	#s_11_7
 
s_11_0


	)

261 
	#s_11_8
 
s_11_1


	)

262 
	#s_11_9
 
s_11_2


	)

263 
	#s_11_10
 
s_11_3


	)

264 
	#s_11_11
 
s_11_4


	)

265 
	#s_11_12
 
s_11_5


	)

266 
	#s_11_13
 
s_11_6


	)

267 
	#s_11_14
 (
s_11_15
 + 1)

	)

268 
	#s_11_15
 (
s_11_16
 + 1)

	)

269 
	#s_11_16
 347

	)

271 
	#s_11_17
 353

	)

273 
	#s_11_18
 (
s_11_19
 + 1)

	)

274 
	#s_11_19
 (
s_11_20
 + 1)

	)

275 
	#s_11_20
 359

	)

277 
	#s_11_21
 (
s_11_22
 + 1)

	)

278 
	#s_11_22
 363

	)

280 
	#s_11_23
 367

	)

282 
	#s_11_24
 371

	)

284 
	#s_11_25
 (
s_11_26
 + 1)

	)

285 
	#s_11_26
 (
s_11_27
 + 1)

	)

286 
	#s_11_27
 375

	)

288 
	#s_11_28
 (
s_11_29
 + 1)

	)

289 
	#s_11_29
 380

	)

291 
	#s_11_30
 385

	)

293 
	#s_11_31
 390

	)

295 
	#s_11_32
 (
s_11_33
 + 1)

	)

296 
	#s_11_33
 395

	)

298 
	#s_11_34
 401

	)

300 
	#s_11_35
 (
s_11_36
 + 1)

	)

301 
	#s_11_36
 (
s_11_37
 + 1)

	)

302 
	#s_11_37
 407

	)

304 
	#s_11_38
 (
s_11_39
 + 1)

	)

305 
	#s_11_39
 411

	)

307 
	#s_11_40
 415

	)

309 
	#s_11_41
 419

	)

314 cÚ¡ 
amÚg
 
	ga_0
[8] =

316  { 2, 
s_0_0
, -1, -1},

317  { 3, 
s_0_1
, -1, -1},

318  { 2, 
s_0_2
, -1, -1},

319  { 2, 
s_0_3
, -1, -1},

320  { 2, 
s_0_4
, -1, -1},

321  { 2, 
s_0_5
, -1, -1},

322  { 2, 
s_0_6
, -1, -1},

323  { 2, 
s_0_7
, -1, -1}

327 cÚ¡ 
amÚg
 
	ga_1
[2] =

329  { 2, 
s_1_0
, -1, 1},

330  { 2, 
s_1_1
, -1, 2}

334 cÚ¡ 
amÚg
 
	ga_2
[23] =

336  { 2, 
s_2_0
, -1, -1},

337  { 2, 
s_2_1
, -1, -1},

338  { 2, 
s_2_2
, -1, -1},

339  { 2, 
s_2_3
, -1, -1},

340  { 2, 
s_2_4
, -1, -1},

341  { 2, 
s_2_5
, -1, -1},

342  { 2, 
s_2_6
, -1, -1},

343  { 2, 
s_2_7
, -1, -1},

344  { 2, 
s_2_8
, -1, -1},

345  { 2, 
s_2_9
, -1, -1},

346  { 2, 
s_2_10
, -1, -1},

347  { 2, 
s_2_11
, -1, -1},

348  { 3, 
s_2_12
, -1, -1},

349  { 2, 
s_2_13
, -1, -1},

350  { 3, 
s_2_14
, -1, -1},

351  { 2, 
s_2_15
, -1, -1},

352  { 2, 
s_2_16
, -1, -1},

353  { 3, 
s_2_17
, -1, -1},

354  { 3, 
s_2_18
, -1, -1},

355  { 3, 
s_2_19
, -1, -1},

356  { 3, 
s_2_20
, -1, -1},

357  { 3, 
s_2_21
, -1, -1},

358  { 2, 
s_2_22
, -1, -1}

362 cÚ¡ 
amÚg
 
	ga_3
[2] =

364  { 2, 
s_3_0
, -1, 1},

365  { 2, 
s_3_1
, -1, 2}

369 cÚ¡ 
amÚg
 
	ga_4
[44] =

371  { 2, 
s_4_0
, -1, -1},

372  { 2, 
s_4_1
, -1, -1},

373  { 2, 
s_4_2
, -1, -1},

374  { 2, 
s_4_3
, -1, -1},

375  { 2, 
s_4_4
, -1, -1},

376  { 3, 
s_4_5
, -1, -1},

377  { 3, 
s_4_6
, -1, -1},

378  { 3, 
s_4_7
, -1, -1},

379  { 3, 
s_4_8
, -1, -1},

380  { 2, 
s_4_9
, -1, -1},

381  { 4, 
s_4_10
, -1, -1},

382  { 4, 
s_4_11
, -1, -1},

383  { 4, 
s_4_12
, -1, -1},

384  { 4, 
s_4_13
, -1, -1},

385  { 4, 
s_4_14
, -1, -1},

386  { 4, 
s_4_15
, -1, -1},

387  { 4, 
s_4_16
, -1, -1},

388  { 4, 
s_4_17
, -1, -1},

389  { 3, 
s_4_18
, -1, -1},

390  { 1, 
s_4_19
, -1, -1},

391  { 2, 
s_4_20
, 19, -1},

392  { 3, 
s_4_21
, 20, -1},

393  { 2, 
s_4_22
, 19, -1},

394  { 3, 
s_4_23
, 22, -1},

395  { 7, 
s_4_24
, 22, -1},

396  { 2, 
s_4_25
, 19, -1},

397  { 3, 
s_4_26
, 19, -1},

398  { 5, 
s_4_27
, -1, -1},

399  { 3, 
s_4_28
, -1, -1},

400  { 1, 
s_4_29
, -1, -1},

401  { 2, 
s_4_30
, 29, -1},

402  { 2, 
s_4_31
, 29, -1},

403  { 5, 
s_4_32
, 29, -1},

404  { 7, 
s_4_33
, 32, -1},

405  { 7, 
s_4_34
, 32, -1},

406  { 7, 
s_4_35
, 32, -1},

407  { 2, 
s_4_36
, 29, -1},

408  { 4, 
s_4_37
, 29, -1},

409  { 3, 
s_4_38
, 29, -1},

410  { 3, 
s_4_39
, -1, -1},

411  { 3, 
s_4_40
, -1, -1},

412  { 4, 
s_4_41
, -1, -1},

413  { 3, 
s_4_42
, -1, -1},

414  { 3, 
s_4_43
, -1, -1}

418 cÚ¡ 
amÚg
 
	ga_5
[3] =

420  { 3, 
s_5_0
, -1, 2},

421  { 3, 
s_5_1
, -1, 1},

422  { 8, 
s_5_2
, -1, 3}

426 cÚ¡ 
amÚg
 
	ga_6
[6] =

428  { 4, 
s_6_0
, -1, 2},

429  { 5, 
s_6_1
, 0, 1},

430  { 6, 
s_6_2
, 0, 3},

431  { 5, 
s_6_3
, -1, 2},

432  { 6, 
s_6_4
, 3, 1},

433  { 7, 
s_6_5
, 3, 4}

437 cÚ¡ 
amÚg
 
	ga_7
[2] =

439  { 2, 
s_7_0
, -1, 1},

440  { 2, 
s_7_1
, -1, 2}

444 cÚ¡ 
amÚg
 
	ga_8
[7] =

446  { 1, 
s_8_0
, -1, 7},

447  { 2, 
s_8_1
, 0, 4},

448  { 2, 
s_8_2
, 0, 6},

449  { 2, 
s_8_3
, 0, 5},

450  { 3, 
s_8_4
, 0, 1},

451  { 3, 
s_8_5
, 0, 2},

452  { 3, 
s_8_6
, 0, 3}

456 cÚ¡ 
amÚg
 
	ga_9
[12] =

458  { 3, 
s_9_0
, -1, 7},

459  { 5, 
s_9_1
, 0, 6},

460  { 5, 
s_9_2
, 0, 5},

461  { 2, 
s_9_3
, -1, 9},

462  { 3, 
s_9_4
, 3, 4},

463  { 4, 
s_9_5
, 4, 1},

464  { 4, 
s_9_6
, 4, 1},

465  { 4, 
s_9_7
, 4, 1},

466  { 5, 
s_9_8
, 4, 3},

467  { 5, 
s_9_9
, 4, 2},

468  { 5, 
s_9_10
, 4, 1},

469  { 4, 
s_9_11
, 3, 8}

473 cÚ¡ 
amÚg
 
	ga_10
[31] =

475  { 1, 
s_10_0
, -1, 18},

476  { 2, 
s_10_1
, 0, 17},

477  { 1, 
s_10_2
, -1, 16},

478  { 2, 
s_10_3
, 2, 13},

479  { 2, 
s_10_4
, 2, 13},

480  { 2, 
s_10_5
, 2, 13},

481  { 3, 
s_10_6
, 2, 14},

482  { 3, 
s_10_7
, 2, 15},

483  { 3, 
s_10_8
, 2, 13},

484  { 1, 
s_10_9
, -1, 18},

485  { 2, 
s_10_10
, 9, 17},

486  { 2, 
s_10_11
, -1, 4},

487  { 3, 
s_10_12
, 11, 1},

488  { 4, 
s_10_13
, 11, 2},

489  { 4, 
s_10_14
, 11, 3},

490  { 4, 
s_10_15
, 11, 1},

491  { 2, 
s_10_16
, -1, 8},

492  { 3, 
s_10_17
, 16, 7},

493  { 5, 
s_10_18
, 17, 5},

494  { 3, 
s_10_19
, -1, 8},

495  { 4, 
s_10_20
, 19, 7},

496  { 6, 
s_10_21
, 20, 6},

497  { 1, 
s_10_22
, -1, 12},

498  { 2, 
s_10_23
, 22, 9},

499  { 2, 
s_10_24
, 22, 9},

500  { 2, 
s_10_25
, 22, 9},

501  { 3, 
s_10_26
, 22, 10},

502  { 3, 
s_10_27
, 22, 11},

503  { 1, 
s_10_28
, -1, 18},

504  { 2, 
s_10_29
, -1, 19},

505  { 2, 
s_10_30
, -1, 20}

509 cÚ¡ 
amÚg
 
	ga_11
[42] =

511  { 2, 
s_11_0
, -1, 10},

512  { 3, 
s_11_1
, 0, 9},

513  { 4, 
s_11_2
, 1, 6},

514  { 3, 
s_11_3
, 0, 9},

515  { 4, 
s_11_4
, 3, 6},

516  { 4, 
s_11_5
, 0, 7},

517  { 4, 
s_11_6
, 0, 8},

518  { 1, 
s_11_7
, -1, 15},

519  { 2, 
s_11_8
, 7, 14},

520  { 3, 
s_11_9
, 8, 11},

521  { 2, 
s_11_10
, 7, 14},

522  { 3, 
s_11_11
, 10, 11},

523  { 3, 
s_11_12
, 7, 12},

524  { 3, 
s_11_13
, 7, 13},

525  { 4, 
s_11_14
, -1, 24},

526  { 5, 
s_11_15
, 14, 21},

527  { 6, 
s_11_16
, 15, 20},

528  { 6, 
s_11_17
, 14, 23},

529  { 2, 
s_11_18
, -1, 29},

530  { 3, 
s_11_19
, 18, 26},

531  { 4, 
s_11_20
, 19, 25},

532  { 3, 
s_11_21
, 18, 26},

533  { 4, 
s_11_22
, 21, 25},

534  { 4, 
s_11_23
, 18, 27},

535  { 4, 
s_11_24
, 18, 28},

536  { 3, 
s_11_25
, -1, 20},

537  { 4, 
s_11_26
, 25, 17},

538  { 5, 
s_11_27
, 26, 16},

539  { 4, 
s_11_28
, 25, 17},

540  { 5, 
s_11_29
, 28, 16},

541  { 5, 
s_11_30
, 25, 18},

542  { 5, 
s_11_31
, 25, 19},

543  { 5, 
s_11_32
, -1, 21},

544  { 6, 
s_11_33
, 32, 20},

545  { 6, 
s_11_34
, -1, 22},

546  { 2, 
s_11_35
, -1, 5},

547  { 3, 
s_11_36
, 35, 4},

548  { 4, 
s_11_37
, 36, 1},

549  { 3, 
s_11_38
, 35, 4},

550  { 4, 
s_11_39
, 38, 1},

551  { 4, 
s_11_40
, 35, 2},

552  { 4, 
s_11_41
, 35, 3}

555 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 17, 52, 14 };

557 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'a' };

558 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'e' };

559 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'e' };

560 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'a' };

561 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'a' };

562 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'a' };

563 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'e' };

564 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'a' };

565 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'e' };

566 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'e' };

567 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'a' };

568 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'e' };

569 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'a' };

570 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'e' };

571 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'a' };

572 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'e' };

573 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'a' };

574 cÚ¡ 
symbŞ
 
	gs_17
[] = { 'e' };

575 cÚ¡ 
symbŞ
 
	gs_18
[] = { 'a' };

576 cÚ¡ 
symbŞ
 
	gs_19
[] = { 'e' };

577 cÚ¡ 
symbŞ
 
	gs_20
[] = { 'a' };

578 cÚ¡ 
symbŞ
 
	gs_21
[] = { 'e' };

579 cÚ¡ 
symbŞ
 
	gs_22
[] = { 'a' };

580 cÚ¡ 
symbŞ
 
	gs_23
[] = { 'e' };

581 cÚ¡ 
symbŞ
 
	gs_24
[] = { 'a' };

582 cÚ¡ 
symbŞ
 
	gs_25
[] = { 'e' };

583 cÚ¡ 
symbŞ
 
	gs_26
[] = { 'a' };

584 cÚ¡ 
symbŞ
 
	gs_27
[] = { 'e' };

585 cÚ¡ 
symbŞ
 
	gs_28
[] = { 'a' };

586 cÚ¡ 
symbŞ
 
	gs_29
[] = { 'e' };

587 cÚ¡ 
symbŞ
 
	gs_30
[] = { 'a' };

588 cÚ¡ 
symbŞ
 
	gs_31
[] = { 'e' };

589 cÚ¡ 
symbŞ
 
	gs_32
[] = { 'a' };

590 cÚ¡ 
symbŞ
 
	gs_33
[] = { 'e' };

591 cÚ¡ 
symbŞ
 
	gs_34
[] = { 'a' };

592 cÚ¡ 
symbŞ
 
	gs_35
[] = { 'e' };

594 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_m¬k_»giÚs
() {

595 
I_p1
 = 
l
;

596 { 
c1
 = 
c
;

597 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb1
;

598 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 1è< 0è
Ïb1
;

599 { 
c2
 = 
c
;

600 ià(
c
 + 1 >ğ
l
 || 
p
[ø+ 1] >> 5 !ğ3 || !((101187584 >> (p[ø+ 1] & 0x1f)è& 1)è
Ïb3
;

601 ià(!(
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 8, 0, 0))è
Ïb3
;

602 
Ïb2
;

603 
Ïb3
:

604 
c
 = 
c2
;

605 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

606 ià(
»t
 < 0è
Ïb1
;

607 
c
 = 
»t
;

610 
Ïb2
:

611 
I_p1
 = 
c
;

612 
Ïb0
;

613 
Ïb1
:

614 
c
 = 
c1
;

615 ià(
	`out_groupšg_U
(
g_v
, 97, 252, 0))  0;

616 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

617 ià(
»t
 < 0)  0;

618 
c
 +ğ
»t
;

620 
I_p1
 = 
c
;

622 
Ïb0
:

624 
	}
}

626 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_R1
() {

627 ià(!(
I_p1
 <ğ
c
))  0;

629 
	}
}

631 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_v_’dšg
() {

632 
amÚg_v¬
;

633 
k‘
 = 
c
;

634 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 161 &&…[c - 1] != 169))  0;

635 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 2, 0, 0);

636 ià(!(
amÚg_v¬
))  0;

637 
b¿
 = 
c
;

638 { 
»t
 = 
	`r_R1
();

639 ià(
»t
 <= 0) „et;

641 
amÚg_v¬
) {

644 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_0
);

645 ià(
»t
 < 0) „et;

649 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_1
);

650 ià(
»t
 < 0) „et;

655 
	}
}

657 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_doubË
() {

658 { 
m_‹¡1
 = 
l
 - 
c
;

659 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((106790108 >> (p[c - 1] & 0x1f)) & 1))  0;

660 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 23, 0, 0)))  0;

661 
c
 = 
l
 - 
m_‹¡1
;

664 
	}
}

666 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_undoubË
() {

667 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

668 ià(
»t
 < 0)  0;

669 
c
 = 
»t
;

671 
k‘
 = 
c
;

672 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 1);

673 ià(
»t
 < 0)  0;

674 
c
 = 
»t
;

676 
b¿
 = 
c
;

677 ià(
	`¦iû_d–
() == -1)  -1;

679 
	}
}

681 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_š¡rum
() {

682 
amÚg_v¬
;

683 
k‘
 = 
c
;

684 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] != 108)  0;

685 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 2, 0, 0);

686 ià(!(
amÚg_v¬
))  0;

687 
b¿
 = 
c
;

688 { 
»t
 = 
	`r_R1
();

689 ià(
»t
 <= 0) „et;

691 
amÚg_v¬
) {

694 { 
»t
 = 
	`r_doubË
();

695 ià(
»t
 <= 0) „et;

699 { 
»t
 = 
	`r_doubË
();

700 ià(
»t
 <= 0) „et;

704 ià(
	`¦iû_d–
() == -1)  -1;

705 { 
»t
 = 
	`r_undoubË
();

706 ià(
»t
 <= 0) „et;

709 
	}
}

711 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_ÿ£
() {

712 
k‘
 = 
c
;

713 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 44, 0, 0)))  0;

714 
b¿
 = 
c
;

715 { 
»t
 = 
	`r_R1
();

716 ià(
»t
 <= 0) „et;

718 ià(
	`¦iû_d–
() == -1)  -1;

719 { 
»t
 = 
	`r_v_’dšg
();

720 ià(
»t
 <= 0) „et;

723 
	}
}

725 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_ÿ£_¥ecŸl
() {

726 
amÚg_v¬
;

727 
k‘
 = 
c
;

728 ià(
c
 - 2 <ğ
lb
 || (
p
[c - 1] != 110 &&…[c - 1] != 116))  0;

729 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 3, 0, 0);

730 ià(!(
amÚg_v¬
))  0;

731 
b¿
 = 
c
;

732 { 
»t
 = 
	`r_R1
();

733 ià(
»t
 <= 0) „et;

735 
amÚg_v¬
) {

738 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_2
);

739 ià(
»t
 < 0) „et;

743 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_3
);

744 ià(
»t
 < 0) „et;

748 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_4
);

749 ià(
»t
 < 0) „et;

754 
	}
}

756 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_ÿ£_Ùh”
() {

757 
amÚg_v¬
;

758 
k‘
 = 
c
;

759 ià(
c
 - 3 <ğ
lb
 || 
p
[c - 1] != 108)  0;

760 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 6, 0, 0);

761 ià(!(
amÚg_v¬
))  0;

762 
b¿
 = 
c
;

763 { 
»t
 = 
	`r_R1
();

764 ià(
»t
 <= 0) „et;

766 
amÚg_v¬
) {

769 ià(
	`¦iû_d–
() == -1)  -1;

772 ià(
	`¦iû_d–
() == -1)  -1;

775 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_5
);

776 ià(
»t
 < 0) „et;

780 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_6
);

781 ià(
»t
 < 0) „et;

786 
	}
}

788 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_çùive
() {

789 
amÚg_v¬
;

790 
k‘
 = 
c
;

791 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 161 &&…[c - 1] != 169))  0;

792 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 2, 0, 0);

793 ià(!(
amÚg_v¬
))  0;

794 
b¿
 = 
c
;

795 { 
»t
 = 
	`r_R1
();

796 ià(
»t
 <= 0) „et;

798 
amÚg_v¬
) {

801 { 
»t
 = 
	`r_doubË
();

802 ià(
»t
 <= 0) „et;

806 { 
»t
 = 
	`r_doubË
();

807 ià(
»t
 <= 0) „et;

811 ià(
	`¦iû_d–
() == -1)  -1;

812 { 
»t
 = 
	`r_undoubË
();

813 ià(
»t
 <= 0) „et;

816 
	}
}

818 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_¶u¿l
() {

819 
amÚg_v¬
;

820 
k‘
 = 
c
;

821 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 107)  0;

822 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_8
, 7, 0, 0);

823 ià(!(
amÚg_v¬
))  0;

824 
b¿
 = 
c
;

825 { 
»t
 = 
	`r_R1
();

826 ià(
»t
 <= 0) „et;

828 
amÚg_v¬
) {

831 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_7
);

832 ià(
»t
 < 0) „et;

836 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_8
);

837 ià(
»t
 < 0) „et;

841 ià(
	`¦iû_d–
() == -1)  -1;

844 ià(
	`¦iû_d–
() == -1)  -1;

847 ià(
	`¦iû_d–
() == -1)  -1;

850 ià(
	`¦iû_d–
() == -1)  -1;

853 ià(
	`¦iû_d–
() == -1)  -1;

857 
	}
}

859 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_owÃd
() {

860 
amÚg_v¬
;

861 
k‘
 = 
c
;

862 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 105 &&…[c - 1] != 169))  0;

863 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_9
, 12, 0, 0);

864 ià(!(
amÚg_v¬
))  0;

865 
b¿
 = 
c
;

866 { 
»t
 = 
	`r_R1
();

867 ià(
»t
 <= 0) „et;

869 
amÚg_v¬
) {

872 ià(
	`¦iû_d–
() == -1)  -1;

875 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_9
);

876 ià(
»t
 < 0) „et;

880 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_10
);

881 ià(
»t
 < 0) „et;

885 ià(
	`¦iû_d–
() == -1)  -1;

888 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_11
);

889 ià(
»t
 < 0) „et;

893 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_12
);

894 ià(
»t
 < 0) „et;

898 ià(
	`¦iû_d–
() == -1)  -1;

901 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_13
);

902 ià(
»t
 < 0) „et;

906 ià(
	`¦iû_d–
() == -1)  -1;

910 
	}
}

912 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_sšg_owÃr
() {

913 
amÚg_v¬
;

914 
k‘
 = 
c
;

915 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_10
, 31, 0, 0);

916 ià(!(
amÚg_v¬
))  0;

917 
b¿
 = 
c
;

918 { 
»t
 = 
	`r_R1
();

919 ià(
»t
 <= 0) „et;

921 
amÚg_v¬
) {

924 ià(
	`¦iû_d–
() == -1)  -1;

927 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_14
);

928 ià(
»t
 < 0) „et;

932 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_15
);

933 ià(
»t
 < 0) „et;

937 ià(
	`¦iû_d–
() == -1)  -1;

940 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_16
);

941 ià(
»t
 < 0) „et;

945 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_17
);

946 ià(
»t
 < 0) „et;

950 ià(
	`¦iû_d–
() == -1)  -1;

953 ià(
	`¦iû_d–
() == -1)  -1;

956 ià(
	`¦iû_d–
() == -1)  -1;

959 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_18
);

960 ià(
»t
 < 0) „et;

964 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_19
);

965 ià(
»t
 < 0) „et;

969 ià(
	`¦iû_d–
() == -1)  -1;

972 ià(
	`¦iû_d–
() == -1)  -1;

975 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_20
);

976 ià(
»t
 < 0) „et;

980 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_21
);

981 ià(
»t
 < 0) „et;

985 ià(
	`¦iû_d–
() == -1)  -1;

988 ià(
	`¦iû_d–
() == -1)  -1;

991 ià(
	`¦iû_d–
() == -1)  -1;

994 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_22
);

995 ià(
»t
 < 0) „et;

999 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_23
);

1000 ià(
»t
 < 0) „et;

1005 
	}
}

1007 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$r_¶ur_owÃr
() {

1008 
amÚg_v¬
;

1009 
k‘
 = 
c
;

1010 ià(
c
 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((10768 >> (p[c - 1] & 0x1f)) & 1))  0;

1011 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_11
, 42, 0, 0);

1012 ià(!(
amÚg_v¬
))  0;

1013 
b¿
 = 
c
;

1014 { 
»t
 = 
	`r_R1
();

1015 ià(
»t
 <= 0) „et;

1017 
amÚg_v¬
) {

1020 ià(
	`¦iû_d–
() == -1)  -1;

1023 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_24
);

1024 ià(
»t
 < 0) „et;

1028 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_25
);

1029 ià(
»t
 < 0) „et;

1033 ià(
	`¦iû_d–
() == -1)  -1;

1036 ià(
	`¦iû_d–
() == -1)  -1;

1039 ià(
	`¦iû_d–
() == -1)  -1;

1042 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_26
);

1043 ià(
»t
 < 0) „et;

1047 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_27
);

1048 ià(
»t
 < 0) „et;

1052 ià(
	`¦iû_d–
() == -1)  -1;

1055 ià(
	`¦iû_d–
() == -1)  -1;

1058 ià(
	`¦iû_d–
() == -1)  -1;

1061 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_28
);

1062 ià(
»t
 < 0) „et;

1066 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_29
);

1067 ià(
»t
 < 0) „et;

1071 ià(
	`¦iû_d–
() == -1)  -1;

1074 ià(
	`¦iû_d–
() == -1)  -1;

1077 ià(
	`¦iû_d–
() == -1)  -1;

1080 ià(
	`¦iû_d–
() == -1)  -1;

1083 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_30
);

1084 ià(
»t
 < 0) „et;

1088 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_31
);

1089 ià(
»t
 < 0) „et;

1093 ià(
	`¦iû_d–
() == -1)  -1;

1096 ià(
	`¦iû_d–
() == -1)  -1;

1099 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_32
);

1100 ià(
»t
 < 0) „et;

1104 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_33
);

1105 ià(
»t
 < 0) „et;

1109 ià(
	`¦iû_d–
() == -1)  -1;

1112 ià(
	`¦iû_d–
() == -1)  -1;

1115 ià(
	`¦iû_d–
() == -1)  -1;

1118 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_34
);

1119 ià(
»t
 < 0) „et;

1123 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_35
);

1124 ià(
»t
 < 0) „et;

1128 ià(
	`¦iû_d–
() == -1)  -1;

1132 
	}
}

1134 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$¡em
() {

1135 { 
c1
 = 
c
;

1136 { 
»t
 = 
	`r_m¬k_»giÚs
();

1137 ià(
»t
 =ğ0è
Ïb0
;

1138 ià(
»t
 < 0) „et;

1140 
Ïb0
:

1141 
c
 = 
c1
;

1143 
lb
 = 
c
; c = 
l
;

1145 { 
m2
 = 
l
 - 
c
; ()m2;

1146 { 
»t
 = 
	`r_š¡rum
();

1147 ià(
»t
 =ğ0è
Ïb1
;

1148 ià(
»t
 < 0) „et;

1150 
Ïb1
:

1151 
c
 = 
l
 - 
m2
;

1153 { 
m3
 = 
l
 - 
c
; ()m3;

1154 { 
»t
 = 
	`r_ÿ£
();

1155 ià(
»t
 =ğ0è
Ïb2
;

1156 ià(
»t
 < 0) „et;

1158 
Ïb2
:

1159 
c
 = 
l
 - 
m3
;

1161 { 
m4
 = 
l
 - 
c
; ()m4;

1162 { 
»t
 = 
	`r_ÿ£_¥ecŸl
();

1163 ià(
»t
 =ğ0è
Ïb3
;

1164 ià(
»t
 < 0) „et;

1166 
Ïb3
:

1167 
c
 = 
l
 - 
m4
;

1169 { 
m5
 = 
l
 - 
c
; ()m5;

1170 { 
»t
 = 
	`r_ÿ£_Ùh”
();

1171 ià(
»t
 =ğ0è
Ïb4
;

1172 ià(
»t
 < 0) „et;

1174 
Ïb4
:

1175 
c
 = 
l
 - 
m5
;

1177 { 
m6
 = 
l
 - 
c
; ()m6;

1178 { 
»t
 = 
	`r_çùive
();

1179 ià(
»t
 =ğ0è
Ïb5
;

1180 ià(
»t
 < 0) „et;

1182 
Ïb5
:

1183 
c
 = 
l
 - 
m6
;

1185 { 
m7
 = 
l
 - 
c
; ()m7;

1186 { 
»t
 = 
	`r_owÃd
();

1187 ià(
»t
 =ğ0è
Ïb6
;

1188 ià(
»t
 < 0) „et;

1190 
Ïb6
:

1191 
c
 = 
l
 - 
m7
;

1193 { 
m8
 = 
l
 - 
c
; ()m8;

1194 { 
»t
 = 
	`r_sšg_owÃr
();

1195 ià(
»t
 =ğ0è
Ïb7
;

1196 ià(
»t
 < 0) „et;

1198 
Ïb7
:

1199 
c
 = 
l
 - 
m8
;

1201 { 
m9
 = 
l
 - 
c
; ()m9;

1202 { 
»t
 = 
	`r_¶ur_owÃr
();

1203 ià(
»t
 =ğ0è
Ïb8
;

1204 ià(
»t
 < 0) „et;

1206 
Ïb8
:

1207 
c
 = 
l
 - 
m9
;

1209 { 
m10
 = 
l
 - 
c
; ()m10;

1210 { 
»t
 = 
	`r_¶u¿l
();

1211 ià(
»t
 =ğ0è
Ïb9
;

1212 ià(
»t
 < 0) „et;

1214 
Ïb9
:

1215 
c
 = 
l
 - 
m10
;

1217 
c
 = 
lb
;

1219 
	}
}

1221 
	gX­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$IÁ”ÇlS‹mHung¬Ÿn
()

1222 : 
	$I_p1
(0)

1224 
	}
}

1226 
X­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::~
	$IÁ”ÇlS‹mHung¬Ÿn
()

1228 
	}
}

1231 
X­Ÿn
::
IÁ”ÇlS‹mHung¬Ÿn
::
	$g‘_desütiÚ
() const

1234 
	}
}

	@languages/hungarian.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mHung¬Ÿn
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_p1
;

9 
	gpublic
:

10 
r_doubË
();

11 
r_undoubË
();

12 
r_çùive
();

13 
r_š¡rum
();

14 
r_¶ur_owÃr
();

15 
r_sšg_owÃr
();

16 
r_owÃd
();

17 
r_¶u¿l
();

18 
r_ÿ£_Ùh”
();

19 
r_ÿ£_¥ecŸl
();

20 
r_ÿ£
();

21 
r_v_’dšg
();

22 
r_R1
();

23 
r_m¬k_»giÚs
();

25 
IÁ”ÇlS‹mHung¬Ÿn
();

26 ~
IÁ”ÇlS‹mHung¬Ÿn
();

27 
¡em
();

28 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/italian.cc

3 
	~<lim™s.h
>

4 
	~"™®Ÿn.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_1
 0

	)

9 
	#s_0_2
 2

	)

11 
	#s_0_3
 4

	)

13 
	#s_0_4
 6

	)

15 
	#s_0_5
 8

	)

17 
	#s_0_6
 10

	)

19 
	#s_1_1
 12

	)

21 
	#s_1_2
 13

	)

23 
	#s_2_0
 (
s_2_1
 + 2)

	)

24 
	#s_2_1
 14

	)

26 
	#s_2_2
 18

	)

28 
	#s_2_3
 24

	)

30 
	#s_2_4
 28

	)

32 
	#s_2_5
 32

	)

34 
	#s_2_6
 (
s_2_7
 + 2)

	)

35 
	#s_2_7
 36

	)

37 
	#s_2_8
 40

	)

39 
	#s_2_9
 46

	)

41 
	#s_2_10
 50

	)

43 
	#s_2_11
 54

	)

45 
	#s_2_12
 (
s_2_13
 + 2)

	)

46 
	#s_2_13
 58

	)

48 
	#s_2_14
 62

	)

50 
	#s_2_15
 68

	)

52 
	#s_2_16
 72

	)

54 
	#s_2_17
 76

	)

56 
	#s_2_18
 80

	)

58 
	#s_2_19
 84

	)

60 
	#s_2_20
 (
s_2_2
 + 1)

	)

61 
	#s_2_21
 86

	)

63 
	#s_2_22
 90

	)

65 
	#s_2_23
 96

	)

67 
	#s_2_24
 100

	)

69 
	#s_2_25
 104

	)

71 
	#s_2_26
 
s_2_2


	)

72 
	#s_2_27
 108

	)

74 
	#s_2_28
 110

	)

76 
	#s_2_29
 112

	)

78 
	#s_2_30
 114

	)

80 
	#s_2_31
 (
s_2_32
 + 2)

	)

81 
	#s_2_32
 116

	)

83 
	#s_2_33
 120

	)

85 
	#s_2_34
 126

	)

87 
	#s_2_35
 130

	)

89 
	#s_2_36
 134

	)

91 
	#s_3_0
 138

	)

93 
	#s_3_1
 142

	)

95 
	#s_3_2
 146

	)

97 
	#s_3_3
 148

	)

99 
	#s_3_4
 150

	)

101 
	#s_4_0
 152

	)

103 
	#s_4_1
 154

	)

105 
	#s_4_2
 158

	)

107 
	#s_4_3
 160

	)

109 
	#s_5_0
 162

	)

111 
	#s_5_1
 164

	)

113 
	#s_5_2
 168

	)

115 
	#s_6_0
 170

	)

117 
	#s_6_1
 173

	)

119 
	#s_6_2
 178

	)

121 
	#s_6_3
 181

	)

123 
	#s_6_4
 185

	)

125 
	#s_6_5
 188

	)

127 
	#s_6_6
 192

	)

129 
	#s_6_7
 (
s_6_8
 + 3)

	)

130 
	#s_6_8
 196

	)

132 
	#s_6_9
 202

	)

134 
	#s_6_10
 206

	)

136 
	#s_6_11
 211

	)

138 
	#s_6_12
 216

	)

140 
	#s_6_13
 221

	)

142 
	#s_6_14
 227

	)

144 
	#s_6_15
 233

	)

146 
	#s_6_16
 239

	)

148 
	#s_6_17
 244

	)

150 
	#s_6_18
 247

	)

152 
	#s_6_19
 (
s_6_20
 + 1)

	)

153 
	#s_6_20
 251

	)

155 
	#s_6_21
 257

	)

157 
	#s_6_22
 261

	)

159 
	#s_6_23
 264

	)

161 
	#s_6_24
 268

	)

163 
	#s_6_25
 (
s_6_26
 + 3)

	)

164 
	#s_6_26
 272

	)

166 
	#s_6_27
 278

	)

168 
	#s_6_28
 282

	)

170 
	#s_6_29
 287

	)

172 
	#s_6_30
 292

	)

174 
	#s_6_31
 296

	)

176 
	#s_6_32
 302

	)

178 
	#s_6_33
 308

	)

180 
	#s_6_34
 314

	)

182 
	#s_6_35
 319

	)

184 
	#s_6_36
 322

	)

186 
	#s_6_37
 326

	)

188 
	#s_6_38
 332

	)

190 
	#s_6_39
 338

	)

192 
	#s_6_40
 342

	)

194 
	#s_6_41
 345

	)

196 
	#s_6_42
 348

	)

198 
	#s_6_43
 352

	)

200 
	#s_6_44
 355

	)

202 
	#s_6_45
 361

	)

204 
	#s_6_46
 367

	)

206 
	#s_6_47
 370

	)

208 
	#s_6_48
 374

	)

210 
	#s_6_49
 379

	)

212 
	#s_6_50
 384

	)

214 
	#s_7_0
 
s_7_59


	)

215 
	#s_7_1
 389

	)

217 
	#s_7_2
 393

	)

219 
	#s_7_3
 396

	)

221 
	#s_7_4
 399

	)

223 
	#s_7_5
 
s_7_17


	)

224 
	#s_7_6
 
s_7_18


	)

225 
	#s_7_7
 
s_7_19


	)

226 
	#s_7_8
 
s_7_70


	)

227 
	#s_7_9
 
s_7_71


	)

228 
	#s_7_10
 402

	)

230 
	#s_7_11
 406

	)

232 
	#s_7_12
 410

	)

234 
	#s_7_13
 
s_7_8


	)

235 
	#s_7_14
 
s_7_9


	)

236 
	#s_7_15
 
s_7_72


	)

237 
	#s_7_16
 (
s_7_17
 + 2)

	)

238 
	#s_7_17
 413

	)

240 
	#s_7_18
 418

	)

242 
	#s_7_19
 423

	)

244 
	#s_7_20
 (
s_7_21
 + 2)

	)

245 
	#s_7_21
 428

	)

247 
	#s_7_22
 433

	)

249 
	#s_7_23
 438

	)

251 
	#s_7_24
 441

	)

253 
	#s_7_25
 447

	)

255 
	#s_7_26
 453

	)

257 
	#s_7_27
 456

	)

259 
	#s_7_28
 460

	)

261 
	#s_7_29
 464

	)

263 
	#s_7_30
 468

	)

265 
	#s_7_31
 472

	)

267 
	#s_7_32
 476

	)

269 
	#s_7_33
 
s_7_52


	)

270 
	#s_7_34
 480

	)

272 
	#s_7_35
 483

	)

274 
	#s_7_36
 486

	)

276 
	#s_7_37
 492

	)

278 
	#s_7_38
 498

	)

280 
	#s_7_39
 501

	)

282 
	#s_7_40
 504

	)

284 
	#s_7_41
 507

	)

286 
	#s_7_42
 
s_7_66


	)

287 
	#s_7_43
 510

	)

289 
	#s_7_44
 514

	)

291 
	#s_7_45
 518

	)

293 
	#s_7_46
 522

	)

295 
	#s_7_47
 526

	)

297 
	#s_7_48
 531

	)

299 
	#s_7_49
 536

	)

301 
	#s_7_50
 541

	)

303 
	#s_7_51
 546

	)

305 
	#s_7_52
 551

	)

307 
	#s_7_53
 557

	)

309 
	#s_7_54
 (
s_7_55
 + 2)

	)

310 
	#s_7_55
 561

	)

312 
	#s_7_56
 567

	)

314 
	#s_7_57
 573

	)

316 
	#s_7_58
 (
s_7_59
 + 3)

	)

317 
	#s_7_59
 577

	)

319 
	#s_7_60
 583

	)

321 
	#s_7_61
 588

	)

323 
	#s_7_62
 593

	)

325 
	#s_7_63
 598

	)

327 
	#s_7_64
 604

	)

329 
	#s_7_65
 (
s_7_66
 + 3)

	)

330 
	#s_7_66
 610

	)

332 
	#s_7_67
 616

	)

334 
	#s_7_68
 621

	)

336 
	#s_7_69
 626

	)

338 
	#s_7_70
 631

	)

340 
	#s_7_71
 639

	)

342 
	#s_7_72
 647

	)

344 
	#s_7_73
 653

	)

346 
	#s_7_74
 659

	)

348 
	#s_7_75
 665

	)

350 
	#s_7_76
 668

	)

352 
	#s_7_77
 671

	)

354 
	#s_7_78
 674

	)

356 
	#s_7_79
 677

	)

358 
	#s_7_80
 680

	)

360 
	#s_7_81
 
s_7_12


	)

361 
	#s_7_82
 
s_7_9


	)

362 
	#s_7_83
 683

	)

364 
	#s_7_84
 687

	)

366 
	#s_7_85
 691

	)

368 
	#s_7_86
 695

	)

373 cÚ¡ 
amÚg
 
	ga_0
[7] =

376  { 2, 
s_0_1
, 0, 6},

377  { 2, 
s_0_2
, 0, 1},

378  { 2, 
s_0_3
, 0, 2},

379  { 2, 
s_0_4
, 0, 3},

380  { 2, 
s_0_5
, 0, 4},

381  { 2, 
s_0_6
, 0, 5}

385 cÚ¡ 
amÚg
 
	ga_1
[3] =

388  { 1, 
s_1_1
, 0, 1},

389  { 1, 
s_1_2
, 0, 2}

393 cÚ¡ 
amÚg
 
	ga_2
[37] =

395  { 2, 
s_2_0
, -1, -1},

396  { 4, 
s_2_1
, 0, -1},

397  { 6, 
s_2_2
, 0, -1},

398  { 4, 
s_2_3
, 0, -1},

399  { 4, 
s_2_4
, 0, -1},

400  { 4, 
s_2_5
, 0, -1},

401  { 2, 
s_2_6
, -1, -1},

402  { 4, 
s_2_7
, 6, -1},

403  { 6, 
s_2_8
, 6, -1},

404  { 4, 
s_2_9
, 6, -1},

405  { 4, 
s_2_10
, 6, -1},

406  { 4, 
s_2_11
, 6, -1},

407  { 2, 
s_2_12
, -1, -1},

408  { 4, 
s_2_13
, 12, -1},

409  { 6, 
s_2_14
, 12, -1},

410  { 4, 
s_2_15
, 12, -1},

411  { 4, 
s_2_16
, 12, -1},

412  { 4, 
s_2_17
, 12, -1},

413  { 4, 
s_2_18
, 12, -1},

414  { 2, 
s_2_19
, -1, -1},

415  { 2, 
s_2_20
, -1, -1},

416  { 4, 
s_2_21
, 20, -1},

417  { 6, 
s_2_22
, 20, -1},

418  { 4, 
s_2_23
, 20, -1},

419  { 4, 
s_2_24
, 20, -1},

420  { 4, 
s_2_25
, 20, -1},

421  { 3, 
s_2_26
, 20, -1},

422  { 2, 
s_2_27
, -1, -1},

423  { 2, 
s_2_28
, -1, -1},

424  { 2, 
s_2_29
, -1, -1},

425  { 2, 
s_2_30
, -1, -1},

426  { 2, 
s_2_31
, -1, -1},

427  { 4, 
s_2_32
, 31, -1},

428  { 6, 
s_2_33
, 31, -1},

429  { 4, 
s_2_34
, 31, -1},

430  { 4, 
s_2_35
, 31, -1},

431  { 4, 
s_2_36
, 31, -1}

435 cÚ¡ 
amÚg
 
	ga_3
[5] =

437  { 4, 
s_3_0
, -1, 1},

438  { 4, 
s_3_1
, -1, 1},

439  { 2, 
s_3_2
, -1, 2},

440  { 2, 
s_3_3
, -1, 2},

441  { 2, 
s_3_4
, -1, 2}

445 cÚ¡ 
amÚg
 
	ga_4
[4] =

447  { 2, 
s_4_0
, -1, -1},

448  { 4, 
s_4_1
, -1, -1},

449  { 2, 
s_4_2
, -1, -1},

450  { 2, 
s_4_3
, -1, 1}

454 cÚ¡ 
amÚg
 
	ga_5
[3] =

456  { 2, 
s_5_0
, -1, 1},

457  { 4, 
s_5_1
, -1, 1},

458  { 2, 
s_5_2
, -1, 1}

462 cÚ¡ 
amÚg
 
	ga_6
[51] =

464  { 3, 
s_6_0
, -1, 1},

465  { 5, 
s_6_1
, -1, 3},

466  { 3, 
s_6_2
, -1, 1},

467  { 4, 
s_6_3
, -1, 1},

468  { 3, 
s_6_4
, -1, 9},

469  { 4, 
s_6_5
, -1, 1},

470  { 4, 
s_6_6
, -1, 5},

471  { 3, 
s_6_7
, -1, 1},

472  { 6, 
s_6_8
, 7, 1},

473  { 4, 
s_6_9
, -1, 1},

474  { 5, 
s_6_10
, -1, 3},

475  { 5, 
s_6_11
, -1, 1},

476  { 5, 
s_6_12
, -1, 1},

477  { 6, 
s_6_13
, -1, 4},

478  { 6, 
s_6_14
, -1, 2},

479  { 6, 
s_6_15
, -1, 4},

480  { 5, 
s_6_16
, -1, 2},

481  { 3, 
s_6_17
, -1, 1},

482  { 4, 
s_6_18
, -1, 1},

483  { 5, 
s_6_19
, -1, 1},

484  { 6, 
s_6_20
, 19, 7},

485  { 4, 
s_6_21
, -1, 1},

486  { 3, 
s_6_22
, -1, 9},

487  { 4, 
s_6_23
, -1, 1},

488  { 4, 
s_6_24
, -1, 5},

489  { 3, 
s_6_25
, -1, 1},

490  { 6, 
s_6_26
, 25, 1},

491  { 4, 
s_6_27
, -1, 1},

492  { 5, 
s_6_28
, -1, 1},

493  { 5, 
s_6_29
, -1, 1},

494  { 4, 
s_6_30
, -1, 1},

495  { 6, 
s_6_31
, -1, 4},

496  { 6, 
s_6_32
, -1, 2},

497  { 6, 
s_6_33
, -1, 4},

498  { 5, 
s_6_34
, -1, 2},

499  { 3, 
s_6_35
, -1, 1},

500  { 4, 
s_6_36
, -1, 1},

501  { 6, 
s_6_37
, -1, 6},

502  { 6, 
s_6_38
, -1, 6},

503  { 4, 
s_6_39
, -1, 1},

504  { 3, 
s_6_40
, -1, 9},

505  { 3, 
s_6_41
, -1, 1},

506  { 4, 
s_6_42
, -1, 1},

507  { 3, 
s_6_43
, -1, 1},

508  { 6, 
s_6_44
, -1, 6},

509  { 6, 
s_6_45
, -1, 6},

510  { 3, 
s_6_46
, -1, 9},

511  { 4, 
s_6_47
, -1, 8},

512  { 5, 
s_6_48
, -1, 1},

513  { 5, 
s_6_49
, -1, 1},

514  { 5, 
s_6_50
, -1, 1}

518 cÚ¡ 
amÚg
 
	ga_7
[87] =

520  { 4, 
s_7_0
, -1, 1},

521  { 4, 
s_7_1
, -1, 1},

522  { 3, 
s_7_2
, -1, 1},

523  { 3, 
s_7_3
, -1, 1},

524  { 3, 
s_7_4
, -1, 1},

525  { 3, 
s_7_5
, -1, 1},

526  { 3, 
s_7_6
, -1, 1},

527  { 3, 
s_7_7
, -1, 1},

528  { 6, 
s_7_8
, -1, 1},

529  { 6, 
s_7_9
, -1, 1},

530  { 4, 
s_7_10
, -1, 1},

531  { 4, 
s_7_11
, -1, 1},

532  { 3, 
s_7_12
, -1, 1},

533  { 3, 
s_7_13
, -1, 1},

534  { 3, 
s_7_14
, -1, 1},

535  { 4, 
s_7_15
, -1, 1},

536  { 3, 
s_7_16
, -1, 1},

537  { 5, 
s_7_17
, 16, 1},

538  { 5, 
s_7_18
, 16, 1},

539  { 5, 
s_7_19
, 16, 1},

540  { 3, 
s_7_20
, -1, 1},

541  { 5, 
s_7_21
, 20, 1},

542  { 5, 
s_7_22
, 20, 1},

543  { 3, 
s_7_23
, -1, 1},

544  { 6, 
s_7_24
, -1, 1},

545  { 6, 
s_7_25
, -1, 1},

546  { 3, 
s_7_26
, -1, 1},

547  { 4, 
s_7_27
, -1, 1},

548  { 4, 
s_7_28
, -1, 1},

549  { 4, 
s_7_29
, -1, 1},

550  { 4, 
s_7_30
, -1, 1},

551  { 4, 
s_7_31
, -1, 1},

552  { 4, 
s_7_32
, -1, 1},

553  { 4, 
s_7_33
, -1, 1},

554  { 3, 
s_7_34
, -1, 1},

555  { 3, 
s_7_35
, -1, 1},

556  { 6, 
s_7_36
, -1, 1},

557  { 6, 
s_7_37
, -1, 1},

558  { 3, 
s_7_38
, -1, 1},

559  { 3, 
s_7_39
, -1, 1},

560  { 3, 
s_7_40
, -1, 1},

561  { 3, 
s_7_41
, -1, 1},

562  { 4, 
s_7_42
, -1, 1},

563  { 4, 
s_7_43
, -1, 1},

564  { 4, 
s_7_44
, -1, 1},

565  { 4, 
s_7_45
, -1, 1},

566  { 4, 
s_7_46
, -1, 1},

567  { 5, 
s_7_47
, -1, 1},

568  { 5, 
s_7_48
, -1, 1},

569  { 5, 
s_7_49
, -1, 1},

570  { 5, 
s_7_50
, -1, 1},

571  { 5, 
s_7_51
, -1, 1},

572  { 6, 
s_7_52
, -1, 1},

573  { 4, 
s_7_53
, -1, 1},

574  { 4, 
s_7_54
, -1, 1},

575  { 6, 
s_7_55
, 54, 1},

576  { 6, 
s_7_56
, 54, 1},

577  { 4, 
s_7_57
, -1, 1},

578  { 3, 
s_7_58
, -1, 1},

579  { 6, 
s_7_59
, 58, 1},

580  { 5, 
s_7_60
, 58, 1},

581  { 5, 
s_7_61
, 58, 1},

582  { 5, 
s_7_62
, 58, 1},

583  { 6, 
s_7_63
, -1, 1},

584  { 6, 
s_7_64
, -1, 1},

585  { 3, 
s_7_65
, -1, 1},

586  { 6, 
s_7_66
, 65, 1},

587  { 5, 
s_7_67
, 65, 1},

588  { 5, 
s_7_68
, 65, 1},

589  { 5, 
s_7_69
, 65, 1},

590  { 8, 
s_7_70
, -1, 1},

591  { 8, 
s_7_71
, -1, 1},

592  { 6, 
s_7_72
, -1, 1},

593  { 6, 
s_7_73
, -1, 1},

594  { 6, 
s_7_74
, -1, 1},

595  { 3, 
s_7_75
, -1, 1},

596  { 3, 
s_7_76
, -1, 1},

597  { 3, 
s_7_77
, -1, 1},

598  { 3, 
s_7_78
, -1, 1},

599  { 3, 
s_7_79
, -1, 1},

600  { 3, 
s_7_80
, -1, 1},

601  { 2, 
s_7_81
, -1, 1},

602  { 2, 
s_7_82
, -1, 1},

603  { 4, 
s_7_83
, -1, 1},

604  { 4, 
s_7_84
, -1, 1},

605  { 4, 
s_7_85
, -1, 1},

606  { 4, 
s_7_86
, -1, 1}

609 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 128, 8, 2, 1 };

611 cÚ¡ 
	gg_AEIO
[] = { 17, 65, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 128, 8, 2 };

613 cÚ¡ 
	gg_CG
[] = { 17 };

615 cÚ¡ 
symbŞ
 
	gs_0
[] = { 0xC3, 0xA0 };

616 cÚ¡ 
symbŞ
 
	gs_1
[] = { 0xC3, 0xA8 };

617 cÚ¡ 
symbŞ
 
	gs_2
[] = { 0xC3, 0xAC };

618 cÚ¡ 
symbŞ
 
	gs_3
[] = { 0xC3, 0xB2 };

619 cÚ¡ 
symbŞ
 
	gs_4
[] = { 0xC3, 0xB9 };

620 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'q', 'U' };

621 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'U' };

622 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'I' };

623 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'i' };

624 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'u' };

625 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'e' };

626 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'i', 'c' };

627 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'l', 'o', 'g' };

628 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'u' };

629 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'e', 'n', 't', 'e' };

630 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'a', 't' };

631 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'a', 't' };

632 cÚ¡ 
symbŞ
 
	gs_17
[] = { 'i', 'c' };

634 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_´–ude
() {

635 
amÚg_v¬
;

636 { 
c_‹¡1
 = 
c
;

638 
c2
 = 
c
;

639 
b¿
 = 
c
;

640 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 7, 0, 0);

641 ià(!(
amÚg_v¬
)è
Ïb0
;

642 
k‘
 = 
c
;

643 
amÚg_v¬
) {

644 0: 
Ïb0
;

646 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_0
);

647 ià(
»t
 < 0) „et;

651 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_1
);

652 ià(
»t
 < 0) „et;

656 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_2
);

657 ià(
»t
 < 0) „et;

661 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_3
);

662 ià(
»t
 < 0) „et;

666 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_4
);

667 ià(
»t
 < 0) „et;

671 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_5
);

672 ià(
»t
 < 0) „et;

676 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

677 ià(
»t
 < 0è
Ïb0
;

678 
c
 = 
»t
;

683 
Ïb0
:

684 
c
 = 
c2
;

687 
c
 = 
c_‹¡1
;

690 
c3
 = 
c
;

692 
c4
 = 
c
;

693 ià(
	`š_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb2
;

694 
b¿
 = 
c
;

695 { 
c5
 = 
c
;

696 ià(
c
 =ğ
l
 || 
p
[c] !ğ'u'è
Ïb4
;

697 
c
++;

698 
k‘
 = 
c
;

699 ià(
	`š_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb4
;

700 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_6
);

701 ià(
»t
 < 0) „et;

703 
Ïb3
;

704 
Ïb4
:

705 
c
 = 
c5
;

706 ià(
c
 =ğ
l
 || 
p
[c] !ğ'i'è
Ïb2
;

707 
c
++;

708 
k‘
 = 
c
;

709 ià(
	`š_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb2
;

710 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_7
);

711 ià(
»t
 < 0) „et;

714 
Ïb3
:

715 
c
 = 
c4
;

717 
Ïb2
:

718 
c
 = 
c4
;

719 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

720 ià(
»t
 < 0è
Ïb1
;

721 
c
 = 
»t
;

725 
Ïb1
:

726 
c
 = 
c3
;

730 
	}
}

732 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_m¬k_»giÚs
() {

733 
I_pV
 = 
l
;

734 
I_p1
 = 
l
;

735 
I_p2
 = 
l
;

736 { 
c1
 = 
c
;

737 { 
c2
 = 
c
;

738 ià(
	`š_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb2
;

739 { 
c3
 = 
c
;

740 ià(
	`out_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb4
;

741 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 249, 1);

742 ià(
»t
 < 0è
Ïb4
;

743 
c
 +ğ
»t
;

745 
Ïb3
;

746 
Ïb4
:

747 
c
 = 
c3
;

748 ià(
	`š_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb2
;

749 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 249, 1);

750 ià(
»t
 < 0è
Ïb2
;

751 
c
 +ğ
»t
;

754 
Ïb3
:

755 
Ïb1
;

756 
Ïb2
:

757 
c
 = 
c2
;

758 ià(
	`out_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb0
;

759 { 
c4
 = 
c
;

760 ià(
	`out_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb6
;

761 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 249, 1);

762 ià(
»t
 < 0è
Ïb6
;

763 
c
 +ğ
»t
;

765 
Ïb5
;

766 
Ïb6
:

767 
c
 = 
c4
;

768 ià(
	`š_groupšg_U
(
g_v
, 97, 249, 0)è
Ïb0
;

769 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

770 ià(
»t
 < 0è
Ïb0
;

771 
c
 = 
»t
;

774 
Ïb5
:

777 
Ïb1
:

778 
I_pV
 = 
c
;

779 
Ïb0
:

780 
c
 = 
c1
;

782 { 
c5
 = 
c
;

783 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 249, 1);

784 ià(
»t
 < 0è
Ïb7
;

785 
c
 +ğ
»t
;

787 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 249, 1);

788 ià(
»t
 < 0è
Ïb7
;

789 
c
 +ğ
»t
;

791 
I_p1
 = 
c
;

792 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 249, 1);

793 ià(
»t
 < 0è
Ïb7
;

794 
c
 +ğ
»t
;

796 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 249, 1);

797 ià(
»t
 < 0è
Ïb7
;

798 
c
 +ğ
»t
;

800 
I_p2
 = 
c
;

801 
Ïb7
:

802 
c
 = 
c5
;

805 
	}
}

807 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_po¡lude
() {

808 
amÚg_v¬
;

810 
c1
 = 
c
;

811 
b¿
 = 
c
;

812 ià(
c
 >ğ
l
 || (
p
[ø+ 0] !ğ73 &&…[ø+ 0] !ğ85)è
amÚg_v¬
 = 3; 

813 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_1
, 3, 0, 0);

814 ià(!(
amÚg_v¬
)è
Ïb0
;

815 
k‘
 = 
c
;

816 
amÚg_v¬
) {

817 0: 
Ïb0
;

819 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_8
);

820 ià(
»t
 < 0) „et;

824 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_9
);

825 ià(
»t
 < 0) „et;

829 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

830 ià(
»t
 < 0è
Ïb0
;

831 
c
 = 
»t
;

836 
Ïb0
:

837 
c
 = 
c1
;

841 
	}
}

843 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_RV
() {

844 ià(!(
I_pV
 <ğ
c
))  0;

846 
	}
}

848 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_R1
() {

849 ià(!(
I_p1
 <ğ
c
))  0;

851 
	}
}

853 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_R2
() {

854 ià(!(
I_p2
 <ğ
c
))  0;

856 
	}
}

858 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_©ched_´Úoun
() {

859 
amÚg_v¬
;

860 
k‘
 = 
c
;

861 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((33314 >> (p[c - 1] & 0x1f)) & 1))  0;

862 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 37, 0, 0)))  0;

863 
b¿
 = 
c
;

864 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 111 &&…[c - 1] != 114))  0;

865 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 5, 0, 0);

866 ià(!(
amÚg_v¬
))  0;

867 { 
»t
 = 
	`r_RV
();

868 ià(
»t
 <= 0) „et;

870 
amÚg_v¬
) {

873 ià(
	`¦iû_d–
() == -1)  -1;

876 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_10
);

877 ià(
»t
 < 0) „et;

882 
	}
}

884 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_¡ªd¬d_suffix
() {

885 
amÚg_v¬
;

886 
k‘
 = 
c
;

887 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 51, 0, 0);

888 ià(!(
amÚg_v¬
))  0;

889 
b¿
 = 
c
;

890 
amÚg_v¬
) {

893 { 
»t
 = 
	`r_R2
();

894 ià(
»t
 <= 0) „et;

896 ià(
	`¦iû_d–
() == -1)  -1;

899 { 
»t
 = 
	`r_R2
();

900 ià(
»t
 <= 0) „et;

902 ià(
	`¦iû_d–
() == -1)  -1;

903 { 
m1
 = 
l
 - 
c
; ()m1;

904 
k‘
 = 
c
;

905 ià(!(
	`eq_s_b
(2, 
s_11
))è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

906 
b¿
 = 
c
;

907 { 
»t
 = 
	`r_R2
();

908 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

909 ià(
»t
 < 0) „et;

911 ià(
	`¦iû_d–
() == -1)  -1;

912 
Ïb0
:

917 { 
»t
 = 
	`r_R2
();

918 ià(
»t
 <= 0) „et;

920 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_12
);

921 ià(
»t
 < 0) „et;

925 { 
»t
 = 
	`r_R2
();

926 ià(
»t
 <= 0) „et;

928 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_13
);

929 ià(
»t
 < 0) „et;

933 { 
»t
 = 
	`r_R2
();

934 ià(
»t
 <= 0) „et;

936 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_14
);

937 ià(
»t
 < 0) „et;

941 { 
»t
 = 
	`r_RV
();

942 ià(
»t
 <= 0) „et;

944 ià(
	`¦iû_d–
() == -1)  -1;

947 { 
»t
 = 
	`r_R1
();

948 ià(
»t
 <= 0) „et;

950 ià(
	`¦iû_d–
() == -1)  -1;

951 { 
m2
 = 
l
 - 
c
; ()m2;

952 
k‘
 = 
c
;

953 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((4722696 >> (p[ø- 1] & 0x1f)è& 1)è{ c = 
l
 - 
m2
; 
Ïb1
; }

954 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 4, 0, 0);

955 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

956 
b¿
 = 
c
;

957 { 
»t
 = 
	`r_R2
();

958 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

959 ià(
»t
 < 0) „et;

961 ià(
	`¦iû_d–
() == -1)  -1;

962 
amÚg_v¬
) {

963 0: { 
c
 = 
l
 - 
m2
; 
Ïb1
; }

965 
k‘
 = 
c
;

966 ià(!(
	`eq_s_b
(2, 
s_15
))è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

967 
b¿
 = 
c
;

968 { 
»t
 = 
	`r_R2
();

969 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

970 ià(
»t
 < 0) „et;

972 ià(
	`¦iû_d–
() == -1)  -1;

975 
Ïb1
:

980 { 
»t
 = 
	`r_R2
();

981 ià(
»t
 <= 0) „et;

983 ià(
	`¦iû_d–
() == -1)  -1;

984 { 
m3
 = 
l
 - 
c
; ()m3;

985 
k‘
 = 
c
;

986 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((4198408 >> (p[ø- 1] & 0x1f)è& 1)è{ c = 
l
 - 
m3
; 
Ïb2
; }

987 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 3, 0, 0);

988 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m3
; 
Ïb2
; }

989 
b¿
 = 
c
;

990 
amÚg_v¬
) {

991 0: { 
c
 = 
l
 - 
m3
; 
Ïb2
; }

993 { 
»t
 = 
	`r_R2
();

994 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb2
; }

995 ià(
»t
 < 0) „et;

997 ià(
	`¦iû_d–
() == -1)  -1;

1000 
Ïb2
:

1005 { 
»t
 = 
	`r_R2
();

1006 ià(
»t
 <= 0) „et;

1008 ià(
	`¦iû_d–
() == -1)  -1;

1009 { 
m4
 = 
l
 - 
c
; ()m4;

1010 
k‘
 = 
c
;

1011 ià(!(
	`eq_s_b
(2, 
s_16
))è{ 
c
 = 
l
 - 
m4
; 
Ïb3
; }

1012 
b¿
 = 
c
;

1013 { 
»t
 = 
	`r_R2
();

1014 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m4
; 
Ïb3
; }

1015 ià(
»t
 < 0) „et;

1017 ià(
	`¦iû_d–
() == -1)  -1;

1018 
k‘
 = 
c
;

1019 ià(!(
	`eq_s_b
(2, 
s_17
))è{ 
c
 = 
l
 - 
m4
; 
Ïb3
; }

1020 
b¿
 = 
c
;

1021 { 
»t
 = 
	`r_R2
();

1022 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m4
; 
Ïb3
; }

1023 ià(
»t
 < 0) „et;

1025 ià(
	`¦iû_d–
() == -1)  -1;

1026 
Ïb3
:

1032 
	}
}

1034 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_v”b_suffix
() {

1035 
amÚg_v¬
;

1036 { 
m1
 = 
l
 - 
c
; ()m1;

1037 
mlim™1
;

1038 ià(
c
 < 
I_pV
)  0;

1039 
c
 = 
I_pV
;

1040 
mlim™1
 = 
lb
;†b = 
c
;

1041 
c
 = 
l
 - 
m1
;

1042 
k‘
 = 
c
;

1043 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 87, 0, 0);

1044 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

1045 
b¿
 = 
c
;

1046 
amÚg_v¬
) {

1047 0: { 
lb
 = 
mlim™1
;  0; }

1049 ià(
	`¦iû_d–
() == -1)  -1;

1052 
lb
 = 
mlim™1
;

1055 
	}
}

1057 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$r_vow–_suffix
() {

1058 { 
m1
 = 
l
 - 
c
; ()m1;

1059 
k‘
 = 
c
;

1060 ià(
	`š_groupšg_b_U
(
g_AEIO
, 97, 242, 0)è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

1061 
b¿
 = 
c
;

1062 { 
»t
 = 
	`r_RV
();

1063 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

1064 ià(
»t
 < 0) „et;

1066 ià(
	`¦iû_d–
() == -1)  -1;

1067 
k‘
 = 
c
;

1068 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'i'è{ c = 
l
 - 
m1
; 
Ïb0
; }

1069 
c
--;

1070 
b¿
 = 
c
;

1071 { 
»t
 = 
	`r_RV
();

1072 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

1073 ià(
»t
 < 0) „et;

1075 ià(
	`¦iû_d–
() == -1)  -1;

1076 
Ïb0
:

1079 { 
m2
 = 
l
 - 
c
; ()m2;

1080 
k‘
 = 
c
;

1081 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'h'è{ c = 
l
 - 
m2
; 
Ïb1
; }

1082 
c
--;

1083 
b¿
 = 
c
;

1084 ià(
	`š_groupšg_b_U
(
g_CG
, 99, 103, 0)è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

1085 { 
»t
 = 
	`r_RV
();

1086 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

1087 ià(
»t
 < 0) „et;

1089 ià(
	`¦iû_d–
() == -1)  -1;

1090 
Ïb1
:

1094 
	}
}

1096 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$¡em
() {

1097 { 
c1
 = 
c
;

1098 { 
»t
 = 
	`r_´–ude
();

1099 ià(
»t
 =ğ0è
Ïb0
;

1100 ià(
»t
 < 0) „et;

1102 
Ïb0
:

1103 
c
 = 
c1
;

1105 { 
c2
 = 
c
;

1106 { 
»t
 = 
	`r_m¬k_»giÚs
();

1107 ià(
»t
 =ğ0è
Ïb1
;

1108 ià(
»t
 < 0) „et;

1110 
Ïb1
:

1111 
c
 = 
c2
;

1113 
lb
 = 
c
; c = 
l
;

1115 { 
m3
 = 
l
 - 
c
; ()m3;

1116 { 
»t
 = 
	`r_©ched_´Úoun
();

1117 ià(
»t
 =ğ0è
Ïb2
;

1118 ià(
»t
 < 0) „et;

1120 
Ïb2
:

1121 
c
 = 
l
 - 
m3
;

1123 { 
m4
 = 
l
 - 
c
; ()m4;

1124 { 
m5
 = 
l
 - 
c
; ()m5;

1125 { 
»t
 = 
	`r_¡ªd¬d_suffix
();

1126 ià(
»t
 =ğ0è
Ïb5
;

1127 ià(
»t
 < 0) „et;

1129 
Ïb4
;

1130 
Ïb5
:

1131 
c
 = 
l
 - 
m5
;

1132 { 
»t
 = 
	`r_v”b_suffix
();

1133 ià(
»t
 =ğ0è
Ïb3
;

1134 ià(
»t
 < 0) „et;

1137 
Ïb4
:

1138 
Ïb3
:

1139 
c
 = 
l
 - 
m4
;

1141 { 
m6
 = 
l
 - 
c
; ()m6;

1142 { 
»t
 = 
	`r_vow–_suffix
();

1143 ià(
»t
 =ğ0è
Ïb6
;

1144 ià(
»t
 < 0) „et;

1146 
Ïb6
:

1147 
c
 = 
l
 - 
m6
;

1149 
c
 = 
lb
;

1150 { 
c7
 = 
c
;

1151 { 
»t
 = 
	`r_po¡lude
();

1152 ià(
»t
 =ğ0è
Ïb7
;

1153 ià(
»t
 < 0) „et;

1155 
Ïb7
:

1156 
c
 = 
c7
;

1159 
	}
}

1161 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$IÁ”ÇlS‹mIlŸn
()

1162 : 
	`I_p2
(0), 
	`I_p1
(0), 
	$I_pV
(0)

1164 
	}
}

1166 
	gX­Ÿn
::
IÁ”ÇlS‹mIlŸn
::~
	$IÁ”ÇlS‹mIlŸn
()

1168 
	}
}

1171 
X­Ÿn
::
IÁ”ÇlS‹mIlŸn
::
	$g‘_desütiÚ
() const

1174 
	}
}

	@languages/italian.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mIlŸn
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_p2
;

9 
	gI_p1
;

10 
	gI_pV
;

11 
	gpublic
:

12 
r_vow–_suffix
();

13 
r_v”b_suffix
();

14 
r_¡ªd¬d_suffix
();

15 
r_©ched_´Úoun
();

16 
r_R2
();

17 
r_R1
();

18 
r_RV
();

19 
r_m¬k_»giÚs
();

20 
r_po¡lude
();

21 
r_´–ude
();

23 
IÁ”ÇlS‹mIlŸn
();

24 ~
IÁ”ÇlS‹mIlŸn
();

25 
¡em
();

26 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/kraaij_pohlmann.cc

3 
	~<lim™s.h
>

4 
	~"k¿aij_pohlmªn.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_0
 0

	)

9 
	#s_0_1
 3

	)

11 
	#s_0_2
 (
s_0_3
 + 1)

	)

12 
	#s_0_3
 5

	)

14 
	#s_0_4
 (
s_0_5
 + 1)

	)

15 
	#s_0_5
 7

	)

17 
	#s_0_6
 10

	)

19 
	#s_1_0
 13

	)

21 
	#s_1_1
 15

	)

23 
	#s_1_2
 17

	)

25 
	#s_1_3
 22

	)

27 
	#s_1_4
 24

	)

29 
	#s_1_5
 29

	)

31 
	#s_1_6
 31

	)

33 
	#s_1_7
 34

	)

35 
	#s_1_8
 36

	)

37 
	#s_1_9
 38

	)

39 
	#s_1_10
 40

	)

41 
	#s_2_0
 44

	)

43 
	#s_2_1
 48

	)

45 
	#s_2_2
 51

	)

47 
	#s_2_3
 54

	)

49 
	#s_2_4
 58

	)

51 
	#s_2_5
 62

	)

53 
	#s_2_6
 65

	)

55 
	#s_2_7
 69

	)

57 
	#s_2_8
 73

	)

59 
	#s_2_9
 76

	)

61 
	#s_2_10
 80

	)

63 
	#s_2_11
 84

	)

65 
	#s_2_12
 89

	)

67 
	#s_2_13
 92

	)

69 
	#s_3_0
 95

	)

71 
	#s_3_1
 98

	)

73 
	#s_3_2
 
s_3_9


	)

74 
	#s_3_3
 
s_3_10


	)

75 
	#s_3_4
 103

	)

77 
	#s_3_5
 109

	)

79 
	#s_3_6
 113

	)

81 
	#s_3_7
 117

	)

83 
	#s_3_8
 121

	)

85 
	#s_3_9
 125

	)

87 
	#s_3_10
 131

	)

89 
	#s_3_11
 139

	)

91 
	#s_3_12
 145

	)

93 
	#s_3_13
 149

	)

95 
	#s_3_14
 155

	)

97 
	#s_3_15
 163

	)

99 
	#s_4_0
 
s_4_1


	)

100 
	#s_4_1
 169

	)

102 
	#s_4_2
 173

	)

104 
	#s_5_0
 177

	)

106 
	#s_5_1
 179

	)

108 
	#s_5_2
 181

	)

110 
	#s_6_0
 183

	)

112 
	#s_6_1
 185

	)

114 
	#s_6_2
 187

	)

116 
	#s_6_3
 189

	)

118 
	#s_6_4
 191

	)

120 
	#s_6_5
 193

	)

122 
	#s_6_6
 195

	)

124 
	#s_6_7
 197

	)

126 
	#s_6_8
 199

	)

128 
	#s_6_9
 201

	)

130 
	#s_6_10
 203

	)

132 
	#s_6_11
 205

	)

134 
	#s_6_12
 207

	)

136 
	#s_6_13
 209

	)

138 
	#s_6_14
 211

	)

140 
	#s_6_15
 213

	)

142 
	#s_6_16
 (
s_6_17
 + 1)

	)

143 
	#s_6_17
 215

	)

145 
	#s_6_18
 217

	)

147 
	#s_6_19
 219

	)

149 
	#s_6_20
 (
s_6_21
 + 1)

	)

150 
	#s_6_21
 221

	)

152 
	#s_7_0
 223

	)

154 
	#s_7_1
 224

	)

159 cÚ¡ 
amÚg
 
	ga_0
[7] =

161  { 3, 
s_0_0
, -1, 7},

162  { 2, 
s_0_1
, -1, 6},

163  { 1, 
s_0_2
, -1, 2},

164  { 2, 
s_0_3
, 2, 1},

165  { 2, 
s_0_4
, 2, 4},

166  { 3, 
s_0_5
, 4, 3},

167  { 3, 
s_0_6
, 2, 5}

171 cÚ¡ 
amÚg
 
	ga_1
[11] =

173  { 2, 
s_1_0
, -1, 5},

174  { 2, 
s_1_1
, -1, 2},

175  { 5, 
s_1_2
, -1, 4},

176  { 2, 
s_1_3
, -1, 1},

177  { 5, 
s_1_4
, -1, 3},

178  { 2, 
s_1_5
, -1, 9},

179  { 3, 
s_1_6
, -1, 10},

180  { 2, 
s_1_7
, -1, 8},

181  { 2, 
s_1_8
, -1, 7},

182  { 2, 
s_1_9
, -1, 6},

183  { 4, 
s_1_10
, -1, 11}

187 cÚ¡ 
amÚg
 
	ga_2
[14] =

189  { 4, 
s_2_0
, -1, 3},

190  { 3, 
s_2_1
, -1, 7},

191  { 3, 
s_2_2
, -1, 8},

192  { 4, 
s_2_3
, -1, 1},

193  { 4, 
s_2_4
, -1, 5},

194  { 3, 
s_2_5
, -1, 5},

195  { 4, 
s_2_6
, -1, 6},

196  { 4, 
s_2_7
, -1, 5},

197  { 3, 
s_2_8
, -1, 3},

198  { 4, 
s_2_9
, -1, 4},

199  { 4, 
s_2_10
, -1, 3},

200  { 5, 
s_2_11
, -1, 2},

201  { 3, 
s_2_12
, -1, 10},

202  { 3, 
s_2_13
, -1, 9}

206 cÚ¡ 
amÚg
 
	ga_3
[16] =

208  { 3, 
s_3_0
, -1, 10},

209  { 5, 
s_3_1
, -1, 2},

210  { 4, 
s_3_2
, -1, 10},

211  { 6, 
s_3_3
, -1, 9},

212  { 6, 
s_3_4
, -1, 1},

213  { 4, 
s_3_5
, -1, 3},

214  { 4, 
s_3_6
, -1, 5},

215  { 4, 
s_3_7
, -1, 4},

216  { 4, 
s_3_8
, -1, 6},

217  { 6, 
s_3_9
, -1, 10},

218  { 8, 
s_3_10
, -1, 9},

219  { 6, 
s_3_11
, -1, 8},

220  { 4, 
s_3_12
, -1, 7},

221  { 6, 
s_3_13
, -1, 10},

222  { 8, 
s_3_14
, -1, 9},

223  { 6, 
s_3_15
, -1, 8}

227 cÚ¡ 
amÚg
 
	ga_4
[3] =

229  { 2, 
s_4_0
, -1, 1},

230  { 4, 
s_4_1
, -1, 1},

231  { 4, 
s_4_2
, -1, 1}

235 cÚ¡ 
amÚg
 
	ga_5
[3] =

237  { 2, 
s_5_0
, -1, 2},

238  { 2, 
s_5_1
, -1, 1},

239  { 2, 
s_5_2
, -1, 3}

243 cÚ¡ 
amÚg
 
	ga_6
[22] =

245  { 2, 
s_6_0
, -1, 1},

246  { 2, 
s_6_1
, -1, 2},

247  { 2, 
s_6_2
, -1, 3},

248  { 2, 
s_6_3
, -1, 4},

249  { 2, 
s_6_4
, -1, 5},

250  { 2, 
s_6_5
, -1, 6},

251  { 2, 
s_6_6
, -1, 7},

252  { 2, 
s_6_7
, -1, 8},

253  { 2, 
s_6_8
, -1, 9},

254  { 2, 
s_6_9
, -1, 10},

255  { 2, 
s_6_10
, -1, 11},

256  { 2, 
s_6_11
, -1, 12},

257  { 2, 
s_6_12
, -1, 13},

258  { 2, 
s_6_13
, -1, 14},

259  { 2, 
s_6_14
, -1, 15},

260  { 2, 
s_6_15
, -1, 16},

261  { 1, 
s_6_16
, -1, 21},

262  { 2, 
s_6_17
, 16, 17},

263  { 2, 
s_6_18
, -1, 18},

264  { 2, 
s_6_19
, -1, 19},

265  { 1, 
s_6_20
, -1, 22},

266  { 2, 
s_6_21
, 20, 20}

270 cÚ¡ 
amÚg
 
	ga_7
[2] =

272  { 1, 
s_7_0
, -1, 1},

273  { 1, 
s_7_1
, -1, 2}

276 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1 };

278 cÚ¡ 
	gg_v_WX
[] = { 17, 65, 208, 1 };

280 cÚ¡ 
	gg_AOU
[] = { 1, 64, 16 };

282 cÚ¡ 
	gg_AIOU
[] = { 1, 65, 16 };

284 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'i', 'j' };

285 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'i', 'j' };

286 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'i', 'j' };

287 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'i', 'e' };

288 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'a', 'r' };

289 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'e', 'r' };

290 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'e' };

291 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'a', 'u' };

292 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'h', 'e', 'd' };

293 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'h', 'e', 'i', 'd' };

294 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'n', 'd' };

295 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'n', 'd' };

296 cÚ¡ 
symbŞ
 
	gs_12
[] = { '\'', 't' };

297 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'e', 't' };

298 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'r', 'n', 't' };

299 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'r', 'n' };

300 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'i', 'n', 'k' };

301 cÚ¡ 
symbŞ
 
	gs_17
[] = { 'i', 'n', 'g' };

302 cÚ¡ 
symbŞ
 
	gs_18
[] = { 'm', 'p' };

303 cÚ¡ 
symbŞ
 
	gs_19
[] = { 'm' };

304 cÚ¡ 
symbŞ
 
	gs_20
[] = { 'g' };

305 cÚ¡ 
symbŞ
 
	gs_21
[] = { 'l', 'i', 'j', 'k' };

306 cÚ¡ 
symbŞ
 
	gs_22
[] = { 'i', 's', 'c', 'h' };

307 cÚ¡ 
symbŞ
 
	gs_23
[] = { 't' };

308 cÚ¡ 
symbŞ
 
	gs_24
[] = { 's' };

309 cÚ¡ 
symbŞ
 
	gs_25
[] = { 'r' };

310 cÚ¡ 
symbŞ
 
	gs_26
[] = { 'l' };

311 cÚ¡ 
symbŞ
 
	gs_27
[] = { 'e', 'n' };

312 cÚ¡ 
symbŞ
 
	gs_28
[] = { 'i', 'e', 'f' };

313 cÚ¡ 
symbŞ
 
	gs_29
[] = { 'e', 'e', 'r' };

314 cÚ¡ 
symbŞ
 
	gs_30
[] = { 'r' };

315 cÚ¡ 
symbŞ
 
	gs_31
[] = { 'a', 'a', 'r' };

316 cÚ¡ 
symbŞ
 
	gs_32
[] = { 'f' };

317 cÚ¡ 
symbŞ
 
	gs_33
[] = { 'g' };

318 cÚ¡ 
symbŞ
 
	gs_34
[] = { 't' };

319 cÚ¡ 
symbŞ
 
	gs_35
[] = { 'd' };

320 cÚ¡ 
symbŞ
 
	gs_36
[] = { 'i', 'e' };

321 cÚ¡ 
symbŞ
 
	gs_37
[] = { 'e', 'e', 'r' };

322 cÚ¡ 
symbŞ
 
	gs_38
[] = { 'n' };

323 cÚ¡ 
symbŞ
 
	gs_39
[] = { 'l' };

324 cÚ¡ 
symbŞ
 
	gs_40
[] = { 'r' };

325 cÚ¡ 
symbŞ
 
	gs_41
[] = { 't', 'e', 'e', 'r' };

326 cÚ¡ 
symbŞ
 
	gs_42
[] = { 'l', 'i', 'j', 'k' };

327 cÚ¡ 
symbŞ
 
	gs_43
[] = { 'k' };

328 cÚ¡ 
symbŞ
 
	gs_44
[] = { 'f' };

329 cÚ¡ 
symbŞ
 
	gs_45
[] = { 'p' };

330 cÚ¡ 
symbŞ
 
	gs_46
[] = { 'b' };

331 cÚ¡ 
symbŞ
 
	gs_47
[] = { 'c' };

332 cÚ¡ 
symbŞ
 
	gs_48
[] = { 'd' };

333 cÚ¡ 
symbŞ
 
	gs_49
[] = { 'f' };

334 cÚ¡ 
symbŞ
 
	gs_50
[] = { 'g' };

335 cÚ¡ 
symbŞ
 
	gs_51
[] = { 'h' };

336 cÚ¡ 
symbŞ
 
	gs_52
[] = { 'j' };

337 cÚ¡ 
symbŞ
 
	gs_53
[] = { 'k' };

338 cÚ¡ 
symbŞ
 
	gs_54
[] = { 'l' };

339 cÚ¡ 
symbŞ
 
	gs_55
[] = { 'm' };

340 cÚ¡ 
symbŞ
 
	gs_56
[] = { 'n' };

341 cÚ¡ 
symbŞ
 
	gs_57
[] = { 'p' };

342 cÚ¡ 
symbŞ
 
	gs_58
[] = { 'q' };

343 cÚ¡ 
symbŞ
 
	gs_59
[] = { 'r' };

344 cÚ¡ 
symbŞ
 
	gs_60
[] = { 's' };

345 cÚ¡ 
symbŞ
 
	gs_61
[] = { 't' };

346 cÚ¡ 
symbŞ
 
	gs_62
[] = { 'v' };

347 cÚ¡ 
symbŞ
 
	gs_63
[] = { 'w' };

348 cÚ¡ 
symbŞ
 
	gs_64
[] = { 'x' };

349 cÚ¡ 
symbŞ
 
	gs_65
[] = { 'z' };

350 cÚ¡ 
symbŞ
 
	gs_66
[] = { 'f' };

351 cÚ¡ 
symbŞ
 
	gs_67
[] = { 's' };

352 cÚ¡ 
symbŞ
 
	gs_68
[] = { 'g', 'e' };

353 cÚ¡ 
symbŞ
 
	gs_69
[] = { 'g', 'e' };

354 cÚ¡ 
symbŞ
 
	gs_70
[] = { 'i', 'j' };

355 cÚ¡ 
symbŞ
 
	gs_71
[] = { 'i', 'j' };

356 cÚ¡ 
symbŞ
 
	gs_72
[] = { 'Y' };

357 cÚ¡ 
symbŞ
 
	gs_73
[] = { 'Y' };

358 cÚ¡ 
symbŞ
 
	gs_74
[] = { 'y' };

360 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_R1
() {

361 
I_x
 = 
c
;

362 ià(!(
I_x
 >ğ
I_p1
))  0;

364 
	}
}

366 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_R2
() {

367 
I_x
 = 
c
;

368 ià(!(
I_x
 >ğ
I_p2
))  0;

370 
	}
}

372 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_V
() {

373 { 
m_‹¡1
 = 
l
 - 
c
;

374 { 
m2
 = 
l
 - 
c
; ()m2;

375 ià(
	`š_groupšg_b_U
(
g_v
, 97, 121, 0)è
Ïb1
;

376 
Ïb0
;

377 
Ïb1
:

378 
c
 = 
l
 - 
m2
;

379 ià(!(
	`eq_s_b
(2, 
s_0
)))  0;

381 
Ïb0
:

382 
c
 = 
l
 - 
m_‹¡1
;

385 
	}
}

387 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_VX
() {

388 { 
m_‹¡1
 = 
l
 - 
c
;

389 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

390 ià(
»t
 < 0)  0;

391 
c
 = 
»t
;

393 { 
m2
 = 
l
 - 
c
; ()m2;

394 ià(
	`š_groupšg_b_U
(
g_v
, 97, 121, 0)è
Ïb1
;

395 
Ïb0
;

396 
Ïb1
:

397 
c
 = 
l
 - 
m2
;

398 ià(!(
	`eq_s_b
(2, 
s_1
)))  0;

400 
Ïb0
:

401 
c
 = 
l
 - 
m_‹¡1
;

404 
	}
}

406 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_C
() {

407 { 
m_‹¡1
 = 
l
 - 
c
;

408 { 
m2
 = 
l
 - 
c
; ()m2;

409 ià(!(
	`eq_s_b
(2, 
s_2
))è
Ïb0
;

411 
Ïb0
:

412 
c
 = 
l
 - 
m2
;

414 ià(
	`out_groupšg_b_U
(
g_v
, 97, 121, 0))  0;

415 
c
 = 
l
 - 
m_‹¡1
;

418 
	}
}

420 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_Ëngth’_V
() {

421 { 
m1
 = 
l
 - 
c
; ()m1;

422 ià(
	`out_groupšg_b_U
(
g_v_WX
, 97, 121, 0)è
Ïb0
;

423 
k‘
 = 
c
;

424 { 
m2
 = 
l
 - 
c
; ()m2;

425 ià(
	`š_groupšg_b_U
(
g_AOU
, 97, 117, 0)è
Ïb2
;

426 
b¿
 = 
c
;

427 { 
m_‹¡3
 = 
l
 - 
c
;

428 { 
m4
 = 
l
 - 
c
; ()m4;

429 ià(
	`out_groupšg_b_U
(
g_v
, 97, 121, 0)è
Ïb4
;

430 
Ïb3
;

431 
Ïb4
:

432 
c
 = 
l
 - 
m4
;

433 ià(
c
 > 
lb
è
Ïb2
;

435 
Ïb3
:

436 
c
 = 
l
 - 
m_‹¡3
;

438 
Ïb1
;

439 
Ïb2
:

440 
c
 = 
l
 - 
m2
;

441 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb0
;

442 
c
--;

443 
b¿
 = 
c
;

444 { 
m_‹¡5
 = 
l
 - 
c
;

445 { 
m6
 = 
l
 - 
c
; ()m6;

446 ià(
	`out_groupšg_b_U
(
g_v
, 97, 121, 0)è
Ïb6
;

447 
Ïb5
;

448 
Ïb6
:

449 
c
 = 
l
 - 
m6
;

450 ià(
c
 > 
lb
è
Ïb0
;

452 
Ïb5
:

453 { 
m7
 = 
l
 - 
c
; ()m7;

454 ià(
	`š_groupšg_b_U
(
g_AIOU
, 97, 117, 0)è
Ïb7
;

455 
Ïb0
;

456 
Ïb7
:

457 
c
 = 
l
 - 
m7
;

459 { 
m8
 = 
l
 - 
c
; ()m8;

460 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

461 ià(
»t
 < 0è
Ïb8
;

462 
c
 = 
»t
;

464 ià(
	`š_groupšg_b_U
(
g_AIOU
, 97, 117, 0)è
Ïb8
;

465 ià(
	`out_groupšg_b_U
(
g_v
, 97, 121, 0)è
Ïb8
;

466 
Ïb0
;

467 
Ïb8
:

468 
c
 = 
l
 - 
m8
;

470 
c
 = 
l
 - 
m_‹¡5
;

473 
Ïb1
:

474 { 
symbŞ
 * 
»t
 = 
	`¦iû_to
(
S_ch
);

475 ià(
»t
 == 0)  -1;

476 
S_ch
 = 
»t
;

478 { 
§ved_c
 = 
c
;

479 
	`š£¹_v
(
c
, c, 
S_ch
);

480 
c
 = 
§ved_c
;

482 
Ïb0
:

483 
c
 = 
l
 - 
m1
;

486 
	}
}

488 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_S‹p_1
() {

489 
amÚg_v¬
;

490 
k‘
 = 
c
;

491 ià(
c
 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((540704 >> (p[c - 1] & 0x1f)) & 1))  0;

492 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 7, 0, 0);

493 ià(!(
amÚg_v¬
))  0;

494 
b¿
 = 
c
;

495 
amÚg_v¬
) {

498 ià(
	`¦iû_d–
() == -1)  -1;

501 { 
»t
 = 
	`r_R1
();

502 ià(
»t
 <= 0) „et;

504 { 
m1
 = 
l
 - 
c
; ()m1;

505 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ't'è
Ïb0
;

506 
c
--;

507 { 
»t
 = 
	`r_R1
();

508 ià(
»t
 =ğ0è
Ïb0
;

509 ià(
»t
 < 0) „et;

512 
Ïb0
:

513 
c
 = 
l
 - 
m1
;

515 { 
»t
 = 
	`r_C
();

516 ià(
»t
 <= 0) „et;

518 ià(
	`¦iû_d–
() == -1)  -1;

521 { 
»t
 = 
	`r_R1
();

522 ià(
»t
 <= 0) „et;

524 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_3
);

525 ià(
»t
 < 0) „et;

529 { 
m2
 = 
l
 - 
c
; ()m2;

530 ià(!(
	`eq_s_b
(2, 
s_4
))è
Ïb2
;

531 { 
»t
 = 
	`r_R1
();

532 ià(
»t
 =ğ0è
Ïb2
;

533 ià(
»t
 < 0) „et;

535 { 
»t
 = 
	`r_C
();

536 ià(
»t
 =ğ0è
Ïb2
;

537 ià(
»t
 < 0) „et;

539 
b¿
 = 
c
;

540 ià(
	`¦iû_d–
() == -1)  -1;

541 { 
»t
 = 
	`r_Ëngth’_V
();

542 ià(
»t
 =ğ0è
Ïb2
;

543 ià(
»t
 < 0) „et;

545 
Ïb1
;

546 
Ïb2
:

547 
c
 = 
l
 - 
m2
;

548 ià(!(
	`eq_s_b
(2, 
s_5
))è
Ïb3
;

549 { 
»t
 = 
	`r_R1
();

550 ià(
»t
 =ğ0è
Ïb3
;

551 ià(
»t
 < 0) „et;

553 { 
»t
 = 
	`r_C
();

554 ià(
»t
 =ğ0è
Ïb3
;

555 ià(
»t
 < 0) „et;

557 
b¿
 = 
c
;

558 ià(
	`¦iû_d–
() == -1)  -1;

559 
Ïb1
;

560 
Ïb3
:

561 
c
 = 
l
 - 
m2
;

562 { 
»t
 = 
	`r_R1
();

563 ià(
»t
 <= 0) „et;

565 { 
»t
 = 
	`r_C
();

566 ià(
»t
 <= 0) „et;

568 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_6
);

569 ià(
»t
 < 0) „et;

572 
Ïb1
:

575 { 
»t
 = 
	`r_R1
();

576 ià(
»t
 <= 0) „et;

578 { 
»t
 = 
	`r_V
();

579 ià(
»t
 <= 0) „et;

581 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_7
);

582 ià(
»t
 < 0) „et;

586 { 
m3
 = 
l
 - 
c
; ()m3;

587 ià(!(
	`eq_s_b
(3, 
s_8
))è
Ïb5
;

588 { 
»t
 = 
	`r_R1
();

589 ià(
»t
 =ğ0è
Ïb5
;

590 ià(
»t
 < 0) „et;

592 
b¿
 = 
c
;

593 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_9
);

594 ià(
»t
 < 0) „et;

596 
Ïb4
;

597 
Ïb5
:

598 
c
 = 
l
 - 
m3
;

599 ià(!(
	`eq_s_b
(2, 
s_10
))è
Ïb6
;

600 ià(
	`¦iû_d–
() == -1)  -1;

601 
Ïb4
;

602 
Ïb6
:

603 
c
 = 
l
 - 
m3
;

604 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'd'è
Ïb7
;

605 
c
--;

606 { 
»t
 = 
	`r_R1
();

607 ià(
»t
 =ğ0è
Ïb7
;

608 ià(
»t
 < 0) „et;

610 { 
»t
 = 
	`r_C
();

611 ià(
»t
 =ğ0è
Ïb7
;

612 ià(
»t
 < 0) „et;

614 
b¿
 = 
c
;

615 ià(
	`¦iû_d–
() == -1)  -1;

616 
Ïb4
;

617 
Ïb7
:

618 
c
 = 
l
 - 
m3
;

619 { 
m4
 = 
l
 - 
c
; ()m4;

620 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'i'è
Ïb10
;

621 
c
--;

622 
Ïb9
;

623 
Ïb10
:

624 
c
 = 
l
 - 
m4
;

625 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'j'è
Ïb8
;

626 
c
--;

628 
Ïb9
:

629 { 
»t
 = 
	`r_V
();

630 ià(
»t
 =ğ0è
Ïb8
;

631 ià(
»t
 < 0) „et;

633 ià(
	`¦iû_d–
() == -1)  -1;

634 
Ïb4
;

635 
Ïb8
:

636 
c
 = 
l
 - 
m3
;

637 { 
»t
 = 
	`r_R1
();

638 ià(
»t
 <= 0) „et;

640 { 
»t
 = 
	`r_C
();

641 ià(
»t
 <= 0) „et;

643 ià(
	`¦iû_d–
() == -1)  -1;

644 { 
»t
 = 
	`r_Ëngth’_V
();

645 ià(
»t
 <= 0) „et;

648 
Ïb4
:

651 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_11
);

652 ià(
»t
 < 0) „et;

657 
	}
}

659 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_S‹p_2
() {

660 
amÚg_v¬
;

661 
k‘
 = 
c
;

662 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] != 101)  0;

663 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 11, 0, 0);

664 ià(!(
amÚg_v¬
))  0;

665 
b¿
 = 
c
;

666 
amÚg_v¬
) {

669 { 
m1
 = 
l
 - 
c
; ()m1;

670 ià(!(
	`eq_s_b
(2, 
s_12
))è
Ïb1
;

671 
b¿
 = 
c
;

672 ià(
	`¦iû_d–
() == -1)  -1;

673 
Ïb0
;

674 
Ïb1
:

675 
c
 = 
l
 - 
m1
;

676 ià(!(
	`eq_s_b
(2, 
s_13
))è
Ïb2
;

677 
b¿
 = 
c
;

678 { 
»t
 = 
	`r_R1
();

679 ià(
»t
 =ğ0è
Ïb2
;

680 ià(
»t
 < 0) „et;

682 { 
»t
 = 
	`r_C
();

683 ià(
»t
 =ğ0è
Ïb2
;

684 ià(
»t
 < 0) „et;

686 ià(
	`¦iû_d–
() == -1)  -1;

687 
Ïb0
;

688 
Ïb2
:

689 
c
 = 
l
 - 
m1
;

690 ià(!(
	`eq_s_b
(3, 
s_14
))è
Ïb3
;

691 
b¿
 = 
c
;

692 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_15
);

693 ià(
»t
 < 0) „et;

695 
Ïb0
;

696 
Ïb3
:

697 
c
 = 
l
 - 
m1
;

698 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ't'è
Ïb4
;

699 
c
--;

700 
b¿
 = 
c
;

701 { 
»t
 = 
	`r_R1
();

702 ià(
»t
 =ğ0è
Ïb4
;

703 ià(
»t
 < 0) „et;

705 { 
»t
 = 
	`r_VX
();

706 ià(
»t
 =ğ0è
Ïb4
;

707 ià(
»t
 < 0) „et;

709 ià(
	`¦iû_d–
() == -1)  -1;

710 
Ïb0
;

711 
Ïb4
:

712 
c
 = 
l
 - 
m1
;

713 ià(!(
	`eq_s_b
(3, 
s_16
))è
Ïb5
;

714 
b¿
 = 
c
;

715 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_17
);

716 ià(
»t
 < 0) „et;

718 
Ïb0
;

719 
Ïb5
:

720 
c
 = 
l
 - 
m1
;

721 ià(!(
	`eq_s_b
(2, 
s_18
))è
Ïb6
;

722 
b¿
 = 
c
;

723 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_19
);

724 ià(
»t
 < 0) „et;

726 
Ïb0
;

727 
Ïb6
:

728 
c
 = 
l
 - 
m1
;

729 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ39è
Ïb7
;

730 
c
--;

731 
b¿
 = 
c
;

732 { 
»t
 = 
	`r_R1
();

733 ià(
»t
 =ğ0è
Ïb7
;

734 ià(
»t
 < 0) „et;

736 ià(
	`¦iû_d–
() == -1)  -1;

737 
Ïb0
;

738 
Ïb7
:

739 
c
 = 
l
 - 
m1
;

740 
b¿
 = 
c
;

741 { 
»t
 = 
	`r_R1
();

742 ià(
»t
 <= 0) „et;

744 { 
»t
 = 
	`r_C
();

745 ià(
»t
 <= 0) „et;

747 ià(
	`¦iû_d–
() == -1)  -1;

749 
Ïb0
:

752 { 
»t
 = 
	`r_R1
();

753 ià(
»t
 <= 0) „et;

755 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_20
);

756 ià(
»t
 < 0) „et;

760 { 
»t
 = 
	`r_R1
();

761 ià(
»t
 <= 0) „et;

763 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_21
);

764 ià(
»t
 < 0) „et;

768 { 
»t
 = 
	`r_R1
();

769 ià(
»t
 <= 0) „et;

771 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_22
);

772 ià(
»t
 < 0) „et;

776 { 
»t
 = 
	`r_R1
();

777 ià(
»t
 <= 0) „et;

779 { 
»t
 = 
	`r_C
();

780 ià(
»t
 <= 0) „et;

782 ià(
	`¦iû_d–
() == -1)  -1;

785 { 
»t
 = 
	`r_R1
();

786 ià(
»t
 <= 0) „et;

788 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_23
);

789 ià(
»t
 < 0) „et;

793 { 
»t
 = 
	`r_R1
();

794 ià(
»t
 <= 0) „et;

796 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_24
);

797 ià(
»t
 < 0) „et;

801 { 
»t
 = 
	`r_R1
();

802 ià(
»t
 <= 0) „et;

804 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_25
);

805 ià(
»t
 < 0) „et;

809 { 
»t
 = 
	`r_R1
();

810 ià(
»t
 <= 0) „et;

812 ià(
	`¦iû_d–
() == -1)  -1;

813 
	`š£¹_s
(
c
, c, 1, 
s_26
);

814 { 
»t
 = 
	`r_Ëngth’_V
();

815 ià(
»t
 <= 0) „et;

819 { 
»t
 = 
	`r_R1
();

820 ià(
»t
 <= 0) „et;

822 { 
»t
 = 
	`r_C
();

823 ià(
»t
 <= 0) „et;

825 ià(
	`¦iû_d–
() == -1)  -1;

826 
	`š£¹_s
(
c
, c, 2, 
s_27
);

827 { 
»t
 = 
	`r_Ëngth’_V
();

828 ià(
»t
 <= 0) „et;

832 { 
»t
 = 
	`r_R1
();

833 ià(
»t
 <= 0) „et;

835 { 
»t
 = 
	`r_C
();

836 ià(
»t
 <= 0) „et;

838 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_28
);

839 ià(
»t
 < 0) „et;

844 
	}
}

846 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_S‹p_3
() {

847 
amÚg_v¬
;

848 
k‘
 = 
c
;

849 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((1316016 >> (p[c - 1] & 0x1f)) & 1))  0;

850 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 14, 0, 0);

851 ià(!(
amÚg_v¬
))  0;

852 
b¿
 = 
c
;

853 
amÚg_v¬
) {

856 { 
»t
 = 
	`r_R1
();

857 ià(
»t
 <= 0) „et;

859 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_29
);

860 ià(
»t
 < 0) „et;

864 { 
»t
 = 
	`r_R1
();

865 ià(
»t
 <= 0) „et;

867 ià(
	`¦iû_d–
() == -1)  -1;

868 { 
»t
 = 
	`r_Ëngth’_V
();

869 ià(
»t
 <= 0) „et;

873 { 
»t
 = 
	`r_R1
();

874 ià(
»t
 <= 0) „et;

876 ià(
	`¦iû_d–
() == -1)  -1;

879 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_30
);

880 ià(
»t
 < 0) „et;

884 { 
»t
 = 
	`r_R1
();

885 ià(
»t
 <= 0) „et;

887 ià(
	`¦iû_d–
() == -1)  -1;

888 { 
»t
 = 
	`r_Ëngth’_V
();

889 ià(
»t
 <= 0) „et;

893 { 
»t
 = 
	`r_R1
();

894 ià(
»t
 <= 0) „et;

896 { 
»t
 = 
	`r_C
();

897 ià(
»t
 <= 0) „et;

899 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_31
);

900 ià(
»t
 < 0) „et;

904 { 
»t
 = 
	`r_R2
();

905 ià(
»t
 <= 0) „et;

907 ià(
	`¦iû_d–
() == -1)  -1;

908 
	`š£¹_s
(
c
, c, 1, 
s_32
);

909 { 
»t
 = 
	`r_Ëngth’_V
();

910 ià(
»t
 <= 0) „et;

914 { 
»t
 = 
	`r_R2
();

915 ià(
»t
 <= 0) „et;

917 ià(
	`¦iû_d–
() == -1)  -1;

918 
	`š£¹_s
(
c
, c, 1, 
s_33
);

919 { 
»t
 = 
	`r_Ëngth’_V
();

920 ià(
»t
 <= 0) „et;

924 { 
»t
 = 
	`r_R1
();

925 ià(
»t
 <= 0) „et;

927 { 
»t
 = 
	`r_C
();

928 ià(
»t
 <= 0) „et;

930 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_34
);

931 ià(
»t
 < 0) „et;

935 { 
»t
 = 
	`r_R1
();

936 ià(
»t
 <= 0) „et;

938 { 
»t
 = 
	`r_C
();

939 ià(
»t
 <= 0) „et;

941 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_35
);

942 ià(
»t
 < 0) „et;

947 
	}
}

949 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_S‹p_4
() {

950 
amÚg_v¬
;

951 { 
m1
 = 
l
 - 
c
; ()m1;

952 
k‘
 = 
c
;

953 ià(
c
 - 2 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1315024 >> (p[ø- 1] & 0x1f)è& 1)è
Ïb1
;

954 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 16, 0, 0);

955 ià(!(
amÚg_v¬
)è
Ïb1
;

956 
b¿
 = 
c
;

957 
amÚg_v¬
) {

958 0: 
Ïb1
;

960 { 
»t
 = 
	`r_R1
();

961 ià(
»t
 =ğ0è
Ïb1
;

962 ià(
»t
 < 0) „et;

964 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_36
);

965 ià(
»t
 < 0) „et;

969 { 
»t
 = 
	`r_R1
();

970 ià(
»t
 =ğ0è
Ïb1
;

971 ià(
»t
 < 0) „et;

973 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_37
);

974 ià(
»t
 < 0) „et;

978 { 
»t
 = 
	`r_R1
();

979 ià(
»t
 =ğ0è
Ïb1
;

980 ià(
»t
 < 0) „et;

982 ià(
	`¦iû_d–
() == -1)  -1;

985 { 
»t
 = 
	`r_R1
();

986 ià(
»t
 =ğ0è
Ïb1
;

987 ià(
»t
 < 0) „et;

989 { 
»t
 = 
	`r_V
();

990 ià(
»t
 =ğ0è
Ïb1
;

991 ià(
»t
 < 0) „et;

993 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_38
);

994 ià(
»t
 < 0) „et;

998 { 
»t
 = 
	`r_R1
();

999 ià(
»t
 =ğ0è
Ïb1
;

1000 ià(
»t
 < 0) „et;

1002 { 
»t
 = 
	`r_V
();

1003 ià(
»t
 =ğ0è
Ïb1
;

1004 ià(
»t
 < 0) „et;

1006 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_39
);

1007 ià(
»t
 < 0) „et;

1011 { 
»t
 = 
	`r_R1
();

1012 ià(
»t
 =ğ0è
Ïb1
;

1013 ià(
»t
 < 0) „et;

1015 { 
»t
 = 
	`r_V
();

1016 ià(
»t
 =ğ0è
Ïb1
;

1017 ià(
»t
 < 0) „et;

1019 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_40
);

1020 ià(
»t
 < 0) „et;

1024 { 
»t
 = 
	`r_R1
();

1025 ià(
»t
 =ğ0è
Ïb1
;

1026 ià(
»t
 < 0) „et;

1028 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_41
);

1029 ià(
»t
 < 0) „et;

1033 { 
»t
 = 
	`r_R1
();

1034 ià(
»t
 =ğ0è
Ïb1
;

1035 ià(
»t
 < 0) „et;

1037 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_42
);

1038 ià(
»t
 < 0) „et;

1042 { 
»t
 = 
	`r_R1
();

1043 ià(
»t
 =ğ0è
Ïb1
;

1044 ià(
»t
 < 0) „et;

1046 ià(
	`¦iû_d–
() == -1)  -1;

1049 { 
»t
 = 
	`r_R1
();

1050 ià(
»t
 =ğ0è
Ïb1
;

1051 ià(
»t
 < 0) „et;

1053 { 
»t
 = 
	`r_C
();

1054 ià(
»t
 =ğ0è
Ïb1
;

1055 ià(
»t
 < 0) „et;

1057 ià(
	`¦iû_d–
() == -1)  -1;

1058 { 
»t
 = 
	`r_Ëngth’_V
();

1059 ià(
»t
 =ğ0è
Ïb1
;

1060 ià(
»t
 < 0) „et;

1064 
Ïb0
;

1065 
Ïb1
:

1066 
c
 = 
l
 - 
m1
;

1067 
k‘
 = 
c
;

1068 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((1310848 >> (p[c - 1] & 0x1f)) & 1))  0;

1069 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 3, 0, 0);

1070 ià(!(
amÚg_v¬
))  0;

1071 
b¿
 = 
c
;

1072 
amÚg_v¬
) {

1075 { 
»t
 = 
	`r_R1
();

1076 ià(
»t
 <= 0) „et;

1078 { 
»t
 = 
	`r_C
();

1079 ià(
»t
 <= 0) „et;

1081 ià(
	`¦iû_d–
() == -1)  -1;

1082 { 
»t
 = 
	`r_Ëngth’_V
();

1083 ià(
»t
 <= 0) „et;

1088 
Ïb0
:

1090 
	}
}

1092 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_S‹p_7
() {

1093 
amÚg_v¬
;

1094 
k‘
 = 
c
;

1095 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] != 116)  0;

1096 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 3, 0, 0);

1097 ià(!(
amÚg_v¬
))  0;

1098 
b¿
 = 
c
;

1099 
amÚg_v¬
) {

1102 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_43
);

1103 ià(
»t
 < 0) „et;

1107 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_44
);

1108 ià(
»t
 < 0) „et;

1112 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_45
);

1113 ià(
»t
 < 0) „et;

1118 
	}
}

1120 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_S‹p_6
() {

1121 
amÚg_v¬
;

1122 
k‘
 = 
c
;

1123 ià(
c
 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((98532828 >> (p[c - 1] & 0x1f)) & 1))  0;

1124 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 22, 0, 0);

1125 ià(!(
amÚg_v¬
))  0;

1126 
b¿
 = 
c
;

1127 
amÚg_v¬
) {

1130 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_46
);

1131 ià(
»t
 < 0) „et;

1135 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_47
);

1136 ià(
»t
 < 0) „et;

1140 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_48
);

1141 ià(
»t
 < 0) „et;

1145 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_49
);

1146 ià(
»t
 < 0) „et;

1150 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_50
);

1151 ià(
»t
 < 0) „et;

1155 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_51
);

1156 ià(
»t
 < 0) „et;

1160 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_52
);

1161 ià(
»t
 < 0) „et;

1165 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_53
);

1166 ià(
»t
 < 0) „et;

1170 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_54
);

1171 ià(
»t
 < 0) „et;

1175 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_55
);

1176 ià(
»t
 < 0) „et;

1180 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_56
);

1181 ià(
»t
 < 0) „et;

1185 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_57
);

1186 ià(
»t
 < 0) „et;

1190 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_58
);

1191 ià(
»t
 < 0) „et;

1195 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_59
);

1196 ià(
»t
 < 0) „et;

1200 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_60
);

1201 ià(
»t
 < 0) „et;

1205 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_61
);

1206 ià(
»t
 < 0) „et;

1210 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_62
);

1211 ià(
»t
 < 0) „et;

1215 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_63
);

1216 ià(
»t
 < 0) „et;

1220 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_64
);

1221 ià(
»t
 < 0) „et;

1225 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_65
);

1226 ià(
»t
 < 0) „et;

1230 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_66
);

1231 ià(
»t
 < 0) „et;

1235 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_67
);

1236 ià(
»t
 < 0) „et;

1241 
	}
}

1243 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_S‹p_1c
() {

1244 
amÚg_v¬
;

1245 
k‘
 = 
c
;

1246 ià(
c
 <ğ
lb
 || (
p
[c - 1] != 100 &&…[c - 1] != 116))  0;

1247 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 2, 0, 0);

1248 ià(!(
amÚg_v¬
))  0;

1249 
b¿
 = 
c
;

1250 { 
»t
 = 
	`r_R1
();

1251 ià(
»t
 <= 0) „et;

1253 { 
»t
 = 
	`r_C
();

1254 ià(
»t
 <= 0) „et;

1256 
amÚg_v¬
) {

1259 { 
m1
 = 
l
 - 
c
; ()m1;

1260 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'n'è
Ïb0
;

1261 
c
--;

1262 { 
»t
 = 
	`r_R1
();

1263 ià(
»t
 =ğ0è
Ïb0
;

1264 ià(
»t
 < 0) „et;

1267 
Ïb0
:

1268 
c
 = 
l
 - 
m1
;

1270 ià(
	`¦iû_d–
() == -1)  -1;

1273 { 
m2
 = 
l
 - 
c
; ()m2;

1274 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'h'è
Ïb1
;

1275 
c
--;

1276 { 
»t
 = 
	`r_R1
();

1277 ià(
»t
 =ğ0è
Ïb1
;

1278 ià(
»t
 < 0) „et;

1281 
Ïb1
:

1282 
c
 = 
l
 - 
m2
;

1284 ià(
	`¦iû_d–
() == -1)  -1;

1288 
	}
}

1290 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_Lo£_´efix
() {

1291 
b¿
 = 
c
;

1292 ià(!(
	`eq_s
(2, 
s_68
)))  0;

1293 
k‘
 = 
c
;

1294 { 
c_‹¡1
 = 
c
;

1295 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 3);

1296 ià(
»t
 < 0)  0;

1297 
c
 = 
»t
;

1299 
c
 = 
c_‹¡1
;

1301 ià(
	`out_groupšg_U
(
g_v
, 97, 121, 1) < 0)  0;

1302 ià(
	`š_groupšg_U
(
g_v
, 97, 121, 1) < 0)  0;

1303 
B_GE_»moved
 = 1;

1304 ià(
	`¦iû_d–
() == -1)  -1;

1306 
	}
}

1308 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_Lo£_šfix
() {

1309 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

1310 ià(
»t
 < 0)  0;

1311 
c
 = 
»t
;

1314 
b¿
 = 
c
;

1315 ià(!(
	`eq_s
(2, 
s_69
))è
Ïb0
;

1316 
k‘
 = 
c
;

1318 
Ïb0
:

1319 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

1320 ià(
»t
 < 0)  0;

1321 
c
 = 
»t
;

1324 { 
c_‹¡1
 = 
c
;

1325 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 3);

1326 ià(
»t
 < 0)  0;

1327 
c
 = 
»t
;

1329 
c
 = 
c_‹¡1
;

1331 ià(
	`out_groupšg_U
(
g_v
, 97, 121, 1) < 0)  0;

1332 ià(
	`š_groupšg_U
(
g_v
, 97, 121, 1) < 0)  0;

1333 
B_GE_»moved
 = 1;

1334 ià(
	`¦iû_d–
() == -1)  -1;

1336 
	}
}

1338 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$r_m—su»
() {

1339 { 
c1
 = 
c
;

1340 
c
 = 
l
;

1341 
I_p1
 = 
c
;

1342 
I_p2
 = 
c
;

1343 
c
 = 
c1
;

1345 { 
c2
 = 
c
;

1347 ià(
	`out_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb2
;

1349 
Ïb2
:

1352 { 
i
 = 1;

1354 
c3
 = 
c
;

1355 { 
c4
 = 
c
;

1356 ià(!(
	`eq_s
(2, 
s_70
))è
Ïb5
;

1357 
Ïb4
;

1358 
Ïb5
:

1359 
c
 = 
c4
;

1360 ià(
	`š_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb3
;

1362 
Ïb4
:

1363 
i
--;

1365 
Ïb3
:

1366 
c
 = 
c3
;

1369 ià(
i
 > 0è
Ïb1
;

1371 ià(
	`out_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb1
;

1372 
I_p1
 = 
c
;

1374 ià(
	`out_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb6
;

1376 
Ïb6
:

1379 { 
i
 = 1;

1381 
c5
 = 
c
;

1382 { 
c6
 = 
c
;

1383 ià(!(
	`eq_s
(2, 
s_71
))è
Ïb9
;

1384 
Ïb8
;

1385 
Ïb9
:

1386 
c
 = 
c6
;

1387 ià(
	`š_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb7
;

1389 
Ïb8
:

1390 
i
--;

1392 
Ïb7
:

1393 
c
 = 
c5
;

1396 ià(
i
 > 0è
Ïb1
;

1398 ià(
	`out_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb1
;

1399 
I_p2
 = 
c
;

1400 
Ïb1
:

1401 
c
 = 
c2
;

1404 
	}
}

1406 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$¡em
() {

1407 
B_Y_found
 = 0;

1408 
B_¡emmed
 = 0;

1409 { 
c1
 = 
c
;

1410 
b¿
 = 
c
;

1411 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb0
;

1412 
c
++;

1413 
k‘
 = 
c
;

1414 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_72
);

1415 ià(
»t
 < 0) „et;

1417 
B_Y_found
 = 1;

1418 
Ïb0
:

1419 
c
 = 
c1
;

1421 { 
c2
 = 
c
;

1423 
c3
 = 
c
;

1425 
c4
 = 
c
;

1426 ià(
	`š_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb3
;

1427 
b¿
 = 
c
;

1428 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb3
;

1429 
c
++;

1430 
k‘
 = 
c
;

1431 
c
 = 
c4
;

1433 
Ïb3
:

1434 
c
 = 
c4
;

1435 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

1436 ià(
»t
 < 0è
Ïb2
;

1437 
c
 = 
»t
;

1440 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_73
);

1441 ià(
»t
 < 0) „et;

1443 
B_Y_found
 = 1;

1445 
Ïb2
:

1446 
c
 = 
c3
;

1449 
c
 = 
c2
;

1451 { 
»t
 = 
	`r_m—su»
();

1452 ià(
»t
 <= 0) „et;

1454 
lb
 = 
c
; c = 
l
;

1456 { 
m5
 = 
l
 - 
c
; ()m5;

1457 { 
»t
 = 
	`r_S‹p_1
();

1458 ià(
»t
 =ğ0è
Ïb4
;

1459 ià(
»t
 < 0) „et;

1461 
B_¡emmed
 = 1;

1462 
Ïb4
:

1463 
c
 = 
l
 - 
m5
;

1465 { 
m6
 = 
l
 - 
c
; ()m6;

1466 { 
»t
 = 
	`r_S‹p_2
();

1467 ià(
»t
 =ğ0è
Ïb5
;

1468 ià(
»t
 < 0) „et;

1470 
B_¡emmed
 = 1;

1471 
Ïb5
:

1472 
c
 = 
l
 - 
m6
;

1474 { 
m7
 = 
l
 - 
c
; ()m7;

1475 { 
»t
 = 
	`r_S‹p_3
();

1476 ià(
»t
 =ğ0è
Ïb6
;

1477 ià(
»t
 < 0) „et;

1479 
B_¡emmed
 = 1;

1480 
Ïb6
:

1481 
c
 = 
l
 - 
m7
;

1483 { 
m8
 = 
l
 - 
c
; ()m8;

1484 { 
»t
 = 
	`r_S‹p_4
();

1485 ià(
»t
 =ğ0è
Ïb7
;

1486 ià(
»t
 < 0) „et;

1488 
B_¡emmed
 = 1;

1489 
Ïb7
:

1490 
c
 = 
l
 - 
m8
;

1492 
c
 = 
lb
;

1493 
B_GE_»moved
 = 0;

1494 { 
c9
 = 
c
;

1495 { 
c10
 = 
c
;

1496 { 
»t
 = 
	`r_Lo£_´efix
();

1497 ià(
»t
 =ğ0è
Ïb8
;

1498 ià(
»t
 < 0) „et;

1500 
c
 = 
c10
;

1501 { 
»t
 = 
	`r_m—su»
();

1502 ià(
»t
 =ğ0è
Ïb8
;

1503 ià(
»t
 < 0) „et;

1506 
Ïb8
:

1507 
c
 = 
c9
;

1509 
lb
 = 
c
; c = 
l
;

1511 { 
m11
 = 
l
 - 
c
; ()m11;

1512 ià(!(
B_GE_»moved
)è
Ïb9
;

1513 { 
»t
 = 
	`r_S‹p_1c
();

1514 ià(
»t
 =ğ0è
Ïb9
;

1515 ià(
»t
 < 0) „et;

1517 
Ïb9
:

1518 
c
 = 
l
 - 
m11
;

1520 
c
 = 
lb
;

1521 
B_GE_»moved
 = 0;

1522 { 
c12
 = 
c
;

1523 { 
c13
 = 
c
;

1524 { 
»t
 = 
	`r_Lo£_šfix
();

1525 ià(
»t
 =ğ0è
Ïb10
;

1526 ià(
»t
 < 0) „et;

1528 
c
 = 
c13
;

1529 { 
»t
 = 
	`r_m—su»
();

1530 ià(
»t
 =ğ0è
Ïb10
;

1531 ià(
»t
 < 0) „et;

1534 
Ïb10
:

1535 
c
 = 
c12
;

1537 
lb
 = 
c
; c = 
l
;

1539 { 
m14
 = 
l
 - 
c
; ()m14;

1540 ià(!(
B_GE_»moved
)è
Ïb11
;

1541 { 
»t
 = 
	`r_S‹p_1c
();

1542 ià(
»t
 =ğ0è
Ïb11
;

1543 ià(
»t
 < 0) „et;

1545 
Ïb11
:

1546 
c
 = 
l
 - 
m14
;

1548 
c
 = 
lb
;

1549 
lb
 = 
c
; c = 
l
;

1551 { 
m15
 = 
l
 - 
c
; ()m15;

1552 { 
»t
 = 
	`r_S‹p_7
();

1553 ià(
»t
 =ğ0è
Ïb12
;

1554 ià(
»t
 < 0) „et;

1556 
B_¡emmed
 = 1;

1557 
Ïb12
:

1558 
c
 = 
l
 - 
m15
;

1560 { 
m16
 = 
l
 - 
c
; ()m16;

1561 { 
m17
 = 
l
 - 
c
; ()m17;

1562 ià(!(
B_¡emmed
)è
Ïb15
;

1563 
Ïb14
;

1564 
Ïb15
:

1565 
c
 = 
l
 - 
m17
;

1566 ià(!(
B_GE_»moved
)è
Ïb13
;

1568 
Ïb14
:

1569 { 
»t
 = 
	`r_S‹p_6
();

1570 ià(
»t
 =ğ0è
Ïb13
;

1571 ià(
»t
 < 0) „et;

1573 
Ïb13
:

1574 
c
 = 
l
 - 
m16
;

1576 
c
 = 
lb
;

1577 { 
c18
 = 
c
;

1578 ià(!(
B_Y_found
)è
Ïb16
;

1580 
c19
 = 
c
;

1582 
c20
 = 
c
;

1583 
b¿
 = 
c
;

1584 ià(
c
 =ğ
l
 || 
p
[c] !ğ'Y'è
Ïb18
;

1585 
c
++;

1586 
k‘
 = 
c
;

1587 
c
 = 
c20
;

1589 
Ïb18
:

1590 
c
 = 
c20
;

1591 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

1592 ià(
»t
 < 0è
Ïb17
;

1593 
c
 = 
»t
;

1596 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_74
);

1597 ià(
»t
 < 0) „et;

1600 
Ïb17
:

1601 
c
 = 
c19
;

1604 
Ïb16
:

1605 
c
 = 
c18
;

1608 
	}
}

1610 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$IÁ”ÇlS‹mK¿aij_pohlmªn
()

1611 : 
	`B_GE_»moved
(0), 
	`B_¡emmed
(0), 
	`B_Y_found
(0), 
	`I_p2
(0), 
	`I_p1
(0), 
	`I_x
(0), 
	$S_ch
(0)

1613 
S_ch
 = 
	`ü—‹_s
();

1614 
	}
}

1616 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::~
	$IÁ”ÇlS‹mK¿aij_pohlmªn
()

1618 
	`lo£_s
(
S_ch
);

1619 
	}
}

1622 
	gX­Ÿn
::
IÁ”ÇlS‹mK¿aij_pohlmªn
::
	$g‘_desütiÚ
() const

1625 
	}
}

	@languages/kraaij_pohlmann.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mK¿aij_pohlmªn
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
B_GE_»moved
;

9 
	gB_¡emmed
;

10 
	gB_Y_found
;

11 
	gI_p2
;

12 
	gI_p1
;

13 
	gI_x
;

14 
symbŞ
 * 
	gS_ch
;

15 
	gpublic
:

16 
r_m—su»
();

17 
r_Lo£_šfix
();

18 
r_Lo£_´efix
();

19 
r_S‹p_1c
();

20 
r_S‹p_6
();

21 
r_S‹p_7
();

22 
r_S‹p_4
();

23 
r_S‹p_3
();

24 
r_S‹p_2
();

25 
r_S‹p_1
();

26 
r_Ëngth’_V
();

27 
r_VX
();

28 
r_V
();

29 
r_C
();

30 
r_R2
();

31 
r_R1
();

33 
IÁ”ÇlS‹mK¿aij_pohlmªn
();

34 ~
IÁ”ÇlS‹mK¿aij_pohlmªn
();

35 
¡em
();

36 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/lovins.cc

3 
	~<lim™s.h
>

4 
	~"lovšs.h
"

6 
Œ_CC
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

7  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_CC
();

10 
Œ_BB
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

11  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_BB
();

14 
Œ_AA
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

15  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_AA
();

18 
Œ_Z
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

19  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_Z
();

22 
Œ_Y
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

23  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_Y
();

26 
Œ_X
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

27  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_X
();

30 
Œ_W
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

31  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_W
();

34 
Œ_V
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

35  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_V
();

38 
Œ_U
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

39  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_U
();

42 
Œ_T
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

43  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_T
();

46 
Œ_S
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

47  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_S
();

50 
Œ_R
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

51  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_R
();

54 
Œ_Q
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

55  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_Q
();

58 
Œ_P
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

59  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_P
();

62 
Œ_O
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

63  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_O
();

66 
Œ_N
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

67  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_N
();

70 
Œ_M
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

71  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_M
();

74 
Œ_L
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

75  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_L
();

78 
Œ_K
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

79  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_K
();

82 
Œ_J
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

83  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_J
();

86 
Œ_I
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

87  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_I
();

90 
Œ_H
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

91  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_H
();

94 
Œ_G
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

95  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_G
();

98 
Œ_F
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

99  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_F
();

102 
Œ_E
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

103  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_E
();

106 
Œ_D
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

107  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_D
();

110 
Œ_C
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

111  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_C
();

114 
Œ_B
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

115  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_B
();

118 
Œ_A
(
X­Ÿn
::
S‹m
::
IÁ”Çl
 * 
this_±r
) {

119  (
¡©ic_ÿ¡
<
X­Ÿn
::
IÁ”ÇlS‹mLovšs
 *>(
this_±r
))->
r_A
();

122 cÚ¡ 
amÚg_funùiÚ
 
	gaf
[29] =

124  
Œ_CC
,

125  
Œ_BB
,

126  
Œ_AA
,

127  
Œ_Z
,

128  
Œ_Y
,

129  
Œ_X
,

130  
Œ_W
,

131  
Œ_V
,

132  
Œ_U
,

133  
Œ_T
,

134  
Œ_S
,

135  
Œ_R
,

136  
Œ_Q
,

137  
Œ_P
,

138  
Œ_O
,

139  
Œ_N
,

140  
Œ_M
,

141  
Œ_L
,

142  
Œ_K
,

143  
Œ_J
,

144  
Œ_I
,

145  
Œ_H
,

146  
Œ_G
,

147  
Œ_F
,

148  
Œ_E
,

149  
Œ_D
,

150  
Œ_C
,

151  
Œ_B
,

152  
Œ_A


155 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

156 
	#s_0_0
 0

	)

158 
	#s_0_1
 1

	)

160 
	#s_0_2
 2

	)

162 
	#s_0_3
 4

	)

164 
	#s_0_4
 6

	)

166 
	#s_0_5
 7

	)

168 
	#s_0_6
 9

	)

170 
	#s_0_7
 11

	)

172 
	#s_0_8
 
s_0_3


	)

173 
	#s_1_0
 13

	)

175 
	#s_1_1
 (
s_1_2
 + 1)

	)

176 
	#s_1_2
 (
s_1_57
 + 3)

	)

177 
	#s_1_3
 
s_1_43


	)

178 
	#s_1_4
 (
s_1_5
 + 1)

	)

179 
	#s_1_5
 
s_1_86


	)

180 
	#s_1_6
 
s_1_251


	)

181 
	#s_1_7
 15

	)

183 
	#s_1_8
 19

	)

185 
	#s_1_9
 23

	)

187 
	#s_1_10
 27

	)

189 
	#s_1_11
 (
s_1_12
 + 2)

	)

190 
	#s_1_12
 
s_1_253


	)

191 
	#s_1_13
 32

	)

193 
	#s_1_14
 39

	)

195 
	#s_1_15
 (
s_1_16
 + 3)

	)

196 
	#s_1_16
 46

	)

198 
	#s_1_17
 51

	)

200 
	#s_1_18
 56

	)

202 
	#s_1_19
 
s_1_238


	)

203 
	#s_1_20
 61

	)

205 
	#s_1_21
 65

	)

207 
	#s_1_22
 70

	)

209 
	#s_1_23
 74

	)

211 
	#s_1_24
 (
s_1_25
 + 2)

	)

212 
	#s_1_25
 79

	)

214 
	#s_1_26
 (
s_1_27
 + 2)

	)

215 
	#s_1_27
 85

	)

217 
	#s_1_28
 (
s_1_29
 + 1)

	)

218 
	#s_1_29
 90

	)

220 
	#s_1_30
 (
s_1_31
 + 2)

	)

221 
	#s_1_31
 95

	)

223 
	#s_1_32
 102

	)

225 
	#s_1_33
 
s_1_15


	)

226 
	#s_1_34
 106

	)

228 
	#s_1_35
 
s_1_16


	)

229 
	#s_1_36
 108

	)

231 
	#s_1_37
 
s_1_17


	)

232 
	#s_1_38
 (
s_1_39
 + 2)

	)

233 
	#s_1_39
 114

	)

235 
	#s_1_40
 119

	)

237 
	#s_1_41
 
s_1_147


	)

238 
	#s_1_42
 (
s_1_43
 + 2)

	)

239 
	#s_1_43
 124

	)

241 
	#s_1_44
 (
s_1_45
 + 2)

	)

242 
	#s_1_45
 130

	)

244 
	#s_1_46
 (
s_1_47
 + 3)

	)

245 
	#s_1_47
 138

	)

247 
	#s_1_48
 
s_1_20


	)

248 
	#s_1_49
 (
s_1_50
 + 2)

	)

249 
	#s_1_50
 145

	)

251 
	#s_1_51
 (
s_1_21
 + 1)

	)

252 
	#s_1_52
 (
s_1_53
 + 1)

	)

253 
	#s_1_53
 150

	)

255 
	#s_1_54
 156

	)

257 
	#s_1_55
 159

	)

259 
	#s_1_56
 
s_1_22


	)

260 
	#s_1_57
 163

	)

262 
	#s_1_58
 170

	)

264 
	#s_1_59
 175

	)

266 
	#s_1_60
 
s_1_187


	)

267 
	#s_1_61
 (
s_1_62
 + 2)

	)

268 
	#s_1_62
 
s_1_159


	)

269 
	#s_1_63
 
s_1_24


	)

270 
	#s_1_64
 (
s_1_65
 + 2)

	)

271 
	#s_1_65
 181

	)

273 
	#s_1_66
 (
s_1_67
 + 3)

	)

274 
	#s_1_67
 188

	)

276 
	#s_1_68
 197

	)

278 
	#s_1_69
 
s_1_25


	)

279 
	#s_1_70
 (
s_1_71
 + 3)

	)

280 
	#s_1_71
 205

	)

282 
	#s_1_72
 211

	)

284 
	#s_1_73
 217

	)

286 
	#s_1_74
 222

	)

288 
	#s_1_75
 227

	)

290 
	#s_1_76
 
s_1_244


	)

291 
	#s_1_77
 233

	)

293 
	#s_1_78
 239

	)

295 
	#s_1_79
 (
s_1_80
 + 2)

	)

296 
	#s_1_80
 243

	)

298 
	#s_1_81
 
s_1_18


	)

299 
	#s_1_82
 250

	)

301 
	#s_1_83
 
s_1_2


	)

302 
	#s_1_84
 
s_1_6


	)

303 
	#s_1_85
 
s_1_65


	)

304 
	#s_1_86
 
s_1_250


	)

305 
	#s_1_87
 
s_1_252


	)

306 
	#s_1_88
 
s_1_254


	)

307 
	#s_1_89
 
s_1_234


	)

308 
	#s_1_90
 
s_1_66


	)

309 
	#s_1_91
 254

	)

311 
	#s_1_92
 260

	)

313 
	#s_1_93
 
s_1_67


	)

314 
	#s_1_94
 
s_1_68


	)

315 
	#s_1_95
 (
s_1_96
 + 2)

	)

316 
	#s_1_96
 
s_1_259


	)

317 
	#s_1_97
 
s_1_260


	)

318 
	#s_1_98
 (
s_1_99
 + 1)

	)

319 
	#s_1_99
 
s_1_262


	)

320 
	#s_1_100
 
s_1_263


	)

321 
	#s_1_101
 265

	)

323 
	#s_1_102
 (
s_1_103
 + 2)

	)

324 
	#s_1_103
 267

	)

326 
	#s_1_104
 272

	)

328 
	#s_1_105
 (
s_1_106
 + 2)

	)

329 
	#s_1_106
 278

	)

331 
	#s_1_107
 285

	)

333 
	#s_1_108
 293

	)

335 
	#s_1_109
 298

	)

337 
	#s_1_110
 (
s_1_111
 + 1)

	)

338 
	#s_1_111
 305

	)

340 
	#s_1_112
 (
s_1_113
 + 2)

	)

341 
	#s_1_113
 
s_1_168


	)

342 
	#s_1_114
 
s_1_17


	)

343 
	#s_1_115
 308

	)

345 
	#s_1_116
 (
s_1_21
 + 1)

	)

346 
	#s_1_117
 
s_1_21


	)

347 
	#s_1_118
 
s_1_95


	)

348 
	#s_1_119
 312

	)

350 
	#s_1_120
 319

	)

352 
	#s_1_121
 328

	)

354 
	#s_1_122
 (
s_1_123
 + 2)

	)

355 
	#s_1_123
 
s_1_171


	)

356 
	#s_1_124
 
s_1_172


	)

357 
	#s_1_125
 
s_1_96


	)

358 
	#s_1_126
 
s_1_174


	)

359 
	#s_1_127
 335

	)

361 
	#s_1_128
 (
s_1_21
 + 1)

	)

362 
	#s_1_129
 
s_1_7


	)

363 
	#s_1_130
 
s_1_266


	)

364 
	#s_1_131
 
s_1_176


	)

365 
	#s_1_132
 341

	)

367 
	#s_1_133
 (
s_1_134
 + 2)

	)

368 
	#s_1_134
 347

	)

370 
	#s_1_135
 (
s_1_136
 + 2)

	)

371 
	#s_1_136
 
s_1_178


	)

372 
	#s_1_137
 
s_1_0


	)

373 
	#s_1_138
 353

	)

375 
	#s_1_139
 355

	)

377 
	#s_1_140
 (
s_1_141
 + 3)

	)

378 
	#s_1_141
 357

	)

380 
	#s_1_142
 
s_1_54


	)

381 
	#s_1_143
 363

	)

383 
	#s_1_144
 368

	)

385 
	#s_1_145
 (
s_1_146
 + 1)

	)

386 
	#s_1_146
 373

	)

388 
	#s_1_147
 378

	)

390 
	#s_1_148
 (
s_1_149
 + 2)

	)

391 
	#s_1_149
 382

	)

393 
	#s_1_150
 387

	)

395 
	#s_1_151
 393

	)

397 
	#s_1_152
 399

	)

399 
	#s_1_153
 (
s_1_154
 + 2)

	)

400 
	#s_1_154
 404

	)

402 
	#s_1_155
 411

	)

404 
	#s_1_156
 
s_1_192


	)

405 
	#s_1_157
 418

	)

407 
	#s_1_158
 424

	)

409 
	#s_1_159
 428

	)

411 
	#s_1_160
 434

	)

413 
	#s_1_161
 
s_1_11


	)

414 
	#s_1_162
 (
s_1_163
 + 1)

	)

415 
	#s_1_163
 (
s_1_164
 + 3)

	)

416 
	#s_1_164
 438

	)

418 
	#s_1_165
 445

	)

420 
	#s_1_166
 451

	)

422 
	#s_1_167
 (
s_1_168
 + 2)

	)

423 
	#s_1_168
 455

	)

425 
	#s_1_169
 (
s_1_170
 + 2)

	)

426 
	#s_1_170
 (
s_1_171
 + 4)

	)

427 
	#s_1_171
 461

	)

429 
	#s_1_172
 471

	)

431 
	#s_1_173
 (
s_1_174
 + 2)

	)

432 
	#s_1_174
 480

	)

434 
	#s_1_175
 490

	)

436 
	#s_1_176
 493

	)

438 
	#s_1_177
 497

	)

440 
	#s_1_178
 502

	)

442 
	#s_1_179
 (
s_1_180
 + 1)

	)

443 
	#s_1_180
 507

	)

445 
	#s_1_181
 
s_1_157


	)

446 
	#s_1_182
 (
s_1_183
 + 3)

	)

447 
	#s_1_183
 (
s_1_184
 + 1)

	)

448 
	#s_1_184
 512

	)

450 
	#s_1_185
 521

	)

452 
	#s_1_186
 529

	)

454 
	#s_1_187
 536

	)

456 
	#s_1_188
 (
s_1_189
 + 2)

	)

457 
	#s_1_189
 543

	)

459 
	#s_1_190
 552

	)

461 
	#s_1_191
 559

	)

463 
	#s_1_192
 (
s_1_193
 + 2)

	)

464 
	#s_1_193
 566

	)

466 
	#s_1_194
 (
s_1_195
 + 2)

	)

467 
	#s_1_195
 573

	)

469 
	#s_1_196
 581

	)

471 
	#s_1_197
 591

	)

473 
	#s_1_198
 601

	)

475 
	#s_1_199
 610

	)

477 
	#s_1_200
 617

	)

479 
	#s_1_201
 (
s_1_202
 + 1)

	)

480 
	#s_1_202
 625

	)

482 
	#s_1_203
 633

	)

484 
	#s_1_204
 641

	)

486 
	#s_1_205
 650

	)

488 
	#s_1_206
 657

	)

490 
	#s_1_207
 (
s_1_208
 + 2)

	)

491 
	#s_1_208
 661

	)

493 
	#s_1_209
 (
s_1_201
 + 1)

	)

494 
	#s_1_210
 
s_1_201


	)

495 
	#s_1_211
 
s_1_202


	)

496 
	#s_1_212
 667

	)

498 
	#s_1_213
 673

	)

500 
	#s_1_214
 
s_1_203


	)

501 
	#s_1_215
 682

	)

503 
	#s_1_216
 
s_1_204


	)

504 
	#s_1_217
 
s_1_10


	)

505 
	#s_1_218
 688

	)

507 
	#s_1_219
 
s_1_23


	)

508 
	#s_1_220
 (
s_1_221
 + 2)

	)

509 
	#s_1_221
 693

	)

511 
	#s_1_222
 
s_1_11


	)

512 
	#s_1_223
 
s_1_208


	)

513 
	#s_1_224
 
s_1_12


	)

514 
	#s_1_225
 700

	)

516 
	#s_1_226
 707

	)

518 
	#s_1_227
 713

	)

520 
	#s_1_228
 719

	)

522 
	#s_1_229
 
s_1_78


	)

523 
	#s_1_230
 725

	)

525 
	#s_1_231
 728

	)

527 
	#s_1_232
 732

	)

529 
	#s_1_233
 (
s_1_234
 + 2)

	)

530 
	#s_1_234
 736

	)

532 
	#s_1_235
 740

	)

534 
	#s_1_236
 744

	)

536 
	#s_1_237
 (
s_1_238
 + 1)

	)

537 
	#s_1_238
 748

	)

539 
	#s_1_239
 (
s_1_240
 + 2)

	)

540 
	#s_1_240
 753

	)

542 
	#s_1_241
 (
s_1_242
 + 2)

	)

543 
	#s_1_242
 758

	)

545 
	#s_1_243
 (
s_1_244
 + 2)

	)

546 
	#s_1_244
 765

	)

548 
	#s_1_245
 (
s_1_246
 + 1)

	)

549 
	#s_1_246
 772

	)

551 
	#s_1_247
 776

	)

553 
	#s_1_248
 (
s_1_249
 + 2)

	)

554 
	#s_1_249
 (
s_1_250
 + 1)

	)

555 
	#s_1_250
 781

	)

557 
	#s_1_251
 788

	)

559 
	#s_1_252
 (
s_1_253
 + 2)

	)

560 
	#s_1_253
 797

	)

562 
	#s_1_254
 808

	)

564 
	#s_1_255
 (
s_1_256
 + 3)

	)

565 
	#s_1_256
 815

	)

567 
	#s_1_257
 (
s_1_258
 + 2)

	)

568 
	#s_1_258
 (
s_1_259
 + 2)

	)

569 
	#s_1_259
 823

	)

571 
	#s_1_260
 834

	)

573 
	#s_1_261
 (
s_1_262
 + 1)

	)

574 
	#s_1_262
 841

	)

576 
	#s_1_263
 847

	)

578 
	#s_1_264
 853

	)

580 
	#s_1_265
 (
s_1_266
 + 1)

	)

581 
	#s_1_266
 857

	)

583 
	#s_1_267
 862

	)

585 
	#s_1_268
 (
s_1_269
 + 1)

	)

586 
	#s_1_269
 868

	)

588 
	#s_1_270
 874

	)

590 
	#s_1_271
 880

	)

592 
	#s_1_272
 885

	)

594 
	#s_1_273
 888

	)

596 
	#s_1_274
 891

	)

598 
	#s_1_275
 898

	)

600 
	#s_1_276
 (
s_1_277
 + 2)

	)

601 
	#s_1_277
 903

	)

603 
	#s_1_278
 908

	)

605 
	#s_1_279
 913

	)

607 
	#s_1_280
 (
s_1_281
 + 2)

	)

608 
	#s_1_281
 917

	)

610 
	#s_1_282
 (
s_1_283
 + 3)

	)

611 
	#s_1_283
 924

	)

613 
	#s_1_284
 933

	)

615 
	#s_1_285
 942

	)

617 
	#s_1_286
 950

	)

619 
	#s_1_287
 (
s_1_288
 + 2)

	)

620 
	#s_1_288
 (
s_1_289
 + 2)

	)

621 
	#s_1_289
 955

	)

623 
	#s_1_290
 966

	)

625 
	#s_1_291
 973

	)

627 
	#s_1_292
 978

	)

629 
	#s_1_293
 983

	)

631 
	#s_2_0
 988

	)

633 
	#s_2_1
 990

	)

635 
	#s_2_2
 992

	)

637 
	#s_2_3
 994

	)

639 
	#s_2_4
 996

	)

641 
	#s_2_5
 998

	)

643 
	#s_2_6
 1000

	)

645 
	#s_2_7
 1002

	)

647 
	#s_2_8
 1004

	)

649 
	#s_2_9
 1006

	)

651 
	#s_3_0
 1008

	)

653 
	#s_3_1
 1011

	)

655 
	#s_3_2
 1014

	)

657 
	#s_3_3
 1017

	)

659 
	#s_3_4
 1020

	)

661 
	#s_3_5
 1024

	)

663 
	#s_3_6
 1028

	)

665 
	#s_3_7
 1031

	)

667 
	#s_3_8
 1034

	)

669 
	#s_3_9
 1037

	)

671 
	#s_3_10
 1040

	)

673 
	#s_3_11
 1042

	)

675 
	#s_3_12
 1045

	)

677 
	#s_3_13
 1049

	)

679 
	#s_3_14
 1053

	)

681 
	#s_3_15
 1056

	)

683 
	#s_3_16
 (
s_3_12
 + 1)

	)

684 
	#s_3_17
 1059

	)

686 
	#s_3_18
 1062

	)

688 
	#s_3_19
 1065

	)

690 
	#s_3_20
 1069

	)

692 
	#s_3_21
 1072

	)

694 
	#s_3_22
 1075

	)

696 
	#s_3_23
 1077

	)

698 
	#s_3_24
 1080

	)

700 
	#s_3_25
 1083

	)

702 
	#s_3_26
 (
s_3_27
 + 1)

	)

703 
	#s_3_27
 1085

	)

705 
	#s_3_28
 1088

	)

707 
	#s_3_29
 1091

	)

709 
	#s_3_30
 1094

	)

711 
	#s_3_31
 1097

	)

713 
	#s_3_32
 1099

	)

715 
	#s_3_33
 1102

	)

720 cÚ¡ 
amÚg
 
	ga_0
[9] =

722  { 1, 
s_0_0
, -1, -1},

723  { 1, 
s_0_1
, -1, -1},

724  { 2, 
s_0_2
, -1, -1},

725  { 2, 
s_0_3
, -1, -1},

726  { 1, 
s_0_4
, -1, -1},

727  { 2, 
s_0_5
, -1, -1},

728  { 2, 
s_0_6
, -1, -1},

729  { 2, 
s_0_7
, -1, -1},

730  { 1, 
s_0_8
, -1, -1}

734 cÚ¡ 
amÚg
 
	ga_1
[294] =

736  { 2, 
s_1_0
, -1, 1},

737  { 1, 
s_1_1
, -1, 1},

738  { 2, 
s_1_2
, 1, 1},

739  { 3, 
s_1_3
, 1, 1},

740  { 2, 
s_1_4
, -1, 1},

741  { 3, 
s_1_5
, 4, 1},

742  { 5, 
s_1_6
, 4, 1},

743  { 4, 
s_1_7
, 4, 1},

744  { 4, 
s_1_8
, 4, 1},

745  { 4, 
s_1_9
, 4, 1},

746  { 5, 
s_1_10
, 4, 1},

747  { 5, 
s_1_11
, 4, 1},

748  { 7, 
s_1_12
, 11, 1},

749  { 7, 
s_1_13
, 11, 1},

750  { 7, 
s_1_14
, 11, 1},

751  { 2, 
s_1_15
, -1, 1},

752  { 5, 
s_1_16
, 15, 1},

753  { 5, 
s_1_17
, 15, 1},

754  { 5, 
s_1_18
, 15, 1},

755  { 3, 
s_1_19
, 15, 1},

756  { 4, 
s_1_20
, 15, 1},

757  { 5, 
s_1_21
, 15, 1},

758  { 4, 
s_1_22
, 15, 1},

759  { 5, 
s_1_23
, 15, 1},

760  { 4, 
s_1_24
, 15, 1},

761  { 6, 
s_1_25
, 24, 1},

762  { 3, 
s_1_26
, -1, 1},

763  { 5, 
s_1_27
, 26, 1},

764  { 4, 
s_1_28
, -1, 1},

765  { 5, 
s_1_29
, 28, 1},

766  { 5, 
s_1_30
, 28, 1},

767  { 7, 
s_1_31
, 30, 1},

768  { 4, 
s_1_32
, -1, 1},

769  { 1, 
s_1_33
, -1, 1},

770  { 2, 
s_1_34
, 33, 1},

771  { 4, 
s_1_35
, 33, 1},

772  { 6, 
s_1_36
, 35, 1},

773  { 4, 
s_1_37
, 33, 1},

774  { 3, 
s_1_38
, 33, 1},

775  { 5, 
s_1_39
, 38, 1},

776  { 5, 
s_1_40
, 38, 1},

777  { 3, 
s_1_41
, 33, 1},

778  { 4, 
s_1_42
, 33, 1},

779  { 6, 
s_1_43
, 42, 1},

780  { 6, 
s_1_44
, 42, 1},

781  { 8, 
s_1_45
, 44, 1},

782  { 4, 
s_1_46
, 33, 1},

783  { 7, 
s_1_47
, 46, 1},

784  { 3, 
s_1_48
, 33, 1},

785  { 3, 
s_1_49
, 33, 1},

786  { 5, 
s_1_50
, 49, 1},

787  { 3, 
s_1_51
, 33, 1},

788  { 5, 
s_1_52
, 33, 1},

789  { 6, 
s_1_53
, 52, 1},

790  { 3, 
s_1_54
, 33, 1},

791  { 4, 
s_1_55
, 33, 1},

792  { 3, 
s_1_56
, 33, 1},

793  { 7, 
s_1_57
, 56, 1},

794  { 5, 
s_1_58
, 56, 1},

795  { 6, 
s_1_59
, 56, 1},

796  { 3, 
s_1_60
, 33, 1},

797  { 3, 
s_1_61
, 33, 1},

798  { 5, 
s_1_62
, 61, 1},

799  { 3, 
s_1_63
, 33, 1},

800  { 5, 
s_1_64
, 63, 1},

801  { 7, 
s_1_65
, 64, 1},

802  { 6, 
s_1_66
, 64, 1},

803  { 9, 
s_1_67
, 66, 1},

804  { 8, 
s_1_68
, 64, 1},

805  { 5, 
s_1_69
, 63, 1},

806  { 3, 
s_1_70
, -1, 1},

807  { 6, 
s_1_71
, 70, 1},

808  { 6, 
s_1_72
, 70, 1},

809  { 5, 
s_1_73
, 70, 1},

810  { 5, 
s_1_74
, 70, 1},

811  { 6, 
s_1_75
, 70, 1},

812  { 5, 
s_1_76
, 70, 1},

813  { 6, 
s_1_77
, 70, 1},

814  { 4, 
s_1_78
, 70, 1},

815  { 5, 
s_1_79
, 70, 1},

816  { 7, 
s_1_80
, 79, 1},

817  { 3, 
s_1_81
, -1, 1},

818  { 4, 
s_1_82
, 81, 1},

819  { 1, 
s_1_83
, -1, 1},

820  { 2, 
s_1_84
, -1, 1},

821  { 4, 
s_1_85
, 84, 1},

822  { 5, 
s_1_86
, 85, 1},

823  { 7, 
s_1_87
, 85, 1},

824  { 5, 
s_1_88
, 84, 1},

825  { 3, 
s_1_89
, 84, 1},

826  { 3, 
s_1_90
, 84, 1},

827  { 6, 
s_1_91
, 90, 1},

828  { 5, 
s_1_92
, 90, 1},

829  { 6, 
s_1_93
, 90, 1},

830  { 5, 
s_1_94
, 84, 1},

831  { 7, 
s_1_95
, 94, 1},

832  { 9, 
s_1_96
, 95, 1},

833  { 5, 
s_1_97
, 84, 1},

834  { 3, 
s_1_98
, -1, 1},

835  { 4, 
s_1_99
, 98, 1},

836  { 4, 
s_1_100
, 98, 1},

837  { 2, 
s_1_101
, -1, 1},

838  { 3, 
s_1_102
, -1, 1},

839  { 5, 
s_1_103
, 102, 1},

840  { 6, 
s_1_104
, 102, 1},

841  { 5, 
s_1_105
, 102, 1},

842  { 7, 
s_1_106
, 105, 1},

843  { 8, 
s_1_107
, 105, 1},

844  { 5, 
s_1_108
, 102, 1},

845  { 7, 
s_1_109
, 102, 1},

846  { 2, 
s_1_110
, -1, 1},

847  { 3, 
s_1_111
, 110, 1},

848  { 3, 
s_1_112
, -1, 1},

849  { 5, 
s_1_113
, 112, 1},

850  { 2, 
s_1_114
, -1, 1},

851  { 4, 
s_1_115
, 114, 1},

852  { 2, 
s_1_116
, -1, 1},

853  { 3, 
s_1_117
, 116, 1},

854  { 5, 
s_1_118
, 117, 1},

855  { 7, 
s_1_119
, 118, 1},

856  { 9, 
s_1_120
, 118, 1},

857  { 7, 
s_1_121
, 118, 1},

858  { 7, 
s_1_122
, 118, 1},

859  { 9, 
s_1_123
, 122, 1},

860  { 8, 
s_1_124
, 118, 1},

861  { 7, 
s_1_125
, 118, 1},

862  { 9, 
s_1_126
, 125, 1},

863  { 6, 
s_1_127
, 117, 1},

864  { 1, 
s_1_128
, -1, 1},

865  { 2, 
s_1_129
, -1, 1},

866  { 3, 
s_1_130
, 129, 1},

867  { 3, 
s_1_131
, -1, 1},

868  { 6, 
s_1_132
, -1, 1},

869  { 4, 
s_1_133
, -1, 1},

870  { 6, 
s_1_134
, 133, 1},

871  { 2, 
s_1_135
, -1, 1},

872  { 4, 
s_1_136
, 135, 1},

873  { 1, 
s_1_137
, -1, 1},

874  { 2, 
s_1_138
, 137, 1},

875  { 2, 
s_1_139
, 137, 1},

876  { 3, 
s_1_140
, 137, 1},

877  { 6, 
s_1_141
, 140, 1},

878  { 2, 
s_1_142
, 137, 1},

879  { 5, 
s_1_143
, 142, 1},

880  { 5, 
s_1_144
, 142, 1},

881  { 4, 
s_1_145
, 142, 1},

882  { 5, 
s_1_146
, 145, 1},

883  { 4, 
s_1_147
, 142, 1},

884  { 3, 
s_1_148
, 142, 1},

885  { 5, 
s_1_149
, 148, 1},

886  { 6, 
s_1_150
, 148, 1},

887  { 6, 
s_1_151
, 148, 1},

888  { 5, 
s_1_152
, 148, 1},

889  { 5, 
s_1_153
, 148, 1},

890  { 7, 
s_1_154
, 153, 1},

891  { 7, 
s_1_155
, 153, 1},

892  { 4, 
s_1_156
, 142, 1},

893  { 6, 
s_1_157
, 142, 1},

894  { 4, 
s_1_158
, 142, 1},

895  { 6, 
s_1_159
, 142, 1},

896  { 4, 
s_1_160
, 137, 1},

897  { 2, 
s_1_161
, 137, 1},

898  { 3, 
s_1_162
, 137, 1},

899  { 4, 
s_1_163
, 162, 1},

900  { 7, 
s_1_164
, 163, 1},

901  { 6, 
s_1_165
, 162, 1},

902  { 4, 
s_1_166
, 137, 1},

903  { 4, 
s_1_167
, 137, 1},

904  { 6, 
s_1_168
, 167, 1},

905  { 4, 
s_1_169
, 137, 1},

906  { 6, 
s_1_170
, 169, 1},

907  { 10, 
s_1_171
, 170, 1},

908  { 9, 
s_1_172
, 170, 1},

909  { 8, 
s_1_173
, 170, 1},

910  { 10, 
s_1_174
, 173, 1},

911  { 3, 
s_1_175
, 137, 1},

912  { 4, 
s_1_176
, 137, 1},

913  { 5, 
s_1_177
, 137, 1},

914  { 5, 
s_1_178
, 137, 1},

915  { 4, 
s_1_179
, 137, 1},

916  { 5, 
s_1_180
, 179, 1},

917  { 4, 
s_1_181
, 137, 1},

918  { 5, 
s_1_182
, 181, 1},

919  { 8, 
s_1_183
, 182, 1},

920  { 9, 
s_1_184
, 183, 1},

921  { 8, 
s_1_185
, 182, 1},

922  { 7, 
s_1_186
, 182, 1},

923  { 7, 
s_1_187
, 182, 1},

924  { 7, 
s_1_188
, 182, 1},

925  { 9, 
s_1_189
, 188, 1},

926  { 7, 
s_1_190
, 181, 1},

927  { 7, 
s_1_191
, 181, 1},

928  { 5, 
s_1_192
, 181, 1},

929  { 7, 
s_1_193
, 192, 1},

930  { 6, 
s_1_194
, 181, 1},

931  { 8, 
s_1_195
, 194, 1},

932  { 10, 
s_1_196
, 194, 1},

933  { 10, 
s_1_197
, 194, 1},

934  { 9, 
s_1_198
, 194, 1},

935  { 7, 
s_1_199
, 181, 1},

936  { 8, 
s_1_200
, 181, 1},

937  { 7, 
s_1_201
, 181, 1},

938  { 8, 
s_1_202
, 201, 1},

939  { 8, 
s_1_203
, 201, 1},

940  { 9, 
s_1_204
, 201, 1},

941  { 7, 
s_1_205
, 181, 1},

942  { 4, 
s_1_206
, 137, 1},

943  { 4, 
s_1_207
, 137, 1},

944  { 6, 
s_1_208
, 207, 1},

945  { 2, 
s_1_209
, 137, 1},

946  { 3, 
s_1_210
, 209, 1},

947  { 4, 
s_1_211
, 210, 1},

948  { 6, 
s_1_212
, 211, 1},

949  { 9, 
s_1_213
, 211, 1},

950  { 4, 
s_1_214
, 210, 1},

951  { 6, 
s_1_215
, 214, 1},

952  { 5, 
s_1_216
, 210, 1},

953  { 3, 
s_1_217
, -1, 1},

954  { 5, 
s_1_218
, 217, 1},

955  { 3, 
s_1_219
, -1, 1},

956  { 5, 
s_1_220
, 219, 1},

957  { 7, 
s_1_221
, 220, 1},

958  { 3, 
s_1_222
, -1, 1},

959  { 5, 
s_1_223
, 222, 1},

960  { 5, 
s_1_224
, 222, 1},

961  { 7, 
s_1_225
, 224, 1},

962  { 6, 
s_1_226
, 224, 1},

963  { 6, 
s_1_227
, 222, 1},

964  { 6, 
s_1_228
, 222, 1},

965  { 1, 
s_1_229
, -1, 1},

966  { 3, 
s_1_230
, 229, 1},

967  { 4, 
s_1_231
, 229, 1},

968  { 4, 
s_1_232
, 229, 1},

969  { 2, 
s_1_233
, 229, 1},

970  { 4, 
s_1_234
, 233, 1},

971  { 4, 
s_1_235
, 233, 1},

972  { 4, 
s_1_236
, 233, 1},

973  { 4, 
s_1_237
, 233, 1},

974  { 5, 
s_1_238
, 237, 1},

975  { 3, 
s_1_239
, 233, 1},

976  { 5, 
s_1_240
, 239, 1},

977  { 5, 
s_1_241
, 239, 1},

978  { 7, 
s_1_242
, 241, 1},

979  { 5, 
s_1_243
, 233, 1},

980  { 7, 
s_1_244
, 243, 1},

981  { 3, 
s_1_245
, 233, 1},

982  { 4, 
s_1_246
, 245, 1},

983  { 5, 
s_1_247
, 245, 1},

984  { 4, 
s_1_248
, 233, 1},

985  { 6, 
s_1_249
, 248, 1},

986  { 7, 
s_1_250
, 249, 1},

987  { 9, 
s_1_251
, 249, 1},

988  { 9, 
s_1_252
, 249, 1},

989  { 11, 
s_1_253
, 252, 1},

990  { 7, 
s_1_254
, 248, 1},

991  { 5, 
s_1_255
, 248, 1},

992  { 8, 
s_1_256
, 255, 1},

993  { 7, 
s_1_257
, 248, 1},

994  { 9, 
s_1_258
, 257, 1},

995  { 11, 
s_1_259
, 258, 1},

996  { 7, 
s_1_260
, 248, 1},

997  { 5, 
s_1_261
, 233, 1},

998  { 6, 
s_1_262
, 261, 1},

999  { 6, 
s_1_263
, 261, 1},

1000  { 4, 
s_1_264
, 233, 1},

1001  { 4, 
s_1_265
, 233, 1},

1002  { 5, 
s_1_266
, 265, 1},

1003  { 6, 
s_1_267
, 233, 1},

1004  { 5, 
s_1_268
, 233, 1},

1005  { 6, 
s_1_269
, 268, 1},

1006  { 6, 
s_1_270
, 268, 1},

1007  { 5, 
s_1_271
, 233, 1},

1008  { 3, 
s_1_272
, 229, 1},

1009  { 3, 
s_1_273
, 229, 1},

1010  { 7, 
s_1_274
, 229, 1},

1011  { 5, 
s_1_275
, 229, 1},

1012  { 3, 
s_1_276
, 229, 1},

1013  { 5, 
s_1_277
, 276, 1},

1014  { 5, 
s_1_278
, 276, 1},

1015  { 4, 
s_1_279
, 276, 1},

1016  { 5, 
s_1_280
, 276, 1},

1017  { 7, 
s_1_281
, 280, 1},

1018  { 6, 
s_1_282
, 280, 1},

1019  { 9, 
s_1_283
, 282, 1},

1020  { 9, 
s_1_284
, 282, 1},

1021  { 8, 
s_1_285
, 280, 1},

1022  { 5, 
s_1_286
, 276, 1},

1023  { 7, 
s_1_287
, 276, 1},

1024  { 9, 
s_1_288
, 287, 1},

1025  { 11, 
s_1_289
, 288, 1},

1026  { 7, 
s_1_290
, 276, 1},

1027  { 5, 
s_1_291
, 276, 1},

1028  { 5, 
s_1_292
, 276, 1},

1029  { 5, 
s_1_293
, 276, 1}

1032 cÚ¡ 
	gaf_1
[294] =

1331 cÚ¡ 
amÚg
 
	ga_2
[10] =

1333  { 2, 
s_2_0
, -1, -1},

1334  { 2, 
s_2_1
, -1, -1},

1335  { 2, 
s_2_2
, -1, -1},

1336  { 2, 
s_2_3
, -1, -1},

1337  { 2, 
s_2_4
, -1, -1},

1338  { 2, 
s_2_5
, -1, -1},

1339  { 2, 
s_2_6
, -1, -1},

1340  { 2, 
s_2_7
, -1, -1},

1341  { 2, 
s_2_8
, -1, -1},

1342  { 2, 
s_2_9
, -1, -1}

1346 cÚ¡ 
amÚg
 
	ga_3
[34] =

1348  { 3, 
s_3_0
, -1, 18},

1349  { 3, 
s_3_1
, -1, 19},

1350  { 3, 
s_3_2
, -1, 20},

1351  { 3, 
s_3_3
, -1, 21},

1352  { 4, 
s_3_4
, -1, 22},

1353  { 4, 
s_3_5
, -1, 23},

1354  { 3, 
s_3_6
, -1, 24},

1355  { 3, 
s_3_7
, -1, 25},

1356  { 3, 
s_3_8
, -1, 26},

1357  { 3, 
s_3_9
, -1, 27},

1358  { 2, 
s_3_10
, -1, 9},

1359  { 3, 
s_3_11
, -1, 28},

1360  { 4, 
s_3_12
, -1, 7},

1361  { 4, 
s_3_13
, -1, 6},

1362  { 3, 
s_3_14
, -1, 5},

1363  { 3, 
s_3_15
, -1, 2},

1364  { 2, 
s_3_16
, -1, 32},

1365  { 3, 
s_3_17
, -1, 29},

1366  { 3, 
s_3_18
, -1, 30},

1367  { 4, 
s_3_19
, -1, 3},

1368  { 3, 
s_3_20
, -1, 4},

1369  { 3, 
s_3_21
, -1, 31},

1370  { 2, 
s_3_22
, -1, 33},

1371  { 3, 
s_3_23
, -1, 1},

1372  { 3, 
s_3_24
, -1, 8},

1373  { 2, 
s_3_25
, -1, 14},

1374  { 2, 
s_3_26
, -1, 15},

1375  { 3, 
s_3_27
, 26, 10},

1376  { 3, 
s_3_28
, 26, 11},

1377  { 3, 
s_3_29
, 26, 12},

1378  { 3, 
s_3_30
, 26, 13},

1379  { 2, 
s_3_31
, -1, 16},

1380  { 3, 
s_3_32
, -1, 17},

1381  { 2, 
s_3_33
, -1, 34}

1384 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'l', 'l' };

1385 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'd', 'r' };

1386 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'i', 'n' };

1387 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'm', 'e', 't' };

1388 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'r', 'y', 's', 't' };

1389 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'i', 'e', 'f' };

1390 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'u', 'c' };

1391 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'u', 'm' };

1392 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'r', 'b' };

1393 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'u', 'r' };

1394 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'i', 's', 't', 'e', 'r' };

1395 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'm', 'e', 't', 'e', 'r' };

1396 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'o', 'l', 'u', 't' };

1397 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'l' };

1398 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'b', 'i', 'c' };

1399 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'd', 'i', 'c' };

1400 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'p', 'i', 'c' };

1401 cÚ¡ 
symbŞ
 
	gs_17
[] = { 't', 'i', 'c' };

1402 cÚ¡ 
symbŞ
 
	gs_18
[] = { 'a', 'c' };

1403 cÚ¡ 
symbŞ
 
	gs_19
[] = { 'e', 'c' };

1404 cÚ¡ 
symbŞ
 
	gs_20
[] = { 'i', 'c' };

1405 cÚ¡ 
symbŞ
 
	gs_21
[] = { 'l', 'u', 'c' };

1406 cÚ¡ 
symbŞ
 
	gs_22
[] = { 'u', 'a', 's' };

1407 cÚ¡ 
symbŞ
 
	gs_23
[] = { 'v', 'a', 's' };

1408 cÚ¡ 
symbŞ
 
	gs_24
[] = { 'c', 'i', 's' };

1409 cÚ¡ 
symbŞ
 
	gs_25
[] = { 'l', 'i', 's' };

1410 cÚ¡ 
symbŞ
 
	gs_26
[] = { 'e', 'r', 'i', 's' };

1411 cÚ¡ 
symbŞ
 
	gs_27
[] = { 'p', 'a', 'n', 's' };

1412 cÚ¡ 
symbŞ
 
	gs_28
[] = { 'e', 'n', 's' };

1413 cÚ¡ 
symbŞ
 
	gs_29
[] = { 'o', 'n', 's' };

1414 cÚ¡ 
symbŞ
 
	gs_30
[] = { 'l', 'u', 's' };

1415 cÚ¡ 
symbŞ
 
	gs_31
[] = { 'r', 'u', 's' };

1416 cÚ¡ 
symbŞ
 
	gs_32
[] = { 'h', 'e', 's' };

1417 cÚ¡ 
symbŞ
 
	gs_33
[] = { 'm', 'i', 's' };

1418 cÚ¡ 
symbŞ
 
	gs_34
[] = { 'e', 'n', 's' };

1419 cÚ¡ 
symbŞ
 
	gs_35
[] = { 'e', 'r', 's' };

1420 cÚ¡ 
symbŞ
 
	gs_36
[] = { 'e', 's' };

1421 cÚ¡ 
symbŞ
 
	gs_37
[] = { 'y', 's' };

1422 cÚ¡ 
symbŞ
 
	gs_38
[] = { 'y', 's' };

1424 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_A
() {

1425 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1426 ià(
»t
 < 0)  0;

1427 
c
 = 
»t
;

1430 
	}
}

1432 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_B
() {

1433 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

1434 ià(
»t
 < 0)  0;

1435 
c
 = 
»t
;

1438 
	}
}

1440 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_C
() {

1441 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 4);

1442 ià(
»t
 < 0)  0;

1443 
c
 = 
»t
;

1446 
	}
}

1448 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_D
() {

1449 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 5);

1450 ià(
»t
 < 0)  0;

1451 
c
 = 
»t
;

1454 
	}
}

1456 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_E
() {

1457 { 
m_‹¡1
 = 
l
 - 
c
;

1458 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1459 ià(
»t
 < 0)  0;

1460 
c
 = 
»t
;

1462 
c
 = 
l
 - 
m_‹¡1
;

1464 { 
m2
 = 
l
 - 
c
; ()m2;

1465 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb0
;

1466 
c
--;

1468 
Ïb0
:

1469 
c
 = 
l
 - 
m2
;

1472 
	}
}

1474 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_F
() {

1475 { 
m_‹¡1
 = 
l
 - 
c
;

1476 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

1477 ià(
»t
 < 0)  0;

1478 
c
 = 
»t
;

1480 
c
 = 
l
 - 
m_‹¡1
;

1482 { 
m2
 = 
l
 - 
c
; ()m2;

1483 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb0
;

1484 
c
--;

1486 
Ïb0
:

1487 
c
 = 
l
 - 
m2
;

1490 
	}
}

1492 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_G
() {

1493 { 
m_‹¡1
 = 
l
 - 
c
;

1494 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

1495 ià(
»t
 < 0)  0;

1496 
c
 = 
»t
;

1498 
c
 = 
l
 - 
m_‹¡1
;

1500 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'f')  0;

1501 
c
--;

1503 
	}
}

1505 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_H
() {

1506 { 
m_‹¡1
 = 
l
 - 
c
;

1507 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1508 ià(
»t
 < 0)  0;

1509 
c
 = 
»t
;

1511 
c
 = 
l
 - 
m_‹¡1
;

1513 { 
m2
 = 
l
 - 
c
; ()m2;

1514 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ't'è
Ïb1
;

1515 
c
--;

1516 
Ïb0
;

1517 
Ïb1
:

1518 
c
 = 
l
 - 
m2
;

1519 ià(!(
	`eq_s_b
(2, 
s_0
)))  0;

1521 
Ïb0
:

1523 
	}
}

1525 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_I
() {

1526 { 
m_‹¡1
 = 
l
 - 
c
;

1527 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1528 ià(
»t
 < 0)  0;

1529 
c
 = 
»t
;

1531 
c
 = 
l
 - 
m_‹¡1
;

1533 { 
m2
 = 
l
 - 
c
; ()m2;

1534 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'o'è
Ïb0
;

1535 
c
--;

1537 
Ïb0
:

1538 
c
 = 
l
 - 
m2
;

1540 { 
m3
 = 
l
 - 
c
; ()m3;

1541 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb1
;

1542 
c
--;

1544 
Ïb1
:

1545 
c
 = 
l
 - 
m3
;

1548 
	}
}

1550 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_J
() {

1551 { 
m_‹¡1
 = 
l
 - 
c
;

1552 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1553 ià(
»t
 < 0)  0;

1554 
c
 = 
»t
;

1556 
c
 = 
l
 - 
m_‹¡1
;

1558 { 
m2
 = 
l
 - 
c
; ()m2;

1559 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'a'è
Ïb0
;

1560 
c
--;

1562 
Ïb0
:

1563 
c
 = 
l
 - 
m2
;

1565 { 
m3
 = 
l
 - 
c
; ()m3;

1566 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb1
;

1567 
c
--;

1569 
Ïb1
:

1570 
c
 = 
l
 - 
m3
;

1573 
	}
}

1575 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_K
() {

1576 { 
m_‹¡1
 = 
l
 - 
c
;

1577 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

1578 ià(
»t
 < 0)  0;

1579 
c
 = 
»t
;

1581 
c
 = 
l
 - 
m_‹¡1
;

1583 { 
m2
 = 
l
 - 
c
; ()m2;

1584 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'l'è
Ïb1
;

1585 
c
--;

1586 
Ïb0
;

1587 
Ïb1
:

1588 
c
 = 
l
 - 
m2
;

1589 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'i'è
Ïb2
;

1590 
c
--;

1591 
Ïb0
;

1592 
Ïb2
:

1593 
c
 = 
l
 - 
m2
;

1594 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'e')  0;

1595 
c
--;

1596 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

1597 ià(
»t
 < 0)  0;

1598 
c
 = 
»t
;

1600 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'u')  0;

1601 
c
--;

1603 
Ïb0
:

1605 
	}
}

1607 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_L
() {

1608 { 
m_‹¡1
 = 
l
 - 
c
;

1609 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1610 ià(
»t
 < 0)  0;

1611 
c
 = 
»t
;

1613 
c
 = 
l
 - 
m_‹¡1
;

1615 { 
m2
 = 
l
 - 
c
; ()m2;

1616 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è
Ïb0
;

1617 
c
--;

1619 
Ïb0
:

1620 
c
 = 
l
 - 
m2
;

1622 { 
m3
 = 
l
 - 
c
; ()m3;

1623 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'x'è
Ïb1
;

1624 
c
--;

1626 
Ïb1
:

1627 
c
 = 
l
 - 
m3
;

1629 { 
m4
 = 
l
 - 
c
; ()m4;

1630 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb2
;

1631 
c
--;

1632 { 
m5
 = 
l
 - 
c
; ()m5;

1633 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'o'è
Ïb3
;

1634 
c
--;

1635 
Ïb2
;

1636 
Ïb3
:

1637 
c
 = 
l
 - 
m5
;

1640 
Ïb2
:

1641 
c
 = 
l
 - 
m4
;

1644 
	}
}

1646 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_M
() {

1647 { 
m_‹¡1
 = 
l
 - 
c
;

1648 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1649 ià(
»t
 < 0)  0;

1650 
c
 = 
»t
;

1652 
c
 = 
l
 - 
m_‹¡1
;

1654 { 
m2
 = 
l
 - 
c
; ()m2;

1655 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'a'è
Ïb0
;

1656 
c
--;

1658 
Ïb0
:

1659 
c
 = 
l
 - 
m2
;

1661 { 
m3
 = 
l
 - 
c
; ()m3;

1662 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'c'è
Ïb1
;

1663 
c
--;

1665 
Ïb1
:

1666 
c
 = 
l
 - 
m3
;

1668 { 
m4
 = 
l
 - 
c
; ()m4;

1669 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb2
;

1670 
c
--;

1672 
Ïb2
:

1673 
c
 = 
l
 - 
m4
;

1675 { 
m5
 = 
l
 - 
c
; ()m5;

1676 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'm'è
Ïb3
;

1677 
c
--;

1679 
Ïb3
:

1680 
c
 = 
l
 - 
m5
;

1683 
	}
}

1685 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_N
() {

1686 { 
m_‹¡1
 = 
l
 - 
c
;

1687 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

1688 ià(
»t
 < 0)  0;

1689 
c
 = 
»t
;

1691 
c
 = 
l
 - 
m_‹¡1
;

1693 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1694 ià(
»t
 < 0)  0;

1695 
c
 = 
»t
;

1697 { 
m2
 = 
l
 - 
c
; ()m2;

1698 { 
m3
 = 
l
 - 
c
; ()m3;

1699 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb2
;

1700 
c
--;

1701 
Ïb1
;

1702 
Ïb2
:

1703 
c
 = 
l
 - 
m3
;

1705 
Ïb0
;

1706 
Ïb1
:

1707 
c
 = 
l
 - 
m2
;

1708 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1709 ià(
»t
 < 0)  0;

1710 
c
 = 
»t
;

1713 
Ïb0
:

1715 
	}
}

1717 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_O
() {

1718 { 
m_‹¡1
 = 
l
 - 
c
;

1719 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1720 ià(
»t
 < 0)  0;

1721 
c
 = 
»t
;

1723 
c
 = 
l
 - 
m_‹¡1
;

1725 { 
m2
 = 
l
 - 
c
; ()m2;

1726 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'l'è
Ïb1
;

1727 
c
--;

1728 
Ïb0
;

1729 
Ïb1
:

1730 
c
 = 
l
 - 
m2
;

1731 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'i')  0;

1732 
c
--;

1734 
Ïb0
:

1736 
	}
}

1738 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_P
() {

1739 { 
m_‹¡1
 = 
l
 - 
c
;

1740 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1741 ià(
»t
 < 0)  0;

1742 
c
 = 
»t
;

1744 
c
 = 
l
 - 
m_‹¡1
;

1746 { 
m2
 = 
l
 - 
c
; ()m2;

1747 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'c'è
Ïb0
;

1748 
c
--;

1750 
Ïb0
:

1751 
c
 = 
l
 - 
m2
;

1754 
	}
}

1756 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_Q
() {

1757 { 
m_‹¡1
 = 
l
 - 
c
;

1758 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1759 ià(
»t
 < 0)  0;

1760 
c
 = 
»t
;

1762 
c
 = 
l
 - 
m_‹¡1
;

1764 { 
m_‹¡2
 = 
l
 - 
c
;

1765 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

1766 ià(
»t
 < 0)  0;

1767 
c
 = 
»t
;

1769 
c
 = 
l
 - 
m_‹¡2
;

1771 { 
m3
 = 
l
 - 
c
; ()m3;

1772 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'l'è
Ïb0
;

1773 
c
--;

1775 
Ïb0
:

1776 
c
 = 
l
 - 
m3
;

1778 { 
m4
 = 
l
 - 
c
; ()m4;

1779 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'n'è
Ïb1
;

1780 
c
--;

1782 
Ïb1
:

1783 
c
 = 
l
 - 
m4
;

1786 
	}
}

1788 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_R
() {

1789 { 
m_‹¡1
 = 
l
 - 
c
;

1790 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1791 ià(
»t
 < 0)  0;

1792 
c
 = 
»t
;

1794 
c
 = 
l
 - 
m_‹¡1
;

1796 { 
m2
 = 
l
 - 
c
; ()m2;

1797 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'n'è
Ïb1
;

1798 
c
--;

1799 
Ïb0
;

1800 
Ïb1
:

1801 
c
 = 
l
 - 
m2
;

1802 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'r')  0;

1803 
c
--;

1805 
Ïb0
:

1807 
	}
}

1809 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_S
() {

1810 { 
m_‹¡1
 = 
l
 - 
c
;

1811 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1812 ià(
»t
 < 0)  0;

1813 
c
 = 
»t
;

1815 
c
 = 
l
 - 
m_‹¡1
;

1817 { 
m2
 = 
l
 - 
c
; ()m2;

1818 ià(!(
	`eq_s_b
(2, 
s_1
))è
Ïb1
;

1819 
Ïb0
;

1820 
Ïb1
:

1821 
c
 = 
l
 - 
m2
;

1822 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 't')  0;

1823 
c
--;

1824 { 
m3
 = 
l
 - 
c
; ()m3;

1825 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ't'è
Ïb2
;

1826 
c
--;

1828 
Ïb2
:

1829 
c
 = 
l
 - 
m3
;

1832 
Ïb0
:

1834 
	}
}

1836 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_T
() {

1837 { 
m_‹¡1
 = 
l
 - 
c
;

1838 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1839 ià(
»t
 < 0)  0;

1840 
c
 = 
»t
;

1842 
c
 = 
l
 - 
m_‹¡1
;

1844 { 
m2
 = 
l
 - 
c
; ()m2;

1845 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb1
;

1846 
c
--;

1847 
Ïb0
;

1848 
Ïb1
:

1849 
c
 = 
l
 - 
m2
;

1850 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 't')  0;

1851 
c
--;

1852 { 
m3
 = 
l
 - 
c
; ()m3;

1853 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'o'è
Ïb2
;

1854 
c
--;

1856 
Ïb2
:

1857 
c
 = 
l
 - 
m3
;

1860 
Ïb0
:

1862 
	}
}

1864 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_U
() {

1865 { 
m_‹¡1
 = 
l
 - 
c
;

1866 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1867 ià(
»t
 < 0)  0;

1868 
c
 = 
»t
;

1870 
c
 = 
l
 - 
m_‹¡1
;

1872 { 
m2
 = 
l
 - 
c
; ()m2;

1873 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'l'è
Ïb1
;

1874 
c
--;

1875 
Ïb0
;

1876 
Ïb1
:

1877 
c
 = 
l
 - 
m2
;

1878 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'm'è
Ïb2
;

1879 
c
--;

1880 
Ïb0
;

1881 
Ïb2
:

1882 
c
 = 
l
 - 
m2
;

1883 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'n'è
Ïb3
;

1884 
c
--;

1885 
Ïb0
;

1886 
Ïb3
:

1887 
c
 = 
l
 - 
m2
;

1888 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'r')  0;

1889 
c
--;

1891 
Ïb0
:

1893 
	}
}

1895 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_V
() {

1896 { 
m_‹¡1
 = 
l
 - 
c
;

1897 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1898 ià(
»t
 < 0)  0;

1899 
c
 = 
»t
;

1901 
c
 = 
l
 - 
m_‹¡1
;

1903 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'c')  0;

1904 
c
--;

1906 
	}
}

1908 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_W
() {

1909 { 
m_‹¡1
 = 
l
 - 
c
;

1910 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1911 ià(
»t
 < 0)  0;

1912 
c
 = 
»t
;

1914 
c
 = 
l
 - 
m_‹¡1
;

1916 { 
m2
 = 
l
 - 
c
; ()m2;

1917 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb0
;

1918 
c
--;

1920 
Ïb0
:

1921 
c
 = 
l
 - 
m2
;

1923 { 
m3
 = 
l
 - 
c
; ()m3;

1924 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è
Ïb1
;

1925 
c
--;

1927 
Ïb1
:

1928 
c
 = 
l
 - 
m3
;

1931 
	}
}

1933 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_X
() {

1934 { 
m_‹¡1
 = 
l
 - 
c
;

1935 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1936 ià(
»t
 < 0)  0;

1937 
c
 = 
»t
;

1939 
c
 = 
l
 - 
m_‹¡1
;

1941 { 
m2
 = 
l
 - 
c
; ()m2;

1942 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'l'è
Ïb1
;

1943 
c
--;

1944 
Ïb0
;

1945 
Ïb1
:

1946 
c
 = 
l
 - 
m2
;

1947 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'i'è
Ïb2
;

1948 
c
--;

1949 
Ïb0
;

1950 
Ïb2
:

1951 
c
 = 
l
 - 
m2
;

1952 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'e')  0;

1953 
c
--;

1954 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

1955 ià(
»t
 < 0)  0;

1956 
c
 = 
»t
;

1958 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'u')  0;

1959 
c
--;

1961 
Ïb0
:

1963 
	}
}

1965 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_Y
() {

1966 { 
m_‹¡1
 = 
l
 - 
c
;

1967 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1968 ià(
»t
 < 0)  0;

1969 
c
 = 
»t
;

1971 
c
 = 
l
 - 
m_‹¡1
;

1973 ià(!(
	`eq_s_b
(2, 
s_2
)))  0;

1975 
	}
}

1977 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_Z
() {

1978 { 
m_‹¡1
 = 
l
 - 
c
;

1979 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1980 ià(
»t
 < 0)  0;

1981 
c
 = 
»t
;

1983 
c
 = 
l
 - 
m_‹¡1
;

1985 { 
m2
 = 
l
 - 
c
; ()m2;

1986 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'f'è
Ïb0
;

1987 
c
--;

1989 
Ïb0
:

1990 
c
 = 
l
 - 
m2
;

1993 
	}
}

1995 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_AA
() {

1996 { 
m_‹¡1
 = 
l
 - 
c
;

1997 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

1998 ià(
»t
 < 0)  0;

1999 
c
 = 
»t
;

2001 
c
 = 
l
 - 
m_‹¡1
;

2003 ià(
c
 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((1839440 >> (p[c - 1] & 0x1f)) & 1))  0;

2004 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 9, 0, 0)))  0;

2006 
	}
}

2008 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_BB
() {

2009 { 
m_‹¡1
 = 
l
 - 
c
;

2010 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 3);

2011 ià(
»t
 < 0)  0;

2012 
c
 = 
»t
;

2014 
c
 = 
l
 - 
m_‹¡1
;

2016 { 
m2
 = 
l
 - 
c
; ()m2;

2017 ià(!(
	`eq_s_b
(3, 
s_3
))è
Ïb0
;

2019 
Ïb0
:

2020 
c
 = 
l
 - 
m2
;

2022 { 
m3
 = 
l
 - 
c
; ()m3;

2023 ià(!(
	`eq_s_b
(4, 
s_4
))è
Ïb1
;

2025 
Ïb1
:

2026 
c
 = 
l
 - 
m3
;

2029 
	}
}

2031 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_CC
() {

2032 { 
m_‹¡1
 = 
l
 - 
c
;

2033 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 
l
, - 2);

2034 ià(
»t
 < 0)  0;

2035 
c
 = 
»t
;

2037 
c
 = 
l
 - 
m_‹¡1
;

2039 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'l')  0;

2040 
c
--;

2042 
	}
}

2044 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_’dšgs
() {

2045 
amÚg_v¬
;

2046 
k‘
 = 
c
;

2047 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 294, 
af_1
, 
af
);

2048 ià(!(
amÚg_v¬
))  0;

2049 
b¿
 = 
c
;

2050 
amÚg_v¬
) {

2053 ià(
	`¦iû_d–
() == -1)  -1;

2057 
	}
}

2059 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_undoubË
() {

2060 { 
m_‹¡1
 = 
l
 - 
c
;

2061 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((1929364 >> (p[c - 1] & 0x1f)) & 1))  0;

2062 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 10, 0, 0)))  0;

2063 
c
 = 
l
 - 
m_‹¡1
;

2065 
k‘
 = 
c
;

2066 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

2067 ià(
»t
 < 0)  0;

2068 
c
 = 
»t
;

2070 
b¿
 = 
c
;

2071 ià(
	`¦iû_d–
() == -1)  -1;

2073 
	}
}

2075 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$r_»¥–l
() {

2076 
amÚg_v¬
;

2077 
k‘
 = 
c
;

2078 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((89919504 >> (p[c - 1] & 0x1f)) & 1))  0;

2079 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 34, 0, 0);

2080 ià(!(
amÚg_v¬
))  0;

2081 
b¿
 = 
c
;

2082 
amÚg_v¬
) {

2085 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_5
);

2086 ià(
»t
 < 0) „et;

2090 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_6
);

2091 ià(
»t
 < 0) „et;

2095 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_7
);

2096 ià(
»t
 < 0) „et;

2100 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_8
);

2101 ià(
»t
 < 0) „et;

2105 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_9
);

2106 ià(
»t
 < 0) „et;

2110 { 
»t
 = 
	`¦iû_äom_s
(5, 
s_10
);

2111 ià(
»t
 < 0) „et;

2115 { 
»t
 = 
	`¦iû_äom_s
(5, 
s_11
);

2116 ià(
»t
 < 0) „et;

2120 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_12
);

2121 ià(
»t
 < 0) „et;

2125 { 
m1
 = 
l
 - 
c
; ()m1;

2126 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'a'è
Ïb0
;

2127 
c
--;

2129 
Ïb0
:

2130 
c
 = 
l
 - 
m1
;

2132 { 
m2
 = 
l
 - 
c
; ()m2;

2133 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'i'è
Ïb1
;

2134 
c
--;

2136 
Ïb1
:

2137 
c
 = 
l
 - 
m2
;

2139 { 
m3
 = 
l
 - 
c
; ()m3;

2140 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'o'è
Ïb2
;

2141 
c
--;

2143 
Ïb2
:

2144 
c
 = 
l
 - 
m3
;

2146 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_13
);

2147 ià(
»t
 < 0) „et;

2151 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_14
);

2152 ià(
»t
 < 0) „et;

2156 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_15
);

2157 ià(
»t
 < 0) „et;

2161 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_16
);

2162 ià(
»t
 < 0) „et;

2166 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_17
);

2167 ià(
»t
 < 0) „et;

2171 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_18
);

2172 ià(
»t
 < 0) „et;

2176 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_19
);

2177 ià(
»t
 < 0) „et;

2181 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_20
);

2182 ià(
»t
 < 0) „et;

2186 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_21
);

2187 ià(
»t
 < 0) „et;

2191 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_22
);

2192 ià(
»t
 < 0) „et;

2196 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_23
);

2197 ià(
»t
 < 0) „et;

2201 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_24
);

2202 ià(
»t
 < 0) „et;

2206 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_25
);

2207 ià(
»t
 < 0) „et;

2211 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_26
);

2212 ià(
»t
 < 0) „et;

2216 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_27
);

2217 ià(
»t
 < 0) „et;

2221 { 
m4
 = 
l
 - 
c
; ()m4;

2222 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb3
;

2223 
c
--;

2225 
Ïb3
:

2226 
c
 = 
l
 - 
m4
;

2228 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_28
);

2229 ià(
»t
 < 0) „et;

2233 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_29
);

2234 ià(
»t
 < 0) „et;

2238 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_30
);

2239 ià(
»t
 < 0) „et;

2243 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_31
);

2244 ià(
»t
 < 0) „et;

2248 { 
m5
 = 
l
 - 
c
; ()m5;

2249 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'p'è
Ïb4
;

2250 
c
--;

2252 
Ïb4
:

2253 
c
 = 
l
 - 
m5
;

2255 { 
m6
 = 
l
 - 
c
; ()m6;

2256 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ't'è
Ïb5
;

2257 
c
--;

2259 
Ïb5
:

2260 
c
 = 
l
 - 
m6
;

2262 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_32
);

2263 ià(
»t
 < 0) „et;

2267 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_33
);

2268 ià(
»t
 < 0) „et;

2272 { 
m7
 = 
l
 - 
c
; ()m7;

2273 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'm'è
Ïb6
;

2274 
c
--;

2276 
Ïb6
:

2277 
c
 = 
l
 - 
m7
;

2279 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_34
);

2280 ià(
»t
 < 0) „et;

2284 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_35
);

2285 ià(
»t
 < 0) „et;

2289 { 
m8
 = 
l
 - 
c
; ()m8;

2290 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'n'è
Ïb7
;

2291 
c
--;

2293 
Ïb7
:

2294 
c
 = 
l
 - 
m8
;

2296 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_36
);

2297 ià(
»t
 < 0) „et;

2301 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_37
);

2302 ià(
»t
 < 0) „et;

2306 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_38
);

2307 ià(
»t
 < 0) „et;

2312 
	}
}

2314 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$¡em
() {

2315 
lb
 = 
c
; c = 
l
;

2317 { 
m1
 = 
l
 - 
c
; ()m1;

2318 { 
»t
 = 
	`r_’dšgs
();

2319 ià(
»t
 =ğ0è
Ïb0
;

2320 ià(
»t
 < 0) „et;

2322 
Ïb0
:

2323 
c
 = 
l
 - 
m1
;

2325 { 
m2
 = 
l
 - 
c
; ()m2;

2326 { 
»t
 = 
	`r_undoubË
();

2327 ià(
»t
 =ğ0è
Ïb1
;

2328 ià(
»t
 < 0) „et;

2330 
Ïb1
:

2331 
c
 = 
l
 - 
m2
;

2333 { 
m3
 = 
l
 - 
c
; ()m3;

2334 { 
»t
 = 
	`r_»¥–l
();

2335 ià(
»t
 =ğ0è
Ïb2
;

2336 ià(
»t
 < 0) „et;

2338 
Ïb2
:

2339 
c
 = 
l
 - 
m3
;

2341 
c
 = 
lb
;

2343 
	}
}

2345 
	gX­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$IÁ”ÇlS‹mLovšs
()

2347 
	}
}

2349 
X­Ÿn
::
IÁ”ÇlS‹mLovšs
::~
	$IÁ”ÇlS‹mLovšs
()

2351 
	}
}

2354 
X­Ÿn
::
IÁ”ÇlS‹mLovšs
::
	$g‘_desütiÚ
() const

2357 
	}
}

	@languages/lovins.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mLovšs
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
public
:

9 
r_»¥–l
();

10 
r_undoubË
();

11 
r_’dšgs
();

12 
r_CC
();

13 
r_BB
();

14 
r_AA
();

15 
r_Z
();

16 
r_Y
();

17 
r_X
();

18 
r_W
();

19 
r_V
();

20 
r_U
();

21 
r_T
();

22 
r_S
();

23 
r_R
();

24 
r_Q
();

25 
r_P
();

26 
r_O
();

27 
r_N
();

28 
r_M
();

29 
r_L
();

30 
r_K
();

31 
r_J
();

32 
r_I
();

33 
r_H
();

34 
r_G
();

35 
r_F
();

36 
r_E
();

37 
r_D
();

38 
r_C
();

39 
r_B
();

40 
r_A
();

42 
IÁ”ÇlS‹mLovšs
();

43 ~
IÁ”ÇlS‹mLovšs
();

44 
¡em
();

45 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/norwegian.cc

3 
	~<lim™s.h
>

4 
	~"nÜwegŸn.h
"

6 
	#s_0_0
 
s_0_3


	)

7 
	#s_0_1
 (
s_0_2
 + 2)

	)

8 
	#s_0_2
 
s_0_17


	)

9 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

10 
	#s_0_3
 0

	)

12 
	#s_0_4
 
s_0_18


	)

13 
	#s_0_5
 4

	)

15 
	#s_0_6
 (
s_0_7
 + 3)

	)

16 
	#s_0_7
 
s_0_20


	)

17 
	#s_0_8
 7

	)

19 
	#s_0_9
 
s_0_4


	)

20 
	#s_0_10
 
s_0_7


	)

21 
	#s_0_11
 11

	)

23 
	#s_0_12
 
s_0_8


	)

24 
	#s_0_13
 13

	)

26 
	#s_0_14
 (
s_0_15
 + 1)

	)

27 
	#s_0_15
 
s_0_28


	)

28 
	#s_0_16
 (
s_0_17
 + 2)

	)

29 
	#s_0_17
 18

	)

31 
	#s_0_18
 22

	)

33 
	#s_0_19
 (
s_0_20
 + 3)

	)

34 
	#s_0_20
 27

	)

36 
	#s_0_21
 (
s_0_22
 + 3)

	)

37 
	#s_0_22
 34

	)

39 
	#s_0_23
 40

	)

41 
	#s_0_24
 43

	)

43 
	#s_0_25
 (
s_0_7
 + 1)

	)

44 
	#s_0_26
 
s_0_7


	)

45 
	#s_0_27
 
s_0_8


	)

46 
	#s_0_28
 46

	)

48 
	#s_1_0
 49

	)

50 
	#s_1_1
 51

	)

52 
	#s_2_0
 (
s_2_1
 + 1)

	)

53 
	#s_2_1
 53

	)

55 
	#s_2_2
 (
s_2_3
 + 1)

	)

56 
	#s_2_3
 57

	)

58 
	#s_2_4
 (
s_2_5
 + 1)

	)

59 
	#s_2_5
 60

	)

61 
	#s_2_6
 64

	)

63 
	#s_2_7
 (
s_2_8
 + 1)

	)

64 
	#s_2_8
 67

	)

66 
	#s_2_9
 (
s_2_10
 + 3)

	)

67 
	#s_2_10
 71

	)

72 cÚ¡ 
amÚg
 
	ga_0
[29] =

74  { 1, 
s_0_0
, -1, 1},

75  { 1, 
s_0_1
, -1, 1},

76  { 3, 
s_0_2
, 1, 1},

77  { 4, 
s_0_3
, 1, 1},

78  { 4, 
s_0_4
, 1, 1},

79  { 3, 
s_0_5
, 1, 1},

80  { 3, 
s_0_6
, 1, 1},

81  { 6, 
s_0_7
, 6, 1},

82  { 4, 
s_0_8
, 1, 3},

83  { 2, 
s_0_9
, -1, 1},

84  { 5, 
s_0_10
, 9, 1},

85  { 2, 
s_0_11
, -1, 1},

86  { 2, 
s_0_12
, -1, 1},

87  { 5, 
s_0_13
, 12, 1},

88  { 1, 
s_0_14
, -1, 2},

89  { 2, 
s_0_15
, 14, 1},

90  { 2, 
s_0_16
, 14, 1},

91  { 4, 
s_0_17
, 16, 1},

92  { 5, 
s_0_18
, 16, 1},

93  { 4, 
s_0_19
, 16, 1},

94  { 7, 
s_0_20
, 19, 1},

95  { 3, 
s_0_21
, 14, 1},

96  { 6, 
s_0_22
, 21, 1},

97  { 3, 
s_0_23
, 14, 1},

98  { 3, 
s_0_24
, 14, 1},

99  { 2, 
s_0_25
, -1, 1},

100  { 3, 
s_0_26
, 25, 1},

101  { 3, 
s_0_27
, -1, 3},

102  { 3, 
s_0_28
, -1, 1}

106 cÚ¡ 
amÚg
 
	ga_1
[2] =

108  { 2, 
s_1_0
, -1, -1},

109  { 2, 
s_1_1
, -1, -1}

113 cÚ¡ 
amÚg
 
	ga_2
[11] =

115  { 3, 
s_2_0
, -1, 1},

116  { 4, 
s_2_1
, 0, 1},

117  { 2, 
s_2_2
, -1, 1},

118  { 3, 
s_2_3
, 2, 1},

119  { 3, 
s_2_4
, 2, 1},

120  { 4, 
s_2_5
, 4, 1},

121  { 3, 
s_2_6
, -1, 1},

122  { 3, 
s_2_7
, -1, 1},

123  { 4, 
s_2_8
, 7, 1},

124  { 4, 
s_2_9
, 7, 1},

125  { 7, 
s_2_10
, 9, 1}

128 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 48, 0, 128 };

130 cÚ¡ 
	gg_s_’dšg
[] = { 119, 125, 149, 1 };

132 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'e', 'r' };

134 
	gX­Ÿn
::
IÁ”ÇlS‹mNÜwegŸn
::
	$r_m¬k_»giÚs
() {

135 
I_p1
 = 
l
;

136 { 
c_‹¡1
 = 
c
;

137 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 3);

138 ià(
»t
 < 0)  0;

139 
c
 = 
»t
;

141 
I_x
 = 
c
;

142 
c
 = 
c_‹¡1
;

144 ià(
	`out_groupšg_U
(
g_v
, 97, 248, 1) < 0)  0;

145 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 248, 1);

146 ià(
»t
 < 0)  0;

147 
c
 +ğ
»t
;

149 
I_p1
 = 
c
;

151 ià(!(
I_p1
 < 
I_x
)è
Ïb0
;

152 
I_p1
 = 
I_x
;

153 
Ïb0
:

155 
	}
}

157 
	gX­Ÿn
::
IÁ”ÇlS‹mNÜwegŸn
::
	$r_maš_suffix
() {

158 
amÚg_v¬
;

159 { 
m1
 = 
l
 - 
c
; ()m1;

160 
mlim™1
;

161 ià(
c
 < 
I_p1
)  0;

162 
c
 = 
I_p1
;

163 
mlim™1
 = 
lb
;†b = 
c
;

164 
c
 = 
l
 - 
m1
;

165 
k‘
 = 
c
;

166 ià(
c
 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1851426 >> (p[ø- 1] & 0x1f)è& 1)è{†b = 
mlim™1
;  0; }

167 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 29, 0, 0);

168 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

169 
b¿
 = 
c
;

170 
lb
 = 
mlim™1
;

172 
amÚg_v¬
) {

175 ià(
	`¦iû_d–
() == -1)  -1;

178 { 
m2
 = 
l
 - 
c
; ()m2;

179 ià(
	`š_groupšg_b_U
(
g_s_’dšg
, 98, 122, 0)è
Ïb1
;

180 
Ïb0
;

181 
Ïb1
:

182 
c
 = 
l
 - 
m2
;

183 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'k')  0;

184 
c
--;

185 ià(
	`out_groupšg_b_U
(
g_v
, 97, 248, 0))  0;

187 
Ïb0
:

188 ià(
	`¦iû_d–
() == -1)  -1;

191 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_0
);

192 ià(
»t
 < 0) „et;

197 
	}
}

199 
	gX­Ÿn
::
IÁ”ÇlS‹mNÜwegŸn
::
	$r_cÚsÚªt_·œ
() {

200 { 
m_‹¡1
 = 
l
 - 
c
;

201 { 
m2
 = 
l
 - 
c
; ()m2;

202 
mlim™2
;

203 ià(
c
 < 
I_p1
)  0;

204 
c
 = 
I_p1
;

205 
mlim™2
 = 
lb
;†b = 
c
;

206 
c
 = 
l
 - 
m2
;

207 
k‘
 = 
c
;

208 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] !ğ116è{†b = 
mlim™2
;  0; }

209 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 2, 0, 0))è{ 
lb
 = 
mlim™2
;  0; }

210 
b¿
 = 
c
;

211 
lb
 = 
mlim™2
;

213 
c
 = 
l
 - 
m_‹¡1
;

215 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

216 ià(
»t
 < 0)  0;

217 
c
 = 
»t
;

219 
b¿
 = 
c
;

220 ià(
	`¦iû_d–
() == -1)  -1;

222 
	}
}

224 
	gX­Ÿn
::
IÁ”ÇlS‹mNÜwegŸn
::
	$r_Ùh”_suffix
() {

225 
amÚg_v¬
;

226 { 
m1
 = 
l
 - 
c
; ()m1;

227 
mlim™1
;

228 ià(
c
 < 
I_p1
)  0;

229 
c
 = 
I_p1
;

230 
mlim™1
 = 
lb
;†b = 
c
;

231 
c
 = 
l
 - 
m1
;

232 
k‘
 = 
c
;

233 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((4718720 >> (p[ø- 1] & 0x1f)è& 1)è{†b = 
mlim™1
;  0; }

234 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 11, 0, 0);

235 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

236 
b¿
 = 
c
;

237 
lb
 = 
mlim™1
;

239 
amÚg_v¬
) {

242 ià(
	`¦iû_d–
() == -1)  -1;

246 
	}
}

248 
	gX­Ÿn
::
IÁ”ÇlS‹mNÜwegŸn
::
	$¡em
() {

249 { 
c1
 = 
c
;

250 { 
»t
 = 
	`r_m¬k_»giÚs
();

251 ià(
»t
 =ğ0è
Ïb0
;

252 ià(
»t
 < 0) „et;

254 
Ïb0
:

255 
c
 = 
c1
;

257 
lb
 = 
c
; c = 
l
;

259 { 
m2
 = 
l
 - 
c
; ()m2;

260 { 
»t
 = 
	`r_maš_suffix
();

261 ià(
»t
 =ğ0è
Ïb1
;

262 ià(
»t
 < 0) „et;

264 
Ïb1
:

265 
c
 = 
l
 - 
m2
;

267 { 
m3
 = 
l
 - 
c
; ()m3;

268 { 
»t
 = 
	`r_cÚsÚªt_·œ
();

269 ià(
»t
 =ğ0è
Ïb2
;

270 ià(
»t
 < 0) „et;

272 
Ïb2
:

273 
c
 = 
l
 - 
m3
;

275 { 
m4
 = 
l
 - 
c
; ()m4;

276 { 
»t
 = 
	`r_Ùh”_suffix
();

277 ià(
»t
 =ğ0è
Ïb3
;

278 ià(
»t
 < 0) „et;

280 
Ïb3
:

281 
c
 = 
l
 - 
m4
;

283 
c
 = 
lb
;

285 
	}
}

287 
	gX­Ÿn
::
IÁ”ÇlS‹mNÜwegŸn
::
	$IÁ”ÇlS‹mNÜwegŸn
()

288 : 
	`I_x
(0), 
	$I_p1
(0)

290 
	}
}

292 
	gX­Ÿn
::
IÁ”ÇlS‹mNÜwegŸn
::~
	$IÁ”ÇlS‹mNÜwegŸn
()

294 
	}
}

297 
X­Ÿn
::
IÁ”ÇlS‹mNÜwegŸn
::
	$g‘_desütiÚ
() const

300 
	}
}

	@languages/norwegian.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mNÜwegŸn
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_x
;

9 
	gI_p1
;

10 
	gpublic
:

11 
r_Ùh”_suffix
();

12 
r_cÚsÚªt_·œ
();

13 
r_maš_suffix
();

14 
r_m¬k_»giÚs
();

16 
IÁ”ÇlS‹mNÜwegŸn
();

17 ~
IÁ”ÇlS‹mNÜwegŸn
();

18 
¡em
();

19 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/porter.cc

3 
	~<lim™s.h
>

4 
	~"pÜ‹r.h
"

6 
	#s_0_0
 (
s_0_1
 + 2)

	)

7 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

8 
	#s_0_1
 0

	)

10 
	#s_0_2
 3

	)

12 
	#s_0_3
 
s_0_2


	)

13 
	#s_1_1
 7

	)

15 
	#s_1_2
 9

	)

17 
	#s_1_3
 11

	)

19 
	#s_1_4
 13

	)

21 
	#s_1_5
 15

	)

23 
	#s_1_6
 17

	)

25 
	#s_1_7
 19

	)

27 
	#s_1_8
 21

	)

29 
	#s_1_9
 23

	)

31 
	#s_1_10
 25

	)

33 
	#s_1_11
 27

	)

35 
	#s_1_12
 29

	)

37 
	#s_2_0
 (
s_2_1
 + 1)

	)

38 
	#s_2_1
 31

	)

40 
	#s_2_2
 34

	)

42 
	#s_3_0
 37

	)

44 
	#s_3_1
 41

	)

46 
	#s_3_2
 45

	)

48 
	#s_3_3
 49

	)

50 
	#s_3_4
 52

	)

52 
	#s_3_5
 56

	)

54 
	#s_3_6
 61

	)

56 
	#s_3_7
 66

	)

58 
	#s_3_8
 71

	)

60 
	#s_3_9
 77

	)

62 
	#s_3_10
 (
s_3_11
 + 1)

	)

63 
	#s_3_11
 82

	)

65 
	#s_3_12
 89

	)

67 
	#s_3_13
 
s_3_11


	)

68 
	#s_3_14
 94

	)

70 
	#s_3_15
 101

	)

72 
	#s_3_16
 105

	)

74 
	#s_3_17
 109

	)

76 
	#s_3_18
 116

	)

78 
	#s_3_19
 123

	)

80 
	#s_4_0
 130

	)

82 
	#s_4_1
 135

	)

84 
	#s_4_2
 140

	)

86 
	#s_4_3
 145

	)

88 
	#s_4_4
 150

	)

90 
	#s_4_5
 154

	)

92 
	#s_4_6
 157

	)

94 
	#s_5_0
 161

	)

96 
	#s_5_1
 163

	)

98 
	#s_5_2
 167

	)

100 
	#s_5_3
 171

	)

102 
	#s_5_4
 175

	)

104 
	#s_5_5
 179

	)

106 
	#s_5_6
 182

	)

108 
	#s_5_7
 185

	)

110 
	#s_5_8
 188

	)

112 
	#s_5_9
 191

	)

114 
	#s_5_10
 193

	)

116 
	#s_5_11
 196

	)

118 
	#s_5_12
 199

	)

120 
	#s_5_13
 201

	)

122 
	#s_5_14
 204

	)

124 
	#s_5_15
 (
s_5_16
 + 1)

	)

125 
	#s_5_16
 (
s_5_17
 + 1)

	)

126 
	#s_5_17
 207

	)

128 
	#s_5_18
 
s_5_13


	)

132 cÚ¡ 
amÚg
 
	ga_0
[4] =

134  { 1, 
s_0_0
, -1, 3},

135  { 3, 
s_0_1
, 0, 2},

136  { 4, 
s_0_2
, 0, 1},

137  { 2, 
s_0_3
, 0, -1}

141 cÚ¡ 
amÚg
 
	ga_1
[13] =

144  { 2, 
s_1_1
, 0, 2},

145  { 2, 
s_1_2
, 0, 2},

146  { 2, 
s_1_3
, 0, 2},

147  { 2, 
s_1_4
, 0, 2},

148  { 2, 
s_1_5
, 0, 1},

149  { 2, 
s_1_6
, 0, 2},

150  { 2, 
s_1_7
, 0, 2},

151  { 2, 
s_1_8
, 0, 2},

152  { 2, 
s_1_9
, 0, 2},

153  { 2, 
s_1_10
, 0, 1},

154  { 2, 
s_1_11
, 0, 2},

155  { 2, 
s_1_12
, 0, 1}

159 cÚ¡ 
amÚg
 
	ga_2
[3] =

161  { 2, 
s_2_0
, -1, 2},

162  { 3, 
s_2_1
, 0, 1},

163  { 3, 
s_2_2
, -1, 2}

167 cÚ¡ 
amÚg
 
	ga_3
[20] =

169  { 4, 
s_3_0
, -1, 3},

170  { 4, 
s_3_1
, -1, 2},

171  { 4, 
s_3_2
, -1, 4},

172  { 3, 
s_3_3
, -1, 6},

173  { 4, 
s_3_4
, -1, 9},

174  { 5, 
s_3_5
, -1, 12},

175  { 5, 
s_3_6
, -1, 5},

176  { 5, 
s_3_7
, -1, 10},

177  { 6, 
s_3_8
, -1, 14},

178  { 5, 
s_3_9
, -1, 13},

179  { 6, 
s_3_10
, -1, 1},

180  { 7, 
s_3_11
, 10, 8},

181  { 5, 
s_3_12
, -1, 10},

182  { 5, 
s_3_13
, -1, 8},

183  { 7, 
s_3_14
, 13, 7},

184  { 4, 
s_3_15
, -1, 7},

185  { 4, 
s_3_16
, -1, 8},

186  { 7, 
s_3_17
, -1, 13},

187  { 7, 
s_3_18
, -1, 11},

188  { 7, 
s_3_19
, -1, 12}

192 cÚ¡ 
amÚg
 
	ga_4
[7] =

194  { 5, 
s_4_0
, -1, 2},

195  { 5, 
s_4_1
, -1, 3},

196  { 5, 
s_4_2
, -1, 1},

197  { 5, 
s_4_3
, -1, 2},

198  { 4, 
s_4_4
, -1, 2},

199  { 3, 
s_4_5
, -1, 3},

200  { 4, 
s_4_6
, -1, 3}

204 cÚ¡ 
amÚg
 
	ga_5
[19] =

206  { 2, 
s_5_0
, -1, 1},

207  { 4, 
s_5_1
, -1, 1},

208  { 4, 
s_5_2
, -1, 1},

209  { 4, 
s_5_3
, -1, 1},

210  { 4, 
s_5_4
, -1, 1},

211  { 3, 
s_5_5
, -1, 1},

212  { 3, 
s_5_6
, -1, 1},

213  { 3, 
s_5_7
, -1, 1},

214  { 3, 
s_5_8
, -1, 1},

215  { 2, 
s_5_9
, -1, 1},

216  { 3, 
s_5_10
, -1, 1},

217  { 3, 
s_5_11
, -1, 2},

218  { 2, 
s_5_12
, -1, 1},

219  { 3, 
s_5_13
, -1, 1},

220  { 3, 
s_5_14
, -1, 1},

221  { 3, 
s_5_15
, -1, 1},

222  { 4, 
s_5_16
, 15, 1},

223  { 5, 
s_5_17
, 16, 1},

224  { 2, 
s_5_18
, -1, 1}

227 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1 };

229 cÚ¡ 
	gg_v_WXY
[] = { 1, 17, 65, 208, 1 };

231 cÚ¡ 
symbŞ
 
	gs_0
[] = { 's', 's' };

232 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'i' };

233 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'e', 'e' };

234 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'e' };

235 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'e' };

236 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'i' };

237 cÚ¡ 
symbŞ
 
	gs_6
[] = { 't', 'i', 'o', 'n' };

238 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'e', 'n', 'c', 'e' };

239 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'a', 'n', 'c', 'e' };

240 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'a', 'b', 'l', 'e' };

241 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'e', 'n', 't' };

242 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'e' };

243 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'i', 'z', 'e' };

244 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'a', 't', 'e' };

245 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'a', 'l' };

246 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'a', 'l' };

247 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'f', 'u', 'l' };

248 cÚ¡ 
symbŞ
 
	gs_17
[] = { 'o', 'u', 's' };

249 cÚ¡ 
symbŞ
 
	gs_18
[] = { 'i', 'v', 'e' };

250 cÚ¡ 
symbŞ
 
	gs_19
[] = { 'b', 'l', 'e' };

251 cÚ¡ 
symbŞ
 
	gs_20
[] = { 'a', 'l' };

252 cÚ¡ 
symbŞ
 
	gs_21
[] = { 'i', 'c' };

253 cÚ¡ 
symbŞ
 
	gs_22
[] = { 'Y' };

254 cÚ¡ 
symbŞ
 
	gs_23
[] = { 'Y' };

255 cÚ¡ 
symbŞ
 
	gs_24
[] = { 'y' };

257 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_shÜtv
() {

258 ià(
	`out_groupšg_b_U
(
g_v_WXY
, 89, 121, 0))  0;

259 ià(
	`š_groupšg_b_U
(
g_v
, 97, 121, 0))  0;

260 ià(
	`out_groupšg_b_U
(
g_v
, 97, 121, 0))  0;

262 
	}
}

264 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_R1
() {

265 ià(!(
I_p1
 <ğ
c
))  0;

267 
	}
}

269 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_R2
() {

270 ià(!(
I_p2
 <ğ
c
))  0;

272 
	}
}

274 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_S‹p_1a
() {

275 
amÚg_v¬
;

276 
k‘
 = 
c
;

277 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 115)  0;

278 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 4, 0, 0);

279 ià(!(
amÚg_v¬
))  0;

280 
b¿
 = 
c
;

281 
amÚg_v¬
) {

284 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_0
);

285 ià(
»t
 < 0) „et;

289 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_1
);

290 ià(
»t
 < 0) „et;

294 ià(
	`¦iû_d–
() == -1)  -1;

298 
	}
}

300 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_S‹p_1b
() {

301 
amÚg_v¬
;

302 
k‘
 = 
c
;

303 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 100 &&…[c - 1] != 103))  0;

304 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 3, 0, 0);

305 ià(!(
amÚg_v¬
))  0;

306 
b¿
 = 
c
;

307 
amÚg_v¬
) {

310 { 
»t
 = 
	`r_R1
();

311 ià(
»t
 <= 0) „et;

313 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_2
);

314 ià(
»t
 < 0) „et;

318 { 
m_‹¡1
 = 
l
 - 
c
;

319 { 
»t
 = 
	`out_groupšg_b_U
(
g_v
, 97, 121, 1);

320 ià(
»t
 < 0)  0;

321 
c
 -ğ
»t
;

323 
c
 = 
l
 - 
m_‹¡1
;

325 ià(
	`¦iû_d–
() == -1)  -1;

326 { 
m_‹¡2
 = 
l
 - 
c
;

327 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((68514004 >> (p[ø- 1] & 0x1f)è& 1)è
amÚg_v¬
 = 3; 

328 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 13, 0, 0);

329 ià(!(
amÚg_v¬
))  0;

330 
c
 = 
l
 - 
m_‹¡2
;

332 
amÚg_v¬
) {

335 { 
§ved_c
 = 
c
;

336 
	`š£¹_s
(
c
, c, 1, 
s_3
);

337 
c
 = 
§ved_c
;

341 
k‘
 = 
c
;

342 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

343 ià(
»t
 < 0)  0;

344 
c
 = 
»t
;

346 
b¿
 = 
c
;

347 ià(
	`¦iû_d–
() == -1)  -1;

350 ià(
c
 !ğ
I_p1
)  0;

351 { 
m_‹¡3
 = 
l
 - 
c
;

352 { 
»t
 = 
	`r_shÜtv
();

353 ià(
»t
 <= 0) „et;

355 
c
 = 
l
 - 
m_‹¡3
;

357 { 
§ved_c
 = 
c
;

358 
	`š£¹_s
(
c
, c, 1, 
s_4
);

359 
c
 = 
§ved_c
;

366 
	}
}

368 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_S‹p_1c
() {

369 
k‘
 = 
c
;

370 { 
m1
 = 
l
 - 
c
; ()m1;

371 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'y'è
Ïb1
;

372 
c
--;

373 
Ïb0
;

374 
Ïb1
:

375 
c
 = 
l
 - 
m1
;

376 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'Y')  0;

377 
c
--;

379 
Ïb0
:

380 
b¿
 = 
c
;

381 { 
»t
 = 
	`out_groupšg_b_U
(
g_v
, 97, 121, 1);

382 ià(
»t
 < 0)  0;

383 
c
 -ğ
»t
;

385 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_5
);

386 ià(
»t
 < 0) „et;

389 
	}
}

391 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_S‹p_2
() {

392 
amÚg_v¬
;

393 
k‘
 = 
c
;

394 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((815616 >> (p[c - 1] & 0x1f)) & 1))  0;

395 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 20, 0, 0);

396 ià(!(
amÚg_v¬
))  0;

397 
b¿
 = 
c
;

398 { 
»t
 = 
	`r_R1
();

399 ià(
»t
 <= 0) „et;

401 
amÚg_v¬
) {

404 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_6
);

405 ià(
»t
 < 0) „et;

409 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_7
);

410 ià(
»t
 < 0) „et;

414 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_8
);

415 ià(
»t
 < 0) „et;

419 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_9
);

420 ià(
»t
 < 0) „et;

424 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_10
);

425 ià(
»t
 < 0) „et;

429 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_11
);

430 ià(
»t
 < 0) „et;

434 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_12
);

435 ià(
»t
 < 0) „et;

439 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_13
);

440 ià(
»t
 < 0) „et;

444 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_14
);

445 ià(
»t
 < 0) „et;

449 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_15
);

450 ià(
»t
 < 0) „et;

454 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_16
);

455 ià(
»t
 < 0) „et;

459 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_17
);

460 ià(
»t
 < 0) „et;

464 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_18
);

465 ià(
»t
 < 0) „et;

469 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_19
);

470 ià(
»t
 < 0) „et;

475 
	}
}

477 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_S‹p_3
() {

478 
amÚg_v¬
;

479 
k‘
 = 
c
;

480 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((528928 >> (p[c - 1] & 0x1f)) & 1))  0;

481 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 7, 0, 0);

482 ià(!(
amÚg_v¬
))  0;

483 
b¿
 = 
c
;

484 { 
»t
 = 
	`r_R1
();

485 ià(
»t
 <= 0) „et;

487 
amÚg_v¬
) {

490 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_20
);

491 ià(
»t
 < 0) „et;

495 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_21
);

496 ià(
»t
 < 0) „et;

500 ià(
	`¦iû_d–
() == -1)  -1;

504 
	}
}

506 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_S‹p_4
() {

507 
amÚg_v¬
;

508 
k‘
 = 
c
;

509 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((3961384 >> (p[c - 1] & 0x1f)) & 1))  0;

510 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 19, 0, 0);

511 ià(!(
amÚg_v¬
))  0;

512 
b¿
 = 
c
;

513 { 
»t
 = 
	`r_R2
();

514 ià(
»t
 <= 0) „et;

516 
amÚg_v¬
) {

519 ià(
	`¦iû_d–
() == -1)  -1;

522 { 
m1
 = 
l
 - 
c
; ()m1;

523 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb1
;

524 
c
--;

525 
Ïb0
;

526 
Ïb1
:

527 
c
 = 
l
 - 
m1
;

528 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 't')  0;

529 
c
--;

531 
Ïb0
:

532 ià(
	`¦iû_d–
() == -1)  -1;

536 
	}
}

538 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_S‹p_5a
() {

539 
k‘
 = 
c
;

540 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'e')  0;

541 
c
--;

542 
b¿
 = 
c
;

543 { 
m1
 = 
l
 - 
c
; ()m1;

544 { 
»t
 = 
	`r_R2
();

545 ià(
»t
 =ğ0è
Ïb1
;

546 ià(
»t
 < 0) „et;

548 
Ïb0
;

549 
Ïb1
:

550 
c
 = 
l
 - 
m1
;

551 { 
»t
 = 
	`r_R1
();

552 ià(
»t
 <= 0) „et;

554 { 
m2
 = 
l
 - 
c
; ()m2;

555 { 
»t
 = 
	`r_shÜtv
();

556 ià(
»t
 =ğ0è
Ïb2
;

557 ià(
»t
 < 0) „et;

560 
Ïb2
:

561 
c
 = 
l
 - 
m2
;

564 
Ïb0
:

565 ià(
	`¦iû_d–
() == -1)  -1;

567 
	}
}

569 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$r_S‹p_5b
() {

570 
k‘
 = 
c
;

571 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'l')  0;

572 
c
--;

573 
b¿
 = 
c
;

574 { 
»t
 = 
	`r_R2
();

575 ià(
»t
 <= 0) „et;

577 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'l')  0;

578 
c
--;

579 ià(
	`¦iû_d–
() == -1)  -1;

581 
	}
}

583 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$¡em
() {

584 
B_Y_found
 = 0;

585 { 
c1
 = 
c
;

586 
b¿
 = 
c
;

587 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb0
;

588 
c
++;

589 
k‘
 = 
c
;

590 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_22
);

591 ià(
»t
 < 0) „et;

593 
B_Y_found
 = 1;

594 
Ïb0
:

595 
c
 = 
c1
;

597 { 
c2
 = 
c
;

599 
c3
 = 
c
;

601 
c4
 = 
c
;

602 ià(
	`š_groupšg_U
(
g_v
, 97, 121, 0)è
Ïb3
;

603 
b¿
 = 
c
;

604 ià(
c
 =ğ
l
 || 
p
[c] !ğ'y'è
Ïb3
;

605 
c
++;

606 
k‘
 = 
c
;

607 
c
 = 
c4
;

609 
Ïb3
:

610 
c
 = 
c4
;

611 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

612 ià(
»t
 < 0è
Ïb2
;

613 
c
 = 
»t
;

616 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_23
);

617 ià(
»t
 < 0) „et;

619 
B_Y_found
 = 1;

621 
Ïb2
:

622 
c
 = 
c3
;

625 
c
 = 
c2
;

627 
I_p1
 = 
l
;

628 
I_p2
 = 
l
;

629 { 
c5
 = 
c
;

630 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 121, 1);

631 ià(
»t
 < 0è
Ïb4
;

632 
c
 +ğ
»t
;

634 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 121, 1);

635 ià(
»t
 < 0è
Ïb4
;

636 
c
 +ğ
»t
;

638 
I_p1
 = 
c
;

639 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 121, 1);

640 ià(
»t
 < 0è
Ïb4
;

641 
c
 +ğ
»t
;

643 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 121, 1);

644 ià(
»t
 < 0è
Ïb4
;

645 
c
 +ğ
»t
;

647 
I_p2
 = 
c
;

648 
Ïb4
:

649 
c
 = 
c5
;

651 
lb
 = 
c
; c = 
l
;

653 { 
m6
 = 
l
 - 
c
; ()m6;

654 { 
»t
 = 
	`r_S‹p_1a
();

655 ià(
»t
 =ğ0è
Ïb5
;

656 ià(
»t
 < 0) „et;

658 
Ïb5
:

659 
c
 = 
l
 - 
m6
;

661 { 
m7
 = 
l
 - 
c
; ()m7;

662 { 
»t
 = 
	`r_S‹p_1b
();

663 ià(
»t
 =ğ0è
Ïb6
;

664 ià(
»t
 < 0) „et;

666 
Ïb6
:

667 
c
 = 
l
 - 
m7
;

669 { 
m8
 = 
l
 - 
c
; ()m8;

670 { 
»t
 = 
	`r_S‹p_1c
();

671 ià(
»t
 =ğ0è
Ïb7
;

672 ià(
»t
 < 0) „et;

674 
Ïb7
:

675 
c
 = 
l
 - 
m8
;

677 { 
m9
 = 
l
 - 
c
; ()m9;

678 { 
»t
 = 
	`r_S‹p_2
();

679 ià(
»t
 =ğ0è
Ïb8
;

680 ià(
»t
 < 0) „et;

682 
Ïb8
:

683 
c
 = 
l
 - 
m9
;

685 { 
m10
 = 
l
 - 
c
; ()m10;

686 { 
»t
 = 
	`r_S‹p_3
();

687 ià(
»t
 =ğ0è
Ïb9
;

688 ià(
»t
 < 0) „et;

690 
Ïb9
:

691 
c
 = 
l
 - 
m10
;

693 { 
m11
 = 
l
 - 
c
; ()m11;

694 { 
»t
 = 
	`r_S‹p_4
();

695 ià(
»t
 =ğ0è
Ïb10
;

696 ià(
»t
 < 0) „et;

698 
Ïb10
:

699 
c
 = 
l
 - 
m11
;

701 { 
m12
 = 
l
 - 
c
; ()m12;

702 { 
»t
 = 
	`r_S‹p_5a
();

703 ià(
»t
 =ğ0è
Ïb11
;

704 ià(
»t
 < 0) „et;

706 
Ïb11
:

707 
c
 = 
l
 - 
m12
;

709 { 
m13
 = 
l
 - 
c
; ()m13;

710 { 
»t
 = 
	`r_S‹p_5b
();

711 ià(
»t
 =ğ0è
Ïb12
;

712 ià(
»t
 < 0) „et;

714 
Ïb12
:

715 
c
 = 
l
 - 
m13
;

717 
c
 = 
lb
;

718 { 
c14
 = 
c
;

719 ià(!(
B_Y_found
)è
Ïb13
;

721 
c15
 = 
c
;

723 
c16
 = 
c
;

724 
b¿
 = 
c
;

725 ià(
c
 =ğ
l
 || 
p
[c] !ğ'Y'è
Ïb15
;

726 
c
++;

727 
k‘
 = 
c
;

728 
c
 = 
c16
;

730 
Ïb15
:

731 
c
 = 
c16
;

732 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

733 ià(
»t
 < 0è
Ïb14
;

734 
c
 = 
»t
;

737 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_24
);

738 ià(
»t
 < 0) „et;

741 
Ïb14
:

742 
c
 = 
c15
;

745 
Ïb13
:

746 
c
 = 
c14
;

749 
	}
}

751 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$IÁ”ÇlS‹mPÜ‹r
()

752 : 
	`B_Y_found
(0), 
	`I_p2
(0), 
	$I_p1
(0)

754 
	}
}

756 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::~
	$IÁ”ÇlS‹mPÜ‹r
()

758 
	}
}

761 
X­Ÿn
::
IÁ”ÇlS‹mPÜ‹r
::
	$g‘_desütiÚ
() const

764 
	}
}

	@languages/porter.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mPÜ‹r
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
B_Y_found
;

9 
	gI_p2
;

10 
	gI_p1
;

11 
	gpublic
:

12 
r_S‹p_5b
();

13 
r_S‹p_5a
();

14 
r_S‹p_4
();

15 
r_S‹p_3
();

16 
r_S‹p_2
();

17 
r_S‹p_1c
();

18 
r_S‹p_1b
();

19 
r_S‹p_1a
();

20 
r_R2
();

21 
r_R1
();

22 
r_shÜtv
();

24 
IÁ”ÇlS‹mPÜ‹r
();

25 ~
IÁ”ÇlS‹mPÜ‹r
();

26 
¡em
();

27 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/portuguese.cc

3 
	~<lim™s.h
>

4 
	~"pÜtugue£.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_1
 0

	)

9 
	#s_0_2
 2

	)

11 
	#s_1_1
 4

	)

13 
	#s_1_2
 6

	)

15 
	#s_2_0
 8

	)

17 
	#s_2_1
 10

	)

19 
	#s_2_2
 12

	)

21 
	#s_2_3
 14

	)

23 
	#s_3_0
 16

	)

25 
	#s_3_1
 20

	)

27 
	#s_3_2
 24

	)

29 
	#s_4_0
 29

	)

31 
	#s_4_1
 31

	)

33 
	#s_4_2
 35

	)

35 
	#s_5_0
 
s_5_25


	)

36 
	#s_5_1
 37

	)

38 
	#s_5_2
 
s_5_26


	)

39 
	#s_5_3
 
s_5_27


	)

40 
	#s_5_4
 
s_5_28


	)

41 
	#s_5_5
 
s_5_29


	)

42 
	#s_5_6
 
s_5_30


	)

43 
	#s_5_7
 
s_5_31


	)

44 
	#s_5_8
 
s_5_32


	)

45 
	#s_5_9
 
s_5_33


	)

46 
	#s_5_10
 
s_5_34


	)

47 
	#s_5_11
 
s_5_37


	)

48 
	#s_5_12
 (
s_5_13
 + 1)

	)

49 
	#s_5_13
 43

	)

51 
	#s_5_14
 49

	)

53 
	#s_5_15
 54

	)

55 
	#s_5_16
 59

	)

57 
	#s_5_17
 
s_5_39


	)

58 
	#s_5_18
 
s_5_40


	)

59 
	#s_5_19
 
s_5_41


	)

60 
	#s_5_20
 
s_5_42


	)

61 
	#s_5_21
 
s_5_43


	)

62 
	#s_5_22
 
s_5_44


	)

63 
	#s_5_23
 65

	)

65 
	#s_5_24
 
s_5_4


	)

66 
	#s_5_25
 71

	)

68 
	#s_5_26
 75

	)

70 
	#s_5_27
 82

	)

72 
	#s_5_28
 86

	)

74 
	#s_5_29
 92

	)

76 
	#s_5_30
 96

	)

78 
	#s_5_31
 101

	)

80 
	#s_5_32
 105

	)

82 
	#s_5_33
 109

	)

84 
	#s_5_34
 116

	)

86 
	#s_5_35
 122

	)

88 
	#s_5_36
 129

	)

90 
	#s_5_37
 135

	)

92 
	#s_5_38
 140

	)

94 
	#s_5_39
 147

	)

96 
	#s_5_40
 151

	)

98 
	#s_5_41
 156

	)

100 
	#s_5_42
 160

	)

102 
	#s_5_43
 167

	)

104 
	#s_5_44
 174

	)

106 
	#s_6_0
 
s_6_48


	)

107 
	#s_6_1
 
s_6_49


	)

108 
	#s_6_2
 (
s_6_3
 + 2)

	)

109 
	#s_6_3
 
s_6_22


	)

110 
	#s_6_4
 
s_6_23


	)

111 
	#s_6_5
 
s_6_24


	)

112 
	#s_6_6
 
s_6_25


	)

113 
	#s_6_7
 
s_6_26


	)

114 
	#s_6_8
 
s_6_27


	)

115 
	#s_6_9
 
s_6_28


	)

116 
	#s_6_10
 
s_6_33


	)

117 
	#s_6_11
 
s_6_34


	)

118 
	#s_6_12
 
s_6_35


	)

119 
	#s_6_13
 
s_6_68


	)

120 
	#s_6_14
 
s_6_69


	)

121 
	#s_6_15
 
s_6_70


	)

122 
	#s_6_16
 (
s_6_17
 + 2)

	)

123 
	#s_6_17
 
s_6_74


	)

124 
	#s_6_18
 
s_6_75


	)

125 
	#s_6_19
 
s_6_76


	)

126 
	#s_6_20
 (
s_6_21
 + 1)

	)

127 
	#s_6_21
 (
s_6_22
 + 2)

	)

128 
	#s_6_22
 178

	)

130 
	#s_6_23
 183

	)

132 
	#s_6_24
 188

	)

134 
	#s_6_25
 193

	)

136 
	#s_6_26
 197

	)

138 
	#s_6_27
 201

	)

140 
	#s_6_28
 205

	)

142 
	#s_6_29
 (
s_6_30
 + 2)

	)

143 
	#s_6_30
 
s_6_100


	)

144 
	#s_6_31
 
s_6_101


	)

145 
	#s_6_32
 
s_6_102


	)

146 
	#s_6_33
 209

	)

148 
	#s_6_34
 214

	)

150 
	#s_6_35
 219

	)

152 
	#s_6_36
 
s_6_88


	)

153 
	#s_6_37
 
s_6_89


	)

154 
	#s_6_38
 224

	)

156 
	#s_6_39
 228

	)

158 
	#s_6_40
 232

	)

160 
	#s_6_41
 236

	)

162 
	#s_6_42
 241

	)

164 
	#s_6_43
 246

	)

166 
	#s_6_44
 
s_6_3


	)

167 
	#s_6_45
 
s_6_4


	)

168 
	#s_6_46
 
s_6_5


	)

169 
	#s_6_47
 
s_6_10


	)

170 
	#s_6_48
 251

	)

172 
	#s_6_49
 255

	)

174 
	#s_6_50
 (
s_6_51
 + 2)

	)

175 
	#s_6_51
 259

	)

177 
	#s_6_52
 264

	)

179 
	#s_6_53
 269

	)

181 
	#s_6_54
 274

	)

183 
	#s_6_55
 278

	)

185 
	#s_6_56
 282

	)

187 
	#s_6_57
 286

	)

189 
	#s_6_58
 
s_6_11


	)

190 
	#s_6_59
 290

	)

192 
	#s_6_60
 295

	)

194 
	#s_6_61
 300

	)

196 
	#s_6_62
 305

	)

198 
	#s_6_63
 309

	)

200 
	#s_6_64
 313

	)

202 
	#s_6_65
 317

	)

204 
	#s_6_66
 322

	)

206 
	#s_6_67
 327

	)

208 
	#s_6_68
 332

	)

210 
	#s_6_69
 337

	)

212 
	#s_6_70
 342

	)

214 
	#s_6_71
 
s_6_12


	)

215 
	#s_6_72
 347

	)

217 
	#s_6_73
 (
s_6_74
 + 2)

	)

218 
	#s_6_74
 350

	)

220 
	#s_6_75
 355

	)

222 
	#s_6_76
 360

	)

224 
	#s_6_77
 365

	)

226 
	#s_6_78
 371

	)

228 
	#s_6_79
 377

	)

230 
	#s_6_80
 383

	)

232 
	#s_6_81
 390

	)

234 
	#s_6_82
 397

	)

236 
	#s_6_83
 404

	)

238 
	#s_6_84
 (
s_6_85
 + 2)

	)

239 
	#s_6_85
 410

	)

241 
	#s_6_86
 417

	)

243 
	#s_6_87
 424

	)

245 
	#s_6_88
 431

	)

247 
	#s_6_89
 435

	)

249 
	#s_6_90
 (
s_6_91
 + 3)

	)

250 
	#s_6_91
 439

	)

252 
	#s_6_92
 446

	)

254 
	#s_6_93
 453

	)

256 
	#s_6_94
 460

	)

258 
	#s_6_95
 (
s_6_96
 + 2)

	)

259 
	#s_6_96
 467

	)

261 
	#s_6_97
 475

	)

263 
	#s_6_98
 483

	)

265 
	#s_6_99
 (
s_6_100
 + 2)

	)

266 
	#s_6_100
 491

	)

268 
	#s_6_101
 497

	)

270 
	#s_6_102
 503

	)

272 
	#s_6_103
 509

	)

274 
	#s_6_104
 517

	)

276 
	#s_6_105
 525

	)

278 
	#s_6_106
 533

	)

280 
	#s_6_107
 537

	)

282 
	#s_6_108
 542

	)

284 
	#s_6_109
 547

	)

286 
	#s_6_110
 552

	)

288 
	#s_6_111
 557

	)

290 
	#s_6_112
 562

	)

292 
	#s_6_113
 567

	)

294 
	#s_6_114
 572

	)

296 
	#s_6_115
 574

	)

298 
	#s_6_116
 576

	)

300 
	#s_6_117
 
s_6_111


	)

301 
	#s_6_118
 
s_6_112


	)

302 
	#s_6_119
 
s_6_113


	)

303 
	#s_7_0
 578

	)

305 
	#s_7_1
 579

	)

307 
	#s_7_2
 
s_7_3


	)

308 
	#s_7_3
 580

	)

310 
	#s_7_4
 582

	)

312 
	#s_7_5
 584

	)

314 
	#s_7_6
 586

	)

316 
	#s_8_0
 588

	)

318 
	#s_8_1
 589

	)

320 
	#s_8_2
 591

	)

322 
	#s_8_3
 593

	)

327 cÚ¡ 
amÚg
 
	ga_0
[3] =

330  { 2, 
s_0_1
, 0, 1},

331  { 2, 
s_0_2
, 0, 2}

335 cÚ¡ 
amÚg
 
	ga_1
[3] =

338  { 2, 
s_1_1
, 0, 1},

339  { 2, 
s_1_2
, 0, 2}

343 cÚ¡ 
amÚg
 
	ga_2
[4] =

345  { 2, 
s_2_0
, -1, -1},

346  { 2, 
s_2_1
, -1, -1},

347  { 2, 
s_2_2
, -1, -1},

348  { 2, 
s_2_3
, -1, 1}

352 cÚ¡ 
amÚg
 
	ga_3
[3] =

354  { 4, 
s_3_0
, -1, 1},

355  { 4, 
s_3_1
, -1, 1},

356  { 5, 
s_3_2
, -1, 1}

360 cÚ¡ 
amÚg
 
	ga_4
[3] =

362  { 2, 
s_4_0
, -1, 1},

363  { 4, 
s_4_1
, -1, 1},

364  { 2, 
s_4_2
, -1, 1}

368 cÚ¡ 
amÚg
 
	ga_5
[45] =

370  { 3, 
s_5_0
, -1, 1},

371  { 6, 
s_5_1
, -1, 1},

372  { 6, 
s_5_2
, -1, 4},

373  { 3, 
s_5_3
, -1, 9},

374  { 5, 
s_5_4
, -1, 1},

375  { 3, 
s_5_5
, -1, 1},

376  { 4, 
s_5_6
, -1, 1},

377  { 3, 
s_5_7
, -1, 8},

378  { 3, 
s_5_8
, -1, 1},

379  { 6, 
s_5_9
, -1, 2},

380  { 5, 
s_5_10
, -1, 7},

381  { 4, 
s_5_11
, -1, 1},

382  { 5, 
s_5_12
, -1, 6},

383  { 6, 
s_5_13
, 12, 5},

384  { 5, 
s_5_14
, -1, 1},

385  { 5, 
s_5_15
, -1, 1},

386  { 6, 
s_5_16
, -1, 3},

387  { 3, 
s_5_17
, -1, 1},

388  { 4, 
s_5_18
, -1, 1},

389  { 3, 
s_5_19
, -1, 1},

390  { 6, 
s_5_20
, -1, 1},

391  { 6, 
s_5_21
, -1, 1},

392  { 3, 
s_5_22
, -1, 8},

393  { 6, 
s_5_23
, -1, 1},

394  { 4, 
s_5_24
, -1, 1},

395  { 4, 
s_5_25
, -1, 1},

396  { 7, 
s_5_26
, -1, 4},

397  { 4, 
s_5_27
, -1, 9},

398  { 6, 
s_5_28
, -1, 1},

399  { 4, 
s_5_29
, -1, 1},

400  { 5, 
s_5_30
, -1, 1},

401  { 4, 
s_5_31
, -1, 8},

402  { 4, 
s_5_32
, -1, 1},

403  { 7, 
s_5_33
, -1, 2},

404  { 6, 
s_5_34
, -1, 7},

405  { 7, 
s_5_35
, -1, 3},

406  { 6, 
s_5_36
, -1, 1},

407  { 5, 
s_5_37
, -1, 1},

408  { 7, 
s_5_38
, -1, 1},

409  { 4, 
s_5_39
, -1, 1},

410  { 5, 
s_5_40
, -1, 1},

411  { 4, 
s_5_41
, -1, 1},

412  { 7, 
s_5_42
, -1, 1},

413  { 7, 
s_5_43
, -1, 1},

414  { 4, 
s_5_44
, -1, 8}

418 cÚ¡ 
amÚg
 
	ga_6
[120] =

420  { 3, 
s_6_0
, -1, 1},

421  { 3, 
s_6_1
, -1, 1},

422  { 2, 
s_6_2
, -1, 1},

423  { 4, 
s_6_3
, 2, 1},

424  { 4, 
s_6_4
, 2, 1},

425  { 4, 
s_6_5
, 2, 1},

426  { 3, 
s_6_6
, -1, 1},

427  { 3, 
s_6_7
, -1, 1},

428  { 3, 
s_6_8
, -1, 1},

429  { 3, 
s_6_9
, -1, 1},

430  { 4, 
s_6_10
, -1, 1},

431  { 4, 
s_6_11
, -1, 1},

432  { 4, 
s_6_12
, -1, 1},

433  { 4, 
s_6_13
, -1, 1},

434  { 4, 
s_6_14
, -1, 1},

435  { 4, 
s_6_15
, -1, 1},

436  { 2, 
s_6_16
, -1, 1},

437  { 4, 
s_6_17
, 16, 1},

438  { 4, 
s_6_18
, 16, 1},

439  { 4, 
s_6_19
, 16, 1},

440  { 2, 
s_6_20
, -1, 1},

441  { 3, 
s_6_21
, 20, 1},

442  { 5, 
s_6_22
, 21, 1},

443  { 5, 
s_6_23
, 21, 1},

444  { 5, 
s_6_24
, 21, 1},

445  { 4, 
s_6_25
, 20, 1},

446  { 4, 
s_6_26
, 20, 1},

447  { 4, 
s_6_27
, 20, 1},

448  { 4, 
s_6_28
, 20, 1},

449  { 2, 
s_6_29
, -1, 1},

450  { 4, 
s_6_30
, 29, 1},

451  { 4, 
s_6_31
, 29, 1},

452  { 4, 
s_6_32
, 29, 1},

453  { 5, 
s_6_33
, 29, 1},

454  { 5, 
s_6_34
, 29, 1},

455  { 5, 
s_6_35
, 29, 1},

456  { 3, 
s_6_36
, -1, 1},

457  { 3, 
s_6_37
, -1, 1},

458  { 4, 
s_6_38
, -1, 1},

459  { 4, 
s_6_39
, -1, 1},

460  { 4, 
s_6_40
, -1, 1},

461  { 5, 
s_6_41
, -1, 1},

462  { 5, 
s_6_42
, -1, 1},

463  { 5, 
s_6_43
, -1, 1},

464  { 2, 
s_6_44
, -1, 1},

465  { 2, 
s_6_45
, -1, 1},

466  { 2, 
s_6_46
, -1, 1},

467  { 2, 
s_6_47
, -1, 1},

468  { 4, 
s_6_48
, 47, 1},

469  { 4, 
s_6_49
, 47, 1},

470  { 3, 
s_6_50
, 47, 1},

471  { 5, 
s_6_51
, 50, 1},

472  { 5, 
s_6_52
, 50, 1},

473  { 5, 
s_6_53
, 50, 1},

474  { 4, 
s_6_54
, 47, 1},

475  { 4, 
s_6_55
, 47, 1},

476  { 4, 
s_6_56
, 47, 1},

477  { 4, 
s_6_57
, 47, 1},

478  { 2, 
s_6_58
, -1, 1},

479  { 5, 
s_6_59
, 58, 1},

480  { 5, 
s_6_60
, 58, 1},

481  { 5, 
s_6_61
, 58, 1},

482  { 4, 
s_6_62
, 58, 1},

483  { 4, 
s_6_63
, 58, 1},

484  { 4, 
s_6_64
, 58, 1},

485  { 5, 
s_6_65
, 58, 1},

486  { 5, 
s_6_66
, 58, 1},

487  { 5, 
s_6_67
, 58, 1},

488  { 5, 
s_6_68
, 58, 1},

489  { 5, 
s_6_69
, 58, 1},

490  { 5, 
s_6_70
, 58, 1},

491  { 2, 
s_6_71
, -1, 1},

492  { 3, 
s_6_72
, 71, 1},

493  { 3, 
s_6_73
, 71, 1},

494  { 5, 
s_6_74
, 73, 1},

495  { 5, 
s_6_75
, 73, 1},

496  { 5, 
s_6_76
, 73, 1},

497  { 6, 
s_6_77
, 73, 1},

498  { 6, 
s_6_78
, 73, 1},

499  { 6, 
s_6_79
, 73, 1},

500  { 7, 
s_6_80
, 73, 1},

501  { 7, 
s_6_81
, 73, 1},

502  { 7, 
s_6_82
, 73, 1},

503  { 6, 
s_6_83
, 73, 1},

504  { 5, 
s_6_84
, 73, 1},

505  { 7, 
s_6_85
, 84, 1},

506  { 7, 
s_6_86
, 84, 1},

507  { 7, 
s_6_87
, 84, 1},

508  { 4, 
s_6_88
, -1, 1},

509  { 4, 
s_6_89
, -1, 1},

510  { 4, 
s_6_90
, -1, 1},

511  { 7, 
s_6_91
, 90, 1},

512  { 7, 
s_6_92
, 90, 1},

513  { 7, 
s_6_93
, 90, 1},

514  { 7, 
s_6_94
, 90, 1},

515  { 6, 
s_6_95
, 90, 1},

516  { 8, 
s_6_96
, 95, 1},

517  { 8, 
s_6_97
, 95, 1},

518  { 8, 
s_6_98
, 95, 1},

519  { 4, 
s_6_99
, -1, 1},

520  { 6, 
s_6_100
, 99, 1},

521  { 6, 
s_6_101
, 99, 1},

522  { 6, 
s_6_102
, 99, 1},

523  { 8, 
s_6_103
, 99, 1},

524  { 8, 
s_6_104
, 99, 1},

525  { 8, 
s_6_105
, 99, 1},

526  { 4, 
s_6_106
, -1, 1},

527  { 5, 
s_6_107
, -1, 1},

528  { 5, 
s_6_108
, -1, 1},

529  { 5, 
s_6_109
, -1, 1},

530  { 5, 
s_6_110
, -1, 1},

531  { 5, 
s_6_111
, -1, 1},

532  { 5, 
s_6_112
, -1, 1},

533  { 5, 
s_6_113
, -1, 1},

534  { 2, 
s_6_114
, -1, 1},

535  { 2, 
s_6_115
, -1, 1},

536  { 2, 
s_6_116
, -1, 1},

537  { 4, 
s_6_117
, -1, 1},

538  { 4, 
s_6_118
, -1, 1},

539  { 4, 
s_6_119
, -1, 1}

543 cÚ¡ 
amÚg
 
	ga_7
[7] =

545  { 1, 
s_7_0
, -1, 1},

546  { 1, 
s_7_1
, -1, 1},

547  { 1, 
s_7_2
, -1, 1},

548  { 2, 
s_7_3
, -1, 1},

549  { 2, 
s_7_4
, -1, 1},

550  { 2, 
s_7_5
, -1, 1},

551  { 2, 
s_7_6
, -1, 1}

555 cÚ¡ 
amÚg
 
	ga_8
[4] =

557  { 1, 
s_8_0
, -1, 1},

558  { 2, 
s_8_1
, -1, 2},

559  { 2, 
s_8_2
, -1, 1},

560  { 2, 
s_8_3
, -1, 1}

563 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 19, 12, 2 };

565 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'a', '~' };

566 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'o', '~' };

567 cÚ¡ 
symbŞ
 
	gs_2
[] = { 0xC3, 0xA3 };

568 cÚ¡ 
symbŞ
 
	gs_3
[] = { 0xC3, 0xB5 };

569 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'l', 'o', 'g' };

570 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'u' };

571 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'e', 'n', 't', 'e' };

572 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'a', 't' };

573 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'a', 't' };

574 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'i', 'r' };

575 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'c' };

577 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_´–ude
() {

578 
amÚg_v¬
;

580 
c1
 = 
c
;

581 
b¿
 = 
c
;

582 ià(
c
 + 1 >ğ
l
 || (
p
[ø+ 1] !ğ163 &&…[ø+ 1] !ğ181)è
amÚg_v¬
 = 3; 

583 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 3, 0, 0);

584 ià(!(
amÚg_v¬
)è
Ïb0
;

585 
k‘
 = 
c
;

586 
amÚg_v¬
) {

587 0: 
Ïb0
;

589 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_0
);

590 ià(
»t
 < 0) „et;

594 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_1
);

595 ià(
»t
 < 0) „et;

599 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

600 ià(
»t
 < 0è
Ïb0
;

601 
c
 = 
»t
;

606 
Ïb0
:

607 
c
 = 
c1
;

611 
	}
}

613 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_m¬k_»giÚs
() {

614 
I_pV
 = 
l
;

615 
I_p1
 = 
l
;

616 
I_p2
 = 
l
;

617 { 
c1
 = 
c
;

618 { 
c2
 = 
c
;

619 ià(
	`š_groupšg_U
(
g_v
, 97, 250, 0)è
Ïb2
;

620 { 
c3
 = 
c
;

621 ià(
	`out_groupšg_U
(
g_v
, 97, 250, 0)è
Ïb4
;

622 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 250, 1);

623 ià(
»t
 < 0è
Ïb4
;

624 
c
 +ğ
»t
;

626 
Ïb3
;

627 
Ïb4
:

628 
c
 = 
c3
;

629 ià(
	`š_groupšg_U
(
g_v
, 97, 250, 0)è
Ïb2
;

630 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 250, 1);

631 ià(
»t
 < 0è
Ïb2
;

632 
c
 +ğ
»t
;

635 
Ïb3
:

636 
Ïb1
;

637 
Ïb2
:

638 
c
 = 
c2
;

639 ià(
	`out_groupšg_U
(
g_v
, 97, 250, 0)è
Ïb0
;

640 { 
c4
 = 
c
;

641 ià(
	`out_groupšg_U
(
g_v
, 97, 250, 0)è
Ïb6
;

642 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 250, 1);

643 ià(
»t
 < 0è
Ïb6
;

644 
c
 +ğ
»t
;

646 
Ïb5
;

647 
Ïb6
:

648 
c
 = 
c4
;

649 ià(
	`š_groupšg_U
(
g_v
, 97, 250, 0)è
Ïb0
;

650 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

651 ià(
»t
 < 0è
Ïb0
;

652 
c
 = 
»t
;

655 
Ïb5
:

658 
Ïb1
:

659 
I_pV
 = 
c
;

660 
Ïb0
:

661 
c
 = 
c1
;

663 { 
c5
 = 
c
;

664 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 250, 1);

665 ià(
»t
 < 0è
Ïb7
;

666 
c
 +ğ
»t
;

668 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 250, 1);

669 ià(
»t
 < 0è
Ïb7
;

670 
c
 +ğ
»t
;

672 
I_p1
 = 
c
;

673 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 250, 1);

674 ià(
»t
 < 0è
Ïb7
;

675 
c
 +ğ
»t
;

677 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 250, 1);

678 ià(
»t
 < 0è
Ïb7
;

679 
c
 +ğ
»t
;

681 
I_p2
 = 
c
;

682 
Ïb7
:

683 
c
 = 
c5
;

686 
	}
}

688 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_po¡lude
() {

689 
amÚg_v¬
;

691 
c1
 = 
c
;

692 
b¿
 = 
c
;

693 ià(
c
 + 1 >ğ
l
 || 
p
[ø+ 1] !ğ126è
amÚg_v¬
 = 3; 

694 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_1
, 3, 0, 0);

695 ià(!(
amÚg_v¬
)è
Ïb0
;

696 
k‘
 = 
c
;

697 
amÚg_v¬
) {

698 0: 
Ïb0
;

700 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_2
);

701 ià(
»t
 < 0) „et;

705 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_3
);

706 ià(
»t
 < 0) „et;

710 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

711 ià(
»t
 < 0è
Ïb0
;

712 
c
 = 
»t
;

717 
Ïb0
:

718 
c
 = 
c1
;

722 
	}
}

724 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_RV
() {

725 ià(!(
I_pV
 <ğ
c
))  0;

727 
	}
}

729 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_R1
() {

730 ià(!(
I_p1
 <ğ
c
))  0;

732 
	}
}

734 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_R2
() {

735 ià(!(
I_p2
 <ğ
c
))  0;

737 
	}
}

739 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_¡ªd¬d_suffix
() {

740 
amÚg_v¬
;

741 
k‘
 = 
c
;

742 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((839714 >> (p[c - 1] & 0x1f)) & 1))  0;

743 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 45, 0, 0);

744 ià(!(
amÚg_v¬
))  0;

745 
b¿
 = 
c
;

746 
amÚg_v¬
) {

749 { 
»t
 = 
	`r_R2
();

750 ià(
»t
 <= 0) „et;

752 ià(
	`¦iû_d–
() == -1)  -1;

755 { 
»t
 = 
	`r_R2
();

756 ià(
»t
 <= 0) „et;

758 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_4
);

759 ià(
»t
 < 0) „et;

763 { 
»t
 = 
	`r_R2
();

764 ià(
»t
 <= 0) „et;

766 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_5
);

767 ià(
»t
 < 0) „et;

771 { 
»t
 = 
	`r_R2
();

772 ià(
»t
 <= 0) „et;

774 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_6
);

775 ià(
»t
 < 0) „et;

779 { 
»t
 = 
	`r_R1
();

780 ià(
»t
 <= 0) „et;

782 ià(
	`¦iû_d–
() == -1)  -1;

783 { 
m1
 = 
l
 - 
c
; ()m1;

784 
k‘
 = 
c
;

785 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((4718616 >> (p[ø- 1] & 0x1f)è& 1)è{ c = 
l
 - 
m1
; 
Ïb0
; }

786 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 4, 0, 0);

787 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

788 
b¿
 = 
c
;

789 { 
»t
 = 
	`r_R2
();

790 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

791 ià(
»t
 < 0) „et;

793 ià(
	`¦iû_d–
() == -1)  -1;

794 
amÚg_v¬
) {

795 0: { 
c
 = 
l
 - 
m1
; 
Ïb0
; }

797 
k‘
 = 
c
;

798 ià(!(
	`eq_s_b
(2, 
s_7
))è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

799 
b¿
 = 
c
;

800 { 
»t
 = 
	`r_R2
();

801 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

802 ià(
»t
 < 0) „et;

804 ià(
	`¦iû_d–
() == -1)  -1;

807 
Ïb0
:

812 { 
»t
 = 
	`r_R2
();

813 ià(
»t
 <= 0) „et;

815 ià(
	`¦iû_d–
() == -1)  -1;

816 { 
m2
 = 
l
 - 
c
; ()m2;

817 
k‘
 = 
c
;

818 ià(
c
 - 3 <ğ
lb
 || (
p
[ø- 1] !ğ101 &&…[ø- 1] !ğ108)è{ c = 
l
 - 
m2
; 
Ïb1
; }

819 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 3, 0, 0);

820 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

821 
b¿
 = 
c
;

822 
amÚg_v¬
) {

823 0: { 
c
 = 
l
 - 
m2
; 
Ïb1
; }

825 { 
»t
 = 
	`r_R2
();

826 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

827 ià(
»t
 < 0) „et;

829 ià(
	`¦iû_d–
() == -1)  -1;

832 
Ïb1
:

837 { 
»t
 = 
	`r_R2
();

838 ià(
»t
 <= 0) „et;

840 ià(
	`¦iû_d–
() == -1)  -1;

841 { 
m3
 = 
l
 - 
c
; ()m3;

842 
k‘
 = 
c
;

843 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((4198408 >> (p[ø- 1] & 0x1f)è& 1)è{ c = 
l
 - 
m3
; 
Ïb2
; }

844 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 3, 0, 0);

845 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m3
; 
Ïb2
; }

846 
b¿
 = 
c
;

847 
amÚg_v¬
) {

848 0: { 
c
 = 
l
 - 
m3
; 
Ïb2
; }

850 { 
»t
 = 
	`r_R2
();

851 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb2
; }

852 ià(
»t
 < 0) „et;

854 ià(
	`¦iû_d–
() == -1)  -1;

857 
Ïb2
:

862 { 
»t
 = 
	`r_R2
();

863 ià(
»t
 <= 0) „et;

865 ià(
	`¦iû_d–
() == -1)  -1;

866 { 
m4
 = 
l
 - 
c
; ()m4;

867 
k‘
 = 
c
;

868 ià(!(
	`eq_s_b
(2, 
s_8
))è{ 
c
 = 
l
 - 
m4
; 
Ïb3
; }

869 
b¿
 = 
c
;

870 { 
»t
 = 
	`r_R2
();

871 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m4
; 
Ïb3
; }

872 ià(
»t
 < 0) „et;

874 ià(
	`¦iû_d–
() == -1)  -1;

875 
Ïb3
:

880 { 
»t
 = 
	`r_RV
();

881 ià(
»t
 <= 0) „et;

883 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'e')  0;

884 
c
--;

885 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_9
);

886 ià(
»t
 < 0) „et;

891 
	}
}

893 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_v”b_suffix
() {

894 
amÚg_v¬
;

895 { 
m1
 = 
l
 - 
c
; ()m1;

896 
mlim™1
;

897 ià(
c
 < 
I_pV
)  0;

898 
c
 = 
I_pV
;

899 
mlim™1
 = 
lb
;†b = 
c
;

900 
c
 = 
l
 - 
m1
;

901 
k‘
 = 
c
;

902 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 120, 0, 0);

903 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

904 
b¿
 = 
c
;

905 
amÚg_v¬
) {

906 0: { 
lb
 = 
mlim™1
;  0; }

908 ià(
	`¦iû_d–
() == -1)  -1;

911 
lb
 = 
mlim™1
;

914 
	}
}

916 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_»sidu®_suffix
() {

917 
amÚg_v¬
;

918 
k‘
 = 
c
;

919 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 7, 0, 0);

920 ià(!(
amÚg_v¬
))  0;

921 
b¿
 = 
c
;

922 
amÚg_v¬
) {

925 { 
»t
 = 
	`r_RV
();

926 ià(
»t
 <= 0) „et;

928 ià(
	`¦iû_d–
() == -1)  -1;

932 
	}
}

934 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$r_»sidu®_fÜm
() {

935 
amÚg_v¬
;

936 
k‘
 = 
c
;

937 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_8
, 4, 0, 0);

938 ià(!(
amÚg_v¬
))  0;

939 
b¿
 = 
c
;

940 
amÚg_v¬
) {

943 { 
»t
 = 
	`r_RV
();

944 ià(
»t
 <= 0) „et;

946 ià(
	`¦iû_d–
() == -1)  -1;

947 
k‘
 = 
c
;

948 { 
m1
 = 
l
 - 
c
; ()m1;

949 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è
Ïb1
;

950 
c
--;

951 
b¿
 = 
c
;

952 { 
m_‹¡2
 = 
l
 - 
c
;

953 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'g'è
Ïb1
;

954 
c
--;

955 
c
 = 
l
 - 
m_‹¡2
;

957 
Ïb0
;

958 
Ïb1
:

959 
c
 = 
l
 - 
m1
;

960 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'i')  0;

961 
c
--;

962 
b¿
 = 
c
;

963 { 
m_‹¡3
 = 
l
 - 
c
;

964 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'c')  0;

965 
c
--;

966 
c
 = 
l
 - 
m_‹¡3
;

969 
Ïb0
:

970 { 
»t
 = 
	`r_RV
();

971 ià(
»t
 <= 0) „et;

973 ià(
	`¦iû_d–
() == -1)  -1;

976 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_10
);

977 ià(
»t
 < 0) „et;

982 
	}
}

984 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$¡em
() {

985 { 
c1
 = 
c
;

986 { 
»t
 = 
	`r_´–ude
();

987 ià(
»t
 =ğ0è
Ïb0
;

988 ià(
»t
 < 0) „et;

990 
Ïb0
:

991 
c
 = 
c1
;

993 { 
c2
 = 
c
;

994 { 
»t
 = 
	`r_m¬k_»giÚs
();

995 ià(
»t
 =ğ0è
Ïb1
;

996 ià(
»t
 < 0) „et;

998 
Ïb1
:

999 
c
 = 
c2
;

1001 
lb
 = 
c
; c = 
l
;

1003 { 
m3
 = 
l
 - 
c
; ()m3;

1004 { 
m4
 = 
l
 - 
c
; ()m4;

1005 { 
m5
 = 
l
 - 
c
; ()m5;

1006 { 
m6
 = 
l
 - 
c
; ()m6;

1007 { 
»t
 = 
	`r_¡ªd¬d_suffix
();

1008 ià(
»t
 =ğ0è
Ïb6
;

1009 ià(
»t
 < 0) „et;

1011 
Ïb5
;

1012 
Ïb6
:

1013 
c
 = 
l
 - 
m6
;

1014 { 
»t
 = 
	`r_v”b_suffix
();

1015 ià(
»t
 =ğ0è
Ïb4
;

1016 ià(
»t
 < 0) „et;

1019 
Ïb5
:

1020 
c
 = 
l
 - 
m5
;

1021 { 
m7
 = 
l
 - 
c
; ()m7;

1022 
k‘
 = 
c
;

1023 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'i'è
Ïb7
;

1024 
c
--;

1025 
b¿
 = 
c
;

1026 { 
m_‹¡8
 = 
l
 - 
c
;

1027 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'c'è
Ïb7
;

1028 
c
--;

1029 
c
 = 
l
 - 
m_‹¡8
;

1031 { 
»t
 = 
	`r_RV
();

1032 ià(
»t
 =ğ0è
Ïb7
;

1033 ià(
»t
 < 0) „et;

1035 ià(
	`¦iû_d–
() == -1)  -1;

1036 
Ïb7
:

1037 
c
 = 
l
 - 
m7
;

1040 
Ïb3
;

1041 
Ïb4
:

1042 
c
 = 
l
 - 
m4
;

1043 { 
»t
 = 
	`r_»sidu®_suffix
();

1044 ià(
»t
 =ğ0è
Ïb2
;

1045 ià(
»t
 < 0) „et;

1048 
Ïb3
:

1049 
Ïb2
:

1050 
c
 = 
l
 - 
m3
;

1052 { 
m9
 = 
l
 - 
c
; ()m9;

1053 { 
»t
 = 
	`r_»sidu®_fÜm
();

1054 ià(
»t
 =ğ0è
Ïb8
;

1055 ià(
»t
 < 0) „et;

1057 
Ïb8
:

1058 
c
 = 
l
 - 
m9
;

1060 
c
 = 
lb
;

1061 { 
c10
 = 
c
;

1062 { 
»t
 = 
	`r_po¡lude
();

1063 ià(
»t
 =ğ0è
Ïb9
;

1064 ià(
»t
 < 0) „et;

1066 
Ïb9
:

1067 
c
 = 
c10
;

1070 
	}
}

1072 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$IÁ”ÇlS‹mPÜtugue£
()

1073 : 
	`I_p2
(0), 
	`I_p1
(0), 
	$I_pV
(0)

1075 
	}
}

1077 
	gX­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::~
	$IÁ”ÇlS‹mPÜtugue£
()

1079 
	}
}

1082 
X­Ÿn
::
IÁ”ÇlS‹mPÜtugue£
::
	$g‘_desütiÚ
() const

1085 
	}
}

	@languages/portuguese.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mPÜtugue£
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_p2
;

9 
	gI_p1
;

10 
	gI_pV
;

11 
	gpublic
:

12 
r_»sidu®_fÜm
();

13 
r_»sidu®_suffix
();

14 
r_v”b_suffix
();

15 
r_¡ªd¬d_suffix
();

16 
r_R2
();

17 
r_R1
();

18 
r_RV
();

19 
r_m¬k_»giÚs
();

20 
r_po¡lude
();

21 
r_´–ude
();

23 
IÁ”ÇlS‹mPÜtugue£
();

24 ~
IÁ”ÇlS‹mPÜtugue£
();

25 
¡em
();

26 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/romanian.cc

3 
	~<lim™s.h
>

4 
	~"romªŸn.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_1
 0

	)

9 
	#s_0_2
 1

	)

11 
	#s_1_0
 2

	)

13 
	#s_1_1
 4

	)

15 
	#s_1_2
 9

	)

17 
	#s_1_3
 12

	)

19 
	#s_1_4
 15

	)

21 
	#s_1_5
 20

	)

23 
	#s_1_6
 (
s_1_7
 + 1)

	)

24 
	#s_1_7
 23

	)

26 
	#s_1_8
 27

	)

28 
	#s_1_9
 30

	)

30 
	#s_1_10
 
s_1_7


	)

31 
	#s_1_11
 34

	)

33 
	#s_1_12
 
s_1_11


	)

34 
	#s_1_13
 38

	)

36 
	#s_1_14
 (
s_1_15
 + 1)

	)

37 
	#s_1_15
 42

	)

39 
	#s_2_0
 47

	)

41 
	#s_2_1
 52

	)

43 
	#s_2_2
 57

	)

45 
	#s_2_3
 62

	)

47 
	#s_2_4
 67

	)

49 
	#s_2_5
 72

	)

51 
	#s_2_6
 79

	)

53 
	#s_2_7
 86

	)

55 
	#s_2_8
 92

	)

57 
	#s_2_9
 98

	)

59 
	#s_2_10
 105

	)

61 
	#s_2_11
 112

	)

63 
	#s_2_12
 121

	)

65 
	#s_2_13
 130

	)

67 
	#s_2_14
 137

	)

69 
	#s_2_15
 142

	)

71 
	#s_2_16
 147

	)

73 
	#s_2_17
 152

	)

75 
	#s_2_18
 (
s_2_19
 + 2)

	)

76 
	#s_2_19
 157

	)

78 
	#s_2_20
 164

	)

80 
	#s_2_21
 169

	)

82 
	#s_2_22
 175

	)

84 
	#s_2_23
 182

	)

86 
	#s_2_24
 191

	)

88 
	#s_2_25
 198

	)

90 
	#s_2_26
 203

	)

92 
	#s_2_27
 208

	)

94 
	#s_2_28
 213

	)

96 
	#s_2_29
 220

	)

98 
	#s_2_30
 229

	)

100 
	#s_2_31
 236

	)

102 
	#s_2_32
 245

	)

104 
	#s_2_33
 256

	)

106 
	#s_2_34
 
s_2_0


	)

107 
	#s_2_35
 
s_2_18


	)

108 
	#s_2_36
 
s_2_19


	)

109 
	#s_2_37
 
s_2_20


	)

110 
	#s_2_38
 
s_2_21


	)

111 
	#s_2_39
 
s_2_1


	)

112 
	#s_2_40
 
s_2_2


	)

113 
	#s_2_41
 
s_2_3


	)

114 
	#s_2_42
 265

	)

116 
	#s_2_43
 271

	)

118 
	#s_2_44
 277

	)

120 
	#s_2_45
 283

	)

122 
	#s_3_0
 289

	)

124 
	#s_3_1
 292

	)

126 
	#s_3_2
 297

	)

128 
	#s_3_3
 302

	)

130 
	#s_3_4
 306

	)

132 
	#s_3_5
 
s_3_18


	)

133 
	#s_3_6
 309

	)

135 
	#s_3_7
 313

	)

137 
	#s_3_8
 317

	)

139 
	#s_3_9
 320

	)

141 
	#s_3_10
 
s_3_0


	)

142 
	#s_3_11
 323

	)

144 
	#s_3_12
 326

	)

146 
	#s_3_13
 331

	)

148 
	#s_3_14
 336

	)

150 
	#s_3_15
 340

	)

152 
	#s_3_16
 344

	)

154 
	#s_3_17
 (
s_3_18
 + 2)

	)

155 
	#s_3_18
 348

	)

157 
	#s_3_19
 353

	)

159 
	#s_3_20
 356

	)

161 
	#s_3_21
 360

	)

163 
	#s_3_22
 364

	)

165 
	#s_3_23
 367

	)

167 
	#s_3_24
 370

	)

169 
	#s_3_25
 373

	)

171 
	#s_3_26
 378

	)

173 
	#s_3_27
 383

	)

175 
	#s_3_28
 387

	)

177 
	#s_3_29
 392

	)

179 
	#s_3_30
 (
s_3_31
 + 2)

	)

180 
	#s_3_31
 395

	)

182 
	#s_3_32
 400

	)

184 
	#s_3_33
 403

	)

186 
	#s_3_34
 407

	)

188 
	#s_3_35
 411

	)

190 
	#s_3_36
 414

	)

192 
	#s_3_37
 419

	)

194 
	#s_3_38
 422

	)

196 
	#s_3_39
 427

	)

198 
	#s_3_40
 431

	)

200 
	#s_3_41
 
s_3_1


	)

201 
	#s_3_42
 
s_3_2


	)

202 
	#s_3_43
 
s_3_14


	)

203 
	#s_3_44
 
s_3_28


	)

204 
	#s_3_45
 
s_3_29


	)

205 
	#s_3_46
 
s_3_4


	)

206 
	#s_3_47
 
s_3_5


	)

207 
	#s_3_48
 
s_3_6


	)

208 
	#s_3_49
 
s_3_7


	)

209 
	#s_3_50
 
s_3_8


	)

210 
	#s_3_51
 
s_3_9


	)

211 
	#s_3_52
 438

	)

213 
	#s_3_53
 442

	)

215 
	#s_3_54
 448

	)

217 
	#s_3_55
 454

	)

219 
	#s_3_56
 459

	)

221 
	#s_3_57
 
s_3_38


	)

222 
	#s_3_58
 463

	)

224 
	#s_3_59
 468

	)

226 
	#s_3_60
 473

	)

228 
	#s_3_61
 477

	)

230 
	#s_4_0
 
s_4_20


	)

231 
	#s_4_1
 
s_4_21


	)

232 
	#s_4_2
 481

	)

234 
	#s_4_3
 484

	)

236 
	#s_4_4
 
s_4_79


	)

237 
	#s_4_5
 
s_4_80


	)

238 
	#s_4_6
 488

	)

240 
	#s_4_7
 491

	)

242 
	#s_4_8
 494

	)

244 
	#s_4_9
 497

	)

246 
	#s_4_10
 (
s_4_11
 + 1)

	)

247 
	#s_4_11
 
s_4_29


	)

248 
	#s_4_12
 
s_4_30


	)

249 
	#s_4_13
 
s_4_31


	)

250 
	#s_4_14
 
s_4_32


	)

251 
	#s_4_15
 
s_4_33


	)

252 
	#s_4_16
 501

	)

254 
	#s_4_17
 506

	)

256 
	#s_4_18
 512

	)

258 
	#s_4_19
 (
s_4_20
 + 1)

	)

259 
	#s_4_20
 515

	)

261 
	#s_4_21
 518

	)

263 
	#s_4_22
 521

	)

265 
	#s_4_23
 524

	)

267 
	#s_4_24
 529

	)

269 
	#s_4_25
 535

	)

271 
	#s_4_26
 537

	)

273 
	#s_4_27
 540

	)

275 
	#s_4_28
 (
s_4_29
 + 1)

	)

276 
	#s_4_29
 544

	)

278 
	#s_4_30
 550

	)

280 
	#s_4_31
 557

	)

282 
	#s_4_32
 563

	)

284 
	#s_4_33
 569

	)

286 
	#s_4_34
 576

	)

288 
	#s_4_35
 580

	)

290 
	#s_4_36
 584

	)

292 
	#s_4_37
 589

	)

294 
	#s_4_38
 (
s_4_39
 + 1)

	)

295 
	#s_4_39
 592

	)

297 
	#s_4_40
 597

	)

299 
	#s_4_41
 602

	)

301 
	#s_4_42
 606

	)

303 
	#s_4_43
 610

	)

305 
	#s_4_44
 (
s_4_45
 + 1)

	)

306 
	#s_4_45
 617

	)

308 
	#s_4_46
 626

	)

310 
	#s_4_47
 636

	)

312 
	#s_4_48
 645

	)

314 
	#s_4_49
 654

	)

316 
	#s_4_50
 664

	)

318 
	#s_4_51
 671

	)

320 
	#s_4_52
 678

	)

322 
	#s_4_53
 686

	)

324 
	#s_4_54
 (
s_4_55
 + 1)

	)

325 
	#s_4_55
 691

	)

327 
	#s_4_56
 694

	)

329 
	#s_4_57
 (
s_4_58
 + 2)

	)

330 
	#s_4_58
 697

	)

332 
	#s_4_59
 701

	)

334 
	#s_4_60
 706

	)

336 
	#s_4_61
 710

	)

338 
	#s_4_62
 714

	)

340 
	#s_4_63
 719

	)

342 
	#s_4_64
 (
s_4_65
 + 2)

	)

343 
	#s_4_65
 721

	)

345 
	#s_4_66
 (
s_4_67
 + 1)

	)

346 
	#s_4_67
 726

	)

348 
	#s_4_68
 733

	)

350 
	#s_4_69
 741

	)

352 
	#s_4_70
 748

	)

354 
	#s_4_71
 755

	)

356 
	#s_4_72
 763

	)

358 
	#s_4_73
 768

	)

360 
	#s_4_74
 773

	)

362 
	#s_4_75
 779

	)

364 
	#s_4_76
 (
s_4_77
 + 1)

	)

365 
	#s_4_77
 782

	)

367 
	#s_4_78
 785

	)

369 
	#s_4_79
 788

	)

371 
	#s_4_80
 792

	)

373 
	#s_4_81
 
s_4_18


	)

374 
	#s_4_82
 797

	)

376 
	#s_4_83
 
s_4_43


	)

377 
	#s_4_84
 
s_4_44


	)

378 
	#s_4_85
 
s_4_45


	)

379 
	#s_4_86
 
s_4_46


	)

380 
	#s_4_87
 
s_4_47


	)

381 
	#s_4_88
 
s_4_48


	)

382 
	#s_4_89
 
s_4_49


	)

383 
	#s_4_90
 
s_4_50


	)

384 
	#s_4_91
 
s_4_51


	)

385 
	#s_4_92
 
s_4_52


	)

386 
	#s_4_93
 803

	)

388 
	#s_5_0
 808

	)

390 
	#s_5_1
 (
s_5_2
 + 1)

	)

391 
	#s_5_2
 809

	)

393 
	#s_5_3
 
s_5_2


	)

394 
	#s_5_4
 811

	)

399 cÚ¡ 
amÚg
 
	ga_0
[3] =

402  { 1, 
s_0_1
, 0, 1},

403  { 1, 
s_0_2
, 0, 2}

407 cÚ¡ 
amÚg
 
	ga_1
[16] =

409  { 2, 
s_1_0
, -1, 3},

410  { 5, 
s_1_1
, -1, 7},

411  { 3, 
s_1_2
, -1, 2},

412  { 3, 
s_1_3
, -1, 4},

413  { 5, 
s_1_4
, -1, 7},

414  { 3, 
s_1_5
, -1, 3},

415  { 3, 
s_1_6
, -1, 5},

416  { 4, 
s_1_7
, 6, 4},

417  { 3, 
s_1_8
, -1, 4},

418  { 4, 
s_1_9
, -1, 6},

419  { 2, 
s_1_10
, -1, 4},

420  { 4, 
s_1_11
, -1, 1},

421  { 2, 
s_1_12
, -1, 1},

422  { 4, 
s_1_13
, -1, 3},

423  { 4, 
s_1_14
, -1, 4},

424  { 5, 
s_1_15
, 14, 4}

428 cÚ¡ 
amÚg
 
	ga_2
[46] =

430  { 5, 
s_2_0
, -1, 4},

431  { 5, 
s_2_1
, -1, 4},

432  { 5, 
s_2_2
, -1, 5},

433  { 5, 
s_2_3
, -1, 6},

434  { 5, 
s_2_4
, -1, 4},

435  { 7, 
s_2_5
, -1, 5},

436  { 7, 
s_2_6
, -1, 6},

437  { 6, 
s_2_7
, -1, 5},

438  { 6, 
s_2_8
, -1, 6},

439  { 7, 
s_2_9
, -1, 5},

440  { 7, 
s_2_10
, -1, 4},

441  { 9, 
s_2_11
, -1, 1},

442  { 9, 
s_2_12
, -1, 2},

443  { 7, 
s_2_13
, -1, 3},

444  { 5, 
s_2_14
, -1, 4},

445  { 5, 
s_2_15
, -1, 5},

446  { 5, 
s_2_16
, -1, 6},

447  { 5, 
s_2_17
, -1, 4},

448  { 5, 
s_2_18
, -1, 5},

449  { 7, 
s_2_19
, 18, 4},

450  { 5, 
s_2_20
, -1, 6},

451  { 6, 
s_2_21
, -1, 5},

452  { 7, 
s_2_22
, -1, 4},

453  { 9, 
s_2_23
, -1, 1},

454  { 7, 
s_2_24
, -1, 3},

455  { 5, 
s_2_25
, -1, 4},

456  { 5, 
s_2_26
, -1, 5},

457  { 5, 
s_2_27
, -1, 6},

458  { 7, 
s_2_28
, -1, 4},

459  { 9, 
s_2_29
, -1, 1},

460  { 7, 
s_2_30
, -1, 3},

461  { 9, 
s_2_31
, -1, 4},

462  { 11, 
s_2_32
, -1, 1},

463  { 9, 
s_2_33
, -1, 3},

464  { 4, 
s_2_34
, -1, 4},

465  { 4, 
s_2_35
, -1, 5},

466  { 6, 
s_2_36
, 35, 4},

467  { 4, 
s_2_37
, -1, 6},

468  { 5, 
s_2_38
, -1, 5},

469  { 4, 
s_2_39
, -1, 4},

470  { 4, 
s_2_40
, -1, 5},

471  { 4, 
s_2_41
, -1, 6},

472  { 6, 
s_2_42
, -1, 4},

473  { 6, 
s_2_43
, -1, 4},

474  { 6, 
s_2_44
, -1, 5},

475  { 6, 
s_2_45
, -1, 6}

479 cÚ¡ 
amÚg
 
	ga_3
[62] =

481  { 3, 
s_3_0
, -1, 1},

482  { 5, 
s_3_1
, -1, 1},

483  { 5, 
s_3_2
, -1, 1},

484  { 4, 
s_3_3
, -1, 1},

485  { 3, 
s_3_4
, -1, 1},

486  { 3, 
s_3_5
, -1, 1},

487  { 4, 
s_3_6
, -1, 1},

488  { 4, 
s_3_7
, -1, 3},

489  { 3, 
s_3_8
, -1, 1},

490  { 3, 
s_3_9
, -1, 1},

491  { 2, 
s_3_10
, -1, 1},

492  { 3, 
s_3_11
, -1, 1},

493  { 5, 
s_3_12
, -1, 1},

494  { 5, 
s_3_13
, -1, 1},

495  { 4, 
s_3_14
, -1, 3},

496  { 4, 
s_3_15
, -1, 2},

497  { 4, 
s_3_16
, -1, 1},

498  { 3, 
s_3_17
, -1, 1},

499  { 5, 
s_3_18
, 17, 1},

500  { 3, 
s_3_19
, -1, 1},

501  { 4, 
s_3_20
, -1, 1},

502  { 4, 
s_3_21
, -1, 3},

503  { 3, 
s_3_22
, -1, 1},

504  { 3, 
s_3_23
, -1, 1},

505  { 3, 
s_3_24
, -1, 1},

506  { 5, 
s_3_25
, -1, 1},

507  { 5, 
s_3_26
, -1, 1},

508  { 4, 
s_3_27
, -1, 2},

509  { 5, 
s_3_28
, -1, 1},

510  { 3, 
s_3_29
, -1, 1},

511  { 3, 
s_3_30
, -1, 1},

512  { 5, 
s_3_31
, 30, 1},

513  { 3, 
s_3_32
, -1, 1},

514  { 4, 
s_3_33
, -1, 1},

515  { 4, 
s_3_34
, -1, 3},

516  { 3, 
s_3_35
, -1, 1},

517  { 5, 
s_3_36
, -1, 3},

518  { 3, 
s_3_37
, -1, 1},

519  { 5, 
s_3_38
, -1, 1},

520  { 4, 
s_3_39
, -1, 1},

521  { 7, 
s_3_40
, -1, 1},

522  { 4, 
s_3_41
, -1, 1},

523  { 4, 
s_3_42
, -1, 1},

524  { 3, 
s_3_43
, -1, 3},

525  { 4, 
s_3_44
, -1, 1},

526  { 2, 
s_3_45
, -1, 1},

527  { 2, 
s_3_46
, -1, 1},

528  { 2, 
s_3_47
, -1, 1},

529  { 3, 
s_3_48
, -1, 1},

530  { 3, 
s_3_49
, -1, 3},

531  { 2, 
s_3_50
, -1, 1},

532  { 2, 
s_3_51
, -1, 1},

533  { 4, 
s_3_52
, -1, 1},

534  { 6, 
s_3_53
, -1, 1},

535  { 6, 
s_3_54
, -1, 1},

536  { 5, 
s_3_55
, -1, 1},

537  { 4, 
s_3_56
, -1, 1},

538  { 4, 
s_3_57
, -1, 1},

539  { 5, 
s_3_58
, -1, 1},

540  { 5, 
s_3_59
, -1, 3},

541  { 4, 
s_3_60
, -1, 1},

542  { 4, 
s_3_61
, -1, 1}

546 cÚ¡ 
amÚg
 
	ga_4
[94] =

548  { 2, 
s_4_0
, -1, 1},

549  { 2, 
s_4_1
, -1, 1},

550  { 3, 
s_4_2
, -1, 1},

551  { 4, 
s_4_3
, -1, 1},

552  { 3, 
s_4_4
, -1, 1},

553  { 4, 
s_4_5
, -1, 1},

554  { 3, 
s_4_6
, -1, 1},

555  { 3, 
s_4_7
, -1, 1},

556  { 3, 
s_4_8
, -1, 1},

557  { 4, 
s_4_9
, -1, 1},

558  { 2, 
s_4_10
, -1, 2},

559  { 3, 
s_4_11
, 10, 1},

560  { 4, 
s_4_12
, 10, 2},

561  { 3, 
s_4_13
, 10, 1},

562  { 3, 
s_4_14
, 10, 1},

563  { 4, 
s_4_15
, 10, 1},

564  { 5, 
s_4_16
, -1, 1},

565  { 6, 
s_4_17
, -1, 1},

566  { 3, 
s_4_18
, -1, 1},

567  { 2, 
s_4_19
, -1, 1},

568  { 3, 
s_4_20
, 19, 1},

569  { 3, 
s_4_21
, 19, 1},

570  { 3, 
s_4_22
, -1, 2},

571  { 5, 
s_4_23
, -1, 1},

572  { 6, 
s_4_24
, -1, 1},

573  { 2, 
s_4_25
, -1, 1},

574  { 3, 
s_4_26
, -1, 1},

575  { 4, 
s_4_27
, -1, 1},

576  { 5, 
s_4_28
, -1, 2},

577  { 6, 
s_4_29
, 28, 1},

578  { 7, 
s_4_30
, 28, 2},

579  { 6, 
s_4_31
, 28, 1},

580  { 6, 
s_4_32
, 28, 1},

581  { 7, 
s_4_33
, 28, 1},

582  { 4, 
s_4_34
, -1, 1},

583  { 4, 
s_4_35
, -1, 1},

584  { 5, 
s_4_36
, -1, 1},

585  { 3, 
s_4_37
, -1, 1},

586  { 4, 
s_4_38
, -1, 2},

587  { 5, 
s_4_39
, 38, 1},

588  { 5, 
s_4_40
, 38, 1},

589  { 4, 
s_4_41
, -1, 2},

590  { 4, 
s_4_42
, -1, 2},

591  { 7, 
s_4_43
, -1, 1},

592  { 8, 
s_4_44
, -1, 2},

593  { 9, 
s_4_45
, 44, 1},

594  { 10, 
s_4_46
, 44, 2},

595  { 9, 
s_4_47
, 44, 1},

596  { 9, 
s_4_48
, 44, 1},

597  { 10, 
s_4_49
, 44, 1},

598  { 7, 
s_4_50
, -1, 1},

599  { 7, 
s_4_51
, -1, 1},

600  { 8, 
s_4_52
, -1, 1},

601  { 5, 
s_4_53
, -1, 2},

602  { 2, 
s_4_54
, -1, 1},

603  { 3, 
s_4_55
, 54, 1},

604  { 3, 
s_4_56
, 54, 1},

605  { 2, 
s_4_57
, -1, 2},

606  { 4, 
s_4_58
, 57, 1},

607  { 5, 
s_4_59
, 57, 2},

608  { 4, 
s_4_60
, 57, 1},

609  { 4, 
s_4_61
, 57, 1},

610  { 5, 
s_4_62
, 57, 1},

611  { 2, 
s_4_63
, -1, 2},

612  { 3, 
s_4_64
, -1, 2},

613  { 5, 
s_4_65
, 64, 1},

614  { 6, 
s_4_66
, 64, 2},

615  { 7, 
s_4_67
, 66, 1},

616  { 8, 
s_4_68
, 66, 2},

617  { 7, 
s_4_69
, 66, 1},

618  { 7, 
s_4_70
, 66, 1},

619  { 8, 
s_4_71
, 66, 1},

620  { 5, 
s_4_72
, 64, 1},

621  { 5, 
s_4_73
, 64, 1},

622  { 6, 
s_4_74
, 64, 1},

623  { 3, 
s_4_75
, -1, 2},

624  { 2, 
s_4_76
, -1, 1},

625  { 3, 
s_4_77
, 76, 1},

626  { 3, 
s_4_78
, 76, 1},

627  { 4, 
s_4_79
, -1, 1},

628  { 5, 
s_4_80
, -1, 1},

629  { 2, 
s_4_81
, -1, 1},

630  { 6, 
s_4_82
, -1, 1},

631  { 4, 
s_4_83
, -1, 1},

632  { 5, 
s_4_84
, -1, 2},

633  { 6, 
s_4_85
, 84, 1},

634  { 7, 
s_4_86
, 84, 2},

635  { 6, 
s_4_87
, 84, 1},

636  { 6, 
s_4_88
, 84, 1},

637  { 7, 
s_4_89
, 84, 1},

638  { 4, 
s_4_90
, -1, 1},

639  { 4, 
s_4_91
, -1, 1},

640  { 5, 
s_4_92
, -1, 1},

641  { 5, 
s_4_93
, -1, 1}

645 cÚ¡ 
amÚg
 
	ga_5
[5] =

647  { 1, 
s_5_0
, -1, 1},

648  { 1, 
s_5_1
, -1, 1},

649  { 2, 
s_5_2
, 1, 1},

650  { 1, 
s_5_3
, -1, 1},

651  { 2, 
s_5_4
, -1, 1}

654 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 32, 0, 0, 4 };

656 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'U' };

657 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'I' };

658 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'i' };

659 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'u' };

660 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'a' };

661 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'e' };

662 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'i' };

663 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'a', 'b' };

664 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'i' };

665 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'a', 't' };

666 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'a', 0xC5, 0xA3, 'i' };

667 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'a', 'b', 'i', 'l' };

668 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'i', 'b', 'i', 'l' };

669 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'i', 'v' };

670 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'i', 'c' };

671 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'a', 't' };

672 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'i', 't' };

673 cÚ¡ 
symbŞ
 
	gs_17
[] = { 0xC5, 0xA3 };

674 cÚ¡ 
symbŞ
 
	gs_18
[] = { 't' };

675 cÚ¡ 
symbŞ
 
	gs_19
[] = { 'i', 's', 't' };

677 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_´–ude
() {

679 
c1
 = 
c
;

681 
c2
 = 
c
;

682 ià(
	`š_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb1
;

683 
b¿
 = 
c
;

684 { 
c3
 = 
c
;

685 ià(
c
 =ğ
l
 || 
p
[c] !ğ'u'è
Ïb3
;

686 
c
++;

687 
k‘
 = 
c
;

688 ià(
	`š_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb3
;

689 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_0
);

690 ià(
»t
 < 0) „et;

692 
Ïb2
;

693 
Ïb3
:

694 
c
 = 
c3
;

695 ià(
c
 =ğ
l
 || 
p
[c] !ğ'i'è
Ïb1
;

696 
c
++;

697 
k‘
 = 
c
;

698 ià(
	`š_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb1
;

699 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_1
);

700 ià(
»t
 < 0) „et;

703 
Ïb2
:

704 
c
 = 
c2
;

706 
Ïb1
:

707 
c
 = 
c2
;

708 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

709 ià(
»t
 < 0è
Ïb0
;

710 
c
 = 
»t
;

714 
Ïb0
:

715 
c
 = 
c1
;

719 
	}
}

721 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_m¬k_»giÚs
() {

722 
I_pV
 = 
l
;

723 
I_p1
 = 
l
;

724 
I_p2
 = 
l
;

725 { 
c1
 = 
c
;

726 { 
c2
 = 
c
;

727 ià(
	`š_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb2
;

728 { 
c3
 = 
c
;

729 ià(
	`out_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb4
;

730 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 259, 1);

731 ià(
»t
 < 0è
Ïb4
;

732 
c
 +ğ
»t
;

734 
Ïb3
;

735 
Ïb4
:

736 
c
 = 
c3
;

737 ià(
	`š_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb2
;

738 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 259, 1);

739 ià(
»t
 < 0è
Ïb2
;

740 
c
 +ğ
»t
;

743 
Ïb3
:

744 
Ïb1
;

745 
Ïb2
:

746 
c
 = 
c2
;

747 ià(
	`out_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb0
;

748 { 
c4
 = 
c
;

749 ià(
	`out_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb6
;

750 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 259, 1);

751 ià(
»t
 < 0è
Ïb6
;

752 
c
 +ğ
»t
;

754 
Ïb5
;

755 
Ïb6
:

756 
c
 = 
c4
;

757 ià(
	`š_groupšg_U
(
g_v
, 97, 259, 0)è
Ïb0
;

758 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

759 ià(
»t
 < 0è
Ïb0
;

760 
c
 = 
»t
;

763 
Ïb5
:

766 
Ïb1
:

767 
I_pV
 = 
c
;

768 
Ïb0
:

769 
c
 = 
c1
;

771 { 
c5
 = 
c
;

772 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 259, 1);

773 ià(
»t
 < 0è
Ïb7
;

774 
c
 +ğ
»t
;

776 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 259, 1);

777 ià(
»t
 < 0è
Ïb7
;

778 
c
 +ğ
»t
;

780 
I_p1
 = 
c
;

781 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 259, 1);

782 ià(
»t
 < 0è
Ïb7
;

783 
c
 +ğ
»t
;

785 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 259, 1);

786 ià(
»t
 < 0è
Ïb7
;

787 
c
 +ğ
»t
;

789 
I_p2
 = 
c
;

790 
Ïb7
:

791 
c
 = 
c5
;

794 
	}
}

796 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_po¡lude
() {

797 
amÚg_v¬
;

799 
c1
 = 
c
;

800 
b¿
 = 
c
;

801 ià(
c
 >ğ
l
 || (
p
[ø+ 0] !ğ73 &&…[ø+ 0] !ğ85)è
amÚg_v¬
 = 3; 

802 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 3, 0, 0);

803 ià(!(
amÚg_v¬
)è
Ïb0
;

804 
k‘
 = 
c
;

805 
amÚg_v¬
) {

806 0: 
Ïb0
;

808 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_2
);

809 ià(
»t
 < 0) „et;

813 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_3
);

814 ià(
»t
 < 0) „et;

818 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

819 ià(
»t
 < 0è
Ïb0
;

820 
c
 = 
»t
;

825 
Ïb0
:

826 
c
 = 
c1
;

830 
	}
}

832 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_RV
() {

833 ià(!(
I_pV
 <ğ
c
))  0;

835 
	}
}

837 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_R1
() {

838 ià(!(
I_p1
 <ğ
c
))  0;

840 
	}
}

842 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_R2
() {

843 ià(!(
I_p2
 <ğ
c
))  0;

845 
	}
}

847 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_¡•_0
() {

848 
amÚg_v¬
;

849 
k‘
 = 
c
;

850 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((266786 >> (p[c - 1] & 0x1f)) & 1))  0;

851 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 16, 0, 0);

852 ià(!(
amÚg_v¬
))  0;

853 
b¿
 = 
c
;

854 { 
»t
 = 
	`r_R1
();

855 ià(
»t
 <= 0) „et;

857 
amÚg_v¬
) {

860 ià(
	`¦iû_d–
() == -1)  -1;

863 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_4
);

864 ià(
»t
 < 0) „et;

868 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_5
);

869 ià(
»t
 < 0) „et;

873 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_6
);

874 ià(
»t
 < 0) „et;

878 { 
m1
 = 
l
 - 
c
; ()m1;

879 ià(!(
	`eq_s_b
(2, 
s_7
))è
Ïb0
;

881 
Ïb0
:

882 
c
 = 
l
 - 
m1
;

884 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_8
);

885 ià(
»t
 < 0) „et;

889 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_9
);

890 ià(
»t
 < 0) „et;

894 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_10
);

895 ià(
»t
 < 0) „et;

900 
	}
}

902 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_combo_suffix
() {

903 
amÚg_v¬
;

904 { 
m_‹¡1
 = 
l
 - 
c
;

905 
k‘
 = 
c
;

906 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 46, 0, 0);

907 ià(!(
amÚg_v¬
))  0;

908 
b¿
 = 
c
;

909 { 
»t
 = 
	`r_R1
();

910 ià(
»t
 <= 0) „et;

912 
amÚg_v¬
) {

915 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_11
);

916 ià(
»t
 < 0) „et;

920 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_12
);

921 ià(
»t
 < 0) „et;

925 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_13
);

926 ià(
»t
 < 0) „et;

930 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_14
);

931 ià(
»t
 < 0) „et;

935 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_15
);

936 ià(
»t
 < 0) „et;

940 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_16
);

941 ià(
»t
 < 0) „et;

945 
B_¡ªd¬d_suffix_»moved
 = 1;

946 
c
 = 
l
 - 
m_‹¡1
;

949 
	}
}

951 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_¡ªd¬d_suffix
() {

952 
amÚg_v¬
;

953 
B_¡ªd¬d_suffix_»moved
 = 0;

955 
m1
 = 
l
 - 
c
; ()m1;

956 { 
»t
 = 
	`r_combo_suffix
();

957 ià(
»t
 =ğ0è
Ïb0
;

958 ià(
»t
 < 0) „et;

961 
Ïb0
:

962 
c
 = 
l
 - 
m1
;

965 
k‘
 = 
c
;

966 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 62, 0, 0);

967 ià(!(
amÚg_v¬
))  0;

968 
b¿
 = 
c
;

969 { 
»t
 = 
	`r_R2
();

970 ià(
»t
 <= 0) „et;

972 
amÚg_v¬
) {

975 ià(
	`¦iû_d–
() == -1)  -1;

978 ià(!(
	`eq_s_b
(2, 
s_17
)))  0;

979 
b¿
 = 
c
;

980 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_18
);

981 ià(
»t
 < 0) „et;

985 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_19
);

986 ià(
»t
 < 0) „et;

990 
B_¡ªd¬d_suffix_»moved
 = 1;

992 
	}
}

994 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_v”b_suffix
() {

995 
amÚg_v¬
;

996 { 
m1
 = 
l
 - 
c
; ()m1;

997 
mlim™1
;

998 ià(
c
 < 
I_pV
)  0;

999 
c
 = 
I_pV
;

1000 
mlim™1
 = 
lb
;†b = 
c
;

1001 
c
 = 
l
 - 
m1
;

1002 
k‘
 = 
c
;

1003 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 94, 0, 0);

1004 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

1005 
b¿
 = 
c
;

1006 
amÚg_v¬
) {

1007 0: { 
lb
 = 
mlim™1
;  0; }

1009 { 
m2
 = 
l
 - 
c
; ()m2;

1010 ià(
	`out_groupšg_b_U
(
g_v
, 97, 259, 0)è
Ïb1
;

1011 
Ïb0
;

1012 
Ïb1
:

1013 
c
 = 
l
 - 
m2
;

1014 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è{†b = 
mlim™1
;  0; }

1015 
c
--;

1017 
Ïb0
:

1018 ià(
	`¦iû_d–
() == -1)  -1;

1021 ià(
	`¦iû_d–
() == -1)  -1;

1024 
lb
 = 
mlim™1
;

1027 
	}
}

1029 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$r_vow–_suffix
() {

1030 
amÚg_v¬
;

1031 
k‘
 = 
c
;

1032 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 5, 0, 0);

1033 ià(!(
amÚg_v¬
))  0;

1034 
b¿
 = 
c
;

1035 { 
»t
 = 
	`r_RV
();

1036 ià(
»t
 <= 0) „et;

1038 
amÚg_v¬
) {

1041 ià(
	`¦iû_d–
() == -1)  -1;

1045 
	}
}

1047 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$¡em
() {

1048 { 
c1
 = 
c
;

1049 { 
»t
 = 
	`r_´–ude
();

1050 ià(
»t
 =ğ0è
Ïb0
;

1051 ià(
»t
 < 0) „et;

1053 
Ïb0
:

1054 
c
 = 
c1
;

1056 { 
c2
 = 
c
;

1057 { 
»t
 = 
	`r_m¬k_»giÚs
();

1058 ià(
»t
 =ğ0è
Ïb1
;

1059 ià(
»t
 < 0) „et;

1061 
Ïb1
:

1062 
c
 = 
c2
;

1064 
lb
 = 
c
; c = 
l
;

1066 { 
m3
 = 
l
 - 
c
; ()m3;

1067 { 
»t
 = 
	`r_¡•_0
();

1068 ià(
»t
 =ğ0è
Ïb2
;

1069 ià(
»t
 < 0) „et;

1071 
Ïb2
:

1072 
c
 = 
l
 - 
m3
;

1074 { 
m4
 = 
l
 - 
c
; ()m4;

1075 { 
»t
 = 
	`r_¡ªd¬d_suffix
();

1076 ià(
»t
 =ğ0è
Ïb3
;

1077 ià(
»t
 < 0) „et;

1079 
Ïb3
:

1080 
c
 = 
l
 - 
m4
;

1082 { 
m5
 = 
l
 - 
c
; ()m5;

1083 { 
m6
 = 
l
 - 
c
; ()m6;

1084 ià(!(
B_¡ªd¬d_suffix_»moved
)è
Ïb6
;

1085 
Ïb5
;

1086 
Ïb6
:

1087 
c
 = 
l
 - 
m6
;

1088 { 
»t
 = 
	`r_v”b_suffix
();

1089 ià(
»t
 =ğ0è
Ïb4
;

1090 ià(
»t
 < 0) „et;

1093 
Ïb5
:

1094 
Ïb4
:

1095 
c
 = 
l
 - 
m5
;

1097 { 
m7
 = 
l
 - 
c
; ()m7;

1098 { 
»t
 = 
	`r_vow–_suffix
();

1099 ià(
»t
 =ğ0è
Ïb7
;

1100 ià(
»t
 < 0) „et;

1102 
Ïb7
:

1103 
c
 = 
l
 - 
m7
;

1105 
c
 = 
lb
;

1106 { 
c8
 = 
c
;

1107 { 
»t
 = 
	`r_po¡lude
();

1108 ià(
»t
 =ğ0è
Ïb8
;

1109 ià(
»t
 < 0) „et;

1111 
Ïb8
:

1112 
c
 = 
c8
;

1115 
	}
}

1117 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$IÁ”ÇlS‹mRomªŸn
()

1118 : 
	`B_¡ªd¬d_suffix_»moved
(0), 
	`I_p2
(0), 
	`I_p1
(0), 
	$I_pV
(0)

1120 
	}
}

1122 
	gX­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::~
	$IÁ”ÇlS‹mRomªŸn
()

1124 
	}
}

1127 
X­Ÿn
::
IÁ”ÇlS‹mRomªŸn
::
	$g‘_desütiÚ
() const

1130 
	}
}

	@languages/romanian.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mRomªŸn
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
B_¡ªd¬d_suffix_»moved
;

9 
	gI_p2
;

10 
	gI_p1
;

11 
	gI_pV
;

12 
	gpublic
:

13 
r_vow–_suffix
();

14 
r_v”b_suffix
();

15 
r_combo_suffix
();

16 
r_¡ªd¬d_suffix
();

17 
r_¡•_0
();

18 
r_R2
();

19 
r_R1
();

20 
r_RV
();

21 
r_m¬k_»giÚs
();

22 
r_po¡lude
();

23 
r_´–ude
();

25 
IÁ”ÇlS‹mRomªŸn
();

26 ~
IÁ”ÇlS‹mRomªŸn
();

27 
¡em
();

28 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/russian.cc

3 
	~<lim™s.h
>

4 
	~"russŸn.h
"

6 
	#s_0_0
 (
s_0_1
 + 2)

	)

7 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

8 
	#s_0_1
 0

	)

10 
	#s_0_2
 12

	)

12 
	#s_0_3
 
s_0_0


	)

13 
	#s_0_4
 
s_0_1


	)

14 
	#s_0_5
 
s_0_2


	)

15 
	#s_0_6
 
s_0_0


	)

16 
	#s_0_7
 
s_0_1


	)

17 
	#s_0_8
 
s_0_2


	)

18 
	#s_1_0
 24

	)

20 
	#s_1_1
 30

	)

22 
	#s_1_2
 36

	)

24 
	#s_1_3
 40

	)

26 
	#s_1_4
 44

	)

28 
	#s_1_5
 48

	)

30 
	#s_1_6
 52

	)

32 
	#s_1_7
 56

	)

34 
	#s_1_8
 60

	)

36 
	#s_1_9
 64

	)

38 
	#s_1_10
 68

	)

40 
	#s_1_11
 72

	)

42 
	#s_1_12
 76

	)

44 
	#s_1_13
 80

	)

46 
	#s_1_14
 84

	)

48 
	#s_1_15
 90

	)

50 
	#s_1_16
 96

	)

52 
	#s_1_17
 100

	)

54 
	#s_1_18
 104

	)

56 
	#s_1_19
 108

	)

58 
	#s_1_20
 
s_1_14


	)

59 
	#s_1_21
 
s_1_0


	)

60 
	#s_1_22
 
s_1_15


	)

61 
	#s_1_23
 
s_1_1


	)

62 
	#s_1_24
 112

	)

64 
	#s_1_25
 118

	)

66 
	#s_2_0
 (
s_2_1
 + 2)

	)

67 
	#s_2_1
 124

	)

69 
	#s_2_2
 130

	)

71 
	#s_2_3
 (
s_2_4
 + 2)

	)

72 
	#s_2_4
 (
s_2_5
 + 2)

	)

73 
	#s_2_5
 136

	)

75 
	#s_2_6
 142

	)

77 
	#s_2_7
 146

	)

79 
	#s_3_0
 150

	)

81 
	#s_3_1
 154

	)

83 
	#s_4_0
 
s_4_10


	)

84 
	#s_4_1
 (
s_4_2
 + 2)

	)

85 
	#s_4_2
 158

	)

87 
	#s_4_3
 164

	)

89 
	#s_4_4
 (
s_4_5
 + 2)

	)

90 
	#s_4_5
 168

	)

92 
	#s_4_6
 
s_4_11


	)

93 
	#s_4_7
 (
s_4_8
 + 2)

	)

94 
	#s_4_8
 174

	)

96 
	#s_4_9
 (
s_4_10
 + 2)

	)

97 
	#s_4_10
 180

	)

99 
	#s_4_11
 186

	)

101 
	#s_4_12
 192

	)

103 
	#s_4_13
 198

	)

105 
	#s_4_14
 
s_4_1


	)

106 
	#s_4_15
 
s_4_2


	)

107 
	#s_4_16
 (
s_4_17
 + 2)

	)

108 
	#s_4_17
 204

	)

110 
	#s_4_18
 210

	)

112 
	#s_4_19
 (
s_4_20
 + 2)

	)

113 
	#s_4_20
 216

	)

115 
	#s_4_21
 222

	)

117 
	#s_4_22
 228

	)

119 
	#s_4_23
 (
s_4_24
 + 2)

	)

120 
	#s_4_24
 234

	)

122 
	#s_4_25
 242

	)

124 
	#s_4_26
 (
s_4_27
 + 2)

	)

125 
	#s_4_27
 250

	)

127 
	#s_4_28
 256

	)

129 
	#s_4_29
 
s_4_23


	)

130 
	#s_4_30
 
s_4_24


	)

131 
	#s_4_31
 
s_4_25


	)

132 
	#s_4_32
 
s_4_16


	)

133 
	#s_4_33
 
s_4_17


	)

134 
	#s_4_34
 
s_4_18


	)

135 
	#s_4_35
 262

	)

137 
	#s_4_36
 266

	)

139 
	#s_4_37
 270

	)

141 
	#s_4_38
 
s_4_7


	)

142 
	#s_4_39
 
s_4_8


	)

143 
	#s_4_40
 (
s_4_41
 + 2)

	)

144 
	#s_4_41
 274

	)

146 
	#s_4_42
 280

	)

148 
	#s_4_43
 (
s_4_44
 + 2)

	)

149 
	#s_4_44
 286

	)

151 
	#s_4_45
 292

	)

153 
	#s_5_0
 298

	)

155 
	#s_5_1
 (
s_5_2
 + 2)

	)

156 
	#s_5_2
 300

	)

158 
	#s_5_3
 306

	)

160 
	#s_5_4
 310

	)

162 
	#s_5_5
 
s_5_7


	)

163 
	#s_5_6
 (
s_5_7
 + 2)

	)

164 
	#s_5_7
 312

	)

166 
	#s_5_8
 316

	)

168 
	#s_5_9
 
s_5_1


	)

169 
	#s_5_10
 320

	)

171 
	#s_5_11
 
s_5_2


	)

172 
	#s_5_12
 
s_5_3


	)

173 
	#s_5_13
 324

	)

175 
	#s_5_14
 328

	)

177 
	#s_5_15
 
s_5_13


	)

178 
	#s_5_16
 332

	)

180 
	#s_5_17
 
s_5_26


	)

181 
	#s_5_18
 
s_5_2


	)

182 
	#s_5_19
 336

	)

184 
	#s_5_20
 340

	)

186 
	#s_5_21
 (
s_5_22
 + 2)

	)

187 
	#s_5_22
 344

	)

189 
	#s_5_23
 352

	)

191 
	#s_5_24
 (
s_5_25
 + 2)

	)

192 
	#s_5_25
 (
s_5_26
 + 2)

	)

193 
	#s_5_26
 358

	)

195 
	#s_5_27
 364

	)

197 
	#s_5_28
 368

	)

199 
	#s_5_29
 
s_5_21


	)

200 
	#s_5_30
 
s_5_22


	)

201 
	#s_5_31
 
s_5_23


	)

202 
	#s_5_32
 (
s_5_33
 + 2)

	)

203 
	#s_5_33
 372

	)

205 
	#s_5_34
 378

	)

207 
	#s_5_35
 
s_5_14


	)

208 
	#s_6_0
 
s_6_1


	)

209 
	#s_6_1
 382

	)

211 
	#s_7_0
 
s_7_2


	)

212 
	#s_7_1
 390

	)

214 
	#s_7_2
 392

	)

216 
	#s_7_3
 400

	)

221 cÚ¡ 
amÚg
 
	ga_0
[9] =

223  { 10, 
s_0_0
, -1, 1},

224  { 12, 
s_0_1
, 0, 2},

225  { 12, 
s_0_2
, 0, 2},

226  { 2, 
s_0_3
, -1, 1},

227  { 4, 
s_0_4
, 3, 2},

228  { 4, 
s_0_5
, 3, 2},

229  { 6, 
s_0_6
, -1, 1},

230  { 8, 
s_0_7
, 6, 2},

231  { 8, 
s_0_8
, 6, 2}

235 cÚ¡ 
amÚg
 
	ga_1
[26] =

237  { 6, 
s_1_0
, -1, 1},

238  { 6, 
s_1_1
, -1, 1},

239  { 4, 
s_1_2
, -1, 1},

240  { 4, 
s_1_3
, -1, 1},

241  { 4, 
s_1_4
, -1, 1},

242  { 4, 
s_1_5
, -1, 1},

243  { 4, 
s_1_6
, -1, 1},

244  { 4, 
s_1_7
, -1, 1},

245  { 4, 
s_1_8
, -1, 1},

246  { 4, 
s_1_9
, -1, 1},

247  { 4, 
s_1_10
, -1, 1},

248  { 4, 
s_1_11
, -1, 1},

249  { 4, 
s_1_12
, -1, 1},

250  { 4, 
s_1_13
, -1, 1},

251  { 6, 
s_1_14
, -1, 1},

252  { 6, 
s_1_15
, -1, 1},

253  { 4, 
s_1_16
, -1, 1},

254  { 4, 
s_1_17
, -1, 1},

255  { 4, 
s_1_18
, -1, 1},

256  { 4, 
s_1_19
, -1, 1},

257  { 4, 
s_1_20
, -1, 1},

258  { 4, 
s_1_21
, -1, 1},

259  { 4, 
s_1_22
, -1, 1},

260  { 4, 
s_1_23
, -1, 1},

261  { 6, 
s_1_24
, -1, 1},

262  { 6, 
s_1_25
, -1, 1}

266 cÚ¡ 
amÚg
 
	ga_2
[8] =

268  { 4, 
s_2_0
, -1, 1},

269  { 6, 
s_2_1
, 0, 2},

270  { 6, 
s_2_2
, 0, 2},

271  { 2, 
s_2_3
, -1, 1},

272  { 4, 
s_2_4
, 3, 1},

273  { 6, 
s_2_5
, 4, 2},

274  { 4, 
s_2_6
, -1, 1},

275  { 4, 
s_2_7
, -1, 1}

279 cÚ¡ 
amÚg
 
	ga_3
[2] =

281  { 4, 
s_3_0
, -1, 1},

282  { 4, 
s_3_1
, -1, 1}

286 cÚ¡ 
amÚg
 
	ga_4
[46] =

288  { 4, 
s_4_0
, -1, 2},

289  { 4, 
s_4_1
, -1, 1},

290  { 6, 
s_4_2
, 1, 2},

291  { 4, 
s_4_3
, -1, 2},

292  { 4, 
s_4_4
, -1, 1},

293  { 6, 
s_4_5
, 4, 2},

294  { 4, 
s_4_6
, -1, 2},

295  { 4, 
s_4_7
, -1, 1},

296  { 6, 
s_4_8
, 7, 2},

297  { 4, 
s_4_9
, -1, 1},

298  { 6, 
s_4_10
, 9, 2},

299  { 6, 
s_4_11
, 9, 2},

300  { 6, 
s_4_12
, -1, 1},

301  { 6, 
s_4_13
, -1, 2},

302  { 2, 
s_4_14
, -1, 2},

303  { 4, 
s_4_15
, 14, 2},

304  { 4, 
s_4_16
, -1, 1},

305  { 6, 
s_4_17
, 16, 2},

306  { 6, 
s_4_18
, 16, 2},

307  { 4, 
s_4_19
, -1, 1},

308  { 6, 
s_4_20
, 19, 2},

309  { 6, 
s_4_21
, -1, 1},

310  { 6, 
s_4_22
, -1, 2},

311  { 6, 
s_4_23
, -1, 1},

312  { 8, 
s_4_24
, 23, 2},

313  { 8, 
s_4_25
, 23, 2},

314  { 4, 
s_4_26
, -1, 1},

315  { 6, 
s_4_27
, 26, 2},

316  { 6, 
s_4_28
, 26, 2},

317  { 2, 
s_4_29
, -1, 1},

318  { 4, 
s_4_30
, 29, 2},

319  { 4, 
s_4_31
, 29, 2},

320  { 2, 
s_4_32
, -1, 1},

321  { 4, 
s_4_33
, 32, 2},

322  { 4, 
s_4_34
, 32, 2},

323  { 4, 
s_4_35
, -1, 2},

324  { 4, 
s_4_36
, -1, 1},

325  { 4, 
s_4_37
, -1, 2},

326  { 2, 
s_4_38
, -1, 1},

327  { 4, 
s_4_39
, 38, 2},

328  { 4, 
s_4_40
, -1, 1},

329  { 6, 
s_4_41
, 40, 2},

330  { 6, 
s_4_42
, 40, 2},

331  { 4, 
s_4_43
, -1, 1},

332  { 6, 
s_4_44
, 43, 2},

333  { 6, 
s_4_45
, 43, 1}

337 cÚ¡ 
amÚg
 
	ga_5
[36] =

339  { 2, 
s_5_0
, -1, 1},

340  { 4, 
s_5_1
, -1, 1},

341  { 6, 
s_5_2
, 1, 1},

342  { 4, 
s_5_3
, -1, 1},

343  { 2, 
s_5_4
, -1, 1},

344  { 2, 
s_5_5
, -1, 1},

345  { 2, 
s_5_6
, -1, 1},

346  { 4, 
s_5_7
, 6, 1},

347  { 4, 
s_5_8
, 6, 1},

348  { 2, 
s_5_9
, -1, 1},

349  { 4, 
s_5_10
, 9, 1},

350  { 4, 
s_5_11
, 9, 1},

351  { 2, 
s_5_12
, -1, 1},

352  { 4, 
s_5_13
, -1, 1},

353  { 4, 
s_5_14
, -1, 1},

354  { 2, 
s_5_15
, -1, 1},

355  { 4, 
s_5_16
, 15, 1},

356  { 4, 
s_5_17
, 15, 1},

357  { 2, 
s_5_18
, -1, 1},

358  { 4, 
s_5_19
, 18, 1},

359  { 4, 
s_5_20
, 18, 1},

360  { 6, 
s_5_21
, 18, 1},

361  { 8, 
s_5_22
, 21, 1},

362  { 6, 
s_5_23
, 18, 1},

363  { 2, 
s_5_24
, -1, 1},

364  { 4, 
s_5_25
, 24, 1},

365  { 6, 
s_5_26
, 25, 1},

366  { 4, 
s_5_27
, 24, 1},

367  { 4, 
s_5_28
, 24, 1},

368  { 4, 
s_5_29
, -1, 1},

369  { 6, 
s_5_30
, 29, 1},

370  { 4, 
s_5_31
, -1, 1},

371  { 4, 
s_5_32
, -1, 1},

372  { 6, 
s_5_33
, 32, 1},

373  { 4, 
s_5_34
, -1, 1},

374  { 2, 
s_5_35
, -1, 1}

378 cÚ¡ 
amÚg
 
	ga_6
[2] =

380  { 6, 
s_6_0
, -1, 1},

381  { 8, 
s_6_1
, -1, 1}

385 cÚ¡ 
amÚg
 
	ga_7
[4] =

387  { 6, 
s_7_0
, -1, 1},

388  { 2, 
s_7_1
, -1, 3},

389  { 8, 
s_7_2
, -1, 1},

390  { 2, 
s_7_3
, -1, 2}

393 cÚ¡ 
	gg_v
[] = { 33, 65, 8, 232 };

395 cÚ¡ 
symbŞ
 
	gs_0
[] = { 0xD0, 0xB0 };

396 cÚ¡ 
symbŞ
 
	gs_1
[] = { 0xD1, 0x8F };

397 cÚ¡ 
symbŞ
 
	gs_2
[] = { 0xD0, 0xB0 };

398 cÚ¡ 
symbŞ
 
	gs_3
[] = { 0xD1, 0x8F };

399 cÚ¡ 
symbŞ
 
	gs_4
[] = { 0xD0, 0xB0 };

400 cÚ¡ 
symbŞ
 
	gs_5
[] = { 0xD1, 0x8F };

401 cÚ¡ 
symbŞ
 
	gs_6
[] = { 0xD0, 0xBD };

402 cÚ¡ 
symbŞ
 
	gs_7
[] = { 0xD0, 0xBD };

403 cÚ¡ 
symbŞ
 
	gs_8
[] = { 0xD0, 0xBD };

404 cÚ¡ 
symbŞ
 
	gs_9
[] = { 0xD0, 0xB8 };

406 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_m¬k_»giÚs
() {

407 
I_pV
 = 
l
;

408 
I_p2
 = 
l
;

409 { 
c1
 = 
c
;

410 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 1072, 1103, 1);

411 ià(
»t
 < 0è
Ïb0
;

412 
c
 +ğ
»t
;

414 
I_pV
 = 
c
;

415 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 1072, 1103, 1);

416 ià(
»t
 < 0è
Ïb0
;

417 
c
 +ğ
»t
;

419 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 1072, 1103, 1);

420 ià(
»t
 < 0è
Ïb0
;

421 
c
 +ğ
»t
;

423 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 1072, 1103, 1);

424 ià(
»t
 < 0è
Ïb0
;

425 
c
 +ğ
»t
;

427 
I_p2
 = 
c
;

428 
Ïb0
:

429 
c
 = 
c1
;

432 
	}
}

434 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_R2
() {

435 ià(!(
I_p2
 <ğ
c
))  0;

437 
	}
}

439 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_³rãùive_g”und
() {

440 
amÚg_v¬
;

441 
k‘
 = 
c
;

442 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 9, 0, 0);

443 ià(!(
amÚg_v¬
))  0;

444 
b¿
 = 
c
;

445 
amÚg_v¬
) {

448 { 
m1
 = 
l
 - 
c
; ()m1;

449 ià(!(
	`eq_s_b
(2, 
s_0
))è
Ïb1
;

450 
Ïb0
;

451 
Ïb1
:

452 
c
 = 
l
 - 
m1
;

453 ià(!(
	`eq_s_b
(2, 
s_1
)))  0;

455 
Ïb0
:

456 ià(
	`¦iû_d–
() == -1)  -1;

459 ià(
	`¦iû_d–
() == -1)  -1;

463 
	}
}

465 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_adjeùive
() {

466 
amÚg_v¬
;

467 
k‘
 = 
c
;

468 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 26, 0, 0);

469 ià(!(
amÚg_v¬
))  0;

470 
b¿
 = 
c
;

471 
amÚg_v¬
) {

474 ià(
	`¦iû_d–
() == -1)  -1;

478 
	}
}

480 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_adjeùiv®
() {

481 
amÚg_v¬
;

482 { 
»t
 = 
	`r_adjeùive
();

483 ià(
»t
 <= 0) „et;

485 { 
m1
 = 
l
 - 
c
; ()m1;

486 
k‘
 = 
c
;

487 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 8, 0, 0);

488 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

489 
b¿
 = 
c
;

490 
amÚg_v¬
) {

491 0: { 
c
 = 
l
 - 
m1
; 
Ïb0
; }

493 { 
m2
 = 
l
 - 
c
; ()m2;

494 ià(!(
	`eq_s_b
(2, 
s_2
))è
Ïb2
;

495 
Ïb1
;

496 
Ïb2
:

497 
c
 = 
l
 - 
m2
;

498 ià(!(
	`eq_s_b
(2, 
s_3
))è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

500 
Ïb1
:

501 ià(
	`¦iû_d–
() == -1)  -1;

504 ià(
	`¦iû_d–
() == -1)  -1;

507 
Ïb0
:

511 
	}
}

513 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_»æexive
() {

514 
amÚg_v¬
;

515 
k‘
 = 
c
;

516 ià(
c
 - 3 <ğ
lb
 || (
p
[c - 1] != 140 &&…[c - 1] != 143))  0;

517 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 2, 0, 0);

518 ià(!(
amÚg_v¬
))  0;

519 
b¿
 = 
c
;

520 
amÚg_v¬
) {

523 ià(
	`¦iû_d–
() == -1)  -1;

527 
	}
}

529 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_v”b
() {

530 
amÚg_v¬
;

531 
k‘
 = 
c
;

532 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 46, 0, 0);

533 ià(!(
amÚg_v¬
))  0;

534 
b¿
 = 
c
;

535 
amÚg_v¬
) {

538 { 
m1
 = 
l
 - 
c
; ()m1;

539 ià(!(
	`eq_s_b
(2, 
s_4
))è
Ïb1
;

540 
Ïb0
;

541 
Ïb1
:

542 
c
 = 
l
 - 
m1
;

543 ià(!(
	`eq_s_b
(2, 
s_5
)))  0;

545 
Ïb0
:

546 ià(
	`¦iû_d–
() == -1)  -1;

549 ià(
	`¦iû_d–
() == -1)  -1;

553 
	}
}

555 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_noun
() {

556 
amÚg_v¬
;

557 
k‘
 = 
c
;

558 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 36, 0, 0);

559 ià(!(
amÚg_v¬
))  0;

560 
b¿
 = 
c
;

561 
amÚg_v¬
) {

564 ià(
	`¦iû_d–
() == -1)  -1;

568 
	}
}

570 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_d”iv©iÚ®
() {

571 
amÚg_v¬
;

572 
k‘
 = 
c
;

573 ià(
c
 - 5 <ğ
lb
 || (
p
[c - 1] != 130 &&…[c - 1] != 140))  0;

574 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 2, 0, 0);

575 ià(!(
amÚg_v¬
))  0;

576 
b¿
 = 
c
;

577 { 
»t
 = 
	`r_R2
();

578 ià(
»t
 <= 0) „et;

580 
amÚg_v¬
) {

583 ià(
	`¦iû_d–
() == -1)  -1;

587 
	}
}

589 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$r_tidy_up
() {

590 
amÚg_v¬
;

591 
k‘
 = 
c
;

592 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 4, 0, 0);

593 ià(!(
amÚg_v¬
))  0;

594 
b¿
 = 
c
;

595 
amÚg_v¬
) {

598 ià(
	`¦iû_d–
() == -1)  -1;

599 
k‘
 = 
c
;

600 ià(!(
	`eq_s_b
(2, 
s_6
)))  0;

601 
b¿
 = 
c
;

602 ià(!(
	`eq_s_b
(2, 
s_7
)))  0;

603 ià(
	`¦iû_d–
() == -1)  -1;

606 ià(!(
	`eq_s_b
(2, 
s_8
)))  0;

607 ià(
	`¦iû_d–
() == -1)  -1;

610 ià(
	`¦iû_d–
() == -1)  -1;

614 
	}
}

616 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$¡em
() {

617 { 
c1
 = 
c
;

618 { 
»t
 = 
	`r_m¬k_»giÚs
();

619 ià(
»t
 =ğ0è
Ïb0
;

620 ià(
»t
 < 0) „et;

622 
Ïb0
:

623 
c
 = 
c1
;

625 
lb
 = 
c
; c = 
l
;

627 { 
m2
 = 
l
 - 
c
; ()m2;

628 
mlim™2
;

629 ià(
c
 < 
I_pV
)  0;

630 
c
 = 
I_pV
;

631 
mlim™2
 = 
lb
;†b = 
c
;

632 
c
 = 
l
 - 
m2
;

633 { 
m3
 = 
l
 - 
c
; ()m3;

634 { 
m4
 = 
l
 - 
c
; ()m4;

635 { 
»t
 = 
	`r_³rãùive_g”und
();

636 ià(
»t
 =ğ0è
Ïb3
;

637 ià(
»t
 < 0) „et;

639 
Ïb2
;

640 
Ïb3
:

641 
c
 = 
l
 - 
m4
;

642 { 
m5
 = 
l
 - 
c
; ()m5;

643 { 
»t
 = 
	`r_»æexive
();

644 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m5
; 
Ïb4
; }

645 ià(
»t
 < 0) „et;

647 
Ïb4
:

650 { 
m6
 = 
l
 - 
c
; ()m6;

651 { 
»t
 = 
	`r_adjeùiv®
();

652 ià(
»t
 =ğ0è
Ïb6
;

653 ià(
»t
 < 0) „et;

655 
Ïb5
;

656 
Ïb6
:

657 
c
 = 
l
 - 
m6
;

658 { 
»t
 = 
	`r_v”b
();

659 ià(
»t
 =ğ0è
Ïb7
;

660 ià(
»t
 < 0) „et;

662 
Ïb5
;

663 
Ïb7
:

664 
c
 = 
l
 - 
m6
;

665 { 
»t
 = 
	`r_noun
();

666 ià(
»t
 =ğ0è
Ïb1
;

667 ià(
»t
 < 0) „et;

670 
Ïb5
:

673 
Ïb2
:

674 
Ïb1
:

675 
c
 = 
l
 - 
m3
;

677 { 
m7
 = 
l
 - 
c
; ()m7;

678 
k‘
 = 
c
;

679 ià(!(
	`eq_s_b
(2, 
s_9
))è{ 
c
 = 
l
 - 
m7
; 
Ïb8
; }

680 
b¿
 = 
c
;

681 ià(
	`¦iû_d–
() == -1)  -1;

682 
Ïb8
:

685 { 
m8
 = 
l
 - 
c
; ()m8;

686 { 
»t
 = 
	`r_d”iv©iÚ®
();

687 ià(
»t
 =ğ0è
Ïb9
;

688 ià(
»t
 < 0) „et;

690 
Ïb9
:

691 
c
 = 
l
 - 
m8
;

693 { 
m9
 = 
l
 - 
c
; ()m9;

694 { 
»t
 = 
	`r_tidy_up
();

695 ià(
»t
 =ğ0è
Ïb10
;

696 ià(
»t
 < 0) „et;

698 
Ïb10
:

699 
c
 = 
l
 - 
m9
;

701 
lb
 = 
mlim™2
;

703 
c
 = 
lb
;

705 
	}
}

707 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$IÁ”ÇlS‹mRussŸn
()

708 : 
	`I_p2
(0), 
	$I_pV
(0)

710 
	}
}

712 
	gX­Ÿn
::
IÁ”ÇlS‹mRussŸn
::~
	$IÁ”ÇlS‹mRussŸn
()

714 
	}
}

717 
X­Ÿn
::
IÁ”ÇlS‹mRussŸn
::
	$g‘_desütiÚ
() const

720 
	}
}

	@languages/russian.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mRussŸn
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_p2
;

9 
	gI_pV
;

10 
	gpublic
:

11 
r_tidy_up
();

12 
r_d”iv©iÚ®
();

13 
r_noun
();

14 
r_v”b
();

15 
r_»æexive
();

16 
r_adjeùiv®
();

17 
r_adjeùive
();

18 
r_³rãùive_g”und
();

19 
r_R2
();

20 
r_m¬k_»giÚs
();

22 
IÁ”ÇlS‹mRussŸn
();

23 ~
IÁ”ÇlS‹mRussŸn
();

24 
¡em
();

25 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/spanish.cc

3 
	~<lim™s.h
>

4 
	~"¥ªish.h
"

6 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

7 
	#s_0_1
 0

	)

9 
	#s_0_2
 2

	)

11 
	#s_0_3
 4

	)

13 
	#s_0_4
 6

	)

15 
	#s_0_5
 8

	)

17 
	#s_1_0
 (
s_1_1
 + 2)

	)

18 
	#s_1_1
 
s_1_8


	)

19 
	#s_1_2
 
s_1_9


	)

20 
	#s_1_3
 10

	)

22 
	#s_1_4
 
s_1_1


	)

23 
	#s_1_5
 (
s_1_6
 + 2)

	)

24 
	#s_1_6
 
s_1_11


	)

25 
	#s_1_7
 (
s_1_8
 + 2)

	)

26 
	#s_1_8
 12

	)

28 
	#s_1_9
 17

	)

30 
	#s_1_10
 (
s_1_11
 + 2)

	)

31 
	#s_1_11
 20

	)

33 
	#s_1_12
 25

	)

35 
	#s_2_0
 28

	)

37 
	#s_2_1
 32

	)

39 
	#s_2_2
 37

	)

41 
	#s_2_3
 42

	)

43 
	#s_2_4
 47

	)

45 
	#s_2_5
 53

	)

47 
	#s_2_6
 55

	)

49 
	#s_2_7
 57

	)

51 
	#s_2_8
 59

	)

53 
	#s_2_9
 62

	)

55 
	#s_2_10
 65

	)

57 
	#s_3_0
 68

	)

59 
	#s_3_1
 70

	)

61 
	#s_3_2
 72

	)

63 
	#s_3_3
 74

	)

65 
	#s_4_0
 76

	)

67 
	#s_4_1
 80

	)

69 
	#s_4_2
 84

	)

71 
	#s_5_0
 88

	)

73 
	#s_5_1
 90

	)

75 
	#s_5_2
 94

	)

77 
	#s_6_0
 
s_6_24


	)

78 
	#s_6_1
 
s_6_25


	)

79 
	#s_6_2
 
s_6_26


	)

80 
	#s_6_3
 
s_6_27


	)

81 
	#s_6_4
 
s_6_28


	)

82 
	#s_6_5
 
s_6_29


	)

83 
	#s_6_6
 
s_6_30


	)

84 
	#s_6_7
 
s_6_31


	)

85 
	#s_6_8
 
s_6_32


	)

86 
	#s_6_9
 
s_6_33


	)

87 
	#s_6_10
 
s_6_34


	)

88 
	#s_6_11
 
s_6_35


	)

89 
	#s_6_12
 
s_6_39


	)

90 
	#s_6_13
 (
s_6_14
 + 1)

	)

91 
	#s_6_14
 96

	)

93 
	#s_6_15
 102

	)

95 
	#s_6_16
 108

	)

97 
	#s_6_17
 
s_6_40


	)

98 
	#s_6_18
 
s_6_41


	)

99 
	#s_6_19
 
s_6_42


	)

100 
	#s_6_20
 
s_6_43


	)

101 
	#s_6_21
 
s_6_44


	)

102 
	#s_6_22
 
s_6_45


	)

103 
	#s_6_23
 
s_6_3


	)

104 
	#s_6_24
 114

	)

106 
	#s_6_25
 118

	)

108 
	#s_6_26
 124

	)

110 
	#s_6_27
 130

	)

112 
	#s_6_28
 136

	)

114 
	#s_6_29
 140

	)

116 
	#s_6_30
 145

	)

118 
	#s_6_31
 149

	)

120 
	#s_6_32
 154

	)

122 
	#s_6_33
 161

	)

124 
	#s_6_34
 167

	)

126 
	#s_6_35
 172

	)

128 
	#s_6_36
 177

	)

130 
	#s_6_37
 184

	)

132 
	#s_6_38
 191

	)

134 
	#s_6_39
 197

	)

136 
	#s_6_40
 202

	)

138 
	#s_6_41
 206

	)

140 
	#s_6_42
 211

	)

142 
	#s_6_43
 215

	)

144 
	#s_6_44
 223

	)

146 
	#s_6_45
 231

	)

148 
	#s_7_0
 
s_7_2


	)

149 
	#s_7_1
 
s_7_3


	)

150 
	#s_7_2
 235

	)

152 
	#s_7_3
 
s_7_5


	)

153 
	#s_7_4
 238

	)

155 
	#s_7_5
 243

	)

157 
	#s_7_6
 248

	)

159 
	#s_7_7
 250

	)

161 
	#s_7_8
 253

	)

163 
	#s_7_9
 256

	)

165 
	#s_7_10
 260

	)

167 
	#s_7_11
 265

	)

169 
	#s_8_0
 
s_8_17


	)

170 
	#s_8_1
 
s_8_41


	)

171 
	#s_8_2
 
s_8_42


	)

172 
	#s_8_3
 
s_8_18


	)

173 
	#s_8_4
 
s_8_19


	)

174 
	#s_8_5
 (
s_8_6
 + 2)

	)

175 
	#s_8_6
 
s_8_21


	)

176 
	#s_8_7
 
s_8_22


	)

177 
	#s_8_8
 
s_8_23


	)

178 
	#s_8_9
 
s_8_1


	)

179 
	#s_8_10
 268

	)

181 
	#s_8_11
 
s_8_2


	)

182 
	#s_8_12
 
s_8_25


	)

183 
	#s_8_13
 
s_8_26


	)

184 
	#s_8_14
 
s_8_61


	)

185 
	#s_8_15
 
s_8_62


	)

186 
	#s_8_16
 (
s_8_17
 + 2)

	)

187 
	#s_8_17
 270

	)

189 
	#s_8_18
 274

	)

191 
	#s_8_19
 278

	)

193 
	#s_8_20
 (
s_8_21
 + 2)

	)

194 
	#s_8_21
 283

	)

196 
	#s_8_22
 289

	)

198 
	#s_8_23
 295

	)

200 
	#s_8_24
 (
s_8_25
 + 2)

	)

201 
	#s_8_25
 301

	)

203 
	#s_8_26
 305

	)

205 
	#s_8_27
 310

	)

207 
	#s_8_28
 314

	)

209 
	#s_8_29
 319

	)

211 
	#s_8_30
 324

	)

213 
	#s_8_31
 329

	)

215 
	#s_8_32
 
s_8_68


	)

216 
	#s_8_33
 
s_8_69


	)

217 
	#s_8_34
 334

	)

219 
	#s_8_35
 338

	)

221 
	#s_8_36
 
s_8_3


	)

222 
	#s_8_37
 (
s_8_4
 + 1)

	)

223 
	#s_8_38
 
s_8_8


	)

224 
	#s_8_39
 
s_8_12


	)

225 
	#s_8_40
 343

	)

227 
	#s_8_41
 347

	)

229 
	#s_8_42
 351

	)

231 
	#s_8_43
 355

	)

233 
	#s_8_44
 359

	)

235 
	#s_8_45
 (
s_8_46
 + 2)

	)

236 
	#s_8_46
 364

	)

238 
	#s_8_47
 370

	)

240 
	#s_8_48
 376

	)

242 
	#s_8_49
 (
s_8_13
 + 1)

	)

243 
	#s_8_50
 382

	)

245 
	#s_8_51
 386

	)

247 
	#s_8_52
 391

	)

249 
	#s_8_53
 396

	)

251 
	#s_8_54
 401

	)

253 
	#s_8_55
 (
s_8_56
 + 2)

	)

254 
	#s_8_56
 407

	)

256 
	#s_8_57
 414

	)

258 
	#s_8_58
 421

	)

260 
	#s_8_59
 428

	)

262 
	#s_8_60
 433

	)

264 
	#s_8_61
 439

	)

266 
	#s_8_62
 445

	)

268 
	#s_8_63
 451

	)

270 
	#s_8_64
 (
s_8_65
 + 2)

	)

271 
	#s_8_65
 455

	)

273 
	#s_8_66
 461

	)

275 
	#s_8_67
 467

	)

277 
	#s_8_68
 473

	)

279 
	#s_8_69
 477

	)

281 
	#s_8_70
 (
s_8_71
 + 3)

	)

282 
	#s_8_71
 481

	)

284 
	#s_8_72
 488

	)

286 
	#s_8_73
 495

	)

288 
	#s_8_74
 (
s_8_75
 + 2)

	)

289 
	#s_8_75
 503

	)

291 
	#s_8_76
 511

	)

293 
	#s_8_77
 519

	)

295 
	#s_8_78
 (
s_8_79
 + 2)

	)

296 
	#s_8_79
 527

	)

298 
	#s_8_80
 533

	)

300 
	#s_8_81
 539

	)

302 
	#s_8_82
 545

	)

304 
	#s_8_83
 552

	)

306 
	#s_8_84
 560

	)

308 
	#s_8_85
 564

	)

310 
	#s_8_86
 569

	)

312 
	#s_8_87
 574

	)

314 
	#s_8_88
 579

	)

316 
	#s_8_89
 
s_8_29


	)

317 
	#s_8_90
 
s_8_30


	)

318 
	#s_8_91
 
s_8_31


	)

319 
	#s_8_92
 
s_8_65


	)

320 
	#s_8_93
 
s_8_66


	)

321 
	#s_8_94
 
s_8_67


	)

322 
	#s_8_95
 582

	)

324 
	#s_9_0
 585

	)

326 
	#s_9_1
 586

	)

328 
	#s_9_2
 
s_9_3


	)

329 
	#s_9_3
 587

	)

331 
	#s_9_4
 589

	)

333 
	#s_9_5
 591

	)

335 
	#s_9_6
 593

	)

337 
	#s_9_7
 595

	)

342 cÚ¡ 
amÚg
 
	ga_0
[6] =

345  { 2, 
s_0_1
, 0, 1},

346  { 2, 
s_0_2
, 0, 2},

347  { 2, 
s_0_3
, 0, 3},

348  { 2, 
s_0_4
, 0, 4},

349  { 2, 
s_0_5
, 0, 5}

353 cÚ¡ 
amÚg
 
	ga_1
[13] =

355  { 2, 
s_1_0
, -1, -1},

356  { 4, 
s_1_1
, 0, -1},

357  { 2, 
s_1_2
, -1, -1},

358  { 2, 
s_1_3
, -1, -1},

359  { 2, 
s_1_4
, -1, -1},

360  { 2, 
s_1_5
, -1, -1},

361  { 4, 
s_1_6
, 5, -1},

362  { 3, 
s_1_7
, -1, -1},

363  { 5, 
s_1_8
, 7, -1},

364  { 3, 
s_1_9
, -1, -1},

365  { 3, 
s_1_10
, -1, -1},

366  { 5, 
s_1_11
, 10, -1},

367  { 3, 
s_1_12
, -1, -1}

371 cÚ¡ 
amÚg
 
	ga_2
[11] =

373  { 4, 
s_2_0
, -1, 6},

374  { 5, 
s_2_1
, -1, 6},

375  { 5, 
s_2_2
, -1, 7},

376  { 5, 
s_2_3
, -1, 2},

377  { 6, 
s_2_4
, -1, 1},

378  { 2, 
s_2_5
, -1, 6},

379  { 2, 
s_2_6
, -1, 6},

380  { 2, 
s_2_7
, -1, 6},

381  { 3, 
s_2_8
, -1, 3},

382  { 3, 
s_2_9
, -1, 4},

383  { 3, 
s_2_10
, -1, 5}

387 cÚ¡ 
amÚg
 
	ga_3
[4] =

389  { 2, 
s_3_0
, -1, -1},

390  { 2, 
s_3_1
, -1, -1},

391  { 2, 
s_3_2
, -1, -1},

392  { 2, 
s_3_3
, -1, 1}

396 cÚ¡ 
amÚg
 
	ga_4
[3] =

398  { 4, 
s_4_0
, -1, 1},

399  { 4, 
s_4_1
, -1, 1},

400  { 4, 
s_4_2
, -1, 1}

404 cÚ¡ 
amÚg
 
	ga_5
[3] =

406  { 2, 
s_5_0
, -1, 1},

407  { 4, 
s_5_1
, -1, 1},

408  { 2, 
s_5_2
, -1, 1}

412 cÚ¡ 
amÚg
 
	ga_6
[46] =

414  { 3, 
s_6_0
, -1, 1},

415  { 5, 
s_6_1
, -1, 2},

416  { 5, 
s_6_2
, -1, 5},

417  { 5, 
s_6_3
, -1, 2},

418  { 3, 
s_6_4
, -1, 1},

419  { 4, 
s_6_5
, -1, 1},

420  { 3, 
s_6_6
, -1, 9},

421  { 4, 
s_6_7
, -1, 1},

422  { 6, 
s_6_8
, -1, 3},

423  { 4, 
s_6_9
, -1, 8},

424  { 4, 
s_6_10
, -1, 1},

425  { 4, 
s_6_11
, -1, 1},

426  { 4, 
s_6_12
, -1, 2},

427  { 5, 
s_6_13
, -1, 7},

428  { 6, 
s_6_14
, 13, 6},

429  { 6, 
s_6_15
, -1, 2},

430  { 6, 
s_6_16
, -1, 4},

431  { 3, 
s_6_17
, -1, 1},

432  { 4, 
s_6_18
, -1, 1},

433  { 3, 
s_6_19
, -1, 1},

434  { 7, 
s_6_20
, -1, 1},

435  { 7, 
s_6_21
, -1, 1},

436  { 3, 
s_6_22
, -1, 9},

437  { 4, 
s_6_23
, -1, 2},

438  { 4, 
s_6_24
, -1, 1},

439  { 6, 
s_6_25
, -1, 2},

440  { 6, 
s_6_26
, -1, 5},

441  { 6, 
s_6_27
, -1, 2},

442  { 4, 
s_6_28
, -1, 1},

443  { 5, 
s_6_29
, -1, 1},

444  { 4, 
s_6_30
, -1, 9},

445  { 5, 
s_6_31
, -1, 1},

446  { 7, 
s_6_32
, -1, 3},

447  { 6, 
s_6_33
, -1, 8},

448  { 5, 
s_6_34
, -1, 1},

449  { 5, 
s_6_35
, -1, 1},

450  { 7, 
s_6_36
, -1, 2},

451  { 7, 
s_6_37
, -1, 4},

452  { 6, 
s_6_38
, -1, 2},

453  { 5, 
s_6_39
, -1, 2},

454  { 4, 
s_6_40
, -1, 1},

455  { 5, 
s_6_41
, -1, 1},

456  { 4, 
s_6_42
, -1, 1},

457  { 8, 
s_6_43
, -1, 1},

458  { 8, 
s_6_44
, -1, 1},

459  { 4, 
s_6_45
, -1, 9}

463 cÚ¡ 
amÚg
 
	ga_7
[12] =

465  { 2, 
s_7_0
, -1, 1},

466  { 2, 
s_7_1
, -1, 1},

467  { 3, 
s_7_2
, -1, 1},

468  { 3, 
s_7_3
, -1, 1},

469  { 5, 
s_7_4
, -1, 1},

470  { 5, 
s_7_5
, -1, 1},

471  { 2, 
s_7_6
, -1, 1},

472  { 3, 
s_7_7
, -1, 1},

473  { 3, 
s_7_8
, -1, 1},

474  { 4, 
s_7_9
, -1, 1},

475  { 5, 
s_7_10
, -1, 1},

476  { 3, 
s_7_11
, -1, 1}

480 cÚ¡ 
amÚg
 
	ga_8
[96] =

482  { 3, 
s_8_0
, -1, 2},

483  { 3, 
s_8_1
, -1, 2},

484  { 3, 
s_8_2
, -1, 2},

485  { 3, 
s_8_3
, -1, 2},

486  { 4, 
s_8_4
, -1, 2},

487  { 3, 
s_8_5
, -1, 2},

488  { 5, 
s_8_6
, 5, 2},

489  { 5, 
s_8_7
, 5, 2},

490  { 5, 
s_8_8
, 5, 2},

491  { 2, 
s_8_9
, -1, 2},

492  { 2, 
s_8_10
, -1, 2},

493  { 2, 
s_8_11
, -1, 2},

494  { 3, 
s_8_12
, -1, 2},

495  { 4, 
s_8_13
, -1, 2},

496  { 4, 
s_8_14
, -1, 2},

497  { 4, 
s_8_15
, -1, 2},

498  { 2, 
s_8_16
, -1, 2},

499  { 4, 
s_8_17
, 16, 2},

500  { 4, 
s_8_18
, 16, 2},

501  { 5, 
s_8_19
, 16, 2},

502  { 4, 
s_8_20
, 16, 2},

503  { 6, 
s_8_21
, 20, 2},

504  { 6, 
s_8_22
, 20, 2},

505  { 6, 
s_8_23
, 20, 2},

506  { 2, 
s_8_24
, -1, 1},

507  { 4, 
s_8_25
, 24, 2},

508  { 5, 
s_8_26
, 24, 2},

509  { 4, 
s_8_27
, -1, 2},

510  { 5, 
s_8_28
, -1, 2},

511  { 5, 
s_8_29
, -1, 2},

512  { 5, 
s_8_30
, -1, 2},

513  { 5, 
s_8_31
, -1, 2},

514  { 3, 
s_8_32
, -1, 2},

515  { 3, 
s_8_33
, -1, 2},

516  { 4, 
s_8_34
, -1, 2},

517  { 5, 
s_8_35
, -1, 2},

518  { 2, 
s_8_36
, -1, 2},

519  { 2, 
s_8_37
, -1, 2},

520  { 2, 
s_8_38
, -1, 2},

521  { 2, 
s_8_39
, -1, 2},

522  { 4, 
s_8_40
, 39, 2},

523  { 4, 
s_8_41
, 39, 2},

524  { 4, 
s_8_42
, 39, 2},

525  { 4, 
s_8_43
, 39, 2},

526  { 5, 
s_8_44
, 39, 2},

527  { 4, 
s_8_45
, 39, 2},

528  { 6, 
s_8_46
, 45, 2},

529  { 6, 
s_8_47
, 45, 2},

530  { 6, 
s_8_48
, 45, 2},

531  { 2, 
s_8_49
, -1, 1},

532  { 4, 
s_8_50
, 49, 2},

533  { 5, 
s_8_51
, 49, 2},

534  { 5, 
s_8_52
, -1, 2},

535  { 5, 
s_8_53
, -1, 2},

536  { 6, 
s_8_54
, -1, 2},

537  { 5, 
s_8_55
, -1, 2},

538  { 7, 
s_8_56
, 55, 2},

539  { 7, 
s_8_57
, 55, 2},

540  { 7, 
s_8_58
, 55, 2},

541  { 5, 
s_8_59
, -1, 2},

542  { 6, 
s_8_60
, -1, 2},

543  { 6, 
s_8_61
, -1, 2},

544  { 6, 
s_8_62
, -1, 2},

545  { 4, 
s_8_63
, -1, 2},

546  { 4, 
s_8_64
, -1, 1},

547  { 6, 
s_8_65
, 64, 2},

548  { 6, 
s_8_66
, 64, 2},

549  { 6, 
s_8_67
, 64, 2},

550  { 4, 
s_8_68
, -1, 2},

551  { 4, 
s_8_69
, -1, 2},

552  { 4, 
s_8_70
, -1, 2},

553  { 7, 
s_8_71
, 70, 2},

554  { 7, 
s_8_72
, 70, 2},

555  { 8, 
s_8_73
, 70, 2},

556  { 6, 
s_8_74
, 70, 2},

557  { 8, 
s_8_75
, 74, 2},

558  { 8, 
s_8_76
, 74, 2},

559  { 8, 
s_8_77
, 74, 2},

560  { 4, 
s_8_78
, -1, 1},

561  { 6, 
s_8_79
, 78, 2},

562  { 6, 
s_8_80
, 78, 2},

563  { 6, 
s_8_81
, 78, 2},

564  { 7, 
s_8_82
, 78, 2},

565  { 8, 
s_8_83
, 78, 2},

566  { 4, 
s_8_84
, -1, 2},

567  { 5, 
s_8_85
, -1, 2},

568  { 5, 
s_8_86
, -1, 2},

569  { 5, 
s_8_87
, -1, 2},

570  { 3, 
s_8_88
, -1, 2},

571  { 4, 
s_8_89
, -1, 2},

572  { 4, 
s_8_90
, -1, 2},

573  { 4, 
s_8_91
, -1, 2},

574  { 4, 
s_8_92
, -1, 2},

575  { 4, 
s_8_93
, -1, 2},

576  { 4, 
s_8_94
, -1, 2},

577  { 3, 
s_8_95
, -1, 2}

581 cÚ¡ 
amÚg
 
	ga_9
[8] =

583  { 1, 
s_9_0
, -1, 1},

584  { 1, 
s_9_1
, -1, 2},

585  { 1, 
s_9_2
, -1, 1},

586  { 2, 
s_9_3
, -1, 1},

587  { 2, 
s_9_4
, -1, 1},

588  { 2, 
s_9_5
, -1, 2},

589  { 2, 
s_9_6
, -1, 1},

590  { 2, 
s_9_7
, -1, 1}

593 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 17, 4, 10 };

595 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'a' };

596 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'e' };

597 cÚ¡ 
symbŞ
 
	gs_2
[] = { 'i' };

598 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'o' };

599 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'u' };

600 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'i', 'e', 'n', 'd', 'o' };

601 cÚ¡ 
symbŞ
 
	gs_6
[] = { 'a', 'n', 'd', 'o' };

602 cÚ¡ 
symbŞ
 
	gs_7
[] = { 'a', 'r' };

603 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'e', 'r' };

604 cÚ¡ 
symbŞ
 
	gs_9
[] = { 'i', 'r' };

605 cÚ¡ 
symbŞ
 
	gs_10
[] = { 'i', 'c' };

606 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'l', 'o', 'g' };

607 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'u' };

608 cÚ¡ 
symbŞ
 
	gs_13
[] = { 'e', 'n', 't', 'e' };

609 cÚ¡ 
symbŞ
 
	gs_14
[] = { 'a', 't' };

610 cÚ¡ 
symbŞ
 
	gs_15
[] = { 'a', 't' };

612 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_m¬k_»giÚs
() {

613 
I_pV
 = 
l
;

614 
I_p1
 = 
l
;

615 
I_p2
 = 
l
;

616 { 
c1
 = 
c
;

617 { 
c2
 = 
c
;

618 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb2
;

619 { 
c3
 = 
c
;

620 ià(
	`out_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb4
;

621 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

622 ià(
»t
 < 0è
Ïb4
;

623 
c
 +ğ
»t
;

625 
Ïb3
;

626 
Ïb4
:

627 
c
 = 
c3
;

628 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb2
;

629 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 252, 1);

630 ià(
»t
 < 0è
Ïb2
;

631 
c
 +ğ
»t
;

634 
Ïb3
:

635 
Ïb1
;

636 
Ïb2
:

637 
c
 = 
c2
;

638 ià(
	`out_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb0
;

639 { 
c4
 = 
c
;

640 ià(
	`out_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb6
;

641 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

642 ià(
»t
 < 0è
Ïb6
;

643 
c
 +ğ
»t
;

645 
Ïb5
;

646 
Ïb6
:

647 
c
 = 
c4
;

648 ià(
	`š_groupšg_U
(
g_v
, 97, 252, 0)è
Ïb0
;

649 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

650 ià(
»t
 < 0è
Ïb0
;

651 
c
 = 
»t
;

654 
Ïb5
:

657 
Ïb1
:

658 
I_pV
 = 
c
;

659 
Ïb0
:

660 
c
 = 
c1
;

662 { 
c5
 = 
c
;

663 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

664 ià(
»t
 < 0è
Ïb7
;

665 
c
 +ğ
»t
;

667 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 252, 1);

668 ià(
»t
 < 0è
Ïb7
;

669 
c
 +ğ
»t
;

671 
I_p1
 = 
c
;

672 { 
»t
 = 
	`out_groupšg_U
(
g_v
, 97, 252, 1);

673 ià(
»t
 < 0è
Ïb7
;

674 
c
 +ğ
»t
;

676 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 252, 1);

677 ià(
»t
 < 0è
Ïb7
;

678 
c
 +ğ
»t
;

680 
I_p2
 = 
c
;

681 
Ïb7
:

682 
c
 = 
c5
;

685 
	}
}

687 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_po¡lude
() {

688 
amÚg_v¬
;

690 
c1
 = 
c
;

691 
b¿
 = 
c
;

692 ià(
c
 + 1 >ğ
l
 || 
p
[ø+ 1] >> 5 !ğ5 || !((67641858 >> (p[ø+ 1] & 0x1f)è& 1)è
amÚg_v¬
 = 6; 

693 
amÚg_v¬
 = 
	`fšd_amÚg
(
s_poŞ
, 
a_0
, 6, 0, 0);

694 ià(!(
amÚg_v¬
)è
Ïb0
;

695 
k‘
 = 
c
;

696 
amÚg_v¬
) {

697 0: 
Ïb0
;

699 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_0
);

700 ià(
»t
 < 0) „et;

704 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_1
);

705 ià(
»t
 < 0) „et;

709 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_2
);

710 ià(
»t
 < 0) „et;

714 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_3
);

715 ià(
»t
 < 0) „et;

719 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_4
);

720 ià(
»t
 < 0) „et;

724 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

725 ià(
»t
 < 0è
Ïb0
;

726 
c
 = 
»t
;

731 
Ïb0
:

732 
c
 = 
c1
;

736 
	}
}

738 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_RV
() {

739 ià(!(
I_pV
 <ğ
c
))  0;

741 
	}
}

743 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_R1
() {

744 ià(!(
I_p1
 <ğ
c
))  0;

746 
	}
}

748 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_R2
() {

749 ià(!(
I_p2
 <ğ
c
))  0;

751 
	}
}

753 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_©ched_´Úoun
() {

754 
amÚg_v¬
;

755 
k‘
 = 
c
;

756 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((557090 >> (p[c - 1] & 0x1f)) & 1))  0;

757 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 13, 0, 0)))  0;

758 
b¿
 = 
c
;

759 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 111 &&…[c - 1] != 114))  0;

760 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 11, 0, 0);

761 ià(!(
amÚg_v¬
))  0;

762 { 
»t
 = 
	`r_RV
();

763 ià(
»t
 <= 0) „et;

765 
amÚg_v¬
) {

768 
b¿
 = 
c
;

769 { 
»t
 = 
	`¦iû_äom_s
(5, 
s_5
);

770 ià(
»t
 < 0) „et;

774 
b¿
 = 
c
;

775 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_6
);

776 ià(
»t
 < 0) „et;

780 
b¿
 = 
c
;

781 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_7
);

782 ià(
»t
 < 0) „et;

786 
b¿
 = 
c
;

787 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_8
);

788 ià(
»t
 < 0) „et;

792 
b¿
 = 
c
;

793 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_9
);

794 ià(
»t
 < 0) „et;

798 ià(
	`¦iû_d–
() == -1)  -1;

801 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'u')  0;

802 
c
--;

803 ià(
	`¦iû_d–
() == -1)  -1;

807 
	}
}

809 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_¡ªd¬d_suffix
() {

810 
amÚg_v¬
;

811 
k‘
 = 
c
;

812 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((835634 >> (p[c - 1] & 0x1f)) & 1))  0;

813 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 46, 0, 0);

814 ià(!(
amÚg_v¬
))  0;

815 
b¿
 = 
c
;

816 
amÚg_v¬
) {

819 { 
»t
 = 
	`r_R2
();

820 ià(
»t
 <= 0) „et;

822 ià(
	`¦iû_d–
() == -1)  -1;

825 { 
»t
 = 
	`r_R2
();

826 ià(
»t
 <= 0) „et;

828 ià(
	`¦iû_d–
() == -1)  -1;

829 { 
m1
 = 
l
 - 
c
; ()m1;

830 
k‘
 = 
c
;

831 ià(!(
	`eq_s_b
(2, 
s_10
))è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

832 
b¿
 = 
c
;

833 { 
»t
 = 
	`r_R2
();

834 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

835 ià(
»t
 < 0) „et;

837 ià(
	`¦iû_d–
() == -1)  -1;

838 
Ïb0
:

843 { 
»t
 = 
	`r_R2
();

844 ià(
»t
 <= 0) „et;

846 { 
»t
 = 
	`¦iû_äom_s
(3, 
s_11
);

847 ià(
»t
 < 0) „et;

851 { 
»t
 = 
	`r_R2
();

852 ià(
»t
 <= 0) „et;

854 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_12
);

855 ià(
»t
 < 0) „et;

859 { 
»t
 = 
	`r_R2
();

860 ià(
»t
 <= 0) „et;

862 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_13
);

863 ià(
»t
 < 0) „et;

867 { 
»t
 = 
	`r_R1
();

868 ià(
»t
 <= 0) „et;

870 ià(
	`¦iû_d–
() == -1)  -1;

871 { 
m2
 = 
l
 - 
c
; ()m2;

872 
k‘
 = 
c
;

873 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((4718616 >> (p[ø- 1] & 0x1f)è& 1)è{ c = 
l
 - 
m2
; 
Ïb1
; }

874 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 4, 0, 0);

875 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

876 
b¿
 = 
c
;

877 { 
»t
 = 
	`r_R2
();

878 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

879 ià(
»t
 < 0) „et;

881 ià(
	`¦iû_d–
() == -1)  -1;

882 
amÚg_v¬
) {

883 0: { 
c
 = 
l
 - 
m2
; 
Ïb1
; }

885 
k‘
 = 
c
;

886 ià(!(
	`eq_s_b
(2, 
s_14
))è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

887 
b¿
 = 
c
;

888 { 
»t
 = 
	`r_R2
();

889 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m2
; 
Ïb1
; }

890 ià(
»t
 < 0) „et;

892 ià(
	`¦iû_d–
() == -1)  -1;

895 
Ïb1
:

900 { 
»t
 = 
	`r_R2
();

901 ià(
»t
 <= 0) „et;

903 ià(
	`¦iû_d–
() == -1)  -1;

904 { 
m3
 = 
l
 - 
c
; ()m3;

905 
k‘
 = 
c
;

906 ià(
c
 - 3 <ğ
lb
 || 
p
[ø- 1] !ğ101è{ c = 
l
 - 
m3
; 
Ïb2
; }

907 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 3, 0, 0);

908 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m3
; 
Ïb2
; }

909 
b¿
 = 
c
;

910 
amÚg_v¬
) {

911 0: { 
c
 = 
l
 - 
m3
; 
Ïb2
; }

913 { 
»t
 = 
	`r_R2
();

914 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb2
; }

915 ià(
»t
 < 0) „et;

917 ià(
	`¦iû_d–
() == -1)  -1;

920 
Ïb2
:

925 { 
»t
 = 
	`r_R2
();

926 ià(
»t
 <= 0) „et;

928 ià(
	`¦iû_d–
() == -1)  -1;

929 { 
m4
 = 
l
 - 
c
; ()m4;

930 
k‘
 = 
c
;

931 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((4198408 >> (p[ø- 1] & 0x1f)è& 1)è{ c = 
l
 - 
m4
; 
Ïb3
; }

932 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 3, 0, 0);

933 ià(!(
amÚg_v¬
)è{ 
c
 = 
l
 - 
m4
; 
Ïb3
; }

934 
b¿
 = 
c
;

935 
amÚg_v¬
) {

936 0: { 
c
 = 
l
 - 
m4
; 
Ïb3
; }

938 { 
»t
 = 
	`r_R2
();

939 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m4
; 
Ïb3
; }

940 ià(
»t
 < 0) „et;

942 ià(
	`¦iû_d–
() == -1)  -1;

945 
Ïb3
:

950 { 
»t
 = 
	`r_R2
();

951 ià(
»t
 <= 0) „et;

953 ià(
	`¦iû_d–
() == -1)  -1;

954 { 
m5
 = 
l
 - 
c
; ()m5;

955 
k‘
 = 
c
;

956 ià(!(
	`eq_s_b
(2, 
s_15
))è{ 
c
 = 
l
 - 
m5
; 
Ïb4
; }

957 
b¿
 = 
c
;

958 { 
»t
 = 
	`r_R2
();

959 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m5
; 
Ïb4
; }

960 ià(
»t
 < 0) „et;

962 ià(
	`¦iû_d–
() == -1)  -1;

963 
Ïb4
:

969 
	}
}

971 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_y_v”b_suffix
() {

972 
amÚg_v¬
;

973 { 
m1
 = 
l
 - 
c
; ()m1;

974 
mlim™1
;

975 ià(
c
 < 
I_pV
)  0;

976 
c
 = 
I_pV
;

977 
mlim™1
 = 
lb
;†b = 
c
;

978 
c
 = 
l
 - 
m1
;

979 
k‘
 = 
c
;

980 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 12, 0, 0);

981 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

982 
b¿
 = 
c
;

983 
lb
 = 
mlim™1
;

985 
amÚg_v¬
) {

988 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'u')  0;

989 
c
--;

990 ià(
	`¦iû_d–
() == -1)  -1;

994 
	}
}

996 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_v”b_suffix
() {

997 
amÚg_v¬
;

998 { 
m1
 = 
l
 - 
c
; ()m1;

999 
mlim™1
;

1000 ià(
c
 < 
I_pV
)  0;

1001 
c
 = 
I_pV
;

1002 
mlim™1
 = 
lb
;†b = 
c
;

1003 
c
 = 
l
 - 
m1
;

1004 
k‘
 = 
c
;

1005 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_8
, 96, 0, 0);

1006 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

1007 
b¿
 = 
c
;

1008 
lb
 = 
mlim™1
;

1010 
amÚg_v¬
) {

1013 { 
m2
 = 
l
 - 
c
; ()m2;

1014 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è{ c = 
l
 - 
m2
; 
Ïb0
; }

1015 
c
--;

1016 { 
m_‹¡3
 = 
l
 - 
c
;

1017 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'g'è{ c = 
l
 - 
m2
; 
Ïb0
; }

1018 
c
--;

1019 
c
 = 
l
 - 
m_‹¡3
;

1021 
Ïb0
:

1024 
b¿
 = 
c
;

1025 ià(
	`¦iû_d–
() == -1)  -1;

1028 ià(
	`¦iû_d–
() == -1)  -1;

1032 
	}
}

1034 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$r_»sidu®_suffix
() {

1035 
amÚg_v¬
;

1036 
k‘
 = 
c
;

1037 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_9
, 8, 0, 0);

1038 ià(!(
amÚg_v¬
))  0;

1039 
b¿
 = 
c
;

1040 
amÚg_v¬
) {

1043 { 
»t
 = 
	`r_RV
();

1044 ià(
»t
 <= 0) „et;

1046 ià(
	`¦iû_d–
() == -1)  -1;

1049 { 
»t
 = 
	`r_RV
();

1050 ià(
»t
 <= 0) „et;

1052 ià(
	`¦iû_d–
() == -1)  -1;

1053 { 
m1
 = 
l
 - 
c
; ()m1;

1054 
k‘
 = 
c
;

1055 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è{ c = 
l
 - 
m1
; 
Ïb0
; }

1056 
c
--;

1057 
b¿
 = 
c
;

1058 { 
m_‹¡2
 = 
l
 - 
c
;

1059 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'g'è{ c = 
l
 - 
m1
; 
Ïb0
; }

1060 
c
--;

1061 
c
 = 
l
 - 
m_‹¡2
;

1063 { 
»t
 = 
	`r_RV
();

1064 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m1
; 
Ïb0
; }

1065 ià(
»t
 < 0) „et;

1067 ià(
	`¦iû_d–
() == -1)  -1;

1068 
Ïb0
:

1074 
	}
}

1076 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$¡em
() {

1077 { 
c1
 = 
c
;

1078 { 
»t
 = 
	`r_m¬k_»giÚs
();

1079 ià(
»t
 =ğ0è
Ïb0
;

1080 ià(
»t
 < 0) „et;

1082 
Ïb0
:

1083 
c
 = 
c1
;

1085 
lb
 = 
c
; c = 
l
;

1087 { 
m2
 = 
l
 - 
c
; ()m2;

1088 { 
»t
 = 
	`r_©ched_´Úoun
();

1089 ià(
»t
 =ğ0è
Ïb1
;

1090 ià(
»t
 < 0) „et;

1092 
Ïb1
:

1093 
c
 = 
l
 - 
m2
;

1095 { 
m3
 = 
l
 - 
c
; ()m3;

1096 { 
m4
 = 
l
 - 
c
; ()m4;

1097 { 
»t
 = 
	`r_¡ªd¬d_suffix
();

1098 ià(
»t
 =ğ0è
Ïb4
;

1099 ià(
»t
 < 0) „et;

1101 
Ïb3
;

1102 
Ïb4
:

1103 
c
 = 
l
 - 
m4
;

1104 { 
»t
 = 
	`r_y_v”b_suffix
();

1105 ià(
»t
 =ğ0è
Ïb5
;

1106 ià(
»t
 < 0) „et;

1108 
Ïb3
;

1109 
Ïb5
:

1110 
c
 = 
l
 - 
m4
;

1111 { 
»t
 = 
	`r_v”b_suffix
();

1112 ià(
»t
 =ğ0è
Ïb2
;

1113 ià(
»t
 < 0) „et;

1116 
Ïb3
:

1117 
Ïb2
:

1118 
c
 = 
l
 - 
m3
;

1120 { 
m5
 = 
l
 - 
c
; ()m5;

1121 { 
»t
 = 
	`r_»sidu®_suffix
();

1122 ià(
»t
 =ğ0è
Ïb6
;

1123 ià(
»t
 < 0) „et;

1125 
Ïb6
:

1126 
c
 = 
l
 - 
m5
;

1128 
c
 = 
lb
;

1129 { 
c6
 = 
c
;

1130 { 
»t
 = 
	`r_po¡lude
();

1131 ià(
»t
 =ğ0è
Ïb7
;

1132 ià(
»t
 < 0) „et;

1134 
Ïb7
:

1135 
c
 = 
c6
;

1138 
	}
}

1140 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$IÁ”ÇlS‹mS·nish
()

1141 : 
	`I_p2
(0), 
	`I_p1
(0), 
	$I_pV
(0)

1143 
	}
}

1145 
	gX­Ÿn
::
IÁ”ÇlS‹mS·nish
::~
	$IÁ”ÇlS‹mS·nish
()

1147 
	}
}

1150 
X­Ÿn
::
IÁ”ÇlS‹mS·nish
::
	$g‘_desütiÚ
() const

1153 
	}
}

	@languages/spanish.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mS·nish
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_p2
;

9 
	gI_p1
;

10 
	gI_pV
;

11 
	gpublic
:

12 
r_»sidu®_suffix
();

13 
r_v”b_suffix
();

14 
r_y_v”b_suffix
();

15 
r_¡ªd¬d_suffix
();

16 
r_©ched_´Úoun
();

17 
r_R2
();

18 
r_R1
();

19 
r_RV
();

20 
r_m¬k_»giÚs
();

21 
r_po¡lude
();

23 
IÁ”ÇlS‹mS·nish
();

24 ~
IÁ”ÇlS‹mS·nish
();

25 
¡em
();

26 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/stem.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/¡em.h
>

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"¡emš‹º®.h
"

29 
	~"®l¢owb®lh—d”s.h
"

31 
	~<¡ršg
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
Çme¥aû
 
	gX­Ÿn
 {

37 
	gS‹m
::
S‹m
(cÚ¡ S‹m & 
o
è: 
š‹º®
(o.internal) { }

40 
S‹m
::
İ”©Ü
=(cÚ¡ S‹m & 
o
)

42 
š‹º®
 = 
o
.internal;

45 
	gS‹m
::
S‹m
(è: 
š‹º®
(0) { }

47 
S‹m
::S‹m(cÚ¡ 
¡d
::
¡ršg
 &
Ïnguage
è: 
š‹º®
(0) {

48 ià(
Ïnguage
.
em±y
()) ;

49 
	gÏnguage
[0]) {

51 ià(
Ïnguage
 == "da" ||†anguage == "danish") {

52 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mDªish
;

55 ià(
	gÏnguage
 == "dutch") {

56 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mDutch
;

59 ià(
	gÏnguage
 == "de") {

60 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mG”mª
;

65 ià(
Ïnguage
 == "en" ||†anguage == "english") {

66 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mEnglish
;

69 ià(
	gÏnguage
 == "es") {

70 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mS·nish
;

75 ià(
Ïnguage
 == "fi" ||†anguage == "finnish") {

76 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mFšnish
;

79 ià(
	gÏnguage
 =ğ"ä" || 
Ïnguage
 == "french") {

80 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mF»nch
;

85 ià(
Ïnguage
 == "german") {

86 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mG”mª
;

89 ià(
	gÏnguage
 == "german2") {

90 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mG”mª2
;

95 ià(
Ïnguage
 == "hu" ||†anguage == "hungarian") {

96 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mHung¬Ÿn
;

101 ià(
Ïnguage
 == "it" ||†anguage == "italian") {

102 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mIlŸn
;

107 ià(
Ïnguage
 == "kraaij_pohlmann") {

108 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mK¿aij_pohlmªn
;

113 ià(
Ïnguage
 == "lovins") {

114 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mLovšs
;

119 ià(
Ïnguage
 == "nl") {

120 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mDutch
;

123 ià(
	gÏnguage
 =ğ"no" || 
Ïnguage
 == "norwegian") {

124 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mNÜwegŸn
;

127 ià(
	gÏnguage
 == "none") {

132 ià(
Ïnguage
 == "pt" ||†anguage == "portuguese") {

133 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mPÜtugue£
;

136 ià(
	gÏnguage
 == "porter") {

137 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mPÜ‹r
;

142 ià(
Ïnguage
 == "ru" ||†anguage == "russian") {

143 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mRussŸn
;

146 ià(
	gÏnguage
 =ğ"ro" || 
Ïnguage
 == "romanian") {

147 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mRomªŸn
;

152 ià(
Ïnguage
 == "spanish") {

153 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mS·nish
;

156 ià(
	gÏnguage
 =ğ"sv" || 
Ïnguage
 == "swedish") {

157 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mSwedish
;

162 ià(
Ïnguage
 == "tr" ||†anguage == "turkish") {

163 
š‹º®
 = 
Ãw
 
IÁ”ÇlS‹mTurkish
;

168 
throw
 
	gX­Ÿn
::
Inv®idArgum’tE¼Ü
("Lªguagcod" + 
Ïnguage
 + " unknown");

171 
	gS‹m
::~
S‹m
() { }

173 
¡ršg


174 
S‹m
::
İ”©Ü
()(cÚ¡ 
¡d
::
¡ršg
 &
wÜd
) const

176 ià(!
š‹º®
.
g‘
(è|| 
wÜd
.
em±y
())  word;

177  
	gš‹º®
->
İ”©Ü
()(
	gwÜd
);

180 
¡ršg


181 
	gS‹m
::
g‘_desütiÚ
() const

183 
¡ršg
 
desc
 = "Xapian::Stem(";

184 ià(
	gš‹º®
.
g‘
()) {

185 
	gdesc
 +ğ
š‹º®
->
g‘_desütiÚ
();

186 
	gdesc
 += ')';

188 
	gdesc
 += "none)";

190  
	gdesc
;

193 
¡ršg


194 
	gS‹m
::
g‘_avaabË_Ïnguages
()

196  
LANGSTRING
;

	@languages/steminternal.cc

54 
	~<cÚfig.h
>

56 
	~"¡emš‹º®.h
"

58 
	~<x­Ÿn/”rÜ.h
>

60 
	~"omas£¹.h
"

62 
	~<c¡dlib
>

63 
	~<c¡ršg
>

65 
	~<¡ršg
>

67 
usšg
 
Çme¥aû
 
	g¡d
;

69 
	#CREATE_SIZE
 16

	)

71 
symbŞ
 * 
	$ü—‹_s
() {

72 * 
mem
 = 
	`m®loc
(
HEAD
 + (
CREATE_SIZE
 + 1è* (
symbŞ
));

73 ià(
mem
 =ğ
NULL
è
throw
 
¡d
::
	`bad_®loc
();

74 
symbŞ
 * 
p
 = 
»š‹½»t_ÿ¡
<symbŞ*>(
HEAD
 + 
¡©ic_ÿ¡
<*>(
mem
));

75 
	`SET_CAPACITY
(
p
, 
CREATE_SIZE
);

76 
	`SET_SIZE
(
p
, 
CREATE_SIZE
);

77  
p
;

78 
	}
}

88 
	$sk_utf8
(cÚ¡ 
symbŞ
 * 
p
, 
c
, 
lb
, 
l
, 
n
) {

89 ià(
n
 >= 0) {

90 ; 
n
 > 0;‚--) {

91 ià(
c
 >ğ
l
)  -1;

92 ià(
p
[
c
++] >= 0xC0) {

93 
c
 < 
l
) {

95 ià(
p
[
c
] >> 6 != 2) ;

96 
c
++;

101 ; 
n
 < 0;‚++) {

102 ià(
c
 <ğ
lb
)  -1;

103 ià(
p
[--
c
] >= 0x80) {

104 
c
 > 
lb
) {

105 ià(
p
[
c
] >= 0xC0) ;

106 
c
--;

111  
c
;

112 
	}
}

118 
symbŞ
 * 
	$šü—£_size
(
symbŞ
 * 
p
, 
n
) {

119 
Ãw_size
 = 
n
 + 20;

120 * 
mem
 = 
	`»®loc
(
»š‹½»t_ÿ¡
<*>(
p
è- 
HEAD
,

121 
HEAD
 + (
Ãw_size
 + 1è* (
symbŞ
));

122 ià(
mem
 =ğ
NULL
) {

123 
throw
 
¡d
::
	`bad_®loc
();

125 
symbŞ
 * 
q
 = 
»š‹½»t_ÿ¡
<symbŞ*>(
HEAD
 + 
¡©ic_ÿ¡
<*>(
mem
));

126 
	`SET_CAPACITY
(
q
, 
Ãw_size
);

127  
q
;

128 
	}
}

130 
Çme¥aû
 
X­Ÿn
 {

132 
S‹m
::
IÁ”Çl
::~Internal()

134 
lo£_s
(
p
);

137 
¡ršg


138 
S‹m
::
IÁ”Çl
::
İ”©Ü
()(cÚ¡ 
¡ršg
 & 
wÜd
)

140 cÚ¡ 
symbŞ
 * 
s
 = 
»š‹½»t_ÿ¡
<cÚ¡ symbŞ *>(
wÜd
.
d©a
());

141 
»¶aû_s
(0, 
l
, 
wÜd
.
size
(), 
s
);

142 
c
 = 0;

143 ià(
¡em
() < 0) {

145 
throw
 
X­Ÿn
::
IÁ”ÇlE¼Ü
("stemmingƒxception!");

147  
¡ršg
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
), 
l
);

152 
S‹m
::
IÁ”Çl
::
g‘_utf8
(* 
¦Ù
) {

153 
b0
, 
b1
;

154 
tmp
 = 
c
;

155 ià(
tmp
 >ğ
l
)  0;

156 
b0
 = 
p
[
tmp
++];

157 ià(
b0
 < 0xC0 || 
tmp
 =ğ
l
) {

158 * 
¦Ù
 = 
b0
;  1;

160 
b1
 = 
p
[
tmp
++];

161 ià(
b0
 < 0xE0 || 
tmp
 =ğ
l
) {

162 * 
¦Ù
 = (
b0
 & 0x1Fè<< 6 | (
b1
 & 0x3F);  2;

164 * 
¦Ù
 = (
b0
 & 0xFè<< 12 | (
b1
 & 0x3Fè<< 6 | (
p
[
tmp
] & 0x3F);  3;

167 
S‹m
::
IÁ”Çl
::
g‘_b_utf8
(* 
¦Ù
) {

168 
b0
, 
b1
;

169 
tmp
 = 
c
;

170 ià(
tmp
 <ğ
lb
)  0;

171 
b0
 = 
p
[--
tmp
];

172 ià(
b0
 < 0x80 || 
tmp
 =ğ
lb
) {

173 * 
¦Ù
 = 
b0
;  1;

175 
b1
 = 
p
[--
tmp
];

176 ià(
b1
 >ğ0xC0 || 
tmp
 =ğ
lb
) {

177 * 
¦Ù
 = (
b1
 & 0x1Fè<< 6 | (
b0
 & 0x3F);  2;

179 * 
¦Ù
 = (
p
[
tmp
] & 0xFè<< 12 | (
b1
 & 0x3Fè<< 6 | (
b0
 & 0x3F);  3;

182 
S‹m
::
IÁ”Çl
::
š_groupšg_U
(cÚ¡ * 
s
, 
mš
, 
max
, 
»³©
) {

184 
ch
;

185 
w
 = 
g‘_utf8
(&
ch
);

186 ià(!
w
)  -1;

187 ià(
ch
 > 
max
 || (ch -ğ
mš
è< 0 || (
s
[ch >> 3] & (0X1 << (ch & 0X7))) == 0)

188  
w
;

189 
c
 +ğ
w
;

190 } 
»³©
);

194 
S‹m
::
IÁ”Çl
::
š_groupšg_b_U
(cÚ¡ * 
s
, 
mš
, 
max
, 
»³©
) {

196 
ch
;

197 
w
 = 
g‘_b_utf8
(&
ch
);

198 ià(!
w
)  -1;

199 ià(
ch
 > 
max
 || (ch -ğ
mš
è< 0 || (
s
[ch >> 3] & (0X1 << (ch & 0X7))) == 0)

200  
w
;

201 
c
 -ğ
w
;

202 } 
»³©
);

206 
S‹m
::
IÁ”Çl
::
out_groupšg_U
(cÚ¡ * 
s
, 
mš
, 
max
, 
»³©
) {

208 
ch
;

209 
w
 = 
g‘_utf8
(&
ch
);

210 ià(!
w
)  -1;

211 ià(!(
ch
 > 
max
 || (ch -ğ
mš
è< 0 || (
s
[ch >> 3] & (0X1 << (ch & 0X7))) == 0))

212   
w
;

213 
c
 +ğ
w
;

214 } 
»³©
);

218 
S‹m
::
IÁ”Çl
::
out_groupšg_b_U
(cÚ¡ * 
s
, 
mš
, 
max
, 
»³©
) {

220 
ch
;

221 
w
 = 
g‘_b_utf8
(&
ch
);

222 ià(!
w
)  -1;

223 ià(!(
ch
 > 
max
 || (ch -ğ
mš
è< 0 || (
s
[ch >> 3] & (0X1 << (ch & 0X7))) == 0))

224  
w
;

225 
c
 -ğ
w
;

226 } 
»³©
);

230 
S‹m
::
IÁ”Çl
::
eq_s
(
s_size
, cÚ¡ 
symbŞ
 * 
s
) {

231 ià(
l
 - 
c
 < 
s_size
 || 
memcmp
(
p
 + c, 
s
, s_siz* (
symbŞ
)) != 0)

233 
c
 +ğ
s_size
;

237 
S‹m
::
IÁ”Çl
::
eq_s_b
(
s_size
, cÚ¡ 
symbŞ
 * 
s
) {

238 ià(
c
 - 
lb
 < 
s_size
 || 
memcmp
(
p
 + c - s_size, 
s
, s_siz* (
symbŞ
)) != 0)

240 
c
 -ğ
s_size
;

245 
S‹m
::
IÁ”Çl
::
fšd_amÚg
(cÚ¡ 
symbŞ
 * 
poŞ
, cÚ¡ 
amÚg
 * 
v
,

246 
v_size
, cÚ¡ * 
âum
,

247 cÚ¡ 
amÚg_funùiÚ
 * 
f
)

249 
i
 = 0;

250 
j
 = 
v_size
;

252 cÚ¡ 
symbŞ
 * 
q
 = 
p
 + 
c
;

253 
c_Üig
 = 
c
;

255 
commÚ_i
 = 0;

256 
commÚ_j
 = 0;

258 
fœ¡_key_š¥eùed
 = 0;

261 
k
 = 
i
 + ((
j
 - i) >> 1);

262 
diff
 = 0;

263 
commÚ
 = 
commÚ_i
 < 
commÚ_j
 ? common_i : common_j;

264 cÚ¡ 
amÚg
 * 
w
 = 
v
 + 
k
;

265 
x
 = 
commÚ
; x < 
w
->
s_size
; x++) {

266 ià(
c_Üig
 + 
commÚ
 =ğ
l
è{ 
diff
 = -1; ; }

267 
diff
 = 
q
[
commÚ
] - (
poŞ
 + 
w
->
s
)[
x
];

268 ià(
diff
 != 0) ;

269 
commÚ
++;

271 ià(
diff
 < 0è{ 
j
 = 
k
; 
commÚ_j
 = 
commÚ
; }

272 { 
i
 = 
k
; 
commÚ_i
 = 
commÚ
; }

273 ià(
j
 - 
i
 <= 1) {

274 ià(
i
 > 0) ;

275 ià(
j
 =ğ
i
) ;

281 ià(
fœ¡_key_š¥eùed
) ;

282 
fœ¡_key_š¥eùed
 = 1;

286 cÚ¡ 
amÚg
 * 
w
 = 
v
 + 
i
;

287 ià(
commÚ_i
 >ğ
w
->
s_size
) {

288 
c
 = 
c_Üig
 + 
w
->
s_size
;

289 ià(!
âum
 || !âum[
i
]è 
w
->
»suÉ
;

291 
»s
 = 
f
[
âum
[
i
] - 1](
this
);

292 
c
 = 
c_Üig
 + 
w
->
s_size
;

293 ià(
»s
è 
w
->
»suÉ
;

296 
i
 = 
w
->
sub¡ršg_i
;

297 ià(
i
 < 0)  0;

303 
S‹m
::
IÁ”Çl
::
fšd_amÚg_b
(cÚ¡ 
symbŞ
 * 
poŞ
, cÚ¡ 
amÚg
 * 
v
,

304 
v_size
, cÚ¡ * 
âum
,

305 cÚ¡ 
amÚg_funùiÚ
 * 
f
)

307 
i
 = 0;

308 
j
 = 
v_size
;

310 cÚ¡ 
symbŞ
 * 
q
 = 
p
 + 
c
 - 1;

311 
c_Üig
 = 
c
;

313 
commÚ_i
 = 0;

314 
commÚ_j
 = 0;

316 
fœ¡_key_š¥eùed
 = 0;

319 
k
 = 
i
 + ((
j
 - i) >> 1);

320 
diff
 = 0;

321 
commÚ
 = 
commÚ_i
 < 
commÚ_j
 ? common_i : common_j;

322 cÚ¡ 
amÚg
 * 
w
 = 
v
 + 
k
;

323 
x
 = 
w
->
s_size
 - 1 - 
commÚ
; x >= 0; x--) {

324 ià(
c_Üig
 - 
commÚ
 =ğ
lb
è{ 
diff
 = -1; ; }

325 
diff
 = 
q
[- 
commÚ
] - (
poŞ
 + 
w
->
s
)[
x
];

326 ià(
diff
 != 0) ;

327 
commÚ
++;

329 ià(
diff
 < 0è{ 
j
 = 
k
; 
commÚ_j
 = 
commÚ
; }

330 { 
i
 = 
k
; 
commÚ_i
 = 
commÚ
; }

331 ià(
j
 - 
i
 <= 1) {

332 ià(
i
 > 0) ;

333 ià(
j
 =ğ
i
) ;

334 ià(
fœ¡_key_š¥eùed
) ;

335 
fœ¡_key_š¥eùed
 = 1;

339 cÚ¡ 
amÚg
 * 
w
 = 
v
 + 
i
;

340 ià(
commÚ_i
 >ğ
w
->
s_size
) {

341 
c
 = 
c_Üig
 - 
w
->
s_size
;

342 ià(!
âum
 || !âum[
i
]è 
w
->
»suÉ
;

344 
»s
 = 
f
[
âum
[
i
] - 1](
this
);

345 
c
 = 
c_Üig
 - 
w
->
s_size
;

346 ià(
»s
è 
w
->
»suÉ
;

349 
i
 = 
w
->
sub¡ršg_i
;

350 ià(
i
 < 0)  0;

355 
S‹m
::
IÁ”Çl
::
»¶aû_s
(
c_b¿
, 
c_k‘
, 
s_size
, cÚ¡ 
symbŞ
 * 
s
)

357 
adju¡m’t
;

358 
Ën
;

359 
As£¹
(
p
);

360 
adju¡m’t
 = 
s_size
 - (
c_k‘
 - 
c_b¿
);

361 
Ën
 = 
SIZE
(
p
);

362 ià(
adju¡m’t
 != 0) {

363 ià(
adju¡m’t
 + 
Ën
 > 
CAPACITY
(
p
)) {

364 
p
 = 
šü—£_size
Õ, 
adju¡m’t
 + 
Ën
);

366 
memmove
(
p
 + 
c_k‘
 + 
adju¡m’t
,

367 
p
 + 
c_k‘
,

368 (
Ën
 - 
c_k‘
è* (
symbŞ
));

369 
SET_SIZE
(
p
, 
adju¡m’t
 + 
Ën
);

370 
l
 +ğ
adju¡m’t
;

371 ià(
c
 >ğ
c_k‘
)

372 
c
 +ğ
adju¡m’t
;

374 ià(
c
 > 
c_b¿
)

375 
c
 = 
c_b¿
;

377 ià(
s_size
 !ğ0è
memmove
(
p
 + 
c_b¿
, 
s
, s_siz* (
symbŞ
));

378  
adju¡m’t
;

381 
S‹m
::
IÁ”Çl
::
¦iû_check
() {

382 
As£¹
(
p
);

383 ià(
b¿
 < 0 || b¿ > 
k‘
 || k‘ > 
l
) {

385 
årštf
(
¡d”r
, "faulty slice operation:\n");

386 
debug
(
z
, -1, 0);

393 
S‹m
::
IÁ”Çl
::
¦iû_äom_s
(
s_size
, cÚ¡ 
symbŞ
 * 
s
) {

394 ià(
¦iû_check
())  -1;

395 
»¶aû_s
(
b¿
, 
k‘
, 
s_size
, 
s
);

399 
S‹m
::
IÁ”Çl
::
š£¹_s
(
c_b¿
, 
c_k‘
, 
s_size
, cÚ¡ 
symbŞ
 * 
s
) {

400 
adju¡m’t
 = 
»¶aû_s
(
c_b¿
, 
c_k‘
, 
s_size
, 
s
);

401 ià(
c_b¿
 <ğ
b¿
èb¿ +ğ
adju¡m’t
;

402 ià(
c_b¿
 <ğ
k‘
èk‘ +ğ
adju¡m’t
;

405 
symbŞ
 * 
S‹m
::
IÁ”Çl
::
¦iû_to
(symbŞ * 
v
) {

406 ià(
¦iû_check
()è 
NULL
;

408 
Ën
 = 
k‘
 - 
b¿
;

409 ià(
CAPACITY
(
v
è< 
Ën
) {

410 
v
 = 
šü—£_size
(v, 
Ën
);

412 
memmove
(
v
, 
p
 + 
b¿
, 
Ën
 * (
symbŞ
));

413 
SET_SIZE
(
v
, 
Ën
);

415  
v
;

418 
symbŞ
 * 
S‹m
::
IÁ”Çl
::
assign_to
(symbŞ * 
v
) {

419 
Ën
 = 
l
;

420 ià(
CAPACITY
(
v
è< 
Ën
) {

421 
v
 = 
šü—£_size
(v, 
Ën
);

423 
memmove
(
v
, 
p
, 
Ën
 * (
symbŞ
));

424 
SET_SIZE
(
v
, 
Ën
);

425  
v
;

429 
S‹m
::
IÁ”Çl
::
debug
(
numb”
, 
lše_couÁ
) {

430 
i
;

431 
lim™
 = 
SIZE
(
p
);

433 ià(
numb”
 >ğ0è
´štf
("%3d (lš%4d): [%d]'",‚umb”, 
lše_couÁ
,
lim™
);

434 
i
 = 0; i <ğ
lim™
; i++) {

435 ià(
lb
 =ğ
i
è
´štf
("{");

436 ià(
b¿
 =ğ
i
è
´štf
("[");

437 ià(
c
 =ğ
i
è
´štf
("|");

438 ià(
k‘
 =ğ
i
è
´štf
("]");

439 ià(
l
 =ğ
i
è
´štf
("}");

440 ià(
i
 < 
lim™
)

441 { 
ch
 = 
p
[
i
];

442 ià(
ch
 == 0) ch = '#';

443 
´štf
("%c", 
ch
);

446 
´štf
("'\n");

	@languages/steminternal.h

21 #iâdeà
XAPIAN_INCLUDED_STEMINTERNAL_H


22 
	#XAPIAN_INCLUDED_STEMINTERNAL_H


	)

24 
	~<x­Ÿn/ba£.h
>

25 
	~<x­Ÿn/¡em.h
>

27 
	~<c¡dlib
>

28 
	~<¡ršg
>

33 
	tsymbŞ
;

35 
	#HEAD
 (2*())

	)

40 
šlše
 

41 
	$SIZE
(cÚ¡ 
symbŞ
* 
p
)

43 cÚ¡ * 
void_p
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
);

44  
»š‹½»t_ÿ¡
<cÚ¡ *>(
void_p
)[-1];

45 
	}
}

47 
šlše
 

48 
	$SET_SIZE
(
symbŞ
* 
p
, 
n
)

50 * 
void_p
 = 
»š‹½»t_ÿ¡
<*>(
p
);

51 
»š‹½»t_ÿ¡
<*>(
void_p
)[-1] = 
n
;

52 
	}
}

54 
šlše
 

55 
	$CAPACITY
(cÚ¡ 
symbŞ
* 
p
)

57 cÚ¡ * 
void_p
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
);

58  
»š‹½»t_ÿ¡
<cÚ¡ *>(
void_p
)[-2];

59 
	}
}

61 
šlše
 

62 
	$SET_CAPACITY
(
symbŞ
* 
p
, 
n
)

64 * 
void_p
 = 
»š‹½»t_ÿ¡
<*>(
p
);

65 
»š‹½»t_ÿ¡
<*>(
void_p
)[-2] = 
n
;

66 
	}
}

68 (*
	tamÚg_funùiÚ
)(
	tX­Ÿn
::
	tS‹m
::
	tIÁ”Çl
 *);

70 
	samÚg
 {

71 
s_size
;

72 
s
;

73 
sub¡ršg_i
;

74 
»suÉ
;

77 
symbŞ
 * 
	`ü—‹_s
();

79 
šlše
 
	$lo£_s
(
symbŞ
 * 
p
) {

80 ià(
p
è
¡d
::
	`ä“
(
»š‹½»t_ÿ¡
<*>Õè- 
HEAD
);

81 
	}
}

83 
sk_utf8
(cÚ¡ 
symbŞ
 * 
p
, 
c
, 
lb
, 
l
, 
n
);

85 
Çme¥aû
 
	gX­Ÿn
 {

87 şas 
	cS‹m
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

88 
¦iû_check
();

90 
	g´Ùeùed
:

91 
symbŞ
 * 
p
;

92 
	gc
, 
	gl
, 
	glb
, 
	gb¿
, 
	gk‘
;

94 
g‘_utf8
(* 
¦Ù
);

95 
g‘_b_utf8
(* 
¦Ù
);

97 
š_groupšg_U
(cÚ¡ * 
s
, 
mš
, 
max
, 
»³©
);

98 
š_groupšg_b_U
(cÚ¡ * 
s
, 
mš
, 
max
, 
»³©
);

99 
out_groupšg_U
(cÚ¡ * 
s
, 
mš
, 
max
, 
»³©
);

100 
out_groupšg_b_U
(cÚ¡ * 
s
, 
mš
, 
max
, 
»³©
);

102 
eq_s
(
s_size
, cÚ¡ 
symbŞ
 * 
s
);

103 
eq_s_b
(
s_size
, cÚ¡ 
symbŞ
 * 
s
);

104 
eq_v
(cÚ¡ 
symbŞ
 * 
v
è{  
eq_s
(
SIZE
(v), v); }

105 
eq_v_b
(cÚ¡ 
symbŞ
 * 
v
è{  
eq_s_b
(
SIZE
(v), v); }

107 
fšd_amÚg
(cÚ¡ 
symbŞ
 *
poŞ
, cÚ¡ 
amÚg
 * 
v
, 
v_size
,

108 cÚ¡ * 
âum
, cÚ¡ 
amÚg_funùiÚ
 * 
f
);

109 
fšd_amÚg_b
(cÚ¡ 
symbŞ
 *
poŞ
, cÚ¡ 
amÚg
 * 
v
, 
v_size
,

110 cÚ¡ * 
âum
, cÚ¡ 
amÚg_funùiÚ
 * 
f
);

112 
»¶aû_s
(
c_b¿
, 
c_k‘
, 
s_size
, cÚ¡ 
symbŞ
 * 
s
);

113 
¦iû_äom_s
(
s_size
, cÚ¡ 
symbŞ
 * 
s
);

114 
¦iû_äom_v
(cÚ¡ 
symbŞ
 * 
v
è{  
¦iû_äom_s
(
SIZE
(v), v); }

116 
¦iû_d–
(è{  
¦iû_äom_s
(0, 0); }

118 
š£¹_s
(
c_b¿
, 
c_k‘
, 
s_size
, cÚ¡ 
symbŞ
 * 
s
);

119 
š£¹_v
(
c_b¿
, 
c_k‘
, cÚ¡ 
symbŞ
 * 
v
) {

120 
š£¹_s
(
c_b¿
, 
c_k‘
, 
SIZE
(
v
), v);

123 
symbŞ
 * 
¦iû_to
(symbŞ * 
v
);

124 
symbŞ
 * 
assign_to
(symbŞ * 
v
);

127 
debug
(
numb”
, 
lše_couÁ
);

130 
	gpublic
:

132 
IÁ”Çl
(è: 
p
(
ü—‹_s
()), 
c
(0), 
l
(0), 
lb
(0), 
b¿
(0), 
k‘
(0) { }

135 
	gvœtu®
 ~
IÁ”Çl
();

138 
	g¡d
::
¡ršg
 
İ”©Ü
()(cÚ¡ 
¡d
::¡ršg & 
wÜd
);

141 
vœtu®
 
¡em
() = 0;

144 
vœtu®
 cÚ¡ * 
g‘_desütiÚ
() const = 0;

	@languages/swedish.cc

3 
	~<lim™s.h
>

4 
	~"swedish.h
"

6 
	#s_0_0
 (
s_0_1
 + 3)

	)

7 
	#s_0_1
 
s_0_23


	)

8 
	#s_0_2
 (
s_0_3
 + 3)

	)

9 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

10 
	#s_0_3
 0

	)

12 
	#s_0_4
 
s_0_25


	)

13 
	#s_0_5
 
s_0_7


	)

14 
	#s_0_6
 
s_0_2


	)

15 
	#s_0_7
 
s_0_27


	)

16 
	#s_0_8
 
s_0_13


	)

17 
	#s_0_9
 7

	)

19 
	#s_0_10
 
s_0_14


	)

20 
	#s_0_11
 11

	)

22 
	#s_0_12
 (
s_0_13
 + 3)

	)

23 
	#s_0_13
 15

	)

25 
	#s_0_14
 
s_0_30


	)

26 
	#s_0_15
 
s_0_31


	)

27 
	#s_0_16
 
s_0_2


	)

28 
	#s_0_17
 
s_0_1


	)

29 
	#s_0_18
 
s_0_2


	)

30 
	#s_0_19
 
s_0_3


	)

31 
	#s_0_20
 
s_0_4


	)

32 
	#s_0_21
 (
s_0_11
 + 1)

	)

33 
	#s_0_22
 
s_0_11


	)

34 
	#s_0_23
 20

	)

36 
	#s_0_24
 25

	)

38 
	#s_0_25
 30

	)

40 
	#s_0_26
 (
s_0_27
 + 2)

	)

41 
	#s_0_27
 35

	)

43 
	#s_0_28
 39

	)

45 
	#s_0_29
 (
s_0_30
 + 2)

	)

46 
	#s_0_30
 44

	)

48 
	#s_0_31
 49

	)

50 
	#s_0_32
 55

	)

52 
	#s_0_33
 59

	)

54 
	#s_0_34
 61

	)

56 
	#s_0_35
 
s_0_3


	)

57 
	#s_0_36
 
s_0_11


	)

58 
	#s_1_0
 66

	)

60 
	#s_1_1
 68

	)

62 
	#s_1_2
 70

	)

64 
	#s_1_3
 72

	)

66 
	#s_1_4
 74

	)

68 
	#s_1_5
 76

	)

70 
	#s_1_6
 78

	)

72 
	#s_2_0
 (
s_2_1
 + 1)

	)

73 
	#s_2_1
 80

	)

75 
	#s_2_2
 83

	)

77 
	#s_2_3
 86

	)

79 
	#s_2_4
 91

	)

84 cÚ¡ 
amÚg
 
	ga_0
[37] =

86  { 1, 
s_0_0
, -1, 1},

87  { 4, 
s_0_1
, 0, 1},

88  { 4, 
s_0_2
, 0, 1},

89  { 7, 
s_0_3
, 2, 1},

90  { 4, 
s_0_4
, 0, 1},

91  { 2, 
s_0_5
, -1, 1},

92  { 1, 
s_0_6
, -1, 1},

93  { 3, 
s_0_7
, 6, 1},

94  { 4, 
s_0_8
, 6, 1},

95  { 4, 
s_0_9
, 6, 1},

96  { 3, 
s_0_10
, 6, 1},

97  { 4, 
s_0_11
, 6, 1},

98  { 2, 
s_0_12
, -1, 1},

99  { 5, 
s_0_13
, 12, 1},

100  { 4, 
s_0_14
, 12, 1},

101  { 5, 
s_0_15
, 12, 1},

102  { 3, 
s_0_16
, -1, 1},

103  { 2, 
s_0_17
, -1, 1},

104  { 2, 
s_0_18
, -1, 1},

105  { 5, 
s_0_19
, 18, 1},

106  { 2, 
s_0_20
, -1, 1},

107  { 1, 
s_0_21
, -1, 2},

108  { 2, 
s_0_22
, 21, 1},

109  { 5, 
s_0_23
, 22, 1},

110  { 5, 
s_0_24
, 22, 1},

111  { 5, 
s_0_25
, 22, 1},

112  { 2, 
s_0_26
, 21, 1},

113  { 4, 
s_0_27
, 26, 1},

114  { 5, 
s_0_28
, 26, 1},

115  { 3, 
s_0_29
, 21, 1},

116  { 5, 
s_0_30
, 29, 1},

117  { 6, 
s_0_31
, 29, 1},

118  { 4, 
s_0_32
, 21, 1},

119  { 2, 
s_0_33
, -1, 1},

120  { 5, 
s_0_34
, -1, 1},

121  { 3, 
s_0_35
, -1, 1},

122  { 3, 
s_0_36
, -1, 1}

126 cÚ¡ 
amÚg
 
	ga_1
[7] =

128  { 2, 
s_1_0
, -1, -1},

129  { 2, 
s_1_1
, -1, -1},

130  { 2, 
s_1_2
, -1, -1},

131  { 2, 
s_1_3
, -1, -1},

132  { 2, 
s_1_4
, -1, -1},

133  { 2, 
s_1_5
, -1, -1},

134  { 2, 
s_1_6
, -1, -1}

138 cÚ¡ 
amÚg
 
	ga_2
[5] =

140  { 2, 
s_2_0
, -1, 1},

141  { 3, 
s_2_1
, 0, 1},

142  { 3, 
s_2_2
, -1, 1},

143  { 5, 
s_2_3
, -1, 3},

144  { 5, 
s_2_4
, -1, 2}

147 cÚ¡ 
	gg_v
[] = { 17, 65, 16, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 0, 32 };

149 cÚ¡ 
	gg_s_’dšg
[] = { 119, 127, 149 };

151 cÚ¡ 
symbŞ
 
	gs_0
[] = { 'l', 0xC3, 0xB6, 's' };

152 cÚ¡ 
symbŞ
 
	gs_1
[] = { 'f', 'u', 'l', 'l' };

154 
	gX­Ÿn
::
IÁ”ÇlS‹mSwedish
::
	$r_m¬k_»giÚs
() {

155 
I_p1
 = 
l
;

156 { 
c_‹¡1
 = 
c
;

157 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, + 3);

158 ià(
»t
 < 0)  0;

159 
c
 = 
»t
;

161 
I_x
 = 
c
;

162 
c
 = 
c_‹¡1
;

164 ià(
	`out_groupšg_U
(
g_v
, 97, 246, 1) < 0)  0;

165 { 
»t
 = 
	`š_groupšg_U
(
g_v
, 97, 246, 1);

166 ià(
»t
 < 0)  0;

167 
c
 +ğ
»t
;

169 
I_p1
 = 
c
;

171 ià(!(
I_p1
 < 
I_x
)è
Ïb0
;

172 
I_p1
 = 
I_x
;

173 
Ïb0
:

175 
	}
}

177 
	gX­Ÿn
::
IÁ”ÇlS‹mSwedish
::
	$r_maš_suffix
() {

178 
amÚg_v¬
;

179 { 
m1
 = 
l
 - 
c
; ()m1;

180 
mlim™1
;

181 ià(
c
 < 
I_p1
)  0;

182 
c
 = 
I_p1
;

183 
mlim™1
 = 
lb
;†b = 
c
;

184 
c
 = 
l
 - 
m1
;

185 
k‘
 = 
c
;

186 ià(
c
 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1851442 >> (p[ø- 1] & 0x1f)è& 1)è{†b = 
mlim™1
;  0; }

187 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 37, 0, 0);

188 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

189 
b¿
 = 
c
;

190 
lb
 = 
mlim™1
;

192 
amÚg_v¬
) {

195 ià(
	`¦iû_d–
() == -1)  -1;

198 ià(
	`š_groupšg_b_U
(
g_s_’dšg
, 98, 121, 0))  0;

199 ià(
	`¦iû_d–
() == -1)  -1;

203 
	}
}

205 
	gX­Ÿn
::
IÁ”ÇlS‹mSwedish
::
	$r_cÚsÚªt_·œ
() {

206 { 
m1
 = 
l
 - 
c
; ()m1;

207 
mlim™1
;

208 ià(
c
 < 
I_p1
)  0;

209 
c
 = 
I_p1
;

210 
mlim™1
 = 
lb
;†b = 
c
;

211 
c
 = 
l
 - 
m1
;

212 { 
m2
 = 
l
 - 
c
; ()m2;

213 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1064976 >> (p[ø- 1] & 0x1f)è& 1)è{†b = 
mlim™1
;  0; }

214 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 7, 0, 0))è{ 
lb
 = 
mlim™1
;  0; }

215 
c
 = 
l
 - 
m2
;

216 
k‘
 = 
c
;

217 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

218 ià(
»t
 < 0è{ 
lb
 = 
mlim™1
;  0; }

219 
c
 = 
»t
;

221 
b¿
 = 
c
;

222 ià(
	`¦iû_d–
() == -1)  -1;

224 
lb
 = 
mlim™1
;

227 
	}
}

229 
	gX­Ÿn
::
IÁ”ÇlS‹mSwedish
::
	$r_Ùh”_suffix
() {

230 
amÚg_v¬
;

231 { 
m1
 = 
l
 - 
c
; ()m1;

232 
mlim™1
;

233 ià(
c
 < 
I_p1
)  0;

234 
c
 = 
I_p1
;

235 
mlim™1
 = 
lb
;†b = 
c
;

236 
c
 = 
l
 - 
m1
;

237 
k‘
 = 
c
;

238 ià(
c
 - 1 <ğ
lb
 || 
p
[ø- 1] >> 5 !ğ3 || !((1572992 >> (p[ø- 1] & 0x1f)è& 1)è{†b = 
mlim™1
;  0; }

239 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 5, 0, 0);

240 ià(!(
amÚg_v¬
)è{ 
lb
 = 
mlim™1
;  0; }

241 
b¿
 = 
c
;

242 
amÚg_v¬
) {

243 0: { 
lb
 = 
mlim™1
;  0; }

245 ià(
	`¦iû_d–
() == -1)  -1;

248 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_0
);

249 ià(
»t
 < 0) „et;

253 { 
»t
 = 
	`¦iû_äom_s
(4, 
s_1
);

254 ià(
»t
 < 0) „et;

258 
lb
 = 
mlim™1
;

261 
	}
}

263 
	gX­Ÿn
::
IÁ”ÇlS‹mSwedish
::
	$¡em
() {

264 { 
c1
 = 
c
;

265 { 
»t
 = 
	`r_m¬k_»giÚs
();

266 ià(
»t
 =ğ0è
Ïb0
;

267 ià(
»t
 < 0) „et;

269 
Ïb0
:

270 
c
 = 
c1
;

272 
lb
 = 
c
; c = 
l
;

274 { 
m2
 = 
l
 - 
c
; ()m2;

275 { 
»t
 = 
	`r_maš_suffix
();

276 ià(
»t
 =ğ0è
Ïb1
;

277 ià(
»t
 < 0) „et;

279 
Ïb1
:

280 
c
 = 
l
 - 
m2
;

282 { 
m3
 = 
l
 - 
c
; ()m3;

283 { 
»t
 = 
	`r_cÚsÚªt_·œ
();

284 ià(
»t
 =ğ0è
Ïb2
;

285 ià(
»t
 < 0) „et;

287 
Ïb2
:

288 
c
 = 
l
 - 
m3
;

290 { 
m4
 = 
l
 - 
c
; ()m4;

291 { 
»t
 = 
	`r_Ùh”_suffix
();

292 ià(
»t
 =ğ0è
Ïb3
;

293 ià(
»t
 < 0) „et;

295 
Ïb3
:

296 
c
 = 
l
 - 
m4
;

298 
c
 = 
lb
;

300 
	}
}

302 
	gX­Ÿn
::
IÁ”ÇlS‹mSwedish
::
	$IÁ”ÇlS‹mSwedish
()

303 : 
	`I_x
(0), 
	$I_p1
(0)

305 
	}
}

307 
	gX­Ÿn
::
IÁ”ÇlS‹mSwedish
::~
	$IÁ”ÇlS‹mSwedish
()

309 
	}
}

312 
X­Ÿn
::
IÁ”ÇlS‹mSwedish
::
	$g‘_desütiÚ
() const

315 
	}
}

	@languages/swedish.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mSwedish
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
I_x
;

9 
	gI_p1
;

10 
	gpublic
:

11 
r_Ùh”_suffix
();

12 
r_cÚsÚªt_·œ
();

13 
r_maš_suffix
();

14 
r_m¬k_»giÚs
();

16 
IÁ”ÇlS‹mSwedish
();

17 ~
IÁ”ÇlS‹mSwedish
();

18 
¡em
();

19 cÚ¡ * 
g‘_desütiÚ
() const;

	@languages/turkish.cc

3 
	~<lim™s.h
>

4 
	~"turkish.h
"

6 
	#s_0_0
 
s_0_2


	)

7 
	#s_0_1
 
s_0_3


	)

8 cÚ¡ 
symbŞ
 
	gs_poŞ
[] = {

9 
	#s_0_2
 0

	)

11 
	#s_0_3
 3

	)

13 
	#s_0_4
 6

	)

15 
	#s_0_5
 9

	)

17 
	#s_0_6
 12

	)

19 
	#s_0_7
 16

	)

21 
	#s_0_8
 20

	)

23 
	#s_0_9
 24

	)

25 
	#s_1_0
 28

	)

27 
	#s_1_1
 32

	)

29 
	#s_2_0
 37

	)

31 
	#s_2_1
 39

	)

33 
	#s_2_2
 41

	)

35 
	#s_2_3
 44

	)

37 
	#s_3_0
 47

	)

39 
	#s_3_1
 49

	)

41 
	#s_3_2
 51

	)

43 
	#s_3_3
 54

	)

45 
	#s_4_0
 57

	)

47 
	#s_4_1
 58

	)

49 
	#s_5_0
 59

	)

51 
	#s_5_1
 61

	)

53 
	#s_6_0
 63

	)

55 
	#s_6_1
 65

	)

57 
	#s_6_2
 67

	)

59 
	#s_6_3
 69

	)

61 
	#s_7_0
 71

	)

63 
	#s_7_1
 74

	)

65 
	#s_8_0
 77

	)

67 
	#s_8_1
 80

	)

69 
	#s_8_2
 83

	)

71 
	#s_8_3
 86

	)

73 
	#s_9_0
 89

	)

75 
	#s_9_1
 93

	)

77 
	#s_10_0
 97

	)

79 
	#s_10_1
 99

	)

81 
	#s_11_0
 101

	)

83 
	#s_11_1
 103

	)

85 
	#s_12_0
 105

	)

87 
	#s_12_1
 107

	)

89 
	#s_12_2
 109

	)

91 
	#s_12_3
 112

	)

93 
	#s_13_0
 115

	)

95 
	#s_13_1
 118

	)

97 
	#s_13_2
 121

	)

99 
	#s_13_3
 125

	)

101 
	#s_14_0
 129

	)

103 
	#s_14_1
 131

	)

105 
	#s_14_2
 133

	)

107 
	#s_14_3
 136

	)

109 
	#s_15_0
 139

	)

111 
	#s_15_1
 144

	)

113 
	#s_15_2
 149

	)

115 
	#s_15_3
 156

	)

117 
	#s_16_0
 163

	)

119 
	#s_16_1
 166

	)

121 
	#s_17_0
 169

	)

123 
	#s_17_1
 172

	)

125 
	#s_17_2
 175

	)

127 
	#s_17_3
 179

	)

129 
	#s_18_0
 183

	)

131 
	#s_18_1
 186

	)

133 
	#s_18_2
 189

	)

135 
	#s_18_3
 192

	)

137 
	#s_18_4
 195

	)

139 
	#s_18_5
 199

	)

141 
	#s_18_6
 203

	)

143 
	#s_18_7
 207

	)

145 
	#s_19_0
 211

	)

147 
	#s_19_1
 218

	)

149 
	#s_20_0
 
s_20_2


	)

150 
	#s_20_1
 
s_20_3


	)

151 
	#s_20_2
 224

	)

153 
	#s_20_3
 227

	)

155 
	#s_20_4
 230

	)

157 
	#s_20_5
 233

	)

159 
	#s_20_6
 236

	)

161 
	#s_20_7
 240

	)

163 
	#s_20_8
 244

	)

165 
	#s_20_9
 248

	)

167 
	#s_20_10
 252

	)

169 
	#s_20_11
 255

	)

171 
	#s_20_12
 258

	)

173 
	#s_20_13
 261

	)

175 
	#s_20_14
 264

	)

177 
	#s_20_15
 268

	)

179 
	#s_20_16
 272

	)

181 
	#s_20_17
 276

	)

183 
	#s_20_18
 280

	)

185 
	#s_20_19
 283

	)

187 
	#s_20_20
 286

	)

189 
	#s_20_21
 289

	)

191 
	#s_20_22
 292

	)

193 
	#s_20_23
 296

	)

195 
	#s_20_24
 300

	)

197 
	#s_20_25
 304

	)

199 
	#s_20_26
 
s_20_4


	)

200 
	#s_20_27
 
s_20_5


	)

201 
	#s_20_28
 
s_20_6


	)

202 
	#s_20_29
 
s_20_7


	)

203 
	#s_20_30
 
s_20_8


	)

204 
	#s_20_31
 
s_20_9


	)

205 
	#s_21_0
 
s_21_2


	)

206 
	#s_21_1
 
s_21_3


	)

207 
	#s_21_2
 308

	)

209 
	#s_21_3
 311

	)

211 
	#s_21_4
 314

	)

213 
	#s_21_5
 317

	)

215 
	#s_21_6
 320

	)

217 
	#s_21_7
 323

	)

219 
	#s_22_0
 326

	)

221 
	#s_22_1
 330

	)

223 
	#s_22_2
 334

	)

225 
	#s_22_3
 339

	)

227 
	#s_23_0
 344

	)

229 
	#s_23_1
 345

	)

231 
	#s_23_2
 346

	)

233 
	#s_23_3
 347

	)

238 cÚ¡ 
amÚg
 
	ga_0
[10] =

240  { 1, 
s_0_0
, -1, -1},

241  { 1, 
s_0_1
, -1, -1},

242  { 3, 
s_0_2
, -1, -1},

243  { 3, 
s_0_3
, -1, -1},

244  { 3, 
s_0_4
, -1, -1},

245  { 3, 
s_0_5
, -1, -1},

246  { 4, 
s_0_6
, -1, -1},

247  { 4, 
s_0_7
, -1, -1},

248  { 4, 
s_0_8
, -1, -1},

249  { 4, 
s_0_9
, -1, -1}

253 cÚ¡ 
amÚg
 
	ga_1
[2] =

255  { 4, 
s_1_0
, -1, -1},

256  { 5, 
s_1_1
, -1, -1}

260 cÚ¡ 
amÚg
 
	ga_2
[4] =

262  { 2, 
s_2_0
, -1, -1},

263  { 2, 
s_2_1
, -1, -1},

264  { 3, 
s_2_2
, -1, -1},

265  { 3, 
s_2_3
, -1, -1}

269 cÚ¡ 
amÚg
 
	ga_3
[4] =

271  { 2, 
s_3_0
, -1, -1},

272  { 2, 
s_3_1
, -1, -1},

273  { 3, 
s_3_2
, -1, -1},

274  { 3, 
s_3_3
, -1, -1}

278 cÚ¡ 
amÚg
 
	ga_4
[2] =

280  { 1, 
s_4_0
, -1, -1},

281  { 1, 
s_4_1
, -1, -1}

285 cÚ¡ 
amÚg
 
	ga_5
[2] =

287  { 2, 
s_5_0
, -1, -1},

288  { 2, 
s_5_1
, -1, -1}

292 cÚ¡ 
amÚg
 
	ga_6
[4] =

294  { 2, 
s_6_0
, -1, -1},

295  { 2, 
s_6_1
, -1, -1},

296  { 2, 
s_6_2
, -1, -1},

297  { 2, 
s_6_3
, -1, -1}

301 cÚ¡ 
amÚg
 
	ga_7
[2] =

303  { 3, 
s_7_0
, -1, -1},

304  { 3, 
s_7_1
, -1, -1}

308 cÚ¡ 
amÚg
 
	ga_8
[4] =

310  { 3, 
s_8_0
, -1, -1},

311  { 3, 
s_8_1
, -1, -1},

312  { 3, 
s_8_2
, -1, -1},

313  { 3, 
s_8_3
, -1, -1}

317 cÚ¡ 
amÚg
 
	ga_9
[2] =

319  { 4, 
s_9_0
, -1, -1},

320  { 4, 
s_9_1
, -1, -1}

324 cÚ¡ 
amÚg
 
	ga_10
[2] =

326  { 2, 
s_10_0
, -1, -1},

327  { 2, 
s_10_1
, -1, -1}

331 cÚ¡ 
amÚg
 
	ga_11
[2] =

333  { 2, 
s_11_0
, -1, -1},

334  { 2, 
s_11_1
, -1, -1}

338 cÚ¡ 
amÚg
 
	ga_12
[4] =

340  { 2, 
s_12_0
, -1, -1},

341  { 2, 
s_12_1
, -1, -1},

342  { 3, 
s_12_2
, -1, -1},

343  { 3, 
s_12_3
, -1, -1}

347 cÚ¡ 
amÚg
 
	ga_13
[4] =

349  { 3, 
s_13_0
, -1, -1},

350  { 3, 
s_13_1
, -1, -1},

351  { 4, 
s_13_2
, -1, -1},

352  { 4, 
s_13_3
, -1, -1}

356 cÚ¡ 
amÚg
 
	ga_14
[4] =

358  { 2, 
s_14_0
, -1, -1},

359  { 2, 
s_14_1
, -1, -1},

360  { 3, 
s_14_2
, -1, -1},

361  { 3, 
s_14_3
, -1, -1}

365 cÚ¡ 
amÚg
 
	ga_15
[4] =

367  { 5, 
s_15_0
, -1, -1},

368  { 5, 
s_15_1
, -1, -1},

369  { 7, 
s_15_2
, -1, -1},

370  { 7, 
s_15_3
, -1, -1}

374 cÚ¡ 
amÚg
 
	ga_16
[2] =

376  { 3, 
s_16_0
, -1, -1},

377  { 3, 
s_16_1
, -1, -1}

381 cÚ¡ 
amÚg
 
	ga_17
[4] =

383  { 3, 
s_17_0
, -1, -1},

384  { 3, 
s_17_1
, -1, -1},

385  { 4, 
s_17_2
, -1, -1},

386  { 4, 
s_17_3
, -1, -1}

390 cÚ¡ 
amÚg
 
	ga_18
[8] =

392  { 3, 
s_18_0
, -1, -1},

393  { 3, 
s_18_1
, -1, -1},

394  { 3, 
s_18_2
, -1, -1},

395  { 3, 
s_18_3
, -1, -1},

396  { 4, 
s_18_4
, -1, -1},

397  { 4, 
s_18_5
, -1, -1},

398  { 4, 
s_18_6
, -1, -1},

399  { 4, 
s_18_7
, -1, -1}

403 cÚ¡ 
amÚg
 
	ga_19
[2] =

405  { 7, 
s_19_0
, -1, -1},

406  { 6, 
s_19_1
, -1, -1}

410 cÚ¡ 
amÚg
 
	ga_20
[32] =

412  { 2, 
s_20_0
, -1, -1},

413  { 2, 
s_20_1
, -1, -1},

414  { 3, 
s_20_2
, -1, -1},

415  { 3, 
s_20_3
, -1, -1},

416  { 3, 
s_20_4
, -1, -1},

417  { 3, 
s_20_5
, -1, -1},

418  { 4, 
s_20_6
, -1, -1},

419  { 4, 
s_20_7
, -1, -1},

420  { 4, 
s_20_8
, -1, -1},

421  { 4, 
s_20_9
, -1, -1},

422  { 3, 
s_20_10
, -1, -1},

423  { 3, 
s_20_11
, -1, -1},

424  { 3, 
s_20_12
, -1, -1},

425  { 3, 
s_20_13
, -1, -1},

426  { 4, 
s_20_14
, -1, -1},

427  { 4, 
s_20_15
, -1, -1},

428  { 4, 
s_20_16
, -1, -1},

429  { 4, 
s_20_17
, -1, -1},

430  { 3, 
s_20_18
, -1, -1},

431  { 3, 
s_20_19
, -1, -1},

432  { 3, 
s_20_20
, -1, -1},

433  { 3, 
s_20_21
, -1, -1},

434  { 4, 
s_20_22
, -1, -1},

435  { 4, 
s_20_23
, -1, -1},

436  { 4, 
s_20_24
, -1, -1},

437  { 4, 
s_20_25
, -1, -1},

438  { 2, 
s_20_26
, -1, -1},

439  { 2, 
s_20_27
, -1, -1},

440  { 3, 
s_20_28
, -1, -1},

441  { 3, 
s_20_29
, -1, -1},

442  { 3, 
s_20_30
, -1, -1},

443  { 3, 
s_20_31
, -1, -1}

447 cÚ¡ 
amÚg
 
	ga_21
[8] =

449  { 2, 
s_21_0
, -1, -1},

450  { 2, 
s_21_1
, -1, -1},

451  { 3, 
s_21_2
, -1, -1},

452  { 3, 
s_21_3
, -1, -1},

453  { 3, 
s_21_4
, -1, -1},

454  { 3, 
s_21_5
, -1, -1},

455  { 3, 
s_21_6
, -1, -1},

456  { 3, 
s_21_7
, -1, -1}

460 cÚ¡ 
amÚg
 
	ga_22
[4] =

462  { 4, 
s_22_0
, -1, -1},

463  { 4, 
s_22_1
, -1, -1},

464  { 5, 
s_22_2
, -1, -1},

465  { 5, 
s_22_3
, -1, -1}

469 cÚ¡ 
amÚg
 
	ga_23
[4] =

471  { 1, 
s_23_0
, -1, 1},

472  { 1, 
s_23_1
, -1, 2},

473  { 1, 
s_23_2
, -1, 3},

474  { 2, 
s_23_3
, -1, 4}

477 cÚ¡ 
	gg_vow–
[] = { 17, 65, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 8, 0, 0, 0, 0, 0, 0, 1 };

479 cÚ¡ 
	gg_U
[] = { 1, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 1 };

481 cÚ¡ 
	gg_vow–1
[] = { 1, 64, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 };

483 cÚ¡ 
	gg_vow–2
[] = { 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 130 };

485 cÚ¡ 
	gg_vow–3
[] = { 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 };

487 cÚ¡ 
	gg_vow–4
[] = { 17 };

489 cÚ¡ 
	gg_vow–5
[] = { 65 };

491 cÚ¡ 
	gg_vow–6
[] = { 65 };

493 cÚ¡ 
symbŞ
 
	gs_0
[] = { 0xC4, 0xB1 };

494 cÚ¡ 
symbŞ
 
	gs_1
[] = { 0xC3, 0xB6 };

495 cÚ¡ 
symbŞ
 
	gs_2
[] = { 0xC3, 0xBC };

496 cÚ¡ 
symbŞ
 
	gs_3
[] = { 'k', 'i' };

497 cÚ¡ 
symbŞ
 
	gs_4
[] = { 'k', 'e', 'n' };

498 cÚ¡ 
symbŞ
 
	gs_5
[] = { 'p' };

499 cÚ¡ 
symbŞ
 
	gs_6
[] = { 0xC3, 0xA7 };

500 cÚ¡ 
symbŞ
 
	gs_7
[] = { 't' };

501 cÚ¡ 
symbŞ
 
	gs_8
[] = { 'k' };

502 cÚ¡ 
symbŞ
 
	gs_9
[] = { 0xC4, 0xB1 };

503 cÚ¡ 
symbŞ
 
	gs_10
[] = { 0xC4, 0xB1 };

504 cÚ¡ 
symbŞ
 
	gs_11
[] = { 'i' };

505 cÚ¡ 
symbŞ
 
	gs_12
[] = { 'u' };

506 cÚ¡ 
symbŞ
 
	gs_13
[] = { 0xC3, 0xB6 };

507 cÚ¡ 
symbŞ
 
	gs_14
[] = { 0xC3, 0xBC };

508 cÚ¡ 
symbŞ
 
	gs_15
[] = { 0xC3, 0xBC };

509 cÚ¡ 
symbŞ
 
	gs_16
[] = { 'a', 'd' };

510 cÚ¡ 
symbŞ
 
	gs_17
[] = { 's', 'o', 'y', 'a', 'd' };

512 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_check_vow–_h¬mÚy
() {

513 { 
m_‹¡1
 = 
l
 - 
c
;

514 ià(
	`out_groupšg_b_U
(
g_vow–
, 97, 305, 1) < 0)  0;

515 { 
m2
 = 
l
 - 
c
; ()m2;

516 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'a'è
Ïb1
;

517 
c
--;

518 ià(
	`out_groupšg_b_U
(
g_vow–1
, 97, 305, 1è< 0è
Ïb1
;

519 
Ïb0
;

520 
Ïb1
:

521 
c
 = 
l
 - 
m2
;

522 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb2
;

523 
c
--;

524 ià(
	`out_groupšg_b_U
(
g_vow–2
, 101, 252, 1è< 0è
Ïb2
;

525 
Ïb0
;

526 
Ïb2
:

527 
c
 = 
l
 - 
m2
;

528 ià(!(
	`eq_s_b
(2, 
s_0
))è
Ïb3
;

529 ià(
	`out_groupšg_b_U
(
g_vow–3
, 97, 305, 1è< 0è
Ïb3
;

530 
Ïb0
;

531 
Ïb3
:

532 
c
 = 
l
 - 
m2
;

533 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'i'è
Ïb4
;

534 
c
--;

535 ià(
	`out_groupšg_b_U
(
g_vow–4
, 101, 105, 1è< 0è
Ïb4
;

536 
Ïb0
;

537 
Ïb4
:

538 
c
 = 
l
 - 
m2
;

539 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'o'è
Ïb5
;

540 
c
--;

541 ià(
	`out_groupšg_b_U
(
g_vow–5
, 111, 117, 1è< 0è
Ïb5
;

542 
Ïb0
;

543 
Ïb5
:

544 
c
 = 
l
 - 
m2
;

545 ià(!(
	`eq_s_b
(2, 
s_1
))è
Ïb6
;

546 ià(
	`out_groupšg_b_U
(
g_vow–6
, 246, 252, 1è< 0è
Ïb6
;

547 
Ïb0
;

548 
Ïb6
:

549 
c
 = 
l
 - 
m2
;

550 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è
Ïb7
;

551 
c
--;

552 ià(
	`out_groupšg_b_U
(
g_vow–5
, 111, 117, 1è< 0è
Ïb7
;

553 
Ïb0
;

554 
Ïb7
:

555 
c
 = 
l
 - 
m2
;

556 ià(!(
	`eq_s_b
(2, 
s_2
)))  0;

557 ià(
	`out_groupšg_b_U
(
g_vow–6
, 246, 252, 1) < 0)  0;

559 
Ïb0
:

560 
c
 = 
l
 - 
m_‹¡1
;

563 
	}
}

565 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_suffix_w™h_İtiÚ®_n_cÚsÚªt
() {

566 { 
m1
 = 
l
 - 
c
; ()m1;

567 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'n'è
Ïb1
;

568 
c
--;

569 { 
m_‹¡2
 = 
l
 - 
c
;

570 ià(
	`š_groupšg_b_U
(
g_vow–
, 97, 305, 0)è
Ïb1
;

571 
c
 = 
l
 - 
m_‹¡2
;

573 
Ïb0
;

574 
Ïb1
:

575 
c
 = 
l
 - 
m1
;

576 { 
m3
 = 
l
 - 
c
; ()m3;

577 { 
m_‹¡4
 = 
l
 - 
c
;

578 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'n'è
Ïb2
;

579 
c
--;

580 
c
 = 
l
 - 
m_‹¡4
;

583 
Ïb2
:

584 
c
 = 
l
 - 
m3
;

586 { 
m_‹¡5
 = 
l
 - 
c
;

587 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

588 ià(
»t
 < 0)  0;

589 
c
 = 
»t
;

591 ià(
	`š_groupšg_b_U
(
g_vow–
, 97, 305, 0))  0;

592 
c
 = 
l
 - 
m_‹¡5
;

595 
Ïb0
:

597 
	}
}

599 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_suffix_w™h_İtiÚ®_s_cÚsÚªt
() {

600 { 
m1
 = 
l
 - 
c
; ()m1;

601 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb1
;

602 
c
--;

603 { 
m_‹¡2
 = 
l
 - 
c
;

604 ià(
	`š_groupšg_b_U
(
g_vow–
, 97, 305, 0)è
Ïb1
;

605 
c
 = 
l
 - 
m_‹¡2
;

607 
Ïb0
;

608 
Ïb1
:

609 
c
 = 
l
 - 
m1
;

610 { 
m3
 = 
l
 - 
c
; ()m3;

611 { 
m_‹¡4
 = 
l
 - 
c
;

612 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ's'è
Ïb2
;

613 
c
--;

614 
c
 = 
l
 - 
m_‹¡4
;

617 
Ïb2
:

618 
c
 = 
l
 - 
m3
;

620 { 
m_‹¡5
 = 
l
 - 
c
;

621 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

622 ià(
»t
 < 0)  0;

623 
c
 = 
»t
;

625 ià(
	`š_groupšg_b_U
(
g_vow–
, 97, 305, 0))  0;

626 
c
 = 
l
 - 
m_‹¡5
;

629 
Ïb0
:

631 
	}
}

633 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
() {

634 { 
m1
 = 
l
 - 
c
; ()m1;

635 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'y'è
Ïb1
;

636 
c
--;

637 { 
m_‹¡2
 = 
l
 - 
c
;

638 ià(
	`š_groupšg_b_U
(
g_vow–
, 97, 305, 0)è
Ïb1
;

639 
c
 = 
l
 - 
m_‹¡2
;

641 
Ïb0
;

642 
Ïb1
:

643 
c
 = 
l
 - 
m1
;

644 { 
m3
 = 
l
 - 
c
; ()m3;

645 { 
m_‹¡4
 = 
l
 - 
c
;

646 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'y'è
Ïb2
;

647 
c
--;

648 
c
 = 
l
 - 
m_‹¡4
;

651 
Ïb2
:

652 
c
 = 
l
 - 
m3
;

654 { 
m_‹¡5
 = 
l
 - 
c
;

655 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

656 ià(
»t
 < 0)  0;

657 
c
 = 
»t
;

659 ià(
	`š_groupšg_b_U
(
g_vow–
, 97, 305, 0))  0;

660 
c
 = 
l
 - 
m_‹¡5
;

663 
Ïb0
:

665 
	}
}

667 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_suffix_w™h_İtiÚ®_U_vow–
() {

668 { 
m1
 = 
l
 - 
c
; ()m1;

669 ià(
	`š_groupšg_b_U
(
g_U
, 105, 305, 0)è
Ïb1
;

670 { 
m_‹¡2
 = 
l
 - 
c
;

671 ià(
	`out_groupšg_b_U
(
g_vow–
, 97, 305, 0)è
Ïb1
;

672 
c
 = 
l
 - 
m_‹¡2
;

674 
Ïb0
;

675 
Ïb1
:

676 
c
 = 
l
 - 
m1
;

677 { 
m3
 = 
l
 - 
c
; ()m3;

678 { 
m_‹¡4
 = 
l
 - 
c
;

679 ià(
	`š_groupšg_b_U
(
g_U
, 105, 305, 0)è
Ïb2
;

680 
c
 = 
l
 - 
m_‹¡4
;

683 
Ïb2
:

684 
c
 = 
l
 - 
m3
;

686 { 
m_‹¡5
 = 
l
 - 
c
;

687 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 
lb
, 0, -1);

688 ià(
»t
 < 0)  0;

689 
c
 = 
»t
;

691 ià(
	`out_groupšg_b_U
(
g_vow–
, 97, 305, 0))  0;

692 
c
 = 
l
 - 
m_‹¡5
;

695 
Ïb0
:

697 
	}
}

699 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_pos£ssives
() {

700 ià(
c
 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((67133440 >> (p[c - 1] & 0x1f)) & 1))  0;

701 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_0
, 10, 0, 0)))  0;

702 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_U_vow–
();

703 ià(
»t
 <= 0) „et;

706 
	}
}

708 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_sU
() {

709 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

710 ià(
»t
 <= 0) „et;

712 ià(
	`š_groupšg_b_U
(
g_U
, 105, 305, 0))  0;

713 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_s_cÚsÚªt
();

714 ià(
»t
 <= 0) „et;

717 
	}
}

719 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_lArI
() {

720 ià(
c
 - 3 <ğ
lb
 || (
p
[c - 1] != 105 &&…[c - 1] != 177))  0;

721 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_1
, 2, 0, 0)))  0;

723 
	}
}

725 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_yU
() {

726 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

727 ià(
»t
 <= 0) „et;

729 ià(
	`š_groupšg_b_U
(
g_U
, 105, 305, 0))  0;

730 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

731 ià(
»t
 <= 0) „et;

734 
	}
}

736 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_nU
() {

737 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

738 ià(
»t
 <= 0) „et;

740 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_2
, 4, 0, 0)))  0;

742 
	}
}

744 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_nUn
() {

745 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

746 ià(
»t
 <= 0) „et;

748 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] != 110)  0;

749 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_3
, 4, 0, 0)))  0;

750 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_n_cÚsÚªt
();

751 ià(
»t
 <= 0) „et;

754 
	}
}

756 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_yA
() {

757 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

758 ià(
»t
 <= 0) „et;

760 ià(
c
 <ğ
lb
 || (
p
[c - 1] != 97 &&…[c - 1] != 101))  0;

761 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_4
, 2, 0, 0)))  0;

762 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

763 ià(
»t
 <= 0) „et;

766 
	}
}

768 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_nA
() {

769 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

770 ià(
»t
 <= 0) „et;

772 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 97 &&…[c - 1] != 101))  0;

773 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_5
, 2, 0, 0)))  0;

775 
	}
}

777 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_DA
() {

778 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

779 ià(
»t
 <= 0) „et;

781 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 97 &&…[c - 1] != 101))  0;

782 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_6
, 4, 0, 0)))  0;

784 
	}
}

786 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_ndA
() {

787 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

788 ià(
»t
 <= 0) „et;

790 ià(
c
 - 2 <ğ
lb
 || (
p
[c - 1] != 97 &&…[c - 1] != 101))  0;

791 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_7
, 2, 0, 0)))  0;

793 
	}
}

795 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_DAn
() {

796 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

797 ià(
»t
 <= 0) „et;

799 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] != 110)  0;

800 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_8
, 4, 0, 0)))  0;

802 
	}
}

804 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_ndAn
() {

805 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

806 ià(
»t
 <= 0) „et;

808 ià(
c
 - 3 <ğ
lb
 || 
p
[c - 1] != 110)  0;

809 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_9
, 2, 0, 0)))  0;

811 
	}
}

813 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_ylA
() {

814 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

815 ià(
»t
 <= 0) „et;

817 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 97 &&…[c - 1] != 101))  0;

818 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_10
, 2, 0, 0)))  0;

819 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

820 ià(
»t
 <= 0) „et;

823 
	}
}

825 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_ki
() {

826 ià(!(
	`eq_s_b
(2, 
s_3
)))  0;

828 
	}
}

830 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_ncA
() {

831 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

832 ià(
»t
 <= 0) „et;

834 ià(
c
 - 1 <ğ
lb
 || (
p
[c - 1] != 97 &&…[c - 1] != 101))  0;

835 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_11
, 2, 0, 0)))  0;

836 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_n_cÚsÚªt
();

837 ià(
»t
 <= 0) „et;

840 
	}
}

842 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_yUm
() {

843 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

844 ià(
»t
 <= 0) „et;

846 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] != 109)  0;

847 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_12
, 4, 0, 0)))  0;

848 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

849 ià(
»t
 <= 0) „et;

852 
	}
}

854 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_sUn
() {

855 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

856 ià(
»t
 <= 0) „et;

858 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] != 110)  0;

859 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_13
, 4, 0, 0)))  0;

861 
	}
}

863 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_yUz
() {

864 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

865 ià(
»t
 <= 0) „et;

867 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] != 122)  0;

868 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_14
, 4, 0, 0)))  0;

869 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

870 ià(
»t
 <= 0) „et;

873 
	}
}

875 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_sUnUz
() {

876 ià(
c
 - 4 <ğ
lb
 || 
p
[c - 1] != 122)  0;

877 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_15
, 4, 0, 0)))  0;

879 
	}
}

881 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_lAr
() {

882 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

883 ià(
»t
 <= 0) „et;

885 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] != 114)  0;

886 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_16
, 2, 0, 0)))  0;

888 
	}
}

890 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_nUz
() {

891 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

892 ià(
»t
 <= 0) „et;

894 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] != 122)  0;

895 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_17
, 4, 0, 0)))  0;

897 
	}
}

899 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_DUr
() {

900 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

901 ià(
»t
 <= 0) „et;

903 ià(
c
 - 2 <ğ
lb
 || 
p
[c - 1] != 114)  0;

904 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_18
, 8, 0, 0)))  0;

906 
	}
}

908 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_cAsInA
() {

909 ià(
c
 - 5 <ğ
lb
 || (
p
[c - 1] != 97 &&…[c - 1] != 101))  0;

910 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_19
, 2, 0, 0)))  0;

912 
	}
}

914 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_yDU
() {

915 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

916 ià(
»t
 <= 0) „et;

918 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_20
, 32, 0, 0)))  0;

919 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

920 ià(
»t
 <= 0) „et;

923 
	}
}

925 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_ysA
() {

926 ià(
c
 - 1 <ğ
lb
 || 
p
[c - 1] >> 5 != 3 || !((26658 >> (p[c - 1] & 0x1f)) & 1))  0;

927 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_21
, 8, 0, 0)))  0;

928 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

929 ià(
»t
 <= 0) „et;

932 
	}
}

934 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_ymUs_
() {

935 { 
»t
 = 
	`r_check_vow–_h¬mÚy
();

936 ià(
»t
 <= 0) „et;

938 ià(
c
 - 3 <ğ
lb
 || 
p
[c - 1] != 159)  0;

939 ià(!(
	`fšd_amÚg_b
(
s_poŞ
, 
a_22
, 4, 0, 0)))  0;

940 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

941 ià(
»t
 <= 0) „et;

944 
	}
}

946 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_m¬k_yk’
() {

947 ià(!(
	`eq_s_b
(3, 
s_4
)))  0;

948 { 
»t
 = 
	`r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

949 ià(
»t
 <= 0) „et;

952 
	}
}

954 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_¡em_nomš®_v”b_suffixes
() {

955 
k‘
 = 
c
;

956 
B_cÚtšue_¡emmšg_noun_suffixes
 = 1;

957 { 
m1
 = 
l
 - 
c
; ()m1;

958 { 
m2
 = 
l
 - 
c
; ()m2;

959 { 
»t
 = 
	`r_m¬k_ymUs_
();

960 ià(
»t
 =ğ0è
Ïb3
;

961 ià(
»t
 < 0) „et;

963 
Ïb2
;

964 
Ïb3
:

965 
c
 = 
l
 - 
m2
;

966 { 
»t
 = 
	`r_m¬k_yDU
();

967 ià(
»t
 =ğ0è
Ïb4
;

968 ià(
»t
 < 0) „et;

970 
Ïb2
;

971 
Ïb4
:

972 
c
 = 
l
 - 
m2
;

973 { 
»t
 = 
	`r_m¬k_ysA
();

974 ià(
»t
 =ğ0è
Ïb5
;

975 ià(
»t
 < 0) „et;

977 
Ïb2
;

978 
Ïb5
:

979 
c
 = 
l
 - 
m2
;

980 { 
»t
 = 
	`r_m¬k_yk’
();

981 ià(
»t
 =ğ0è
Ïb1
;

982 ià(
»t
 < 0) „et;

985 
Ïb2
:

986 
Ïb0
;

987 
Ïb1
:

988 
c
 = 
l
 - 
m1
;

989 { 
»t
 = 
	`r_m¬k_cAsInA
();

990 ià(
»t
 =ğ0è
Ïb6
;

991 ià(
»t
 < 0) „et;

993 { 
m3
 = 
l
 - 
c
; ()m3;

994 { 
»t
 = 
	`r_m¬k_sUnUz
();

995 ià(
»t
 =ğ0è
Ïb8
;

996 ià(
»t
 < 0) „et;

998 
Ïb7
;

999 
Ïb8
:

1000 
c
 = 
l
 - 
m3
;

1001 { 
»t
 = 
	`r_m¬k_lAr
();

1002 ià(
»t
 =ğ0è
Ïb9
;

1003 ià(
»t
 < 0) „et;

1005 
Ïb7
;

1006 
Ïb9
:

1007 
c
 = 
l
 - 
m3
;

1008 { 
»t
 = 
	`r_m¬k_yUm
();

1009 ià(
»t
 =ğ0è
Ïb10
;

1010 ià(
»t
 < 0) „et;

1012 
Ïb7
;

1013 
Ïb10
:

1014 
c
 = 
l
 - 
m3
;

1015 { 
»t
 = 
	`r_m¬k_sUn
();

1016 ià(
»t
 =ğ0è
Ïb11
;

1017 ià(
»t
 < 0) „et;

1019 
Ïb7
;

1020 
Ïb11
:

1021 
c
 = 
l
 - 
m3
;

1022 { 
»t
 = 
	`r_m¬k_yUz
();

1023 ià(
»t
 =ğ0è
Ïb12
;

1024 ià(
»t
 < 0) „et;

1026 
Ïb7
;

1027 
Ïb12
:

1028 
c
 = 
l
 - 
m3
;

1030 
Ïb7
:

1031 { 
»t
 = 
	`r_m¬k_ymUs_
();

1032 ià(
»t
 =ğ0è
Ïb6
;

1033 ià(
»t
 < 0) „et;

1035 
Ïb0
;

1036 
Ïb6
:

1037 
c
 = 
l
 - 
m1
;

1038 { 
»t
 = 
	`r_m¬k_lAr
();

1039 ià(
»t
 =ğ0è
Ïb13
;

1040 ià(
»t
 < 0) „et;

1042 
b¿
 = 
c
;

1043 ià(
	`¦iû_d–
() == -1)  -1;

1044 { 
m4
 = 
l
 - 
c
; ()m4;

1045 
k‘
 = 
c
;

1046 { 
m5
 = 
l
 - 
c
; ()m5;

1047 { 
»t
 = 
	`r_m¬k_DUr
();

1048 ià(
»t
 =ğ0è
Ïb16
;

1049 ià(
»t
 < 0) „et;

1051 
Ïb15
;

1052 
Ïb16
:

1053 
c
 = 
l
 - 
m5
;

1054 { 
»t
 = 
	`r_m¬k_yDU
();

1055 ià(
»t
 =ğ0è
Ïb17
;

1056 ià(
»t
 < 0) „et;

1058 
Ïb15
;

1059 
Ïb17
:

1060 
c
 = 
l
 - 
m5
;

1061 { 
»t
 = 
	`r_m¬k_ysA
();

1062 ià(
»t
 =ğ0è
Ïb18
;

1063 ià(
»t
 < 0) „et;

1065 
Ïb15
;

1066 
Ïb18
:

1067 
c
 = 
l
 - 
m5
;

1068 { 
»t
 = 
	`r_m¬k_ymUs_
();

1069 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m4
; 
Ïb14
; }

1070 ià(
»t
 < 0) „et;

1073 
Ïb15
:

1074 
Ïb14
:

1077 
B_cÚtšue_¡emmšg_noun_suffixes
 = 0;

1078 
Ïb0
;

1079 
Ïb13
:

1080 
c
 = 
l
 - 
m1
;

1081 { 
»t
 = 
	`r_m¬k_nUz
();

1082 ià(
»t
 =ğ0è
Ïb19
;

1083 ià(
»t
 < 0) „et;

1085 { 
m6
 = 
l
 - 
c
; ()m6;

1086 { 
»t
 = 
	`r_m¬k_yDU
();

1087 ià(
»t
 =ğ0è
Ïb21
;

1088 ià(
»t
 < 0) „et;

1090 
Ïb20
;

1091 
Ïb21
:

1092 
c
 = 
l
 - 
m6
;

1093 { 
»t
 = 
	`r_m¬k_ysA
();

1094 ià(
»t
 =ğ0è
Ïb19
;

1095 ià(
»t
 < 0) „et;

1098 
Ïb20
:

1099 
Ïb0
;

1100 
Ïb19
:

1101 
c
 = 
l
 - 
m1
;

1102 { 
m7
 = 
l
 - 
c
; ()m7;

1103 { 
»t
 = 
	`r_m¬k_sUnUz
();

1104 ià(
»t
 =ğ0è
Ïb24
;

1105 ià(
»t
 < 0) „et;

1107 
Ïb23
;

1108 
Ïb24
:

1109 
c
 = 
l
 - 
m7
;

1110 { 
»t
 = 
	`r_m¬k_yUz
();

1111 ià(
»t
 =ğ0è
Ïb25
;

1112 ià(
»t
 < 0) „et;

1114 
Ïb23
;

1115 
Ïb25
:

1116 
c
 = 
l
 - 
m7
;

1117 { 
»t
 = 
	`r_m¬k_sUn
();

1118 ià(
»t
 =ğ0è
Ïb26
;

1119 ià(
»t
 < 0) „et;

1121 
Ïb23
;

1122 
Ïb26
:

1123 
c
 = 
l
 - 
m7
;

1124 { 
»t
 = 
	`r_m¬k_yUm
();

1125 ià(
»t
 =ğ0è
Ïb22
;

1126 ià(
»t
 < 0) „et;

1129 
Ïb23
:

1130 
b¿
 = 
c
;

1131 ià(
	`¦iû_d–
() == -1)  -1;

1132 { 
m8
 = 
l
 - 
c
; ()m8;

1133 
k‘
 = 
c
;

1134 { 
»t
 = 
	`r_m¬k_ymUs_
();

1135 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m8
; 
Ïb27
; }

1136 ià(
»t
 < 0) „et;

1138 
Ïb27
:

1141 
Ïb0
;

1142 
Ïb22
:

1143 
c
 = 
l
 - 
m1
;

1144 { 
»t
 = 
	`r_m¬k_DUr
();

1145 ià(
»t
 <= 0) „et;

1147 
b¿
 = 
c
;

1148 ià(
	`¦iû_d–
() == -1)  -1;

1149 { 
m9
 = 
l
 - 
c
; ()m9;

1150 
k‘
 = 
c
;

1151 { 
m10
 = 
l
 - 
c
; ()m10;

1152 { 
»t
 = 
	`r_m¬k_sUnUz
();

1153 ià(
»t
 =ğ0è
Ïb30
;

1154 ià(
»t
 < 0) „et;

1156 
Ïb29
;

1157 
Ïb30
:

1158 
c
 = 
l
 - 
m10
;

1159 { 
»t
 = 
	`r_m¬k_lAr
();

1160 ià(
»t
 =ğ0è
Ïb31
;

1161 ià(
»t
 < 0) „et;

1163 
Ïb29
;

1164 
Ïb31
:

1165 
c
 = 
l
 - 
m10
;

1166 { 
»t
 = 
	`r_m¬k_yUm
();

1167 ià(
»t
 =ğ0è
Ïb32
;

1168 ià(
»t
 < 0) „et;

1170 
Ïb29
;

1171 
Ïb32
:

1172 
c
 = 
l
 - 
m10
;

1173 { 
»t
 = 
	`r_m¬k_sUn
();

1174 ià(
»t
 =ğ0è
Ïb33
;

1175 ià(
»t
 < 0) „et;

1177 
Ïb29
;

1178 
Ïb33
:

1179 
c
 = 
l
 - 
m10
;

1180 { 
»t
 = 
	`r_m¬k_yUz
();

1181 ià(
»t
 =ğ0è
Ïb34
;

1182 ià(
»t
 < 0) „et;

1184 
Ïb29
;

1185 
Ïb34
:

1186 
c
 = 
l
 - 
m10
;

1188 
Ïb29
:

1189 { 
»t
 = 
	`r_m¬k_ymUs_
();

1190 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m9
; 
Ïb28
; }

1191 ià(
»t
 < 0) „et;

1193 
Ïb28
:

1197 
Ïb0
:

1198 
b¿
 = 
c
;

1199 ià(
	`¦iû_d–
() == -1)  -1;

1201 
	}
}

1203 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_¡em_suffix_chaš_befÜe_ki
() {

1204 
k‘
 = 
c
;

1205 { 
»t
 = 
	`r_m¬k_ki
();

1206 ià(
»t
 <= 0) „et;

1208 { 
m1
 = 
l
 - 
c
; ()m1;

1209 { 
»t
 = 
	`r_m¬k_DA
();

1210 ià(
»t
 =ğ0è
Ïb1
;

1211 ià(
»t
 < 0) „et;

1213 
b¿
 = 
c
;

1214 ià(
	`¦iû_d–
() == -1)  -1;

1215 { 
m2
 = 
l
 - 
c
; ()m2;

1216 
k‘
 = 
c
;

1217 { 
m3
 = 
l
 - 
c
; ()m3;

1218 { 
»t
 = 
	`r_m¬k_lAr
();

1219 ià(
»t
 =ğ0è
Ïb4
;

1220 ià(
»t
 < 0) „et;

1222 
b¿
 = 
c
;

1223 ià(
	`¦iû_d–
() == -1)  -1;

1224 { 
m4
 = 
l
 - 
c
; ()m4;

1225 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1226 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m4
; 
Ïb5
; }

1227 ià(
»t
 < 0) „et;

1229 
Ïb5
:

1232 
Ïb3
;

1233 
Ïb4
:

1234 
c
 = 
l
 - 
m3
;

1235 { 
»t
 = 
	`r_m¬k_pos£ssives
();

1236 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m2
; 
Ïb2
; }

1237 ià(
»t
 < 0) „et;

1239 
b¿
 = 
c
;

1240 ià(
	`¦iû_d–
() == -1)  -1;

1241 { 
m5
 = 
l
 - 
c
; ()m5;

1242 
k‘
 = 
c
;

1243 { 
»t
 = 
	`r_m¬k_lAr
();

1244 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m5
; 
Ïb6
; }

1245 ià(
»t
 < 0) „et;

1247 
b¿
 = 
c
;

1248 ià(
	`¦iû_d–
() == -1)  -1;

1249 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1250 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m5
; 
Ïb6
; }

1251 ià(
»t
 < 0) „et;

1253 
Ïb6
:

1257 
Ïb3
:

1258 
Ïb2
:

1261 
Ïb0
;

1262 
Ïb1
:

1263 
c
 = 
l
 - 
m1
;

1264 { 
»t
 = 
	`r_m¬k_nUn
();

1265 ià(
»t
 =ğ0è
Ïb7
;

1266 ià(
»t
 < 0) „et;

1268 
b¿
 = 
c
;

1269 ià(
	`¦iû_d–
() == -1)  -1;

1270 { 
m6
 = 
l
 - 
c
; ()m6;

1271 
k‘
 = 
c
;

1272 { 
m7
 = 
l
 - 
c
; ()m7;

1273 { 
»t
 = 
	`r_m¬k_lArI
();

1274 ià(
»t
 =ğ0è
Ïb10
;

1275 ià(
»t
 < 0) „et;

1277 
b¿
 = 
c
;

1278 ià(
	`¦iû_d–
() == -1)  -1;

1279 
Ïb9
;

1280 
Ïb10
:

1281 
c
 = 
l
 - 
m7
;

1282 
k‘
 = 
c
;

1283 { 
m8
 = 
l
 - 
c
; ()m8;

1284 { 
»t
 = 
	`r_m¬k_pos£ssives
();

1285 ià(
»t
 =ğ0è
Ïb13
;

1286 ià(
»t
 < 0) „et;

1288 
Ïb12
;

1289 
Ïb13
:

1290 
c
 = 
l
 - 
m8
;

1291 { 
»t
 = 
	`r_m¬k_sU
();

1292 ià(
»t
 =ğ0è
Ïb11
;

1293 ià(
»t
 < 0) „et;

1296 
Ïb12
:

1297 
b¿
 = 
c
;

1298 ià(
	`¦iû_d–
() == -1)  -1;

1299 { 
m9
 = 
l
 - 
c
; ()m9;

1300 
k‘
 = 
c
;

1301 { 
»t
 = 
	`r_m¬k_lAr
();

1302 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m9
; 
Ïb14
; }

1303 ià(
»t
 < 0) „et;

1305 
b¿
 = 
c
;

1306 ià(
	`¦iû_d–
() == -1)  -1;

1307 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1308 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m9
; 
Ïb14
; }

1309 ià(
»t
 < 0) „et;

1311 
Ïb14
:

1314 
Ïb9
;

1315 
Ïb11
:

1316 
c
 = 
l
 - 
m7
;

1317 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1318 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m6
; 
Ïb8
; }

1319 ià(
»t
 < 0) „et;

1322 
Ïb9
:

1323 
Ïb8
:

1326 
Ïb0
;

1327 
Ïb7
:

1328 
c
 = 
l
 - 
m1
;

1329 { 
»t
 = 
	`r_m¬k_ndA
();

1330 ià(
»t
 <= 0) „et;

1332 { 
m10
 = 
l
 - 
c
; ()m10;

1333 { 
»t
 = 
	`r_m¬k_lArI
();

1334 ià(
»t
 =ğ0è
Ïb16
;

1335 ià(
»t
 < 0) „et;

1337 
b¿
 = 
c
;

1338 ià(
	`¦iû_d–
() == -1)  -1;

1339 
Ïb15
;

1340 
Ïb16
:

1341 
c
 = 
l
 - 
m10
;

1342 { 
»t
 = 
	`r_m¬k_sU
();

1343 ià(
»t
 =ğ0è
Ïb17
;

1344 ià(
»t
 < 0) „et;

1346 
b¿
 = 
c
;

1347 ià(
	`¦iû_d–
() == -1)  -1;

1348 { 
m11
 = 
l
 - 
c
; ()m11;

1349 
k‘
 = 
c
;

1350 { 
»t
 = 
	`r_m¬k_lAr
();

1351 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m11
; 
Ïb18
; }

1352 ià(
»t
 < 0) „et;

1354 
b¿
 = 
c
;

1355 ià(
	`¦iû_d–
() == -1)  -1;

1356 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1357 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m11
; 
Ïb18
; }

1358 ià(
»t
 < 0) „et;

1360 
Ïb18
:

1363 
Ïb15
;

1364 
Ïb17
:

1365 
c
 = 
l
 - 
m10
;

1366 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1367 ià(
»t
 <= 0) „et;

1370 
Ïb15
:

1373 
Ïb0
:

1375 
	}
}

1377 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_¡em_noun_suffixes
() {

1378 { 
m1
 = 
l
 - 
c
; ()m1;

1379 
k‘
 = 
c
;

1380 { 
»t
 = 
	`r_m¬k_lAr
();

1381 ià(
»t
 =ğ0è
Ïb1
;

1382 ià(
»t
 < 0) „et;

1384 
b¿
 = 
c
;

1385 ià(
	`¦iû_d–
() == -1)  -1;

1386 { 
m2
 = 
l
 - 
c
; ()m2;

1387 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1388 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m2
; 
Ïb2
; }

1389 ià(
»t
 < 0) „et;

1391 
Ïb2
:

1394 
Ïb0
;

1395 
Ïb1
:

1396 
c
 = 
l
 - 
m1
;

1397 
k‘
 = 
c
;

1398 { 
»t
 = 
	`r_m¬k_ncA
();

1399 ià(
»t
 =ğ0è
Ïb3
;

1400 ià(
»t
 < 0) „et;

1402 
b¿
 = 
c
;

1403 ià(
	`¦iû_d–
() == -1)  -1;

1404 { 
m3
 = 
l
 - 
c
; ()m3;

1405 { 
m4
 = 
l
 - 
c
; ()m4;

1406 
k‘
 = 
c
;

1407 { 
»t
 = 
	`r_m¬k_lArI
();

1408 ià(
»t
 =ğ0è
Ïb6
;

1409 ià(
»t
 < 0) „et;

1411 
b¿
 = 
c
;

1412 ià(
	`¦iû_d–
() == -1)  -1;

1413 
Ïb5
;

1414 
Ïb6
:

1415 
c
 = 
l
 - 
m4
;

1416 
k‘
 = 
c
;

1417 { 
m5
 = 
l
 - 
c
; ()m5;

1418 { 
»t
 = 
	`r_m¬k_pos£ssives
();

1419 ià(
»t
 =ğ0è
Ïb9
;

1420 ià(
»t
 < 0) „et;

1422 
Ïb8
;

1423 
Ïb9
:

1424 
c
 = 
l
 - 
m5
;

1425 { 
»t
 = 
	`r_m¬k_sU
();

1426 ià(
»t
 =ğ0è
Ïb7
;

1427 ià(
»t
 < 0) „et;

1430 
Ïb8
:

1431 
b¿
 = 
c
;

1432 ià(
	`¦iû_d–
() == -1)  -1;

1433 { 
m6
 = 
l
 - 
c
; ()m6;

1434 
k‘
 = 
c
;

1435 { 
»t
 = 
	`r_m¬k_lAr
();

1436 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m6
; 
Ïb10
; }

1437 ià(
»t
 < 0) „et;

1439 
b¿
 = 
c
;

1440 ià(
	`¦iû_d–
() == -1)  -1;

1441 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1442 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m6
; 
Ïb10
; }

1443 ià(
»t
 < 0) „et;

1445 
Ïb10
:

1448 
Ïb5
;

1449 
Ïb7
:

1450 
c
 = 
l
 - 
m4
;

1451 
k‘
 = 
c
;

1452 { 
»t
 = 
	`r_m¬k_lAr
();

1453 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb4
; }

1454 ià(
»t
 < 0) „et;

1456 
b¿
 = 
c
;

1457 ià(
	`¦iû_d–
() == -1)  -1;

1458 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1459 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m3
; 
Ïb4
; }

1460 ià(
»t
 < 0) „et;

1463 
Ïb5
:

1464 
Ïb4
:

1467 
Ïb0
;

1468 
Ïb3
:

1469 
c
 = 
l
 - 
m1
;

1470 
k‘
 = 
c
;

1471 { 
m7
 = 
l
 - 
c
; ()m7;

1472 { 
»t
 = 
	`r_m¬k_ndA
();

1473 ià(
»t
 =ğ0è
Ïb13
;

1474 ià(
»t
 < 0) „et;

1476 
Ïb12
;

1477 
Ïb13
:

1478 
c
 = 
l
 - 
m7
;

1479 { 
»t
 = 
	`r_m¬k_nA
();

1480 ià(
»t
 =ğ0è
Ïb11
;

1481 ià(
»t
 < 0) „et;

1484 
Ïb12
:

1485 { 
m8
 = 
l
 - 
c
; ()m8;

1486 { 
»t
 = 
	`r_m¬k_lArI
();

1487 ià(
»t
 =ğ0è
Ïb15
;

1488 ià(
»t
 < 0) „et;

1490 
b¿
 = 
c
;

1491 ià(
	`¦iû_d–
() == -1)  -1;

1492 
Ïb14
;

1493 
Ïb15
:

1494 
c
 = 
l
 - 
m8
;

1495 { 
»t
 = 
	`r_m¬k_sU
();

1496 ià(
»t
 =ğ0è
Ïb16
;

1497 ià(
»t
 < 0) „et;

1499 
b¿
 = 
c
;

1500 ià(
	`¦iû_d–
() == -1)  -1;

1501 { 
m9
 = 
l
 - 
c
; ()m9;

1502 
k‘
 = 
c
;

1503 { 
»t
 = 
	`r_m¬k_lAr
();

1504 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m9
; 
Ïb17
; }

1505 ià(
»t
 < 0) „et;

1507 
b¿
 = 
c
;

1508 ià(
	`¦iû_d–
() == -1)  -1;

1509 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1510 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m9
; 
Ïb17
; }

1511 ià(
»t
 < 0) „et;

1513 
Ïb17
:

1516 
Ïb14
;

1517 
Ïb16
:

1518 
c
 = 
l
 - 
m8
;

1519 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1520 ià(
»t
 =ğ0è
Ïb11
;

1521 ià(
»t
 < 0) „et;

1524 
Ïb14
:

1525 
Ïb0
;

1526 
Ïb11
:

1527 
c
 = 
l
 - 
m1
;

1528 
k‘
 = 
c
;

1529 { 
m10
 = 
l
 - 
c
; ()m10;

1530 { 
»t
 = 
	`r_m¬k_ndAn
();

1531 ià(
»t
 =ğ0è
Ïb20
;

1532 ià(
»t
 < 0) „et;

1534 
Ïb19
;

1535 
Ïb20
:

1536 
c
 = 
l
 - 
m10
;

1537 { 
»t
 = 
	`r_m¬k_nU
();

1538 ià(
»t
 =ğ0è
Ïb18
;

1539 ià(
»t
 < 0) „et;

1542 
Ïb19
:

1543 { 
m11
 = 
l
 - 
c
; ()m11;

1544 { 
»t
 = 
	`r_m¬k_sU
();

1545 ià(
»t
 =ğ0è
Ïb22
;

1546 ià(
»t
 < 0) „et;

1548 
b¿
 = 
c
;

1549 ià(
	`¦iû_d–
() == -1)  -1;

1550 { 
m12
 = 
l
 - 
c
; ()m12;

1551 
k‘
 = 
c
;

1552 { 
»t
 = 
	`r_m¬k_lAr
();

1553 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m12
; 
Ïb23
; }

1554 ià(
»t
 < 0) „et;

1556 
b¿
 = 
c
;

1557 ià(
	`¦iû_d–
() == -1)  -1;

1558 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1559 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m12
; 
Ïb23
; }

1560 ià(
»t
 < 0) „et;

1562 
Ïb23
:

1565 
Ïb21
;

1566 
Ïb22
:

1567 
c
 = 
l
 - 
m11
;

1568 { 
»t
 = 
	`r_m¬k_lArI
();

1569 ià(
»t
 =ğ0è
Ïb18
;

1570 ià(
»t
 < 0) „et;

1573 
Ïb21
:

1574 
Ïb0
;

1575 
Ïb18
:

1576 
c
 = 
l
 - 
m1
;

1577 
k‘
 = 
c
;

1578 { 
»t
 = 
	`r_m¬k_DAn
();

1579 ià(
»t
 =ğ0è
Ïb24
;

1580 ià(
»t
 < 0) „et;

1582 
b¿
 = 
c
;

1583 ià(
	`¦iû_d–
() == -1)  -1;

1584 { 
m13
 = 
l
 - 
c
; ()m13;

1585 
k‘
 = 
c
;

1586 { 
m14
 = 
l
 - 
c
; ()m14;

1587 { 
»t
 = 
	`r_m¬k_pos£ssives
();

1588 ià(
»t
 =ğ0è
Ïb27
;

1589 ià(
»t
 < 0) „et;

1591 
b¿
 = 
c
;

1592 ià(
	`¦iû_d–
() == -1)  -1;

1593 { 
m15
 = 
l
 - 
c
; ()m15;

1594 
k‘
 = 
c
;

1595 { 
»t
 = 
	`r_m¬k_lAr
();

1596 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m15
; 
Ïb28
; }

1597 ià(
»t
 < 0) „et;

1599 
b¿
 = 
c
;

1600 ià(
	`¦iû_d–
() == -1)  -1;

1601 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1602 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m15
; 
Ïb28
; }

1603 ià(
»t
 < 0) „et;

1605 
Ïb28
:

1608 
Ïb26
;

1609 
Ïb27
:

1610 
c
 = 
l
 - 
m14
;

1611 { 
»t
 = 
	`r_m¬k_lAr
();

1612 ià(
»t
 =ğ0è
Ïb29
;

1613 ià(
»t
 < 0) „et;

1615 
b¿
 = 
c
;

1616 ià(
	`¦iû_d–
() == -1)  -1;

1617 { 
m16
 = 
l
 - 
c
; ()m16;

1618 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1619 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m16
; 
Ïb30
; }

1620 ià(
»t
 < 0) „et;

1622 
Ïb30
:

1625 
Ïb26
;

1626 
Ïb29
:

1627 
c
 = 
l
 - 
m14
;

1628 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1629 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m13
; 
Ïb25
; }

1630 ià(
»t
 < 0) „et;

1633 
Ïb26
:

1634 
Ïb25
:

1637 
Ïb0
;

1638 
Ïb24
:

1639 
c
 = 
l
 - 
m1
;

1640 
k‘
 = 
c
;

1641 { 
m17
 = 
l
 - 
c
; ()m17;

1642 { 
»t
 = 
	`r_m¬k_nUn
();

1643 ià(
»t
 =ğ0è
Ïb33
;

1644 ià(
»t
 < 0) „et;

1646 
Ïb32
;

1647 
Ïb33
:

1648 
c
 = 
l
 - 
m17
;

1649 { 
»t
 = 
	`r_m¬k_ylA
();

1650 ià(
»t
 =ğ0è
Ïb31
;

1651 ià(
»t
 < 0) „et;

1654 
Ïb32
:

1655 
b¿
 = 
c
;

1656 ià(
	`¦iû_d–
() == -1)  -1;

1657 { 
m18
 = 
l
 - 
c
; ()m18;

1658 { 
m19
 = 
l
 - 
c
; ()m19;

1659 
k‘
 = 
c
;

1660 { 
»t
 = 
	`r_m¬k_lAr
();

1661 ià(
»t
 =ğ0è
Ïb36
;

1662 ià(
»t
 < 0) „et;

1664 
b¿
 = 
c
;

1665 ià(
	`¦iû_d–
() == -1)  -1;

1666 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1667 ià(
»t
 =ğ0è
Ïb36
;

1668 ià(
»t
 < 0) „et;

1670 
Ïb35
;

1671 
Ïb36
:

1672 
c
 = 
l
 - 
m19
;

1673 
k‘
 = 
c
;

1674 { 
m20
 = 
l
 - 
c
; ()m20;

1675 { 
»t
 = 
	`r_m¬k_pos£ssives
();

1676 ià(
»t
 =ğ0è
Ïb39
;

1677 ià(
»t
 < 0) „et;

1679 
Ïb38
;

1680 
Ïb39
:

1681 
c
 = 
l
 - 
m20
;

1682 { 
»t
 = 
	`r_m¬k_sU
();

1683 ià(
»t
 =ğ0è
Ïb37
;

1684 ià(
»t
 < 0) „et;

1687 
Ïb38
:

1688 
b¿
 = 
c
;

1689 ià(
	`¦iû_d–
() == -1)  -1;

1690 { 
m21
 = 
l
 - 
c
; ()m21;

1691 
k‘
 = 
c
;

1692 { 
»t
 = 
	`r_m¬k_lAr
();

1693 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m21
; 
Ïb40
; }

1694 ià(
»t
 < 0) „et;

1696 
b¿
 = 
c
;

1697 ià(
	`¦iû_d–
() == -1)  -1;

1698 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1699 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m21
; 
Ïb40
; }

1700 ià(
»t
 < 0) „et;

1702 
Ïb40
:

1705 
Ïb35
;

1706 
Ïb37
:

1707 
c
 = 
l
 - 
m19
;

1708 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1709 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m18
; 
Ïb34
; }

1710 ià(
»t
 < 0) „et;

1713 
Ïb35
:

1714 
Ïb34
:

1717 
Ïb0
;

1718 
Ïb31
:

1719 
c
 = 
l
 - 
m1
;

1720 
k‘
 = 
c
;

1721 { 
»t
 = 
	`r_m¬k_lArI
();

1722 ià(
»t
 =ğ0è
Ïb41
;

1723 ià(
»t
 < 0) „et;

1725 
b¿
 = 
c
;

1726 ià(
	`¦iû_d–
() == -1)  -1;

1727 
Ïb0
;

1728 
Ïb41
:

1729 
c
 = 
l
 - 
m1
;

1730 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1731 ià(
»t
 =ğ0è
Ïb42
;

1732 ià(
»t
 < 0) „et;

1734 
Ïb0
;

1735 
Ïb42
:

1736 
c
 = 
l
 - 
m1
;

1737 
k‘
 = 
c
;

1738 { 
m22
 = 
l
 - 
c
; ()m22;

1739 { 
»t
 = 
	`r_m¬k_DA
();

1740 ià(
»t
 =ğ0è
Ïb45
;

1741 ià(
»t
 < 0) „et;

1743 
Ïb44
;

1744 
Ïb45
:

1745 
c
 = 
l
 - 
m22
;

1746 { 
»t
 = 
	`r_m¬k_yU
();

1747 ià(
»t
 =ğ0è
Ïb46
;

1748 ià(
»t
 < 0) „et;

1750 
Ïb44
;

1751 
Ïb46
:

1752 
c
 = 
l
 - 
m22
;

1753 { 
»t
 = 
	`r_m¬k_yA
();

1754 ià(
»t
 =ğ0è
Ïb43
;

1755 ià(
»t
 < 0) „et;

1758 
Ïb44
:

1759 
b¿
 = 
c
;

1760 ià(
	`¦iû_d–
() == -1)  -1;

1761 { 
m23
 = 
l
 - 
c
; ()m23;

1762 
k‘
 = 
c
;

1763 { 
m24
 = 
l
 - 
c
; ()m24;

1764 { 
»t
 = 
	`r_m¬k_pos£ssives
();

1765 ià(
»t
 =ğ0è
Ïb49
;

1766 ià(
»t
 < 0) „et;

1768 
b¿
 = 
c
;

1769 ià(
	`¦iû_d–
() == -1)  -1;

1770 { 
m25
 = 
l
 - 
c
; ()m25;

1771 
k‘
 = 
c
;

1772 { 
»t
 = 
	`r_m¬k_lAr
();

1773 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m25
; 
Ïb50
; }

1774 ià(
»t
 < 0) „et;

1776 
Ïb50
:

1779 
Ïb48
;

1780 
Ïb49
:

1781 
c
 = 
l
 - 
m24
;

1782 { 
»t
 = 
	`r_m¬k_lAr
();

1783 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m23
; 
Ïb47
; }

1784 ià(
»t
 < 0) „et;

1787 
Ïb48
:

1788 
b¿
 = 
c
;

1789 ià(
	`¦iû_d–
() == -1)  -1;

1790 
k‘
 = 
c
;

1791 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1792 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m23
; 
Ïb47
; }

1793 ià(
»t
 < 0) „et;

1795 
Ïb47
:

1798 
Ïb0
;

1799 
Ïb43
:

1800 
c
 = 
l
 - 
m1
;

1801 
k‘
 = 
c
;

1802 { 
m26
 = 
l
 - 
c
; ()m26;

1803 { 
»t
 = 
	`r_m¬k_pos£ssives
();

1804 ià(
»t
 =ğ0è
Ïb52
;

1805 ià(
»t
 < 0) „et;

1807 
Ïb51
;

1808 
Ïb52
:

1809 
c
 = 
l
 - 
m26
;

1810 { 
»t
 = 
	`r_m¬k_sU
();

1811 ià(
»t
 <= 0) „et;

1814 
Ïb51
:

1815 
b¿
 = 
c
;

1816 ià(
	`¦iû_d–
() == -1)  -1;

1817 { 
m27
 = 
l
 - 
c
; ()m27;

1818 
k‘
 = 
c
;

1819 { 
»t
 = 
	`r_m¬k_lAr
();

1820 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m27
; 
Ïb53
; }

1821 ià(
»t
 < 0) „et;

1823 
b¿
 = 
c
;

1824 ià(
	`¦iû_d–
() == -1)  -1;

1825 { 
»t
 = 
	`r_¡em_suffix_chaš_befÜe_ki
();

1826 ià(
»t
 =ğ0è{ 
c
 = 
l
 - 
m27
; 
Ïb53
; }

1827 ià(
»t
 < 0) „et;

1829 
Ïb53
:

1833 
Ïb0
:

1835 
	}
}

1837 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_po¡_´oûss_Ï¡_cÚsÚªts
() {

1838 
amÚg_v¬
;

1839 
k‘
 = 
c
;

1840 
amÚg_v¬
 = 
	`fšd_amÚg_b
(
s_poŞ
, 
a_23
, 4, 0, 0);

1841 ià(!(
amÚg_v¬
))  0;

1842 
b¿
 = 
c
;

1843 
amÚg_v¬
) {

1846 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_5
);

1847 ià(
»t
 < 0) „et;

1851 { 
»t
 = 
	`¦iû_äom_s
(2, 
s_6
);

1852 ià(
»t
 < 0) „et;

1856 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_7
);

1857 ià(
»t
 < 0) „et;

1861 { 
»t
 = 
	`¦iû_äom_s
(1, 
s_8
);

1862 ià(
»t
 < 0) „et;

1867 
	}
}

1869 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_­³nd_U_to_¡ems_’dšg_w™h_d_Ü_g
() {

1870 { 
m_‹¡1
 = 
l
 - 
c
;

1871 { 
m2
 = 
l
 - 
c
; ()m2;

1872 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'd'è
Ïb1
;

1873 
c
--;

1874 
Ïb0
;

1875 
Ïb1
:

1876 
c
 = 
l
 - 
m2
;

1877 ià(
c
 <ğ
lb
 || 
p
[c - 1] != 'g')  0;

1878 
c
--;

1880 
Ïb0
:

1881 
c
 = 
l
 - 
m_‹¡1
;

1883 { 
m3
 = 
l
 - 
c
; ()m3;

1884 { 
m_‹¡4
 = 
l
 - 
c
;

1885 ià(
	`out_groupšg_b_U
(
g_vow–
, 97, 305, 1è< 0è
Ïb3
;

1886 { 
m5
 = 
l
 - 
c
; ()m5;

1887 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'a'è
Ïb5
;

1888 
c
--;

1889 
Ïb4
;

1890 
Ïb5
:

1891 
c
 = 
l
 - 
m5
;

1892 ià(!(
	`eq_s_b
(2, 
s_9
))è
Ïb3
;

1894 
Ïb4
:

1895 
c
 = 
l
 - 
m_‹¡4
;

1897 { 
§ved_c
 = 
c
;

1898 
	`š£¹_s
(
c
, c, 2, 
s_10
);

1899 
c
 = 
§ved_c
;

1901 
Ïb2
;

1902 
Ïb3
:

1903 
c
 = 
l
 - 
m3
;

1904 { 
m_‹¡6
 = 
l
 - 
c
;

1905 ià(
	`out_groupšg_b_U
(
g_vow–
, 97, 305, 1è< 0è
Ïb6
;

1906 { 
m7
 = 
l
 - 
c
; ()m7;

1907 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'e'è
Ïb8
;

1908 
c
--;

1909 
Ïb7
;

1910 
Ïb8
:

1911 
c
 = 
l
 - 
m7
;

1912 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'i'è
Ïb6
;

1913 
c
--;

1915 
Ïb7
:

1916 
c
 = 
l
 - 
m_‹¡6
;

1918 { 
§ved_c
 = 
c
;

1919 
	`š£¹_s
(
c
, c, 1, 
s_11
);

1920 
c
 = 
§ved_c
;

1922 
Ïb2
;

1923 
Ïb6
:

1924 
c
 = 
l
 - 
m3
;

1925 { 
m_‹¡8
 = 
l
 - 
c
;

1926 ià(
	`out_groupšg_b_U
(
g_vow–
, 97, 305, 1è< 0è
Ïb9
;

1927 { 
m9
 = 
l
 - 
c
; ()m9;

1928 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'o'è
Ïb11
;

1929 
c
--;

1930 
Ïb10
;

1931 
Ïb11
:

1932 
c
 = 
l
 - 
m9
;

1933 ià(
c
 <ğ
lb
 || 
p
[ø- 1] !ğ'u'è
Ïb9
;

1934 
c
--;

1936 
Ïb10
:

1937 
c
 = 
l
 - 
m_‹¡8
;

1939 { 
§ved_c
 = 
c
;

1940 
	`š£¹_s
(
c
, c, 1, 
s_12
);

1941 
c
 = 
§ved_c
;

1943 
Ïb2
;

1944 
Ïb9
:

1945 
c
 = 
l
 - 
m3
;

1946 { 
m_‹¡10
 = 
l
 - 
c
;

1947 ià(
	`out_groupšg_b_U
(
g_vow–
, 97, 305, 1) < 0)  0;

1948 { 
m11
 = 
l
 - 
c
; ()m11;

1949 ià(!(
	`eq_s_b
(2, 
s_13
))è
Ïb13
;

1950 
Ïb12
;

1951 
Ïb13
:

1952 
c
 = 
l
 - 
m11
;

1953 ià(!(
	`eq_s_b
(2, 
s_14
)))  0;

1955 
Ïb12
:

1956 
c
 = 
l
 - 
m_‹¡10
;

1958 { 
§ved_c
 = 
c
;

1959 
	`š£¹_s
(
c
, c, 2, 
s_15
);

1960 
c
 = 
§ved_c
;

1963 
Ïb2
:

1965 
	}
}

1967 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_mÜe_thª_Úe_syÎabË_wÜd
() {

1968 { 
c_‹¡1
 = 
c
;

1969 { 
i
 = 2;

1971 
c2
 = 
c
;

1972 { 
»t
 = 
	`out_groupšg_U
(
g_vow–
, 97, 305, 1);

1973 ià(
»t
 < 0è
Ïb0
;

1974 
c
 +ğ
»t
;

1976 
i
--;

1978 
Ïb0
:

1979 
c
 = 
c2
;

1982 ià(
i
 > 0)  0;

1984 
c
 = 
c_‹¡1
;

1987 
	}
}

1989 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_is_»£rved_wÜd
() {

1990 { 
c1
 = 
c
;

1991 { 
c_‹¡2
 = 
c
;

1993 ià(!(
	`eq_s
(2, 
s_16
))è
Ïb2
;

1995 
Ïb2
:

1996 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

1997 ià(
»t
 < 0è
Ïb1
;

1998 
c
 = 
»t
;

2001 
I_¡¾’
 = 2;

2002 ià(!(
I_¡¾’
 =ğ
l
)è
Ïb1
;

2003 
c
 = 
c_‹¡2
;

2005 
Ïb0
;

2006 
Ïb1
:

2007 
c
 = 
c1
;

2008 { 
c_‹¡3
 = 
c
;

2010 ià(!(
	`eq_s
(5, 
s_17
))è
Ïb3
;

2012 
Ïb3
:

2013 { 
»t
 = 
	`sk_utf8
(
p
, 
c
, 0, 
l
, 1);

2014 ià(
»t
 < 0)  0;

2015 
c
 = 
»t
;

2018 
I_¡¾’
 = 5;

2019 ià(!(
I_¡¾’
 =ğ
l
))  0;

2020 
c
 = 
c_‹¡3
;

2023 
Ïb0
:

2025 
	}
}

2027 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$r_po¡lude
() {

2028 { 
c1
 = 
c
;

2029 { 
»t
 = 
	`r_is_»£rved_wÜd
();

2030 ià(
»t
 =ğ0è
Ïb0
;

2031 ià(
»t
 < 0) „et;

2034 
Ïb0
:

2035 
c
 = 
c1
;

2037 
lb
 = 
c
; c = 
l
;

2039 { 
m2
 = 
l
 - 
c
; ()m2;

2040 { 
»t
 = 
	`r_­³nd_U_to_¡ems_’dšg_w™h_d_Ü_g
();

2041 ià(
»t
 =ğ0è
Ïb1
;

2042 ià(
»t
 < 0) „et;

2044 
Ïb1
:

2045 
c
 = 
l
 - 
m2
;

2047 { 
m3
 = 
l
 - 
c
; ()m3;

2048 { 
»t
 = 
	`r_po¡_´oûss_Ï¡_cÚsÚªts
();

2049 ià(
»t
 =ğ0è
Ïb2
;

2050 ià(
»t
 < 0) „et;

2052 
Ïb2
:

2053 
c
 = 
l
 - 
m3
;

2055 
c
 = 
lb
;

2057 
	}
}

2059 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$¡em
() {

2060 { 
»t
 = 
	`r_mÜe_thª_Úe_syÎabË_wÜd
();

2061 ià(
»t
 <= 0) „et;

2063 
lb
 = 
c
; c = 
l
;

2065 { 
m1
 = 
l
 - 
c
; ()m1;

2066 { 
»t
 = 
	`r_¡em_nomš®_v”b_suffixes
();

2067 ià(
»t
 =ğ0è
Ïb0
;

2068 ià(
»t
 < 0) „et;

2070 
Ïb0
:

2071 
c
 = 
l
 - 
m1
;

2073 ià(!(
B_cÚtšue_¡emmšg_noun_suffixes
))  0;

2074 { 
m2
 = 
l
 - 
c
; ()m2;

2075 { 
»t
 = 
	`r_¡em_noun_suffixes
();

2076 ià(
»t
 =ğ0è
Ïb1
;

2077 ià(
»t
 < 0) „et;

2079 
Ïb1
:

2080 
c
 = 
l
 - 
m2
;

2082 
c
 = 
lb
;

2083 { 
»t
 = 
	`r_po¡lude
();

2084 ià(
»t
 <= 0) „et;

2087 
	}
}

2089 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$IÁ”ÇlS‹mTurkish
()

2090 : 
	`B_cÚtšue_¡emmšg_noun_suffixes
(0), 
	$I_¡¾’
(0)

2092 
	}
}

2094 
	gX­Ÿn
::
IÁ”ÇlS‹mTurkish
::~
	$IÁ”ÇlS‹mTurkish
()

2096 
	}
}

2099 
X­Ÿn
::
IÁ”ÇlS‹mTurkish
::
	$g‘_desütiÚ
() const

2102 
	}
}

	@languages/turkish.h

3 
	~"¡emš‹º®.h
"

5 
Çme¥aû
 
	gX­Ÿn
 {

7 şas 
	cIÁ”ÇlS‹mTurkish
 : 
public
 
S‹m
::
IÁ”Çl
 {

8 
B_cÚtšue_¡emmšg_noun_suffixes
;

9 
	gI_¡¾’
;

10 
	gpublic
:

11 
r_¡em_suffix_chaš_befÜe_ki
();

12 
r_¡em_noun_suffixes
();

13 
r_¡em_nomš®_v”b_suffixes
();

14 
r_po¡lude
();

15 
r_po¡_´oûss_Ï¡_cÚsÚªts
();

16 
r_mÜe_thª_Úe_syÎabË_wÜd
();

17 
r_m¬k_suffix_w™h_İtiÚ®_s_cÚsÚªt
();

18 
r_m¬k_suffix_w™h_İtiÚ®_n_cÚsÚªt
();

19 
r_m¬k_suffix_w™h_İtiÚ®_U_vow–
();

20 
r_m¬k_suffix_w™h_İtiÚ®_y_cÚsÚªt
();

21 
r_m¬k_ysA
();

22 
r_m¬k_ymUs_
();

23 
r_m¬k_yk’
();

24 
r_m¬k_yDU
();

25 
r_m¬k_yUz
();

26 
r_m¬k_yUm
();

27 
r_m¬k_yU
();

28 
r_m¬k_ylA
();

29 
r_m¬k_yA
();

30 
r_m¬k_pos£ssives
();

31 
r_m¬k_sUnUz
();

32 
r_m¬k_sUn
();

33 
r_m¬k_sU
();

34 
r_m¬k_nUz
();

35 
r_m¬k_nUn
();

36 
r_m¬k_nU
();

37 
r_m¬k_ndAn
();

38 
r_m¬k_ndA
();

39 
r_m¬k_ncA
();

40 
r_m¬k_nA
();

41 
r_m¬k_lArI
();

42 
r_m¬k_lAr
();

43 
r_m¬k_ki
();

44 
r_m¬k_DUr
();

45 
r_m¬k_DAn
();

46 
r_m¬k_DA
();

47 
r_m¬k_cAsInA
();

48 
r_is_»£rved_wÜd
();

49 
r_check_vow–_h¬mÚy
();

50 
r_­³nd_U_to_¡ems_’dšg_w™h_d_Ü_g
();

52 
IÁ”ÇlS‹mTurkish
();

53 ~
IÁ”ÇlS‹mTurkish
();

54 
¡em
();

55 cÚ¡ * 
g‘_desütiÚ
() const;

	@matcher/andmaybepostlist.cc

24 
	~<cÚfig.h
>

26 
	~"ªdmayb•o¡li¡.h
"

27 
	~"muÉŸndpo¡li¡.h
"

28 
	~"omas£¹.h
"

29 
	~"omdebug.h
"

31 
Po¡Li¡
 *

32 
	gAndMaybePo¡Li¡
::
´oûss_Ãxt_Ü_sk_to
(
X­Ÿn
::
weight
 
w_mš
, 
Po¡Li¡
 *
»t
)

34 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "AndMaybePo¡Li¡::´oûss_Ãxt_Ü_sk_to", 
w_mš
 << ", " << 
»t
);

35 
hªdË_´uÃ
(
l
, 
»t
);

36 ià(
	gl
->
©_’d
()) {

38 
	glh—d
 = 0;

39 
RETURN
(
NULL
);

42 
	glh—d
 = 
l
->
g‘_docid
();

43 ià(
	glh—d
 <ğ
rh—d
è
RETURN
(
NULL
);

45 
boŞ
 
	gv®id
;

46 
check_hªdlšg_´uÃ
(
r
, 
lh—d
, 
w_mš
 - 
lmax
, 
m©ch”
, 
v®id
);

47 ià(
	gr
->
©_’d
()) {

48 
Po¡Li¡
 *
	gtmp
 = 
l
;

49 
	gl
 = 
NULL
;

50 
RETURN
(
tmp
);

52 ià(
	gv®id
) {

53 
	grh—d
 = 
r
->
g‘_docid
();

55 
	grh—d
 = 0;

57 
RETURN
(
NULL
);

60 
Po¡Li¡
 *

61 
	gAndMaybePo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

63 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "AndMaybePo¡Li¡::Ãxt", 
w_mš
);

64 ià(
	gw_mš
 > 
	glmax
) {

66 
Po¡Li¡
 *
	g»t
;

67 
LOGLINE
(
MATCH
, "AND MAYBE -> AND");

68 
	g»t
 = 
Ãw
 
MuÉiAndPo¡Li¡
(
l
, 
r
, 
lmax
, 
rmax
, 
m©ch”
, 
dbsize
, 
Œue
);

69 
	gl
 = 
r
 = 
NULL
;

70 
sk_to_hªdlšg_´uÃ
(
»t
, 
¡d
::
max
(
lh—d
, 
rh—d
è+ 1, 
w_mš
, 
m©ch”
);

71 
RETURN
(
»t
);

73 
RETURN
(
´oûss_Ãxt_Ü_sk_to
(
w_mš
, 
l
->
Ãxt
(w_mš - 
rmax
)));

76 
Po¡Li¡
 *

77 
	gAndMaybePo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

79 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "AndMaybePo¡Li¡::sk_to", 
did
 << ", " << 
w_mš
);

80 ià(
	gw_mš
 > 
	glmax
) {

82 
Po¡Li¡
 *
	g»t
;

83 
LOGLINE
(
MATCH
, "AND MAYBE -> AND (in skip_to)");

84 
	g»t
 = 
Ãw
 
MuÉiAndPo¡Li¡
(
l
, 
r
, 
lmax
, 
rmax
, 
m©ch”
, 
dbsize
, 
Œue
);

85 
	gdid
 = 
¡d
::
max
(
did
, std::max(
lh—d
, 
rh—d
));

86 
	gl
 = 
r
 = 
NULL
;

87 
sk_to_hªdlšg_´uÃ
(
»t
, 
did
, 
w_mš
, 
m©ch”
);

88 
RETURN
(
»t
);

92 ià(
	gdid
 <ğ
lh—d
è
RETURN
(
NULL
);

94 
RETURN
(
´oûss_Ãxt_Ü_sk_to
(
w_mš
, 
l
->
sk_to
(
did
, w_mš - 
rmax
)));

97 
	gX­Ÿn
::
doccouÁ


98 
AndMaybePo¡Li¡
::
	$g‘_‹rmäeq_max
() const

100 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "AndMaybePostList::get_termfreq_max", "");

102 
	`RETURN
(
l
->
	`g‘_‹rmäeq_max
());

103 
	}
}

105 
	gX­Ÿn
::
doccouÁ


106 
AndMaybePo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

108 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "AndMaybePostList::get_termfreq_min", "");

110 
	`RETURN
(
l
->
	`g‘_‹rmäeq_mš
());

111 
	}
}

113 
	gX­Ÿn
::
doccouÁ


114 
AndMaybePo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

116 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "AndMaybePostList::get_termfreq_est", "");

118 
	`RETURN
(
l
->
	`g‘_‹rmäeq_e¡
());

119 
	}
}

121 
T”mF»qs


122 
	gAndMaybePo¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

123 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

125 
LOGCALL
(
MATCH
, 
T”mF»qs
,

126 "AndMaybePo¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

128 
RETURN
(
l
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

131 
	gX­Ÿn
::
docid


132 
AndMaybePo¡Li¡
::
	$g‘_docid
() const

134 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
docid
, "AndMaybePostList::get_docid", "");

135 
	`As£¹
(
lh—d
 != 0);

136 
	`RETURN
(
lh—d
);

137 
	}
}

140 
	gX­Ÿn
::
weight


141 
AndMaybePo¡Li¡
::
	$g‘_weight
() const

143 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "AndMaybePostList::get_weight", "");

144 
	`As£¹
(
lh—d
 != 0);

145 ià(
lh—d
 =ğ
rh—d
è
	`RETURN
(
l
->
	`g‘_weight
(è+ 
r
->get_weight());

146 
	`RETURN
(
l
->
	`g‘_weight
());

147 
	}
}

150 
	gX­Ÿn
::
weight


151 
AndMaybePo¡Li¡
::
	$g‘_maxweight
() const

153 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "AndMaybePostList::get_maxweight", "");

154 
	`RETURN
(
lmax
 + 
rmax
);

155 
	}
}

157 
	gX­Ÿn
::
weight


158 
AndMaybePo¡Li¡
::
	$»ÿlc_maxweight
()

160 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "AndMaybePostList::recalc_maxweight", "");

161 
lmax
 = 
l
->
	`»ÿlc_maxweight
();

162 
rmax
 = 
r
->
	`»ÿlc_maxweight
();

163 
	`RETURN
(
AndMaybePo¡Li¡
::
	`g‘_maxweight
());

164 
	}
}

166 
boŞ


167 
	gAndMaybePo¡Li¡
::
	$©_’d
() const

169 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "AndMaybePostList::at_end", "");

170 
	`RETURN
(
lh—d
 == 0);

171 
	}
}

173 
	g¡d
::
¡ršg


174 
AndMaybePo¡Li¡
::
	$g‘_desütiÚ
() const

176  "(" + 
l
->
	`g‘_desütiÚ
(è+ " AndMayb" + 
r
->get_description() +

178 
	}
}

180 
	gX­Ÿn
::
‹rmcouÁ


181 
AndMaybePo¡Li¡
::
	$g‘_doş’gth
() const

183 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "AndMaybePostList::get_doclength", "");

184 
	`As£¹
(
lh—d
 != 0);

185 ià(
lh—d
 =ğ
rh—d
è
	`As£¹Eq
(
l
->
	`g‘_doş’gth
(), 
r
->get_doclength());

186 
	`RETURN
(
l
->
	`g‘_doş’gth
());

187 
	}
}

189 
	gX­Ÿn
::
‹rmcouÁ


190 
AndMaybePo¡Li¡
::
	$g‘_wdf
() const

192 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "AndMaybePostList::get_wdf", "");

193 ià(
lh—d
 =ğ
rh—d
è
	`RETURN
(
l
->
	`g‘_wdf
(è+ 
r
->get_wdf());

194 
	`RETURN
(
l
->
	`g‘_wdf
());

195 
	}
}

197 
	gX­Ÿn
::
‹rmcouÁ


198 
AndMaybePo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

200 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "AndMaybePostList::count_matching_subqs", "");

201 ià(
lh—d
 =ğ
rh—d
)

202 
	`RETURN
(
l
->
	`couÁ_m©chšg_subqs
(è+ 
r
->count_matching_subqs());

203 
	`RETURN
(
l
->
	`couÁ_m©chšg_subqs
());

204 
	}
}

	@matcher/andmaybepostlist.h

28 #iâdeà
OM_HGUARD_ANDMAYBEPOSTLIST_H


29 
	#OM_HGUARD_ANDMAYBEPOSTLIST_H


	)

31 
	~"b¿nchpo¡li¡.h
"

53 şas 
	cAndMaybePo¡Li¡
 : 
public
 
B¿nchPo¡Li¡
 {

54 
´iv©e
:

55 
X­Ÿn
::
doccouÁ
 
dbsize
;

56 
	mX­Ÿn
::
docid
 
lh—d
, 
	mrh—d
;

57 
	mX­Ÿn
::
weight
 
lmax
, 
	mrmax
;

59 
Po¡Li¡
 * 
´oûss_Ãxt_Ü_sk_to
(
X­Ÿn
::
weight
 
w_mš
, Po¡Li¡ *
»t
);

60 
	mpublic
:

61 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

62 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

63 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

65 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

66 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

68 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

69 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

70 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

72 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

74 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

75 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

76 
boŞ
 
	$©_’d
() const;

78 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

83 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

85 
	`AndMaybePo¡Li¡
(
Po¡Li¡
 *
Ëá_
,

86 
Po¡Li¡
 *
right_
,

87 
MuÉiM©ch
 *
m©ch”_
,

88 
X­Ÿn
::
doccouÁ
 
dbsize_
)

89 : 
	`B¿nchPo¡Li¡
(
Ëá_
, 
right_
, 
m©ch”_
),

90 
	`dbsize
(
dbsize_
), 
	`lh—d
(0), 
	$rh—d
(0)

96 
	`AndMaybePo¡Li¡
(
Po¡Li¡
 *
Ëá_
,

97 
Po¡Li¡
 *
right_
,

98 
MuÉiM©ch
 *
m©ch”_
,

99 
X­Ÿn
::
doccouÁ
 
dbsize_
,

100 
X­Ÿn
::
docid
 
lh—d_
,

101 
X­Ÿn
::
docid
 
rh—d_
)

102 : 
	`B¿nchPo¡Li¡
(
Ëá_
, 
right_
, 
m©ch”_
),

103 
	`dbsize
(
dbsize_
), 
	`lh—d
(
lh—d_
), 
	$rh—d
(
rh—d_
)

107 
lmax
 = 
l
->
	`g‘_maxweight
();

108 
rmax
 = 
r
->
	`g‘_maxweight
();

109 
	}
}

115 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

117 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

118 
	}
};

	@matcher/andnotpostlist.cc

24 
	~<cÚfig.h
>

25 
	~"ªdnÙpo¡li¡.h
"

26 
	~"omas£¹.h
"

27 
	~"omdebug.h
"

29 
Po¡Li¡
 *

30 
	gAndNÙPo¡Li¡
::
advªû_to_Ãxt_m©ch
(
X­Ÿn
::
weight
 
w_mš
, 
Po¡Li¡
 *
»t
)

32 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "AndNÙPo¡Li¡::advªû_to_Ãxt_m©ch", 
w_mš
 << ", " << 
»t
);

33 
hªdË_´uÃ
(
l
, 
»t
);

34 ià(
	gl
->
©_’d
()) {

35 
	glh—d
 = 0;

36 
RETURN
(
NULL
);

38 
	glh—d
 = 
l
->
g‘_docid
();

40 
	grh—d
 <ğ
lh—d
) {

41 ià(
lh—d
 =ğ
rh—d
) {

42 
Ãxt_hªdlšg_´uÃ
(
l
, 
w_mš
, 
m©ch”
);

43 ià(
	gl
->
©_’d
()) {

44 
	glh—d
 = 0;

45 
RETURN
(
NULL
);

47 
	glh—d
 = 
l
->
g‘_docid
();

49 
sk_to_hªdlšg_´uÃ
(
r
, 
lh—d
, 0, 
m©ch”
);

50 ià(
	gr
->
©_’d
()) {

51 
	g»t
 = 
l
;

52 
	gl
 = 
NULL
;

53 
RETURN
(
»t
);

55 
	grh—d
 = 
r
->
g‘_docid
();

57 
RETURN
(
NULL
);

60 
	gAndNÙPo¡Li¡
::
AndNÙPo¡Li¡
(
Po¡Li¡
 *
Ëá_
,

61 
Po¡Li¡
 *
right_
,

62 
MuÉiM©ch
 *
m©ch”_
,

63 
X­Ÿn
::
doccouÁ
 
dbsize_
)

64 : 
B¿nchPo¡Li¡
(
Ëá_
, 
right_
, 
m©ch”_
),

65 
lh—d
(0), 
rh—d
(0), 
	$dbsize
(
dbsize_
)

67 
	`DEBUGCALL
(
MATCH
, , "AndNÙPo¡Li¡", 
Ëá_
 << ", " << 
right_
 << ", " << 
m©ch”_
 << ", " << 
dbsize_
);

68 
	}
}

70 
Po¡Li¡
 *

71 
	gAndNÙPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

73 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "AndNÙPo¡Li¡::Ãxt", 
w_mš
);

74 
RETURN
(
advªû_to_Ãxt_m©ch
(
w_mš
, 
l
->
Ãxt
(w_min)));

77 
Po¡Li¡
 *

78 
	gAndNÙPo¡Li¡
::
sync_ªd_sk_to
(
X­Ÿn
::
docid
 
id
,

79 
X­Ÿn
::
weight
 
w_mš
,

80 
X­Ÿn
::
docid
 
lh
,

81 
X­Ÿn
::
docid
 
rh
)

83 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "AndNÙPo¡Li¡::sync_ªd_sk_to", 
id
 << ", " << 
w_mš
 << ", " << 
lh
 << ", " << 
rh
);

84 
	glh—d
 = 
lh
;

85 
	grh—d
 = 
rh
;

86 
RETURN
(
sk_to
(
id
, 
w_mš
));

89 
Po¡Li¡
 *

90 
	gAndNÙPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

92 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "AndNÙPo¡Li¡::sk_to", 
did
 << ", " << 
w_mš
);

93 ià(
	gdid
 <ğ
lh—d
è
RETURN
(
NULL
);

94 
RETURN
(
advªû_to_Ãxt_m©ch
(
w_mš
, 
l
->
sk_to
(
did
, w_min)));

97 
	gX­Ÿn
::
doccouÁ


98 
AndNÙPo¡Li¡
::
	$g‘_‹rmäeq_max
() const

100 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "AndNotPostList::get_termfreq_max", "");

102 
	`RETURN
(
l
->
	`g‘_‹rmäeq_max
());

103 
	}
}

105 
	gX­Ÿn
::
doccouÁ


106 
AndNÙPo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

108 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "AndNotPostList::get_termfreq_min", "");

110 
X­Ÿn
::
doccouÁ
 
l_mš
 = 
l
->
	`g‘_‹rmäeq_mš
();

111 
X­Ÿn
::
doccouÁ
 
r_max
 = 
r
->
	`g‘_‹rmäeq_max
();

112 ià(
l_mš
 > 
r_max
è
	`RETURN
(l_min -„_max);

113 
	`RETURN
(0u);

114 
	}
}

116 
	gX­Ÿn
::
doccouÁ


117 
AndNÙPo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

119 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "AndNotPostList::get_termfreq_est", "");

123 
e¡
 = 
l
->
	`g‘_‹rmäeq_e¡
() *

124 (1.0 - (
r
->
	`g‘_‹rmäeq_e¡
()è/ 
dbsize
);

125 
	`RETURN
(
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
e¡
 + 0.5));

126 
	}
}

128 
T”mF»qs


129 
	gAndNÙPo¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

130 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

132 
LOGCALL
(
MATCH
, 
T”mF»qs
,

133 "AndNÙPo¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

137 
T”mF»qs
 
läeqs
(
l
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

138 
T”mF»qs
 
räeqs
(
r
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

140 
	gäeqe¡
, 
	g»läeqe¡
;

143 
As£¹
(
¡©s
.
cŞËùiÚ_size
);

145 
	gäeqe¡
 = 
läeqs
.
‹rmäeq
 *

146 (1.0 - ((
räeqs
.
‹rmäeq
è/ 
¡©s
.
cŞËùiÚ_size
));

148 ià(
	g¡©s
.
	gr£t_size
 == 0) {

149 
»läeqe¡
 = 0;

151 
	g»läeqe¡
 = 
läeqs
.
»É”mäeq
 *

152 (1.0 - ((
räeqs
.
»É”mäeq
è/ 
¡©s
.
r£t_size
));

155 
RETURN
(
T”mF»qs
(
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
äeqe¡
 + 0.5),

156 
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
»läeqe¡
 + 0.5)));

159 
	gX­Ÿn
::
docid


160 
AndNÙPo¡Li¡
::
	$g‘_docid
() const

162 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
docid
, "AndNotPostList::get_docid", "");

163 
	`RETURN
(
lh—d
);

164 
	}
}

167 
	gX­Ÿn
::
weight


168 
AndNÙPo¡Li¡
::
	$g‘_weight
() const

170 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "AndNotPostList::get_weight", "");

171 
	`RETURN
(
l
->
	`g‘_weight
());

172 
	}
}

175 
	gX­Ÿn
::
weight


176 
AndNÙPo¡Li¡
::
	$g‘_maxweight
() const

178 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "AndNotPostList::get_maxweight", "");

179 
	`RETURN
(
l
->
	`g‘_maxweight
());

180 
	}
}

182 
	gX­Ÿn
::
weight


183 
AndNÙPo¡Li¡
::
	$»ÿlc_maxweight
()

185 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "AndNotPostList::recalc_maxweight", "");

188 
	`RETURN
(
l
->
	`»ÿlc_maxweight
());

189 
	}
}

191 
boŞ


192 
	gAndNÙPo¡Li¡
::
	$©_’d
() const

194 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "AndNotPostList::at_end", "");

195 
	`RETURN
(
lh—d
 == 0);

196 
	}
}

198 
	g¡d
::
¡ršg


199 
AndNÙPo¡Li¡
::
	$g‘_desütiÚ
() const

201  "(" + 
l
->
	`g‘_desütiÚ
(è+ " AndNÙ " + 
r
->get_description() + ")";

202 
	}
}

204 
	gX­Ÿn
::
‹rmcouÁ


205 
AndNÙPo¡Li¡
::
	$g‘_doş’gth
() const

207 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "AndNotPostList::get_doclength", "");

208 
	`RETURN
(
l
->
	`g‘_doş’gth
());

209 
	}
}

211 
	gX­Ÿn
::
‹rmcouÁ


212 
AndNÙPo¡Li¡
::
	$g‘_wdf
() const

214 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "AndNotPostList::get_wdf", "");

215 
	`RETURN
(
l
->
	`g‘_wdf
());

216 
	}
}

218 
	gX­Ÿn
::
‹rmcouÁ


219 
AndNÙPo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

221 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "AndNotPostList::count_matching_subqs", "");

222 
	`RETURN
(
l
->
	`couÁ_m©chšg_subqs
());

223 
	}
}

	@matcher/andnotpostlist.h

24 #iâdeà
OM_HGUARD_ANDNOTPOSTLIST_H


25 
	#OM_HGUARD_ANDNOTPOSTLIST_H


	)

27 
	~"b¿nchpo¡li¡.h
"

34 şas 
	cAndNÙPo¡Li¡
 : 
public
 
B¿nchPo¡Li¡
 {

35 
´iv©e
:

36 
X­Ÿn
::
docid
 
lh—d
, 
	mrh—d
;

39 
	mX­Ÿn
::
doccouÁ
 
dbsize
;

41 
Po¡Li¡
 *
advªû_to_Ãxt_m©ch
(
X­Ÿn
::
weight
 
w_mš
, Po¡Li¡ *
»t
);

42 
	mpublic
:

43 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

44 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

45 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

46 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

47 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

49 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

50 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

51 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

53 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

55 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

56 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

57 
boŞ
 
	$©_’d
() const;

59 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

64 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

66 
	`AndNÙPo¡Li¡
(
Po¡Li¡
 *
Ëá
,

67 
Po¡Li¡
 *
right
,

68 
MuÉiM©ch
 *
m©ch”_
,

69 
X­Ÿn
::
doccouÁ
 
dbsize_
);

71 
Po¡Li¡
 *
	`sync_ªd_sk_to
(
X­Ÿn
::
docid
 
id
,

72 
X­Ÿn
::
weight
 
w_mš
,

73 
X­Ÿn
::
docid
 
lh
,

74 
X­Ÿn
::
docid
 
rh
);

79 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

81 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

	@matcher/branchpostlist.cc

22 
	~<cÚfig.h
>

24 
	~"b¿nchpo¡li¡.h
"

26 
	gB¿nchPo¡Li¡
::~
	$B¿nchPo¡Li¡
()

28 
d–‘e
 
l
;

29 
d–‘e
 
r
;

30 
	}
}

	@matcher/branchpostlist.h

23 #iâdeà
OM_HGUARD_BRANCHPOSTLIST_H


24 
	#OM_HGUARD_BRANCHPOSTLIST_H


	)

26 
	~"muÉim©ch.h
"

27 
	~"po¡li¡.h
"

36 şas 
	cB¿nchPo¡Li¡
 : 
public
 
Po¡Li¡
 {

37 
´iv©e
:

39 
B¿nchPo¡Li¡
(const BranchPostList &);

40 
	mB¿nchPo¡Li¡
 & 
	mİ”©Ü
=(cÚ¡ 
B¿nchPo¡Li¡
 &);

42 
	m´Ùeùed
:

44 
Po¡Li¡
 *
l
;

47 
Po¡Li¡
 *
	mr
;

54 
MuÉiM©ch
 *
	mm©ch”
;

59 
	$hªdË_´uÃ
(
Po¡Li¡
 *&
kid
, Po¡Li¡ *
»t
) {

60 ià(
»t
) {

61 
d–‘e
 
kid
;

62 
kid
 = 
»t
;

65 
m©ch”
->
	`»ÿlc_maxweight
();

69 
public
:

70 
	$B¿nchPo¡Li¡
(
Po¡Li¡
 *
l_
, Po¡Li¡ *
r_
, 
MuÉiM©ch
 *
m©ch”_
)

71 : 
	`l
(
l_
), 
	`r
(
r_
), 
	$m©ch”
(
m©ch”_
è{
	}
}

73 
	gvœtu®
 ~
B¿nchPo¡Li¡
();

81 
šlše
 
boŞ


82 
Ãxt_hªdlšg_´uÃ
(
Po¡Li¡
 * & 
¶
, 
X­Ÿn
::
weight
 
w_mš
,

83 
MuÉiM©ch
 *
m©ch”
)

85 
Po¡Li¡
 *
	gp
 = 
¶
->
Ãxt
(
w_mš
);

86 ià(!
	gp
è 
	gçl£
;

87 
d–‘e
 
	g¶
;

88 
	g¶
 = 
p
;

90 ià(
	gm©ch”
èm©ch”->
»ÿlc_maxweight
();

91  
	gŒue
;

94 
šlše
 
boŞ


95 
sk_to_hªdlšg_´uÃ
(
Po¡Li¡
 * & 
¶
, 
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
,

96 
MuÉiM©ch
 *
m©ch”
)

98 
Po¡Li¡
 *
	gp
 = 
¶
->
sk_to
(
did
, 
w_mš
);

99 ià(!
	gp
è 
	gçl£
;

100 
d–‘e
 
	g¶
;

101 
	g¶
 = 
p
;

103 ià(
	gm©ch”
èm©ch”->
»ÿlc_maxweight
();

104  
	gŒue
;

107 
šlše
 
boŞ


108 
check_hªdlšg_´uÃ
(
Po¡Li¡
 * & 
¶
, 
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
,

109 
MuÉiM©ch
 *
m©ch”
, 
boŞ
 & 
v®id
)

111 
Po¡Li¡
 *
	gp
 = 
¶
->
check
(
did
, 
w_mš
, 
v®id
);

112 ià(!
	gp
è 
	gçl£
;

113 
d–‘e
 
	g¶
;

114 
	g¶
 = 
p
;

116 ià(
	gm©ch”
èm©ch”->
»ÿlc_maxweight
();

117  
	gŒue
;

	@matcher/collapser.cc

21 
	~<cÚfig.h
>

23 
	~"cŞÏp£r.h
"

25 
	~"omas£¹.h
"

27 
	~<®gÜ™hm
>

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
cŞÏp£_»suÉ


32 
	gCŞÏp£D©a
::
add_™em
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 & 
™em
,

33 
X­Ÿn
::
doccouÁ
 
cŞÏp£_max
, cÚ¡ 
MS‘Cmp
 & 
mcmp
,

34 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 & 
Şd_™em
)

36 ià(
™ems
.
size
(è< 
cŞÏp£_max
) {

37 
™ems
.
push_back
(
™em
);

38 
	g™ems
.
back
().
	gcŞÏp£_key
 = 
¡ršg
();

39  
	gADDED
;

44 ià(
	gcŞÏp£_couÁ
 =ğ0 && 
cŞÏp£_max
 != 1) {

48 
make_h—p
(
™ems
.
begš
(), i‹ms.
’d
(), 
mcmp
);

50 ++
	gcŞÏp£_couÁ
;

52 ià(
mcmp
(
™ems
.
äÚt
(), 
™em
)) {

54 ià(
	g™em
.
	gwt
 > 
	gÃxt_be¡_weight
èÃxt_be¡_weighˆğ
™em
.
wt
;

55  
	gREJECTED
;

58 
	gÃxt_be¡_weight
 = 
™ems
.
äÚt
().
wt
;

60 
	g™ems
.
push_back
(
™em
);

61 
push_h—p
(
™ems
.
begš
(), i‹ms.
’d
(), 
mcmp
);

62 
pİ_h—p
(
™ems
.
begš
(), i‹ms.
’d
(), 
mcmp
);

63 
sw­
(
Şd_™em
, 
™ems
.
back
());

64 
	g™ems
.
pİ_back
();

66  
	gREPLACED
;

69 
cŞÏp£_»suÉ


70 
	gCŞÏp£r
::
´oûss
(
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 & 
™em
,

71 
Po¡Li¡
 * 
po¡li¡
,

72 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 & 
vsdoc
,

73 cÚ¡ 
MS‘Cmp
 & 
mcmp
)

75 ++
	gdocs_cÚsid”ed
;

77 cÚ¡ 
¡ršg
 * 
	gkey_±r
 = 
po¡li¡
->
g‘_cŞÏp£_key
();

78 ià(
	gkey_±r
) {

79 
	g™em
.
	gcŞÏp£_key
 = *
key_±r
;

82 
	g™em
.
	gcŞÏp£_key
 = 
vsdoc
.
g‘_v®ue
(
¦Ù
);

85 ià(
	g™em
.
	gcŞÏp£_key
.
em±y
()) {

87 ++
	gno_cŞÏp£_key
;

88  
	gEMPTY
;

91 
	gm­
<
	g¡ršg
, 
	gCŞÏp£D©a
>::
™”©Ü
 
Şdkey
;

92 
	gŞdkey
 = 
bË
.
fšd
(
™em
.
cŞÏp£_key
);

93 ià(
	gŞdkey
 =ğ
bË
.
’d
()) {

95 
bË
.
š£¹
(
make_·œ
(
™em
.
cŞÏp£_key
, 
CŞÏp£D©a
(item)));

96 ++
	g’Œy_couÁ
;

97  
	gADDED
;

100 
cŞÏp£_»suÉ
 
	g»s
;

101 
	gCŞÏp£D©a
 & 
	gcŞÏp£_d©a
 = 
Şdkey
->
£cÚd
;

102 
	g»s
 = 
cŞÏp£_d©a
.
add_™em
(
™em
, 
cŞÏp£_max
, 
mcmp
, 
Şd_™em
);

103 ià(
	g»s
 =ğ
ADDED
) {

104 ++
’Œy_couÁ
;

105 } ià(
	g»s
 =ğ
REJECTED
 || 
»s
 =ğ
REPLACED
) {

106 ++
dups_ignÜed
;

108  
	g»s
;

111 
	gX­Ÿn
::
doccouÁ


112 
CŞÏp£r
::
g‘_cŞÏp£_couÁ
(cÚ¡ 
¡ršg
 & 
cŞÏp£_key
, 
³rûÁ_cutoff
,

113 
X­Ÿn
::
weight
 
mš_weight
) const

115 
m­
<
¡ršg
, 
	gCŞÏp£D©a
>::
cÚ¡_™”©Ü
 
key
 = 
bË
.
fšd
(
cŞÏp£_key
);

117 
As£¹
(
key
 !ğ
bË
.
’d
());

119 ià(!
	g³rûÁ_cutoff
) {

121  
	gkey
->
	g£cÚd
.
g‘_cŞÏp£_couÁ
();

124 ià(
	gkey
->
	g£cÚd
.
g‘_Ãxt_be¡_weight
(è< 
	gmš_weight
) {

137 
	gX­Ÿn
::
doccouÁ


138 
CŞÏp£r
::
	$g‘_m©ches_low”_bound
() const

142 
X­Ÿn
::
doccouÁ
 
m©ches_low”_bound
 = 
no_cŞÏp£_key
 + 
’Œy_couÁ
;

143  
m©ches_low”_bound
;

149 
X­Ÿn
::
doccouÁ
 
max_k•t
 = 0;

150 
m­
<
¡ršg
, 
CŞÏp£D©a
>::
cÚ¡_™”©Ü
 
i
;

151 
i
 = 
bË
.
	`begš
(); i !ğbË.
	`’d
(); ++i) {

152 ià(
i
->
£cÚd
.
	`g‘_cŞÏp£_couÁ
(è> 
max_k•t
) {

153 
max_k•t
 = 
i
->
£cÚd
.
	`g‘_cŞÏp£_couÁ
();

154 ià(
max_k•t
 =ğ
cŞÏp£_max
) {

155  
m©ches_low”_bound
;

159  
m©ches_low”_bound
 + (
cŞÏp£_max
 - 
max_k•t
);

161 
	}
}

	@matcher/collapser.h

21 #iâdeà
XAPIAN_INCLUDED_COLLAPSER_H


22 
	#XAPIAN_INCLUDED_COLLAPSER_H


	)

24 
	~"docum’t.h
"

25 
	~"m£tcmp.h
"

26 
	~"om’quœeš‹º®.h
"

27 
	~"po¡li¡.h
"

29 
	~<m­
>

33 
	mEMPTY
,

34 
	mADDED
,

35 
	mREJECTED
,

36 
	mREPLACED


37 } 
	tcŞÏp£_»suÉ
;

40 şas 
	cCŞÏp£D©a
 {

50 
	mveùÜ
<
	mX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
> 
™ems
;

53 
	mX­Ÿn
::
weight
 
Ãxt_be¡_weight
;

56 
	mX­Ÿn
::
doccouÁ
 
cŞÏp£_couÁ
;

58 
	mpublic
:

60 
CŞÏp£D©a
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 & 
™em
)

61 : 
™ems
(1, 
™em
), 
Ãxt_be¡_weight
(0), 
	$cŞÏp£_couÁ
(0) {

62 
™ems
[0].
cŞÏp£_key
 = 
	`¡ršg
();

74 
cŞÏp£_»suÉ
 
	`add_™em
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 & 
™em
,

75 
X­Ÿn
::
doccouÁ
 
cŞÏp£_max
,

76 cÚ¡ 
MS‘Cmp
 & 
mcmp
,

77 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 & 
Şd_™em
);

80 
X­Ÿn
::
weight
 
	$g‘_Ãxt_be¡_weight
(ècÚ¡ {  
Ãxt_be¡_weight
; 
	}
}

83 
	gX­Ÿn
::
doccouÁ
 
	$g‘_cŞÏp£_couÁ
(ècÚ¡ {  
cŞÏp£_couÁ
; 
	}
}

87 şas 
	cCŞÏp£r
 {

89 
	m¡d
::
m­
<
¡d
::
¡ršg
, 
	mCŞÏp£D©a
> 
	mbË
;

92 
	mX­Ÿn
::
doccouÁ
 
’Œy_couÁ
;

98 
	mX­Ÿn
::
doccouÁ
 
no_cŞÏp£_key
;

105 
	mX­Ÿn
::
doccouÁ
 
dups_ignÜed
;

112 
	mX­Ÿn
::
doccouÁ
 
docs_cÚsid”ed
;

115 
	mX­Ÿn
::
v®u’o
 
¦Ù
;

118 
	mX­Ÿn
::
doccouÁ
 
cŞÏp£_max
;

120 
	mpublic
:

122 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 
Şd_™em
;

124 
CŞÏp£r
(
X­Ÿn
::
v®u’o
 
¦Ù_
, X­Ÿn::
doccouÁ
 
cŞÏp£_max_
)

125 : 
’Œy_couÁ
(0), 
no_cŞÏp£_key
(0), 
dups_ignÜed
(0),

126 
docs_cÚsid”ed
(0), 
¦Ù
(
¦Ù_
), 
cŞÏp£_max
(
cŞÏp£_max_
),

127 
	$Şd_™em
(0, 0) { }

130 
İ”©Ü
 
	$boŞ
(ècÚ¡ {  
cŞÏp£_max
 !ğ0; 
	}
}

142 
cŞÏp£_»suÉ
 
´oûss
(
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 & 
™em
,

143 
Po¡Li¡
 * 
po¡li¡
,

144 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 & 
vsdoc
,

145 cÚ¡ 
MS‘Cmp
 & 
mcmp
);

147 
	gX­Ÿn
::
doccouÁ
 
g‘_cŞÏp£_couÁ
(cÚ¡ 
¡d
::
¡ršg
 & 
cŞÏp£_key
,

148 
³rûÁ_cutoff
,

149 
X­Ÿn
::
weight
 
mš_weight
) const;

151 
	gX­Ÿn
::
doccouÁ
 
	$g‘_docs_cÚsid”ed
(ècÚ¡ {  
docs_cÚsid”ed
; 
	}
}

153 
	gX­Ÿn
::
doccouÁ
 
	$g‘_dups_ignÜed
(ècÚ¡ {  
dups_ignÜed
; 
	}
}

155 
	gX­Ÿn
::
doccouÁ
 
	$’Œ›s
(ècÚ¡ {  
’Œy_couÁ
; 
	}
}

157 
	gX­Ÿn
::
doccouÁ
 
	$g‘_m©ches_low”_bound
() const;

159 
boŞ
 
	$em±y
(ècÚ¡ {  
bË
.
	`em±y
(); 
	}
}

	@matcher/exactphrasepostlist.cc

21 
	~<cÚfig.h
>

23 
	~"exaùph¿£po¡li¡.h
"

24 
	~"pos™iÚli¡.h
"

25 
	~"omdebug.h
"

27 
	~<®gÜ™hm
>

28 
	~<veùÜ
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	gExaùPh¿£Po¡Li¡
::
ExaùPh¿£Po¡Li¡
(
Po¡Li¡
 *
sourû_
,

33 cÚ¡ 
veùÜ
<
Po¡Li¡
*> &
‹rms_
)

34 : 
S–eùPo¡Li¡
(
sourû_
), 
	$‹rms
(
‹rms_
)

36 
size_t
 
n
 = 
‹rms_
.
	`size
();

37 
po¦i¡s
 = 
Ãw
 
Pos™iÚLi¡
*[
n
];

38 
Œy
 {

39 
Üd”
 = 
Ãw
 [
n
];

40 } 
	`ÿtch
 (...) {

41 
d–‘e
 [] 
po¦i¡s
;

42 
throw
;

44 
size_t
 
i
 = 0; i < 
n
; ++iè
Üd”
[i] = (i);

45 
	}
}

47 
	gExaùPh¿£Po¡Li¡
::~
	$ExaùPh¿£Po¡Li¡
()

49 
d–‘e
 [] 
po¦i¡s
;

50 
d–‘e
 [] 
Üd”
;

51 
	}
}

54 
	gExaùPh¿£Po¡Li¡
::
	$¡¬t_pos™iÚ_li¡
(
i
)

56 
šdex
 = 
Üd”
[
i
];

57 
po¦i¡s
[
i
] = 
‹rms
[
šdex
]->
	`»ad_pos™iÚ_li¡
();

58 
po¦i¡s
[
i
]->
šdex
 = index;

59 
	}
}

61 şas 
	cT”mCom·»
 {

62 
	mveùÜ
<
	mPo¡Li¡
 *> & 
	m‹rms
;

64 
	mpublic
:

65 
T”mCom·»
(
veùÜ
<
Po¡Li¡
 *> & 
‹rms_
è: 
	$‹rms
(
‹rms_
) { }

67 
boŞ
 
	$İ”©Ü
()(
a
, 
b
) const {

68  
‹rms
[
a
]->
	`g‘_wdf
(è<”ms[
b
]->get_wdf();

69 
	}
}

72 
boŞ


73 
	gExaùPh¿£Po¡Li¡
::
	$‹¡_doc
()

75 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "ExactPhrasePostList::test_doc", "");

77 ià(
‹rms
.
	`size
(è<ğ1è
	`RETURN
(
Œue
);

83 
	`sÜt
(
Üd”
, ord” + 
‹rms
.
	`size
(), 
	`T”mCom·»
(terms));

89 
	`¡¬t_pos™iÚ_li¡
(0);

90 
po¦i¡s
[0]->
	`sk_to
Õo¦i¡s[0]->
šdex
);

91 ià(
po¦i¡s
[0]->
	`©_’d
()è
	`RETURN
(
çl£
);

96 
	`¡¬t_pos™iÚ_li¡
(1);

97 ià(
po¦i¡s
[0]->
	`g‘_size
() <…oslists[1]->get_size()) {

98 
po¦i¡s
[1]->
	`sk_to
Õo¦i¡s[1]->
šdex
);

99 ià(
po¦i¡s
[1]->
	`©_’d
()è
	`RETURN
(
çl£
);

100 
	`sw­
(
po¦i¡s
[0],…oslists[1]);

103 
»ad_hwm
 = 1;

104 
X­Ÿn
::
‹rmpos
 
idx0
 = 
po¦i¡s
[0]->
šdex
;

106 
X­Ÿn
::
‹rmpos
 
ba£
 = 
po¦i¡s
[0]->
	`g‘_pos™iÚ
(è- 
idx0
;

107 
i
 = 1;

108 
Œue
) {

109 ià(
i
 > 
»ad_hwm
) {

110 
»ad_hwm
 = 
i
;

111 
	`¡¬t_pos™iÚ_li¡
(
i
);

116 
X­Ÿn
::
‹rmpos
 
»quœed
 = 
ba£
 + 
po¦i¡s
[
i
]->
šdex
;

117 
po¦i¡s
[
i
]->
	`sk_to
(
»quœed
);

118 ià(
po¦i¡s
[
i
]->
	`©_’d
()è
	`RETURN
(
çl£
);

119 ià(
po¦i¡s
[
i
]->
	`g‘_pos™iÚ
(è!ğ
»quœed
) ;

120 ià(++
i
 =ğ
‹rms
.
	`size
()è
	`RETURN
(
Œue
);

122 
po¦i¡s
[0]->
	`Ãxt
();

123 } !
po¦i¡s
[0]->
	`©_’d
());

124 
	`RETURN
(
çl£
);

125 
	}
}

127 
	gX­Ÿn
::
‹rmcouÁ


128 
ExaùPh¿£Po¡Li¡
::
	$g‘_wdf
() const

140 
¡d
::
veùÜ
<
Po¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
 = 
‹rms
.
	`begš
();

141 
X­Ÿn
::
‹rmcouÁ
 
wdf
 = (*
i
)->
	`g‘_wdf
();

142 ; 
i
 !ğ
‹rms
.
	`’d
(); i++) {

143 
wdf
 = 
¡d
::
	`mš
(wdf, (*
i
)->
	`g‘_wdf
());

145  
wdf
;

146 
	}
}

148 
	gX­Ÿn
::
doccouÁ


149 
ExaùPh¿£Po¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

154  
sourû
->
	`g‘_‹rmäeq_e¡
() / 4;

155 
	}
}

157 
T”mF»qs


158 
	gExaùPh¿£Po¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

159 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

161 
LOGCALL
(
MATCH
, 
T”mF»qs
,

162 "ExaùPh¿£Po¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

165 
T”mF»qs
 
»suÉ
(
sourû
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

166 
	g»suÉ
.
	g‹rmäeq
 /= 4;

167 
	g»suÉ
.
	g»É”mäeq
 /= 4;

168 
RETURN
(
»suÉ
);

171 
¡ršg


172 
	gExaùPh¿£Po¡Li¡
::
	$g‘_desütiÚ
() const

174  "(ExaùPh¿£ " + 
sourû
->
	`g‘_desütiÚ
() + ")";

175 
	}
}

	@matcher/exactphrasepostlist.h

22 #iâdeà
XAPIAN_INCLUDED_EXACTPHRASEPOSTLIST_H


23 
	#XAPIAN_INCLUDED_EXACTPHRASEPOSTLIST_H


	)

25 
	~"£Ëùpo¡li¡.h
"

26 
	~<veùÜ
>

28 
	gX­Ÿn
::
	tPos™iÚI‹¿tÜ
::
	tIÁ”Çl
 
	tPos™iÚLi¡
;

40 şas 
	cExaùPh¿£Po¡Li¡
 : 
public
 
S–eùPo¡Li¡
 {

41 
¡d
::
veùÜ
<
Po¡Li¡
*> 
‹rms
;

43 
Pos™iÚLi¡
 ** 
	mpo¦i¡s
;

45 * 
	mÜd”
;

48 
¡¬t_pos™iÚ_li¡
(
i
);

51 
boŞ
 
‹¡_doc
();

53 
	mpublic
:

54 
ExaùPh¿£Po¡Li¡
(
Po¡Li¡
 *
sourû_
, cÚ¡ 
¡d
::
veùÜ
<Po¡Li¡*> &
‹rms_
);

56 ~
ExaùPh¿£Po¡Li¡
();

58 
	mX­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

60 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

62 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

63 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

65 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

	@matcher/externalpostlist.cc

22 
	~<cÚfig.h
>

24 
	~"ex‹º®po¡li¡.h
"

26 
	~<x­Ÿn/po¡šgsourû.h
>

28 
	~"omas£¹.h
"

29 
	~"omdebug.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gEx‹º®Po¡Li¡
::
Ex‹º®Po¡Li¡
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
,

34 
X­Ÿn
::
Po¡šgSourû
 *
sourû_
,

35 
çùÜ_
,

36 
MuÉiM©ch
 * 
m©ch”
)

37 : 
sourû
(
sourû_
), 
sourû_is_owÃd
(
çl£
), 
cu¼’t
(0), 
	$çùÜ
(
çùÜ_
)

39 
	`As£¹
(
sourû
);

40 
X­Ÿn
::
Po¡šgSourû
 * 
Ãwsourû
 = 
sourû
->
	`şÚe
();

41 ià(
Ãwsourû
 !ğ
NULL
) {

42 
sourû
 = 
Ãwsourû
;

43 
sourû_is_owÃd
 = 
Œue
;

45 
sourû
->
	`»gi¡”_m©ch”_
(
¡©ic_ÿ¡
<*>(
m©ch”
));

46 
sourû
->
	`š™
(
db
);

47 
	}
}

49 
	gEx‹º®Po¡Li¡
::~
	$Ex‹º®Po¡Li¡
()

51 ià(
sourû_is_owÃd
) {

52 
d–‘e
 
sourû
;

54 
	}
}

56 
	gX­Ÿn
::
doccouÁ


57 
Ex‹º®Po¡Li¡
::
	$g‘_‹rmäeq_mš
() const

59 
	`As£¹
(
sourû
);

60  
sourû
->
	`g‘_‹rmäeq_mš
();

61 
	}
}

63 
	gX­Ÿn
::
doccouÁ


64 
Ex‹º®Po¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

66 
	`As£¹
(
sourû
);

67  
sourû
->
	`g‘_‹rmäeq_e¡
();

68 
	}
}

70 
	gX­Ÿn
::
doccouÁ


71 
Ex‹º®Po¡Li¡
::
	$g‘_‹rmäeq_max
() const

73 
	`As£¹
(
sourû
);

74  
sourû
->
	`g‘_‹rmäeq_max
();

75 
	}
}

77 
	gX­Ÿn
::
weight


78 
Ex‹º®Po¡Li¡
::
	$g‘_maxweight
() const

80 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "ExternalPostList::get_maxweight", "");

82 ià(
sourû
 =ğ
NULL
è
	`RETURN
(0.0);

83 ià(
çùÜ
 =ğ0.0è
	`RETURN
(0.0);

84 
	`RETURN
(
çùÜ
 * 
sourû
->
	`g‘_maxweight
());

85 
	}
}

87 
	gX­Ÿn
::
docid


88 
Ex‹º®Po¡Li¡
::
	$g‘_docid
() const

90 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
docid
, "ExternalPostList::get_docid", "");

91 
	`As£¹
(
cu¼’t
);

92 
	`RETURN
(
cu¼’t
);

93 
	}
}

95 
	gX­Ÿn
::
weight


96 
Ex‹º®Po¡Li¡
::
	$g‘_weight
() const

98 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "ExternalPostList::get_weight", "");

99 
	`As£¹
(
sourû
);

100 ià(
çùÜ
 =ğ0.0è
	`RETURN
(factor);

101 
	`RETURN
(
çùÜ
 * 
sourû
->
	`g‘_weight
());

102 
	}
}

104 
	gX­Ÿn
::
‹rmcouÁ


105 
Ex‹º®Po¡Li¡
::
	$g‘_doş’gth
() const

107 
	`As£¹
(
çl£
);

109 
	}
}

111 
	gX­Ÿn
::
weight


112 
Ex‹º®Po¡Li¡
::
	$»ÿlc_maxweight
()

114  
Ex‹º®Po¡Li¡
::
	`g‘_maxweight
();

115 
	}
}

117 
Pos™iÚLi¡
 *

118 
	gEx‹º®Po¡Li¡
::
	$»ad_pos™iÚ_li¡
()

120  
NULL
;

121 
	}
}

123 
Pos™iÚLi¡
 *

124 
	gEx‹º®Po¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

126  
NULL
;

127 
	}
}

129 
Po¡Li¡
 *

130 
	gEx‹º®Po¡Li¡
::
	$upd©e_aá”_advªû
() {

131 
	`DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "ExternalPostList::update_after_advance", "");

132 
	`As£¹
(
sourû
);

133 ià(
sourû
->
	`©_’d
()) {

134 
	`LOGLINE
(
MATCH
, "ExternalPostList‚ow‡tƒnd");

135 ià(
sourû_is_owÃd
è
d–‘e
 
sourû
;

136 
sourû
 = 
NULL
;

138 
cu¼’t
 = 
sourû
->
	`g‘_docid
();

140 
	`RETURN
(
NULL
);

141 
	}
}

143 
Po¡Li¡
 *

144 
	gEx‹º®Po¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

146 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "Ex‹º®Po¡Li¡::Ãxt", 
w_mš
);

147 
As£¹
(
sourû
);

148 
	gsourû
->
Ãxt
(
w_mš
);

149 
RETURN
(
upd©e_aá”_advªû
());

152 
Po¡Li¡
 *

153 
	gEx‹º®Po¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

155 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "ExternalPostList::skip_to",

156 
did
 << ", " << 
w_mš
);

157 
As£¹
(
sourû
);

158 ià(
	gdid
 <ğ
cu¼’t
è
RETURN
(
NULL
);

159 
	gsourû
->
sk_to
(
did
, 
w_mš
);

160 
RETURN
(
upd©e_aá”_advªû
());

163 
Po¡Li¡
 *

164 
	gEx‹º®Po¡Li¡
::
check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
, 
boŞ
 &
v®id
)

166 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "ExternalPostList::check",

167 
did
 << ", " << 
w_mš
 << ", <valid>");

168 
As£¹
(
sourû
);

169 ià(
	gdid
 <ğ
cu¼’t
) {

170 
v®id
 = 
Œue
;

171 
RETURN
(
NULL
);

173 
	gv®id
 = 
sourû
->
check
(
did
, 
w_mš
);

174 ià(
	gsourû
->
©_’d
()) {

175 
LOGLINE
(
MATCH
, "ExternalPostList‚ow‡tƒnd");

176 ià(
	gsourû_is_owÃd
è
d–‘e
 
	gsourû
;

177 
	gsourû
 = 
NULL
;

179 
	gcu¼’t
 = 
v®id
 ? 
sourû
->
g‘_docid
(è: 
cu¼’t
;

181 
RETURN
(
NULL
);

184 
boŞ


185 
	gEx‹º®Po¡Li¡
::
	$©_’d
() const

187 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "ExternalPostList::at_end", "");

188 
	`RETURN
(
sourû
 =ğ
NULL
);

189 
	}
}

191 
	gX­Ÿn
::
‹rmcouÁ


192 
Ex‹º®Po¡Li¡
::
	$couÁ_m©chšg_subqs
() const

195 
	}
}

197 
¡ršg


198 
	gEx‹º®Po¡Li¡
::
	$g‘_desütiÚ
() const

200 
¡ršg
 
desc
 = "ExternalPostList(";

201 ià(
sourû
è
desc
 +ğsourû->
	`g‘_desütiÚ
();

202 
desc
 += ")";

203  
desc
;

204 
	}
}

	@matcher/externalpostlist.h

22 #iâdeà
XAPIAN_INCLUDED_EXTERNALPOSTLIST_H


23 
	#XAPIAN_INCLUDED_EXTERNALPOSTLIST_H


	)

25 
	~"po¡li¡.h
"

27 
Çme¥aû
 
	gX­Ÿn
 {

28 
şass
 
	gPo¡šgSourû
;

31 
şass
 
	gMuÉiM©ch
;

33 şas 
	cEx‹º®Po¡Li¡
 : 
public
 
Po¡Li¡
 {

35 
Ex‹º®Po¡Li¡
(const ExternalPostList &);

38 
	mİ”©Ü
=(cÚ¡ 
Ex‹º®Po¡Li¡
 &);

40 
	mX­Ÿn
::
Po¡šgSourû
 * 
sourû
;

41 
boŞ
 
	msourû_is_owÃd
;

43 
	mX­Ÿn
::
docid
 
cu¼’t
;

45 
	mçùÜ
;

47 
Po¡Li¡
 * 
upd©e_aá”_advªû
();

49 
	mpublic
:

54 
Ex‹º®Po¡Li¡
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
,

55 
X­Ÿn
::
Po¡šgSourû
 *
sourû_
,

56 
çùÜ_
,

57 
MuÉiM©ch
 * 
m©ch”
);

59 ~
Ex‹º®Po¡Li¡
();

61 
	mX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

63 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

65 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

67 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

69 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

71 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

73 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

75 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

77 
Pos™iÚLi¡
 * 
	`»ad_pos™iÚ_li¡
();

79 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

81 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

83 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
 
w_mš
);

85 
Po¡Li¡
 * 
	`check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
, 
boŞ
 &
v®id
);

87 
boŞ
 
	$©_’d
() const;

89 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

91 
¡ršg
 
	$g‘_desütiÚ
() const;

	@matcher/extraweightpostlist.h

23 #iâdeà
OM_HGUARD_EXTRAWEIGHTPOSTLIST_H


24 
	#OM_HGUARD_EXTRAWEIGHTPOSTLIST_H


	)

26 
	~"muÉim©ch.h
"

28 
Çme¥aû
 
	gX­Ÿn
 {

29 
şass
 
	gWeight
;

33 şas 
	cExŒaWeightPo¡Li¡
 : 
public
 
Po¡Li¡
 {

34 
´iv©e
:

35 
Po¡Li¡
 * 
¶
;

36 
	mX­Ÿn
::
Weight
 * 
wt
;

37 
MuÉiM©ch
 * 
	mm©ch”
;

38 
	mX­Ÿn
::
weight
 
max_weight
;

40 
	mpublic
:

41 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const {

42  
¶
->
	`g‘_‹rmäeq_max
();

44 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const {

45  
¶
->
	`g‘_‹rmäeq_mš
();

46 
	}
}

47 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const {

48  
¶
->
	`g‘_‹rmäeq_e¡
();

49 
	}
}

51 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
¶
->
	`g‘_docid
(); 
	}
}

53 
	gX­Ÿn
::
weight
 
	$g‘_weight
() const {

54  
¶
->
	`g‘_weight
(è+ 
wt
->
	`g‘_sumexŒa
Õl->
	`g‘_doş’gth
());

55 
	}
}

57 
	gX­Ÿn
::
weight
 
	$g‘_maxweight
() const {

58  
¶
->
	`g‘_maxweight
(è+ 
max_weight
;

59 
	}
}

61 
	gX­Ÿn
::
weight
 
	$»ÿlc_maxweight
() {

62  
¶
->
	`»ÿlc_maxweight
(è+ 
max_weight
;

63 
	}
}

65 
Po¡Li¡
 *
Ãxt
(
X­Ÿn
::
weight
 
w_mš
) {

66 
Po¡Li¡
 *
p
 = 
¶
->
Ãxt
(
w_mš
 - 
max_weight
);

67 ià(
	gp
) {

68 
d–‘e
 
	g¶
;

69 
	g¶
 = 
p
;

70 ià(
	gm©ch”
èm©ch”->
»ÿlc_maxweight
();

72  
	gNULL
;

75 
Po¡Li¡
 *
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
) {

76 
Po¡Li¡
 *
p
 = 
¶
->
sk_to
(
did
, 
w_mš
 - 
max_weight
);

77 ià(
	gp
) {

78 
d–‘e
 
	g¶
;

79 
	g¶
 = 
p
;

80 ià(
	gm©ch”
èm©ch”->
»ÿlc_maxweight
();

82  
	gNULL
;

85 
boŞ
 
	$©_’d
(ècÚ¡ {  
¶
->
	`©_’d
(); 
	}
}

87 
	g¡d
::
¡ršg
 
	$g‘_desütiÚ
() const {

88  "ĞExŒaWeighˆ" + 
¶
->
	`g‘_desütiÚ
() + " )";

89 
	}
}

94 
vœtu®
 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const {

95  
¶
->
	`g‘_doş’gth
();

96 
	}
}

98 
ExŒaWeightPo¡Li¡
(
Po¡Li¡
 * 
¶_
, 
X­Ÿn
::
Weight
 *
wt_
,

99 
MuÉiM©ch
 *
m©ch”_
)

100 : 
¶
(
¶_
), 
wt
(
wt_
), 
m©ch”
(
m©ch”_
),

101 
max_weight
(
wt
->
	$g‘_maxexŒa
())

102 { 
	}
}

104 ~
	$ExŒaWeightPo¡Li¡
() {

105 
d–‘e
 
¶
;

106 
d–‘e
 
wt
;

107 
	}
}

109 
	gX­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const {

110  
¶
->
	`couÁ_m©chšg_subqs
();

111 
	}
}

	@matcher/localmatch.cc

24 
	~<cÚfig.h
>

26 
	~"loÿlm©ch.h
"

28 
	~"autİŒ.h
"

29 
	~"exŒaweigho¡li¡.h
"

30 
	~"Ëaåo¡li¡.h
"

31 
	~"omdebug.h
"

32 
	~"omqu”yš‹º®.h
"

33 
	~"qu”yİtimi£r.h
"

34 
	~"synÚympo¡li¡.h
"

35 
	~"weightš‹º®.h
"

37 
	~<cæßt
>

38 
	~<cm©h
>

39 
	~<m­
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

43 
	gLoÿlSubM©ch
::
LoÿlSubM©ch
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
db_
,

44 cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qu”y
, X­Ÿn::
‹rmcouÁ
 
qËn_
,

45 cÚ¡ 
X­Ÿn
::
RS‘
 & 
omr£t
,

46 cÚ¡ 
X­Ÿn
::
Weight
 *
wt_çùÜy_
)

47 : 
Üig_qu”y
(*
qu”y
), 
qËn
(
qËn_
), 
db
(
db_
),

48 
r£t
(
db
, 
omr£t
), 
wt_çùÜy
(
wt_çùÜy_
), 
	$‹rm_šfo
(
NULL
)

50 
	`DEBUGCALL
(
MATCH
, , "LocalSubMatch::LocalSubMatch",

51 
db
 << ", " << 
qu”y
 << ", " << 
qËn_
 << ", " << 
omr£t
 << ", " <<

53 
	}
}

55 
boŞ


56 
	gLoÿlSubM©ch
::
´•¬e_m©ch
(
boŞ
, 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
)

58 
DEBUGCALL
(
MATCH
, 
boŞ
, "LocalSubMatch::prepare_match", "[nowait], [total_stats]");

59 
	gX­Ÿn
::
Weight
::
IÁ”Çl
 
my_¡©s
;

62 
	gmy_¡©s
.
	gtÙ®_Ëngth
 = 
db
->
g‘_tÙ®_Ëngth
();

63 
	gmy_¡©s
.
	gcŞËùiÚ_size
 = 
db
->
g‘_doccouÁ
();

66 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t™”
 = 
Üig_qu”y
.
g‘_‹rms
();

67 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rms_’d
(
NULL
);

68  ; 
	gt™”
 !ğ
‹rms_’d
; ++titer) {

69 
As£¹
(!(*
t™”
).
em±y
());

70 
	gmy_¡©s
.
£t_‹rmäeq
(*
t™”
, 
db
->
g‘_‹rmäeq
(*titer));

71 
	gr£t
.
wl_wªt_»É”mäeq
(*
t™”
);

73 
	gr£t
.
cÚŒibu‹_¡©s
(
my_¡©s
);

76 
	gtÙ®_¡©s
 +ğ
my_¡©s
;

77 
RETURN
(
Œue
);

81 
	gLoÿlSubM©ch
::
¡¬t_m©ch
(
X­Ÿn
::
doccouÁ
, Xapian::doccount,

82 
X­Ÿn
::
doccouÁ
,

83 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
)

86 
¡©s
 = &
tÙ®_¡©s
;

89 
Po¡Li¡
 *

90 
	gLoÿlSubM©ch
::
g‘_po¡li¡_ªd_‹rm_šfo
(
MuÉiM©ch
 * 
m©ch”
,

91 
m­
<
¡ršg
, 
X­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> * 
‹rmäeqªdwts
,

92 
X­Ÿn
::
‹rmcouÁ
 * 
tÙ®_subqs_±r
)

94 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "LocalSubMatch::get_postlist_and_term_info",

95 
m©ch”
 << ", [termfreqandwts], [total_subqs_ptr]");

96 
	g‹rm_šfo
 = 
‹rmäeqªdwts
;

101 
Qu”yO±imi£r
 
İt
(*
db
, *
this
, 
m©ch”
);

102 
Po¡Li¡
 * 
	g¶
 = 
İt
.
İtimi£_qu”y
(&
Üig_qu”y
);

103 *
	gtÙ®_subqs_±r
 = 
İt
.
g‘_tÙ®_subqu”›s
();

107 
	gAutoPŒ
<
	gX­Ÿn
::
Weight
> 
exŒa_wt
(
wt_çùÜy
->
şÚe
());

108 
	gexŒa_wt
->
š™_
(*
¡©s
, 
qËn
);

109 ià(
	gexŒa_wt
->
g‘_maxexŒa
() != 0.0) {

110 
¶
 = 
Ãw
 
ExŒaWeightPo¡Li¡
Õl, 
exŒa_wt
.
»Ëa£
(), 
m©ch”
);

113 
RETURN
(
¶
);

116 
Po¡Li¡
 *

117 
	gLoÿlSubM©ch
::
	$make_synÚym_po¡li¡
(
Po¡Li¡
 * 
Ü_¶
, 
MuÉiM©ch
 * 
m©ch”
,

118 
çùÜ
)

120 
	`DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "LocalSubMatch::make_synonym_postlist",

121 "[Ü_¶], [m©ch”], " << 
çùÜ
);

122 
	`LOGVALUE
(
MATCH
, 
Ü_¶
->
	`g‘_‹rmäeq_e¡
());

123 
AutoPŒ
<
SynÚymPo¡Li¡
> 
	`»s
(
Ãw
 
	`SynÚymPo¡Li¡
(
Ü_¶
, 
m©ch”
));

124 
AutoPŒ
<
X­Ÿn
::
Weight
> 
	`wt
(
wt_çùÜy
->
	`şÚe
());

126 
T”mF»qs
 
äeqs
;

132 ià(
	`usu®
(
¡©s
->
cŞËùiÚ_size
 != 0)) {

133 
äeqs
 = 
Ü_¶
->
	`g‘_‹rmäeq_e¡_usšg_¡©s
(*
¡©s
);

135 
wt
->
	`š™_
(*
¡©s
, 
qËn
, 
çùÜ
, 
äeqs
.
‹rmäeq
, f»qs.
»É”mäeq
);

137 
»s
->
	`£t_weight
(
wt
.
	`»Ëa£
());

138 
	`RETURN
(
»s
.
	`»Ëa£
());

139 
	}
}

141 
Po¡Li¡
 *

142 
	gLoÿlSubM©ch
::
po¡li¡_äom_İ_Ëaf_qu”y
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
,

143 
çùÜ
)

145 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "LocalSubMatch::postlist_from_op_leaf_query",

146 
qu”y
 << ", " << 
çùÜ
);

147 
As£¹
(
qu”y
);

148 
As£¹Eq
(
qu”y
->
İ
, 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
);

149 
As£¹
(
qu”y
->
subqs
.
em±y
());

150 
boŞ
 
	gboŞ—n
 = (
çùÜ
 == 0.0);

151 
	gAutoPŒ
<
	gX­Ÿn
::
Weight
> 
wt
;

152 ià(!
	gboŞ—n
) {

153 
	gwt
.
»£t
(
wt_çùÜy
->
şÚe
());

154 
	gwt
->
š™_
(*
¡©s
, 
qËn
, 
qu”y
->
Šame
, qu”y->
g‘_wqf
(), 
çùÜ
);

157 ià(
	g‹rm_šfo
) {

158 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
>::
™”©Ü
 
i
;

159 
	gi
 = 
‹rm_šfo
->
fšd
(
qu”y
->
Šame
);

160 ià(
	gi
 =ğ
‹rm_šfo
->
’d
()) {

161 
X­Ÿn
::
doccouÁ
 
tf
 = 
¡©s
->
g‘_‹rmäeq
(
qu”y
->
Šame
);

162 
	gX­Ÿn
::
weight
 weighˆğ
boŞ—n
 ? 0 : 
wt
->
g‘_max·¹
();

163 
	gX­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
 
šfo
(
tf
, 
weight
);

164 
LOGLINE
(
MATCH
, "S‘tšg”m_šfo[" << 
qu”y
->
Šame
 << "] "

165 "tØ(" << 
tf
 << ", " << 
weight
 << ")");

166 
	g‹rm_šfo
->
š£¹
(
make_·œ
(
qu”y
->
Šame
, 
šfo
));

167 } ià(!
	gboŞ—n
) {

168 
	gi
->
	g£cÚd
.
	g‹rmweight
 +ğ
wt
->
g‘_max·¹
();

169 
As£¹Eq
(
¡©s
->
g‘_‹rmäeq
(
qu”y
->
Šame
), 
i
->
£cÚd
.
‹rmäeq
);

170 
LOGLINE
(
MATCH
, "Inü—sšg”m_šfo[" << 
qu”y
->
Šame
 << "] "

171 "tØ(" << 
i
->
£cÚd
.
‹rmäeq
 << ", " <<

172 
i
->
£cÚd
.
‹rmweight
 << ")");

176 
L—fPo¡Li¡
 * 
	g¶
 = 
db
->
İ’_po¡_li¡
(
qu”y
->
Šame
);

179 ià(!
	gboŞ—n
è
	g¶
->
£t_‹rmweight
(
wt
.
»Ëa£
());

180 
RETURN
(
¶
);

	@matcher/localmatch.h

22 #iâdeà
XAPIAN_INCLUDED_LOCALMATCH_H


23 
	#XAPIAN_INCLUDED_LOCALMATCH_H


	)

25 
	~"d©aba£.h
"

26 
	~"omqu”yš‹º®.h
"

27 
	~"r£t.h
"

28 
	~"subm©ch.h
"

29 
	~"x­Ÿn/weight.h
"

31 
	~<m­
>

33 şas 
	cLoÿlSubM©ch
 : 
public
 
SubM©ch
 {

35 
İ”©Ü
=(cÚ¡ 
LoÿlSubM©ch
 &);

38 
LoÿlSubM©ch
(const LocalSubMatch &);

41 cÚ¡ 
	mX­Ÿn
::
Weight
::
IÁ”Çl
 * 
¡©s
;

44 
	mX­Ÿn
::
Qu”y
::
IÁ”Çl
 
Üig_qu”y
;

47 
	mX­Ÿn
::
‹rmcouÁ
 
qËn
;

50 cÚ¡ 
	mX­Ÿn
::
D©aba£
::
IÁ”Çl
 *
db
;

56 
RS‘I
 
	mr£t
;

59 cÚ¡ 
	mX­Ÿn
::
Weight
 * 
wt_çùÜy
;

62 
	m¡d
::
m­
<
¡ršg
, 
	mX­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> * 
‹rm_šfo
;

64 
	mpublic
:

66 
LoÿlSubM©ch
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
db
,

67 cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qu”y
,

68 
X­Ÿn
::
‹rmcouÁ
 
qËn
,

69 cÚ¡ 
X­Ÿn
::
RS‘
 & 
omr£t
,

70 cÚ¡ 
X­Ÿn
::
Weight
 *
wt_çùÜy
);

73 
boŞ
 
´•¬e_m©ch
(boŞ 
nowa™
, 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
);

76 
¡¬t_m©ch
(
X­Ÿn
::
doccouÁ
 
fœ¡
,

77 
X­Ÿn
::
doccouÁ
 
max™ems
,

78 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

79 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
);

82 
Po¡Li¡
 * 
g‘_po¡li¡_ªd_‹rm_šfo
(
MuÉiM©ch
 *
m©ch”
,

83 
¡d
::
m­
<
¡ršg
, 
X­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> *
‹rmäeqªdwts
,

84 
X­Ÿn
::
‹rmcouÁ
 * 
tÙ®_subqs_±r
);

88 
Po¡Li¡
 * 
make_synÚym_po¡li¡
(Po¡Li¡ * 
Ü_¶
, 
MuÉiM©ch
 * 
m©ch”
,

89 
çùÜ
);

95 
Po¡Li¡
 * 
po¡li¡_äom_İ_Ëaf_qu”y
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
,

96 
çùÜ
);

	@matcher/mergepostlist.cc

24 
	~<cÚfig.h
>

25 
	~"muÉim©ch.h
"

26 
	~"em±ypo¡li¡.h
"

27 
	~"m”g•o¡li¡.h
"

28 
	~"b¿nchpo¡li¡.h
"

29 
	~"omas£¹.h
"

30 
	~"omdebug.h
"

31 
	~"v®ue¡»amdocum’t.h
"

32 
	~"x­Ÿn/”rÜhªdËr.h
"

36 
	gM”gePo¡Li¡
::~
	$M”gePo¡Li¡
()

38 
	`DEBUGCALL
(
MATCH
, , "MergePostList::~MergePostList", "");

39 
¡d
::
veùÜ
<
Po¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
;

40 
i
 = 
¶i¡s
.
	`begš
(); i !ğ¶i¡s.
	`’d
(); i++) {

41 
d–‘e
 *
i
;

43 
	}
}

45 
Po¡Li¡
 *

46 
	gM”gePo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

48 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "M”gePo¡Li¡::Ãxt", 
w_mš
);

49 
LOGVALUE
(
MATCH
, 
cu¼’t
);

50 ià(
	gcu¼’t
 =ğ-1è
cu¼’t
 = 0;

51 
	gŒue
) {

54 
	gŒy
 {

55 
Ãxt_hªdlšg_´uÃ
(
¶i¡s
[
cu¼’t
], 
w_mš
, 
m©ch”
);

56 ià(!
	g¶i¡s
[
cu¼’t
]->
©_’d
()) ;

57 ++
	gcu¼’t
;

58 ià((
	gcu¼’t
è>ğ
¶i¡s
.
size
()) ;

59 
	gvsdoc
.
Ãw_subdb
(
cu¼’t
);

60 } 
ÿtch
 (
X­Ÿn
::
E¼Ü
 & 
e
) {

61 ià(
”rÜhªdËr
) {

62 
LOGLINE
(
EXCEPTION
, "Callingƒrror handler in MergePostList::next().");

63 (*
	g”rÜhªdËr
)(
	ge
);

65 
d–‘e
 
	g¶i¡s
[
cu¼’t
];

66 
	g¶i¡s
[
cu¼’t
] = 
Ãw
 
Em±yPo¡Li¡
;

68 
	gthrow
;

71 ià(
	gm©ch”
èm©ch”->
»ÿlc_maxweight
();

73 
LOGVALUE
(
MATCH
, 
cu¼’t
);

74 
RETURN
(
NULL
);

77 
Po¡Li¡
 *

78 
	gM”gePo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

80 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "M”gePo¡Li¡::sk_to", 
did
 << ", " << 
w_mš
);

81 ()
	gdid
;

82 ()
	gw_mš
;

85 
throw
 
	gX­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("MergePostList doesn't support skip_to");

88 
	gX­Ÿn
::
‹rmcouÁ


89 
M”gePo¡Li¡
::
	$g‘_wdf
() const

91 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "MergePostList::get_wdf", "");

92 
	`RETURN
(
¶i¡s
[
cu¼’t
]->
	`g‘_wdf
());

93 
	}
}

95 
	gX­Ÿn
::
doccouÁ


96 
M”gePo¡Li¡
::
	$g‘_‹rmäeq_max
() const

98 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "MergePostList::get_termfreq_max", "");

100 
X­Ÿn
::
doccouÁ
 
tÙ®
 = 0;

101 
veùÜ
<
Po¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
;

102 
i
 = 
¶i¡s
.
	`begš
(); i !ğ¶i¡s.
	`’d
(); i++) {

103 
tÙ®
 +ğ(*
i
)->
	`g‘_‹rmäeq_max
();

105  
tÙ®
;

106 
	}
}

108 
	gX­Ÿn
::
doccouÁ


109 
M”gePo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

111 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "MergePostList::get_termfreq_min", "");

113 
X­Ÿn
::
doccouÁ
 
tÙ®
 = 0;

114 
veùÜ
<
Po¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
;

115 
i
 = 
¶i¡s
.
	`begš
(); i !ğ¶i¡s.
	`’d
(); i++) {

116 
tÙ®
 +ğ(*
i
)->
	`g‘_‹rmäeq_mš
();

118  
tÙ®
;

119 
	}
}

121 
	gX­Ÿn
::
doccouÁ


122 
M”gePo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

124 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "MergePostList::get_termfreq_est", "");

126 
X­Ÿn
::
doccouÁ
 
tÙ®
 = 0;

127 
veùÜ
<
Po¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
;

128 
i
 = 
¶i¡s
.
	`begš
(); i !ğ¶i¡s.
	`’d
(); i++) {

129 
tÙ®
 +ğ(*
i
)->
	`g‘_‹rmäeq_e¡
();

131  
tÙ®
;

132 
	}
}

134 
	gX­Ÿn
::
docid


135 
M”gePo¡Li¡
::
	$g‘_docid
() const

137 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
docid
, "MergePostList::get_docid", "");

138 
	`As£¹
(
cu¼’t
 != -1);

141 
	`RETURN
((
¶i¡s
[
cu¼’t
]->
	`g‘_docid
(è- 1è*…li¡s.
	`size
() + current + 1);

142 
	}
}

144 
	gX­Ÿn
::
weight


145 
M”gePo¡Li¡
::
	$g‘_weight
() const

147 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "MergePostList::get_weight", "");

148 
	`As£¹
(
cu¼’t
 != -1);

149  
¶i¡s
[
cu¼’t
]->
	`g‘_weight
();

150 
	}
}

152 cÚ¡ 
¡ršg
 *

153 
	gM”gePo¡Li¡
::
	$g‘_cŞÏp£_key
() const

155 
	`DEBUGCALL
(
MATCH
, 
¡ršg
 *, "MergePostList::get_collapse_key", "");

156 
	`As£¹
(
cu¼’t
 != -1);

157  
¶i¡s
[
cu¼’t
]->
	`g‘_cŞÏp£_key
();

158 
	}
}

160 
	gX­Ÿn
::
weight


161 
M”gePo¡Li¡
::
	$g‘_maxweight
() const

163 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "MergePostList::get_maxweight", "");

164  
w_max
;

165 
	}
}

167 
	gX­Ÿn
::
weight


168 
M”gePo¡Li¡
::
	$»ÿlc_maxweight
()

170 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "MergePostList::recalc_maxweight", "");

171 
w_max
 = 0;

172 
veùÜ
<
Po¡Li¡
 *>::
™”©Ü
 
i
;

173 
i
 = 
¶i¡s
.
	`begš
(); i !ğ¶i¡s.
	`’d
(); i++) {

174 
Œy
 {

175 
X­Ÿn
::
weight
 
w
 = (*
i
)->
	`»ÿlc_maxweight
();

176 ià(
w
 > 
w_max
) w_max = w;

177 } 
	`ÿtch
 (
X­Ÿn
::
E¼Ü
 & 
e
) {

178 ià(
”rÜhªdËr
) {

179 
	`LOGLINE
(
EXCEPTION
, "Callingƒrror handler in MergePostList::recalc_maxweight().");

180 (*
”rÜhªdËr
)(
e
);

182 ià(
cu¼’t
 =ğ
i
 - 
¶i¡s
.
	`begš
()) {

184 
throw
;

187 
	`d–‘e
 (*
i
);

188 *
i
 = 
Ãw
 
Em±yPo¡Li¡
;

190 
throw
;

194  
w_max
;

195 
	}
}

197 
boŞ


198 
	gM”gePo¡Li¡
::
	$©_’d
() const

200 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "MergePostList::at_end", "");

201 
	`As£¹
(
cu¼’t
 != -1);

202  (
cu¼’t
è>ğ
¶i¡s
.
	`size
();

203 
	}
}

205 
¡ršg


206 
	gM”gePo¡Li¡
::
	$g‘_desütiÚ
() const

208 
¡ršg
 
desc
 = "( Merge ";

209 
veùÜ
<
Po¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
;

210 
i
 = 
¶i¡s
.
	`begš
(); i !ğ¶i¡s.
	`’d
(); i++) {

211 
desc
 +ğ(*
i
)->
	`g‘_desütiÚ
() + " ";

213  
desc
 + ")";

214 
	}
}

216 
	gX­Ÿn
::
‹rmcouÁ


217 
M”gePo¡Li¡
::
	$g‘_doş’gth
() const

219 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "MergePostList::get_doclength", "");

220 
	`As£¹
(
cu¼’t
 != -1);

221  
¶i¡s
[
cu¼’t
]->
	`g‘_doş’gth
();

222 
	}
}

224 
	gX­Ÿn
::
‹rmcouÁ


225 
M”gePo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

227 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "MergePostList::count_matching_subqs", "");

228 
	`RETURN
(
¶i¡s
[
cu¼’t
]->
	`couÁ_m©chšg_subqs
());

229 
	}
}

	@matcher/mergepostlist.h

24 #iâdeà
OM_HGUARD_MERGEPOSTLIST_H


25 
	#OM_HGUARD_MERGEPOSTLIST_H


	)

27 
	~"po¡li¡.h
"

29 
şass
 
	gV®ueSŒ—mDocum’t
;

33 şas 
	cM”gePo¡Li¡
 : 
public
 
Po¡Li¡
 {

34 
´iv©e
:

36 
M”gePo¡Li¡
(const MergePostList &);

37 
	mM”gePo¡Li¡
 & 
	mİ”©Ü
=(cÚ¡ 
M”gePo¡Li¡
 &);

39 
	mX­Ÿn
::
weight
 
w_max
;

41 
	mveùÜ
<
	mPo¡Li¡
 *> 
	m¶i¡s
;

43 
	mcu¼’t
;

50 
MuÉiM©ch
 *
	mm©ch”
;

58 
	mV®ueSŒ—mDocum’t
 & 
	mvsdoc
;

60 
	mX­Ÿn
::
E¼ÜHªdËr
 * 
”rÜhªdËr
;

61 
	mpublic
:

62 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

63 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

64 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

65 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

67 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

68 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

69 cÚ¡ 
¡ršg
 * 
	$g‘_cŞÏp£_key
() const;

71 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

73 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

75 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

76 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

77 
boŞ
 
	$©_’d
() const;

79 
¡ršg
 
	$g‘_desütiÚ
() const;

84 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

86 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

88 
	`M”gePo¡Li¡
(cÚ¡ 
¡d
::
veùÜ
<
Po¡Li¡
 *> & 
¶i¡s_
,

89 
MuÉiM©ch
 *
m©ch”_
,

90 
V®ueSŒ—mDocum’t
 & 
vsdoc_
,

91 
X­Ÿn
::
E¼ÜHªdËr
 * 
”rÜhªdËr_
)

92 : 
	`¶i¡s
(
¶i¡s_
), 
	`cu¼’t
(-1), 
	`m©ch”
(
m©ch”_
), 
	`vsdoc
(
vsdoc_
),

93 
	$”rÜhªdËr
(
”rÜhªdËr_
) { }

95 ~
	`M”gePo¡Li¡
();

96 
	}
};

	@matcher/msetcmp.cc

21 
	~<cÚfig.h
>

22 
	~"m£tcmp.h
"

30 
	g‹m¶©e
<
boŞ
 
	gFORWARD_DID
, boŞ 
	gCHECK_DID_ZERO
> 
šlše
 bool

31 
m£tcmp_by_did
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
a
,

32 cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
b
)

34 ià(
FORWARD_DID
) {

35 ià(
CHECK_DID_ZERO
) {

37 ià(
a
.
did
 =ğ0è 
çl£
;

38 ià(
	gb
.
	gdid
 =ğ0è 
Œue
;

40  (
	ga
.
	gdid
 < 
	gb
.did);

42  (
	ga
.
	gdid
 > 
	gb
.did);

47 
	g‹m¶©e
<
boŞ
 
	gFORWARD_DID
> bool

48 
m£tcmp_by_»Ëvªû
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
a
,

49 cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
b
)

51 ià(
a
.
wt
 > 
b
.wtè 
Œue
;

52 ià(
	ga
.
	gwt
 < 
	gb
.wtè 
	gçl£
;

53  
	gm£tcmp_by_did
<
	gFORWARD_DID
, 
	gŒue
>(
	ga
, 
	gb
);

57 
	g‹m¶©e
<
boŞ
 
	gFORWARD_VALUE
, boŞ 
	gFORWARD_DID
> bool

58 
m£tcmp_by_v®ue
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
a
,

59 cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
b
)

61 ià(!
FORWARD_VALUE
) {

63 ià(
a
.
did
 =ğ0è 
çl£
;

64 ià(
	gb
.
	gdid
 =ğ0è 
Œue
;

66 ià(
	ga
.
	gsÜt_key
 > 
	gb
.sÜt_keyè 
	gFORWARD_VALUE
;

67 ià(
	ga
.
	gsÜt_key
 < 
	gb
.sÜt_keyè !
	gFORWARD_VALUE
;

68  
	gm£tcmp_by_did
<
	gFORWARD_DID
, 
	gFORWARD_VALUE
>(
	ga
, 
	gb
);

72 
	g‹m¶©e
<
boŞ
 
	gFORWARD_VALUE
, boŞ 
	gFORWARD_DID
> bool

73 
m£tcmp_by_v®ue_th’_»Ëvªû
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
a
,

74 cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
b
)

76 ià(!
FORWARD_VALUE
) {

78 ià(
a
.
did
 =ğ0è 
çl£
;

79 ià(
	gb
.
	gdid
 =ğ0è 
Œue
;

81 ià(
	ga
.
	gsÜt_key
 > 
	gb
.sÜt_keyè 
	gFORWARD_VALUE
;

82 ià(
	ga
.
	gsÜt_key
 < 
	gb
.sÜt_keyè !
	gFORWARD_VALUE
;

83 ià(
	ga
.
	gwt
 > 
	gb
.wtè 
	gŒue
;

84 ià(
	ga
.
	gwt
 < 
	gb
.wtè 
	gçl£
;

85  
	gm£tcmp_by_did
<
	gFORWARD_DID
, 
	gFORWARD_VALUE
>(
	ga
, 
	gb
);

89 
	g‹m¶©e
<
boŞ
 
	gFORWARD_VALUE
, boŞ 
	gFORWARD_DID
> bool

90 
m£tcmp_by_»Ëvªû_th’_v®ue
(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
a
,

91 cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
b
)

93 ià(!
FORWARD_VALUE
) {

95 ià(
a
.
did
 =ğ0è 
çl£
;

96 ià(
	gb
.
	gdid
 =ğ0è 
Œue
;

98 ià(
	ga
.
	gwt
 > 
	gb
.wtè 
	gŒue
;

99 ià(
	ga
.
	gwt
 < 
	gb
.wtè 
	gçl£
;

100 ià(
	ga
.
	gsÜt_key
 > 
	gb
.sÜt_keyè 
	gFORWARD_VALUE
;

101 ià(
	ga
.
	gsÜt_key
 < 
	gb
.sÜt_keyè !
	gFORWARD_VALUE
;

102  
	gm£tcmp_by_did
<
	gFORWARD_DID
, 
	gFORWARD_VALUE
>(
	ga
, 
	gb
);

105 
m£t_cmp
 
	gm£t_cmp_bË
[] = {

107 
m£tcmp_by_»Ëvªû
<
çl£
>,

109 
m£tcmp_by_»Ëvªû
<
Œue
>,

112 
m£tcmp_by_v®ue
<
çl£
, false>,

113 
m£tcmp_by_v®ue
<
Œue
, 
çl£
>,

114 
m£tcmp_by_v®ue
<
çl£
, 
Œue
>,

115 
m£tcmp_by_v®ue
<
Œue
,rue>,

117 
m£tcmp_by_v®ue_th’_»Ëvªû
<
çl£
, false>,

118 
m£tcmp_by_v®ue_th’_»Ëvªû
<
Œue
, 
çl£
>,

119 
m£tcmp_by_v®ue_th’_»Ëvªû
<
çl£
, 
Œue
>,

120 
m£tcmp_by_v®ue_th’_»Ëvªû
<
Œue
,rue>,

122 
m£tcmp_by_»Ëvªû_th’_v®ue
<
Œue
,rue>,

123 
m£tcmp_by_»Ëvªû_th’_v®ue
<
çl£
, 
Œue
>,

124 
m£tcmp_by_»Ëvªû_th’_v®ue
<
Œue
, 
çl£
>,

125 
m£tcmp_by_»Ëvªû_th’_v®ue
<
çl£
, false>

128 
m£t_cmp
 
g‘_m£tcmp_funùiÚ
(
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
sÜt_by
, 
boŞ
 
sÜt_fÜw¬d
, boŞ 
sÜt_v®ue_fÜw¬d
) {

129 ià(
	gsÜt_by
 =ğ
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
REL
è
sÜt_v®ue_fÜw¬d
 = 
çl£
;

130  
	gm£t_cmp_bË
[
sÜt_by
 * 4 + 
sÜt_fÜw¬d
 * 2 + 
sÜt_v®ue_fÜw¬d
];

	@matcher/msetcmp.h

22 #iâdeà
XAPIAN_INCLUDED_MSETCMP_H


23 
	#XAPIAN_INCLUDED_MSETCMP_H


	)

25 
	~"om’quœeš‹º®.h
"

28 
	$boŞ
 (* 
	tm£t_cmp
)(cÚ¡ 
	tX­Ÿn
::
	tIÁ”Çl
::
	tMS‘I‹m
 &,

29 cÚ¡ 
	tX­Ÿn
::
	tIÁ”Çl
::
	tMS‘I‹m
 &);

32 
m£t_cmp
 
	`g‘_m£tcmp_funùiÚ
(
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
sÜt_by
, 
boŞ
 
sÜt_fÜw¬d
, boŞ 
sÜt_v®ue_fÜw¬d
);

35 şas 
	cMS‘Cmp
 {

36 
m£t_cmp
 
â
;

37 
public
:

38 
	$MS‘Cmp
(
m£t_cmp
 
â_
è: 
	$â
(
â_
) { }

40 
boŞ
 
	$İ”©Ü
()(cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
a
,

41 cÚ¡ 
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 &
b
) const {

42  
	`â
(
a
, 
b
);

43 
	}
}

	@matcher/msetpostlist.cc

21 
	~<cÚfig.h
>

23 
	~"m£o¡li¡.h
"

24 
	~"omas£¹.h
"

25 
	~"omdebug.h
"

27 
	gX­Ÿn
::
doccouÁ


28 
MS‘Po¡Li¡
::
	$g‘_‹rmäeq_mš
() const

30 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "MSetPostList::get_termfreq_min", "");

31 
	`RETURN
(
m£t_š‹º®
->
m©ches_low”_bound
);

32 
	}
}

34 
	gX­Ÿn
::
doccouÁ


35 
MS‘Po¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

37 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "MSetPostList::get_termfreq_est", "");

38 
	`RETURN
(
m£t_š‹º®
->
m©ches_e¡im©ed
);

39 
	}
}

41 
	gX­Ÿn
::
doccouÁ


42 
MS‘Po¡Li¡
::
	$g‘_‹rmäeq_max
() const

44 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "MSetPostList::get_termfreq_max", "");

45 
	`RETURN
(
m£t_š‹º®
->
m©ches_uµ”_bound
);

46 
	}
}

48 
	gX­Ÿn
::
weight


49 
MS‘Po¡Li¡
::
	$g‘_maxweight
() const

51 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "MSetPostList::get_maxweight", "");

54 ià(
cursÜ
 =ğ-1è
	`RETURN
(
m£t_š‹º®
->
max_possibË
);

58 ià(
deü—sšg_»Ëvªû
) {

60 ià(
	`©_’d
()è
	`RETURN
(0);

61 
	`RETURN
(
m£t_š‹º®
->
™ems
[
cursÜ
].
wt
);

65 
	`RETURN
(
m£t_š‹º®
->
max_©šed
);

66 
	}
}

68 
	gX­Ÿn
::
docid


69 
MS‘Po¡Li¡
::
	$g‘_docid
() const

71 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
docid
, "MSetPostList::get_docid", "");

72 
	`As£¹
(
cursÜ
 != -1);

73 
	`RETURN
(
m£t_š‹º®
->
™ems
[
cursÜ
].
did
);

74 
	}
}

76 
	gX­Ÿn
::
weight


77 
MS‘Po¡Li¡
::
	$g‘_weight
() const

79 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "MSetPostList::get_weight", "");

80 
	`As£¹
(
cursÜ
 != -1);

81 
	`RETURN
(
m£t_š‹º®
->
™ems
[
cursÜ
].
wt
);

82 
	}
}

84 cÚ¡ 
¡ršg
 *

85 
	gMS‘Po¡Li¡
::
	$g‘_cŞÏp£_key
() const

87 
	`DEBUGCALL
(
MATCH
, 
¡ršg
 *, "MSetPostList::get_collapse_key", "");

88 
	`As£¹
(
cursÜ
 != -1);

89 
	`RETURN
(&
m£t_š‹º®
->
™ems
[
cursÜ
].
cŞÏp£_key
);

90 
	}
}

92 
	gX­Ÿn
::
‹rmcouÁ


93 
MS‘Po¡Li¡
::
	$g‘_doş’gth
() const

95 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("MSetPostList::get_doclength() unimplemented");

96 
	}
}

98 
	gX­Ÿn
::
weight


99 
MS‘Po¡Li¡
::
	$»ÿlc_maxweight
()

101 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "MSetPostList::recalc_maxweight", "");

102 
	`RETURN
(
MS‘Po¡Li¡
::
	`g‘_maxweight
());

103 
	}
}

105 
Po¡Li¡
 *

106 
	gMS‘Po¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

108 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "MS‘Po¡Li¡::Ãxt", 
w_mš
);

109 
As£¹
(
cursÜ
 =ğ-1 || !
©_’d
());

110 ++
	gcursÜ
;

111 ià(
	gdeü—sšg_»Ëvªû
) {

115 ià(!
©_’d
(è&& 
	gm£t_š‹º®
->
	g™ems
[
cursÜ
].
	gwt
 < 
	gw_mš
)

116 
	gcursÜ
 = 
m£t_š‹º®
->
™ems
.
size
();

119 !
©_’d
(è&& 
	gm£t_š‹º®
->
	g™ems
[
cursÜ
].
	gwt
 < 
	gw_mš
)

120 ++
	gcursÜ
;

122 
RETURN
(
NULL
);

125 
Po¡Li¡
 *

126 
	gMS‘Po¡Li¡
::
sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
)

131 
throw
 
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
("MSetPostList::skip_to‚ot meaningful");

134 
boŞ


135 
	gMS‘Po¡Li¡
::
	$©_’d
() const

137 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "MSetPostList::at_end", "");

138 
	`As£¹
(
cursÜ
 != -1);

139 
	`RETURN
(
	`size_t
(
cursÜ
è>ğ
m£t_š‹º®
->
™ems
.
	`size
());

140 
	}
}

142 
¡ršg


143 
	gMS‘Po¡Li¡
::
	$g‘_desütiÚ
() const

145 
¡ršg
 
	`desc
("(MSet ");

146 
desc
 +ğ
m£t_š‹º®
->
	`g‘_desütiÚ
();

147 
desc
 += ')';

148  
desc
;

149 
	}
}

	@matcher/msetpostlist.h

21 #iâdeà
XAPIAN_INCLUDED_MSETPOSTLIST_H


22 
	#XAPIAN_INCLUDED_MSETPOSTLIST_H


	)

24 
	~"x­Ÿn/’quœe.h
"

26 
	~"om’quœeš‹º®.h
"

27 
	~"po¡li¡.h
"

35 şas 
	cMS‘Po¡Li¡
 : 
public
 
Po¡Li¡
 {

37 
İ”©Ü
=(cÚ¡ 
MS‘Po¡Li¡
 &);

40 
MS‘Po¡Li¡
(const MSetPostList &);

43 
	mcursÜ
;

46 
	mX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
X­Ÿn
::
MS‘
::IÁ”Çl> 
m£t_š‹º®
;

52 
boŞ
 
	mdeü—sšg_»Ëvªû
;

54 
	mpublic
:

55 
MS‘Po¡Li¡
(cÚ¡ 
X­Ÿn
::
MS‘
 
m£t
, 
boŞ
 
deü—sšg_»Ëvªû_
)

56 : 
cursÜ
(-1), 
m£t_š‹º®
(
m£t
.
š‹º®
),

57 
	$deü—sšg_»Ëvªû
(
deü—sšg_»Ëvªû_
) { }

59 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

61 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

63 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

65 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

67 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

69 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

71 cÚ¡ 
¡ršg
 * 
	$g‘_cŞÏp£_key
() const;

74 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

76 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

78 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

81 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

83 
boŞ
 
	$©_’d
() const;

85 
¡ršg
 
	$g‘_desütiÚ
() const;

86 
	}
};

	@matcher/multiandpostlist.cc

22 
	~<cÚfig.h
>

24 
	~"muÉŸndpo¡li¡.h
"

25 
	~"omas£¹.h
"

26 
	~"debuglog.h
"

29 
	gMuÉiAndPo¡Li¡
::
	$®loÿ‹_¶i¡_ªd_max_wt
()

31 
¶i¡
 = 
Ãw
 
Po¡Li¡
 * [
n_kids
];

32 
Œy
 {

33 
max_wt
 = 
Ãw
 
X­Ÿn
::
weight
 [
n_kids
];

34 } 
	`ÿtch
 (...) {

35 
d–‘e
 [] 
¶i¡
;

36 
¶i¡
 = 
NULL
;

37 
throw
;

39 
	}
}

41 
	gMuÉiAndPo¡Li¡
::~
	$MuÉiAndPo¡Li¡
()

43 ià(
¶i¡
) {

44 
size_t
 
i
 = 0; i < 
n_kids
; ++i) {

45 
d–‘e
 
¶i¡
[
i
];

47 
d–‘e
 [] 
¶i¡
;

49 
d–‘e
 [] 
max_wt
;

50 
	}
}

52 
	gX­Ÿn
::
doccouÁ


53 
MuÉiAndPo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

58 
X­Ÿn
::
doccouÁ
 
sum
 = 
¶i¡
[0]->
	`g‘_‹rmäeq_mš
();

59 ià(
sum
) {

60 
size_t
 
i
 = 1; i < 
n_kids
; ++i) {

61 
X­Ÿn
::
doccouÁ
 
sum_Şd
 = 
sum
;

62 
sum
 +ğ
¶i¡
[
i
]->
	`g‘_‹rmäeq_mš
();

66 ià(
sum
 >ğ
sum_Şd
 && sum <ğ
db_size
) {

70 
sum
 -ğ
db_size
;

72 
	`As£¹R–P¬ªoid
(
sum
,<=,
MuÉiAndPo¡Li¡
::
	`g‘_‹rmäeq_e¡
());

74  
sum
;

75 
	}
}

77 
	gX­Ÿn
::
doccouÁ


78 
MuÉiAndPo¡Li¡
::
	$g‘_‹rmäeq_max
() const

81 
X­Ÿn
::
doccouÁ
 
»suÉ
 = 
¶i¡
[0]->
	`g‘_‹rmäeq_max
();

82 
size_t
 
i
 = 1; i < 
n_kids
; ++i) {

83 
X­Ÿn
::
doccouÁ
 
tf
 = 
¶i¡
[
i
]->
	`g‘_‹rmäeq_max
();

84 ià(
tf
 < 
»suÉ
)„esult =f;

86  
»suÉ
;

87 
	}
}

89 
	gX­Ÿn
::
doccouÁ


90 
MuÉiAndPo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

95 
	`»suÉ
(
¶i¡
[0]->
	`g‘_‹rmäeq_e¡
());

96 
size_t
 
i
 = 1; i < 
n_kids
; ++i) {

97 
»suÉ
 = (»suÉ * 
¶i¡
[
i
]->
	`g‘_‹rmäeq_e¡
()è/ 
db_size
;

99  
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
»suÉ
 + 0.5);

100 
	}
}

102 
T”mF»qs


103 
	gMuÉiAndPo¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

104 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

106 
LOGCALL
(
MATCH
, 
T”mF»qs
,

107 "MuÉiAndPo¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

111 
T”mF»qs
 
äeqs
(
¶i¡
[0]->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

113 
	gäeqe¡
 = (
äeqs
.
‹rmäeq
);

114 
	g»läeqe¡
 = (
äeqs
.
»É”mäeq
);

117 
As£¹
(
¡©s
.
cŞËùiÚ_size
);

119 
size_t
 
	gi
 = 1; i < 
	gn_kids
; ++i) {

120 
	gäeqs
 = 
¶i¡
[
i
]->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
);

124 
	gäeqe¡
 = (
äeqe¡
 * 
äeqs
.
‹rmäeq
è/ 
¡©s
.
cŞËùiÚ_size
;

128 ià(
	g¡©s
.
	gr£t_size
 != 0)

129 
»läeqe¡
 = (»läeqe¡ * 
äeqs
.
»É”mäeq
è/ 
¡©s
.
r£t_size
;

132 
RETURN
(
T”mF»qs
(
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
äeqe¡
 + 0.5),

133 
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
»läeqe¡
 + 0.5)));

136 
	gX­Ÿn
::
weight


137 
MuÉiAndPo¡Li¡
::
	$g‘_maxweight
() const

139  
max_tÙ®
;

140 
	}
}

142 
	gX­Ÿn
::
docid


143 
MuÉiAndPo¡Li¡
::
	$g‘_docid
() const

145  
did
;

146 
	}
}

148 
	gX­Ÿn
::
‹rmcouÁ


149 
MuÉiAndPo¡Li¡
::
	$g‘_doş’gth
() const

151 
	`As£¹
(
did
);

152 
X­Ÿn
::
‹rmcouÁ
 
doş’gth
 = 
¶i¡
[0]->
	`g‘_doş’gth
();

153 
size_t
 
i
 = 1; i < 
n_kids
; ++i) {

154 
	`As£¹Eq
(
doş’gth
, 
¶i¡
[
i
]->
	`g‘_doş’gth
());

156  
doş’gth
;

157 
	}
}

159 
	gX­Ÿn
::
weight


160 
MuÉiAndPo¡Li¡
::
	$g‘_weight
() const

162 
	`As£¹
(
did
);

163 
X­Ÿn
::
weight
 
»suÉ
 = 0;

164 
size_t
 
i
 = 0; i < 
n_kids
; ++i) {

165 
»suÉ
 +ğ
¶i¡
[
i
]->
	`g‘_weight
();

167  
»suÉ
;

168 
	}
}

170 
boŞ


171 
	gMuÉiAndPo¡Li¡
::
	$©_’d
() const

173  (
did
 == 0);

174 
	}
}

176 
	gX­Ÿn
::
weight


177 
MuÉiAndPo¡Li¡
::
	$»ÿlc_maxweight
()

179 
max_tÙ®
 = 0.0;

180 
size_t
 
i
 = 0; i < 
n_kids
; ++i) {

181 
X­Ÿn
::
weight
 
Ãw_max
 = 
¶i¡
[
i
]->
	`»ÿlc_maxweight
();

182 
max_wt
[
i
] = 
Ãw_max
;

183 
max_tÙ®
 +ğ
Ãw_max
;

185  
max_tÙ®
;

186 
	}
}

188 
Po¡Li¡
 *

189 
	gMuÉiAndPo¡Li¡
::
fšd_Ãxt_m©ch
(
X­Ÿn
::
weight
 
w_mš
)

191 
advªûd_¶i¡0
:

192 ià(
¶i¡
[0]->
©_’d
()) {

193 
did
 = 0;

194  
	gNULL
;

196 
	gdid
 = 
¶i¡
[0]->
g‘_docid
();

197 
size_t
 
	gi
 = 1; i < 
	gn_kids
; ++i) {

198 
boŞ
 
	gv®id
;

199 
check_h–³r
(
i
, 
did
, 
w_mš
, 
v®id
);

200 ià(!
	gv®id
) {

201 
Ãxt_h–³r
(0, 
w_mš
);

202 
	gadvªûd_¶i¡0
;

204 ià(
	g¶i¡
[
i
]->
©_’d
()) {

205 
	gdid
 = 0;

206  
	gNULL
;

208 
	gX­Ÿn
::
docid
 
Ãw_did
 = 
¶i¡
[
i
]->
g‘_docid
();

209 ià(
	gÃw_did
 !ğ
did
) {

210 
sk_to_h–³r
(0, 
Ãw_did
, 
w_mš
);

211 
	gadvªûd_¶i¡0
;

214  
	gNULL
;

217 
Po¡Li¡
 *

218 
	gMuÉiAndPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

220 
Ãxt_h–³r
(0, 
w_mš
);

221  
fšd_Ãxt_m©ch
(
w_mš
);

224 
Po¡Li¡
 *

225 
	gMuÉiAndPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did_mš
, X­Ÿn::
weight
 
w_mš
)

227 
sk_to_h–³r
(0, 
did_mš
, 
w_mš
);

228  
fšd_Ãxt_m©ch
(
w_mš
);

231 
	g¡d
::
¡ršg


232 
MuÉiAndPo¡Li¡
::
	$g‘_desütiÚ
() const

234 
¡ršg
 
	`desc
("(");

235 
desc
 +ğ
¶i¡
[0]->
	`g‘_desütiÚ
();

236 
size_t
 
i
 = 1; i < 
n_kids
; ++i) {

237 
desc
 += " AND ";

238 
desc
 +ğ
¶i¡
[
i
]->
	`g‘_desütiÚ
();

240 
desc
 += ')';

241  
desc
;

242 
	}
}

244 
	gX­Ÿn
::
‹rmcouÁ


245 
MuÉiAndPo¡Li¡
::
	$g‘_wdf
() const

247 
X­Ÿn
::
‹rmcouÁ
 
tÙwdf
 = 0;

248 
size_t
 
i
 = 0; i < 
n_kids
; ++i) {

249 
tÙwdf
 +ğ
¶i¡
[
i
]->
	`g‘_wdf
();

251  
tÙwdf
;

252 
	}
}

254 
	gX­Ÿn
::
‹rmcouÁ


255 
MuÉiAndPo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

257 
X­Ÿn
::
‹rmcouÁ
 
tÙ®
 = 0;

258 
size_t
 
i
 = 0; i < 
n_kids
; ++i) {

259 
tÙ®
 +ğ
¶i¡
[
i
]->
	`couÁ_m©chšg_subqs
();

261  
tÙ®
;

262 
	}
}

	@matcher/multiandpostlist.h

22 #iâdeà
XAPIAN_INCLUDED_MULTIANDPOSTLIST_H


23 
	#XAPIAN_INCLUDED_MULTIANDPOSTLIST_H


	)

25 
	~"muÉim©ch.h
"

26 
	~"omas£¹.h
"

27 
	~"po¡li¡.h
"

30 şas 
	cMuÉiAndPo¡Li¡
 : 
public
 
Po¡Li¡
 {

33 
	sCom·»Po¡Li¡T”mF»qAsûndšg
 {

35 
boŞ
 
İ”©Ü
()(cÚ¡ 
Po¡Li¡
 *
a
, cÚ¡ Po¡Li¡ *
	mb
) {

36  
	ma
->
g‘_‹rmäeq_e¡
(è< 
	mb
->get_termfreq_est();

41 
	gİ”©Ü
=(cÚ¡ 
MuÉiAndPo¡Li¡
 &);

44 
MuÉiAndPo¡Li¡
(const MultiAndPostList &);

47 
	gX­Ÿn
::
docid
 
did
;

50 
size_t
 
	gn_kids
;

53 
Po¡Li¡
 ** 
	g¶i¡
;

56 
	gX­Ÿn
::
weight
 * 
max_wt
;

59 
	gX­Ÿn
::
weight
 
max_tÙ®
;

62 
	gX­Ÿn
::
doccouÁ
 
db_size
;

65 
MuÉiM©ch
 *
	gm©ch”
;

68 
	gX­Ÿn
::
weight
 
Ãw_mš
(
X­Ÿn
::weighˆ
w_mš
, 
size_t
 
n
) {

69  
	gw_mš
 - (
	gmax_tÙ®
 - 
	gmax_wt
[
n
]);

73 
Ãxt_h–³r
(
size_t
 
n
, 
X­Ÿn
::
weight
 
w_mš
) {

74 
Po¡Li¡
 * 
»s
 = 
¶i¡
[
n
]->
Ãxt
(
Ãw_mš
(
w_mš
,‚));

75 ià(
	g»s
) {

76 
d–‘e
 
	g¶i¡
[
n
];

77 
	g¶i¡
[
n
] = 
»s
;

78 
	gm©ch”
->
»ÿlc_maxweight
();

83 
sk_to_h–³r
(
size_t
 
n
, 
X­Ÿn
::
docid
 
did_mš
, X­Ÿn::
weight
 
w_mš
) {

84 
Po¡Li¡
 * 
»s
 = 
¶i¡
[
n
]->
sk_to
(
did_mš
, 
Ãw_mš
(
w_mš
,‚));

85 ià(
	g»s
) {

86 
d–‘e
 
	g¶i¡
[
n
];

87 
	g¶i¡
[
n
] = 
»s
;

88 
	gm©ch”
->
»ÿlc_maxweight
();

93 
check_h–³r
(
size_t
 
n
, 
X­Ÿn
::
docid
 
did_mš
, X­Ÿn::
weight
 
w_mš
,

94 
boŞ
 &
v®id
) {

95 
Po¡Li¡
 * 
	g»s
 = 
¶i¡
[
n
]->
check
(
did_mš
, 
Ãw_mš
(
w_mš
,‚), 
v®id
);

96 ià(
	g»s
) {

97 
d–‘e
 
	g¶i¡
[
n
];

98 
	g¶i¡
[
n
] = 
»s
;

99 
	gm©ch”
->
»ÿlc_maxweight
();

107 
®loÿ‹_¶i¡_ªd_max_wt
();

110 
Po¡Li¡
 * 
fšd_Ãxt_m©ch
(
X­Ÿn
::
weight
 
w_mš
);

112 
	gpublic
:

116 
‹m¶©e
 <
şass
 
RªdomItÜ
>

117 
MuÉiAndPo¡Li¡
(
RªdomItÜ
 
¶_begš
, RªdomItÜ 
¶_’d
,

118 
MuÉiM©ch
 * 
m©ch”_
, 
X­Ÿn
::
doccouÁ
 
db_size_
)

119 : 
did
(0), 
n_kids
(
¶_’d
 - 
¶_begš
), 
¶i¡
(
NULL
), 
max_wt
(NULL),

120 
max_tÙ®
(0), 
db_size
(
db_size_
), 
	$m©ch”
(
m©ch”_
)

122 
	`®loÿ‹_¶i¡_ªd_max_wt
();

127 
¡d
::
	`·¹Ÿl_sÜt_cİy
(
¶_begš
, 
¶_’d
, 
¶i¡
,…li¡ + 
n_kids
,

128 
	`Com·»Po¡Li¡T”mF»qAsûndšg
());

129 
	}
}

137 
MuÉiAndPo¡Li¡
(
Po¡Li¡
 *
l
, Po¡Li¡ *
r
,

138 
X­Ÿn
::
weight
 
lmax
, X­Ÿn::weighˆ
rmax
,

139 
MuÉiM©ch
 * 
m©ch”_
, 
X­Ÿn
::
doccouÁ
 
db_size_
,

140 
boŞ
 
check_Üd”
 = 
çl£
)

141 : 
did
(0), 
n_kids
(2), 
¶i¡
(
NULL
), 
max_wt
(NULL),

142 
max_tÙ®
(
lmax
 + 
rmax
), 
db_size
(
db_size_
), 
	$m©ch”
(
m©ch”_
)

144 ià(
check_Üd”
) {

145 ià(
l
->
	`g‘_‹rmäeq_e¡
(è< 
r
->get_termfreq_est()) {

146 
¡d
::
	`sw­
(
l
, 
r
);

147 
¡d
::
	`sw­
(
lmax
, 
rmax
);

150 
	`As£¹R–
(
l
->
	`g‘_‹rmäeq_e¡
(),>=,
r
->get_termfreq_est());

152 
	`®loÿ‹_¶i¡_ªd_max_wt
();

154 
¶i¡
[0] = 
r
;

155 
¶i¡
[1] = 
l
;

156 
max_wt
[0] = 
rmax
;

157 
max_wt
[1] = 
lmax
;

158 
	}
}

160 ~
MuÉiAndPo¡Li¡
();

162 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

164 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

166 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

168 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

169 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

171 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

173 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

175 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

177 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

179 
boŞ
 
	$©_’d
() const;

181 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

183 
IÁ”Çl
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

185 
IÁ”Çl
 *
	`sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
 
w_mš
);

187 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

196 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

198 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

199 
	}
};

	@matcher/multimatch.cc

26 
	~<cÚfig.h
>

28 
	~"muÉim©ch.h
"

30 
	~"cŞÏp£r.h
"

31 
	~"subm©ch.h
"

32 
	~"loÿlm©ch.h
"

33 
	~"omdebug.h
"

34 
	~"om’quœeš‹º®.h
"

36 
	~"em±ypo¡li¡.h
"

37 
	~"b¿nchpo¡li¡.h
"

38 
	~"m”g•o¡li¡.h
"

40 
	~"docum’t.h
"

41 
	~"omqu”yš‹º®.h
"

43 
	~"subm©ch.h
"

45 
	~"m£tcmp.h
"

47 
	~"v®ue¡»amdocum’t.h
"

48 
	~"weightš‹º®.h
"

50 
	~<x­Ÿn/”rÜhªdËr.h
>

51 
	~<x­Ÿn/m©ch¥y.h
>

52 
	~<x­Ÿn/v”siÚ.h
>

54 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


55 
	~"»mÙesubm©ch.h
"

56 
	~"»mÙe-d©aba£.h
"

59 
	~<®gÜ™hm
>

60 
	~<cæßt
>

61 
	~<şim™s
>

62 
	~<veùÜ
>

63 
	~<m­
>

64 
	~<£t
>

66 
usšg
 
Çme¥aû
 
	g¡d
;

68 cÚ¡ 
	gX­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
REL
 =

69 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
REL
;

70 cÚ¡ 
	gX­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
REL_VAL
 =

71 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
REL_VAL
;

72 cÚ¡ 
	gX­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
VAL
 =

73 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
VAL
;

75 cÚ¡ 
	gX­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
VAL_REL
 =

76 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
VAL_REL
;

87 
¥l™_r£t_by_db
(cÚ¡ 
X­Ÿn
::
RS‘
 * 
r£t
,

88 
X­Ÿn
::
doccouÁ
 
numb”_of_subdbs
,

89 
veùÜ
<
X­Ÿn
::
RS‘
> & 
subr£ts
)

91 
DEBUGCALL_STATIC
(
MATCH
, , "split_rset_by_db",

92 (
r£t
 ? *r£ˆ: 
X­Ÿn
::
RS‘
()) <<

93 ", " << 
numb”_of_subdbs
 <<

94 ", [subr£ts(size=" << 
subr£ts
.
size
() << "]");

95 ià(
	gr£t
) {

96 ià(
	gnumb”_of_subdbs
 == 1) {

98 
subr£ts
.
push_back
(*
r£t
);

102 
	gsubr£ts
.
»£rve
(
numb”_of_subdbs
);

103 
size_t
 
	gi
 = 0; i < 
	gnumb”_of_subdbs
; ++i) {

104 
	gsubr£ts
.
push_back
(
X­Ÿn
::
RS‘
());

107 cÚ¡ 
	g£t
<
	gX­Ÿn
::
docid
> & 
r£t™ems
 = 
r£t
->
š‹º®
->
g‘_™ems
();

108 
	g£t
<
	gX­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
j
;

109 
	gj
 = 
r£t™ems
.
begš
(); j !ğr£t™ems.
’d
(); ++j) {

110 
	gX­Ÿn
::
doccouÁ
 
loÿl_docid
 = (*
j
 - 1è/ 
numb”_of_subdbs
 + 1;

111 
	gX­Ÿn
::
doccouÁ
 
subd©aba£
 = (*
j
 - 1è% 
numb”_of_subdbs
;

112 
	gsubr£ts
[
subd©aba£
].
add_docum’t
(
loÿl_docid
);

117 
	gsubr£ts
.
»size
(
numb”_of_subdbs
);

119 
As£¹
(
subr£ts
.
size
(è=ğ
numb”_of_subdbs
);

141 
´•¬e_sub_m©ches
(
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
SubM©ch
> > & 
Ëaves
,

142 
X­Ÿn
::
E¼ÜHªdËr
 * 
”rÜhªdËr
,

143 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
)

145 
DEBUGCALL_STATIC
(
MATCH
, , "prepare_sub_matches",

146 "[Ëaves(size=" << 
Ëaves
.
size
() << ")], " <<

147 
”rÜhªdËr
 << ", " << 
¡©s
);

149 
	gveùÜ
<
	gboŞ
> 
	g´•¬ed
;

150 
	g´•¬ed
.
»size
(
Ëaves
.
size
(), 
çl£
);

151 
size_t
 
	guÅ»·»d
 = 
Ëaves
.
size
();

152 
boŞ
 
	gnowa™
 = 
Œue
;

153 
	guÅ»·»d
) {

154 
size_t
 
	gËaf
 = 0;†—à< 
	gËaves
.
size
(); ++leaf) {

155 ià(
	g´•¬ed
[
Ëaf
]) ;

156 
	gŒy
 {

157 
SubM©ch
 * 
	gsubm©ch
 = 
Ëaves
[
Ëaf
].
g‘
();

158 ià(!
	gsubm©ch
 || subm©ch->
´•¬e_m©ch
(
nowa™
, 
¡©s
)) {

159 
	g´•¬ed
[
Ëaf
] = 
Œue
;

160 --
	guÅ»·»d
;

162 } 
ÿtch
 (
X­Ÿn
::
E¼Ü
 & 
e
) {

163 ià(!
”rÜhªdËr
è
throw
;

165 
LOGLINE
(
EXCEPTION
, "Callingƒrror handler for…repare_match() on‡ SubMatch.");

166 (*
	g”rÜhªdËr
)(
	ge
);

168 
	gËaves
[
Ëaf
] = 
NULL
;

169 
	g´•¬ed
[
Ëaf
] = 
Œue
;

170 --
	guÅ»·»d
;

175 
	gnowa™
 = 
çl£
;

180 şas 
	cMuÉËM©chSpy
 : 
public
 
X­Ÿn
::
M©chSpy
 {

181 
´iv©e
:

183 cÚ¡ 
¡d
::
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
¥›s
;

185 
	mpublic
:

186 
MuÉËM©chSpy
(cÚ¡ 
¡d
::
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
¥›s_
)

187 : 
	$¥›s
(
¥›s_
) {}

193 
	$İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
, X­Ÿn::
weight
 
wt
);

194 
	}
};

197 
	gMuÉËM©chSpy
::
	$İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
, X­Ÿn::
weight
 
wt
) {

198 
	`LOGCALL_VOID
(
MATCH
, "MuÉËM©chSpy::İ”©Ü()", 
doc
 << ", " << 
wt
);

199 
veùÜ
<
X­Ÿn
::
M©chSpy
 *>::
cÚ¡_™”©Ü
 
i
;

200 
i
 = 
¥›s
.
	`begš
(); i !ğ¥›s.
	`’d
(); ++i) {

201 (**
i
)(
doc
, 
wt
);

203 
	}
}

208 
	gMuÉiM©ch
::
MuÉiM©ch
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db_
,

209 cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qu”y_
,

210 
X­Ÿn
::
‹rmcouÁ
 
qËn
,

211 cÚ¡ 
X­Ÿn
::
RS‘
 * 
omr£t
,

212 
X­Ÿn
::
doccouÁ
 
cŞÏp£_max_
,

213 
X­Ÿn
::
v®u’o
 
cŞÏp£_key_
,

214 
³rûÁ_cutoff_
, 
X­Ÿn
::
weight
 
weight_cutoff_
,

215 
X­Ÿn
::
Enquœe
::
docid_Üd”
 
Üd”_
,

216 
X­Ÿn
::
v®u’o
 
sÜt_key_
,

217 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
sÜt_by_
,

218 
boŞ
 
sÜt_v®ue_fÜw¬d_
,

219 
X­Ÿn
::
E¼ÜHªdËr
 * 
”rÜhªdËr_
,

220 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
,

221 cÚ¡ 
X­Ÿn
::
Weight
 * 
weight_
,

222 cÚ¡ 
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s_
,

223 
boŞ
 
have_sÜ‹r
, boŞ 
have_mdecid”
)

224 : 
db
(
db_
), 
qu”y
(
qu”y_
),

225 
cŞÏp£_max
(
cŞÏp£_max_
), 
cŞÏp£_key
(
cŞÏp£_key_
),

226 
³rûÁ_cutoff
(
³rûÁ_cutoff_
), 
weight_cutoff
(
weight_cutoff_
),

227 
Üd”
(
Üd”_
),

228 
sÜt_key
(
sÜt_key_
), 
sÜt_by
(
sÜt_by_
),

229 
sÜt_v®ue_fÜw¬d
(
sÜt_v®ue_fÜw¬d_
),

230 
”rÜhªdËr
(
”rÜhªdËr_
), 
weight
(
weight_
),

231 
is_»mÙe
(
db
.
š‹º®
.
size
()),

232 
	$m©ch¥›s
(
m©ch¥›s_
)

234 
	`DEBUGCALL
(
MATCH
, , "MuÉiM©ch", 
db_
 << ", " << 
qu”y_
 << ", " <<

235 
qËn
 << ", " << (
omr£t
 ? *omr£ˆ: 
X­Ÿn
::
	`RS‘
()) << ", " <<

236 
cŞÏp£_max_
 << ", " << 
cŞÏp£_key_
 << ", " <<

237 
³rûÁ_cutoff_
 << ", " << 
weight_cutoff_
 << ", " <<

238 (
Üd”_
è<< ", " << 
sÜt_key_
 << ", " <<

239 (
sÜt_by_
è<< ", " << 
sÜt_v®ue_fÜw¬d_
 << ", " <<

240 
”rÜhªdËr_
 << ", " << 
¡©s
 << ", [weight_], "

241 "[m©ch¥›s_], " << 
have_sÜ‹r
 << ", " << 
have_mdecid”
);

243 ià(!
qu”y
) ;

244 
qu”y
->
	`v®id©e_qu”y
();

246 
X­Ÿn
::
doccouÁ
 
numb”_of_subdbs
 = 
db
.
š‹º®
.
	`size
();

247 
veùÜ
<
X­Ÿn
::
RS‘
> 
subr£ts
;

248 
	`¥l™_r£t_by_db
(
omr£t
, 
numb”_of_subdbs
, 
subr£ts
);

250 
size_t
 
i
 = 0; i !ğ
numb”_of_subdbs
; ++i) {

251 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
subdb
 = 
db
.
š‹º®
[
i
].
	`g‘
();

252 
	`As£¹
(
subdb
);

253 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
SubM©ch
> 
sm©ch
;

254 
Œy
 {

256 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


257 
RemÙeD©aba£
 *
»m_db
 = 
subdb
->
	`as_»mÙed©aba£
();

258 ià(
»m_db
) {

259 ià(
have_sÜ‹r
) {

260 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Xapian::KeyMaker‚ot supported forhe„emote backend");

262 ià(
have_mdecid”
) {

263 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Xapian::MatchDecider‚ot supported forhe„emote backend");

265 
»m_db
->
	`£t_qu”y
(
qu”y
, 
qËn
, 
cŞÏp£_max
, 
cŞÏp£_key
,

266 
Üd”
, 
sÜt_key
, 
sÜt_by
, 
sÜt_v®ue_fÜw¬d
,

267 
³rûÁ_cutoff
, 
weight_cutoff
, 
weight
,

268 
subr£ts
[
i
], 
m©ch¥›s
);

269 
boŞ
 
deü—sšg_»Ëvªû
 =

270 (
sÜt_by
 =ğ
REL
 || sÜt_by =ğ
REL_VAL
);

271 
sm©ch
 = 
Ãw
 
	`RemÙeSubM©ch
(
»m_db
, 
deü—sšg_»Ëvªû
, 
m©ch¥›s
);

272 
is_»mÙe
[
i
] = 
Œue
;

275 
sm©ch
 = 
Ãw
 
	`LoÿlSubM©ch
(
subdb
, 
qu”y
, 
qËn
, 
subr£ts
[
i
], 
weight
);

276 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


279 } 
	`ÿtch
 (
X­Ÿn
::
E¼Ü
 & 
e
) {

280 ià(!
”rÜhªdËr
è
throw
;

281 
	`LOGLINE
(
EXCEPTION
, "Callingƒrror handler for creation of‡ SubMatch from‡ database‡nd query.");

282 (*
”rÜhªdËr
)(
e
);

284 
sm©ch
 = 
NULL
;

286 
Ëaves
.
	`push_back
(
sm©ch
);

289 
	`´•¬e_sub_m©ches
(
Ëaves
, 
”rÜhªdËr
, 
¡©s
);

290 
¡©s
.
	`£t_bounds_äom_db
(
db
);

291 
	}
}

293 
	gX­Ÿn
::
weight


294 
MuÉiM©ch
::
	$g‘Ü»ÿlc_maxweight
(
Po¡Li¡
 *
¶
)

296 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "MuÉiM©ch::g‘Ü»ÿlc_maxweight", 
¶
);

297 
X­Ÿn
::
weight
 
wt
;

298 ià(
»ÿlcuÏ‹_w_max
) {

299 
	`LOGLINE
(
MATCH
, "recalculating max weight");

300 
wt
 = 
¶
->
	`»ÿlc_maxweight
();

301 
»ÿlcuÏ‹_w_max
 = 
çl£
;

303 
wt
 = 
¶
->
	`g‘_maxweight
();

304 
	`As£¹EqDoubËP¬ªoid
(
wt
, 
¶
->
	`»ÿlc_maxweight
());

306 
	`LOGLINE
(
MATCH
, "max…ossibË doøweighˆğ" << 
wt
);

307 
	`RETURN
(
wt
);

308 
	}
}

311 
	gMuÉiM©ch
::
g‘_m£t
(
X­Ÿn
::
doccouÁ
 
fœ¡
, X­Ÿn::doccouÁ 
max™ems
,

312 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

313 
X­Ÿn
::
MS‘
 & 
m£t
,

314 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
,

315 cÚ¡ 
X­Ÿn
::
M©chDecid”
 *
mdecid”
,

316 cÚ¡ 
X­Ÿn
::
M©chDecid”
 *
m©ch¥y_Ëgacy
,

317 cÚ¡ 
X­Ÿn
::
KeyMak”
 *
sÜ‹r
)

319 
DEBUGCALL
(
MATCH
, , "MuÉiM©ch::g‘_m£t", 
fœ¡
 << ", " << 
max™ems


320 << ", " << 
check_©_Ëa¡
 << ", ...");

321 ià(
	gcheck_©_Ëa¡
 < 
	gmax™ems
ècheck_©_Ëa¡ = 
max™ems
;

323 ià(!
	gqu”y
) {

324 
	gm£t
 = 
X­Ÿn
::
MS‘
();

328 
As£¹
(!
Ëaves
.
em±y
());

330 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


333 ià(
	gËaves
.
size
(è=ğ1 && 
is_»mÙe
[0]) {

334 
RemÙeSubM©ch
 * 
»m_m©ch
;

335 
	g»m_m©ch
 = 
¡©ic_ÿ¡
<
RemÙeSubM©ch
*>(
Ëaves
[0].
g‘
());

336 
	g»m_m©ch
->
¡¬t_m©ch
(
fœ¡
, 
max™ems
, 
check_©_Ëa¡
, 
¡©s
);

337 
	g»m_m©ch
->
g‘_m£t
(
m£t
);

344 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
SubM©ch
> >::
™”©Ü
 
Ëaf
;

345 
	gËaf
 = 
Ëaves
.
begš
();†—à!ğËaves.
’d
(); ++leaf) {

346 ià(!(*
	gËaf
).
g‘
()) ;

347 
	gŒy
 {

348 (*
	gËaf
)->
¡¬t_m©ch
(0, 
fœ¡
 + 
max™ems
,

349 
fœ¡
 + 
check_©_Ëa¡
, 
¡©s
);

350 } 
ÿtch
 (
X­Ÿn
::
E¼Ü
 & 
e
) {

351 ià(!
”rÜhªdËr
è
throw
;

352 
LOGLINE
(
EXCEPTION
, "Callingƒrror handler for "

354 (*
	g”rÜhªdËr
)(
	ge
);

356 *
	gËaf
 = 
NULL
;

362 
	gveùÜ
<
	gPo¡Li¡
 *> 
	gpo¡li¡s
;

363 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> 
‹rmäeqªdwts
;

364 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> * 
‹rmäeqªdwts_±r
;

365 
	g‹rmäeqªdwts_±r
 = &
‹rmäeqªdwts
;

367 
	gX­Ÿn
::
‹rmcouÁ
 
tÙ®_subqs
 = 0;

372 
	gX­Ÿn
::
doccouÁ
 
defš™e_m©ches_nÙ_£’
 = 0;

373 
size_t
 
	gi
 = 0; i !ğ
Ëaves
.
size
(); ++i) {

374 
Po¡Li¡
 *
	g¶
;

375 
	gŒy
 {

376 
	g¶
 = 
Ëaves
[
i
]->
g‘_po¡li¡_ªd_‹rm_šfo
(
this
,

377 
‹rmäeqªdwts_±r
,

378 &
tÙ®_subqs
);

379 ià(
	g‹rmäeqªdwts_±r
 && !
	g‹rmäeqªdwts
.
em±y
())

380 
	g‹rmäeqªdwts_±r
 = 
NULL
;

381 ià(
	gis_»mÙe
[
i
]) {

382 ià(
	g¶
->
g‘_‹rmäeq_mš
(è> 
	gfœ¡
 + 
	gmax™ems
) {

383 
LOGLINE
(
MATCH
, "Found " <<

384 
¶
->
g‘_‹rmäeq_mš
(è- (
fœ¡
 + 
max™ems
)

387 
	gdefš™e_m©ches_nÙ_£’
 +ğ
¶
->
g‘_‹rmäeq_mš
();

388 
	gdefš™e_m©ches_nÙ_£’
 -ğ
fœ¡
 + 
max™ems
;

391 } 
ÿtch
 (
X­Ÿn
::
E¼Ü
 & 
e
) {

392 ià(!
”rÜhªdËr
è
throw
;

393 
LOGLINE
(
EXCEPTION
, "Callingƒrror handler for "

395 (*
	g”rÜhªdËr
)(
	ge
);

398 
	gËaves
[
i
] = 
NULL
;

399 
	g¶
 = 
Ãw
 
Em±yPo¡Li¡
;

401 
	gpo¡li¡s
.
push_back
(
¶
);

403 
As£¹
(!
po¡li¡s
.
em±y
());

405 
V®ueSŒ—mDocum’t
 
vsdoc
(
db
);

406 ++
	gvsdoc
.
	g»f_couÁ
;

407 
	gX­Ÿn
::
Docum’t
 
doc
(&
vsdoc
);

410 
Po¡Li¡
 *
	g¶
;

411 ià(
	gpo¡li¡s
.
size
() == 1) {

412 
¶
 = 
po¡li¡s
.
äÚt
();

414 
	g¶
 = 
Ãw
 
M”gePo¡Li¡
(
po¡li¡s
, 
this
, 
vsdoc
, 
”rÜhªdËr
);

417 
LOGLINE
(
MATCH
, "¶ = (" << 
¶
->
g‘_desütiÚ
() << ")");

419 #ifdeà
XAPIAN_DEBUG_LOG


421 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
>::
cÚ¡_™”©Ü
 
tfwi
;

422 
	gtfwi
 = 
‹rmäeqªdwts
.
begš
();fw˜!ğ‹rmäeqªdwts.
’d
(); ++tfwi) {

423 
LOGLINE
(
MATCH
, "‹rmäeqªdwts[" << 
tfwi
->
fœ¡
 << "] = " <<fwi->
£cÚd
.
‹rmäeq
 << ", " <<fwi->£cÚd.
‹rmweight
);

429 
	gX­Ÿn
::
doccouÁ
 
docs_m©ched
 = 0;

430 
	gX­Ÿn
::
weight
 
g»©e¡_wt
 = 0;

431 
	gX­Ÿn
::
‹rmcouÁ
 
g»©e¡_wt_subqs_m©ched
 = 0;

432 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


433 
	gg»©e¡_wt_subqs_db_num
 = 
UINT_MAX
;

435 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
> 
™ems
;

438 cÚ¡ 
	gX­Ÿn
::
weight
 
max_possibË
 = 
¶
->
»ÿlc_maxweight
();

440 
LOGLINE
(
MATCH
, "¶ = (" << 
¶
->
g‘_desütiÚ
() << ")");

441 
	g»ÿlcuÏ‹_w_max
 = 
çl£
;

443 
	gX­Ÿn
::
doccouÁ
 
m©ches_uµ”_bound
 = 
¶
->
g‘_‹rmäeq_max
();

444 
	gX­Ÿn
::
doccouÁ
 
m©ches_low”_bound
 = 0;

445 
	gX­Ÿn
::
doccouÁ
 
m©ches_e¡im©ed
 = 
¶
->
g‘_‹rmäeq_e¡
();

447 ià(
	gmdecid”
 =ğ
NULL
 && 
m©ch¥y_Ëgacy
 == NULL) {

451 
m©ches_low”_bound
 = 
¶
->
g‘_‹rmäeq_mš
();

455 
	gX­Ÿn
::
M©chSpy
 *
m©ch¥y
 = 
NULL
;

456 
MuÉËM©chSpy
 
muÉi¥y
(
m©ch¥›s
);

457 ià(!
	gm©ch¥›s
.
em±y
()) {

458 ià(
	gm©ch¥›s
.
size
() == 1) {

459 
m©ch¥y
 = 
m©ch¥›s
[0];

461 
	gm©ch¥y
 = &
muÉi¥y
;

467 ià(
	gcheck_©_Ëa¡
 == 0) {

468 
d–‘e
 
¶
;

469 
	gX­Ÿn
::
doccouÁ
 
uncŞÏp£d_low”_bound
 = 
m©ches_low”_bound
;

470 ià(
	gcŞÏp£_max
) {

474 ià(
	gm©ches_low”_bound
 > 
	gcŞÏp£_max
)

475 
	gm©ches_low”_bound
 = 
cŞÏp£_max
;

478 
	gm£t
 = 
X­Ÿn
::
MS‘
(
Ãw
 X­Ÿn::MS‘::
IÁ”Çl
(

479 
fœ¡
,

480 
m©ches_uµ”_bound
,

481 
m©ches_low”_bound
,

482 
m©ches_e¡im©ed
,

483 
m©ches_uµ”_bound
,

484 
uncŞÏp£d_low”_bound
,

485 
m©ches_e¡im©ed
,

486 
max_possibË
, 
g»©e¡_wt
, 
™ems
,

487 
‹rmäeqªdwts
,

493 
	gX­Ÿn
::
doccouÁ
 
decid”_cÚsid”ed
 = 0;

495 
	gX­Ÿn
::
doccouÁ
 
decid”_d’›d
 = 0;

499 
	gX­Ÿn
::
doccouÁ
 
max_msize
 = 
fœ¡
 + 
max™ems
;

500 
	g™ems
.
»£rve
(
max_msize
 + 1);

504 
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 
mš_™em
(0.0, 0);

507 
	gX­Ÿn
::
weight
 
mš_weight
 = 
weight_cutoff
;

510 
	gX­Ÿn
::
weight
 
³rûÁ_cutoff_çùÜ
 = 
³rûÁ_cutoff
 / 100.0;

513 
	g³rûÁ_cutoff_çùÜ
 -ğ
DBL_EPSILON
;

516 
CŞÏp£r
 
cŞÏp£r
(
cŞÏp£_key
, 
cŞÏp£_max
);

519 
boŞ
 
	gsÜt_fÜw¬d
 = (
Üd”
 !ğ
X­Ÿn
::
Enquœe
::
DESCENDING
);

520 
MS‘Cmp
 
mcmp
(
g‘_m£tcmp_funùiÚ
(
sÜt_by
, 
sÜt_fÜw¬d
, 
sÜt_v®ue_fÜw¬d
));

535 
boŞ
 
	gis_h—p
 = 
çl£
;

537 
	gŒue
) {

538 
boŞ
 
	gpushback
;

540 ià(
¿»
(
»ÿlcuÏ‹_w_max
)) {

541 ià(
	gmš_weight
 > 0.0) {

542 ià(
¿»
(
g‘Ü»ÿlc_maxweight
(
¶
è< 
mš_weight
)) {

543 
LOGLINE
(
MATCH
, "*** TERMINATING EARLY (1)");

549 ià(
¿»
(
Ãxt_hªdlšg_´uÃ
(
¶
, 
mš_weight
, 
this
))) {

550 
LOGLINE
(
MATCH
, "*** REPLACING ROOT");

552 ià(
	gmš_weight
 > 0.0) {

556 ià(
¿»
(
g‘Ü»ÿlc_maxweight
(
¶
è< 
mš_weight
)) {

557 
LOGLINE
(
MATCH
, "*** TERMINATING EARLY (2)");

563 ià(
¿»
(
¶
->
©_’d
())) {

564 
LOGLINE
(
MATCH
, "Reachedƒnd of…otential matches");

571 
	gX­Ÿn
::
weight
 
wt
 = 0.0;

572 
boŞ
 
	gÿlcuÏ‹d_weight
 = 
çl£
;

573 ià(
	gsÜt_by
 !ğ
VAL
 || 
mš_weight
 > 0.0) {

574 
wt
 = 
¶
->
g‘_weight
();

575 ià(
	gwt
 < 
	gmš_weight
) {

576 
LOGLINE
(
MATCH
, "Rejecting…otential match dueo insufficient weight");

579 
	gÿlcuÏ‹d_weight
 = 
Œue
;

582 
	gX­Ÿn
::
docid
 
did
 = 
¶
->
g‘_docid
();

583 
	gvsdoc
.
£t_docum’t
(
did
);

584 
LOGLINE
(
MATCH
, "Cªdid©docum’ˆid " << 
did
 << " wˆ" << 
wt
);

585 
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 
Ãw_™em
(
wt
, 
did
);

586 ià(
	gsÜt_by
 !ğ
REL
) {

587 ià(
sÜ‹r
) {

588 
Ãw_™em
.
sÜt_key
 = (*
sÜ‹r
)(
doc
);

590 
	gÃw_™em
.
	gsÜt_key
 = 
vsdoc
.
g‘_v®ue
(
sÜt_key
);

597 ià(!
mcmp
(
Ãw_™em
, 
mš_™em
)) {

598 ià(
	gmdecid”
 =ğ
NULL
 && !
cŞÏp£r
 && 
m©ch¥y_Ëgacy
 == NULL) {

601 
LOGLINE
(
MATCH
, "Making‚ote of match item which sorts†owerhan min_item");

602 ++
	gdocs_m©ched
;

603 ià(!
	gÿlcuÏ‹d_weight
è
	gwt
 = 
¶
->
g‘_weight
();

604 ià(
	gm©ch¥y
) {

605 
	gm©ch¥y
->
İ”©Ü
()(
	gdoc
, 
	gwt
);

607 ià(
	gwt
 > 
	gg»©e¡_wt
è
	gÃw_g»©e¡_weight
;

610 ià(
	gdocs_m©ched
 >ğ
check_©_Ëa¡
) {

612 
LOGLINE
(
MATCH
, "Dropping candidate which sorts†owerhan min_item");

614 ià(!
	gÿlcuÏ‹d_weight
è
	gwt
 = 
¶
->
g‘_weight
();

615 ià(
	gwt
 > 
	gg»©e¡_wt
è
	gÃw_g»©e¡_weight
;

621 
LOGLINE
(
MATCH
, "Keeping candidate which sorts†owerhan min_item for further investigation");

626 ià(
	gm©ch¥y
 !ğ
NULL
 || 
mdecid”
 !ğNULL || 
m©ch¥y_Ëgacy
 != NULL) {

627 cÚ¡ 
muÉl›r
 = 
db
.
š‹º®
.
size
();

628 
As£¹
(
muÉl›r
 != 0);

629 
	gX­Ÿn
::
doccouÁ
 
n
 = (
did
 - 1è% 
muÉl›r
;

632 ià(!
	gis_»mÙe
[
n
]) {

633 ++
	gdecid”_cÚsid”ed
;

634 ià(
	gm©ch¥y_Ëgacy
 && !m©ch¥y_Ëgacy->
İ”©Ü
()(
	gdoc
)) {

635 ++
	gdecid”_d’›d
;

638 ià(
	gmdecid”
 && !mdecid”->
İ”©Ü
()(
	gdoc
)) {

639 ++
	gdecid”_d’›d
;

642 ià(
	gm©ch¥y
) {

643 ià(!
	gÿlcuÏ‹d_weight
) {

644 
	gwt
 = 
¶
->
g‘_weight
();

645 
	gÃw_™em
.
	gwt
 = 
wt
;

646 
	gÿlcuÏ‹d_weight
 = 
Œue
;

648 
	gm©ch¥y
->
İ”©Ü
()(
	gdoc
, 
	gwt
);

653 ià(!
	gÿlcuÏ‹d_weight
) {

655 
	gwt
 = 
¶
->
g‘_weight
();

656 
	gÃw_™em
.
	gwt
 = 
wt
;

659 
	gpushback
 = 
Œue
;

662 ià(
	gcŞÏp£r
) {

663 
cŞÏp£_»suÉ
 
	g»s
;

664 
	g»s
 = 
cŞÏp£r
.
´oûss
(
Ãw_™em
, 
¶
, 
vsdoc
, 
mcmp
);

665 ià(
	g»s
 =ğ
REJECTED
) {

668 ià(
sÜt_by
 !ğ
REL
 && sÜt_by !ğ
REL_VAL
) {

669 ià(
wt
 > 
g»©e¡_wt
è
Ãw_g»©e¡_weight
;

674 ià(
	g»s
 =ğ
REPLACED
) {

677 
As£¹
(!
™ems
.
em±y
());

679 cÚ¡ 
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
 & 
Şd_™em
 =

680 
cŞÏp£r
.
Şd_™em
;

686 
	gX­Ÿn
::
weight
 
Şd_wt
 = 
Şd_™em
.
wt
;

687 ià(
	gŞd_wt
 >ğ
mš_weight
 && 
mcmp
(
Şd_™em
, 
mš_™em
)) {

690 
	gX­Ÿn
::
docid
 
Şddid
 = 
Şd_™em
.
did
;

691 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
™”©Ü
 
i
;

692 
	gi
 = 
™ems
.
begš
(); i !ğ™ems.
’d
(); ++i) {

693 ià(
	gi
->
	gdid
 =ğ
Şddid
) {

694 
LOGLINE
(
MATCH
, "collapse:„emoving " <<

695 
Şddid
 << ": " <<

696 
Ãw_™em
.
cŞÏp£_key
);

702 *
	gi
 = 
Ãw_™em
;

703 
	gpushback
 = 
çl£
;

704 
	gis_h—p
 = 
çl£
;

713 ià(
	gpushback
) {

714 ++
	gdocs_m©ched
;

715 ià(
	g™ems
.
size
(è>ğ
max_msize
) {

716 
™ems
.
push_back
(
Ãw_™em
);

717 ià(!
	gis_h—p
) {

718 
	gis_h—p
 = 
Œue
;

719 
make_h—p
(
™ems
.
begš
(), i‹ms.
’d
(), 
mcmp
);

721 
	gpush_h—p
<
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
™”©Ü
,

722 
	gMS‘Cmp
>(
	g™ems
.
begš
(), i‹ms.
’d
(), 
	gmcmp
);

724 
	gpİ_h—p
<
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
™”©Ü
,

725 
	gMS‘Cmp
>(
	g™ems
.
begš
(), i‹ms.
’d
(), 
	gmcmp
);

726 
	g™ems
.
pİ_back
();

728 
	gmš_™em
 = 
™ems
.
äÚt
();

729 ià(
	gsÜt_by
 =ğ
REL
 || 
sÜt_by
 =ğ
REL_VAL
) {

730 ià(
docs_m©ched
 >ğ
check_©_Ëa¡
) {

731 ià(
sÜt_by
 =ğ
REL
) {

735 ià(
¿»
(
max_possibË
 =ğ0 && 
sÜt_fÜw¬d
)) {

741 ià(
Ëaves
.
size
() == 1) ;

744 ià(
	gmš_™em
.
	gwt
 > 
	gmš_weight
) {

745 
LOGLINE
(
MATCH
, "Setting min_weighto " <<

746 
mš_™em
.
wt
 << " from " << 
mš_weight
);

747 
	gmš_weight
 = 
mš_™em
.
wt
;

751 ià(
¿»
(
g‘Ü»ÿlc_maxweight
(
¶
è< 
mš_weight
)) {

752 
LOGLINE
(
MATCH
, "*** TERMINATING EARLY (3)");

756 
	g™ems
.
push_back
(
Ãw_™em
);

757 
	gis_h—p
 = 
çl£
;

758 ià(
	gsÜt_by
 =ğ
REL
 && 
™ems
.
size
(è=ğ
max_msize
) {

759 ià(
docs_m©ched
 >ğ
check_©_Ëa¡
) {

763 ià(
¿»
(
max_possibË
 =ğ0 && 
sÜt_fÜw¬d
)) {

769 ià(
Ëaves
.
size
() == 1) ;

777 ià(
	gwt
 > 
	gg»©e¡_wt
) {

778 
	gÃw_g»©e¡_weight
:

779 
g»©e¡_wt
 = 
wt
;

780 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


781 cÚ¡ 
	gmuÉl›r
 = 
db
.
š‹º®
.
size
();

782 
	gdb_num
 = (
did
 - 1è% 
muÉl›r
;

783 ià(
	gis_»mÙe
[
db_num
]) {

786 
	gg»©e¡_wt_subqs_db_num
 = 
db_num
;

790 
	gg»©e¡_wt_subqs_m©ched
 = 
¶
->
couÁ_m©chšg_subqs
();

791 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


792 
	gg»©e¡_wt_subqs_db_num
 = 
UINT_MAX
;

795 ià(
	g³rûÁ_cutoff
) {

796 
	gX­Ÿn
::
weight
 
w
 = 
wt
 * 
³rûÁ_cutoff_çùÜ
;

797 ià(
	gw
 > 
	gmš_weight
) {

798 
	gmš_weight
 = 
w
;

799 ià(!
	gis_h—p
) {

800 
	gis_h—p
 = 
Œue
;

801 
	gmake_h—p
<
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
™”©Ü
,

802 
	gMS‘Cmp
>(
	g™ems
.
begš
(), i‹ms.
’d
(), 
	gmcmp
);

804 !
	g™ems
.
em±y
(è&& i‹ms.
äÚt
().
	gwt
 < 
	gmš_weight
) {

805 
	gpİ_h—p
<
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
™”©Ü
,

806 
	gMS‘Cmp
>(
	g™ems
.
begš
(), i‹ms.
’d
(), 
	gmcmp
);

807 
As£¹
(
™ems
.
back
().
wt
 < 
mš_weight
);

808 
	g™ems
.
pİ_back
();

810 #ifdeà
XAPIAN_ASSERTIONS_PARANOID


811 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
cÚ¡_™”©Ü
 
i
;

812 
	gi
 = 
™ems
.
begš
(); i !ğ™ems.
’d
(); ++i) {

813 
As£¹
(
i
->
wt
 >ğ
mš_weight
);

822 
d–‘e
 
	g¶
;

824 
	g³rûÁ_sÿË
 = 0;

825 ià(!
	g™ems
.
em±y
(è&& 
	gg»©e¡_wt
 > 0) {

828 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
cÚ¡_™”©Ü
 
be¡
;

829 
	gbe¡
 = 
mš_–em’t
(
™ems
.
begš
(), i‹ms.
’d
(), 
mcmp
);

831 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


832 ià(
	gg»©e¡_wt_subqs_db_num
 !ğ
UINT_MAX
) {

833 cÚ¡ 
n
 = 
g»©e¡_wt_subqs_db_num
;

834 
RemÙeSubM©ch
 * 
	g»m_m©ch
;

835 
	g»m_m©ch
 = 
¡©ic_ÿ¡
<
RemÙeSubM©ch
*>(
Ëaves
[
n
].
g‘
());

836 
	g³rûÁ_sÿË
 = 
»m_m©ch
->
g‘_³rûÁ_çùÜ
() / 100.0;

840 
	g³rûÁ_sÿË
 = 
g»©e¡_wt_subqs_m©ched
 / (
tÙ®_subqs
);

841 
	g³rûÁ_sÿË
 /ğ
g»©e¡_wt
;

843 
As£¹
(
³rûÁ_sÿË
 > 0);

844 ià(
	g³rûÁ_cutoff
) {

849 
	gX­Ÿn
::
weight
 
mš_wt
 = 
³rûÁ_cutoff_çùÜ
 / 
³rûÁ_sÿË
;

850 ià(!
	gis_h—p
) {

851 
	gis_h—p
 = 
Œue
;

852 
	gmake_h—p
<
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
™”©Ü
,

853 
	gMS‘Cmp
>(
	g™ems
.
begš
(), i‹ms.
’d
(), 
	gmcmp
);

855 !
	g™ems
.
em±y
(è&& i‹ms.
äÚt
().
	gwt
 < 
	gmš_wt
) {

856 
	gpİ_h—p
<
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
™”©Ü
,

857 
	gMS‘Cmp
>(
	g™ems
.
begš
(), i‹ms.
’d
(), 
	gmcmp
);

858 
As£¹
(
™ems
.
back
().
wt
 < 
mš_wt
);

859 
	g™ems
.
pİ_back
();

861 #ifdeà
XAPIAN_ASSERTIONS_PARANOID


862 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
cÚ¡_™”©Ü
 
j
;

863 
	gj
 = 
™ems
.
begš
(); j !ğ™ems.
’d
(); ++j) {

864 
As£¹
(
j
->
wt
 >ğ
mš_wt
);

868 
	g³rûÁ_sÿË
 *= 100.0;

871 
LOGLINE
(
MATCH
,

872 "docs_m©ched = " << 
docs_m©ched
 <<

873 ", defš™e_m©ches_nÙ_£’ = " << 
defš™e_m©ches_nÙ_£’
 <<

874 ", m©ches_low”_bound = " << 
m©ches_low”_bound
 <<

875 ", m©ches_e¡im©ed = " << 
m©ches_e¡im©ed
 <<

876 ", m©ches_uµ”_bound = " << 
m©ches_uµ”_bound
);

880 
	gdocs_m©ched
 +ğ
defš™e_m©ches_nÙ_£’
;

882 
	gX­Ÿn
::
doccouÁ
 
uncŞÏp£d_low”_bound
 = 
m©ches_low”_bound
;

883 
	gX­Ÿn
::
doccouÁ
 
uncŞÏp£d_uµ”_bound
 = 
m©ches_uµ”_bound
;

884 
	gX­Ÿn
::
doccouÁ
 
uncŞÏp£d_e¡im©ed
 = 
m©ches_e¡im©ed
;

885 ià(
	g™ems
.
size
(è< 
	gmax_msize
) {

888 
LOGLINE
(
MATCH
, "™ems.size(èğ" << 
™ems
.
size
() <<

889 ", max_msizğ" << 
max_msize
 << ", setting boundsƒqual");

890 
As£¹
(
defš™e_m©ches_nÙ_£’
 == 0);

891 
As£¹
(
³rûÁ_cutoff
 || 
docs_m©ched
 =ğ
™ems
.
size
());

892 
	gm©ches_low”_bound
 = 
m©ches_uµ”_bound
 = 
m©ches_e¡im©ed


893 ğ
™ems
.
size
();

894 ià(
	gcŞÏp£r
 && 
	gm©ches_low”_bound
 > 
	guncŞÏp£d_low”_bound
)

895 
	guncŞÏp£d_low”_bound
 = 
m©ches_low”_bound
;

896 } ià(
	gdocs_m©ched
 < 
	gcheck_©_Ëa¡
) {

899 
LOGLINE
(
MATCH
, "Setting boundsƒqual");

900 
	gm©ches_low”_bound
 = 
m©ches_uµ”_bound
 = 
m©ches_e¡im©ed


901 ğ
docs_m©ched
;

902 ià(
	gcŞÏp£r
 && 
	gm©ches_low”_bound
 > 
	guncŞÏp£d_low”_bound
)

903 
	guncŞÏp£d_low”_bound
 = 
m©ches_low”_bound
;

905 
As£¹R–
(
m©ches_e¡im©ed
,>=,
m©ches_low”_bound
);

906 
As£¹R–
(
m©ches_e¡im©ed
,<=,
m©ches_uµ”_bound
);

911 
	ge¡im©e_sÿË
 = 1.0;

912 
	gunique_¿‹
 = 1.0;

914 ià(
	gcŞÏp£r
) {

915 
LOGLINE
(
MATCH
, "Adjusting bounds dueo collapse_key");

916 
	gm©ches_low”_bound
 = 
cŞÏp£r
.
g‘_m©ches_low”_bound
();

917 ià(
	gm©ches_low”_bound
 > 
	guncŞÏp£d_low”_bound
)

918 
	guncŞÏp£d_low”_bound
 = 
m©ches_low”_bound
;

923 
	gX­Ÿn
::
doccouÁ
 
docs_cÚsid”ed
 = 
cŞÏp£r
.
g‘_docs_cÚsid”ed
();

924 
	gX­Ÿn
::
doccouÁ
 
dups_ignÜed
 = 
cŞÏp£r
.
g‘_dups_ignÜed
();

925 ià(
	gdocs_cÚsid”ed
 > 0) {

926 
	gunique
 = (
docs_cÚsid”ed
 - 
dups_ignÜed
);

927 
	gunique_¿‹
 = 
unique
 / (
docs_cÚsid”ed
);

932 
	gm©ches_uµ”_bound
 -ğ
dups_ignÜed
;

934 
LOGLINE
(
MATCH
, "m©ches_low”_bound=" << 
m©ches_low”_bound
 <<

935 ", m©ches_e¡im©ed=" << 
m©ches_e¡im©ed
 <<

936 "*" << 
e¡im©e_sÿË
 << "*" << 
unique_¿‹
 <<

937 ", m©ches_uµ”_bound=" << 
m©ches_uµ”_bound
);

940 ià(
	gmdecid”
 || 
	gm©ch¥y_Ëgacy
) {

941 ià(!
	g³rûÁ_cutoff
) {

942 ià(!
	gcŞÏp£r
) {

946 
	gm©ches_low”_bound
 = 
max
(
docs_m©ched
, 
m©ches_low”_bound
);

953 ià(
	gdecid”_cÚsid”ed
 > 0) {

954 
	gacû±
 = (
decid”_cÚsid”ed
 - 
decid”_d’›d
);

955 
	gacû±_¿‹
 = 
acû±
 / (
decid”_cÚsid”ed
);

956 
	ge¡im©e_sÿË
 *ğ
acû±_¿‹
;

963 
	gm©ches_uµ”_bound
 -ğ
decid”_d’›d
;

964 ià(
	gcŞÏp£r
è
	guncŞÏp£d_uµ”_bound
 -ğ
decid”_d’›d
;

967 ià(
	g³rûÁ_cutoff
) {

968 
	ge¡im©e_sÿË
 *ğ(1.0 - 
³rûÁ_cutoff_çùÜ
);

978 
	gm©ches_low”_bound
 = 
™ems
.
size
();

979 ià(
	gcŞÏp£r
è
	guncŞÏp£d_low”_bound
 = 
m©ches_low”_bound
;

984 
LOGLINE
(
MATCH
, "Adjusted bounds dueo…ercent_cutoff (" <<

985 
³rûÁ_cutoff
 << "):‚ow have matches_estimated=" <<

986 
m©ches_e¡im©ed
 << ", matches_lower_bound=" <<

987 
m©ches_low”_bound
);

990 ià(
	gcŞÏp£r
 && 
	ge¡im©e_sÿË
 != 1.0) {

991 
uncŞÏp£d_e¡im©ed
 =

992 
X­Ÿn
::
doccouÁ
(
uncŞÏp£d_e¡im©ed
 * 
e¡im©e_sÿË
 + 0.5);

995 
	ge¡im©e_sÿË
 *ğ
unique_¿‹
;

997 ià(
	ge¡im©e_sÿË
 != 1.0) {

998 
m©ches_e¡im©ed
 =

999 
X­Ÿn
::
doccouÁ
(
m©ches_e¡im©ed
 * 
e¡im©e_sÿË
 + 0.5);

1000 ià(
	gm©ches_e¡im©ed
 < 
	gm©ches_low”_bound
)

1001 
	gm©ches_e¡im©ed
 = 
m©ches_low”_bound
;

1004 ià(
	gcŞÏp£r
 || 
	gmdecid”
 || 
	gm©ch¥y_Ëgacy
) {

1005 
LOGLINE
(
MATCH
, "Clampingƒstimate between bounds: "

1006 "m©ches_low”_bound = " << 
m©ches_low”_bound
 <<

1007 ", m©ches_e¡im©ed = " << 
m©ches_e¡im©ed
 <<

1008 ", m©ches_uµ”_bound = " << 
m©ches_uµ”_bound
);

1009 
As£¹R–
(
m©ches_low”_bound
,<=,
m©ches_uµ”_bound
);

1010 
	gm©ches_e¡im©ed
 = 
max
(
m©ches_e¡im©ed
, 
m©ches_low”_bound
);

1011 
	gm©ches_e¡im©ed
 = 
mš
(
m©ches_e¡im©ed
, 
m©ches_uµ”_bound
);

1012 } ià(!
	g³rûÁ_cutoff
) {

1013 
As£¹R–
(
docs_m©ched
,<=,
m©ches_uµ”_bound
);

1014 ià(
	gdocs_m©ched
 > 
	gm©ches_low”_bound
)

1015 
	gm©ches_low”_bound
 = 
docs_m©ched
;

1016 ià(
	gdocs_m©ched
 > 
	gm©ches_e¡im©ed
)

1017 
	gm©ches_e¡im©ed
 = 
docs_m©ched
;

1020 ià(
	gcŞÏp£r
 && !
	gmdecid”
 && !
	g³rûÁ_cutoff
 && !
	gm©ch¥y_Ëgacy
) {

1021 
As£¹R–
(
docs_m©ched
,<=,
uncŞÏp£d_uµ”_bound
);

1022 ià(
	gdocs_m©ched
 > 
	guncŞÏp£d_low”_bound
)

1023 
	guncŞÏp£d_low”_bound
 = 
docs_m©ched
;

1027 ià(
	gcŞÏp£r
) {

1028 
As£¹R–
(
uncŞÏp£d_low”_bound
,<=,
uncŞÏp£d_uµ”_bound
);

1029 ià(
	guncŞÏp£d_e¡im©ed
 < 
	guncŞÏp£d_low”_bound
) {

1030 
	guncŞÏp£d_e¡im©ed
 = 
uncŞÏp£d_low”_bound
;

1031 } ià(
	guncŞÏp£d_e¡im©ed
 > 
	guncŞÏp£d_uµ”_bound
) {

1032 
	guncŞÏp£d_e¡im©ed
 = 
uncŞÏp£d_uµ”_bound
;

1036 
	guncŞÏp£d_low”_bound
 = 
m©ches_low”_bound
;

1037 
	guncŞÏp£d_uµ”_bound
 = 
m©ches_uµ”_bound
;

1038 
	guncŞÏp£d_e¡im©ed
 = 
m©ches_e¡im©ed
;

1041 
LOGLINE
(
MATCH
, 
™ems
.
size
() << " items in…otential mset");

1043 ià(
	gfœ¡
 > 0) {

1045 ià(
	g™ems
.
size
(è<ğ
fœ¡
) {

1046 
™ems
.
ş—r
();

1048 
LOGLINE
(
MATCH
, "fšdšg " << 
fœ¡
 << "th");

1053 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
»v”£_™”©Ü
 
Áh
;

1054 
	gÁh
 = 
™ems
.
rbegš
(è+ 
fœ¡
;

1055 
Áh_–em’t
(
™ems
.
rbegš
(), 
Áh
, i‹ms.
»nd
(), 
mcmp
);

1057 
	g™ems
.
”a£
(
™ems
.
begš
(è+ i‹ms.
size
(è- 
fœ¡
, i‹ms.
’d
());

1061 
LOGLINE
(
MATCH
, "sÜtšg " << 
™ems
.
size
() << "ƒntries");

1064 
sÜt
(
™ems
.
begš
(), i‹ms.
’d
(), 
mcmp
);

1066 ià(!
	g™ems
.
em±y
()) {

1067 
LOGLINE
(
MATCH
, "mš weighˆš m£ˆğ" << 
™ems
.
back
().
wt
);

1068 
LOGLINE
(
MATCH
, "max weighˆš m£ˆğ" << 
™ems
[0].
wt
);

1071 
As£¹R–
(
m©ches_e¡im©ed
,>=,
m©ches_low”_bound
);

1072 
As£¹R–
(
m©ches_e¡im©ed
,<=,
m©ches_uµ”_bound
);

1074 
As£¹R–
(
uncŞÏp£d_e¡im©ed
,>=,
uncŞÏp£d_low”_bound
);

1075 
As£¹R–
(
uncŞÏp£d_e¡im©ed
,<=,
uncŞÏp£d_uµ”_bound
);

1085 ià(!
	g™ems
.
em±y
(è&& 
	gcŞÏp£r
 && !collapser.empty()) {

1088 
	gX­Ÿn
::
weight
 
mš_wt
 = 
³rûÁ_cutoff_çùÜ
 / (
³rûÁ_sÿË
 / 100);

1089 
	gX­Ÿn
::
doccouÁ
 
’Œ›s
 = 
cŞÏp£r
.entries();

1090 
	gveùÜ
<
	gX­Ÿn
::
IÁ”Çl
::
MS‘I‹m
>::
™”©Ü
 
i
;

1091 
	gi
 = 
™ems
.
begš
(); i !ğ™ems.
’d
(); ++i) {

1093 ià(
	gi
->
	gcŞÏp£_key
.
em±y
()) ;

1096 
	gi
->
	gcŞÏp£_couÁ
 = 
cŞÏp£r
.
g‘_cŞÏp£_couÁ
(
i
->
cŞÏp£_key
, 
³rûÁ_cutoff
, 
mš_wt
);

1097 ià(--
	g’Œ›s
 == 0) {

1104 
	gm£t
 = 
X­Ÿn
::
MS‘
(
Ãw
 X­Ÿn::MS‘::
IÁ”Çl
(

1105 
fœ¡
,

1106 
m©ches_uµ”_bound
,

1107 
m©ches_low”_bound
,

1108 
m©ches_e¡im©ed
,

1109 
uncŞÏp£d_uµ”_bound
,

1110 
uncŞÏp£d_low”_bound
,

1111 
uncŞÏp£d_e¡im©ed
,

1112 
max_possibË
, 
g»©e¡_wt
, 
™ems
,

1113 
‹rmäeqªdwts
,

1114 
³rûÁ_sÿË
));

	@matcher/orpostlist.cc

24 
	~<cÚfig.h
>

26 
	~"Üpo¡li¡.h
"

27 
	~"muÉŸndpo¡li¡.h
"

28 
	~"ªdmayb•o¡li¡.h
"

29 
	~"omas£¹.h
"

30 
	~"omdebug.h
"

32 
	~<®gÜ™hm
>

34 
	gOrPo¡Li¡
::
OrPo¡Li¡
(
Po¡Li¡
 *
Ëá_
,

35 
Po¡Li¡
 *
right_
,

36 
MuÉiM©ch
 *
m©ch”_
,

37 
X­Ÿn
::
doccouÁ
 
dbsize_
)

38 : 
B¿nchPo¡Li¡
(
Ëá_
, 
right_
, 
m©ch”_
),

39 
lh—d
(0), 
rh—d
(0), 
lmax
(0), 
rmax
(0), 
mšmax
(0), 
	$dbsize
(
dbsize_
)

41 
	`DEBUGCALL
(
MATCH
, , "OrPo¡Li¡", 
Ëá_
 << ", " << 
right_
 << ", " << 
m©ch”_
 << ", " << 
dbsize_
);

42 
	`As£¹R–
(
Ëá_
->
	`g‘_‹rmäeq_e¡
(),>=,
right_
->get_termfreq_est());

43 
	}
}

45 
Po¡Li¡
 *

46 
	gOrPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

48 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "OrPo¡Li¡::Ãxt", 
w_mš
);

49 ià(
	gw_mš
 > 
	gmšmax
) {

51 
Po¡Li¡
 *
	g»t
;

52 ià(
	gw_mš
 > 
	glmax
) {

53 ià(
	gw_mš
 > 
	grmax
) {

54 
LOGLINE
(
MATCH
, "OR -> AND");

55 
	g»t
 = 
Ãw
 
MuÉiAndPo¡Li¡
(
l
, 
r
, 
lmax
, 
rmax
, 
m©ch”
, 
dbsize
);

56 
sk_to_hªdlšg_´uÃ
(
»t
, 
¡d
::
max
(
lh—d
, 
rh—d
è+ 1, 
w_mš
,

57 
m©ch”
);

59 
LOGLINE
(
MATCH
, "OR -> AND MAYBE (1)");

60 
	g»t
 = 
Ãw
 
AndMaybePo¡Li¡
(
r
, 
l
, 
m©ch”
, 
dbsize
, 
rh—d
, 
lh—d
);

61 
Ãxt_hªdlšg_´uÃ
(
»t
, 
w_mš
, 
m©ch”
);

65 
As£¹
(
w_mš
 > 
rmax
);

66 
LOGLINE
(
MATCH
, "OR -> AND MAYBE (2)");

67 
	g»t
 = 
Ãw
 
AndMaybePo¡Li¡
(
l
, 
r
, 
m©ch”
, 
dbsize
, 
lh—d
, 
rh—d
);

68 
Ãxt_hªdlšg_´uÃ
(
»t
, 
w_mš
, 
m©ch”
);

71 
	gl
 = 
r
 = 
NULL
;

72 
RETURN
(
»t
);

75 
boŞ
 
	gldry
 = 
çl£
;

76 
boŞ
 
	gºext
 = 
çl£
;

78 ià(
	glh—d
 <ğ
rh—d
) {

79 ià(
lh—d
 =ğ
rh—d
è
ºext
 = 
Œue
;

80 
Ãxt_hªdlšg_´uÃ
(
l
, 
w_mš
 - 
rmax
, 
m©ch”
);

81 ià(
	gl
->
©_’d
()è
	gldry
 = 
Œue
;

83 
	gºext
 = 
Œue
;

86 ià(
	gºext
) {

87 
Ãxt_hªdlšg_´uÃ
(
r
, 
w_mš
 - 
lmax
, 
m©ch”
);

88 ià(
	gr
->
©_’d
()) {

89 
Po¡Li¡
 *
	g»t
 = 
l
;

90 
	gl
 = 
NULL
;

91 
RETURN
(
»t
);

93 
	grh—d
 = 
r
->
g‘_docid
();

96 ià(!
	gldry
) {

97 
	glh—d
 = 
l
->
g‘_docid
();

98 
RETURN
(
NULL
);

101 
Po¡Li¡
 *
	g»t
 = 
r
;

102 
	gr
 = 
NULL
;

103 
RETURN
(
»t
);

106 
Po¡Li¡
 *

107 
	gOrPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

109 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "OrPo¡Li¡::sk_to", 
did
 << ", " << 
w_mš
);

110 ià(
	gw_mš
 > 
	gmšmax
) {

112 
Po¡Li¡
 *
	g»t
;

113 ià(
	gw_mš
 > 
	glmax
) {

114 ià(
	gw_mš
 > 
	grmax
) {

115 
LOGLINE
(
MATCH
, "OR -> AND (in skip_to)");

116 
	g»t
 = 
Ãw
 
MuÉiAndPo¡Li¡
(
l
, 
r
, 
lmax
, 
rmax
, 
m©ch”
, 
dbsize
);

117 
	gdid
 = 
¡d
::
max
(
did
, std::max(
lh—d
, 
rh—d
));

119 
LOGLINE
(
MATCH
, "OR -> AND MAYBE (in skip_to) (1)");

120 
	g»t
 = 
Ãw
 
AndMaybePo¡Li¡
(
r
, 
l
, 
m©ch”
, 
dbsize
, 
rh—d
, 
lh—d
);

121 
	gdid
 = 
¡d
::
max
(
did
, 
rh—d
);

125 
As£¹
(
w_mš
 > 
rmax
);

126 
LOGLINE
(
MATCH
, "OR -> AND MAYBE (in skip_to) (2)");

127 
	g»t
 = 
Ãw
 
AndMaybePo¡Li¡
(
l
, 
r
, 
m©ch”
, 
dbsize
, 
lh—d
, 
rh—d
);

128 
	gdid
 = 
¡d
::
max
(
did
, 
lh—d
);

131 
	gl
 = 
r
 = 
NULL
;

132 
sk_to_hªdlšg_´uÃ
(
»t
, 
did
, 
w_mš
, 
m©ch”
);

133 
RETURN
(
»t
);

136 
boŞ
 
	gldry
 = 
çl£
;

137 ià(
	glh—d
 < 
	gdid
) {

138 
sk_to_hªdlšg_´uÃ
(
l
, 
did
, 
w_mš
 - 
rmax
, 
m©ch”
);

139 
	gldry
 = 
l
->
©_’d
();

142 ià(
	grh—d
 < 
	gdid
) {

143 
sk_to_hªdlšg_´uÃ
(
r
, 
did
, 
w_mš
 - 
lmax
, 
m©ch”
);

145 ià(
	gr
->
©_’d
()) {

146 
Po¡Li¡
 *
	g»t
 = 
l
;

147 
	gl
 = 
NULL
;

148 
RETURN
(
»t
);

150 
	grh—d
 = 
r
->
g‘_docid
();

153 ià(!
	gldry
) {

154 
	glh—d
 = 
l
->
g‘_docid
();

155 
RETURN
(
NULL
);

158 
Po¡Li¡
 *
	g»t
 = 
r
;

159 
	gr
 = 
NULL
;

160 
RETURN
(
»t
);

163 
	gX­Ÿn
::
doccouÁ


164 
OrPo¡Li¡
::
	$g‘_‹rmäeq_max
() const

166 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "OrPostList::get_termfreq_max", "");

167 
	`RETURN
(
¡d
::
	`mš
(
l
->
	`g‘_‹rmäeq_max
(è+ 
r
->g‘_‹rmäeq_max(), 
dbsize
));

168 
	}
}

170 
	gX­Ÿn
::
doccouÁ


171 
OrPo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

173 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "OrPostList::get_termfreq_min", "");

174 
	`RETURN
(
¡d
::
	`max
(
l
->
	`g‘_‹rmäeq_mš
(), 
r
->get_termfreq_min()));

175 
	}
}

177 
	gX­Ÿn
::
doccouÁ


178 
OrPo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

180 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "OrPostList::get_termfreq_est", "");

183 
Ë¡
 = 
¡©ic_ÿ¡
<>(
l
->
	`g‘_‹rmäeq_e¡
());

184 
»¡
 = 
¡©ic_ÿ¡
<>(
r
->
	`g‘_‹rmäeq_e¡
());

185 
e¡
 = 
Ë¡
 + 
»¡
 - (Ë¡ *„e¡ / 
dbsize
);

186 
	`RETURN
(
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
e¡
 + 0.5));

187 
	}
}

189 
T”mF»qs


190 
	gOrPo¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

191 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

193 
LOGCALL
(
MATCH
, 
T”mF»qs
,

194 "OrPo¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

197 
T”mF»qs
 
läeqs
(
l
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

198 
T”mF»qs
 
räeqs
(
r
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

200 
	gäeqe¡
, 
	g»läeqe¡
;

203 
As£¹
(
¡©s
.
cŞËùiÚ_size
);

205 
	gäeqe¡
 = 
läeqs
.
‹rmäeq
 + 
räeqs
.termfreq -

206 (
läeqs
.
‹rmäeq
 * 
räeqs
.‹rmäeq / 
¡©s
.
cŞËùiÚ_size
);

208 ià(
	g¡©s
.
	gr£t_size
 == 0) {

209 
»läeqe¡
 = 0;

211 
	g»läeqe¡
 = 
läeqs
.
»É”mäeq
 + 
räeqs
.reltermfreq -

212 (
läeqs
.
»É”mäeq
 * 
räeqs
.»É”mäeq / 
¡©s
.
r£t_size
);

215 
RETURN
(
T”mF»qs
(
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
äeqe¡
 + 0.5),

216 
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
»läeqe¡
 + 0.5)));

219 
	gX­Ÿn
::
docid


220 
OrPo¡Li¡
::
	$g‘_docid
() const

222 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
docid
, "OrPostList::get_docid", "");

223 
	`As£¹
(
lh—d
 !ğ0 && 
rh—d
 != 0);

224 
	`RETURN
(
¡d
::
	`mš
(
lh—d
, 
rh—d
));

225 
	}
}

228 
	gX­Ÿn
::
weight


229 
OrPo¡Li¡
::
	$g‘_weight
() const

231 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "OrPostList::get_weight", "");

232 
	`As£¹
(
lh—d
 !ğ0 && 
rh—d
 != 0);

233 ià(
lh—d
 < 
rh—d
è
	`RETURN
(
l
->
	`g‘_weight
());

234 ià(
lh—d
 > 
rh—d
è
	`RETURN
(
r
->
	`g‘_weight
());

235 
	`RETURN
(
l
->
	`g‘_weight
(è+ 
r
->get_weight());

236 
	}
}

239 
	gX­Ÿn
::
weight


240 
OrPo¡Li¡
::
	$g‘_maxweight
() const

242 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "OrPostList::get_maxweight", "");

243 
	`RETURN
(
lmax
 + 
rmax
);

244 
	}
}

246 
	gX­Ÿn
::
weight


247 
OrPo¡Li¡
::
	$»ÿlc_maxweight
()

249 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "OrPostList::recalc_maxweight", "");

253 
lmax
 = 
l
->
	`»ÿlc_maxweight
();

254 
rmax
 = 
r
->
	`»ÿlc_maxweight
();

255 
mšmax
 = 
¡d
::
	`mš
(
lmax
, 
rmax
);

256 
	`RETURN
(
OrPo¡Li¡
::
	`g‘_maxweight
());

257 
	}
}

259 
boŞ


260 
	gOrPo¡Li¡
::
	$©_’d
() const

262 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "OrPostList::at_end", "");

264 
	`As£¹P¬ªoid
(!(
l
->
	`©_’d
()è&& !(
r
->at_end()));

265 
	`RETURN
(
çl£
);

266 
	}
}

268 
	g¡d
::
¡ršg


269 
OrPo¡Li¡
::
	$g‘_desütiÚ
() const

271  "(" + 
l
->
	`g‘_desütiÚ
(è+ " O¸" + 
r
->get_description() + ")";

272 
	}
}

274 
	gX­Ÿn
::
‹rmcouÁ


275 
OrPo¡Li¡
::
	$g‘_doş’gth
() const

277 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "OrPostList::get_doclength", "");

278 
X­Ÿn
::
‹rmcouÁ
 
doş’gth
;

280 
	`As£¹
(
lh—d
 !ğ0 && 
rh—d
 != 0);

281 ià(
lh—d
 > 
rh—d
) {

282 
doş’gth
 = 
r
->
	`g‘_doş’gth
();

283 
	`LOGLINE
(
MATCH
, "OrPo¡Li¡::g‘_doş’gth(è[righˆdocid=" << 
rh—d
 <<

284 "] = " << 
doş’gth
);

286 
doş’gth
 = 
l
->
	`g‘_doş’gth
();

287 
	`LOGLINE
(
MATCH
, "OrPo¡Li¡::g‘_doş’gth(è[Ëá docid=" << 
lh—d
 <<

288 "] = " << 
doş’gth
);

291 
	`RETURN
(
doş’gth
);

292 
	}
}

294 
	gX­Ÿn
::
‹rmcouÁ


295 
OrPo¡Li¡
::
	$g‘_wdf
() const

297 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "OrPostList::get_wdf", "");

298 ià(
lh—d
 < 
rh—d
è
	`RETURN
(
l
->
	`g‘_wdf
());

299 ià(
lh—d
 > 
rh—d
è
	`RETURN
(
r
->
	`g‘_wdf
());

300 
	`RETURN
(
l
->
	`g‘_wdf
(è+ 
r
->get_wdf());

301 
	}
}

303 
	gX­Ÿn
::
‹rmcouÁ


304 
OrPo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

306 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "OrPostList::count_matching_subqs", "");

307 ià(
lh—d
 < 
rh—d
è
	`RETURN
(
l
->
	`couÁ_m©chšg_subqs
());

308 ià(
lh—d
 > 
rh—d
è
	`RETURN
(
r
->
	`couÁ_m©chšg_subqs
());

309 
	`RETURN
(
l
->
	`couÁ_m©chšg_subqs
(è+ 
r
->count_matching_subqs());

310 
	}
}

	@matcher/orpostlist.h

24 #iâdeà
OM_HGUARD_ORPOSTLIST_H


25 
	#OM_HGUARD_ORPOSTLIST_H


	)

27 
	~"b¿nchpo¡li¡.h
"

36 şas 
	cOrPo¡Li¡
 : 
public
 
B¿nchPo¡Li¡
 {

37 
´iv©e
:

38 
X­Ÿn
::
docid
 
lh—d
, 
	mrh—d
;

39 
	mX­Ÿn
::
weight
 
lmax
, 
	mrmax
, 
	mmšmax
;

40 
	mX­Ÿn
::
doccouÁ
 
dbsize
;

41 
	mpublic
:

42 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

43 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

44 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

45 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

46 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

48 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

49 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

50 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

52 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

54 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

55 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

56 
boŞ
 
	$©_’d
() const;

58 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

67 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

69 
	`OrPo¡Li¡
(
Po¡Li¡
 * 
Ëá_
,

70 
Po¡Li¡
 * 
right_
,

71 
MuÉiM©ch
 * 
m©ch”_
,

72 
X­Ÿn
::
doccouÁ
 
dbsize_
);

78 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

80 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

	@matcher/phrasepostlist.cc

24 
	~<cÚfig.h
>

26 
	~"ph¿£po¡li¡.h
"

27 
	~"pos™iÚli¡.h
"

28 
	~"omas£¹.h
"

29 
	~"omdebug.h
"

30 
	~"uts.h
"

32 
	~<®gÜ™hm
>

37 şas 
	cPos™iÚLi¡CmpLt
 {

38 
	mpublic
:

41 
boŞ
 
	$İ”©Ü
()(cÚ¡ 
Pos™iÚLi¡
 *
a
, cÚ¡ Pos™iÚLi¡ *
b
) {

42  
a
->
	`g‘_size
(è< 
b
->get_size();

44 
	}
};

49 
boŞ


50 
	gN—rPo¡Li¡
::
	$‹¡_doc
()

52 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "NearPostList::test_doc", "");

53 
¡d
::
veùÜ
<
Pos™iÚLi¡
 *> 
¶i¡s
;

55 
¡d
::
veùÜ
<
Po¡Li¡
 *>::
™”©Ü
 
i
;

56 
i
 = 
‹rms
.
	`begš
(); i !ğ‹rms.
	`’d
(); i++) {

57 
Pos™iÚLi¡
 * 
p
 = (*
i
)->
	`»ad_pos™iÚ_li¡
();

59 ià(!
p
è 
çl£
;

60 
¶i¡s
.
	`push_back
(
p
);

63 
¡d
::
	`sÜt
(
¶i¡s
.
	`begš
(),…li¡s.
	`’d
(), 
	`Pos™iÚLi¡CmpLt
());

65 
X­Ÿn
::
‹rmpos
 
pos
;

67 
¶i¡s
[0]->
	`Ãxt
();

68 ià(
¶i¡s
[0]->
	`©_’d
()è
	`RETURN
(
çl£
);

69 
pos
 = 
¶i¡s
[0]->
	`g‘_pos™iÚ
();

70 } !
	`do_‹¡
(
¶i¡s
, 1, 
pos
,…os));

72 
	`RETURN
(
Œue
);

73 
	}
}

75 
boŞ


76 
	gN—rPo¡Li¡
::
do_‹¡
(
¡d
::
veùÜ
<
Pos™iÚLi¡
 *> &
¶i¡s
, 
X­Ÿn
::
‹rmcouÁ
 
i
,

77 
X­Ÿn
::
‹rmcouÁ
 
mš
, X­Ÿn::‹rmcouÁ 
max
)

79 
DEBUGCALL
(
MATCH
, 
boŞ
, "N—rPo¡Li¡::do_‹¡", "[¶i¡s], " << 
i
 << ", " << 
mš
 << ", " << 
max
);

80 
LOGLINE
(
MATCH
, "docid = " << 
g‘_docid
(è<< ", wšdow = " << 
wšdow
);

81 
	gX­Ÿn
::
‹rmcouÁ
 
tmp
 = 
max
 + 1;

83 ià(
	gwšdow
 <ğ
tmp
ètm°-ğ
wšdow
; 
	gtmp
 = 0;

84 
	g¶i¡s
[
i
]->
sk_to
(
tmp
);

85 !
	g¶i¡s
[
i
]->
©_’d
()) {

86 
	gX­Ÿn
::
‹rmpos
 
pos
 = 
¶i¡s
[
i
]->
g‘_pos™iÚ
();

87 
LOGLINE
(
MATCH
, "[" << 
i
 << "]: " << 
max
 - 
wšdow
 + 1 << " " << 
mš
 <<

88 " " << 
pos
 << " " << 
max
 << " " << 
mš
 + 
wšdow
 - 1);

89 ià(
	gpos
 > 
	gmš
 + 
	gwšdow
 - 1è
RETURN
(
çl£
);

90 ià(
	gi
 + 1 =ğ
¶i¡s
.
size
()è
RETURN
(
Œue
);

91 ià(
	gpos
 < 
	gmš
èmš = 
pos
;

92 ià(
	gpos
 > 
	gmax
èmax = 
pos
;

93 ià(
do_‹¡
(
¶i¡s
, 
i
 + 1, 
mš
, 
max
)è
RETURN
(
Œue
);

94 
	g¶i¡s
[
i
]->
Ãxt
();

96 
RETURN
(
çl£
);

99 
	gX­Ÿn
::
‹rmcouÁ


100 
N—rPo¡Li¡
::
	$g‘_wdf
() const

142 
¡d
::
veùÜ
<
Po¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
 = 
‹rms
.
	`begš
();

143 
X­Ÿn
::
‹rmcouÁ
 
wdf
 = (*
i
)->
	`g‘_wdf
();

144 ; 
i
 !ğ
‹rms
.
	`’d
(); i++) {

145 
wdf
 = 
¡d
::
	`mš
(wdf, (*
i
)->
	`g‘_wdf
());

150  
¡d
::
	`max
(
wdf
, 
X­Ÿn
::
	`‹rmcouÁ
(1));

151 
	}
}

153 
T”mF»qs


154 
	gN—rPo¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

155 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

157 
LOGCALL
(
MATCH
, 
T”mF»qs
,

158 "N—rPo¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

160 
T”mF»qs
 
»suÉ
(
sourû
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

161 
	g»suÉ
.
	g‹rmäeq
 /= 2;

162 
	g»suÉ
.
	g»É”mäeq
 /= 2;

163 
RETURN
(
»suÉ
);

166 
	g¡d
::
¡ršg


167 
N—rPo¡Li¡
::
	$g‘_desütiÚ
() const

169  "(N—¸" + 
	`om_to¡ršg
(
wšdow
è+ " " + 
sourû
->
	`g‘_desütiÚ
() + ")";

170 
	}
}

176 
boŞ


177 
	gPh¿£Po¡Li¡
::
	$‹¡_doc
()

179 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "PhrasePostList::test_doc", "");

180 
¡d
::
veùÜ
<
Pos™iÚLi¡
 *> 
¶i¡s
;

182 
¡d
::
veùÜ
<
Po¡Li¡
 *>::
™”©Ü
 
i
;

183 
i
 = 
‹rms
.
	`begš
(); i !ğ‹rms.
	`’d
(); i++) {

184 
Pos™iÚLi¡
 * 
p
 = (*
i
)->
	`»ad_pos™iÚ_li¡
();

186 ià(!
p
è 
çl£
;

187 
p
->
šdex
 = 
i
 - 
‹rms
.
	`begš
();

188 
¶i¡s
.
	`push_back
(
p
);

191 
¡d
::
	`sÜt
(
¶i¡s
.
	`begš
(),…li¡s.
	`’d
(), 
	`Pos™iÚLi¡CmpLt
());

193 
X­Ÿn
::
‹rmpos
 
pos
;

194 
X­Ÿn
::
‹rmpos
 
idx
, 
mš
;

196 
¶i¡s
[0]->
	`Ãxt
();

197 ià(
¶i¡s
[0]->
	`©_’d
()) {

198 
	`LOGLINE
(
MATCH
, "--MISS--");

199 
	`RETURN
(
çl£
);

201 
pos
 = 
¶i¡s
[0]->
	`g‘_pos™iÚ
();

202 
idx
 = 
¶i¡s
[0]->
šdex
;

203 
mš
 = 
pos
 + 
¶i¡s
.
	`size
(è- 
idx
;

204 ià(
mš
 > 
wšdow
) min -= window; min = 0;

205 } !
	`do_‹¡
(
¶i¡s
, 1, 
mš
, 
pos
 + 
wšdow
 - 
idx
));

206 
	`LOGLINE
(
MATCH
, "**HIT**");

207 
	`RETURN
(
Œue
);

208 
	}
}

210 
boŞ


211 
	gPh¿£Po¡Li¡
::
do_‹¡
(
¡d
::
veùÜ
<
Pos™iÚLi¡
 *> &
¶i¡s
, 
X­Ÿn
::
‹rmcouÁ
 
i
,

212 
X­Ÿn
::
‹rmcouÁ
 
mš
, X­Ÿn::‹rmcouÁ 
max
)

214 
DEBUGCALL
(
MATCH
, 
boŞ
, "Ph¿£Po¡Li¡::do_‹¡", "[¶i¡s], " << 
i
 << ", " << 
mš
 << ", " << 
max
);

215 
LOGLINE
(
MATCH
, "docid = " << 
g‘_docid
(è<< ", wšdow = " << 
wšdow
);

216 
	gX­Ÿn
::
‹rmpos
 
idxi
 = 
¶i¡s
[
i
]->
šdex
;

217 
LOGLINE
(
MATCH
, "my idx iÀph¿£ i " << 
idxi
);

219 
	gX­Ÿn
::
‹rmpos
 
mymš
 = 
mš
 + 
idxi
;

220 
	gX­Ÿn
::
‹rmpos
 
mymax
 = 
max
 - 
¶i¡s
.
size
(è+ 
idxi
;

221 
LOGLINE
(
MATCH
, "MIN = " << 
mymš
 << " MAX = " << 
mymax
);

224 
	gX­Ÿn
::
‹rmcouÁ
 
j
 = 0; 
	gj
 < 
	gi
; j++) {

225 
	gX­Ÿn
::
‹rmpos
 
idxj
 = 
¶i¡s
[
j
]->
šdex
;

226 ià(
	gidxj
 > 
	gidxi
) {

227 
	gX­Ÿn
::
‹rmpos
 
tmp
 = 
¶i¡s
[
j
]->
g‘_pos™iÚ
(è+ 
idxj
 - 
idxi
;

228 
LOGLINE
(
MATCH
, "ABOVE " << 
tmp
);

229 ià(
	gtmp
 < 
	gmymax
èmymax = 
tmp
;

231 
As£¹R–
(
idxi
, !=, 
idxj
);

232 
	gX­Ÿn
::
‹rmpos
 
tmp
 = 
¶i¡s
[
j
]->
g‘_pos™iÚ
(è+ 
idxi
 - 
idxj
;

233 
LOGLINE
(
MATCH
, "BELOW " << 
tmp
);

234 ià(
	gtmp
 > 
	gmymš
èmymš = 
tmp
;

236 
LOGLINE
(
MATCH
, "mš = " << 
mymš
 << " max = " << 
mymax
);

238 
	g¶i¡s
[
i
]->
sk_to
(
mymš
);

240 !
	g¶i¡s
[
i
]->
©_’d
()) {

241 
	gX­Ÿn
::
‹rmpos
 
pos
 = 
¶i¡s
[
i
]->
g‘_pos™iÚ
();

242 
LOGLINE
(
MATCH
, " " << 
mymš
 << " " << 
pos
 << " " << 
mymax
);

243 ià(
	gpos
 > 
	gmymax
è
RETURN
(
çl£
);

244 ià(
	gi
 + 1 =ğ
¶i¡s
.
size
()è
RETURN
(
Œue
);

245 
	gX­Ÿn
::
‹rmpos
 
tmp
 = 
pos
 + 
wšdow
 - 
idxi
;

246 ià(
	gtmp
 < 
	gmax
èmax = 
tmp
;

247 
	gtmp
 = 
pos
 + 
¶i¡s
.
size
(è- 
idxi
;

248 ià(
	gtmp
 > 
	gwšdow
) {

249 
	gtmp
 -ğ
wšdow
;

250 ià(
	gtmp
 > 
	gmš
èmš = 
tmp
;

252 ià(
do_‹¡
(
¶i¡s
, 
i
 + 1, 
mš
, 
max
)è
RETURN
(
Œue
);

253 
	g¶i¡s
[
i
]->
Ãxt
();

255 
RETURN
(
çl£
);

258 
	gX­Ÿn
::
‹rmcouÁ


259 
Ph¿£Po¡Li¡
::
	$g‘_wdf
() const

270 
¡d
::
veùÜ
<
Po¡Li¡
 *>::
cÚ¡_™”©Ü
 
i
 = 
‹rms
.
	`begš
();

271 
X­Ÿn
::
‹rmcouÁ
 
wdf
 = (*
i
)->
	`g‘_wdf
();

272 ; 
i
 !ğ
‹rms
.
	`’d
(); i++) {

273 
wdf
 = 
¡d
::
	`mš
(wdf, (*
i
)->
	`g‘_wdf
());

278  
¡d
::
	`max
(
wdf
 / 2, 
X­Ÿn
::
	`‹rmcouÁ
(1));

279 
	}
}

281 
T”mF»qs


282 
	gPh¿£Po¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

283 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

285 
LOGCALL
(
MATCH
, 
T”mF»qs
,

286 "Ph¿£Po¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

288 
T”mF»qs
 
»suÉ
(
sourû
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

289 
	g»suÉ
.
	g‹rmäeq
 /= 3;

290 
	g»suÉ
.
	g»É”mäeq
 /= 3;

291 
RETURN
(
»suÉ
);

294 
	g¡d
::
¡ršg


295 
Ph¿£Po¡Li¡
::
	$g‘_desütiÚ
() const

297  "(Ph¿£ " + 
	`om_to¡ršg
(
wšdow
) + " "

298 + 
sourû
->
	`g‘_desütiÚ
() + ")";

299 
	}
}

	@matcher/phrasepostlist.h

24 #iâdeà
OM_HGUARD_PHRASEPOSTLIST_H


25 
	#OM_HGUARD_PHRASEPOSTLIST_H


	)

27 
	~"£Ëùpo¡li¡.h
"

28 
	~<veùÜ
>

30 
	gX­Ÿn
::
	tPos™iÚI‹¿tÜ
::
	tIÁ”Çl
 
	tPos™iÚLi¡
;

39 şas 
	cN—rPo¡Li¡
 : 
public
 
S–eùPo¡Li¡
 {

40 
´iv©e
:

41 
X­Ÿn
::
‹rmpos
 
wšdow
;

42 
	m¡d
::
veùÜ
<
Po¡Li¡
 *> 
‹rms
;

44 
boŞ
 
‹¡_doc
();

45 
boŞ
 
do_‹¡
(
¡d
::
veùÜ
<
Pos™iÚLi¡
 *> &
¶i¡s
, 
X­Ÿn
::
‹rmcouÁ
 
i
,

46 
X­Ÿn
::
‹rmcouÁ
 
mš
, X­Ÿn::‹rmcouÁ 
max
);

47 
	mpublic
:

48 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

49 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

51 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const

54  
sourû
->
	`g‘_‹rmäeq_e¡
() / 2;

57 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

58 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

60 
	`N—rPo¡Li¡
(
Po¡Li¡
 *
sourû_
, 
X­Ÿn
::
‹rmpos
 
wšdow_
,

61 
¡d
::
veùÜ
<
Po¡Li¡
 *> 
‹rms_
)

62 : 
	$S–eùPo¡Li¡
(
sourû_
)

64 
wšdow
 = 
wšdow_
;

65 
‹rms
 = 
‹rms_
;

66 
	}
}

76 şas 
	cPh¿£Po¡Li¡
 : 
public
 
S–eùPo¡Li¡
 {

77 
´iv©e
:

78 
X­Ÿn
::
‹rmpos
 
wšdow
;

79 
	m¡d
::
veùÜ
<
Po¡Li¡
 *> 
‹rms
;

81 
boŞ
 
‹¡_doc
();

82 
boŞ
 
do_‹¡
(
¡d
::
veùÜ
<
Pos™iÚLi¡
 *> &
¶i¡s
, 
X­Ÿn
::
‹rmcouÁ
 
i
,

83 
X­Ÿn
::
‹rmcouÁ
 
mš
, X­Ÿn::‹rmcouÁ 
max
);

84 
	mpublic
:

85 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

86 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

88 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const

91  
sourû
->
	`g‘_‹rmäeq_e¡
() / 3;

94 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

95 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

97 
	`Ph¿£Po¡Li¡
(
Po¡Li¡
 *
sourû_
, 
X­Ÿn
::
‹rmpos
 
wšdow_
,

98 
¡d
::
veùÜ
<
Po¡Li¡
 *> 
‹rms_
è: 
	$S–eùPo¡Li¡
(
sourû_
)

100 
wšdow
 = 
wšdow_
;

101 
‹rms
 = 
‹rms_
;

102 
	}
}

	@matcher/queryoptimiser.cc

22 
	~<cÚfig.h
>

24 
	~"qu”yİtimi£r.h
"

26 
	~"ªdmayb•o¡li¡.h
"

27 
	~"ªdnÙpo¡li¡.h
"

28 
	~"cÚ¡_d©aba£_w¿µ”.h
"

29 
	~"em±ypo¡li¡.h
"

30 
	~"exaùph¿£po¡li¡.h
"

31 
	~"ex‹º®po¡li¡.h
"

32 
	~"muÉŸndpo¡li¡.h
"

33 
	~"muÉim©ch.h
"

34 
	~"omas£¹.h
"

35 
	~"omdebug.h
"

36 
	~"omqu”yš‹º®.h
"

37 
	~"Üpo¡li¡.h
"

38 
	~"ph¿£po¡li¡.h
"

39 
	~"po¡li¡.h
"

40 
	~"v®ueg•o¡li¡.h
"

41 
	~"v®u”ªg•o¡li¡.h
"

42 
	~"xÜpo¡li¡.h
"

44 
	~<®gÜ™hm
>

45 
	~<li¡
>

46 
	~<¡ršg
>

47 
	~<veùÜ
>

49 
usšg
 
Çme¥aû
 
	g¡d
;

51 
Po¡Li¡
 *

52 
	gQu”yO±imi£r
::
do_subqu”y
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qu”y
, 
çùÜ
)

54 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "QueryOptimiser::do_subquery",

55 
qu”y
 << ", " << 
çùÜ
);

58 ià(!
	gqu”y
è
RETURN
(
Ãw
 
Em±yPo¡Li¡
);

60 
	gqu”y
->
	gİ
) {

61 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_LEAF
:

62 ià(
çùÜ
 != 0.0) {

63 ++
tÙ®_subqs
;

64 ià(
	gqu”y
->
	gŠame
.
em±y
()è
	gçùÜ
 = 0.0;

66 
RETURN
(
loÿlsubm©ch
.
po¡li¡_äom_İ_Ëaf_qu”y
(
qu”y
, 
çùÜ
));

68 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
OP_EXTERNAL_SOURCE
: {

69 ià(
çùÜ
 != 0.0)

70 ++
tÙ®_subqs
;

71 
As£¹
(
qu”y
->
ex‹º®_sourû
);

72 
	gX­Ÿn
::
D©aba£
 
w¿µeddb
(
Ãw
 
CÚ¡D©aba£W¿µ”
(&
db
));

73 
RETURN
(
Ãw
 
Ex‹º®Po¡Li¡
(
w¿µeddb
,

74 
qu”y
->
ex‹º®_sourû
, 
çùÜ
,

75 
m©ch”
));

78 
	gX­Ÿn
::
Qu”y
::
OP_AND
:

79 
X­Ÿn
::
Qu”y
::
OP_FILTER
:

80 
X­Ÿn
::
Qu”y
::
OP_NEAR
:

81 
X­Ÿn
::
Qu”y
::
OP_PHRASE
:

82 
RETURN
(
do_ªd_like
(
qu”y
, 
çùÜ
));

84 
	gX­Ÿn
::
Qu”y
::
OP_OR
:

85 
X­Ÿn
::
Qu”y
::
OP_XOR
:

86 
X­Ÿn
::
Qu”y
::
OP_ELITE_SET
:

87 
RETURN
(
do_Ü_like
(
qu”y
, 
çùÜ
));

89 
	gX­Ÿn
::
Qu”y
::
OP_SYNONYM
: {

92 
X­Ÿn
::
‹rmcouÁ
 
§ve_tÙ®_subqs
 = 
tÙ®_subqs
;

93 
Po¡Li¡
 * 
	g¶
 = 
do_synÚym
(
qu”y
, 
çùÜ
);

94 
	gtÙ®_subqs
 = 
§ve_tÙ®_subqs
;

95 ià(
	gçùÜ
 != 0.0)

96 ++
tÙ®_subqs
;

97 
RETURN
(
¶
);

100 
	gX­Ÿn
::
Qu”y
::
OP_AND_NOT
: {

101 
As£¹Eq
(
qu”y
->
subqs
.
size
(), 2);

102 
Po¡Li¡
 * 
	gl
 = 
do_subqu”y
(
qu”y
->
subqs
[0], 
çùÜ
);

103 
Po¡Li¡
 * 
	gr
 = 
do_subqu”y
(
qu”y
->
subqs
[1], 0.0);

104 
RETURN
(
Ãw
 
AndNÙPo¡Li¡
(
l
, 
r
, 
m©ch”
, 
db_size
));

107 
	gX­Ÿn
::
Qu”y
::
OP_AND_MAYBE
: {

108 
As£¹Eq
(
qu”y
->
subqs
.
size
(), 2);

109 
Po¡Li¡
 * 
	gl
 = 
do_subqu”y
(
qu”y
->
subqs
[0], 
çùÜ
);

110 
Po¡Li¡
 * 
	gr
 = 
do_subqu”y
(
qu”y
->
subqs
[1], 
çùÜ
);

111 
RETURN
(
Ãw
 
AndMaybePo¡Li¡
(
l
, 
r
, 
m©ch”
, 
db_size
));

114 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_RANGE
: {

115 ià(
çùÜ
 != 0.0)

116 ++
tÙ®_subqs
;

117 
	gX­Ÿn
::
v®u’o
 
v®no
(
qu”y
->
·¿m‘”
);

118 cÚ¡ 
	g¡ršg
 & 
	g¿nge_begš
 = 
qu”y
->
Šame
;

119 cÚ¡ 
	g¡ršg
 & 
	g¿nge_’d
 = 
qu”y
->
¡r_·¿m‘”
;

120 
RETURN
(
Ãw
 
V®ueRªgePo¡Li¡
(&
db
, 
v®no
, 
¿nge_begš
, 
¿nge_’d
));

123 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_GE
: {

124 ià(
çùÜ
 != 0.0)

125 ++
tÙ®_subqs
;

126 
	gX­Ÿn
::
v®u’o
 
v®no
(
qu”y
->
·¿m‘”
);

127 cÚ¡ 
	g¡ršg
 & 
	g¿nge_begš
 = 
qu”y
->
Šame
;

128 
RETURN
(
Ãw
 
V®ueGePo¡Li¡
(&
db
, 
v®no
, 
¿nge_begš
));

131 
	gX­Ÿn
::
Qu”y
::
OP_VALUE_LE
: {

132 ià(
çùÜ
 != 0.0)

133 ++
tÙ®_subqs
;

134 
	gX­Ÿn
::
v®u’o
 
v®no
(
qu”y
->
·¿m‘”
);

135 cÚ¡ 
	g¡ršg
 & 
	g¿nge_’d
 = 
qu”y
->
Šame
;

136 
RETURN
(
Ãw
 
V®ueRªgePo¡Li¡
(&
db
, 
v®no
, "", 
¿nge_’d
));

139 
	gX­Ÿn
::
Qu”y
::
OP_SCALE_WEIGHT
: {

140 
As£¹Eq
(
qu”y
->
subqs
.
size
(), 1);

141 
	gsub_çùÜ
 = 
çùÜ
;

142 ià(
	gsub_çùÜ
 !ğ0.0è
sub_çùÜ
 *ğ
qu”y
->
g‘_dbl_·¿m‘”
();

143 
RETURN
(
do_subqu”y
(
qu”y
->
subqs
[0], 
sub_çùÜ
));

147 
As£¹
(
çl£
);

148 
RETURN
(
NULL
);

152 
	sPosF‹r
 {

153 
PosF‹r
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ_
, 
size_t
 
begš_
, size_ˆ
’d_
,

154 
X­Ÿn
::
‹rmcouÁ
 
wšdow_
)

155 : 
İ
(
İ_
), 
begš
(
begš_
), 
’d
(
’d_
), 
wšdow
(
wšdow_
) { }

157 
	mX­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
;

160 
size_t
 
	mbegš
, 
	m’d
;

162 
	mX­Ÿn
::
‹rmcouÁ
 
wšdow
;

165 
Po¡Li¡
 *

166 
	gQu”yO±imi£r
::
do_ªd_like
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
, 
çùÜ
)

168 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "QueryOptimiser::do_and_like",

169 
qu”y
 << ", " << 
çùÜ
);

171 
	gli¡
<
	gPosF‹r
> 
	gpos_f‹rs
;

172 
	gveùÜ
<
	gPo¡Li¡
 *> 
	g¶i¡s
;

173 
do_ªd_like
(
qu”y
, 
çùÜ
, 
¶i¡s
, 
pos_f‹rs
);

174 
As£¹R–
(
¶i¡s
.
size
(), >=, 2);

176 
Po¡Li¡
 * 
	g¶
;

177 
	g¶
 = 
Ãw
 
MuÉiAndPo¡Li¡
(
¶i¡s
.
begš
(),…li¡s.
’d
(), 
m©ch”
, 
db_size
);

184 
	gli¡
<
	gPosF‹r
>::
™”©Ü
 
i
;

185 
	gi
 = 
pos_f‹rs
.
begš
(); i !ğpos_f‹rs.
’d
(); ++i) {

186 cÚ¡ 
	gPosF‹r
 & 
	gf‹r
 = *
i
;

190 
	gveùÜ
<
	gPo¡Li¡
 *> 
‹rms
(
¶i¡s
.
begš
(è+ 
f‹r
.begin,

191 
¶i¡s
.
begš
(è+ 
f‹r
.
’d
);

193 
	gX­Ÿn
::
‹rmcouÁ
 
wšdow
 = 
f‹r
.window;

194 ià(
	gf‹r
.
	gİ
 =ğ
X­Ÿn
::
Qu”y
::
OP_NEAR
) {

195 
¶
 = 
Ãw
 
N—rPo¡Li¡
Õl, 
wšdow
, 
‹rms
);

196 } ià(
	gwšdow
 =ğ
f‹r
.
’d
 - f‹r.
begš
) {

197 
As£¹Eq
(
f‹r
.
İ
, 
X­Ÿn
::
Qu”y
::
OP_PHRASE
);

198 
	g¶
 = 
Ãw
 
ExaùPh¿£Po¡Li¡
(
¶
, 
‹rms
);

200 
As£¹Eq
(
f‹r
.
İ
, 
X­Ÿn
::
Qu”y
::
OP_PHRASE
);

201 
	g¶
 = 
Ãw
 
Ph¿£Po¡Li¡
(
¶
, 
wšdow
, 
‹rms
);

205 
RETURN
(
¶
);

208 
šlše
 
boŞ
 
is_ªd_like
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
) {

209  
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_AND
 || o°=ğX­Ÿn::Qu”y::
OP_FILTER
 ||

210 
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_NEAR
 || o°=ğX­Ÿn::Qu”y::
OP_PHRASE
;

214 
	gQu”yO±imi£r
::
do_ªd_like
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
, 
çùÜ
,

215 
veùÜ
<
Po¡Li¡
 *> & 
ªd_¶i¡s
,

216 
li¡
<
PosF‹r
> & 
pos_f‹rs
)

218 
DEBUGCALL
(
MATCH
, , "QueryOptimiser::do_and_like",

219 
qu”y
 << ", " << 
çùÜ
 << ", [and_plists], [pos_filters]");

221 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
 = 
qu”y
->op;

222 
As£¹
(
is_ªd_like
(
İ
));

224 
boŞ
 
	gpos™iÚ®
 = 
çl£
;

225 ià(
	gİ
 =ğ
X­Ÿn
::
Qu”y
::
OP_PHRASE
 || 
İ
 =ğX­Ÿn::Qu”y::
OP_NEAR
) {

229 ià(!
db
.
has_pos™iÚs
()) {

230 
İ
 = 
X­Ÿn
::
Qu”y
::
OP_AND
;

232 
	gpos™iÚ®
 = 
Œue
;

236 cÚ¡ 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
subqu”y_li¡
 &
qu”›s
 = 
qu”y
->
subqs
;

237 
As£¹R–
(
qu”›s
.
size
(), >=, 2);

239 
size_t
 
	gi
 = 0; i !ğ
qu”›s
.
size
(); ++i) {

241 ià(
	gi
 =ğ1 && 
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_FILTER
è
çùÜ
 = 0.0;

243 cÚ¡ 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
subq
 = 
qu”›s
[
i
];

244 ià(
is_ªd_like
(
subq
->
İ
)) {

245 
do_ªd_like
(
subq
, 
çùÜ
, 
ªd_¶i¡s
, 
pos_f‹rs
);

247 
Po¡Li¡
 * 
	g¶
 = 
do_subqu”y
(
subq
, 
çùÜ
);

248 
	gªd_¶i¡s
.
push_back
(
¶
);

252 ià(
	gpos™iÚ®
) {

254 
size_t
 
	g’d
 = 
ªd_¶i¡s
.
size
();

255 
size_t
 
	gbegš
 = 
’d
 - 
qu”›s
.
size
();

256 
	gX­Ÿn
::
‹rmcouÁ
 
wšdow
 = 
qu”y
->
·¿m‘”
;

258 
	gpos_f‹rs
.
push_back
(
PosF‹r
(
İ
, 
begš
, 
’d
, 
wšdow
));

267 
	sCmpMaxOrT”ms
 {

276 
boŞ
 
İ”©Ü
()(cÚ¡ 
Po¡Li¡
 *
	ma
, cÚ¡ Po¡Li¡ *
	mb
) {

277 ià(
	ma
->
g‘_‹rmäeq_max
(è=ğ0è 
çl£
;

278 ià(
	mb
->
g‘_‹rmäeq_max
(è=ğ0è 
Œue
;

280 #ià
defšed
(
__i386__
è|| defšed(
__mc68000__
)

297 vŞ©
	ma_max_wt
 = 
a
->
g‘_maxweight
();

298 vŞ©
	mb_max_wt
 = 
b
->
g‘_maxweight
();

299  
	ma_max_wt
 > 
	mb_max_wt
;

301  
	ma
->
g‘_maxweight
(è> 
	mb
->get_maxweight();

306 
	g‹m¶©e
<
şass
 
	gCLASS
> 
	sd–‘e_±r
 {

307 
İ”©Ü
()(
CLASS
 *
	mp
è{ 
d–‘e
…; }

311 
	sCom·»Po¡Li¡T”mF»qAsûndšg
 {

313 
boŞ
 
İ”©Ü
()(cÚ¡ 
Po¡Li¡
 *
	ma
, cÚ¡ Po¡Li¡ *
	mb
) {

314  
	ma
->
g‘_‹rmäeq_e¡
(è> 
	mb
->get_termfreq_est();

318 
Po¡Li¡
 *

319 
	gQu”yO±imi£r
::
do_Ü_like
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
, 
çùÜ
)

321 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "QueryOptimiser::do_or_like",

322 
qu”y
 << ", " << 
çùÜ
);

326 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
İ_t
 
İ
 = 
qu”y
->op;

327 
As£¹
(
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_ELITE_SET
 || o°=ğX­Ÿn::Qu”y::
OP_OR
 ||

328 
İ
 =ğ
X­Ÿn
::
Qu”y
::
OP_XOR
 || o°=ğX­Ÿn::Qu”y::
OP_SYNONYM
);

330 cÚ¡ 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
subqu”y_li¡
 &
qu”›s
 = 
qu”y
->
subqs
;

331 
As£¹R–
(
qu”›s
.
size
(), >=, 2);

333 
	gveùÜ
<
	gPo¡Li¡
 *> 
	gpo¡li¡s
;

334 
	gpo¡li¡s
.
»£rve
(
qu”›s
.
size
());

336 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
::
subqu”y_li¡
::
cÚ¡_™”©Ü
 
q
;

337 
	gq
 = 
qu”›s
.
begš
(); q !ğqu”›s.
’d
(); ++q) {

338 
	gpo¡li¡s
.
push_back
(
do_subqu”y
(*
q
, 
çùÜ
));

341 ià(
	gİ
 =ğ
X­Ÿn
::
Qu”y
::
OP_ELITE_SET
) {

343 
X­Ÿn
::
‹rmcouÁ
 
–™e_£t_size
 = 
qu”y
->
·¿m‘”
;

344 
As£¹
(
–™e_£t_size
 > 0);

346 ià(
	gpo¡li¡s
.
size
(è> 
	g–™e_£t_size
) {

349 
fÜ_—ch
(
po¡li¡s
.
begš
(),…o¡li¡s.
’d
(),

350 
mem_fun
(&
Po¡Li¡
::
»ÿlc_maxweight
));

352 
Áh_–em’t
(
po¡li¡s
.
begš
(),

353 
po¡li¡s
.
begš
(è+ 
–™e_£t_size
 - 1,

354 
po¡li¡s
.
’d
(), 
CmpMaxOrT”ms
());

356 
fÜ_—ch
(
po¡li¡s
.
begš
(è+ 
–™e_£t_size
,…o¡li¡s.
’d
(),

357 
d–‘e_±r
<
Po¡Li¡
>());

359 ià(
	g–™e_£t_size
 =ğ1è
RETURN
(
po¡li¡s
[0]);

361 
	gpo¡li¡s
.
»size
(
–™e_£t_size
);

367 
make_h—p
(
po¡li¡s
.
begš
(),…o¡li¡s.
’d
(),

368 
Com·»Po¡Li¡T”mF»qAsûndšg
());

376 
As£¹R–
(
po¡li¡s
.
size
(), >=, 2);

377 
	gŒue
) {

384 
Po¡Li¡
 * 
	gr
 = 
po¡li¡s
.
äÚt
();

385 
pİ_h—p
(
po¡li¡s
.
begš
(),…o¡li¡s.
’d
(),

386 
Com·»Po¡Li¡T”mF»qAsûndšg
());

387 
	gpo¡li¡s
.
pİ_back
();

388 
Po¡Li¡
 * 
	gl
 = 
po¡li¡s
.
äÚt
();

390 
Po¡Li¡
 * 
	g¶
;

391 ià(
	gİ
 =ğ
X­Ÿn
::
Qu”y
::
OP_XOR
) {

392 
¶
 = 
Ãw
 
XÜPo¡Li¡
(
l
, 
r
, 
m©ch”
, 
db_size
);

394 
	g¶
 = 
Ãw
 
OrPo¡Li¡
(
l
, 
r
, 
m©ch”
, 
db_size
);

397 ià(
	gpo¡li¡s
.
size
(è=ğ1è
RETURN
(
¶
);

399 
pİ_h—p
(
po¡li¡s
.
begš
(),…o¡li¡s.
’d
(),

400 
Com·»Po¡Li¡T”mF»qAsûndšg
());

401 
	gpo¡li¡s
.
back
(èğ
¶
;

402 
push_h—p
(
po¡li¡s
.
begš
(),…o¡li¡s.
’d
(),

403 
Com·»Po¡Li¡T”mF»qAsûndšg
());

407 
Po¡Li¡
 *

408 
	gQu”yO±imi£r
::
do_synÚym
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
, 
çùÜ
)

410 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "QueryOptimiser::do_synonym",

411 
qu”y
 << ", " << 
çùÜ
);

412 ià(
	gçùÜ
 == 0.0) {

415 
RETURN
(
do_Ü_like
(
qu”y
, 0.0));

422 
As£¹Eq
(
qu”y
->
g‘_wqf
(), 0);

426 
RETURN
(
loÿlsubm©ch
.
make_synÚym_po¡li¡
(
do_Ü_like
(
qu”y
, 0.0),

427 
m©ch”
, 
çùÜ
));

	@matcher/queryoptimiser.h

22 #iâdeà
XAPIAN_INCLUDED_QUERYOPTIMISER_H


23 
	#XAPIAN_INCLUDED_QUERYOPTIMISER_H


	)

25 
	~"x­Ÿn/qu”y.h
"

27 
	~"d©aba£.h
"

28 
	~"loÿlm©ch.h
"

29 
	~"om’quœeš‹º®.h
"

30 
	~"po¡li¡.h
"

32 
	~<li¡
>

33 
	~<veùÜ
>

35 
şass
 
	gMuÉiM©ch
;

36 
	gPosF‹r
;

38 şas 
	cQu”yO±imi£r
 {

39 cÚ¡ 
	mX­Ÿn
::
D©aba£
::
IÁ”Çl
 & 
db
;

41 
	mX­Ÿn
::
doccouÁ
 
db_size
;

43 
	mLoÿlSubM©ch
 & 
	mloÿlsubm©ch
;

45 
MuÉiM©ch
 * 
	mm©ch”
;

52 
	mX­Ÿn
::
‹rmcouÁ
 
tÙ®_subqs
;

61 
Po¡Li¡
 * 
do_subqu”y
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qu”y
,

62 
çùÜ
);

72 
Po¡Li¡
 * 
do_ªd_like
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
, 
çùÜ
);

84 
do_ªd_like
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
, 
çùÜ
,

85 
¡d
::
veùÜ
<
Po¡Li¡
 *> & 
ªd_¶i¡s
,

86 
¡d
::
li¡
<
PosF‹r
> & 
pos_f‹rs
);

96 
Po¡Li¡
 * 
do_Ü_like
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
, 
çùÜ
);

105 
Po¡Li¡
 * 
do_synÚym
(cÚ¡ 
X­Ÿn
::
Qu”y
::
IÁ”Çl
 *
qu”y
, 
çùÜ
);

107 
	mpublic
:

108 
Qu”yO±imi£r
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 & 
db_
,

109 
LoÿlSubM©ch
 & 
loÿlsubm©ch_
,

110 
MuÉiM©ch
 * 
m©ch”_
)

111 : 
db
(
db_
), 
db_size
(db.
g‘_doccouÁ
()), 
loÿlsubm©ch
(
loÿlsubm©ch_
),

112 
m©ch”
(
m©ch”_
), 
	$tÙ®_subqs
(0) { }

114 
Po¡Li¡
 * 
	`İtimi£_qu”y
(
X­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qu”y
) {

115  
	`do_subqu”y
(
qu”y
, 1.0);

116 
	}
}

118 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_tÙ®_subqu”›s
(ècÚ¡ {  
tÙ®_subqs
; 
	}
}

	@matcher/remotesubmatch.cc

22 
	~<cÚfig.h
>

23 
	~"»mÙesubm©ch.h
"

25 
	~"m£o¡li¡.h
"

26 
	~"omdebug.h
"

27 
	~"»mÙe-d©aba£.h
"

28 
	~"weightš‹º®.h
"

30 
	gRemÙeSubM©ch
::
RemÙeSubM©ch
(
RemÙeD©aba£
 *
db_
,

31 
boŞ
 
deü—sšg_»Ëvªû_
,

32 cÚ¡ 
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s_
)

33 : 
db
(
db_
),

34 
deü—sšg_»Ëvªû
(
deü—sšg_»Ëvªû_
),

35 
	$m©ch¥›s
(
m©ch¥›s_
)

37 
	`DEBUGCALL
(
MATCH
, , "RemoteSubMatch",

38 
db_
 << ", " << 
deü—sšg_»Ëvªû_
 << ", " <<

40 
	}
}

42 
boŞ


43 
	gRemÙeSubM©ch
::
´•¬e_m©ch
(
boŞ
 
nowa™
,

44 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
)

46 
DEBUGCALL
(
MATCH
, 
boŞ
, "RemÙeSubM©ch::´•¬e_m©ch", 
nowa™
 << ", [total_stats]");

47 
	gX­Ÿn
::
Weight
::
IÁ”Çl
 
»mÙe_¡©s
;

48 ià(!
	gdb
->
g‘_»mÙe_¡©s
(
nowa™
, 
»mÙe_¡©s
)è
RETURN
(
çl£
);

49 
	gtÙ®_¡©s
 +ğ
»mÙe_¡©s
;

50 
RETURN
(
Œue
);

54 
	gRemÙeSubM©ch
::
¡¬t_m©ch
(
X­Ÿn
::
doccouÁ
 
fœ¡
,

55 
X­Ÿn
::
doccouÁ
 
max™ems
,

56 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

57 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
)

59 
DEBUGCALL
(
MATCH
, , "RemoteSubMatch::start_match",

60 
fœ¡
 << ", " << 
max™ems
 << ", " << 
check_©_Ëa¡
);

61 
	gdb
->
£nd_glob®_¡©s
(
fœ¡
, 
max™ems
, 
check_©_Ëa¡
, 
tÙ®_¡©s
);

64 
Po¡Li¡
 *

65 
	gRemÙeSubM©ch
::
g‘_po¡li¡_ªd_‹rm_šfo
(
MuÉiM©ch
 *,

66 
m­
<
¡ršg
, 
X­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> * 
‹rmäeqªdwts
,

67 
X­Ÿn
::
‹rmcouÁ
 * 
tÙ®_subqs_±r
)

69 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "RemoteSubMatch::get_postlist_and_term_info",

70 "[m©ch”], " << (*)
‹rmäeqªdwts
 << ", " << (*)
tÙ®_subqs_±r
);

71 
	gX­Ÿn
::
MS‘
 
m£t
;

72 
	gdb
->
g‘_m£t
(
m£t
, 
m©ch¥›s
);

73 
	g³rûÁ_çùÜ
 = 
m£t
.
š‹º®
->
³rûÁ_çùÜ
;

74 ià(
	g‹rmäeqªdwts
è*‹rmäeqªdwt ğ
m£t
.
š‹º®
->
‹rmäeqªdwts
;

77 ()
	gtÙ®_subqs_±r
;

78  
Ãw
 
MS‘Po¡Li¡
(
m£t
, 
deü—sšg_»Ëvªû
);

	@matcher/remotesubmatch.h

22 #iâdeà
XAPIAN_INCLUDED_REMOTESUBMATCH_H


23 
	#XAPIAN_INCLUDED_REMOTESUBMATCH_H


	)

25 
	~"subm©ch.h
"

26 
	~"»mÙe-d©aba£.h
"

27 
	~"x­Ÿn/weight.h
"

29 
Çme¥aû
 
	gX­Ÿn
 {

30 
şass
 
	gM©chSpy
;

34 şas 
	cRemÙeSubM©ch
 : 
public
 
SubM©ch
 {

36 
İ”©Ü
=(cÚ¡ 
RemÙeSubM©ch
 &);

39 
RemÙeSubM©ch
(const RemoteSubMatch &);

42 
RemÙeD©aba£
 *
	mdb
;

48 
boŞ
 
	mdeü—sšg_»Ëvªû
;

51 
	m³rûÁ_çùÜ
;

54 cÚ¡ 
	mveùÜ
<
	mX­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s
;

56 
	mpublic
:

58 
RemÙeSubM©ch
(
RemÙeD©aba£
 *
db_
,

59 
boŞ
 
deü—sšg_»Ëvªû_
,

60 cÚ¡ 
veùÜ
<
X­Ÿn
::
M©chSpy
 *> & 
m©ch¥›s
);

63 
boŞ
 
´•¬e_m©ch
(boŞ 
nowa™
, 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
);

66 
¡¬t_m©ch
(
X­Ÿn
::
doccouÁ
 
fœ¡
,

67 
X­Ÿn
::
doccouÁ
 
max™ems
,

68 
X­Ÿn
::
doccouÁ
 
check_©_Ëa¡
,

69 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
tÙ®_¡©s
);

72 
Po¡Li¡
 * 
g‘_po¡li¡_ªd_‹rm_šfo
(
MuÉiM©ch
 *
m©ch”
,

73 
¡d
::
m­
<¡d::
¡ršg
,

74 
X­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> *
‹rmäeqªdwts
,

75 
X­Ÿn
::
‹rmcouÁ
 * 
tÙ®_subqs_±r
);

78 
	$g‘_³rûÁ_çùÜ
(ècÚ¡ {  
³rûÁ_çùÜ
; }

81 
	`g‘_m£t
(
X­Ÿn
::
MS‘
 & 
m£t
è{ 
db
->g‘_m£t(m£t, 
m©ch¥›s
); 
	}
}

	@matcher/rset.cc

24 
	~<cÚfig.h
>

26 
	~"d©aba£.h
"

27 
	~"r£t.h
"

28 
	~"omdebug.h
"

30 
	~"autİŒ.h
"

31 
	~"‹rmli¡.h
"

32 
	~"weightš‹º®.h
"

35 
	gRS‘I
::
	$ÿlcuÏ‹_¡©s
()

37 
	`DEBUGCALL
(
MATCH
, , "RSetI::calculate_stats", "");

38 
	`As£¹
(!
ÿlcuÏ‹d_»É”mäeqs
);

39 
¡d
::
£t
<
X­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
doc
;

40 
doc
 = 
docum’ts
.
	`begš
(); doø!ğdocum’ts.
	`’d
(); doc++) {

41 
	`As£¹
(*
doc
);

42 
	`LOGLINE
(
WTCALC
, "CouÁšg„–‹rmäeq š docum’ˆ" << *
doc
 << " [ ");

43 ià(
dbroÙ
) {

44 
AutoPŒ
<
T”mLi¡
> 
	`
(
dbroÙ
->
	`İ’_‹rm_li¡
(*
doc
));

45 

->
	`Ãxt
();

46 !

->
	`©_’d
()) {

50 
¡ršg
 
Šame
 = 

->
	`g‘_‹rmÇme
();

51 ià(
»É”mäeqs
.
	`fšd
(
Šame
è!ğ»É”mäeqs.
	`’d
()) {

52 
»É”mäeqs
[
Šame
] ++;

53 
	`LOGLINE
(
WTCALC
, 
Šame
 << "‚ow ha »É”mäeq oà" << 
»É”mäeqs
[tname]);

55 

->
	`Ãxt
();

58 
X­Ÿn
::
T”mI‹¿tÜ
 

 = 
roÙ
.
	`‹rmli¡_begš
(*
doc
);

59 
X­Ÿn
::
T”mI‹¿tÜ
 
’d
 = 
roÙ
.
	`‹rmli¡_’d
(*
doc
);

60 

 !ğ
’d
) {

64 
¡ršg
 
Šame
 = *

;

65 ià(
»É”mäeqs
.
	`fšd
(
Šame
è!ğ»É”mäeqs.
	`’d
()) {

66 
»É”mäeqs
[
Šame
] ++;

67 
	`LOGLINE
(
WTCALC
, 
Šame
 << "‚ow ha »É”mäeq oà" << 
»É”mäeqs
[tname]);

69 

++;

72 
	`LOGLINE
(
WTCALC
, "]");

74 
ÿlcuÏ‹d_»É”mäeqs
 = 
Œue
;

75 
	}
}

78 
	gRS‘I
::
cÚŒibu‹_¡©s
(
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
)

80 
DEBUGCALL
(
MATCH
, , "RS‘I::cÚŒibu‹_¡©s", 
¡©s
);

81 
ÿlcuÏ‹_¡©s
();

83 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gX­Ÿn
::
doccouÁ
>::
cÚ¡_™”©Ü
 
i
;

84 
	gi
 = 
»É”mäeqs
.
begš
(); i !ğ»É”mäeqs.
’d
(); i++) {

85 
	g¡©s
.
£t_»É”mäeq
(
i
->
fœ¡
, i->
£cÚd
);

87 
	g¡©s
.
	gr£t_size
 +ğ
size
();

	@matcher/selectpostlist.cc

23 
	~<cÚfig.h
>

25 
	~"£Ëùpo¡li¡.h
"

26 
	~"omas£¹.h
"

27 
	~"omdebug.h
"

29 
Po¡Li¡
 *

30 
	gS–eùPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

32 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "S–eùPo¡Li¡::Ãxt", 
w_mš
);

34 
Po¡Li¡
 *
	gp
 = 
sourû
->
Ãxt
(
w_mš
);

35 ()
	gp
;

36 
As£¹
(
p
 =ğ
NULL
);

37 } !
	gsourû
->
©_’d
(è&& !
‹¡_doc
());

38 
RETURN
(
NULL
);

41 
Po¡Li¡
 *

42 
	gS–eùPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

44 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "S–eùPo¡Li¡::sk_to", 
did
 << ", " << 
w_mš
);

45 ià(
	gdid
 > 
g‘_docid
()) {

46 
Po¡Li¡
 *
	gp
 = 
sourû
->
sk_to
(
did
, 
w_mš
);

47 ()
	gp
;

48 
As£¹
(
p
 =ğ
NULL
);

49 ià(!
	gsourû
->
©_’d
(è&& !
‹¡_doc
())

50 
RETURN
(
S–eùPo¡Li¡
::
Ãxt
(
w_mš
));

52 
RETURN
(
NULL
);

	@matcher/selectpostlist.h

22 #iâdeà
OM_HGUARD_SELECTPOSTLIST_H


23 
	#OM_HGUARD_SELECTPOSTLIST_H


	)

25 
	~"po¡li¡.h
"

30 şas 
	cS–eùPo¡Li¡
 : 
public
 
Po¡Li¡
 {

31 
´iv©e
:

33 
S–eùPo¡Li¡
(const SelectPostList &);

34 
	mS–eùPo¡Li¡
 & 
	mİ”©Ü
=(cÚ¡ 
S–eùPo¡Li¡
 &);

36 
	m´Ùeùed
:

37 
Po¡Li¡
 *
sourû
;

42 
vœtu®
 
boŞ
 
‹¡_doc
() = 0;

43 
	mpublic
:

44 
Po¡Li¡
 *
Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

45 
Po¡Li¡
 *
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

48 
	mX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
(ècÚ¡ {  
sourû
->
	`g‘_‹rmäeq_max
(); }

49 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
(ècÚ¡ {  0; 
	}
}

50 
	gX­Ÿn
::
weight
 
	$g‘_maxweight
(ècÚ¡ {  
sourû
->
	`g‘_maxweight
(); 
	}
}

51 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
sourû
->
	`g‘_docid
(); 
	}
}

52 
	gX­Ÿn
::
weight
 
	$g‘_weight
(ècÚ¡ {  
sourû
->
	`g‘_weight
(); 
	}
}

53 
	gX­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
(ècÚ¡ {  
sourû
->
	`g‘_doş’gth
(); 
	}
}

54 
	gX­Ÿn
::
weight
 
	$»ÿlc_maxweight
(è{  
sourû
->
	`»ÿlc_maxweight
(); 
	}
}

55 
Pos™iÚLi¡
 * 
	$»ad_pos™iÚ_li¡
(è{  
sourû
->
	`»ad_pos™iÚ_li¡
(); 
	}
}

56 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
(ècÚ¡ {  
sourû
->
	`İ’_pos™iÚ_li¡
(); 
	}
}

57 
boŞ
 
	$©_’d
(ècÚ¡ {  
sourû
->
	`©_’d
(); 
	}
}

59 
	gX­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const {

60  
sourû
->
	`couÁ_m©chšg_subqs
();

61 
	}
}

63 
	g¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

65 
	$S–eùPo¡Li¡
(
Po¡Li¡
 *
sourû_
è: 
	$sourû
(
sourû_
è{ 
	}
}

66 ~
	$S–eùPo¡Li¡
(è{ 
d–‘e
 
sourû
; 
	}
}

69 
šlše
 
	g¡d
::
¡ršg


70 
S–eùPo¡Li¡
::
	$g‘_desütiÚ
() const

72  "(S–eù " + 
sourû
->
	`g‘_desütiÚ
() + ")";

73 
	}
}

	@matcher/synonympostlist.cc

23 
	~<cÚfig.h
>

25 
	~"synÚympo¡li¡.h
"

27 
	~"b¿nchpo¡li¡.h
"

28 
	~"debuglog.h
"

30 
	gSynÚymPo¡Li¡
::~
	$SynÚymPo¡Li¡
()

32 
d–‘e
 
wt
;

33 
d–‘e
 
subŒ“
;

34 
	}
}

37 
	gSynÚymPo¡Li¡
::
£t_weight
(cÚ¡ 
X­Ÿn
::
Weight
 * 
wt_
)

39 
d–‘e
 
wt
;

40 
	gwt
 = 
wt_
;

41 
	gwªt_doş’gth
 = 
wt
->
g‘_sum·¹_Ãeds_doş’gth_
();

42 
	gwªt_wdf
 = 
wt
->
g‘_sum·¹_Ãeds_wdf_
();

45 
Po¡Li¡
 *

46 
	gSynÚymPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

48 
LOGCALL
(
MATCH
, 
Po¡Li¡
 *, "SynÚymPo¡Li¡::Ãxt", 
w_mš
);

49 ()
	gw_mš
;

50 
Ãxt_hªdlšg_´uÃ
(
subŒ“
, 0, 
m©ch”
);

51 
RETURN
(
NULL
);

54 
Po¡Li¡
 *

55 
	gSynÚymPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

57 
LOGCALL
(
MATCH
, 
Po¡Li¡
 *, "SynÚymPo¡Li¡::sk_to", 
did
 << ", " << 
w_mš
);

58 ()
	gw_mš
;

59 
sk_to_hªdlšg_´uÃ
(
subŒ“
, 
did
, 0, 
m©ch”
);

60 
RETURN
(
NULL
);

63 
	gX­Ÿn
::
weight


64 
SynÚymPo¡Li¡
::
	$g‘_weight
() const

66 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "SynonymPostList::get_weight", "");

79 ià(
wªt_wdf
) {

80 
X­Ÿn
::
‹rmcouÁ
 
wdf
 = 
	`g‘_wdf
();

81 
X­Ÿn
::
‹rmcouÁ
 
doş’
 = 
	`g‘_doş’gth
();

82 ià(
wdf
 > 
doş’
) wdf = doclen;

83 
	`RETURN
(
wt
->
	`g‘_sum·¹
(
wdf
, 
doş’
));

85 
	`RETURN
(
wt
->
	`g‘_sum·¹
(0, 
wªt_doş’gth
 ? 
	`g‘_doş’gth
() : 0));

86 
	}
}

88 
	gX­Ÿn
::
weight


89 
SynÚymPo¡Li¡
::
	$g‘_maxweight
() const

91 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "SynonymPostList::get_maxweight", "");

92 
	`RETURN
(
wt
->
	`g‘_max·¹
());

93 
	}
}

95 
	gX­Ÿn
::
weight


96 
SynÚymPo¡Li¡
::
	$»ÿlc_maxweight
()

98 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "SynonymPostList::recalc_maxweight", "");

102 ià(!
have_ÿlcuÏ‹d_subŒ“_maxweights
) {

103 
subŒ“
->
	`»ÿlc_maxweight
();

104 
have_ÿlcuÏ‹d_subŒ“_maxweights
 = 
Œue
;

106 
	`RETURN
(
SynÚymPo¡Li¡
::
	`g‘_maxweight
());

107 
	}
}

109 
	gX­Ÿn
::
‹rmcouÁ


110 
SynÚymPo¡Li¡
::
	$g‘_wdf
() const {

111 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "SynonymPostList::get_wdf", "");

112 
	`RETURN
(
subŒ“
->
	`g‘_wdf
());

113 
	}
}

115 
	gX­Ÿn
::
doccouÁ


116 
SynÚymPo¡Li¡
::
	$g‘_‹rmäeq_mš
() const {

117 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "SynonymPostList::get_termfreq_min", "");

118 
	`RETURN
(
subŒ“
->
	`g‘_‹rmäeq_mš
());

119 
	}
}

121 
	gX­Ÿn
::
doccouÁ


122 
SynÚymPo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const {

123 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "SynonymPostList::get_termfreq_min", "");

124 
	`RETURN
(
subŒ“
->
	`g‘_‹rmäeq_e¡
());

125 
	}
}

127 
	gX­Ÿn
::
doccouÁ


128 
SynÚymPo¡Li¡
::
	$g‘_‹rmäeq_max
() const {

129 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "SynonymPostList::get_termfreq_min", "");

130 
	`RETURN
(
subŒ“
->
	`g‘_‹rmäeq_max
());

131 
	}
}

133 
	gX­Ÿn
::
docid


134 
SynÚymPo¡Li¡
::
	$g‘_docid
() const {

135 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
docid
, "SynonymPostList::get_docid", "");

136 
	`RETURN
(
subŒ“
->
	`g‘_docid
());

137 
	}
}

139 
	gX­Ÿn
::
‹rmcouÁ


140 
SynÚymPo¡Li¡
::
	$g‘_doş’gth
() const {

141 
	`LOGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "SynonymPostList::get_doclength", "");

142 
	`RETURN
(
subŒ“
->
	`g‘_doş’gth
());

143 
	}
}

145 
boŞ


146 
	gSynÚymPo¡Li¡
::
	$©_’d
() const {

147 
	`LOGCALL
(
MATCH
, 
boŞ
, "SynonymPostList::at_end", "");

148 
	`RETURN
(
subŒ“
->
	`©_’d
());

149 
	}
}

151 
	gX­Ÿn
::
‹rmcouÁ


152 
SynÚymPo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

155 
	}
}

157 
	g¡d
::
¡ršg


158 
SynÚymPo¡Li¡
::
	$g‘_desütiÚ
() const

160  "(SynÚym " + 
subŒ“
->
	`g‘_desütiÚ
() + ")";

161 
	}
}

	@matcher/synonympostlist.h

22 #iâdeà
XAPIAN_INCLUDED_SYNONYMPOSTLIST_H


23 
	#XAPIAN_INCLUDED_SYNONYMPOSTLIST_H


	)

25 
	~"muÉim©ch.h
"

26 
	~"po¡li¡.h
"

34 şas 
	cSynÚymPo¡Li¡
 : 
public
 
Po¡Li¡
 {

38 
Po¡Li¡
 * 
subŒ“
;

45 
MuÉiM©ch
 * 
	mm©ch”
;

48 cÚ¡ 
	mX­Ÿn
::
Weight
 * 
wt
;

51 
boŞ
 
	mwªt_doş’gth
;

54 
boŞ
 
	mwªt_wdf
;

57 
boŞ
 
	mhave_ÿlcuÏ‹d_subŒ“_maxweights
;

59 
	mpublic
:

60 
	$SynÚymPo¡Li¡
(
Po¡Li¡
 * 
subŒ“_
, 
MuÉiM©ch
 * 
m©ch”_
)

61 : 
	`subŒ“
(
subŒ“_
), 
	`m©ch”
(
m©ch”_
), 
	`wt
(
NULL
),

62 
	`wªt_doş’gth
(
çl£
), 
	`wªt_wdf
(false),

63 
	$have_ÿlcuÏ‹d_subŒ“_maxweights
(
çl£
) { }

65 ~
	`SynÚymPo¡Li¡
();

72 
	`£t_weight
(cÚ¡ 
X­Ÿn
::
Weight
 * 
wt_
);

74 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

75 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

77 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

78 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

79 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

82 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

83 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

84 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

85 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

89 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

90 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

91 
boŞ
 
	$©_’d
() const;

93 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

95 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

96 
	}
};

	@matcher/valuegepostlist.cc

22 
	~<cÚfig.h
>

24 
	~"v®ueg•o¡li¡.h
"

26 
	~"autİŒ.h
"

27 
	~"omas£¹.h
"

28 
	~"docum’t.h
"

29 
	~"Ëaåo¡li¡.h
"

30 
	~"uts.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
Po¡Li¡
 *

35 
	gV®ueGePo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
)

37 
As£¹
(
db
);

38 ià(!
	g®ldocs_¶
è®ldocs_¶ = 
db
->
İ’_po¡_li¡
(
¡ršg
());

39 
	g®ldocs_¶
->
sk_to
(
cu¼’t
 + 1);

40 !
	g®ldocs_¶
->
©_’d
()) {

41 
	gcu¼’t
 = 
®ldocs_¶
->
g‘_docid
();

42 
	gAutoPŒ
<
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
> 
doc
(
db
->
İ’_docum’t
(
cu¼’t
, 
Œue
));

43 
¡ršg
 
	gv
 = 
doc
->
g‘_v®ue
(
v®no
);

44 ià(
	gv
 >ğ
begš
è 
NULL
;

45 
	g®ldocs_¶
->
Ãxt
();

47 
	gdb
 = 
NULL
;

48  
	gNULL
;

51 
Po¡Li¡
 *

52 
	gV®ueGePo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

54 
As£¹
(
db
);

55 ià(
	gdid
 <ğ
cu¼’t
è 
NULL
;

56 
	gcu¼’t
 = 
did
 - 1;

57  
	gV®ueGePo¡Li¡
::
Ãxt
(
w_mš
);

60 
Po¡Li¡
 *

61 
	gV®ueGePo¡Li¡
::
check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
, 
boŞ
 &
v®id
)

63 
As£¹
(
db
);

64 ià(
	gdid
 <ğ
cu¼’t
) {

65 
v®id
 = 
Œue
;

66  
	gNULL
;

68 
As£¹R–P¬ªoid
(
did
, <=, 
db
->
g‘_Ï¡docid
());

69 
	gcu¼’t
 = 
did
;

70 
	gAutoPŒ
<
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
> 
doc
(
db
->
İ’_docum’t
(
cu¼’t
, 
Œue
));

71 
¡ršg
 
	gv
 = 
doc
->
g‘_v®ue
(
v®no
);

72 
	gv®id
 = (
v
 >ğ
begš
);

73  
	gNULL
;

76 
¡ršg


77 
	gV®ueGePo¡Li¡
::
	$g‘_desütiÚ
() const

79 
¡ršg
 
desc
 = "ValueGePostList(";

80 
desc
 +ğ
	`om_to¡ršg
(
v®no
);

81 
desc
 += ", ";

82 
desc
 +ğ
begš
;

83 
desc
 += ")";

84  
desc
;

85 
	}
}

	@matcher/valuegepostlist.h

22 #iâdeà
XAPIAN_INCLUDED_VALUEGEPOSTLIST_H


23 
	#XAPIAN_INCLUDED_VALUEGEPOSTLIST_H


	)

25 
	~"v®u”ªg•o¡li¡.h
"

27 şas 
	cV®ueGePo¡Li¡
: 
public
 
V®ueRªgePo¡Li¡
 {

29 
V®ueGePo¡Li¡
(const ValueGePostList &);

32 
	mİ”©Ü
=(cÚ¡ 
V®ueGePo¡Li¡
 &);

34 
	mpublic
:

35 
V®ueGePo¡Li¡
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
db_
,

36 
X­Ÿn
::
v®u’o
 
v®no_
,

37 cÚ¡ 
¡d
::
¡ršg
 &
begš_
)

38 : 
V®ueRªgePo¡Li¡
(
db_
, 
v®no_
, 
begš_
, "") {}

40 
Po¡Li¡
 * 
Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

42 
Po¡Li¡
 * 
sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
 
w_mš
);

44 
Po¡Li¡
 * 
check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
, 
boŞ
 &
v®id
);

46 
¡ršg
 
	$g‘_desütiÚ
() const;

47 
	}
};

	@matcher/valuerangepostlist.cc

22 
	~<cÚfig.h
>

24 
	~"v®u”ªg•o¡li¡.h
"

26 
	~"autİŒ.h
"

27 
	~"omas£¹.h
"

28 
	~"docum’t.h
"

29 
	~"Ëaåo¡li¡.h
"

30 
	~"uts.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	gV®ueRªgePo¡Li¡
::~
	$V®ueRªgePo¡Li¡
()

36 
d–‘e
 
®ldocs_¶
;

37 
	}
}

39 
	gX­Ÿn
::
doccouÁ


40 
V®ueRªgePo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

43 
	}
}

45 
	gX­Ÿn
::
doccouÁ


46 
V®ueRªgePo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

48 
	`As£¹P¬ªoid
(!
db
 || 
db_size
 =ğdb->
	`g‘_doccouÁ
());

51  
db_size
 / 2;

52 
	}
}

54 
T”mF»qs


55 
	gV®ueRªgePo¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

56 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

58 
LOGCALL
(
MATCH
, 
T”mF»qs
,

59 "V®ueRªgePo¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

62 
RETURN
(
T”mF»qs
(
¡©s
.
cŞËùiÚ_size
 / 2, sts.
r£t_size
 / 2));

65 
	gX­Ÿn
::
doccouÁ


66 
V®ueRªgePo¡Li¡
::
	$g‘_‹rmäeq_max
() const

68 
	`As£¹P¬ªoid
(!
db
 || 
db_size
 =ğdb->
	`g‘_doccouÁ
());

69  
db_size
;

70 
	}
}

72 
	gX­Ÿn
::
weight


73 
V®ueRªgePo¡Li¡
::
	$g‘_maxweight
() const

76 
	}
}

78 
	gX­Ÿn
::
docid


79 
V®ueRªgePo¡Li¡
::
	$g‘_docid
() const

81 
	`As£¹
(
cu¼’t
);

82 
	`As£¹
(
db
);

83  
cu¼’t
;

84 
	}
}

86 
	gX­Ÿn
::
weight


87 
V®ueRªgePo¡Li¡
::
	$g‘_weight
() const

89 
	`As£¹
(
db
);

91 
	}
}

93 
	gX­Ÿn
::
‹rmcouÁ


94 
V®ueRªgePo¡Li¡
::
	$g‘_doş’gth
() const

96 
	`As£¹
(
db
);

98 
	}
}

100 
	gX­Ÿn
::
weight


101 
V®ueRªgePo¡Li¡
::
	$»ÿlc_maxweight
()

103 
	`As£¹
(
db
);

105 
	}
}

107 
Pos™iÚLi¡
 *

108 
	gV®ueRªgePo¡Li¡
::
	$»ad_pos™iÚ_li¡
()

110 
	`As£¹
(
db
);

111  
NULL
;

112 
	}
}

114 
Pos™iÚLi¡
 *

115 
	gV®ueRªgePo¡Li¡
::
	$İ’_pos™iÚ_li¡
() const

117 
	`As£¹
(
db
);

118  
NULL
;

119 
	}
}

121 
Po¡Li¡
 *

122 
	gV®ueRªgePo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
)

124 
As£¹
(
db
);

125 ià(!
	g®ldocs_¶
è®ldocs_¶ = 
db
->
İ’_po¡_li¡
(
¡ršg
());

126 
	g®ldocs_¶
->
sk_to
(
cu¼’t
 + 1);

127 !
	g®ldocs_¶
->
©_’d
()) {

128 
	gcu¼’t
 = 
®ldocs_¶
->
g‘_docid
();

129 
	gAutoPŒ
<
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
> 
doc
(
db
->
İ’_docum’t
(
cu¼’t
, 
Œue
));

130 
¡ršg
 
	gv
 = 
doc
->
g‘_v®ue
(
v®no
);

131 ià(
	gv
 >ğ
begš
 && 
v
 <ğ
’d
è 
NULL
;

132 
	g®ldocs_¶
->
Ãxt
();

134 
	gdb
 = 
NULL
;

135  
	gNULL
;

138 
Po¡Li¡
 *

139 
	gV®ueRªgePo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

141 
As£¹
(
db
);

142 ià(
	gdid
 <ğ
cu¼’t
è 
NULL
;

143 
	gcu¼’t
 = 
did
 - 1;

144  
	gV®ueRªgePo¡Li¡
::
Ãxt
(
w_mš
);

147 
Po¡Li¡
 *

148 
	gV®ueRªgePo¡Li¡
::
check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
, 
boŞ
 &
v®id
)

150 
As£¹
(
db
);

151 ià(
	gdid
 <ğ
cu¼’t
) {

152 
v®id
 = 
Œue
;

153  
	gNULL
;

155 
As£¹R–P¬ªoid
(
did
, <=, 
db
->
g‘_Ï¡docid
());

156 
	gcu¼’t
 = 
did
;

157 
	gAutoPŒ
<
	gX­Ÿn
::
Docum’t
::
IÁ”Çl
> 
doc
(
db
->
İ’_docum’t
(
cu¼’t
, 
Œue
));

158 
¡ršg
 
	gv
 = 
doc
->
g‘_v®ue
(
v®no
);

159 
	gv®id
 = (
v
 >ğ
begš
 && v <ğ
’d
);

160  
	gNULL
;

163 
boŞ


164 
	gV®ueRªgePo¡Li¡
::
	$©_’d
() const

166  (
db
 =ğ
NULL
);

167 
	}
}

169 
	gX­Ÿn
::
‹rmcouÁ


170 
V®ueRªgePo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

173 
	}
}

175 
¡ršg


176 
	gV®ueRªgePo¡Li¡
::
	$g‘_desütiÚ
() const

178 
¡ršg
 
desc
 = "ValueRangePostList(";

179 
desc
 +ğ
	`om_to¡ršg
(
v®no
);

180 
desc
 += ", ";

181 
desc
 +ğ
begš
;

182 
desc
 += ", ";

183 
desc
 +ğ
’d
;

184 
desc
 += ")";

185  
desc
;

186 
	}
}

	@matcher/valuerangepostlist.h

22 #iâdeà
XAPIAN_INCLUDED_VALUERANGEPOSTLIST_H


23 
	#XAPIAN_INCLUDED_VALUERANGEPOSTLIST_H


	)

25 
	~"d©aba£.h
"

26 
	~"po¡li¡.h
"

28 şas 
	cV®ueRªgePo¡Li¡
 : 
public
 
Po¡Li¡
 {

29 
´Ùeùed
:

30 cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
db
;

32 
	mX­Ÿn
::
v®u’o
 
v®no
;

34 cÚ¡ 
	m¡d
::
¡ršg
 
begš
, 
	m’d
;

36 
	mX­Ÿn
::
docid
 
cu¼’t
;

38 
	mX­Ÿn
::
doccouÁ
 
db_size
;

40 
L—fPo¡Li¡
 * 
	m®ldocs_¶
;

43 
V®ueRªgePo¡Li¡
(const ValueRangePostList &);

46 
	mİ”©Ü
=(cÚ¡ 
V®ueRªgePo¡Li¡
 &);

48 
	mpublic
:

49 
V®ueRªgePo¡Li¡
(cÚ¡ 
X­Ÿn
::
D©aba£
::
IÁ”Çl
 *
db_
,

50 
X­Ÿn
::
v®u’o
 
v®no_
,

51 cÚ¡ 
¡d
::
¡ršg
 &
begš_
, cÚ¡ std::¡ršg &
’d_
)

52 : 
db
(
db_
), 
v®no
(
v®no_
), 
begš
(
begš_
), 
’d
(
’d_
), 
cu¼’t
(0),

53 
db_size
(
db
->
g‘_doccouÁ
()), 
	$®ldocs_¶
(0) { }

55 ~
	`V®ueRªgePo¡Li¡
();

57 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

59 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

61 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

63 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

64 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

66 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

68 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

70 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

72 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

74 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

76 
Pos™iÚLi¡
 * 
	`»ad_pos™iÚ_li¡
();

78 
Pos™iÚLi¡
 * 
	$İ’_pos™iÚ_li¡
() const;

80 
Po¡Li¡
 * 
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

82 
Po¡Li¡
 * 
	`sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
 
w_mš
);

84 
Po¡Li¡
 * 
	`check
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
, 
boŞ
 &
v®id
);

86 
boŞ
 
	$©_’d
() const;

88 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

90 
¡ršg
 
	$g‘_desütiÚ
() const;

91 
	}
};

	@matcher/valuestreamdocument.cc

21 
	~<cÚfig.h
>

23 
	~"v®ue¡»amdocum’t.h
"

24 
	~"omas£¹.h
"

26 
usšg
 
Çme¥aû
 
	g¡d
;

29 
ş—r_v®u–i¡s
(
m­
<
X­Ÿn
::
v®u’o
, 
V®ueLi¡
 *> & 
v®u–i¡s
)

31 
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueLi¡
 *>::
cÚ¡_™”©Ü
 
i
;

32 
	gi
 = 
v®u–i¡s
.
begš
(); i !ğv®u–i¡s.
’d
(); ++i) {

33 
d–‘e
 
	gi
->
	g£cÚd
;

35 
	gv®u–i¡s
.
ş—r
();

38 
	gV®ueSŒ—mDocum’t
::~
	$V®ueSŒ—mDocum’t
()

40 
d–‘e
 
doc
;

41 
	`ş—r_v®u–i¡s
(
v®u–i¡s
);

42 
	}
}

45 
	gV®ueSŒ—mDocum’t
::
	$Ãw_subdb
(
n
)

47 
	`As£¹R–
(
n
,>,0);

48 
	`As£¹R–
(
	`size_t
(
n
),<,
db
.
š‹º®
.
	`size
());

49 
cu¼’t
 = (
n
);

50 
d©aba£
 = 
db
.
š‹º®
[
n
];

51 
	`ş—r_v®u–i¡s
(
v®u–i¡s
);

52 
	}
}

54 
¡ršg


55 
	gV®ueSŒ—mDocum’t
::
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const

57 #ifdeà
XAPIAN_ASSERTIONS_PARANOID


58 ià(!
doc
)

59 
doc
 = 
db
.
g‘_docum’t_Ïzy
(
did
);

62 
	g·œ
<
	gm­
<
	gX­Ÿn
::
v®u’o
, 
	gV®ueLi¡
 *>::
™”©Ü
, 
	gboŞ
> 
	g»t
;

63 
	g»t
 = 
v®u–i¡s
.
š£¹
(
make_·œ
(
¦Ù
, 
¡©ic_ÿ¡
<
V®ueLi¡
*>(
NULL
)));

64 
V®ueLi¡
 * 
	gvl
;

65 ià(
	g»t
.
	g£cÚd
) {

67 
	gvl
 = 
d©aba£
->
İ’_v®ue_li¡
(
¦Ù
);

68 
	g»t
.
	gfœ¡
->
	g£cÚd
 = 
vl
;

70 
	gvl
 = 
»t
.
fœ¡
->
£cÚd
;

71 ià(!
	gvl
) {

72 
As£¹EqP¬ªoid
(
¡ršg
(), 
doc
->
g‘_v®ue
(
¦Ù
));

73  
¡ršg
();

77 
size_t
 
	gmuÉl›r
 = 
db
.
š‹º®
.
size
();

78 
	gX­Ÿn
::
docid
 
sub_did
 = (
did
 - 
cu¼’t
 - 2 + 
muÉl›r
) / multiplier + 1;

79 
As£¹Eq
((
sub_did
 - 1è* 
muÉl›r
 + 
cu¼’t
 + 1, 
did
);

80 ià(
	gvl
->
check
(
sub_did
)) {

81 ià(
	gvl
->
©_’d
()) {

82 
d–‘e
 
	gvl
;

83 
	g»t
.
	gfœ¡
->
	g£cÚd
 = 
NULL
;

84 } ià(
	gvl
->
g‘_docid
(è=ğ
sub_did
) {

85 
As£¹
(
vl
);

86 
¡ršg
 
	gv
 = 
vl
->
g‘_v®ue
();

87 
As£¹Eq
(
v
, 
doc
->
g‘_v®ue
(
¦Ù
));

88  
	gv
;

91 
As£¹EqP¬ªoid
(
¡ršg
(), 
doc
->
g‘_v®ue
(
¦Ù
));

92  
¡ršg
();

96 
	gV®ueSŒ—mDocum’t
::
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v
) const

98 ià(!
	gdoc
)

99 
	gdoc
 = 
db
.
g‘_docum’t_Ïzy
(
did
);

100  
	gdoc
->
do_g‘_®l_v®ues
(
v
);

103 
¡ršg


104 
	gV®ueSŒ—mDocum’t
::
	$do_g‘_d©a
() const

106 ià(!
doc
)

107 
doc
 = 
db
.
	`g‘_docum’t_Ïzy
(
did
);

108  
doc
->
	`do_g‘_d©a
();

109 
	}
}

	@matcher/valuestreamdocument.h

21 #iâdeà
XAPIAN_INCLUDED_VALUESTREAMDOCUMENT_H


22 
	#XAPIAN_INCLUDED_VALUESTREAMDOCUMENT_H


	)

24 
	~"docum’t.h
"

25 
	~"v®u–i¡.h
"

26 
	~"x­Ÿn/ty³s.h
"

28 
	~<m­
>

31 şas 
	cV®ueSŒ—mDocum’t
 : 
public
 
X­Ÿn
::
Docum’t
::
IÁ”Çl
 {

33 
İ”©Ü
=(cÚ¡ 
V®ueSŒ—mDocum’t
 &);

36 
V®ueSŒ—mDocum’t
(const ValueStreamDocument &);

38 
mubË
 
	m¡d
::
m­
<
X­Ÿn
::
v®u’o
, 
	mV®ueLi¡
 *> 
	mv®u–i¡s
;

40 
	mX­Ÿn
::
D©aba£
 
db
;

42 
size_t
 
	mcu¼’t
;

44 
mubË
 
	mX­Ÿn
::
Docum’t
::
IÁ”Çl
 * 
doc
;

46 
	mpublic
:

47 
V®ueSŒ—mDocum’t
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db_
)

48 : 
IÁ”Çl
(
db_
.
š‹º®
[0], 0), 
db
(db_), 
cu¼’t
(0), 
	$doc
(
NULL
) { }

50 
	`Ãw_subdb
(
n
);

52 ~
	`V®ueSŒ—mDocum’t
();

54 
	`£t_docum’t
(
X­Ÿn
::
docid
 
did_
) {

55 
did
 = 
did_
;

56 
d–‘e
 
doc
;

57 
doc
 = 
NULL
;

58 
	}
}

61 
¡ršg
 
g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const {

62  
V®ueSŒ—mDocum’t
::
do_g‘_v®ue
(
¦Ù
);

65 
	g´iv©e
:

67 
¡ršg
 
do_g‘_v®ue
(
X­Ÿn
::
v®u’o
 
¦Ù
) const;

68 
do_g‘_®l_v®ues
(
m­
<
X­Ÿn
::
v®u’o
, 
¡ršg
> & 
v®ues_
) const;

69 
¡ršg
 
	$do_g‘_d©a
() const;

71 
	}
};

	@matcher/xorpostlist.cc

24 
	~<cÚfig.h
>

26 
	~"xÜpo¡li¡.h
"

27 
	~"ªdnÙpo¡li¡.h
"

28 
	~"omas£¹.h
"

29 
	~"omdebug.h
"

34 
šlše
 
Po¡Li¡
 *

35 
	gXÜPo¡Li¡
::
advªû_to_Ãxt_m©ch
(
X­Ÿn
::
weight
 
w_mš
)

37 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "XÜPo¡Li¡::advªû_to_Ãxt_m©ch", 
w_mš
);

38 
	grh—d
 =ğ
lh—d
) {

39 
Ãxt_hªdlšg_´uÃ
(
l
, 
w_mš
, 
m©ch”
);

40 
Ãxt_hªdlšg_´uÃ
(
r
, 
w_mš
, 
m©ch”
);

41 ià(
	gl
->
©_’d
()) {

42 ià(
	gr
->
©_’d
()) {

43 
	glh—d
 = 0;

44 
RETURN
(
NULL
);

46 
Po¡Li¡
 *
	g»t
 = 
r
;

47 
	gr
 = 
NULL
;

48 
RETURN
(
»t
);

50 ià(
	gr
->
©_’d
()) {

51 
Po¡Li¡
 *
	g»t
 = 
l
;

52 
	gl
 = 
NULL
;

53 
RETURN
(
»t
);

55 
	glh—d
 = 
l
->
g‘_docid
();

56 
	grh—d
 = 
r
->
g‘_docid
();

58 
RETURN
(
NULL
);

61 
	gXÜPo¡Li¡
::
XÜPo¡Li¡
(
Po¡Li¡
 *
Ëá_
,

62 
Po¡Li¡
 *
right_
,

63 
MuÉiM©ch
 *
m©ch”_
,

64 
X­Ÿn
::
doccouÁ
 
dbsize_
)

65 : 
B¿nchPo¡Li¡
(
Ëá_
, 
right_
, 
m©ch”_
),

66 
lh—d
(0),

67 
rh—d
(0),

68 
	$dbsize
(
dbsize_
)

70 
	`DEBUGCALL
(
MATCH
, , "XÜPo¡Li¡", 
Ëá_
 << ", " << 
right_
 << ", " << 
m©ch”_
 << ", " << 
dbsize_
);

71 
	}
}

73 
Po¡Li¡
 *

74 
	gXÜPo¡Li¡
::
Ãxt
(
X­Ÿn
::
weight
 
w_mš
)

76 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "XÜPo¡Li¡::Ãxt", 
w_mš
);

77 ià(
	gw_mš
 > 
	gmšmax
) {

79 
Po¡Li¡
 *
	g»t
;

80 ià(
	gw_mš
 > 
	glmax
) {

81 ià(
	gw_mš
 > 
	grmax
) {

82 
LOGLINE
(
MATCH
, "XOR drops below w_min");

84 
	glh—d
 = 0;

85 
RETURN
(
NULL
);

87 
LOGLINE
(
MATCH
, "XOR -> AND NOT (1)");

88 
	g»t
 = 
Ãw
 
AndNÙPo¡Li¡
(
r
, 
l
, 
m©ch”
, 
dbsize
);

91 
As£¹
(
w_mš
 > 
rmax
);

92 
LOGLINE
(
MATCH
, "XOR -> AND NOT (2)");

93 
	g»t
 = 
Ãw
 
AndNÙPo¡Li¡
(
l
, 
r
, 
m©ch”
, 
dbsize
);

96 
	gl
 = 
r
 = 
NULL
;

97 
Ãxt_hªdlšg_´uÃ
(
»t
, 
w_mš
, 
m©ch”
);

98 
RETURN
(
»t
);

101 
boŞ
 
	gldry
 = 
çl£
;

102 
boŞ
 
	gºext
 = 
çl£
;

104 ià(
	glh—d
 <ğ
rh—d
) {

106 ià(
lh—d
 =ğ
rh—d
è
ºext
 = 
Œue
;

107 
Ãxt_hªdlšg_´uÃ
(
l
, 
w_mš
, 
m©ch”
);

108 ià(
	gl
->
©_’d
()è
	gldry
 = 
Œue
;

110 
	gºext
 = 
Œue
;

113 ià(
	gºext
) {

114 
Ãxt_hªdlšg_´uÃ
(
r
, 
w_mš
, 
m©ch”
);

115 ià(
	gr
->
©_’d
()) {

116 
Po¡Li¡
 *
	g»t
 = 
l
;

117 
	gl
 = 
NULL
;

118 
RETURN
(
»t
);

120 
	grh—d
 = 
r
->
g‘_docid
();

123 ià(
	gldry
) {

124 
Po¡Li¡
 *
	g»t
 = 
r
;

125 
	gr
 = 
NULL
;

126 
RETURN
(
»t
);

129 
	glh—d
 = 
l
->
g‘_docid
();

130 
RETURN
(
advªû_to_Ãxt_m©ch
(
w_mš
));

133 
Po¡Li¡
 *

134 
	gXÜPo¡Li¡
::
sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
)

136 
DEBUGCALL
(
MATCH
, 
Po¡Li¡
 *, "XÜPo¡Li¡::sk_to", 
did
 << ", " << 
w_mš
);

137 ià(
	gw_mš
 > 
	gmšmax
) {

139 
Po¡Li¡
 *
	g»t
, *
	g»t2
;

140 ià(
	gw_mš
 > 
	glmax
) {

141 ià(
	gw_mš
 > 
	grmax
) {

142 
LOGLINE
(
MATCH
, "XOR drops below w_min");

144 
	glh—d
 = 0;

145 
RETURN
(
NULL
);

147 
LOGLINE
(
MATCH
, "XOR -> AND NOT (in skip_to) (1)");

148 
AndNÙPo¡Li¡
 *
	g»t3
 = 
Ãw
 AndNÙPo¡Li¡(
r
, 
l
, 
m©ch”
, 
dbsize
);

149 
	gdid
 = 
¡d
::
max
(
did
, 
rh—d
);

150 
	g»t2
 = 
»t3
->
sync_ªd_sk_to
(
did
, 
w_mš
, 
rh—d
, 
lh—d
);

151 
	g»t
 = 
»t3
;

154 
As£¹
(
w_mš
 > 
rmax
);

155 
LOGLINE
(
MATCH
, "XOR -> AND NOT (in skip_to) (2)");

156 
AndNÙPo¡Li¡
 *
	g»t3
 = 
Ãw
 AndNÙPo¡Li¡(
l
, 
r
, 
m©ch”
, 
dbsize
);

157 
	gdid
 = 
¡d
::
max
(
did
, 
lh—d
);

158 
	g»t2
 = 
»t3
->
sync_ªd_sk_to
(
did
, 
w_mš
, 
lh—d
, 
rh—d
);

159 
	g»t
 = 
»t3
;

162 
	gl
 = 
r
 = 
NULL
;

163 ià(
	g»t2
) {

164 
d–‘e
 
	g»t
;

165 
	g»t
 = 
»t2
;

167 
RETURN
(
»t
);

170 
boŞ
 
	gldry
 = 
çl£
;

171 ià(
	glh—d
 < 
	gdid
) {

172 
sk_to_hªdlšg_´uÃ
(
l
, 
did
, 
w_mš
, 
m©ch”
);

173 
	gldry
 = 
l
->
©_’d
();

176 ià(
	grh—d
 < 
	gdid
) {

177 
sk_to_hªdlšg_´uÃ
(
r
, 
did
, 
w_mš
, 
m©ch”
);

179 ià(
	gr
->
©_’d
()) {

180 
Po¡Li¡
 *
	g»t
 = 
l
;

181 
	gl
 = 
NULL
;

182 
RETURN
(
»t
);

184 
	grh—d
 = 
r
->
g‘_docid
();

187 ià(
	gldry
) {

188 
Po¡Li¡
 *
	g»t
 = 
r
;

189 
	gr
 = 
NULL
;

190 
RETURN
(
»t
);

193 
	glh—d
 = 
l
->
g‘_docid
();

194 
RETURN
(
advªû_to_Ãxt_m©ch
(
w_mš
));

197 
	gX­Ÿn
::
doccouÁ


198 
XÜPo¡Li¡
::
	$g‘_‹rmäeq_max
() const

200 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "XorPostList::get_termfreq_max", "");

201  
l
->
	`g‘_‹rmäeq_max
(è+ 
r
->get_termfreq_max();

202 
	}
}

204 
	gX­Ÿn
::
doccouÁ


205 
XÜPo¡Li¡
::
	$g‘_‹rmäeq_mš
() const

207 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "XorPostList::get_termfreq_min", "");

211 
X­Ÿn
::
doccouÁ
 
r_mš
 = 
r
->
	`g‘_‹rmäeq_mš
();

212 
X­Ÿn
::
doccouÁ
 
l_mš
 = 
l
->
	`g‘_‹rmäeq_mš
();

213 
X­Ÿn
::
doccouÁ
 
r_max
 = 
r
->
	`g‘_‹rmäeq_max
();

214 
X­Ÿn
::
doccouÁ
 
l_max
 = 
l
->
	`g‘_‹rmäeq_max
();

215 
X­Ÿn
::
doccouÁ
 
‹rmäeq_mš
 = 0u;

216 ià(
r_mš
 > 
l_max
)

217 
‹rmäeq_mš
 = 
r_mš
 - 
l_max
;

218 ià(
l_mš
 > 
r_max
 && (l_mš -„_maxè> 
‹rmäeq_mš
)

219 
‹rmäeq_mš
 = 
l_mš
 - 
r_max
;

221  
‹rmäeq_mš
;

222 
	}
}

224 
	gX­Ÿn
::
doccouÁ


225 
XÜPo¡Li¡
::
	$g‘_‹rmäeq_e¡
() const

227 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
doccouÁ
, "XorPostList::get_termfreq_est", "");

230 
Ë¡
 = 
¡©ic_ÿ¡
<>(
l
->
	`g‘_‹rmäeq_e¡
());

231 
»¡
 = 
¡©ic_ÿ¡
<>(
r
->
	`g‘_‹rmäeq_e¡
());

232 
e¡
 = 
Ë¡
 + 
»¡
 - (2.0 *†e¡ *„e¡ / 
dbsize
);

233 
	`RETURN
(
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
e¡
 + 0.5));

234 
	}
}

236 
T”mF»qs


237 
	gXÜPo¡Li¡
::
g‘_‹rmäeq_e¡_usšg_¡©s
(

238 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const

240 
LOGCALL
(
MATCH
, 
T”mF»qs
,

241 "XÜPo¡Li¡::g‘_‹rmäeq_e¡_usšg_¡©s", 
¡©s
);

244 
T”mF»qs
 
läeqs
(
l
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

245 
T”mF»qs
 
räeqs
(
r
->
g‘_‹rmäeq_e¡_usšg_¡©s
(
¡©s
));

247 
	gäeqe¡
, 
	g»läeqe¡
;

250 
As£¹
(
¡©s
.
cŞËùiÚ_size
);

252 
	gäeqe¡
 = 
läeqs
.
‹rmäeq
 + 
räeqs
.termfreq

253 - (2.0 * 
läeqs
.
‹rmäeq
 * 
räeqs
.termfreq

254 / 
¡©s
.
cŞËùiÚ_size
);

256 ià(
	g¡©s
.
	gr£t_size
 == 0) {

257 
»läeqe¡
 = 0;

259 
	g»läeqe¡
 = 
läeqs
.
»É”mäeq
 + 
räeqs
.reltermfreq

260 - (2.0 * 
läeqs
.
»É”mäeq
 * 
räeqs
.reltermfreq

261 / 
¡©s
.
r£t_size
);

264 
RETURN
(
T”mF»qs
(
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
äeqe¡
 + 0.5),

265 
¡©ic_ÿ¡
<
X­Ÿn
::
doccouÁ
>(
»läeqe¡
 + 0.5)));

268 
	gX­Ÿn
::
docid


269 
XÜPo¡Li¡
::
	$g‘_docid
() const

271 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
docid
, "XorPostList::get_docid", "");

272 
	`As£¹
(
lh—d
 !ğ0 && 
rh—d
 != 0);

273  
¡d
::
	`mš
(
lh—d
, 
rh—d
);

274 
	}
}

277 
	gX­Ÿn
::
weight


278 
XÜPo¡Li¡
::
	$g‘_weight
() const

280 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "XorPostList::get_weight", "");

281 
	`As£¹
(
lh—d
 !ğ0 && 
rh—d
 != 0);

282 ià(
lh—d
 < 
rh—d
è 
l
->
	`g‘_weight
();

283 
	`As£¹
(
lh—d
 > 
rh—d
);

284  
r
->
	`g‘_weight
();

285 
	}
}

288 
	gX­Ÿn
::
weight


289 
XÜPo¡Li¡
::
	$g‘_maxweight
() const

291 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "XorPostList::get_maxweight", "");

292  
¡d
::
	`max
(
lmax
, 
rmax
);

293 
	}
}

295 
	gX­Ÿn
::
weight


296 
XÜPo¡Li¡
::
	$»ÿlc_maxweight
()

298 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
weight
, "XorPostList::recalc_maxweight", "");

302 
lmax
 = 
l
->
	`»ÿlc_maxweight
();

303 
rmax
 = 
r
->
	`»ÿlc_maxweight
();

304 
mšmax
 = 
¡d
::
	`mš
(
lmax
, 
rmax
);

305  
XÜPo¡Li¡
::
	`g‘_maxweight
();

306 
	}
}

308 
boŞ


309 
	gXÜPo¡Li¡
::
	$©_’d
() const

311 
	`DEBUGCALL
(
MATCH
, 
boŞ
, "XorPostList::at_end", "");

312  
lh—d
 == 0;

313 
	}
}

315 
	g¡d
::
¡ršg


316 
XÜPo¡Li¡
::
	$g‘_desütiÚ
() const

318  "(" + 
l
->
	`g‘_desütiÚ
(è+ " XÜ " + 
r
->get_description() + ")";

319 
	}
}

321 
	gX­Ÿn
::
‹rmcouÁ


322 
XÜPo¡Li¡
::
	$g‘_doş’gth
() const

324 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "XorPostList::get_doclength", "");

325 
	`As£¹
(
lh—d
 !ğ0 && 
rh—d
 != 0);

326 ià(
lh—d
 < 
rh—d
è 
l
->
	`g‘_doş’gth
();

327 
	`As£¹
(
lh—d
 > 
rh—d
);

328  
r
->
	`g‘_doş’gth
();

329 
	}
}

331 
	gX­Ÿn
::
‹rmcouÁ


332 
XÜPo¡Li¡
::
	$g‘_wdf
() const

334 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "XorPostList::get_wdf", "");

335 ià(
lh—d
 < 
rh—d
è
	`RETURN
(
l
->
	`g‘_wdf
());

336 
	`RETURN
(
r
->
	`g‘_wdf
());

337 
	}
}

339 
	gX­Ÿn
::
‹rmcouÁ


340 
XÜPo¡Li¡
::
	$couÁ_m©chšg_subqs
() const

342 
	`DEBUGCALL
(
MATCH
, 
X­Ÿn
::
‹rmcouÁ
, "XorPostList::count_matching_subqs", "");

343 ià(
lh—d
 < 
rh—d
è
	`RETURN
(
l
->
	`couÁ_m©chšg_subqs
());

344 
	`RETURN
(
r
->
	`couÁ_m©chšg_subqs
());

345 
	}
}

	@matcher/xorpostlist.h

24 #iâdeà
OM_HGUARD_XORPOSTLIST_H


25 
	#OM_HGUARD_XORPOSTLIST_H


	)

27 
	~"b¿nchpo¡li¡.h
"

39 şas 
	cXÜPo¡Li¡
 : 
public
 
B¿nchPo¡Li¡
 {

40 
´iv©e
:

41 
X­Ÿn
::
docid
 
lh—d
, 
	mrh—d
;

42 
	mX­Ÿn
::
weight
 
lmax
, 
	mrmax
, 
	mmšmax
;

44 
	mX­Ÿn
::
doccouÁ
 
dbsize
;

46 
Po¡Li¡
 *
advªû_to_Ãxt_m©ch
(
X­Ÿn
::
weight
 
w_mš
);

47 
	mpublic
:

48 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
() const;

49 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
() const;

50 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
() const;

51 
T”mF»qs
 
	`g‘_‹rmäeq_e¡_usšg_¡©s
(

52 cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 & 
¡©s
) const;

54 
X­Ÿn
::
docid
 
	$g‘_docid
() const;

55 
X­Ÿn
::
weight
 
	$g‘_weight
() const;

56 
X­Ÿn
::
weight
 
	$g‘_maxweight
() const;

58 
X­Ÿn
::
weight
 
	`»ÿlc_maxweight
();

60 
Po¡Li¡
 *
	`Ãxt
(
X­Ÿn
::
weight
 
w_mš
);

61 
Po¡Li¡
 *
	`sk_to
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
w_mš
);

62 
boŞ
 
	$©_’d
() const;

64 
¡d
::
¡ršg
 
	$g‘_desütiÚ
() const;

69 
vœtu®
 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_doş’gth
() const;

71 
	`XÜPo¡Li¡
(
Po¡Li¡
 * 
Ëá_
,

72 
Po¡Li¡
 * 
right_
,

73 
MuÉiM©ch
 * 
m©ch”_
,

74 
X­Ÿn
::
doccouÁ
 
dbsize_
);

79 
X­Ÿn
::
‹rmcouÁ
 
	$g‘_wdf
() const;

81 
X­Ÿn
::
‹rmcouÁ
 
	$couÁ_m©chšg_subqs
() const;

	@net/progclient.cc

23 
	~<cÚfig.h
>

25 
	~"§ã”ºo.h
"

26 
	~"§ãfú.h
"

28 
	~"´ogş›Á.h
"

29 
	~<x­Ÿn/”rÜ.h
>

30 
	~"omdebug.h
"

32 
	~<¡ršg
>

33 
	~<veùÜ
>

35 
	~<sys/ty³s.h
>

36 #iâdeà
__WIN32__


37 
	~<sys/sock‘.h
>

38 
	~<sys/wa™.h
>

40 
	~<io.h
>

43 
usšg
 
Çme¥aû
 
	g¡d
;

45 #iâdeà
__WIN32__


50 
¥l™_wÜds
(cÚ¡ 
¡ršg
 &
‹xt
, 
veùÜ
<¡ršg> &
wÜds
, 
ws
 = ' ')

52 
size_t
 
i
 = 0;

53 ià(
	gi
 < 
	g‹xt
.
Ëngth
(è&&ext[0] =ğ
ws
) {

54 
i
 = 
‹xt
.
fšd_fœ¡_nÙ_of
(
ws
, i);

56 
	gi
 < 
	g‹xt
.
Ëngth
()) {

57 
size_t
 
	gj
 = 
‹xt
.
fšd_fœ¡_of
(
ws
, 
i
);

58 
	gwÜds
.
push_back
(
‹xt
.
sub¡r
(
i
, 
j
 - i));

59 
	gi
 = 
‹xt
.
fšd_fœ¡_nÙ_of
(
ws
, 
j
);

64 
	gProgCl›Á
::
	$ProgCl›Á
(cÚ¡ 
¡ršg
 &
´ogÇme
, cÚ¡ sŒšg &
¬gs
,

65 
m£cs_timeout
, 
boŞ
 
wr™abË
)

66 : 
	`RemÙeD©aba£
(
	`run_´og¿m
(
´ogÇme
, 
¬gs


67 #iâdeà
__WIN32__


68 , 
pid


71 
m£cs_timeout
,

72 
	`g‘_´ogcÚ‹xt
(
´ogÇme
, 
¬gs
),

73 
wr™abË
)

75 
	`DEBUGCALL
(
DB
, , "ProgCl›Á::ProgCl›Á", 
´ogÇme
 << ", " << 
¬gs
 <<

76 ", " << 
m£cs_timeout
 << ", " << 
wr™abË
);

77 
	}
}

79 
¡ršg


80 
	gProgCl›Á
::
	$g‘_´ogcÚ‹xt
(cÚ¡ 
¡ršg
 &
´ogÇme
, cÚ¡ sŒšg &
¬gs
)

82 
	`DEBUGCALL_STATIC
(
DB
, 
¡ršg
, "ProgCl›Á::g‘_´ogcÚ‹xt", 
´ogÇme
 <<

83 ", " << 
¬gs
);

84 
	`RETURN
("»mÙe:´og(" + 
´ogÇme
 + " " + 
¬gs
);

85 
	}
}

88 
	gProgCl›Á
::
run_´og¿m
(cÚ¡ 
¡ršg
 &
´ogÇme
, cÚ¡ sŒšg &
¬gs


89 #iâdeà
__WIN32__


90 , 
pid_t
 &
pid


94 #ià
defšed
 
HAVE_SOCKETPAIR
 && defšed 
HAVE_FORK


95 
DEBUGCALL_STATIC
(
DB
, , "ProgCl›Á::run_´og¿m", 
´ogÇme
 << ", " <<

96 
¬gs
 << ", [&pid]");

100 
	gsv
[2];

102 ià(
sock‘·œ
(
PF_UNIX
, 
SOCK_STREAM
, 0, 
sv
) < 0) {

103 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
(
¡ršg
("sock‘·œ faed"), 
g‘_´ogcÚ‹xt
(
´ogÇme
, 
¬gs
), 
”ºo
);

106 
	gpid
 = 
fÜk
();

108 ià(
	gpid
 < 0) {

109 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
(
¡ršg
("fÜk faed"), 
g‘_´ogcÚ‹xt
(
´ogÇme
, 
¬gs
), 
”ºo
);

112 ià(
	gpid
 != 0) {

115 ::
şo£
(
sv
[1]);

116  
	gsv
[0];

125 ::
şo£
(0);

126 ::
şo£
(1);

127 
dup2
(
sv
[1], 0);

128 
dup2
(
sv
[1], 1);

132 
	gfd
 = 2; fd < 256; ++fd) {

133 ::
şo£
(
fd
);

137 
	g¡d”rfd
 = 
İ’
("/dev/nuÎ", 
O_WRONLY
);

138 ià(
	g¡d”rfd
 == -1) {

139 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
(
¡ršg
("Redœeùšg std”¸tØ/dev/nuÎ faed"), 
g‘_´ogcÚ‹xt
(
´ogÇme
, 
¬gs
), 
”ºo
);

141 ià(
	g¡d”rfd
 != 2) {

143 
dup2
(
¡d”rfd
, 2);

144 ::
şo£
(
¡d”rfd
);

147 
	gveùÜ
<
	g¡ršg
> 
	g¬gvec
;

148 
¥l™_wÜds
(
¬gs
, 
¬gvec
);

152 cÚ¡ **
	gÃw_¬gv
 = 
Ãw
 cÚ¡ *[
¬gvec
.
size
() + 2];

154 
	gÃw_¬gv
[0] = 
´ogÇme
.
c_¡r
();

155 
	gveùÜ
<
	g¡ršg
>::
size_ty³
 
i
 = 0; 
	gi
 < 
	g¬gvec
.
size
(); ++i) {

156 
	gÃw_¬gv
[
i
 + 1] = 
¬gvec
[i].
c_¡r
();

158 
	gÃw_¬gv
[
¬gvec
.
size
() + 1] = 0;

159 
execvp
(
´ogÇme
.
c_¡r
(), 
cÚ¡_ÿ¡
<*cÚ¡ *>(
Ãw_¬gv
));

164 
_ex™
(-1);

165 #ifdeà
__sgi


169 #–ià
defšed
 
__WIN32__


170 
DEBUGCALL_STATIC
(
DB
, , "ProgCl›Á::run_´og¿m", 
´ogÇme
 << ", " <<

171 
¬gs
);

173 
	gpecouÁ
 = 0;

174 
	gp’ame
[256];

175 
¥rštf
(
p’ame
, "\\\\.\\pipe\\xapian-remote-%lx-%lx-%x",

176 ()
G‘Cu¼’tProûssId
(),

177 ()
G‘Cu¼’tTh»adId
(), 
pecouÁ
++);

179 
HANDLE
 
	ghPe
 = 
C»©eNamedPe
(
p’ame
,

180 
PIPE_ACCESS_DUPLEX
|
FILE_FLAG_OVERLAPPED
,

182 1, 4096, 4096, 
NMPWAIT_USE_DEFAULT_WAIT
,

183 
NULL
);

185 ià(
	ghPe
 =ğ
INVALID_HANDLE_VALUE
) {

186 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("CreateNamedPipe failed",

187 
g‘_´ogcÚ‹xt
(
´ogÇme
, 
¬gs
),

188 -()
G‘La¡E¼Ü
());

191 
HANDLE
 
	ghCl›Á
 = 
C»©eFe
(
p’ame
,

192 
GENERIC_READ
|
GENERIC_WRITE
, 0, 
NULL
, 
OPEN_EXISTING
,

193 
FILE_FLAG_OVERLAPPED
, 
NULL
);

195 ià(
	ghCl›Á
 =ğ
INVALID_HANDLE_VALUE
) {

196 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("CreateFile failed",

197 
g‘_´ogcÚ‹xt
(
´ogÇme
, 
¬gs
),

198 -()
G‘La¡E¼Ü
());

201 ià(!
CÚÃùNamedPe
(
hPe
, 
NULL
è&& 
G‘La¡E¼Ü
(è!ğ
ERROR_PIPE_CONNECTED
) {

202 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("ConnectNamedPipe failed",

203 
g‘_´ogcÚ‹xt
(
´ogÇme
, 
¬gs
),

204 -()
G‘La¡E¼Ü
());

208 
S‘HªdËInfÜm©iÚ
(
hCl›Á
, 
HANDLE_FLAG_INHERIT
, 1);

211 
PROCESS_INFORMATION
 
	g´ocšfo
;

212 
mem£t
(&
´ocšfo
, 0, (
PROCESS_INFORMATION
));

214 
STARTUPINFO
 
	g¡¬tupšfo
;

215 
mem£t
(&
¡¬tupšfo
, 0, (
STARTUPINFO
));

216 
	g¡¬tupšfo
.
	gcb
 = (
STARTUPINFO
);

217 
	g¡¬tupšfo
.
	ghStdE¼Ü
 = 
hCl›Á
;

218 
	g¡¬tupšfo
.
	ghStdOuut
 = 
hCl›Á
;

219 
	g¡¬tupšfo
.
	ghStdIÅut
 = 
hCl›Á
;

220 
	g¡¬tupšfo
.
	gdwFÏgs
 |ğ
STARTF_USESTDHANDLES
;

223 
BOOL
 
	gok
;

224 * 
	gcmdlše
 = 
¡rdup
((
´ogÇme
 + ' ' + 
¬gs
).
c_¡r
());

225 
	gok
 = 
C»©eProûss
(0, 
cmdlše
, 0, 0, 
TRUE
, 0, 0, 0, &
¡¬tupšfo
, &
´ocšfo
);

226 
ä“
(
cmdlše
);

227 ià(!
	gok
) {

228 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("CreateProcess failed",

229 
g‘_´ogcÚ‹xt
(
´ogÇme
, 
¬gs
),

230 -()
G‘La¡E¼Ü
());

233 
Clo£HªdË
(
hCl›Á
);

234 
Clo£HªdË
(
´ocšfo
.
hTh»ad
);

235  
_İ’_osfhªdË
((
šŒ_t
)
hPe
, 
O_RDWR
|
O_BINARY
);

239 
	gProgCl›Á
::~
	$ProgCl›Á
()

242 
	`do_şo£
();

243 #iâdeà
__WIN32__


244 
	`wa™pid
(
pid
, 0, 0);

246 
	}
}

	@net/remoteconnection.cc

21 
	~<cÚfig.h
>

23 
	~"»mÙecÚÃùiÚ.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"§ã”ºo.h
"

28 
	~"§ãfú.h
"

29 
	~"§ãuni¡d.h
"

31 
	~<®gÜ™hm
>

32 
	~<¡ršg
>

34 
	~"omas£¹.h
"

35 
	~"omdebug.h
"

36 
	~"omtime.h
"

37 
	~"£rŸli£.h
"

38 
	~"sock‘_uts.h
"

39 
	~"uts.h
"

41 #iâdeà
__WIN32__


42 
	~"§ãsys£Ëù.h
"

44 
	~"msvc_posix_w¿µ”.h
"

47 
usšg
 
Çme¥aû
 
	g¡d
;

49 
	#CHUNKSIZE
 4096

	)

51 #ifdeà
__WIN32__


52 
šlše
 

53 
	$upd©e_ov”Ïµed_off£t
(
WSAOVERLAPPED
 & 
ov”Ïµed
, 
DWORD
 
n
)

55 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
DWORD
);

56 
ov”Ïµed
.
Off£t
 +ğ
n
;

57 ià(
ov”Ïµed
.
Off£t
 < 
n
è++ov”Ïµed.
Off£tHigh
;

58 
	}
}

61 
	gRemÙeCÚÃùiÚ
::
	$RemÙeCÚÃùiÚ
(
fdš_
, 
fdout_
,

62 cÚ¡ 
¡ršg
 & 
cÚ‹xt_
)

63 : 
	`fdš
(
fdš_
), 
	`fdout
(
fdout_
), 
	$cÚ‹xt
(
cÚ‹xt_
)

65 #ifdeà
__WIN32__


66 
	`mem£t
(&
ov”Ïµed
, 0, (overlapped));

67 
ov”Ïµed
.
hEv’t
 = 
	`C»©eEv’t
(
NULL
, 
FALSE
, FALSE, NULL);

68 ià(!
ov”Ïµed
.
hEv’t
)

69 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Failedo setup OVERLAPPED",

70 
cÚ‹xt
, -()
	`G‘La¡E¼Ü
());

73 
	}
}

75 
	gRemÙeCÚÃùiÚ
::~
	$RemÙeCÚÃùiÚ
()

77 #ifdeà
__WIN32__


78 ià(
ov”Ïµed
.
hEv’t
)

79 
	`Clo£HªdË
(
ov”Ïµed
.
hEv’t
);

81 
	}
}

84 
	gRemÙeCÚÃùiÚ
::
	$»ad_©_Ëa¡
(
size_t
 
mš_Ën
, cÚ¡ 
OmTime
 & 
’d_time
)

86 
	`DEBUGCALL
(
REMOTE
, 
¡ršg
, "RemoteConnection::read_at_least",

87 
mš_Ën
 << ", " << 
’d_time
);

89 ià(
bufãr
.
	`Ëngth
(è>ğ
mš_Ën
) ;

91 #ifdeà
__WIN32__


92 
HANDLE
 
hš
 = 
	`fd_to_hªdË
(
fdš
);

94 
buf
[
CHUNKSIZE
];

95 
DWORD
 
»ûived
;

96 
BOOL
 
ok
 = 
	`R—dFe
(
hš
, 
buf
, (buf), &
»ûived
, &
ov”Ïµed
);

97 ià(!
ok
) {

98 
”rcode
 = 
	`G‘La¡E¼Ü
();

99 ià(
”rcode
 !ğ
ERROR_IO_PENDING
)

100 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("»ad faed", 
cÚ‹xt
, -
”rcode
);

102 
DWORD
 
wa™rc
;

103 
wa™rc
 = 
	`Wa™FÜSšgËObjeù
(
ov”Ïµed
.
hEv’t
, 
	`ÿlc_»ad_wa™_m£cs
(
’d_time
));

104 ià(
wa™rc
 !ğ
WAIT_OBJECT_0
) {

105 
	`LOGLINE
(
REMOTE
, "read:imeout hasƒxpired");

106 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØ»ad", 
cÚ‹xt
);

109 ià(!
	`G‘Ov”ÏµedResuÉ
(
hš
, &
ov”Ïµed
, &
»ûived
, 
FALSE
))

110 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Failedo get overlapped„esult",

111 
cÚ‹xt
, -()
	`G‘La¡E¼Ü
());

114 ià(
»ûived
 == 0)

115 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Reûived EOF", 
cÚ‹xt
);

117 
bufãr
.
	`­³nd
(
buf
, 
»ûived
);

120 
	`upd©e_ov”Ïµed_off£t
(
ov”Ïµed
, 
»ûived
);

121 } 
bufãr
.
	`Ëngth
(è< 
mš_Ën
);

124 ià(
	`fú
(
fdš
, 
F_SETFL
, 
’d_time
.
	`is_£t
(è? 
O_NONBLOCK
 : 0) < 0) {

125 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Failedo set fdin‚on-blocking-ness",

126 
cÚ‹xt
, 
”ºo
);

129 
Œue
) {

130 
buf
[
CHUNKSIZE
];

131 
ssize_t
 
»ûived
 = 
	`»ad
(
fdš
, 
buf
, (buf));

133 ià(
»ûived
 > 0) {

134 
bufãr
.
	`­³nd
(
buf
, 
»ûived
);

135 ià(
bufãr
.
	`Ëngth
(è>ğ
mš_Ën
) ;

139 ià(
»ûived
 == 0)

140 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Reûived EOF", 
cÚ‹xt
);

142 
	`LOGLINE
(
REMOTE
, "»ad gav”ºØğ" << 
	`¡»¼Ü
(
”ºo
));

143 ià(
”ºo
 =ğ
EINTR
) ;

145 ià(
”ºo
 !ğ
EAGAIN
)

146 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("»ad faed", 
cÚ‹xt
, 
”ºo
);

148 
	`As£¹
(
’d_time
.
	`is_£t
());

149 
Œue
) {

151 
OmTime
 
time_diff
 = 
’d_time
 - OmTime::
	`now
();

153 ià(
time_diff
.
£c
 < 0) {

154 
	`LOGLINE
(
REMOTE
, "read:imeout hasƒxpired");

155 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØ»ad", 
cÚ‹xt
);

158 
timev®
 
tv
;

159 
tv
.
tv_£c
 = 
time_diff
.
£c
;

160 
tv
.
tv_u£c
 = 
time_diff
.
u£c
;

163 
fd_£t
 
fd£t
;

164 
	`FD_ZERO
(&
fd£t
);

165 
	`FD_SET
(
fdš
, &
fd£t
);

167 
£Ëù_»suÉ
 = 
	`£Ëù
(
fdš
 + 1, &
fd£t
, 0, &fd£t, &
tv
);

168 ià(
£Ëù_»suÉ
 > 0) ;

170 ià(
£Ëù_»suÉ
 == 0)

171 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØ»ad", 
cÚ‹xt
);

174 ià(
”ºo
 !ğ
EINTR
)

175 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("£Ëù faed duršg„—d", 
cÚ‹xt
, 
”ºo
);

179 
	}
}

181 
boŞ


182 
	gRemÙeCÚÃùiÚ
::
	$»ady_to_»ad
() const

184 
	`DEBUGCALL
(
REMOTE
, 
boŞ
, "RemoteConnection::ready_to_read", "");

185 ià(
fdš
 == -1) {

186 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

189 ià(!
bufãr
.
	`em±y
()è
	`RETURN
(
Œue
);

192 
fd_£t
 
fd£t
;

193 
	`FD_ZERO
(&
fd£t
);

194 
	`FD_SET
(
fdš
, &
fd£t
);

199 
timev®
 
tv
;

200 
tv
.
tv_£c
 = 0;

201 
tv
.
tv_u£c
 = 100000;

202 
	`RETURN
(
	`£Ëù
(
fdš
 + 1, &
fd£t
, 0, &fd£t, &
tv
) > 0);

203 
	}
}

206 
	gRemÙeCÚÃùiÚ
::
	$£nd_mes§ge
(
ty³
, cÚ¡ 
¡ršg
 &
mes§ge
, cÚ¡ 
OmTime
 & 
’d_time
)

208 
	`DEBUGCALL
(
REMOTE
, , "RemoteConnection::send_message",

209 
ty³
 << ", " << 
mes§ge
 << ", " << 
’d_time
);

210 ià(
fdout
 == -1) {

211 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

214 
¡ršg
 
h—d”
;

215 
h—d”
 +ğ
ty³
;

216 
h—d”
 +ğ
	`’code_Ëngth
(
mes§ge
.
	`size
());

218 #ifdeà
__WIN32__


219 
HANDLE
 
hout
 = 
	`fd_to_hªdË
(
fdout
);

220 cÚ¡ 
¡ršg
 * 
¡r
 = &
h—d”
;

222 
size_t
 
couÁ
 = 0;

223 
Œue
) {

224 
DWORD
 
n
;

225 
BOOL
 
ok
 = 
	`Wr™eFe
(
hout
, 
¡r
->
	`d©a
(è+ 
couÁ
, sŒ->
	`size
(è- couÁ, &
n
, &
ov”Ïµed
);

226 ià(!
ok
) {

227 
”rcode
 = 
	`G‘La¡E¼Ü
();

228 ià(
”rcode
 !ğ
ERROR_IO_PENDING
)

229 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("wr™çed", 
cÚ‹xt
, -
”rcode
);

231 
DWORD
 
wa™rc
;

232 
wa™rc
 = 
	`Wa™FÜSšgËObjeù
(
ov”Ïµed
.
hEv’t
, 
	`ÿlc_»ad_wa™_m£cs
(
’d_time
));

233 ià(
wa™rc
 !ğ
WAIT_OBJECT_0
) {

234 
	`LOGLINE
(
REMOTE
, "write:imeout hasƒxpired");

235 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØwr™e", 
cÚ‹xt
);

238 ià(!
	`G‘Ov”ÏµedResuÉ
(
hout
, &
ov”Ïµed
, &
n
, 
FALSE
))

239 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Failedo get overlapped„esult",

240 
cÚ‹xt
, -()
	`G‘La¡E¼Ü
());

243 
couÁ
 +ğ
n
;

246 
	`upd©e_ov”Ïµed_off£t
(
ov”Ïµed
, 
n
);

248 ià(
couÁ
 =ğ
¡r
->
	`size
()) {

249 ià(
¡r
 =ğ&
mes§ge
 || mes§ge.
	`em±y
()) ;

250 
¡r
 = &
mes§ge
;

251 
couÁ
 = 0;

256 ià(
	`fú
(
fdout
, 
F_SETFL
, 
’d_time
.
	`is_£t
(è? 
O_NONBLOCK
 : 0) < 0) {

257 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Failedo set fdout‚on-blocking-ness",

258 
cÚ‹xt
, 
”ºo
);

261 cÚ¡ 
¡ršg
 * 
¡r
 = &
h—d”
;

263 
fd_£t
 
fd£t
;

264 
size_t
 
couÁ
 = 0;

265 
Œue
) {

268 
ssize_t
 
n
 = 
	`wr™e
(
fdout
, 
¡r
->
	`d©a
(è+ 
couÁ
, sŒ->
	`size
() - count);

270 ià(
n
 >= 0) {

271 
couÁ
 +ğ
n
;

272 ià(
couÁ
 =ğ
¡r
->
	`size
()) {

273 ià(
¡r
 =ğ&
mes§ge
 || mes§ge.
	`em±y
()) ;

274 
¡r
 = &
mes§ge
;

275 
couÁ
 = 0;

280 
	`LOGLINE
(
REMOTE
, "wr™gav”ºØğ" << 
	`¡»¼Ü
(
”ºo
));

281 ià(
”ºo
 =ğ
EINTR
) ;

283 ià(
”ºo
 !ğ
EAGAIN
)

284 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("wr™çed", 
cÚ‹xt
, 
”ºo
);

287 
	`FD_ZERO
(&
fd£t
);

288 
	`FD_SET
(
fdout
, &
fd£t
);

290 
OmTime
 
	`time_diff
(
’d_time
 - OmTime::
	`now
());

291 ià(
time_diff
.
£c
 < 0) {

292 
	`LOGLINE
(
REMOTE
, "write:imeout hasƒxpired");

293 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØwr™e", 
cÚ‹xt
);

296 
timev®
 
tv
;

297 
tv
.
tv_£c
 = 
time_diff
.
£c
;

298 
tv
.
tv_u£c
 = 
time_diff
.
u£c
;

300 
£Ëù_»suÉ
 = 
	`£Ëù
(
fdout
 + 1, 0, &
fd£t
, &fd£t, &
tv
);

302 ià(
£Ëù_»suÉ
 < 0) {

303 ià(
”ºo
 =ğ
EINTR
) {

309 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("£Ëù faed duršg wr™e", 
cÚ‹xt
, 
”ºo
);

312 ià(
£Ëù_»suÉ
 == 0)

313 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØwr™e", 
cÚ‹xt
);

316 
	}
}

319 
	gRemÙeCÚÃùiÚ
::
	$£nd_fe
(
ty³
, cÚ¡ 
¡ršg
 &
fe
, cÚ¡ 
OmTime
 & 
’d_time
)

321 
	`DEBUGCALL
(
REMOTE
, , "RemoteConnection::send_file",

322 
ty³
 << ", " << 
fe
 << ", " << 
’d_time
);

323 ià(
fdout
 == -1) {

324 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

327 #ifdeà
__WIN32__


328 
fd
 = 
	`msvc_posix_İ’
(
fe
.
	`c_¡r
(), 
O_RDONLY
);

330 
fd
 = 
	`İ’
(
fe
.
	`c_¡r
(), 
O_RDONLY
);

332 ià(
fd
 =ğ-1è
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("FnÙ found: " + 
fe
, 
”ºo
);

333 
fdşo£r
 
	`şo£fd
(
fd
);

335 
off_t
 
size
;

337 
¡©
 
sb
;

338 ià(
	`f¡©
(
fd
, &
sb
) == -1)

339 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Couldn'ˆ¡© fe: " + 
fe
, 
”ºo
);

340 
size
 = 
sb
.
¡_size
;

343 
buf
[
CHUNKSIZE
];

344 
buf
[0] = 
ty³
;

345 
size_t
 
c
 = 1;

347 
¡ršg
 
’c_size
 = 
	`’code_Ëngth
(
size
);

348 
c
 +ğ
’c_size
.
	`size
();

350 
	`As£¹R–
(
c
, <=, (
buf
));

351 
	`memıy
(
buf
 + 1, 
’c_size
.
	`d©a
(),ƒnc_size.
	`size
());

354 #ifdeà
__WIN32__


355 
HANDLE
 
hout
 = 
	`fd_to_hªdË
(
fdout
);

356 
size_t
 
couÁ
 = 0;

357 
Œue
) {

358 
DWORD
 
n
;

359 
BOOL
 
ok
 = 
	`Wr™eFe
(
hout
, 
buf
 + 
couÁ
, 
c
 - couÁ, &
n
, &
ov”Ïµed
);

360 ià(!
ok
) {

361 
”rcode
 = 
	`G‘La¡E¼Ü
();

362 ià(
”rcode
 !ğ
ERROR_IO_PENDING
)

363 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("wr™çed", 
cÚ‹xt
, -
”rcode
);

365 
DWORD
 
wa™rc
;

366 
wa™rc
 = 
	`Wa™FÜSšgËObjeù
(
ov”Ïµed
.
hEv’t
, 
	`ÿlc_»ad_wa™_m£cs
(
’d_time
));

367 ià(
wa™rc
 !ğ
WAIT_OBJECT_0
) {

368 
	`LOGLINE
(
REMOTE
, "write:imeout hasƒxpired");

369 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØwr™e", 
cÚ‹xt
);

372 ià(!
	`G‘Ov”ÏµedResuÉ
(
hout
, &
ov”Ïµed
, &
n
, 
FALSE
))

373 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Failedo get overlapped„esult",

374 
cÚ‹xt
, -()
	`G‘La¡E¼Ü
());

377 
couÁ
 +ğ
n
;

380 
	`upd©e_ov”Ïµed_off£t
(
ov”Ïµed
, 
n
);

382 ià(
couÁ
 =ğ
c
) {

383 ià(
size
 == 0) ;

385 
ssize_t
 
»s
;

387 
»s
 = 
	`»ad
(
fd
, 
buf
, (buf));

388 } 
»s
 < 0 && 
”ºo
 =ğ
EINTR
);

389 ià(
»s
 < 0è
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("»ad faed", 
”ºo
);

390 
c
 = 
	`size_t
(
»s
);

392 
size
 -ğ
c
;

393 
couÁ
 = 0;

398 ià(
	`fú
(
fdout
, 
F_SETFL
, 
’d_time
.
	`is_£t
(è? 
O_NONBLOCK
 : 0) < 0) {

399 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Failedo set fdout‚on-blocking-ness",

400 
cÚ‹xt
, 
”ºo
);

403 
fd_£t
 
fd£t
;

404 
size_t
 
couÁ
 = 0;

405 
Œue
) {

408 
ssize_t
 
n
 = 
	`wr™e
(
fdout
, 
buf
 + 
couÁ
, 
c
 - count);

410 ià(
n
 >= 0) {

411 
couÁ
 +ğ
n
;

412 ià(
couÁ
 =ğ
c
) {

413 ià(
size
 == 0) ;

415 
ssize_t
 
»s
;

417 
»s
 = 
	`»ad
(
fd
, 
buf
, (buf));

418 } 
»s
 < 0 && 
”ºo
 =ğ
EINTR
);

419 ià(
»s
 < 0è
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("»ad faed", 
”ºo
);

420 
c
 = 
	`size_t
(
»s
);

422 
size
 -ğ
c
;

423 
couÁ
 = 0;

428 
	`LOGLINE
(
REMOTE
, "wr™gav”ºØğ" << 
	`¡»¼Ü
(
”ºo
));

429 ià(
”ºo
 =ğ
EINTR
) ;

431 ià(
”ºo
 !ğ
EAGAIN
)

432 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("wr™çed", 
cÚ‹xt
, 
”ºo
);

435 
	`FD_ZERO
(&
fd£t
);

436 
	`FD_SET
(
fdout
, &
fd£t
);

438 
OmTime
 
	`time_diff
(
’d_time
 - OmTime::
	`now
());

439 ià(
time_diff
.
£c
 < 0) {

440 
	`LOGLINE
(
REMOTE
, "write:imeout hasƒxpired");

441 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØwr™e", 
cÚ‹xt
);

444 
timev®
 
tv
;

445 
tv
.
tv_£c
 = 
time_diff
.
£c
;

446 
tv
.
tv_u£c
 = 
time_diff
.
u£c
;

448 
£Ëù_»suÉ
 = 
	`£Ëù
(
fdout
 + 1, 0, &
fd£t
, &fd£t, &
tv
);

450 ià(
£Ëù_»suÉ
 < 0) {

451 ià(
”ºo
 =ğ
EINTR
) {

457 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("£Ëù faed duršg wr™e", 
cÚ‹xt
, 
”ºo
);

460 ià(
£Ëù_»suÉ
 == 0)

461 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed whŒyšgØwr™e", 
cÚ‹xt
);

464 
	}
}

467 
	gRemÙeCÚÃùiÚ
::
	$¢iff_Ãxt_mes§ge_ty³
(cÚ¡ 
OmTime
 & 
’d_time
)

469 
	`DEBUGCALL
(
REMOTE
, , "RemoteConnection::get_message",

470 "[»suÉ], " << 
’d_time
);

471 ià(
fdš
 == -1) {

472 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

475 
	`»ad_©_Ëa¡
(1, 
’d_time
);

476 
ty³
 = 
bufãr
[0];

477 
	`RETURN
(
ty³
);

478 
	}
}

481 
	gRemÙeCÚÃùiÚ
::
	$g‘_mes§ge
(
¡ršg
 &
»suÉ
, cÚ¡ 
OmTime
 & 
’d_time
)

483 
	`DEBUGCALL
(
REMOTE
, , "RemoteConnection::get_message",

484 "[»suÉ], " << 
’d_time
);

485 ià(
fdš
 == -1) {

486 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

489 
	`»ad_©_Ëa¡
(2, 
’d_time
);

490 
size_t
 
Ën
 = 
¡©ic_ÿ¡
<>(
bufãr
[1]);

491 
	`»ad_©_Ëa¡
(
Ën
 + 2, 
’d_time
);

492 ià(
Ën
 != 0xff) {

493 
»suÉ
.
	`assign
(
bufãr
.
	`d©a
(è+ 2, 
Ën
);

494 
ty³
 = 
bufãr
[0];

495 
bufãr
.
	`”a£
(0, 
Ën
 + 2);

496 
	`RETURN
(
ty³
);

498 
Ën
 = 0;

499 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
bufãr
.
	`begš
() + 2;

500 
ch
;

501 
shiá
 = 0;

503 ià(
i
 =ğ
bufãr
.
	`’d
(è|| 
shiá
 > 28) {

505 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Insane message†ength specified!");

507 
ch
 = *
i
++;

508 
Ën
 |ğ
	`size_t
(
ch
 & 0x7fè<< 
shiá
;

509 
shiá
 += 7;

510 } (
ch
 & 0x80) == 0);

511 
Ën
 += 255;

512 
size_t
 
h—d”_Ën
 = (
i
 - 
bufãr
.
	`begš
());

513 
	`»ad_©_Ëa¡
(
h—d”_Ën
 + 
Ën
, 
’d_time
);

514 
»suÉ
.
	`assign
(
bufãr
.
	`d©a
(è+ 
h—d”_Ën
, 
Ën
);

515 
ty³
 = 
bufãr
[0];

516 
bufãr
.
	`”a£
(0, 
h—d”_Ën
 + 
Ën
);

517 
	`RETURN
(
ty³
);

518 
	}
}

521 
	gRemÙeCÚÃùiÚ
::
	$g‘_mes§ge_chunked
(cÚ¡ 
OmTime
 & 
’d_time
)

523 
	`DEBUGCALL
(
REMOTE
, , "RemÙeCÚÃùiÚ::g‘_mes§ge_chunked", 
’d_time
);

524 ià(
fdš
 == -1) {

525 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

528 
	`»ad_©_Ëa¡
(2, 
’d_time
);

529 
off_t
 
Ën
 = 
¡©ic_ÿ¡
<>(
bufãr
[1]);

530 ià(
Ën
 != 0xff) {

531 
chunked_d©a_Ëá
 = 
Ën
;

532 
ty³
 = 
bufãr
[0];

533 
bufãr
.
	`”a£
(0, 2);

534 
	`RETURN
(
ty³
);

536 
	`»ad_©_Ëa¡
(
Ën
 + 2, 
’d_time
);

537 
Ën
 = 0;

538 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
bufãr
.
	`begš
() + 2;

539 
ch
;

540 
shiá
 = 0;

544 ià(
i
 =ğ
bufãr
.
	`’d
(è|| 
shiá
 > 63) {

546 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Insane message†ength specified!");

548 
ch
 = *
i
++;

549 
Ën
 |ğ
	`off_t
(
ch
 & 0x7fè<< 
shiá
;

550 
shiá
 += 7;

551 } (
ch
 & 0x80) == 0);

552 
Ën
 += 255;

553 
chunked_d©a_Ëá
 = 
Ën
;

554 
ty³
 = 
bufãr
[0];

555 
size_t
 
h—d”_Ën
 = (
i
 - 
bufãr
.
	`begš
());

556 
bufãr
.
	`”a£
(0, 
h—d”_Ën
);

557 
	`RETURN
(
ty³
);

558 
	}
}

560 
boŞ


561 
	gRemÙeCÚÃùiÚ
::
	$g‘_mes§ge_chunk
(
¡ršg
 &
»suÉ
, 
size_t
 
©_Ëa¡
,

562 cÚ¡ 
OmTime
 & 
’d_time
)

564 
	`DEBUGCALL
(
REMOTE
, 
boŞ
, "RemoteConnection::get_message_chunk",

565 
»suÉ
 << ", " << 
©_Ëa¡
 << ", " << 
’d_time
);

566 ià(
fdš
 == -1) {

567 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

570 ià(
©_Ëa¡
 <ğ
»suÉ
.
	`size
()è
	`RETURN
(
Œue
);

571 
©_Ëa¡
 -ğ
»suÉ
.
	`size
();

573 
boŞ
 
»ad_’ough
 = (
	`off_t
(
©_Ëa¡
è<ğ
chunked_d©a_Ëá
);

574 ià(!
»ad_’ough
è
©_Ëa¡
 = 
	`size_t
(
chunked_d©a_Ëá
);

576 
	`»ad_©_Ëa¡
(
©_Ëa¡
, 
’d_time
);

578 
size_t
 
	`»’
(
	`mš
(
	`off_t
(
bufãr
.
	`size
()), 
chunked_d©a_Ëá
));

579 
»suÉ
.
	`­³nd
(
bufãr
, 0, 
»’
);

580 
bufãr
.
	`”a£
(0, 
»’
);

581 
chunked_d©a_Ëá
 -ğ
»’
;

583 
	`RETURN
(
»ad_’ough
);

584 
	}
}

588 
	$wr™e_®l
(
fd
, cÚ¡ * 
p
, 
size_t
 
n
)

590 
n
) {

591 
ssize_t
 
c
 = 
	`wr™e
(
fd
, 
p
, 
n
);

592 ià(
c
 < 0) {

593 ià(
”ºo
 =ğ
EINTR
) ;

594 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("E¼Ü wr™šgØfe", 
”ºo
);

596 
p
 +ğ
c
;

597 
n
 -ğ
c
;

599 
	}
}

602 
	gRemÙeCÚÃùiÚ
::
	$»ûive_fe
(cÚ¡ 
¡ršg
 &
fe
, cÚ¡ 
OmTime
 & 
’d_time
)

604 
	`DEBUGCALL
(
REMOTE
, , "RemoteConnection::receive_file",

605 
fe
 << ", " << 
’d_time
);

606 ià(
fdš
 == -1) {

607 
throw
 
X­Ÿn
::
	`D©aba£E¼Ü
("Database has been closed");

610 #ifdeà
__WIN32__


612 
fd
 = 
	`msvc_posix_İ’
(
fe
.
	`c_¡r
(), 
O_WRONLY
|
O_CREAT
|
O_TRUNC
);

614 
fd
 = 
	`İ’
(
fe
.
	`c_¡r
(), 
O_WRONLY
|
O_CREAT
|
O_TRUNC
, 0666);

616 ià(
fd
 =ğ-1è
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Couldn'ˆİ’ ffÜ wr™šg: " + 
fe
, 
”ºo
);

617 
fdşo£r
 
	`şo£fd
(
fd
);

619 
	`»ad_©_Ëa¡
(2, 
’d_time
);

620 
size_t
 
Ën
 = 
¡©ic_ÿ¡
<>(
bufãr
[1]);

621 
	`»ad_©_Ëa¡
(
Ën
 + 2, 
’d_time
);

622 ià(
Ën
 != 0xff) {

623 
	`wr™e_®l
(
fd
, 
bufãr
.
	`d©a
(è+ 2, 
Ën
);

624 
ty³
 = 
bufãr
[0];

625 
bufãr
.
	`”a£
(0, 
Ën
 + 2);

626 
	`RETURN
(
ty³
);

628 
Ën
 = 0;

629 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
bufãr
.
	`begš
() + 2;

630 
ch
;

631 
shiá
 = 0;

633 ià(
i
 =ğ
bufãr
.
	`’d
(è|| 
shiá
 > 28) {

635 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Insane message†ength specified!");

637 
ch
 = *
i
++;

638 
Ën
 |ğ
	`size_t
(
ch
 & 0x7fè<< 
shiá
;

639 
shiá
 += 7;

640 } (
ch
 & 0x80) == 0);

641 
Ën
 += 255;

642 
size_t
 
h—d”_Ën
 = (
i
 - 
bufãr
.
	`begš
());

643 
size_t
 
	`»mašËn
(
	`mš
(
bufãr
.
	`size
(è- 
h—d”_Ën
, 
Ën
));

644 
	`wr™e_®l
(
fd
, 
bufãr
.
	`d©a
(è+ 
h—d”_Ën
, 
»mašËn
);

645 
Ën
 -ğ
»mašËn
;

646 
ty³
 = 
bufãr
[0];

647 
bufãr
.
	`”a£
(0, 
h—d”_Ën
 + 
»mašËn
);

648 
Ën
 > 0) {

649 
	`»ad_©_Ëa¡
(
	`mš
(
Ën
, 
	`size_t
(
CHUNKSIZE
)), 
’d_time
);

650 
»mašËn
 = 
	`mš
(
bufãr
.
	`size
(), 
Ën
);

651 
	`wr™e_®l
(
fd
, 
bufãr
.
	`d©a
(), 
»mašËn
);

652 
Ën
 -ğ
»mašËn
;

653 
bufãr
.
	`”a£
(0, 
»mašËn
);

655 
	`RETURN
(
ty³
);

656 
	}
}

659 
	gRemÙeCÚÃùiÚ
::
	$do_şo£
(
boŞ
 
wa™
)

661 
	`DEBUGCALL
(
REMOTE
, , "RemÙeCÚÃùiÚ::do_şo£", 
wa™
);

663 ià(
fdš
 >= 0) {

664 ià(
wa™
) {

667 
Œy
 {

668 
	`£nd_mes§ge
(
MSG_SHUTDOWN
, 
	`¡ršg
(), 
	`OmTime
());

669 } 
	`ÿtch
 (...) {

671 #ifdeà
__WIN32__


672 
HANDLE
 
hš
 = 
	`fd_to_hªdË
(
fdš
);

673 
dummy
;

674 
DWORD
 
»ûived
;

675 
BOOL
 
ok
 = 
	`R—dFe
(
hš
, &
dummy
, 1, &
»ûived
, &
ov”Ïµed
);

676 ià(!
ok
 && 
	`G‘La¡E¼Ü
(è=ğ
ERROR_IO_PENDING
) {

678 ()
	`Wa™FÜSšgËObjeù
(
ov”Ïµed
.
hEv’t
, 
INFINITE
);

683 
fd_£t
 
fd£t
;

684 
	`FD_ZERO
(&
fd£t
);

685 
	`FD_SET
(
fdš
, &
fd£t
);

686 
»s
;

688 
»s
 = 
	`£Ëù
(
fdš
 + 1, &
fd£t
, 0, &fd£t, 
NULL
);

689 } 
»s
 < 0 && 
”ºo
 =ğ
EINTR
);

692 
	`şo£_fd_Ü_sock‘
(
fdš
);

695 ià(
fdš
 =ğ
fdout
) fdout = -1;

697 
fdš
 = -1;

700 ià(
fdout
 >= 0) {

701 
	`şo£_fd_Ü_sock‘
(
fdout
);

702 
fdout
 = -1;

704 
	}
}

706 #ifdeà
__WIN32__


707 
DWORD


708 
	gRemÙeCÚÃùiÚ
::
	$ÿlc_»ad_wa™_m£cs
(cÚ¡ 
OmTime
 & 
’d_time
)

710 ià(!
’d_time
.
	`is_£t
())

711  
INFINITE
;

714 
OmTime
 
	`now
(OmTime::now());

716 
DWORD
 
m£cs
;

719 ià(
now
 > 
’d_time
) {

720 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
("Timeouˆexpœed befÜ¡¬tšg„—d", 
cÚ‹xt
);

722 
OmTime
 
time_diff
 = 
’d_time
 - 
now
;

723 
m£cs
 = 
time_diff
.
£c
 * 1000 +ime_diff.
u£c
 / 1000;

724  
m£cs
;

725 
	}
}

	@net/remoteserver.cc

22 
	~<cÚfig.h
>

23 
	~"»mÙe£rv”.h
"

25 
	~"x­Ÿn/d©aba£.h
"

26 
	~"x­Ÿn/’quœe.h
"

27 
	~"x­Ÿn/”rÜ.h
"

28 
	~"x­Ÿn/m©ch¥y.h
"

29 
	~"x­Ÿn/v®ue™”©Ü.h
"

31 
	~"§ã”ºo.h
"

32 
	~<sigÇl.h
>

33 
	~<c¡dlib
>

35 
	~"autİŒ.h
"

36 
	~"muÉim©ch.h
"

37 
	~"omas£¹.h
"

38 
	~"omtime.h
"

39 
	~"£rŸli£.h
"

40 
	~"£rŸli£-doubË.h
"

41 
	~"uts.h
"

42 
	~"weightš‹º®.h
"

45 
	sCÚÃùiÚClo£d
 { };

47 
	gRemÙeS”v”
::
RemÙeS”v”
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
db·ths
,

48 
fdš_
, 
fdout_
,

49 
X­Ÿn
::
timeout
 
aùive_timeout_
,

50 
X­Ÿn
::
timeout
 
idË_timeout_
,

51 
boŞ
 
wr™abË_
)

52 : 
RemÙeCÚÃùiÚ
(
fdš_
, 
fdout_
, 
¡d
::
¡ršg
()),

53 
db
(
NULL
), 
wdb
(NULL), 
wr™abË
(
wr™abË_
),

54 
aùive_timeout
(
aùive_timeout_
), 
	$idË_timeout
(
idË_timeout_
)

57 
Œy
 {

58 
	`As£¹
(!
db·ths
.
	`em±y
());

62 
db
 = 
Ãw
 
X­Ÿn
::
	`D©aba£
(
db·ths
[0]);

66 
cÚ‹xt
 = 
db·ths
[0];

68 ià(!
wr™abË
) {

69 
veùÜ
<
¡d
::
¡ršg
>::
cÚ¡_™”©Ü
 
	`i
(
db·ths
.
	`begš
());

70 ++
i
; i !ğ
db·ths
.
	`’d
(); ++i) {

71 
db
->
	`add_d©aba£
(
X­Ÿn
::
	`D©aba£
(*
i
));

72 
cÚ‹xt
 += ' ';

73 
cÚ‹xt
 +ğ*
i
;

76 
	`As£¹Eq
(
db·ths
.
	`size
(), 1);

78 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
”r
) {

80 
	`£nd_mes§ge
(
REPLY_EXCEPTION
, 
	`£rŸli£_”rÜ
(
”r
));

82 
throw
;

85 #iâdeà
__WIN32__


88 ià(
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
è=ğ
SIG_ERR
)

89 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Couldn'ˆ£ˆSIGPIPEØSIG_IGN", 
”ºo
);

93 
¡ršg
 
mes§ge
;

94 
mes§ge
 +ğ(
XAPIAN_REMOTE_PROTOCOL_MAJOR_VERSION
);

95 
mes§ge
 +ğ(
XAPIAN_REMOTE_PROTOCOL_MINOR_VERSION
);

96 
mes§ge
 +ğ
	`’code_Ëngth
(
db
->
	`g‘_doccouÁ
());

97 
mes§ge
 +ğ
	`’code_Ëngth
(
db
->
	`g‘_Ï¡docid
());

98 
mes§ge
 +ğ
	`’code_Ëngth
(
db
->
	`g‘_doş’gth_low”_bound
());

99 
mes§ge
 +ğ
	`’code_Ëngth
(
db
->
	`g‘_doş’gth_uµ”_bound
());

100 
mes§ge
 +ğ(
db
->
	`has_pos™iÚs
() ? '1' : '0');

102 
tÙËn_t
 
tÙ®_Ën
 = 
	`tÙËn_t
(
db
->
	`g‘_avËngth
(è* db->
	`g‘_doccouÁ
() + .5);

103 
mes§ge
 +ğ
	`’code_Ëngth
(
tÙ®_Ën
);

105 
¡ršg
 
uuid
 = 
db
->
	`g‘_uuid
();

106 
mes§ge
 +ğ
uuid
;

107 
	`£nd_mes§ge
(
REPLY_GREETING
, 
mes§ge
);

108 
	}
}

110 
	gRemÙeS”v”
::~
	$RemÙeS”v”
()

112 
d–‘e
 
db
;

114 
	}
}

116 
mes§ge_ty³


117 
	gRemÙeS”v”
::
g‘_mes§ge
(
X­Ÿn
::
timeout
imeout, 
¡ršg
 & 
»suÉ
,

118 
mes§ge_ty³
 
»quœed_ty³
)

120 
	gty³
;

121 
OmTime
 
	g’d_time
;

122 ià(
	gtimeout
)

123 
	g’d_time
 = 
OmTime
::
now
(è+ 
timeout
;

124 
	gty³
 = 
RemÙeCÚÃùiÚ
::
g‘_mes§ge
(
»suÉ
, 
’d_time
);

127 ià(
	gty³
 =ğ
MSG_SHUTDOWN
è
throw
 
CÚÃùiÚClo£d
();

128 ià(
	gty³
 >ğ
MSG_MAX
) {

129 
¡ršg
 
”rmsg
("Invalid messageype ");

130 
	g”rmsg
 +ğ
om_to¡ršg
(
ty³
);

131 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
(
”rmsg
);

133 ià(
	g»quœed_ty³
 !ğ
MSG_MAX
 && 
ty³
 !ğ(
»quœed_ty³
)) {

134 
¡ršg
 
”rmsg
("Expecting messageype ");

135 
	g”rmsg
 +ğ
om_to¡ršg
((
»quœed_ty³
));

136 
	g”rmsg
 += ", got ";

137 
	g”rmsg
 +ğ
om_to¡ršg
((
ty³
));

138 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
(
”rmsg
);

140  
	g¡©ic_ÿ¡
<
	gmes§ge_ty³
>(
	gty³
);

144 
	gRemÙeS”v”
::
	$£nd_mes§ge
(
»¶y_ty³
 
ty³
, cÚ¡ 
¡ršg
 &
mes§ge
)

146 
OmTime
 
’d_time
;

147 ià(
aùive_timeout
)

148 
’d_time
 = 
OmTime
::
	`now
(è+ 
aùive_timeout
;

149 
ty³_as_ch¬
 = 
¡©ic_ÿ¡
<>(
ty³
);

150 
RemÙeCÚÃùiÚ
::
	`£nd_mes§ge
(
ty³_as_ch¬
, 
mes§ge
, 
’d_time
);

151 
	}
}

153 (
	gRemÙeS”v”
::* 
	tdi¥©ch_func
)(cÚ¡ 
	t¡ršg
 &);

156 
	gRemÙeS”v”
::
	$run
()

158 
Œue
) {

159 
Œy
 {

165 cÚ¡ 
di¥©ch_func
 
di¥©ch
[] = {

166 &
RemÙeS”v”
::
msg_®É”ms
,

167 &
RemÙeS”v”
::
msg_cŞläeq
,

168 &
RemÙeS”v”
::
msg_docum’t
,

169 &
RemÙeS”v”
::
msg_‹rmexi¡s
,

170 &
RemÙeS”v”
::
msg_‹rmäeq
,

171 &
RemÙeS”v”
::
msg_v®ue¡©s
,

172 &
RemÙeS”v”
::
msg_k“·live
,

173 &
RemÙeS”v”
::
msg_doş’gth
,

174 &
RemÙeS”v”
::
msg_qu”y
,

175 &
RemÙeS”v”
::
msg_‹rmli¡
,

176 &
RemÙeS”v”
::
msg_pos™iÚli¡
,

177 &
RemÙeS”v”
::
msg_po¡li¡
,

178 &
RemÙeS”v”
::
msg_»İ’
,

179 &
RemÙeS”v”
::
msg_upd©e
,

180 &
RemÙeS”v”
::
msg_adddocum’t
,

181 &
RemÙeS”v”
::
msg_ÿnûl
,

182 &
RemÙeS”v”
::
msg_d–‘edocum’‰”m
,

183 &
RemÙeS”v”
::
msg_comm™
,

184 &
RemÙeS”v”
::
msg_»¶aûdocum’t
,

185 &
RemÙeS”v”
::
msg_»¶aûdocum’‰”m
,

186 &
RemÙeS”v”
::
msg_d–‘edocum’t
,

187 &
RemÙeS”v”
::
msg_wr™—cûss
,

188 &
RemÙeS”v”
::
msg_g‘m‘ad©a
,

189 &
RemÙeS”v”
::
msg_£tm‘ad©a
,

194 
¡ršg
 
mes§ge
;

195 
size_t
 
ty³
 = 
	`g‘_mes§ge
(
idË_timeout
, 
mes§ge
);

196 ià(
ty³
 >ğ(
di¥©ch
)/(dispatch[0])) {

197 
¡ršg
 
	`”rmsg
("Unexpected messageype ");

198 
”rmsg
 +ğ
	`om_to¡ršg
(
ty³
);

199 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
(
”rmsg
);

201 (
this
->*(
di¥©ch
[
ty³
]))(
mes§ge
);

202 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
N‘wÜkTimeoutE¼Ü
 & 
e
) {

203 
Œy
 {

207 
RemÙeCÚÃùiÚ
::
	`£nd_mes§ge
(
REPLY_EXCEPTION
, 
	`£rŸli£_”rÜ
(
e
), 
OmTime
::
	`now
());

208 } 
	`ÿtch
 (...) {

212 
throw
;

213 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
N‘wÜkE¼Ü
 &) {

219 
throw
;

220 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

223 
	`£nd_mes§ge
(
REPLY_EXCEPTION
, 
	`£rŸli£_”rÜ
(
e
));

224 } 
	`ÿtch
 (
CÚÃùiÚClo£d
 &) {

226 } 
	`ÿtch
 (...) {

228 
	`£nd_mes§ge
(
REPLY_EXCEPTION
, 
	`¡ršg
());

231 
throw
;

234 
	}
}

237 
	gRemÙeS”v”
::
	$msg_®É”ms
(cÚ¡ 
¡ršg
 &
mes§ge
)

239 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

240 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

241 
¡ršg
 
	`´efix
(
p
, 
p_’d
 -…);

243 cÚ¡ 
X­Ÿn
::
T”mI‹¿tÜ
 
’d
 = 
db
->
	`®É”ms_’d
(
´efix
);

244 
X­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
->
	`®É”ms_begš
(
´efix
); !ğ
’d
; ++t) {

245 
¡ršg
 
™em
 = 
	`’code_Ëngth
(
t
.
	`g‘_‹rmäeq
());

246 
™em
 +ğ*
t
;

247 
	`£nd_mes§ge
(
REPLY_ALLTERMS
, 
™em
);

250 
	`£nd_mes§ge
(
REPLY_DONE
, 
	`¡ršg
());

251 
	}
}

254 
	gRemÙeS”v”
::
	$msg_‹rmli¡
(cÚ¡ 
¡ršg
 &
mes§ge
)

256 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

257 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

258 
X­Ÿn
::
docid
 
did
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

260 
	`£nd_mes§ge
(
REPLY_DOCLENGTH
, 
	`’code_Ëngth
(
db
->
	`g‘_doş’gth
(
did
)));

261 cÚ¡ 
X­Ÿn
::
T”mI‹¿tÜ
 
’d
 = 
db
->
	`‹rmli¡_’d
(
did
);

262 
X­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
->
	`‹rmli¡_begš
(
did
); !ğ
’d
; ++t) {

263 
¡ršg
 
™em
 = 
	`’code_Ëngth
(
t
.
	`g‘_wdf
());

264 
™em
 +ğ
	`’code_Ëngth
(
t
.
	`g‘_‹rmäeq
());

265 
™em
 +ğ*
t
;

266 
	`£nd_mes§ge
(
REPLY_TERMLIST
, 
™em
);

269 
	`£nd_mes§ge
(
REPLY_DONE
, 
	`¡ršg
());

270 
	}
}

273 
	gRemÙeS”v”
::
	$msg_pos™iÚli¡
(cÚ¡ 
¡ršg
 &
mes§ge
)

275 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

276 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

277 
X­Ÿn
::
docid
 
did
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

278 
¡ršg
 
	`‹rm
(
p
, 
p_’d
 -…);

280 
X­Ÿn
::
‹rmpos
 
Ï¡pos
 = 
¡©ic_ÿ¡
<Xapian::termpos>(-1);

281 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
’d
 = 
db
->
	`pos™iÚli¡_’d
(
did
, 
‹rm
);

282 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
i
 = 
db
->
	`pos™iÚli¡_begš
(
did
, 
‹rm
);

283 
i
 !ğ
’d
; ++i) {

284 
X­Ÿn
::
‹rmpos
 
pos
 = *
i
;

285 
	`£nd_mes§ge
(
REPLY_POSITIONLIST
, 
	`’code_Ëngth
(
pos
 - 
Ï¡pos
 - 1));

286 
Ï¡pos
 = 
pos
;

289 
	`£nd_mes§ge
(
REPLY_DONE
, 
	`¡ršg
());

290 
	}
}

293 
	gRemÙeS”v”
::
	$msg_po¡li¡
(cÚ¡ 
¡ršg
 &
mes§ge
)

295 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

296 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

297 
¡ršg
 
	`‹rm
(
p
, 
p_’d
 -…);

299 
X­Ÿn
::
doccouÁ
 
‹rmäeq
 = 
db
->
	`g‘_‹rmäeq
(
‹rm
);

300 
X­Ÿn
::
‹rmcouÁ
 
cŞläeq
 = 
db
->
	`g‘_cŞËùiÚ_äeq
(
‹rm
);

301 
	`£nd_mes§ge
(
REPLY_POSTLISTSTART
, 
	`’code_Ëngth
(
‹rmäeq
è+ƒncode_Ëngth(
cŞläeq
));

303 
X­Ÿn
::
docid
 
Ï¡docid
 = 0;

304 cÚ¡ 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
’d
 = 
db
->
	`po¡li¡_’d
(
‹rm
);

305 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
i
 = 
db
->
	`po¡li¡_begš
(
‹rm
);

306 
i
 !ğ
’d
; ++i) {

308 
X­Ÿn
::
docid
 
Ãwdocid
 = *
i
;

309 
¡ršg
 
»¶y
 = 
	`’code_Ëngth
(
Ãwdocid
 - 
Ï¡docid
 - 1);

310 
»¶y
 +ğ
	`’code_Ëngth
(
i
.
	`g‘_wdf
());

312 
	`£nd_mes§ge
(
REPLY_POSTLISTITEM
, 
»¶y
);

313 
Ï¡docid
 = 
Ãwdocid
;

316 
	`£nd_mes§ge
(
REPLY_DONE
, 
	`¡ršg
());

317 
	}
}

320 
	gRemÙeS”v”
::
	$msg_wr™—cûss
(cÚ¡ 
¡ršg
 & 
msg
)

322 ià(!
wr™abË
)

323 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

325 
wdb
 = 
Ãw
 
X­Ÿn
::
	`Wr™abËD©aba£
(
cÚ‹xt
, X­Ÿn::
DB_OPEN
);

326 
d–‘e
 
db
;

327 
db
 = 
wdb
;

328 
	`msg_upd©e
(
msg
);

329 
	}
}

332 
	gRemÙeS”v”
::
	$msg_»İ’
(cÚ¡ 
¡ršg
 & 
msg
)

334 
db
->
	`»İ’
();

335 
	`msg_upd©e
(
msg
);

336 
	}
}

339 
	gRemÙeS”v”
::
	$msg_upd©e
(cÚ¡ 
¡ršg
 &)

343 
db
->
	`»İ’
();

345 
¡ršg
 
mes§ge
 = 
	`’code_Ëngth
(
db
->
	`g‘_doccouÁ
());

346 
mes§ge
 +ğ
	`’code_Ëngth
(
db
->
	`g‘_Ï¡docid
());

347 
mes§ge
 +ğ
	`’code_Ëngth
(
db
->
	`g‘_doş’gth_low”_bound
());

348 
mes§ge
 +ğ
	`’code_Ëngth
(
db
->
	`g‘_doş’gth_uµ”_bound
());

349 
mes§ge
 +ğ(
db
->
	`has_pos™iÚs
() ? '1' : '0');

351 
tÙËn_t
 
tÙ®_Ën
 = 
	`tÙËn_t
(
db
->
	`g‘_avËngth
(è* db->
	`g‘_doccouÁ
() + .5);

352 
mes§ge
 +ğ
	`’code_Ëngth
(
tÙ®_Ën
);

354 
¡ršg
 
uuid
 = 
db
->
	`g‘_uuid
();

355 
mes§ge
 +ğ
uuid
;

356 
	`£nd_mes§ge
(
REPLY_UPDATE
, 
mes§ge
);

357 
	}
}

364 
	sM©chSpyLi¡
 {

365 
	mveùÜ
<
	mX­Ÿn
::
M©chSpy
 *> 
¥›s
;

367 ~
M©chSpyLi¡
() {

368 
	mveùÜ
<
	mX­Ÿn
::
M©chSpy
 *>::
cÚ¡_™”©Ü
 
i
;

369 
	mi
 = 
¥›s
.
begš
(); i !ğ¥›s.
’d
(); ++i) {

370 
d–‘e
 *
	mi
;

376 
	gRemÙeS”v”
::
	$msg_qu”y
(cÚ¡ 
¡ršg
 &
mes§ge_š
)

378 cÚ¡ *
p
 = 
mes§ge_š
.
	`c_¡r
();

379 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge_š
.
	`size
();

380 
size_t
 
Ën
;

383 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

384 
AutoPŒ
<
X­Ÿn
::
Qu”y
::
IÁ”Çl
> 
	`qu”y
(X­Ÿn::Qu”y::IÁ”Çl::
	`un£rŸli£
(
	`¡ršg
(
p
, 
Ën
), 
»g
));

385 
p
 +ğ
Ën
;

388 
X­Ÿn
::
‹rmcouÁ
 
qËn
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

390 
X­Ÿn
::
v®u’o
 
cŞÏp£_max
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

392 
X­Ÿn
::
v®u’o
 
cŞÏp£_key
 = X­Ÿn::
BAD_VALUENO
;

393 ià(
cŞÏp£_max
è
cŞÏp£_key
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

395 ià(
p_’d
 - 
p
 < 4 || *p < '0' || *p > '2') {

396 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("bad message (docid_order)");

398 
X­Ÿn
::
Enquœe
::
docid_Üd”
 
Üd”
;

399 
Üd”
 = 
¡©ic_ÿ¡
<
X­Ÿn
::
Enquœe
::
docid_Üd”
>(*
p
++ - '0');

401 
X­Ÿn
::
v®u’o
 
sÜt_key
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

403 ià(*
p
 < '0' || *p > '3') {

404 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("bad message (sort_by)");

406 
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
 
sÜt_by
;

407 
sÜt_by
 = 
¡©ic_ÿ¡
<
X­Ÿn
::
Enquœe
::
IÁ”Çl
::
sÜt_£‰šg
>(*
p
++ - '0');

409 ià(*
p
 < '0' || *p > '1') {

410 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("bad message (sort_value_forward)");

412 
boŞ
 
	`sÜt_v®ue_fÜw¬d
(*
p
++ != '0');

414 
³rûÁ_cutoff
 = *
p
++;

415 ià(
³rûÁ_cutoff
 < 0 ||…ercent_cutoff > 100) {

416 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("bad message (percent_cutoff)");

419 
X­Ÿn
::
weight
 
weight_cutoff
 = 
	`un£rŸli£_doubË
(&
p
, 
p_’d
);

420 ià(
weight_cutoff
 < 0) {

421 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("bad message (weight_cutoff)");

425 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

426 
¡ršg
 
	`wŠame
(
p
, 
Ën
);

427 
p
 +ğ
Ën
;

429 cÚ¡ 
X­Ÿn
::
Weight
 * 
w‰y³
 = 
»g
.
	`g‘_weightšg_scheme
(
wŠame
);

430 ià(
w‰y³
 =ğ
NULL
) {

434 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Weighting scheme " +

435 
wŠame
 + "‚ot„egistered");

438 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

439 
AutoPŒ
<
X­Ÿn
::
Weight
> 
	`wt
(
w‰y³
->
	`un£rŸli£
(
	`¡ršg
(
p
, 
Ën
)));

440 
p
 +ğ
Ën
;

443 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

444 
X­Ÿn
::
RS‘
 
r£t
 = 
	`un£rŸli£_r£t
(
	`¡ršg
(
p
, 
Ën
));

445 
p
 +ğ
Ën
;

448 
M©chSpyLi¡
 
m©ch¥›s
;

449 
p
 !ğ
p_’d
) {

450 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

451 
¡ršg
 
	`¥yty³
(
p
, 
Ën
);

452 cÚ¡ 
X­Ÿn
::
M©chSpy
 * 
¥yşass
 = 
»g
.
	`g‘_m©ch_¥y
(
¥yty³
);

453 ià(
¥yşass
 =ğ
NULL
) {

454 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("M©ch spy " + 
¥yty³
 +

457 
p
 +ğ
Ën
;

459 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

460 
m©ch¥›s
.
¥›s
.
	`push_back
(
¥yşass
->
	`un£rŸli£
(
	`¡ršg
(
p
, 
Ën
), 
»g
));

461 
p
 +ğ
Ën
;

464 
X­Ÿn
::
Weight
::
IÁ”Çl
 
loÿl_¡©s
;

465 
MuÉiM©ch
 
	`m©ch
(*
db
, 
qu”y
.
	`g‘
(), 
qËn
, &
r£t
, 
cŞÏp£_max
, 
cŞÏp£_key
,

466 
³rûÁ_cutoff
, 
weight_cutoff
, 
Üd”
,

467 
sÜt_key
, 
sÜt_by
, 
sÜt_v®ue_fÜw¬d
, 
NULL
,

468 
loÿl_¡©s
, 
wt
.
	`g‘
(), 
m©ch¥›s
.
¥›s
, 
çl£
, false);

470 
	`£nd_mes§ge
(
REPLY_STATS
, 
	`£rŸli£_¡©s
(
loÿl_¡©s
));

472 
¡ršg
 
mes§ge
;

473 
	`g‘_mes§ge
(
aùive_timeout
, 
mes§ge
, 
MSG_GETMSET
);

474 
p
 = 
mes§ge
.
	`c_¡r
();

475 
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

477 
X­Ÿn
::
‹rmcouÁ
 
fœ¡
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

478 
X­Ÿn
::
‹rmcouÁ
 
max™ems
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

480 
X­Ÿn
::
‹rmcouÁ
 
check_©_Ëa¡
 = 0;

481 
check_©_Ëa¡
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

483 
mes§ge
.
	`”a£
(0, mes§ge.
	`size
(è- (
p_’d
 - 
p
));

484 
X­Ÿn
::
Weight
::
IÁ”Çl
 
	`tÙ®_¡©s
(
	`un£rŸli£_¡©s
(
mes§ge
));

485 
tÙ®_¡©s
.
	`£t_bounds_äom_db
(*
db
);

487 
X­Ÿn
::
MS‘
 
m£t
;

488 
m©ch
.
	`g‘_m£t
(
fœ¡
, 
max™ems
, 
check_©_Ëa¡
, 
m£t
, 
tÙ®_¡©s
, 0, 0, 0);

490 
mes§ge
.
	`»size
(0);

491 
veùÜ
<
X­Ÿn
::
M©chSpy
 *>::
cÚ¡_™”©Ü
 
i
;

492 
i
 = 
m©ch¥›s
.
¥›s
.
	`begš
(); i !ğm©ch¥›s.¥›s.
	`’d
(); ++i) {

493 
¡ršg
 
¥y_»suÉs
 = (*
i
)->
	`£rŸli£_»suÉs
();

494 
mes§ge
 +ğ
	`’code_Ëngth
(
¥y_»suÉs
.
	`size
());

495 
mes§ge
 +ğ
¥y_»suÉs
;

497 
mes§ge
 +ğ
	`£rŸli£_m£t
(
m£t
);

498 
	`£nd_mes§ge
(
REPLY_RESULTS
, 
mes§ge
);

499 
	}
}

502 
	gRemÙeS”v”
::
	$msg_docum’t
(cÚ¡ 
¡ršg
 &
mes§ge
)

504 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

505 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

506 
X­Ÿn
::
docid
 
did
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

508 
X­Ÿn
::
Docum’t
 
doc
 = 
db
->
	`g‘_docum’t
(
did
);

510 
	`£nd_mes§ge
(
REPLY_DOCDATA
, 
doc
.
	`g‘_d©a
());

512 
X­Ÿn
::
V®ueI‹¿tÜ
 
i
;

513 
i
 = 
doc
.
	`v®ues_begš
(); i !ğdoc.
	`v®ues_’d
(); ++i) {

514 
¡ršg
 
™em
 = 
	`’code_Ëngth
(
i
.
	`g‘_v®u’o
());

515 
™em
 +ğ*
i
;

516 
	`£nd_mes§ge
(
REPLY_VALUE
, 
™em
);

518 
	`£nd_mes§ge
(
REPLY_DONE
, 
	`¡ršg
());

519 
	}
}

522 
	gRemÙeS”v”
::
	$msg_k“·live
(cÚ¡ 
¡ršg
 &)

525 
db
->
	`k“p_®ive
();

526 
	`£nd_mes§ge
(
REPLY_DONE
, 
	`¡ršg
());

527 
	}
}

530 
	gRemÙeS”v”
::
	$msg_‹rmexi¡s
(cÚ¡ 
¡ršg
 &
‹rm
)

532 
	`£nd_mes§ge
((
db
->
	`‹rm_exi¡s
(
‹rm
è? 
REPLY_TERMEXISTS
 : 
REPLY_TERMDOESNTEXIST
), 
	`¡ršg
());

533 
	}
}

536 
	gRemÙeS”v”
::
	$msg_cŞläeq
(cÚ¡ 
¡ršg
 &
‹rm
)

538 
	`£nd_mes§ge
(
REPLY_COLLFREQ
, 
	`’code_Ëngth
(
db
->
	`g‘_cŞËùiÚ_äeq
(
‹rm
)));

539 
	}
}

542 
	gRemÙeS”v”
::
	$msg_‹rmäeq
(cÚ¡ 
¡ršg
 &
‹rm
)

544 
	`£nd_mes§ge
(
REPLY_TERMFREQ
, 
	`’code_Ëngth
(
db
->
	`g‘_‹rmäeq
(
‹rm
)));

545 
	}
}

548 
	gRemÙeS”v”
::
	$msg_v®ue¡©s
(cÚ¡ 
¡ršg
 & 
mes§ge
)

550 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

551 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

552 
p
 !ğ
p_’d
) {

553 
X­Ÿn
::
v®u’o
 
v®no
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

554 
¡ršg
 
mes§ge_out
;

555 
mes§ge_out
 +ğ
	`’code_Ëngth
(
db
->
	`g‘_v®ue_äeq
(
v®no
));

556 
¡ršg
 
bound
 = 
db
->
	`g‘_v®ue_low”_bound
(
v®no
);

557 
mes§ge_out
 +ğ
	`’code_Ëngth
(
bound
.
	`size
());

558 
mes§ge_out
 +ğ
bound
;

559 
bound
 = 
db
->
	`g‘_v®ue_uµ”_bound
(
v®no
);

560 
mes§ge_out
 +ğ
	`’code_Ëngth
(
bound
.
	`size
());

561 
mes§ge_out
 +ğ
bound
;

563 
	`£nd_mes§ge
(
REPLY_VALUESTATS
, 
mes§ge_out
);

565 
	}
}

568 
	gRemÙeS”v”
::
	$msg_doş’gth
(cÚ¡ 
¡ršg
 &
mes§ge
)

570 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

571 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

572 
X­Ÿn
::
docid
 
did
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

573 
	`£nd_mes§ge
(
REPLY_DOCLENGTH
, 
	`’code_Ëngth
(
db
->
	`g‘_doş’gth
(
did
)));

574 
	}
}

577 
	gRemÙeS”v”
::
	$msg_comm™
(cÚ¡ 
¡ršg
 &)

579 ià(!
wdb
)

580 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

582 
wdb
->
	`comm™
();

584 
	`£nd_mes§ge
(
REPLY_DONE
, 
	`¡ršg
());

585 
	}
}

588 
	gRemÙeS”v”
::
	$msg_ÿnûl
(cÚ¡ 
¡ršg
 &)

590 ià(!
wdb
)

591 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

595 
wdb
->
	`begš_Œª§ùiÚ
(
çl£
);

596 
wdb
->
	`ÿnûl_Œª§ùiÚ
();

597 
	}
}

600 
	gRemÙeS”v”
::
	$msg_adddocum’t
(cÚ¡ 
¡ršg
 & 
mes§ge
)

602 ià(!
wdb
)

603 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

605 
X­Ÿn
::
docid
 
did
 = 
wdb
->
	`add_docum’t
(
	`un£rŸli£_docum’t
(
mes§ge
));

607 
	`£nd_mes§ge
(
REPLY_ADDDOCUMENT
, 
	`’code_Ëngth
(
did
));

608 
	}
}

611 
	gRemÙeS”v”
::
	$msg_d–‘edocum’t
(cÚ¡ 
¡ršg
 & 
mes§ge
)

613 ià(!
wdb
)

614 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

616 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

617 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

618 
X­Ÿn
::
docid
 
did
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

620 
wdb
->
	`d–‘e_docum’t
(
did
);

622 
	`£nd_mes§ge
(
REPLY_DONE
, 
	`¡ršg
());

623 
	}
}

626 
	gRemÙeS”v”
::
	$msg_d–‘edocum’‰”m
(cÚ¡ 
¡ršg
 & 
mes§ge
)

628 ià(!
wdb
)

629 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

631 
wdb
->
	`d–‘e_docum’t
(
mes§ge
);

632 
	}
}

635 
	gRemÙeS”v”
::
	$msg_»¶aûdocum’t
(cÚ¡ 
¡ršg
 & 
mes§ge
)

637 ià(!
wdb
)

638 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

640 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

641 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

642 
X­Ÿn
::
docid
 
did
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

644 
wdb
->
	`»¶aû_docum’t
(
did
, 
	`un£rŸli£_docum’t
(
	`¡ršg
(
p
, 
p_’d
)));

645 
	}
}

648 
	gRemÙeS”v”
::
	$msg_»¶aûdocum’‰”m
(cÚ¡ 
¡ršg
 & 
mes§ge
)

650 ià(!
wdb
)

651 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

653 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

654 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

655 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

656 
¡ršg
 
	`unique_‹rm
(
p
, 
Ën
);

657 
p
 +ğ
Ën
;

659 
X­Ÿn
::
docid
 
did
 = 
wdb
->
	`»¶aû_docum’t
(
unique_‹rm
, 
	`un£rŸli£_docum’t
(
	`¡ršg
(
p
, 
p_’d
)));

661 
	`£nd_mes§ge
(
REPLY_ADDDOCUMENT
, 
	`’code_Ëngth
(
did
));

662 
	}
}

665 
	gRemÙeS”v”
::
	$msg_g‘m‘ad©a
(cÚ¡ 
¡ršg
 & 
mes§ge
)

667 
	`£nd_mes§ge
(
REPLY_METADATA
, 
db
->
	`g‘_m‘ad©a
(
mes§ge
));

668 
	}
}

671 
	gRemÙeS”v”
::
	$msg_£tm‘ad©a
(cÚ¡ 
¡ršg
 & 
mes§ge
)

673 ià(!
wdb
)

674 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Server is„ead-only");

675 cÚ¡ *
p
 = 
mes§ge
.
	`d©a
();

676 cÚ¡ *
p_’d
 = 
p
 + 
mes§ge
.
	`size
();

677 
size_t
 
keyËn
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

678 
¡ršg
 
	`key
(
p
, 
keyËn
);

679 
p
 +ğ
keyËn
;

680 
¡ršg
 
	`v®
(
p
, 
p_’d
 -…);

681 
wdb
->
	`£t_m‘ad©a
(
key
, 
v®
);

682 
	}
}

	@net/remotetcpclient.cc

21 
	~<cÚfig.h
>

23 
	~"»mÙ‘ış›Á.h
"

25 
	~<x­Ÿn/”rÜ.h
>

27 
	~"tış›Á.h
"

28 
	~"uts.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gRemÙeTıCl›Á
::
	$İ’_sock‘
(cÚ¡ 
¡ršg
 & 
ho¡Çme
, 
pÜt
,

34 
m£cs_timeout_cÚÃù
)

37 
Œy
 {

38  
TıCl›Á
::
	`İ’_sock‘
(
ho¡Çme
, 
pÜt
, 
m£cs_timeout_cÚÃù
, 
Œue
);

39 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
N‘wÜkTimeoutE¼Ü
 & 
e
) {

40 
throw
 
X­Ÿn
::
	`N‘wÜkTimeoutE¼Ü
(
e
.
	`g‘_msg
(), 
	`g‘_tıcÚ‹xt
(
ho¡Çme
, 
pÜt
),

41 
e
.
	`g‘_”rÜ_¡ršg
());

42 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
N‘wÜkE¼Ü
 & 
e
) {

43 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
(
e
.
	`g‘_msg
(), 
	`g‘_tıcÚ‹xt
(
ho¡Çme
, 
pÜt
),

44 
e
.
	`g‘_”rÜ_¡ršg
());

46 
	}
}

48 
¡ršg


49 
	gRemÙeTıCl›Á
::
	$g‘_tıcÚ‹xt
(cÚ¡ 
¡ršg
 & 
ho¡Çme
, 
pÜt
)

51 
¡ršg
 
	`»suÉ
("remote:tcp(");

52 
»suÉ
 +ğ
ho¡Çme
;

53 
»suÉ
 += ':';

54 
»suÉ
 +ğ
	`om_to¡ršg
(
pÜt
);

55 
»suÉ
 += ')';

56  
»suÉ
;

57 
	}
}

59 
	gRemÙeTıCl›Á
::~
	$RemÙeTıCl›Á
()

61 
	`do_şo£
();

62 
	}
}

	@net/remotetcpserver.cc

23 
	~<cÚfig.h
>

25 
	~"»mÙ‘ı£rv”.h
"

27 
	~<x­Ÿn/”rÜ.h
>

29 
	~"»mÙe£rv”.h
"

31 
	~<io¡»am
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	gRemÙeTıS”v”
::
RemÙeTıS”v”
(cÚ¡ 
veùÜ
<
¡d
::
¡ršg
> &
db·ths_
,

37 cÚ¡ 
¡d
::
¡ršg
 & 
ho¡
, 
pÜt
,

38 
m£cs_aùive_timeout_
,

39 
m£cs_idË_timeout_
,

40 
boŞ
 
wr™abË_
,

41 
boŞ
 
v”bo£_
)

42 : 
TıS”v”
(
ho¡
, 
pÜt
, 
Œue
, 
v”bo£_
),

43 
db·ths
(
db·ths_
), 
wr™abË
(
wr™abË_
),

44 
m£cs_aùive_timeout
(
m£cs_aùive_timeout_
),

45 
	$m£cs_idË_timeout
(
m£cs_idË_timeout_
)

47 
	}
}

50 
	gRemÙeTıS”v”
::
	$hªdË_Úe_cÚÃùiÚ
(
sock‘
)

52 
Œy
 {

53 
RemÙeS”v”
 
	`s£rv
(
db·ths
, 
sock‘
, socket,

54 
m£cs_aùive_timeout
, 
m£cs_idË_timeout
,

55 
wr™abË
);

56 
s£rv
.
	`run
();

57 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
N‘wÜkTimeoutE¼Ü
 &
e
) {

58 ià(
v”bo£
)

59 
û¼
 << "CÚÃùiÚimed out: " << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

60 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

61 
û¼
 << "GÙƒxû±iÚ " << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

62 } 
	`ÿtch
 (...) {

65 
	}
}

	@net/replicatetcpclient.cc

21 
	~<cÚfig.h
>

23 
	~"»¶iÿ‹tış›Á.h
"

25 
	~"»¶iÿtiÚ.h
"

27 
	~"omtime.h
"

28 
	~"tış›Á.h
"

29 
	~"uts.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	gR•liÿ‹TıCl›Á
::
	$R•liÿ‹TıCl›Á
(cÚ¡ 
¡ršg
 & 
ho¡Çme
, 
pÜt
,

34 
m£cs_timeout_cÚÃù
)

35 : 
	`sock‘
(
	`İ’_sock‘
(
ho¡Çme
, 
pÜt
, 
m£cs_timeout_cÚÃù
)),

36 
	`»mcÚn
(-1, 
sock‘
, "")

38 
	}
}

41 
	gR•liÿ‹TıCl›Á
::
	$İ’_sock‘
(cÚ¡ 
¡ršg
 & 
ho¡Çme
, 
pÜt
,

42 
m£cs_timeout_cÚÃù
)

44  
TıCl›Á
::
	`İ’_sock‘
(
ho¡Çme
, 
pÜt
, 
m£cs_timeout_cÚÃù
, 
çl£
);

45 
	}
}

48 
	gR•liÿ‹TıCl›Á
::
upd©e_äom_ma¡”
(cÚ¡ 
¡d
::
¡ršg
 & 
·th
,

49 cÚ¡ 
¡d
::
¡ršg
 & 
ma¡”db
,

50 
X­Ÿn
::
R•liÿtiÚInfo
 & 
šfo
)

52 
X­Ÿn
::
D©aba£R•liÿ
 
»¶iÿ
(
·th
);

53 
	g»mcÚn
.
£nd_mes§ge
('R', 
»¶iÿ
.
g‘_»visiÚ_šfo
(), 
OmTime
());

54 
	g»mcÚn
.
£nd_mes§ge
('D', 
ma¡”db
, 
OmTime
());

55 
	g»¶iÿ
.
£t_»ad_fd
(
sock‘
);

56 
	gšfo
.
ş—r
();

57 
	gX­Ÿn
::
R•liÿtiÚInfo
 
subšfo
;

58 
	g»¶iÿ
.
­¶y_Ãxt_chªge£t
(&
subšfo
)) {

59 
¦“p
(30);

60 
	gšfo
.
	gchªge£t_couÁ
 +ğ
subšfo
.
chªge£t_couÁ
;

61 
	gšfo
.
	gfuÎcİy_couÁ
 +ğ
subšfo
.
fuÎcİy_couÁ
;

62 ià(
	gsubšfo
.
	gchªged
)

63 
	gšfo
.
	gchªged
 = 
Œue
;

65 
	gšfo
.
	gchªge£t_couÁ
 +ğ
subšfo
.
chªge£t_couÁ
;

66 
	gšfo
.
	gfuÎcİy_couÁ
 +ğ
subšfo
.
fuÎcİy_couÁ
;

67 ià(
	gsubšfo
.
	gchªged
)

68 
	gšfo
.
	gchªged
 = 
Œue
;

71 
	gR•liÿ‹TıCl›Á
::~
	$R•liÿ‹TıCl›Á
()

73 
»mcÚn
.
	`do_şo£
(
Œue
);

74 
	}
}

	@net/replicatetcpserver.cc

21 
	~<cÚfig.h
>

23 
	~"»¶iÿ‹tı£rv”.h
"

25 
	~<x­Ÿn/”rÜ.h
>

26 
	~"»¶iÿtiÚ.h
"

28 
	~"omtime.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	gR•liÿ‹TıS”v”
::
	$R•liÿ‹TıS”v”
(cÚ¡ 
¡ršg
 & 
ho¡
, 
pÜt
,

33 cÚ¡ 
¡ršg
 & 
·th_
)

34 : 
	`TıS”v”
(
ho¡
, 
pÜt
, 
çl£
, f®£), 
	$·th
(
·th_
)

36 
	}
}

38 
	gR•liÿ‹TıS”v”
::~
	$R•liÿ‹TıS”v”
() {

39 
	}
}

42 
R•liÿ‹TıS”v”
::
	$hªdË_Úe_cÚÃùiÚ
(
sock‘
)

44 
RemÙeCÚÃùiÚ
 
	`ş›Á
(
sock‘
, -1, "");

45 
Œy
 {

47 
¡ršg
 
¡¬t_»visiÚ
;

48 ià(
ş›Á
.
	`g‘_mes§ge
(
¡¬t_»visiÚ
, 
	`OmTime
()) != 'R') {

49 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Bad„eplication client message");

53 
¡ršg
 
dbÇme
;

54 ià(
ş›Á
.
	`g‘_mes§ge
(
dbÇme
, 
	`OmTime
()) != 'D') {

55 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Bad„eplication client message (2)");

57 ià(
dbÇme
.
	`fšd
(".."è!ğ
¡ršg
::
Åos
) {

58 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("dbname contained '..'");

61 
¡ršg
 
	`db·th
(
·th
);

62 
db·th
 += '/';

63 
db·th
 +ğ
dbÇme
;

64 
X­Ÿn
::
D©aba£Ma¡”
 
	`ma¡”
(
db·th
);

65 
ma¡”
.
	`wr™e_chªge£ts_to_fd
(
sock‘
, 
¡¬t_»visiÚ
, 
NULL
);

66 } 
	`ÿtch
 (...) {

69 
	}
}

	@net/serialise.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/docum’t.h
>

24 
	~<x­Ÿn/”rÜ.h
>

25 
	~<x­Ÿn/pos™iÚ™”©Ü.h
>

26 
	~<x­Ÿn/‹rm™”©Ü.h
>

27 
	~<x­Ÿn/v®ue™”©Ü.h
>

29 
	~"omas£¹.h
"

30 
	~"om’quœeš‹º®.h
"

31 
	~"£rŸli£.h
"

32 
	~"£rŸli£-doubË.h
"

33 
	~"uts.h
"

34 
	~"weightš‹º®.h
"

36 
	~<¡ršg
>

37 
	~<c¡ršg
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
size_t


42 
	$decode_Ëngth
(cÚ¡ ** 
p
, cÚ¡ *
’d
, 
boŞ
 
check_»maššg
)

44 ià(*
p
 =ğ
’d
) {

45 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Badƒncoded†ength:‚o data");

48 
size_t
 
Ën
 = 
¡©ic_ÿ¡
<>(*(*
p
)++);

49 ià(
Ën
 == 0xff) {

50 
Ën
 = 0;

51 
ch
;

52 
shiá
 = 0;

54 ià(*
p
 =ğ
’d
 || 
shiá
 > 28)

55 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Badƒncoded†ength: insufficient data");

56 
ch
 = *(*
p
)++;

57 
Ën
 |ğ
	`size_t
(
ch
 & 0x7fè<< 
shiá
;

58 
shiá
 += 7;

59 } (
ch
 & 0x80) == 0);

60 
Ën
 += 255;

62 ià(
check_»maššg
 && 
Ën
 > 
	`size_t
(
’d
 - *
p
)) {

63 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Badƒncoded†ength:†ength greaterhan data");

65  
Ën
;

66 
	}
}

68 
¡ršg


69 
£rŸli£_”rÜ
(cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
)

71 
¡ršg
 
»suÉ
;

72 
	g»suÉ
 +ğ
’code_Ëngth
(
¡¾’
(
e
.
g‘_ty³
()));

73 
	g»suÉ
 +ğ
e
.
g‘_ty³
();

74 
	g»suÉ
 +ğ
’code_Ëngth
(
e
.
g‘_cÚ‹xt
().
Ëngth
());

75 
	g»suÉ
 +ğ
e
.
g‘_cÚ‹xt
();

76 
	g»suÉ
 +ğ
’code_Ëngth
(
e
.
g‘_msg
().
Ëngth
());

77 
	g»suÉ
 +ğ
e
.
g‘_msg
();

79 cÚ¡ * 
	g”r
 = 
e
.
g‘_”rÜ_¡ršg
();

80 ià(
	g”r
è
	g»suÉ
 +ğ
”r
;

81  
	g»suÉ
;

85 
	$un£rŸli£_”rÜ
(cÚ¡ 
¡ršg
 &
£rŸli£d_”rÜ
, cÚ¡ sŒšg &
´efix
,

86 cÚ¡ 
¡ršg
 &
Ãw_cÚ‹xt
)

89 cÚ¡ * 
p
 = 
£rŸli£d_”rÜ
.
	`c_¡r
();

90 cÚ¡ * 
’d
 = 
p
 + 
£rŸli£d_”rÜ
.
	`size
();

91 
size_t
 
Ën
;

92 
Ën
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

93 ià(
Ën
 =ğ7 && 
	`memcmp
(
p
, "UNKNOWN", 7) == 0) {

94 
throw
 
X­Ÿn
::
	`IÁ”ÇlE¼Ü
("UNKNOWN");

96 
¡ršg
 
	`ty³
(
p
, 
Ën
);

97 
p
 +ğ
Ën
;

99 
Ën
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

100 
¡ršg
 
	`cÚ‹xt
(
p
, 
Ën
);

101 
p
 +ğ
Ën
;

103 
Ën
 = 
	`decode_Ëngth
(&
p
, 
’d
, 
Œue
);

104 
¡ršg
 
	`msg
(
´efix
);

105 
msg
.
	`­³nd
(
p
, 
Ën
);

106 
p
 +ğ
Ën
;

108 cÚ¡ * 
”rÜ_¡ršg
 = (
p
 =ğ
’d
è? 
NULL
 :…;

110 ià(!
cÚ‹xt
.
	`em±y
(è&& !
Ãw_cÚ‹xt
.empty()) {

111 
msg
 += "; context was: ";

112 
msg
 +ğ
cÚ‹xt
;

113 
cÚ‹xt
 = 
Ãw_cÚ‹xt
;

116 
	~<x­Ÿn/”rÜdi¥©ch.h
>

118 
¡ršg
 
Ãwmsg
 = "Unknown„emoteƒxceptionype ";

119 
Ãwmsg
 +ğ
ty³
;

120 
Ãwmsg
 += ": ";

121 
Ãwmsg
 +ğ
msg
;

122 
throw
 
X­Ÿn
::
	`IÁ”ÇlE¼Ü
(
Ãwmsg
, 
cÚ‹xt
);

123 
	}
}

125 
¡ršg


126 
£rŸli£_¡©s
(cÚ¡ 
X­Ÿn
::
Weight
::
IÁ”Çl
 &
¡©s
)

128 
¡ršg
 
»suÉ
;

130 
	g»suÉ
 +ğ
’code_Ëngth
(
¡©s
.
tÙ®_Ëngth
);

131 
	g»suÉ
 +ğ
’code_Ëngth
(
¡©s
.
cŞËùiÚ_size
);

132 
	g»suÉ
 +ğ
’code_Ëngth
(
¡©s
.
r£t_size
);

134 
	g»suÉ
 +ğ
’code_Ëngth
(
¡©s
.
‹rmäeqs
.
size
());

135 
	gm­
<
	g¡ršg
, 
	gT”mF»qs
>::
cÚ¡_™”©Ü
 
i
;

136 
	gi
 = 
¡©s
.
‹rmäeqs
.
begš
(); i !ğ¡©s.‹rmäeqs.
’d
(); ++i) {

137 
	g»suÉ
 +ğ
’code_Ëngth
(
i
->
fœ¡
.
size
());

138 
	g»suÉ
 +ğ
i
->
fœ¡
;

139 
	g»suÉ
 +ğ
’code_Ëngth
(
i
->
£cÚd
.
‹rmäeq
);

140 ià(
	g¡©s
.
	gr£t_size
 != 0)

141 
»suÉ
 +ğ
’code_Ëngth
(
i
->
£cÚd
.
»É”mäeq
);

144  
	g»suÉ
;

147 
	gX­Ÿn
::
Weight
::
IÁ”Çl


148 
	$un£rŸli£_¡©s
(cÚ¡ 
¡ršg
 &
s
)

150 cÚ¡ * 
p
 = 
s
.
	`d©a
();

151 cÚ¡ * 
p_’d
 = 
p
 + 
s
.
	`size
();

153 
X­Ÿn
::
Weight
::
IÁ”Çl
 
¡©
;

155 
¡©
.
tÙ®_Ëngth
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

156 
¡©
.
cŞËùiÚ_size
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

157 
¡©
.
r£t_size
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

159 
size_t
 
n
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

160 
n
--) {

161 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

162 
¡ršg
 
	`‹rm
(
p
, 
Ën
);

163 
p
 +ğ
Ën
;

164 
X­Ÿn
::
doccouÁ
 
	`‹rmäeq
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
));

165 ià(
¡©
.
r£t_size
 == 0) {

166 
¡©
.
‹rmäeqs
.
	`š£¹
(
	`make_·œ
(
‹rm
, 
	`T”mF»qs
(
‹rmäeq
, 0)));

168 
X­Ÿn
::
doccouÁ
 
	`»É”mäeq
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
));

169 
¡©
.
‹rmäeqs
.
	`š£¹
(
	`make_·œ
(
‹rm
,

170 
	`T”mF»qs
(
‹rmäeq
, 
»É”mäeq
)));

174  
¡©
;

175 
	}
}

177 
¡ršg


178 
£rŸli£_m£t
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t
)

180 
¡ršg
 
»suÉ
;

182 
	g»suÉ
 +ğ
’code_Ëngth
(
m£t
.
g‘_fœ¡™em
());

183 
	g»suÉ
 +ğ
’code_Ëngth
(
m£t
.
g‘_m©ches_low”_bound
());

184 
	g»suÉ
 +ğ
’code_Ëngth
(
m£t
.
g‘_m©ches_e¡im©ed
());

185 
	g»suÉ
 +ğ
’code_Ëngth
(
m£t
.
g‘_m©ches_uµ”_bound
());

186 
	g»suÉ
 +ğ
’code_Ëngth
(
m£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
());

187 
	g»suÉ
 +ğ
’code_Ëngth
(
m£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
());

188 
	g»suÉ
 +ğ
’code_Ëngth
(
m£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
());

189 
	g»suÉ
 +ğ
£rŸli£_doubË
(
m£t
.
g‘_max_possibË
());

190 
	g»suÉ
 +ğ
£rŸli£_doubË
(
m£t
.
g‘_max_©šed
());

192 
	g»suÉ
 +ğ
£rŸli£_doubË
(
m£t
.
š‹º®
->
³rûÁ_çùÜ
);

194 
	g»suÉ
 +ğ
’code_Ëngth
(
m£t
.
size
());

195 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t
.
begš
(); 
	gi
 !ğm£t.
’d
(); ++i) {

196 
	g»suÉ
 +ğ
£rŸli£_doubË
(
i
.
g‘_weight
());

197 
	g»suÉ
 +ğ
’code_Ëngth
(*
i
);

198 
	g»suÉ
 +ğ
’code_Ëngth
(
i
.
g‘_cŞÏp£_key
().
size
());

199 
	g»suÉ
 +ğ
i
.
g‘_cŞÏp£_key
();

200 
	g»suÉ
 +ğ
’code_Ëngth
(
i
.
g‘_cŞÏp£_couÁ
());

203 cÚ¡ 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> &
‹rmäeqªdwts


204 ğ
m£t
.
š‹º®
->
‹rmäeqªdwts
;

206 
	gm­
<
	g¡ršg
, 
	gX­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
>::
cÚ¡_™”©Ü
 
j
;

207 
	gj
 = 
‹rmäeqªdwts
.
begš
(); j !ğ‹rmäeqªdwts.
’d
(); ++j) {

208 
	g»suÉ
 +ğ
’code_Ëngth
(
j
->
fœ¡
.
size
());

209 
	g»suÉ
 +ğ
j
->
fœ¡
;

210 
	g»suÉ
 +ğ
’code_Ëngth
(
j
->
£cÚd
.
‹rmäeq
);

211 
	g»suÉ
 +ğ
£rŸli£_doubË
(
j
->
£cÚd
.
‹rmweight
);

214  
	g»suÉ
;

217 
	gX­Ÿn
::
MS‘


218 
	$un£rŸli£_m£t
(cÚ¡ * 
p
, cÚ¡ * 
p_’d
)

220 
X­Ÿn
::
doccouÁ
 
fœ¡™em
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

221 
X­Ÿn
::
doccouÁ
 
m©ches_low”_bound
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

222 
X­Ÿn
::
doccouÁ
 
m©ches_e¡im©ed
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

223 
X­Ÿn
::
doccouÁ
 
m©ches_uµ”_bound
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

224 
X­Ÿn
::
doccouÁ
 
uncŞÏp£d_low”_bound
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

225 
X­Ÿn
::
doccouÁ
 
uncŞÏp£d_e¡im©ed
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

226 
X­Ÿn
::
doccouÁ
 
uncŞÏp£d_uµ”_bound
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

227 
X­Ÿn
::
weight
 
max_possibË
 = 
	`un£rŸli£_doubË
(&
p
, 
p_’d
);

228 
X­Ÿn
::
weight
 
max_©šed
 = 
	`un£rŸli£_doubË
(&
p
, 
p_’d
);

230 
³rûÁ_çùÜ
 = 
	`un£rŸli£_doubË
(&
p
, 
p_’d
);

232 
veùÜ
<
X­Ÿn
::
IÁ”Çl
::
MS‘I‹m
> 
™ems
;

233 
size_t
 
msize
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

234 
msize
-- > 0) {

235 
X­Ÿn
::
weight
 
wt
 = 
	`un£rŸli£_doubË
(&
p
, 
p_’d
);

236 
X­Ÿn
::
docid
 
did
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

237 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

238 
¡ršg
 
	`key
(
p
, 
Ën
);

239 
p
 +ğ
Ën
;

240 
X­Ÿn
::
doccouÁ
 
cŞÏp£_út
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

241 
™ems
.
	`push_back
(
X­Ÿn
::
IÁ”Çl
::
	`MS‘I‹m
(
wt
, 
did
, 
key
, 
cŞÏp£_út
));

244 
m­
<
¡ršg
, 
X­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
> 
‹rmšfo
;

245 
p
 !ğ
p_’d
) {

246 
X­Ÿn
::
MS‘
::
IÁ”Çl
::
T”mF»qAndWeight
 
tçw
;

247 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

248 
¡ršg
 
	`‹rm
(
p
, 
Ën
);

249 
p
 +ğ
Ën
;

250 
tçw
.
‹rmäeq
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

251 
tçw
.
‹rmweight
 = 
	`un£rŸli£_doubË
(&
p
, 
p_’d
);

252 
‹rmšfo
.
	`š£¹
(
	`make_·œ
(
‹rm
, 
tçw
));

255  
X­Ÿn
::
	`MS‘
(
Ãw
 X­Ÿn::
MS‘
::
	`IÁ”Çl
(

256 
fœ¡™em
,

257 
m©ches_uµ”_bound
,

258 
m©ches_low”_bound
,

259 
m©ches_e¡im©ed
,

260 
uncŞÏp£d_uµ”_bound
,

261 
uncŞÏp£d_low”_bound
,

262 
uncŞÏp£d_e¡im©ed
,

263 
max_possibË
, 
max_©šed
,

264 
™ems
, 
‹rmšfo
, 
³rûÁ_çùÜ
));

265 
	}
}

267 
¡ršg


268 
£rŸli£_r£t
(cÚ¡ 
X­Ÿn
::
RS‘
 &
r£t
)

270 cÚ¡ 
£t
<
X­Ÿn
::
docid
> & 
™ems
 = 
r£t
.
š‹º®
->
g‘_™ems
();

271 
¡ršg
 
	g»suÉ
;

272 
	g£t
<
	gX­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
i
;

273 
	gX­Ÿn
::
docid
 
Ï¡did
 = 0;

274 
	gi
 = 
™ems
.
begš
(); i !ğ™ems.
’d
(); ++i) {

275 
	gX­Ÿn
::
docid
 
did
 = *
i
;

276 
	g»suÉ
 +ğ
’code_Ëngth
(
did
 - 
Ï¡did
 - 1);

277 
	gÏ¡did
 = 
did
;

279  
	g»suÉ
;

282 
	gX­Ÿn
::
RS‘


283 
	$un£rŸli£_r£t
(cÚ¡ 
¡ršg
 &
s
)

285 
X­Ÿn
::
RS‘
 
r£t
;

287 cÚ¡ * 
p
 = 
s
.
	`d©a
();

288 cÚ¡ * 
p_’d
 = 
p
 + 
s
.
	`size
();

290 
X­Ÿn
::
docid
 
did
 = 0;

291 
p
 !ğ
p_’d
) {

292 
did
 +ğ
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
) + 1;

293 
r£t
.
	`add_docum’t
(
did
);

296  
r£t
;

297 
	}
}

299 
¡ršg


300 
£rŸli£_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
)

302 
¡ršg
 
»suÉ
;

304 
size_t
 
	gn
 = 
doc
.
v®ues_couÁ
();

305 
	g»suÉ
 +ğ
’code_Ëngth
(
doc
.
v®ues_couÁ
());

306 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v®ue
;

307 
	gv®ue
 = 
doc
.
v®ues_begš
(); v®u!ğdoc.
v®ues_’d
(); ++value) {

308 
	g»suÉ
 +ğ
’code_Ëngth
(
v®ue
.
g‘_v®u’o
());

309 
	g»suÉ
 +ğ
’code_Ëngth
((*
v®ue
).
size
());

310 
	g»suÉ
 +ğ*
v®ue
;

311 --
	gn
;

313 
As£¹
(
n
 == 0);

315 
	g»suÉ
 +ğ
’code_Ëngth
(
doc
.
‹rmli¡_couÁ
());

316 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm
;

317 
	gn
 = 
doc
.
‹rmli¡_couÁ
();

318 
	g‹rm
 = 
doc
.
‹rmli¡_begš
();”m !ğdoc.
‹rmli¡_’d
(); ++term) {

319 
	g»suÉ
 +ğ
’code_Ëngth
((*
‹rm
).
size
());

320 
	g»suÉ
 +ğ*
‹rm
;

321 
	g»suÉ
 +ğ
’code_Ëngth
(
‹rm
.
g‘_wdf
());

323 
	g»suÉ
 +ğ
’code_Ëngth
(
‹rm
.
pos™iÚli¡_couÁ
());

324 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos
;

325 
	gX­Ÿn
::
‹rmpos
 
Şdpos
 = 0;

326 
size_t
 
	gx
 = 
‹rm
.
pos™iÚli¡_couÁ
();

327 
	gpos
 = 
‹rm
.
pos™iÚli¡_begš
();…o !ğ‹rm.
pos™iÚli¡_’d
(); ++pos) {

328 
	gX­Ÿn
::
‹rmpos
 
diff
 = *
pos
 - 
Şdpos
;

329 
¡ršg
 
	gd–
 = 
’code_Ëngth
(
diff
);

330 
	g»suÉ
 +ğ
d–
;

331 
	gŞdpos
 = *
pos
;

332 --
	gx
;

334 
As£¹
(
x
 == 0);

335 --
	gn
;

337 
As£¹
(
n
 == 0);

339 
	g»suÉ
 +ğ
doc
.
g‘_d©a
();

340  
	g»suÉ
;

343 
	gX­Ÿn
::
Docum’t


344 
	$un£rŸli£_docum’t
(cÚ¡ 
¡ršg
 &
s
)

346 
X­Ÿn
::
Docum’t
 
doc
;

347 cÚ¡ * 
p
 = 
s
.
	`d©a
();

348 cÚ¡ * 
p_’d
 = 
p
 + 
s
.
	`size
();

350 
size_t
 
n_v®ues
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

351 
n_v®ues
--) {

352 
X­Ÿn
::
v®u’o
 
v®no
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

353 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

354 
doc
.
	`add_v®ue
(
v®no
, 
	`¡ršg
(
p
, 
Ën
));

355 
p
 +ğ
Ën
;

358 
size_t
 
n_‹rms
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

359 
n_‹rms
--) {

360 
size_t
 
Ën
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
);

361 
¡ršg
 
	`‹rm
(
p
, 
Ën
);

362 
p
 +ğ
Ën
;

365 
X­Ÿn
::
‹rmcouÁ
 
wdf
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

366 
doc
.
	`add_‹rm
(
‹rm
, 
wdf
);

368 
size_t
 
n_pos
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

369 
X­Ÿn
::
‹rmpos
 
pos
 = 0;

370 
n_pos
--) {

371 
pos
 +ğ
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

372 
doc
.
	`add_po¡šg
(
‹rm
, 
pos
, 0);

376 
doc
.
	`£t_d©a
(
	`¡ršg
(
p
, 
p_’d
 -…));

377  
doc
;

378 
	}
}

	@net/tcpclient.cc

23 
	~<cÚfig.h
>

25 
	~"»mÙecÚÃùiÚ.h
"

26 
	~"tış›Á.h
"

27 
	~<x­Ÿn/”rÜ.h
>

29 
	~"§ã”ºo.h
"

30 
	~"§ãfú.h
"

31 
	~"sock‘_uts.h
"

33 
	~<c¡ršg
>

34 #iâdeà
__WIN32__


35 
	~<Ãtdb.h
>

36 
	~<Ãtš‘/š.h
>

37 
	~<Ãtš‘/tı.h
>

38 
	~<sys/sock‘.h
>

39 
	~"§ãsys£Ëù.h
"

43 
	gTıCl›Á
::
İ’_sock‘
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡Çme
, 
pÜt
,

44 
m£cs_timeout_cÚÃù
, 
boŞ
 
tı_nod–ay
)

47 
ho¡’t
 *
	gho¡
 = 
g‘ho¡byÇme
(
ho¡Çme
.
c_¡r
());

49 ià(
	gho¡
 == 0) {

50 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
(
¡d
::
¡ršg
("Couldn'ˆ»sŞvho¡ "è+ 
ho¡Çme
,

51 #ifdeà
__WIN32__


52 
sock‘_”ºo
()

59 (
h_”ºo
 < 0 ? 
”ºo
 : -h_errno)

64 
	gsock‘fd
 = 
sock‘
(
PF_INET
, 
SOCK_STREAM
, 0);

66 ià(
	gsock‘fd
 < 0) {

67 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("Couldn'ˆü—‹ sock‘", 
sock‘_”ºo
());

70 
sockaddr_š
 
	g»maddr
;

71 
mem£t
(&
»maddr
, 0, (remaddr));

72 
	g»maddr
.
	gsš_çmy
 = 
AF_INET
;

73 
	g»maddr
.
	gsš_pÜt
 = 
htÚs
(
pÜt
);

74 
memıy
(&
»maddr
.
sš_addr
, 
ho¡
->
h_addr
, ho¡->
h_Ëngth
);

76 #ifdeà
__WIN32__


77 
ULONG
 
	g’abËd
 = 1;

78 
	grc
 = 
ioùlsock‘
(
sock‘fd
, 
FIONBIO
, &
’abËd
);

80 
	grc
 = 
fú
(
sock‘fd
, 
F_SETFL
, 
O_NDELAY
);

82 ià(
	grc
 < 0) {

83 
	g§ved_”ºo
 = 
sock‘_”ºo
();

84 
şo£_fd_Ü_sock‘
(
sock‘fd
);

85 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("Couldn'ˆ£ˆO_NDELAY", 
§ved_”ºo
);

88 ià(
	gtı_nod–ay
) {

89 
	gİtv®
 = 1;

92 ià(
£tsockİt
(
sock‘fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
,

93 
»š‹½»t_ÿ¡
<*>(&
İtv®
),

94 (
İtv®
)) < 0) {

95 
	g§ved_”ºo
 = 
sock‘_”ºo
();

96 
şo£_fd_Ü_sock‘
(
sock‘fd
);

97 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("Couldn'ˆ£ˆTCP_NODELAY", 
§ved_”ºo
);

101 
	g»tv®
 = 
cÚÃù
(
sock‘fd
, 
»š‹½»t_ÿ¡
<
sockaddr
 *>(&
»maddr
),

102 (
»maddr
));

104 ià(
	g»tv®
 < 0) {

105 #ifdeà
__WIN32__


106 ià(
WSAG‘La¡E¼Ü
(è!ğ
WSAEWOULDBLOCK
) {

108 ià(
sock‘_”ºo
(è!ğ
EINPROGRESS
) {

110 
§ved_”ºo
 = 
sock‘_”ºo
();

111 
şo£_fd_Ü_sock‘
(
sock‘fd
);

112 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("Couldn'ˆcÚÃù", 
§ved_”ºo
);

116 
fd_£t
 
	gfd£t
;

117 
FD_ZERO
(&
fd£t
);

118 
FD_SET
(
sock‘fd
, &
fd£t
);

120 
timev®
 
	gtv
;

121 
	gtv
.
	gtv_£c
 = 
m£cs_timeout_cÚÃù
 / 1000;

122 
	gtv
.
	gtv_u£c
 = 
m£cs_timeout_cÚÃù
 % 1000 * 1000;

124 
	g»tv®
 = 
£Ëù
(
sock‘fd
 + 1, 0, &
fd£t
, &fd£t, &
tv
);

126 ià(
	g»tv®
 == 0) {

127 
şo£_fd_Ü_sock‘
(
sock‘fd
);

128 
throw
 
	gX­Ÿn
::
N‘wÜkTimeoutE¼Ü
("Couldn'ˆcÚÃù", 
ETIMEDOUT
);

131 
	g”r
 = 0;

132 
SOCKLEN_T
 
	gËn
 = (
”r
);

136 
	g»tv®
 = 
g‘sockİt
(
sock‘fd
, 
SOL_SOCKET
, 
SO_ERROR
,

137 
»š‹½»t_ÿ¡
<*>(&
”r
), &
Ën
);

139 ià(
	g»tv®
 < 0) {

140 
	g§ved_”ºo
 = 
sock‘_”ºo
();

141 
şo£_fd_Ü_sock‘
(
sock‘fd
);

142 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("Couldn'ˆg‘ sock‘ o±iÚs", 
§ved_”ºo
);

144 ià(
	g”r
) {

145 
şo£_fd_Ü_sock‘
(
sock‘fd
);

146 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("Couldn'ˆcÚÃù", 
”r
);

150 #ifdeà
__WIN32__


151 
	g’abËd
 = 0;

152 
ioùlsock‘
(
sock‘fd
, 
FIONBIO
, &
’abËd
);

154 
fú
(
sock‘fd
, 
F_SETFL
, 0);

156  
	gsock‘fd
;

	@net/tcpserver.cc

23 
	~<cÚfig.h
>

25 
	~"tı£rv”.h
"

27 
	~<x­Ÿn/”rÜ.h
>

29 
	~"§ã”ºo.h
"

30 
	~"§ãfú.h
"

32 
	~"nÜ‘uº.h
"

33 
	~"»mÙecÚÃùiÚ.h
"

34 
	~"uts.h
"

36 #ifdeà
__WIN32__


37 
	~<´oûss.h
>

39 
	~<sys/sock‘.h
>

40 
	~<Ãtš‘/š_sy¡m.h
>

41 
	~<Ãtš‘/š.h
>

42 
	~<Ãtš‘/.h
>

43 
	~<Ãtš‘/tı.h
>

44 
	~<¬·/š‘.h
>

45 
	~<Ãtdb.h
>

46 
	~<sigÇl.h
>

47 
	~<sys/wa™.h
>

50 
	~<io¡»am
>

52 
	~<c¡ršg
>

53 
	~<sys/ty³s.h
>

55 
usšg
 
Çme¥aû
 
	g¡d
;

58 #ià!
defšed
 
SIGCHLD
 && defšed 
SIGCLD


59 
	#SIGCHLD
 
SIGCLD


	)

62 #ifdeà
__WIN32__


65 
	#CLOSESOCKET
(
S
è
	`şo£sock‘
(S)

	)

67 
	#CLOSESOCKET
(
S
è
	`şo£
(S)

	)

71 
	gTıS”v”
::
TıS”v”
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡
, 
pÜt
, 
boŞ
 
tı_nod–ay
,

72 
boŞ
 
v”bo£_
)

74 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


75 
mu‹x
(
NULL
),

77 
li¡’_sock‘
(
g‘_li¡’šg_sock‘
(
ho¡
, 
pÜt
, 
tı_nod–ay


78 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


79 , 
mu‹x


82 
	$v”bo£
(
v”bo£_
)

84 
	}
}

87 
	gTıS”v”
::
g‘_li¡’šg_sock‘
(cÚ¡ 
¡d
::
¡ršg
 & 
ho¡
, 
pÜt
,

88 
boŞ
 
tı_nod–ay


89 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


90 , 
HANDLE
 &
mu‹x


94 
	gsock‘fd
 = 
sock‘
(
PF_INET
, 
SOCK_STREAM
, 0);

96 ià(
	gsock‘fd
 < 0) {

97 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("sock‘", 
sock‘_”ºo
());

100 
	g»tv®
 = 0;

102 ià(
	gtı_nod–ay
) {

103 
	gİtv®
 = 1;

106 
	g»tv®
 = 
£tsockİt
(
sock‘fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
,

107 
»š‹½»t_ÿ¡
<*>(&
İtv®
),

108 (
İtv®
));

112 
	gİtv®
 = 1;

113 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


120 
	gÇme
[64];

121 
¥rštf
(
Çme
, "Glob®\\x­Ÿn-tı£rv”-li¡’šg-%d", 
pÜt
);

122 ià((
	gmu‹x
 = 
C»©eMu‹x
(
NULL
, 
TRUE
, 
Çme
)) == NULL) {

126 } ià(
G‘La¡E¼Ü
(è=ğ
ERROR_ALREADY_EXISTS
) {

129 
Clo£HªdË
(
mu‹x
);

130 
	gmu‹x
 = 
NULL
;

132 ià(
	gmu‹x
 =ğ
NULL
) {

133 
û¼
 << "S”v” i ®»ady„uÂšg oÀpÜˆ" << 
pÜt
 << 
’dl
;

136 
ex™
(69);

139 ià(
	g»tv®
 >= 0) {

140 
»tv®
 = 
£tsockİt
(
sock‘fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
,

141 
»š‹½»t_ÿ¡
<*>(&
İtv®
),

142 (
İtv®
));

145 #ià
defšed
 
SO_EXCLUSIVEADDRUSE


155 ià(
	g»tv®
 >= 0) {

156 ()
£tsockİt
(
sock‘fd
, 
SOL_SOCKET
, 
SO_EXCLUSIVEADDRUSE
,

157 
»š‹½»t_ÿ¡
<*>(&
İtv®
),

158 (
İtv®
));

163 ià(
	g»tv®
 < 0) {

164 
	g§ved_”ºo
 = 
sock‘_”ºo
();

165 
CLOSESOCKET
(
sock‘fd
);

166 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("£tsockİˆçed", 
§ved_”ºo
);

169 
sockaddr_š
 
	gaddr
;

170 
mem£t
(&
addr
, 0, (addr));

171 
	gaddr
.
	gsš_çmy
 = 
AF_INET
;

172 
	gaddr
.
	gsš_pÜt
 = 
htÚs
(
pÜt
);

173 ià(
	gho¡
.
em±y
()) {

174 
	gaddr
.
	gsš_addr
.
	gs_addr
 = 
INADDR_ANY
;

177 
ho¡’t
 *
	gho¡’t
 = 
g‘ho¡byÇme
(
ho¡
.
c_¡r
());

179 ià(
	gho¡’t
 == 0) {

180 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
(
¡ršg
("Couldn'ˆ»sŞvho¡ "è+ 
ho¡
,

182 #ifdeà
__WIN32__


183 
sock‘_”ºo
()

190 (
h_”ºo
 < 0 ? 
”ºo
 : -h_errno)

195 
memıy
(&
addr
.
sš_addr
, 
ho¡’t
->
h_addr
, ho¡’t->
h_Ëngth
);

198 
	g»tv®
 = 
bšd
(
sock‘fd
,

199 
»š‹½»t_ÿ¡
<
sockaddr
 *>(&
addr
),

200 (
addr
));

202 ià(
	g»tv®
 < 0) {

203 
	g§ved_”ºo
 = 
sock‘_”ºo
();

204 ià(
	g§ved_”ºo
 =ğ
EADDRINUSE
) {

205 
û¼
 << 
ho¡
 << ':' << 
pÜt
 << "‡Ì—dy iÀu£" << 
’dl
;

208 
ex™
(69);

210 
CLOSESOCKET
(
sock‘fd
);

211 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("bšd faed", 
§ved_”ºo
);

214 
	g»tv®
 = 
li¡’
(
sock‘fd
, 5);

216 ià(
	g»tv®
 < 0) {

217 
	g§ved_”ºo
 = 
sock‘_”ºo
();

218 
CLOSESOCKET
(
sock‘fd
);

219 
throw
 
	gX­Ÿn
::
N‘wÜkE¼Ü
("li¡’ faed", 
§ved_”ºo
);

221  
	gsock‘fd
;

225 
	gTıS”v”
::
	$acû±_cÚÃùiÚ
()

227 
sockaddr_š
 
»mÙe_add»ss
;

228 
SOCKLEN_T
 
»mÙe_add»ss_size
 = (
»mÙe_add»ss
);

230 
cÚ_sock‘
 = 
	`acû±
(
li¡’_sock‘
,

231 
»š‹½»t_ÿ¡
<
sockaddr
 *>(&
»mÙe_add»ss
),

232 &
»mÙe_add»ss_size
);

234 ià(
cÚ_sock‘
 < 0) {

235 #ifdeà
__WIN32__


236 ià(
	`WSAG‘La¡E¼Ü
(è=ğ
WSAEINTR
) {

238 ià(
mu‹x
è
	`Clo£HªdË
(mutex);

239 
mu‹x
 = 
NULL
;

243 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("acû± faed", 
	`sock‘_”ºo
());

246 ià(
»mÙe_add»ss_size
 !ğ(
»mÙe_add»ss
)) {

247 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("accept: unexpected„emote‡ddress size");

250 ià(
v”bo£
) {

251 
cout
 << "CÚÃùiÚ from " << 
	`š‘_Áß
(
»mÙe_add»ss
.
sš_addr
)

252 << ",…Üˆ" << 
»mÙe_add»ss
.
sš_pÜt
 << 
’dl
;

255  
cÚ_sock‘
;

256 
	}
}

258 
	gTıS”v”
::~
	$TıS”v”
()

260 
	`CLOSESOCKET
(
li¡’_sock‘
);

261 #ià
defšed
 
__CYGWIN__
 || defšed 
__WIN32__


262 ià(
mu‹x
è
	`Clo£HªdË
(mutex);

264 
	}
}

266 #ifdeà
HAVE_FORK


269 
	gTıS”v”
::
	$run_Úû
()

271 
cÚÃùed_sock‘
 = 
	`acû±_cÚÃùiÚ
();

272 
pid_t
 
pid
 = 
	`fÜk
();

273 ià(
pid
 == 0) {

275 
	`şo£
(
li¡’_sock‘
);

277 
	`hªdË_Úe_cÚÃùiÚ
(
cÚÃùed_sock‘
);

278 
	`şo£
(
cÚÃùed_sock‘
);

280 ià(
v”bo£
è
cout
 << "Closšg cÚÃùiÚ." << 
’dl
;

281 
	`ex™
(0);

286 ià(
pid
 < 0) {

288 
§ved_”ºo
 = 
	`sock‘_”ºo
();

289 
	`şo£
(
cÚÃùed_sock‘
);

290 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("fÜk faed", 
§ved_”ºo
);

293 
	`şo£
(
cÚÃùed_sock‘
);

294 
	}
}

298 
XAPIAN_NORETURN
(
Ú_SIGTERM
());

301 
Ú_SIGTERM
()

303 
sigÇl
(
SIGTERM
, 
SIG_DFL
);

305 #ifdeà
HAVE_KILLPG


306 
kÍg
(0, 
SIGTERM
);

308 
kl
(0, 
SIGTERM
);

310 
ex™
(0);

313 #ifdeà
HAVE_WAITPID


315 
Ú_SIGCHLD
()

317 
¡©us
;

318 
wa™pid
(-1, &
¡©us
, 
WNOHANG
) > 0);

325 
TıS”v”
::
	$run
()

330 #ifdeà
HAVE_WAITPID


331 
	`sigÇl
(
SIGCHLD
, 
Ú_SIGCHLD
);

333 
	`sigÇl
(
SIGCHLD
, 
SIG_IGN
);

335 
	`sigÇl
(
SIGTERM
, 
Ú_SIGTERM
);

337 
Œue
) {

338 
Œy
 {

339 
	`run_Úû
();

340 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

342 
û¼
 << "Caughˆ" << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

343 } 
	`ÿtch
 (...) {

345 
û¼
 << "Caughˆexû±iÚ." << 
’dl
;

348 
	}
}

350 #–ià
defšed
 
__WIN32__


358 cÚ¡ *
pShutdownSock‘
 = 
NULL
;

361 
BOOL


362 
	$CŒlHªdËr
(
DWORD
 
fdwCŒlTy³
)

364 
fdwCŒlTy³
) {

365 
CTRL_C_EVENT
:

366 
CTRL_CLOSE_EVENT
:

370 
CTRL_LOGOFF_EVENT
:

371 
CTRL_SHUTDOWN_EVENT
:

375 
cout
 << "Shu‰šg down..." << 
’dl
;

377 
CTRL_BREAK_EVENT
:

381 
cout
 << "CŒl+B»ak:‡bÜtšg…roûss" << 
’dl
;

382  
FALSE
;

384 
û¼
 << "uÃx³ùed CŒlHªdËr: " << 
fdwCŒlTy³
 << 
’dl
;

385  
FALSE
;

391 ià(!
pShutdownSock‘
 || 
	`şo£sock‘
(*pShutdownSock‘è=ğ
SOCKET_ERROR
) {

394  
FALSE
;

397 
pShutdownSock‘
 = 
NULL
;

398  
TRUE
;

399 
	}
}

402 
	sth»ad_·¿m


404 
th»ad_·¿m
(
TıS”v”
 *
s
, 
c
è: 
£rv”
(s), 
cÚÃùed_sock‘
(c) {}

405 
TıS”v”
 *
	m£rv”
;

406 
	mcÚÃùed_sock‘
;

410 
__¡dÿÎ


411 
	$run_th»ad
(* 
·¿m_
)

413 
th»ad_·¿m
 * 
	`·¿m
(
»š‹½»t_ÿ¡
<th»ad_·¿m *>(
·¿m_
));

414 
sock‘
 = 
·¿m
->
cÚÃùed_sock‘
;

416 
·¿m
->
£rv”
->
	`hªdË_Úe_cÚÃùiÚ
(
sock‘
);

417 
	`şo£sock‘
(
sock‘
);

419 
d–‘e
 
·¿m
;

421 
	`_’dth»adex
(0);

423 
	}
}

426 
	gTıS”v”
::
	$run
()

432 
pShutdownSock‘
 = &
li¡’_sock‘
;

433 ià(!::
	`S‘CÚsŞeCŒlHªdËr
((
PHANDLER_ROUTINE
è
CŒlHªdËr
, 
TRUE
))

434 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("Failedo install shutdown handler");

436 
Œue
) {

437 
Œy
 {

438 
cÚÃùed_sock‘
 = 
	`acû±_cÚÃùiÚ
();

439 ià(
cÚÃùed_sock‘
 == -1)

446 
th»ad_·¿m
 *
·¿m
 = 
Ãw
 
	`th»ad_·¿m
(
this
, 
cÚÃùed_sock‘
);

447 
HANDLE
 
hth»ad
 = (HANDLE)
	`_begšth»adex
(
NULL
, 0, ::
run_th»ad
, 
·¿m
, 0, NULL);

448 ià(
hth»ad
 == 0) {

451 
	`şo£sock‘
(
cÚÃùed_sock‘
);

452 
throw
 
X­Ÿn
::
	`N‘wÜkE¼Ü
("_begšth»adex faed", 
”ºo
);

459 
	`Clo£HªdË
(
hth»ad
);

460 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

462 
û¼
 << "Caughˆ" << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

463 } 
	`ÿtch
 (...) {

465 
û¼
 << "Caughˆexû±iÚ." << 
’dl
;

468 
	}
}

471 
	gTıS”v”
::
	$run_Úû
()

474 
fd
 = 
	`acû±_cÚÃùiÚ
();

475 
	`hªdË_Úe_cÚÃùiÚ
(
fd
);

476 
	`şo£sock‘
(
fd
);

477 
	}
}

480 #”rÜ 
Ne™h”
 
HAVE_FORK
 
nÜ
 
__WIN32__
 
¬e
 
defšed
.

	@queryparser/lemon.c

15 
	~<¡dio.h
>

16 
	~<¡d¬g.h
>

17 
	~<¡ršg.h
>

18 
	~<ùy³.h
>

19 
	~<¡dlib.h
>

20 
	~<as£¹.h
>

22 #iâdeà
__WIN32__


23 #ià
defšed
(
_WIN32
è|| defšed(
WIN32
)

24 
	#__WIN32__


	)

28 #ifdeà
__WIN32__


29 
acûss
();

31 
	~<uni¡d.h
>

34 
	#PRIVATE
 

	)

36 #ifdeà
TEST


37 
	#MAXRHS
 5

	)

39 
	#MAXRHS
 1000

	)

42 *
msÜt
(*,**,(*)(const *,const *));

49 
	#ËmÚSŒËn
(
X
è(()
	`¡¾’
(X))

	)

51 
aùiÚ
 *
	`AùiÚ_Ãw
();

52 
aùiÚ
 *
	`AùiÚ_sÜt
(action *);

55 
	`FšdRuËP»ûd’ûs
();

56 
	`FšdFœ¡S‘s
();

57 
	`FšdS‹s
();

58 
	`FšdLšks
();

59 
	`FšdFŞlowS‘s
();

60 
	`FšdAùiÚs
();

63 
	`CÚfigli¡_š™
( );

64 
cÚfig
 *
	`CÚfigli¡_add
( );

65 
cÚfig
 *
	`CÚfigli¡_addbasis
( );

66 
	`CÚfigli¡_şosu»
( );

67 
	`CÚfigli¡_sÜt
( );

68 
	`CÚfigli¡_sÜtbasis
( );

69 
cÚfig
 *
	`CÚfigli¡_»tuº
( );

70 
cÚfig
 *
	`CÚfigli¡_basis
( );

71 
	`CÚfigli¡_—t
( );

72 
	`CÚfigli¡_»£t
( );

75 
	`E¼ÜMsg
(const *, ,const *, ...);

78 
	ss_İtiÚs
 {

79 ’um { 
OPT_FLAG
=1, 
OPT_INT
, 
OPT_DBL
, 
OPT_STR
,

80 
OPT_FFLAG
, 
OPT_FINT
, 
OPT_FDBL
, 
OPT_FSTR
} 
ty³
;

81 *
Ïb–
;

82 *
¬g
;

83 (*
func
)();

84 *
mes§ge
;

86 
	`O±In™
( );

87 
	`O±NArgs
( );

88 *
	`O±Arg
( );

89 
	`O±E¼
( );

90 
	`O±Pršt
( );

93 
	`P¬£
( );

96 
¶šk
 *
	`Plšk_Ãw
( );

97 
	`Plšk_add
( );

98 
	`Plšk_cİy
( );

99 
	`Plšk_d–‘e
( );

102 
	`R•ršt
( );

103 
	`R•ÜtOuut
( );

104 
	`R•ÜtTabË
( );

105 
	`R•ÜtH—d”
( );

106 
	`Com´essTabËs
( );

107 
	`ResÜtS‹s
( );

110 
	`S‘Size
( );

111 *
	`S‘New
( );

112 
	`S‘F»e
( );

114 
	`S‘Add
( );

115 
	`S‘UniÚ
( );

117 
	#S‘Fšd
(
X
,
Y
è(X[Y]è

	)

124 ’um {
LEMON_FALSE
=0, 
LEMON_TRUE
} 
	tBoŞ—n
;

128 
	ssymbŞ
 {

129 *
Çme
;

130 
šdex
;

132 
TERMINAL
,

133 
NONTERMINAL
,

134 
MULTITERMINAL


135 } 
ty³
;

136 
ruË
 *rule;

137 
symbŞ
 *
çÎback
;

138 
´ec
;

139 
	ee_assoc
 {

140 
LEFT
,

141 
RIGHT
,

142 
NONE
,

143 
UNK


144 } 
assoc
;

145 *
fœ¡£t
;

146 
BoŞ—n
 
Ïmbda
;

147 
u£CÁ
;

148 *
de¡ruùÜ
;

150 
de¡Lš’o
;

151 *
d©©y³
;

153 
dŠum
;

157 
nsubsym
;

158 
symbŞ
 **
subsym
;

163 
	sruË
 {

164 
symbŞ
 *
lhs
;

165 *
lh§lŸs
;

166 
lhsS¹
;

167 
ruËlše
;

168 
Ähs
;

169 
symbŞ
 **
rhs
;

170 **
rh§lŸs
;

171 
lše
;

172 *
code
;

173 
symbŞ
 *
´ecsym
;

174 
šdex
;

175 
BoŞ—n
 
ÿnReduû
;

176 
ruË
 *
Ãxhs
;

177 
ruË
 *
Ãxt
;

185 
	scÚfig
 {

186 
ruË
 *
½
;

187 
dÙ
;

188 *
fws
;

189 
¶šk
 *
åÍ
;

190 
¶šk
 *
b¶p
;

191 
¡©e
 *
¡p
;

193 
COMPLETE
,

194 
INCOMPLETE


195 } 
¡©us
;

196 
cÚfig
 *
Ãxt
;

197 
cÚfig
 *
bp
;

201 
	saùiÚ
 {

202 
symbŞ
 *
¥
;

203 
	ee_aùiÚ
 {

204 
SHIFT
,

205 
ACCEPT
,

206 
REDUCE
,

207 
ERROR
,

208 
SSCONFLICT
,

209 
SRCONFLICT
,

210 
RRCONFLICT
,

211 
SH_RESOLVED
,

212 
RD_RESOLVED
,

213 
NOT_USED


214 } 
ty³
;

216 
¡©e
 *
¡p
;

217 
ruË
 *
½
;

218 } 
x
;

219 
aùiÚ
 *
Ãxt
;

220 
aùiÚ
 *
cŞlide
;

225 
	s¡©e
 {

226 
cÚfig
 *
bp
;

227 
cÚfig
 *
cå
;

228 
¡©’um
;

229 
aùiÚ
 *
­
;

230 
nTknAù
, 
nNtAù
;

231 
iTknOf¡
, 
iNtOf¡
;

232 
iDæt
;

234 
	#NO_OFFSET
 (-2147483647)

	)

239 
	s¶šk
 {

240 
cÚfig
 *
cå
;

241 
¶šk
 *
Ãxt
;

248 
	sËmÚ
 {

249 
¡©e
 **
sÜ‹d
;

250 
ruË
 *rule;

251 
n¡©e
;

252 
ÄuË
;

253 
nsymbŞ
;

254 
Á”mš®
;

255 
symbŞ
 **
symbŞs
;

256 
”rÜút
;

257 
symbŞ
 *
”rsym
;

258 
symbŞ
 *
wdÿrd
;

259 *
Çme
;

260 *
¬g
;

261 *
tok’ty³
;

262 *
v¬ty³
;

263 *
¡¬t
;

264 *
¡acksize
;

265 *
šşude
;

266 *
”rÜ
;

267 *
ov”æow
;

268 *
çu»
;

269 *
acû±
;

270 *
exŒacode
;

271 *
tok’de¡
;

272 *
v¬de¡
;

273 *
f’ame
;

274 *
ouŠame
;

275 *
tok’´efix
;

276 
ncÚæiù
;

277 
bËsize
;

278 
basisæag
;

279 
has_çÎback
;

280 
nŞš’osæag
;

281 *
¬gv0
;

284 
	#MemÜyCheck
(
X
) if((X)==0){ \

285 
	`memÜy_”rÜ
(); \

286 
	`memÜy_”rÜ
(); \

287 
	}

	)
}

304 *
SŒ§ã
();

306 
SŒ§ã_š™
( );

307 
SŒ§ã_š£¹
( );

308 *
SŒ§ã_fšd
( );

312 
symbŞ
 *
SymbŞ_Ãw
();

313 
SymbŞcmµ
(cÚ¡ *
void_a
, cÚ¡ *
void_b
);

314 
SymbŞ_š™
( );

315 
SymbŞ_š£¹
( );

316 
symbŞ
 *
SymbŞ_fšd
( );

317 
symbŞ
 *
SymbŞ_Nth
( );

318 
SymbŞ_couÁ
( );

319 
symbŞ
 **
SymbŞ_¬¿yof
( );

323 
CÚfigcmp
( );

324 
¡©e
 *
S‹_Ãw
();

325 
S‹_š™
( );

326 
S‹_š£¹
( );

327 
¡©e
 *
S‹_fšd
( );

328 
¡©e
 **
S‹_¬¿yof
( );

332 
CÚfigbË_š™
( );

333 
CÚfigbË_š£¹
( );

334 
cÚfig
 *
CÚfigbË_fšd
( );

335 
CÚfigbË_ş—r
( );

342 
aùiÚ
 *
	$AùiÚ_Ãw
(){

343 
aùiÚ
 *
ä“li¡
 = 0;

344 
aùiÚ
 *
Ãw
;

346 ifĞ
ä“li¡
==0 ){

347 
i
;

348 
amt
 = 100;

349 
ä“li¡
 = (
aùiÚ
 *)
	`ÿÎoc
(
amt
, (action));

350 ifĞ
ä“li¡
==0 ){

351 
	`årštf
(
¡d”r
,"Unableo‡llocate memory for‡‚ew…arser‡ction.");

352 
	`ex™
(1);

354 
i
=0; i<
amt
-1; i++è
ä“li¡
[i].
Ãxt
 = &freelist[i+1];

355 
ä“li¡
[
amt
-1].
Ãxt
 = 0;

357 
Ãw
 = 
ä“li¡
;

358 
ä“li¡
 = f»–i¡->
Ãxt
;

359  
Ãw
;

360 
	}
}

366 
	$aùiÚcmp
(

367 cÚ¡ *
ch¬_­1
,

368 cÚ¡ *
ch¬_­2


370 cÚ¡ 
aùiÚ
 *
­1
 = (cÚ¡ aùiÚ *)
ch¬_­1
;

371 cÚ¡ 
aùiÚ
 *
­2
 = (cÚ¡ aùiÚ *)
ch¬_­2
;

372 
rc
;

373 
rc
 = 
­1
->
¥
->
šdex
 - 
­2
->sp->index;

374 ifĞ
rc
==0 ){

375 
rc
 = ()
­1
->
ty³
 - ()
­2
->type;

377 ifĞ
rc
==0 && 
­1
->
ty³
==
REDUCE
 ){

378 
rc
 = 
­1
->
x
.
½
->
šdex
 - 
­2
->x.rp->index;

380  
rc
;

381 
	}
}

384 
aùiÚ
 *
	$AùiÚ_sÜt
(

385 
aùiÚ
 *
­


388 
­
 = (
aùiÚ
 *)
	`msÜt
((*ïp,(**)(*)&­->
Ãxt
,
aùiÚcmp
);

389  
­
;

390 
	}
}

392 
	$AùiÚ_add
(
­p
,
ty³
,
¥
,
¬g
)

393 
aùiÚ
 **
­p
;

394 
e_aùiÚ
 
ty³
;

395 
symbŞ
 *
¥
;

396 *
¬g
;

398 
aùiÚ
 *
Ãw
;

399 
Ãw
 = 
	`AùiÚ_Ãw
();

400 
Ãw
->
Ãxt
 = *
­p
;

401 *
­p
 = 
Ãw
;

402 
Ãw
->
ty³
 =ype;

403 
Ãw
->
¥
 = sp;

404 ifĞ
ty³
==
SHIFT
 ){

405 
Ãw
->
x
.
¡p
 = (
¡©e
 *)
¬g
;

407 
Ãw
->
x
.
½
 = (
ruË
 *)
¬g
;

409 
	}
}

419 
aùb
 
	taùb
;

420 
	saùb
 {

421 
	mnAùiÚ
;

422 
	mnAùiÚAÎoc
;

424 
	mlookah—d
;

425 
	maùiÚ
;

426 } *
	maAùiÚ
,

427 *
	maLookah—d
;

428 
	mmnLookah—d
;

429 
	mmnAùiÚ
;

430 
	mmxLookah—d
;

431 
	mnLookah—d
;

432 
	mnLookah—dAÎoc
;

436 
	#aùb_size
(
X
è((X)->
nAùiÚ
)

	)

439 
	#aùb_yyaùiÚ
(
X
,
N
è((X)->
aAùiÚ
[N].
aùiÚ
)

	)

442 
	#aùb_yylookah—d
(
X
,
N
è((X)->
aAùiÚ
[N].
lookah—d
)

	)

445 
	$aùb_ä“
(
aùb
 *
p
){

446 
	`ä“
Ğ
p
->
aAùiÚ
 );

447 
	`ä“
Ğ
p
->
aLookah—d
 );

448 
	`ä“
Ğ
p
 );

449 
	}
}

452 
aùb
 *
	$aùb_®loc
(){

453 
aùb
 *
p
 = 
	`ÿÎoc
( 1, (*p) );

454 ifĞ
p
==0 ){

455 
	`årštf
(
¡d”r
,"Unableo‡llocate memory for‡‚ew‡cttab.");

456 
	`ex™
(1);

458 
	`mem£t
(
p
, 0, (*p));

459  
p
;

460 
	}
}

464 
	$aùb_aùiÚ
(
aùb
 *
p
, 
lookah—d
, 
aùiÚ
){

465 ifĞ
p
->
nLookah—d
>õ->
nLookah—dAÎoc
 ){

466 
p
->
nLookah—dAÎoc
 += 25;

467 
p
->
aLookah—d
 = 
	`»®loc
(…->aLookahead,

468 (
p
->
aLookah—d
[0])*p->
nLookah—dAÎoc
 );

469 ifĞ
p
->
aLookah—d
==0 ){

470 
	`årštf
(
¡d”r
,"malloc failed\n");

471 
	`ex™
(1);

474 ifĞ
p
->
nLookah—d
==0 ){

475 
p
->
mxLookah—d
 = 
lookah—d
;

476 
p
->
mnLookah—d
 = 
lookah—d
;

477 
p
->
mnAùiÚ
 = 
aùiÚ
;

479 ifĞ
p
->
mxLookah—d
<
lookah—d
 )…->mxLookahead =†ookahead;

480 ifĞ
p
->
mnLookah—d
>
lookah—d
 ){

481 
p
->
mnLookah—d
 = 
lookah—d
;

482 
p
->
mnAùiÚ
 = 
aùiÚ
;

485 
p
->
aLookah—d
[p->
nLookah—d
].
lookah—d
 =†ookahead;

486 
p
->
aLookah—d
[p->
nLookah—d
].
aùiÚ
 =‡ction;

487 
p
->
nLookah—d
++;

488 
	}
}

497 
	$aùb_š£¹
(
aùb
 *
p
){

498 
i
, 
j
, 
k
, 
n
;

499 
	`as£¹
Ğ
p
->
nLookah—d
>0 );

505 
n
 = 
p
->
mxLookah—d
 + 1;

506 ifĞ
p
->
nAùiÚ
 + 
n
 >ğp->
nAùiÚAÎoc
 ){

507 
ŞdAÎoc
 = 
p
->
nAùiÚAÎoc
;

508 
p
->
nAùiÚAÎoc
 =…->
nAùiÚ
 + 
n
 +…->nActionAlloc + 20;

509 
p
->
aAùiÚ
 = 
	`»®loc
(…->aAction,

510 (
p
->
aAùiÚ
[0])*p->
nAùiÚAÎoc
);

511 ifĞ
p
->
aAùiÚ
==0 ){

512 
	`årštf
(
¡d”r
,"malloc failed\n");

513 
	`ex™
(1);

515 
i
=
ŞdAÎoc
; i<
p
->
nAùiÚAÎoc
; i++){

516 
p
->
aAùiÚ
[
i
].
lookah—d
 = -1;

517 
p
->
aAùiÚ
[
i
].
aùiÚ
 = -1;

528 
i
=0; i<
p
->
nAùiÚ
+p->
mnLookah—d
; i++){

529 ifĞ
p
->
aAùiÚ
[
i
].
lookah—d
<0 ){

530 
j
=0; j<
p
->
nLookah—d
; j++){

531 
k
 = 
p
->
aLookah—d
[
j
].
lookah—d
 -…->
mnLookah—d
 + 
i
;

532 ifĞ
k
<0 ) ;

533 ifĞ
p
->
aAùiÚ
[
k
].
lookah—d
>=0 ) ;

535 ifĞ
j
<
p
->
nLookah—d
 ) ;

536 
j
=0; j<
p
->
nAùiÚ
; j++){

537 ifĞ
p
->
aAùiÚ
[
j
].
lookah—d
==j+p->
mnLookah—d
-
i
 ) ;

539 ifĞ
j
==
p
->
nAùiÚ
 ){

542 }ifĞ
p
->
aAùiÚ
[
i
].
lookah—d
=õ->
mnLookah—d
 ){

543 ifĞ
p
->
aAùiÚ
[
i
].
aùiÚ
!õ->
mnAùiÚ
 ) ;

544 
j
=0; j<
p
->
nLookah—d
; j++){

545 
k
 = 
p
->
aLookah—d
[
j
].
lookah—d
 -…->
mnLookah—d
 + 
i
;

546 ifĞ
k
<0 || k>=
p
->
nAùiÚ
 ) ;

547 ifĞ
p
->
aLookah—d
[
j
].
lookah—d
!õ->
aAùiÚ
[
k
].lookahead ) ;

548 ifĞ
p
->
aLookah—d
[
j
].
aùiÚ
!õ->
aAùiÚ
[
k
].action ) ;

550 ifĞ
j
<
p
->
nLookah—d
 ) ;

551 
n
 = 0;

552 
j
=0; j<
p
->
nAùiÚ
; j++){

553 ifĞ
p
->
aAùiÚ
[
j
].
lookah—d
<0 ) ;

554 ifĞ
p
->
aAùiÚ
[
j
].
lookah—d
==j+p->
mnLookah—d
-
i
 ) 
n
++;

556 ifĞ
n
==
p
->
nLookah—d
 ){

562 
j
=0; j<
p
->
nLookah—d
; j++){

563 
k
 = 
p
->
aLookah—d
[
j
].
lookah—d
 -…->
mnLookah—d
 + 
i
;

564 
p
->
aAùiÚ
[
k
] =…->
aLookah—d
[
j
];

565 ifĞ
k
>=
p
->
nAùiÚ
 )…->nAction = k+1;

567 
p
->
nLookah—d
 = 0;

571  
i
 - 
p
->
mnLookah—d
;

572 
	}
}

589 
	$FšdRuËP»ûd’ûs
(
xp
)

590 
ËmÚ
 *
xp
;

592 
ruË
 *
½
;

593 
½
=
xp
->
ruË
;„p;„pôp->
Ãxt
){

594 ifĞ
½
->
´ecsym
==0 ){

595 
i
, 
j
;

596 
i
=0; i<
½
->
Ähs
 &&„p->
´ecsym
==0; i++){

597 
symbŞ
 *
¥
 = 
½
->
rhs
[
i
];

598 ifĞ
¥
->
ty³
==
MULTITERMINAL
 ){

599 
j
=0; j<
¥
->
nsubsym
; j++){

600 ifĞ
¥
->
subsym
[
j
]->
´ec
>=0 ){

601 
½
->
´ecsym
 = 
¥
->
subsym
[
j
];

605 }ifĞ
¥
->
´ec
>=0 ){

606 
½
->
´ecsym
 =„p->
rhs
[
i
];

612 
	}
}

619 
	$FšdFœ¡S‘s
(
Ëmp
)

620 
ËmÚ
 *
Ëmp
;

622 
i
, 
j
;

623 
ruË
 *
½
;

624 
´og»ss
;

626 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

627 
Ëmp
->
symbŞs
[
i
]->
Ïmbda
 = 
LEMON_FALSE
;

629 
i
=
Ëmp
->
Á”mš®
; i<Ëmp->
nsymbŞ
; i++){

630 
Ëmp
->
symbŞs
[
i
]->
fœ¡£t
 = 
	`S‘New
();

635 
´og»ss
 = 0;

636 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

637 ifĞ
½
->
lhs
->
Ïmbda
 ) ;

638 
i
=0; i<
½
->
Ähs
; i++){

639 
symbŞ
 *
¥
 = 
½
->
rhs
[
i
];

640 ifĞ
¥
->
ty³
!=
TERMINAL
 || sp->
Ïmbda
==
LEMON_FALSE
 ) ;

642 ifĞ
i
==
½
->
Ähs
 ){

643 
½
->
lhs
->
Ïmbda
 = 
LEMON_TRUE
;

644 
´og»ss
 = 1;

647 } 
´og»ss
 );

651 
symbŞ
 *
s1
, *
s2
;

652 
´og»ss
 = 0;

653 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

654 
s1
 = 
½
->
lhs
;

655 
i
=0; i<
½
->
Ähs
; i++){

656 
s2
 = 
½
->
rhs
[
i
];

657 ifĞ
s2
->
ty³
==
TERMINAL
 ){

658 
´og»ss
 +ğ
	`S‘Add
(
s1
->
fœ¡£t
,
s2
->
šdex
);

660 }ifĞ
s2
->
ty³
==
MULTITERMINAL
 ){

661 
j
=0; j<
s2
->
nsubsym
; j++){

662 
´og»ss
 +ğ
	`S‘Add
(
s1
->
fœ¡£t
,
s2
->
subsym
[
j
]->
šdex
);

665 }ifĞ
s1
==
s2
 ){

666 ifĞ
s1
->
Ïmbda
==
LEMON_FALSE
 ) ;

668 
´og»ss
 +ğ
	`S‘UniÚ
(
s1
->
fœ¡£t
,
s2
->firstset);

669 ifĞ
s2
->
Ïmbda
==
LEMON_FALSE
 ) ;

673 } 
´og»ss
 );

675 
	}
}

681 
PRIVATE
 
¡©e
 *
g‘¡©e
( );

682 
	$FšdS‹s
(
Ëmp
)

683 
ËmÚ
 *
Ëmp
;

685 
symbŞ
 *
¥
;

686 
ruË
 *
½
;

688 
	`CÚfigli¡_š™
();

691 ifĞ
Ëmp
->
¡¬t
 ){

692 
¥
 = 
	`SymbŞ_fšd
(
Ëmp
->
¡¬t
);

693 ifĞ
¥
==0 ){

694 
	`E¼ÜMsg
(
Ëmp
->
f’ame
,0,

697 "symbŞ in¡—d.",
Ëmp
->
¡¬t
,Ëmp->
ruË
->
lhs
->
Çme
);

698 
Ëmp
->
”rÜút
++;

699 
¥
 = 
Ëmp
->
ruË
->
lhs
;

702 
¥
 = 
Ëmp
->
ruË
->
lhs
;

708 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

709 
i
;

710 
i
=0; i<
½
->
Ähs
; i++){

711 ifĞ
½
->
rhs
[
i
]==
¥
 ){

712 
	`E¼ÜMsg
(
Ëmp
->
f’ame
,0,

715 "dÛ nÙ wÜk…rİ”ly.",
¥
->
Çme
);

716 
Ëmp
->
”rÜút
++;

724 
½
=
¥
->
ruË
;„p;„pôp->
Ãxhs
){

725 
cÚfig
 *
Ãwcå
;

726 
½
->
lhsS¹
 = 1;

727 
Ãwcå
 = 
	`CÚfigli¡_addbasis
(
½
,0);

728 
	`S‘Add
(
Ãwcå
->
fws
,0);

734 ()
	`g‘¡©e
(
Ëmp
);

736 
	}
}

741 
PRIVATE
 
budshiás
( );

742 
PRIVATE
 
¡©e
 *
	$g‘¡©e
(
Ëmp
)

743 
ËmÚ
 *
Ëmp
;

745 
cÚfig
 *
cå
, *
bp
;

746 
¡©e
 *
¡p
;

750 
	`CÚfigli¡_sÜtbasis
();

751 
bp
 = 
	`CÚfigli¡_basis
();

754 
¡p
 = 
	`S‹_fšd
(
bp
);

755 ifĞ
¡p
 ){

759 
cÚfig
 *
x
, *
y
;

760 
x
=
bp
, 
y
=
¡p
->bp; x && y; x=x->bp, y=y->bp){

761 
	`Plšk_cİy
(&
y
->
b¶p
,
x
->bplp);

762 
	`Plšk_d–‘e
(
x
->
åÍ
);

763 
x
->
åÍ
 = x->
b¶p
 = 0;

765 
cå
 = 
	`CÚfigli¡_»tuº
();

766 
	`CÚfigli¡_—t
(
cå
);

769 
	`CÚfigli¡_şosu»
(
Ëmp
);

770 
	`CÚfigli¡_sÜt
();

771 
cå
 = 
	`CÚfigli¡_»tuº
();

772 
¡p
 = 
	`S‹_Ãw
();

773 
	`MemÜyCheck
(
¡p
);

774 
¡p
->
bp
 = bp;

775 
¡p
->
cå
 = cfp;

776 
¡p
->
¡©’um
 = 
Ëmp
->
n¡©e
++;

777 
¡p
->
­
 = 0;

778 
	`S‹_š£¹
(
¡p
,¡p->
bp
);

779 
	`budshiás
(
Ëmp
,
¡p
);

781  
¡p
;

782 
	}
}

787 
	$§me_symbŞ
(
a
,
b
)

788 
symbŞ
 *
a
;

789 
symbŞ
 *
b
;

791 
i
;

792 ifĞ
a
==
b
 )  1;

793 ifĞ
a
->
ty³
!=
MULTITERMINAL
 )  0;

794 ifĞ
b
->
ty³
!=
MULTITERMINAL
 )  0;

795 ifĞ
a
->
nsubsym
!=
b
->nsubsym )  0;

796 
i
=0; i<
a
->
nsubsym
; i++){

797 ifĞ
a
->
subsym
[
i
]!=
b
->subsym[i] )  0;

800 
	}
}

805 
PRIVATE
 
	$budshiás
(
Ëmp
,
¡p
)

806 
ËmÚ
 *
Ëmp
;

807 
¡©e
 *
¡p
;

809 
cÚfig
 *
cå
;

810 
cÚfig
 *
bcå
;

811 
cÚfig
 *
Ãw
;

812 
symbŞ
 *
¥
;

813 
symbŞ
 *
b¥
;

814 
¡©e
 *
Ãw¡p
;

818 
cå
=
¡p
->cå; cå; cå=cå->
Ãxt
ècå->
¡©us
 = 
INCOMPLETE
;

821 
cå
=
¡p
->cå; cå; cå=cå->
Ãxt
){

822 ifĞ
cå
->
¡©us
==
COMPLETE
 ) ;

823 ifĞ
cå
->
dÙ
>=cå->
½
->
Ähs
 ) ;

824 
	`CÚfigli¡_»£t
();

825 
¥
 = 
cå
->
½
->
rhs
[cå->
dÙ
];

830 
bcå
=
cå
; bcå; bcå=bcå->
Ãxt
){

831 ifĞ
bcå
->
¡©us
==
COMPLETE
 ) ;

832 ifĞ
bcå
->
dÙ
>=bcå->
½
->
Ähs
 ) ;

833 
b¥
 = 
bcå
->
½
->
rhs
[bcå->
dÙ
];

834 ifĞ!
	`§me_symbŞ
(
b¥
,
¥
) ) ;

835 
bcå
->
¡©us
 = 
COMPLETE
;

836 
Ãw
 = 
	`CÚfigli¡_addbasis
(
bcå
->
½
,bcå->
dÙ
+1);

837 
	`Plšk_add
(&
Ãw
->
b¶p
,
bcå
);

842 
Ãw¡p
 = 
	`g‘¡©e
(
Ëmp
);

846 ifĞ
¥
->
ty³
==
MULTITERMINAL
 ){

847 
i
;

848 
i
=0; i<
¥
->
nsubsym
; i++){

849 
	`AùiÚ_add
(&
¡p
->
­
,
SHIFT
,
¥
->
subsym
[
i
],(*)
Ãw¡p
);

852 
	`AùiÚ_add
(&
¡p
->
­
,
SHIFT
,
¥
,(*)
Ãw¡p
);

855 
	}
}

860 
	$FšdLšks
(
Ëmp
)

861 
ËmÚ
 *
Ëmp
;

863 
i
;

864 
cÚfig
 *
cå
, *
Ùh”
;

865 
¡©e
 *
¡p
;

866 
¶šk
 *
¶p
;

871 
i
=0; i<
Ëmp
->
n¡©e
; i++){

872 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

873 
cå
=
¡p
->cå; cå; cå=cå->
Ãxt
){

874 
cå
->
¡p
 = stp;

880 
i
=0; i<
Ëmp
->
n¡©e
; i++){

881 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

882 
cå
=
¡p
->cå; cå; cå=cå->
Ãxt
){

883 
¶p
=
cå
->
b¶p
;…Í;…ÍõÍ->
Ãxt
){

884 
Ùh”
 = 
¶p
->
cå
;

885 
	`Plšk_add
(&
Ùh”
->
åÍ
,
cå
);

889 
	}
}

896 
	$FšdFŞlowS‘s
(
Ëmp
)

897 
ËmÚ
 *
Ëmp
;

899 
i
;

900 
cÚfig
 *
cå
;

901 
¶šk
 *
¶p
;

902 
´og»ss
;

903 
chªge
;

905 
i
=0; i<
Ëmp
->
n¡©e
; i++){

906 
cå
=
Ëmp
->
sÜ‹d
[
i
]->cå; cå; cå=cå->
Ãxt
){

907 
cå
->
¡©us
 = 
INCOMPLETE
;

912 
´og»ss
 = 0;

913 
i
=0; i<
Ëmp
->
n¡©e
; i++){

914 
cå
=
Ëmp
->
sÜ‹d
[
i
]->cå; cå; cå=cå->
Ãxt
){

915 ifĞ
cå
->
¡©us
==
COMPLETE
 ) ;

916 
¶p
=
cå
->
åÍ
;…Í;…ÍõÍ->
Ãxt
){

917 
chªge
 = 
	`S‘UniÚ
(
¶p
->
cå
->
fws
,cfp->fws);

918 ifĞ
chªge
 ){

919 
¶p
->
cå
->
¡©us
 = 
INCOMPLETE
;

920 
´og»ss
 = 1;

923 
cå
->
¡©us
 = 
COMPLETE
;

926 } 
´og»ss
 );

927 
	}
}

929 
»sŞve_cÚæiù
();

933 
	$FšdAùiÚs
(
Ëmp
)

934 
ËmÚ
 *
Ëmp
;

936 
i
,
j
;

937 
cÚfig
 *
cå
;

938 
¡©e
 *
¡p
;

939 
symbŞ
 *
¥
;

940 
ruË
 *
½
;

946 
i
=0; i<
Ëmp
->
n¡©e
; i++){

947 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

948 
cå
=
¡p
->cå; cå; cå=cå->
Ãxt
){

949 ifĞ
cå
->
½
->
Ähs
==cå->
dÙ
 ){

950 
j
=0; j<
Ëmp
->
Á”mš®
; j++){

951 ifĞ
	`S‘Fšd
(
cå
->
fws
,
j
) ){

954 
	`AùiÚ_add
(&
¡p
->
­
,
REDUCE
,
Ëmp
->
symbŞs
[
j
],(*)
cå
->
½
);

962 ifĞ
Ëmp
->
¡¬t
 ){

963 
¥
 = 
	`SymbŞ_fšd
(
Ëmp
->
¡¬t
);

964 ifĞ
¥
==0 ) s°ğ
Ëmp
->
ruË
->
lhs
;

966 
¥
 = 
Ëmp
->
ruË
->
lhs
;

971 
	`AùiÚ_add
(&
Ëmp
->
sÜ‹d
[0]->
­
,
ACCEPT
,
¥
,0);

974 
i
=0; i<
Ëmp
->
n¡©e
; i++){

975 
aùiÚ
 *
­
, *
Çp
;

976 
¡©e
 *
¡p
;

977 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

979 
¡p
->
­
 = 
	`AùiÚ_sÜt
(stp->ap);

980 
­
=
¡p
->­;‡°&&‡p->
Ãxt
;‡p=ap->next){

981 
Çp
=
­
->
Ãxt
;‚­ &&‚­->
¥
==ap->sp;‚ap=nap->next){

984 
Ëmp
->
ncÚæiù
 +ğ
	`»sŞve_cÚæiù
(
­
,
Çp
);

990 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
è½->
ÿnReduû
 = 
LEMON_FALSE
;

991 
i
=0; i<
Ëmp
->
n¡©e
; i++){

992 
aùiÚ
 *
­
;

993 
­
=
Ëmp
->
sÜ‹d
[
i
]->­;‡p;‡p÷p->
Ãxt
){

994 ifĞ
­
->
ty³
==
REDUCE
 )‡p->
x
.
½
->
ÿnReduû
 = 
LEMON_TRUE
;

997 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

998 ifĞ
½
->
ÿnReduû
 ) ;

999 
	`E¼ÜMsg
(
Ëmp
->
f’ame
,
½
->
ruËlše
,"This„ule can‚ot be„educed.");

1000 
Ëmp
->
”rÜút
++;

1002 
	}
}

1017 
	$»sŞve_cÚæiù
(
­x
,
­y
)

1018 
aùiÚ
 *
­x
;

1019 
aùiÚ
 *
­y
;

1021 
symbŞ
 *
¥x
, *
¥y
;

1022 
”rút
 = 0;

1023 
	`as£¹
Ğ
­x
->
¥
==
­y
->sp );

1024 ifĞ
­x
->
ty³
==
SHIFT
 && 
­y
->type==SHIFT ){

1025 
­y
->
ty³
 = 
SSCONFLICT
;

1026 
”rút
++;

1028 ifĞ
­x
->
ty³
==
SHIFT
 && 
­y
->ty³==
REDUCE
 ){

1029 
¥x
 = 
­x
->
¥
;

1030 
¥y
 = 
­y
->
x
.
½
->
´ecsym
;

1031 ifĞ
¥y
==0 || 
¥x
->
´ec
<0 || spy->prec<0 ){

1033 
­y
->
ty³
 = 
SRCONFLICT
;

1034 
”rút
++;

1035 }ifĞ
¥x
->
´ec
>
¥y
->prec ){

1036 
­y
->
ty³
 = 
RD_RESOLVED
;

1037 }ifĞ
¥x
->
´ec
<
¥y
->prec ){

1038 
­x
->
ty³
 = 
SH_RESOLVED
;

1039 }ifĞ
¥x
->
´ec
==
¥y
->´eø&& spx->
assoc
==
RIGHT
 ){

1040 
­y
->
ty³
 = 
RD_RESOLVED
;

1041 }ifĞ
¥x
->
´ec
==
¥y
->´eø&& spx->
assoc
==
LEFT
 ){

1042 
­x
->
ty³
 = 
SH_RESOLVED
;

1044 
	`as£¹
Ğ
¥x
->
´ec
==
¥y
->´eø&& spx->
assoc
==
NONE
 );

1045 
­y
->
ty³
 = 
SRCONFLICT
;

1046 
”rút
++;

1048 }ifĞ
­x
->
ty³
==
REDUCE
 && 
­y
->type==REDUCE ){

1049 
¥x
 = 
­x
->
x
.
½
->
´ecsym
;

1050 
¥y
 = 
­y
->
x
.
½
->
´ecsym
;

1051 ifĞ
¥x
==0 || 
¥y
==0 || spx->
´ec
<0 ||

1052 
¥y
->
´ec
<0 || 
¥x
->prec==spy->prec ){

1053 
­y
->
ty³
 = 
RRCONFLICT
;

1054 
”rút
++;

1055 }ifĞ
¥x
->
´ec
>
¥y
->prec ){

1056 
­y
->
ty³
 = 
RD_RESOLVED
;

1057 }ifĞ
¥x
->
´ec
<
¥y
->prec ){

1058 
­x
->
ty³
 = 
RD_RESOLVED
;

1061 
	`as£¹
(

1062 
­x
->
ty³
==
SH_RESOLVED
 ||

1063 
­x
->
ty³
==
RD_RESOLVED
 ||

1064 
­x
->
ty³
==
SSCONFLICT
 ||

1065 
­x
->
ty³
==
SRCONFLICT
 ||

1066 
­x
->
ty³
==
RRCONFLICT
 ||

1067 
­y
->
ty³
==
SH_RESOLVED
 ||

1068 
­y
->
ty³
==
RD_RESOLVED
 ||

1069 
­y
->
ty³
==
SSCONFLICT
 ||

1070 
­y
->
ty³
==
SRCONFLICT
 ||

1071 
­y
->
ty³
==
RRCONFLICT


1077  
”rút
;

1078 
	}
}

1085 
cÚfig
 *
	gä“li¡
 = 0;

1086 
cÚfig
 *
	gcu¼’t
 = 0;

1087 
cÚfig
 **
	gcu¼’‹nd
 = 0;

1088 
cÚfig
 *
	gbasis
 = 0;

1089 
cÚfig
 **
	gbasi£nd
 = 0;

1092 
PRIVATE
 
cÚfig
 *
	$ÃwcÚfig
(){

1093 
cÚfig
 *
Ãw
;

1094 ifĞ
ä“li¡
==0 ){

1095 
i
;

1096 
amt
 = 3;

1097 
ä“li¡
 = (
cÚfig
 *)
	`ÿÎoc
Ğ
amt
, (config) );

1098 ifĞ
ä“li¡
==0 ){

1099 
	`årštf
(
¡d”r
,"Unableo‡llocate memory for‡‚ew configuration.");

1100 
	`ex™
(1);

1102 
i
=0; i<
amt
-1; i++è
ä“li¡
[i].
Ãxt
 = &freelist[i+1];

1103 
ä“li¡
[
amt
-1].
Ãxt
 = 0;

1105 
Ãw
 = 
ä“li¡
;

1106 
ä“li¡
 = f»–i¡->
Ãxt
;

1107  
Ãw
;

1108 
	}
}

1111 
PRIVATE
 
	$d–‘ecÚfig
(
Şd
)

1112 
cÚfig
 *
Şd
;

1114 
Şd
->
Ãxt
 = 
ä“li¡
;

1115 
ä“li¡
 = 
Şd
;

1116 
	}
}

1119 
	$CÚfigli¡_š™
(){

1120 
cu¼’t
 = 0;

1121 
cu¼’‹nd
 = &
cu¼’t
;

1122 
basis
 = 0;

1123 
basi£nd
 = &
basis
;

1124 
	`CÚfigbË_š™
();

1126 
	}
}

1129 
	$CÚfigli¡_»£t
(){

1130 
cu¼’t
 = 0;

1131 
cu¼’‹nd
 = &
cu¼’t
;

1132 
basis
 = 0;

1133 
basi£nd
 = &
basis
;

1134 
	`CÚfigbË_ş—r
(0);

1136 
	}
}

1139 
cÚfig
 *
	$CÚfigli¡_add
(
½
,
dÙ
)

1140 
ruË
 *
½
;

1141 
dÙ
;

1143 
cÚfig
 *
cå
, 
mod–
;

1145 
	`as£¹
Ğ
cu¼’‹nd
!=0 );

1146 
mod–
.
½
 =„p;

1147 
mod–
.
dÙ
 = dot;

1148 
cå
 = 
	`CÚfigbË_fšd
(&
mod–
);

1149 ifĞ
cå
==0 ){

1150 
cå
 = 
	`ÃwcÚfig
();

1151 
cå
->
½
 =„p;

1152 
cå
->
dÙ
 = dot;

1153 
cå
->
fws
 = 
	`S‘New
();

1154 
cå
->
¡p
 = 0;

1155 
cå
->
åÍ
 = cå->
b¶p
 = 0;

1156 
cå
->
Ãxt
 = 0;

1157 
cå
->
bp
 = 0;

1158 *
cu¼’‹nd
 = 
cå
;

1159 
cu¼’‹nd
 = &
cå
->
Ãxt
;

1160 
	`CÚfigbË_š£¹
(
cå
);

1162  
cå
;

1163 
	}
}

1166 
cÚfig
 *
	$CÚfigli¡_addbasis
(
½
,
dÙ
)

1167 
ruË
 *
½
;

1168 
dÙ
;

1170 
cÚfig
 *
cå
, 
mod–
;

1172 
	`as£¹
Ğ
basi£nd
!=0 );

1173 
	`as£¹
Ğ
cu¼’‹nd
!=0 );

1174 
mod–
.
½
 =„p;

1175 
mod–
.
dÙ
 = dot;

1176 
cå
 = 
	`CÚfigbË_fšd
(&
mod–
);

1177 ifĞ
cå
==0 ){

1178 
cå
 = 
	`ÃwcÚfig
();

1179 
cå
->
½
 =„p;

1180 
cå
->
dÙ
 = dot;

1181 
cå
->
fws
 = 
	`S‘New
();

1182 
cå
->
¡p
 = 0;

1183 
cå
->
åÍ
 = cå->
b¶p
 = 0;

1184 
cå
->
Ãxt
 = 0;

1185 
cå
->
bp
 = 0;

1186 *
cu¼’‹nd
 = 
cå
;

1187 
cu¼’‹nd
 = &
cå
->
Ãxt
;

1188 *
basi£nd
 = 
cå
;

1189 
basi£nd
 = &
cå
->
bp
;

1190 
	`CÚfigbË_š£¹
(
cå
);

1192  
cå
;

1193 
	}
}

1196 
	$CÚfigli¡_şosu»
(
Ëmp
)

1197 
ËmÚ
 *
Ëmp
;

1199 
cÚfig
 *
cå
, *
Ãwcå
;

1200 
ruË
 *
½
, *
Ãw½
;

1201 
symbŞ
 *
¥
, *
x¥
;

1202 
i
, 
dÙ
;

1204 
	`as£¹
Ğ
cu¼’‹nd
!=0 );

1205 
cå
=
cu¼’t
; cå; cå=cå->
Ãxt
){

1206 
½
 = 
cå
->rp;

1207 
dÙ
 = 
cå
->dot;

1208 ifĞ
dÙ
>=
½
->
Ähs
 ) ;

1209 
¥
 = 
½
->
rhs
[
dÙ
];

1210 ifĞ
¥
->
ty³
==
NONTERMINAL
 ){

1211 ifĞ
¥
->
ruË
==0 && sp!=
Ëmp
->
”rsym
 ){

1212 
	`E¼ÜMsg
(
Ëmp
->
f’ame
,
½
->
lše
,"Nonterminal \"%s\" has‚o„ules.",

1213 
¥
->
Çme
);

1214 
Ëmp
->
”rÜút
++;

1216 
Ãw½
=
¥
->
ruË
;‚ew½;‚ew½òew½->
Ãxhs
){

1217 
Ãwcå
 = 
	`CÚfigli¡_add
(
Ãw½
,0);

1218 
i
=
dÙ
+1; i<
½
->
Ähs
; i++){

1219 
x¥
 = 
½
->
rhs
[
i
];

1220 ifĞ
x¥
->
ty³
==
TERMINAL
 ){

1221 
	`S‘Add
(
Ãwcå
->
fws
,
x¥
->
šdex
);

1223 }ifĞ
x¥
->
ty³
==
MULTITERMINAL
 ){

1224 
k
;

1225 
k
=0; k<
x¥
->
nsubsym
; k++){

1226 
	`S‘Add
(
Ãwcå
->
fws
, 
x¥
->
subsym
[
k
]->
šdex
);

1230 
	`S‘UniÚ
(
Ãwcå
->
fws
,
x¥
->
fœ¡£t
);

1231 ifĞ
x¥
->
Ïmbda
==
LEMON_FALSE
 ) ;

1234 ifĞ
i
==
½
->
Ähs
 ) 
	`Plšk_add
(&
cå
->
åÍ
,
Ãwcå
);

1239 
	}
}

1242 
	$CÚfigli¡_sÜt
(){

1244 
cu¼’t
 = (
cÚfig
 *)
	`msÜt
((*)cu¼’t,(**)(*)&(cu¼’t->
Ãxt
),
CÚfigcmp
);

1245 
cu¼’‹nd
 = 0;

1247 
	}
}

1250 
	$CÚfigli¡_sÜtbasis
(){

1252 
basis
 = (
cÚfig
 *)
	`msÜt
((*)
cu¼’t
,(**)(*)&(cu¼’t->
bp
),
CÚfigcmp
);

1253 
basi£nd
 = 0;

1255 
	}
}

1259 
cÚfig
 *
	$CÚfigli¡_»tuº
(){

1260 
cÚfig
 *
Şd
;

1261 
Şd
 = 
cu¼’t
;

1262 
cu¼’t
 = 0;

1263 
cu¼’‹nd
 = 0;

1264  
Şd
;

1265 
	}
}

1269 
cÚfig
 *
	$CÚfigli¡_basis
(){

1270 
cÚfig
 *
Şd
;

1271 
Şd
 = 
basis
;

1272 
basis
 = 0;

1273 
basi£nd
 = 0;

1274  
Şd
;

1275 
	}
}

1278 
	$CÚfigli¡_—t
(
cå
)

1279 
cÚfig
 *
cå
;

1281 
cÚfig
 *
Ãxtcå
;

1282 ; 
cå
; cå=
Ãxtcå
){

1283 
Ãxtcå
 = 
cå
->
Ãxt
;

1284 
	`as£¹
Ğ
cå
->
åÍ
==0 );

1285 
	`as£¹
Ğ
cå
->
b¶p
==0 );

1286 ifĞ
cå
->
fws
 ) 
	`S‘F»e
(cfp->fws);

1287 
	`d–‘ecÚfig
(
cå
);

1290 
	}
}

1299 
	$fšdb»ak
(
msg
,
mš
,
max
)

1300 *
msg
;

1301 
mš
;

1302 
max
;

1304 
i
,
¥Ù
;

1305 
c
;

1306 
i
=
¥Ù
=
mš
; i<=
max
; i++){

1307 
c
 = 
msg
[
i
];

1308 ifĞ
c
=='\t' ) 
msg
[
i
] = ' ';

1309 ifĞ
c
=='\n' ){ 
msg
[
i
] = ' '; 
¥Ù
 = i; ; }

1310 ifĞ
c
==0 ){ 
¥Ù
 = 
i
; ; }

1311 ifĞ
c
=='-' && 
i
<
max
-1 ) 
¥Ù
 = i+1;

1312 ifĞ
c
==' ' ) 
¥Ù
 = 
i
;

1314  
¥Ù
;

1315 
	}
}

1322 
	#ERRMSGSIZE
 10000

	)

1323 
	#LINEWIDTH
 79

	)

1324 
	#PREFIXLIMIT
 60

	)

1325 
	$E¼ÜMsg
(cÚ¡ *
f’ame
, 
lš’o
, cÚ¡ *
fÜm©
, ...){

1326 
”rmsg
[
ERRMSGSIZE
];

1327 
´efix
[
PREFIXLIMIT
+10];

1328 
”rmsgsize
;

1329 
´efixsize
;

1330 
avaabËwidth
;

1331 
va_li¡
 
­
;

1332 
’d
, 
»¡¬t
, 
ba£
;

1334 
	`va_¡¬t
(
­
, 
fÜm©
);

1336 ifĞ
lš’o
>0 ){

1337 
	`¥rštf
(
´efix
,"%.*s:%d: ",
PREFIXLIMIT
-10,
f’ame
,
lš’o
);

1339 
	`¥rštf
(
´efix
,"%.*s: ",
PREFIXLIMIT
-10,
f’ame
);

1341 
´efixsize
 = 
	`ËmÚSŒËn
(
´efix
);

1342 
avaabËwidth
 = 
LINEWIDTH
 - 
´efixsize
;

1345 
	`v¥rštf
(
”rmsg
,
fÜm©
,
­
);

1346 
	`va_’d
(
­
);

1347 
”rmsgsize
 = 
	`ËmÚSŒËn
(
”rmsg
);

1349  
”rmsgsize
>0 && 
”rmsg
[errmsgsize-1]=='\n' ){

1350 
”rmsg
[--
”rmsgsize
] = 0;

1354 
ba£
 = 0;

1355  
”rmsg
[
ba£
]!=0 ){

1356 
’d
 = 
»¡¬t
 = 
	`fšdb»ak
(&
”rmsg
[
ba£
],0,
avaabËwidth
);

1357 
»¡¬t
 +ğ
ba£
;

1358  
”rmsg
[
»¡¬t
]==' ' )„estart++;

1359 
	`årštf
(
¡dout
,"%s%.*s\n",
´efix
,
’d
,&
”rmsg
[
ba£
]);

1360 
ba£
 = 
»¡¬t
;

1362 
	}
}

1371 
	$memÜy_”rÜ
(){

1372 
	`årštf
(
¡d”r
,"Out of memory. Aborting...\n");

1373 
	`ex™
(1);

1374 
	}
}

1376 
	gnDefše
 = 0;

1377 **
	gazDefše
 = 0;

1382 
	$hªdË_D_İtiÚ
(*
z
){

1383 **
·z
;

1384 
nDefše
++;

1385 
azDefše
 = 
	`»®loc
×zDefše, ×zDefše[0])*
nDefše
);

1386 ifĞ
azDefše
==0 ){

1387 
	`årštf
(
¡d”r
,"out of memory\n");

1388 
	`ex™
(1);

1390 
·z
 = &
azDefše
[
nDefše
-1];

1391 *
·z
 = 
	`m®loc
Ğ
	`ËmÚSŒËn
(
z
)+1 );

1392 ifĞ*
·z
==0 ){

1393 
	`årštf
(
¡d”r
,"out of memory\n");

1394 
	`ex™
(1);

1396 
	`¡rıy
(*
·z
, 
z
);

1397 
z
=*
·z
; *z && *z!='='; z++){}

1398 *
z
 = 0;

1399 
	}
}

1401 *
	gouut_f’ame
 = 0;

1405 
	$hªdË_o_İtiÚ
(*
z
){

1406 
ouut_f’ame
 = 
	`m®loc
Ğ
	`¡¾’
(
z
)+1 );

1407 ifĞ
ouut_f’ame
==0 ){

1408 
	`årštf
(
¡d”r
,"out of memory\n");

1409 
	`ex™
(1);

1411 
	`¡rıy
(
ouut_f’ame
, 
z
);

1412 
	}
}

1414 *
	gouut_h—d”_f’ame
 = 0;

1418 
	$hªdË_h_İtiÚ
(*
z
){

1419 
ouut_h—d”_f’ame
 = 
	`m®loc
Ğ
	`¡¾’
(
z
)+1 );

1420 ifĞ
ouut_h—d”_f’ame
==0 ){

1421 
	`årštf
(
¡d”r
,"out of memory\n");

1422 
	`ex™
(1);

1424 
	`¡rıy
(
ouut_h—d”_f’ame
, 
z
);

1425 
	}
}

1429 
	$maš
(
¬gc
,
¬gv
)

1430 
¬gc
;

1431 **
¬gv
;

1433 
v”siÚ
 = 0;

1434 
½æag
 = 0;

1435 
basisæag
 = 0;

1436 
com´ess
 = 0;

1437 
qu›t
 = 0;

1438 
¡©i¡ics
 = 0;

1439 
mhæag
 = 0;

1440 
nŞš’osæag
 = 0;

1441 
s_İtiÚs
 
İtiÚs
[] = {

1442 {
OPT_FLAG
, "b", (*)&
basisæag
, 0, "Print onlyhe basis in„eport."},

1443 {
OPT_FLAG
, "c", (*)&
com´ess
, 0, "Don't compresshe‡ctionable."},

1444 {
OPT_FSTR
, "D", 0, 
hªdË_D_İtiÚ
, "Define‡n %ifdef macro."},

1445 {
OPT_FLAG
, "g", (*)&
½æag
, 0, "Print grammar without‡ctions."},

1446 {
OPT_FLAG
, "m", (*)&
mhæag
, 0, "Output‡ makeheaders compatible file."},

1447 {
OPT_FLAG
, "l", (*)&
nŞš’osæag
, 0, "Do‚ot…rint #line statements."},

1448 {
OPT_FLAG
, "q", (*)&
qu›t
, 0, "(Quiet) Don't…rinthe„eport file."},

1449 {
OPT_FLAG
, "s", (*)&
¡©i¡ics
, 0,

1451 {
OPT_FLAG
, "x", (*)&
v”siÚ
, 0, "Printhe version‚umber."},

1452 {
OPT_FSTR
, "o", 0, 
hªdË_o_İtiÚ
, "Specify output filename."},

1453 {
OPT_FSTR
, "h", 0, 
hªdË_h_İtiÚ
, "Specify output header filename."},

1454 {
OPT_FLAG
,0,0,0,0}

1456 
i
;

1457 
ËmÚ
 
Ëm
;

1459 ()
¬gc
;

1460 
	`O±In™
(
¬gv
,
İtiÚs
,
¡d”r
);

1461 ifĞ
v”siÚ
 ){

1462 
	`´štf
("Lemon version 1.0 (patched for Xapian)\n");

1463 
	`ex™
(0);

1465 ifĞ
	`O±NArgs
()!=1 ){

1466 
	`årštf
(
¡d”r
,"Exactly one filename‡rgument is„equired.\n");

1467 
	`ex™
(1);

1469 
	`mem£t
(&
Ëm
, 0, (lem));

1470 
Ëm
.
”rÜút
 = 0;

1473 
	`SŒ§ã_š™
();

1474 
	`SymbŞ_š™
();

1475 
	`S‹_š™
();

1476 
Ëm
.
¬gv0
 = 
¬gv
[0];

1477 
Ëm
.
f’ame
 = 
	`O±Arg
(0);

1478 
Ëm
.
basisæag
 = basisflag;

1479 
Ëm
.
nŞš’osæag
 =‚olinenosflag;

1480 
	`SymbŞ_Ãw
("$");

1481 
Ëm
.
”rsym
 = 
	`SymbŞ_Ãw
("error");

1482 
Ëm
.
”rsym
->
u£CÁ
 = 0;

1485 
	`P¬£
(&
Ëm
);

1486 ifĞ
Ëm
.
”rÜút
 ) 
	`ex™
(lem.errorcnt);

1487 ifĞ
Ëm
.
ÄuË
==0 ){

1488 
	`årštf
(
¡d”r
,"Empty grammar.\n");

1489 
	`ex™
(1);

1493 
Ëm
.
nsymbŞ
 = 
	`SymbŞ_couÁ
();

1494 
	`SymbŞ_Ãw
("{default}");

1495 
Ëm
.
symbŞs
 = 
	`SymbŞ_¬¿yof
();

1496 
i
=0; i<=
Ëm
.
nsymbŞ
; i++èËm.
symbŞs
[i]->
šdex
 = i;

1497 
	`qsÜt
(
Ëm
.
symbŞs
,Ëm.
nsymbŞ
+1,(
symbŞ
*),

1498 
SymbŞcmµ
);

1499 
i
=0; i<=
Ëm
.
nsymbŞ
; i++èËm.
symbŞs
[i]->
šdex
 = i;

1500 
i
=1; 
	`isuµ”
(
Ëm
.
symbŞs
[i]->
Çme
[0]); i++);

1501 
Ëm
.
Á”mš®
 = 
i
;

1504 ifĞ
½æag
 ){

1505 
	`R•ršt
(&
Ëm
);

1508 
	`S‘Size
(
Ëm
.
Á”mš®
+1);

1511 
	`FšdRuËP»ûd’ûs
(&
Ëm
);

1515 
	`FšdFœ¡S‘s
(&
Ëm
);

1519 
Ëm
.
n¡©e
 = 0;

1520 
	`FšdS‹s
(&
Ëm
);

1521 
Ëm
.
sÜ‹d
 = 
	`S‹_¬¿yof
();

1524 
	`FšdLšks
(&
Ëm
);

1527 
	`FšdFŞlowS‘s
(&
Ëm
);

1530 
	`FšdAùiÚs
(&
Ëm
);

1533 ifĞ
com´ess
==0 ) 
	`Com´essTabËs
(&
Ëm
);

1537 
	`ResÜtS‹s
(&
Ëm
);

1540 ifĞ!
qu›t
 ) 
	`R•ÜtOuut
(&
Ëm
);

1543 
	`R•ÜtTabË
(&
Ëm
, 
mhæag
);

1548 ifĞ!
mhæag
 ) 
	`R•ÜtH—d”
(&
Ëm
);

1550 ifĞ
¡©i¡ics
 ){

1551 
	`´štf
("Parser statistics: %derminals, %d‚onterminals, %d„ules\n",

1552 
Ëm
.
Á”mš®
,†em.
nsymbŞ
 -†em.Á”mš®,†em.
ÄuË
);

1553 
	`´štf
(" %d states, %d…arserableƒntries, %d conflicts\n",

1554 
Ëm
.
n¡©e
,†em.
bËsize
,†em.
ncÚæiù
);

1556 ifĞ
Ëm
.
ncÚæiù
 ){

1557 
	`årštf
(
¡d”r
,"%d…¬sšg cÚæiùs.\n",
Ëm
.
ncÚæiù
);

1559 
	`ex™
(
Ëm
.
”rÜút
 +†em.
ncÚæiù
);

1560  (
Ëm
.
”rÜút
 +†em.
ncÚæiù
);

1561 
	}
}

1589 
	#NEXT
(
A
è(*(**)((()A)+
off£t
))

	)

1606 *
m”ge
(

1607 *
a
,

1608 *
b
,

1609 (*
cmp
)(const *,const *),

1610 
off£t


1612 *
±r
, *
h—d
;

1614 ifĞ
a
==0 ){

1615 
h—d
 = 
b
;

1616 }ifĞ
b
==0 ){

1617 
h—d
 = 
a
;

1619 ifĞ(*
cmp
)(
a
,
b
)<0 ){

1620 
±r
 = 
a
;

1621 
a
 = 
	`NEXT
(a);

1623 
±r
 = 
b
;

1624 
b
 = 
	`NEXT
(b);

1626 
h—d
 = 
±r
;

1627  
a
 && 
b
 ){

1628 ifĞ(*
cmp
)(
a
,
b
)<0 ){

1629 
	`NEXT
(
±r
èğ
a
;

1630 
±r
 = 
a
;

1631 
a
 = 
	`NEXT
(a);

1633 
	`NEXT
(
±r
èğ
b
;

1634 
±r
 = 
b
;

1635 
b
 = 
	`NEXT
(b);

1638 ifĞ
a
 ) 
	`NEXT
(
±r
) =‡;

1639 
	`NEXT
(
±r
èğ
b
;

1641  
h—d
;

1642 
	}
}

1657 
	#LISTSIZE
 30

	)

1658 *
msÜt
(

1659 *
li¡
,

1660 **
Ãxt
,

1661 (*
cmp
)(const *,const *)

1663 
off£t
;

1664 *
•
;

1665 *
£t
[
LISTSIZE
];

1666 
i
;

1667 
off£t
 = ()
Ãxt
 - ()
li¡
;

1668 
i
=0; i<
LISTSIZE
; i++è
£t
[i] = 0;

1669  
li¡
 ){

1670 
•
 = 
li¡
;

1671 
li¡
 = 
	`NEXT
(list);

1672 
	`NEXT
(
•
) = 0;

1673 
i
=0; i<
LISTSIZE
-1 && 
£t
[i]!=0; i++){

1674 
•
 = 
	`m”ge
Óp,
£t
[
i
],
cmp
,
off£t
);

1675 
£t
[
i
] = 0;

1677 
£t
[
i
] = 
•
;

1679 
•
 = 0;

1680 
i
=0; i<
LISTSIZE
; i++èifĞ
£t
[i] ) 
•
 = 
	`m”ge
Óp,£t[i],
cmp
,
off£t
);

1681  
•
;

1682 
	}
}

1684 **
	g¬gv
;

1685 
s_İtiÚs
 *
	gİ
;

1686 
FILE
 *
	g”r¡»am
;

1688 
	#ISOPT
(
X
è((X)[0]=='-'||(X)[0]=='+'||
	`¡rchr
((X),'=')!=0)

	)

1694 
	$”¾še
(
n
,
k
,
”r
)

1695 
n
;

1696 
k
;

1697 
FILE
 *
”r
;

1699 
¥út
, 
i
;

1700 ifĞ
¬gv
[0] ) 
	`årštf
(
”r
,"%s",argv[0]);

1701 
¥út
 = 
	`ËmÚSŒËn
(
¬gv
[0]) + 1;

1702 
i
=1; i<
n
 && 
¬gv
[i]; i++){

1703 
	`årštf
(
”r
," %s",
¬gv
[
i
]);

1704 
¥út
 +ğ
	`ËmÚSŒËn
(
¬gv
[
i
])+1;

1706 
¥út
 +ğ
k
;

1707 ; 
¬gv
[
i
]; i++è
	`årštf
(
”r
," %s",argv[i]);

1708 ifĞ
¥út
<20 ){

1709 
	`årštf
(
”r
,"\n%*s^-- h”e\n",
¥út
,"");

1711 
	`årštf
(
”r
,"\n%*sh”--^\n",
¥út
-7,"");

1713 
	}
}

1719 
	$¬gšdex
(
n
)

1720 
n
;

1722 
i
;

1723 
dashdash
 = 0;

1724 ifĞ
¬gv
!=0 && *argv!=0 ){

1725 
i
=1; 
¬gv
[i]; i++){

1726 ifĞ
dashdash
 || !
	`ISOPT
(
¬gv
[
i
]) ){

1727 ifĞ
n
==0 )  
i
;

1728 
n
--;

1730 ifĞ
	`¡rcmp
(
¬gv
[
i
],"--")==0 ) 
dashdash
 = 1;

1734 
	}
}

1736 
	gemsg
[] = "Command†ine syntaxƒrror: ";

1741 
	$hªdËæags
(
i
,
”r
)

1742 
i
;

1743 
FILE
 *
”r
;

1745 
v
;

1746 
”rút
 = 0;

1747 
j
;

1748 
j
=0; 
İ
[j].
Ïb–
; j++){

1749 ifĞ
	`¡ºcmp
(&
¬gv
[
i
][1],
İ
[
j
].
Ïb–
,
	`ËmÚSŒËn
(op[j].label))==0 ) ;

1751 
v
 = 
¬gv
[
i
][0]=='-' ? 1 : 0;

1752 ifĞ
İ
[
j
].
Ïb–
==0 ){

1753 ifĞ
”r
 ){

1754 
	`årštf
(
”r
,"%sundefšed o±iÚ.\n",
emsg
);

1755 
	`”¾še
(
i
,1,
”r
);

1757 
”rút
++;

1758 }ifĞ
İ
[
j
].
ty³
==
OPT_FLAG
 ){

1759 *((*)
İ
[
j
].
¬g
èğ
v
;

1760 }ifĞ
İ
[
j
].
ty³
==
OPT_FFLAG
 ){

1761 (
İ
[
j
].
func
)(
v
);

1762 }ifĞ
İ
[
j
].
ty³
==
OPT_FSTR
 ){

1763 (
İ
[
j
].
func
)(&
¬gv
[
i
][2]);

1765 ifĞ
”r
 ){

1766 
	`årštf
(
”r
,"%smissšg‡rgum’ˆÚ sw™ch.\n",
emsg
);

1767 
	`”¾še
(
i
,1,
”r
);

1769 
”rút
++;

1771  
”rút
;

1772 
	}
}

1777 
	$hªdËsw™ch
(
i
,
”r
)

1778 
i
;

1779 
FILE
 *
”r
;

1781 
lv
 = 0;

1782 
dv
 = 0.0;

1783 *
sv
 = 0, *
’d
;

1784 *
ı
;

1785 
j
;

1786 
”rút
 = 0;

1787 
ı
 = 
	`¡rchr
(
¬gv
[
i
],'=');

1788 
	`as£¹
Ğ
ı
!=0 );

1789 *
ı
 = 0;

1790 
j
=0; 
İ
[j].
Ïb–
; j++){

1791 ifĞ
	`¡rcmp
(
¬gv
[
i
],
İ
[
j
].
Ïb–
)==0 ) ;

1793 *
ı
 = '=';

1794 ifĞ
İ
[
j
].
Ïb–
==0 ){

1795 ifĞ
”r
 ){

1796 
	`årštf
(
”r
,"%sundefšed o±iÚ.\n",
emsg
);

1797 
	`”¾še
(
i
,0,
”r
);

1799 
”rút
++;

1801 
ı
++;

1802  
İ
[
j
].
ty³
 ){

1803 
OPT_FLAG
:

1804 
OPT_FFLAG
:

1805 ifĞ
”r
 ){

1806 
	`årštf
(
”r
,"%sİtiÚ„equœe ª‡rgum’t.\n",
emsg
);

1807 
	`”¾še
(
i
,0,
”r
);

1809 
”rút
++;

1811 
OPT_DBL
:

1812 
OPT_FDBL
:

1813 
dv
 = 
	`¡¹od
(
ı
,&
’d
);

1814 ifĞ*
’d
 ){

1815 ifĞ
”r
 ){

1816 
	`årštf
(
”r
,"%sËg® ch¬aù” iÀæßtšg-pošˆ¬gum’t.\n",
emsg
);

1817 
	`”¾še
(
i
,(()
’d
)-()
¬gv
[i],
”r
);

1819 
”rút
++;

1822 
OPT_INT
:

1823 
OPT_FINT
:

1824 
lv
 = 
	`¡¹Ş
(
ı
,&
’d
,0);

1825 ifĞ*
’d
 ){

1826 ifĞ
”r
 ){

1827 
	`årštf
(
”r
,"%sËg® ch¬aù” iÀš‹g”‡rgum’t.\n",
emsg
);

1828 
	`”¾še
(
i
,(()
’d
)-()
¬gv
[i],
”r
);

1830 
”rút
++;

1833 
OPT_STR
:

1834 
OPT_FSTR
:

1835 
sv
 = 
ı
;

1838  
İ
[
j
].
ty³
 ){

1839 
OPT_FLAG
:

1840 
OPT_FFLAG
:

1842 
OPT_DBL
:

1843 *(*)(
İ
[
j
].
¬g
èğ
dv
;

1845 
OPT_FDBL
:

1846 (
İ
[
j
].
func
)(
dv
);

1848 
OPT_INT
:

1849 *(*)(
İ
[
j
].
¬g
èğ
lv
;

1851 
OPT_FINT
:

1852 (
İ
[
j
].
func
)(()
lv
);

1854 
OPT_STR
:

1855 *(**)(
İ
[
j
].
¬g
èğ
sv
;

1857 
OPT_FSTR
:

1858 (
İ
[
j
].
func
)(
sv
);

1862  
”rút
;

1863 
	}
}

1865 
	$O±In™
(
a
,
o
,
”r
)

1866 **
a
;

1867 
s_İtiÚs
 *
o
;

1868 
FILE
 *
”r
;

1870 
”rút
 = 0;

1871 
¬gv
 = 
a
;

1872 
İ
 = 
o
;

1873 
”r¡»am
 = 
”r
;

1874 ifĞ
¬gv
 && *¬gv && 
İ
 ){

1875 
i
;

1876 
i
=1; 
¬gv
[i]; i++){

1877 ifĞ
¬gv
[
i
][0]=='+' ||‡rgv[i][0]=='-' ){

1878 
”rút
 +ğ
	`hªdËæags
(
i
,
”r
);

1879 }ifĞ
	`¡rchr
(
¬gv
[
i
],'=') ){

1880 
”rút
 +ğ
	`hªdËsw™ch
(
i
,
”r
);

1884 ifĞ
”rút
>0 ){

1885 
	`årštf
(
”r
,"V®id commªd†šİtiÚ fÜ \"%s\"‡»:\n",*
a
);

1886 
	`O±Pršt
();

1887 
	`ex™
(1);

1890 
	}
}

1892 
	$O±NArgs
(){

1893 
út
 = 0;

1894 
dashdash
 = 0;

1895 
i
;

1896 ifĞ
¬gv
!=0 &&‡rgv[0]!=0 ){

1897 
i
=1; 
¬gv
[i]; i++){

1898 ifĞ
dashdash
 || !
	`ISOPT
(
¬gv
[
i
]èè
út
++;

1899 ifĞ
	`¡rcmp
(
¬gv
[
i
],"--")==0 ) 
dashdash
 = 1;

1902  
út
;

1903 
	}
}

1905 *
	$O±Arg
(
n
)

1906 
n
;

1908 
i
;

1909 
i
 = 
	`¬gšdex
(
n
);

1910  
i
>=0 ? 
¬gv
[i] : 0;

1911 
	}
}

1913 
	$O±E¼
(
n
)

1914 
n
;

1916 
i
;

1917 
i
 = 
	`¬gšdex
(
n
);

1918 ifĞ
i
>=0 ) 
	`”¾še
(i,0,
”r¡»am
);

1919 
	}
}

1921 
	$O±Pršt
(){

1922 
i
;

1923 
max
, 
Ën
;

1924 
max
 = 0;

1925 
i
=0; 
İ
[i].
Ïb–
; i++){

1926 
Ën
 = 
	`ËmÚSŒËn
(
İ
[
i
].
Ïb–
) + 1;

1927  
İ
[
i
].
ty³
 ){

1928 
OPT_FLAG
:

1929 
OPT_FFLAG
:

1931 
OPT_INT
:

1932 
OPT_FINT
:

1933 
Ën
 += 9;

1935 
OPT_DBL
:

1936 
OPT_FDBL
:

1937 
Ën
 += 6;

1939 
OPT_STR
:

1940 
OPT_FSTR
:

1941 
Ën
 += 8;

1944 ifĞ
Ën
>
max
 ) max =†en;

1946 
i
=0; 
İ
[i].
Ïb–
; i++){

1947  
İ
[
i
].
ty³
 ){

1948 
OPT_FLAG
:

1949 
OPT_FFLAG
:

1950 
	`årštf
(
”r¡»am
," -%-*  %s\n",
max
,
İ
[
i
].
Ïb–
,İ[i].
mes§ge
);

1952 
OPT_INT
:

1953 
OPT_FINT
:

1954 
	`årštf
(
”r¡»am
," %s=<š‹g”>%*  %s\n",
İ
[
i
].
Ïb–
,

1955 ()(
max
-
	`ËmÚSŒËn
(
İ
[
i
].
Ïb–
)-9),"",İ[i].
mes§ge
);

1957 
OPT_DBL
:

1958 
OPT_FDBL
:

1959 
	`årštf
(
”r¡»am
," %s=<»®>%*  %s\n",
İ
[
i
].
Ïb–
,

1960 ()(
max
-
	`ËmÚSŒËn
(
İ
[
i
].
Ïb–
)-6),"",İ[i].
mes§ge
);

1962 
OPT_STR
:

1963 
OPT_FSTR
:

1964 
	`årštf
(
”r¡»am
," %s=<¡ršg>%*  %s\n",
İ
[
i
].
Ïb–
,

1965 ()(
max
-
	`ËmÚSŒËn
(
İ
[
i
].
Ïb–
)-8),"",İ[i].
mes§ge
);

1969 
	}
}

1976 
	sp¡©e
 {

1977 *
	mf’ame
;

1978 
	mtok’lš’o
;

1979 
	m”rÜút
;

1980 *
	mtok’¡¬t
;

1981 
ËmÚ
 *
	mgp
;

1982 
	ee_¡©e
 {

1983 
	mINITIALIZE
,

1984 
	mWAITING_FOR_DECL_OR_RULE
,

1985 
	mWAITING_FOR_DECL_KEYWORD
,

1986 
	mWAITING_FOR_DECL_ARG
,

1987 
	mWAITING_FOR_PRECEDENCE_SYMBOL
,

1988 
	mWAITING_FOR_ARROW
,

1989 
	mIN_RHS
,

1990 
	mLHS_ALIAS_1
,

1991 
	mLHS_ALIAS_2
,

1992 
	mLHS_ALIAS_3
,

1993 
	mRHS_ALIAS_1
,

1994 
	mRHS_ALIAS_2
,

1995 
	mPRECEDENCE_MARK_1
,

1996 
	mPRECEDENCE_MARK_2
,

1997 
	mRESYNC_AFTER_RULE_ERROR
,

1998 
	mRESYNC_AFTER_DECL_ERROR
,

1999 
	mWAITING_FOR_DESTRUCTOR_SYMBOL
,

2000 
	mWAITING_FOR_DATATYPE_SYMBOL
,

2001 
	mWAITING_FOR_FALLBACK_ID
,

2002 
	mWAITING_FOR_WILDCARD_ID


2003 } 
	m¡©e
;

2004 
symbŞ
 *
	mçÎback
;

2005 
symbŞ
 *
	mlhs
;

2006 *
	mlh§lŸs
;

2007 
	mÄhs
;

2008 
symbŞ
 *
	mrhs
[
MAXRHS
];

2009 *
	m®Ÿs
[
MAXRHS
];

2010 
ruË
 *
	m´evruË
;

2011 *
	mdeşkeywÜd
;

2012 **
	mdeş¬g¦Ù
;

2013 
	mš£¹LšeMaüo
;

2014 *
	mdeşlš’o¦Ù
;

2015 
e_assoc
 
	mdeşassoc
;

2016 
	m´eccouÁ”
;

2017 
ruË
 *
	mfœ¡ruË
;

2018 
ruË
 *
	mÏ¡ruË
;

2022 
	$·r£Ú‘ok’
(
p¥
)

2023 
p¡©e
 *
p¥
;

2025 *
x
;

2026 
x
 = 
	`SŒ§ã
(
p¥
->
tok’¡¬t
);

2028 
	`´štf
("%s:%d: Tok’=[%s] s‹=%d\n",
p¥
->
f’ame
,p¥->
tok’lš’o
,

2029 
x
,
p¥
->
¡©e
);

2031  
p¥
->
¡©e
 ){

2032 
INITIALIZE
:

2033 
p¥
->
´evruË
 = 0;

2034 
p¥
->
´eccouÁ”
 = 0;

2035 
p¥
->
fœ¡ruË
 =…¥->
Ï¡ruË
 = 0;

2036 
p¥
->
gp
->
ÄuË
 = 0;

2038 
WAITING_FOR_DECL_OR_RULE
:

2039 ifĞ
x
[0]=='%' ){

2040 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_KEYWORD
;

2041 }ifĞ
	`i¦ow”
(
x
[0]) ){

2042 
p¥
->
lhs
 = 
	`SymbŞ_Ãw
(
x
);

2043 
p¥
->
Ähs
 = 0;

2044 
p¥
->
lh§lŸs
 = 0;

2045 
p¥
->
¡©e
 = 
WAITING_FOR_ARROW
;

2046 }ifĞ
x
[0]=='{' ){

2047 ifĞ
p¥
->
´evruË
==0 ){

2048 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2051 
p¥
->
”rÜút
++;

2052 }ifĞ
p¥
->
´evruË
->
code
!=0 ){

2053 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2056 
p¥
->
”rÜút
++;

2058 
p¥
->
´evruË
->
lše
 =…¥->
tok’lš’o
;

2059 
p¥
->
´evruË
->
code
 = &
x
[1];

2061 }ifĞ
x
[0]=='[' ){

2062 
p¥
->
¡©e
 = 
PRECEDENCE_MARK_1
;

2064 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2066 
x
);

2067 
p¥
->
”rÜút
++;

2070 
PRECEDENCE_MARK_1
:

2071 ifĞ!
	`isuµ”
(
x
[0]) ){

2072 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2074 
p¥
->
”rÜút
++;

2075 }ifĞ
p¥
->
´evruË
==0 ){

2076 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2077 "Th”i nØ´iÜ„uËØassigÀ´eûd’û \"[%s]\".",
x
);

2078 
p¥
->
”rÜút
++;

2079 }ifĞ
p¥
->
´evruË
->
´ecsym
!=0 ){

2080 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2083 
p¥
->
”rÜút
++;

2085 
p¥
->
´evruË
->
´ecsym
 = 
	`SymbŞ_Ãw
(
x
);

2087 
p¥
->
¡©e
 = 
PRECEDENCE_MARK_2
;

2089 
PRECEDENCE_MARK_2
:

2090 ifĞ
x
[0]!=']' ){

2091 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2093 
p¥
->
”rÜút
++;

2095 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_OR_RULE
;

2097 
WAITING_FOR_ARROW
:

2098 ifĞ
x
[0]==':' && x[1]==':' && x[2]=='=' ){

2099 
p¥
->
¡©e
 = 
IN_RHS
;

2100 }ifĞ
x
[0]=='(' ){

2101 
p¥
->
¡©e
 = 
LHS_ALIAS_1
;

2103 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2105 
p¥
->
lhs
->
Çme
);

2106 
p¥
->
”rÜút
++;

2107 
p¥
->
¡©e
 = 
RESYNC_AFTER_RULE_ERROR
;

2110 
LHS_ALIAS_1
:

2111 ifĞ
	`i§Íha
(
x
[0]) ){

2112 
p¥
->
lh§lŸs
 = 
x
;

2113 
p¥
->
¡©e
 = 
LHS_ALIAS_2
;

2115 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2117 
x
,
p¥
->
lhs
->
Çme
);

2118 
p¥
->
”rÜút
++;

2119 
p¥
->
¡©e
 = 
RESYNC_AFTER_RULE_ERROR
;

2122 
LHS_ALIAS_2
:

2123 ifĞ
x
[0]==')' ){

2124 
p¥
->
¡©e
 = 
LHS_ALIAS_3
;

2126 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2127 "Missšg \")\" fŞlowšg LHS‡lŸ Çm\"%s\".",
p¥
->
lh§lŸs
);

2128 
p¥
->
”rÜút
++;

2129 
p¥
->
¡©e
 = 
RESYNC_AFTER_RULE_ERROR
;

2132 
LHS_ALIAS_3
:

2133 ifĞ
x
[0]==':' && x[1]==':' && x[2]=='=' ){

2134 
p¥
->
¡©e
 = 
IN_RHS
;

2136 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2138 
p¥
->
lhs
->
Çme
,p¥->
lh§lŸs
);

2139 
p¥
->
”rÜút
++;

2140 
p¥
->
¡©e
 = 
RESYNC_AFTER_RULE_ERROR
;

2143 
IN_RHS
:

2144 ifĞ
x
[0]=='.' ){

2145 
ruË
 *
½
;

2146 
½
 = (
ruË
 *)
	`ÿÎoc
( (rule) +

2147 (
symbŞ
*)*
p¥
->
Ähs
 + (*)*psp->nrhs, 1);

2148 ifĞ
½
==0 ){

2149 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2151 
p¥
->
”rÜút
++;

2152 
p¥
->
´evruË
 = 0;

2154 
i
;

2155 
½
->
ruËlše
 = 
p¥
->
tok’lš’o
;

2156 
½
->
rhs
 = (
symbŞ
**)&rp[1];

2157 
½
->
rh§lŸs
 = (**)&Ôp->
rhs
[
p¥
->
Ähs
]);

2158 
i
=0; i<
p¥
->
Ähs
; i++){

2159 
½
->
rhs
[
i
] = 
p¥
->rhs[i];

2160 
½
->
rh§lŸs
[
i
] = 
p¥
->
®Ÿs
[i];

2162 
½
->
lhs
 = 
p¥
->lhs;

2163 
½
->
lh§lŸs
 = 
p¥
->lhsalias;

2164 
½
->
Ähs
 = 
p¥
->nrhs;

2165 
½
->
code
 = 0;

2166 
½
->
´ecsym
 = 0;

2167 
½
->
šdex
 = 
p¥
->
gp
->
ÄuË
++;

2168 
½
->
Ãxhs
 =„p->
lhs
->
ruË
;

2169 
½
->
lhs
->
ruË
 =„p;

2170 
½
->
Ãxt
 = 0;

2171 ifĞ
p¥
->
fœ¡ruË
==0 ){

2172 
p¥
->
fœ¡ruË
 =…¥->
Ï¡ruË
 = 
½
;

2174 
p¥
->
Ï¡ruË
->
Ãxt
 = 
½
;

2175 
p¥
->
Ï¡ruË
 = 
½
;

2177 
p¥
->
´evruË
 = 
½
;

2179 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_OR_RULE
;

2180 }ifĞ
	`i§Íha
(
x
[0]) ){

2181 ifĞ
p¥
->
Ähs
>=
MAXRHS
 ){

2182 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2184 
x
);

2185 
p¥
->
”rÜút
++;

2186 
p¥
->
¡©e
 = 
RESYNC_AFTER_RULE_ERROR
;

2188 
p¥
->
rhs
[p¥->
Ähs
] = 
	`SymbŞ_Ãw
(
x
);

2189 
p¥
->
®Ÿs
[p¥->
Ähs
] = 0;

2190 
p¥
->
Ähs
++;

2192 }ifĞ(
x
[0]=='|' || x[0]=='/'è&& 
p¥
->
Ähs
>0 ){

2193 
symbŞ
 *
m¥
 = 
p¥
->
rhs
[p¥->
Ähs
-1];

2194 ifĞ
m¥
->
ty³
!=
MULTITERMINAL
 ){

2195 
symbŞ
 *
Üig¥
 = 
m¥
;

2196 
m¥
 = 
	`ÿÎoc
(1,(*msp));

2197 
	`mem£t
(
m¥
, 0, (*msp));

2198 
m¥
->
ty³
 = 
MULTITERMINAL
;

2199 
m¥
->
nsubsym
 = 1;

2200 
m¥
->
subsym
 = 
	`ÿÎoc
(1,(
symbŞ
*));

2201 
m¥
->
subsym
[0] = 
Üig¥
;

2202 
m¥
->
Çme
 = 
Üig¥
->name;

2203 
p¥
->
rhs
[p¥->
Ähs
-1] = 
m¥
;

2205 
m¥
->
nsubsym
++;

2206 
m¥
->
subsym
 = 
	`»®loc
(m¥->subsym, (
symbŞ
*)*m¥->
nsubsym
);

2207 
m¥
->
subsym
[m¥->
nsubsym
-1] = 
	`SymbŞ_Ãw
(&
x
[1]);

2208 ifĞ
	`i¦ow”
(
x
[1]è|| i¦ow”(
m¥
->
subsym
[0]->
Çme
[0]) ){

2209 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2211 
p¥
->
”rÜút
++;

2213 }ifĞ
x
[0]=='(' && 
p¥
->
Ähs
>0 ){

2214 
p¥
->
¡©e
 = 
RHS_ALIAS_1
;

2216 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2217 "IÎeg® ch¬aù” oÀRHS oàruË: \"%s\".",
x
);

2218 
p¥
->
”rÜút
++;

2219 
p¥
->
¡©e
 = 
RESYNC_AFTER_RULE_ERROR
;

2222 
RHS_ALIAS_1
:

2223 ifĞ
	`i§Íha
(
x
[0]) ){

2224 
p¥
->
®Ÿs
[p¥->
Ähs
-1] = 
x
;

2225 
p¥
->
¡©e
 = 
RHS_ALIAS_2
;

2227 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2229 
x
,
p¥
->
rhs
[p¥->
Ähs
-1]->
Çme
);

2230 
p¥
->
”rÜút
++;

2231 
p¥
->
¡©e
 = 
RESYNC_AFTER_RULE_ERROR
;

2234 
RHS_ALIAS_2
:

2235 ifĞ
x
[0]==')' ){

2236 
p¥
->
¡©e
 = 
IN_RHS
;

2238 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2239 "Missšg \")\" fŞlowšg LHS‡lŸ Çm\"%s\".",
p¥
->
lh§lŸs
);

2240 
p¥
->
”rÜút
++;

2241 
p¥
->
¡©e
 = 
RESYNC_AFTER_RULE_ERROR
;

2244 
WAITING_FOR_DECL_KEYWORD
:

2245 ifĞ
	`i§Íha
(
x
[0]) ){

2246 
p¥
->
deşkeywÜd
 = 
x
;

2247 
p¥
->
deş¬g¦Ù
 = 0;

2248 
p¥
->
deşlš’o¦Ù
 = 0;

2249 
p¥
->
š£¹LšeMaüo
 = 1;

2250 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_ARG
;

2251 ifĞ
	`¡rcmp
(
x
,"name")==0 ){

2252 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
Çme
);

2253 
p¥
->
š£¹LšeMaüo
 = 0;

2254 }ifĞ
	`¡rcmp
(
x
,"include")==0 ){

2255 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
šşude
);

2256 }ifĞ
	`¡rcmp
(
x
,"code")==0 ){

2257 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
exŒacode
);

2258 }ifĞ
	`¡rcmp
(
x
,"token_destructor")==0 ){

2259 
p¥
->
deş¬g¦Ù
 = &p¥->
gp
->
tok’de¡
;

2260 }ifĞ
	`¡rcmp
(
x
,"default_destructor")==0 ){

2261 
p¥
->
deş¬g¦Ù
 = &p¥->
gp
->
v¬de¡
;

2262 }ifĞ
	`¡rcmp
(
x
,"token_prefix")==0 ){

2263 
p¥
->
deş¬g¦Ù
 = &p¥->
gp
->
tok’´efix
;

2264 
p¥
->
š£¹LšeMaüo
 = 0;

2265 }ifĞ
	`¡rcmp
(
x
,"syntax_error")==0 ){

2266 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
”rÜ
);

2267 }ifĞ
	`¡rcmp
(
x
,"parse_accept")==0 ){

2268 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
acû±
);

2269 }ifĞ
	`¡rcmp
(
x
,"parse_failure")==0 ){

2270 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
çu»
);

2271 }ifĞ
	`¡rcmp
(
x
,"stack_overflow")==0 ){

2272 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
ov”æow
);

2273 }ifĞ
	`¡rcmp
(
x
,"extra_argument")==0 ){

2274 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
¬g
);

2275 
p¥
->
š£¹LšeMaüo
 = 0;

2276 }ifĞ
	`¡rcmp
(
x
,"token_type")==0 ){

2277 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
tok’ty³
);

2278 
p¥
->
š£¹LšeMaüo
 = 0;

2279 }ifĞ
	`¡rcmp
(
x
,"default_type")==0 ){

2280 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
v¬ty³
);

2281 
p¥
->
š£¹LšeMaüo
 = 0;

2282 }ifĞ
	`¡rcmp
(
x
,"stack_size")==0 ){

2283 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
¡acksize
);

2284 
p¥
->
š£¹LšeMaüo
 = 0;

2285 }ifĞ
	`¡rcmp
(
x
,"start_symbol")==0 ){

2286 
p¥
->
deş¬g¦Ù
 = &Õ¥->
gp
->
¡¬t
);

2287 
p¥
->
š£¹LšeMaüo
 = 0;

2288 }ifĞ
	`¡rcmp
(
x
,"left")==0 ){

2289 
p¥
->
´eccouÁ”
++;

2290 
p¥
->
deşassoc
 = 
LEFT
;

2291 
p¥
->
¡©e
 = 
WAITING_FOR_PRECEDENCE_SYMBOL
;

2292 }ifĞ
	`¡rcmp
(
x
,"right")==0 ){

2293 
p¥
->
´eccouÁ”
++;

2294 
p¥
->
deşassoc
 = 
RIGHT
;

2295 
p¥
->
¡©e
 = 
WAITING_FOR_PRECEDENCE_SYMBOL
;

2296 }ifĞ
	`¡rcmp
(
x
,"nonassoc")==0 ){

2297 
p¥
->
´eccouÁ”
++;

2298 
p¥
->
deşassoc
 = 
NONE
;

2299 
p¥
->
¡©e
 = 
WAITING_FOR_PRECEDENCE_SYMBOL
;

2300 }ifĞ
	`¡rcmp
(
x
,"destructor")==0 ){

2301 
p¥
->
¡©e
 = 
WAITING_FOR_DESTRUCTOR_SYMBOL
;

2302 }ifĞ
	`¡rcmp
(
x
,"type")==0 ){

2303 
p¥
->
¡©e
 = 
WAITING_FOR_DATATYPE_SYMBOL
;

2304 }ifĞ
	`¡rcmp
(
x
,"fallback")==0 ){

2305 
p¥
->
çÎback
 = 0;

2306 
p¥
->
¡©e
 = 
WAITING_FOR_FALLBACK_ID
;

2307 }ifĞ
	`¡rcmp
(
x
,"wildcard")==0 ){

2308 
p¥
->
¡©e
 = 
WAITING_FOR_WILDCARD_ID
;

2310 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2311 "UnknowÀdeş¬©iÚ keywÜd: \"%%%s\".",
x
);

2312 
p¥
->
”rÜút
++;

2313 
p¥
->
¡©e
 = 
RESYNC_AFTER_DECL_ERROR
;

2316 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2317 "IÎeg® deş¬©iÚ keywÜd: \"%s\".",
x
);

2318 
p¥
->
”rÜút
++;

2319 
p¥
->
¡©e
 = 
RESYNC_AFTER_DECL_ERROR
;

2322 
WAITING_FOR_DESTRUCTOR_SYMBOL
:

2323 ifĞ!
	`i§Íha
(
x
[0]) ){

2324 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2326 
p¥
->
”rÜút
++;

2327 
p¥
->
¡©e
 = 
RESYNC_AFTER_DECL_ERROR
;

2329 
symbŞ
 *
¥
 = 
	`SymbŞ_Ãw
(
x
);

2330 
p¥
->
deş¬g¦Ù
 = &
¥
->
de¡ruùÜ
;

2331 
p¥
->
deşlš’o¦Ù
 = &
¥
->
de¡Lš’o
;

2332 
p¥
->
š£¹LšeMaüo
 = 1;

2333 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_ARG
;

2336 
WAITING_FOR_DATATYPE_SYMBOL
:

2337 ifĞ!
	`i§Íha
(
x
[0]) ){

2338 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2340 
p¥
->
”rÜút
++;

2341 
p¥
->
¡©e
 = 
RESYNC_AFTER_DECL_ERROR
;

2343 
symbŞ
 *
¥
 = 
	`SymbŞ_Ãw
(
x
);

2344 
p¥
->
deş¬g¦Ù
 = &
¥
->
d©©y³
;

2345 
p¥
->
š£¹LšeMaüo
 = 0;

2346 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_ARG
;

2349 
WAITING_FOR_PRECEDENCE_SYMBOL
:

2350 ifĞ
x
[0]=='.' ){

2351 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_OR_RULE
;

2352 }ifĞ
	`isuµ”
(
x
[0]) ){

2353 
symbŞ
 *
¥
;

2354 
¥
 = 
	`SymbŞ_Ãw
(
x
);

2355 ifĞ
¥
->
´ec
>=0 ){

2356 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2357 "SymbŞ \"%s\" ha ®»ady bgiv’‡…»ûd’û.",
x
);

2358 
p¥
->
”rÜút
++;

2360 
¥
->
´ec
 = 
p¥
->
´eccouÁ”
;

2361 
¥
->
assoc
 = 
p¥
->
deşassoc
;

2364 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2365 "Cª'ˆassigÀ¨´eûd’ûØ\"%s\".",
x
);

2366 
p¥
->
”rÜút
++;

2369 
WAITING_FOR_DECL_ARG
:

2370 ifĞ
x
[0]=='{' || x[0]=='\"' || 
	`i§Êum
(x[0]) ){

2371 *
zOld
, *
zNew
, *
zBuf
, *
z
;

2372 
nOld
, 
n
, 
nLše
, 
nNew
, 
nBack
;

2373 
addLšeMaüo
;

2374 
zLše
[50];

2375 
zNew
 = 
x
;

2376 ifĞ
zNew
[0]=='"' || zNew[0]=='{' ) zNew++;

2377 
nNew
 = 
	`ËmÚSŒËn
(
zNew
);

2378 ifĞ*
p¥
->
deş¬g¦Ù
 ){

2379 
zOld
 = *
p¥
->
deş¬g¦Ù
;

2381 
zOld
 = "";

2383 
nOld
 = 
	`ËmÚSŒËn
(
zOld
);

2384 
n
 = 
nOld
 + 
nNew
 + 20;

2385 
addLšeMaüo
 = !
p¥
->
gp
->
nŞš’osæag
 &&…¥->
š£¹LšeMaüo
 &&

2386 (
p¥
->
deşlš’o¦Ù
==0 ||…sp->decllinenoslot[0]!=0);

2387 ifĞ
addLšeMaüo
 ){

2388 
z
=
p¥
->
f’ame
, 
nBack
=0; *z; z++){

2389 ifĞ*
z
=='\\' ) 
nBack
++;

2391 
	`¥rštf
(
zLše
, "#lš%d ", 
p¥
->
tok’lš’o
);

2392 
nLše
 = 
	`ËmÚSŒËn
(
zLše
);

2393 
n
 +ğ
nLše
 + 
	`ËmÚSŒËn
(
p¥
->
f’ame
è+ 
nBack
;

2395 *
p¥
->
deş¬g¦Ù
 = 
zBuf
 = 
	`»®loc
(*p¥->deş¬g¦Ù, 
n
);

2396 
zBuf
 +ğ
nOld
;

2397 ifĞ
addLšeMaüo
 ){

2398 ifĞ
nOld
 && 
zBuf
[-1]!='\n' ){

2399 *(
zBuf
++) = '\n';

2401 
	`memıy
(
zBuf
, 
zLše
, 
nLše
);

2402 
zBuf
 +ğ
nLše
;

2403 *(
zBuf
++) = '"';

2404 
z
=
p¥
->
f’ame
; *z; z++){

2405 ifĞ*
z
=='\\' ){

2406 *(
zBuf
++) = '\\';

2408 *(
zBuf
++èğ*
z
;

2410 *(
zBuf
++) = '"';

2411 *(
zBuf
++) = '\n';

2413 ifĞ
p¥
->
deşlš’o¦Ù
 &&…sp->decllinenoslot[0]==0 ){

2414 
p¥
->
deşlš’o¦Ù
[0] =…¥->
tok’lš’o
;

2416 
	`memıy
(
zBuf
, 
zNew
, 
nNew
);

2417 
zBuf
 +ğ
nNew
;

2418 *
zBuf
 = 0;

2419 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_OR_RULE
;

2421 
	`E¼ÜMsg
(
p¥
->
f’ame
,p¥->
tok’lš’o
,

2422 "IÎeg®‡rgum’ˆtØ%%%s: %s",
p¥
->
deşkeywÜd
,
x
);

2423 
p¥
->
”rÜút
++;

2424 
p¥
->
¡©e
 = 
RESYNC_AFTER_DECL_ERROR
;

2427 
WAITING_FOR_FALLBACK_ID
:

2428 ifĞ
x
[0]=='.' ){

2429 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_OR_RULE
;

2430 }ifĞ!
	`isuµ”
(
x
[0]) ){

2431 
	`E¼ÜMsg
(
p¥
->
f’ame
,…¥->
tok’lš’o
,

2432 "%%çÎback‡rgum’ˆ\"%s\" should b¨tok’", 
x
);

2433 
p¥
->
”rÜút
++;

2435 
symbŞ
 *
¥
 = 
	`SymbŞ_Ãw
(
x
);

2436 ifĞ
p¥
->
çÎback
==0 ){

2437 
p¥
->
çÎback
 = 
¥
;

2438 }ifĞ
¥
->
çÎback
 ){

2439 
	`E¼ÜMsg
(
p¥
->
f’ame
,…¥->
tok’lš’o
,

2440 "MÜthª oÃ f®lback‡ssigÃdØtok’ %s", 
x
);

2441 
p¥
->
”rÜút
++;

2443 
¥
->
çÎback
 = 
p¥
->fallback;

2444 
p¥
->
gp
->
has_çÎback
 = 1;

2448 
WAITING_FOR_WILDCARD_ID
:

2449 ifĞ
x
[0]=='.' ){

2450 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_OR_RULE
;

2451 }ifĞ!
	`isuµ”
(
x
[0]) ){

2452 
	`E¼ÜMsg
(
p¥
->
f’ame
,…¥->
tok’lš’o
,

2453 "%%wdÿrd‡rgum’ˆ\"%s\" should b¨tok’", 
x
);

2454 
p¥
->
”rÜút
++;

2456 
symbŞ
 *
¥
 = 
	`SymbŞ_Ãw
(
x
);

2457 ifĞ
p¥
->
gp
->
wdÿrd
==0 ){

2458 
p¥
->
gp
->
wdÿrd
 = 
¥
;

2460 
	`E¼ÜMsg
(
p¥
->
f’ame
,…¥->
tok’lš’o
,

2461 "ExŒ¨wdÿrdØtok’: %s", 
x
);

2462 
p¥
->
”rÜút
++;

2466 
RESYNC_AFTER_RULE_ERROR
:

2469 
RESYNC_AFTER_DECL_ERROR
:

2470 ifĞ
x
[0]=='.' ) 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_OR_RULE
;

2471 ifĞ
x
[0]=='%' ) 
p¥
->
¡©e
 = 
WAITING_FOR_DECL_KEYWORD
;

2474 
	}
}

2481 
	$´•roûss_šput
(*
z
){

2482 
i
, 
j
, 
k
, 
n
;

2483 
exşude
 = 0;

2484 
¡¬t
 = 0;

2485 
lš’o
 = 1;

2486 
¡¬t_lš’o
 = 1;

2487 
i
=0; 
z
[i]; i++){

2488 ifĞ
z
[
i
]=='\n' ) 
lš’o
++;

2489 ifĞ
z
[
i
]!='%' || (i>0 && z[i-1]!='\n') ) ;

2490 ifĞ
	`¡ºcmp
(&
z
[
i
],"%’dif",6)==0 && 
	`is¥aû
(z[i+6]) ){

2491 ifĞ
exşude
 ){

2492 
exşude
--;

2493 ifĞ
exşude
==0 ){

2494 
j
=
¡¬t
; j<
i
; j++èifĞ
z
[j]!='\n' ) z[j] = ' ';

2497 
j
=
i
; 
z
[j] && z[j]!='\n'; j++) z[j] = ' ';

2498 }ifĞ(
	`¡ºcmp
(&
z
[
i
],"%ifdef",6)==0 && 
	`is¥aû
(z[i+6]))

2499 || (
	`¡ºcmp
(&
z
[
i
],"%iâdef",7)==0 && 
	`is¥aû
(z[i+7])) ){

2500 ifĞ
exşude
 ){

2501 
exşude
++;

2503 
j
=
i
+7; 
	`is¥aû
(
z
[j]); j++){}

2504 
n
=0; 
z
[
j
+n] && !
	`is¥aû
(z[j+n]);‚++){}

2505 
exşude
 = 1;

2506 
k
=0; k<
nDefše
; k++){

2507 ifĞ
	`¡ºcmp
(
azDefše
[
k
],&
z
[
j
],
n
)==0 && 
	`ËmÚSŒËn
(azDefine[k])==n ){

2508 
exşude
 = 0;

2512 ifĞ
z
[
i
+3]=='n' ) 
exşude
 = !exclude;

2513 ifĞ
exşude
 ){

2514 
¡¬t
 = 
i
;

2515 
¡¬t_lš’o
 = 
lš’o
;

2518 
j
=
i
; 
z
[j] && z[j]!='\n'; j++) z[j] = ' ';

2521 ifĞ
exşude
 ){

2522 
	`årštf
(
¡d”r
,"uÁ”mš©ed %%ifdeà¡¬tšg oÀlš%d\n", 
¡¬t_lš’o
);

2523 
	`ex™
(1);

2525 
	}
}

2532 
	$P¬£
(
gp
)

2533 
ËmÚ
 *
gp
;

2535 
p¡©e
 
ps
;

2536 
FILE
 *
å
;

2537 *
febuf
;

2538 
fesize
;

2539 
lš’o
;

2540 
c
;

2541 *
ı
, *
Ãxtı
;

2542 
¡¬še
 = 0;

2544 
	`mem£t
(&
ps
, '\0', (ps));

2545 
ps
.
gp
 = gp;

2546 
ps
.
f’ame
 = 
gp
->filename;

2547 
ps
.
”rÜút
 = 0;

2548 
ps
.
¡©e
 = 
INITIALIZE
;

2551 
å
 = 
	`fİ’
(
ps
.
f’ame
,"rb");

2552 ifĞ
å
==0 ){

2553 
	`E¼ÜMsg
(
ps
.
f’ame
,0,"Can't openhis file for„eading.");

2554 
gp
->
”rÜút
++;

2557 
	`f£ek
(
å
,0,2);

2558 
fesize
 = 
	`á–l
(
å
);

2559 ifĞ
fesize
==-1 ){

2560 
	`E¼ÜMsg
(
ps
.
f’ame
,0,"Couldn't„ead size ofhis file.");

2561 
gp
->
”rÜút
++;

2564 
	`»wšd
(
å
);

2565 
febuf
 = (*)
	`m®loc
Ğ
fesize
+1 );

2566 ifĞ
febuf
==0 ){

2567 
	`E¼ÜMsg
(
ps
.
f’ame
,0,"Can't‡llocate %d of memoryo holdhis file.",

2568 
fesize
+1);

2569 
gp
->
”rÜút
++;

2572 ifĞ
	`ä—d
(
febuf
,1,
fesize
,
å
)!=(
size_t
)filesize ){

2573 
	`E¼ÜMsg
(
ps
.
f’ame
,0,"Can't„ead in‡ll %d bytes ofhis file.",

2574 
fesize
);

2575 
	`ä“
(
febuf
);

2576 
gp
->
”rÜút
++;

2579 
	`fşo£
(
å
);

2580 
febuf
[
fesize
] = 0;

2583 
	`´•roûss_šput
(
febuf
);

2586 
lš’o
 = 1;

2587 
ı
=
febuf
; (
c
= *cp)!=0; ){

2588 ifĞ
c
=='\n' ) 
lš’o
++;

2589 ifĞ
	`is¥aû
(
c
è){ 
ı
++; ; }

2590 ifĞ
c
=='/' && 
ı
[1]=='/' ){

2591 
ı
+=2;

2592  (
c
ğ*
ı
)!=0 && c!='\n' ) cp++;

2595 ifĞ
c
=='/' && 
ı
[1]=='*' ){

2596 
ı
+=2;

2597  (
c
ğ*
ı
)!=0 && (c!='/' || cp[-1]!='*') ){

2598 ifĞ
c
=='\n' ) 
lš’o
++;

2599 
ı
++;

2601 ifĞ
c
 ) 
ı
++;

2604 
ps
.
tok’¡¬t
 = 
ı
;

2605 
ps
.
tok’lš’o
 = 
lš’o
;

2606 ifĞ
c
=='\"' ){

2607 
ı
++;

2608  (
c
ğ*
ı
)!=0 && c!='\"' ){

2609 ifĞ
c
=='\n' ) 
lš’o
++;

2610 
ı
++;

2612 ifĞ
c
==0 ){

2613 
	`E¼ÜMsg
(
ps
.
f’ame
,
¡¬še
,

2615 
ps
.
”rÜút
++;

2616 
Ãxtı
 = 
ı
;

2618 
Ãxtı
 = 
ı
+1;

2620 }ifĞ
c
=='{' ){

2621 
Ëv–
;

2622 
ı
++;

2623 
Ëv–
=1; (
c
ğ*
ı
)!=0 && (level>1 || c!='}'); cp++){

2624 ifĞ
c
=='\n' ) 
lš’o
++;

2625 ifĞ
c
=='{' ) 
Ëv–
++;

2626 ifĞ
c
=='}' ) 
Ëv–
--;

2627 ifĞ
c
=='/' && 
ı
[1]=='*' ){

2628 
´evc
;

2629 
ı
 = &cp[2];

2630 
´evc
 = 0;

2631  (
c
ğ*
ı
)!=0 && (c!='/' || 
´evc
!='*') ){

2632 ifĞ
c
=='\n' ) 
lš’o
++;

2633 
´evc
 = 
c
;

2634 
ı
++;

2636 }ifĞ
c
=='/' && 
ı
[1]=='/' ){

2637 
ı
 = &cp[2];

2638  (
c
ğ*
ı
)!=0 && c!='\n' ) cp++;

2639 ifĞ
c
 ) 
lš’o
++;

2640 }ifĞ
c
=='\'' || c=='\"' ){

2641 
¡¬tch¬
, 
´evc
;

2642 
¡¬tch¬
 = 
c
;

2643 
´evc
 = 0;

2644 
ı
++; (
c
ğ*ı)!=0 && (c!=
¡¬tch¬
 || 
´evc
=='\\'); cp++){

2645 ifĞ
c
=='\n' ) 
lš’o
++;

2646 ifĞ
´evc
=='\\' )…revc = 0;

2647 
´evc
 = 
c
;

2651 ifĞ
c
==0 ){

2652 
	`E¼ÜMsg
(
ps
.
f’ame
,ps.
tok’lš’o
,

2654 
ps
.
”rÜút
++;

2655 
Ãxtı
 = 
ı
;

2657 
Ãxtı
 = 
ı
+1;

2659 }ifĞ
	`i§Êum
(
c
) ){

2660  (
c
ğ*
ı
)!=0 && (
	`i§Êum
(c) || c=='_') ) cp++;

2661 
Ãxtı
 = 
ı
;

2662 }ifĞ
c
==':' && 
ı
[1]==':' && cp[2]=='=' ){

2663 
ı
 += 3;

2664 
Ãxtı
 = 
ı
;

2665 }ifĞ(
c
=='/' || c=='|'è&& 
	`i§Íha
(
ı
[1]) ){

2666 
ı
 += 2;

2667  (
c
 = *
ı
)!=0 && (
	`i§Êum
(c) || c=='_') ) cp++;

2668 
Ãxtı
 = 
ı
;

2670 
ı
++;

2671 
Ãxtı
 = 
ı
;

2673 
c
 = *
ı
;

2674 *
ı
 = 0;

2675 
	`·r£Ú‘ok’
(&
ps
);

2676 *
ı
 = 
c
;

2677 
ı
 = 
Ãxtı
;

2679 
	`ä“
(
febuf
);

2680 
gp
->
ruË
 = 
ps
.
fœ¡ruË
;

2681 
gp
->
”rÜút
 = 
ps
.errorcnt;

2682 
	}
}

2688 
¶šk
 *
	g¶šk_ä“li¡
 = 0;

2691 
¶šk
 *
	$Plšk_Ãw
(){

2692 
¶šk
 *
Ãw
;

2694 ifĞ
¶šk_ä“li¡
==0 ){

2695 
i
;

2696 
amt
 = 100;

2697 
¶šk_ä“li¡
 = (
¶šk
 *)
	`ÿÎoc
Ğ
amt
, (plink) );

2698 ifĞ
¶šk_ä“li¡
==0 ){

2699 
	`årštf
(
¡d”r
,

2701 
	`ex™
(1);

2703 
i
=0; i<
amt
-1; i++è
¶šk_ä“li¡
[i].
Ãxt
 = &plink_freelist[i+1];

2704 
¶šk_ä“li¡
[
amt
-1].
Ãxt
 = 0;

2706 
Ãw
 = 
¶šk_ä“li¡
;

2707 
¶šk_ä“li¡
 =…lšk_ä“li¡->
Ãxt
;

2708  
Ãw
;

2709 
	}
}

2712 
	$Plšk_add
(
¶µ
,
cå
)

2713 
¶šk
 **
¶µ
;

2714 
cÚfig
 *
cå
;

2716 
¶šk
 *
Ãw
;

2717 
Ãw
 = 
	`Plšk_Ãw
();

2718 
Ãw
->
Ãxt
 = *
¶µ
;

2719 *
¶µ
 = 
Ãw
;

2720 
Ãw
->
cå
 = cfp;

2721 
	}
}

2724 
	$Plšk_cİy
(
to
,
äom
)

2725 
¶šk
 **
to
;

2726 
¶šk
 *
äom
;

2728 
¶šk
 *
Ãxl
;

2729  
äom
 ){

2730 
Ãxl
 = 
äom
->
Ãxt
;

2731 
äom
->
Ãxt
 = *
to
;

2732 *
to
 = 
äom
;

2733 
äom
 = 
Ãxl
;

2735 
	}
}

2738 
	$Plšk_d–‘e
(
¶p
)

2739 
¶šk
 *
¶p
;

2741 
¶šk
 *
Ãxl
;

2743  
¶p
 ){

2744 
Ãxl
 = 
¶p
->
Ãxt
;

2745 
¶p
->
Ãxt
 = 
¶šk_ä“li¡
;

2746 
¶šk_ä“li¡
 = 
¶p
;

2747 
¶p
 = 
Ãxl
;

2749 
	}
}

2759 
PRIVATE
 *
	$fe_mak’ame
(
Ëmp
,
suffix
)

2760 
ËmÚ
 *
Ëmp
;

2761 *
suffix
;

2763 *
Çme
;

2764 *
ı
;

2766 
Çme
 = 
	`m®loc
Ğ
	`ËmÚSŒËn
(
Ëmp
->
f’ame
è+†emÚSŒËn(
suffix
) + 5 );

2767 ifĞ
Çme
==0 ){

2768 
	`årštf
(
¡d”r
,"Can't‡llocate space for‡ filename.\n");

2769 
	`ex™
(1);

2771 
	`¡rıy
(
Çme
,
Ëmp
->
f’ame
);

2772 
ı
 = 
	`¡¼chr
(
Çme
,'.');

2773 ifĞ
ı
 ) *cp = 0;

2774 
	`¡rÿt
(
Çme
,
suffix
);

2775  
Çme
;

2776 
	}
}

2781 
PRIVATE
 
FILE
 *
	$fe_İ’
(
Ëmp
,
suffix
,
mode
)

2782 
ËmÚ
 *
Ëmp
;

2783 *
suffix
;

2784 *
mode
;

2786 
FILE
 *
å
;

2788 ifĞ
Ëmp
->
ouŠame
 ) 
	`ä“
(lemp->outname);

2789 
Ëmp
->
ouŠame
 = 
	`fe_mak’ame
Öemp, 
suffix
);

2790 
å
 = 
	`fİ’
(
Ëmp
->
ouŠame
,
mode
);

2791 ifĞ
å
==0 && *
mode
=='w' ){

2792 
	`årštf
(
¡d”r
,"Cª'ˆİ’ f\"%s\".\n",
Ëmp
->
ouŠame
);

2793 
Ëmp
->
”rÜút
++;

2796  
å
;

2797 
	}
}

2801 
	$R•ršt
(
Ëmp
)

2802 
ËmÚ
 *
Ëmp
;

2804 
ruË
 *
½
;

2805 
symbŞ
 *
¥
;

2806 
i
, 
j
, 
maxËn
, 
Ën
, 
ncŞumns
, 
sk
;

2807 
	`´štf
("// R•ršˆoàšpuˆf\"%s\".\n// SymbŞs:\n",
Ëmp
->
f’ame
);

2808 
maxËn
 = 10;

2809 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

2810 
¥
 = 
Ëmp
->
symbŞs
[
i
];

2811 
Ën
 = 
	`ËmÚSŒËn
(
¥
->
Çme
);

2812 ifĞ
Ën
>
maxËn
 ) maxlen =†en;

2814 
ncŞumns
 = 76/(
maxËn
+5);

2815 ifĞ
ncŞumns
<1 )‚columns = 1;

2816 
sk
 = (
Ëmp
->
nsymbŞ
 + 
ncŞumns
 - 1)/ncolumns;

2817 
i
=0; i<
sk
; i++){

2818 
	`´štf
("//");

2819 
j
=
i
; j<
Ëmp
->
nsymbŞ
; j+=
sk
){

2820 
¥
 = 
Ëmp
->
symbŞs
[
j
];

2821 
	`as£¹
Ğ
¥
->
šdex
==
j
 );

2822 
	`´štf
(" %3d %-*.*s",
j
,
maxËn
,maxËn,
¥
->
Çme
);

2824 
	`´štf
("\n");

2826 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

2827 
	`´štf
("%s",
½
->
lhs
->
Çme
);

2829 
	`´štf
(" ::=");

2830 
i
=0; i<
½
->
Ähs
; i++){

2831 
¥
 = 
½
->
rhs
[
i
];

2832 
	`´štf
(" %s", 
¥
->
Çme
);

2833 ifĞ
¥
->
ty³
==
MULTITERMINAL
 ){

2834 
j
=1; j<
¥
->
nsubsym
; j++){

2835 
	`´štf
("|%s", 
¥
->
subsym
[
j
]->
Çme
);

2840 
	`´štf
(".");

2841 ifĞ
½
->
´ecsym
 ) 
	`´štf
(" [%s]",½->´ecsym->
Çme
);

2843 
	`´štf
("\n");

2845 
	}
}

2847 
	$CÚfigPršt
(
å
,
cå
)

2848 
FILE
 *
å
;

2849 
cÚfig
 *
cå
;

2851 
ruË
 *
½
;

2852 
symbŞ
 *
¥
;

2853 
i
, 
j
;

2854 
½
 = 
cå
->rp;

2855 
	`årštf
(
å
,"% ::=",
½
->
lhs
->
Çme
);

2856 
i
=0; i<=
½
->
Ähs
; i++){

2857 ifĞ
i
==
cå
->
dÙ
 ) 
	`årštf
(
å
," *");

2858 ifĞ
i
==
½
->
Ähs
 ) ;

2859 
¥
 = 
½
->
rhs
[
i
];

2860 
	`årštf
(
å
," %s", 
¥
->
Çme
);

2861 ifĞ
¥
->
ty³
==
MULTITERMINAL
 ){

2862 
j
=1; j<
¥
->
nsubsym
; j++){

2863 
	`årštf
(
å
,"|%s",
¥
->
subsym
[
j
]->
Çme
);

2867 
	}
}

2872 
PRIVATE
 
	$S‘Pršt
(
out
,
£t
,
Ëmp
)

2873 
FILE
 *
out
;

2874 *
£t
;

2875 
ËmÚ
 *
Ëmp
;

2877 
i
;

2878 *
¥aûr
;

2879 
¥aûr
 = "";

2880 
	`årštf
(
out
,"%12s[","");

2881 
i
=0; i<
Ëmp
->
Á”mš®
; i++){

2882 ifĞ
	`S‘Fšd
(
£t
,
i
) ){

2883 
	`årštf
(
out
,"%s%s",
¥aûr
,
Ëmp
->
symbŞs
[
i
]->
Çme
);

2884 
¥aûr
 = " ";

2887 
	`årštf
(
out
,"]\n");

2888 
	}
}

2891 
PRIVATE
 
	$PlškPršt
(
out
,
¶p
,
g
)

2892 
FILE
 *
out
;

2893 
¶šk
 *
¶p
;

2894 *
g
;

2896  
¶p
 ){

2897 
	`årštf
(
out
,"%12s% (¡©%2dè","",
g
,
¶p
->
cå
->
¡p
->
¡©’um
);

2898 
	`CÚfigPršt
(
out
,
¶p
->
cå
);

2899 
	`årštf
(
out
,"\n");

2900 
¶p
 =…Í->
Ãxt
;

2902 
	}
}

2908 
	$PrštAùiÚ
(
aùiÚ
 *
­
, 
FILE
 *
å
, 
šd’t
){

2909 
»suÉ
 = 1;

2910  
­
->
ty³
 ){

2911 
SHIFT
:

2912 
	`årštf
(
å
,"%* shiá %d",
šd’t
,
­
->
¥
->
Çme
,­->
x
.
¡p
->
¡©’um
);

2914 
REDUCE
:

2915 
	`årštf
(
å
,"%* »duû %d",
šd’t
,
­
->
¥
->
Çme
,­->
x
.
½
->
šdex
);

2917 
ACCEPT
:

2918 
	`årštf
(
å
,"%* acû±",
šd’t
,
­
->
¥
->
Çme
);

2920 
ERROR
:

2921 
	`årštf
(
å
,"%* ”rÜ",
šd’t
,
­
->
¥
->
Çme
);

2923 
SRCONFLICT
:

2924 
RRCONFLICT
:

2925 
	`årštf
(
å
,"%*s„educe %-3d ** Parsing conflict **",

2926 
šd’t
,
­
->
¥
->
Çme
,­->
x
.
½
->
šdex
);

2928 
SSCONFLICT
:

2929 
	`årštf
(
å
,"%*s shift %d ** Parsing conflict **",

2930 
šd’t
,
­
->
¥
->
Çme
,­->
x
.
¡p
->
¡©’um
);

2932 
SH_RESOLVED
:

2933 
RD_RESOLVED
:

2934 
NOT_USED
:

2935 
»suÉ
 = 0;

2938  
»suÉ
;

2939 
	}
}

2942 
	$R•ÜtOuut
(
Ëmp
)

2943 
ËmÚ
 *
Ëmp
;

2945 
i
;

2946 
¡©e
 *
¡p
;

2947 
cÚfig
 *
cå
;

2948 
aùiÚ
 *
­
;

2949 
FILE
 *
å
;

2951 
å
 = 
	`fe_İ’
(
Ëmp
,".out","wb");

2952 ifĞ
å
==0 ) ;

2953 
i
=0; i<
Ëmp
->
n¡©e
; i++){

2954 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

2955 
	`årštf
(
å
,"S‹ %d:\n",
¡p
->
¡©’um
);

2956 ifĞ
Ëmp
->
basisæag
 ) 
cå
=
¡p
->
bp
;

2957 
cå
=
¡p
->cfp;

2958  
cå
 ){

2959 
buf
[20];

2960 ifĞ
cå
->
dÙ
==cå->
½
->
Ähs
 ){

2961 
	`¥rštf
(
buf
,"(%d)",
cå
->
½
->
šdex
);

2962 
	`årštf
(
å
," %5 ",
buf
);

2964 
	`årštf
(
å
," ");

2966 
	`CÚfigPršt
(
å
,
cå
);

2967 
	`årštf
(
å
,"\n");

2969 
	`S‘Pršt
(
å
,
cå
->
fws
,
Ëmp
);

2970 
	`PlškPršt
(
å
,
cå
->
åÍ
,"To ");

2971 
	`PlškPršt
(
å
,
cå
->
b¶p
,"From");

2973 ifĞ
Ëmp
->
basisæag
 ) 
cå
=cå->
bp
;

2974 
cå
=cå->
Ãxt
;

2976 
	`årštf
(
å
,"\n");

2977 
­
=
¡p
->­;‡p;‡p÷p->
Ãxt
){

2978 ifĞ
	`PrštAùiÚ
(
­
,
å
,30èè
	`årštf
(fp,"\n");

2980 
	`årštf
(
å
,"\n");

2982 
	`årštf
(
å
, "----------------------------------------------------\n");

2983 
	`årštf
(
å
, "Symbols:\n");

2984 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

2985 
j
;

2986 
symbŞ
 *
¥
;

2988 
¥
 = 
Ëmp
->
symbŞs
[
i
];

2989 
	`årštf
(
å
, " %3d: %s", 
i
, 
¥
->
Çme
);

2990 ifĞ
¥
->
ty³
==
NONTERMINAL
 ){

2991 
	`årštf
(
å
, ":");

2992 ifĞ
¥
->
Ïmbda
 ){

2993 
	`årštf
(
å
, " <lambda>");

2995 
j
=0; j<
Ëmp
->
Á”mš®
; j++){

2996 ifĞ
¥
->
fœ¡£t
 && 
	`S‘Fšd
(¥->fœ¡£t, 
j
) ){

2997 
	`årštf
(
å
, " %s", 
Ëmp
->
symbŞs
[
j
]->
Çme
);

3001 
	`årštf
(
å
, "\n");

3003 
	`fşo£
(
å
);

3005 
	}
}

3009 
PRIVATE
 *
	$·th£¬ch
(
¬gv0
,
Çme
,
modemask
)

3010 *
¬gv0
;

3011 *
Çme
;

3012 
modemask
;

3014 *
·thli¡
;

3015 *
·th
,*
ı
;

3016 
c
;

3018 #ifdeà
__WIN32__


3019 
ı
 = 
	`¡¼chr
(
¬gv0
,'\\');

3021 
ı
 = 
	`¡¼chr
(
¬gv0
,'/');

3023 ifĞ
ı
 ){

3024 
c
 = *
ı
;

3025 *
ı
 = 0;

3026 
·th
 = (*)
	`m®loc
Ğ
	`ËmÚSŒËn
(
¬gv0
è+†emÚSŒËn(
Çme
) + 2 );

3027 ifĞ
·th
 ) 
	`¥rštf
Õ©h,"%s/%s",
¬gv0
,
Çme
);

3028 *
ı
 = 
c
;

3030 *
	`g‘’v
();

3031 
·thli¡
 = 
	`g‘’v
("PATH");

3032 ifĞ
·thli¡
==0 )…athlist = ".:/bin:/usr/bin";

3033 
·th
 = (*)
	`m®loc
Ğ
	`ËmÚSŒËn
(
·thli¡
)+ËmÚSŒËn(
Çme
)+2 );

3034 ifĞ
·th
!=0 ){

3035  *
·thli¡
 ){

3036 
ı
 = 
	`¡rchr
(
·thli¡
,':');

3037 ifĞ
ı
==0 ) c°ğ&
·thli¡
[
	`ËmÚSŒËn
(pathlist)];

3038 
c
 = *
ı
;

3039 *
ı
 = 0;

3040 
	`¥rštf
(
·th
,"%s/%s",
·thli¡
,
Çme
);

3041 *
ı
 = 
c
;

3042 ifĞ
c
==0 ) 
·thli¡
 = "";

3043 
·thli¡
 = &
ı
[1];

3044 ifĞ
	`acûss
(
·th
,
modemask
)==0 ) ;

3048  
·th
;

3049 
	}
}

3055 
PRIVATE
 
	$compu‹_aùiÚ
(
Ëmp
,
­
)

3056 
ËmÚ
 *
Ëmp
;

3057 
aùiÚ
 *
­
;

3059 
aù
;

3060  
­
->
ty³
 ){

3061 
SHIFT
: 
aù
 = 
­
->
x
.
¡p
->
¡©’um
; ;

3062 
REDUCE
: 
aù
 = 
­
->
x
.
½
->
šdex
 + 
Ëmp
->
n¡©e
; ;

3063 
ERROR
: 
aù
 = 
Ëmp
->
n¡©e
 +†emp->
ÄuË
; ;

3064 
ACCEPT
: 
aù
 = 
Ëmp
->
n¡©e
 +†emp->
ÄuË
 + 1; ;

3065 : 
aù
 = -1; ;

3067  
aù
;

3068 
	}
}

3070 
	#LINESIZE
 1000

	)

3080 
PRIVATE
 
	$É_xãr
(
Çme
,
š
,
out
,
lš’o
)

3081 *
Çme
;

3082 
FILE
 *
š
;

3083 
FILE
 *
out
;

3084 *
lš’o
;

3086 
i
, 
iS¹
;

3087 
lše
[
LINESIZE
];

3088  
	`fg‘s
(
lše
,
LINESIZE
,
š
) && (line[0]!='%' ||†ine[1]!='%') ){

3089 (*
lš’o
)++;

3090 
iS¹
 = 0;

3091 ifĞ
Çme
 ){

3092 
i
=0; 
lše
[i]; i++){

3093 ifĞ
lše
[
i
]=='P' && 
	`¡ºcmp
(&line[i],"Parse",5)==0

3094 && (
i
==0 || !
	`i§Íha
(
lše
[i-1]))

3096 ifĞ
i
>
iS¹
 ) 
	`årštf
(
out
,"%.*s",i-iS¹,&
lše
[iStart]);

3097 
	`årštf
(
out
,"%s",
Çme
);

3098 
i
 += 4;

3099 
iS¹
 = 
i
+1;

3103 
	`årštf
(
out
,"%s",&
lše
[
iS¹
]);

3105 
	}
}

3109 
PRIVATE
 
FILE
 *
	$É_İ’
(
Ëmp
)

3110 
ËmÚ
 *
Ëmp
;

3112 
‹m¶©’ame
[] = "lempar.c";

3113 
buf
[1000];

3114 
FILE
 *
š
;

3115 *
ÉÇme
;

3116 *
ı
;

3117 *
to_ä“
 = 
NULL
;

3119 
ı
 = 
	`¡¼chr
(
Ëmp
->
f’ame
,'.');

3120 ifĞ
ı
 ){

3121 
	`¥rštf
(
buf
,"%.*s.É",()(
ı
-
Ëmp
->
f’ame
),lemp->filename);

3123 
	`¥rštf
(
buf
,"%s.É",
Ëmp
->
f’ame
);

3125 ifĞ
	`acûss
(
buf
,004)==0 ){

3126 
ÉÇme
 = 
buf
;

3127 }ifĞ
	`acûss
(
‹m¶©’ame
,004)==0 ){

3128 
ÉÇme
 = 
‹m¶©’ame
;

3130 
ÉÇme
 = 
	`·th£¬ch
(
Ëmp
->
¬gv0
,
‹m¶©’ame
,0);

3131 
to_ä“
 = 
ÉÇme
;

3133 ifĞ
ÉÇme
==0 ){

3134 
	`årštf
(
¡d”r
,"Can't findhe…arser driveremplate file \"%s\".\n",

3135 
‹m¶©’ame
);

3136 
Ëmp
->
”rÜút
++;

3139 
š
 = 
	`fİ’
(
ÉÇme
,"rb");

3140 ià(
to_ä“
è
	`ä“
(to_free);

3141 ifĞ
š
==0 ){

3142 
	`årštf
(
¡d”r
,"Cª'ˆİ’h‹m¶©f\"%s\".\n",
‹m¶©’ame
);

3143 
Ëmp
->
”rÜút
++;

3146  
š
;

3147 
	}
}

3150 
PRIVATE
 
	$É_lšedœ
(
out
,
lš’o
,
f’ame
)

3151 
FILE
 *
out
;

3152 
lš’o
;

3153 *
f’ame
;

3155 
	`årštf
(
out
,"#lš%d \"",
lš’o
);

3156  *
f’ame
 ){

3157 ifĞ*
f’ame
 =ğ'\\' ) 
	`putc
('\\',
out
);

3158 
	`putc
(*
f’ame
,
out
);

3159 
f’ame
++;

3161 
	`årštf
(
out
,"\"\n");

3162 
	}
}

3165 
PRIVATE
 
	$É_´št
(
out
,
Ëmp
,
¡r
,
lš’o
)

3166 
FILE
 *
out
;

3167 
ËmÚ
 *
Ëmp
;

3168 *
¡r
;

3169 *
lš’o
;

3171 ifĞ
¡r
==0 ) ;

3172  *
¡r
 ){

3173 
	`putc
(*
¡r
,
out
);

3174 ifĞ*
¡r
=='\n' ) (*
lš’o
)++;

3175 
¡r
++;

3177 ifĞ
¡r
[-1]!='\n' ){

3178 
	`putc
('\n',
out
);

3179 (*
lš’o
)++;

3181 ià(!
Ëmp
->
nŞš’osæag
) {

3182 (*
lš’o
)++; 
	`É_lšedœ
(
out
,*lš’o,
Ëmp
->
ouŠame
);

3185 
	}
}

3191 
	$em™_de¡ruùÜ_code
(
out
,
¥
,
Ëmp
,
lš’o
)

3192 
FILE
 *
out
;

3193 
symbŞ
 *
¥
;

3194 
ËmÚ
 *
Ëmp
;

3195 *
lš’o
;

3197 *
ı
 = 0;

3199 ifĞ
¥
->
ty³
==
TERMINAL
 ){

3200 
ı
 = 
Ëmp
->
tok’de¡
;

3201 ifĞ
ı
==0 ) ;

3202 
	`årštf
(
out
,"{\n"); (*
lš’o
)++;

3203 }ifĞ
¥
->
de¡ruùÜ
 ){

3204 
ı
 = 
¥
->
de¡ruùÜ
;

3205 
	`årštf
(
out
,"{\n"); (*
lš’o
)++;

3206 ià(!
Ëmp
->
nŞš’osæag
è{ (*
lš’o
)++; 
	`É_lšedœ
(
out
,
¥
->
de¡Lš’o
,Ëmp->
f’ame
); }

3207 }ifĞ
Ëmp
->
v¬de¡
 ){

3208 
ı
 = 
Ëmp
->
v¬de¡
;

3209 ifĞ
ı
==0 ) ;

3210 
	`årštf
(
out
,"{\n"); (*
lš’o
)++;

3212 
	`as£¹
( 0 );

3214 ; *
ı
; cp++){

3215 ifĞ*
ı
=='$' && cp[1]=='$' ){

3216 
	`årštf
(
out
,"(yypmšÜ->yy%d)",
¥
->
dŠum
);

3217 
ı
++;

3220 ifĞ*
ı
=='\n' ) (*
lš’o
)++;

3221 
	`åutc
(*
ı
,
out
);

3223 
	`årštf
(
out
,"\n"); (*
lš’o
)++;

3224 ià(!
Ëmp
->
nŞš’osæag
) {

3225 (*
lš’o
)++; 
	`É_lšedœ
(
out
,*lš’o,
Ëmp
->
ouŠame
);

3227 
	`årštf
(
out
,"}\n"); (*
lš’o
)++;

3229 
	}
}

3234 
	$has_de¡ruùÜ
(
¥
, 
Ëmp
)

3235 
symbŞ
 *
¥
;

3236 
ËmÚ
 *
Ëmp
;

3238 
»t
;

3239 ifĞ
¥
->
ty³
==
TERMINAL
 ){

3240 
»t
 = 
Ëmp
->
tok’de¡
!=0;

3242 
»t
 = 
Ëmp
->
v¬de¡
!=0 || 
¥
->
de¡ruùÜ
!=0;

3244  
»t
;

3245 
	}
}

3259 
PRIVATE
 *
	$­³nd_¡r
(*
zText
, 
n
, 
p1
, 
p2
){

3260 *
z
 = 0;

3261 
®loûd
 = 0;

3262 
u£d
 = 0;

3263 
c
;

3264 
zIÁ
[40];

3266 ifĞ
zText
==0 ){

3267 
u£d
 = 0;

3268  
z
;

3270 ifĞ
n
<=0 ){

3271 ifĞ
n
<0 ){

3272 
u£d
 +ğ
n
;

3273 
	`as£¹
Ğ
u£d
>=0 );

3275 
n
 = 
	`ËmÚSŒËn
(
zText
);

3277 ifĞ
n
+(
zIÁ
)*2+
u£d
 >ğ(
size_t
)
®loûd
 ){

3278 
®loûd
 = 
n
 + (
zIÁ
)*2 + 
u£d
 + 200;

3279 
z
 = 
	`»®loc
(z, 
®loûd
);

3281 ifĞ
z
==0 )  "";

3282  
n
-- > 0 ){

3283 
c
 = *(
zText
++);

3284 ifĞ
c
=='%' && 
n
>0 && 
zText
[0]=='d' ){

3285 
	`¥rštf
(
zIÁ
, "%d", 
p1
);

3286 
p1
 = 
p2
;

3287 
	`¡rıy
(&
z
[
u£d
], 
zIÁ
);

3288 
u£d
 +ğ
	`ËmÚSŒËn
(&
z
[used]);

3289 
zText
++;

3290 
n
--;

3292 
z
[
u£d
++] = 
c
;

3295 
z
[
u£d
] = 0;

3296  
z
;

3297 
	}
}

3304 
PRIVATE
 
	$Œª¦©e_code
(
ËmÚ
 *
Ëmp
, 
ruË
 *
½
){

3305 *
ı
, *
xp
;

3306 
i
;

3307 
lhsu£d
 = 0;

3308 
u£d
[
MAXRHS
];

3310 
i
=0; i<
½
->
Ähs
; i++è
u£d
[i] = 0;

3311 
lhsu£d
 = 0;

3313 ifĞ
½
->
code
==0 ){

3314 
½
->
code
 = "\n";

3315 
½
->
lše
 =„p->
ruËlše
;

3318 
	`­³nd_¡r
(0,0,0,0);

3319 
ı
=
½
->
code
; *cp; cp++){

3320 ifĞ
	`i§Íha
(*
ı
è&& (ı==
½
->
code
 || (!
	`i§Êum
(cp[-1]) && cp[-1]!='_')) ){

3321 
§ved
;

3322 
xp
ğ&
ı
[1]; 
	`i§Êum
(*xp) || *xp=='_'; xp++);

3323 
§ved
 = *
xp
;

3324 *
xp
 = 0;

3325 ifĞ
½
->
lh§lŸs
 && 
	`¡rcmp
(
ı
,rp->lhsalias)==0 ){

3326 
	`­³nd_¡r
("yygÙomšÜ.yy%d",0,
½
->
lhs
->
dŠum
,0);

3327 
ı
 = 
xp
;

3328 
lhsu£d
 = 1;

3330 
i
=0; i<
½
->
Ähs
; i++){

3331 ifĞ
½
->
rh§lŸs
[
i
] && 
	`¡rcmp
(
ı
,rp->rhsalias[i])==0 ){

3332 ifĞ
ı
!=
½
->
code
 && cp[-1]=='@' ){

3335 
	`­³nd_¡r
("yym¥[%d].majÜ",-1,
i
-
½
->
Ähs
+1,0);

3337 
symbŞ
 *
¥
 = 
½
->
rhs
[
i
];

3338 
dŠum
;

3339 ifĞ
¥
->
ty³
==
MULTITERMINAL
 ){

3340 
dŠum
 = 
¥
->
subsym
[0]->dtnum;

3342 
dŠum
 = 
¥
->dtnum;

3344 
	`­³nd_¡r
("yym¥[%d].mšÜ.yy%d",0,
i
-
½
->
Ähs
+1, 
dŠum
);

3346 
ı
 = 
xp
;

3347 
u£d
[
i
] = 1;

3352 *
xp
 = 
§ved
;

3354 
	`­³nd_¡r
(
ı
, 1, 0, 0);

3358 ifĞ
½
->
lh§lŸs
 && !
lhsu£d
 ){

3359 
	`E¼ÜMsg
(
Ëmp
->
f’ame
,
½
->
ruËlše
,

3361 
½
->
lh§lŸs
,½->
lhs
->
Çme
,rp->lhsalias);

3362 
Ëmp
->
”rÜút
++;

3367 
i
=0; i<
½
->
Ähs
; i++){

3368 ifĞ
½
->
rh§lŸs
[
i
] && !
u£d
[i] ){

3369 
	`E¼ÜMsg
(
Ëmp
->
f’ame
,
½
->
ruËlše
,

3371 
½
->
rh§lŸs
[
i
],½->
rhs
[i]->
Çme
,rp->rhsalias[i]);

3372 
Ëmp
->
”rÜút
++;

3373 }ifĞ
½
->
rh§lŸs
[
i
]==0 ){

3374 ifĞ
	`has_de¡ruùÜ
(
½
->
rhs
[
i
],
Ëmp
) ){

3375 
	`­³nd_¡r
(" yy_destructor(yypParser,%d,&yymsp[%d].minor);\n", 0,

3376 
½
->
rhs
[
i
]->
šdex
,i-½->
Ähs
+1);

3382 ifĞ
½
->
code
 ){

3383 
ı
 = 
	`­³nd_¡r
(0,0,0,0);

3384 
½
->
code
 = 
	`SŒ§ã
(
ı
?cp:"");

3386 
	}
}

3392 
PRIVATE
 
	$em™_code
(
out
,
½
,
Ëmp
,
lš’o
)

3393 
FILE
 *
out
;

3394 
ruË
 *
½
;

3395 
ËmÚ
 *
Ëmp
;

3396 *
lš’o
;

3398 *
ı
;

3401 ifĞ
½
->
code
 ){

3402 ià(!
Ëmp
->
nŞš’osæag
è{ (*
lš’o
)++; 
	`É_lšedœ
(
out
,
½
->
lše
,Ëmp->
f’ame
); }

3403 
	`årštf
(
out
,"{%s",
½
->
code
);

3404 
ı
=
½
->
code
; *cp; cp++){

3405 ifĞ*
ı
=='\n' ) (*
lš’o
)++;

3407 
	`årštf
(
out
,"}\n"); (*
lš’o
)++;

3408 ià(!
Ëmp
->
nŞš’osæag
è{ (*
lš’o
)++; 
	`É_lšedœ
(
out
,*lš’o,Ëmp->
ouŠame
); }

3412 
	}
}

3421 
	$´št_¡ack_uniÚ
(
out
,
Ëmp
,
¶š’o
,
mhæag
)

3422 
FILE
 *
out
;

3423 
ËmÚ
 *
Ëmp
;

3424 *
¶š’o
;

3425 
mhæag
;

3427 
lš’o
 = *
¶š’o
;

3428 **
ty³s
;

3429 
¬¿ysize
;

3430 
maxd’gth
;

3431 *
¡ddt
;

3432 
i
,
j
;

3433 
hash
;

3434 *
Çme
;

3437 
¬¿ysize
 = 
Ëmp
->
nsymbŞ
 * 2;

3438 
ty³s
 = (**)
	`ÿÎoc
Ğ
¬¿ysize
, (*) );

3439 
i
=0; i<
¬¿ysize
; i++è
ty³s
[i] = 0;

3440 
maxd’gth
 = 0;

3441 ifĞ
Ëmp
->
v¬ty³
 ){

3442 
maxd’gth
 = 
	`ËmÚSŒËn
(
Ëmp
->
v¬ty³
);

3444 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

3445 
Ën
;

3446 
symbŞ
 *
¥
 = 
Ëmp
->
symbŞs
[
i
];

3447 ifĞ
¥
->
d©©y³
==0 ) ;

3448 
Ën
 = 
	`ËmÚSŒËn
(
¥
->
d©©y³
);

3449 ifĞ
Ën
>
maxd’gth
 ) maxdtlength =†en;

3451 
¡ddt
 = (*)
	`m®loc
Ğ
maxd’gth
*2 + 1 );

3452 ifĞ
ty³s
==0 || 
¡ddt
==0 ){

3453 
	`årštf
(
¡d”r
,"Out of memory.\n");

3454 
	`ex™
(1);

3463 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

3464 
symbŞ
 *
¥
 = 
Ëmp
->
symbŞs
[
i
];

3465 *
ı
;

3466 ifĞ
¥
==
Ëmp
->
”rsym
 ){

3467 
¥
->
dŠum
 = 
¬¿ysize
+1;

3470 ifĞ
¥
->
ty³
!=
NONTERMINAL
 || (¥->
d©©y³
==0 && 
Ëmp
->
v¬ty³
==0) ){

3471 
¥
->
dŠum
 = 0;

3474 
ı
 = 
¥
->
d©©y³
;

3475 ifĞ
ı
==0 ) c°ğ
Ëmp
->
v¬ty³
;

3476 
j
 = 0;

3477  
	`is¥aû
(*
ı
) ) cp++;

3478  *
ı
 ) 
¡ddt
[
j
++] = *cp++;

3479  
j
>0 && 
	`is¥aû
(
¡ddt
[j-1]) ) j--;

3480 
¡ddt
[
j
] = 0;

3481 ifĞ
Ëmp
->
tok’ty³
 && 
	`¡rcmp
(
¡ddt
,†emp->tokentype)==0 ){

3482 
¥
->
dŠum
 = 0;

3485 
hash
 = 0;

3486 
j
=0; 
¡ddt
[j]; j++){

3487 
hash
 = hash*53 + 
¡ddt
[
j
];

3489 
hash
 = (hash & 0x7fffffff)%
¬¿ysize
;

3490  
ty³s
[
hash
] ){

3491 ifĞ
	`¡rcmp
(
ty³s
[
hash
],
¡ddt
)==0 ){

3492 
¥
->
dŠum
 = 
hash
 + 1;

3495 
hash
++;

3496 ifĞ
hash
>=
¬¿ysize
 ) hash = 0;

3498 ifĞ
ty³s
[
hash
]==0 ){

3499 
¥
->
dŠum
 = 
hash
 + 1;

3500 
ty³s
[
hash
] = (*)
	`m®loc
Ğ
	`ËmÚSŒËn
(
¡ddt
)+1 );

3501 ifĞ
ty³s
[
hash
]==0 ){

3502 
	`årštf
(
¡d”r
,"Out of memory.\n");

3503 
	`ex™
(1);

3505 
	`¡rıy
(
ty³s
[
hash
],
¡ddt
);

3510 
Çme
 = 
Ëmp
->name ?†emp->name : "Parse";

3511 
lš’o
 = *
¶š’o
;

3512 ifĞ
mhæag
 ){ 
	`årštf
(
out
,"#iàINTERFACE\n"); 
lš’o
++; }

3513 
	`årštf
(
out
,"#defš%sTOKENTYPE %s\n",
Çme
,

3514 
Ëmp
->
tok’ty³
?Ëmp->tok’ty³:"void*"); 
lš’o
++;

3515 ifĞ
mhæag
 ){ 
	`årštf
(
out
,"#’dif\n"); 
lš’o
++; }

3516 
	`årštf
(
out
,"ty³deàuniÚ {\n"); 
lš’o
++;

3517 
	`årštf
(
out
," iÁ yyš™;\n"); 
lš’o
++;

3518 
	`årštf
(
out
," %sTOKENTYPE yy0;\n",
Çme
); 
lš’o
++;

3519 
i
=0; i<
¬¿ysize
; i++){

3520 ifĞ
ty³s
[
i
]==0 ) ;

3521 
	`årštf
(
out
," % yy%d;\n",
ty³s
[
i
],i+1); 
lš’o
++;

3522 
	`ä“
(
ty³s
[
i
]);

3524 ifĞ
Ëmp
->
”rsym
->
u£CÁ
 ){

3525 
	`årštf
(
out
," iÁ yy%d;\n",
Ëmp
->
”rsym
->
dŠum
); 
lš’o
++;

3527 
	`ä“
(
¡ddt
);

3528 
	`ä“
(
ty³s
);

3529 
	`årštf
(
out
,"} YYMINORTYPE;\n"); 
lš’o
++;

3530 *
¶š’o
 = 
lš’o
;

3531 
	}
}

3537 cÚ¡ *
	$mšimum_size_ty³
(
lwr
, 
u´
){

3538 ifĞ
lwr
>=0 ){

3539 ifĞ
u´
<=255 ){

3541 }ifĞ
u´
<65535 ){

3546 }ifĞ
lwr
>=-127 && 
u´
<=127 ){

3548 }ifĞ
lwr
>=-32767 && 
u´
<32767 ){

3553 
	}
}

3561 
	sax£t
 {

3562 
¡©e
 *
	m¡p
;

3563 
	misTkn
;

3564 
	mnAùiÚ
;

3570 
	$ax£t_com·»
(cÚ¡ *
a
, cÚ¡ *
b
){

3571 
ax£t
 *
p1
 = (ax£t*)
a
;

3572 
ax£t
 *
p2
 = (ax£t*)
b
;

3573  
p2
->
nAùiÚ
 - 
p1
->nAction;

3574 
	}
}

3579 
	$wr™eRuËText
(
FILE
 *
out
, 
ruË
 *
½
){

3580 
j
;

3581 
	`årštf
(
out
,"% ::=", 
½
->
lhs
->
Çme
);

3582 
j
=0; j<
½
->
Ähs
; j++){

3583 
symbŞ
 *
¥
 = 
½
->
rhs
[
j
];

3584 
	`årštf
(
out
," %s", 
¥
->
Çme
);

3585 ifĞ
¥
->
ty³
==
MULTITERMINAL
 ){

3586 
k
;

3587 
k
=1; k<
¥
->
nsubsym
; k++){

3588 
	`årštf
(
out
,"|%s",
¥
->
subsym
[
k
]->
Çme
);

3592 
	}
}

3596 
	$R•ÜtTabË
(
Ëmp
, 
mhæag
)

3597 
ËmÚ
 *
Ëmp
;

3598 
mhæag
;

3600 
FILE
 *
out
, *
š
;

3601 
lše
[
LINESIZE
];

3602 
lš’o
;

3603 
¡©e
 *
¡p
;

3604 
aùiÚ
 *
­
;

3605 
ruË
 *
½
;

3606 
aùb
 *
pAùb
;

3607 
i
, 
j
, 
n
;

3608 *
Çme
;

3609 
mnTknOf¡
, 
mxTknOf¡
;

3610 
mnNtOf¡
, 
mxNtOf¡
;

3611 
ax£t
 *
ax
;

3613 
š
 = 
	`É_İ’
(
Ëmp
);

3614 ifĞ
š
==0 ) ;

3615 ifĞ
ouut_f’ame
!=0 ){

3616 *
tmp
 = 
Ëmp
->
f’ame
;

3617 *
ext
 = 
	`¡¼chr
(
ouut_f’ame
, '.');

3618 ifĞ
ext
==0 )ƒxt = ".c";

3619 
Ëmp
->
f’ame
 = 
ouut_f’ame
;

3620 
out
 = 
	`fe_İ’
(
Ëmp
,
ext
,"wb");

3621 
Ëmp
->
f’ame
 = 
tmp
;

3623 
out
 = 
	`fe_İ’
(
Ëmp
,".c","wb");

3625 ifĞ
out
==0 ){

3626 
	`fşo£
(
š
);

3629 
lš’o
 = 1;

3630 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3633 
	`É_´št
(
out
,
Ëmp
,Ëmp->
šşude
,&
lš’o
);

3634 ifĞ
mhæag
 ){

3635 *
Çme
 = 
	`fe_mak’ame
(
Ëmp
, ".h");

3636 
	`årštf
(
out
,"#šşud\"%s\"\n", 
Çme
); 
lš’o
++;

3637 
	`ä“
(
Çme
);

3639 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3642 ifĞ
mhæag
 ){

3643 *
´efix
;

3644 
	`årštf
(
out
,"#iàINTERFACE\n"); 
lš’o
++;

3645 ifĞ
Ëmp
->
tok’´efix
 ) 
´efix
 =†emp->tokenprefix;

3646 
´efix
 = "";

3647 
i
=1; i<
Ëmp
->
Á”mš®
; i++){

3648 
	`årštf
(
out
,"#defš%s%-30 %2d\n",
´efix
,
Ëmp
->
symbŞs
[
i
]->
Çme
,i);

3649 
lš’o
++;

3651 
	`årštf
(
out
,"#’dif\n"); 
lš’o
++;

3653 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3656 
	`årštf
(
out
,"#define YYCODETYPE %s\n",

3657 
	`mšimum_size_ty³
(0, 
Ëmp
->
nsymbŞ
+1)); 
lš’o
++;

3658 
	`årštf
(
out
,"#defšYYNOCODE %d\n",
Ëmp
->
nsymbŞ
+1); 
lš’o
++;

3659 
	`årštf
(
out
,"#define YYACTIONTYPE %s\n",

3660 
	`mšimum_size_ty³
(0, 
Ëmp
->
n¡©e
+Ëmp->
ÄuË
+5)); 
lš’o
++;

3661 ifĞ
Ëmp
->
wdÿrd
 ){

3662 
	`årštf
(
out
,"#define YYWILDCARD %d\n",

3663 
Ëmp
->
wdÿrd
->
šdex
); 
lš’o
++;

3665 
	`´št_¡ack_uniÚ
(
out
,
Ëmp
,&
lš’o
,
mhæag
);

3666 
	`årštf
(
out
, "#iâdeàYYSTACKDEPTH\n"); 
lš’o
++;

3667 ifĞ
Ëmp
->
¡acksize
 ){

3668 
	`årštf
(
out
,"#defšYYSTACKDEPTH %s\n",
Ëmp
->
¡acksize
); 
lš’o
++;

3670 
	`årštf
(
out
,"#defšYYSTACKDEPTH 100\n"); 
lš’o
++;

3672 
	`årštf
(
out
, "#’dif\n"); 
lš’o
++;

3673 ifĞ
mhæag
 ){

3674 
	`årštf
(
out
,"#iàINTERFACE\n"); 
lš’o
++;

3676 
Çme
 = 
Ëmp
->name ?†emp->name : "Parse";

3677 ifĞ
Ëmp
->
¬g
 &&†emp->arg[0] ){

3678 
i
;

3679 
i
 = 
	`ËmÚSŒËn
(
Ëmp
->
¬g
);

3680  
i
>=1 && 
	`is¥aû
(
Ëmp
->
¬g
[i-1]) ) i--;

3681  
i
>=1 && (
	`i§Êum
(
Ëmp
->
¬g
[i-1]) ||†emp->arg[i-1]=='_') ) i--;

3682 
	`årštf
(
out
,"#defš%sARG_SDECL %s;\n",
Çme
,
Ëmp
->
¬g
); 
lš’o
++;

3683 
	`årštf
(
out
,"#defš%sARG_PDECL ,%s\n",
Çme
,
Ëmp
->
¬g
); 
lš’o
++;

3684 
	`årštf
(
out
,"#define %sARG_FETCH %s = yypParser->%s\n",

3685 
Çme
,
Ëmp
->
¬g
,&Ëmp->¬g[
i
]); 
lš’o
++;

3686 
	`årštf
(
out
,"#define %sARG_STORE yypParser->%s = %s\n",

3687 
Çme
,&
Ëmp
->
¬g
[
i
],&Ëmp->¬g[i]); 
lš’o
++;

3689 
	`årštf
(
out
,"#defš%sARG_SDECL\n",
Çme
); 
lš’o
++;

3690 
	`årštf
(
out
,"#defš%sARG_PDECL\n",
Çme
); 
lš’o
++;

3691 
	`årštf
(
out
,"#defš%sARG_FETCH\n",
Çme
); 
lš’o
++;

3692 
	`årštf
(
out
,"#defš%sARG_STORE\n",
Çme
); 
lš’o
++;

3694 ifĞ
mhæag
 ){

3695 
	`årštf
(
out
,"#’dif\n"); 
lš’o
++;

3697 
	`årštf
(
out
,"#defšYYNSTATE %d\n",
Ëmp
->
n¡©e
); 
lš’o
++;

3698 
	`årštf
(
out
,"#defšYYNRULE %d\n",
Ëmp
->
ÄuË
); 
lš’o
++;

3699 ifĞ
Ëmp
->
”rsym
->
u£CÁ
 ){

3700 
	`årštf
(
out
,"#defšYYERRORSYMBOL %d\n",
Ëmp
->
”rsym
->
šdex
); 
lš’o
++;

3701 
	`årštf
(
out
,"#defšYYERRSYMDT yy%d\n",
Ëmp
->
”rsym
->
dŠum
); 
lš’o
++;

3703 ifĞ
Ëmp
->
has_çÎback
 ){

3704 
	`årštf
(
out
,"#defšYYFALLBACK 1\n"); 
lš’o
++;

3706 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3721 
ax
 = 
	`ÿÎoc
(
Ëmp
->
n¡©e
*2, (ax[0]));

3722 ifĞ
ax
==0 ){

3723 
	`årštf
(
¡d”r
,"malloc failed\n");

3724 
	`ex™
(1);

3726 
i
=0; i<
Ëmp
->
n¡©e
; i++){

3727 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

3728 
ax
[
i
*2].
¡p
 = stp;

3729 
ax
[
i
*2].
isTkn
 = 1;

3730 
ax
[
i
*2].
nAùiÚ
 = 
¡p
->
nTknAù
;

3731 
ax
[
i
*2+1].
¡p
 = stp;

3732 
ax
[
i
*2+1].
isTkn
 = 0;

3733 
ax
[
i
*2+1].
nAùiÚ
 = 
¡p
->
nNtAù
;

3735 
mxTknOf¡
 = 
mnTknOf¡
 = 0;

3736 
mxNtOf¡
 = 
mnNtOf¡
 = 0;

3742 
	`qsÜt
(
ax
, 
Ëmp
->
n¡©e
*2, ×x[0]), 
ax£t_com·»
);

3743 
pAùb
 = 
	`aùb_®loc
();

3744 
i
=0; i<
Ëmp
->
n¡©e
*2 && 
ax
[i].
nAùiÚ
>0; i++){

3745 
¡p
 = 
ax
[
i
].stp;

3746 ifĞ
ax
[
i
].
isTkn
 ){

3747 
­
=
¡p
->­;‡p;‡p÷p->
Ãxt
){

3748 
aùiÚ
;

3749 ifĞ
­
->
¥
->
šdex
>=
Ëmp
->
Á”mš®
 ) ;

3750 
aùiÚ
 = 
	`compu‹_aùiÚ
(
Ëmp
, 
­
);

3751 ifĞ
aùiÚ
<0 ) ;

3752 
	`aùb_aùiÚ
(
pAùb
, 
­
->
¥
->
šdex
, 
aùiÚ
);

3754 
¡p
->
iTknOf¡
 = 
	`aùb_š£¹
(
pAùb
);

3755 ifĞ
¡p
->
iTknOf¡
<
mnTknOf¡
 ) mnTknOfst = stp->iTknOfst;

3756 ifĞ
¡p
->
iTknOf¡
>
mxTknOf¡
 ) mxTknOfst = stp->iTknOfst;

3758 
­
=
¡p
->­;‡p;‡p÷p->
Ãxt
){

3759 
aùiÚ
;

3760 ifĞ
­
->
¥
->
šdex
<
Ëmp
->
Á”mš®
 ) ;

3761 ifĞ
­
->
¥
->
šdex
==
Ëmp
->
nsymbŞ
 ) ;

3762 
aùiÚ
 = 
	`compu‹_aùiÚ
(
Ëmp
, 
­
);

3763 ifĞ
aùiÚ
<0 ) ;

3764 
	`aùb_aùiÚ
(
pAùb
, 
­
->
¥
->
šdex
, 
aùiÚ
);

3766 
¡p
->
iNtOf¡
 = 
	`aùb_š£¹
(
pAùb
);

3767 ifĞ
¡p
->
iNtOf¡
<
mnNtOf¡
 ) mnNtOfst = stp->iNtOfst;

3768 ifĞ
¡p
->
iNtOf¡
>
mxNtOf¡
 ) mxNtOfst = stp->iNtOfst;

3771 
	`ä“
(
ax
);

3774 
	`årštf
(
out
,"¡©iøcÚ¡ YYACTIONTYPE yy_aùiÚ[] = {\n"); 
lš’o
++;

3775 
n
 = 
	`aùb_size
(
pAùb
);

3776 
i
=
j
=0; i<
n
; i++){

3777 
aùiÚ
 = 
	`aùb_yyaùiÚ
(
pAùb
, 
i
);

3778 ifĞ
aùiÚ
<0 )‡ùiÚ = 
Ëmp
->
n¡©e
 +†emp->
ÄuË
 + 2;

3779 ifĞ
j
==0 ) 
	`årštf
(
out
," /* %5d */ ", 
i
);

3780 
	`årštf
(
out
, " %4d,", 
aùiÚ
);

3781 ifĞ
j
==9 || 
i
==
n
-1 ){

3782 
	`årštf
(
out
, "\n"); 
lš’o
++;

3783 
j
 = 0;

3785 
j
++;

3788 
	`årštf
(
out
, "};\n"); 
lš’o
++;

3791 
	`årštf
(
out
,"¡©iøcÚ¡ YYCODETYPE yy_lookah—d[] = {\n"); 
lš’o
++;

3792 
i
=
j
=0; i<
n
; i++){

3793 
Ï
 = 
	`aùb_yylookah—d
(
pAùb
, 
i
);

3794 ifĞ
Ï
<0 )†¨ğ
Ëmp
->
nsymbŞ
;

3795 ifĞ
j
==0 ) 
	`årštf
(
out
," /* %5d */ ", 
i
);

3796 
	`årštf
(
out
, " %4d,", 
Ï
);

3797 ifĞ
j
==9 || 
i
==
n
-1 ){

3798 
	`årštf
(
out
, "\n"); 
lš’o
++;

3799 
j
 = 0;

3801 
j
++;

3804 
	`årštf
(
out
, "};\n"); 
lš’o
++;

3807 
	`årštf
(
out
, "#defšYY_SHIFT_USE_DFLT (%d)\n", 
mnTknOf¡
-1); 
lš’o
++;

3808 
n
 = 
Ëmp
->
n¡©e
;

3809  
n
>0 && 
Ëmp
->
sÜ‹d
[n-1]->
iTknOf¡
==
NO_OFFSET
 )‚--;

3810 
	`årštf
(
out
, "#defšYY_SHIFT_MAX %d\n", 
n
-1); 
lš’o
++;

3811 
	`årštf
(
out
, "static const %s yy_shift_ofst[] = {\n",

3812 
	`mšimum_size_ty³
(
mnTknOf¡
-1, 
mxTknOf¡
)); 
lš’o
++;

3813 
i
=
j
=0; i<
n
; i++){

3814 
of¡
;

3815 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

3816 
of¡
 = 
¡p
->
iTknOf¡
;

3817 ifĞ
of¡
==
NO_OFFSET
 ) of¡ = 
mnTknOf¡
 - 1;

3818 ifĞ
j
==0 ) 
	`årštf
(
out
," /* %5d */ ", 
i
);

3819 
	`årštf
(
out
, " %4d,", 
of¡
);

3820 ifĞ
j
==9 || 
i
==
n
-1 ){

3821 
	`årštf
(
out
, "\n"); 
lš’o
++;

3822 
j
 = 0;

3824 
j
++;

3827 
	`årštf
(
out
, "};\n"); 
lš’o
++;

3830 
	`årštf
(
out
, "#defšYY_REDUCE_USE_DFLT (%d)\n", 
mnNtOf¡
-1); 
lš’o
++;

3831 
n
 = 
Ëmp
->
n¡©e
;

3832  
n
>0 && 
Ëmp
->
sÜ‹d
[n-1]->
iNtOf¡
==
NO_OFFSET
 )‚--;

3833 
	`årštf
(
out
, "#defšYY_REDUCE_MAX %d\n", 
n
-1); 
lš’o
++;

3834 
	`årštf
(
out
, "static const %s yy_reduce_ofst[] = {\n",

3835 
	`mšimum_size_ty³
(
mnNtOf¡
-1, 
mxNtOf¡
)); 
lš’o
++;

3836 
i
=
j
=0; i<
n
; i++){

3837 
of¡
;

3838 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

3839 
of¡
 = 
¡p
->
iNtOf¡
;

3840 ifĞ
of¡
==
NO_OFFSET
 ) of¡ = 
mnNtOf¡
 - 1;

3841 ifĞ
j
==0 ) 
	`årštf
(
out
," /* %5d */ ", 
i
);

3842 
	`årštf
(
out
, " %4d,", 
of¡
);

3843 ifĞ
j
==9 || 
i
==
n
-1 ){

3844 
	`årštf
(
out
, "\n"); 
lš’o
++;

3845 
j
 = 0;

3847 
j
++;

3850 
	`årštf
(
out
, "};\n"); 
lš’o
++;

3853 
	`årštf
(
out
, "¡©iøcÚ¡ YYACTIONTYPE yy_deçuÉ[] = {\n"); 
lš’o
++;

3854 
n
 = 
Ëmp
->
n¡©e
;

3855 
i
=
j
=0; i<
n
; i++){

3856 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

3857 ifĞ
j
==0 ) 
	`årštf
(
out
," /* %5d */ ", 
i
);

3858 
	`årštf
(
out
, " %4d,", 
¡p
->
iDæt
);

3859 ifĞ
j
==9 || 
i
==
n
-1 ){

3860 
	`årštf
(
out
, "\n"); 
lš’o
++;

3861 
j
 = 0;

3863 
j
++;

3866 
	`årštf
(
out
, "};\n"); 
lš’o
++;

3867 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3871 ifĞ
Ëmp
->
has_çÎback
 ){

3872 
mx
 = 
Ëmp
->
Á”mš®
 - 1;

3873  
mx
>0 && 
Ëmp
->
symbŞs
[mx]->
çÎback
==0 ){ mx--; }

3874 
i
=0; i<=
mx
; i++){

3875 
symbŞ
 *
p
 = 
Ëmp
->
symbŞs
[
i
];

3876 ifĞ
p
->
çÎback
==0 ){

3877 
	`årštf
(
out
, " 0, /* %10 =>‚Ùhšg */\n", 
p
->
Çme
);

3879 
	`årštf
(
out
, " %3d, /* %10 => % */\n", 
p
->
çÎback
->
šdex
,

3880 
p
->
Çme
,…->
çÎback
->name);

3882 
lš’o
++;

3885 
	`É_xãr
(
Ëmp
->
Çme
, 
š
, 
out
, &
lš’o
);

3889 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

3890 
	`¥rštf
(
lše
,"\"%s\",",
Ëmp
->
symbŞs
[
i
]->
Çme
);

3891 
	`årštf
(
out
," %-15s",
lše
);

3892 ifĞ(
i
&3)==3 ){ 
	`årštf
(
out
,"\n"); 
lš’o
++; }

3894 ifĞ(
i
&3)!=0 ){ 
	`årštf
(
out
,"\n"); 
lš’o
++; }

3895 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3901 
i
=0, 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
, i++){

3902 
	`as£¹
Ğ
½
->
šdex
==
i
 );

3903 
	`årštf
(
out
," /* %3d */ \"", 
i
);

3904 
	`wr™eRuËText
(
out
, 
½
);

3905 
	`årštf
(
out
,"\",\n"); 
lš’o
++;

3907 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3913 ifĞ
Ëmp
->
tok’de¡
 ){

3914 
Úû
 = 1;

3915 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

3916 
symbŞ
 *
¥
 = 
Ëmp
->
symbŞs
[
i
];

3917 ifĞ
¥
==0 || sp->
ty³
!=
TERMINAL
 ) ;

3918 ifĞ
Úû
 ){

3919 
	`årštf
(
out
, " /* TERMINAL De¡ruùÜ */\n"); 
lš’o
++;

3920 
Úû
 = 0;

3922 
	`årštf
(
out
," ca£ %d: /* % */\n", 
¥
->
šdex
, sp->
Çme
); 
lš’o
++;

3924 
i
=0; i<
Ëmp
->
nsymbŞ
 &&†emp->
symbŞs
[i]->
ty³
!=
TERMINAL
; i++);

3925 ifĞ
i
<
Ëmp
->
nsymbŞ
 ){

3926 
	`em™_de¡ruùÜ_code
(
out
,
Ëmp
->
symbŞs
[
i
],Ëmp,&
lš’o
);

3927 
	`årštf
(
out
," b»ak;\n"); 
lš’o
++;

3930 ifĞ
Ëmp
->
v¬de¡
 ){

3931 
symbŞ
 *
dæt_¥
 = 0;

3932 
Úû
 = 1;

3933 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

3934 
symbŞ
 *
¥
 = 
Ëmp
->
symbŞs
[
i
];

3935 ifĞ
¥
==0 || sp->
ty³
==
TERMINAL
 ||

3936 
¥
->
šdex
<=0 || sp->
de¡ruùÜ
!=0 ) ;

3937 ifĞ
Úû
 ){

3938 
	`årštf
(
out
, " /* DeçuÉ NON-TERMINAL De¡ruùÜ */\n"); 
lš’o
++;

3939 
Úû
 = 0;

3941 
	`årštf
(
out
," ca£ %d: /* % */\n", 
¥
->
šdex
, sp->
Çme
); 
lš’o
++;

3942 
dæt_¥
 = 
¥
;

3944 ifĞ
dæt_¥
!=0 ){

3945 
	`em™_de¡ruùÜ_code
(
out
,
dæt_¥
,
Ëmp
,&
lš’o
);

3947 
	`årštf
(
out
," b»ak;\n"); 
lš’o
++;

3949 
i
=0; i<
Ëmp
->
nsymbŞ
; i++){

3950 
symbŞ
 *
¥
 = 
Ëmp
->
symbŞs
[
i
];

3951 ifĞ
¥
==0 || sp->
ty³
==
TERMINAL
 || sp->
de¡ruùÜ
==0 ) ;

3952 
	`årštf
(
out
," ca£ %d: /* % */\n", 
¥
->
šdex
, sp->
Çme
); 
lš’o
++;

3955 
j
=
i
+1; j<
Ëmp
->
nsymbŞ
; j++){

3956 
symbŞ
 *
¥2
 = 
Ëmp
->
symbŞs
[
j
];

3957 ifĞ
¥2
 && sp2->
ty³
!=
TERMINAL
 && sp2->
de¡ruùÜ


3958 && 
¥2
->
dŠum
==
¥
->dtnum

3959 && 
	`¡rcmp
(
¥
->
de¡ruùÜ
,
¥2
->destructor)==0 ){

3960 
	`årštf
(
out
," case %d: /* %s */\n",

3961 
¥2
->
šdex
, sp2->
Çme
); 
lš’o
++;

3962 
¥2
->
de¡ruùÜ
 = 0;

3966 
	`em™_de¡ruùÜ_code
(
out
,
Ëmp
->
symbŞs
[
i
],Ëmp,&
lš’o
);

3967 
	`årštf
(
out
," b»ak;\n"); 
lš’o
++;

3969 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3972 
	`É_´št
(
out
,
Ëmp
,Ëmp->
ov”æow
,&
lš’o
);

3973 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3980 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

3981 
	`årštf
(
out
," { %d, %d },\n",
½
->
lhs
->
šdex
,½->
Ähs
); 
lš’o
++;

3983 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

3986 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

3987 
	`Œª¦©e_code
(
Ëmp
, 
½
);

3990 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

3991 
ruË
 *
½2
;

3992 ifĞ
½
->
code
==0 ) ;

3993 ifĞ
½
->
code
[0]=='\n' &&„p->code[1]==0 ) ;

3994 
	`årštf
(
out
," ca£ %d: /* ", 
½
->
šdex
);

3995 
	`wr™eRuËText
(
out
, 
½
);

3996 
	`årštf
(
out
, " */\n"); 
lš’o
++;

3997 
½2
=
½
->
Ãxt
;„p2;„p2=rp2->next){

3998 ifĞ
½2
->
code
==
½
->code ){

3999 
	`årštf
(
out
," ca£ %d: /* ", 
½2
->
šdex
);

4000 
	`wr™eRuËText
(
out
, 
½2
);

4001 
	`årštf
(
out
," */ yy‹¡ÿ£(yyruËno==%d);\n", 
½2
->
šdex
); 
lš’o
++;

4002 
½2
->
code
 = 0;

4005 
	`em™_code
(
out
,
½
,
Ëmp
,&
lš’o
);

4006 
	`årštf
(
out
," b»ak;\n"); 
lš’o
++;

4007 
½
->
code
 = 0;

4011 
	`årštf
(
out
," deçuÉ:\n"); 
lš’o
++;

4012 
½
=
Ëmp
->
ruË
;„p;„pôp->
Ãxt
){

4013 ifĞ
½
->
code
==0 ) ;

4014 
	`as£¹
Ğ
½
->
code
[0]=='\n' &&„p->code[1]==0 );

4015 
	`årštf
(
out
," /* (%dè", 
½
->
šdex
);

4016 
	`wr™eRuËText
(
out
, 
½
);

4017 
	`årštf
(
out
, " */ yy‹¡ÿ£(yyruËno==%d);\n", 
½
->
šdex
); 
lš’o
++;

4019 
	`årštf
(
out
," b»ak;\n"); 
lš’o
++;

4020 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

4023 
	`É_´št
(
out
,
Ëmp
,Ëmp->
çu»
,&
lš’o
);

4024 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

4027 
	`É_´št
(
out
,
Ëmp
,Ëmp->
”rÜ
,&
lš’o
);

4028 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

4031 
	`É_´št
(
out
,
Ëmp
,Ëmp->
acû±
,&
lš’o
);

4032 
	`É_xãr
(
Ëmp
->
Çme
,
š
,
out
,&
lš’o
);

4035 
	`É_´št
(
out
,
Ëmp
,Ëmp->
exŒacode
,&
lš’o
);

4037 
	`fşo£
(
š
);

4038 
	`fşo£
(
out
);

4040 
	}
}

4043 
	$R•ÜtH—d”
(
Ëmp
)

4044 
ËmÚ
 *
Ëmp
;

4046 
FILE
 *
out
, *
š
;

4047 *
´efix
;

4048 
lše
[
LINESIZE
];

4049 
·‰”n
[
LINESIZE
];

4050 
i
;

4052 ifĞ
Ëmp
->
tok’´efix
 ) 
´efix
 =†emp->tokenprefix;

4053 
´efix
 = "";

4054 ifĞ
ouut_h—d”_f’ame
!=0 ){

4055 *
tmp
 = 
Ëmp
->
f’ame
;

4056 *
ext
 = 
	`¡¼chr
(
ouut_h—d”_f’ame
, '.');

4057 ifĞ
ext
==0 )ƒxt = ".h";

4058 
Ëmp
->
f’ame
 = 
ouut_h—d”_f’ame
;

4059 
š
 = 
	`fe_İ’
(
Ëmp
,
ext
,"rb");

4060 
Ëmp
->
f’ame
 = 
tmp
;

4062 
š
 = 
	`fe_İ’
(
Ëmp
,".h","rb");

4064 ifĞ
š
 ){

4065 
i
=1; i<
Ëmp
->
Á”mš®
 && 
	`fg‘s
(
lše
,
LINESIZE
,
š
); i++){

4066 
	`¥rštf
(
·‰”n
,"#defš%s%-30 %2d\n",
´efix
,
Ëmp
->
symbŞs
[
i
]->
Çme
,i);

4067 ifĞ
	`¡rcmp
(
lše
,
·‰”n
) ) ;

4069 
	`fşo£
(
š
);

4070 ifĞ
i
==
Ëmp
->
Á”mš®
 ){

4075 ifĞ
ouut_h—d”_f’ame
!=0 ){

4076 *
tmp
 = 
Ëmp
->
f’ame
;

4077 *
ext
 = 
	`¡¼chr
(
ouut_h—d”_f’ame
, '.');

4078 ifĞ
ext
==0 )ƒxt = ".h";

4079 
Ëmp
->
f’ame
 = 
ouut_h—d”_f’ame
;

4080 
out
 = 
	`fe_İ’
(
Ëmp
,
ext
,"wb");

4081 
Ëmp
->
f’ame
 = 
tmp
;

4083 
out
 = 
	`fe_İ’
(
Ëmp
,".h","wb");

4085 ifĞ
out
 ){

4086 
i
=1; i<
Ëmp
->
Á”mš®
; i++){

4087 
	`årštf
(
out
,"#defš%s%-30 %2d\n",
´efix
,
Ëmp
->
symbŞs
[
i
]->
Çme
,i);

4089 
	`fşo£
(
out
);

4092 
	}
}

4101 
	$Com´essTabËs
(
Ëmp
)

4102 
ËmÚ
 *
Ëmp
;

4104 
¡©e
 *
¡p
;

4105 
aùiÚ
 *
­
, *
­2
;

4106 
ruË
 *
½
, *
½2
, *
rbe¡
;

4107 
nbe¡
, 
n
;

4108 
i
;

4109 
u£sWdÿrd
;

4111 
i
=0; i<
Ëmp
->
n¡©e
; i++){

4112 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

4113 
nbe¡
 = 0;

4114 
rbe¡
 = 0;

4115 
u£sWdÿrd
 = 0;

4117 
­
=
¡p
->­;‡p;‡p÷p->
Ãxt
){

4118 ifĞ
­
->
ty³
==
SHIFT
 &&‡p->
¥
==
Ëmp
->
wdÿrd
 ){

4119 
u£sWdÿrd
 = 1;

4121 ifĞ
­
->
ty³
!=
REDUCE
 ) ;

4122 
½
 = 
­
->
x
.rp;

4123 ifĞ
½
->
lhsS¹
 ) ;

4124 ifĞ
½
==
rbe¡
 ) ;

4125 
n
 = 1;

4126 
­2
=
­
->
Ãxt
;‡p2;‡p2=ap2->next){

4127 ifĞ
­2
->
ty³
!=
REDUCE
 ) ;

4128 
½2
 = 
­2
->
x
.
½
;

4129 ifĞ
½2
==
rbe¡
 ) ;

4130 ifĞ
½2
==
½
 ) 
n
++;

4132 ifĞ
n
>
nbe¡
 ){

4133 
nbe¡
 = 
n
;

4134 
rbe¡
 = 
½
;

4142 ifĞ
nbe¡
<1 || 
u£sWdÿrd
 ) ;

4146 
­
=
¡p
->­;‡p;‡p÷p->
Ãxt
){

4147 ifĞ
­
->
ty³
==
REDUCE
 &&‡p->
x
.
½
==
rbe¡
 ) ;

4149 
	`as£¹
Ğ
­
 );

4150 
­
->
¥
 = 
	`SymbŞ_Ãw
("{default}");

4151 
­
÷p->
Ãxt
;‡p;‡p=ap->next){

4152 ifĞ
­
->
ty³
==
REDUCE
 &&‡p->
x
.
½
==
rbe¡
 )‡p->ty³ = 
NOT_USED
;

4154 
¡p
->
­
 = 
	`AùiÚ_sÜt
(stp->ap);

4156 
	}
}

4165 
	$¡©eResÜtCom·»
(cÚ¡ *
a
, cÚ¡ *
b
){

4166 cÚ¡ 
¡©e
 *
pA
 = *(cÚ¡ ¡©e**)
a
;

4167 cÚ¡ 
¡©e
 *
pB
 = *(cÚ¡ ¡©e**)
b
;

4168 
n
;

4170 
n
 = 
pB
->
nNtAù
 - 
pA
->nNtAct;

4171 ifĞ
n
==0 ){

4172 
n
 = 
pB
->
nTknAù
 - 
pA
->nTknAct;

4174  
n
;

4175 
	}
}

4182 
	$ResÜtS‹s
(
Ëmp
)

4183 
ËmÚ
 *
Ëmp
;

4185 
i
;

4186 
¡©e
 *
¡p
;

4187 
aùiÚ
 *
­
;

4189 
i
=0; i<
Ëmp
->
n¡©e
; i++){

4190 
¡p
 = 
Ëmp
->
sÜ‹d
[
i
];

4191 
¡p
->
nTknAù
 = s->
nNtAù
 = 0;

4192 
¡p
->
iDæt
 = 
Ëmp
->
n¡©e
 +†emp->
ÄuË
;

4193 
¡p
->
iTknOf¡
 = 
NO_OFFSET
;

4194 
¡p
->
iNtOf¡
 = 
NO_OFFSET
;

4195 
­
=
¡p
->­;‡p;‡p÷p->
Ãxt
){

4196 ifĞ
	`compu‹_aùiÚ
(
Ëmp
,
­
)>=0 ){

4197 ifĞ
­
->
¥
->
šdex
<
Ëmp
->
Á”mš®
 ){

4198 
¡p
->
nTknAù
++;

4199 }ifĞ
­
->
¥
->
šdex
<
Ëmp
->
nsymbŞ
 ){

4200 
¡p
->
nNtAù
++;

4202 
¡p
->
iDæt
 = 
	`compu‹_aùiÚ
(
Ëmp
, 
­
);

4207 
	`qsÜt
(&
Ëmp
->
sÜ‹d
[1],†emp->
n¡©e
-1, (lemp->sorted[0]),

4208 
¡©eResÜtCom·»
);

4209 
i
=0; i<
Ëmp
->
n¡©e
; i++){

4210 
Ëmp
->
sÜ‹d
[
i
]->
¡©’um
 = i;

4212 
	}
}

4220 
	gsize
 = 0;

4223 
	$S‘Size
(
n
)

4224 
n
;

4226 
size
 = 
n
+1;

4227 
	}
}

4230 *
	$S‘New
(){

4231 *
s
;

4232 
s
 = (*)
	`ÿÎoc
Ğ
size
, 1);

4233 ifĞ
s
==0 ){

4234 
	`memÜy_”rÜ
();

4235 
	`memÜy_”rÜ
();

4237  
s
;

4238 
	}
}

4241 
	$S‘F»e
(
s
)

4242 *
s
;

4244 
	`ä“
(
s
);

4245 
	}
}

4249 
	$S‘Add
(
s
,
e
)

4250 *
s
;

4251 
e
;

4253 
rv
;

4254 
	`as£¹
Ğ
e
>=0 &&ƒ<
size
 );

4255 
rv
 = 
s
[
e
];

4256 
s
[
e
] = 1;

4257  !
rv
;

4258 
	}
}

4261 
	$S‘UniÚ
(
s1
,
s2
)

4262 *
s1
;

4263 *
s2
;

4265 
i
, 
´og»ss
;

4266 
´og»ss
 = 0;

4267 
i
=0; i<
size
; i++){

4268 ifĞ
s2
[
i
]==0 ) ;

4269 ifĞ
s1
[
i
]==0 ){

4270 
´og»ss
 = 1;

4271 
s1
[
i
] = 1;

4274  
´og»ss
;

4275 
	}
}

4289 
PRIVATE
 
	$¡rhash
(
x
)

4290 *
x
;

4292 
h
 = 0;

4293  *
x
è
h
 = h*13 + *(x++);

4294  
h
;

4295 
	}
}

4301 *
	$SŒ§ã
(
y
)

4302 *
y
;

4304 *
z
;

4306 ifĞ
y
==0 )  0;

4307 
z
 = 
	`SŒ§ã_fšd
(
y
);

4308 ifĞ
z
==0 && (z=
	`m®loc
Ğ
	`ËmÚSŒËn
(
y
)+1 ))!=0 ){

4309 
	`¡rıy
(
z
,
y
);

4310 
	`SŒ§ã_š£¹
(
z
);

4312 
	`MemÜyCheck
(
z
);

4313  
z
;

4314 
	}
}

4319 
	ss_x1
 {

4320 
	msize
;

4323 
	mcouÁ
;

4324 
s_x1node
 *
	mtbl
;

4325 
s_x1node
 **
	mht
;

4331 
	ss_x1node
 {

4332 *
	md©a
;

4333 
s_x1node
 *
	mÃxt
;

4334 
s_x1node
 **
	mäom
;

4335 } 
	tx1node
;

4338 
s_x1
 *
	gx1a
;

4341 
	$SŒ§ã_š™
(){

4342 ifĞ
x1a
 ) ;

4343 
x1a
 = (
s_x1
*)
	`m®loc
( (s_x1) );

4344 ifĞ
x1a
 ){

4345 
x1a
->
size
 = 1024;

4346 
x1a
->
couÁ
 = 0;

4347 
x1a
->
tbl
 = (
x1node
*)
	`m®loc
(

4348 ((
x1node
) + (x1node*))*1024 );

4349 ifĞ
x1a
->
tbl
==0 ){

4350 
	`ä“
(
x1a
);

4351 
x1a
 = 0;

4353 
i
;

4354 
x1a
->
ht
 = (
x1node
**)&(x1a->
tbl
[1024]);

4355 
i
=0; i<1024; i++è
x1a
->
ht
[i] = 0;

4358 
	}
}

4361 
	$SŒ§ã_š£¹
(
d©a
)

4362 *
d©a
;

4364 
x1node
 *
Å
;

4365 
h
;

4366 
ph
;

4368 ifĞ
x1a
==0 )  0;

4369 
ph
 = 
	`¡rhash
(
d©a
);

4370 
h
 = 
ph
 & (
x1a
->
size
-1);

4371 
Å
 = 
x1a
->
ht
[
h
];

4372  
Å
 ){

4373 ifĞ
	`¡rcmp
(
Å
->
d©a
,data)==0 ){

4378 
Å
 =‚p->
Ãxt
;

4380 ifĞ
x1a
->
couÁ
>=x1a->
size
 ){

4382 
i
,
size
;

4383 
s_x1
 
¬¿y
;

4384 
¬¿y
.
size
 = sizğ
x1a
->size*2;

4385 
¬¿y
.
couÁ
 = 
x1a
->count;

4386 
¬¿y
.
tbl
 = (
x1node
*)
	`m®loc
(

4387 ((
x1node
è+ (x1node*))*
size
 );

4388 ifĞ
¬¿y
.
tbl
==0 )  0;

4389 
¬¿y
.
ht
 = (
x1node
**)&×¼ay.
tbl
[
size
]);

4390 
i
=0; i<
size
; i++è
¬¿y
.
ht
[i] = 0;

4391 
i
=0; i<
x1a
->
couÁ
; i++){

4392 
x1node
 *
ŞdÅ
, *
ÃwÅ
;

4393 
ŞdÅ
 = &(
x1a
->
tbl
[
i
]);

4394 
h
 = 
	`¡rhash
(
ŞdÅ
->
d©a
è& (
size
-1);

4395 
ÃwÅ
 = &(
¬¿y
.
tbl
[
i
]);

4396 ifĞ
¬¿y
.
ht
[
h
] )‡¼ay.ht[h]->
äom
 = &(
ÃwÅ
->
Ãxt
);

4397 
ÃwÅ
->
Ãxt
 = 
¬¿y
.
ht
[
h
];

4398 
ÃwÅ
->
d©a
 = 
ŞdÅ
->data;

4399 
ÃwÅ
->
äom
 = &(
¬¿y
.
ht
[
h
]);

4400 
¬¿y
.
ht
[
h
] = 
ÃwÅ
;

4402 
	`ä“
(
x1a
->
tbl
);

4403 *
x1a
 = 
¬¿y
;

4406 
h
 = 
ph
 & (
x1a
->
size
-1);

4407 
Å
 = &(
x1a
->
tbl
[x1a->
couÁ
++]);

4408 
Å
->
d©a
 = data;

4409 ifĞ
x1a
->
ht
[
h
] ) x1a->ht[h]->
äom
 = &(
Å
->
Ãxt
);

4410 
Å
->
Ãxt
 = 
x1a
->
ht
[
h
];

4411 
x1a
->
ht
[
h
] = 
Å
;

4412 
Å
->
äom
 = &(
x1a
->
ht
[
h
]);

4414 
	}
}

4418 *
	$SŒ§ã_fšd
(
key
)

4419 *
key
;

4421 
h
;

4422 
x1node
 *
Å
;

4424 ifĞ
x1a
==0 )  0;

4425 
h
 = 
	`¡rhash
(
key
è& (
x1a
->
size
-1);

4426 
Å
 = 
x1a
->
ht
[
h
];

4427  
Å
 ){

4428 ifĞ
	`¡rcmp
(
Å
->
d©a
,
key
)==0 ) ;

4429 
Å
 =‚p->
Ãxt
;

4431  
Å
 ?‚p->
d©a
 : 0;

4432 
	}
}

4437 
symbŞ
 *
	$SymbŞ_Ãw
(
x
)

4438 *
x
;

4440 
symbŞ
 *
¥
;

4442 
¥
 = 
	`SymbŞ_fšd
(
x
);

4443 ifĞ
¥
==0 ){

4444 
¥
 = (
symbŞ
 *)
	`ÿÎoc
(1, (symbol) );

4445 
	`MemÜyCheck
(
¥
);

4446 
¥
->
Çme
 = 
	`SŒ§ã
(
x
);

4447 
¥
->
ty³
 = 
	`isuµ”
(*
x
è? 
TERMINAL
 : 
NONTERMINAL
;

4448 
¥
->
ruË
 = 0;

4449 
¥
->
çÎback
 = 0;

4450 
¥
->
´ec
 = -1;

4451 
¥
->
assoc
 = 
UNK
;

4452 
¥
->
fœ¡£t
 = 0;

4453 
¥
->
Ïmbda
 = 
LEMON_FALSE
;

4454 
¥
->
de¡ruùÜ
 = 0;

4455 
¥
->
de¡Lš’o
 = 0;

4456 
¥
->
d©©y³
 = 0;

4457 
¥
->
u£CÁ
 = 0;

4458 
	`SymbŞ_š£¹
(
¥
,¥->
Çme
);

4460 
¥
->
u£CÁ
++;

4461  
¥
;

4462 
	}
}

4474 
	$SymbŞcmµ
(cÚ¡ *
void_a
, cÚ¡ *
void_b
){

4475 
symbŞ
 *
a
 = *(symbŞ **)
void_a
;

4476 
symbŞ
 *
b
 = *(symbŞ **)
void_b
;

4477 
i1
 = 
a
->
šdex
 + 10000000*×->
Çme
[0]>'Z');

4478 
i2
 = 
b
->
šdex
 + 10000000*(b->
Çme
[0]>'Z');

4479  
i1
-
i2
;

4480 
	}
}

4485 
	ss_x2
 {

4486 
	msize
;

4489 
	mcouÁ
;

4490 
s_x2node
 *
	mtbl
;

4491 
s_x2node
 **
	mht
;

4497 
	ss_x2node
 {

4498 
symbŞ
 *
	md©a
;

4499 *
	mkey
;

4500 
s_x2node
 *
	mÃxt
;

4501 
s_x2node
 **
	mäom
;

4502 } 
	tx2node
;

4505 
s_x2
 *
	gx2a
;

4508 
	$SymbŞ_š™
(){

4509 ifĞ
x2a
 ) ;

4510 
x2a
 = (
s_x2
*)
	`m®loc
( (s_x2) );

4511 ifĞ
x2a
 ){

4512 
x2a
->
size
 = 128;

4513 
x2a
->
couÁ
 = 0;

4514 
x2a
->
tbl
 = (
x2node
*)
	`m®loc
(

4515 ((
x2node
) + (x2node*))*128 );

4516 ifĞ
x2a
->
tbl
==0 ){

4517 
	`ä“
(
x2a
);

4518 
x2a
 = 0;

4520 
i
;

4521 
x2a
->
ht
 = (
x2node
**)&(x2a->
tbl
[128]);

4522 
i
=0; i<128; i++è
x2a
->
ht
[i] = 0;

4525 
	}
}

4528 
	$SymbŞ_š£¹
(
d©a
,
key
)

4529 
symbŞ
 *
d©a
;

4530 *
key
;

4532 
x2node
 *
Å
;

4533 
h
;

4534 
ph
;

4536 ifĞ
x2a
==0 )  0;

4537 
ph
 = 
	`¡rhash
(
key
);

4538 
h
 = 
ph
 & (
x2a
->
size
-1);

4539 
Å
 = 
x2a
->
ht
[
h
];

4540  
Å
 ){

4541 ifĞ
	`¡rcmp
(
Å
->
key
,key)==0 ){

4546 
Å
 =‚p->
Ãxt
;

4548 ifĞ
x2a
->
couÁ
>=x2a->
size
 ){

4550 
i
,
size
;

4551 
s_x2
 
¬¿y
;

4552 
¬¿y
.
size
 = sizğ
x2a
->size*2;

4553 
¬¿y
.
couÁ
 = 
x2a
->count;

4554 
¬¿y
.
tbl
 = (
x2node
*)
	`m®loc
(

4555 ((
x2node
è+ (x2node*))*
size
 );

4556 ifĞ
¬¿y
.
tbl
==0 )  0;

4557 
¬¿y
.
ht
 = (
x2node
**)&×¼ay.
tbl
[
size
]);

4558 
i
=0; i<
size
; i++è
¬¿y
.
ht
[i] = 0;

4559 
i
=0; i<
x2a
->
couÁ
; i++){

4560 
x2node
 *
ŞdÅ
, *
ÃwÅ
;

4561 
ŞdÅ
 = &(
x2a
->
tbl
[
i
]);

4562 
h
 = 
	`¡rhash
(
ŞdÅ
->
key
è& (
size
-1);

4563 
ÃwÅ
 = &(
¬¿y
.
tbl
[
i
]);

4564 ifĞ
¬¿y
.
ht
[
h
] )‡¼ay.ht[h]->
äom
 = &(
ÃwÅ
->
Ãxt
);

4565 
ÃwÅ
->
Ãxt
 = 
¬¿y
.
ht
[
h
];

4566 
ÃwÅ
->
key
 = 
ŞdÅ
->key;

4567 
ÃwÅ
->
d©a
 = 
ŞdÅ
->data;

4568 
ÃwÅ
->
äom
 = &(
¬¿y
.
ht
[
h
]);

4569 
¬¿y
.
ht
[
h
] = 
ÃwÅ
;

4571 
	`ä“
(
x2a
->
tbl
);

4572 *
x2a
 = 
¬¿y
;

4575 
h
 = 
ph
 & (
x2a
->
size
-1);

4576 
Å
 = &(
x2a
->
tbl
[x2a->
couÁ
++]);

4577 
Å
->
key
 = key;

4578 
Å
->
d©a
 = data;

4579 ifĞ
x2a
->
ht
[
h
] ) x2a->ht[h]->
äom
 = &(
Å
->
Ãxt
);

4580 
Å
->
Ãxt
 = 
x2a
->
ht
[
h
];

4581 
x2a
->
ht
[
h
] = 
Å
;

4582 
Å
->
äom
 = &(
x2a
->
ht
[
h
]);

4584 
	}
}

4588 
symbŞ
 *
	$SymbŞ_fšd
(
key
)

4589 *
key
;

4591 
h
;

4592 
x2node
 *
Å
;

4594 ifĞ
x2a
==0 )  0;

4595 
h
 = 
	`¡rhash
(
key
è& (
x2a
->
size
-1);

4596 
Å
 = 
x2a
->
ht
[
h
];

4597  
Å
 ){

4598 ifĞ
	`¡rcmp
(
Å
->
key
,key)==0 ) ;

4599 
Å
 =‚p->
Ãxt
;

4601  
Å
 ?‚p->
d©a
 : 0;

4602 
	}
}

4605 
symbŞ
 *
	$SymbŞ_Nth
(
n
)

4606 
n
;

4608 
symbŞ
 *
d©a
;

4609 ifĞ
x2a
 && 
n
>0 &&‚<=x2a->
couÁ
 ){

4610 
d©a
 = 
x2a
->
tbl
[
n
-1].data;

4612 
d©a
 = 0;

4614  
d©a
;

4615 
	}
}

4618 
	$SymbŞ_couÁ
()

4620  
x2a
 ? x2a->
couÁ
 : 0;

4621 
	}
}

4626 
symbŞ
 **
	$SymbŞ_¬¿yof
()

4628 
symbŞ
 **
¬¿y
;

4629 
i
,
size
;

4630 ifĞ
x2a
==0 )  0;

4631 
size
 = 
x2a
->
couÁ
;

4632 
¬¿y
 = (
symbŞ
 **)
	`ÿÎoc
(
size
, (symbol *));

4633 ifĞ
¬¿y
 ){

4634 
i
=0; i<
size
; i++è
¬¿y
[i] = 
x2a
->
tbl
[i].
d©a
;

4636  
¬¿y
;

4637 
	}
}

4640 
	$CÚfigcmp
(
a
,
b
)

4641 
cÚfig
 *
a
;

4642 
cÚfig
 *
b
;

4644 
x
;

4645 
x
 = 
a
->
½
->
šdex
 - 
b
->rp->index;

4646 ifĞ
x
==0 ) x = 
a
->
dÙ
 - 
b
->dot;

4647  
x
;

4648 
	}
}

4651 
PRIVATE
 
	$¡©ecmp
(
a
,
b
)

4652 
cÚfig
 *
a
;

4653 
cÚfig
 *
b
;

4655 
rc
;

4656 
rc
=0;„c==0 && 
a
 && 
b
;‡÷->
bp
, b=b->bp){

4657 
rc
 = 
a
->
½
->
šdex
 - 
b
->rp->index;

4658 ifĞ
rc
==0 )„øğ
a
->
dÙ
 - 
b
->dot;

4660 ifĞ
rc
==0 ){

4661 ifĞ
a
 ) 
rc
 = 1;

4662 ifĞ
b
 ) 
rc
 = -1;

4664  
rc
;

4665 
	}
}

4668 
PRIVATE
 
	$¡©ehash
(
a
)

4669 
cÚfig
 *
a
;

4671 
h
=0;

4672  
a
 ){

4673 
h
 = h*571 + 
a
->
½
->
šdex
*37 +‡->
dÙ
;

4674 
a
 =‡->
bp
;

4676  
h
;

4677 
	}
}

4680 
¡©e
 *
	$S‹_Ãw
()

4682 
¡©e
 *
Ãw
;

4683 
Ãw
 = (
¡©e
 *)
	`ÿÎoc
(1, (state) );

4684 
	`MemÜyCheck
(
Ãw
);

4685  
Ãw
;

4686 
	}
}

4691 
	ss_x3
 {

4692 
	msize
;

4695 
	mcouÁ
;

4696 
s_x3node
 *
	mtbl
;

4697 
s_x3node
 **
	mht
;

4703 
	ss_x3node
 {

4704 
¡©e
 *
	md©a
;

4705 
cÚfig
 *
	mkey
;

4706 
s_x3node
 *
	mÃxt
;

4707 
s_x3node
 **
	mäom
;

4708 } 
	tx3node
;

4711 
s_x3
 *
	gx3a
;

4714 
	$S‹_š™
(){

4715 ifĞ
x3a
 ) ;

4716 
x3a
 = (
s_x3
*)
	`m®loc
( (s_x3) );

4717 ifĞ
x3a
 ){

4718 
x3a
->
size
 = 128;

4719 
x3a
->
couÁ
 = 0;

4720 
x3a
->
tbl
 = (
x3node
*)
	`m®loc
(

4721 ((
x3node
) + (x3node*))*128 );

4722 ifĞ
x3a
->
tbl
==0 ){

4723 
	`ä“
(
x3a
);

4724 
x3a
 = 0;

4726 
i
;

4727 
x3a
->
ht
 = (
x3node
**)&(x3a->
tbl
[128]);

4728 
i
=0; i<128; i++è
x3a
->
ht
[i] = 0;

4731 
	}
}

4734 
	$S‹_š£¹
(
d©a
,
key
)

4735 
¡©e
 *
d©a
;

4736 
cÚfig
 *
key
;

4738 
x3node
 *
Å
;

4739 
h
;

4740 
ph
;

4742 ifĞ
x3a
==0 )  0;

4743 
ph
 = 
	`¡©ehash
(
key
);

4744 
h
 = 
ph
 & (
x3a
->
size
-1);

4745 
Å
 = 
x3a
->
ht
[
h
];

4746  
Å
 ){

4747 ifĞ
	`¡©ecmp
(
Å
->
key
,key)==0 ){

4752 
Å
 =‚p->
Ãxt
;

4754 ifĞ
x3a
->
couÁ
>=x3a->
size
 ){

4756 
i
,
size
;

4757 
s_x3
 
¬¿y
;

4758 
¬¿y
.
size
 = sizğ
x3a
->size*2;

4759 
¬¿y
.
couÁ
 = 
x3a
->count;

4760 
¬¿y
.
tbl
 = (
x3node
*)
	`m®loc
(

4761 ((
x3node
è+ (x3node*))*
size
 );

4762 ifĞ
¬¿y
.
tbl
==0 )  0;

4763 
¬¿y
.
ht
 = (
x3node
**)&×¼ay.
tbl
[
size
]);

4764 
i
=0; i<
size
; i++è
¬¿y
.
ht
[i] = 0;

4765 
i
=0; i<
x3a
->
couÁ
; i++){

4766 
x3node
 *
ŞdÅ
, *
ÃwÅ
;

4767 
ŞdÅ
 = &(
x3a
->
tbl
[
i
]);

4768 
h
 = 
	`¡©ehash
(
ŞdÅ
->
key
è& (
size
-1);

4769 
ÃwÅ
 = &(
¬¿y
.
tbl
[
i
]);

4770 ifĞ
¬¿y
.
ht
[
h
] )‡¼ay.ht[h]->
äom
 = &(
ÃwÅ
->
Ãxt
);

4771 
ÃwÅ
->
Ãxt
 = 
¬¿y
.
ht
[
h
];

4772 
ÃwÅ
->
key
 = 
ŞdÅ
->key;

4773 
ÃwÅ
->
d©a
 = 
ŞdÅ
->data;

4774 
ÃwÅ
->
äom
 = &(
¬¿y
.
ht
[
h
]);

4775 
¬¿y
.
ht
[
h
] = 
ÃwÅ
;

4777 
	`ä“
(
x3a
->
tbl
);

4778 *
x3a
 = 
¬¿y
;

4781 
h
 = 
ph
 & (
x3a
->
size
-1);

4782 
Å
 = &(
x3a
->
tbl
[x3a->
couÁ
++]);

4783 
Å
->
key
 = key;

4784 
Å
->
d©a
 = data;

4785 ifĞ
x3a
->
ht
[
h
] ) x3a->ht[h]->
äom
 = &(
Å
->
Ãxt
);

4786 
Å
->
Ãxt
 = 
x3a
->
ht
[
h
];

4787 
x3a
->
ht
[
h
] = 
Å
;

4788 
Å
->
äom
 = &(
x3a
->
ht
[
h
]);

4790 
	}
}

4794 
¡©e
 *
	$S‹_fšd
(
key
)

4795 
cÚfig
 *
key
;

4797 
h
;

4798 
x3node
 *
Å
;

4800 ifĞ
x3a
==0 )  0;

4801 
h
 = 
	`¡©ehash
(
key
è& (
x3a
->
size
-1);

4802 
Å
 = 
x3a
->
ht
[
h
];

4803  
Å
 ){

4804 ifĞ
	`¡©ecmp
(
Å
->
key
,key)==0 ) ;

4805 
Å
 =‚p->
Ãxt
;

4807  
Å
 ?‚p->
d©a
 : 0;

4808 
	}
}

4813 
¡©e
 **
	$S‹_¬¿yof
()

4815 
¡©e
 **
¬¿y
;

4816 
i
,
size
;

4817 ifĞ
x3a
==0 )  0;

4818 
size
 = 
x3a
->
couÁ
;

4819 
¬¿y
 = (
¡©e
 **)
	`m®loc
Ğ(¡©*)*
size
 );

4820 ifĞ
¬¿y
 ){

4821 
i
=0; i<
size
; i++è
¬¿y
[i] = 
x3a
->
tbl
[i].
d©a
;

4823  
¬¿y
;

4824 
	}
}

4827 
PRIVATE
 
	$cÚfighash
(
a
)

4828 
cÚfig
 *
a
;

4830 
h
=0;

4831 
h
 = h*571 + 
a
->
½
->
šdex
*37 +‡->
dÙ
;

4832  
h
;

4833 
	}
}

4838 
	ss_x4
 {

4839 
	msize
;

4842 
	mcouÁ
;

4843 
s_x4node
 *
	mtbl
;

4844 
s_x4node
 **
	mht
;

4850 
	ss_x4node
 {

4851 
cÚfig
 *
	md©a
;

4852 
s_x4node
 *
	mÃxt
;

4853 
s_x4node
 **
	mäom
;

4854 } 
	tx4node
;

4857 
s_x4
 *
	gx4a
;

4860 
	$CÚfigbË_š™
(){

4861 ifĞ
x4a
 ) ;

4862 
x4a
 = (
s_x4
*)
	`m®loc
( (s_x4) );

4863 ifĞ
x4a
 ){

4864 
x4a
->
size
 = 64;

4865 
x4a
->
couÁ
 = 0;

4866 
x4a
->
tbl
 = (
x4node
*)
	`m®loc
(

4867 ((
x4node
) + (x4node*))*64 );

4868 ifĞ
x4a
->
tbl
==0 ){

4869 
	`ä“
(
x4a
);

4870 
x4a
 = 0;

4872 
i
;

4873 
x4a
->
ht
 = (
x4node
**)&(x4a->
tbl
[64]);

4874 
i
=0; i<64; i++è
x4a
->
ht
[i] = 0;

4877 
	}
}

4880 
	$CÚfigbË_š£¹
(
d©a
)

4881 
cÚfig
 *
d©a
;

4883 
x4node
 *
Å
;

4884 
h
;

4885 
ph
;

4887 ifĞ
x4a
==0 )  0;

4888 
ph
 = 
	`cÚfighash
(
d©a
);

4889 
h
 = 
ph
 & (
x4a
->
size
-1);

4890 
Å
 = 
x4a
->
ht
[
h
];

4891  
Å
 ){

4892 ifĞ
	`CÚfigcmp
(
Å
->
d©a
,data)==0 ){

4897 
Å
 =‚p->
Ãxt
;

4899 ifĞ
x4a
->
couÁ
>=x4a->
size
 ){

4901 
i
,
size
;

4902 
s_x4
 
¬¿y
;

4903 
¬¿y
.
size
 = sizğ
x4a
->size*2;

4904 
¬¿y
.
couÁ
 = 
x4a
->count;

4905 
¬¿y
.
tbl
 = (
x4node
*)
	`m®loc
(

4906 ((
x4node
è+ (x4node*))*
size
 );

4907 ifĞ
¬¿y
.
tbl
==0 )  0;

4908 
¬¿y
.
ht
 = (
x4node
**)&×¼ay.
tbl
[
size
]);

4909 
i
=0; i<
size
; i++è
¬¿y
.
ht
[i] = 0;

4910 
i
=0; i<
x4a
->
couÁ
; i++){

4911 
x4node
 *
ŞdÅ
, *
ÃwÅ
;

4912 
ŞdÅ
 = &(
x4a
->
tbl
[
i
]);

4913 
h
 = 
	`cÚfighash
(
ŞdÅ
->
d©a
è& (
size
-1);

4914 
ÃwÅ
 = &(
¬¿y
.
tbl
[
i
]);

4915 ifĞ
¬¿y
.
ht
[
h
] )‡¼ay.ht[h]->
äom
 = &(
ÃwÅ
->
Ãxt
);

4916 
ÃwÅ
->
Ãxt
 = 
¬¿y
.
ht
[
h
];

4917 
ÃwÅ
->
d©a
 = 
ŞdÅ
->data;

4918 
ÃwÅ
->
äom
 = &(
¬¿y
.
ht
[
h
]);

4919 
¬¿y
.
ht
[
h
] = 
ÃwÅ
;

4921 
	`ä“
(
x4a
->
tbl
);

4922 *
x4a
 = 
¬¿y
;

4925 
h
 = 
ph
 & (
x4a
->
size
-1);

4926 
Å
 = &(
x4a
->
tbl
[x4a->
couÁ
++]);

4927 
Å
->
d©a
 = data;

4928 ifĞ
x4a
->
ht
[
h
] ) x4a->ht[h]->
äom
 = &(
Å
->
Ãxt
);

4929 
Å
->
Ãxt
 = 
x4a
->
ht
[
h
];

4930 
x4a
->
ht
[
h
] = 
Å
;

4931 
Å
->
äom
 = &(
x4a
->
ht
[
h
]);

4933 
	}
}

4937 
cÚfig
 *
	$CÚfigbË_fšd
(
key
)

4938 
cÚfig
 *
key
;

4940 
h
;

4941 
x4node
 *
Å
;

4943 ifĞ
x4a
==0 )  0;

4944 
h
 = 
	`cÚfighash
(
key
è& (
x4a
->
size
-1);

4945 
Å
 = 
x4a
->
ht
[
h
];

4946  
Å
 ){

4947 ifĞ
	`CÚfigcmp
(
Å
->
d©a
,
key
)==0 ) ;

4948 
Å
 =‚p->
Ãxt
;

4950  
Å
 ?‚p->
d©a
 : 0;

4951 
	}
}

4955 
	$CÚfigbË_ş—r
(
f
)

4956 (*
f
)( );

4958 
i
;

4959 ifĞ
x4a
==0 || x4a->
couÁ
==0 ) ;

4960 ifĞ
f
 ) 
i
=0; i<
x4a
->
couÁ
; i++è(*f)(x4a->
tbl
[i].
d©a
);

4961 
i
=0; i<
x4a
->
size
; i++èx4a->
ht
[i] = 0;

4962 
x4a
->
couÁ
 = 0;

4964 
	}
}

	@queryparser/queryparser.cc

22 
	~<cÚfig.h
>

24 
	~<x­Ÿn/qu”y·r£r.h
>

25 
	~<x­Ÿn/‹rm™”©Ü.h
>

27 
	~"omdebug.h
"

28 
	~"qu”y·r£r_š‹º®.h
"

29 
	~"veùÜ‹rmli¡.h
"

31 
	~<c¡ršg
>

33 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

35 
usšg
 
Çme¥aû
 
	g¡d
;

38 
¡ršg


39 
	gStİ³r
::
	$g‘_desütiÚ
() const

42 
	}
}

44 
¡ršg


45 
	gSim¶eStİ³r
::
	$g‘_desütiÚ
() const

47 
¡ršg
 
	`desc
("Xapian::SimpleStopper(");

48 
£t
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

49 
i
 = 
¡İ_wÜds
.
	`begš
(); i !ğ¡İ_wÜds.
	`’d
(); ++i) {

50 ià(
i
 !ğ
¡İ_wÜds
.
	`begš
()è
desc
 += ' ';

51 
desc
 +ğ*
i
;

53 
desc
 += ')';

54  
desc
;

55 
	}
}

57 
	gV®ueRªgeProûssÜ
::~
	$V®ueRªgeProûssÜ
(è{ 
	}
}

59 
Qu”yP¬£r
::
	$Qu”yP¬£r
(cÚ¡ 
Qu”yP¬£r
 & 
o
è: 
	$š‹º®
(
o
.
š‹º®
è{ 
	}
}

61 
Qu”yP¬£r
 &

62 
Qu”yP¬£r
::
İ”©Ü
=(cÚ¡ Qu”yP¬£¸& 
o
)

64 
š‹º®
 = 
o
.internal;

65  *
	gthis
;

68 
	gQu”yP¬£r
::
	$Qu”yP¬£r
(è: 
	`š‹º®
(
Ãw
 
Qu”yP¬£r
::
IÁ”Çl
è{ 
	}
}

70 
Qu”yP¬£r
::~
	$Qu”yP¬£r
(è{ 
	}
}

73 
Qu”yP¬£r
::
£t_¡emm”
(cÚ¡ 
X­Ÿn
::
S‹m
 & 
¡emm”
)

75 
š‹º®
->
¡emm”
 = stemmer;

79 
	gQu”yP¬£r
::
	$£t_¡emmšg_¡¿‹gy
(
¡em_¡¿‹gy
 
¡¿‹gy
)

81 
š‹º®
->
¡em_aùiÚ
 = 
¡¿‹gy
;

82 
	}
}

85 
	gQu”yP¬£r
::
	$£t_¡İ³r
(cÚ¡ 
Stİ³r
 * 
¡İ³r
)

87 
š‹º®
->
¡İ³r
 = stopper;

88 
	}
}

91 
	gQu”yP¬£r
::
£t_deçuÉ_İ
(
Qu”y
::
İ
 
deçuÉ_İ
)

93 
š‹º®
->
deçuÉ_İ
 = default_op;

96 
	gQu”y
::
İ


97 
Qu”yP¬£r
::
	$g‘_deçuÉ_İ
() const

99  
š‹º®
->
deçuÉ_İ
;

100 
	}
}

103 
	gQu”yP¬£r
::
	$£t_d©aba£
(cÚ¡ 
D©aba£
 &
db
) {

104 
š‹º®
->
db
 = db;

105 
	}
}

107 
Qu”y


108 
	gQu”yP¬£r
::
	$·r£_qu”y
(cÚ¡ 
¡ršg
 &
qu”y_¡ršg
, 
æags
,

109 cÚ¡ 
¡ršg
 &
deçuÉ_´efix
)

111 
š‹º®
->
¡İli¡
.
	`ş—r
();

112 
š‹º®
->
un¡em
.
	`ş—r
();

113 
š‹º®
->
”rmsg
 = 
NULL
;

115 ià(
qu”y_¡ršg
.
	`em±y
()è 
	`Qu”y
();

117 
Qu”y
 
»suÉ
 = 
š‹º®
->
	`·r£_qu”y
(
qu”y_¡ršg
, 
æags
, 
deçuÉ_´efix
);

118 ià(
š‹º®
->
”rmsg
 && 
	`¡rcmp
(internal->errmsg, "parseƒrror") == 0) {

119 
»suÉ
 = 
š‹º®
->
	`·r£_qu”y
(
qu”y_¡ršg
, 0, 
deçuÉ_´efix
);

122 ià(
š‹º®
->
”rmsg
è
throw
 
X­Ÿn
::
	`Qu”yP¬£rE¼Ü
(internal->errmsg);

123  
»suÉ
;

124 
	}
}

127 
	gQu”yP¬£r
::
	$add_´efix
(cÚ¡ 
¡ršg
 &
f›ld
, cÚ¡ sŒšg &
´efix
)

129 
	`As£¹
(
š‹º®
.
	`g‘
());

130 
š‹º®
->
	`add_´efix
(
f›ld
, 
´efix
, 
çl£
);

131 
	}
}

134 
	gQu”yP¬£r
::
	$add_boŞ—n_´efix
(cÚ¡ 
¡ršg
 &
f›ld
, cÚ¡ sŒšg &
´efix
)

136 
	`As£¹
(
š‹º®
.
	`g‘
());

139 ià(
f›ld
.
	`em±y
())

140 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Can't setheƒmpty…refixo be‡ boolean filter");

141 
š‹º®
->
	`add_´efix
(
f›ld
, 
´efix
, 
Œue
);

142 
	}
}

144 
T”mI‹¿tÜ


145 
	gQu”yP¬£r
::
	$¡İli¡_begš
() const

147 
li¡
<
¡ršg
> & 
¦
 = 
š‹º®
->
¡İli¡
;

148  
	`T”mI‹¿tÜ
(
Ãw
 
	`VeùÜT”mLi¡
(
¦
.
	`begš
(), sl.
	`’d
()));

149 
	}
}

151 
T”mI‹¿tÜ


152 
	gQu”yP¬£r
::
	$un¡em_begš
(cÚ¡ 
¡ršg
 &
‹rm
) const

154 
·œ
<
muÉim­
<
¡ršg
, sŒšg>::
™”©Ü
,

155 
muÉim­
<
¡ršg
, sŒšg>::
™”©Ü
> 
¿nge
;

156 
¿nge
 = 
š‹º®
->
un¡em
.
	`equ®_¿nge
(
‹rm
);

157 
li¡
<
¡ršg
> 
l
;

158 
muÉim­
<
¡ršg
, sŒšg>::
™”©Ü
 & 
i
 = 
¿nge
.
fœ¡
;

159 
i
 !ğ
¿nge
.
£cÚd
) {

160 
l
.
	`push_back
(
i
->
£cÚd
);

161 ++
i
;

163  
	`T”mI‹¿tÜ
(
Ãw
 
	`VeùÜT”mLi¡
(
l
.
	`begš
(),†.
	`’d
()));

164 
	}
}

167 
	gQu”yP¬£r
::
add_v®u”ªg•roûssÜ
(
X­Ÿn
::
V®ueRªgeProûssÜ
 * 
v½roc
)

169 
As£¹
(
š‹º®
.
g‘
());

170 
	gš‹º®
->
	gv®¿ng•rocs
.
push_back
(
v½roc
);

173 
¡ršg


174 
	gQu”yP¬£r
::
	$g‘_cÜ»ùed_qu”y_¡ršg
() const

176  
š‹º®
->
cÜ»ùed_qu”y
;

177 
	}
}

179 
¡ršg


180 
	gQu”yP¬£r
::
	$g‘_desütiÚ
() const

184 
	}
}

	@queryparser/queryparser_internal.cc

32 
	~<cÚfig.h
>

34 
	~"omas£¹.h
"

35 
	~"qu”y·r£r_š‹º®.h
"

36 
	~<x­Ÿn/”rÜ.h
>

37 
	~<x­Ÿn/unicode.h
>

38 
	~"¡ršguts.h
"

40 
	~"omdebug.h
"

43 
	~"qu”y·r£r_tok’.h
"

45 
	~<®gÜ™hm
>

46 
	~<li¡
>

47 
	~<¡ršg
>

49 
	~<¡ršg.h
>

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

55 
šlše
 
boŞ


56 
	$U_isuµ”
(
ch
) {

57  (
ch
 < 128 && 
	`C_isuµ”
(()ch));

58 
	}
}

60 
šlše
 
boŞ


61 
	$U_isdig™
(
ch
) {

62  (
ch
 < 128 && 
	`C_isdig™
(()ch));

63 
	}
}

65 
šlše
 
boŞ


66 
	$U_i§Íha
(
ch
) {

67  (
ch
 < 128 && 
	`C_i§Íha
(()ch));

68 
	}
}

70 
usšg
 
	gX­Ÿn
::
Unicode
::
is_wh™e¥aû
;

72 
šlše
 
boŞ


73 
	$is_nÙ_wh™e¥aû
(
ch
) {

74  !
	`is_wh™e¥aû
(
ch
);

75 
	}
}

77 
usšg
 
	gX­Ÿn
::
Unicode
::
is_wÜdch¬
;

79 
šlše
 
boŞ


80 
	$is_nÙ_wÜdch¬
(
ch
) {

81  !
	`is_wÜdch¬
(
ch
);

82 
	}
}

84 
šlše
 
boŞ


85 
	$is_dig™
(
ch
) {

86  (
Unicode
::
	`g‘_ÿ‹gÜy
(
ch
è=ğUnicode::
DECIMAL_DIGIT_NUMBER
);

87 
	}
}

91 
šlše
 
boŞ


92 
	$is_suffix
(
ch
) {

93  
ch
 == '+' || ch == '#';

94 
	}
}

96 
šlše
 
boŞ


97 
	$´efix_Ãeds_cŞÚ
(cÚ¡ 
¡ršg
 & 
´efix
, 
ch
)

99 ià(!
	`U_isuµ”
(
ch
)è 
çl£
;

100 
¡ršg
::
size_ty³
 
Ën
 = 
´efix
.
	`Ëngth
();

101  (
Ën
 > 1 && 
´efix
[len - 1] != ':');

102 
	}
}

104 
usšg
 
	gUnicode
::
is_cu¼’cy
;

107 
	sf‹r_group_id
 {

111 
	mli¡
<
	m¡ršg
> 
	m´efixes
;

116 
	mX­Ÿn
::
v®u’o
 
v®no
;

119 
ex¶ic™
 
f‹r_group_id
(cÚ¡ 
li¡
<
¡ršg
> & 
´efixes_
)

120 : 
´efixes
(
´efixes_
), 
v®no
(
X­Ÿn
::
BAD_VALUENO
) {}

123 
ex¶ic™
 
f‹r_group_id
(
X­Ÿn
::
v®u’o
 
v®no_
)

124 : 
´efixes
(), 
v®no
(
v®no_
) {}

127 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mf‹r_group_id
 & 
	mÙh”
) const {

128 ià(
	m´efixes
 !ğ
Ùh”
.
´efixes
) {

129  
´efixes
 < 
Ùh”
.prefixes;

131  
	mv®no
 < 
	mÙh”
.valno;

141 şas 
	cT”m
 {

142 
S‹
 * 
	m¡©e
;

144 
	mpublic
:

145 
¡ršg
 
Çme
;

146 
	mli¡
<
	m¡ršg
> 
	m´efixes
;

147 
¡ršg
 
	mun¡emmed
;

148 
	mQu”yP¬£r
::
¡em_¡¿‹gy
 
¡em
;

149 
‹rmpos
 
	mpos
;

151 
	$T”m
(cÚ¡ 
¡ršg
 &
Çme_
, 
‹rmpos
 
pos_
è: 
	`Çme
Òame_), 
	`¡em
(
Qu”yP¬£r
::
STEM_NONE
), 
	$pos
(
pos_
) { }

152 
	$T”m
(cÚ¡ 
¡ršg
 &
Çme_
è: 
	`Çme
Òame_), 
	`¡em
(
Qu”yP¬£r
::
STEM_NONE
), 
	$pos
(0è{ 
	}
}

153 
T”m
(cÚ¡ 
¡ršg
 &
Çme_
, cÚ¡ 
li¡
<¡ršg> &
´efixes_
)

154 : 
Çme
(
Çme_
), 
´efixes
(
´efixes_
), 
¡em
(
Qu”yP¬£r
::
STEM_NONE
), 
	$pos
(0è{ 
	}
}

155 
	$T”m
(
‹rmpos
 
pos_
è: 
	`¡em
(
Qu”yP¬£r
::
STEM_NONE
), 
	$pos
(
pos_
è{ 
	}
}

156 
T”m
(
S‹
 * 
¡©e_
, cÚ¡ 
¡ršg
 &
Çme_
, cÚ¡ 
li¡
<¡ršg> &
´efixes_
,

157 cÚ¡ 
¡ršg
 &
un¡emmed_
,

158 
Qu”yP¬£r
::
¡em_¡¿‹gy
 
¡em_
 = Qu”yP¬£r::
STEM_NONE
,

159 
‹rmpos
 
pos_
 = 0)

160 : 
¡©e
(
¡©e_
), 
Çme
(
Çme_
), 
´efixes
(
´efixes_
), 
un¡emmed
(
un¡emmed_
),

161 
¡em
(
¡em_
), 
	$pos
(
pos_
è{ 
	}
}

163 
¡ršg
 
	$make_‹rm
(cÚ¡ 
¡ršg
 & 
´efix
) const;

165 
	$Ãed_pos™iÚs
() {

166 ià(
¡em
 =ğ
Qu”yP¬£r
::
STEM_SOME
è¡em = Qu”yP¬£r::
STEM_NONE
;

167 
	}
}

169 
‹rmpos
 
	$g‘_‹rmpos
(ècÚ¡ {  
pos
; 
	}
}

171 
f‹r_group_id
 
	$g‘_f‹r_group_id
(ècÚ¡ {  
	`f‹r_group_id
(
´efixes
); 
	}
}

173 
Qu”y
 * 
	$as_wdÿrded_qu”y
(
S‹
 * 
¡©e
) const;

183 
Qu”y
 * 
	$as_·¹Ÿl_qu”y
(
S‹
 * 
¡©e_
) const;

185 
Qu”y
 
	$g‘_qu”y
() const;

187 
Qu”y
 
	$g‘_qu”y_w™h_synÚyms
() const;

189 
Qu”y
 
	$g‘_qu”y_w™h_auto_synÚyms
() const;

190 
	}
};

193 şas 
	cS‹
 {

194 
	mQu”yP¬£r
::
IÁ”Çl
 * 
qpi
;

196 
	mpublic
:

197 
Qu”y
 
qu”y
;

198 cÚ¡ * 
	m”rÜ
;

199 
	mæags
;

201 
S‹
(
Qu”yP¬£r
::
IÁ”Çl
 * 
qpi_
, 
æags_
)

202 : 
qpi
(
qpi_
), 
”rÜ
(
NULL
), 
	$æags
(
æags_
) { }

204 
¡ršg
 
	$¡em_‹rm
(cÚ¡ 
¡ršg
 &
‹rm
) {

205  
qpi
->
	`¡emm”
(
‹rm
);

206 
	}
}

208 
	$add_to_¡İli¡
(cÚ¡ 
T”m
 * 
‹rm
) {

209 
qpi
->
¡İli¡
.
	`push_back
(
‹rm
->
Çme
);

210 
	}
}

212 
	$add_to_un¡em
(cÚ¡ 
¡ršg
 & 
‹rm
, cÚ¡ sŒšg & 
un¡emmed
) {

213 
qpi
->
un¡em
.
	`š£¹
(
	`make_·œ
(
‹rm
, 
un¡emmed
));

214 
	}
}

216 
v®u’o
 
	$v®ue_¿nge
(
Qu”y
 & 
q
, 
T”m
 *
a
, T”m *
b
) {

217 
li¡
<
V®ueRªgeProûssÜ
 *>::
cÚ¡_™”©Ü
 
i
;

218 
i
 = 
qpi
->
v®¿ng•rocs
.
	`begš
(); i !ğqpi->v®¿ng•rocs.
	`’d
(); ++i) {

219 
¡ršg
 
¡¬t
 = 
a
->
Çme
;

220 
¡ršg
 
’d
 = 
b
->
Çme
;

221 
X­Ÿn
::
v®u’o
 
v®no
 = (**
i
)(
¡¬t
, 
’d
);

222 ià(
v®no
 !ğ
X­Ÿn
::
BAD_VALUENO
) {

223 
d–‘e
 
a
;

224 
d–‘e
 
b
;

225 
q
 = 
	`Qu”y
(
Qu”y
::
OP_VALUE_RANGE
, 
v®no
, 
¡¬t
, 
’d
);

226  
v®no
;

235 
”rÜ
 = "Unknown„ange operation";

236  
X­Ÿn
::
BAD_VALUENO
;

237 
	}
}

239 
	gQu”y
::
İ
 
	$deçuÉ_İ
(ècÚ¡ {  
qpi
->
deçuÉ_İ
; 
	}
}

241 
boŞ
 
	$is_¡İwÜd
(cÚ¡ 
T”m
 *
‹rm
) const {

242  
qpi
->
¡İ³r
 && (*qpi->¡İ³r)(
‹rm
->
Çme
);

243 
	}
}

245 
D©aba£
 
	$g‘_d©aba£
() const {

246  
qpi
->
db
;

247 
	}
}

250 
¡ršg


251 
	gT”m
::
	$make_‹rm
(cÚ¡ 
¡ršg
 & 
´efix
) const

253 
¡ršg
 
‹rm
;

254 ià(
¡em
 =ğ
Qu”yP¬£r
::
STEM_SOME
è
‹rm
 += 'Z';

255 ià(!
´efix
.
	`em±y
()) {

256 
‹rm
 +ğ
´efix
;

257 ià(
	`´efix_Ãeds_cŞÚ
(
´efix
, 
Çme
[0])è
‹rm
 += ':';

259 ià(
¡em
 !ğ
Qu”yP¬£r
::
STEM_NONE
) {

260 
‹rm
 +ğ
¡©e
->
	`¡em_‹rm
(
Çme
);

262 
‹rm
 +ğ
Çme
;

265 ià(!
un¡emmed
.
	`em±y
())

266 
¡©e
->
	`add_to_un¡em
(
‹rm
, 
un¡emmed
);

267  
‹rm
;

268 
	}
}

270 
Qu”y


271 
	gT”m
::
	$g‘_qu”y_w™h_synÚyms
() const

273 
Qu”y
 
q
 = 
	`g‘_qu”y
();

276 
li¡
<
¡ršg
>::
cÚ¡_™”©Ü
 
p™”
;

277 
p™”
 = 
´efixes
.
	`begš
();…™” !ğ´efixes.
	`’d
(); ++piter) {

279 
¡ršg
 
‹rm
;

280 ià(!
p™”
->
	`em±y
()) {

281 
‹rm
 +ğ*
p™”
;

282 ià(
	`´efix_Ãeds_cŞÚ
(*
p™”
, 
Çme
[0])è
‹rm
 += ':';

284 
‹rm
 +ğ
Çme
;

286 
X­Ÿn
::
D©aba£
 
db
 = 
¡©e
->
	`g‘_d©aba£
();

287 
X­Ÿn
::
T”mI‹¿tÜ
 
syn
 = 
db
.
	`synÚyms_begš
(
‹rm
);

288 
X­Ÿn
::
T”mI‹¿tÜ
 
’d
 = 
db
.
	`synÚyms_’d
(
‹rm
);

289 ià(
syn
 =ğ
’d
 && 
¡em
 !ğ
Qu”yP¬£r
::
STEM_NONE
) {

291 
‹rm
 = 'Z';

292 ià(!
p™”
->
	`em±y
()) {

293 
‹rm
 +ğ*
p™”
;

294 ià(
	`´efix_Ãeds_cŞÚ
(*
p™”
, 
Çme
[0])è
‹rm
 += ':';

296 
‹rm
 +ğ
¡©e
->
	`¡em_‹rm
(
Çme
);

297 
syn
 = 
db
.
	`synÚyms_begš
(
‹rm
);

298 
’d
 = 
db
.
	`synÚyms_’d
(
‹rm
);

300 
syn
 !ğ
’d
) {

301 
q
 = 
	`Qu”y
(
Qu”y
::
OP_SYNONYM
, q, Qu”y(*
syn
, 1, 
pos
));

302 ++
syn
;

305  
q
;

306 
	}
}

308 
Qu”y


309 
	gT”m
::
	$g‘_qu”y_w™h_auto_synÚyms
() const

311 ià(
¡©e
->
æags
 & 
Qu”yP¬£r
::
FLAG_AUTO_SYNONYMS
)

312  
	`g‘_qu”y_w™h_synÚyms
();

314  
	`g‘_qu”y
();

315 
	}
}

318 
add_to_qu”y
(
Qu”y
 *& 
q
, Qu”y::
İ
 op, Qu”y * 
‹rm
)

320 
As£¹
(
‹rm
);

321 ià(
	gq
) {

322 *
	gq
 = 
Qu”y
(
İ
, *
q
, *
‹rm
);

323 
d–‘e
 
	g‹rm
;

325 
	gq
 = 
‹rm
;

330 
add_to_qu”y
(
Qu”y
 *& 
q
, Qu”y::
İ
 op, cÚ¡ Qu”y & 
‹rm
)

332 ià(
	gq
) {

333 *
	gq
 = 
Qu”y
(
İ
, *
q
, 
‹rm
);

335 
	gq
 = 
Ãw
 
Qu”y
(
‹rm
);

339 
Qu”y


340 
	gT”m
::
	$g‘_qu”y
() const

342 
	`As£¹
(
´efixes
.
	`size
() >= 1);

343 
li¡
<
¡ršg
>::
cÚ¡_™”©Ü
 
p™”
 = 
´efixes
.
	`begš
();

344 
Qu”y
 
	`q
(
	`make_‹rm
(*
p™”
), 1, 
pos
);

345 ++
p™”
 !ğ
´efixes
.
	`’d
()) {

346 
q
 = 
	`Qu”y
(
Qu”y
::
OP_OR
, q, Qu”y(
	`make_‹rm
(*
p™”
), 1, 
pos
));

348  
q
;

349 
	}
}

351 
Qu”y
 *

352 
	gT”m
::
	$as_wdÿrded_qu”y
(
S‹
 * 
¡©e_
) const

354 
D©aba£
 
db
 = 
¡©e_
->
	`g‘_d©aba£
();

355 
veùÜ
<
Qu”y
> 
subqs
;

356 
li¡
<
¡ršg
>::
cÚ¡_™”©Ü
 
p™”
;

357 
p™”
 = 
´efixes
.
	`begš
();…™” !ğ´efixes.
	`’d
(); ++piter) {

358 
¡ršg
 
roÙ
 = *
p™”
;

359 
roÙ
 +ğ
Çme
;

360 
T”mI‹¿tÜ
 
t
 = 
db
.
	`®É”ms_begš
(
roÙ
);

361 
t
 !ğ
db
.
	`®É”ms_’d
(
roÙ
)) {

362 
subqs
.
	`push_back
(
	`Qu”y
(*
t
, 1, 
pos
));

363 ++
t
;

366 
d–‘e
 
this
;

367  
Ãw
 
	`Qu”y
(
Qu”y
::
OP_SYNONYM
, 
subqs
.
	`begš
(), subqs.
	`’d
());

368 
	}
}

370 
Qu”y
 *

371 
	gT”m
::
	$as_·¹Ÿl_qu”y
(
S‹
 * 
¡©e_
) const

373 
D©aba£
 
db
 = 
¡©e_
->
	`g‘_d©aba£
();

374 
veùÜ
<
Qu”y
> 
subqs_·¹Ÿl
;

375 
veùÜ
<
Qu”y
> 
subqs_fuÎ
;

376 
li¡
<
¡ršg
>::
cÚ¡_™”©Ü
 
p™”
;

377 
p™”
 = 
´efixes
.
	`begš
();…™” !ğ´efixes.
	`’d
(); ++piter) {

378 
¡ršg
 
roÙ
 = *
p™”
;

379 
roÙ
 +ğ
Çme
;

380 
T”mI‹¿tÜ
 
t
 = 
db
.
	`®É”ms_begš
(
roÙ
);

381 
t
 !ğ
db
.
	`®É”ms_’d
(
roÙ
)) {

382 
subqs_·¹Ÿl
.
	`push_back
(
	`Qu”y
(*
t
, 1, 
pos
));

383 ++
t
;

386 
subqs_fuÎ
.
	`push_back
(
	`Qu”y
(
	`make_‹rm
(*
p™”
), 1, 
pos
));

388 
d–‘e
 
this
;

389  
Ãw
 
	`Qu”y
(
Qu”y
::
OP_OR
,

390 
	`Qu”y
(
Qu”y
::
OP_SYNONYM
,

391 
subqs_·¹Ÿl
.
	`begš
(), subqs_·¹Ÿl.
	`’d
()),

392 
	`Qu”y
(
Qu”y
::
OP_SYNONYM
,

393 
subqs_fuÎ
.
	`begš
(), subqs_fuÎ.
	`’d
()));

394 
	}
}

396 
šlše
 
boŞ


397 
	$is_ph¿£_g’”©Ü
(
ch
)

402  (
ch
 && ch < 128 && 
	`¡rchr
(".-/:\\@", chè!ğ
NULL
);

403 
	}
}

405 
šlše
 
boŞ


406 
	$is_¡em_´ev’‹r
(
ch
)

408  (
ch
 && ch < 128 && 
	`¡rchr
("(/\\@<>=*[{\"", chè!ğ
NULL
);

409 
	}
}

411 
šlše
 
boŞ


412 
	$should_¡em
(cÚ¡ 
¡ršg
 & 
‹rm
)

414 
	`DEBUGCALL
(
DB
, 
boŞ
, "should_stem", "");

415 cÚ¡ 
SHOULD_STEM_MASK
 =

416 (1 << 
Unicode
::
LOWERCASE_LETTER
) |

417 (1 << 
Unicode
::
TITLECASE_LETTER
) |

418 (1 << 
Unicode
::
MODIFIER_LETTER
) |

419 (1 << 
Unicode
::
OTHER_LETTER
);

420 
Utf8I‹¿tÜ
 
	`u
(
‹rm
);

421  ((
SHOULD_STEM_MASK
 >> 
Unicode
::
	`g‘_ÿ‹gÜy
(*
u
)) & 1);

422 
	}
}

427 cÚ¡ 
UNICODE_IGNORE
(-1);

429 
šlše
 
	$check_šfix
(
ch
) {

430 ià(
ch
 == '\'' || ch == '&' || ch == 0xb7 || ch == 0x5f4 || ch == 0x2027) {

435  
ch
;

439 ià(
ch
 == 0x2019 || ch == 0x201b)  '\'';

440 ià(
ch
 >= 0x200b && (ch <= 0x200d || ch == 0x2060 || ch == 0xfeff))

441  
UNICODE_IGNORE
;

443 
	}
}

445 
šlše
 
	$check_šfix_dig™
(
ch
) {

447 
ch
) {

459  
ch
;

461 ià(
ch
 >= 0x200b && (ch <= 0x200d || ch == 0x2060 || ch == 0xfeff))

462  
UNICODE_IGNORE
;

464 
	}
}

466 
	gyyP¬£r
;

469 
yyP¬£r
 *
P¬£AÎoc
();

470 
P¬£F»e
(
yyP¬£r
 *);

471 
P¬£
(
yyP¬£r
 *, , 
T”m
 *, 
S‹
 *);

474 
	gQu”yP¬£r
::
IÁ”Çl
::
	$add_´efix
(cÚ¡ 
¡ršg
 &
f›ld
, cÚ¡ sŒšg &
´efix
,

475 
boŞ
 
f‹r
)

477 
m­
<
¡ršg
, 
P»fixInfo
>::
™”©Ü
 
p
 = 
´efixm­
.
	`fšd
(
f›ld
);

478 ià(
p
 =ğ
´efixm­
.
	`’d
()) {

479 
´efixm­
.
	`š£¹
(
	`make_·œ
(
f›ld
, 
	`P»fixInfo
(
f‹r
, 
´efix
)));

482 ià(
p
->
£cÚd
.
f‹r
 != filter) {

483 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
("Can't use‡dd_prefix()‡nd‡dd_bool_prefix() onhe same field‚ame");

485 
p
->
£cÚd
.
´efixes
.
	`push_back
(
´efix
);

487 
	}
}

489 
¡ršg


490 
	gQu”yP¬£r
::
IÁ”Çl
::
	$·r£_‹rm
(
Utf8I‹¿tÜ
 &
™
, cÚ¡ Utf8I‹¿tÜ &
’d
,

491 
boŞ
 &
was_aüÚym
)

493 
¡ršg
 
‹rm
;

496 ià(
	`U_isuµ”
(*
™
)) {

497 
¡ršg
 
t
;

498 
Utf8I‹¿tÜ
 
p
 = 
™
;

500 
Unicode
::
	`­³nd_utf8
(
t
, *
p
++);

501 } 
p
 !ğ
’d
 && *°=ğ'.' && ++°!ğ’d && 
	`U_isuµ”
(*p));

504 ià(
t
.
	`Ëngth
() > 1) {

508 ià(
p
 =ğ
’d
 || !
	`is_wÜdch¬
(*p)) {

509 
™
 = 
p
;

510 
	`sw­
(
‹rm
, 
t
);

514 
was_aüÚym
 = !
‹rm
.
	`em±y
();

516 ià(
‹rm
.
	`em±y
()) {

517 
´evch
 = *
™
;

518 
Unicode
::
	`­³nd_utf8
(
‹rm
, 
´evch
);

519 ++
™
 !ğ
’d
) {

520 
ch
 = *
™
;

521 ià(!
	`is_wÜdch¬
(
ch
)) {

525 
Utf8I‹¿tÜ
 
p
 = 
™
;

526 ++
p
;

527 ià(
p
 =ğ
’d
 || !
	`is_wÜdch¬
(*p)) ;

528 
Ãxtch
 = *
p
;

529 ià(
	`is_dig™
(
´evch
è&& is_dig™(
Ãxtch
)) {

530 
ch
 = 
	`check_šfix_dig™
(ch);

532 
ch
 = 
	`check_šfix
(ch);

534 ià(!
ch
) ;

535 ià(
ch
 =ğ
UNICODE_IGNORE
)

538 
Unicode
::
	`­³nd_utf8
(
‹rm
, 
ch
);

539 
´evch
 = 
ch
;

541 ià(
™
 !ğ
’d
 && 
	`is_suffix
(*it)) {

542 
¡ršg
 
suff_‹rm
 = 
‹rm
;

543 
Utf8I‹¿tÜ
 
p
 = 
™
;

546 ià(
suff_‹rm
.
	`size
(è- 
‹rm
.size() == 3) {

547 
suff_‹rm
.
	`»size
(0);

550 
suff_‹rm
 +ğ*
p
;

551 } 
	`is_suffix
(*++
p
));

552 ià(!
suff_‹rm
.
	`em±y
(è&& (
p
 =ğ
’d
 || !
	`is_wÜdch¬
(*p))) {

557 
boŞ
 
u£_suff_‹rm
 = 
çl£
;

558 
¡ršg
 
lc
 = 
Unicode
::
	`tŞow”
(
suff_‹rm
);

559 ià(
db
.
	`‹rm_exi¡s
(
lc
)) {

560 
u£_suff_‹rm
 = 
Œue
;

562 
lc
 = 
Unicode
::
	`tŞow”
(
‹rm
);

563 ià(!
db
.
	`‹rm_exi¡s
(
lc
)è
u£_suff_‹rm
 = 
Œue
;

565 ià(
u£_suff_‹rm
) {

566 
‹rm
 = 
suff_‹rm
;

567 
™
 = 
p
;

572  
‹rm
;

573 
	}
}

575 
Qu”y


576 
	gQu”yP¬£r
::
IÁ”Çl
::
	$·r£_qu”y
(cÚ¡ 
¡ršg
 &
qs
, 
æags
,

577 cÚ¡ 
¡ršg
 &
deçuÉ_´efix
)

579 
yyP¬£r
 * 
pP¬£r
 = 
	`P¬£AÎoc
();

582 
boŞ
 
v®ue_¿nges
;

583 
v®ue_¿nges
 = !
v®¿ng•rocs
.
	`em±y
(è&& (
qs
.
	`fšd
(".."è!ğ
¡ršg
::
Åos
);

585 
‹rmpos
 
‹rm_pos
 = 1;

586 
Utf8I‹¿tÜ
 
	`™
(
qs
), 
’d
;

588 
S‹
 
	`¡©e
(
this
, 
æags
);

592 
cÜ»ùiÚ_off£t
 = 0;

593 
cÜ»ùed_qu”y
.
	`»size
(0);

596 
li¡
<cÚ¡ 
P»fixInfo
 *> 
´efix_¡ack
;

600 cÚ¡ 
P»fixInfo
 
	`def_pfx
(
çl£
, 
deçuÉ_´efix
);

602 cÚ¡ 
P»fixInfo
 * 
deçuÉ_´efixšfo
 = &
def_pfx
;

603 ià(
deçuÉ_´efix
.
	`em±y
()) {

604 
m­
<
¡ršg
, 
P»fixInfo
>::
cÚ¡_™”©Ü
 
f
 = 
´efixm­
.
	`fšd
("");

605 ià(
f
 !ğ
´efixm­
.
	`’d
()è
deçuÉ_´efixšfo
 = &(f->
£cÚd
);

609 
´efix_¡ack
.
	`push_back
(
deçuÉ_´efixšfo
);

612 
Ãw´ev
 = ' ';

613 
maš_Ëx_loİ
:

615 
DEFAULT
, 
IN_QUOTES
, 
IN_PREFIXED_QUOTES
, 
IN_PHRASED_TERM
, 
IN_GROUP
,

616 
EXPLICIT_SYNONYM


617 } 
mode
 = 
DEFAULT
;

618 
™
 !ğ
’d
 && !
¡©e
.
”rÜ
) {

619 
boŞ
 
Ï¡_was_İ”©Ü
 = 
çl£
;

620 ià(
mode
 =ğ
EXPLICIT_SYNONYM
èmodğ
DEFAULT
;

621 ià(
çl£
) {

622 
ju¡_had_İ”©Ü
:

623 ià(
™
 =ğ
’d
) ;

624 
mode
 = 
DEFAULT
;

625 
ju¡_had_synÚym_İ”©Ü
:

626 
Ï¡_was_İ”©Ü
 = 
Œue
;

628 ià(
mode
 =ğ
IN_PHRASED_TERM
èmodğ
DEFAULT
;

629 ià(
	`is_wh™e¥aû
(*
™
)) {

630 
Ãw´ev
 = ' ';

631 ++
™
;

632 
™
 = 
	`fšd_if
(™, 
’d
, 
is_nÙ_wh™e¥aû
);

633 ià(
™
 =ğ
’d
) ;

636 ià((
mode
 =ğ
DEFAULT
 || mod=ğ
IN_GROUP
è&& 
v®ue_¿nges
) {

641 
Utf8I‹¿tÜ
 
p
 = 
™
;

642 
ch
 = 0;

643 
p
 !ğ
’d
) {

644 ià(
ch
 =ğ'.' && *
p
 == '.') {

645 ++
p
;

646 ià(
p
 =ğ
’d
 || *p <= ' ' || *p == ')') ;

648 
¡ršg
 
r
;

650 
Unicode
::
	`­³nd_utf8
(
r
, *
™
++);

651 } 
™
 !ğ
p
);

653 
r
.
	`»size
Ô.
	`size
() - 2);

654 
	`P¬£
(
pP¬£r
, 
RANGE_START
, 
Ãw
 
	`T”m
(
r
), &
¡©e
);

655 
r
.
	`»size
(0);

659 
Unicode
::
	`­³nd_utf8
(
r
, *
p
++);

660 } 
p
 !ğ
’d
 && *p > ' ' && *p != ')');

661 
	`P¬£
(
pP¬£r
, 
RANGE_END
, 
Ãw
 
	`T”m
(
r
), &
¡©e
);

662 
™
 = 
p
;

663 
maš_Ëx_loİ
;

665 
ch
 = *
p
;

666 ià(!(
	`is_wÜdch¬
(
ch
è|| 
	`is_cu¼’cy
(ch) ||

667 (
ch
 < 128 && 
	`¡rchr
("%,-./:@", ch)))) ;

668 ++
p
;

672 ià(!
	`is_wÜdch¬
(*
™
)) {

673 
´ev
 = 
Ãw´ev
;

674 
ch
 = *
™
++;

675 
Ãw´ev
 = 
ch
;

677 ià(
mode
 =ğ
IN_GROUP
èmodğ
DEFAULT
;

678 
ch
) {

680 ià(
mode
 =ğ
DEFAULT
) {

682 
™
 = 
	`fšd_if
(™, 
’d
, 
is_nÙ_wh™e¥aû
);

683 ià(
™
 =ğ
’d
) {

687 
dÚe
;

689 ià(*
™
 == '"') {

693 
Ãw´ev
 = *
™
++;

697 ià(
æags
 & 
Qu”yP¬£r
::
FLAG_PHRASE
) {

698 
	`P¬£
(
pP¬£r
, 
QUOTE
, 
NULL
, &
¡©e
);

699 ià(
mode
 =ğ
DEFAULT
) {

700 
mode
 = 
IN_QUOTES
;

703 ià(
mode
 =ğ
IN_PREFIXED_QUOTES
)

704 
´efix_¡ack
.
	`pİ_back
();

705 
mode
 = 
DEFAULT
;

712 ià(
™
 =ğ
’d
è
dÚe
;

713 ià(
´ev
 > ' ' &&…rev != '(') {

717 ià(
	`is_wh™e¥aû
(*
™
) || *it == '+' || *it == '-') {

721 
Ãw´ev
 = *
™
++;

724 ià(
mode
 =ğ
DEFAULT
 && (
æags
 & 
FLAG_LOVEHATE
)) {

725 
tok’
;

726 ià(
ch
 == '+') {

727 
tok’
 = 
LOVE
;

728 } ià(
Ï¡_was_İ”©Ü
) {

729 
tok’
 = 
HATE_AFTER_AND
;

731 
tok’
 = 
HATE
;

733 
	`P¬£
(
pP¬£r
, 
tok’
, 
NULL
, &
¡©e
);

734 
ju¡_had_İ”©Ü
;

742 
™
 = 
	`fšd_if
(™, 
’d
, 
is_nÙ_wh™e¥aû
);

744 ià(
™
 =ğ
’d
è
dÚe
;

745 ià(
´ev
 > ' ' && 
	`¡rchr
("()+-",…»vè=ğ
NULL
) {

749 ià(*
™
 == ')') {

751 
Ãw´ev
 = *
™
++;

754 ià(
mode
 =ğ
DEFAULT
 && (
æags
 & 
FLAG_BOOLEAN
)) {

755 
´efix_¡ack
.
	`push_back
Õ»fix_¡ack.
	`back
());

756 
	`P¬£
(
pP¬£r
, 
BRA
, 
NULL
, &
¡©e
);

761 ià(
mode
 =ğ
DEFAULT
 && (
æags
 & 
FLAG_BOOLEAN
)) {

765 ià(
´efix_¡ack
.
	`size
(è> 1è´efix_¡ack.
	`pİ_back
();

766 
	`P¬£
(
pP¬£r
, 
KET
, 
NULL
, &
¡©e
);

772 ià(
™
 =ğ
’d
è
dÚe
;

773 ià(
mode
 =ğ
DEFAULT
 && (
æags
 & 
FLAG_SYNONYM
)) {

774 ià(
´ev
 > ' ' && 
	`¡rchr
("+-(",…»vè=ğ
NULL
) {

778 ià(!
	`is_wÜdch¬
(*
™
)) {

782 
	`P¬£
(
pP¬£r
, 
SYNONYM
, 
NULL
, &
¡©e
);

783 
mode
 = 
EXPLICIT_SYNONYM
;

784 
ju¡_had_synÚym_İ”©Ü
;

792 
	`As£¹
(
	`is_wÜdch¬
(*
™
));

794 
size_t
 
‹rm_¡¬t_šdex
 = 
™
.
	`¿w
(è- 
qs
.
	`d©a
();

796 
Ãw´ev
 = 'A';

799 cÚ¡ 
P»fixInfo
 * 
´efixšfo
 = 
NULL
;

800 ià((
mode
 =ğ
DEFAULT
 || mod=ğ
IN_GROUP
 || mod=ğ
EXPLICIT_SYNONYM
) &&

801 !
´efixm­
.
	`em±y
()) {

803 
Utf8I‹¿tÜ
 
p
 = 
	`fšd_if
(
™
, 
’d
, 
is_nÙ_wÜdch¬
);

804 ià(
p
 !ğ
’d
 && *p == ':' && ++p !=ƒnd && *p > ' ' && *p != ')') {

805 
¡ršg
 
f›ld
;

806 
p
 = 
™
;

807 *
p
 != ':')

808 
Unicode
::
	`­³nd_utf8
(
f›ld
, *
p
++);

809 
m­
<
¡ršg
, 
P»fixInfo
>::
cÚ¡_™”©Ü
 
f
;

810 
f
 = 
´efixm­
.
	`fšd
(
f›ld
);

811 ià(
f
 !ğ
´efixm­
.
	`’d
()) {

814 
ch
 = *++
p
;

815 
´efixšfo
 = &(
f
->
£cÚd
);

817 ià(
´efixšfo
->
f‹r
) {

819 ià(
mode
 =ğ
IN_GROUP
)

820 
mode
 = 
DEFAULT
;

821 
™
 = 
p
;

822 
¡ršg
 
Çme
;

823 ià(
™
 !ğ
’d
 && *it == '"') {

825 ++
™
;

826 
™
 !ğ
’d
) {

827 ià(*
™
 == '"') {

829 ià(++
™
 =ğ
’d
 || *it != '"')

832 
Unicode
::
	`­³nd_utf8
(
Çme
, *
™
++);

839 
™
 !ğ
’d
 && *it > ' ' && *it != ')')

840 
Unicode
::
	`­³nd_utf8
(
Çme
, *
™
++);

843 
f›ld
 += ':';

844 
f›ld
 +ğ
Çme
;

845 cÚ¡ 
li¡
<
¡ršg
> & 
´efixes
 = 
´efixšfo
->prefixes;

846 
T”m
 * 
tok’
 = 
Ãw
 
	`T”m
(&
¡©e
, 
Çme
, 
´efixes
, 
f›ld
);

847 
	`P¬£
(
pP¬£r
, 
BOOLEAN_FILTER
, 
tok’
, &
¡©e
);

851 ià(
ch
 =ğ'"' && (
æags
 & 
FLAG_PHRASE
)) {

853 
mode
 = 
IN_PREFIXED_QUOTES
;

854 
	`P¬£
(
pP¬£r
, 
QUOTE
, 
NULL
, &
¡©e
);

855 
™
 = 
p
;

856 
Ãw´ev
 = 
ch
;

857 ++
™
;

858 
´efix_¡ack
.
	`push_back
(
´efixšfo
);

862 ià(
ch
 =ğ'(' && (
æags
 & 
FLAG_BOOLEAN
)) {

864 
mode
 = 
DEFAULT
;

865 
	`P¬£
(
pP¬£r
, 
BRA
, 
NULL
, &
¡©e
);

866 
™
 = 
p
;

867 
Ãw´ev
 = 
ch
;

868 ++
™
;

869 
´efix_¡ack
.
	`push_back
(
´efixšfo
);

873 ià(
	`is_wÜdch¬
(
ch
)) {

875 
™
 = 
p
;

879 
´efixšfo
 = 
NULL
;

885 
ph¿£d_‹rm
:

886 
boŞ
 
was_aüÚym
;

887 
¡ršg
 
‹rm
 = 
	`·r£_‹rm
(
™
, 
’d
, 
was_aüÚym
);

890 ià((
mode
 =ğ
DEFAULT
 || mod=ğ
IN_GROUP
) &&

891 (
æags
 & 
FLAG_BOOLEAN
) &&

893 !
was_aüÚym
 &&

894 !
´efixšfo
 &&

895 
‹rm
.
	`size
(è>ğ2 &&”m.size(è<ğ4 && 
	`U_i§Íha
(term[0])) {

897 
¡ršg
 
İ
 = 
‹rm
;

898 ià(
æags
 & 
FLAG_BOOLEAN_ANY_CASE
) {

899 
¡ršg
::
™”©Ü
 
i
 = 
İ
.
	`begš
(); i !ğİ.
	`’d
(); ++i) {

900 *
i
 = 
	`C_touµ”
(*i);

903 ià(
İ
.
	`size
() == 3) {

904 ià(
İ
 == "AND") {

905 
	`P¬£
(
pP¬£r
, 
AND
, 
NULL
, &
¡©e
);

906 
ju¡_had_İ”©Ü
;

908 ià(
İ
 == "NOT") {

909 
	`P¬£
(
pP¬£r
, 
NOT
, 
NULL
, &
¡©e
);

910 
ju¡_had_İ”©Ü
;

912 ià(
İ
 == "XOR") {

913 
	`P¬£
(
pP¬£r
, 
XOR
, 
NULL
, &
¡©e
);

914 
ju¡_had_İ”©Ü
;

916 ià(
İ
 == "ADJ") {

917 ià(
™
 !ğ
’d
 && *it == '/') {

918 
size_t
 
width
 = 0;

919 
Utf8I‹¿tÜ
 
p
 = 
™
;

920 ++
p
 !ğ
’d
 && 
	`U_isdig™
(*p)) {

921 
width
 = (width * 10è+ (*
p
 - '0');

923 ià(
width
 && (
p
 =ğ
’d
 || 
	`is_wh™e¥aû
(*p))) {

924 
™
 = 
p
;

925 
	`P¬£
(
pP¬£r
, 
ADJ
, 
Ãw
 
	`T”m
(
width
), &
¡©e
);

926 
ju¡_had_İ”©Ü
;

930 
	`P¬£
(
pP¬£r
, 
ADJ
, 
NULL
, &
¡©e
);

931 
ju¡_had_İ”©Ü
;

933 } ià(
İ
.
	`size
() == 2) {

934 ià(
İ
 == "OR") {

935 
	`P¬£
(
pP¬£r
, 
OR
, 
NULL
, &
¡©e
);

936 
ju¡_had_İ”©Ü
;

938 } ià(
İ
.
	`size
() == 4) {

939 ià(
İ
 == "NEAR") {

940 ià(
™
 !ğ
’d
 && *it == '/') {

941 
size_t
 
width
 = 0;

942 
Utf8I‹¿tÜ
 
p
 = 
™
;

943 ++
p
 !ğ
’d
 && 
	`U_isdig™
(*p)) {

944 
width
 = (width * 10è+ (*
p
 - '0');

946 ià(
width
 && (
p
 =ğ
’d
 || 
	`is_wh™e¥aû
(*p))) {

947 
™
 = 
p
;

948 
	`P¬£
(
pP¬£r
, 
NEAR
, 
Ãw
 
	`T”m
(
width
), &
¡©e
);

949 
ju¡_had_İ”©Ü
;

953 
	`P¬£
(
pP¬£r
, 
NEAR
, 
NULL
, &
¡©e
);

954 
ju¡_had_İ”©Ü
;

960 ià(!
´efixšfo
è´efixšfØğ
´efix_¡ack
.
	`back
();

962 
	`As£¹
(!
´efixšfo
->
f‹r
);

965 
¡ršg
 
	`un¡emmed_‹rm
(
‹rm
);

966 
‹rm
 = 
Unicode
::
	`tŞow”
(term);

970 
¡em_¡¿‹gy
 
¡em_‹rm
 = 
¡em_aùiÚ
;

971 ià(
¡em_‹rm
 !ğ
STEM_NONE
) {

972 ià(!
¡emm”
.
š‹º®
.
	`g‘
()) {

974 
¡em_‹rm
 = 
STEM_NONE
;

975 } ià(
¡em_‹rm
 =ğ
STEM_SOME
) {

976 ià(!
	`should_¡em
(
un¡emmed_‹rm
) ||

977 (
™
 !ğ
’d
 && 
	`is_¡em_´ev’‹r
(*it))) {

979 
¡em_‹rm
 = 
STEM_NONE
;

984 
T”m
 * 
‹rm_obj
 = 
Ãw
 
	`T”m
(&
¡©e
, 
‹rm
, 
´efixšfo
->
´efixes
,

985 
un¡emmed_‹rm
, 
¡em_‹rm
, 
‹rm_pos
++);

987 ià(
mode
 =ğ
DEFAULT
 || mod=ğ
IN_GROUP
) {

988 ià(
™
 !ğ
’d
) {

989 ià((
æags
 & 
FLAG_WILDCARD
è&& *
™
 == '*') {

990 
Utf8I‹¿tÜ
 
	`p
(
™
);

991 ++
p
;

992 ià(
p
 =ğ
’d
 || !
	`is_wÜdch¬
(*p)) {

993 
™
 = 
p
;

996 
	`P¬£
(
pP¬£r
, 
WILD_TERM
, 
‹rm_obj
, &
¡©e
);

1001 ià(
æags
 & 
FLAG_PARTIAL
) {

1004 
	`P¬£
(
pP¬£r
, 
PARTIAL_TERM
, 
‹rm_obj
, &
¡©e
);

1012 ià((
æags
 & 
FLAG_SPELLING_CORRECTION
è&& !
was_aüÚym
) {

1013 
li¡
<
¡ršg
>::
cÚ¡_™”©Ü
 
´efix™”
;

1014 
´efix™”
 = 
´efixšfo
->
´efixes
.
	`begš
();

1015 
´efix™”
 !ğ
´efixšfo
->
´efixes
.
	`’d
();

1016 ++
´efix™”
) {

1017 ià(!
´efix™”
->
	`em±y
())

1019 ià(!
db
.
	`‹rm_exi¡s
(
‹rm
)) {

1020 
¡ršg
 
sugge¡iÚ
 = 
db
.
	`g‘_¥–lšg_sugge¡iÚ
(
‹rm
);

1021 ià(!
sugge¡iÚ
.
	`em±y
()) {

1022 ià(
cÜ»ùed_qu”y
.
	`em±y
()ècÜ»ùed_qu”y = 
qs
;

1023 
size_t
 
‹rm_’d_šdex
 = 
™
.
	`¿w
(è- 
qs
.
	`d©a
();

1024 
size_t
 
n
 = 
‹rm_’d_šdex
 - 
‹rm_¡¬t_šdex
;

1025 
size_t
 
pos
 = 
‹rm_¡¬t_šdex
 + 
cÜ»ùiÚ_off£t
;

1026 
cÜ»ùed_qu”y
.
	`»¶aû
(
pos
, 
n
, 
sugge¡iÚ
);

1027 
cÜ»ùiÚ_off£t
 +ğ
sugge¡iÚ
.
	`size
();

1028 
cÜ»ùiÚ_off£t
 -ğ
n
;

1035 ià(
mode
 =ğ
IN_PHRASED_TERM
) {

1036 
	`P¬£
(
pP¬£r
, 
PHR_TERM
, 
‹rm_obj
, &
¡©e
);

1040 ià(
mode
 =ğ
IN_GROUP
 && 
	`is_ph¿£_g’”©Ü
(*
™
)) {

1042 
Utf8I‹¿tÜ
 
p
 = 
™
;

1044 ++
p
;

1045 } 
p
 !ğ
’d
 && 
	`is_ph¿£_g’”©Ü
(*p));

1048 ià(
p
 !ğ
’d
 && 
	`is_wÜdch¬
(*p)) {

1049 
mode
 = 
DEFAULT
;

1053 
	`P¬£
(
pP¬£r
, (
mode
 =ğ
IN_GROUP
 ? 
GROUP_TERM
 : 
TERM
),

1054 
‹rm_obj
, &
¡©e
);

1055 ià(
mode
 !ğ
DEFAULT
 && mod!ğ
IN_GROUP
) ;

1059 ià(
™
 =ğ
’d
) ;

1061 ià(
	`is_ph¿£_g’”©Ü
(*
™
)) {

1064 ++
™
;

1065 } 
™
 !ğ
’d
 && 
	`is_ph¿£_g’”©Ü
(*it));

1068 ià(
™
 !ğ
’d
 && 
	`is_wÜdch¬
(*it)) {

1069 
mode
 = 
IN_PHRASED_TERM
;

1070 
‹rm_¡¬t_šdex
 = 
™
.
	`¿w
(è- 
qs
.
	`d©a
();

1071 
ph¿£d_‹rm
;

1073 } ià(
mode
 =ğ
DEFAULT
 || mod=ğ
IN_GROUP
) {

1074 
mode
 = 
DEFAULT
;

1075 ià(!
Ï¡_was_İ”©Ü
 && 
	`is_wh™e¥aû
(*
™
)) {

1076 
Ãw´ev
 = ' ';

1079 ++
™
;

1080 } 
™
 !ğ
’d
 && 
	`is_wh™e¥aû
(*it));

1083 ià(
™
 !ğ
’d
 && 
	`is_wÜdch¬
(*it)) {

1084 
mode
 = 
IN_GROUP
;

1089 
dÚe
:

1090 ià(!
¡©e
.
”rÜ
) {

1092 ià(
mode
 =ğ
IN_QUOTES
 || mod=ğ
IN_PREFIXED_QUOTES
)

1093 
	`P¬£
(
pP¬£r
, 
QUOTE
, 
NULL
, &
¡©e
);

1094 
	`P¬£
(
pP¬£r
, 0, 
NULL
, &
¡©e
);

1096 
	`P¬£F»e
(
pP¬£r
);

1098 
”rmsg
 = 
¡©e
.
”rÜ
;

1099  
¡©e
.
qu”y
;

1100 
	}
}

1102 
	sProbQu”y
 {

1103 
Qu”y
 * 
	mqu”y
;

1104 
Qu”y
 * 
	mlove
;

1105 
Qu”y
 * 
	mh©e
;

1109 
	mm­
<
	mf‹r_group_id
, 
	mQu”y
> 
	mf‹r
;

1111 
ProbQu”y
(è: 
qu”y
(0), 
love
(0), 
h©e
(0) { }

1112 ~
ProbQu”y
() {

1113 
d–‘e
 
	mqu”y
;

1114 
d–‘e
 
	mlove
;

1115 
d–‘e
 
	mh©e
;

1118 
Qu”y
 
m”ge_f‹rs
() const {

1119 
	mm­
<
	mf‹r_group_id
, 
	mQu”y
>::
cÚ¡_™”©Ü
 
i
 = 
f‹r
.
begš
();

1120 
As£¹
(
i
 !ğ
f‹r
.
’d
());

1121 
Qu”y
 
	mq
 = 
i
->
£cÚd
;

1122 ++
	mi
 !ğ
f‹r
.
’d
()) {

1123 
q
 = 
Qu”y
(Qu”y::
OP_AND
, q, 
i
->
£cÚd
);

1125  
	mq
;

1129 şas 
	cT”mGroup
 {

1130 
	mveùÜ
<
	mT”m
 *> 
	m‹rms
;

1132 
	mpublic
:

1133 
	$T”mGroup
() { }

1136 
	$add_‹rm
(
T”m
 * 
‹rm
) {

1137 
‹rms
.
	`push_back
(
‹rm
);

1138 
	}
}

1141 
Qu”y
 * 
	$as_group
(
S‹
 *
¡©e
) const;

1146 
	$de¡roy
(è{ 
d–‘e
 
this
; 
	}
}

1148 
	g´Ùeùed
:

1152 ~
	$T”mGroup
() {

1153 
veùÜ
<
T”m
*>::
cÚ¡_™”©Ü
 
i
;

1154 
i
 = 
‹rms
.
	`begš
(); i !ğ‹rms.
	`’d
(); ++i) {

1155 
d–‘e
 *
i
;

1157 
	}
}

1160 
Qu”y
 *

1161 
	gT”mGroup
::
	$as_group
(
S‹
 *
¡©e
) const

1163 
Qu”y
::
İ
 
deçuÉ_İ
 = 
¡©e
->
	`deçuÉ_İ
();

1164 
veùÜ
<
Qu”y
> 
subqs
;

1165 
subqs
.
	`»£rve
(
‹rms
.
	`size
());

1166 ià(
¡©e
->
æags
 & 
Qu”yP¬£r
::
FLAG_AUTO_MULTIWORD_SYNONYMS
) {

1168 
D©aba£
 
db
 = 
¡©e
->
	`g‘_d©aba£
();

1170 
¡ršg
 
key
;

1171 
veùÜ
<
T”m
*>::
cÚ¡_™”©Ü
 
begš
 = 
‹rms
.
	`begš
();

1172 
veùÜ
<
T”m
*>::
cÚ¡_™”©Ü
 
i
 = 
begš
;

1173 
i
 !ğ
‹rms
.
	`’d
()) {

1174 
T”mI‹¿tÜ
 
	`synkey
(
db
.
	`synÚym_keys_begš
((*
i
)->
Çme
));

1175 
T”mI‹¿tÜ
 
	`syÃnd
(
db
.
	`synÚym_keys_’d
((*
i
)->
Çme
));

1176 ià(
synkey
 =ğ
syÃnd
) {

1178 ià(
¡©e
->
	`is_¡İwÜd
(*
i
)) {

1179 
¡©e
->
	`add_to_¡İli¡
(*
i
);

1181 
subqs
.
	`push_back
((*
i
)->
	`g‘_qu”y_w™h_auto_synÚyms
());

1183 
begš
 = ++
i
;

1186 
key
.
	`»size
(0);

1187 
i
 !ğ
‹rms
.
	`’d
()) {

1188 ià(!
key
.
	`em±y
()) key += ' ';

1189 
key
 +ğ(*
i
)->
Çme
;

1190 ++
i
;

1191 
synkey
.
	`sk_to
(
key
);

1192 ià(
synkey
 =ğ
syÃnd
 || !
	`¡¬tsw™h
(*synkey, 
key
)) ;

1195 
T”mI‹¿tÜ
 
syn
, 
’d
;

1196 
Œue
) {

1197 
syn
 = 
db
.
	`synÚyms_begš
(
key
);

1198 
’d
 = 
db
.
	`synÚyms_’d
(
key
);

1199 ià(
syn
 !ğ
’d
) ;

1200 ià(--
i
 =ğ
begš
) ;

1201 
key
.
	`»size
(key.
	`size
(è- (*
i
)->
Çme
.size() - 1);

1203 ià(
i
 =ğ
begš
) {

1205 ià(
¡©e
->
	`is_¡İwÜd
(*
i
)) {

1206 
¡©e
->
	`add_to_¡İli¡
(*
i
);

1208 
subqs
.
	`push_back
((*
i
)->
	`g‘_qu”y_w™h_auto_synÚyms
());

1210 
begš
 = ++
i
;

1214 
veùÜ
<
Qu”y
> 
subqs2
;

1215 
veùÜ
<
T”m
*>::
cÚ¡_™”©Ü
 
j
;

1216 
j
 = 
begš
; j !ğ
i
; ++j) {

1217 ià(
¡©e
->
	`is_¡İwÜd
(*
j
)) {

1218 
¡©e
->
	`add_to_¡İli¡
(*
j
);

1220 
subqs2
.
	`push_back
((*
j
)->
	`g‘_qu”y
());

1223 
Qu”y
 
q_Üigš®_‹rms
;

1224 ià(
deçuÉ_İ
 =ğ
Qu”y
::
OP_NEAR
 ||

1225 
deçuÉ_İ
 =ğ
Qu”y
::
OP_PHRASE
) {

1226 
q_Üigš®_‹rms
 = 
	`Qu”y
(
deçuÉ_İ
,

1227 
subqs2
.
	`begš
(), subqs2.
	`’d
(),

1228 
subqs2
.
	`size
() + 9);

1230 
q_Üigš®_‹rms
 = 
	`Qu”y
(
deçuÉ_İ
,

1231 
subqs2
.
	`begš
(), subqs2.
	`’d
());

1233 
subqs2
.
	`ş—r
();

1236 
X­Ÿn
::
‹rmpos
 
pos
 = (*
begš
)->pos;

1237 
begš
 = 
i
;

1238 
syn
 !ğ
’d
) {

1239 
subqs2
.
	`push_back
(
	`Qu”y
(*
syn
, 1, 
pos
));

1240 ++
syn
;

1242 
Qu”y
 
	`q_synÚym_‹rms
(Qu”y::
OP_SYNONYM
, 
subqs2
.
	`begš
(), subqs2.
	`’d
());

1243 
subqs2
.
	`ş—r
();

1244 
subqs
.
	`push_back
(
	`Qu”y
(
Qu”y
::
OP_SYNONYM
,

1245 
q_Üigš®_‹rms
, 
q_synÚym_‹rms
));

1248 
veùÜ
<
T”m
*>::
cÚ¡_™”©Ü
 
i
;

1249 
i
 = 
‹rms
.
	`begš
(); i !ğ‹rms.
	`’d
(); ++i) {

1250 ià(
¡©e
->
	`is_¡İwÜd
(*
i
)) {

1251 
¡©e
->
	`add_to_¡İli¡
(*
i
);

1253 
subqs
.
	`push_back
((*
i
)->
	`g‘_qu”y_w™h_auto_synÚyms
());

1258 
d–‘e
 
this
;

1260 ià(
subqs
.
	`em±y
()è 
NULL
;

1262 ià(
deçuÉ_İ
 =ğ
Qu”y
::
OP_NEAR
 ||

1263 
deçuÉ_İ
 =ğ
Qu”y
::
OP_PHRASE
) {

1264  
Ãw
 
	`Qu”y
(
deçuÉ_İ
, 
subqs
.
	`begš
(), subqs.
	`’d
(),

1265 
subqs
.
	`size
() + 9);

1267  
Ãw
 
	`Qu”y
(
deçuÉ_İ
, 
subqs
.
	`begš
(), subqs.
	`’d
());

1268 
	}
}

1270 şas 
	cT”mLi¡
 {

1271 
	mveùÜ
<
	mT”m
 *> 
	m‹rms
;

1272 
size_t
 
	mwšdow
;

1283 
boŞ
 
	munifÜm_´efixes
;

1288 
	mli¡
<
	m¡ršg
> 
	m´efixes
;

1291 
Qu”y
 * 
as_İwšdow_qu”y
(Qu”y::
İ
 op, 
X­Ÿn
::
‹rmcouÁ
 
w_d–
) const {

1292 
Qu”y
 * 
q
 = 
NULL
;

1293 
size_t
 
	mn_‹rms
 = 
‹rms
.
size
();

1294 
	mX­Ÿn
::
‹rmcouÁ
 
w
 = 
w_d–
 + 
‹rms
.
size
();

1295 ià(
	munifÜm_´efixes
) {

1296 
	mli¡
<
	m¡ršg
>::
cÚ¡_™”©Ü
 
p™”
;

1297 
	mp™”
 = 
´efixes
.
begš
();…™” !ğ´efixes.
’d
(); ++piter) {

1298 
	mveùÜ
<
	mQu”y
> 
	msubqs
;

1299 
	msubqs
.
»£rve
(
n_‹rms
);

1300 
	mveùÜ
<
	mT”m
 *>::
cÚ¡_™”©Ü
 
t™”
;

1301 
	mt™”
 = 
‹rms
.
begš
();™” !ğ‹rms.
’d
(); ++titer) {

1302 
T”m
 * 
	mt
 = *
t™”
;

1303 
	msubqs
.
push_back
(
Qu”y
(
t
->
make_‹rm
(*
p™”
), 1,->
pos
));

1305 
add_to_qu”y
(
q
, 
Qu”y
::
OP_OR
,

1306 
Qu”y
(
İ
, 
subqs
.
begš
(), subqs.
’d
(), 
w
));

1309 
	mveùÜ
<
	mQu”y
> 
	msubqs
;

1310 
	msubqs
.
»£rve
(
n_‹rms
);

1311 
	mveùÜ
<
	mT”m
 *>::
cÚ¡_™”©Ü
 
t™”
;

1312 
	mt™”
 = 
‹rms
.
begš
();™” !ğ‹rms.
’d
(); ++titer) {

1313 
	msubqs
.
push_back
((*
t™”
)->
g‘_qu”y
());

1315 
	mq
 = 
Ãw
 
Qu”y
(
İ
, 
subqs
.
begš
(), subqs.
’d
(), 
w
);

1318 
d–‘e
 
	mthis
;

1319  
	mq
;

1322 
	gpublic
:

1323 
	$T”mLi¡
(è: 
	`wšdow
(0), 
	$unifÜm_´efixes
(
Œue
è{ 
	}
}

1326 
	$add_pos™iÚ®_‹rm
(
T”m
 * 
‹rm
) {

1327 ià(
‹rms
.
	`em±y
()) {

1328 
´efixes
 = 
‹rm
->prefixes;

1329 } ià(
unifÜm_´efixes
 && 
´efixes
 !ğ
‹rm
->prefixes) {

1330 
´efixes
.
	`ş—r
();

1331 
unifÜm_´efixes
 = 
çl£
;

1333 
‹rm
->
	`Ãed_pos™iÚs
();

1334 
‹rms
.
	`push_back
(
‹rm
);

1335 
	}
}

1337 
	$adju¡_wšdow
(
size_t
 
®‹º©ive_wšdow
) {

1338 ià(
®‹º©ive_wšdow
 > 
wšdow
) window =‡lternative_window;

1339 
	}
}

1342 
Qu”y
 * 
	$as_ph¿£_qu”y
() const {

1343  
	`as_İwšdow_qu”y
(
Qu”y
::
OP_PHRASE
, 0);

1344 
	}
}

1347 
Qu”y
 * 
	$as_Ã¬_qu”y
() const {

1351 
size_t
 
w
 = 
wšdow
;

1352 ià(
w
 == 0) w = 10;

1353  
	`as_İwšdow_qu”y
(
Qu”y
::
OP_NEAR
, 
w
 - 1);

1354 
	}
}

1357 
Qu”y
 * 
	$as_adj_qu”y
() const {

1361 
size_t
 
w
 = 
wšdow
;

1362 ià(
w
 == 0) w = 10;

1363  
	`as_İwšdow_qu”y
(
Qu”y
::
OP_PHRASE
, 
w
 - 1);

1364 
	}
}

1369 
	$de¡roy
(è{ 
d–‘e
 
this
; 
	}
}

1371 
	g´Ùeùed
:

1375 ~
	$T”mLi¡
() {

1376 
veùÜ
<
T”m
 *>::
cÚ¡_™”©Ü
 
t
;

1377 
t
 = 
‹rms
.
	`begš
(); !ğ‹rms.
	`’d
(); ++t) {

1378 
d–‘e
 *
t
;

1380 
	}
}

1384 
	#BOOL_OP_TO_QUERY
(
E
, 
A
, 
OP
, 
B
, 
OP_TXT
) \

1386 ià(!
A
 || !
B
) {\

1387 
¡©e
->
”rÜ
 = "SyÁax: <ex´essiÚ> "
OP_TXT
" <expression>";\

1388 
	`yy_·r£_çed
(
yypP¬£r
);\

1391 
E
 = 
Ãw
 
	`Qu”y
(
OP
, *
A
, *
B
);\

1392 
d–‘e
 
A
;\

1393 
d–‘e
 
B
;\

1394 } 0)

	)

1409 #iâdeà
INTERFACE


1410 
	#INTERFACE
 1

	)

1446 
	#YYCODETYPE
 

	)

1447 
	#YYNOCODE
 39

	)

1448 
	#YYACTIONTYPE
 

	)

1449 
	#P¬£TOKENTYPE
 
T”m
 *

	)

1451 
	myyš™
;

1452 
P¬£TOKENTYPE
 
	myy0
;

1453 
	myy8
;

1454 
ProbQu”y
 * 
	myy12
;

1455 
T”mLi¡
 * 
	myy27
;

1456 
Qu”y
 * 
	myy73
;

1457 
T”mGroup
 * 
	myy76
;

1458 } 
	tYYMINORTYPE
;

1459 #iâdeà
YYSTACKDEPTH


1460 
	#YYSTACKDEPTH
 100

	)

1462 
	#P¬£ARG_SDECL
 
S‹
 * 
¡©e
;

	)

1463 
	#P¬£ARG_PDECL
 ,
S‹
 * 
¡©e


	)

1464 
	#P¬£ARG_FETCH
 
S‹
 * 
¡©e
 = 
yypP¬£r
->
	)
state

1465 
	#P¬£ARG_STORE
 
yypP¬£r
->
¡©e
 = 
	)
state

1466 
	#YYNSTATE
 75

	)

1467 
	#YYNRULE
 52

	)

1468 
	#YY_NO_ACTION
 (
YYNSTATE
+
YYNRULE
+2)

	)

1469 
	#YY_ACCEPT_ACTION
 (
YYNSTATE
+
YYNRULE
+1)

	)

1470 
	#YY_ERROR_ACTION
 (
YYNSTATE
+
YYNRULE
)

	)

1480 #iâdeà
yy‹¡ÿ£


1481 
	#yy‹¡ÿ£
(
X
)

	)

1531 cÚ¡ 
YYACTIONTYPE
 
	gyy_aùiÚ
[] = {

1565 cÚ¡ 
YYCODETYPE
 
	gyy_lookah—d
[] = {

1599 
	#YY_SHIFT_USE_DFLT
 (-4)

	)

1600 
	#YY_SHIFT_MAX
 36

	)

1601 cÚ¡ 
	gyy_shiá_of¡
[] = {

1607 
	#YY_REDUCE_USE_DFLT
 (-25)

	)

1608 
	#YY_REDUCE_MAX
 14

	)

1609 cÚ¡ 
	gyy_»duû_of¡
[] = {

1613 cÚ¡ 
YYACTIONTYPE
 
	gyy_deçuÉ
[] = {

1623 
	#YY_SZ_ACTTAB
 ()((
yy_aùiÚ
)/(yy_aùiÚ[0]))

	)

1635 #ifdeà
YYFALLBACK


1636 cÚ¡ 
YYCODETYPE
 
	gyyF®lback
[] = {

1652 
	syySckEÁry
 {

1653 
yySckEÁry
() {

1654 
	m¡©’o
 = 0;

1655 
	mmajÜ
 = 0;

1657 
yySckEÁry
(
YYACTIONTYPE
 
¡©’o_
, 
YYCODETYPE
 
majÜ_
, 
YYMINORTYPE
 
mšÜ_
) {

1658 
	m¡©’o
 = 
¡©’o_
;

1659 
	mmajÜ
 = 
majÜ_
;

1660 
	mmšÜ
 = 
mšÜ_
;

1662 
YYACTIONTYPE
 
	m¡©’o
;

1663 
YYCODETYPE
 
	mmajÜ
;

1665 
YYMINORTYPE
 
	mmšÜ
;

1671 
	syyP¬£r
 {

1672 
	myy”rút
;

1673 
P¬£ARG_SDECL


1674 
	mveùÜ
<
	myySckEÁry
> 
	myy¡ack
;

1676 
yyP¬£r
 
	tyyP¬£r
;

1679 
yy_·r£_çed
(
yyP¬£r
 *);

1681 
	~"omas£¹.h
"

1682 
	~"omdebug.h
"

1684 #ifdeà
XAPIAN_DEBUG_LOG


1687 cÚ¡ *cÚ¡ 
	gyyTok’Name
[] = {

1702 cÚ¡ *cÚ¡ 
	gyyRuËName
[] = {

1761 cÚ¡ *
	$P¬£Tok’Name
(
tok’Ty³
){

1762 ifĞ
tok’Ty³
>=0 &&ok’Ty³<()((
yyTok’Name
)/(yyTokenName[0])) ){

1763  
yyTok’Name
[
tok’Ty³
];

1766 
	}
}

1772 cÚ¡ *
	$P¬£RuËName
(
ruËNum
){

1773 ifĞ
ruËNum
>=0 &&„uËNum<()((
yyRuËName
)/(yyRuleName[0])) ){

1774  
yyRuËName
[
ruËNum
];

1777 
	}
}

1792 
yyP¬£r
 *
	$P¬£AÎoc
(){

1793  
Ãw
 
yyP¬£r
;

1794 
	}
}

1801 
	$yy_de¡ruùÜ
(

1802 
yyP¬£r
 *
yypP¬£r
,

1803 
YYCODETYPE
 
yymajÜ
,

1804 
YYMINORTYPE
 *
yypmšÜ


1806 
P¬£ARG_FETCH
;

1807  
yymajÜ
 ){

1843 
	`d–‘e
 (
yypmšÜ
->
yy0
);

1855 
	`d–‘e
 (
yypmšÜ
->
yy73
);

1863 
	`d–‘e
 (
yypmšÜ
->
yy12
);

1873 (
yypmšÜ
->
yy27
)->
	`de¡roy
();

1880 (
yypmšÜ
->
yy76
)->
	`de¡roy
();

1886 
P¬£ARG_STORE
;

1887 
	}
}

1897 
	$yy_pİ_·r£r_¡ack
(
yyP¬£r
 *
pP¬£r
){

1898 
YYCODETYPE
 
yymajÜ
;

1899 ifĞ
pP¬£r
->
yy¡ack
.
	`em±y
() )  0;

1900 
yySckEÁry
 *
yytos
 = &
pP¬£r
->
yy¡ack
.
	`back
();

1902 
	`LOGLINE
(
QUERYPARSER
, "Pİpšg " << 
	`P¬£Tok’Name
(
yytos
->
majÜ
));

1903 
yymajÜ
 = (
YYCODETYPE
)
yytos
->
majÜ
;

1904 
	`yy_de¡ruùÜ
(
pP¬£r
, 
yymajÜ
, &
yytos
->
mšÜ
);

1905 
pP¬£r
->
yy¡ack
.
	`pİ_back
();

1906  
yymajÜ
;

1907 
	}
}

1917 
	$P¬£F»e
(

1918 
yyP¬£r
 *
pP¬£r


1920 ifĞ
pP¬£r
==0 ) ;

1921  !
pP¬£r
->
yy¡ack
.
	`em±y
(èè
	`yy_pİ_·r£r_¡ack
(pParser);

1922 
d–‘e
 
pP¬£r
;

1923 
	}
}

1933 
	$yy_fšd_shiá_aùiÚ
(

1934 
yyP¬£r
 *
pP¬£r
,

1935 
YYCODETYPE
 
iLookAh—d


1937 
i
;

1938 
¡©’o
 = 
pP¬£r
->
yy¡ack
.
	`back
().stateno;

1940 ifĞ
¡©’o
>
YY_SHIFT_MAX
 || (
i
 = 
yy_shiá_of¡
[¡©’o])==
YY_SHIFT_USE_DFLT
 ){

1941  
yy_deçuÉ
[
¡©’o
];

1943 
	`As£¹
Ğ
iLookAh—d
!=
YYNOCODE
 );

1944 
i
 +ğ
iLookAh—d
;

1945 ifĞ
i
<0 || i>=
YY_SZ_ACTTAB
 || 
yy_lookah—d
[i]!=
iLookAh—d
 ){

1946 ifĞ
iLookAh—d
>0 ){

1947 #ifdeà
YYFALLBACK


1948 
YYCODETYPE
 
iF®lback
;

1949 ifĞ
iLookAh—d
<(
yyF®lback
)/(yyFallback[0])

1950 && (
iF®lback
 = 
yyF®lback
[
iLookAh—d
])!=0 ){

1951 
	`LOGLINE
(
QUERYPARSER
,

1952 "FALLBACK " << 
	`P¬£Tok’Name
(
iLookAh—d
) << " => " <<

1953 
	`P¬£Tok’Name
(
iF®lback
));

1954  
	`yy_fšd_shiá_aùiÚ
(
pP¬£r
, 
iF®lback
);

1957 #ifdeà
YYWILDCARD


1959 
j
 = 
i
 - 
iLookAh—d
 + 
YYWILDCARD
;

1960 ifĞ
j
>=0 && j<
YY_SZ_ACTTAB
 && 
yy_lookah—d
[j]==
YYWILDCARD
 ){

1961 
	`LOGLINE
(
QUERYPARSER
,

1962 "WILDCARD " << 
	`P¬£Tok’Name
(
iLookAh—d
) << " => " <<

1963 
	`P¬£Tok’Name
(
YYWILDCARD
));

1964  
yy_aùiÚ
[
j
];

1969  
yy_deçuÉ
[
¡©’o
];

1971  
yy_aùiÚ
[
i
];

1973 
	}
}

1983 
	$yy_fšd_»duû_aùiÚ
(

1984 
¡©’o
,

1985 
YYCODETYPE
 
iLookAh—d


1987 
i
;

1988 #ifdeà
YYERRORSYMBOL


1989 ifĞ
¡©’o
>
YY_REDUCE_MAX
 ){

1990  
yy_deçuÉ
[
¡©’o
];

1993 
	`As£¹
Ğ
¡©’o
<=
YY_REDUCE_MAX
 );

1995 
i
 = 
yy_»duû_of¡
[
¡©’o
];

1996 
	`As£¹
Ğ
i
!=
YY_REDUCE_USE_DFLT
 );

1997 
	`As£¹
Ğ
iLookAh—d
!=
YYNOCODE
 );

1998 
i
 +ğ
iLookAh—d
;

1999 #ifdeà
YYERRORSYMBOL


2000 ifĞ
i
<0 || i>=
YY_SZ_ACTTAB
 || 
yy_lookah—d
[i]!=
iLookAh—d
 ){

2001  
yy_deçuÉ
[
¡©’o
];

2004 
	`As£¹
Ğ
i
>=0 && i<
YY_SZ_ACTTAB
 );

2005 
	`As£¹
Ğ
yy_lookah—d
[
i
]==
iLookAh—d
 );

2007  
yy_aùiÚ
[
i
];

2008 
	}
}

2013 
	$yy_shiá
(

2014 
yyP¬£r
 *
yypP¬£r
,

2015 
yyNewS‹
,

2016 
yyMajÜ
,

2017 
YYMINORTYPE
 *
yypMšÜ


2025 #ifdeà
XAPIAN_DEBUG_LOG


2026 
i
;

2027 
	`LOGLINE
(
QUERYPARSER
, "Shiá " << 
yyNewS‹
);

2028 
¡ršg
 
	`¡ack
("Stack:");

2029 
i
 = 0; i < 
yypP¬£r
->
yy¡ack
.
	`size
(); i++) {

2030 
¡ack
 += ' ';

2031 
¡ack
 +ğ
	`P¬£Tok’Name
(
yypP¬£r
->
yy¡ack
[
i
].
majÜ
);

2033 
	`LOGLINE
(
QUERYPARSER
, 
¡ack
);

2035 
yypP¬£r
->
yy¡ack
.
	`push_back
(
	`yySckEÁry
(
yyNewS‹
, 
yyMajÜ
, *
yypMšÜ
));

2036 
	}
}

2042 
YYCODETYPE
 
	mlhs
;

2043 
	mÄhs
;

2044 } 
	gyyRuËInfo
[] = {

2099 
yy_acû±
(
yyP¬£r
*);

2105 
	$yy_»duû
(

2106 
yyP¬£r
 *
yypP¬£r
,

2107 
yyruËno


2109 
yygÙo
;

2110 
yyaù
;

2111 
YYMINORTYPE
 
yygÙomšÜ
;

2112 
yySckEÁry
 *
yym¥
;

2113 
yysize
;

2114 
P¬£ARG_FETCH
;

2115 
yym¥
 = &
yypP¬£r
->
yy¡ack
.
	`back
();

2116 #ifdeà
XAPIAN_DEBUG_LOG


2117 
	`LOGLINE
(
QUERYPARSER
, "Reduû [" << 
	`P¬£RuËName
(
yyruËno
) << "].");

2139  
yyruËno
 ){

2152 ià(
yym¥
[0].
mšÜ
.
yy73
) {

2153 
¡©e
->
qu”y
 = *
yym¥
[0].
mšÜ
.
yy73
;

2154 
d–‘e
 
yym¥
[0].
mšÜ
.
yy73
;

2156 
¡©e
->
qu”y
 = 
	`Qu”y
();

2165 
¡©e
->
qu”y
 = 
	`Qu”y
();

2170 9: 
	`yy‹¡ÿ£
(
yyruËno
==9);

2172 { 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.yy73; }

2177 { 
	`BOOL_OP_TO_QUERY
(
yygÙomšÜ
.
yy73
, 
yym¥
[-2].
mšÜ
.yy73, 
Qu”y
::
OP_AND
, yym¥[0].mšÜ.yy73, "AND"); 
	`yy_de¡ruùÜ
(
yypP¬£r
,4,&yymsp[-1].minor);

2185 ià(!
yym¥
[-2].
mšÜ
.
yy73
 && (
¡©e
->
æags
 & 
Qu”yP¬£r
::
FLAG_PURE_NOT
)) {

2186 
yym¥
[-2].
mšÜ
.
yy73
 = 
Ãw
 
	`Qu”y
("", 1, 0);

2188 
	`BOOL_OP_TO_QUERY
(
yygÙomšÜ
.
yy73
, 
yym¥
[-2].
mšÜ
.yy73, 
Qu”y
::
OP_AND_NOT
, yymsp[0].minor.yy73, "NOT");

2189 
	`yy_de¡ruùÜ
(
yypP¬£r
,5,&
yym¥
[-1].
mšÜ
);

2195 { 
	`BOOL_OP_TO_QUERY
(
yygÙomšÜ
.
yy73
, 
yym¥
[-3].
mšÜ
.yy73, 
Qu”y
::
OP_AND_NOT
, yym¥[0].mšÜ.yy73, "AND NOT"); 
	`yy_de¡ruùÜ
(
yypP¬£r
,4,&yymsp[-2].minor);

2196 
	`yy_de¡ruùÜ
(
yypP¬£r
,5,&
yym¥
[-1].
mšÜ
);

2202 { 
	`BOOL_OP_TO_QUERY
(
yygÙomšÜ
.
yy73
, 
yym¥
[-3].
mšÜ
.yy73, 
Qu”y
::
OP_AND_NOT
, yym¥[0].mšÜ.yy73, "AND"); 
	`yy_de¡ruùÜ
(
yypP¬£r
,4,&yymsp[-2].minor);

2203 
	`yy_de¡ruùÜ
(
yypP¬£r
,10,&
yym¥
[-1].
mšÜ
);

2209 { 
	`BOOL_OP_TO_QUERY
(
yygÙomšÜ
.
yy73
, 
yym¥
[-2].
mšÜ
.yy73, 
Qu”y
::
OP_OR
, yym¥[0].mšÜ.yy73, "OR"); 
	`yy_de¡ruùÜ
(
yypP¬£r
,2,&yymsp[-1].minor);

2215 { 
	`BOOL_OP_TO_QUERY
(
yygÙomšÜ
.
yy73
, 
yym¥
[-2].
mšÜ
.yy73, 
Qu”y
::
OP_XOR
, yym¥[0].mšÜ.yy73, "XOR"); 
	`yy_de¡ruùÜ
(
yypP¬£r
,3,&yymsp[-1].minor);

2225 
yygÙomšÜ
.
yy73
 = 
NULL
;

2232 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy12
->
qu”y
;

2233 
yym¥
[0].
mšÜ
.
yy12
->
qu”y
 = 
NULL
;

2235 ià(
yym¥
[0].
mšÜ
.
yy12
->
love
) {

2236 ià(
yym¥
[0].
mšÜ
.
yy12
->
love
->
	`em±y
()) {

2238 
d–‘e
 
yygÙomšÜ
.
yy73
;

2239 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy12
->
love
;

2240 } ià(
yygÙomšÜ
.
yy73
) {

2241 
	`sw­
(
yygÙomšÜ
.
yy73
, 
yym¥
[0].
mšÜ
.
yy12
->
love
);

2242 
	`add_to_qu”y
(
yygÙomšÜ
.
yy73
, 
Qu”y
::
OP_AND_MAYBE
, 
yym¥
[0].
mšÜ
.
yy12
->
love
);

2244 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy12
->
love
;

2246 
yym¥
[0].
mšÜ
.
yy12
->
love
 = 
NULL
;

2249 ià(!
yym¥
[0].
mšÜ
.
yy12
->
f‹r
.
	`em±y
()) {

2250 ià(
yygÙomšÜ
.
yy73
) {

2251 
	`add_to_qu”y
(
yygÙomšÜ
.
yy73
, 
Qu”y
::
OP_FILTER
, 
yym¥
[0].
mšÜ
.
yy12
->
	`m”ge_f‹rs
());

2254 
yygÙomšÜ
.
yy73
 = 
Ãw
 
	`Qu”y
(
Qu”y
::
OP_SCALE_WEIGHT
, 
yym¥
[0].
mšÜ
.
yy12
->
	`m”ge_f‹rs
(), 0.0);

2258 ià(
yym¥
[0].
mšÜ
.
yy12
->
h©e
 && !yym¥[0].mšÜ.yy12->h©e->
	`em±y
()) {

2259 ià(!
yygÙomšÜ
.
yy73
) {

2261 
	`yy_·r£_çed
(
yypP¬£r
);

2264 *
yygÙomšÜ
.
yy73
 = 
	`Qu”y
(
Qu”y
::
OP_AND_NOT
, *yygÙomšÜ.yy73, *
yym¥
[0].
mšÜ
.
yy12
->
h©e
);

2267 
d–‘e
 
yym¥
[0].
mšÜ
.
yy12
;

2272 30: 
	`yy‹¡ÿ£
(
yyruËno
==30);

2273 32: 
	`yy‹¡ÿ£
(
yyruËno
==32);

2276 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.yy73;

2283 
Qu”y
 
¿nge
;

2284 
X­Ÿn
::
v®u’o
 
v®no
 = 
¡©e
->
	`v®ue_¿nge
(
¿nge
, 
yym¥
[-1].
mšÜ
.
yy0
, yymsp[0].minor.yy0);

2285 ià(
v®no
 =ğ
BAD_VALUENO
) {

2286 
	`yy_·r£_çed
(
yypP¬£r
);

2289 
yygÙomšÜ
.
yy12
 = 
Ãw
 
ProbQu”y
;

2290 
yygÙomšÜ
.
yy12
->
f‹r
[
	`f‹r_group_id
(
v®no
)] = 
¿nge
;

2297 
Qu”y
 
¿nge
;

2298 
X­Ÿn
::
v®u’o
 
v®no
 = 
¡©e
->
	`v®ue_¿nge
(
¿nge
, 
yym¥
[-1].
mšÜ
.
yy0
, yymsp[0].minor.yy0);

2299 ià(
v®no
 =ğ
BAD_VALUENO
) {

2300 
	`yy_·r£_çed
(
yypP¬£r
);

2303 
yygÙomšÜ
.
yy12
 = 
yym¥
[-2].
mšÜ
.yy12;

2304 
Qu”y
 & 
q
 = 
yygÙomšÜ
.
yy12
->
f‹r
[
	`f‹r_group_id
(
v®no
)];

2305 
q
 = 
	`Qu”y
(
Qu”y
::
OP_OR
, q, 
¿nge
);

2312 
yygÙomšÜ
.
yy12
 = 
Ãw
 
ProbQu”y
;

2313 
yygÙomšÜ
.
yy12
->
qu”y
 = 
yym¥
[-1].
mšÜ
.
yy73
;

2314 ià(
yym¥
[0].
mšÜ
.
yy73
) {

2315 
Qu”y
::
İ
 o°ğ
¡©e
->
	`deçuÉ_İ
();

2316 ià(
yygÙomšÜ
.
yy12
->
qu”y
 && (
İ
 =ğ
Qu”y
::
OP_NEAR
 || op == Query::OP_NEAR)) {

2320 
Qu”y
 * 
subqs
[2] = { 
yygÙomšÜ
.
yy12
->
qu”y
, 
yym¥
[0].
mšÜ
.
yy73
 };

2321 *(
yygÙomšÜ
.
yy12
->
qu”y
èğ
	`Qu”y
(
İ
, 
subqs
, subqs + 2, 11);

2322 
d–‘e
 
yym¥
[0].
mšÜ
.
yy73
;

2324 
	`add_to_qu”y
(
yygÙomšÜ
.
yy12
->
qu”y
, 
İ
, 
yym¥
[0].
mšÜ
.
yy73
);

2333 
yygÙomšÜ
.
yy12
 = 
yym¥
[-1].
mšÜ
.yy12;

2335 ià(
yym¥
[0].
mšÜ
.
yy73
è
	`add_to_qu”y
(
yygÙomšÜ
.
yy12
->
qu”y
, 
¡©e
->
	`deçuÉ_İ
(), yymsp[0].minor.yy73);

2342 
yygÙomšÜ
.
yy12
 = 
Ãw
 
ProbQu”y
;

2343 ià(
¡©e
->
	`deçuÉ_İ
(è=ğ
Qu”y
::
OP_AND
) {

2344 
yygÙomšÜ
.
yy12
->
qu”y
 = 
yym¥
[0].
mšÜ
.
yy73
;

2346 
yygÙomšÜ
.
yy12
->
love
 = 
yym¥
[0].
mšÜ
.
yy73
;

2348 
	`yy_de¡ruùÜ
(
yypP¬£r
,8,&
yym¥
[-1].
mšÜ
);

2355 
yygÙomšÜ
.
yy12
 = 
yym¥
[-2].
mšÜ
.yy12;

2356 ià(
¡©e
->
	`deçuÉ_İ
(è=ğ
Qu”y
::
OP_AND
) {

2360 
	`add_to_qu”y
(
yygÙomšÜ
.
yy12
->
qu”y
, 
Qu”y
::
OP_AND
, 
yym¥
[0].
mšÜ
.
yy73
);

2362 
	`add_to_qu”y
(
yygÙomšÜ
.
yy12
->
love
, 
Qu”y
::
OP_AND
, 
yym¥
[0].
mšÜ
.
yy73
);

2364 
	`yy_de¡ruùÜ
(
yypP¬£r
,8,&
yym¥
[-1].
mšÜ
);

2371 
yygÙomšÜ
.
yy12
 = 
Ãw
 
ProbQu”y
;

2372 
yygÙomšÜ
.
yy12
->
h©e
 = 
yym¥
[0].
mšÜ
.
yy73
;

2373 
	`yy_de¡ruùÜ
(
yypP¬£r
,9,&
yym¥
[-1].
mšÜ
);

2380 
yygÙomšÜ
.
yy12
 = 
yym¥
[-2].
mšÜ
.yy12;

2381 
	`add_to_qu”y
(
yygÙomšÜ
.
yy12
->
h©e
, 
Qu”y
::
OP_OR
, 
yym¥
[0].
mšÜ
.
yy73
);

2382 
	`yy_de¡ruùÜ
(
yypP¬£r
,9,&
yym¥
[-1].
mšÜ
);

2389 
yygÙomšÜ
.
yy12
 = 
Ãw
 
ProbQu”y
;

2390 
yygÙomšÜ
.
yy12
->
h©e
 = 
Ãw
 
	`Qu”y
(
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_qu”y
());

2391 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2392 
	`yy_de¡ruùÜ
(
yypP¬£r
,9,&
yym¥
[-1].
mšÜ
);

2399 
yygÙomšÜ
.
yy12
 = 
yym¥
[-2].
mšÜ
.yy12;

2400 
	`add_to_qu”y
(
yygÙomšÜ
.
yy12
->
h©e
, 
Qu”y
::
OP_OR
, 
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_qu”y
());

2401 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2402 
	`yy_de¡ruùÜ
(
yypP¬£r
,9,&
yym¥
[-1].
mšÜ
);

2409 
yygÙomšÜ
.
yy12
 = 
Ãw
 
ProbQu”y
;

2410 
yygÙomšÜ
.
yy12
->
f‹r
[
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_f‹r_group_id
()] = yym¥[0].mšÜ.yy0->
	`g‘_qu”y
();

2411 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2418 
yygÙomšÜ
.
yy12
 = 
yym¥
[-1].
mšÜ
.yy12;

2420 
Qu”y
 & 
q
 = 
yygÙomšÜ
.
yy12
->
f‹r
[
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_f‹r_group_id
()];

2421 
q
 = 
	`Qu”y
(
Qu”y
::
OP_OR
, q, 
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_qu”y
());

2422 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2430 
yygÙomšÜ
.
yy12
 = 
Ãw
 
ProbQu”y
;

2431 
yygÙomšÜ
.
yy12
->
f‹r
[
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_f‹r_group_id
()] = yym¥[0].mšÜ.yy0->
	`g‘_qu”y
();

2432 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2433 
	`yy_de¡ruùÜ
(
yypP¬£r
,8,&
yym¥
[-1].
mšÜ
);

2441 
yygÙomšÜ
.
yy12
 = 
yym¥
[-2].
mšÜ
.yy12;

2443 
Qu”y
 & 
q
 = 
yygÙomšÜ
.
yy12
->
f‹r
[
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_f‹r_group_id
()];

2444 
q
 = 
	`Qu”y
(
Qu”y
::
OP_OR
, q, 
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_qu”y
());

2445 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2446 
	`yy_de¡ruùÜ
(
yypP¬£r
,8,&
yym¥
[-1].
mšÜ
);

2452 { 
yygÙomšÜ
.
yy12
 = 
yym¥
[0].
mšÜ
.yy12; }

2458 
yygÙomšÜ
.
yy12
 = 
Ãw
 
ProbQu”y
;

2459 
yygÙomšÜ
.
yy12
->
qu”y
 = 
yym¥
[0].
mšÜ
.
yy73
;

2466 ià(
¡©e
->
	`is_¡İwÜd
(
yym¥
[0].
mšÜ
.
yy0
)) {

2467 
yygÙomšÜ
.
yy73
 = 
NULL
;

2468 
¡©e
->
	`add_to_¡İli¡
(
yym¥
[0].
mšÜ
.
yy0
);

2470 
yygÙomšÜ
.
yy73
 = 
Ãw
 
	`Qu”y
(
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_qu”y_w™h_auto_synÚyms
());

2472 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2479 
yygÙomšÜ
.
yy73
 = 
Ãw
 
	`Qu”y
(
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_qu”y_w™h_auto_synÚyms
());

2480 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2486 { 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy0
->
	`as_wdÿrded_qu”y
(
¡©e
); }

2491 { 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy0
->
	`as_·¹Ÿl_qu”y
(
¡©e
); }

2496 { 
yygÙomšÜ
.
yy73
 = 
yym¥
[-1].
mšÜ
.
yy27
->
	`as_ph¿£_qu”y
(); 
	`yy_de¡ruùÜ
(
yypP¬£r
,20,&yymsp[-2].minor);

2497 
	`yy_de¡ruùÜ
(
yypP¬£r
,20,&
yym¥
[0].
mšÜ
);

2503 { 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy27
->
	`as_ph¿£_qu”y
(); }

2509 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy76
->
	`as_group
(
¡©e
);

2515 { 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy27
->
	`as_Ã¬_qu”y
(); }

2520 { 
yygÙomšÜ
.
yy73
 = 
yym¥
[0].
mšÜ
.
yy27
->
	`as_adj_qu”y
(); }

2525 { 
yygÙomšÜ
.
yy73
 = 
yym¥
[-1].
mšÜ
.yy73; 
	`yy_de¡ruùÜ
(
yypP¬£r
,21,&yymsp[-2].minor);

2526 
	`yy_de¡ruùÜ
(
yypP¬£r
,22,&
yym¥
[0].
mšÜ
);

2533 
yygÙomšÜ
.
yy73
 = 
Ãw
 
	`Qu”y
(
yym¥
[0].
mšÜ
.
yy0
->
	`g‘_qu”y_w™h_synÚyms
());

2534 
d–‘e
 
yym¥
[0].
mšÜ
.
yy0
;

2535 
	`yy_de¡ruùÜ
(
yypP¬£r
,11,&
yym¥
[-1].
mšÜ
);

2542 
yygÙomšÜ
.
yy27
 = 
Ãw
 
T”mLi¡
;

2543 
yygÙomšÜ
.
yy27
->
	`add_pos™iÚ®_‹rm
(
yym¥
[0].
mšÜ
.
yy0
);

2548 45: 
	`yy‹¡ÿ£
(
yyruËno
==45);

2551 
yygÙomšÜ
.
yy27
 = 
yym¥
[-1].
mšÜ
.yy27;

2552 
yygÙomšÜ
.
yy27
->
	`add_pos™iÚ®_‹rm
(
yym¥
[0].
mšÜ
.
yy0
);

2559 
yygÙomšÜ
.
yy27
 = 
Ãw
 
T”mLi¡
;

2560 
yygÙomšÜ
.
yy27
->
	`add_pos™iÚ®_‹rm
(
yym¥
[-1].
mšÜ
.
yy0
);

2561 
yygÙomšÜ
.
yy27
->
	`add_pos™iÚ®_‹rm
(
yym¥
[0].
mšÜ
.
yy0
);

2568 
yygÙomšÜ
.
yy76
 = 
Ãw
 
T”mGroup
;

2569 
yygÙomšÜ
.
yy76
->
	`add_‹rm
(
yym¥
[-1].
mšÜ
.
yy0
);

2570 
yygÙomšÜ
.
yy76
->
	`add_‹rm
(
yym¥
[0].
mšÜ
.
yy0
);

2577 
yygÙomšÜ
.
yy76
 = 
yym¥
[-1].
mšÜ
.yy76;

2578 
yygÙomšÜ
.
yy76
->
	`add_‹rm
(
yym¥
[0].
mšÜ
.
yy0
);

2583 50: 
	`yy‹¡ÿ£
(
yyruËno
==50);

2586 
yygÙomšÜ
.
yy27
 = 
Ãw
 
T”mLi¡
;

2587 
yygÙomšÜ
.
yy27
->
	`add_pos™iÚ®_‹rm
(
yym¥
[-2].
mšÜ
.
yy0
);

2588 
yygÙomšÜ
.
yy27
->
	`add_pos™iÚ®_‹rm
(
yym¥
[0].
mšÜ
.
yy0
);

2589 ià(
yym¥
[-1].
mšÜ
.
yy0
) {

2590 
yygÙomšÜ
.
yy27
->
	`adju¡_wšdow
(
yym¥
[-1].
mšÜ
.
yy0
->
	`g‘_‹rmpos
());

2591 
d–‘e
 
yym¥
[-1].
mšÜ
.
yy0
;

2597 51: 
	`yy‹¡ÿ£
(
yyruËno
==51);

2600 
yygÙomšÜ
.
yy27
 = 
yym¥
[-2].
mšÜ
.yy27;

2601 
yygÙomšÜ
.
yy27
->
	`add_pos™iÚ®_‹rm
(
yym¥
[0].
mšÜ
.
yy0
);

2602 ià(
yym¥
[-1].
mšÜ
.
yy0
) {

2603 
yygÙomšÜ
.
yy27
->
	`adju¡_wšdow
(
yym¥
[-1].
mšÜ
.
yy0
->
	`g‘_‹rmpos
());

2604 
d–‘e
 
yym¥
[-1].
mšÜ
.
yy0
;

2612 
yygÙo
 = 
yyRuËInfo
[
yyruËno
].
lhs
;

2613 
yysize
 = 
yyRuËInfo
[
yyruËno
].
Ähs
;

2614 
yypP¬£r
->
yy¡ack
.
	`»size
(yypP¬£r->yy¡ack.
	`size
(è- 
yysize
);

2615 
yyaù
 = 
	`yy_fšd_»duû_aùiÚ
(
yypP¬£r
->
yy¡ack
.
	`back
().
¡©’o
,(
YYCODETYPE
)
yygÙo
);

2616 ifĞ
yyaù
 < 
YYNSTATE
 ){

2617 
	`yy_shiá
(
yypP¬£r
,
yyaù
,
yygÙo
,&
yygÙomšÜ
);

2619 
	`As£¹
Ğ
yyaù
 =ğ
YYNSTATE
 + 
YYNRULE
 + 1 );

2620 
	`yy_acû±
(
yypP¬£r
);

2622 
	}
}

2627 #iâdeà
YYNOERRORRECOVERY


2628 
	$yy_·r£_çed
(

2629 
yyP¬£r
 *
yypP¬£r


2631 
P¬£ARG_FETCH
;

2632 
	`LOGLINE
(
QUERYPARSER
, "Fail!");

2633  !
yypP¬£r
->
yy¡ack
.
	`em±y
(èè
	`yy_pİ_·r£r_¡ack
(yypParser);

2639 ià(!
¡©e
->
”rÜ
) state->error = "parseƒrror";

2641 
P¬£ARG_STORE
;

2642 
	}
}

2648 
	$yy_syÁax_”rÜ
(

2649 
yyP¬£r
 *
yypP¬£r
,

2650 
yymajÜ
,

2651 
YYMINORTYPE
 
yymšÜ


2653 
P¬£ARG_FETCH
;

2654 ()
yymajÜ
;

2655 ()
yymšÜ
;

2656 
	#TOKEN
 (
yymšÜ
.
yy0
)

	)

2659 
	`yy_·r£_çed
(
yypP¬£r
);

2661 
P¬£ARG_STORE
;

2662 
	}
}

2667 
	$yy_acû±
(

2668 
yyP¬£r
 *
yypP¬£r


2670 
P¬£ARG_FETCH
;

2671 
	`LOGLINE
(
QUERYPARSER
, "Accept!");

2672  !
yypP¬£r
->
yy¡ack
.
	`em±y
(èè
	`yy_pİ_·r£r_¡ack
(yypParser);

2675 
P¬£ARG_STORE
;

2676 
	}
}

2697 
	$P¬£
(

2698 
yyP¬£r
 *
yypP¬£r
,

2699 
yymajÜ
,

2700 
P¬£TOKENTYPE
 
yymšÜ


2701 
P¬£ARG_PDECL


2703 
YYMINORTYPE
 
yymšÜuniÚ
;

2704 
yyaù
;

2705 
yy’dofšput
;

2706 #ifdeà
YYERRORSYMBOL


2707 
yy”rÜh™
 = 0;

2711 ifĞ
yypP¬£r
->
yy¡ack
.
	`em±y
() ){

2712 
yypP¬£r
->
yy¡ack
.
	`push_back
(
	`yySckEÁry
());

2713 
yypP¬£r
->
yy”rút
 = -1;

2715 
yymšÜuniÚ
.
yy0
 = 
yymšÜ
;

2716 
yy’dofšput
 = (
yymajÜ
==0);

2717 
P¬£ARG_STORE
;

2719 
	`LOGLINE
(
QUERYPARSER
, "IÅuˆ" << 
	`P¬£Tok’Name
(
yymajÜ
) << " " <<

2720 (
yymšÜ
 ? yymšÜ->
Çme
 : "<<null>>"));

2723 
yyaù
 = 
	`yy_fšd_shiá_aùiÚ
(
yypP¬£r
,(
YYCODETYPE
)
yymajÜ
);

2724 ifĞ
yyaù
<
YYNSTATE
 ){

2725 
	`As£¹
Ğ!
yy’dofšput
 );

2726 
	`yy_shiá
(
yypP¬£r
,
yyaù
,
yymajÜ
,&
yymšÜuniÚ
);

2727 
yypP¬£r
->
yy”rút
--;

2728 
yymajÜ
 = 
YYNOCODE
;

2729 }ifĞ
yyaù
 < 
YYNSTATE
 + 
YYNRULE
 ){

2730 
	`yy_»duû
(
yypP¬£r
,
yyaù
-
YYNSTATE
);

2732 
	`As£¹
Ğ
yyaù
 =ğ
YY_ERROR_ACTION
 );

2733 #ifdeà
YYERRORSYMBOL


2734 
yymx
;

2736 
	`LOGLINE
(
QUERYPARSER
, "Syntax Error!");

2737 #ifdeà
YYERRORSYMBOL


2757 ifĞ
yypP¬£r
->
yy”rút
<0 ){

2758 
	`yy_syÁax_”rÜ
(
yypP¬£r
,
yymajÜ
,
yymšÜuniÚ
);

2760 
yymx
 = 
yypP¬£r
->
yy¡ack
.
	`back
().
majÜ
;

2761 ifĞ
yymx
==
YYERRORSYMBOL
 || 
yy”rÜh™
 ){

2762 
	`LOGLINE
(
QUERYPARSER
, "Disÿrd iÅuˆtok’ " << 
	`P¬£Tok’Name
(
yymajÜ
));

2763 
	`yy_de¡ruùÜ
(
yypP¬£r
, (
YYCODETYPE
)
yymajÜ
,&
yymšÜuniÚ
);

2764 
yymajÜ
 = 
YYNOCODE
;

2767 !
yypP¬£r
->
yy¡ack
.
	`em±y
() &&

2768 
yymx
 !ğ
YYERRORSYMBOL
 &&

2769 (
yyaù
 = 
	`yy_fšd_»duû_aùiÚ
(

2770 
yypP¬£r
->
yy¡ack
.
	`back
().
¡©’o
,

2771 
YYERRORSYMBOL
)è>ğ
YYNSTATE


2773 
	`yy_pİ_·r£r_¡ack
(
yypP¬£r
);

2775 ifĞ
yypP¬£r
->
yy¡ack
.
	`em±y
(è|| 
yymajÜ
==0 ){

2776 
	`yy_de¡ruùÜ
(
yypP¬£r
, (
YYCODETYPE
)
yymajÜ
,&
yymšÜuniÚ
);

2777 
	`yy_·r£_çed
(
yypP¬£r
);

2778 
yymajÜ
 = 
YYNOCODE
;

2779 }ifĞ
yymx
!=
YYERRORSYMBOL
 ){

2780 
YYMINORTYPE
 
u2
;

2781 
u2
.
YYERRSYMDT
 = 0;

2782 
	`yy_shiá
(
yypP¬£r
,
yyaù
,
YYERRORSYMBOL
,&
u2
);

2785 
yypP¬£r
->
yy”rút
 = 3;

2786 
yy”rÜh™
 = 1;

2787 #–ià
	`defšed
(
YYNOERRORRECOVERY
)

2795 
	`yy_syÁax_”rÜ
(
yypP¬£r
,
yymajÜ
,
yymšÜuniÚ
);

2796 
	`yy_de¡ruùÜ
(
yypP¬£r
,(
YYCODETYPE
)
yymajÜ
,&
yymšÜuniÚ
);

2797 
yymajÜ
 = 
YYNOCODE
;

2809 ifĞ
yypP¬£r
->
yy”rút
<=0 ){

2810 
	`yy_syÁax_”rÜ
(
yypP¬£r
,
yymajÜ
,
yymšÜuniÚ
);

2812 
yypP¬£r
->
yy”rút
 = 3;

2813 
	`yy_de¡ruùÜ
(
yypP¬£r
,(
YYCODETYPE
)
yymajÜ
,&
yymšÜuniÚ
);

2814 ifĞ
yy’dofšput
 ){

2815 
	`yy_·r£_çed
(
yypP¬£r
);

2817 
yymajÜ
 = 
YYNOCODE
;

2820 } 
yymajÜ
!=
YYNOCODE
 && !
yypP¬£r
->
yy¡ack
.
	`em±y
() );

2822 
	}
}

	@queryparser/queryparser_internal.h

22 #iâdeà
XAPIAN_INCLUDED_QUERYPARSER_INTERNAL_H


23 
	#XAPIAN_INCLUDED_QUERYPARSER_INTERNAL_H


	)

25 
	~<x­Ÿn/ba£.h
>

26 
	~<x­Ÿn/d©aba£.h
>

27 
	~<x­Ÿn/qu”y.h
>

28 
	~<x­Ÿn/qu”y·r£r.h
>

29 
	~<x­Ÿn/¡em.h
>

31 
	~<li¡
>

32 
	~<m­
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
şass
 
	gS‹
;

39 
	sP»fixInfo
 {

41 
boŞ
 
	mf‹r
;

44 
	mli¡
<
	m¡ršg
> 
	m´efixes
;

46 
P»fixInfo
(
boŞ
 
f‹r_
, cÚ¡ 
¡ršg
 & 
´efix
)

47 : 
f‹r
(
f‹r_
)

49 
´efixes
.
push_back
(
´efix
);

53 
Çme¥aû
 
	gX­Ÿn
 {

55 
şass
 
	gUtf8I‹¿tÜ
;

57 şas 
	cQu”yP¬£r
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

58 
ä›nd
 
şass
 
Qu”yP¬£r
;

59 
ä›nd
 
	gşass
 ::
S‹
;

60 
S‹m
 
	g¡emm”
;

61 
¡em_¡¿‹gy
 
	g¡em_aùiÚ
;

62 cÚ¡ 
Stİ³r
 * 
	g¡İ³r
;

63 
	gQu”y
::
İ
 
deçuÉ_İ
;

64 cÚ¡ * 
	g”rmsg
;

65 
D©aba£
 
	gdb
;

66 
	gli¡
<
	g¡ršg
> 
	g¡İli¡
;

67 
	gmuÉim­
<
	g¡ršg
, sŒšg> 
	gun¡em
;

71 
	gm­
<
	g¡ršg
, 
	gP»fixInfo
> 
	g´efixm­
;

73 
	gli¡
<
	gV®ueRªgeProûssÜ
 *> 
	gv®¿ng•rocs
;

75 
¡ršg
 
	gcÜ»ùed_qu”y
;

77 
add_´efix
(cÚ¡ 
¡ršg
 &
f›ld
, cÚ¡ sŒšg &
´efix
, 
boŞ
 
f‹r
);

79 
	g¡d
::
¡ršg
 
·r£_‹rm
(
Utf8I‹¿tÜ
 &
™
, cÚ¡ Utf8I‹¿tÜ &
’d
,

80 
boŞ
 &
was_aüÚym
);

82 
	gpublic
:

83 
IÁ”Çl
(è: 
¡em_aùiÚ
(
STEM_NONE
), 
¡İ³r
(
NULL
),

84 
deçuÉ_İ
(
Qu”y
::
OP_OR
), 
”rmsg
(
NULL
) { }

85 
Qu”y
 
·r£_qu”y
(cÚ¡ 
¡ršg
 & 
qu”y_¡ršg
, 
æags
, cÚ¡ sŒšg & 
deçuÉ_´efix
);

	@queryparser/queryparser_token.h

1 
	#ERROR
 1

	)

2 
	#OR
 2

	)

3 
	#XOR
 3

	)

4 
	#AND
 4

	)

5 
	#NOT
 5

	)

6 
	#NEAR
 6

	)

7 
	#ADJ
 7

	)

8 
	#LOVE
 8

	)

9 
	#HATE
 9

	)

10 
	#HATE_AFTER_AND
 10

	)

11 
	#SYNONYM
 11

	)

12 
	#TERM
 12

	)

13 
	#GROUP_TERM
 13

	)

14 
	#PHR_TERM
 14

	)

15 
	#WILD_TERM
 15

	)

16 
	#PARTIAL_TERM
 16

	)

17 
	#BOOLEAN_FILTER
 17

	)

18 
	#RANGE_START
 18

	)

19 
	#RANGE_END
 19

	)

20 
	#QUOTE
 20

	)

21 
	#BRA
 21

	)

22 
	#KET
 22

	)

	@queryparser/termgenerator.cc

21 
	~<cÚfig.h
>

23 
	~<x­Ÿn/‹rmg’”©Ü.h
>

24 
	~<x­Ÿn/ty³s.h
>

25 
	~<x­Ÿn/unicode.h
>

27 
	~"‹rmg’”©Ü_š‹º®.h
"

29 
	~"uts.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

32 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

34 
	gT”mG’”©Ü
::
	$T”mG’”©Ü
(cÚ¡ 
T”mG’”©Ü
 & 
o
è: 
	$š‹º®
(
o
.
š‹º®
è{ 
	}
}

36 
T”mG’”©Ü
 &

37 
T”mG’”©Ü
::
İ”©Ü
=(cÚ¡ T”mG’”©Ü & 
o
) {

38 
š‹º®
 = 
o
.internal;

39  *
	gthis
;

42 
	gT”mG’”©Ü
::
	$T”mG’”©Ü
(è: 
	`š‹º®
(
Ãw
 
T”mG’”©Ü
::
IÁ”Çl
è{ 
	}
}

44 
T”mG’”©Ü
::~
	$T”mG’”©Ü
(è{ 
	}
}

47 
T”mG’”©Ü
::
£t_¡emm”
(cÚ¡ 
X­Ÿn
::
S‹m
 & 
¡emm”
)

49 
š‹º®
->
¡emm”
 = stemmer;

53 
	gT”mG’”©Ü
::
£t_¡İ³r
(cÚ¡ 
X­Ÿn
::
Stİ³r
 * 
¡İ³r
)

55 
š‹º®
->
¡İ³r
 = stopper;

59 
	gT”mG’”©Ü
::
£t_docum’t
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
)

61 
š‹º®
->
doc
 = doc;

62 
	gš‹º®
->
	g‹rmpos
 = 0;

65 cÚ¡ 
	gX­Ÿn
::
Docum’t
 &

66 
T”mG’”©Ü
::
	$g‘_docum’t
() const

68  
š‹º®
->
doc
;

69 
	}
}

72 
	gT”mG’”©Ü
::
£t_d©aba£
(cÚ¡ 
X­Ÿn
::
Wr™abËD©aba£
 &
db
)

74 
š‹º®
->
db
 = db;

77 
	gT”mG’”©Ü
::
æags


78 
T”mG’”©Ü
::
	$£t_æags
(
æags
 
toggË
, fÏg 
mask
)

80 
T”mG’”©Ü
::
æags
 
Şd_æags
 = 
š‹º®
->flags;

81 
š‹º®
->
æags
 = 
	`æags
((
Şd_æags
 & 
mask
è^ 
toggË
);

82  
Şd_æags
;

83 
	}
}

86 
	gT”mG’”©Ü
::
šdex_‹xt
(cÚ¡ 
X­Ÿn
::
Utf8I‹¿tÜ
 & 
™Ü
,

87 
X­Ÿn
::
‹rmcouÁ
 
weight
,

88 cÚ¡ 
¡ršg
 & 
´efix
)

90 
	gš‹º®
->
šdex_‹xt
(
™Ü
, 
weight
, 
´efix
, 
Œue
);

94 
	gT”mG’”©Ü
::
šdex_‹xt_w™hout_pos™iÚs
(cÚ¡ 
X­Ÿn
::
Utf8I‹¿tÜ
 & 
™Ü
,

95 
X­Ÿn
::
‹rmcouÁ
 
weight
,

96 cÚ¡ 
¡ršg
 & 
´efix
)

98 
	gš‹º®
->
šdex_‹xt
(
™Ü
, 
weight
, 
´efix
, 
çl£
);

102 
	gT”mG’”©Ü
::
šü—£_‹rmpos
(
X­Ÿn
::
‹rmcouÁ
 
d–
)

104 
š‹º®
->
‹rmpos
 +ğ
d–
;

107 
	gX­Ÿn
::
‹rmcouÁ


108 
T”mG’”©Ü
::
	$g‘_‹rmpos
() const

110  
š‹º®
->
‹rmpos
;

111 
	}
}

114 
	gT”mG’”©Ü
::
£t_‹rmpos
(
X­Ÿn
::
‹rmcouÁ
 
‹rmpos
)

116 
š‹º®
->
‹rmpos
 =ermpos;

119 
¡ršg


120 
	gT”mG’”©Ü
::
	$g‘_desütiÚ
() const

122 
¡ršg
 
	`s
("Xapian::TermGenerator(");

123 ià(
š‹º®
.
	`g‘
()) {

124 
s
 += "stem=";

125 
s
 +ğ
š‹º®
->
¡emm”
.
	`g‘_desütiÚ
();

126 ià(
š‹º®
->
¡İ³r
) {

127 
s
 += ", stopper set";

129 
s
 += ", doc=";

130 
s
 +ğ
š‹º®
->
doc
.
	`g‘_desütiÚ
();

131 
s
 += ",ermpos=";

132 
s
 +ğ
	`om_to¡ršg
(
š‹º®
->
‹rmpos
);

134 
s
 += ")";

135  
s
;

136 
	}
}

	@queryparser/termgenerator_internal.cc

21 
	~<cÚfig.h
>

23 
	~"‹rmg’”©Ü_š‹º®.h
"

25 
	~<x­Ÿn/docum’t.h
>

26 
	~<x­Ÿn/qu”y·r£r.h
>

27 
	~<x­Ÿn/unicode.h
>

29 
	~"¡ršguts.h
"

31 
	~<¡ršg
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
Çme¥aû
 
	gX­Ÿn
 {

39 cÚ¡ 
	gMAX_PROB_TERM_LENGTH
 = 64;

45 
šlše
 
boŞ


46 
U_isuµ”
(
ch
) {

47  (
	gch
 < 128 && 
C_isuµ”
(()
ch
));

50 
šlše
 
check_wÜdch¬
(
ch
) {

51 ià(
	gUnicode
::
is_wÜdch¬
(
ch
)è 
Unicode
::
tŞow”
(ch);

55 
šlše
 
boŞ


56 
should_¡em
(cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
)

58 cÚ¡ 
SHOULD_STEM_MASK
 =

59 (1 << 
Unicode
::
LOWERCASE_LETTER
) |

60 (1 << 
Unicode
::
TITLECASE_LETTER
) |

61 (1 << 
Unicode
::
MODIFIER_LETTER
) |

62 (1 << 
Unicode
::
OTHER_LETTER
);

63 
Utf8I‹¿tÜ
 
u
(
‹rm
);

64  ((
	gSHOULD_STEM_MASK
 >> 
	gUnicode
::
g‘_ÿ‹gÜy
(*
u
)) & 1);

70 cÚ¡ 
UNICODE_IGNORE
(-1);

72 
šlše
 
check_šfix
(
ch
) {

73 ià(
	gch
 =ğ'\'' || 
ch
 == '&' || ch == 0xb7 || ch == 0x5f4 || ch == 0x2027) {

78  
ch
;

82 ià(
	gch
 =ğ0x2019 || 
ch
 == 0x201b)  '\'';

83 ià(
	gch
 >ğ0x200b && (
ch
 <= 0x200d || ch == 0x2060 || ch == 0xfeff))

84  
UNICODE_IGNORE
;

88 
šlše
 
check_šfix_dig™
(
ch
) {

90 
	gch
) {

102  
ch
;

104 ià(
	gch
 >ğ0x200b && (
ch
 <= 0x200d || ch == 0x2060 || ch == 0xfeff))

105  
UNICODE_IGNORE
;

109 
šlše
 
boŞ


110 
is_dig™
(
ch
) {

111  (
	gUnicode
::
g‘_ÿ‹gÜy
(
ch
è=ğ
Unicode
::
DECIMAL_DIGIT_NUMBER
);

114 
šlše
 
check_suffix
(
ch
) {

115 ià(
	gch
 =ğ'+' || 
ch
 == '#')  ch;

121 
	#STOPWORDS_NONE
 0

	)

122 
	#STOPWORDS_IGNORE
 1

	)

123 
	#STOPWORDS_INDEX_UNSTEMMED_ONLY
 2

	)

126 
	gT”mG’”©Ü
::
IÁ”Çl
::
šdex_‹xt
(
Utf8I‹¿tÜ
 
™Ü
, 
‹rmcouÁ
 
weight
,

127 cÚ¡ 
¡ršg
 & 
´efix
, 
boŞ
 
w™h_pos™iÚs
)

129 
DEBUGCALL
(
DB
, , "TermGenerator::Internal::index_text", "");

130 
	g¡İ_mode
 = 
STOPWORDS_INDEX_UNSTEMMED_ONLY
;

132 ià(!
	g¡İ³r
è
	g¡İ_mode
 = 
STOPWORDS_NONE
;

134 
	gŒue
) {

136 
	gch
;

137 
	gŒue
) {

138 ià(
	g™Ü
 =ğ
Utf8I‹¿tÜ
()) ;

139 
	gch
 = 
check_wÜdch¬
(*
™Ü
);

140 ià(
	gch
) ;

141 ++
	g™Ü
;

144 
¡ršg
 
	g‹rm
;

147 ià(
U_isuµ”
(*
™Ü
)) {

148 cÚ¡ 
Utf8I‹¿tÜ
 
	g’d
;

149 
Utf8I‹¿tÜ
 
	gp
 = 
™Ü
;

151 
	gUnicode
::
­³nd_utf8
(
‹rm
, 
Unicode
::
tŞow”
(*
p
++));

152 } 
	gp
 !ğ
’d
 && *
p
 =ğ'.' && ++°!ğ’d && 
U_isuµ”
(*p));

155 ià(
	g‹rm
.
size
() > 1) {

158 ià(
	gp
 =ğ
’d
 || !
Unicode
::
is_wÜdch¬
(*
p
)) {

159 
™Ü
 = 
p
;

160 
	g’doá”m
;

163 
	g‹rm
.
»size
(0);

166 
	gŒue
) {

167 
	g´evch
;

169 
	gUnicode
::
­³nd_utf8
(
‹rm
, 
ch
);

170 
	g´evch
 = 
ch
;

171 ià(++
	g™Ü
 =ğ
Utf8I‹¿tÜ
()è
’doá”m
;

172 
	gch
 = 
check_wÜdch¬
(*
™Ü
);

173 } 
	gch
);

175 
Utf8I‹¿tÜ
 
Ãxt
(
™Ü
);

176 ++
	gÃxt
;

177 ià(
	gÃxt
 =ğ
Utf8I‹¿tÜ
()) ;

178 
	gÃxtch
 = 
check_wÜdch¬
(*
Ãxt
);

179 ià(!
	gÃxtch
) ;

180 
	gšfix_ch
 = *
™Ü
;

181 ià(
is_dig™
(
´evch
è&& is_dig™(*
Ãxt
)) {

182 
	gšfix_ch
 = 
check_šfix_dig™
(
šfix_ch
);

185 
	gšfix_ch
 = 
check_šfix
(
šfix_ch
);

187 ià(!
	gšfix_ch
) ;

188 ià(
	gšfix_ch
 !ğ
UNICODE_IGNORE
)

189 
Unicode
::
­³nd_utf8
(
‹rm
, 
šfix_ch
);

190 
	gch
 = 
Ãxtch
;

191 
	g™Ü
 = 
Ãxt
;

195 
size_t
 
	gËn
 = 
‹rm
.
size
();

196 
	gcouÁ
 = 0;

197 (
	gch
 = 
check_suffix
(*
™Ü
))) {

198 ià(++
couÁ
 > 3) {

199 
‹rm
.
»size
(
Ën
);

202 
	gUnicode
::
­³nd_utf8
(
‹rm
, 
ch
);

203 ià(++
	g™Ü
 =ğ
Utf8I‹¿tÜ
()è
’doá”m
;

206 ià(
	gUnicode
::
is_wÜdch¬
(*
™Ü
))

207 
‹rm
.
»size
(
Ën
);

210 
	g’doá”m
:

211 
LOGLINE
(
DB
, "‹rm is: " << 
‹rm
);

212 ià(
	g‹rm
.
size
(è> 
	gMAX_PROB_TERM_LENGTH
) ;

214 ià(
	g¡İ_mode
 =ğ
STOPWORDS_IGNORE
 && (*
¡İ³r
)(
‹rm
)) ;

216 ià(
	gw™h_pos™iÚs
) {

217 
LOGLINE
(
DB
, "addermo…ost†ist");

218 
	gdoc
.
add_po¡šg
(
´efix
 + 
‹rm
, ++
‹rmpos
, 
weight
);

220 
LOGLINE
(
DB
, "addermoerm†ist");

221 
	gdoc
.
add_‹rm
(
´efix
 + 
‹rm
, 
weight
);

223 ià((
	gæags
 & 
	gFLAG_SPELLING
è&& 
	g´efix
.
em±y
()è
	gdb
.
add_¥–lšg
(
‹rm
);

225 ià(!
	g¡emm”
.
	gš‹º®
.
g‘
()) ;

227 ià(
	g¡İ_mode
 =ğ
STOPWORDS_INDEX_UNSTEMMED_ONLY
 && (*
¡İ³r
)(
‹rm
))

232 ià(!
should_¡em
(
‹rm
)) ;

235 
¡ršg
 
¡em
("Z");

236 
	g¡em
 +ğ
´efix
;

237 
	g¡em
 +ğ
¡emm”
(
‹rm
);

238 
LOGLINE
(
DB
, "Add s‹m: " << 
¡em
 << "o doc");

239 
	gdoc
.
add_‹rm
(
¡em
, 
weight
);

	@queryparser/termgenerator_internal.h

21 #iâdeà
XAPIAN_INCLUDED_TERMGENERATOR_INTERNAL_H


22 
	#XAPIAN_INCLUDED_TERMGENERATOR_INTERNAL_H


	)

24 
	~<x­Ÿn/ba£.h
>

25 
	~<x­Ÿn/d©aba£.h
>

26 
	~<x­Ÿn/docum’t.h
>

27 
	~<x­Ÿn/‹rmg’”©Ü.h
>

28 
	~<x­Ÿn/¡em.h
>

30 
Çme¥aû
 
	gX­Ÿn
 {

32 
şass
 
	gStİ³r
;

34 şas 
	cT”mG’”©Ü
::
IÁ”Çl
 : 
public
 
X­Ÿn
::IÁ”Çl::
RefCÁBa£
 {

35 
ä›nd
 
şass
 
T”mG’”©Ü
;

36 
S‹m
 
	g¡emm”
;

37 cÚ¡ 
Stİ³r
 * 
	g¡İ³r
;

38 
Docum’t
 
	gdoc
;

39 
‹rmcouÁ
 
	g‹rmpos
;

40 
	gT”mG’”©Ü
::
æags
 flags;

41 
Wr™abËD©aba£
 
	gdb
;

43 
	gpublic
:

44 
IÁ”Çl
(è: 
¡İ³r
(
NULL
), 
‹rmpos
(0),

45 
æags
(
T”mG’”©Ü
::flags(0)) { }

46 
šdex_‹xt
(
Utf8I‹¿tÜ
 
™Ü
,

47 
‹rmcouÁ
 
weight
,

48 cÚ¡ 
¡d
::
¡ršg
 & 
´efix
,

49 
boŞ
 
w™h_pos™iÚs
);

	@tests/api_all.h

2 
	~"­i_ªydb.h
"

3 
	~"­i_back’d.h
"

4 
	~"­i_şo£db.h
"

5 
	~"­i_cŞÏp£.h
"

6 
	~"­i_com·ù.h
"

7 
	~"­i_db.h
"

8 
	~"­i_g’”©ed.h
"

9 
	~"­i_m©ch¥y.h
"

10 
	~"­i_m‘ad©a.h
"

11 
	~"­i_nodb.h
"

12 
	~"­i_nÚe.h
"

13 
	~"­i_İsynÚym.h
"

14 
	~"­i_³rûÁages.h
"

15 
	~"­i_posdb.h
"

16 
	~"­i_po¡šgsourû.h
"

17 
	~"­i_qpback’d.h
"

18 
	~"­i_qu”y.h
"

19 
	~"­i_»¶aûdoc.h
"

20 
	~"­i_»¶iÿ‹.h
"

21 
	~"­i_sÿÏb™y.h
"

22 
	~"­i_£rŸli£.h
"

23 
	~"­i_sÜtšg.h
"

24 
	~"­i_sÜtšgŞd.h
"

25 
	~"­i_¥–lšg.h
"

26 
	~"­i_Œªsdb.h
"

27 
	~"­i_unicode.h
"

28 
	~"­i_v®ue¡©s.h
"

29 
	~"­i_v®ue¡»am.h
"

30 
	~"­i_wrdb.h
"

	@tests/api_anydb.cc

24 
	~<cÚfig.h
>

26 
	~"­i_ªydb.h
"

28 
	~<®gÜ™hm
>

29 
	~<¡ršg
>

31 
	~<x­Ÿn.h
>

32 
	~"back’dmªag”_loÿl.h
"

33 
	~"‹¡su™e.h
"

34 
	~"‹¡uts.h
"

35 
	~"uts.h
"

37 
	~"­™e¡.h
"

39 
	~<li¡
>

41 
usšg
 
Çme¥aû
 
	g¡d
;

44 
´št_m£t_weights
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t
)

46 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t
.
begš
();

47  ; 
	gi
 !ğ
m£t
.
’d
(); ++i) {

48 
	gtout
 << " " << 
	gi
.
g‘_weight
();

53 
´št_m£t_³rûÁages
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t
)

55 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t
.
begš
();

56  ; 
	gi
 !ğ
m£t
.
’d
(); ++i) {

57 
	gtout
 << " " << 
	gm£t
.
cÚv”t_to_³rûÁ
(
i
);

61 
	gX­Ÿn
::
Qu”y


62 
qu”y
(
X­Ÿn
::
Qu”y
::
İ
 op,

63 cÚ¡ 
¡ršg
 & 
t1
 = sŒšg(), cÚ¡ sŒšg & 
t2
 = string(),

64 cÚ¡ 
¡ršg
 & 
t3
 = sŒšg(), cÚ¡ sŒšg & 
t4
 = string(),

65 cÚ¡ 
¡ršg
 & 
t5
 = sŒšg(), cÚ¡ sŒšg & 
t6
 = string(),

66 cÚ¡ 
¡ršg
 & 
t7
 = sŒšg(), cÚ¡ sŒšg & 
t8
 = string(),

67 cÚ¡ 
¡ršg
 & 
t9
 = sŒšg(), cÚ¡ sŒšg & 
t10
 = 
	$¡ršg
())

69 
veùÜ
<
¡ršg
> 
v
;

70 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

71 ià(!
t1
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t1));

72 ià(!
t2
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t2));

73 ià(!
t3
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t3));

74 ià(!
t4
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t4));

75 ià(!
t5
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t5));

76 ià(!
t6
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t6));

77 ià(!
t7
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t7));

78 ià(!
t8
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t8));

79 ià(!
t9
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t9));

80 ià(!
t10
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t10));

81  
X­Ÿn
::
	`Qu”y
(
İ
, 
v
.
	`begš
(), v.
	`’d
());

82 
	}
}

84 
	gX­Ÿn
::
Qu”y


85 
qu”y
(
X­Ÿn
::
Qu”y
::
İ
 op, X­Ÿn::
‹rmcouÁ
 
·¿m‘”
,

86 cÚ¡ 
¡ršg
 & 
t1
 = sŒšg(), cÚ¡ sŒšg & 
t2
 = string(),

87 cÚ¡ 
¡ršg
 & 
t3
 = sŒšg(), cÚ¡ sŒšg & 
t4
 = string(),

88 cÚ¡ 
¡ršg
 & 
t5
 = sŒšg(), cÚ¡ sŒšg & 
t6
 = string(),

89 cÚ¡ 
¡ršg
 & 
t7
 = sŒšg(), cÚ¡ sŒšg & 
t8
 = string(),

90 cÚ¡ 
¡ršg
 & 
t9
 = sŒšg(), cÚ¡ sŒšg & 
t10
 = 
	$¡ršg
())

92 
veùÜ
<
¡ršg
> 
v
;

93 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

94 ià(!
t1
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t1));

95 ià(!
t2
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t2));

96 ià(!
t3
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t3));

97 ià(!
t4
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t4));

98 ià(!
t5
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t5));

99 ià(!
t6
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t6));

100 ià(!
t7
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t7));

101 ià(!
t8
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t8));

102 ià(!
t9
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t9));

103 ià(!
t10
.
	`em±y
()è
v
.
	`push_back
(
	`¡emm”
(t10));

104  
X­Ÿn
::
	`Qu”y
(
İ
, 
v
.
	`begš
(), v.
	`’d
(), 
·¿m‘”
);

105 
	}
}

107 
	gX­Ÿn
::
Qu”y


108 
	$qu”y
(cÚ¡ 
¡ršg
 &
t
)

110  
X­Ÿn
::
	`Qu”y
(X­Ÿn::
	`S‹m
("’glish")(
t
));

111 
	}
}

117 
	$DEFINE_TESTCASE
(
z”odocid1
, 
back’d
) {

121 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_onedoc"));

123 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

126 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word"));

129 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

133 
	`TEST_MSET_SIZE
(
mym£t
, 1);

135 
	`TEST_AND_EXPLAIN
(*(
mym£t
.
	`begš
()) != 0,

138  
Œue
;

139 
	}
}

142 
	$DEFINE_TESTCASE
(
em±yqu”y1
, 
back’d
) {

143 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

145 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
());

146 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

147 
	`TEST_MSET_SIZE
(
mym£t
, 0);

148 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 0);

149 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 0);

150 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 0);

151 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 0);

152 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 0);

153 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 0);

155 
veùÜ
<
X­Ÿn
::
Qu”y
> 
v
;

156 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
, 
v
.
	`begš
(), v.
	`’d
()));

157 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

158 
	`TEST_MSET_SIZE
(
mym£t
, 0);

159 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 0);

160 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 0);

161 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 0);

162 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 0);

163 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 0);

164 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 0);

166  
Œue
;

167 
	}
}

170 
	$DEFINE_TESTCASE
(
sim¶equ”y1
, 
back’d
) {

171 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

172 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word"));

173 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

174 
	`TEST_MSET_SIZE
(
mym£t
, 2);

175  
Œue
;

176 
	}
}

179 
	$DEFINE_TESTCASE
(
sim¶equ”y2
, 
back’d
) {

182 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
("apitest_simpledata");

183 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

184 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word"));

187 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

191 
	`m£t_ex³ù_Üd”
(
mym£t
, 2, 4);

194 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

196 
	`TEST_EQUAL_DOUBLE
(
i
.
	`g‘_weight
(), 1.04648168717725);

197 
i
++;

198 
	`TEST_EQUAL_DOUBLE
(
i
.
	`g‘_weight
(), 0.640987686595914);

200  
Œue
;

201 
	}
}

204 
	$DEFINE_TESTCASE
(
sim¶equ”y3
, 
back’d
) {

205 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

206 
’quœe
.
	`£t_qu”y
(
	`qu”y
("this"));

207 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

210 
	`TEST_MSET_SIZE
(
mym£t
, 6);

212  
Œue
;

213 
	}
}

217 
	$DEFINE_TESTCASE
(
wdqu”y1
, 
back’d
) {

218 
X­Ÿn
::
Qu”yP¬£r
 
qu”y·r£r
;

219 
æags
 = 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
 |

220 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_LOVEHATE
;

221 
qu”y·r£r
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

222 
qu”y·r£r
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_ALL
);

223 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
("apitest_simpledata");

224 
qu”y·r£r
.
	`£t_d©aba£
(
db
);

225 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

227 
X­Ÿn
::
Qu”y
 
qobj
 = 
qu”y·r£r
.
	`·r£_qu”y
("th*", 
æags
);

228 
tout
 << 
qobj
.
	`g‘_desütiÚ
(è<< 
’dl
;

229 
’quœe
.
	`£t_qu”y
(
qobj
);

230 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

232 
	`TEST_MSET_SIZE
(
mym£t
, 6);

234 
qobj
 = 
qu”y·r£r
.
	`·r£_qu”y
("nÙšdb* \"this\"", 
æags
);

235 
tout
 << 
qobj
.
	`g‘_desütiÚ
(è<< 
’dl
;

236 
’quœe
.
	`£t_qu”y
(
qobj
);

237 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

239 
	`TEST_MSET_SIZE
(
mym£t
, 6);

241 
qobj
 = 
qu”y·r£r
.
	`·r£_qu”y
("+nÙšdb* \"this\"", 
æags
);

242 
tout
 << 
qobj
.
	`g‘_desütiÚ
(è<< 
’dl
;

243 
’quœe
.
	`£t_qu”y
(
qobj
);

244 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

246 
	`TEST_MSET_SIZE
(
mym£t
, 0);

248  
Œue
;

249 
	}
}

252 
	$DEFINE_TESTCASE
(
muÉidb1
, 
back’d
) {

253 
X­Ÿn
::
D©aba£
 
	`mydb1
(
	`g‘_d©aba£
("apitest_simpledata", "apitest_simpledata2"));

254 
X­Ÿn
::
Enquœe
 
	`’quœe1
(
mydb1
);

256 
X­Ÿn
::
D©aba£
 
	`mydb2
(
	`g‘_d©aba£
("apitest_simpledata"));

257 
mydb2
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata2"));

258 
X­Ÿn
::
Enquœe
 
	`’quœe2
(
mydb2
);

261 
X­Ÿn
::
Qu”y
 
	`myqu”y
("word");

262 
’quœe1
.
	`£t_qu”y
(
myqu”y
);

263 
’quœe2
.
	`£t_qu”y
(
myqu”y
);

267 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe1
.
	`g‘_m£t
(0, 10);

268 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe2
.
	`g‘_m£t
(0, 10);

270 
	`TEST_EQUAL
(
mym£t1
.
	`size
(), 
mym£t2
.size());

271 
	`TEST
(
	`m£t_¿nge_is_§me_weights
(
mym£t1
, 0, 
mym£t2
, 0, mym£t1.
	`size
()));

272  
Œue
;

273 
	}
}

277 
DEFINE_TESTCASE
(
muÉidb2
, 
back’d
 && !
muÉi
) {

278 
	gX­Ÿn
::
D©aba£
 
mydb1
(
g‘_d©aba£
("apitest_simpledata",

280 
	gX­Ÿn
::
Enquœe
 
’quœe1
(
mydb1
);

282 
	gX­Ÿn
::
D©aba£
 
mydb2
(
g‘_d©aba£
("apitest_simpledata"));

283 
	gmydb2
.
add_d©aba£
(
g‘_d©aba£
("apitest_simpledata2"));

284 
	gX­Ÿn
::
Enquœe
 
’quœe2
(
mydb2
);

287 
	gX­Ÿn
::
Qu”y
 
myqu”y
 = 
qu”y
(
X­Ÿn
::Qu”y::
OP_OR
, "inmemory", "word");

288 
	g’quœe1
.
£t_qu”y
(
myqu”y
);

289 
	g’quœe2
.
£t_qu”y
(
myqu”y
);

293 
	gX­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe1
.
g‘_m£t
(0, 10);

294 
	gX­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe2
.
g‘_m£t
(0, 10);

296 
TEST_EQUAL
(
mym£t1
.
size
(), 
mym£t2
.size());

297 
TEST
(
m£t_¿nge_is_§me_weights
(
mym£t1
, 0, 
mym£t2
, 0, mym£t1.
size
()));

298  
	gŒue
;

302 
DEFINE_TESTCASE
(
muÉidb3
, 
back’d
 && !
muÉi
) {

303 
	gX­Ÿn
::
D©aba£
 
mydb2
(
g‘_d©aba£
("apitest_simpledata"));

304 
	gmydb2
.
add_d©aba£
(
g‘_d©aba£
("apitest_simpledata2"));

305 
	gX­Ÿn
::
Enquœe
 
’quœe
(
mydb2
);

308 
	gX­Ÿn
::
Qu”y
 
myqu”y
 = 
qu”y
(
X­Ÿn
::Qu”y::
OP_OR
, "inmemory", "word");

309 
	g’quœe
.
£t_weightšg_scheme
(
X­Ÿn
::
BoŞWeight
());

310 
	g’quœe
.
£t_qu”y
(
myqu”y
);

313 
	gX­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
g‘_m£t
(0, 10);

314 
m£t_ex³ù_Üd”
(
mym£t
, 2, 3, 7);

316  
	gŒue
;

320 
DEFINE_TESTCASE
(
muÉidb4
, 
back’d
 && !
muÉi
) {

321 
	gX­Ÿn
::
D©aba£
 
mydb2
(
g‘_d©aba£
("apitest_simpledata"));

322 
	gmydb2
.
add_d©aba£
(
g‘_d©aba£
("apitest_simpledata2"));

323 
	gmydb2
.
add_d©aba£
(
g‘_d©aba£
("apitest_termorder"));

324 
	gX­Ÿn
::
Enquœe
 
’quœe
(
mydb2
);

327 
	gX­Ÿn
::
Qu”y
 
myqu”y
 = 
qu”y
(
X­Ÿn
::Qu”y::
OP_OR
, "inmemory", "word");

328 
	g’quœe
.
£t_weightšg_scheme
(
X­Ÿn
::
BoŞWeight
());

329 
	g’quœe
.
£t_qu”y
(
myqu”y
);

332 
	gX­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
g‘_m£t
(0, 10);

333 
m£t_ex³ù_Üd”
(
mym£t
, 2, 3, 4, 10);

335  
	gŒue
;

339 
DEFINE_TESTCASE
(
muÉidb5
, 
back’d
 && !
muÉi
) {

340 
	gX­Ÿn
::
D©aba£
 
mydb2
(
g‘_d©aba£
("apitest_simpledata"));

341 
	gmydb2
.
add_d©aba£
(
g‘_d©aba£
("apitest_simpledata2"));

342 
	gX­Ÿn
::
Enquœe
 
’quœe
(
mydb2
);

345 
	gX­Ÿn
::
Qu”y
 
myqu”y
 = 
qu”y
(
X­Ÿn
::Qu”y::
OP_AND
, "inmemory", "word");

346 
	g’quœe
.
£t_weightšg_scheme
(
X­Ÿn
::
BoŞWeight
());

347 
	g’quœe
.
£t_qu”y
(
myqu”y
);

350 
	gX­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
g‘_m£t
(0, 10);

351 
m£t_ex³ù_Üd”
(
mym£t
, 2);

353  
	gŒue
;

358 
	$DEFINE_TESTCASE
(
m£tmax™ems1
, 
back’d
) {

359 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

360 
’quœe
.
	`£t_qu”y
(
	`qu”y
("this"));

361 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 1);

362 
	`TEST_MSET_SIZE
(
mym£t
, 1);

364 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 5);

365 
	`TEST_MSET_SIZE
(
mym£t
, 5);

367  
Œue
;

368 
	}
}

373 
	$DEFINE_TESTCASE
(
ex·ndweights1
, 
back’d
) {

374 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

375 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

377 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

379 
X­Ÿn
::
RS‘
 
myr£t
;

380 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

381 
myr£t
.
	`add_docum’t
(*
i
);

382 
myr£t
.
	`add_docum’t
(*(++
i
));

384 
X­Ÿn
::
ES‘
 
e£t
 = 
’quœe
.
	`g‘_e£t
(3, 
myr£t
,ƒnquœe.
USE_EXACT_TERMFREQ
);

385 
	`TEST_EQUAL
(
e£t
.
	`size
(), 3);

386 
	`TEST_EQUAL_DOUBLE
(
e£t
[0].
	`g‘_weight
(), 6.08904001099445);

387 
	`TEST_EQUAL_DOUBLE
(
e£t
[1].
	`g‘_weight
(), 6.08904001099445);

388 
	`TEST_EQUAL_DOUBLE
(
e£t
[2].
	`g‘_weight
(), 4.73383620844021);

390  
Œue
;

391 
	}
}

394 
	$DEFINE_TESTCASE
(
ex·ndweights2
, 
back’d
) {

395 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

396 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

398 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

400 
X­Ÿn
::
RS‘
 
myr£t
;

401 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

402 
myr£t
.
	`add_docum’t
(*
i
);

403 
myr£t
.
	`add_docum’t
(*(++
i
));

405 
X­Ÿn
::
ES‘
 
e£t
 = 
’quœe
.
	`g‘_e£t
(3, 
myr£t
);

406 
	`TEST_EQUAL
(
e£t
.
	`size
(), 3);

407 ià(!
	`¡¬tsw™h
(
	`g‘_dbty³
(), "multi")) {

410 
	`TEST_EQUAL_DOUBLE
(
e£t
[0].
	`g‘_weight
(), 6.08904001099445);

411 
	`TEST_EQUAL_DOUBLE
(
e£t
[1].
	`g‘_weight
(), 6.08904001099445);

412 
	`TEST_EQUAL_DOUBLE
(
e£t
[2].
	`g‘_weight
(), 4.73383620844021);

416 
	`TEST_NOT_EQUAL_DOUBLE
(
e£t
[0].
	`g‘_weight
(), 6.08904001099445);

417 
	`TEST_EQUAL_DOUBLE
(
e£t
[1].
	`g‘_weight
(), 6.08904001099445);

418 
	`TEST_NOT_EQUAL_DOUBLE
(
e£t
[2].
	`g‘_weight
(), 4.73383620844021);

421  
Œue
;

422 
	}
}

426 
	$DEFINE_TESTCASE
(
ex·ndmax™ems1
, 
back’d
) {

427 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

428 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

430 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

431 
tout
 << "mym£t.size(èğ" << 
mym£t
.
	`size
(è<< 
’dl
;

432 
	`TEST
(
mym£t
.
	`size
() >= 2);

434 
X­Ÿn
::
RS‘
 
myr£t
;

435 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

436 
myr£t
.
	`add_docum’t
(*
i
);

437 
myr£t
.
	`add_docum’t
(*(++
i
));

439 
X­Ÿn
::
ES‘
 
mye£t
 = 
’quœe
.
	`g‘_e£t
(1, 
myr£t
);

440 
	`TEST_EQUAL
(
mye£t
.
	`size
(), 1);

442  
Œue
;

443 
	}
}

446 
	$DEFINE_TESTCASE
(
boŞqu”y1
, 
back’d
) {

447 
X­Ÿn
::
Qu”y
 
	`myboŞqu”y
(
	`qu”y
("this"));

451 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

452 
’quœe
.
	`£t_qu”y
(
myboŞqu”y
);

453 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

456 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

458 
	`TEST_NOT_EQUAL
(
mym£t
.
	`size
(), 0);

459 
	`TEST_EQUAL
(
mym£t
.
	`g‘_max_possibË
(), 0);

460 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
(); i !ğmym£t.
	`’d
(); ++i) {

461 
	`TEST_EQUAL
(
i
.
	`g‘_weight
(), 0);

463  
Œue
;

464 
	}
}

467 
	$DEFINE_TESTCASE
(
m£tfœ¡1
, 
back’d
) {

468 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

469 
’quœe
.
	`£t_qu”y
(
	`qu”y
("this"));

470 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 6);

471 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(3, 3);

472 
	`TEST
(
	`m£t_¿nge_is_§me
(
mym£t1
, 3, 
mym£t2
, 0, 3));

476 
	`TEST_EQUAL
(
mym£t1
[5].
	`g‘_docum’t
().
	`g‘_d©a
(),

477 
mym£t2
[2].
	`g‘_docum’t
().
	`g‘_d©a
());

478  
Œue
;

479 
	}
}

482 
	$DEFINE_TESTCASE
(
tİ”ûÁ1
, 
back’d
) {

483 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

484 
’quœe
.
	`£t_qu”y
(
	`qu”y
("this"));

485 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

487 
Ï¡_pù
 = 100;

488 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

489  ; 
i
 !ğ
mym£t
.
	`’d
(); ++i) {

490 
pù
 = 
mym£t
.
	`cÚv”t_to_³rûÁ
(
i
);

491 
	`TEST_AND_EXPLAIN
(
pù
 =ğ
i
.
	`g‘_³rûÁ
(),

493 
	`TEST_AND_EXPLAIN
(
pù
 =ğ
mym£t
.
	`cÚv”t_to_³rûÁ
(
i
.
	`g‘_weight
()),

495 
	`TEST_AND_EXPLAIN
(
pù
 >= 0 &&…ct <= 100,

496 "³rûÁagouˆoà¿nge: " << 
pù
);

497 
	`TEST_AND_EXPLAIN
(
pù
 <ğ
Ï¡_pù
, "percentage increased down mset");

498 
Ï¡_pù
 = 
pù
;

500  
Œue
;

501 
	}
}

504 
	$DEFINE_TESTCASE
(
tİ”ûÁ2
, 
back’d
) {

505 
Back’dMªag”Loÿl
 
loÿl_mªag”
;

506 
loÿl_mªag”
.
	`£t_d©adœ
(
‹¡_driv”
::
	`g‘_¤cdœ
() + "/testdata/");

507 
X­Ÿn
::
Enquœe
 
	`loÿËnq
(
loÿl_mªag”
.
	`g‘_d©aba£
("apitest_simpledata"));

508 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

510 
pù
;

513 
’quœe
.
	`£t_qu”y
(
	`qu”y
("this"));

514 
loÿËnq
.
	`£t_qu”y
(
	`qu”y
("this"));

515 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

516 
X­Ÿn
::
MS‘
 
loÿlm£t
 = 
loÿËnq
.
	`g‘_m£t
(0, 20);

518 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

519 
	`TEST
(
i
 !ğ
mym£t
.
	`’d
());

520 
pù
 = 
mym£t
.
	`cÚv”t_to_³rûÁ
(
i
);

521 
	`TEST_EQUAL
(
pù
, 100);

523 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 
loÿlm£t
.get_matches_lower_bound());

524 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 
loÿlm£t
.get_matches_upper_bound());

525 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 
loÿlm£t
.get_matches_estimated());

526 
	`TEST_EQUAL_DOUBLE
(
mym£t
.
	`g‘_max_©šed
(), 
loÿlm£t
.get_max_attained());

527 
	`TEST_EQUAL
(
mym£t
.
	`size
(), 
loÿlm£t
.size());

528 
	`TEST
(
	`m£t_¿nge_is_§me
(
mym£t
, 0, 
loÿlm£t
, 0, mym£t.
	`size
()));

531 
X­Ÿn
::
Qu”y
 
q
 = 
	`qu”y
(X­Ÿn::Qu”y::
OP_OR
,

533 
’quœe
.
	`£t_qu”y
(
q
);

534 
loÿËnq
.
	`£t_qu”y
(
q
);

535 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

536 
loÿlm£t
 = 
loÿËnq
.
	`g‘_m£t
(0, 20);

538 
i
 = 
mym£t
.
	`begš
();

539 
	`TEST
(
i
 !ğ
mym£t
.
	`’d
());

540 
pù
 = 
mym£t
.
	`cÚv”t_to_³rûÁ
(
i
);

541 
	`TEST_REL
(
pù
,>,60);

542 
	`TEST_REL
(
pù
,<,76);

544 ++
i
;

546 
	`TEST
(
i
 !ğ
mym£t
.
	`’d
());

547 
pù
 = 
mym£t
.
	`cÚv”t_to_³rûÁ
(
i
);

548 
	`TEST_REL
(
pù
,>,40);

549 
	`TEST_REL
(
pù
,<,50);

551 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 
loÿlm£t
.get_matches_lower_bound());

552 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 
loÿlm£t
.get_matches_upper_bound());

553 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 
loÿlm£t
.get_matches_estimated());

554 
	`TEST_EQUAL_DOUBLE
(
mym£t
.
	`g‘_max_©šed
(), 
loÿlm£t
.get_max_attained());

555 
	`TEST_EQUAL
(
mym£t
.
	`size
(), 
loÿlm£t
.size());

556 
	`TEST
(
	`m£t_¿nge_is_§me
(
mym£t
, 0, 
loÿlm£t
, 0, mym£t.
	`size
()));

558  
Œue
;

559 
	}
}

561 şas 
	cmyEx·ndFunùÜ
 : 
public
 
X­Ÿn
::
Ex·ndDecid”
 {

562 
public
:

563 
boŞ
 
	$İ”©Ü
()(cÚ¡ 
¡ršg
 & 
Šame
) const {

564 
sum
 = 0;

565 
¡ršg
::
cÚ¡_™”©Ü
 
i
=
Šame
.
	`begš
(); i!ñÇme.
	`’d
(); ++i) {

566 
sum
 +ğ*
i
;

571  (
sum
 % 2) == 0;

573 
	}
};

576 
	$DEFINE_TESTCASE
(
ex·ndfunùÜ1
, 
back’d
) {

577 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

578 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

580 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

581 
	`TEST
(
mym£t
.
	`size
() >= 2);

583 
X­Ÿn
::
RS‘
 
myr£t
;

584 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

585 
myr£t
.
	`add_docum’t
(*
i
);

586 
myr£t
.
	`add_docum’t
(*(++
i
));

588 
myEx·ndFunùÜ
 
myfunùÜ
;

590 
X­Ÿn
::
ES‘
 
mye£t_Üig
 = 
’quœe
.
	`g‘_e£t
(1000, 
myr£t
);

591 
Ãwe£t_size
 = 0;

592 
X­Ÿn
::
ES‘I‹¿tÜ
 
j
 = 
mye£t_Üig
.
	`begš
();

593  ; 
j
 !ğ
mye£t_Üig
.
	`’d
(); ++j) {

594 ià(
	`myfunùÜ
(*
j
)è
Ãwe£t_size
++;

596 
X­Ÿn
::
ES‘
 
mye£t
 = 
’quœe
.
	`g‘_e£t
(
Ãwe£t_size
, 
myr£t
, &
myfunùÜ
);

600 ià(
v”bo£
) {

601 
tout
 << "orig_eset: ";

602 
	`cİy
(
mye£t_Üig
.
	`begš
(), mye£t_Üig.
	`’d
(),

603 
o¡»am_™”©Ü
<
X­Ÿn
::
ES‘I‹m
>(
tout
, " "));

604 
tout
 << "\n";

606 
tout
 << "new_eset: ";

607 
	`cİy
(
mye£t
.
	`begš
(), mye£t.
	`’d
(),

608 
o¡»am_™”©Ü
<
X­Ÿn
::
ES‘I‹m
>(
tout
, " "));

609 
tout
 << "\n";

612 
X­Ÿn
::
ES‘I‹¿tÜ
 
Üig
 = 
mye£t_Üig
.
	`begš
();

613 
X­Ÿn
::
ES‘I‹¿tÜ
 
ft
 = 
mye£t
.
	`begš
();

614 ; 
Üig
 !ğ
mye£t_Üig
.
	`’d
(è&& 
ft
 !ğ
mye£t
.end(); ++orig, ++filt) {

616 
Üig
 !ğ
mye£t_Üig
.
	`’d
(è&& !
	`myfunùÜ
(*orig)) {

617 ++
Üig
;

620 
	`TEST_AND_EXPLAIN
(*
Üig
 =ğ*
ft
 &&

621 
Üig
.
	`g‘_weight
(è=ğ
ft
.get_weight(),

622 "Mism©ch iÀ™em " << *
Üig
 << " vs. " << *
ft


626 
Üig
 !ğ
mye£t_Üig
.
	`’d
(è&& !
	`myfunùÜ
(*orig)) {

627 ++
Üig
;

630 
	`TEST_EQUAL
(
Üig
, 
mye£t_Üig
.
	`’d
());

631 
	`TEST_AND_EXPLAIN
(
ft
 =ğ
mye£t
.
	`’d
(),

633  
Œue
;

634 
	}
}

637 
	$DEFINE_TESTCASE
(
pùcutoff1
, 
back’d
) {

638 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

639 
’quœe
.
	`£t_qu”y
(
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_OR
,

641 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 100);

643 ià(
v”bo£
) {

644 
tout
 << "Original mset…cts:";

645 
	`´št_m£t_³rûÁages
(
mym£t1
);

646 
tout
 << "\n";

649 
num_™ems
 = 0;

650 
my_pù
 = 100;

651 
chªges
 = 0;

652 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t1
.
	`begš
();

653 
c
 = 0;

654  ; 
i
 !ğ
mym£t1
.
	`’d
(); ++i, ++
c
) {

655 
Ãw_pù
 = 
mym£t1
.
	`cÚv”t_to_³rûÁ
(
i
);

656 ià(
Ãw_pù
 !ğ
my_pù
) {

657 
chªges
++;

658 ià(
chªges
 > 3) ;

659 
num_™ems
 = 
c
;

660 
my_pù
 = 
Ãw_pù
;

664 
	`TEST_AND_EXPLAIN
(
chªges
 > 3, "MSet‚ot variedƒnoughoest");

665 ià(
v”bo£
) {

666 
tout
 << "Cutofà³rûÁ: " << 
my_pù
 << "\n";

669 
’quœe
.
	`£t_cutoff
(
my_pù
);

670 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 100);

672 ià(
v”bo£
) {

673 
tout
 << "Percentages‡fter cutoff:";

674 
	`´št_m£t_³rûÁages
(
mym£t2
);

675 
tout
 << "\n";

678 
	`TEST_AND_EXPLAIN
(
mym£t2
.
	`size
(è>ğ
num_™ems
,

681 
	`TEST_AND_EXPLAIN
(
mym£t2
.
	`size
(è=ğ
num_™ems
 ||

682 (
mym£t2
.
	`cÚv”t_to_³rûÁ
(mym£t2[
num_™ems
]è=ğ
my_pù
 &&

683 
mym£t2
.
	`cÚv”t_to_³rûÁ
(mym£t2.
	`back
()è=ğ
my_pù
),

686  
Œue
;

687 
	}
}

690 
	$DEFINE_TESTCASE
(
pùcutoff2
, 
back’d
) {

691 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

692 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

693 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND_NOT
, Xapian::Query("this"), Xapian::Query("banana")));

694 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 100);

696 ià(
v”bo£
) {

697 
tout
 << "Original mset…cts:";

698 
	`´št_m£t_³rûÁages
(
m£t
);

699 
tout
 << "\n";

702 
	`TEST
(
m£t
.
	`size
() >= 2);

703 
	`TEST
(
m£t
[0].
	`g‘_³rûÁ
() - mset[1].get_percent() >= 2);

705 
X­Ÿn
::
³rûÁ
 
cutoff
 = 
m£t
[0].
	`g‘_³rûÁ
() + mset[1].get_percent();

706 
cutoff
 /= 2;

708 
’quœe
.
	`£t_cutoff
(
cutoff
);

709 
’quœe
.
	`£t_cŞÏp£_key
(1234);

711 
X­Ÿn
::
MS‘
 
m£t2
 = 
’quœe
.
	`g‘_m£t
(0, 1);

712 
	`TEST_EQUAL
(
m£t2
.
	`size
(), 1);

713 
	`TEST_EQUAL
(
m£t2
.
	`g‘_m©ches_low”_bound
(), 1);

714 
	`TEST_REL
(
m£t2
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(),>=,1);

715 
	`TEST_REL
(
m£t2
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,
m£t
.
	`size
());

716 
	`TEST_REL
(
m£t2
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(),>=,
m£t
.
	`size
());

717 
	`TEST_REL
(
m£t2
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,m£t2.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
());

718 
	`TEST_REL
(
m£t2
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(),>=,m£t2.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
());

720  
Œue
;

721 
	}
}

724 
	$DEFINE_TESTCASE
(
pùcutoff3
, 
back’d
) {

725 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

726 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

727 
X­Ÿn
::
MS‘
 
m£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

729 ià(
v”bo£
) {

730 
tout
 << "Original mset…cts:";

731 
	`´št_m£t_³rûÁages
(
m£t1
);

732 
tout
 << "\n";

735 
³rûÁ
 = 100;

736 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t1
.
	`begš
(); i !ğm£t1.
	`’d
(); ++i) {

737 
Ãw_³rûÁ
 = 
m£t1
.
	`cÚv”t_to_³rûÁ
(
i
);

738 ià(
Ãw_³rûÁ
 !ğ
³rûÁ
) {

739 
’quœe
.
	`£t_cutoff
(
³rûÁ
);

740 
X­Ÿn
::
MS‘
 
m£t2
 = 
’quœe
.
	`g‘_m£t
(0, 10);

741 
	`TEST_EQUAL
(
m£t2
.
	`size
(), 
i
.
	`g‘_¿nk
());

742 
³rûÁ
 = 
Ãw_³rûÁ
;

746  
Œue
;

747 
	}
}

750 
	$DEFINE_TESTCASE
(
cutoff1
, 
back’d
) {

751 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

752 
’quœe
.
	`£t_qu”y
(
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_OR
,

754 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 100);

756 ià(
v”bo£
) {

757 
tout
 << "Original mset weights:";

758 
	`´št_m£t_weights
(
mym£t1
);

759 
tout
 << "\n";

762 
num_™ems
 = 0;

763 
X­Ÿn
::
weight
 
my_wt
 = -100;

764 
chªges
 = 0;

765 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t1
.
	`begš
();

766 
c
 = 0;

767  ; 
i
 !ğ
mym£t1
.
	`’d
(); ++i, ++
c
) {

768 
X­Ÿn
::
weight
 
Ãw_wt
 = 
i
.
	`g‘_weight
();

769 ià(
Ãw_wt
 !ğ
my_wt
) {

770 
chªges
++;

771 ià(
chªges
 > 3) ;

772 
num_™ems
 = 
c
;

773 
my_wt
 = 
Ãw_wt
;

777 
	`TEST_AND_EXPLAIN
(
chªges
 > 3, "MSet‚ot variedƒnoughoest");

778 ià(
v”bo£
) {

779 
tout
 << "Cutofàweight: " << 
my_wt
 << "\n";

782 
’quœe
.
	`£t_cutoff
(0, 
my_wt
);

783 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 100);

785 ià(
v”bo£
) {

786 
tout
 << "Weights‡fter cutoff:";

787 
	`´št_m£t_weights
(
mym£t2
);

788 
tout
 << "\n";

791 
	`TEST_AND_EXPLAIN
(
mym£t2
.
	`size
(è>ğ
num_™ems
,

794 
	`TEST_AND_EXPLAIN
(
mym£t2
.
	`size
(è=ğ
num_™ems
 ||

795 (
mym£t2
[
num_™ems
].
	`g‘_weight
(è=ğ
my_wt
 &&

796 
mym£t2
.
	`back
().
	`g‘_weight
(è=ğ
my_wt
),

799  
Œue
;

800 
	}
}

803 
	$DEFINE_TESTCASE
(
®lowq‹rms1
, 
back’d
) {

804 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

805 
¡ršg
 
‹rm
 = "paragraph";

806 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(
‹rm
));

808 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

809 
	`TEST
(
mym£t
.
	`size
() >= 2);

811 
X­Ÿn
::
RS‘
 
myr£t
;

812 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

813 
myr£t
.
	`add_docum’t
(*
i
);

814 
myr£t
.
	`add_docum’t
(*(++
i
));

816 
X­Ÿn
::
ES‘
 
mye£t
 = 
’quœe
.
	`g‘_e£t
(1000, 
myr£t
);

817 
X­Ÿn
::
ES‘I‹¿tÜ
 
j
 = 
mye£t
.
	`begš
();

818  ; 
j
 !ğ
mye£t
.
	`’d
(); ++j) {

819 
	`TEST_NOT_EQUAL
(*
j
, 
‹rm
);

822 
X­Ÿn
::
ES‘
 
mye£t2
 = 
’quœe
.
	`g‘_e£t
(1000, 
myr£t
, X­Ÿn::
Enquœe
::
INCLUDE_QUERY_TERMS
);

823 
j
 = 
mye£t2
.
	`begš
();

824  ; 
j
 !ğ
mye£t2
.
	`’d
(); ++j) {

825 ià(*
j
 =ğ
‹rm
) ;

827 
	`TEST
(
j
 !ğ
mye£t2
.
	`’d
());

828  
Œue
;

829 
	}
}

832 
	$DEFINE_TESTCASE
(
max©š1
, 
back’d
) {

833 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

834 
’quœe
.
	`£t_qu”y
(
	`qu”y
("this"));

835 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 100);

837 
X­Ÿn
::
weight
 
mymax
 = 0;

838 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

839  ; 
i
 !ğ
mym£t
.
	`’d
(); ++i) {

840 ià(
i
.
	`g‘_weight
(è> 
mymax
) mymax = i.get_weight();

842 
	`TEST_EQUAL
(
mymax
, 
mym£t
.
	`g‘_max_©šed
());

844  
Œue
;

845 
	}
}

848 
	$DEFINE_TESTCASE
(
»v”£boŞ1
, 
back’d
) {

849 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

850 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

851 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

853 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 100);

854 
	`TEST_AND_EXPLAIN
(
mym£t1
.
	`size
() > 1,

857 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
ASCENDING
);

858 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 100);

859 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

860 
X­Ÿn
::
MS‘
 
mym£t3
 = 
’quœe
.
	`g‘_m£t
(0, 100);

863 
	`TEST_EQUAL
(
mym£t1
.
	`size
(), 
mym£t2
.size());

866 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t1
.
	`begš
();

867 
X­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
mym£t2
.
	`begš
();

868  ; 
i
 !ğ
mym£t1
.
	`’d
(), 
j
 !ğ
mym£t2
.end(); ++i, j++) {

871 
	`TEST_EQUAL
(*
i
, *
j
);

876 
	`TEST_EQUAL
(
mym£t1
.
	`size
(), 
mym£t3
.size());

879 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t1
.
	`begš
();

880 
veùÜ
<
X­Ÿn
::
docid
> 
	`»v
(
mym£t3
.
	`begš
(), mym£t3.
	`’d
());

882 
veùÜ
<
X­Ÿn
::
docid
>::
»v”£_™”©Ü
 
j
 = 
»v
.
	`rbegš
();

883  ; 
i
 !ğ
mym£t1
.
	`’d
(); ++i, 
j
++) {

886 
	`TEST_EQUAL
(*
i
, *
j
);

890  
Œue
;

891 
	}
}

894 
	$DEFINE_TESTCASE
(
»v”£boŞ2
, 
back’d
) {

895 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

896 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

897 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

899 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 100);

901 
	`TEST_AND_EXPLAIN
(
mym£t1
.
	`size
() > 1,

904 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
ASCENDING
);

905 
X­Ÿn
::
doccouÁ
 
msize
 = 
mym£t1
.
	`size
() / 2;

906 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 
msize
);

907 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

908 
X­Ÿn
::
MS‘
 
mym£t3
 = 
’quœe
.
	`g‘_m£t
(0, 
msize
);

911 
	`TEST_EQUAL
(
msize
, 
mym£t2
.
	`size
());

913 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t1
.
	`begš
();

914 
X­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
mym£t2
.
	`begš
();

915  ; 
i
 !ğ
mym£t1
.
	`’d
(), 
j
 !ğ
mym£t2
.end(); ++i, j++) {

918 
	`TEST_EQUAL
(*
i
, *
j
);

923 
	`TEST_EQUAL
(
msize
, 
mym£t3
.
	`size
());

925 
veùÜ
<
X­Ÿn
::
docid
> 
	`»v
(
mym£t1
.
	`begš
(), mym£t1.
	`’d
());

927 
veùÜ
<
X­Ÿn
::
docid
>::
»v”£_™”©Ü
 
i
 = 
»v
.
	`rbegš
();

928 
X­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
mym£t3
.
	`begš
();

929  ; 
j
 !ğ
mym£t3
.
	`’d
(); ++
i
, j++) {

932 
	`TEST_EQUAL
(*
i
, *
j
);

936  
Œue
;

937 
	}
}

940 
	$DEFINE_TESTCASE
(
g‘m‹rms1
, 
back’d
) {

941 
li¡
<
¡ršg
> 
ªsw”s_li¡
;

942 
ªsw”s_li¡
.
	`push_back
("one");

943 
ªsw”s_li¡
.
	`push_back
("two");

944 
ªsw”s_li¡
.
	`push_back
("three");

945 
ªsw”s_li¡
.
	`push_back
("four");

947 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_termorder"));

948 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

950 
X­Ÿn
::
Qu”y
 
	`myqu”y
(X­Ÿn::Qu”y::
OP_OR
,

951 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

952 
X­Ÿn
::
	`Qu”y
("one", 1, 1),

953 
X­Ÿn
::
	`Qu”y
("three", 1, 3)),

954 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

955 
X­Ÿn
::
	`Qu”y
("four", 1, 4),

956 
X­Ÿn
::
	`Qu”y
("two", 1, 2)));

958 
’quœe
.
	`£t_qu”y
(
myqu”y
);

960 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

962 
	`TEST_MSET_SIZE
(
mym£t
, 1);

963 
li¡
<
¡ršg
> 
	`li¡
(
’quœe
.
	`g‘_m©chšg_‹rms_begš
(
mym£t
.
	`begš
()),

964 
’quœe
.
	`g‘_m©chšg_‹rms_’d
(
mym£t
.
	`begš
()));

965 
	`TEST
(
li¡
 =ğ
ªsw”s_li¡
);

967  
Œue
;

968 
	}
}

971 
	$DEFINE_TESTCASE
(
g‘m‹rms2
, 
back’d
) {

972 
li¡
<
¡ršg
> 
ªsw”s_li¡
;

973 
ªsw”s_li¡
.
	`push_back
("one");

974 
ªsw”s_li¡
.
	`push_back
("two");

975 
ªsw”s_li¡
.
	`push_back
("three");

977 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_termorder"));

978 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

980 
X­Ÿn
::
Qu”y
 
	`myqu”y
(X­Ÿn::Qu”y::
OP_OR
,

981 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

982 
X­Ÿn
::
	`Qu”y
("one", 1, 1),

983 
X­Ÿn
::
	`Qu”y
("three", 1, 3)),

984 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

985 
X­Ÿn
::
	`Qu”y
("one", 1, 4),

986 
X­Ÿn
::
	`Qu”y
("two", 1, 2)));

988 
’quœe
.
	`£t_qu”y
(
myqu”y
);

990 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

992 
	`TEST_MSET_SIZE
(
mym£t
, 1);

993 
li¡
<
¡ršg
> 
	`li¡
(
’quœe
.
	`g‘_m©chšg_‹rms_begš
(
mym£t
.
	`begš
()),

994 
’quœe
.
	`g‘_m©chšg_‹rms_’d
(
mym£t
.
	`begš
()));

995 
	`TEST
(
li¡
 =ğ
ªsw”s_li¡
);

997  
Œue
;

998 
	}
}

1001 
	$DEFINE_TESTCASE
(
poscŞÏp£1
, 
back’d
) {

1002 
X­Ÿn
::
Qu”y
 
	`myqu”y1
(X­Ÿn::Qu”y::
OP_OR
,

1003 
X­Ÿn
::
	`Qu”y
("this", 1, 1),

1004 
X­Ÿn
::
	`Qu”y
("this", 1, 1));

1005 
X­Ÿn
::
Qu”y
 
	`myqu”y2
("this", 2, 1);

1007 ià(
v”bo£
) {

1008 
tout
 << 
myqu”y1
.
	`g‘_desütiÚ
() << "\n";

1009 
tout
 << 
myqu”y2
.
	`g‘_desütiÚ
() << "\n";

1012 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1013 
’quœe
.
	`£t_qu”y
(
myqu”y1
);

1014 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1016 
’quœe
.
	`£t_qu”y
(
myqu”y2
);

1017 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1019 
	`TEST_EQUAL
(
mym£t1
, 
mym£t2
);

1021  
Œue
;

1022 
	}
}

1025 
	$DEFINE_TESTCASE
(
»³©qu”y1
, 
back’d
) {

1026 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1027 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

1029 
’quœe
.
	`£t_qu”y
(
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_OR
, "this", "word"));

1031 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1032 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1033 
	`TEST_EQUAL
(
mym£t1
, 
mym£t2
);

1035  
Œue
;

1036 
	}
}

1039 
	$DEFINE_TESTCASE
(
ãtchdocs1
, 
back’d
) {

1040 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1041 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

1043 
’quœe
.
	`£t_qu”y
(
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_OR
, "this", "word"));

1045 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1046 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1047 
	`TEST_EQUAL
(
mym£t1
, 
mym£t2
);

1048 
mym£t2
.
	`ãtch
(mym£t2[0], mym£t2[mym£t2.
	`size
() - 1]);

1049 
mym£t2
.
	`ãtch
(mym£t2.
	`begš
(), mym£t2.
	`’d
());

1050 
mym£t2
.
	`ãtch
(mym£t2.
	`begš
());

1051 
mym£t2
.
	`ãtch
();

1053 
X­Ÿn
::
MS‘I‹¿tÜ
 
™1
 = 
mym£t1
.
	`begš
();

1054 
X­Ÿn
::
MS‘I‹¿tÜ
 
™2
 = 
mym£t2
.
	`begš
();

1056 
™1
 !ğ
mym£t1
.
	`’d
(è&& 
™2
 !ğ
mym£t2
.end()) {

1057 
	`TEST_EQUAL
(
™1
.
	`g‘_docum’t
().
	`g‘_d©a
(),

1058 
™2
.
	`g‘_docum’t
().
	`g‘_d©a
());

1059 
	`TEST_NOT_EQUAL
(
™1
.
	`g‘_docum’t
().
	`g‘_d©a
(), "");

1060 
	`TEST_NOT_EQUAL
(
™2
.
	`g‘_docum’t
().
	`g‘_d©a
(), "");

1061 
™1
++;

1062 
™2
++;

1064 
	`TEST_EQUAL
(
™1
, 
mym£t1
.
	`’d
());

1065 
	`TEST_EQUAL
(
™1
, 
mym£t2
.
	`’d
());

1067  
Œue
;

1068 
	}
}

1071 
	$DEFINE_TESTCASE
(
ab£Á‹rm1
, 
back’d
) {

1072 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1073 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

1074 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("frink"));

1076 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1077 
	`m£t_ex³ù_Üd”
(
mym£t
);

1079  
Œue
;

1080 
	}
}

1083 
	$DEFINE_TESTCASE
(
ab£Á‹rm2
, 
back’d
) {

1084 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1085 
veùÜ
<
¡ršg
> 
‹rms
;

1086 
‹rms
.
	`push_back
("frink");

1088 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
‹rms
.
	`begš
(),”ms.
	`’d
());

1089 
’quœe
.
	`£t_qu”y
(
qu”y
);

1091 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1092 
	`m£t_ex³ù_Üd”
(
mym£t
);

1094  
Œue
;

1095 
	}
}

1098 
	$DEFINE_TESTCASE
(
r£t1
, 
back’d
) {

1099 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_rset"));

1100 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

1101 
X­Ÿn
::
Qu”y
 
myqu”y
 = 
	`qu”y
(X­Ÿn::Qu”y::
OP_OR
, "giraffe", "tiger");

1102 
’quœe
.
	`£t_qu”y
(
myqu”y
);

1104 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1106 
X­Ÿn
::
RS‘
 
myr£t
;

1107 
myr£t
.
	`add_docum’t
(1);

1109 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 10, &
myr£t
);

1113 
	`TEST_MSET_SIZE
(
mym£t1
, 3);

1114 
	`TEST_MSET_SIZE
(
mym£t2
, 3);

1116  
Œue
;

1117 
	}
}

1120 
	$DEFINE_TESTCASE
(
r£t2
, 
back’d
) {

1121 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_rset"));

1122 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

1123 
X­Ÿn
::
Qu”y
 
myqu”y
 = 
	`qu”y
(X­Ÿn::Qu”y::
OP_OR
, "cuddly", "people");

1124 
’quœe
.
	`£t_qu”y
(
myqu”y
);

1126 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1128 
X­Ÿn
::
RS‘
 
myr£t
;

1129 
myr£t
.
	`add_docum’t
(2);

1131 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 10, &
myr£t
);

1133 
	`m£t_ex³ù_Üd”
(
mym£t1
, 1, 2);

1134 
	`m£t_ex³ù_Üd”
(
mym£t2
, 2, 1);

1136  
Œue
;

1137 
	}
}

1140 
DEFINE_TESTCASE
(
r£tmuÉidb1
, 
back’d
 && !
muÉi
) {

1141 
	gX­Ÿn
::
D©aba£
 
mydb1
(
g‘_d©aba£
("apitest_rset", "apitest_simpledata2"));

1142 
	gX­Ÿn
::
D©aba£
 
mydb2
(
g‘_d©aba£
("apitest_rset"));

1143 
	gmydb2
.
add_d©aba£
(
g‘_d©aba£
("apitest_simpledata2"));

1145 
	gX­Ÿn
::
Enquœe
 
’quœe1
(
mydb1
);

1146 
	gX­Ÿn
::
Enquœe
 
’quœe2
(
mydb2
);

1148 
	gX­Ÿn
::
Qu”y
 
myqu”y
 = 
qu”y
(
X­Ÿn
::Qu”y::
OP_OR
, "cuddly", "multiple");

1150 
	g’quœe1
.
£t_qu”y
(
myqu”y
);

1151 
	g’quœe2
.
£t_qu”y
(
myqu”y
);

1153 
	gX­Ÿn
::
RS‘
 
myr£t1
;

1154 
	gX­Ÿn
::
RS‘
 
myr£t2
;

1155 
	gmyr£t1
.
add_docum’t
(4);

1156 
	gmyr£t2
.
add_docum’t
(2);

1158 
	gX­Ÿn
::
MS‘
 
mym£t1a
 = 
’quœe1
.
g‘_m£t
(0, 10);

1159 
	gX­Ÿn
::
MS‘
 
mym£t1b
 = 
’quœe1
.
g‘_m£t
(0, 10, &
myr£t1
);

1160 
	gX­Ÿn
::
MS‘
 
mym£t2a
 = 
’quœe2
.
g‘_m£t
(0, 10);

1161 
	gX­Ÿn
::
MS‘
 
mym£t2b
 = 
’quœe2
.
g‘_m£t
(0, 10, &
myr£t2
);

1163 
m£t_ex³ù_Üd”
(
mym£t1a
, 1, 4);

1164 
m£t_ex³ù_Üd”
(
mym£t1b
, 4, 1);

1165 
m£t_ex³ù_Üd”
(
mym£t2a
, 1, 2);

1166 
m£t_ex³ù_Üd”
(
mym£t2b
, 2, 1);

1168 
TEST
(
m£t_¿nge_is_§me_weights
(
mym£t1a
, 0, 
mym£t2a
, 0, 2));

1169 
TEST
(
m£t_¿nge_is_§me_weights
(
mym£t1b
, 0, 
mym£t2b
, 0, 2));

1170 
TEST_NOT_EQUAL
(
mym£t1a
, 
mym£t1b
);

1171 
TEST_NOT_EQUAL
(
mym£t2a
, 
mym£t2b
);

1173  
	gŒue
;

1178 
DEFINE_TESTCASE
(
r£tmuÉidb3
, 
back’d
 && !
muÉi
) {

1179 
	gX­Ÿn
::
Enquœe
 
’quœe
(
g‘_d©aba£
("apitest_simpledata2"));

1180 
	g’quœe
.
£t_qu”y
(
qu”y
(
X­Ÿn
::
Qu”y
::
OP_OR
, "cuddly", "people"));

1181 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

1182  
	gŒue
;

1186 
	$DEFINE_TESTCASE
(
–™e£t1
, 
back’d
) {

1189 
	`SKIP_TEST_FOR_BACKEND
("multi");

1191 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_simpledata"));

1192 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

1194 
X­Ÿn
::
Qu”y
 
myqu”y1
 = 
	`qu”y
(X­Ÿn::Qu”y::
OP_OR
, "word");

1196 
X­Ÿn
::
Qu”y
 
myqu”y2
 = 
	`qu”y
(X­Ÿn::Qu”y::
OP_ELITE_SET
, 1,

1199 
’quœe
.
	`£t_qu”y
(
myqu”y1
, 2);

1200 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1202 
’quœe
.
	`£t_qu”y
(
myqu”y2
);

1203 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1205 
	`TEST_EQUAL
(
mym£t1
, 
mym£t2
);

1206  
Œue
;

1207 
	}
}

1211 
	$DEFINE_TESTCASE
(
–™e£t2
, 
back’d
) {

1214 
	`SKIP_TEST_FOR_BACKEND
("multi");

1216 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_simpledata"));

1217 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

1219 
X­Ÿn
::
Qu”y
 
myqu”y1
 = 
	`qu”y
(X­Ÿn::Qu”y::
OP_AND
, "word", "search");

1221 
veùÜ
<
X­Ÿn
::
Qu”y
> 
qs
;

1222 
qs
.
	`push_back
(
	`qu”y
("this"));

1223 
qs
.
	`push_back
(
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_AND
, "word", "search"));

1224 
X­Ÿn
::
Qu”y
 
	`myqu”y2
(X­Ÿn::Qu”y::
OP_ELITE_SET
,

1225 
qs
.
	`begš
(), qs.
	`’d
(), 1);

1227 
’quœe
.
	`£t_qu”y
(
myqu”y1
);

1228 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1230 
’quœe
.
	`£t_qu”y
(
myqu”y2
);

1231 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1233 
	`TEST_EQUAL
(
mym£t1
, 
mym£t2
);

1238  
Œue
;

1239 
	}
}

1243 
	$DEFINE_TESTCASE
(
–™e£t3
, 
back’d
) {

1244 
X­Ÿn
::
D©aba£
 
	`mydb1
(
	`g‘_d©aba£
("apitest_simpledata"));

1245 
X­Ÿn
::
Enquœe
 
	`’quœe1
(
mydb1
);

1247 
X­Ÿn
::
D©aba£
 
	`mydb2
(
	`g‘_d©aba£
("apitest_simpledata"));

1248 
X­Ÿn
::
Enquœe
 
	`’quœe2
(
mydb2
);

1251 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

1253 
¡ršg
 
‹rm1
 = 
	`¡emm”
("word");

1254 
¡ršg
 
‹rm2
 = 
	`¡emm”
("rubbish");

1255 
¡ršg
 
‹rm3
 = 
	`¡emm”
("banana");

1257 
veùÜ
<
¡ršg
> 
‹rms
;

1258 
‹rms
.
	`push_back
(
‹rm1
);

1259 
‹rms
.
	`push_back
(
‹rm2
);

1260 
‹rms
.
	`push_back
(
‹rm3
);

1262 
X­Ÿn
::
Qu”y
 
	`myqu”y1
(X­Ÿn::Qu”y::
OP_OR
, 
‹rms
.
	`begš
(),”ms.
	`’d
());

1263 
’quœe1
.
	`£t_qu”y
(
myqu”y1
);

1265 
X­Ÿn
::
Qu”y
 
	`myqu”y2
(X­Ÿn::Qu”y::
OP_ELITE_SET
, 
‹rms
.
	`begš
(),”ms.
	`’d
(), 3);

1266 
’quœe2
.
	`£t_qu”y
(
myqu”y2
);

1269 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe1
.
	`g‘_m£t
(0, 10);

1270 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe2
.
	`g‘_m£t
(0, 10);

1272 
	`TEST_EQUAL
(
mym£t1
.
	`g‘_‹rmäeq
(
‹rm1
),

1273 
mym£t2
.
	`g‘_‹rmäeq
(
‹rm1
));

1274 
	`TEST_EQUAL
(
mym£t1
.
	`g‘_‹rmweight
(
‹rm1
),

1275 
mym£t2
.
	`g‘_‹rmweight
(
‹rm1
));

1276 
	`TEST_EQUAL
(
mym£t1
.
	`g‘_‹rmäeq
(
‹rm2
),

1277 
mym£t2
.
	`g‘_‹rmäeq
(
‹rm2
));

1278 
	`TEST_EQUAL
(
mym£t1
.
	`g‘_‹rmweight
(
‹rm2
),

1279 
mym£t2
.
	`g‘_‹rmweight
(
‹rm2
));

1280 
	`TEST_EQUAL
(
mym£t1
.
	`g‘_‹rmäeq
(
‹rm3
),

1281 
mym£t2
.
	`g‘_‹rmäeq
(
‹rm3
));

1282 
	`TEST_EQUAL
(
mym£t1
.
	`g‘_‹rmweight
(
‹rm3
),

1283 
mym£t2
.
	`g‘_‹rmweight
(
‹rm3
));

1286  
Œue
;

1287 
	}
}

1290 
	$DEFINE_TESTCASE
(
–™e£t4
, 
back’d
) {

1293 
	`SKIP_TEST_FOR_BACKEND
("multi");

1295 
X­Ÿn
::
D©aba£
 
	`mydb1
(
	`g‘_d©aba£
("apitest_simpledata"));

1296 
X­Ÿn
::
Enquœe
 
	`’quœe1
(
mydb1
);

1298 
X­Ÿn
::
D©aba£
 
	`mydb2
(
	`g‘_d©aba£
("apitest_simpledata"));

1299 
X­Ÿn
::
Enquœe
 
	`’quœe2
(
mydb2
);

1301 
X­Ÿn
::
Qu”y
 
myqu”y1
 = 
	`qu”y
("rubbish");

1302 
X­Ÿn
::
Qu”y
 
myqu”y2
 = 
	`qu”y
(X­Ÿn::Qu”y::
OP_ELITE_SET
, 1,

1304 
’quœe1
.
	`£t_qu”y
(
myqu”y1
);

1305 
’quœe2
.
	`£t_qu”y
(
myqu”y2
);

1308 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe1
.
	`g‘_m£t
(0, 10);

1309 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe2
.
	`g‘_m£t
(0, 10);

1311 
	`TEST_NOT_EQUAL
(
mym£t2
.
	`size
(), 0);

1312 
	`TEST_EQUAL
(
mym£t1
, 
mym£t2
);

1315  
Œue
;

1316 
	}
}

1319 
	$DEFINE_TESTCASE
(
–™e£t5
, 
back’d
) {

1320 
	`SKIP_TEST_FOR_BACKEND
("multi");

1322 
X­Ÿn
::
D©aba£
 
	`mydb1
(
	`g‘_d©aba£
("apitest_simpledata"));

1323 
X­Ÿn
::
Enquœe
 
	`’quœe1
(
mydb1
);

1325 
veùÜ
<
¡ršg
> 
v
;

1326 
i
 = 0; i != 3; ++i) {

1327 
v
.
	`push_back
("simpl");

1328 
v
.
	`push_back
("queri");

1330 
v
.
	`push_back
("rubbish");

1331 
v
.
	`push_back
("rubbish");

1332 
v
.
	`push_back
("rubbish");

1333 
v
.
	`push_back
("word");

1334 
v
.
	`push_back
("word");

1335 
v
.
	`push_back
("word");

1338 
X­Ÿn
::
Qu”y
 
myqu”y1
 = X­Ÿn::
	`Qu”y
(X­Ÿn::Qu”y::
OP_ELITE_SET
,

1339 
v
.
	`begš
(), v.
	`’d
(), 1);

1340 
myqu”y1
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_SCALE_WEIGHT
,

1341 
myqu”y1
,

1344 
’quœe1
.
	`£t_qu”y
(
myqu”y1
);

1347 
’quœe1
.
	`g‘_m£t
(0, 10);

1349  
Œue
;

1350 
	}
}

1353 
	$DEFINE_TESTCASE
(
‹rmli¡‹rmäeq1
, 
back’d
) {

1354 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_simpledata"));

1355 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

1356 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

1357 
X­Ÿn
::
RS‘
 
r£t1
;

1358 
X­Ÿn
::
RS‘
 
r£t2
;

1359 
r£t1
.
	`add_docum’t
(5);

1360 
r£t2
.
	`add_docum’t
(6);

1362 
X­Ÿn
::
ES‘
 
e£t1
 = 
’quœe
.
	`g‘_e£t
(1000, 
r£t1
);

1363 
X­Ÿn
::
ES‘
 
e£t2
 = 
’quœe
.
	`g‘_e£t
(1000, 
r£t2
);

1366 
¡ršg
 
th‘”m
 = 
	`¡emm”
("another");

1368 
X­Ÿn
::
weight
 
wt1
 = 0;

1369 
X­Ÿn
::
weight
 
wt2
 = 0;

1371 
X­Ÿn
::
ES‘I‹¿tÜ
 
i
 = 
e£t1
.
	`begš
();

1372  ; 
i
 !ğ
e£t1
.
	`’d
(); i++) {

1373 ià(*
i
 =ğ
th‘”m
) {

1374 
wt1
 = 
i
.
	`g‘_weight
();

1380 
X­Ÿn
::
ES‘I‹¿tÜ
 
i
 = 
e£t2
.
	`begš
();

1381  ; 
i
 !ğ
e£t2
.
	`’d
(); i++) {

1382 ià(*
i
 =ğ
th‘”m
) {

1383 
wt2
 = 
i
.
	`g‘_weight
();

1389 
	`TEST_NOT_EQUAL
(
wt1
, 0);

1390 
	`TEST_NOT_EQUAL
(
wt2
, 0);

1391 
	`TEST_EQUAL
(
wt1
, 
wt2
);

1393  
Œue
;

1394 
	}
}

1397 
	$DEFINE_TESTCASE
(
q‹rmšfo1
, 
back’d
) {

1398 
X­Ÿn
::
D©aba£
 
	`mydb1
(
	`g‘_d©aba£
("apitest_simpledata", "apitest_simpledata2"));

1399 
X­Ÿn
::
Enquœe
 
	`’quœe1
(
mydb1
);

1401 
X­Ÿn
::
D©aba£
 
	`mydb2
(
	`g‘_d©aba£
("apitest_simpledata"));

1402 
mydb2
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata2"));

1403 
X­Ÿn
::
Enquœe
 
	`’quœe2
(
mydb2
);

1406 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

1408 
¡ršg
 
‹rm1
 = 
	`¡emm”
("word");

1409 
¡ršg
 
‹rm2
 = 
	`¡emm”
("inmemory");

1410 
¡ršg
 
‹rm3
 = 
	`¡emm”
("flibble");

1412 
X­Ÿn
::
Qu”y
 
	`myqu”y
(X­Ÿn::Qu”y::
OP_OR
,

1413 
X­Ÿn
::
	`Qu”y
(
‹rm1
),

1414 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

1415 
X­Ÿn
::
	`Qu”y
(
‹rm2
),

1416 
X­Ÿn
::
	`Qu”y
(
‹rm3
)));

1417 
’quœe1
.
	`£t_qu”y
(
myqu”y
);

1418 
’quœe2
.
	`£t_qu”y
(
myqu”y
);

1421 
X­Ÿn
::
MS‘
 
mym£t1a
 = 
’quœe1
.
	`g‘_m£t
(0, 0);

1422 
X­Ÿn
::
MS‘
 
mym£t2a
 = 
’quœe2
.
	`g‘_m£t
(0, 0);

1424 
	`TEST_EQUAL
(
mym£t1a
.
	`g‘_‹rmäeq
(
‹rm1
),

1425 
mym£t2a
.
	`g‘_‹rmäeq
(
‹rm1
));

1426 
	`TEST_EQUAL
(
mym£t1a
.
	`g‘_‹rmäeq
(
‹rm2
),

1427 
mym£t2a
.
	`g‘_‹rmäeq
(
‹rm2
));

1428 
	`TEST_EQUAL
(
mym£t1a
.
	`g‘_‹rmäeq
(
‹rm3
),

1429 
mym£t2a
.
	`g‘_‹rmäeq
(
‹rm3
));

1431 
	`TEST_EQUAL
(
mym£t1a
.
	`g‘_‹rmäeq
(
‹rm1
), 3);

1432 
	`TEST_EQUAL
(
mym£t1a
.
	`g‘_‹rmäeq
(
‹rm2
), 1);

1433 
	`TEST_EQUAL
(
mym£t1a
.
	`g‘_‹rmäeq
(
‹rm3
), 0);

1435 
	`TEST_NOT_EQUAL
(
mym£t1a
.
	`g‘_‹rmweight
(
‹rm1
), 0);

1436 
	`TEST_NOT_EQUAL
(
mym£t1a
.
	`g‘_‹rmweight
(
‹rm2
), 0);

1438 
	`TEST_NOT_EQUAL
(
mym£t1a
.
	`g‘_‹rmweight
(
‹rm3
), 0);

1440 
	`TEST_EQUAL
(
mym£t1a
.
	`g‘_‹rmäeq
(
	`¡emm”
("banana")), 1);

1441 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
,

1442 
mym£t1a
.
	`g‘_‹rmweight
(
	`¡emm”
("banana")));

1444 
	`TEST_EQUAL
(
mym£t1a
.
	`g‘_‹rmäeq
("sponge"), 0);

1445 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
,

1446 
mym£t1a
.
	`g‘_‹rmweight
("sponge"));

1448  
Œue
;

1449 
	}
}

1452 
	$DEFINE_TESTCASE
(
q‹rmšfo2
, 
back’d
) {

1453 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

1454 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

1457 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

1459 
¡ršg
 
‹rm1
 = 
	`¡emm”
("paragraph");

1460 
¡ršg
 
‹rm2
 = 
	`¡emm”
("another");

1462 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_AND_NOT
, 
‹rm1
,

1463 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
, 
‹rm1
, 
‹rm2
));

1464 
’quœe
.
	`£t_qu”y
(
qu”y
);

1468 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1470 
	`TEST_NOT_EQUAL
(
m£t
.
	`g‘_‹rmweight
("paragraph"), 0);

1472  
Œue
;

1473 
	}
}

1477 
	$DEFINE_TESTCASE
(
m£tz”o™ems1
, 
back’d
) {

1478 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1479 
’quœe
.
	`£t_qu”y
(
	`qu”y
("this"));

1480 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 0);

1482 
X­Ÿn
::
MS‘
 
mym£t2
 = 
’quœe
.
	`g‘_m£t
(0, 1);

1484 
	`TEST_EQUAL
(
mym£t1
.
	`g‘_max_possibË
(), 
mym£t2
.get_max_possible());

1486  
Œue
;

1487 
	}
}

1490 
	$DEFINE_TESTCASE
(
m©ches1
, 
back’d
) {

1491 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1492 
X­Ÿn
::
Qu”y
 
myqu”y
;

1493 
X­Ÿn
::
MS‘
 
mym£t
;

1495 
myqu”y
 = 
	`qu”y
("word");

1496 
’quœe
.
	`£t_qu”y
(
myqu”y
);

1497 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1498 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 2);

1499 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 2);

1500 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 2);

1501 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 2);

1502 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 2);

1503 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 2);

1505 
myqu”y
 = 
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_OR
, "inmemory", "word");

1506 
’quœe
.
	`£t_qu”y
(
myqu”y
);

1507 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1508 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 2);

1509 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 2);

1510 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 2);

1511 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 2);

1512 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 2);

1513 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 2);

1515 
myqu”y
 = 
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_AND
, "inmemory", "word");

1516 
’quœe
.
	`£t_qu”y
(
myqu”y
);

1517 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1518 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 0);

1519 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 0);

1520 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 0);

1521 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 0);

1522 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 0);

1523 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 0);

1525 
myqu”y
 = 
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_AND
, "simple", "word");

1526 
’quœe
.
	`£t_qu”y
(
myqu”y
);

1527 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1528 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 2);

1529 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 2);

1530 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 2);

1531 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 2);

1532 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 2);

1533 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 2);

1535 
myqu”y
 = 
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_AND
, "simple", "word");

1536 
’quœe
.
	`£t_qu”y
(
myqu”y
);

1537 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 0);

1542 
	`TEST_REL
(
mym£t
.
	`g‘_m©ches_low”_bound
(),<=,mym£t.
	`g‘_m©ches_e¡im©ed
());

1543 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 1);

1544 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 2);

1545 
	`TEST_REL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,mym£t.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
());

1546 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 1);

1547 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 2);

1549 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 1);

1550 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 2);

1551 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 2);

1552 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 2);

1553 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 2);

1554 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 2);

1555 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 2);

1557 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 2);

1558 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 2);

1559 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 2);

1560 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 2);

1561 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 2);

1562 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 2);

1563 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 2);

1565 
myqu”y
 = 
	`qu”y
(
X­Ÿn
::
Qu”y
::
OP_AND
, "paragraph", "another");

1566 
’quœe
.
	`£t_qu”y
(
myqu”y
);

1567 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 0);

1568 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 1);

1569 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 2);

1570 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 2);

1571 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 1);

1572 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 2);

1573 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 2);

1575 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 1);

1576 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 1);

1577 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 2);

1578 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 2);

1579 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 1);

1580 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 2);

1581 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 2);

1583 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 2);

1584 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 1);

1585 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 1);

1586 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 1);

1587 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 1);

1588 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 1);

1589 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 1);

1591 
mym£t
 = 
’quœe
.
	`g‘_m£t
(1, 20);

1592 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 1);

1593 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_e¡im©ed
(), 1);

1594 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 1);

1595 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 1);

1596 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 1);

1597 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 1);

1599  
Œue
;

1600 
	}
}

1603 
	$DEFINE_TESTCASE
(
wqf1
, 
back’d
) {

1605 
X­Ÿn
::
Qu”y
 
	`q1
("word", 2);

1606 
X­Ÿn
::
Qu”y
 
	`q2
("word");

1607 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1608 
’quœe
.
	`£t_qu”y
(
q1
);

1609 
X­Ÿn
::
MS‘
 
m£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1610 
’quœe
.
	`£t_qu”y
(
q2
);

1611 
X­Ÿn
::
MS‘
 
m£t2
 = 
’quœe
.
	`g‘_m£t
(0, 2);

1613 
	`TEST
(
m£t1
.
	`begš
().
	`g‘_weight
(è> 
m£t2
.begin().get_weight());

1614  
Œue
;

1615 
	}
}

1618 
	$DEFINE_TESTCASE
(
qËn1
, 
back’d
) {

1619 
X­Ÿn
::
Qu”y
 
	`q1
("word");

1620 
X­Ÿn
::
Qu”y
 
	`q2
("word");

1621 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1622 
’quœe
.
	`£t_qu”y
(
q1
);

1623 
X­Ÿn
::
MS‘
 
m£t1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1624 
’quœe
.
	`£t_qu”y
(
q2
);

1625 
X­Ÿn
::
MS‘
 
m£t2
 = 
’quœe
.
	`g‘_m£t
(0, 2);

1628 
	`TEST
(
m£t1
.
	`begš
().
	`g‘_weight
(è=ğ
m£t2
.begin().get_weight());

1629  
Œue
;

1630 
	}
}

1633 
	$DEFINE_TESTCASE
(
‹rmli¡1
, 
back’d
) {

1634 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_onedoc"));

1635 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
,

1636 
X­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
.
	`‹rmli¡_begš
(0));

1637 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
,

1638 
X­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
.
	`‹rmli¡_begš
(2));

1641 
X­Ÿn
::
T”mI‹¿tÜ
 
‹mp
 = 
db
.
	`‹rmli¡_begš
(1);

1642 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
,

1643 
X­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
.
	`‹rmli¡_begš
(999999999));

1644  
Œue
;

1645 
	}
}

1648 
	$DEFINE_TESTCASE
(
‹rmli¡2
, 
back’d
) {

1649 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_onedoc"));

1650 
X­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
.
	`‹rmli¡_begš
(1);

1651 
X­Ÿn
::
T”mI‹¿tÜ
 
‹nd
 = 
db
.
	`‹rmli¡_’d
(1);

1654 
X­Ÿn
::
T”mI‹¿tÜ
 
t_cİy
 = 
t
;

1655 
	`TEST_EQUAL
(
t
, 
t_cİy
);

1658 
X­Ÿn
::
T”mI‹¿tÜ
 
	`t_şÚe
(
t
);

1659 
	`TEST_EQUAL
(
t
, 
t_şÚe
);

1661 
veùÜ
<
¡ršg
> 
	`v
(
t
, 
‹nd
);

1663 
t
 = 
db
.
	`‹rmli¡_begš
(1);

1664 
‹nd
 = 
db
.
	`‹rmli¡_’d
(1);

1665 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
i
;

1666 
i
 = 
v
.
	`begš
(); i !ğv.
	`’d
(); i++) {

1667 
	`TEST_NOT_EQUAL
(
t
, 
‹nd
);

1668 
	`TEST_EQUAL
(*
i
, *
t
);

1669 
t
++;

1671 
	`TEST_EQUAL
(
t
, 
‹nd
);

1672  
Œue
;

1673 
	}
}

1675 
	gX­Ÿn
::
T”mI‹¿tÜ


1676 
	$‹¡_‹rmli¡3_h–³r
()

1678 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_onedoc"));

1679  
db
.
	`‹rmli¡_begš
(1);

1680 
	}
}

1683 
	$DEFINE_TESTCASE
(
‹rmli¡3
, 
back’d
) {

1684 
X­Ÿn
::
T”mI‹¿tÜ
 
u
 = 
	`‹¡_‹rmli¡3_h–³r
();

1685 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_onedoc"));

1686 
X­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
.
	`‹rmli¡_begš
(1);

1687 
X­Ÿn
::
T”mI‹¿tÜ
 
‹nd
 = 
db
.
	`‹rmli¡_’d
(1);

1689 
t
 !ğ
‹nd
) {

1690 
	`TEST_EQUAL
(*
t
, *
u
);

1691 
t
++;

1692 
u
++;

1694  
Œue
;

1695 
	}
}

1698 
	$DEFINE_TESTCASE
(
‹rmli¡4
, 
back’d
) {

1699 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_onedoc"));

1700 
X­Ÿn
::
T”mI‹¿tÜ
 
i
 = 
db
.
	`‹rmli¡_begš
(1);

1701 
i
.
	`sk_to
("");

1702 
i
.
	`sk_to
("\xff");

1703  
Œue
;

1704 
	}
}

1707 
	$DEFINE_TESTCASE
(
punù”ms1
, 
back’d
) {

1708 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_punc"));

1709 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

1711 
X­Ÿn
::
Qu”y
 
	`q1
("semi;colon");

1712 
’quœe
.
	`£t_qu”y
(
q1
);

1713 
X­Ÿn
::
MS‘
 
m1
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1715 
X­Ÿn
::
Qu”y
 
	`q2
("col:on");

1716 
’quœe
.
	`£t_qu”y
(
q2
);

1717 
X­Ÿn
::
MS‘
 
m2
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1719 
X­Ÿn
::
Qu”y
 
	`q3
("com,ma");

1720 
’quœe
.
	`£t_qu”y
(
q3
);

1721 
X­Ÿn
::
MS‘
 
m3
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1723  
Œue
;

1724 
	}
}

1727 
	$DEFINE_TESTCASE
(
¥aû‹rms1
, 
back’d
) {

1728 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_space"));

1729 
X­Ÿn
::
MS‘
 
mym£t
;

1730 
X­Ÿn
::
doccouÁ
 
couÁ
;

1731 
X­Ÿn
::
MS‘I‹¿tÜ
 
m
;

1732 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

1734 
’quœe
.
	`£t_qu”y
(
	`¡emm”
("space man"));

1735 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1736 
	`TEST_MSET_SIZE
(
mym£t
, 1);

1737 
couÁ
 = 0;

1738 
m
 = 
mym£t
.
	`begš
(); m !ğmym£t.
	`’d
(); ++mè++
couÁ
;

1739 
	`TEST_EQUAL
(
couÁ
, 1);

1741 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 1; value_no < 7; ++value_no) {

1742 
	`TEST_NOT_EQUAL
(
mym£t
.
	`begš
().
	`g‘_docum’t
().
	`g‘_d©a
(), "");

1743 
	`TEST_NOT_EQUAL
(
mym£t
.
	`begš
().
	`g‘_docum’t
().
	`g‘_v®ue
(
v®ue_no
), "");

1746 
’quœe
.
	`£t_qu”y
(
	`¡emm”
("tab\tby"));

1747 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1748 
	`TEST_MSET_SIZE
(
mym£t
, 1);

1749 
couÁ
 = 0;

1750 
m
 = 
mym£t
.
	`begš
(); m !ğmym£t.
	`’d
(); ++mè++
couÁ
;

1751 
	`TEST_EQUAL
(
couÁ
, 1);

1753 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 1; value_no < 7; ++value_no) {

1754 
¡ršg
 
v®ue
 = 
mym£t
.
	`begš
().
	`g‘_docum’t
().
	`g‘_v®ue
(
v®ue_no
);

1755 
	`TEST_NOT_EQUAL
(
v®ue
, "");

1756 ià(
v®ue_no
 == 0) {

1757 
	`TEST
(
v®ue
.
	`size
() > 262);

1758 
	`TEST_EQUAL
(
¡©ic_ÿ¡
<>(
v®ue
[261]), 255);

1762 
’quœe
.
	`£t_qu”y
(
	`¡emm”
("back\\slash"));

1763 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1764 
	`TEST_MSET_SIZE
(
mym£t
, 1);

1765 
couÁ
 = 0;

1766 
m
 = 
mym£t
.
	`begš
(); m !ğmym£t.
	`’d
(); ++mè++
couÁ
;

1767 
	`TEST_EQUAL
(
couÁ
, 1);

1769  
Œue
;

1770 
	}
}

1773 
	$DEFINE_TESTCASE
(
xÜ1
, 
back’d
) {

1774 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1775 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

1776 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

1778 
veùÜ
<
¡ršg
> 
‹rms
;

1779 
‹rms
.
	`push_back
(
	`¡emm”
("this"));

1780 
‹rms
.
	`push_back
(
	`¡emm”
("word"));

1781 
‹rms
.
	`push_back
(
	`¡emm”
("of"));

1783 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_XOR
, 
‹rms
.
	`begš
(),”ms.
	`’d
());

1784 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

1785 
’quœe
.
	`£t_qu”y
(
qu”y
);

1787 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1788 
	`m£t_ex³ù_Üd”
(
mym£t
, 1, 2, 5, 6);

1790  
Œue
;

1791 
	}
}

1794 
	$DEFINE_TESTCASE
(
g‘doc1
, 
back’d
) {

1795 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_onedoc"));

1796 
X­Ÿn
::
Docum’t
 
	`doc
(
db
.
	`g‘_docum’t
(1));

1797 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
db
.
	`g‘_docum’t
(0));

1798 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(999999999));

1799 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(123456789));

1800 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(3));

1801 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(2));

1804 
X­Ÿn
::
Docum’t
 
doc2
 = 
doc
;

1805 
doc
.
	`£t_d©a
("modified!");

1806 
	`TEST_EQUAL
(
doc
.
	`g‘_d©a
(), "modified!");

1807 
	`TEST_EQUAL
(
doc
.
	`g‘_d©a
(), 
doc2
.get_data());

1808  
Œue
;

1809 
	}
}

1812 
	$DEFINE_TESTCASE
(
em±yİ1
, 
back’d
) {

1813 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1814 
veùÜ
<
X­Ÿn
::
Qu”y
> 
nuÎvec
;

1816 
X­Ÿn
::
Qu”y
 
	`qu”y1
(X­Ÿn::Qu”y::
OP_XOR
, 
nuÎvec
.
	`begš
(),‚uÎvec.
	`’d
());

1818 
’quœe
.
	`£t_qu”y
(
qu”y1
);

1819 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1820 
	`TEST_MSET_SIZE
(
mym£t
, 0);

1821 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
’quœe
.
	`g‘_m©chšg_‹rms_begš
(1));

1823  
Œue
;

1824 
	}
}

1827 
	$DEFINE_TESTCASE
(
check©Ëa¡1
, 
back’d
) {

1828 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1829 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("thom"));

1830 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10, 11);

1831 
	`TEST_EQUAL
(0, 
mym£t
.
	`size
());

1833  
Œue
;

1834 
	}
}

1838 
	$DEFINE_TESTCASE
(
check©Ëa¡2
, 
back’d
) {

1839 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1840 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("paragraph"));

1842 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 3, 10);

1843 
	`TEST_MSET_SIZE
(
mym£t
, 3);

1844 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_low”_bound
(), 5);

1845 
	`TEST_EQUAL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 5);

1847 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 2, 4);

1848 
	`TEST_MSET_SIZE
(
mym£t
, 2);

1849 
	`TEST_REL
(
mym£t
.
	`g‘_m©ches_low”_bound
(),>=,4);

1850 
	`TEST_REL
(
mym£t
.
	`g‘_m©ches_low”_bound
(),>=,4);

1851 
	`TEST_REL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(),>=,4);

1852 
	`TEST_REL
(
mym£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(),>=,4);

1854  
Œue
;

1855 
	}
}

1858 
	$DEFINE_TESTCASE
(
check©Ëa¡3
, 
back’d
) {

1859 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("etext"));

1860 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("prussian"));

1862 
Üd”
 = 0; order < 3; ++order) {

1863 
Üd”
) {

1865 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
ASCENDING
);

1868 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

1871 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DONT_CARE
);

1875 
sÜt
 = 0; sort < 7; ++sort) {

1876 
boŞ
 
»v”£
 = (
sÜt
 & 1);

1877 
sÜt
) {

1879 
’quœe
.
	`£t_sÜt_by_»Ëvªû
();

1882 
’quœe
.
	`£t_sÜt_by_v®ue
(0, 
»v”£
);

1885 
’quœe
.
	`£t_sÜt_by_v®ue_th’_»Ëvªû
(0, 
»v”£
);

1888 
’quœe
.
	`£t_sÜt_by_»Ëvªû_th’_v®ue
(0, 
»v”£
);

1892 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 100, 500);

1893 
	`TEST_MSET_SIZE
(
m£t
, 60);

1894 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_low”_bound
(), 60);

1895 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_e¡im©ed
(), 60);

1896 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_uµ”_bound
(), 60);

1897 
	`TEST_EQUAL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 60);

1898 
	`TEST_EQUAL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 60);

1899 
	`TEST_EQUAL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 60);

1901 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 50, 100);

1902 
	`TEST_MSET_SIZE
(
m£t
, 50);

1903 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_low”_bound
(), 60);

1904 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_e¡im©ed
(), 60);

1905 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_uµ”_bound
(), 60);

1906 
	`TEST_EQUAL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 60);

1907 
	`TEST_EQUAL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 60);

1908 
	`TEST_EQUAL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 60);

1910 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10, 50);

1911 
	`TEST_MSET_SIZE
(
m£t
, 10);

1912 
	`TEST_REL
(
m£t
.
	`g‘_m©ches_low”_bound
(),>=,50);

1913 
	`TEST_REL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(),>=,50);

1917  
Œue
;

1918 
	}
}

1921 
	$DEFINE_TESTCASE
(
®Ío¡li¡1
, 
back’d
) {

1922 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_manydocs"));

1923 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
i
 = 
db
.
	`po¡li¡_begš
("");

1924 
j
 = 1;

1925 
i
 !ğ
db
.
	`po¡li¡_’d
("")) {

1926 
	`TEST_EQUAL
(*
i
, 
j
);

1927 
i
++;

1928 
j
++;

1930 
	`TEST_EQUAL
(
j
, 513);

1932 
i
 = 
db
.
	`po¡li¡_begš
("");

1933 
j
 = 1;

1934 
i
 !ğ
db
.
	`po¡li¡_’d
("")) {

1935 
	`TEST_EQUAL
(*
i
, 
j
);

1936 
i
++;

1937 
j
++;

1938 ià(
j
 == 50) {

1939 
j
 += 10;

1940 
i
.
	`sk_to
(
j
);

1943 
	`TEST_EQUAL
(
j
, 513);

1945  
Œue
;

1946 
	}
}

1948 
‹¡_em±y‹rm1_h–³r
(
X­Ÿn
::
D©aba£
 & 
db
)

1951 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
db
.
pos™iÚli¡_begš
(1, ""));

1952 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), db.
g‘_‹rmäeq
(""));

1953 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(è!ğ0, db.
‹rm_exi¡s
(""));

1954 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), db.
g‘_cŞËùiÚ_äeq
(""));

1958 
	$DEFINE_TESTCASE
(
em±y‹rm1
, 
back’d
) {

1959 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_manydocs"));

1960 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 512);

1961 
	`‹¡_em±y‹rm1_h–³r
(
db
);

1963 
db
 = 
	`g‘_d©aba£
("apitest_onedoc");

1964 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 1);

1965 
	`‹¡_em±y‹rm1_h–³r
(
db
);

1967 
db
 = 
	`g‘_d©aba£
("");

1968 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

1969 
	`‹¡_em±y‹rm1_h–³r
(
db
);

1971  
Œue
;

1972 
	}
}

1975 
	$DEFINE_TESTCASE
(
v®u”ªge1
, 
back’d
) {

1976 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

1977 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

1978 cÚ¡ * 
v®s
[] = {

1979 "", " ", "a", "¯", "abcd", "e", "g", "h", "hzz", "i", "l", "z", 
NULL


1981 cÚ¡ **
¡¬t
 = 
v®s
; *start; ++start) {

1982 cÚ¡ **
’d
 = 
v®s
; *end; ++end) {

1983 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_VALUE_RANGE
, 1, *
¡¬t
, *
’d
);

1984 
’q
.
	`£t_qu”y
(
qu”y
);

1985 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 20);

1987 
£t
<
X­Ÿn
::
docid
> 
m©ched
;

1988 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
;

1989 
i
 = 
m£t
.
	`begš
(); i !ğm£t.
	`’d
(); ++i) {

1990 
m©ched
.
	`š£¹
(*
i
);

1991 
¡ršg
 
v®ue
 = 
db
.
	`g‘_docum’t
(*
i
).
	`g‘_v®ue
(1);

1992 
tout
 << "'" << *
¡¬t
 << "' <ğ'" << 
v®ue
 << "' <ğ'" << *
’d
 << "'" << 
’dl
;

1993 
	`TEST
(
v®ue
 >ğ*
¡¬t
);

1994 
	`TEST
(
v®ue
 <ğ*
’d
);

1997 
X­Ÿn
::
docid
 
j
 = 
db
.
	`g‘_Ï¡docid
(); j != 0; --j) {

1998 ià(
m©ched
.
	`fšd
(
j
è=ğm©ched.
	`’d
()) {

1999 
¡ršg
 
v®ue
 = 
db
.
	`g‘_docum’t
(
j
).
	`g‘_v®ue
(1);

2000 
tout
 << 
v®ue
 << " < '" << *
¡¬t
 << "' o¸> '" << *
’d
 << "'" << 
’dl
;

2001 
	`TEST
(
v®ue
 < *
¡¬t
 || v®u> *
’d
);

2006  
Œue
;

2007 
	}
}

2011 
	$DEFINE_TESTCASE
(
v®u”ªge2
, 
wr™abË
) {

2012 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

2013 
X­Ÿn
::
Docum’t
 
doc
;

2014 
doc
.
	`£t_d©a
("5");

2015 
doc
.
	`add_v®ue
(0, "5");

2016 
db
.
	`»¶aû_docum’t
(5, 
doc
);

2017 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

2019 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_VALUE_LE
, 0, "6");

2020 
’q
.
	`£t_qu”y
(
qu”y
);

2021 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 20);

2023 
	`TEST_EQUAL
(
m£t
.
	`size
(), 1);

2024 
	`TEST_EQUAL
(*(
m£t
[0]), 5);

2025  
Œue
;

2026 
	}
}

2029 
	$DEFINE_TESTCASE
(
®ldoc¥l1
, 
wr™abË
) {

2030 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

2031 
X­Ÿn
::
Docum’t
 
doc
;

2032 
doc
.
	`£t_d©a
("5");

2033 
doc
.
	`add_v®ue
(0, "5");

2034 
db
.
	`»¶aû_docum’t
(5, 
doc
);

2036 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
i
 = 
db
.
	`po¡li¡_begš
("");

2037 
	`TEST
(
i
 !ğ
db
.
	`po¡li¡_’d
(""));

2038 
	`TEST_EQUAL
(*
i
, 5);

2039 
	`TEST_EQUAL
(
i
.
	`g‘_doş’gth
(), 0);

2040 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 1);

2041 ++
i
;

2042 
	`TEST
(
i
 =ğ
db
.
	`po¡li¡_’d
(""));

2044  
Œue
;

2045 
	}
}

2048 
	$DEFINE_TESTCASE
(
®ldoc¥l2
, 
wr™abË
) {

2049 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
i
, 
’d
;

2051 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

2052 
X­Ÿn
::
Docum’t
 
doc
;

2053 
doc
.
	`£t_d©a
("5");

2054 
doc
.
	`add_v®ue
(0, "5");

2055 
db
.
	`»¶aû_docum’t
(5, 
doc
);

2058 
i
 = 
db
.
	`po¡li¡_begš
("");

2059 
’d
 = 
db
.
	`po¡li¡_’d
("");

2060 
	`TEST
(
i
 !ğ
’d
);

2061 
	`TEST_EQUAL
(*
i
, 5);

2062 
	`TEST_EQUAL
(
i
.
	`g‘_doş’gth
(), 0);

2063 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 1);

2064 ++
i
;

2065 
	`TEST
(
i
 =ğ
’d
);

2067 
db
.
	`comm™
();

2070 
i
 = 
db
.
	`po¡li¡_begš
("");

2071 
’d
 = 
db
.
	`po¡li¡_’d
("");

2072 
	`TEST
(
i
 !ğ
’d
);

2073 
	`TEST_EQUAL
(*
i
, 5);

2074 
	`TEST_EQUAL
(
i
.
	`g‘_doş’gth
(), 0);

2075 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 1);

2076 ++
i
;

2077 
	`TEST
(
i
 =ğ
’d
);

2080 
doc
 = 
X­Ÿn
::
	`Docum’t
();

2081 
doc
.
	`£t_d©a
("5");

2082 
doc
.
	`add_v®ue
(0, "7");

2083 
db
.
	`»¶aû_docum’t
(7, 
doc
);

2086 
i
 = 
db
.
	`po¡li¡_begš
("");

2087 
’d
 = 
db
.
	`po¡li¡_’d
("");

2088 
	`TEST
(
i
 !ğ
’d
);

2089 
	`TEST_EQUAL
(*
i
, 5);

2090 
	`TEST_EQUAL
(
i
.
	`g‘_doş’gth
(), 0);

2091 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 1);

2092 ++
i
;

2093 
	`TEST
(
i
 !ğ
’d
);

2094 
	`TEST_EQUAL
(*
i
, 7);

2095 
	`TEST_EQUAL
(
i
.
	`g‘_doş’gth
(), 0);

2096 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 1);

2097 ++
i
;

2098 
	`TEST
(
i
 =ğ
’d
);

2101 
db
.
	`d–‘e_docum’t
(5);

2104 
i
 = 
db
.
	`po¡li¡_begš
("");

2105 
’d
 = 
db
.
	`po¡li¡_’d
("");

2106 
	`TEST
(
i
 !ğ
’d
);

2107 
	`TEST_EQUAL
(*
i
, 7);

2108 
	`TEST_EQUAL
(
i
.
	`g‘_doş’gth
(), 0);

2109 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 1);

2110 ++
i
;

2111 
	`TEST
(
i
 =ğ
’d
);

2115 
db
.
	`comm™
();

2116 
i
 = 
db
.
	`po¡li¡_begš
("");

2117 
’d
 = 
db
.
	`po¡li¡_’d
("");

2120 
	`TEST
(
i
 !ğ
’d
);

2121 
	`TEST_EQUAL
(*
i
, 7);

2122 
	`TEST_EQUAL
(
i
.
	`g‘_doş’gth
(), 0);

2123 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 1);

2124 ++
i
;

2125 
	`TEST
(
i
 =ğ
’d
);

2127  
Œue
;

2128 
	}
}

2131 
	$DEFINE_TESTCASE
(
v®uege1
, 
back’d
) {

2132 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

2133 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

2134 cÚ¡ * 
v®s
[] = {

2135 "", " ", "a", "¯", "abcd", "e", "g", "h", "hzz", "i", "l", "z", 
NULL


2137 cÚ¡ **
¡¬t
 = 
v®s
; *start; ++start) {

2138 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_VALUE_GE
, 1, *
¡¬t
);

2139 
’q
.
	`£t_qu”y
(
qu”y
);

2140 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 20);

2142 
£t
<
X­Ÿn
::
docid
> 
m©ched
;

2143 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
;

2144 
i
 = 
m£t
.
	`begš
(); i !ğm£t.
	`’d
(); ++i) {

2145 
m©ched
.
	`š£¹
(*
i
);

2146 
¡ršg
 
v®ue
 = 
db
.
	`g‘_docum’t
(*
i
).
	`g‘_v®ue
(1);

2147 
tout
 << "'" << *
¡¬t
 << "' <ğ'" << 
v®ue
 << "'" << 
’dl
;

2148 
	`TEST_REL
(
v®ue
,>=,*
¡¬t
);

2152 
X­Ÿn
::
docid
 
j
 = 
db
.
	`g‘_Ï¡docid
(); j != 0; --j) {

2153 ià(
m©ched
.
	`fšd
(
j
è=ğm©ched.
	`’d
()) {

2154 
¡ršg
 
v®ue
 = 
db
.
	`g‘_docum’t
(
j
).
	`g‘_v®ue
(1);

2155 
tout
 << 
v®ue
 << " < '" << *
¡¬t
 << "'" << 
’dl
;

2156 
	`TEST_REL
(
v®ue
,<,*
¡¬t
);

2160  
Œue
;

2161 
	}
}

2164 
	$DEFINE_TESTCASE
(
v®u–e1
, 
back’d
) {

2165 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

2166 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

2167 cÚ¡ * 
v®s
[] = {

2168 "", " ", "a", "¯", "abcd", "e", "g", "h", "hzz", "i", "l", "z", 
NULL


2170 cÚ¡ **
’d
 = 
v®s
; *end; ++end) {

2171 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_VALUE_LE
, 1, *
’d
);

2172 
’q
.
	`£t_qu”y
(
qu”y
);

2173 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 20);

2175 
£t
<
X­Ÿn
::
docid
> 
m©ched
;

2176 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
;

2177 
i
 = 
m£t
.
	`begš
(); i !ğm£t.
	`’d
(); ++i) {

2178 
m©ched
.
	`š£¹
(*
i
);

2179 
¡ršg
 
v®ue
 = 
db
.
	`g‘_docum’t
(*
i
).
	`g‘_v®ue
(1);

2180 
tout
 << "'" << *
’d
 << "' <ğ'" << 
v®ue
 << "'" << 
’dl
;

2181 
	`TEST
(
v®ue
 <ğ*
’d
);

2184 
X­Ÿn
::
docid
 
j
 = 
db
.
	`g‘_Ï¡docid
(); j != 0; --j) {

2185 ià(
m©ched
.
	`fšd
(
j
è=ğm©ched.
	`’d
()) {

2186 
¡ršg
 
v®ue
 = 
db
.
	`g‘_docum’t
(
j
).
	`g‘_v®ue
(1);

2187 
tout
 << 
v®ue
 << " < '" << *
’d
 << "'" << 
’dl
;

2188 
	`TEST
(
v®ue
 > *
’d
);

2192  
Œue
;

2193 
	}
}

2196 
	$DEFINE_TESTCASE
(
sÿËweight1
, 
back’d
) {

2197 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

2198 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

2199 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

2201 cÚ¡ * 
qu”›s
[] = {

2210 
NULL


2212 cÚ¡ 
muÉl›rs
[] = {

2217 cÚ¡ **
q¡r
 = 
qu”›s
; *qstr; ++qstr) {

2218 
X­Ÿn
::
Qu”y
 
qu”y1
 = 
qp
.
	`·r£_qu”y
(*
q¡r
);

2219 
tout
 << "qu”y1: " << 
qu”y1
.
	`g‘_desütiÚ
(è<< 
’dl
;

2220 cÚ¡ *
muÉp
 = 
muÉl›rs
; multp[0] != multp[1]; ++multp) {

2221 
muÉ
 = *
muÉp
;

2222 ià(
muÉ
 < 0) {

2223 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
,

2224 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_SCALE_WEIGHT
,

2225 
qu”y1
, 
muÉ
));

2228 
X­Ÿn
::
Qu”y
 
	`qu”y2
(X­Ÿn::Qu”y::
OP_SCALE_WEIGHT
, 
qu”y1
, 
muÉ
);

2229 
tout
 << "qu”y2: " << 
qu”y2
.
	`g‘_desütiÚ
(è<< 
’dl
;

2231 
’q
.
	`£t_qu”y
(
qu”y1
);

2232 
X­Ÿn
::
MS‘
 
m£t1
 = 
’q
.
	`g‘_m£t
(0, 20);

2233 
’q
.
	`£t_qu”y
(
qu”y2
);

2234 
X­Ÿn
::
MS‘
 
m£t2
 = 
’q
.
	`g‘_m£t
(0, 20);

2236 
	`TEST_EQUAL
(
m£t1
.
	`size
(), 
m£t2
.size());

2238 
X­Ÿn
::
MS‘I‹¿tÜ
 
i1
, 
i2
;

2239 ià(
muÉ
 > 0) {

2240 
i1
 = 
m£t1
.
	`begš
(), 
i2
 = 
m£t2
.begin();

2241 
i1
 !ğ
m£t1
.
	`’d
(è&& 
i2
 !ğ
m£t2
.end(); ++i1, ++i2) {

2242 
	`TEST_EQUAL_DOUBLE
(
i1
.
	`g‘_weight
(è* 
muÉ
, 
i2
.get_weight());

2243 
	`TEST_EQUAL
(*
i1
, *
i2
);

2247 
veùÜ
<
X­Ÿn
::
docid
> 
ids1
;

2248 
veùÜ
<
X­Ÿn
::
docid
> 
ids2
;

2249 
i1
 = 
m£t1
.
	`begš
(), 
i2
 = 
m£t2
.begin();

2250 
i1
 !ğ
m£t1
.
	`’d
(è&& 
i2
 !ğ
m£t2
.end(); ++i1, ++i2) {

2251 
	`TEST_NOT_EQUAL_DOUBLE
(
i1
.
	`g‘_weight
(), 0);

2252 
	`TEST_EQUAL_DOUBLE
(
i2
.
	`g‘_weight
(), 0);

2253 
ids1
.
	`push_back
(*
i1
);

2254 
ids2
.
	`push_back
(*
i2
);

2256 
	`sÜt
(
ids1
.
	`begš
(), ids1.
	`’d
());

2257 
	`TEST_EQUAL
(
ids1
, 
ids2
);

2261  
Œue
;

2262 
	}
}

2266 
	$DEFINE_TESTCASE
(
sÿËweight2
, 
back’d
) {

2267 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

2268 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

2269 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
;

2271 
X­Ÿn
::
Qu”y
 
	`qu”y1
("fridg");

2272 
X­Ÿn
::
Qu”y
 
	`qu”y2
(X­Ÿn::Qu”y::
OP_SCALE_WEIGHT
, 
qu”y1
, 2.5);

2273 
X­Ÿn
::
Qu”y
 
	`qu”y3
("milk");

2274 
X­Ÿn
::
Qu”y
 
	`qu”y4
(X­Ÿn::Qu”y::
OP_SCALE_WEIGHT
, 
qu”y3
, 0);

2275 
X­Ÿn
::
Qu”y
 
	`qu”y5
(X­Ÿn::Qu”y::
OP_OR
, 
qu”y2
, 
qu”y4
);

2284 
veùÜ
<
X­Ÿn
::
docid
> 
ids1
;

2285 
£t
<
X­Ÿn
::
docid
> 
idsš1
;

2286 
veùÜ
<
X­Ÿn
::
docid
> 
ids3
;

2288 
’q
.
	`£t_qu”y
(
qu”y1
);

2289 
X­Ÿn
::
MS‘
 
m£t1
 = 
’q
.
	`g‘_m£t
(0, 20);

2290 
’q
.
	`£t_qu”y
(
qu”y3
);

2291 
X­Ÿn
::
MS‘
 
m£t3
 = 
’q
.
	`g‘_m£t
(0, 20);

2292 
	`TEST_NOT_EQUAL
(
m£t1
.
	`size
(), 0);

2293 
i
 = 
m£t1
.
	`begš
(); i !ğm£t1.
	`’d
(); ++i) {

2294 
ids1
.
	`push_back
(*
i
);

2295 
idsš1
.
	`š£¹
(*
i
);

2297 
	`TEST_NOT_EQUAL
(
m£t3
.
	`size
(), 0);

2298 
i
 = 
m£t3
.
	`begš
(); i !ğm£t3.
	`’d
(); ++i) {

2299 ià(
idsš1
.
	`fšd
(*
i
è!ğidsš1.
	`’d
())

2301 
ids3
.
	`push_back
(*
i
);

2303 
	`sÜt
(
ids3
.
	`begš
(), ids3.
	`’d
());

2304 
ids1
.
	`š£¹
(ids1.
	`’d
(), 
ids3
.
	`begš
(), ids3.end());

2307 
veùÜ
<
X­Ÿn
::
docid
> 
ids5
;

2308 
’q
.
	`£t_qu”y
(
qu”y5
);

2309 
X­Ÿn
::
MS‘
 
m£t5
 = 
’q
.
	`g‘_m£t
(0, 20);

2310 
i
 = 
m£t5
.
	`begš
(); i !ğm£t5.
	`’d
(); ++i) {

2311 
ids5
.
	`push_back
(*
i
);

2314 
	`TEST_EQUAL
(
ids1
, 
ids5
);

2315  
Œue
;

2316 
	}
}

2320 
	$DEFINE_TESTCASE
(
bm25weight1
, 
back’d
) {

2321 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

2322 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BM25Weight
(1, 25, 1, 0.01, 0.5));

2323 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word") );

2325 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 25);

2327  
Œue
;

2328 
	}
}

2331 
	$DEFINE_TESTCASE
(
Œadweight1
, 
back’d
) {

2332 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

2333 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`T¿dWeight
());

2334 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word") );

2336 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 25);

2338 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`T¿dWeight
(0));

2339 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word") );

2341 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 25);

2345  
Œue
;

2346 
	}
}

2349 
DEFINE_TESTCASE
(
uuid1
, 
back’d
 && !
muÉi
) {

2350 
SKIP_TEST_FOR_BACKEND
("inmemory");

2351 
	gX­Ÿn
::
D©aba£
 
db
 = 
g‘_d©aba£
("apitest_simpledata");

2352 
¡ršg
 
	guuid1
 = 
db
.
g‘_uuid
();

2355 
	gX­Ÿn
::
D©aba£
 
db2
;

2356 
TEST_EQUAL
(
¡ršg
(), 
db2
.
g‘_uuid
());

2358 
	gdb2
.
add_d©aba£
(
db
);

2359 
TEST_EQUAL
(
uuid1
, 
db2
.
g‘_uuid
());

2363 
	gdb2
.
add_d©aba£
(
db
);

2364 
TEST_EQUAL
(
uuid1
 + ":" + uuid1, 
db2
.
g‘_uuid
());

2366 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


2369 
	gdb2
.
add_d©aba£
(
X­Ÿn
::
InMemÜy
::
İ’
());

2370 
TEST_EQUAL
(
¡ršg
(), 
db2
.
g‘_uuid
());

2373  
	gŒue
;

	@tests/api_anydb.h

2 
boŞ
 
‹¡_z”odocid1
();

3 
boŞ
 
‹¡_em±yqu”y1
();

4 
boŞ
 
‹¡_sim¶equ”y1
();

5 
boŞ
 
‹¡_sim¶equ”y2
();

6 
boŞ
 
‹¡_sim¶equ”y3
();

7 
boŞ
 
‹¡_wdqu”y1
();

8 
boŞ
 
‹¡_muÉidb1
();

9 
boŞ
 
‹¡_muÉidb2
();

10 
boŞ
 
‹¡_muÉidb3
();

11 
boŞ
 
‹¡_muÉidb4
();

12 
boŞ
 
‹¡_muÉidb5
();

13 
boŞ
 
‹¡_m£tmax™ems1
();

14 
boŞ
 
‹¡_ex·ndweights1
();

15 
boŞ
 
‹¡_ex·ndweights2
();

16 
boŞ
 
‹¡_ex·ndmax™ems1
();

17 
boŞ
 
‹¡_boŞqu”y1
();

18 
boŞ
 
‹¡_m£tfœ¡1
();

19 
boŞ
 
‹¡_tİ”ûÁ1
();

20 
boŞ
 
‹¡_tİ”ûÁ2
();

21 
boŞ
 
‹¡_ex·ndfunùÜ1
();

22 
boŞ
 
‹¡_pùcutoff1
();

23 
boŞ
 
‹¡_pùcutoff2
();

24 
boŞ
 
‹¡_pùcutoff3
();

25 
boŞ
 
‹¡_cutoff1
();

26 
boŞ
 
‹¡_®lowq‹rms1
();

27 
boŞ
 
‹¡_max©š1
();

28 
boŞ
 
‹¡_»v”£boŞ1
();

29 
boŞ
 
‹¡_»v”£boŞ2
();

30 
boŞ
 
‹¡_g‘m‹rms1
();

31 
boŞ
 
‹¡_g‘m‹rms2
();

32 
boŞ
 
‹¡_poscŞÏp£1
();

33 
boŞ
 
‹¡_»³©qu”y1
();

34 
boŞ
 
‹¡_ãtchdocs1
();

35 
boŞ
 
‹¡_ab£Á‹rm1
();

36 
boŞ
 
‹¡_ab£Á‹rm2
();

37 
boŞ
 
‹¡_r£t1
();

38 
boŞ
 
‹¡_r£t2
();

39 
boŞ
 
‹¡_r£tmuÉidb1
();

40 
boŞ
 
‹¡_r£tmuÉidb3
();

41 
boŞ
 
‹¡_–™e£t1
();

42 
boŞ
 
‹¡_–™e£t2
();

43 
boŞ
 
‹¡_–™e£t3
();

44 
boŞ
 
‹¡_–™e£t4
();

45 
boŞ
 
‹¡_–™e£t5
();

46 
boŞ
 
‹¡_‹rmli¡‹rmäeq1
();

47 
boŞ
 
‹¡_q‹rmšfo1
();

48 
boŞ
 
‹¡_q‹rmšfo2
();

49 
boŞ
 
‹¡_m£tz”o™ems1
();

50 
boŞ
 
‹¡_m©ches1
();

51 
boŞ
 
‹¡_wqf1
();

52 
boŞ
 
‹¡_qËn1
();

53 
boŞ
 
‹¡_‹rmli¡1
();

54 
boŞ
 
‹¡_‹rmli¡2
();

55 
boŞ
 
‹¡_‹rmli¡3
();

56 
boŞ
 
‹¡_‹rmli¡4
();

57 
boŞ
 
‹¡_punù”ms1
();

58 
boŞ
 
‹¡_¥aû‹rms1
();

59 
boŞ
 
‹¡_xÜ1
();

60 
boŞ
 
‹¡_g‘doc1
();

61 
boŞ
 
‹¡_em±yİ1
();

62 
boŞ
 
‹¡_check©Ëa¡1
();

63 
boŞ
 
‹¡_check©Ëa¡2
();

64 
boŞ
 
‹¡_check©Ëa¡3
();

65 
boŞ
 
‹¡_®Ío¡li¡1
();

66 
boŞ
 
‹¡_em±y‹rm1
();

67 
boŞ
 
‹¡_v®u”ªge1
();

68 
boŞ
 
‹¡_v®u”ªge2
();

69 
boŞ
 
‹¡_®ldoc¥l1
();

70 
boŞ
 
‹¡_®ldoc¥l2
();

71 
boŞ
 
‹¡_v®uege1
();

72 
boŞ
 
‹¡_v®u–e1
();

73 
boŞ
 
‹¡_sÿËweight1
();

74 
boŞ
 
‹¡_sÿËweight2
();

75 
boŞ
 
‹¡_bm25weight1
();

76 
boŞ
 
‹¡_Œadweight1
();

77 
boŞ
 
‹¡_uuid1
();

	@tests/api_backend.cc

22 
	~<cÚfig.h
>

24 
	~"­i_back’d.h
"

26 
	#XAPIAN_DEPRECATED
(
X
è
	)
X

27 
	~<x­Ÿn.h
>

29 
	~"‹¡su™e.h
"

30 
	~"‹¡uts.h
"

31 
	~"uts.h
"

33 
	~"­™e¡.h
"

35 
	~"§ãuni¡d.h
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

40 
DEFINE_TESTCASE
(
lockfeumask1
, 
b¿ss
 || 
ch”t
 || 
æšt
) {

41 #ià!
defšed
 
__WIN32__
 && !defšed 
__CYGWIN__
 && !defšed 
__EMX__


42 
mode_t
 
	gŞd_umask
 = 
umask
(022);

43 
	gŒy
 {

44 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_Çmed_wr™abË_d©aba£
("lockfileumask1");

46 
¡ršg
 
	g·th
 = 
g‘_Çmed_wr™abË_d©aba£_·th
("lockfileumask1");

47 
	g·th
 += "/flintlock";

49 
¡©
 
	g¡©buf
;

50 
TEST
(
¡©
(
·th
, &
¡©buf
) == 0);

51 
TEST_EQUAL
(
¡©buf
.
¡_mode
 & 0777, 0644);

52 } 
ÿtch
 (...) {

53 
umask
(
Şd_umask
);

54 
	gthrow
;

57 
umask
(
Şd_umask
);

60  
	gŒue
;

64 
	$DEFINE_TESTCASE
(
tÙ®doş’1
, 
wr™abË
) {

65 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

66 
X­Ÿn
::
Docum’t
 
doc
;

67 
doc
.
	`add_po¡šg
("foo", 1, 2000000000);

68 
db
.
	`add_docum’t
(
doc
);

69 
db
.
	`add_docum’t
(
doc
);

70 
	`TEST_EQUAL
(
db
.
	`g‘_avËngth
(), 2000000000);

71 
db
.
	`comm™
();

72 
	`TEST_EQUAL
(
db
.
	`g‘_avËngth
(), 2000000000);

73 ià(
	`g‘_dbty³
() != "inmemory") {

75 
X­Ÿn
::
D©aba£
 
dbr
 = 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

76 
	`TEST_EQUAL
(
dbr
.
	`g‘_avËngth
(), 2000000000);

78  
Œue
;

79 
	}
}

81 
	$DEFINE_TESTCASE
(
db¡©s1
, 
back’d
) {

82 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
("etext");

86 cÚ¡ 
X­Ÿn
::
‹rmcouÁ
 
mš_Ën
 = 2;

87 cÚ¡ 
X­Ÿn
::
‹rmcouÁ
 
max_Ën
 = 532;

88 cÚ¡ 
X­Ÿn
::
‹rmcouÁ
 
max_wdf
 = 22;

90 ià(
	`g‘_dbty³
().
	`fšd
("ch”t"è!ğ
¡ršg
::
Åos
 ||

91 
	`g‘_dbty³
().
	`fšd
("b¿ss"è!ğ
¡ršg
::
Åos
) {

93 
	`TEST_EQUAL
(
db
.
	`g‘_doş’gth_uµ”_bound
(), 
max_Ën
);

94 
	`TEST_EQUAL
(
db
.
	`g‘_doş’gth_low”_bound
(), 
mš_Ën
);

97 
	`TEST_REL
(
db
.
	`g‘_doş’gth_uµ”_bound
(),>=,
max_Ën
);

98 
	`TEST_REL
(
db
.
	`g‘_doş’gth_low”_bound
(),<=,
mš_Ën
);

101 
	`TEST_REL
(
db
.
	`g‘_wdf_uµ”_bound
("the"),>=,
max_wdf
);

103  
Œue
;

104 
	}
}

107 
	$DEFINE_TESTCASE
(
®ldoc¥l3
, 
back’d
) {

108 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
(
	`¡ršg
());

110 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
(
	`¡ršg
()), 0);

111 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
(
	`¡ršg
()), 0);

112 
	`TEST
(
db
.
	`po¡li¡_begš
(
	`¡ršg
()è=ğdb.
	`po¡li¡_’d
(string()));

114  
Œue
;

115 
	}
}

118 
	$DEFINE_TESTCASE
(
modif›dpo¡li¡1
, 
wr™abË
) {

119 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

120 
X­Ÿn
::
Docum’t
 
a
, 
b
;

121 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

123 
a
.
	`add_‹rm
("T");

124 
’q
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("T"));

126 
db
.
	`»¶aû_docum’t
(2, 
a
);

127 
db
.
	`comm™
();

128 
db
.
	`»¶aû_docum’t
(1, 
a
);

129 
db
.
	`»¶aû_docum’t
(1, 
b
);

131 
	`m£t_ex³ù_Üd”
(
’q
.
	`g‘_m£t
(0, 2), 2);

133  
Œue
;

134 
	}
}

137 
	$DEFINE_TESTCASE
(
doş’aá”comm™1
, 
wr™abË
) {

138 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

139 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_doş’gth
(1));

140 
db
.
	`»¶aû_docum’t
(1, 
X­Ÿn
::
	`Docum’t
());

141 
db
.
	`comm™
();

142 
	`TEST_EQUAL
(
db
.
	`g‘_doş’gth
(1), 0);;

143  
Œue
;

144 
	}
}

146 
	$DEFINE_TESTCASE
(
v®ue§á”comm™1
, 
wr™abË
) {

147 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

148 
X­Ÿn
::
Docum’t
 
doc
;

149 
doc
.
	`add_v®ue
(0, "value");

150 
db
.
	`»¶aû_docum’t
(2, 
doc
);

151 
db
.
	`comm™
();

152 
db
.
	`»¶aû_docum’t
(1, 
doc
);

153 
db
.
	`»¶aû_docum’t
(3, 
doc
);

154 
	`TEST_EQUAL
(
db
.
	`g‘_docum’t
(3).
	`g‘_v®ue
(0), "value");

155 
db
.
	`comm™
();

156 
	`TEST_EQUAL
(
db
.
	`g‘_docum’t
(3).
	`g‘_v®ue
(0), "value");

157  
Œue
;

158 
	}
}

160 
DEFINE_TESTCASE
(
lockfefd0Ü1
, 
b¿ss
 || 
ch”t
 || 
æšt
) {

161 #ià!
defšed
 
__WIN32__
 && !defšed 
__CYGWIN__
 && !defšed 
__EMX__


162 
	gŞd_¡dš
 = 
dup
(0);

163 
	gŞd_¡dout
 = 
dup
(1);

164 
	gŒy
 {

166 
şo£
(0);

168 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

169 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£LockE¼Ü
,

170 ()
g‘_wr™abË_d©aba£_agaš
());

173 
şo£
(1);

175 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

176 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£LockE¼Ü
,

177 ()
g‘_wr™abË_d©aba£_agaš
());

180 
dup2
(
Şd_¡dš
, 0);

182 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

183 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£LockE¼Ü
,

184 ()
g‘_wr™abË_d©aba£_agaš
());

186 } 
ÿtch
 (...) {

187 
dup2
(
Şd_¡dš
, 0);

188 
dup2
(
Şd_¡dout
, 1);

189 
şo£
(
Şd_¡dš
);

190 
şo£
(
Şd_¡dout
);

191 
	gthrow
;

194 
dup2
(
Şd_¡dout
, 1);

195 
şo£
(
Şd_¡dš
);

196 
şo£
(
Şd_¡dout
);

199  
	gŒue
;

202 
	gMyM©chDecid”
 : 
public
 
X­Ÿn
::
M©chDecid”
 {

203 
mubË
 
boŞ
 
ÿÎed
;

205 
MyM©chDecid”
(è: 
ÿÎed
(
çl£
) { }

207 
boŞ
 
İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &) const {

208 
ÿÎed
 = 
Œue
;

209  
	gŒue
;

214 
	$DEFINE_TESTCASE
(
m©chdecid”4
, 
»mÙe
) {

215 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

216 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

217 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("paragraph"));

219 
MyM©chDecid”
 
mdecid”
, 
m¥yŞd
;

220 
X­Ÿn
::
MS‘
 
m£t
;

222 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

223 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10, 
NULL
, &
mdecid”
));

224 
	`TEST
(!
mdecid”
.
ÿÎed
);

226 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

227 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10, 0, 
NULL
, NULL, &
m¥yŞd
));

228 
	`TEST
(!
m¥yŞd
.
ÿÎed
);

230 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

231 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10, 0, 
NULL
, &
mdecid”
, &
m¥yŞd
));

232 
	`TEST
(!
mdecid”
.
ÿÎed
);

233 
	`TEST
(!
m¥yŞd
.
ÿÎed
);

235  
Œue
;

236 
	}
}

241 
DEFINE_TESTCASE
(
»¶aûdoc7
, 
wr™abË
 && !
šmemÜy
 && !
»mÙe
) {

247 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
(
g‘_wr™abË_d©aba£
());

248 
	gX­Ÿn
::
Docum’t
 
doc
;

249 
	gdoc
.
£t_d©a
("fish");

250 
	gdoc
.
add_‹rm
("Hlocalhost");

251 
	gdoc
.
add_po¡šg
("hello", 1);

252 
	gdoc
.
add_po¡šg
("world", 2);

253 
	gdoc
.
add_v®ue
(1, "myvalue");

254 
	gdb
.
add_docum’t
(
doc
);

255 
	gdb
.
comm™
();

261 
	gdoc
.
add_‹rm
("XREV2");

262 
	gdb
.
add_docum’t
(
doc
);

264 
	gi
 = 0; i < 10000; ++i) {

265 
	gdoc
 = 
db
.
g‘_docum’t
(1);

266 
	gdb
.
»¶aû_docum’t
(1, 
doc
);

269 
	gX­Ÿn
::
D©aba£
 
rodb
(
g‘_wr™abË_d©aba£_as_d©aba£
());

270 
TEST_EQUAL
(
rodb
.
g‘_doccouÁ
(), 1);

272 
	gdb
.
æush
();

273 
	grodb
.
»İ’
();

275 
TEST_EQUAL
(
rodb
.
g‘_doccouÁ
(), 2);

276  
	gŒue
;

283 
	$DEFINE_TESTCASE
(
»¶aûdoc8
, 
wr™abË
) {

284 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
());

286 
X­Ÿn
::
Docum’t
 
doc
;

287 
doc
.
	`£t_d©a
("fish");

288 
doc
.
	`add_‹rm
("takeaway");

289 
db
.
	`add_docum’t
(
doc
);

291 
db
.
	`d–‘e_docum’t
(1);

293 
X­Ÿn
::
Docum’t
 
doc
;

294 
doc
.
	`£t_d©a
("chips");

295 
doc
.
	`add_‹rm
("takeaway", 2);

296 
db
.
	`»¶aû_docum’t
(1, 
doc
);

298 
db
.
	`æush
();

299 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("takeaway"), 2);

300 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p
 = 
db
.
	`po¡li¡_begš
("takeaway");

301 
	`TEST
(
p
 !ğ
db
.
	`po¡li¡_’d
("takeaway"));

302 
	`TEST_EQUAL
(
p
.
	`g‘_wdf
(), 2);

303  
Œue
;

304 
	}
}

	@tests/api_backend.h

2 
boŞ
 
‹¡_lockfeumask1
();

3 
boŞ
 
‹¡_tÙ®doş’1
();

4 
boŞ
 
‹¡_db¡©s1
();

5 
boŞ
 
‹¡_®ldoc¥l3
();

6 
boŞ
 
‹¡_modif›dpo¡li¡1
();

7 
boŞ
 
‹¡_doş’aá”comm™1
();

8 
boŞ
 
‹¡_v®ue§á”comm™1
();

9 
boŞ
 
‹¡_lockfefd0Ü1
();

10 
boŞ
 
‹¡_m©chdecid”4
();

11 
boŞ
 
‹¡_»¶aûdoc7
();

12 
boŞ
 
‹¡_»¶aûdoc8
();

	@tests/api_closedb.cc

22 
	~<cÚfig.h
>

24 
	~"­i_şo£db.h
"

26 
	~<x­Ÿn.h
>

28 
	~"­™e¡.h
"

29 
	~"‹¡uts.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	#COUNT_CLOSEDEXC
(
CODE
) \

34 
Œy
 { 
CODE
; } 
	`ÿtch
 (
X­Ÿn
::
D©aba£E¼Ü
 &è{ ++
şo£dexc_couÁ
; }

	)

36 
	#IF_NOT_CLOSEDEXC
(
CODE
) \

38 
hadexc
 = 
çl£
; \

39 
Œy
 { \

40 
CODE
; \

41 } 
	`ÿtch
 (
X­Ÿn
::
D©aba£E¼Ü
 &) { \

42 ++
şo£dexc_couÁ
; \

43 
hadexc
 = 
Œue
; \

45 } 
çl£
); ià(
hadexc
)

	)

48 
	sşo£db1_™”©Üs
 {

49 
	mX­Ÿn
::
D©aba£
 
db
;

50 
	mX­Ÿn
::
Docum’t
 
doc1
;

51 
	mX­Ÿn
::
Po¡šgI‹¿tÜ
 
¶1
;

52 
	mX­Ÿn
::
Po¡šgI‹¿tÜ
 
¶2
;

53 
	mX­Ÿn
::
Po¡šgI‹¿tÜ
 
¶’d
;

55 
£tup
(
X­Ÿn
::
D©aba£
 
db_
) {

56 
db
 = 
db_
;

59 
	m¶1
 = 
db
.
po¡li¡_begš
("paragraph");

60 
	m¶2
 = 
db
.
po¡li¡_begš
("paragraph");

61 ++
	m¶2
;

62 
	m¶’d
 = 
db
.
po¡li¡_’d
("paragraph");

65 
³rfÜm
() {

66 
	mşo£dexc_couÁ
 = 0;

67 
boŞ
 
	mhadexc
;

70 
IF_NOT_CLOSEDEXC
(
doc1
 = 
db
.
g‘_docum’t
(1)) {

71 
COUNT_CLOSEDEXC
(
TEST_EQUAL
(
doc1
.
g‘_d©a
().
sub¡r
(0, 33),

73 
COUNT_CLOSEDEXC
(
doc1
.
‹rmli¡_begš
());

78 
COUNT_CLOSEDEXC
(
db
.
po¡li¡_begš
("paragraph"));

79 
COUNT_CLOSEDEXC
(
db
.
g‘_docum’t
(1).
g‘_v®ue
(1));

82 
COUNT_CLOSEDEXC
(
db
.
»İ’
());

84 
TEST_NOT_EQUAL
(
¶1
, 
¶’d
);

86 
COUNT_CLOSEDEXC
(
db
.
po¡li¡_begš
("paragraph"));

88 
COUNT_CLOSEDEXC
(
TEST_EQUAL
(*
¶1
, 1));

89 
COUNT_CLOSEDEXC
(
TEST_EQUAL
(
¶1
.
g‘_doş’gth
(), 28));

93 
boŞ
 
	madvªûd
 = 
çl£
;

94 
	mŒy
 {

95 ++
	m¶1
;

96 
	madvªûd
 = 
Œue
;

97 } 
ÿtch
 (
X­Ÿn
::
D©aba£E¼Ü
 &) {}

99 ià(
advªûd
) {

100 
COUNT_CLOSEDEXC
(
TEST_EQUAL
(*
¶1
, 2));

101 
COUNT_CLOSEDEXC
(
TEST_EQUAL
(
¶1
.
g‘_doş’gth
(), 81));

104  
	mşo£dexc_couÁ
;

109 
	$DEFINE_TESTCASE
(
şo£db1
, 
back’d
) {

110 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

111 
şo£db1_™”©Üs
 
™”s
;

114 
™”s
.
	`£tup
(
db
);

115 
şo£dexc_couÁ
 = 
™”s
.
	`³rfÜm
();

116 
	`TEST_EQUAL
(
şo£dexc_couÁ
, 0);

119 
™”s
.
	`£tup
(
db
);

122 
db
.
	`şo£
();

125 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£E¼Ü
, 
db
.
	`»İ’
());

128 
şo£dexc_couÁ
 = 
™”s
.
	`³rfÜm
();

129 
	`TEST_NOT_EQUAL
(
şo£dexc_couÁ
, 0);

132 
db
.
	`şo£
();

134  
Œue
;

135 
	}
}

138 
DEFINE_TESTCASE
(
şo£db2
, 
wr™abË
 && !
šmemÜy
 && !
»mÙe
) {

139 
	gX­Ÿn
::
Wr™abËD©aba£
 
dbw1
(
g‘_Çmed_wr™abË_d©aba£
("apitest_closedb2"));

140 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£LockE¼Ü
,

141 
X­Ÿn
::
Wr™abËD©aba£
(
g‘_Çmed_wr™abË_d©aba£_·th
("apitest_closedb2"),

142 
X­Ÿn
::
DB_OPEN
));

143 
	gdbw1
.
şo£
();

144 
	gX­Ÿn
::
Wr™abËD©aba£
 
dbw2
 = 
g‘_Çmed_wr™abË_d©aba£
("apitest_closedb2");

145 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£E¼Ü
, 
dbw1
.
po¡li¡_begš
("paragraph"));

146 
TEST_EQUAL
(
dbw2
.
po¡li¡_begš
("·¿g¿ph"), dbw2.
po¡li¡_’d
("paragraph"));

148  
	gŒue
;

152 
	$DEFINE_TESTCASE
(
şo£db3
, 
back’d
) {

153 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("etext"));

154 
db
.
	`şo£
();

155 
Œy
 {

156 
	`TEST
(
db
.
	`has_pos™iÚs
());

157 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
D©aba£E¼Ü
 &) {

159 
Œy
 {

160 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 566);

161 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
D©aba£E¼Ü
 &) {

163  
Œue
;

164 
	}
}

167 
DEFINE_TESTCASE
(
şo£db4
, 
wr™abË
 && !
šmemÜy
) {

168 
	gX­Ÿn
::
Wr™abËD©aba£
 
wdb
(
g‘_wr™abË_d©aba£
());

169 
	gwdb
.
add_docum’t
(
X­Ÿn
::
Docum’t
());

170 
TEST_EQUAL
(
wdb
.
g‘_doccouÁ
(), 1);

171 
	gwdb
.
şo£
();

172 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_wr™abË_d©aba£_as_d©aba£
());

173 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), 1);

174  
	gŒue
;

178 
DEFINE_TESTCASE
(
şo£db5
, 
Œª§ùiÚs
 && !
»mÙe
) {

182 
	gX­Ÿn
::
Wr™abËD©aba£
 
wdb
 = 
g‘_wr™abË_d©aba£
();

183 
	gwdb
.
begš_Œª§ùiÚ
();

184 
	gwdb
.
add_docum’t
(
X­Ÿn
::
Docum’t
());

185 
TEST_EQUAL
(
wdb
.
g‘_doccouÁ
(), 1);

186 
	gwdb
.
şo£
();

187 
	gX­Ÿn
::
D©aba£
 
db
 = 
g‘_wr™abË_d©aba£_as_d©aba£
();

188 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), 0);

193 
	gX­Ÿn
::
Wr™abËD©aba£
 
wdb
 = 
g‘_wr™abË_d©aba£
();

194 
	gwdb
.
begš_Œª§ùiÚ
(
çl£
);

195 
	gwdb
.
add_docum’t
(
X­Ÿn
::
Docum’t
());

196 
TEST_EQUAL
(
wdb
.
g‘_doccouÁ
(), 1);

197 
	gwdb
.
şo£
();

198 
	gX­Ÿn
::
D©aba£
 
db
 = 
g‘_wr™abË_d©aba£_as_d©aba£
();

199 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), 0);

201  
	gŒue
;

	@tests/api_closedb.h

2 
boŞ
 
‹¡_şo£db1
();

3 
boŞ
 
‹¡_şo£db2
();

4 
boŞ
 
‹¡_şo£db3
();

5 
boŞ
 
‹¡_şo£db4
();

6 
boŞ
 
‹¡_şo£db5
();

	@tests/api_collapse.cc

21 
	~<cÚfig.h
>

23 
	~"­i_cŞÏp£.h
"

25 
	~<x­Ÿn.h
>

27 
	~"­™e¡.h
"

28 
	~"‹¡uts.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	$DEFINE_TESTCASE
(
cŞÏp£key5
,
back’d
) {

34 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

35 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

37 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

39 
X­Ÿn
::
MS‘
 
fuÎ_m£t
 = 
’quœe
.
	`g‘_m£t
(0, 
db
.
	`g‘_doccouÁ
());

41 
X­Ÿn
::
v®u’o
 
¦Ù
 = 0; slot < 10; ++slot) {

42 
m­
<
¡ršg
, 
X­Ÿn
::
doccouÁ
> 
Îy
;

43 
X­Ÿn
::
docid
 
did
 = 1; did <ğ
db
.
	`g‘_doccouÁ
(); ++did) {

44 ++
Îy
[
db
.
	`g‘_docum’t
(
did
).
	`g‘_v®ue
(
¦Ù
)];

47 
X­Ÿn
::
doccouÁ
 
cmax
 = 
db
.
	`g‘_doccouÁ
() + 1; cmax > 0; --cmax) {

48 
tout
 << "CŞÏpsšg oÀ¦Ù " << 
¦Ù
 << " max " << 
cmax
 << 
’dl
;

49 
’quœe
.
	`£t_cŞÏp£_key
(
¦Ù
, 
cmax
);

50 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 
fuÎ_m£t
.
	`size
());

53 
X­Ÿn
::
doccouÁ
 
ex³ù_size
 = 0;

54 
m­
<
¡ršg
, 
X­Ÿn
::
doccouÁ
>::
cÚ¡_™”©Ü
 
i
;

55 
i
 = 
Îy
.
	`begš
(); i !ğÎy.
	`’d
(); ++i) {

56 ià(
i
->
fœ¡
.
	`em±y
(è|| i->
£cÚd
 <ğ
cmax
) {

57 
ex³ù_size
 +ğ
i
->
£cÚd
;

59 
ex³ù_size
 +ğ
cmax
;

62 
	`TEST_EQUAL
(
m£t
.
	`size
(), 
ex³ù_size
);

66 
m­
<
¡ršg
, 
X­Ÿn
::
doccouÁ
> 
£’
;

67 
X­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
m£t
.
	`begš
(); j !ğm£t.
	`’d
(); ++j) {

68 cÚ¡ 
¡ršg
 & 
key
 = 
j
.
	`g‘_cŞÏp£_key
();

69 
	`TEST
(
Îy
.
	`fšd
(
key
è!ğÎy.
	`’d
());

70 ++
£’
[
key
];

72 
i
 = 
Îy
.
	`begš
(); i !ğÎy.
	`’d
(); ++i) {

73 ià(
i
->
fœ¡
.
	`em±y
(è|| i->
£cÚd
 <ğ
cmax
) {

74 
	`TEST_EQUAL
(
£’
[
i
->
fœ¡
], i->
£cÚd
);

76 
	`TEST_EQUAL
(
£’
[
i
->
fœ¡
], 
cmax
);

82  
Œue
;

83 
	}
}

	@tests/api_collapse.h

2 
boŞ
 
‹¡_cŞÏp£key5
();

	@tests/api_collated.h

3 ià(!
	gback’d
) {

4 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

5 { "deçuÉùÜ1", 
‹¡_deçuÉùÜ1
 },

6 { "cİyassign1", 
‹¡_cİyassign1
 },

7 { "m©ch¥y6", 
‹¡_m©ch¥y6
 },

8 { "ŒivŸl1", 
‹¡_ŒivŸl1
 },

9 { "g‘q‹rms1", 
‹¡_g‘q‹rms1
 },

10 { "g‘q‹rms2", 
‹¡_g‘q‹rms2
 },

11 { "em±yqu”y2", 
‹¡_em±yqu”y2
 },

12 { "em±yqu”y3", 
‹¡_em±yqu”y3
 },

13 { "qu”yËn1", 
‹¡_qu”yËn1
 },

14 { "qu”yËn2", 
‹¡_qu”yËn2
 },

15 { "qu”yv®id1", 
‹¡_qu”yv®id1
 },

16 { "subqcŞÏp£1", 
‹¡_subqcŞÏp£1
 },

17 { "em±yqu”y·¹1", 
‹¡_em±yqu”y·¹1
 },

18 { "sšgËsubq1", 
‹¡_sšgËsubq1
 },

19 { "¡emÏngs1", 
‹¡_¡emÏngs1
 },

20 { "weight1", 
‹¡_weight1
 },

21 { "nosuchdb1", 
‹¡_nosuchdb1
 },

22 { "addv®ue1", 
‹¡_addv®ue1
 },

23 { "poscŞÏp£2", 
‹¡_poscŞÏp£2
 },

24 { "unš™db1", 
‹¡_unš™db1
 },

25 { "sÿËweight3", 
‹¡_sÿËweight3
 },

26 { "sÿËweight4", 
‹¡_sÿËweight4
 },

27 { "r£t3", 
‹¡_r£t3
 },

28 { "r£t4", 
‹¡_r£t4
 },

29 { "İv®uege1", 
‹¡_İv®uege1
 },

30 { "v®ue£tm©chdecid”1", 
‹¡_v®ue£tm©chdecid”1
 },

31 { "em±ym£t1", 
‹¡_em±ym£t1
 },

32 { "nosubd©aba£s1", 
‹¡_nosubd©aba£s1
 },

33 { "docum’t1", 
‹¡_docum’t1
 },

34 { "qu”y‹rms1", 
‹¡_qu”y‹rms1
 },

35 { "m©chnÙhšg1", 
‹¡_m©chnÙhšg1
 },

36 { "Ã¬subqu”›s1", 
‹¡_Ã¬subqu”›s1
 },

37 { "£rŸli£_docum’t1", 
‹¡_£rŸli£_docum’t1
 },

38 { "£rŸli£_qu”y1", 
‹¡_£rŸli£_qu”y1
 },

39 { "£rŸli£_qu”y2", 
‹¡_£rŸli£_qu”y2
 },

40 { "£rŸli£_qu”y3", 
‹¡_£rŸli£_qu”y3
 },

41 { "£rŸli£_qu”y4", 
‹¡_£rŸli£_qu”y4
 },

42 { "doubË_»gi¡”_Ëak", 
‹¡_doubË_»gi¡”_Ëak
 },

43 { "»gi¡ry1", 
‹¡_»gi¡ry1
 },

44 { "»gi¡ry2", 
‹¡_»gi¡ry2
 },

45 { "»gi¡ry3", 
‹¡_»gi¡ry3
 },

46 { "muÉiv®uekeymak”1", 
‹¡_muÉiv®uekeymak”1
 },

47 { "utf8™”©Ü1", 
‹¡_utf8™”©Ü1
 },

48 { "utf8™”©Ü2", 
‹¡_utf8™”©Ü2
 },

49 { "unicode1", 
‹¡_unicode1
 },

50 { "ÿ£cÚv”t1", 
‹¡_ÿ£cÚv”t1
 },

51 { "ÿ£cÚv”t2", 
‹¡_ÿ£cÚv”t2
 },

52 { "utf8cÚv”t1", 
‹¡_utf8cÚv”t1
 },

53 { "unicod•»diÿ‹s1", 
‹¡_unicod•»diÿ‹s1
 },

54 { "v®ue¡©s5", 
‹¡_v®ue¡©s5
 },

55 { "fixedweightsourû2", 
‹¡_fixedweightsourû2
 },

58 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

60 ià(
	gback’d
) {

61 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

62 { "z”odocid1", 
‹¡_z”odocid1
 },

63 { "em±yqu”y1", 
‹¡_em±yqu”y1
 },

64 { "sim¶equ”y1", 
‹¡_sim¶equ”y1
 },

65 { "sim¶equ”y2", 
‹¡_sim¶equ”y2
 },

66 { "sim¶equ”y3", 
‹¡_sim¶equ”y3
 },

67 { "wdqu”y1", 
‹¡_wdqu”y1
 },

68 { "muÉidb1", 
‹¡_muÉidb1
 },

69 { "m£tmax™ems1", 
‹¡_m£tmax™ems1
 },

70 { "ex·ndweights1", 
‹¡_ex·ndweights1
 },

71 { "ex·ndweights2", 
‹¡_ex·ndweights2
 },

72 { "ex·ndmax™ems1", 
‹¡_ex·ndmax™ems1
 },

73 { "boŞqu”y1", 
‹¡_boŞqu”y1
 },

74 { "m£tfœ¡1", 
‹¡_m£tfœ¡1
 },

75 { "tİ”ûÁ1", 
‹¡_tİ”ûÁ1
 },

76 { "tİ”ûÁ2", 
‹¡_tİ”ûÁ2
 },

77 { "ex·ndfunùÜ1", 
‹¡_ex·ndfunùÜ1
 },

78 { "pùcutoff1", 
‹¡_pùcutoff1
 },

79 { "pùcutoff2", 
‹¡_pùcutoff2
 },

80 { "pùcutoff3", 
‹¡_pùcutoff3
 },

81 { "cutoff1", 
‹¡_cutoff1
 },

82 { "®lowq‹rms1", 
‹¡_®lowq‹rms1
 },

83 { "max©š1", 
‹¡_max©š1
 },

84 { "»v”£boŞ1", 
‹¡_»v”£boŞ1
 },

85 { "»v”£boŞ2", 
‹¡_»v”£boŞ2
 },

86 { "g‘m‹rms1", 
‹¡_g‘m‹rms1
 },

87 { "g‘m‹rms2", 
‹¡_g‘m‹rms2
 },

88 { "poscŞÏp£1", 
‹¡_poscŞÏp£1
 },

89 { "»³©qu”y1", 
‹¡_»³©qu”y1
 },

90 { "ãtchdocs1", 
‹¡_ãtchdocs1
 },

91 { "ab£Á‹rm1", 
‹¡_ab£Á‹rm1
 },

92 { "ab£Á‹rm2", 
‹¡_ab£Á‹rm2
 },

93 { "r£t1", 
‹¡_r£t1
 },

94 { "r£t2", 
‹¡_r£t2
 },

95 { "–™e£t1", 
‹¡_–™e£t1
 },

96 { "–™e£t2", 
‹¡_–™e£t2
 },

97 { "–™e£t3", 
‹¡_–™e£t3
 },

98 { "–™e£t4", 
‹¡_–™e£t4
 },

99 { "–™e£t5", 
‹¡_–™e£t5
 },

100 { "‹rmli¡‹rmäeq1", 
‹¡_‹rmli¡‹rmäeq1
 },

101 { "q‹rmšfo1", 
‹¡_q‹rmšfo1
 },

102 { "q‹rmšfo2", 
‹¡_q‹rmšfo2
 },

103 { "m£tz”o™ems1", 
‹¡_m£tz”o™ems1
 },

104 { "m©ches1", 
‹¡_m©ches1
 },

105 { "wqf1", 
‹¡_wqf1
 },

106 { "qËn1", 
‹¡_qËn1
 },

107 { "‹rmli¡1", 
‹¡_‹rmli¡1
 },

108 { "‹rmli¡2", 
‹¡_‹rmli¡2
 },

109 { "‹rmli¡3", 
‹¡_‹rmli¡3
 },

110 { "‹rmli¡4", 
‹¡_‹rmli¡4
 },

111 { "punù”ms1", 
‹¡_punù”ms1
 },

112 { "¥aû‹rms1", 
‹¡_¥aû‹rms1
 },

113 { "xÜ1", 
‹¡_xÜ1
 },

114 { "g‘doc1", 
‹¡_g‘doc1
 },

115 { "em±yİ1", 
‹¡_em±yİ1
 },

116 { "check©Ëa¡1", 
‹¡_check©Ëa¡1
 },

117 { "check©Ëa¡2", 
‹¡_check©Ëa¡2
 },

118 { "check©Ëa¡3", 
‹¡_check©Ëa¡3
 },

119 { "®Ío¡li¡1", 
‹¡_®Ío¡li¡1
 },

120 { "em±y‹rm1", 
‹¡_em±y‹rm1
 },

121 { "v®u”ªge1", 
‹¡_v®u”ªge1
 },

122 { "v®uege1", 
‹¡_v®uege1
 },

123 { "v®u–e1", 
‹¡_v®u–e1
 },

124 { "sÿËweight1", 
‹¡_sÿËweight1
 },

125 { "sÿËweight2", 
‹¡_sÿËweight2
 },

126 { "bm25weight1", 
‹¡_bm25weight1
 },

127 { "Œadweight1", 
‹¡_Œadweight1
 },

128 { "db¡©s1", 
‹¡_db¡©s1
 },

129 { "®ldoc¥l3", 
‹¡_®ldoc¥l3
 },

130 { "şo£db1", 
‹¡_şo£db1
 },

131 { "şo£db3", 
‹¡_şo£db3
 },

132 { "cŞÏp£key5", 
‹¡_cŞÏp£key5
 },

133 { "‹rm¡©s", 
‹¡_‹rm¡©s
 },

134 { "m£t™”©Ü1", 
‹¡_m£t™”©Ü1
 },

135 { "m£t™”©Ü2", 
‹¡_m£t™”©Ü2
 },

136 { "m£t™”©Ü3", 
‹¡_m£t™”©Ü3
 },

137 { "e£t™”©Ü1", 
‹¡_e£t™”©Ü1
 },

138 { "e£t™”©Ü2", 
‹¡_e£t™”©Ü2
 },

139 { "cŞÏp£key1", 
‹¡_cŞÏp£key1
 },

140 { "cŞÏp£key2", 
‹¡_cŞÏp£key2
 },

141 { "cŞÏp£key3", 
‹¡_cŞÏp£key3
 },

142 { "cŞÏp£key4", 
‹¡_cŞÏp£key4
 },

143 { "®É”ms1", 
‹¡_®É”ms1
 },

144 { "®É”ms2", 
‹¡_®É”ms2
 },

145 { "®É”ms3", 
‹¡_®É”ms3
 },

146 { "®É”ms4", 
‹¡_®É”ms4
 },

147 { "®É”ms5", 
‹¡_®É”ms5
 },

148 { "®É”ms6", 
‹¡_®É”ms6
 },

149 { "¥ecŸÉ”ms1", 
‹¡_¥ecŸÉ”ms1
 },

150 { "¥ecŸÉ”ms2", 
‹¡_¥ecŸÉ”ms2
 },

151 { "po¡li¡1", 
‹¡_po¡li¡1
 },

152 { "po¡li¡2", 
‹¡_po¡li¡2
 },

153 { "po¡li¡3", 
‹¡_po¡li¡3
 },

154 { "po¡li¡4", 
‹¡_po¡li¡4
 },

155 { "po¡li¡5", 
‹¡_po¡li¡5
 },

156 { "po¡li¡6", 
‹¡_po¡li¡6
 },

157 { "cŞläeq1", 
‹¡_cŞläeq1
 },

158 { "sÜtv®ue1", 
‹¡_sÜtv®ue1
 },

159 { "sÜŒ–1", 
‹¡_sÜŒ–1
 },

160 { "m©ch®l1", 
‹¡_m©ch®l1
 },

161 { "m©ch¥y5", 
‹¡_m©ch¥y5
 },

162 { "synÚym1", 
‹¡_synÚym1
 },

163 { "synÚym2", 
‹¡_synÚym2
 },

164 { "synÚym3", 
‹¡_synÚym3
 },

165 { "synÚym4", 
‹¡_synÚym4
 },

166 { "cÚsi¡’cy3", 
‹¡_cÚsi¡’cy3
 },

167 { "pùcutoff5", 
‹¡_pùcutoff5
 },

168 { "tİ”ûÁ4", 
‹¡_tİ”ûÁ4
 },

169 { "v®ueweightsourû1", 
‹¡_v®ueweightsourû1
 },

170 { "fixedweightsourû1", 
‹¡_fixedweightsourû1
 },

171 { "v®ue¡»am2", 
‹¡_v®ue¡»am2
 },

172 { "v®ue¡»am3", 
‹¡_v®ue¡»am3
 },

173 { "v®uem­sourû1", 
‹¡_v®uem­sourû1
 },

176 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

178 ià(
	gback’d
&&!
	gšmemÜy
&&!
	g»mÙe
) {

179 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

180 { "¡ubdb1", 
‹¡_¡ubdb1
 },

181 { "¡ubdb2", 
‹¡_¡ubdb2
 },

182 { "¡ubdb3", 
‹¡_¡ubdb3
 },

183 { "¡ubdb4", 
‹¡_¡ubdb4
 },

184 { "¡ubdb5", 
‹¡_¡ubdb5
 },

187 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

189 ià(
	gback’d
&&!
	gmuÉi
) {

190 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

191 { "muÉidb2", 
‹¡_muÉidb2
 },

192 { "muÉidb3", 
‹¡_muÉidb3
 },

193 { "muÉidb4", 
‹¡_muÉidb4
 },

194 { "muÉidb5", 
‹¡_muÉidb5
 },

195 { "r£tmuÉidb1", 
‹¡_r£tmuÉidb1
 },

196 { "r£tmuÉidb3", 
‹¡_r£tmuÉidb3
 },

197 { "uuid1", 
‹¡_uuid1
 },

198 { "r£tmuÉidb2", 
‹¡_r£tmuÉidb2
 },

199 { "muÉ›x·nd1", 
‹¡_muÉ›x·nd1
 },

200 { "v®ue¡»am1", 
‹¡_v®ue¡»am1
 },

201 { "v®uem­sourû2", 
‹¡_v®uem­sourû2
 },

202 { "decv®wtsourû4", 
‹¡_decv®wtsourû4
 },

205 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

207 ià(
	gback’d
&&!
	g»mÙe
) {

208 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

209 { "m©chdecid”1", 
‹¡_m©chdecid”1
 },

210 { "m©chdecid”2", 
‹¡_m©chdecid”2
 },

211 { "m©chdecid”3", 
‹¡_m©chdecid”3
 },

212 { "cÚsi¡’cy1", 
‹¡_cÚsi¡’cy1
 },

213 { "u£rweight1", 
‹¡_u£rweight1
 },

214 { "v®ue£tm©chdecid”2", 
‹¡_v®ue£tm©chdecid”2
 },

215 { "m©ch¥y1", 
‹¡_m©ch¥y1
 },

216 { "ex‹º®sourû4", 
‹¡_ex‹º®sourû4
 },

217 { "sÜtfunùÜ1", 
‹¡_sÜtfunùÜ1
 },

218 { "chªgesÜ‹r1", 
‹¡_chªgesÜ‹r1
 },

219 { "sÜtfunùÜem±y1", 
‹¡_sÜtfunùÜem±y1
 },

220 { "ŞdsÜtfunùÜ1", 
‹¡_ŞdsÜtfunùÜ1
 },

221 { "ŞdchªgesÜ‹r1", 
‹¡_ŞdchªgesÜ‹r1
 },

222 { "ŞdsÜtfunùÜem±y1", 
‹¡_ŞdsÜtfunùÜem±y1
 },

225 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

227 ià(
	gback’d
&&!
	g»mÙe
&&!
	gmuÉi
) {

228 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

229 { "pùcutoff4", 
‹¡_pùcutoff4
 },

230 { "ex‹º®sourû1", 
‹¡_ex‹º®sourû1
 },

231 { "ex‹º®sourû3", 
‹¡_ex‹º®sourû3
 },

232 { "chªgemaxweightsourû1", 
‹¡_chªgemaxweightsourû1
 },

233 { "em±yv®wtsourû1", 
‹¡_em±yv®wtsourû1
 },

236 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

238 ià(
	gb¿ss
||
	gch”t
||
	gæšt
) {

239 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

240 { "lockfeumask1", 
‹¡_lockfeumask1
 },

241 { "lockfefd0Ü1", 
‹¡_lockfefd0Ü1
 },

242 { "com·ùnÜ’umb”1", 
‹¡_com·ùnÜ’umb”1
 },

243 { "com·ùm”ge1", 
‹¡_com·ùm”ge1
 },

244 { "com·ùmuÉichunks1", 
‹¡_com·ùmuÉichunks1
 },

245 { "üash»cov”y1", 
‹¡_üash»cov”y1
 },

246 { "ÏzybËbug1", 
‹¡_ÏzybËbug1
 },

247 { "cursÜd–bug1", 
‹¡_cursÜd–bug1
 },

250 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

252 ià(
	gæšt
) {

253 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

254 { "æštd©aba£İ’šg”rÜ1", 
‹¡_æštd©aba£İ’šg”rÜ1
 },

255 { "æštd©aba£fÜm©”rÜ1", 
‹¡_æštd©aba£fÜm©”rÜ1
 },

256 { "æštd©aba£fÜm©”rÜ2", 
‹¡_æštd©aba£fÜm©”rÜ2
 },

257 { "æštd©aba£fÜm©”rÜ3", 
‹¡_æštd©aba£fÜm©”rÜ3
 },

258 { "æštbackw¬dcom·t1", 
‹¡_æštbackw¬dcom·t1
 },

259 { "æštbackw¬dcom·t2", 
‹¡_æštbackw¬dcom·t2
 },

260 { "æštd©aba£İ’1", 
‹¡_æštd©aba£İ’1
 },

263 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

265 ià(
	gšmemÜy
) {

266 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

267 { "¡ubdb6", 
‹¡_¡ubdb6
 },

270 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

272 ià(
	gm‘ad©a
) {

273 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

274 { "m‘ad©a3", 
‹¡_m‘ad©a3
 },

277 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

279 ià(
	gm‘ad©a
&&!
	gšmemÜy
) {

280 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

281 { "m‘ad©a2", 
‹¡_m‘ad©a2
 },

282 { "m‘ad©a4", 
‹¡_m‘ad©a4
 },

285 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

287 ià(
	gpos™iÚ®
) {

288 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

289 { "Ã¬1", 
‹¡_Ã¬1
 },

290 { "Ã¬2", 
‹¡_Ã¬2
 },

291 { "ph¿£1", 
‹¡_ph¿£1
 },

292 { "ph¿£2", 
‹¡_ph¿£2
 },

293 { "po¦i¡1", 
‹¡_po¦i¡1
 },

294 { "pos™äom‹rm™1", 
‹¡_pos™äom‹rm™1
 },

297 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

299 ià(
	gpos™iÚ®
&&
	gwr™abË
) {

300 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

301 { "po¦i¡2", 
‹¡_po¦i¡2
 },

302 { "po¦i¡3", 
‹¡_po¦i¡3
 },

303 { "po¦i¡upd©e1", 
‹¡_po¦i¡upd©e1
 },

306 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

308 ià(
	g»mÙe
) {

309 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

310 { "m©chdecid”4", 
‹¡_m©chdecid”4
 },

311 { "k“·live1", 
‹¡_k“·live1
 },

312 { "Ãt¡©s1", 
‹¡_Ãt¡©s1
 },

313 { "tİ”ûÁ3", 
‹¡_tİ”ûÁ3
 },

314 { "ex‹º®sourû2", 
‹¡_ex‹º®sourû2
 },

315 { "sÜtfunùÜ»mÙe1", 
‹¡_sÜtfunùÜ»mÙe1
 },

318 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

320 ià(
	g»¶iÿs
) {

321 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

322 { "»¶iÿ‹1", 
‹¡_»¶iÿ‹1
 },

325 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

327 ià(
	g¥–lšg
) {

328 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

329 { "¥–l1", 
‹¡_¥–l1
 },

330 { "¥–l2", 
‹¡_¥–l2
 },

331 { "¥–l3", 
‹¡_¥–l3
 },

332 { "¥–l4", 
‹¡_¥–l4
 },

333 { "¥–l5", 
‹¡_¥–l5
 },

334 { "¥–l6", 
‹¡_¥–l6
 },

337 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

339 ià(
	gsynÚyms
) {

340 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

341 { "qpsynÚym·¹Ÿl1", 
‹¡_qpsynÚym·¹Ÿl1
 },

344 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

346 ià(
	gŒª§ùiÚs
) {

347 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

348 { "badŒª§ùiÚ1", 
‹¡_badŒª§ùiÚ1
 },

349 { "comm™Œª§ùiÚ1", 
‹¡_comm™Œª§ùiÚ1
 },

350 { "ÿnûÉ¿n§ùiÚ1", 
‹¡_ÿnûÉ¿n§ùiÚ1
 },

351 { "ÿnûÉ¿n§ùiÚ2", 
‹¡_ÿnûÉ¿n§ùiÚ2
 },

354 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

356 ià(
	gŒª§ùiÚs
&&!
	g»mÙe
) {

357 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

358 { "şo£db5", 
‹¡_şo£db5
 },

361 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

363 ià(
	gŒª§ùiÚs
&&
	gv®ue¡©s
) {

364 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

365 { "v®ue¡©s2", 
‹¡_v®ue¡©s2
 },

366 { "v®ue¡©s4", 
‹¡_v®ue¡©s4
 },

369 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

371 ià(
	gv®ue¡©s
) {

372 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

373 { "v®ueweightsourû2", 
‹¡_v®ueweightsourû2
 },

374 { "v®ue¡©s3", 
‹¡_v®ue¡©s3
 },

377 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

379 ià(
	gv®ue¡©s
&&!
	gmuÉi
) {

380 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

381 { "v®ueweightsourû3", 
‹¡_v®ueweightsourû3
 },

384 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

386 ià(
	gwr™abË
) {

387 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

388 { "v®u”ªge2", 
‹¡_v®u”ªge2
 },

389 { "®ldoc¥l1", 
‹¡_®ldoc¥l1
 },

390 { "®ldoc¥l2", 
‹¡_®ldoc¥l2
 },

391 { "tÙ®doş’1", 
‹¡_tÙ®doş’1
 },

392 { "modif›dpo¡li¡1", 
‹¡_modif›dpo¡li¡1
 },

393 { "doş’aá”comm™1", 
‹¡_doş’aá”comm™1
 },

394 { "v®ue§á”comm™1", 
‹¡_v®ue§á”comm™1
 },

395 { "»¶aûdoc8", 
‹¡_»¶aûdoc8
 },

396 { "m©ch¥y2", 
‹¡_m©ch¥y2
 },

397 { "m©ch¥y4", 
‹¡_m©ch¥y4
 },

398 { "m‘ad©a1", 
‹¡_m‘ad©a1
 },

399 { "mod‹rmwdf1", 
‹¡_mod‹rmwdf1
 },

400 { "bigßddv®ue1", 
‹¡_bigßddv®ue1
 },

401 { "£rŸli£_docum’t2", 
‹¡_£rŸli£_docum’t2
 },

402 { "decv®wtsourû1", 
‹¡_decv®wtsourû1
 },

403 { "decv®wtsourû2", 
‹¡_decv®wtsourû2
 },

404 { "decv®wtsourû3", 
‹¡_decv®wtsourû3
 },

405 { "decv®wtsourû5", 
‹¡_decv®wtsourû5
 },

406 { "adddoc1", 
‹¡_adddoc1
 },

407 { "adddoc2", 
‹¡_adddoc2
 },

408 { "adddoc3", 
‹¡_adddoc3
 },

409 { "adddoc4", 
‹¡_adddoc4
 },

410 { "adddoc5", 
‹¡_adddoc5
 },

411 { "adddoc6", 
‹¡_adddoc6
 },

412 { "im¶ic™’d£ssiÚ1", 
‹¡_im¶ic™’d£ssiÚ1
 },

413 { "d©aba£assign1", 
‹¡_d©aba£assign1
 },

414 { "d–doc1", 
‹¡_d–doc1
 },

415 { "d–doc2", 
‹¡_d–doc2
 },

416 { "d–doc3", 
‹¡_d–doc3
 },

417 { "d–doc4", 
‹¡_d–doc4
 },

418 { "d–doc5", 
‹¡_d–doc5
 },

419 { "d–doc6", 
‹¡_d–doc6
 },

420 { "»¶aûdoc1", 
‹¡_»¶aûdoc1
 },

421 { "»¶aûdoc2", 
‹¡_»¶aûdoc2
 },

422 { "»¶aûdoc3", 
‹¡_»¶aûdoc3
 },

423 { "»¶aûdoc4", 
‹¡_»¶aûdoc4
 },

424 { "»¶aûdoc5", 
‹¡_»¶aûdoc5
 },

425 { "»¶aûdoc6", 
‹¡_»¶aûdoc6
 },

426 { "uniqu‘”m1", 
‹¡_uniqu‘”m1
 },

427 { "®Ío¡li¡2", 
‹¡_®Ío¡li¡2
 },

428 { "em±y‹rm2", 
‹¡_em±y‹rm2
 },

429 { "ph¿£ÜÃ¬tßnd1", 
‹¡_ph¿£ÜÃ¬tßnd1
 },

430 { "lÚgpos™iÚli¡1", 
‹¡_lÚgpos™iÚli¡1
 },

431 { "cÚsi¡’cy2", 
‹¡_cÚsi¡’cy2
 },

432 { "nomÜedocids1", 
‹¡_nomÜedocids1
 },

433 { "‹rmtoŞÚg1", 
‹¡_‹rmtoŞÚg1
 },

434 { "po¡li¡7", 
‹¡_po¡li¡7
 },

435 { "modifyv®ues1", 
‹¡_modifyv®ues1
 },

438 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

440 ià(
	gwr™abË
&&!
	gšmemÜy
) {

441 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

442 { "şo£db4", 
‹¡_şo£db4
 },

445 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

447 ià(
	gwr™abË
&&!
	gšmemÜy
&&!
	g»mÙe
) {

448 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

449 { "»¶aûdoc7", 
‹¡_»¶aûdoc7
 },

450 { "şo£db2", 
‹¡_şo£db2
 },

453 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

455 ià(
	gwr™abË
&&!
	g»mÙe
) {

456 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

457 { "m‘ad©a5", 
‹¡_m‘ad©a5
 },

458 { "sÜtfunùÜ2", 
‹¡_sÜtfunùÜ2
 },

459 { "ŞdsÜtfunùÜ2", 
‹¡_ŞdsÜtfunùÜ2
 },

462 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

464 ià(
	gwr™abË
&&
	gm‘ad©a
) {

465 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

466 { "wr™”—d1", 
‹¡_wr™”—d1
 },

469 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

471 ià(
	gwr™abË
&&
	gsynÚyms
) {

472 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

473 { "synÚym™Ü1", 
‹¡_synÚym™Ü1
 },

476 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

478 ià(
	gwr™abË
&&
	gv®ue¡©s
) {

479 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

480 { "v®ue¡©s1", 
‹¡_v®ue¡©s1
 },

481 { "v®ueweightsourû5", 
‹¡_v®ueweightsourû5
 },

484 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

	@tests/api_compact.cc

23 
	~<cÚfig.h
>

25 
	~"­i_com·ù.h
"

27 
	~"­™e¡.h
"

28 
	~"back’dmªag”.h
"

29 
	~"dbcheck.h
"

30 
	~"‹¡su™e.h
"

31 
	~"‹¡uts.h
"

33 
	~<x­Ÿn.h
>

35 
	~<c¡dlib
>

36 
	~"§ãsyswa™.h
"

38 
	~"¡r.h
"

39 
	~"uts.h
"

40 
	~"unixcmds.h
"

42 
	#XAPIAN_COMPACT
 
XAPIAN_BIN_PATH
"x­Ÿn-com·ù"

	)

44 #iâdeà
__WIN32__


45 
	#SILENT
 ">/dev/nuÎ 2>&1"

	)

47 
	#SILENT
 ">nuÈ2>nul"

	)

50 
usšg
 
Çme¥aû
 
	g¡d
;

53 
make_¥¬£_db
(
X­Ÿn
::
Wr™abËD©aba£
 &
db
, cÚ¡ 
¡ršg
 & 
s
)

56 * 
	gp
 = 
cÚ¡_ÿ¡
<*>(
s
.
c_¡r
());

58 *
	gp
) {

59 
boŞ
 
	gd–
 = (*
p
 == '!');

60 ià(
	gd–
è++
	gp
;

61 
	gX­Ÿn
::
docid
 
fœ¡
 = 
¡¹oul
(
p
, &p, 10);

62 
	gX­Ÿn
::
docid
 
Ï¡
 = 
fœ¡
;

63 ià(*
	gp
 == '-') {

64 
Ï¡
 = 
¡¹oul
(
p
 + 1, &p, 10);

66 ià(*
	gp
 && *p != ' ') {

67 
tout
 << 
p
 - 
s
.
c_¡r
(è<< 
’dl
;

68 
FAIL_TEST
("Bad s·r£ db s³øÓx³ùed s·û): " << 
s
);

70 ià(
	gfœ¡
 > 
	gÏ¡
) {

71 
FAIL_TEST
("Bad s·r£ db s³ø(fœ¡ >†a¡): " << 
s
);

75 ià(
	gd–
) {

76 
	gdb
.
d–‘e_docum’t
(
fœ¡
);

78 
	gX­Ÿn
::
Docum’t
 
doc
;

79 
¡ršg
 
	gid
 = 
¡r
(
fœ¡
);

80 
	gdoc
.
£t_d©a
(
id
);

81 
	gdoc
.
add_‹rm
("Q" + 
¡r
(
fœ¡
));

82 
	gdoc
.
add_‹rm
(
¡ršg
(
fœ¡
 % 7 + 1, ((first % 26) + 'a')));

83 
	gdb
.
»¶aû_docum’t
(
fœ¡
, 
doc
);

85 } 
	gfœ¡
++ < 
	gÏ¡
);

87 ià(*
	gp
 == '\0') ;

88 ++
	gp
;

91 
	gdb
.
comm™
();

95 
	$check_¥¬£_uid_‹rms
(cÚ¡ 
¡ršg
 & 
·th
)

97 
X­Ÿn
::
D©aba£
 
	`db
(
·th
);

98 
X­Ÿn
::
T”mI‹¿tÜ
 
t
;

99 
t
 = 
db
.
	`®É”ms_begš
("Q"); !ğdb.
	`®É”ms_’d
("Q"); ++t) {

100 
X­Ÿn
::
docid
 
did
 = 
	`©oi
((*
t
).
	`c_¡r
() + 1);

101 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p
 = 
db
.
	`po¡li¡_begš
(*
t
);

102 
	`TEST_EQUAL
(*
p
, 
did
);

104 
	}
}

106 
DEFINE_TESTCASE
(
com·ùnÜ’umb”1
, 
b¿ss
 || 
ch”t
 || 
æšt
) {

107 
	g¡©us
;

109 
¡ršg
 
	ga
 = 
g‘_d©aba£_·th
("com·ùnÜ’umb”1a", 
make_¥¬£_db
,

111 
¡ršg
 
	ga_uuid
;

113 
	gX­Ÿn
::
D©aba£
 
db
(
a
);

114 
	ga_uuid
 = 
db
.
g‘_uuid
();

116 
	ga
 += ' ';

117 
¡ršg
 
	gb
 = 
g‘_d©aba£_·th
("com·ùnÜ’umb”1b", 
make_¥¬£_db
,

119 
	gb
 += ' ';

120 
¡ršg
 
	gc
 = 
g‘_d©aba£_·th
("com·ùnÜ’umb”1c", 
make_¥¬£_db
,

122 
	gc
 += ' ';

123 
¡ršg
 
	gd
 = 
g‘_d©aba£_·th
("com·ùnÜ’umb”1d", 
make_¥¬£_db
,

125 
	gd
 += ' ';

127 
¡ršg
 
	gcmd
 = 
XAPIAN_COMPACT
" "
SILENT
" --no-renumber ";

128 
¡ršg
 
	gout
 = 
g‘_Çmed_wr™abË_d©aba£_·th
("compactnorenumber1out");

130 
rm_rf
(
out
);

131 
	g¡©us
 = 
sy¡em
(
cmd
 + 
a
 + 
out
);

132 
TEST_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

133 
check_¥¬£_uid_‹rms
(
out
);

136 ià(
g‘_dbty³
() == "flint") {

139 
TEST
(
fe_exi¡s
(
out
 + "/uuid"));

141 
TEST
(!
dœ_exi¡s
(
out
 + "/donor"));

142 
	gX­Ÿn
::
D©aba£
 
db
(
out
);

145 
¡ršg
 
	gout_uuid
 = 
db
.
g‘_uuid
();

146 
TEST_NOT_EQUAL
(
a_uuid
, 
out_uuid
);

147 
TEST_EQUAL
(
out_uuid
.
size
(), 36);

148 
TEST_NOT_EQUAL
(
out_uuid
, "00000000-0000-0000-0000-000000000000");

151 
TEST
(!
dœ_exi¡s
(
out
 + "/donor"));

154 
rm_rf
(
out
);

155 
	g¡©us
 = 
sy¡em
(
cmd
 + 
a
 + 
c
 + 
out
);

156 
TEST_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

157 
check_¥¬£_uid_‹rms
(
out
);

159 
rm_rf
(
out
);

160 
	g¡©us
 = 
sy¡em
(
cmd
 + 
d
 + 
a
 + 
c
 + 
out
);

161 
TEST_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

162 
check_¥¬£_uid_‹rms
(
out
);

164 
rm_rf
(
out
);

165 
	g¡©us
 = 
sy¡em
(
cmd
 + 
c
 + 
a
 + 
d
 + 
out
);

166 
TEST_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

167 
check_¥¬£_uid_‹rms
(
out
);

170 
rm_rf
(
out
);

171 
	g¡©us
 = 
sy¡em
(
cmd
 + 
a
 + 
b
 + 
out
);

172 
TEST_NOT_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

175 
rm_rf
(
out
);

176 
	g¡©us
 = 
sy¡em
(
cmd
 + 
b
 + 
a
 + 
out
);

177 
TEST_NOT_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

180 
rm_rf
(
out
);

181 
	g¡©us
 = 
sy¡em
(
cmd
 + 
a
 + 
b
 + 
d
 + 
out
);

182 
TEST_NOT_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

185 
rm_rf
(
out
);

186 
	g¡©us
 = 
sy¡em
(
cmd
 + 
d
 + 
b
 + 
a
 + 
out
);

187 
TEST_NOT_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

190 
rm_rf
(
out
);

191 
	g¡©us
 = 
sy¡em
(
cmd
 + 
b
 + 
a
 + 
d
 + 
out
);

192 
TEST_NOT_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

194  
	gŒue
;

198 
DEFINE_TESTCASE
(
com·ùm”ge1
, 
b¿ss
 || 
ch”t
 || 
æšt
) {

199 
	g¡©us
;

201 
¡ršg
 
	gcmd
 = 
XAPIAN_COMPACT
" "
SILENT
" ";

202 
¡ršg
 
	gšdb·th
 = 
g‘_d©aba£_·th
("apitest_simpledata") + ' ';

203 
¡ršg
 
	goutdb·th
 = 
g‘_Çmed_wr™abË_d©aba£_·th
("compactmerge1out");

204 
rm_rf
(
outdb·th
);

206 
	g¡©us
 = 
sy¡em
(
cmd
 + 
šdb·th
 + indb·th + 
outdb·th
);

207 
TEST_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

209 
	gX­Ÿn
::
D©aba£
 
šdb
(
g‘_d©aba£
("apitest_simpledata"));

210 
	gX­Ÿn
::
D©aba£
 
outdb
(
outdb·th
);

212 
TEST_EQUAL
(
šdb
.
g‘_doccouÁ
(è* 2, 
outdb
.get_doccount());

213 
dbcheck
(
outdb
, outdb.
g‘_doccouÁ
(), outdb.get_doccount());

215  
	gŒue
;

219 
make_muÉichunk_db
(
X­Ÿn
::
Wr™abËD©aba£
 &
db
, cÚ¡ 
¡ršg
 &)

221 
	gcouÁ
 = 10000;

223 
	gX­Ÿn
::
Docum’t
 
doc
;

224 
	gdoc
.
add_‹rm
("a");

225 
	gcouÁ
) {

226 
	gdb
.
add_docum’t
(
doc
);

227 --
	gcouÁ
;

230 
	gdb
.
comm™
();

235 
DEFINE_TESTCASE
(
com·ùmuÉichunks1
, 
b¿ss
 || 
ch”t
 || 
æšt
) {

236 
	g¡©us
;

238 
¡ršg
 
	gcmd
 = 
XAPIAN_COMPACT
" "
SILENT
" ";

239 
¡ršg
 
	gšdb·th
 = 
g‘_d©aba£_·th
("compactmultichunks1in",

240 
make_muÉichunk_db
, "");

241 
¡ršg
 
	goutdb·th
 = 
g‘_Çmed_wr™abË_d©aba£_·th
("compactmultichunks1out");

242 
rm_rf
(
outdb·th
);

244 
	g¡©us
 = 
sy¡em
(
cmd
 + 
šdb·th
 + ' ' + 
outdb·th
);

245 
TEST_EQUAL
(
WEXITSTATUS
(
¡©us
), 0);

247 
	gX­Ÿn
::
D©aba£
 
šdb
(
šdb·th
);

248 
	gX­Ÿn
::
D©aba£
 
outdb
(
outdb·th
);

250 
TEST_EQUAL
(
šdb
.
g‘_doccouÁ
(), 
outdb
.get_doccount());

251 
dbcheck
(
outdb
, outdb.
g‘_doccouÁ
(), outdb.get_doccount());

253  
	gŒue
;

	@tests/api_compact.h

2 
boŞ
 
‹¡_com·ùnÜ’umb”1
();

3 
boŞ
 
‹¡_com·ùm”ge1
();

4 
boŞ
 
‹¡_com·ùmuÉichunks1
();

	@tests/api_db.cc

24 
	~<cÚfig.h
>

26 
	~"­i_db.h
"

28 
	~<®gÜ™hm
>

29 
	~<f¡»am
>

30 
	~<m­
>

31 
	~<¡ršg
>

32 
	~<veùÜ
>

34 
	~<x­Ÿn.h
>

36 
	~"back’dmªag”.h
"

37 
	~"back’dmªag”_loÿl.h
"

38 
	~"‹¡su™e.h
"

39 
	~"‹¡uts.h
"

40 
	~"unixcmds.h
"

41 
	~"uts.h
"

43 
	~"­™e¡.h
"

45 
usšg
 
Çme¥aû
 
	g¡d
;

47 
	gX­Ÿn
::
Qu”y


48 
	$qu”y
(cÚ¡ 
¡ršg
 &
t
)

50  
X­Ÿn
::
	`Qu”y
(X­Ÿn::
	`S‹m
("’glish")(
t
));

51 
	}
}

57 
	$DEFINE_TESTCASE
(
‹rm¡©s
, 
back’d
) {

58 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

60 
	`TEST
(!
db
.
	`‹rm_exi¡s
("corn"));

61 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("corn"), 0);

62 
	`TEST
(
db
.
	`‹rm_exi¡s
("banana"));

63 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("banana"), 1);

64 
	`TEST
(
db
.
	`‹rm_exi¡s
("paragraph"));

65 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("paragraph"), 5);

67  
Œue
;

68 
	}
}

71 
DEFINE_TESTCASE
(
¡ubdb1
, 
back’d
 && !
šmemÜy
 && !
»mÙe
) {

73 
mkdœ
(".stub", 0755);

74 cÚ¡ * 
	gdb·th
 = ".stub/stubdb1";

75 
of¡»am
 
out
(
db·th
);

76 
TEST
(
out
.
is_İ’
());

77 
	gout
 << "autØ../" << 
g‘_d©aba£_·th
("­™e¡_sim¶ed©a"è<< 
	g’dl
;

78 
	gout
.
şo£
();

81 
	gX­Ÿn
::
D©aba£
 
db
 = 
X­Ÿn
::
Auto
::
İ’_¡ub
(
db·th
);

82 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

83 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("word"));

84 
	g’quœe
.
g‘_m£t
(0, 10);

87 
	gX­Ÿn
::
D©aba£
 
db
(
db·th
);

88 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

89 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("word"));

90 
	g’quœe
.
g‘_m£t
(0, 10);

93  
	gŒue
;

97 
DEFINE_TESTCASE
(
¡ubdb2
, 
back’d
 && !
šmemÜy
 && !
»mÙe
) {

99 
mkdœ
(".stub", 0755);

100 cÚ¡ * 
	gdb·th
 = ".stub/stubdb2";

101 
of¡»am
 
out
(
db·th
);

102 
TEST
(
out
.
is_İ’
());

103 
	gout
 << "»mÙ:" << 
	gBack’dMªag”
::
g‘_x­Ÿn_´og¤v_commªd
()

104 << ' ' << 
g‘_d©aba£_·th
("­™e¡_sim¶ed©a"è<< 
’dl
;

105 
	gout
.
şo£
();

108 
	gX­Ÿn
::
D©aba£
 
db
 = 
X­Ÿn
::
Auto
::
İ’_¡ub
(
db·th
);

109 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

110 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("word"));

111 
	g’quœe
.
g‘_m£t
(0, 10);

114 
	gX­Ÿn
::
D©aba£
 
db
(
db·th
);

115 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

116 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("word"));

117 
	g’quœe
.
g‘_m£t
(0, 10);

120  
	gŒue
;

124 
DEFINE_TESTCASE
(
¡ubdb3
, 
back’d
 && !
šmemÜy
 && !
»mÙe
) {

126 
mkdœ
(".stub", 0755);

127 cÚ¡ * 
	gdb·th
 = ".stub/stubdb3";

128 
of¡»am
 
out
(
db·th
);

129 
TEST
(
out
.
is_İ’
());

130 
	gout
 << "autØ../" << 
g‘_d©aba£_·th
("apitest_simpledata") << "\n"

132 
	gout
.
şo£
();

134 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

135 
X­Ÿn
::
D©aba£
 
db
 = X­Ÿn::
Auto
::
İ’_¡ub
(
db·th
));

137 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

138 
X­Ÿn
::
D©aba£
 
db
(
db·th
));

140  
	gŒue
;

144 
DEFINE_TESTCASE
(
¡ubdb4
, 
back’d
 && !
šmemÜy
 && !
»mÙe
) {

146 
mkdœ
(".stub", 0755);

147 cÚ¡ * 
	gdb·th
 = ".stub/stubdb4";

148 
of¡»am
 
out
(
db·th
);

149 
TEST
(
out
.
is_İ’
());

150 
	gout
 << "bad†ine here\n";

151 
	gout
.
şo£
();

153 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

154 
X­Ÿn
::
D©aba£
 
db
 = X­Ÿn::
Auto
::
İ’_¡ub
(
db·th
));

156 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

157 
X­Ÿn
::
D©aba£
 
db
(
db·th
));

159  
	gŒue
;

164 
DEFINE_TESTCASE
(
¡ubdb5
, 
back’d
 && !
šmemÜy
 && !
»mÙe
) {

166 
mkdœ
(".stub", 0755);

167 cÚ¡ * 
	gdb·th
 = ".stub/stubdb5";

168 
of¡»am
 
out
(
db·th
);

169 
TEST
(
out
.
is_İ’
());

170 
	gout
 << "bad\n"

171 "autØ../" << 
g‘_d©aba£_·th
("­™e¡_sim¶ed©a"è<< 
	g’dl
;

172 
	gout
.
şo£
();

174 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

175 
X­Ÿn
::
D©aba£
 
db
 = X­Ÿn::
Auto
::
İ’_¡ub
(
db·th
));

177 
TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

178 
X­Ÿn
::
D©aba£
 
db
(
db·th
));

180  
	gŒue
;

184 
	$DEFINE_TESTCASE
(
¡ubdb6
, 
šmemÜy
) {

185 
	`mkdœ
(".stub", 0755);

186 cÚ¡ * 
db·th
 = ".stub/stubdb6";

187 
of¡»am
 
	`out
(
db·th
);

188 
	`TEST
(
out
.
	`is_İ’
());

189 
out
 << "inmemory\n";

190 
out
.
	`şo£
();

194 
X­Ÿn
::
D©aba£
 
db
 = X­Ÿn::
Auto
::
	`İ’_¡ub
(
db·th
);

195 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

196 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

197 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word"));

198 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

199 
	`TEST
(
m£t
.
	`em±y
());

202 
X­Ÿn
::
D©aba£
 
	`db
(
db·th
);

203 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

204 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

205 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word"));

206 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

207 
	`TEST
(
m£t
.
	`em±y
());

212 
X­Ÿn
::
Wr™abËD©aba£
 
db
;

213 
db
 = 
X­Ÿn
::
Auto
::
	`İ’_¡ub
(
db·th
, X­Ÿn::
DB_OPEN
);

214 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

215 
db
.
	`add_docum’t
(
X­Ÿn
::
	`Docum’t
());

216 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 1);

219 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
db·th
, X­Ÿn::
DB_OPEN
);

220 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

221 
db
.
	`add_docum’t
(
X­Ÿn
::
	`Docum’t
());

222 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 1);

225  
Œue
;

226 
	}
}

229 şas 
	cMyE¼ÜHªdËr
 : 
public
 
X­Ÿn
::
E¼ÜHªdËr
 {

230 
public
:

231 
couÁ
;

233 
boŞ
 
hªdË_”rÜ
(
X­Ÿn
::
E¼Ü
 & 
”rÜ
) {

234 ++
couÁ
;

235 
	mtout
 << "E¼Ü hªdlšg caught: " << 
	m”rÜ
.
g‘_desütiÚ
()

236 << ", couÁ i now " << 
	mcouÁ
 << "\n";

237  
	mŒue
;

240 
	$MyE¼ÜHªdËr
(è: 
	$couÁ
 (0è{
	}
}

245 
MyE¼ÜHªdËr
 
	gmyhªdËr
;

247 
	gX­Ÿn
::
D©aba£
 
mydb2
(
g‘_d©aba£
("apitest_simpledata"));

248 
	gX­Ÿn
::
D©aba£
 
mydb3
(
g‘_d©aba£
("apitest_simpledata2"));

249 
	g”rcouÁ
 = 1;

250 
	g‹¡couÁ
 = 0;estcount < 14;estcount ++) {

251 
	gtout
 << "‹¡couÁ=" << 
	g‹¡couÁ
 << "\n";

252 
	gX­Ÿn
::
D©aba£
 
mydb4
(
g‘_d©aba£
("-e", "apitest_termorder"));

253 
	gX­Ÿn
::
D©aba£
 
mydb5
(
g‘_ÃtwÜk_d©aba£
("apitest_termorder", 1));

254 
	gX­Ÿn
::
D©aba£
 
mydb6
(
g‘_d©aba£
("-e2", "apitest_termorder"));

255 
	gX­Ÿn
::
D©aba£
 
mydb7
(
g‘_d©aba£
("-e3", "apitest_simpledata"));

257 
	gX­Ÿn
::
D©aba£
 
dbs
;

258 
	g‹¡couÁ
) {

260 
dbs
.
add_d©aba£
(
mydb2
);

261 
	gdbs
.
add_d©aba£
(
mydb3
);

262 
	gdbs
.
add_d©aba£
(
mydb4
);

265 
dbs
.
add_d©aba£
(
mydb4
);

266 
	gdbs
.
add_d©aba£
(
mydb2
);

267 
	gdbs
.
add_d©aba£
(
mydb3
);

270 
dbs
.
add_d©aba£
(
mydb3
);

271 
	gdbs
.
add_d©aba£
(
mydb4
);

272 
	gdbs
.
add_d©aba£
(
mydb2
);

275 
dbs
.
add_d©aba£
(
mydb2
);

276 
	gdbs
.
add_d©aba£
(
mydb3
);

277 
	gdbs
.
add_d©aba£
(
mydb5
);

278 
¦“p
(1);

281 
dbs
.
add_d©aba£
(
mydb5
);

282 
	gdbs
.
add_d©aba£
(
mydb2
);

283 
	gdbs
.
add_d©aba£
(
mydb3
);

284 
¦“p
(1);

287 
dbs
.
add_d©aba£
(
mydb3
);

288 
	gdbs
.
add_d©aba£
(
mydb5
);

289 
	gdbs
.
add_d©aba£
(
mydb2
);

290 
¦“p
(1);

293 
dbs
.
add_d©aba£
(
mydb2
);

294 
	gdbs
.
add_d©aba£
(
mydb3
);

295 
	gdbs
.
add_d©aba£
(
mydb6
);

298 
dbs
.
add_d©aba£
(
mydb6
);

299 
	gdbs
.
add_d©aba£
(
mydb2
);

300 
	gdbs
.
add_d©aba£
(
mydb3
);

303 
dbs
.
add_d©aba£
(
mydb3
);

304 
	gdbs
.
add_d©aba£
(
mydb6
);

305 
	gdbs
.
add_d©aba£
(
mydb2
);

308 
dbs
.
add_d©aba£
(
mydb2
);

309 
	gdbs
.
add_d©aba£
(
mydb3
);

310 
	gdbs
.
add_d©aba£
(
mydb7
);

313 
dbs
.
add_d©aba£
(
mydb7
);

314 
	gdbs
.
add_d©aba£
(
mydb2
);

315 
	gdbs
.
add_d©aba£
(
mydb3
);

318 
dbs
.
add_d©aba£
(
mydb3
);

319 
	gdbs
.
add_d©aba£
(
mydb7
);

320 
	gdbs
.
add_d©aba£
(
mydb2
);

323 
dbs
.
add_d©aba£
(
mydb2
);

324 
	gdbs
.
add_d©aba£
(
mydb6
);

325 
	gdbs
.
add_d©aba£
(
mydb7
);

328 
dbs
.
add_d©aba£
(
mydb2
);

329 
	gdbs
.
add_d©aba£
(
mydb7
);

330 
	gdbs
.
add_d©aba£
(
mydb6
);

333 
	gtout
 << "db=" << 
	gdbs
 << "\n";

334 
	gX­Ÿn
::
Enquœe
 
’quœe
(
dbs
, &
myhªdËr
);

337 
	gX­Ÿn
::
Qu”y
 
myqu”y
 = 
qu”y
(
X­Ÿn
::Qu”y::
OP_OR
, "inmemory", "word");

338 
	g’quœe
.
£t_weightšg_scheme
(
X­Ÿn
::
BoŞWeight
());

339 
	g’quœe
.
£t_qu”y
(
myqu”y
);

341 
	gtout
 << "qu”y=" << 
	gmyqu”y
 << "\n";

343 
	gX­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
g‘_m£t
(0, 10);

345 
	g‹¡couÁ
) {

347 
m£t_ex³ù_Üd”
(
mym£t
, 2, 4, 10);

350 
m£t_ex³ù_Üd”
(
mym£t
, 3, 5, 11);

353 
m£t_ex³ù_Üd”
(
mym£t
, 1, 6, 12);

357 
m£t_ex³ù_Üd”
(
mym£t
, 4, 10);

358 
	g”rcouÁ
 += 1;

361 
TEST_EQUAL
(
myhªdËr
.
couÁ
, 
”rcouÁ
);

362 
	g”rcouÁ
 += 1;

365  
	gŒue
;

369 şas 
	cmyM©chDecid”
 : 
public
 
X­Ÿn
::
M©chDecid”
 {

370 
public
:

371 
boŞ
 
	$İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
) const {

373  
doc
.
	`g‘_d©a
().
	`fšd
("Thi is"è!ğ
¡ršg
::
Åos
;

375 
	}
};

378 
DEFINE_TESTCASE
(
m©chdecid”1
, 
back’d
 && !
»mÙe
) {

379 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_simpledata"));

380 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

381 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("this"));

383 
myM©chDecid”
 
	gmyfunùÜ
;

385 
	gX­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
g‘_m£t
(0, 100, 0, &
myfunùÜ
);

387 
	gveùÜ
<
	gboŞ
> 
docid_checked
(
db
.
g‘_Ï¡docid
());

391 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
begš
();

392 
TEST
(
i
 !ğ
mym£t
.
’d
());

393 
TEST_EQUAL
(
mym£t
.
size
(), 3);

394 
TEST_EQUAL
(
mym£t
.
g‘_m©ches_low”_bound
(), 3);

395 
TEST_EQUAL
(
mym£t
.
g‘_m©ches_uµ”_bound
(), 3);

396 
TEST_EQUAL
(
mym£t
.
g‘_m©ches_e¡im©ed
(), 3);

397 
TEST_EQUAL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(), 3);

398 
TEST_EQUAL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 3);

399 
TEST_EQUAL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(), 3);

400  ; 
	gi
 !ğ
mym£t
.
’d
(); ++i) {

401 cÚ¡ 
	gX­Ÿn
::
Docum’t
 
doc
(
i
.
g‘_docum’t
());

402 
TEST
(
myfunùÜ
(
doc
));

403 
	gdocid_checked
[*
i
] = 
Œue
;

408 
	gmym£t
 = 
’quœe
.
g‘_m£t
(0, 100);

409 
TEST
(
mym£t
.
size
() > 3);

413 
	gmym£t
 = 
’quœe
.
g‘_m£t
(0, 0, 0, &
myfunùÜ
);

414 
TEST_EQUAL
(
mym£t
.
size
(), 0);

415 
TEST_EQUAL
(
mym£t
.
g‘_m©ches_low”_bound
(), 0);

416 
TEST_EQUAL
(
mym£t
.
g‘_m©ches_uµ”_bound
(), 6);

417 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),>,0);

418 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),<=,6);

419 
TEST_EQUAL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(), 0);

420 
TEST_EQUAL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(), 6);

421 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),>,0);

422 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),<=,6);

427 
	gmym£t
 = 
’quœe
.
g‘_m£t
(0, 1, 0, &
myfunùÜ
);

428 
TEST_EQUAL
(
mym£t
.
size
(), 1);

429 
TEST_REL
(
mym£t
.
g‘_m©ches_low”_bound
(),>=,1);

430 
TEST_REL
(
mym£t
.
g‘_m©ches_low”_bound
(),<=,3);

431 
TEST_REL
(
mym£t
.
g‘_m©ches_uµ”_bound
(),>=,3);

432 
TEST_REL
(
mym£t
.
g‘_m©ches_uµ”_bound
(),<=,6);

433 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),>,0);

434 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),<=,6);

435 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),>=,1);

436 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,3);

437 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),>=,3);

438 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),<=,6);

439 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),>,0);

440 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),<=,6);

443 
	gX­Ÿn
::
docid
 
did
 = 1; 
	gdid
 < 
	gdocid_checked
.
size
(); ++did) {

444 ià(!
	gdocid_checked
[
did
]) {

445 
TEST
(!
myfunùÜ
(
db
.
g‘_docum’t
(
did
)));

451 
	g’quœe
.
£t_cŞÏp£_key
(99);

452 
	gmym£t
 = 
’quœe
.
g‘_m£t
(0, 1, 0, &
myfunùÜ
);

453 
TEST_EQUAL
(
mym£t
.
size
(), 1);

454 
TEST_REL
(
mym£t
.
g‘_m©ches_low”_bound
(),>=,1);

455 
TEST_REL
(
mym£t
.
g‘_m©ches_low”_bound
(),<=,3);

456 
TEST_REL
(
mym£t
.
g‘_m©ches_uµ”_bound
(),>=,3);

457 
TEST_REL
(
mym£t
.
g‘_m©ches_uµ”_bound
(),<=,6);

458 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),>,0);

459 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),<=,6);

460 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),>=,1);

461 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,3);

462 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),>=,3);

463 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),<=,6);

464 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),>,0);

465 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),<=,6);

469 
	g’quœe
.
£t_cŞÏp£_key
(
X­Ÿn
::
BAD_VALUENO
);

470 
	g’quœe
.
£t_cutoff
(1);

471 
	gmym£t
 = 
’quœe
.
g‘_m£t
(0, 1, 0, &
myfunùÜ
);

472 
TEST_EQUAL
(
mym£t
.
size
(), 1);

473 
TEST_REL
(
mym£t
.
g‘_m©ches_low”_bound
(),>=,1);

474 
TEST_REL
(
mym£t
.
g‘_m©ches_low”_bound
(),<=,3);

475 
TEST_REL
(
mym£t
.
g‘_m©ches_uµ”_bound
(),>=,3);

476 
TEST_REL
(
mym£t
.
g‘_m©ches_uµ”_bound
(),<=,6);

477 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),>,0);

478 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),<=,6);

479 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),>=,1);

480 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,3);

481 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),>=,3);

482 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),<=,6);

483 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),>,0);

484 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),<=,6);

487 
	g’quœe
.
£t_cŞÏp£_key
(99);

488 
	gmym£t
 = 
’quœe
.
g‘_m£t
(0, 1, 0, &
myfunùÜ
);

489 
TEST_EQUAL
(
mym£t
.
size
(), 1);

490 
TEST_REL
(
mym£t
.
g‘_m©ches_low”_bound
(),>=,1);

491 
TEST_REL
(
mym£t
.
g‘_m©ches_low”_bound
(),<=,3);

492 
TEST_REL
(
mym£t
.
g‘_m©ches_uµ”_bound
(),>=,3);

493 
TEST_REL
(
mym£t
.
g‘_m©ches_uµ”_bound
(),<=,6);

494 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),>,0);

495 
TEST_REL
(
mym£t
.
g‘_m©ches_e¡im©ed
(),<=,6);

496 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),>=,1);

497 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,3);

498 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),>=,3);

499 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),<=,6);

500 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),>,0);

501 
TEST_REL
(
mym£t
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),<=,6);

503  
	gŒue
;

507 
DEFINE_TESTCASE
(
m©chdecid”2
, 
back’d
 && !
»mÙe
) {

508 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_simpledata"));

509 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

510 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("this"));

512 
myM©chDecid”
 
	gmyfunùÜ
;

514 
	gX­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
g‘_m£t
(0, 100, 0, 
NULL
, &
myfunùÜ
);

516 
	gveùÜ
<
	gboŞ
> 
docid_checked
(
db
.
g‘_Ï¡docid
());

520 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
begš
();

521 
TEST
(
i
 !ğ
mym£t
.
’d
());

522 
TEST_EQUAL
(
mym£t
.
size
(), 3);

523  ; 
	gi
 !ğ
mym£t
.
’d
(); ++i) {

524 cÚ¡ 
	gX­Ÿn
::
Docum’t
 
doc
(
i
.
g‘_docum’t
());

525 
TEST
(
myfunùÜ
(
doc
));

526 
	gdocid_checked
[*
i
] = 
Œue
;

530 
	gX­Ÿn
::
docid
 
did
 = 1; 
	gdid
 < 
	gdocid_checked
.
size
(); ++did) {

531 ià(!
	gdocid_checked
[
did
]) {

532 
TEST
(!
myfunùÜ
(
db
.
g‘_docum’t
(
did
)));

536  
	gŒue
;

539 şas 
	cmyM©chDecid”2
 : 
public
 
X­Ÿn
::
M©chDecid”
 {

540 
public
:

541 
boŞ
 
	$İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
) const {

543  
doc
.
	`g‘_d©a
().
	`fšd
("W´oduû"è=ğ
¡ršg
::
Åos
;

545 
	}
};

549 
DEFINE_TESTCASE
(
m©chdecid”3
, 
back’d
 && !
»mÙe
) {

550 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("etext"));

551 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

552 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(""));

553 
	g’quœe
.
£t_cŞÏp£_key
(12);

554 
	g’quœe
.
£t_sÜt_by_v®ue
(11, 
Œue
);

556 
myM©chDecid”2
 
	gmyfunùÜ
;

558 
	gX­Ÿn
::
MS‘
 
m£t1
 = 
’quœe
.
g‘_m£t
(0, 2, 0, 
NULL
, &
myfunùÜ
);

559 
	gX­Ÿn
::
MS‘
 
m£t2
 = 
’quœe
.
g‘_m£t
(0, 1000, 0, 
NULL
, &
myfunùÜ
);

562 
TEST_EQUAL
(
m£t2
.
g‘_m©ches_e¡im©ed
(), m£t2.
size
());

563 
TEST_EQUAL
(
m£t2
.
g‘_m©ches_low”_bound
(), m£t2.
g‘_m©ches_e¡im©ed
());

564 
TEST_EQUAL
(
m£t2
.
g‘_m©ches_e¡im©ed
(), m£t2.
g‘_m©ches_uµ”_bound
());

566 
TEST_REL
(
m£t2
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,m£t2.
g‘_uncŞÏp£d_m©ches_e¡im©ed
());

567 
TEST_REL
(
m£t2
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),<=,m£t2.
g‘_uncŞÏp£d_m©ches_uµ”_bound
());

571 
TEST_REL
(
m£t1
.
g‘_m©ches_low”_bound
(),<=,
m£t2
.
size
());

574 
TEST_REL
(
m£t1
.
g‘_m©ches_low”_bound
(),<=,m£t1.
g‘_m©ches_e¡im©ed
());

575 
TEST_REL
(
m£t1
.
g‘_m©ches_e¡im©ed
(),<=,m£t1.
g‘_m©ches_uµ”_bound
());

576 
TEST_REL
(
m£t1
.
size
(),<=,m£t1.
g‘_m©ches_uµ”_bound
());

578 
TEST_REL
(
m£t1
.
g‘_uncŞÏp£d_m©ches_low”_bound
(),<=,m£t1.
g‘_uncŞÏp£d_m©ches_e¡im©ed
());

579 
TEST_REL
(
m£t1
.
g‘_uncŞÏp£d_m©ches_e¡im©ed
(),<=,m£t1.
g‘_uncŞÏp£d_m©ches_uµ”_bound
());

583 
TEST_REL
(
m£t1
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),>=,
db
.
g‘_doccouÁ
() - 1);

584 
TEST_REL
(
m£t1
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),<=,
db
.
g‘_doccouÁ
());

585 
TEST_REL
(
m£t2
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),>=,
db
.
g‘_doccouÁ
() - 1);

586 
TEST_REL
(
m£t2
.
g‘_uncŞÏp£d_m©ches_uµ”_bound
(),<=,
db
.
g‘_doccouÁ
());

588  
	gŒue
;

592 
	$DEFINE_TESTCASE
(
m£t™”©Ü1
, 
back’d
) {

593 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

594 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

595 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 2);

597 
X­Ÿn
::
MS‘I‹¿tÜ
 
j
;

598 
j
 = 
mym£t
.
	`begš
();

599 
X­Ÿn
::
MS‘I‹¿tÜ
 
k
 = 
mym£t
.
	`’d
();

600 
X­Ÿn
::
MS‘I‹¿tÜ
 
	`l
(
j
);

601 
X­Ÿn
::
MS‘I‹¿tÜ
 
	`m
(
k
);

602 
X­Ÿn
::
MS‘I‹¿tÜ
 
n
 = 
mym£t
.
	`begš
();

603 
X­Ÿn
::
MS‘I‹¿tÜ
 
o
 = 
mym£t
.
	`begš
();

604 
	`TEST_NOT_EQUAL
(
j
, 
k
);

605 
	`TEST_NOT_EQUAL
(
l
, 
m
);

606 
	`TEST_EQUAL
(
k
, 
m
);

607 
	`TEST_EQUAL
(
j
, 
l
);

608 
	`TEST_EQUAL
(
j
, j);

609 
	`TEST_EQUAL
(
k
, k);

611 
k
 = 
j
;

612 
	`TEST_EQUAL
(
j
, 
k
);

613 
	`TEST_EQUAL
(
j
, 
o
);

614 
k
++;

615 
	`TEST_NOT_EQUAL
(
j
, 
k
);

616 
	`TEST_NOT_EQUAL
(
k
, 
l
);

617 
	`TEST_NOT_EQUAL
(
k
, 
m
);

618 
	`TEST_NOT_EQUAL
(
k
, 
o
);

619 
o
++;

620 
	`TEST_EQUAL
(
k
, 
o
);

621 
k
++;

622 
	`TEST_NOT_EQUAL
(
j
, 
k
);

623 
	`TEST_NOT_EQUAL
(
k
, 
l
);

624 
	`TEST_EQUAL
(
k
, 
m
);

625 
	`TEST_EQUAL
(
n
, 
l
);

627 
n
 = 
m
;

628 
	`TEST_NOT_EQUAL
(
n
, 
l
);

629 
	`TEST_EQUAL
(
n
, 
m
);

630 
	`TEST_NOT_EQUAL
(
n
, 
mym£t
.
	`begš
());

631 
	`TEST_EQUAL
(
n
, 
mym£t
.
	`’d
());

633  
Œue
;

634 
	}
}

637 
	$DEFINE_TESTCASE
(
m£t™”©Ü2
, 
back’d
) {

638 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

639 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

640 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 0);

642 
X­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
mym£t
.
	`begš
();

643 
X­Ÿn
::
MS‘I‹¿tÜ
 
k
 = 
mym£t
.
	`’d
();

644 
X­Ÿn
::
MS‘I‹¿tÜ
 
	`l
(
j
);

645 
X­Ÿn
::
MS‘I‹¿tÜ
 
	`m
(
k
);

646 
	`TEST_EQUAL
(
j
, 
k
);

647 
	`TEST_EQUAL
(
l
, 
m
);

648 
	`TEST_EQUAL
(
k
, 
m
);

649 
	`TEST_EQUAL
(
j
, 
l
);

650 
	`TEST_EQUAL
(
j
, j);

651 
	`TEST_EQUAL
(
k
, k);

653  
Œue
;

654 
	}
}

657 
	$DEFINE_TESTCASE
(
m£t™”©Ü3
, 
back’d
) {

658 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_simpledata"));

659 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

660 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

662 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(2, 10);

664 
	`TEST
(!
mym£t
.
	`em±y
());

665 
X­Ÿn
::
Docum’t
 
	`doc
(
mym£t
.
	`begš
().
	`g‘_docum’t
());

666 
	`TEST
(!
doc
.
	`g‘_d©a
().
	`em±y
());

668  
Œue
;

669 
	}
}

672 
	$DEFINE_TESTCASE
(
e£t™”©Ü1
, 
back’d
) {

673 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

674 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

676 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

677 
	`TEST
(
mym£t
.
	`size
() >= 2);

679 
X­Ÿn
::
RS‘
 
myr£t
;

680 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

681 
myr£t
.
	`add_docum’t
(*
i
);

682 
myr£t
.
	`add_docum’t
(*(++
i
));

684 
X­Ÿn
::
ES‘
 
mye£t
 = 
’quœe
.
	`g‘_e£t
(2, 
myr£t
);

685 
X­Ÿn
::
ES‘I‹¿tÜ
 
j
;

686 
j
 = 
mye£t
.
	`begš
();

687 
X­Ÿn
::
ES‘I‹¿tÜ
 
k
 = 
mye£t
.
	`’d
();

688 
X­Ÿn
::
ES‘I‹¿tÜ
 
	`l
(
j
);

689 
X­Ÿn
::
ES‘I‹¿tÜ
 
	`m
(
k
);

690 
X­Ÿn
::
ES‘I‹¿tÜ
 
n
 = 
mye£t
.
	`begš
();

692 
	`TEST_NOT_EQUAL
(
j
, 
k
);

693 
	`TEST_NOT_EQUAL
(
l
, 
m
);

694 
	`TEST_EQUAL
(
k
, 
m
);

695 
	`TEST_EQUAL
(
j
, 
l
);

696 
	`TEST_EQUAL
(
j
, j);

697 
	`TEST_EQUAL
(
k
, k);

699 
k
 = 
j
;

700 
	`TEST_EQUAL
(
j
, 
k
);

701 
k
++;

702 
	`TEST_NOT_EQUAL
(
j
, 
k
);

703 
	`TEST_NOT_EQUAL
(
k
, 
l
);

704 
	`TEST_NOT_EQUAL
(
k
, 
m
);

705 
k
++;

706 
	`TEST_NOT_EQUAL
(
j
, 
k
);

707 
	`TEST_NOT_EQUAL
(
k
, 
l
);

708 
	`TEST_EQUAL
(
k
, 
m
);

709 
	`TEST_EQUAL
(
n
, 
l
);

711 
n
 = 
m
;

712 
	`TEST_NOT_EQUAL
(
n
, 
l
);

713 
	`TEST_EQUAL
(
n
, 
m
);

714 
	`TEST_NOT_EQUAL
(
n
, 
mye£t
.
	`begš
());

715 
	`TEST_EQUAL
(
n
, 
mye£t
.
	`’d
());

717  
Œue
;

718 
	}
}

721 
	$DEFINE_TESTCASE
(
e£t™”©Ü2
, 
back’d
) {

722 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

723 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

725 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

726 
	`TEST
(
mym£t
.
	`size
() >= 2);

728 
X­Ÿn
::
RS‘
 
myr£t
;

729 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

730 
myr£t
.
	`add_docum’t
(*
i
);

731 
myr£t
.
	`add_docum’t
(*(++
i
));

733 
X­Ÿn
::
ES‘
 
mye£t
 = 
’quœe
.
	`g‘_e£t
(0, 
myr£t
);

734 
X­Ÿn
::
ES‘I‹¿tÜ
 
j
 = 
mye£t
.
	`begš
();

735 
X­Ÿn
::
ES‘I‹¿tÜ
 
k
 = 
mye£t
.
	`’d
();

736 
X­Ÿn
::
ES‘I‹¿tÜ
 
	`l
(
j
);

737 
X­Ÿn
::
ES‘I‹¿tÜ
 
	`m
(
k
);

738 
	`TEST_EQUAL
(
j
, 
k
);

739 
	`TEST_EQUAL
(
l
, 
m
);

740 
	`TEST_EQUAL
(
k
, 
m
);

741 
	`TEST_EQUAL
(
j
, 
l
);

742 
	`TEST_EQUAL
(
j
, j);

743 
	`TEST_EQUAL
(
k
, k);

745  
Œue
;

746 
	}
}

749 
	$DEFINE_TESTCASE
(
cŞÏp£key1
, 
back’d
) {

750 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

751 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

753 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 100);

754 
X­Ÿn
::
doccouÁ
 
mymsize1
 = 
mym£t1
.
	`size
();

756 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 1; value_no < 7; ++value_no) {

757 
’quœe
.
	`£t_cŞÏp£_key
(
v®ue_no
);

758 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 100);

760 
	`TEST_AND_EXPLAIN
(
mymsize1
 > 
mym£t
.
	`size
(),

763 
m­
<
¡ršg
, 
X­Ÿn
::
docid
> 
v®ues
;

764 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

765  ; 
i
 !ğ
mym£t
.
	`’d
(); ++i) {

766 
¡ršg
 
v®ue
 = 
i
.
	`g‘_docum’t
().
	`g‘_v®ue
(
v®ue_no
);

767 
	`TEST
(
v®ues
[
v®ue
] =ğ0 || v®ue.
	`em±y
());

768 
v®ues
[
v®ue
] = *
i
;

772  
Œue
;

773 
	}
}

777 
	$DEFINE_TESTCASE
(
cŞÏp£key2
, 
back’d
) {

778 
	`SKIP_TEST
("Don't have‡ suitable database currently");

781 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata2"));

782 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

784 
X­Ÿn
::
MS‘
 
m£t1
 = 
’quœe
.
	`g‘_m£t
(0, 1);

789 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

790 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 3;

791 
’quœe
.
	`£t_cŞÏp£_key
(
v®ue_no
);

792 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 1);

794 
	`TEST_REL
(
m£t
.
	`g‘_m©ches_low”_bound
(),<,
m£t1
.get_matches_lower_bound());

795 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_uµ”_bound
(), 
m£t1
.get_matches_upper_bound());

798  
Œue
;

799 
	}
}

803 
	$DEFINE_TESTCASE
(
cŞÏp£key3
, 
back’d
) {

804 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

805 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

807 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 3);

809 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 1; value_no < 7; ++value_no) {

810 
’quœe
.
	`£t_cŞÏp£_key
(
v®ue_no
);

811 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 3);

813 
	`TEST_AND_EXPLAIN
(
mym£t1
.
	`g‘_m©ches_low”_bound
(è> 
mym£t
.get_matches_lower_bound(),

815 
	`TEST_AND_EXPLAIN
(
mym£t1
.
	`g‘_m©ches_uµ”_bound
(è> 
mym£t
.get_matches_upper_bound(),

818 
m­
<
¡ršg
, 
X­Ÿn
::
docid
> 
v®ues
;

819 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

820  ; 
i
 !ğ
mym£t
.
	`’d
(); ++i) {

821 
¡ršg
 
v®ue
 = 
i
.
	`g‘_docum’t
().
	`g‘_v®ue
(
v®ue_no
);

822 
	`TEST
(
v®ues
[
v®ue
] =ğ0 || v®ue.
	`em±y
());

823 
v®ues
[
v®ue
] = *
i
;

833 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 1000;

834 
’quœe
.
	`£t_cŞÏp£_key
(
v®ue_no
);

835 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 3);

837 
	`TEST
(
mym£t
.
	`g‘_m©ches_low”_bound
(è<ğ
mym£t1
.get_matches_lower_bound());

838 
	`TEST_EQUAL
(
mym£t
.
	`g‘_m©ches_uµ”_bound
(), 
mym£t1
.get_matches_upper_bound());

840 
m­
<
¡ršg
, 
X­Ÿn
::
docid
> 
v®ues
;

841 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

842  ; 
i
 !ğ
mym£t
.
	`’d
(); ++i) {

843 
¡ršg
 
v®ue
 = 
i
.
	`g‘_docum’t
().
	`g‘_v®ue
(
v®ue_no
);

844 
	`TEST
(
v®ues
[
v®ue
] =ğ0 || v®ue.
	`em±y
());

845 
v®ues
[
v®ue
] = *
i
;

849  
Œue
;

850 
	}
}

854 
	$DEFINE_TESTCASE
(
cŞÏp£key4
, 
back’d
) {

855 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

856 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

858 
X­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
	`g‘_m£t
(0, 0);

860 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 1; value_no < 7; ++value_no) {

861 
’quœe
.
	`£t_cŞÏp£_key
(
v®ue_no
);

862 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 0);

864 
	`TEST_AND_EXPLAIN
(
mym£t
.
	`g‘_m©ches_low”_bound
() == 1,

866 
	`TEST_AND_EXPLAIN
(
mym£t1
.
	`g‘_m©ches_uµ”_bound
(è=ğ
mym£t
.get_matches_upper_bound(),

869 
m­
<
¡ršg
, 
X­Ÿn
::
docid
> 
v®ues
;

870 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t
.
	`begš
();

871  ; 
i
 !ğ
mym£t
.
	`’d
(); ++i) {

872 
¡ršg
 
v®ue
 = 
i
.
	`g‘_docum’t
().
	`g‘_v®ue
(
v®ue_no
);

873 
	`TEST
(
v®ues
[
v®ue
] =ğ0 || v®ue.
	`em±y
());

874 
v®ues
[
v®ue
] = *
i
;

878  
Œue
;

879 
	}
}

882 
	$DEFINE_TESTCASE
(
k“·live1
, 
»mÙe
) {

883 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_»mÙe_d©aba£
("apitest_simpledata", 5000));

886 
i
 = 0; i < 10; ++i) {

887 
	`¦“p
(2);

888 
db
.
	`k“p_®ive
();

890 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

891 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word"));

892 
’quœe
.
	`g‘_m£t
(0, 10);

895 
	`¦“p
(10);

896 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word"));

897 
	`TEST_EXCEPTION
(
X­Ÿn
::
N‘wÜkE¼Ü
,

898 
’quœe
.
	`g‘_m£t
(0, 10));

900  
Œue
;

901 
	}
}

904 
	$DEFINE_TESTCASE
(
®É”ms1
, 
back’d
) {

905 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_allterms"));

906 
X­Ÿn
::
T”mI‹¿tÜ
 
©i
 = 
db
.
	`®É”ms_begš
();

907 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

908 
	`TEST_EQUAL
(*
©i
, "one");

909 
	`TEST_EQUAL
(
©i
.
	`g‘_‹rmäeq
(), 1);

911 
X­Ÿn
::
T”mI‹¿tÜ
 
©i2
 = 
©i
;

913 
©i
++;

914 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

915 ià(
v”bo£
) {

916 
tout
 << "*©˜ğ`" << *
©i
 << "'\n";

917 
tout
 << "*©i.Ëngth = `" << (*
©i
).
	`Ëngth
() << "'\n";

918 
tout
 << "*©˜=ğ\"Úe\" = " << (*
©i
 == "one") << "\n";

919 
tout
 << "*©i[3] = " << ((*
©i
)[3]) << "\n";

920 
tout
 << "*©˜ğ`" << *
©i
 << "'\n";

922 
	`TEST
(*
©i
 == "three");

923 
	`TEST
(
©i
.
	`g‘_‹rmäeq
() == 3);

926 
	`TEST
(
©i2
 !ğ
db
.
	`®É”ms_’d
());

927 
	`TEST
(*
©i2
 == "one");

928 
	`TEST
(
©i2
.
	`g‘_‹rmäeq
() == 1);

931 ++
©i
;

933 ++
©i2
;

935 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

936 
	`TEST
(*
©i
 == "two");

937 
	`TEST
(
©i
.
	`g‘_‹rmäeq
() == 2);

940 
	`TEST
(
©i2
 !ğ
db
.
	`®É”ms_’d
());

941 
	`TEST
(*
©i2
 == "three");

942 
	`TEST
(
©i2
.
	`g‘_‹rmäeq
() == 3);

945 
©i
++;

946 
	`TEST
(
©i
 =ğ
db
.
	`®É”ms_’d
());

948  
Œue
;

949 
	}
}

952 
	$DEFINE_TESTCASE
(
®É”ms2
, 
back’d
) {

953 
X­Ÿn
::
D©aba£
 
db
;

954 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_allterms"));

955 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_allterms2"));

956 
X­Ÿn
::
T”mI‹¿tÜ
 
©i
 = 
db
.
	`®É”ms_begš
();

958 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

959 
	`TEST
(*
©i
 == "five");

960 
	`TEST
(
©i
.
	`g‘_‹rmäeq
() == 2);

961 
©i
++;

963 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

964 
	`TEST
(*
©i
 == "four");

965 
	`TEST
(
©i
.
	`g‘_‹rmäeq
() == 1);

967 
©i
++;

968 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

969 
	`TEST
(*
©i
 == "one");

970 
	`TEST
(
©i
.
	`g‘_‹rmäeq
() == 1);

972 ++
©i
;

973 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

974 
	`TEST
(*
©i
 == "six");

975 
	`TEST
(
©i
.
	`g‘_‹rmäeq
() == 3);

977 
©i
++;

978 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

979 
	`TEST
(*
©i
 == "three");

980 
	`TEST
(
©i
.
	`g‘_‹rmäeq
() == 3);

982 
©i
++;

983 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

984 
	`TEST
(*
©i
 == "two");

985 
	`TEST
(
©i
.
	`g‘_‹rmäeq
() == 2);

987 
©i
++;

988 
	`TEST
(
©i
 =ğ
db
.
	`®É”ms_’d
());

990  
Œue
;

991 
	}
}

994 
	$DEFINE_TESTCASE
(
®É”ms3
, 
back’d
) {

995 
X­Ÿn
::
D©aba£
 
db
;

996 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_allterms"));

997 
X­Ÿn
::
T”mI‹¿tÜ
 
©i
 = 
db
.
	`®É”ms_begš
();

999 
©i
.
	`sk_to
(
	`¡ršg
("zzzzzz"));

1000 
	`TEST
(
©i
 =ğ
db
.
	`®É”ms_’d
());

1002  
Œue
;

1003 
	}
}

1007 
	$DEFINE_TESTCASE
(
®É”ms4
, 
back’d
) {

1010 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
("apitest_allterms4");

1012 
X­Ÿn
::
T”mI‹¿tÜ
 
i
 = 
db
.
	`®É”ms_begš
();

1013 
	`TEST
(
i
 !ğ
db
.
	`®É”ms_’d
());

1014 
	`TEST
(*
i
 == "foo");

1015 
	`TEST
(
i
.
	`g‘_‹rmäeq
() == 682);

1016 ++
i
;

1017 
	`TEST
(
i
 =ğ
db
.
	`®É”ms_’d
());

1019  
Œue
;

1020 
	}
}

1024 
	$DEFINE_TESTCASE
(
®É”ms5
, 
back’d
) {

1025 
X­Ÿn
::
D©aba£
 
db
;

1026 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_allterms"));

1027 
X­Ÿn
::
T”mI‹¿tÜ
 
©i
 = 
db
.
	`®É”ms_begš
();

1028 
©i
.
	`sk_to
("three");

1029 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
());

1030 
	`TEST_EQUAL
(*
©i
, "three");

1032  
Œue
;

1033 
	}
}

1036 
	$DEFINE_TESTCASE
(
®É”ms6
, 
back’d
) {

1037 
X­Ÿn
::
D©aba£
 
db
;

1038 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_allterms"));

1039 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_allterms2"));

1041 
X­Ÿn
::
T”mI‹¿tÜ
 
©i
 = 
db
.
	`®É”ms_begš
("three");

1042 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
("three"));

1043 
	`TEST_EQUAL
(*
©i
, "three");

1044 
©i
.
	`sk_to
("three");

1045 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
("three"));

1046 
	`TEST_EQUAL
(*
©i
, "three");

1047 
©i
++;

1048 
	`TEST
(
©i
 =ğ
db
.
	`®É”ms_’d
("three"));

1050 
©i
 = 
db
.
	`®É”ms_begš
("thre");

1051 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
("thre"));

1052 
	`TEST_EQUAL
(*
©i
, "three");

1053 
©i
.
	`sk_to
("three");

1054 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
("thre"));

1055 
	`TEST_EQUAL
(*
©i
, "three");

1056 
©i
++;

1057 
	`TEST
(
©i
 =ğ
db
.
	`®É”ms_’d
("thre"));

1059 
©i
 = 
db
.
	`®É”ms_begš
("f");

1060 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
("f"));

1061 
	`TEST_EQUAL
(*
©i
, "five");

1062 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
("f"));

1063 
©i
.
	`sk_to
("three");

1064 
	`TEST
(
©i
 =ğ
db
.
	`®É”ms_’d
("f"));

1066 
©i
 = 
db
.
	`®É”ms_begš
("f");

1067 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
("f"));

1068 
	`TEST_EQUAL
(*
©i
, "five");

1069 
©i
++;

1070 
	`TEST
(
©i
 !ğ
db
.
	`®É”ms_’d
("f"));

1071 
	`TEST_EQUAL
(*
©i
, "four");

1072 
©i
++;

1073 
	`TEST
(
©i
 =ğ
db
.
	`®É”ms_’d
("f"));

1075 
©i
 = 
db
.
	`®É”ms_begš
("absent");

1076 
	`TEST
(
©i
 =ğ
db
.
	`®É”ms_’d
("absent"));

1078  
Œue
;

1079 
	}
}

1082 
	$DEFINE_TESTCASE
(
¥ecŸÉ”ms1
, 
back’d
) {

1083 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_space"));

1084 
X­Ÿn
::
MS‘
 
mym£t
;

1085 
X­Ÿn
::
doccouÁ
 
couÁ
;

1086 
X­Ÿn
::
MS‘I‹¿tÜ
 
m
;

1087 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

1089 
’quœe
.
	`£t_qu”y
(
	`¡emm”
("new\nline"));

1090 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1091 
	`TEST_MSET_SIZE
(
mym£t
, 1);

1092 
couÁ
 = 0;

1093 
m
 = 
mym£t
.
	`begš
(); m !ğmym£t.
	`’d
(); ++mè++
couÁ
;

1094 
	`TEST_EQUAL
(
couÁ
, 1);

1096 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 0; value_no < 7; ++value_no) {

1097 
¡ršg
 
v®ue
 = 
mym£t
.
	`begš
().
	`g‘_docum’t
().
	`g‘_v®ue
(
v®ue_no
);

1098 
	`TEST_NOT_EQUAL
(
v®ue
, "");

1099 ià(
v®ue_no
 == 0) {

1100 
	`TEST
(
v®ue
.
	`size
() > 263);

1101 
	`TEST_EQUAL
(
¡©ic_ÿ¡
<>(
v®ue
[262]), 255);

1102 
k
 = 0; k < 256; k++) {

1103 
	`TEST_EQUAL
(
¡©ic_ÿ¡
<>(
v®ue
[
k
+7]), k);

1108 
’quœe
.
	`£t_qu”y
(
	`¡emm”
(
	`¡ršg
("big\0zero", 8)));

1109 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1110 
	`TEST_MSET_SIZE
(
mym£t
, 1);

1111 
couÁ
 = 0;

1112 
m
 = 
mym£t
.
	`begš
(); m !ğmym£t.
	`’d
(); ++mè++
couÁ
;

1113 
	`TEST_EQUAL
(
couÁ
, 1);

1115  
Œue
;

1116 
	}
}

1120 
	$DEFINE_TESTCASE
(
¥ecŸÉ”ms2
, 
back’d
) {

1121 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_space"));

1125 
X­Ÿn
::
T”mI‹¿tÜ
 
t
;

1126 
t
 = 
db
.
	`®É”ms_begš
();

1127 
	`TEST_EQUAL
(*
t
, "back\\¦ash"); ++t; 
	`TEST_NOT_EQUAL
Ñ, 
db
.
	`®É”ms_’d
());

1128 
	`TEST_EQUAL
(*
t
, 
	`¡ršg
("big\0z”o", 8)); ++t; 
	`TEST_NOT_EQUAL
Ñ, 
db
.
	`®É”ms_’d
());

1129 
	`TEST_EQUAL
(*
t
, "Ãw\Æš"); ++t; 
	`TEST_NOT_EQUAL
Ñ, 
db
.
	`®É”ms_’d
());

1130 
	`TEST_EQUAL
(*
t
, "Úe\x01Ú"); ++t; 
	`TEST_NOT_EQUAL
Ñ, 
db
.
	`®É”ms_’d
());

1131 
	`TEST_EQUAL
(*
t
, "¥aû mª"); ++t; 
	`TEST_NOT_EQUAL
Ñ, 
db
.
	`®É”ms_’d
());

1132 
	`TEST_EQUAL
(*
t
, "b\tbi"); ++t; 
	`TEST_NOT_EQUAL
Ñ, 
db
.
	`®É”ms_’d
());

1133 
	`TEST_EQUAL
(*
t
, "tu\x02tu"); ++t; TEST_EQUALÑ, 
db
.
	`®É”ms_’d
());

1139 
t
 = 
db
.
	`®É”ms_begš
();

1140 
t
.
	`sk_to
(
	`¡ršg
("big\0zero", 8));

1141 
	`TEST_NOT_EQUAL
(
t
, 
db
.
	`®É”ms_’d
());

1142 
	`TEST_EQUAL
(*
t
, 
	`¡ršg
("big\0zero", 8));

1144  
Œue
;

1145 
	}
}

1148 
DEFINE_TESTCASE
(
r£tmuÉidb2
, 
back’d
 && !
muÉi
) {

1149 
	gX­Ÿn
::
D©aba£
 
mydb1
(
g‘_d©aba£
("apitest_rset", "apitest_simpledata2"));

1150 
	gX­Ÿn
::
D©aba£
 
mydb2
(
g‘_d©aba£
("apitest_rset"));

1151 
	gmydb2
.
add_d©aba£
(
g‘_d©aba£
("apitest_simpledata2"));

1153 
	gX­Ÿn
::
Enquœe
 
’quœe1
(
mydb1
);

1154 
	gX­Ÿn
::
Enquœe
 
’quœe2
(
mydb2
);

1156 
	gX­Ÿn
::
Qu”y
 
myqu”y
 = 
qu”y
("is");

1158 
	g’quœe1
.
£t_qu”y
(
myqu”y
);

1159 
	g’quœe2
.
£t_qu”y
(
myqu”y
);

1161 
	gX­Ÿn
::
RS‘
 
myr£t1
;

1162 
	gX­Ÿn
::
RS‘
 
myr£t2
;

1163 
	gmyr£t1
.
add_docum’t
(4);

1164 
	gmyr£t2
.
add_docum’t
(2);

1166 
	gX­Ÿn
::
MS‘
 
mym£t1a
 = 
’quœe1
.
g‘_m£t
(0, 10);

1167 
	gX­Ÿn
::
MS‘
 
mym£t1b
 = 
’quœe1
.
g‘_m£t
(0, 10, &
myr£t1
);

1168 
	gX­Ÿn
::
MS‘
 
mym£t2a
 = 
’quœe2
.
g‘_m£t
(0, 10);

1169 
	gX­Ÿn
::
MS‘
 
mym£t2b
 = 
’quœe2
.
g‘_m£t
(0, 10, &
myr£t2
);

1171 
m£t_ex³ù_Üd”
(
mym£t1a
, 4, 3);

1172 
m£t_ex³ù_Üd”
(
mym£t1b
, 4, 3);

1173 
m£t_ex³ù_Üd”
(
mym£t2a
, 2, 5);

1174 
m£t_ex³ù_Üd”
(
mym£t2b
, 2, 5);

1176 
TEST
(
m£t_¿nge_is_§me_weights
(
mym£t1a
, 0, 
mym£t2a
, 0, 2));

1177 
TEST
(
m£t_¿nge_is_§me_weights
(
mym£t1b
, 0, 
mym£t2b
, 0, 2));

1178 
TEST_NOT_EQUAL
(
mym£t1a
, 
mym£t1b
);

1179 
TEST_NOT_EQUAL
(
mym£t2a
, 
mym£t2b
);

1181  
	gŒue
;

1185 
DEFINE_TESTCASE
(
muÉ›x·nd1
, 
back’d
 && !
muÉi
) {

1186 
	gX­Ÿn
::
D©aba£
 
mydb1
(
g‘_d©aba£
("apitest_simpledata", "apitest_simpledata2"));

1187 
	gX­Ÿn
::
Enquœe
 
’quœe1
(
mydb1
);

1189 
	gX­Ÿn
::
D©aba£
 
mydb2
(
g‘_d©aba£
("apitest_simpledata"));

1190 
	gmydb2
.
add_d©aba£
(
g‘_d©aba£
("apitest_simpledata2"));

1191 
	gX­Ÿn
::
Enquœe
 
’quœe2
(
mydb2
);

1194 
	gX­Ÿn
::
RS‘
 
r£t1
;

1195 
	gX­Ÿn
::
RS‘
 
r£t2
;

1196 
	gr£t1
.
add_docum’t
(1);

1197 
	gr£t1
.
add_docum’t
(7);

1198 
	gr£t2
.
add_docum’t
(1);

1199 
	gr£t2
.
add_docum’t
(2);

1204 
	gX­Ÿn
::
ES‘
 
e£t1
 = 
’quœe1
.
g‘_e£t
(1000, 
r£t1
);

1207 
	gX­Ÿn
::
ES‘
 
e£t2
 = 
’quœe2
.
g‘_e£t
(1000, 
r£t2
);

1210 
	gX­Ÿn
::
ES‘
 
e£t3
 = 
’quœe2
.
g‘_e£t
(1000, 
r£t2
, 
X­Ÿn
::
Enquœe
::
USE_EXACT_TERMFREQ
);

1212 
TEST_EQUAL
(
e£t1
.
size
(), 
e£t3
.size());

1214 
	gX­Ÿn
::
ES‘I‹¿tÜ
 
i
 = 
e£t1
.
begš
();

1215 
	gX­Ÿn
::
ES‘I‹¿tÜ
 
j
 = 
e£t3
.
begš
();

1216 
	gi
 !ğ
e£t1
.
’d
(è&& 
j
 !ğ
e£t3
.end()) {

1217 
TEST_EQUAL
(*
i
, *
j
);

1218 
TEST_EQUAL
(
i
.
g‘_weight
(), 
j
.get_weight());

1219 ++
	gi
;

1220 ++
	gj
;

1222 
TEST
(
i
 =ğ
e£t1
.
’d
());

1223 
TEST
(
j
 =ğ
e£t3
.
’d
());

1225 
boŞ
 
	ge£t1_eq_e£t2
 = 
Œue
;

1226 
	gi
 = 
e£t1
.
begš
();

1227 
	gj
 = 
e£t2
.
begš
();

1228 
	gi
 !ğ
e£t1
.
’d
(è&& 
j
 !ğ
e£t2
.end()) {

1229 ià(
i
.
g‘_weight
(è!ğ
j
.get_weight()) {

1230 
e£t1_eq_e£t2
 = 
çl£
;

1233 ++
	gi
;

1234 ++
	gj
;

1236 
TEST
(!
e£t1_eq_e£t2
);

1238  
	gŒue
;

1242 
	$DEFINE_TESTCASE
(
po¡li¡1
, 
back’d
) {

1243 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

1245 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
("ro£bud"), db.
	`po¡li¡_’d
("rosebud"));

1247 
¡ršg
 
s
 = "let_us_see_if_we_can_break_it_with_a_really_really_long_term.";

1248 
i
 = 0; i < 8; ++i) {

1249 
s
 += s;

1250 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
(
s
), db.
	`po¡li¡_’d
(s));

1254 
	`TEST_NOT_EQUAL
(
db
.
	`po¡li¡_begš
("a"), db.
	`po¡li¡_’d
("a"));

1256  
Œue
;

1257 
	}
}

1260 
	$DEFINE_TESTCASE
(
po¡li¡2
, 
back’d
) {

1261 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

1262 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p
;

1263 
p
 = 
db
.
	`po¡li¡_begš
("this");

1264 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
³nd
 = 
db
.
	`po¡li¡_’d
("this");

1266 
	`TEST
(
p
.
	`g‘_desütiÚ
() != "Xapian::PostingIterator(pos=END)");

1269 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p_cİy
 = 
p
;

1270 
	`TEST_EQUAL
(
p
, 
p_cİy
);

1272 
	`TEST
(
p_cİy
.
	`g‘_desütiÚ
() != "Xapian::PostingIterator(pos=END)");

1275 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
	`p_şÚe
(
p
);

1276 
	`TEST_EQUAL
(
p
, 
p_şÚe
);

1278 
	`TEST
(
p_şÚe
.
	`g‘_desütiÚ
() != "Xapian::PostingIterator(pos=END)");

1280 
veùÜ
<
X­Ÿn
::
docid
> 
	`v
(
p
, 
³nd
);

1282 
p
 = 
db
.
	`po¡li¡_begš
("this");

1283 
³nd
 = 
db
.
	`po¡li¡_’d
("this");

1284 
veùÜ
<
X­Ÿn
::
docid
>::
cÚ¡_™”©Ü
 
i
;

1285 
i
 = 
v
.
	`begš
(); i !ğv.
	`’d
(); i++) {

1286 
	`TEST_NOT_EQUAL
(
p
, 
³nd
);

1287 
	`TEST_EQUAL
(*
i
, *
p
);

1288 
p
++;

1290 
	`TEST_EQUAL
(
p
, 
³nd
);

1292 
	`TEST_STRINGS_EQUAL
(
p
.
	`g‘_desütiÚ
(),

1294 
	`TEST_STRINGS_EQUAL
(
³nd
.
	`g‘_desütiÚ
(),

1297  
Œue
;

1298 
	}
}

1301 
	$DEFINE_TESTCASE
(
po¡li¡3
, 
back’d
) {

1302 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
u
;

1304 
X­Ÿn
::
D©aba£
 
	`db_‹mp
(
	`g‘_d©aba£
("apitest_simpledata"));

1305 
u
 = 
db_‹mp
.
	`po¡li¡_begš
("this");

1308 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

1309 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p
 = 
db
.
	`po¡li¡_begš
("this");

1310 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
³nd
 = 
db
.
	`po¡li¡_’d
("this");

1312 
p
 !ğ
³nd
) {

1313 
	`TEST_EQUAL
(*
p
, *
u
);

1314 
p
++;

1315 
u
++;

1317  
Œue
;

1318 
	}
}

1321 
	$DEFINE_TESTCASE
(
po¡li¡4
, 
back’d
) {

1322 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

1323 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
i
 = 
db
.
	`po¡li¡_begš
("this");

1324 
i
.
	`sk_to
(1);

1325 
i
.
	`sk_to
(999999999);

1326 
	`TEST
(
i
 =ğ
db
.
	`po¡li¡_’d
("this"));

1327  
Œue
;

1328 
	}
}

1331 
	$DEFINE_TESTCASE
(
po¡li¡5
, 
back’d
) {

1332 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_manydocs"));

1334 ià(
db
.
	`g‘_avËngth
() != 1)

1335 
	`TEST_EQUAL_DOUBLE
(
db
.
	`g‘_avËngth
(), 4);

1336 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
i
 = 
db
.
	`po¡li¡_begš
("this");

1337 
j
 = 1;

1338 
i
 !ğ
db
.
	`po¡li¡_’d
("this")) {

1339 
	`TEST_EQUAL
(*
i
, 
j
);

1340 
i
++;

1341 
j
++;

1343 
	`TEST_EQUAL
(
j
, 513);

1344  
Œue
;

1345 
	}
}

1348 
	$DEFINE_TESTCASE
(
po¡li¡6
, 
back’d
) {

1349 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

1350 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
i
 = 
db
.
	`po¡li¡_begš
("this");

1351 
	`TEST
(
i
 !ğ
db
.
	`po¡li¡_’d
("this"));

1352 
i
 !ğ
db
.
	`po¡li¡_’d
("this")) {

1353 
	`TEST_EQUAL
(
i
.
	`g‘_doş’gth
(), 
db
.get_doclength(*i));

1354 
	`TEST_REL
(
i
.
	`g‘_wdf
(),<=,i.
	`g‘_doş’gth
());

1355 ++
i
;

1357  
Œue
;

1358 
	}
}

1361 
	$DEFINE_TESTCASE
(
cŞläeq1
, 
back’d
) {

1362 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

1364 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("this"), 11);

1365 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("first"), 1);

1366 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("last"), 0);

1367 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("word"), 9);

1369 
X­Ÿn
::
D©aba£
 
	`db1
(
	`g‘_d©aba£
("apitest_simpledata", "apitest_simpledata2"));

1370 
X­Ÿn
::
D©aba£
 
	`db2
(
	`g‘_d©aba£
("apitest_simpledata"));

1371 
db2
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata2"));

1373 
	`TEST_EQUAL
(
db1
.
	`g‘_cŞËùiÚ_äeq
("this"), 15);

1374 
	`TEST_EQUAL
(
db1
.
	`g‘_cŞËùiÚ_äeq
("first"), 1);

1375 
	`TEST_EQUAL
(
db1
.
	`g‘_cŞËùiÚ_äeq
("last"), 0);

1376 
	`TEST_EQUAL
(
db1
.
	`g‘_cŞËùiÚ_äeq
("word"), 11);

1377 
	`TEST_EQUAL
(
db2
.
	`g‘_cŞËùiÚ_äeq
("this"), 15);

1378 
	`TEST_EQUAL
(
db2
.
	`g‘_cŞËùiÚ_äeq
("first"), 1);

1379 
	`TEST_EQUAL
(
db2
.
	`g‘_cŞËùiÚ_äeq
("last"), 0);

1380 
	`TEST_EQUAL
(
db2
.
	`g‘_cŞËùiÚ_äeq
("word"), 11);

1382  
Œue
;

1383 
	}
}

1386 
	$DEFINE_TESTCASE
(
sÜtv®ue1
, 
back’d
) {

1387 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

1388 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

1390 
·ss
 = 1;…ass <= 2; ++pass) {

1391 
X­Ÿn
::
v®u’o
 
v®ue_no
 = 1; value_no < 7; ++value_no) {

1392 
tout
 << "SÜtšg oÀv®u" << 
v®ue_no
 << 
’dl
;

1393 
’quœe
.
	`£t_sÜt_by_v®ue
(
v®ue_no
, 
Œue
);

1394 
X­Ÿn
::
MS‘
 
®lb£t
 = 
’quœe
.
	`g‘_m£t
(0, 100);

1395 
X­Ÿn
::
MS‘
 
·¹b£t1
 = 
’quœe
.
	`g‘_m£t
(0, 3);

1396 
X­Ÿn
::
MS‘
 
·¹b£t2
 = 
’quœe
.
	`g‘_m£t
(3, 97);

1397 
	`TEST_EQUAL
(
®lb£t
.
	`size
(), 
·¹b£t1
.size(è+ 
·¹b£t2
.size());

1399 
boŞ
 
ok
 = 
Œue
;

1400 
n
 = 0;

1401 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
, 
j
;

1402 
j
 = 
®lb£t
.
	`begš
();

1403 
i
 = 
·¹b£t1
.
	`begš
(); i !ğ·¹b£t1.
	`’d
(); ++i) {

1404 
tout
 << "EÁry " << 
n
 << ": " << *
i
 << " | " << *
j
 << 
’dl
;

1405 
	`TEST
(
j
 !ğ
®lb£t
.
	`’d
());

1406 ià(*
i
 !ğ*
j
è
ok
 = 
çl£
;

1407 ++
j
;

1408 ++
n
;

1410 
tout
 << "===\n";

1411 
i
 = 
·¹b£t2
.
	`begš
(); i !ğ·¹b£t2.
	`’d
(); ++i) {

1412 
tout
 << "EÁry " << 
n
 << ": " << *
i
 << " | " << *
j
 << 
’dl
;

1413 
	`TEST
(
j
 !ğ
®lb£t
.
	`’d
());

1414 ià(*
i
 !ğ*
j
è
ok
 = 
çl£
;

1415 ++
j
;

1416 ++
n
;

1418 
	`TEST
(
j
 =ğ
®lb£t
.
	`’d
());

1419 ià(!
ok
)

1420 
	`FAIL_TEST
("Split msets‡ren't consistent with unsplit");

1422 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

1425  
Œue
;

1426 
	}
}

1432 
DEFINE_TESTCASE
(
cÚsi¡’cy1
, 
back’d
 && !
»mÙe
) {

1433 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("etext"));

1434 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

1435 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, Xapian::Query("the"), Xapian::Query("sky")));

1436 
	gX­Ÿn
::
doccouÁ
 
lÙs
 = 214;

1437 
	gX­Ÿn
::
MS‘
 
bigm£t
 = 
’quœe
.
g‘_m£t
(0, 
lÙs
);

1438 
TEST_EQUAL
(
bigm£t
.
size
(), 
lÙs
);

1439 
	gŒy
 {

1440 
	gX­Ÿn
::
doccouÁ
 
¡¬t
 = 0; 
	g¡¬t
 < 
	glÙs
; ++start) {

1441 
	gX­Ÿn
::
doccouÁ
 
size
 = 0; 
	gsize
 < 
	glÙs
 - 
	g¡¬t
; ++size) {

1442 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(
¡¬t
, 
size
);

1443 ià(
	gm£t
.
size
()) {

1444 
TEST_EQUAL
(
¡¬t
 + 
m£t
.
size
(),

1445 
mš
(
¡¬t
 + 
size
, 
bigm£t
.size()));

1446 } ià(
	gsize
) {

1448 
TEST
(
¡¬t
 >ğ
bigm£t
.
size
());

1450 
	gX­Ÿn
::
doccouÁ
 
i
 = 0; 
	gi
 < 
	gm£t
.
size
(); ++i) {

1451 
TEST_EQUAL
(*
m£t
[
i
], *
bigm£t
[
¡¬t
 + i]);

1452 
TEST_EQUAL_DOUBLE
(
m£t
[
i
].
g‘_weight
(),

1453 
bigm£t
[
¡¬t
 + 
i
].
g‘_weight
());

1458 
ÿtch
 (cÚ¡ 
X­Ÿn
::
N‘wÜkTimeoutE¼Ü
 &) {

1460 
SKIP_TEST
("Testakingoo†ong");

1462  
	gŒue
;

1466 
	$DEFINE_TESTCASE
(
æštd©aba£İ’šg”rÜ1
, 
æšt
) {

1467 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


1468 
	`mkdœ
(".flint", 0755);

1470 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

1471 
X­Ÿn
::
Flšt
::
	`İ’
(".flint/nosuchdirectory"));

1472 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

1473 
X­Ÿn
::
Flšt
::
	`İ’
(".æšt/nosuchdœeùÜy", X­Ÿn::
DB_OPEN
));

1475 
	`mkdœ
(".flint/emptydirectory", 0700);

1476 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

1477 
X­Ÿn
::
Flšt
::
	`İ’
(".flint/emptydirectory"));

1479 
	`touch
(".flint/somefile");

1480 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

1481 
X­Ÿn
::
Flšt
::
	`İ’
(".flint/somefile"));

1482 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£O³nšgE¼Ü
,

1483 
X­Ÿn
::
Flšt
::
	`İ’
(".æšt/somefe", X­Ÿn::
DB_OPEN
));

1484 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£C»©eE¼Ü
,

1485 
X­Ÿn
::
Flšt
::
	`İ’
(".æšt/somefe", X­Ÿn::
DB_CREATE
));

1486 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£C»©eE¼Ü
,

1487 
X­Ÿn
::
Flšt
::
	`İ’
(".æšt/somefe", X­Ÿn::
DB_CREATE_OR_OPEN
));

1488 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£C»©eE¼Ü
,

1489 
X­Ÿn
::
Flšt
::
	`İ’
(".æšt/somefe", X­Ÿn::
DB_CREATE_OR_OVERWRITE
));

1492  
Œue
;

1493 
	}
}

1496 
	$DEFINE_TESTCASE
(
æštd©aba£fÜm©”rÜ1
, 
æšt
) {

1497 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


1498 
¡ršg
 
dbdœ
 = 
‹¡_driv”
::
	`g‘_¤cdœ
();

1499 
dbdœ
 += "/testdata/flint-0.9.9";

1503 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£V”siÚE¼Ü
,

1504 
X­Ÿn
::
D©aba£
 
	`db
(
dbdœ
));

1507 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£V”siÚE¼Ü
,

1508 ()
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
));

1512 
	`uÆšk
((
dbdœ
 + "/æšock").
	`c_¡r
());

1515  
Œue
;

1516 
	}
}

1520 
	$DEFINE_TESTCASE
(
æštd©aba£fÜm©”rÜ2
, 
æšt
) {

1521 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


1522 
¡ršg
 
æšt099
 = 
‹¡_driv”
::
	`g‘_¤cdœ
();

1523 
æšt099
 += "/testdata/flint-0.9.9";

1525 
	`mkdœ
(".flint", 0755);

1526 
¡ršg
 
dbdœ
 = ".flint/test_flintdatabaseformaterror2";

1528 
	`rm_rf
(
dbdœ
);

1529 
	`ı_R
(
æšt099
, 
dbdœ
);

1531 ()
X­Ÿn
::
	`Wr™abËD©aba£
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1533 
	`rm_rf
(
dbdœ
);

1534 
	`ı_R
(
æšt099
, 
dbdœ
);

1537 ()
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1540  
Œue
;

1541 
	}
}

1544 
	$DEFINE_TESTCASE
(
æštd©aba£fÜm©”rÜ3
, 
æšt
) {

1545 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


1546 
¡ršg
 
æšt099
 = 
‹¡_driv”
::
	`g‘_¤cdœ
();

1547 
æšt099
 += "/testdata/flint-0.9.9";

1549 
	`mkdœ
(".flint", 0755);

1550 
¡ršg
 
dbdœ
 = ".flint/test_flintdatabaseformaterror3";

1552 
	`rm_rf
(
dbdœ
);

1553 
	`ı_R
(
æšt099
, 
dbdœ
);

1555 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£V”siÚE¼Ü
,

1556 
X­Ÿn
::
	`Wr™abËD©aba£
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OPEN
));

1560 
X­Ÿn
::
	`Wr™abËD©aba£
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1563  
Œue
;

1564 
	}
}

1567 
	$DEFINE_TESTCASE
(
æštbackw¬dcom·t1
, 
æšt
) {

1568 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


1569 
¡ršg
 
æšt101
 = 
‹¡_driv”
::
	`g‘_¤cdœ
();

1570 
æšt101
 += "/testdata/flint-1.0.1";

1572 
	`mkdœ
(".flint", 0755);

1573 
¡ršg
 
dbdœ
 = ".flint/test_flintbackwardcompat1";

1575 
	`rm_rf
(
dbdœ
);

1576 
	`ı_R
(
æšt101
, 
dbdœ
);

1580 
X­Ÿn
::
D©aba£
 
	`db
(
dbdœ
);

1581 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

1586 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_OPEN
);

1587 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

1591  
Œue
;

1592 
	}
}

1595 
	$DEFINE_TESTCASE
(
æštbackw¬dcom·t2
, 
æšt
) {

1596 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


1597 
¡ršg
 
æšt102
 = 
‹¡_driv”
::
	`g‘_¤cdœ
();

1598 
æšt102
 += "/testdata/flint-1.0.2";

1600 
	`mkdœ
(".flint", 0755);

1601 
¡ršg
 
dbdœ
 = ".flint/test_flintbackwardcompat2";

1603 
	`rm_rf
(
dbdœ
);

1604 
	`ı_R
(
æšt102
, 
dbdœ
);

1608 
X­Ÿn
::
D©aba£
 
	`db
(
dbdœ
);

1609 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

1614 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_OPEN
);

1615 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

1619  
Œue
;

1620 
	}
}

1623 
	$DEFINE_TESTCASE
(
æštd©aba£İ’1
, 
æšt
) {

1624 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


1625 cÚ¡ 
¡ršg
 
dbdœ
 = ".flint/test_flintdatabaseopen1";

1626 
	`mkdœ
(".flint", 0755);

1629 
	`rm_rf
(
dbdœ
);

1630 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 =

1631 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE
);

1632 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£LockE¼Ü
,

1633 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_OPEN
));

1634 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
);

1638 
	`rm_rf
(
dbdœ
);

1639 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 =

1640 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OPEN
);

1641 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£LockE¼Ü
,

1642 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
));

1643 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
);

1647 
	`rm_rf
(
dbdœ
);

1648 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 =

1649 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1650 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£LockE¼Ü
,

1651 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OPEN
));

1652 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
);

1656 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£C»©eE¼Ü
,

1657 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE
));

1658 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 =

1659 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1660 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
);

1664 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 =

1665 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OPEN
);

1666 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
);

1670 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 =

1671 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
, X­Ÿn::
DB_OPEN
);

1672 
X­Ÿn
::
Flšt
::
	`İ’
(
dbdœ
);

1676  
Œue
;

1677 
	}
}

1683 
	$DEFINE_TESTCASE
(
sÜŒ–1
, 
back’d
) {

1684 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_sortrel"));

1685 
’quœe
.
	`£t_sÜt_by_v®ue
(1, 
Œue
);

1686 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("woman"));

1688 cÚ¡ 
X­Ÿn
::
docid
 
Üd”1
[] = { 1,2,3,4,5,6,7,8,9 };

1689 cÚ¡ 
X­Ÿn
::
docid
 
Üd”2
[] = { 2,1,3,6,5,4,7,9,8 };

1690 cÚ¡ 
X­Ÿn
::
docid
 
Üd”3
[] = { 3,2,1,6,5,4,9,8,7 };

1691 cÚ¡ 
X­Ÿn
::
docid
 
Üd”4
[] = { 7,8,9,4,5,6,1,2,3 };

1692 cÚ¡ 
X­Ÿn
::
docid
 
Üd”5
[] = { 9,8,7,6,5,4,3,2,1 };

1693 cÚ¡ 
X­Ÿn
::
docid
 
Üd”6
[] = { 7,9,8,6,5,4,2,1,3 };

1694 cÚ¡ 
X­Ÿn
::
docid
 
Üd”7
[] = { 7,9,8,6,5,4,2,1,3 };

1695 cÚ¡ 
X­Ÿn
::
docid
 
Üd”8
[] = { 7,6,2,9,5,1,8,4,3 };

1696 cÚ¡ 
X­Ÿn
::
docid
 
Üd”9
[] = { 2,6,7,1,5,9,3,4,8 };

1698 
X­Ÿn
::
MS‘
 
m£t
;

1699 
size_t
 
i
;

1701 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1702 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”1
è/ (
X­Ÿn
::
docid
));

1703 
i
 = 0; i < (
Üd”1
è/ (
X­Ÿn
::
docid
); ++i) {

1704 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”1
[i]);

1707 
’quœe
.
	`£t_sÜt_by_v®ue_th’_»Ëvªû
(1, 
Œue
);

1709 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1710 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”2
è/ (
X­Ÿn
::
docid
));

1711 
i
 = 0; i < (
Üd”2
è/ (
X­Ÿn
::
docid
); ++i) {

1712 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”2
[i]);

1715 
’quœe
.
	`£t_sÜt_by_v®ue
(1, 
Œue
);

1717 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1718 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”1
è/ (
X­Ÿn
::
docid
));

1719 
i
 = 0; i < (
Üd”1
è/ (
X­Ÿn
::
docid
); ++i) {

1720 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”1
[i]);

1723 
’quœe
.
	`£t_sÜt_by_v®ue_th’_»Ëvªû
(1, 
Œue
);

1724 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

1726 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1727 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”2
è/ (
X­Ÿn
::
docid
));

1728 
i
 = 0; i < (
Üd”2
è/ (
X­Ÿn
::
docid
); ++i) {

1729 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”2
[i]);

1732 
’quœe
.
	`£t_sÜt_by_v®ue
(1, 
Œue
);

1733 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

1735 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1736 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”3
è/ (
X­Ÿn
::
docid
));

1737 
i
 = 0; i < (
Üd”3
è/ (
X­Ÿn
::
docid
); ++i) {

1738 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”3
[i]);

1741 
’quœe
.
	`£t_sÜt_by_v®ue
(1, 
çl£
);

1742 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
ASCENDING
);

1743 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1744 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”4
è/ (
X­Ÿn
::
docid
));

1745 
i
 = 0; i < (
Üd”4
è/ (
X­Ÿn
::
docid
); ++i) {

1746 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”4
[i]);

1749 
’quœe
.
	`£t_sÜt_by_v®ue
(1, 
çl£
);

1750 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

1751 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1752 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”5
è/ (
X­Ÿn
::
docid
));

1753 
i
 = 0; i < (
Üd”5
è/ (
X­Ÿn
::
docid
); ++i) {

1754 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”5
[i]);

1757 
’quœe
.
	`£t_sÜt_by_v®ue_th’_»Ëvªû
(1, 
çl£
);

1758 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
ASCENDING
);

1759 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1760 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”6
è/ (
X­Ÿn
::
docid
));

1761 
i
 = 0; i < (
Üd”6
è/ (
X­Ÿn
::
docid
); ++i) {

1762 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”6
[i]);

1765 
’quœe
.
	`£t_sÜt_by_v®ue_th’_»Ëvªû
(1, 
çl£
);

1766 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

1767 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1768 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”7
è/ (
X­Ÿn
::
docid
));

1769 
i
 = 0; i < (
Üd”7
è/ (
X­Ÿn
::
docid
); ++i) {

1770 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”7
[i]);

1773 
’quœe
.
	`£t_sÜt_by_»Ëvªû_th’_v®ue
(1, 
Œue
);

1774 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
ASCENDING
);

1775 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1776 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”8
è/ (
X­Ÿn
::
docid
));

1777 
i
 = 0; i < (
Üd”8
è/ (
X­Ÿn
::
docid
); ++i) {

1778 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”8
[i]);

1781 
’quœe
.
	`£t_sÜt_by_»Ëvªû_th’_v®ue
(1, 
Œue
);

1782 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

1783 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1784 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”8
è/ (
X­Ÿn
::
docid
));

1785 
i
 = 0; i < (
Üd”8
è/ (
X­Ÿn
::
docid
); ++i) {

1786 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”8
[i]);

1789 
’quœe
.
	`£t_sÜt_by_»Ëvªû_th’_v®ue
(1, 
çl£
);

1790 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
ASCENDING
);

1791 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1792 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”9
è/ (
X­Ÿn
::
docid
));

1793 
i
 = 0; i < (
Üd”9
è/ (
X­Ÿn
::
docid
); ++i) {

1794 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”9
[i]);

1797 
’quœe
.
	`£t_sÜt_by_»Ëvªû_th’_v®ue
(1, 
çl£
);

1798 
’quœe
.
	`£t_docid_Üd”
(
X­Ÿn
::
Enquœe
::
DESCENDING
);

1799 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1800 
	`TEST_EQUAL
(
m£t
.
	`size
(), (
Üd”9
è/ (
X­Ÿn
::
docid
));

1801 
i
 = 0; i < (
Üd”9
è/ (
X­Ÿn
::
docid
); ++i) {

1802 
	`TEST_EQUAL
(*
m£t
[
i
], 
Üd”9
[i]);

1805  
Œue
;

1806 
	}
}

1809 
	$DEFINE_TESTCASE
(
Ãt¡©s1
, 
»mÙe
) {

1810 
Back’dMªag”Loÿl
 
loÿl_mªag”
;

1811 
loÿl_mªag”
.
	`£t_d©adœ
(
‹¡_driv”
::
	`g‘_¤cdœ
() + "/testdata/");

1813 cÚ¡ * 
wÜds
[] = { "paragraph", "word" };

1814 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
wÜds
, words + 2);

1815 cÚ¡ 
size_t
 
MSET_SIZE
 = 10;

1817 
X­Ÿn
::
RS‘
 
r£t
;

1818 
r£t
.
	`add_docum’t
(4);

1819 
r£t
.
	`add_docum’t
(9);

1821 
X­Ÿn
::
MS‘
 
m£t_®Îoÿl
;

1823 
X­Ÿn
::
D©aba£
 
db
;

1824 
db
.
	`add_d©aba£
(
loÿl_mªag”
.
	`g‘_d©aba£
("apitest_simpledata"));

1825 
db
.
	`add_d©aba£
(
loÿl_mªag”
.
	`g‘_d©aba£
("apitest_simpledata2"));

1827 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

1828 
’q
.
	`£t_qu”y
(
qu”y
);

1829 
m£t_®Îoÿl
 = 
’q
.
	`g‘_m£t
(0, 
MSET_SIZE
, &
r£t
);

1833 
X­Ÿn
::
D©aba£
 
db
;

1834 
db
.
	`add_d©aba£
(
loÿl_mªag”
.
	`g‘_d©aba£
("apitest_simpledata"));

1835 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata2"));

1837 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

1838 
’q
.
	`£t_qu”y
(
qu”y
);

1839 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 
MSET_SIZE
, &
r£t
);

1840 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_low”_bound
(), 
m£t_®Îoÿl
.get_matches_lower_bound());

1841 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_uµ”_bound
(), 
m£t_®Îoÿl
.get_matches_upper_bound());

1842 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_e¡im©ed
(), 
m£t_®Îoÿl
.get_matches_estimated());

1843 
	`TEST_EQUAL
(
m£t
.
	`g‘_max_©šed
(), 
m£t_®Îoÿl
.get_max_attained());

1844 
	`TEST_EQUAL
(
m£t
.
	`size
(), 
m£t_®Îoÿl
.size());

1845 
	`TEST
(
	`m£t_¿nge_is_§me
(
m£t
, 0, 
m£t_®Îoÿl
, 0, m£t.
	`size
()));

1849 
X­Ÿn
::
D©aba£
 
db
;

1850 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata"));

1851 
db
.
	`add_d©aba£
(
loÿl_mªag”
.
	`g‘_d©aba£
("apitest_simpledata2"));

1853 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

1854 
’q
.
	`£t_qu”y
(
qu”y
);

1855 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 
MSET_SIZE
, &
r£t
);

1856 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_low”_bound
(), 
m£t_®Îoÿl
.get_matches_lower_bound());

1857 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_uµ”_bound
(), 
m£t_®Îoÿl
.get_matches_upper_bound());

1858 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_e¡im©ed
(), 
m£t_®Îoÿl
.get_matches_estimated());

1859 
	`TEST_EQUAL
(
m£t
.
	`g‘_max_©šed
(), 
m£t_®Îoÿl
.get_max_attained());

1860 
	`TEST_EQUAL
(
m£t
.
	`size
(), 
m£t_®Îoÿl
.size());

1861 
	`TEST
(
	`m£t_¿nge_is_§me
(
m£t
, 0, 
m£t_®Îoÿl
, 0, m£t.
	`size
()));

1865 
X­Ÿn
::
D©aba£
 
db
;

1866 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata"));

1867 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata2"));

1869 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

1870 
’q
.
	`£t_qu”y
(
qu”y
);

1871 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 
MSET_SIZE
, &
r£t
);

1872 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_low”_bound
(), 
m£t_®Îoÿl
.get_matches_lower_bound());

1873 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_uµ”_bound
(), 
m£t_®Îoÿl
.get_matches_upper_bound());

1874 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_e¡im©ed
(), 
m£t_®Îoÿl
.get_matches_estimated());

1875 
	`TEST_EQUAL
(
m£t
.
	`g‘_max_©šed
(), 
m£t_®Îoÿl
.get_max_attained());

1876 
	`TEST_EQUAL
(
m£t
.
	`size
(), 
m£t_®Îoÿl
.size());

1877 
	`TEST
(
	`m£t_¿nge_is_§me
(
m£t
, 0, 
m£t_®Îoÿl
, 0, m£t.
	`size
()));

1880  
Œue
;

1881 
	}
}

1884 şas 
	cMyWeight
 : 
public
 
X­Ÿn
::
Weight
 {

1885 
sÿË_çùÜ
;

1887 
	mpublic
:

1888 
MyWeight
 * 
	$şÚe
() const {

1889  
Ãw
 
MyWeight
;

1891 
	$š™
(
çùÜ
) {

1892 
sÿË_çùÜ
 = 
çùÜ
;

1893 
	}
}

1894 
	$MyWeight
(è{ 
	}
}

1895 ~
	$MyWeight
(è{ 
	}
}

1896 
	g¡d
::
¡ršg
 
	$Çme
(ècÚ¡ {  "MyWeight"; 
	}
}

1897 
¡ršg
 
	$£rŸli£
(ècÚ¡ {  
	`¡ršg
(); 
	}
}

1898 
MyWeight
 * 
	$un£rŸli£
(cÚ¡ 
¡ršg
 &ècÚ¡ {  
Ãw
 
MyWeight
; 
	}
}

1899 
	gX­Ÿn
::
weight
 
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
, Xapian::termcount) const {

1900  
sÿË_çùÜ
;

1902 
	gX­Ÿn
::
weight
 
	$g‘_max·¹
(ècÚ¡ {  
sÿË_çùÜ
; 
	}
}

1904 
	gX­Ÿn
::
weight
 
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
) const {  0; }

1905 
	gX­Ÿn
::
weight
 
	$g‘_maxexŒa
(ècÚ¡ {  0; 
	}
}

1911 
DEFINE_TESTCASE
(
u£rweight1
, 
back’d
 && !
»mÙe
) {

1912 
	gX­Ÿn
::
Enquœe
 
’quœe
(
g‘_d©aba£
("apitest_simpledata"));

1913 
	g’quœe
.
£t_weightšg_scheme
(
MyWeight
());

1914 cÚ¡ * 
	gqu”y
[] = { "this", "line", "paragraph", "rubbish" };

1915 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
qu”y
,

1916 
qu”y
 + (query) / (query[0])));

1917 
	gX­Ÿn
::
MS‘
 
mym£t1
 = 
’quœe
.
g‘_m£t
(0, 100);

1920 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
mym£t1
.
begš
(); 
	gi
 !ğmym£t1.
’d
(); ++i) {

1921 
	gX­Ÿn
::
‹rmcouÁ
 
m©chšg_‹rms
 = 0;

1922 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
’quœe
.
g‘_m©chšg_‹rms_begš
(
i
);

1923 
	gt
 !ğ
’quœe
.
g‘_m©chšg_‹rms_’d
(
i
)) {

1924 ++
m©chšg_‹rms
;

1925 ++
	gt
;

1927 
TEST_EQUAL
(
i
.
g‘_weight
(), 
m©chšg_‹rms
);

1930  
	gŒue
;

1937 
	$DEFINE_TESTCASE
(
m©ch®l1
, 
back’d
) {

1938 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

1939 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

1940 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
Qu”y
::
M©chAÎ
);

1941 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1942 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_low”_bound
(), 
db
.
	`g‘_doccouÁ
());

1943 
	`TEST_EQUAL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 
db
.
	`g‘_doccouÁ
());

1945 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

1946 
X­Ÿn
::
	`Qu”y
("nosuchterm"),

1947 
X­Ÿn
::
Qu”y
::
M©chAÎ
));

1948 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1949 
	`TEST_EQUAL
(
m£t
.
	`g‘_m©ches_low”_bound
(), 
db
.
	`g‘_doccouÁ
());

1950 
	`TEST_EQUAL
(
m£t
.
	`g‘_uncŞÏp£d_m©ches_low”_bound
(), 
db
.
	`g‘_doccouÁ
());

1953 
	`TEST
(
m£t
.
	`size
() > 1);

1954 
	`TEST_EQUAL
(
m£t
[m£t.
	`size
(è- 1].
	`g‘_weight
(), 0);

1955 
	`TEST_EQUAL
(*
m£t
[0], 1);

1956 
	`TEST_EQUAL
(*
m£t
[m£t.
	`size
() - 1], mset.size());

1958  
Œue
;

1959 
	}
}

1962 
DEFINE_TESTCASE
(
v®ue£tm©chdecid”2
, 
back’d
 && !
»mÙe
) {

1963 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_phrase"));

1964 
	gX­Ÿn
::
Enquœe
 
’q
(
db
);

1965 
	g’q
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("leav"));

1967 
	gX­Ÿn
::
V®ueS‘M©chDecid”
 
vsmd1
(1, 
Œue
);

1968 
	gvsmd1
.
add_v®ue
("n");

1969 
	gX­Ÿn
::
V®ueS‘M©chDecid”
 
vsmd2
(1, 
çl£
);

1970 
	gvsmd2
.
add_v®ue
("n");

1972 
	gX­Ÿn
::
MS‘
 
mym£t
 = 
’q
.
g‘_m£t
(0, 20);

1973 
m£t_ex³ù_Üd”
(
mym£t
, 8, 6, 4, 5, 7, 10, 12, 11, 13, 9, 14);

1974 
	gmym£t
 = 
’q
.
g‘_m£t
(0, 20, 0, 
NULL
, &
vsmd1
);

1975 
m£t_ex³ù_Üd”
(
mym£t
, 6, 12);

1976 
	gmym£t
 = 
’q
.
g‘_m£t
(0, 20, 0, 
NULL
, &
vsmd2
);

1977 
m£t_ex³ù_Üd”
(
mym£t
, 8, 4, 5, 7, 10, 11, 13, 9, 14);

1979  
	gŒue
;

	@tests/api_db.h

2 
boŞ
 
‹¡_‹rm¡©s
();

3 
boŞ
 
‹¡_¡ubdb1
();

4 
boŞ
 
‹¡_¡ubdb2
();

5 
boŞ
 
‹¡_¡ubdb3
();

6 
boŞ
 
‹¡_¡ubdb4
();

7 
boŞ
 
‹¡_¡ubdb5
();

8 
boŞ
 
‹¡_¡ubdb6
();

9 
boŞ
 
‹¡_m©chdecid”1
();

10 
boŞ
 
‹¡_m©chdecid”2
();

11 
boŞ
 
‹¡_m©chdecid”3
();

12 
boŞ
 
‹¡_m£t™”©Ü1
();

13 
boŞ
 
‹¡_m£t™”©Ü2
();

14 
boŞ
 
‹¡_m£t™”©Ü3
();

15 
boŞ
 
‹¡_e£t™”©Ü1
();

16 
boŞ
 
‹¡_e£t™”©Ü2
();

17 
boŞ
 
‹¡_cŞÏp£key1
();

18 
boŞ
 
‹¡_cŞÏp£key2
();

19 
boŞ
 
‹¡_cŞÏp£key3
();

20 
boŞ
 
‹¡_cŞÏp£key4
();

21 
boŞ
 
‹¡_k“·live1
();

22 
boŞ
 
‹¡_®É”ms1
();

23 
boŞ
 
‹¡_®É”ms2
();

24 
boŞ
 
‹¡_®É”ms3
();

25 
boŞ
 
‹¡_®É”ms4
();

26 
boŞ
 
‹¡_®É”ms5
();

27 
boŞ
 
‹¡_®É”ms6
();

28 
boŞ
 
‹¡_¥ecŸÉ”ms1
();

29 
boŞ
 
‹¡_¥ecŸÉ”ms2
();

30 
boŞ
 
‹¡_r£tmuÉidb2
();

31 
boŞ
 
‹¡_muÉ›x·nd1
();

32 
boŞ
 
‹¡_po¡li¡1
();

33 
boŞ
 
‹¡_po¡li¡2
();

34 
boŞ
 
‹¡_po¡li¡3
();

35 
boŞ
 
‹¡_po¡li¡4
();

36 
boŞ
 
‹¡_po¡li¡5
();

37 
boŞ
 
‹¡_po¡li¡6
();

38 
boŞ
 
‹¡_cŞläeq1
();

39 
boŞ
 
‹¡_sÜtv®ue1
();

40 
boŞ
 
‹¡_cÚsi¡’cy1
();

41 
boŞ
 
‹¡_æštd©aba£İ’šg”rÜ1
();

42 
boŞ
 
‹¡_æštd©aba£fÜm©”rÜ1
();

43 
boŞ
 
‹¡_æštd©aba£fÜm©”rÜ2
();

44 
boŞ
 
‹¡_æštd©aba£fÜm©”rÜ3
();

45 
boŞ
 
‹¡_æštbackw¬dcom·t1
();

46 
boŞ
 
‹¡_æštbackw¬dcom·t2
();

47 
boŞ
 
‹¡_æštd©aba£İ’1
();

48 
boŞ
 
‹¡_sÜŒ–1
();

49 
boŞ
 
‹¡_Ãt¡©s1
();

50 
boŞ
 
‹¡_u£rweight1
();

51 
boŞ
 
‹¡_m©ch®l1
();

52 
boŞ
 
‹¡_v®ue£tm©chdecid”2
();

	@tests/api_generated.cc

22 
	~<cÚfig.h
>

24 
	~"­i_g’”©ed.h
"

26 
	~<x­Ÿn.h
>

28 
	~"­™e¡.h
"

29 
	~"‹¡uts.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

34 
DEFINE_TESTCASE
(
deçuÉùÜ1
, !
back’d
) {

35 
	gX­Ÿn
::
BM25Weight
 
bm25weight
;

36 
	gX­Ÿn
::
BoŞWeight
 
boŞweight
;

37 
	gX­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
deü—sšgv®ueweigho¡šgsourû
(0);

38 ()
	gdeü—sšgv®ueweigho¡šgsourû
.
g‘_desütiÚ
();

39 
	gX­Ÿn
::
FixedWeightPo¡šgSourû
 
fixedweigho¡šgsourû
(0);

40 ()
	gfixedweigho¡šgsourû
.
g‘_desütiÚ
();

41 
	gX­Ÿn
::
T¿dWeight
 
Œadweight
;

42 
	gX­Ÿn
::
V®ueCouÁM©chSpy
 
v®uecouÁm©ch¥y
(0);

43 ()
	gv®uecouÁm©ch¥y
.
g‘_desütiÚ
();

44 
	gX­Ÿn
::
V®ueM­Po¡šgSourû
 
v®uem­po¡šgsourû
(0);

45 ()
	gv®uem­po¡šgsourû
.
g‘_desütiÚ
();

46 
	gX­Ÿn
::
V®uePo¡šgSourû
 
v®u•o¡šgsourû
(0);

47 ()
	gv®u•o¡šgsourû
.
g‘_desütiÚ
();

48 
	gX­Ÿn
::
V®ueWeightPo¡šgSourû
 
v®ueweigho¡šgsourû
(0);

49 ()
	gv®ueweigho¡šgsourû
.
g‘_desütiÚ
();

50  
	gŒue
;

54 
DEFINE_TESTCASE
(
cİyassign1
, !
back’d
) {

55 
	gX­Ÿn
::
D©aba£
 
d©aba£
;

56 ()
	gd©aba£
.
g‘_desütiÚ
();

57 
	gX­Ÿn
::
D©aba£
 
cİy_d©aba£
(
d©aba£
);

58 
	gd©aba£
 = 
cİy_d©aba£
;

60 
	gX­Ÿn
::
D©eV®ueRªgeProûssÜ
 
d©ev®u”ªg•roûssÜ
(0);

61 
	gX­Ÿn
::
D©eV®ueRªgeProûssÜ
 
cİy_d©ev®u”ªg•roûssÜ
(
d©ev®u”ªg•roûssÜ
);

62 
	gd©ev®u”ªg•roûssÜ
 = 
cİy_d©ev®u”ªg•roûssÜ
;

64 
	gX­Ÿn
::
Docum’t
 
docum’t
;

65 ()
	gdocum’t
.
g‘_desütiÚ
();

66 
	gX­Ÿn
::
Docum’t
 
cİy_docum’t
(
docum’t
);

67 
	gdocum’t
 = 
cİy_docum’t
;

69 
	gX­Ÿn
::
ES‘
 
e£t
;

70 ()
	ge£t
.
g‘_desütiÚ
();

71 
	gX­Ÿn
::
ES‘
 
cİy_e£t
(
e£t
);

72 
	ge£t
 = 
cİy_e£t
;

74 
	gX­Ÿn
::
ES‘I‹¿tÜ
 
e£t™”©Ü
;

75 ()
	ge£t™”©Ü
.
g‘_desütiÚ
();

76 
	gX­Ÿn
::
ES‘I‹¿tÜ
 
cİy_e£t™”©Ü
(
e£t™”©Ü
);

77 
	ge£t™”©Ü
 = 
cİy_e£t™”©Ü
;

79 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


80 
	gX­Ÿn
::
Enquœe
 
’quœe
(
X­Ÿn
::
InMemÜy
::
İ’
());

81 ()
	g’quœe
.
g‘_desütiÚ
();

82 
	gX­Ÿn
::
Enquœe
 
cİy_’quœe
(
’quœe
);

83 
	g’quœe
 = 
cİy_’quœe
;

86 
	gX­Ÿn
::
MS‘
 
m£t
;

87 ()
	gm£t
.
g‘_desütiÚ
();

88 
	gX­Ÿn
::
MS‘
 
cİy_m£t
(
m£t
);

89 
	gm£t
 = 
cİy_m£t
;

91 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
m£t™”©Ü
;

92 ()
	gm£t™”©Ü
.
g‘_desütiÚ
();

93 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
cİy_m£t™”©Ü
(
m£t™”©Ü
);

94 
	gm£t™”©Ü
 = 
cİy_m£t™”©Ü
;

96 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
muÉiv®uekeymak”
;

97 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
cİy_muÉiv®uekeymak”
(
muÉiv®uekeymak”
);

98 
	gmuÉiv®uekeymak”
 = 
cİy_muÉiv®uekeymak”
;

100 
	gX­Ÿn
::
Numb”V®ueRªgeProûssÜ
 
numb”v®u”ªg•roûssÜ
(0, "");

101 
	gX­Ÿn
::
Numb”V®ueRªgeProûssÜ
 
cİy_numb”v®u”ªg•roûssÜ
(
numb”v®u”ªg•roûssÜ
);

102 
	gnumb”v®u”ªg•roûssÜ
 = 
cİy_numb”v®u”ªg•roûssÜ
;

104 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos™iÚ™”©Ü
;

105 ()
	gpos™iÚ™”©Ü
.
g‘_desütiÚ
();

106 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
cİy_pos™iÚ™”©Ü
(
pos™iÚ™”©Ü
);

107 
	gpos™iÚ™”©Ü
 = 
cİy_pos™iÚ™”©Ü
;

109 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 
po¡šg™”©Ü
;

110 ()
	gpo¡šg™”©Ü
.
g‘_desütiÚ
();

111 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 
cİy_po¡šg™”©Ü
(
po¡šg™”©Ü
);

112 
	gpo¡šg™”©Ü
 = 
cİy_po¡šg™”©Ü
;

114 
	gX­Ÿn
::
Qu”y
 
qu”y
;

115 ()
	gqu”y
.
g‘_desütiÚ
();

116 
	gX­Ÿn
::
Qu”y
 
cİy_qu”y
(
qu”y
);

117 
	gqu”y
 = 
cİy_qu”y
;

119 
	gX­Ÿn
::
Qu”yP¬£r
 
qu”y·r£r
;

120 ()
	gqu”y·r£r
.
g‘_desütiÚ
();

121 
	gX­Ÿn
::
Qu”yP¬£r
 
cİy_qu”y·r£r
(
qu”y·r£r
);

122 
	gqu”y·r£r
 = 
cİy_qu”y·r£r
;

124 
	gX­Ÿn
::
RS‘
 
r£t
;

125 ()
	gr£t
.
g‘_desütiÚ
();

126 
	gX­Ÿn
::
RS‘
 
cİy_r£t
(
r£t
);

127 
	gr£t
 = 
cİy_r£t
;

129 
	gX­Ÿn
::
Regi¡ry
 
»gi¡ry
;

130 
	gX­Ÿn
::
Regi¡ry
 
cİy_»gi¡ry
(
»gi¡ry
);

131 
	g»gi¡ry
 = 
cİy_»gi¡ry
;

133 
	gX­Ÿn
::
Sim¶eStİ³r
 
sim¶e¡İ³r
;

134 ()
	gsim¶e¡İ³r
.
g‘_desütiÚ
();

135 
	gX­Ÿn
::
Sim¶eStİ³r
 
cİy_sim¶e¡İ³r
(
sim¶e¡İ³r
);

136 
	gsim¶e¡İ³r
 = 
cİy_sim¶e¡İ³r
;

138 
	gX­Ÿn
::
S‹m
 
¡em
;

139 ()
	g¡em
.
g‘_desütiÚ
();

140 
	gX­Ÿn
::
S‹m
 
cİy_¡em
(
¡em
);

141 
	g¡em
 = 
cİy_¡em
;

143 
	gX­Ÿn
::
SŒšgV®ueRªgeProûssÜ
 
¡ršgv®u”ªg•roûssÜ
(0);

144 
	gX­Ÿn
::
SŒšgV®ueRªgeProûssÜ
 
cİy_¡ršgv®u”ªg•roûssÜ
(
¡ršgv®u”ªg•roûssÜ
);

145 
	g¡ršgv®u”ªg•roûssÜ
 = 
cİy_¡ršgv®u”ªg•roûssÜ
;

147 
	gX­Ÿn
::
T”mG’”©Ü
 
‹rmg’”©Ü
;

148 ()
	g‹rmg’”©Ü
.
g‘_desütiÚ
();

149 
	gX­Ÿn
::
T”mG’”©Ü
 
cİy_‹rmg’”©Ü
(
‹rmg’”©Ü
);

150 
	g‹rmg’”©Ü
 = 
cİy_‹rmg’”©Ü
;

152 
	gX­Ÿn
::
T”mI‹¿tÜ
 
‹rm™”©Ü
;

153 ()
	g‹rm™”©Ü
.
g‘_desütiÚ
();

154 
	gX­Ÿn
::
T”mI‹¿tÜ
 
cİy_‹rm™”©Ü
(
‹rm™”©Ü
);

155 
	g‹rm™”©Ü
 = 
cİy_‹rm™”©Ü
;

157 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v®ue™”©Ü
;

158 ()
	gv®ue™”©Ü
.
g‘_desütiÚ
();

159 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
cİy_v®ue™”©Ü
(
v®ue™”©Ü
);

160 
	gv®ue™”©Ü
 = 
cİy_v®ue™”©Ü
;

162 
	gX­Ÿn
::
Wr™abËD©aba£
 
wr™abËd©aba£
;

163 ()
	gwr™abËd©aba£
.
g‘_desütiÚ
();

164 
	gX­Ÿn
::
Wr™abËD©aba£
 
cİy_wr™abËd©aba£
(
wr™abËd©aba£
);

165 
	gwr™abËd©aba£
 = 
cİy_wr™abËd©aba£
;

167  
	gŒue
;

	@tests/api_generated.h

2 
boŞ
 
‹¡_deçuÉùÜ1
();

3 
boŞ
 
‹¡_cİyassign1
();

	@tests/api_matchspy.cc

24 
	~<cÚfig.h
>

26 
	~"­i_m©ch¥y.h
"

28 
	~<x­Ÿn.h
>

30 
	~"¡r.h
"

31 
	~<cm©h
>

32 
	~<m­
>

33 
	~<veùÜ
>

35 
	~"back’dmªag”.h
"

36 
	~"‹¡su™e.h
"

37 
	~"‹¡uts.h
"

38 
	~"­™e¡.h
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

45 şas 
	cSim¶eM©chSpy
 : 
public
 
X­Ÿn
::
M©chSpy
 {

46 
public
:

48 
¡d
::
veùÜ
<¡d::
¡ršg
> 
£’
;

50 
	$İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &
doc
,

51 
X­Ÿn
::
weight
) {

55 
£’
.
	`push_back
(
doc
.
	`g‘_d©a
());

57 
	}
};

60 
DEFINE_TESTCASE
(
m©ch¥y1
, 
back’d
 && !
»mÙe
) {

61 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_simpledata"));

62 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

63 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("this"));

65 
Sim¶eM©chSpy
 
	gmy¥y
;

67 
	gX­Ÿn
::
MS‘
 
no¥ym£t
 = 
’quœe
.
g‘_m£t
(0, 100);

68 
	g’quœe
.
add_m©ch¥y
(&
my¥y
);

69 
	gX­Ÿn
::
MS‘
 
¥ym£t
 = 
’quœe
.
g‘_m£t
(0, 100);

72 
TEST_EQUAL
(
no¥ym£t
, 
¥ym£t
);

74 
	gveùÜ
<
	gboŞ
> 
docid_checked
(
db
.
g‘_Ï¡docid
());

78 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
¥ym£t
.
begš
();

79 
TEST
(
i
 !ğ
¥ym£t
.
’d
());

80 
TEST_EQUAL
(
¥ym£t
.
size
(), 6);

81 
TEST_EQUAL
(
my¥y
.
£’
.
size
(), 
¥ym£t
.size());

83 
	g¡d
::
sÜt
(
my¥y
.
£’
.
begš
(), my¥y.£’.
’d
());

85 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
£’2
;

86  ; 
	gi
 !ğ
¥ym£t
.
’d
(); ++i) {

87 cÚ¡ 
	gX­Ÿn
::
Docum’t
 
doc
(
i
.
g‘_docum’t
());

88 
	g£’2
.
push_back
(
doc
.
g‘_d©a
());

90 
	g¡d
::
sÜt
(
£’2
.
begš
(), s“n2.
’d
());

92 
TEST_EQUAL
(
my¥y
.
£’
.
size
(), 
£’2
.size());

93 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>::
cÚ¡_™”©Ü
 
j
 = 
my¥y
.
£’
.
begš
();

94 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>::
cÚ¡_™”©Ü
 
j2
 = 
£’2
.
begš
();

95 ; 
	gj
 !ğ
my¥y
.
£’
.
’d
(); ++j, ++
	gj2
) {

96 
TEST_EQUAL
(*
j
, *
j2
);

99  
	gŒue
;

102 
¡ršg
 
v®ues_to_»´
(cÚ¡ 
X­Ÿn
::
V®ueCouÁM©chSpy
 & 
¥y
) {

103 
¡ršg
 
»suÉ»´
("|");

104 
	gX­Ÿn
::
T”mI‹¿tÜ
 
i
 = 
¥y
.
v®ues_begš
();

105 
	gi
 !ğ
¥y
.
v®ues_’d
();

106 ++
	gi
) {

107 
	g»suÉ»´
 +ğ*
i
;

108 
	g»suÉ»´
 += ':';

109 
	g»suÉ»´
 +ğ
¡r
(
i
.
g‘_‹rmäeq
());

110 
	g»suÉ»´
 += '|';

112  
	g»suÉ»´
;

115 
	$DEFINE_TESTCASE
(
m©ch¥y2
, 
wr™abË
)

117 ià(
	`g‘_dbty³
() == "remotetcp" || get_dbtype() == "remoteprog") {

118 
	`SKIP_TEST
("Test‚ot supported for„emote backend");

121 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

122 
c
 = 1; c <= 25; ++c) {

123 
X­Ÿn
::
Docum’t
 
doc
;

124 
doc
.
	`£t_d©a
("Docum’ˆ" + 
	`¡r
(
c
));

125 
çùÜs
 = 0;

126 
çùÜ
 = 1; faùÜ <ğ
c
; ++factor) {

127 
doc
.
	`add_‹rm
("all");

128 ià(
c
 % 
çùÜ
 == 0) {

129 
doc
.
	`add_‹rm
("XFACT" + 
	`¡r
(
çùÜ
));

130 ++
çùÜs
;

135 
doc
.
	`add_v®ue
(0, 
	`¡r
(
çùÜs
));

137 
doc
.
	`add_v®ue
(1, 
	`¡r
(
c
 % 10));

139 
doc
.
	`add_v®ue
(2, "fish");

141 
doc
.
	`add_v®ue
(3, 
	`¡r
(¡r(
c
).
	`size
()));

143 
db
.
	`add_docum’t
(
doc
);

146 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥y0
(0);

147 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥y1
(1);

148 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥y3
(3);

150 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

152 
’q
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("all"));

154 
’q
.
	`add_m©ch¥y
(&
¥y0
);

155 
’q
.
	`add_m©ch¥y
(&
¥y1
);

156 
’q
.
	`add_m©ch¥y
(&
¥y3
);

157 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 10);

159 
	`TEST_EQUAL
(
¥y0
.
	`g‘_tÙ®
(), 25);

160 
	`TEST_EQUAL
(
¥y1
.
	`g‘_tÙ®
(), 25);

161 
	`TEST_EQUAL
(
¥y3
.
	`g‘_tÙ®
(), 25);

163 cÚ¡ * 
»suÉs
[] = {

168 
	`TEST_STRINGS_EQUAL
(
	`v®ues_to_»´
(
¥y0
), 
»suÉs
[0]);

169 
	`TEST_STRINGS_EQUAL
(
	`v®ues_to_»´
(
¥y1
), 
»suÉs
[1]);

170 
	`TEST_STRINGS_EQUAL
(
	`v®ues_to_»´
(
¥y3
), 
»suÉs
[2]);

172  
Œue
;

173 
	}
}

175 
	$DEFINE_TESTCASE
(
m©ch¥y4
, 
wr™abË
)

177 ià(
	`g‘_dbty³
() == "remotetcp" || get_dbtype() == "remoteprog") {

178 
	`SKIP_TEST
("Test‚ot supported for„emote backend");

181 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

182 
c
 = 1; c <= 25; ++c) {

183 
X­Ÿn
::
Docum’t
 
doc
;

184 
doc
.
	`£t_d©a
("Docum’ˆ" + 
	`¡r
(
c
));

185 
çùÜs
 = 0;

186 
çùÜ
 = 1; faùÜ <ğ
c
; ++factor) {

187 
doc
.
	`add_‹rm
("all");

188 ià(
c
 % 
çùÜ
 == 0) {

189 
doc
.
	`add_‹rm
("XFACT" + 
	`¡r
(
çùÜ
));

190 ++
çùÜs
;

195 
doc
.
	`add_v®ue
(0, 
	`¡r
(
çùÜs
));

197 
doc
.
	`add_v®ue
(1, 
	`¡r
(
c
 % 10));

199 
doc
.
	`add_v®ue
(2, "fish");

201 
doc
.
	`add_v®ue
(3, 
	`¡r
(¡r(
c
).
	`size
()));

203 
db
.
	`add_docum’t
(
doc
);

209 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥ya0
(0);

210 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥ya1
(1);

211 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥ya3
(3);

212 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥yb0
(0);

213 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥yb1
(1);

214 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`¥yb3
(3);

216 
X­Ÿn
::
Enquœe
 
	`’qa
(
db
);

217 
X­Ÿn
::
Enquœe
 
	`’qb
(
db
);

219 
’qa
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("all"));

220 
’qb
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("all"));

222 
’qa
.
	`add_m©ch¥y
(&
¥ya0
);

223 
’qa
.
	`add_m©ch¥y
(&
¥ya1
);

224 
’qa
.
	`add_m©ch¥y
(&
¥ya3
);

225 
’qb
.
	`add_m©ch¥y
(&
¥yb0
);

226 
’qb
.
	`add_m©ch¥y
(&
¥yb1
);

227 
’qb
.
	`add_m©ch¥y
(&
¥yb3
);

229 
X­Ÿn
::
MS‘
 
m£
 = 
’qa
.
	`g‘_m£t
(0, 10);

230 
’qb
.
	`£t_sÜt_by_v®ue
(0, 
çl£
);

231 
X­Ÿn
::
MS‘
 
m£tb
 = 
’qb
.
	`g‘_m£t
(0, 10, 100);

233 
	`TEST_EQUAL
(
¥ya0
.
	`g‘_tÙ®
(), 25);

234 
	`TEST_EQUAL
(
¥ya1
.
	`g‘_tÙ®
(), 25);

235 
	`TEST_EQUAL
(
¥ya3
.
	`g‘_tÙ®
(), 25);

236 
	`TEST_EQUAL
(
¥yb0
.
	`g‘_tÙ®
(), 25);

237 
	`TEST_EQUAL
(
¥yb1
.
	`g‘_tÙ®
(), 25);

238 
	`TEST_EQUAL
(
¥yb3
.
	`g‘_tÙ®
(), 25);

240 cÚ¡ * 
»suÉs
[] = {

249 
NULL


251 
¡d
::
veùÜ
<
X­Ÿn
::
V®ueCouÁM©chSpy
 *> 
¥›s
;

252 
¥›s
.
	`push_back
(&
¥ya0
);

253 
¥›s
.
	`push_back
(&
¥ya1
);

254 
¥›s
.
	`push_back
(
NULL
);

255 
¥›s
.
	`push_back
(&
¥ya3
);

256 
¥›s
.
	`push_back
(&
¥yb0
);

257 
¥›s
.
	`push_back
(&
¥yb1
);

258 
¥›s
.
	`push_back
(
NULL
);

259 
¥›s
.
	`push_back
(&
¥yb3
);

260 
X­Ÿn
::
v®u’o
 
v
 = 0; 
»suÉs
[v]; ++v) {

261 
tout
 << "v®u" << 
v
 << 
’dl
;

262 
X­Ÿn
::
V®ueCouÁM©chSpy
 * 
¥y
 = 
¥›s
[
v
];

263 
¡ršg
 
	`®lv®s_¡r
("|");

264 ià(
¥y
 !ğ
NULL
) {

265 
size_t
 
®lv®s_size
 = 0;

266 
X­Ÿn
::
T”mI‹¿tÜ
 
i
 = 
¥y
->
	`tİ_v®ues_begš
(100);

267 
i
 !ğ
¥y
->
	`tİ_v®ues_’d
(100);

268 ++
i
, ++
®lv®s_size
) {

269 
®lv®s_¡r
 +ğ*
i
;

270 
®lv®s_¡r
 += ':';

271 
®lv®s_¡r
 +ğ
	`¡r
(
i
.
	`g‘_‹rmäeq
());

272 
®lv®s_¡r
 += '|';

274 
tout
 << 
®lv®s_¡r
 << 
’dl
;

275 
	`TEST_STRINGS_EQUAL
(
®lv®s_¡r
, 
»suÉs
[
v
]);

277 
size_t
 
couÁ
 = 0; couÁ < 
®lv®s_size
; ++count) {

278 
tout
 << "couÁ " << 
couÁ
 << 
’dl
;

279 
X­Ÿn
::
T”mI‹¿tÜ
 
i
 = 
¥y
->
	`tİ_v®ues_begš
(100),

280 
j
 = 
¥y
->
	`tİ_v®ues_begš
(
couÁ
);

281 
i
 !ğ
¥y
->
	`tİ_v®ues_’d
(100) &&

282 
j
 !ğ
¥y
->
	`tİ_v®ues_’d
(
couÁ
);

283 ++
i
, ++
j
) {

284 
tout
 << "j " << 
j
 << 
’dl
;

285 
	`TEST_EQUAL
(*
i
, *
j
);

286 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 
j
.get_termfreq());

292  
Œue
;

293 
	}
}

296 
	$DEFINE_TESTCASE
(
m©ch¥y5
, 
back’d
)

298 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

299 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

300 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("this"));

302 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`my¥y1
(1);

303 
X­Ÿn
::
V®ueCouÁM©chSpy
 
	`my¥y2
(1);

305 
’quœe
.
	`add_m©ch¥y
(&
my¥y1
);

306 
’quœe
.
	`add_m©ch¥y
(&
my¥y2
);

307 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 100);

308 
	`TEST_EQUAL
(
mym£t
.
	`size
(), 6);

310 
X­Ÿn
::
T”mI‹¿tÜ
 
i
 = 
my¥y1
.
	`v®ues_begš
();

311 
	`TEST
(
i
 !ğ
my¥y1
.
	`v®ues_’d
());

312 
	`TEST
(*
i
 == "h");

313 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 5);

314 ++
i
;

315 
	`TEST
(
i
 !ğ
my¥y1
.
	`v®ues_’d
());

316 
	`TEST
(*
i
 == "n");

317 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 1);

318 ++
i
;

319 
	`TEST
(
i
 =ğ
my¥y1
.
	`v®ues_’d
());

321 
i
 = 
my¥y2
.
	`v®ues_begš
();

322 
	`TEST
(
i
 !ğ
my¥y2
.
	`v®ues_’d
());

323 
	`TEST
(*
i
 == "h");

324 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 5);

325 ++
i
;

326 
	`TEST
(
i
 !ğ
my¥y2
.
	`v®ues_’d
());

327 
	`TEST
(*
i
 == "n");

328 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 1);

329 ++
i
;

330 
	`TEST
(
i
 =ğ
my¥y2
.
	`v®ues_’d
());

332  
Œue
;

333 
	}
}

335 şas 
	cMySpy
 : 
public
 
X­Ÿn
::
M©chSpy
 {

336 
	$İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &, X­Ÿn::
weight
) {

338 
	}
};

341 
DEFINE_TESTCASE
(
m©ch¥y6
, !
back’d
)

343 
MySpy
 
	g¥y
;

345 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
¥y
.
şÚe
());

346 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
¥y
.
Çme
());

347 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
¥y
.
£rŸli£
());

348 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

349 
¥y
.
un£rŸli£
(
¡d
::
¡ršg
(), 
X­Ÿn
::
Regi¡ry
()));

350 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
¥y
.
£rŸli£_»suÉs
());

351 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

352 
¥y
.
m”ge_»suÉs
(
¡d
::
¡ršg
()));

353 
TEST_EQUAL
(
¥y
.
g‘_desütiÚ
(), "Xapian::MatchSpy()");

355  
	gŒue
;

	@tests/api_matchspy.h

2 
boŞ
 
‹¡_m©ch¥y1
();

3 
boŞ
 
‹¡_m©ch¥y2
();

4 
boŞ
 
‹¡_m©ch¥y4
();

5 
boŞ
 
‹¡_m©ch¥y5
();

6 
boŞ
 
‹¡_m©ch¥y6
();

	@tests/api_metadata.cc

22 
	~<cÚfig.h
>

24 
	~"­i_m‘ad©a.h
"

26 
	~<x­Ÿn.h
>

28 
	~"­™e¡.h
"

29 
	~"‹¡su™e.h
"

30 
	~"‹¡uts.h
"

32 
	~<¡ršg
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	$DEFINE_TESTCASE
(
m‘ad©a1
, 
wr™abË
) {

38 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

40 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
("foo"), "");

41 
Œy
 {

42 
db
.
	`£t_m‘ad©a
("foo", "bar");

43 } 
	`ÿtch
 (
X­Ÿn
::
Unim¶em’‹dE¼Ü
 &) {

44 
	`SKIP_TEST
("Metadata‚ot supported byhis backend");

46 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
("foo"), "bar");

47 
db
.
	`£t_m‘ad©a
("foo", "baz");

48 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

49 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
("foo"), "baz");

50 
db
.
	`£t_m‘ad©a
("foo", "");

51 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
("foo"), "");

53 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

56 
db
.
	`£t_m‘ad©a
("foo", "value of foo");

57 
db
.
	`£t_m‘ad©a
(
	`¡ršg
("foo\0bar", 7), string(1, '\0'));

58 
db
.
	`£t_m‘ad©a
(
	`¡ršg
("foo\0", 4), string("foo\0bar", 7));

60 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
("foo"), "value of foo");

61 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
(
	`¡ršg
("foo\0bar", 7)), string(1, '\0'));

62 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
(
	`¡ršg
("foo\0", 4)), string("foo\0bar", 7));

64 
db
.
	`comm™
();

66 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
("foo"), "value of foo");

67 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
(
	`¡ršg
("foo\0bar", 7)), string(1, '\0'));

68 
	`TEST_EQUAL
(
db
.
	`g‘_m‘ad©a
(
	`¡ršg
("foo\0", 4)), string("foo\0bar", 7));

70  
Œue
;

71 
	}
}

74 
DEFINE_TESTCASE
(
m‘ad©a2
, 
m‘ad©a
 && !
šmemÜy
) {

75 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

76 
	gX­Ÿn
::
D©aba£
 
dbr
 = 
g‘_wr™abË_d©aba£_as_d©aba£
();

78 
TEST_EQUAL
(
db
.
g‘_m‘ad©a
("foo"), "");

79 
	gdb
.
£t_m‘ad©a
("foo", "bar");

80 
TEST_EQUAL
(
db
.
g‘_m‘ad©a
("foo"), "bar");

81 
TEST_EQUAL
(
dbr
.
g‘_m‘ad©a
("foo"), "");

82 
	gdb
.
comm™
();

83 
TEST_EQUAL
(
dbr
.
g‘_m‘ad©a
("foo"), "");

84 
	gdbr
.
»İ’
();

85 
TEST_EQUAL
(
db
.
g‘_m‘ad©a
("foo"), "bar");

86 
TEST_EQUAL
(
dbr
.
g‘_m‘ad©a
("foo"), "bar");

87 
TEST_EQUAL
(
dbr
.
g‘_doccouÁ
(), 0);

89 
	gdb
.
add_docum’t
(
X­Ÿn
::
Docum’t
());

90 
	gdb
.
£t_m‘ad©a
("foo", "baz");

91 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), 1);

92 
TEST_EQUAL
(
db
.
g‘_m‘ad©a
("foo"), "baz");

93 
	gdb
.
comm™
();

95 
TEST_EQUAL
(
dbr
.
g‘_m‘ad©a
("foo"), "bar");

96 
	gdbr
.
»İ’
();

97 
TEST_EQUAL
(
dbr
.
g‘_m‘ad©a
("foo"), "baz");

99 
	gdb
.
£t_m‘ad©a
("foo", "");

100 
TEST_EQUAL
(
db
.
g‘_m‘ad©a
("foo"), "");

101 
	gdb
.
comm™
();

102 
TEST_EQUAL
(
dbr
.
g‘_m‘ad©a
("foo"), "baz");

103 
	gdbr
.
»İ’
();

104 
TEST_EQUAL
(
dbr
.
g‘_m‘ad©a
("foo"), "");

106 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), 1);

108  
	gŒue
;

112 
	$DEFINE_TESTCASE
(
m‘ad©a3
, 
m‘ad©a
) {

113 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

115 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
db
.
	`g‘_m‘ad©a
(""));

116 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
db
.
	`£t_m‘ad©a
("", "foo"));

117 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
db
.
	`g‘_m‘ad©a
(""));

119  
Œue
;

120 
	}
}

124 
DEFINE_TESTCASE
(
m‘ad©a4
, 
m‘ad©a
 && !
šmemÜy
) {

125 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

127 
	gdb
.
£t_m‘ad©a
("foo", "foo");

128 
	gdb
.
comm™
();

130 
	gX­Ÿn
::
Docum’t
 
doc
;

131 
	gdoc
.
add_po¡šg
("foo", 1);

132 
	gdb
.
add_docum’t
(
doc
);

134 
	gX­Ÿn
::
D©aba£
 
dbr
(
g‘_wr™abË_d©aba£_as_d©aba£
());

136  
	gŒue
;

141 
DEFINE_TESTCASE
(
m‘ad©a5
, 
wr™abË
 && !
»mÙe
) {

142 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

145 
	gX­Ÿn
::
T”mI‹¿tÜ
 
™”
;

146 
	g™”
 = 
db
.
m‘ad©a_keys_begš
();

147 
TEST_EQUAL
(
™”
, 
db
.
m‘ad©a_keys_’d
());

151 
SKIP_TEST_FOR_BACKEND
("inmemory");

153 
	gŒy
 {

154 
	gdb
.
£t_m‘ad©a
("foo", "val");

155 } 
ÿtch
 (
X­Ÿn
::
Unim¶em’‹dE¼Ü
 &) {

156 
SKIP_TEST
("Metadata‚ot supported byhis backend");

158 
	gdb
.
comm™
();

161 
	g™”
 = 
db
.
m‘ad©a_keys_begš
();

162 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

163 
TEST_EQUAL
(*
™”
, "foo");

164 ++
	g™”
;

165 
TEST
(
™”
 =ğ
db
.
m‘ad©a_keys_’d
());

168 
	gX­Ÿn
::
Docum’t
 
doc
;

169 
	gdoc
.
add_po¡šg
("foo", 1);

170 
	gdb
.
add_docum’t
(
doc
);

171 
	gdb
.
comm™
();

173 
	g™”
 = 
db
.
m‘ad©a_keys_begš
();

174 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

175 
TEST_EQUAL
(*
™”
, "foo");

176 ++
	g™”
;

177 
TEST
(
™”
 =ğ
db
.
m‘ad©a_keys_’d
());

181 
	gdb
.
£t_m‘ad©a
("foo", "");

182 
	gdb
.
comm™
();

183 
	g™”
 = 
db
.
m‘ad©a_keys_begš
();

184 
TEST
(
™”
 =ğ
db
.
m‘ad©a_keys_’d
());

187 
	gdb
.
£t_m‘ad©a
("a", "val");

188 
	gdb
.
£t_m‘ad©a
("foo", "val");

189 
	gdb
.
£t_m‘ad©a
("foo1", "val");

190 
	gdb
.
£t_m‘ad©a
("foo2", "val");

191 
	gdb
.
£t_m‘ad©a
("z", "val");

192 
	gdb
.
comm™
();

194 
	g™”
 = 
db
.
m‘ad©a_keys_begš
();

195 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

196 
TEST_EQUAL
(*
™”
, "a");

197 ++
	g™”
;

198 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

199 
TEST_EQUAL
(*
™”
, "foo");

200 ++
	g™”
;

201 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

202 
TEST_EQUAL
(*
™”
, "foo1");

203 ++
	g™”
;

204 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

205 
TEST_EQUAL
(*
™”
, "foo2");

206 ++
	g™”
;

207 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

208 
TEST_EQUAL
(*
™”
, "z");

209 ++
	g™”
;

210 
TEST
(
™”
 =ğ
db
.
m‘ad©a_keys_’d
());

212 
	g™”
 = 
db
.
m‘ad©a_keys_begš
("foo");

213 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
("foo"));

214 
TEST_EQUAL
(*
™”
, "foo");

215 ++
	g™”
;

216 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
("foo"));

217 
TEST_EQUAL
(*
™”
, "foo1");

218 ++
	g™”
;

219 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
("foo"));

220 
TEST_EQUAL
(*
™”
, "foo2");

221 ++
	g™”
;

222 
TEST
(
™”
 =ğ
db
.
m‘ad©a_keys_’d
("foo"));

224 
	g™”
 = 
db
.
m‘ad©a_keys_begš
("foo1");

225 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
("foo1"));

226 
TEST_EQUAL
(*
™”
, "foo1");

227 ++
	g™”
;

228 
TEST
(
™”
 =ğ
db
.
m‘ad©a_keys_’d
("foo1"));

230 
	g™”
 = 
db
.
m‘ad©a_keys_begš
();

231 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

232 
TEST_EQUAL
(*
™”
, "a");

235 
	g™”
.
sk_to
("");

236 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

237 
TEST_EQUAL
(*
™”
, "a");

240 
	g™”
.
sk_to
("foo1");

241 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

242 
TEST_EQUAL
(*
™”
, "foo1");

245 
	g™”
.
sk_to
("");

246 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

247 
TEST_EQUAL
(*
™”
, "a");

250 
	g™”
.
sk_to
("foo1");

251 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

252 
TEST_EQUAL
(*
™”
, "foo1");

255 ++
	g™”
;

256 
TEST
(
™”
 !ğ
db
.
m‘ad©a_keys_’d
());

257 
TEST_EQUAL
(*
™”
, "foo2");

260 
	g™”
.
sk_to
("zoo");

261 
TEST
(
™”
 =ğ
db
.
m‘ad©a_keys_’d
());

263  
	gŒue
;

267 
	$DEFINE_TESTCASE
(
wr™”—d1
, 
wr™abË
 && 
m‘ad©a
) {

268 
X­Ÿn
::
Wr™abËD©aba£
 
db_w
 = 
	`g‘_wr™abË_d©aba£
();

269 
db_w
.
	`£t_m‘ad©a
("1", "2");

270 
¡ršg
 
	`lÚg™em
(20000, 'j');

271 
db_w
.
	`£t_m‘ad©a
("2", 
lÚg™em
);

273 
¡ršg
 
»ad™em
 = 
db_w
.
	`g‘_m‘ad©a
("2");

274 
	`TEST_EQUAL
(
»ad™em
, 
lÚg™em
);

276  
Œue
;

277 
	}
}

	@tests/api_metadata.h

2 
boŞ
 
‹¡_m‘ad©a1
();

3 
boŞ
 
‹¡_m‘ad©a2
();

4 
boŞ
 
‹¡_m‘ad©a3
();

5 
boŞ
 
‹¡_m‘ad©a4
();

6 
boŞ
 
‹¡_m‘ad©a5
();

7 
boŞ
 
‹¡_wr™”—d1
();

	@tests/api_nodb.cc

24 
	~<cÚfig.h
>

26 
	~"­i_nodb.h
"

28 
	~<x­Ÿn.h
>

30 
	~"­™e¡.h
"

31 
	~"‹¡su™e.h
"

32 
	~"‹¡uts.h
"

33 
	~"uts.h
"

35 
	~"autİŒ.h
"

36 
	~<li¡
>

37 
	~<¡ršg
>

38 
	~<veùÜ
>

40 
usšg
 
Çme¥aû
 
	g¡d
;

43 
DEFINE_TESTCASE
(
ŒivŸl1
, !
back’d
) {

44  
	gŒue
;

48 
DEFINE_TESTCASE
(
g‘q‹rms1
, !
back’d
) {

49 
	gli¡
<
	g¡ršg
> 
	gªsw”s_li¡
;

50 
	gªsw”s_li¡
.
push_back
("one");

51 
	gªsw”s_li¡
.
push_back
("two");

52 
	gªsw”s_li¡
.
push_back
("three");

53 
	gªsw”s_li¡
.
push_back
("four");

55 
	gX­Ÿn
::
Qu”y
 
myqu”y
(
X­Ÿn
::Qu”y::
OP_OR
,

56 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_AND
,

57 
X­Ÿn
::
Qu”y
("one", 1, 1),

58 
X­Ÿn
::
Qu”y
("three", 1, 3)),

59 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
,

60 
X­Ÿn
::
Qu”y
("four", 1, 4),

61 
X­Ÿn
::
Qu”y
("two", 1, 2)));

63 
	gli¡
<
	g¡ršg
> 
	gli¡1
;

65 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
;

66 
	gt
 = 
myqu”y
.
g‘_‹rms_begš
(); !ğmyqu”y.
g‘_‹rms_’d
(); ++t)

67 
	gli¡1
.
push_back
(*
t
);

69 
TEST
(
li¡1
 =ğ
ªsw”s_li¡
);

70 
	gli¡
<
	g¡ršg
> 
li¡2
(
myqu”y
.
g‘_‹rms_begš
(), myqu”y.
g‘_‹rms_’d
());

71 
TEST
(
li¡2
 =ğ
ªsw”s_li¡
);

72  
	gŒue
;

77 
DEFINE_TESTCASE
(
g‘q‹rms2
, !
back’d
) {

78 
	gX­Ÿn
::
Qu”y
 
em±y_qu”y
;

79 
TEST_EQUAL
(
em±y_qu”y
.
g‘_‹rms_begš
(),ƒm±y_qu”y.
g‘_‹rms_’d
());

80  
	gŒue
;

84 
DEFINE_TESTCASE
(
em±yqu”y2
, !
back’d
) {

86 
TEST
(
X­Ÿn
::
Qu”y
().
em±y
());

88 
TEST
(
X­Ÿn
::
Qu”y
().
g‘_Ëngth
() == 0);

89 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
> 
v
;

90 
TEST
(
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
v
.
begš
(), v.
’d
()).
em±y
());

91 
TEST
(
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
v
.
begš
(), v.
’d
()).
g‘_Ëngth
() == 0);

92  
	gŒue
;

96 
DEFINE_TESTCASE
(
em±yqu”y3
, !
back’d
) {

97 cÚ¡ 
	gX­Ÿn
::
Qu”y
::
İ
 
İs
[] = {

98 
X­Ÿn
::
Qu”y
::
OP_AND
,

99 
X­Ÿn
::
Qu”y
::
OP_OR
,

100 
X­Ÿn
::
Qu”y
::
OP_XOR
,

101 
X­Ÿn
::
Qu”y
::
OP_AND_MAYBE
,

102 
X­Ÿn
::
Qu”y
::
OP_AND_NOT


105 
size_t
 
	gi
 = 0; i < (
	gİs
) / (ops[0]); ++i) {

106 
	gtout
 << "Te¡šg o°#" << 
	gi
 << 
	g’dl
;

107 
	gX­Ÿn
::
Qu”y
 
em±y
;

108 
	gX­Ÿn
::
Qu”y
 
q
("test");

109 
	gX­Ÿn
::
Qu”y
 
qcombše
(
İs
[
i
], 
em±y
, 
q
);

110 
	gtout
 << 
	gqcombše
.
g‘_desütiÚ
(è<< 
	g’dl
;

111 
	gX­Ÿn
::
Qu”y
 
qcombše2
(
İs
[
i
], 
q
, 
em±y
);

112 
	gtout
 << 
	gqcombše2
.
g‘_desütiÚ
(è<< 
	g’dl
;

115  
	gŒue
;

119 
DEFINE_TESTCASE
(
qu”yËn1
, !
back’d
) {

121 
	gX­Ÿn
::
Qu”y
 
myqu”y
;

122 
	gmyqu”y
 = 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
,

123 
X­Ÿn
::
Qu”y
("foo"),

124 
X­Ÿn
::
Qu”y
("bar"));

125 
	gmyqu”y
 = 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_AND
,

126 
myqu”y
,

127 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
,

128 
X­Ÿn
::
Qu”y
("wibble"),

129 
X­Ÿn
::
Qu”y
("spoon")));

131 
TEST_EQUAL
(
myqu”y
.
g‘_Ëngth
(), 4);

132 
TEST
(!
myqu”y
.
em±y
());

133  
	gŒue
;

137 
DEFINE_TESTCASE
(
qu”yËn2
, !
back’d
) {

139 
¡ršg
 
	g‹rms
[3] = {

144 
	gX­Ÿn
::
Qu”y
 
qu”›s
[3] = {

145 
X­Ÿn
::
Qu”y
("wibble"),

146 
X­Ÿn
::
Qu”y
("wobble"),

147 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
¡ršg
("jelly"), string("belly"))

150 
	gX­Ÿn
::
Qu”y
 
myqu”y
;

151 
	gveùÜ
<
	g¡ršg
> 
v1
(
‹rms
,erms + 3);

152 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
> 
v2
(
qu”›s
, queries + 3);

153 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
 *> 
v3
;

154 
	gAutoPŒ
<
	gX­Ÿn
::
Qu”y
> 
dynqu”y1
(
Ãw
 
X­Ÿn
::Qu”y(X­Ÿn::Qu”y::
OP_AND
,

155 
¡ršg
("ball"),

156 
¡ršg
("club")));

157 
	gAutoPŒ
<
	gX­Ÿn
::
Qu”y
> 
dynqu”y2
(
Ãw
 
X­Ÿn
::Query("ring"));

158 
	gv3
.
push_back
(
dynqu”y1
.
g‘
());

159 
	gv3
.
push_back
(
dynqu”y2
.
g‘
());

161 
	gX­Ÿn
::
Qu”y
 
myq1
 = 
X­Ÿn
::Qu”y(X­Ÿn::Qu”y::
OP_AND
, 
v1
.
begš
(), v1.
’d
());

162 
	gtout
 << "myq1=" << 
	gmyq1
 << "\n";

163 
TEST_EQUAL
(
myq1
.
g‘_Ëngth
(), 3);

165 
	gX­Ÿn
::
Qu”y
 
myq2_1
 = 
X­Ÿn
::Qu”y(X­Ÿn::Qu”y::
OP_OR
, 
v2
.
begš
(), v2.
’d
());

166 
	gtout
 << "myq2_1=" << 
	gmyq2_1
 << "\n";

167 
TEST_EQUAL
(
myq2_1
.
g‘_Ëngth
(), 4);

169 
	gX­Ÿn
::
Qu”y
 
myq2_2
 = 
X­Ÿn
::Qu”y(X­Ÿn::Qu”y::
OP_AND
, 
v3
.
begš
(), v3.
’d
());

170 
	gtout
 << "myq2_2=" << 
	gmyq2_2
 << "\n";

171 
TEST_EQUAL
(
myq2_2
.
g‘_Ëngth
(), 3);

173 
	gX­Ÿn
::
Qu”y
 
myq2
 = 
X­Ÿn
::Qu”y(X­Ÿn::Qu”y::
OP_OR
, 
myq2_1
, 
myq2_2
);

174 
	gtout
 << "myq2=" << 
	gmyq2
 << "\n";

175 
TEST_EQUAL
(
myq2
.
g‘_Ëngth
(), 7);

177 
	gmyqu”y
 = 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
myq1
, 
myq2
);

178 
	gtout
 << "myqu”y=" << 
	gmyqu”y
 << "\n";

179 
TEST_EQUAL
(
myqu”y
.
g‘_Ëngth
(), 10);

181  
	gŒue
;

185 
DEFINE_TESTCASE
(
qu”yv®id1
, !
back’d
) {

186 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
> 
v1
;

188 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
,

189 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_AND_NOT
, 
v1
.
begš
(), v1.
’d
()));

190 
	gtout
 << "ANDNOT (èchecked" << 
	g’dl
;

191 
	gv1
.
push_back
(
X­Ÿn
::
Qu”y
("bad"));

192 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
,

193 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_AND_NOT
, 
v1
.
begš
(), v1.
’d
()));

194 
	gtout
 << "ANDNOT (\"bad\"èchecked" << 
	g’dl
;

195 
	gv1
.
ş—r
();

196 
	gv1
.
push_back
(
X­Ÿn
::
Qu”y
());

197 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
,

198 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_AND_NOT
, 
v1
.
begš
(), v1.
’d
()));

199 
	gtout
 << "ANDNOT (X­Ÿn::Qu”y()èchecked" << 
	g’dl
;

200 
	gX­Ÿn
::
Qu”y
 
q2
(
X­Ÿn
::Qu”y::
OP_XOR
, Xapian::Query("foo"), Xapian::Query("bar"));

201 
	gtout
 << "XOR (\"foo\", \"b¬\"èchecked" << 
	g’dl
;

202  
	gŒue
;

206 
DEFINE_TESTCASE
(
subqcŞÏp£1
, !
back’d
) {

207 
	gX­Ÿn
::
Qu”y
 
qu”›s1
[3] = {

208 
X­Ÿn
::
Qu”y
("wibble"),

209 
X­Ÿn
::
Qu”y
("wobble"),

210 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
¡ršg
("jelly"), string("belly"))

213 
	gX­Ÿn
::
Qu”y
 
qu”›s2
[3] = {

214 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_AND
, 
¡ršg
("jelly"), string("belly")),

215 
X­Ÿn
::
Qu”y
("wibble"),

216 
X­Ÿn
::
Qu”y
("wobble")

219 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
> 
vec1
(
qu”›s1
, queries1 + 3);

220 
	gX­Ÿn
::
Qu”y
 
myqu”y1
(
X­Ÿn
::Qu”y::
OP_OR
, 
vec1
.
begš
(), vec1.
’d
());

221 
TEST_EQUAL
(
myqu”y1
.
g‘_desütiÚ
(),

224 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
> 
vec2
(
qu”›s2
, queries2 + 3);

225 
	gX­Ÿn
::
Qu”y
 
myqu”y2
(
X­Ÿn
::Qu”y::
OP_AND
, 
vec2
.
begš
(), vec2.
’d
());

226 
TEST_EQUAL
(
myqu”y2
.
g‘_desütiÚ
(),

229  
	gŒue
;

233 
DEFINE_TESTCASE
(
em±yqu”y·¹1
, !
back’d
) {

234 
	gveùÜ
<
	g¡ršg
> 
	gem±y‹rms
;

235 
	gX­Ÿn
::
Qu”y
 
qu”y
(
X­Ÿn
::Qu”y::
OP_OR
, 
em±y‹rms
.
begš
(),ƒm±y‹rms.
’d
());

236 
TEST
(
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_AND
, 
qu”y
, X­Ÿn::Qu”y("x")).
em±y
());

237 
TEST
(
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_AND
, 
qu”y
, X­Ÿn::Qu”y("x")).
g‘_Ëngth
() == 0);

238 
TEST
(!
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
qu”y
, X­Ÿn::Qu”y("x")).
em±y
());

239 
TEST
(
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, 
qu”y
, X­Ÿn::Qu”y("x")).
g‘_Ëngth
() == 1);

240  
	gŒue
;

243 
DEFINE_TESTCASE
(
sšgËsubq1
, !
back’d
) {

244 
	gveùÜ
<
	g¡ršg
> 
	gÚ‘”m
;

245 
	gÚ‘”m
.
push_back
("solo");

246 
	gX­Ÿn
::
Qu”y
 
q_–™e£t
(
X­Ÿn
::Qu”y::
OP_ELITE_SET
, 
Ú‘”m
.
begš
(), oÃ‹rm.
’d
(), 1);

247 
	gX­Ÿn
::
Qu”y
 
q_Ã¬
(
X­Ÿn
::Qu”y::
OP_NEAR
, 
Ú‘”m
.
begš
(), oÃ‹rm.
’d
(), 1);

248 
	gX­Ÿn
::
Qu”y
 
q_ph¿£
(
X­Ÿn
::Qu”y::
OP_PHRASE
, 
Ú‘”m
.
begš
(), oÃ‹rm.
’d
(), 1);

249  
	gŒue
;

252 
DEFINE_TESTCASE
(
¡emÏngs1
, !
back’d
) {

253 
¡ršg
 
	gÏngs
 = 
X­Ÿn
::
S‹m
::
g‘_avaabË_Ïnguages
();

254 
	gtout
 << "avaabË†ªguage '" << 
	gÏngs
 << "'" << 
	g’dl
;

255 
TEST
(!
Ïngs
.
em±y
());

258 
	gÏngs
 += " da‚lƒn fi fr de hu it‚o…t„o„uƒs svr";

260 
	g¡ršg
::
size_ty³
 
i
 = 0;

261 
	gŒue
) {

262 
	g¡ršg
::
size_ty³
 
¥c
 = 
Ïngs
.
fšd
(' ', 
i
);

265 
TEST_NOT_EQUAL
(
i
, 
¥c
);

269 
¡ršg
 
	gÏnguage
 = 
Ïngs
.
sub¡r
(
i
, 
¥c
 - i);

270 
	gtout
 << "checkšg†ªguagcod'" << 
	gÏnguage
 << "' wÜks" << 
	g’dl
;

271 
	gX­Ÿn
::
S‹m
 
¡emm”
(
Ïnguage
);

272 ià(
	gÏnguage
.
size
() > 2) {

273 
¡ršg
 
ex³ùed
("Xapian::Stem(");

274 
	gex³ùed
 +ğ
Ïnguage
;

275 
	gex³ùed
 += ')';

276 
TEST_EQUAL
(
¡emm”
.
g‘_desütiÚ
(), 
ex³ùed
);

279 ià(
	g¥c
 =ğ
¡ršg
::
Åos
) ;

280 
	gi
 = 
¥c
 + 1;

284 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, X­Ÿn::
S‹m
 
¡emm”
("bogus"));

287 
	gX­Ÿn
::
S‹m
 
¡em_nÙhšg
 = 
X­Ÿn
::Stem("");

289  
	gŒue
;

293 
DEFINE_TESTCASE
(
weight1
, !
back’d
) {

294 
	gX­Ÿn
::
Weight
 * 
wt
;

296 
	gX­Ÿn
::
BoŞWeight
 
boŞweight
;

297 
TEST_EQUAL
(
boŞweight
.
Çme
(), "Xapian::BoolWeight");

298 
	gwt
 = 
X­Ÿn
::
BoŞWeight
().
un£rŸli£
(
boŞweight
.
£rŸli£
());

299 
TEST_EQUAL
(
boŞweight
.
£rŸli£
(), 
wt
->serialise());

300 
d–‘e
 
	gwt
;

302 
	gX­Ÿn
::
T¿dWeight
 
Œadweight_dæt
;

303 
	gX­Ÿn
::
T¿dWeight
 
Œadweight
(1.0);

304 
TEST_EQUAL
(
Œadweight
.
Çme
(), "Xapian::TradWeight");

305 
TEST_EQUAL
(
Œadweight_dæt
.
£rŸli£
(), 
Œadweight
.serialise());

306 
	gwt
 = 
X­Ÿn
::
T¿dWeight
().
un£rŸli£
(
Œadweight
.
£rŸli£
());

307 
TEST_EQUAL
(
Œadweight
.
£rŸli£
(), 
wt
->serialise());

308 
d–‘e
 
	gwt
;

310 
	gX­Ÿn
::
T¿dWeight
 
Œadweight2
(2.0);

311 
TEST_NOT_EQUAL
(
Œadweight
.
£rŸli£
(), 
Œadweight2
.serialise());

313 
	gX­Ÿn
::
BM25Weight
 
bm25weight_dæt
;

314 
	gX­Ÿn
::
BM25Weight
 
bm25weight
(1, 0, 1, 0.5, 0.5);

315 
TEST_EQUAL
(
bm25weight
.
Çme
(), "Xapian::BM25Weight");

316 
TEST_EQUAL
(
bm25weight_dæt
.
£rŸli£
(), 
bm25weight
.serialise());

317 
	gwt
 = 
X­Ÿn
::
BM25Weight
().
un£rŸli£
(
bm25weight
.
£rŸli£
());

318 
TEST_EQUAL
(
bm25weight
.
£rŸli£
(), 
wt
->serialise());

319 
d–‘e
 
	gwt
;

321 
	gX­Ÿn
::
BM25Weight
 
bm25weight2
(1, 0.5, 1, 0.5, 0.5);

322 
TEST_NOT_EQUAL
(
bm25weight
.
£rŸli£
(), 
bm25weight2
.serialise());

324  
	gŒue
;

328 
DEFINE_TESTCASE
(
nosuchdb1
, !
back’d
) {

330 
	gŒy
 {

331 
	gX­Ÿn
::
D©aba£
 
db
("NOsuChdaTabASe");

332 } 
ÿtch
 (cÚ¡ 
X­Ÿn
::
D©aba£O³nšgE¼Ü
 & 
e
) {

335 
TEST_STRINGS_EQUAL
(
e
.
g‘_msg
(), "Couldn't stat 'NOsuChdaTabASe'");

338  
	gŒue
;

342 
DEFINE_TESTCASE
(
addv®ue1
, !
back’d
) {

344 
	gX­Ÿn
::
Docum’t
 
doc
;

345 
	gdoc
.
add_v®ue
(1, "original");

346 
	gdoc
.
add_v®ue
(1, "replacement");

347 
TEST_EQUAL
(
doc
.
g‘_v®ue
(1), "replacement");

349 
	gdoc
.
add_v®ue
(2, "too");

350 
	gdoc
.
add_v®ue
(3, "free");

351 
	gdoc
.
add_v®ue
(4, "for");

353 
	gdoc
.
»move_v®ue
(2);

354 
	gdoc
.
»move_v®ue
(4);

355 
TEST_EQUAL
(
doc
.
g‘_v®ue
(0), "");

356 
TEST_EQUAL
(
doc
.
g‘_v®ue
(1), "replacement");

357 
TEST_EQUAL
(
doc
.
g‘_v®ue
(2), "");

358 
TEST_EQUAL
(
doc
.
g‘_v®ue
(3), "free");

359 
TEST_EQUAL
(
doc
.
g‘_v®ue
(4), "");

361  
	gŒue
;

365 
DEFINE_TESTCASE
(
poscŞÏp£2
, !
back’d
) {

366 
	gX­Ÿn
::
Qu”y
 
q
(
X­Ÿn
::Qu”y::
OP_OR
, Xapian::Query("this", 1, 1), Xapian::Query("this", 1, 1));

367 
TEST_EQUAL
(
q
.
g‘_Ëngth
(), 2);

368  
	gŒue
;

373 
DEFINE_TESTCASE
(
unš™db1
, !
back’d
) {

374 
	gX­Ÿn
::
D©aba£
 
db
;

375 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
,

376 
X­Ÿn
::
Enquœe
 
’q
(
db
));

377  
	gŒue
;

381 
DEFINE_TESTCASE
(
sÿËweight3
, !
back’d
) {

382 
	gX­Ÿn
::
Qu”y
 
m©chnÙhšg
(
X­Ÿn
::Qu”y::
M©chNÙhšg
);

383 
	gX­Ÿn
::
Qu”y
 
qu”y
(
X­Ÿn
::Qu”y::
OP_SCALE_WEIGHT
, 
m©chnÙhšg
, 3.0);

384 
TEST_EQUAL
(
qu”y
.
g‘_desütiÚ
(), "Xapian::Query()");

385  
	gŒue
;

389 
DEFINE_TESTCASE
(
sÿËweight4
, !
back’d
) {

392 
	gçùÜ
 = 179.76931348623157e306;

393 vŞ©
	g»c
 = 1.0 / 
çùÜ
;

394 
	gÃ¬ly1
 = 
çùÜ
 * 
»c
;

396 
TEST_NOT_EQUAL
(
Ã¬ly1
, 1.0);

397 
	gX­Ÿn
::
Qu”y
 
foo
("foo");

398 
	gX­Ÿn
::
Qu”y
 
foo_Ã¬ly1
(
X­Ÿn
::Qu”y::
OP_SCALE_WEIGHT
, 
foo
, 
Ã¬ly1
);

399 
TEST_EQUAL
(
foo_Ã¬ly1
.
g‘_desütiÚ
(), "Xapian::Query(foo)");

401  
	gŒue
;

405 
DEFINE_TESTCASE
(
r£t3
, !
back’d
) {

406 
	gX­Ÿn
::
RS‘
 
r£t
;

407 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
r£t
.
add_docum’t
(0));

408 
TEST
(
r£t
.
em±y
());

409 
TEST_EQUAL
(
r£t
.
size
(), 0);

410 
	gr£t
.
add_docum’t
(1);

411 
	gr£t
.
add_docum’t
(
¡©ic_ÿ¡
<
X­Ÿn
::
docid
>(-1));

412 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
r£t
.
add_docum’t
(0));

413 
TEST
(!
r£t
.
em±y
());

414 
TEST_EQUAL
(
r£t
.
size
(), 2);

415  
	gŒue
;

419 
DEFINE_TESTCASE
(
r£t4
, !
back’d
) {

420 
	gX­Ÿn
::
RS‘
 
r£t
;

421 
	gr£t
.
add_docum’t
(1);

423 
TEST_STRINGS_EQUAL
(
r£t
.
g‘_desütiÚ
(), "RSet(RSet::Internal(1))");

424  
	gŒue
;

428 
DEFINE_TESTCASE
(
İv®uege1
, !
back’d
) {

429 
	gX­Ÿn
::
Qu”y
 
qu”y
(
X­Ÿn
::Qu”y::
OP_VALUE_GE
, 0, "");

430 
TEST_STRINGS_EQUAL
(
qu”y
.
g‘_desütiÚ
(), 
X­Ÿn
::
Qu”y
::
M©chAÎ
.get_description());

431  
	gŒue
;

435 
DEFINE_TESTCASE
(
v®ue£tm©chdecid”1
, !
back’d
) {

436 
	gX­Ÿn
::
V®ueS‘M©chDecid”
 
vsmd1
(0, 
Œue
);

437 
	gvsmd1
.
add_v®ue
("42");

438 
	gX­Ÿn
::
V®ueS‘M©chDecid”
 
vsmd2
(0, 
çl£
);

439 
	gvsmd2
.
»move_v®ue
("nosuch");

440 
	gvsmd2
.
add_v®ue
("42");

441 
	gX­Ÿn
::
V®ueS‘M©chDecid”
 
vsmd3
(0, 
Œue
);

442 
	gvsmd3
.
add_v®ue
("42");

443 
	gvsmd3
.
add_v®ue
("blah");

445 
	gX­Ÿn
::
Docum’t
 
doc
;

446 
TEST
(!
vsmd1
(
doc
));

447 
TEST
(
vsmd2
(
doc
));

448 
TEST
(!
vsmd3
(
doc
));

449 
	gdoc
.
add_v®ue
(0, "42");

450 
TEST
(
vsmd1
(
doc
));

451 
TEST
(!
vsmd2
(
doc
));

452 
TEST
(
vsmd3
(
doc
));

453 
	gdoc
.
add_v®ue
(0, "blah");

454 
TEST
(!
vsmd1
(
doc
));

455 
TEST
(
vsmd2
(
doc
));

456 
TEST
(
vsmd3
(
doc
));

458 
	gvsmd3
.
»move_v®ue
("nosuch");

459 
	gvsmd3
.
»move_v®ue
("blah");

460 
TEST
(!
vsmd1
(
doc
));

461 
TEST
(
vsmd2
(
doc
));

462 
TEST
(!
vsmd3
(
doc
));

463 
	gdoc
.
add_v®ue
(0, "42");

464 
TEST
(
vsmd1
(
doc
));

465 
TEST
(!
vsmd2
(
doc
));

466 
TEST
(
vsmd3
(
doc
));

468  
	gŒue
;

472 
DEFINE_TESTCASE
(
em±ym£t1
, !
back’d
) {

473 
	gX­Ÿn
::
MS‘
 
em±ym£t
;

474 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
,

475 
em±ym£t
.
g‘_‹rmäeq
("foo"));

476  
	gŒue
;

	@tests/api_nodb.h

2 
boŞ
 
‹¡_ŒivŸl1
();

3 
boŞ
 
‹¡_g‘q‹rms1
();

4 
boŞ
 
‹¡_g‘q‹rms2
();

5 
boŞ
 
‹¡_em±yqu”y2
();

6 
boŞ
 
‹¡_em±yqu”y3
();

7 
boŞ
 
‹¡_qu”yËn1
();

8 
boŞ
 
‹¡_qu”yËn2
();

9 
boŞ
 
‹¡_qu”yv®id1
();

10 
boŞ
 
‹¡_subqcŞÏp£1
();

11 
boŞ
 
‹¡_em±yqu”y·¹1
();

12 
boŞ
 
‹¡_sšgËsubq1
();

13 
boŞ
 
‹¡_¡emÏngs1
();

14 
boŞ
 
‹¡_weight1
();

15 
boŞ
 
‹¡_nosuchdb1
();

16 
boŞ
 
‹¡_addv®ue1
();

17 
boŞ
 
‹¡_poscŞÏp£2
();

18 
boŞ
 
‹¡_unš™db1
();

19 
boŞ
 
‹¡_sÿËweight3
();

20 
boŞ
 
‹¡_sÿËweight4
();

21 
boŞ
 
‹¡_r£t3
();

22 
boŞ
 
‹¡_r£t4
();

23 
boŞ
 
‹¡_İv®uege1
();

24 
boŞ
 
‹¡_v®ue£tm©chdecid”1
();

25 
boŞ
 
‹¡_em±ym£t1
();

	@tests/api_none.cc

23 
	~<cÚfig.h
>

25 
	~"­i_nÚe.h
"

27 
	~<x­Ÿn.h
>

29 
	~"­™e¡.h
"

30 
	~"‹¡su™e.h
"

31 
	~"‹¡uts.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

37 
DEFINE_TESTCASE
(
nosubd©aba£s1
, !
back’d
) {

38 
	gX­Ÿn
::
D©aba£
 
db
;

39 
TEST_EQUAL
(
db
.
g‘_m‘ad©a
("foo"), 
¡d
::
¡ršg
());

40 
TEST_EQUAL
(
db
.
m‘ad©a_keys_begš
(), db.
m‘ad©a_keys_’d
());

41 
TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
‹rmli¡_begš
(1));

42 
TEST_EQUAL
(
db
.
®É”ms_begš
(), db.
®É”ms_’d
());

43 
TEST_EQUAL
(
db
.
®É”ms_begš
("foo"), db.
®É”ms_’d
("foo"));

44 
TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
pos™iÚli¡_begš
(1, "foo"));

45 
TEST_EQUAL
(
db
.
g‘_Ï¡docid
(), 0);

46 
TEST_EQUAL
(
db
.
v®ue¡»am_begš
(7), db.
v®ue¡»am_’d
(7));

47 
TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
g‘_doş’gth
(1));

48 
TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
g‘_docum’t
(1));

49  
	gŒue
;

53 
DEFINE_TESTCASE
(
docum’t1
, !
back’d
) {

54 
	gX­Ÿn
::
Docum’t
 
doc
;

55 
	gdoc
.
add_boŞ—n_‹rm
("Hxapian.org");

56 
TEST_EQUAL
(
doc
.
‹rmli¡_couÁ
(), 1);

57 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
doc
.
‹rmli¡_begš
();

58 
TEST
(
t
 !ğ
doc
.
‹rmli¡_’d
());

59 
TEST_EQUAL
(*
t
, "Hxapian.org");

60 
TEST_EQUAL
(
t
.
g‘_wdf
(), 0);

61 
TEST
(++
t
 =ğ
doc
.
‹rmli¡_’d
());

62 
	gdoc
.
»move_‹rm
("Hxapian.org");

63 
TEST_EQUAL
(
doc
.
‹rmli¡_couÁ
(), 0);

64 
TEST
(
doc
.
‹rmli¡_begš
(è=ğdoc.
‹rmli¡_’d
());

65  
	gŒue
;

	@tests/api_none.h

2 
boŞ
 
‹¡_nosubd©aba£s1
();

3 
boŞ
 
‹¡_docum’t1
();

	@tests/api_opsynonym.cc

23 
	~<cÚfig.h
>

25 
	~"­i_İsynÚym.h
"

27 
	~<m­
>

28 
	~<£t
>

29 
	~<veùÜ
>

31 
	~<x­Ÿn.h
>

33 
	~"back’dmªag”.h
"

34 
	~"‹¡su™e.h
"

35 
	~"‹¡uts.h
"

37 
	~"­™e¡.h
"

39 
usšg
 
Çme¥aû
 
	g¡d
;

45 
	$DEFINE_TESTCASE
(
synÚym1
, 
back’d
) {

46 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("etext"));

48 
	`TEST_REL
(
db
.
	`g‘_doş’gth_uµ”_bound
(), >, 0);

50 
X­Ÿn
::
doccouÁ
 
lÙs
 = 214;

54 
veùÜ
<veùÜ<
X­Ÿn
::
Qu”y
> > 
subqu”›s_li¡
;

59 
veùÜ
<> 
subqu”›s_§meweight_couÁ
;

60 
veùÜ
<> 
subqu”›s_diffweight_couÁ
;

62 
veùÜ
<
X­Ÿn
::
Qu”y
> 
subqu”›s
;

63 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

64 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

66 
subqu”›s_§meweight_couÁ
.
	`push_back
(33);

67 
subqu”›s_diffweight_couÁ
.
	`push_back
(0);

70 
subqu”›s
.
	`ş—r
();

71 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("sky"));

72 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

73 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

75 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

76 
subqu”›s_diffweight_couÁ
.
	`push_back
(34);

80 
subqu”›s
.
	`ş—r
();

81 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("gutenberg"));

82 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("blockhead"));

83 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

85 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

86 
subqu”›s_diffweight_couÁ
.
	`push_back
(18);

88 
subqu”›s
.
	`ş—r
();

89 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

90 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

91 
X­Ÿn
::
	`Qu”y
("sky"),

92 
X­Ÿn
::
	`Qu”y
("glove")));

93 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

95 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

96 
subqu”›s_diffweight_couÁ
.
	`push_back
(34);

98 
subqu”›s
.
	`ş—r
();

99 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

100 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

101 
X­Ÿn
::
	`Qu”y
("sky"),

102 
X­Ÿn
::
	`Qu”y
("date")));

103 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

105 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

106 
subqu”›s_diffweight_couÁ
.
	`push_back
(34);

108 
subqu”›s
.
	`ş—r
();

109 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

110 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND_MAYBE
,

111 
X­Ÿn
::
	`Qu”y
("sky"),

112 
X­Ÿn
::
	`Qu”y
("date")));

113 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

115 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

116 
subqu”›s_diffweight_couÁ
.
	`push_back
(34);

118 
subqu”›s
.
	`ş—r
();

119 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

120 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND_NOT
,

121 
X­Ÿn
::
	`Qu”y
("sky"),

122 
X­Ÿn
::
	`Qu”y
("date")));

123 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

125 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

126 
subqu”›s_diffweight_couÁ
.
	`push_back
(34);

128 
subqu”›s
.
	`ş—r
();

129 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

130 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

131 
X­Ÿn
::
	`Qu”y
("sky"),

132 
X­Ÿn
::
	`Qu”y
("date")));

133 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

139 
subqu”›s_§meweight_couÁ
.
	`push_back
(32);

140 
subqu”›s_diffweight_couÁ
.
	`push_back
(1);

142 
subqu”›s
.
	`ş—r
();

143 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

144 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_XOR
,

145 
X­Ÿn
::
	`Qu”y
("sky"),

146 
X­Ÿn
::
	`Qu”y
("date")));

147 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

149 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

150 
subqu”›s_diffweight_couÁ
.
	`push_back
(34);

152 
subqu”›s
.
	`ş—r
();

153 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

154 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_SYNONYM
,

155 
X­Ÿn
::
	`Qu”y
("sky"),

156 
X­Ÿn
::
	`Qu”y
("date")));

157 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

166 
subqu”›s_§meweight_couÁ
.
	`push_back
(1);

167 
subqu”›s_diffweight_couÁ
.
	`push_back
(33);

169 
subqu”›s
.
	`ş—r
();

170 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("sky"));

171 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("date"));

172 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("stein"));

173 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("ally"));

174 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

176 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

177 
subqu”›s_diffweight_couÁ
.
	`push_back
(35);

179 
subqu”›s
.
	`ş—r
();

180 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("attitud"));

181 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
,

182 
X­Ÿn
::
	`Qu”y
("german"),

183 
X­Ÿn
::
	`Qu”y
("adventur")));

184 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

191 
subqu”›s_§meweight_couÁ
.
	`push_back
(1);

192 
subqu”›s_diffweight_couÁ
.
	`push_back
(3);

194 
subqu”›s
.
	`ş—r
();

195 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("attitud"));

196 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

197 
X­Ÿn
::
	`Qu”y
("german"),

198 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_SYNONYM
,

199 
X­Ÿn
::
	`Qu”y
("sky"),

200 
X­Ÿn
::
	`Qu”y
("date"))));

201 
subqu”›s_li¡
.
	`push_back
(
subqu”›s
);

203 
subqu”›s_§meweight_couÁ
.
	`push_back
(0);

204 
subqu”›s_diffweight_couÁ
.
	`push_back
(54);

206 
veùÜ
<veùÜ<
X­Ÿn
::
Qu”y
> >::
size_ty³
 
subqgroup
 = 0;

207 
subqgroup
 !ğ
subqu”›s_li¡
.
	`size
(); ++subqgroup)

209 
veùÜ
<
X­Ÿn
::
Qu”y
> * 
qli¡
 = &(
subqu”›s_li¡
[
subqgroup
]);

212 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

215 
X­Ÿn
::
Qu”y
 
	`Üqu”y
(X­Ÿn::Qu”y::
OP_OR
, 
qli¡
->
	`begš
(), qli¡->
	`’d
());

216 
’quœe
.
	`£t_qu”y
(
Üqu”y
);

217 
X­Ÿn
::
MS‘
 
Üm£t
 = 
’quœe
.
	`g‘_m£t
(0, 
lÙs
);

220 
X­Ÿn
::
Qu”y
 
	`synqu”y
(X­Ÿn::Qu”y::
OP_SYNONYM
, 
qli¡
->
	`begš
(), qli¡->
	`’d
());

221 
’quœe
.
	`£t_qu”y
(
synqu”y
);

222 
X­Ÿn
::
MS‘
 
synm£t
 = 
’quœe
.
	`g‘_m£t
(0, 
lÙs
);

224 
tout
 << "Com·ršg " << 
Üqu”y
 << " w™h " << 
synqu”y
 << '\n';

227 
	`TEST_NOT_EQUAL
(
synm£t
.
	`size
(), 0);

229 
	`TEST_EQUAL
(
synm£t
.
	`size
(), 
Üm£t
.size());

230 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
weight
> 
v®ues_Ü
;

231 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
weight
> 
v®ues_synÚym
;

232 
X­Ÿn
::
doccouÁ
 
i
 = 0; i < 
synm£t
.
	`size
(); ++i) {

233 
v®ues_Ü
[*
Üm£t
[
i
]] = orm£t[i].
	`g‘_weight
();

234 
v®ues_synÚym
[*
synm£t
[
i
]] = synm£t[i].
	`g‘_weight
();

236 
	`TEST_EQUAL
(
v®ues_Ü
.
	`size
(), 
v®ues_synÚym
.size());

240 
§me_weight
 = 0;

241 
difã»Á_weight
 = 0;

242 
m­
<
X­Ÿn
::
docid
, X­Ÿn::
weight
>::
cÚ¡_™”©Ü


243 
j
 = 
v®ues_Ü
.
	`begš
(); j !ğv®ues_Ü.
	`’d
(); ++j) {

244 
X­Ÿn
::
docid
 
did
 = 
j
->
fœ¡
;

247 
	`TEST
(
v®ues_synÚym
.
	`fšd
(
did
è!ğv®ues_synÚym.
	`’d
());

248 ià(
v®ues_Ü
[
did
] =ğ
v®ues_synÚym
[did]) {

249 ++
§me_weight
;

251 ++
difã»Á_weight
;

255 
ex³ùed_§me
 = 
subqu”›s_§meweight_couÁ
[
subqgroup
];

256 
ex³ùed_diff
 = 
subqu”›s_diffweight_couÁ
[
subqgroup
];

258 
	`TEST_EQUAL
(
difã»Á_weight
, 
ex³ùed_diff
);

259 
	`TEST_EQUAL
(
§me_weight
, 
ex³ùed_§me
);

264 
X­Ÿn
::
MS‘
 
m£t_tİ
 = 
’quœe
.
	`g‘_m£t
(0, 1);

265 
	`TEST_EQUAL
(
m£t_tİ
.
	`size
(), 1);

266 
	`TEST
(
	`m£t_¿nge_is_§me
(
m£t_tİ
, 0, 
synm£t
, 0, 1));

268  
Œue
;

269 
	}
}

272 
	$DEFINE_TESTCASE
(
synÚym2
, 
back’d
) {

273 
X­Ÿn
::
Qu”y
 
qu”y
;

274 
veùÜ
<
X­Ÿn
::
Qu”y
> 
subqu”›s
;

275 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("file"));

276 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("the"));

277 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("next"));

278 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("reader"));

279 
qu”y
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
, 
subqu”›s
.
	`begš
(), subqu”›s.
	`’d
());

280 
subqu”›s
.
	`ş—r
();

281 
subqu”›s
.
	`push_back
(
qu”y
);

282 
subqu”›s
.
	`push_back
(
X­Ÿn
::
	`Qu”y
("gutenberg"));

283 
qu”y
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_SYNONYM
, 
subqu”›s
.
	`begš
(), subqu”›s.
	`’d
());

285 
tout
 << 
qu”y
 << '\n';

287 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("etext"));

288 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

289 
’quœe
.
	`£t_qu”y
(
qu”y
);

290 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

291 
tout
 << 
m£t
 << '\n';

294 
maxposs
 = 
m£t
.
	`g‘_max_possibË
();

295 
qu”y
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_SCALE_WEIGHT
, query, 10.0);

296 
’quœe
.
	`£t_qu”y
(
qu”y
);

297 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

298 
maxposs2
 = 
m£t
.
	`g‘_max_possibË
();

300 
	`TEST_EQUAL_DOUBLE
(
maxposs
 * 10.0, 
maxposs2
);

302  
Œue
;

303 
	}
}

306 
check_m£ts_cÚš_§me_docs
(cÚ¡ 
X­Ÿn
::
MS‘
 & 
m£t1
,

307 cÚ¡ 
X­Ÿn
::
MS‘
 & 
m£t2
)

309 
TEST_EQUAL
(
m£t1
.
size
(), 
m£t2
.size());

311 
	g£t
<
	gX­Ÿn
::
docid
> 
docids
;

312 
	gX­Ÿn
::
doccouÁ
 
i
 = 0; 
	gi
 < 
	gm£t1
.
size
(); ++i) {

313 
	gdocids
.
š£¹
(*
m£t1
[
i
]);

317 
	gX­Ÿn
::
doccouÁ
 
j
 = 0; 
	gj
 < 
	gm£t2
.
size
(); ++j) {

321 
TEST
(
docids
.
”a£
(*
m£t2
[
j
]));

326 
	$DEFINE_TESTCASE
(
synÚym3
, 
back’d
) {

327 
X­Ÿn
::
Qu”y
 
qu”y
 = X­Ÿn::
	`Qu”y
(X­Ÿn::Qu”y::
OP_SYNONYM
,

328 
X­Ÿn
::
	`Qu”y
("sky"),

329 
X­Ÿn
::
	`Qu”y
("date"));

331 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("etext"));

332 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

333 
’quœe
.
	`£t_qu”y
(
qu”y
);

334 
X­Ÿn
::
MS‘
 
m£t_Üig
 = 
’quœe
.
	`g‘_m£t
(0, 
db
.
	`g‘_doccouÁ
());

336 
tout
 << 
qu”y
 << '\n';

337 
tout
 << 
m£t_Üig
 << '\n';

341 
qu”y
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_SCALE_WEIGHT
, query, 0.0);

342 
’quœe
.
	`£t_qu”y
(
qu”y
);

343 
X­Ÿn
::
MS‘
 
m£t_z”o
 = 
’quœe
.
	`g‘_m£t
(0, 
db
.
	`g‘_doccouÁ
());

345 
tout
 << 
qu”y
 << '\n';

346 
tout
 << 
m£t_z”o
 << '\n';

349 
	`TEST_NOT_EQUAL
(
m£t_z”o
.
	`size
(), 0);

352 
	`check_m£ts_cÚš_§me_docs
(
m£t_Üig
, 
m£t_z”o
);

353 
X­Ÿn
::
doccouÁ
 
i
 = 0; i < 
m£t_Üig
.
	`size
(); ++i) {

354 
	`TEST_NOT_EQUAL
(
m£t_Üig
[
i
].
	`g‘_weight
(), 0.0);

355 
	`TEST_EQUAL
(
m£t_z”o
[
i
].
	`g‘_weight
(), 0.0);

358  
Œue
;

359 
	}
}

362 
	$DEFINE_TESTCASE
(
synÚym4
, 
back’d
) {

363 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("etext"));

364 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

365 
X­Ÿn
::
Qu”y
 
syn_qu”y
 = X­Ÿn::
	`Qu”y
(X­Ÿn::Qu”y::
OP_SYNONYM
,

366 
X­Ÿn
::
	`Qu”y
("gutenberg"),

367 
X­Ÿn
::
	`Qu”y
("blockhead"));

368 
X­Ÿn
::
Qu”y
 
Ü_qu”y
 = X­Ÿn::
	`Qu”y
(X­Ÿn::Qu”y::
OP_OR
,

369 
X­Ÿn
::
	`Qu”y
("gutenberg"),

370 
X­Ÿn
::
	`Qu”y
("blockhead"));

371 
X­Ÿn
::
Qu”y
 
d©e_qu”y
 = X­Ÿn::
	`Qu”y
("date");

374 cÚ¡ 
X­Ÿn
::
Qu”y
::
İ
 
İ”©Üs
[] = {

375 
X­Ÿn
::
Qu”y
::
OP_AND_MAYBE
,

376 
X­Ÿn
::
Qu”y
::
OP_AND_NOT
,

377 
X­Ÿn
::
Qu”y
::
OP_AND
,

378 
X­Ÿn
::
Qu”y
::
OP_XOR
,

379 
X­Ÿn
::
Qu”y
::
OP_OR
,

380 
X­Ÿn
::
Qu”y
::
OP_SYNONYM


382 cÚ¡ 
X­Ÿn
::
Qu”y
::
İ
 * 
’d
;

383 
’d
 = 
İ”©Üs
 + (operators) / (operators[0]);

384 cÚ¡ 
X­Ÿn
::
Qu”y
::
İ
 * 
i
 = 
İ”©Üs
; i !ğ
’d
; ++i) {

385 
tout
.
	`¡r
(
	`¡ršg
());

386 
X­Ÿn
::
Qu”y
 
	`qu”y1
(*
i
, 
syn_qu”y
, 
d©e_qu”y
);

387 
X­Ÿn
::
Qu”y
 
	`qu”y2
(*
i
, 
Ü_qu”y
, 
d©e_qu”y
);

389 
’quœe
.
	`£t_qu”y
(
qu”y1
);

390 
tout
 << "qu”y1:" << 
qu”y1
 << '\n';

391 
X­Ÿn
::
MS‘
 
m£t1
 = 
’quœe
.
	`g‘_m£t
(0, 
db
.
	`g‘_doccouÁ
());

392 
tout
 << "m£t1:" << 
m£t1
 << '\n';

393 
’quœe
.
	`£t_qu”y
(
qu”y2
);

394 
tout
 << "qu”y2:" << 
qu”y2
 << '\n';

395 
X­Ÿn
::
MS‘
 
m£t2
 = 
’quœe
.
	`g‘_m£t
(0, 
db
.
	`g‘_doccouÁ
());

396 
tout
 << "m£t2:" << 
m£t2
 << '\n';

398 
	`TEST_NOT_EQUAL
(
m£t1
.
	`size
(), 0);

399 ià(*
i
 !ğ
X­Ÿn
::
Qu”y
::
OP_XOR
) {

400 
	`TEST_EQUAL
(
m£t1
[0].
	`g‘_³rûÁ
(), 100);

402 
	`TEST
(
m£t1
[0].
	`g‘_³rûÁ
() != 100);

404 
	`check_m£ts_cÚš_§me_docs
(
m£t1
, 
m£t2
);

407  
Œue
;

408 
	}
}

	@tests/api_opsynonym.h

2 
boŞ
 
‹¡_synÚym1
();

3 
boŞ
 
‹¡_synÚym2
();

4 
boŞ
 
‹¡_synÚym3
();

5 
boŞ
 
‹¡_synÚym4
();

	@tests/api_percentages.cc

22 
	~<cÚfig.h
>

24 
	~"­i_³rûÁages.h
"

26 
	~<x­Ÿn.h
>

28 
	~"­™e¡.h
"

29 
	~"back’dmªag”_loÿl.h
"

30 
	~"‹¡uts.h
"

32 
	~<cæßt
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	$DEFINE_TESTCASE
(
cÚsi¡’cy3
, 
back’d
) {

40 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_sortconsist"));

41 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

42 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("foo"));

43 
’quœe
.
	`£t_sÜt_by_v®ue
(1, 0);

44 
X­Ÿn
::
doccouÁ
 
lÙs
 = 3;

45 
X­Ÿn
::
MS‘
 
bigm£t
 = 
’quœe
.
	`g‘_m£t
(0, 
lÙs
);

46 
	`TEST_EQUAL
(
bigm£t
.
	`size
(), 
lÙs
);

47 
X­Ÿn
::
doccouÁ
 
¡¬t
 = 0; s¹ < 
lÙs
; ++start) {

48 
tout
 << *
bigm£t
[
¡¬t
] << ":" << bigm£t[¡¬t].
	`g‘_weight
() << ":"

49 << 
bigm£t
[
¡¬t
].
	`g‘_³rûÁ
(è<< "%" << 
’dl
;

50 
X­Ÿn
::
doccouÁ
 
size
 = 0; siz< 
lÙs
 - 
¡¬t
; ++size) {

51 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(
¡¬t
, 
size
);

52 ià(
m£t
.
	`size
()) {

53 
	`TEST_EQUAL
(
¡¬t
 + 
m£t
.
	`size
(),

54 
	`mš
(
¡¬t
 + 
size
, 
bigm£t
.
	`size
()));

55 } ià(
size
) {

56 
	`TEST
(
¡¬t
 >ğ
bigm£t
.
	`size
());

58 
X­Ÿn
::
doccouÁ
 
i
 = 0; i < 
m£t
.
	`size
(); ++i) {

59 
	`TEST_EQUAL
(*
m£t
[
i
], *
bigm£t
[
¡¬t
 + i]);

60 
	`TEST_EQUAL_DOUBLE
(
m£t
[
i
].
	`g‘_weight
(),

61 
bigm£t
[
¡¬t
 + 
i
].
	`g‘_weight
());

62 
	`TEST_EQUAL_DOUBLE
(
m£t
[
i
].
	`g‘_³rûÁ
(),

63 
bigm£t
[
¡¬t
 + 
i
].
	`g‘_³rûÁ
());

67  
Œue
;

68 
	}
}

70 şas 
	cMyPo¡šgSourû
 : 
public
 
X­Ÿn
::
Po¡šgSourû
 {

71 
veùÜ
<
·œ
<
X­Ÿn
::
docid
, 
	mX­Ÿn
::
weight
> > 
weights
;

72 
	mveùÜ
<
	m·œ
<
	mX­Ÿn
::
docid
, X­Ÿn::
weight
> >::
cÚ¡_™”©Ü
 
i
;

73 
boŞ
 
	m¡¬‹d
;

75 
MyPo¡šgSourû
(cÚ¡ 
veùÜ
<
·œ
<
X­Ÿn
::
docid
, X­Ÿn::
weight
> > &
weights_
,

76 
X­Ÿn
::
weight
 
max_wt
)

77 : 
weights
(
weights_
), 
	$¡¬‹d
(
çl£
)

79 
	`£t_maxweight
(
max_wt
);

82 
public
:

83 
	$MyPo¡šgSourû
(è: 
	$¡¬‹d
(
çl£
è{ 
	}
}

85 
Po¡šgSourû
 * 
	$şÚe
() const

87  
Ãw
 
	`MyPo¡šgSourû
(
weights
, 
	`g‘_maxweight
());

88 
	}
}

90 
­³nd_docweight
(
X­Ÿn
::
docid
 
did
, X­Ÿn::
weight
 
wt
) {

91 
weights
.
push_back
(
make_·œ
(
did
, 
wt
));

92 ià(
	gwt
 > 
g‘_maxweight
()è
£t_maxweight
(
wt
);

95 
š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 &è{ 
¡¬‹d
 = 
çl£
; }

97 
	gX­Ÿn
::
weight
 
	$g‘_weight
(ècÚ¡ {  
i
->
£cÚd
; 
	}
}

99 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
(ècÚ¡ {  
weights
.
	`size
(); 
	}
}

100 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
(ècÚ¡ {  
weights
.
	`size
(); 
	}
}

101 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
(ècÚ¡ {  
weights
.
	`size
(); 
	}
}

103 
Ãxt
(
X­Ÿn
::
weight
 ) {

104 ià(!
¡¬‹d
) {

105 
i
 = 
weights
.
begš
();

106 
	g¡¬‹d
 = 
Œue
;

108 ++
	gi
;

112 
boŞ
 
	$©_’d
() const {

113  (
i
 =ğ
weights
.
	`’d
());

114 
	}
}

116 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
i
->
fœ¡
; 
	}
}

118 
¡ršg
 
	$g‘_desütiÚ
() const {

120 
	}
}

125 
DEFINE_TESTCASE
(
pùcutoff4
, 
back’d
 && !
»mÙe
 && !
muÉi
) {

128 
	g•sÚs
 = 0;

129 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_simpledata"));

130 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

131 
	gŒue
) {

132 
MyPo¡šgSourû
 
	gsourû
;

133 
	gsourû
.
­³nd_docweight
(1, 100);

134 
	gsourû
.
­³nd_docweight
(2, 50 - 
•sÚs
 * 
DBL_EPSILON
);

135 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(&
sourû
));

136 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

137 
TEST_EQUAL
(
m£t
.
size
(), 2);

138 ià(
	gm£t
[1].
g‘_³rûÁ
() != 50) ;

139 ++
	g•sÚs
;

144 
MyPo¡šgSourû
 
	gsourû
;

145 
	gsourû
.
­³nd_docweight
(1, 100);

146 
	gsourû
.
­³nd_docweight
(2, 50);

147 
	gsourû
.
­³nd_docweight
(3, 50 - (
•sÚs
 - 1è* 
DBL_EPSILON
);

148 
	gsourû
.
­³nd_docweight
(4, 50 - 
•sÚs
 * 
DBL_EPSILON
);

149 
	gsourû
.
­³nd_docweight
(5, 25);

151 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(&
sourû
));

152 
	gX­Ÿn
::
MS‘
 
m£t1
 = 
’quœe
.
g‘_m£t
(0, 10);

153 
TEST_EQUAL
(
m£t1
.
size
(), 5);

154 
TEST_EQUAL
(
m£t1
[2].
g‘_³rûÁ
(), 50);

155 
TEST_EQUAL
(
m£t1
[3].
g‘_³rûÁ
(), 49);

159 
	g³rûÁ
 = 100;

160 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t1
.
begš
(); 
	gi
 !ğm£t1.
’d
(); ++i) {

161 
	gÃw_³rûÁ
 = 
m£t1
.
cÚv”t_to_³rûÁ
(
i
);

162 
	gtout
 << "m£t1 i‹m = " << 
	gi
.
g‘_³rûÁ
() << "%\n";

163 ià(
	gÃw_³rûÁ
 !ğ
³rûÁ
) {

164 
’quœe
.
£t_cutoff
(
³rûÁ
);

165 
	gX­Ÿn
::
MS‘
 
m£t2
 = 
’quœe
.
g‘_m£t
(0, 10);

166 
	gtout
 << "cutofàğ" << 
	g³rûÁ
 << "%, "

167 "m£ˆsizğ" << 
	gm£t2
.
size
() << "\n";

168 
TEST_EQUAL
(
m£t2
.
size
(), 
i
.
g‘_¿nk
());

169 
	g³rûÁ
 = 
Ãw_³rûÁ
;

173  
	gŒue
;

177 
	$DEFINE_TESTCASE
(
pùcutoff5
, 
back’d
) {

178 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_simpledata"));

179 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

180 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("test"));

181 
’quœe
.
	`£t_cutoff
(42);

182 
X­Ÿn
::
MS‘
 
m£t
;

184 
’quœe
.
	`£t_sÜt_by_v®ue
(0, 
çl£
);

185 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10));

187 
’quœe
.
	`£t_sÜt_by_v®ue
(0, 
Œue
);

188 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10));

190 
’quœe
.
	`£t_sÜt_by_v®ue_th’_»Ëvªû
(0, 
çl£
);

191 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10));

193 
’quœe
.
	`£t_sÜt_by_v®ue_th’_»Ëvªû
(0, 
Œue
);

194 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10));

196  
Œue
;

197 
	}
}

200 
	$DEFINE_TESTCASE
(
tİ”ûÁ3
, 
»mÙe
) {

201 
Back’dMªag”Loÿl
 
loÿl_mªag”
;

202 
loÿl_mªag”
.
	`£t_d©adœ
(
‹¡_driv”
::
	`g‘_¤cdœ
() + "/testdata/");

203 
X­Ÿn
::
D©aba£
 
db
;

204 
db
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata"));

205 
db
.
	`add_d©aba£
(
loÿl_mªag”
.
	`g‘_d©aba£
("apitest_simpledata"));

207 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

208 
’quœe
.
	`£t_sÜt_by_v®ue
(1, 
çl£
);

210 cÚ¡ * 
‹rms
[] = { "paragraph", "banana" };

211 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
, 
‹rms
,erms + 2));

213 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

215 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
;

216 
i
 = 
m£t
.
	`begš
(); i !ğm£t.
	`’d
(); ++i) {

218 
	`TEST_REL
(
i
.
	`g‘_³rûÁ
(),<,100);

221  
Œue
;

222 
	}
}

226 
	$DEFINE_TESTCASE
(
tİ”ûÁ4
, 
back’d
) {

227 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
("apitest_simpledata"));

229 
X­Ÿn
::
Qu”y
 
	`qu”y
(X­Ÿn::Qu”y::
OP_FILTER
,

230 
X­Ÿn
::
	`Qu”y
("paragraph"),

231 
X­Ÿn
::
	`Qu”y
("queri"));

232 
qu”y
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_XOR
,

233 
qu”y
, 
X­Ÿn
::
	`Qu”y
("rubbish"));

235 
’quœe
.
	`£t_qu”y
(
qu”y
);

236 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

239 
	`TEST
(!
m£t
.
	`em±y
());

240 
	`TEST_EQUAL
(
m£t
[0].
	`g‘_³rûÁ
(), 50);

242  
Œue
;

243 
	}
}

	@tests/api_percentages.h

2 
boŞ
 
‹¡_cÚsi¡’cy3
();

3 
boŞ
 
‹¡_pùcutoff4
();

4 
boŞ
 
‹¡_pùcutoff5
();

5 
boŞ
 
‹¡_tİ”ûÁ3
();

6 
boŞ
 
‹¡_tİ”ûÁ4
();

	@tests/api_posdb.cc

23 
	~<cÚfig.h
>

25 
	~"­i_posdb.h
"

27 
	~<¡ršg
>

28 
	~<veùÜ
>

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	~<x­Ÿn.h
>

33 
	~"‹¡su™e.h
"

34 
	~"‹¡uts.h
"

36 
	~"­™e¡.h
"

39 
	$DEFINE_TESTCASE
(
Ã¬1
, 
pos™iÚ®
) {

40 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_phrase"));

41 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

42 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

43 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

46 
veùÜ
<
X­Ÿn
::
Qu”y
> 
subqs
;

47 
X­Ÿn
::
Qu”y
 
q
;

48 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

49 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

50 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

51 
’quœe
.
	`£t_qu”y
(
q
);

54 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

55 
	`m£t_ex³ù_Üd”
(
mym£t
);

57 
subqs
.
	`ş—r
();

58 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

59 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near")));

60 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

61 
’quœe
.
	`£t_qu”y
(
q
);

64 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

65 
	`m£t_ex³ù_Üd”
(
mym£t
, 3);

67 
subqs
.
	`ş—r
();

68 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

69 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near")));

70 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 3);

71 
’quœe
.
	`£t_qu”y
(
q
);

74 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

75 
	`m£t_ex³ù_Üd”
(
mym£t
, 1, 3);

77 
subqs
.
	`ş—r
();

78 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

79 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near")));

80 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 5);

81 
’quœe
.
	`£t_qu”y
(
q
);

84 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

85 
	`m£t_ex³ù_Üd”
(
mym£t
, 1, 3);

87 
subqs
.
	`ş—r
();

88 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

89 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near")));

90 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 6);

91 
’quœe
.
	`£t_qu”y
(
q
);

94 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

95 
	`m£t_ex³ù_Üd”
(
mym£t
, 1, 2, 3);

97 
subqs
.
	`ş—r
();

98 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

99 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

100 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

101 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 3);

102 
’quœe
.
	`£t_qu”y
(
q
);

105 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

106 
	`m£t_ex³ù_Üd”
(
mym£t
, 4, 5, 6, 7, 8, 9);

108 
subqs
.
	`ş—r
();

109 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

110 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

111 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

112 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 4);

113 
’quœe
.
	`£t_qu”y
(
q
);

116 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

117 
	`m£t_ex³ù_Üd”
(
mym£t
, 4, 5, 6, 7, 8, 9, 10);

119 
subqs
.
	`ş—r
();

120 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

121 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

122 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

123 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 5);

124 
’quœe
.
	`£t_qu”y
(
q
);

127 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

128 
	`m£t_ex³ù_Üd”
(
mym£t
, 4, 5, 6, 7, 8, 9, 10, 11);

130 
subqs
.
	`ş—r
();

131 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

132 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

133 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

134 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 6);

135 
’quœe
.
	`£t_qu”y
(
q
);

138 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

139 
	`m£t_ex³ù_Üd”
(
mym£t
, 4, 5, 6, 7, 8, 9, 10, 11, 12);

141 
subqs
.
	`ş—r
();

142 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

143 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

144 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

145 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 7);

146 
’quœe
.
	`£t_qu”y
(
q
);

149 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

150 
	`m£t_ex³ù_Üd”
(
mym£t
, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13);

152 
subqs
.
	`ş—r
();

153 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

154 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

155 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

156 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 8);

157 
’quœe
.
	`£t_qu”y
(
q
);

160 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

161 
	`m£t_ex³ù_Üd”
(
mym£t
, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14);

163 
subqs
.
	`ş—r
();

164 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

165 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

166 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

168 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 999999999);

169 
’quœe
.
	`£t_qu”y
(
q
);

172 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

173 
	`m£t_ex³ù_Üd”
(
mym£t
, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14);

175  
Œue
;

176 
	}
}

179 
	$DEFINE_TESTCASE
(
Ã¬2
, 
pos™iÚ®
) {

180 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_phrase"));

181 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

182 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

183 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

186 
veùÜ
<
X­Ÿn
::
Qu”y
> 
subqs
;

187 
X­Ÿn
::
Qu”y
 
q
;

188 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

189 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")),

190 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near"))));

191 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("and")));

192 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

193 
’quœe
.
	`£t_qu”y
(
q
);

196 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

197 
	`m£t_ex³ù_Üd”
(
mym£t
, 1);

199 
subqs
.
	`ş—r
();

200 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

201 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")),

202 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near"))));

203 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("operator")));

204 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

205 
’quœe
.
	`£t_qu”y
(
q
);

208 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

209 
	`m£t_ex³ù_Üd”
(
mym£t
, 2);

211 
subqs
.
	`ş—r
();

212 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("operator")));

213 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

214 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")),

215 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near"))));

216 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

217 
’quœe
.
	`£t_qu”y
(
q
);

220 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

221 
	`m£t_ex³ù_Üd”
(
mym£t
, 2);

223  
Œue
;

224 
	}
}

227 
	$DEFINE_TESTCASE
(
ph¿£1
, 
pos™iÚ®
) {

228 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_phrase"));

229 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

230 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

231 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

234 
veùÜ
<
X­Ÿn
::
Qu”y
> 
subqs
;

235 
X­Ÿn
::
Qu”y
 
q
;

236 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

237 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

238 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

239 
’quœe
.
	`£t_qu”y
(
q
);

242 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

243 
	`m£t_ex³ù_Üd”
(
mym£t
);

245 
subqs
.
	`ş—r
();

246 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

247 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near")));

248 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

249 
’quœe
.
	`£t_qu”y
(
q
);

252 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

253 
	`m£t_ex³ù_Üd”
(
mym£t
);

255 
subqs
.
	`ş—r
();

256 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

257 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near")));

258 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 3);

259 
’quœe
.
	`£t_qu”y
(
q
);

262 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

263 
	`m£t_ex³ù_Üd”
(
mym£t
, 1);

265 
subqs
.
	`ş—r
();

266 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

267 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near")));

268 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 5);

269 
’quœe
.
	`£t_qu”y
(
q
);

272 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

273 
	`m£t_ex³ù_Üd”
(
mym£t
, 1);

275 
subqs
.
	`ş—r
();

276 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")));

277 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near")));

278 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 6);

279 
’quœe
.
	`£t_qu”y
(
q
);

282 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

283 
	`m£t_ex³ù_Üd”
(
mym£t
, 1, 2);

285 
subqs
.
	`ş—r
();

286 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

287 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

288 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

289 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 3);

290 
’quœe
.
	`£t_qu”y
(
q
);

293 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

294 
	`m£t_ex³ù_Üd”
(
mym£t
, 4);

296 
subqs
.
	`ş—r
();

297 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

298 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

299 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

300 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 4);

301 
’quœe
.
	`£t_qu”y
(
q
);

304 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

305 
	`m£t_ex³ù_Üd”
(
mym£t
, 4);

307 
subqs
.
	`ş—r
();

308 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

309 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

310 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

311 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 5);

312 
’quœe
.
	`£t_qu”y
(
q
);

315 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

316 
	`m£t_ex³ù_Üd”
(
mym£t
, 4);

318 
subqs
.
	`ş—r
();

319 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

320 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

321 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

322 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 6);

323 
’quœe
.
	`£t_qu”y
(
q
);

326 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

327 
	`m£t_ex³ù_Üd”
(
mym£t
, 4);

329 
subqs
.
	`ş—r
();

330 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

331 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

332 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

333 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 7);

334 
’quœe
.
	`£t_qu”y
(
q
);

337 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

338 
	`m£t_ex³ù_Üd”
(
mym£t
, 4);

340 
subqs
.
	`ş—r
();

341 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

342 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

343 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

344 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 8);

345 
’quœe
.
	`£t_qu”y
(
q
);

348 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

349 
	`m£t_ex³ù_Üd”
(
mym£t
, 4);

352 
subqs
.
	`ş—r
();

353 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("leave")));

354 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("fridge")));

355 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("on")));

356 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 999999999);

357 
’quœe
.
	`£t_qu”y
(
q
);

360 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 20);

361 
	`m£t_ex³ù_Üd”
(
mym£t
, 4);

364 
subqs
.
	`ş—r
();

365 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("first")));

366 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("second")));

367 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("third")));

368 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 9);

369 
’quœe
.
	`£t_qu”y
(
q
);

372 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

373 
	`m£t_ex³ù_Üd”
(
mym£t
);

376 
subqs
.
	`ş—r
();

377 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("first")));

378 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("second")));

379 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("third")));

380 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 10);

381 
’quœe
.
	`£t_qu”y
(
q
);

384 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

385 
	`m£t_ex³ù_Üd”
(
mym£t
, 15);

389 
subqs
.
	`ş—r
();

390 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("milk")));

391 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("rare")));

392 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

393 
’quœe
.
	`£t_qu”y
(
q
);

396 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

397 
	`m£t_ex³ù_Üd”
(
mym£t
, 16);

401 
subqs
.
	`ş—r
();

402 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("rare")));

403 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("milk")));

404 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

405 
’quœe
.
	`£t_qu”y
(
q
);

408 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

409 
	`m£t_ex³ù_Üd”
(
mym£t
, 17);

411  
Œue
;

412 
	}
}

415 
	$DEFINE_TESTCASE
(
ph¿£2
, 
pos™iÚ®
) {

416 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_phrase"));

417 
X­Ÿn
::
Enquœe
 
	`’quœe
(
mydb
);

418 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

419 
’quœe
.
	`£t_weightšg_scheme
(
X­Ÿn
::
	`BoŞWeight
());

422 
veùÜ
<
X­Ÿn
::
Qu”y
> 
subqs
;

423 
X­Ÿn
::
Qu”y
 
q
;

424 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

425 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")),

426 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near"))));

427 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("and")));

428 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

429 
’quœe
.
	`£t_qu”y
(
q
);

432 
X­Ÿn
::
MS‘
 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

433 
	`m£t_ex³ù_Üd”
(
mym£t
);

435 
subqs
.
	`ş—r
();

436 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

437 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")),

438 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near"))));

439 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("operator")));

440 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

441 
’quœe
.
	`£t_qu”y
(
q
);

444 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

445 
	`m£t_ex³ù_Üd”
(
mym£t
, 2);

447 
subqs
.
	`ş—r
();

448 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("operator")));

449 
subqs
.
	`push_back
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_AND
,

450 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("phrase")),

451 
X­Ÿn
::
	`Qu”y
(
	`¡emm”
("near"))));

452 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
subqs
.
	`begš
(), subqs.
	`’d
(), 2);

453 
’quœe
.
	`£t_qu”y
(
q
);

456 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

457 
	`m£t_ex³ù_Üd”
(
mym£t
);

459  
Œue
;

460 
	}
}

463 
	$DEFINE_TESTCASE
(
po¦i¡1
, 
pos™iÚ®
) {

464 
X­Ÿn
::
D©aba£
 
	`mydb
(
	`g‘_d©aba£
("apitest_poslist"));

466 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

467 
¡ršg
 
‹rm
 = 
	`¡emm”
("sponge");

469 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
¶i
 = 
mydb
.
	`pos™iÚli¡_begš
(2, 
‹rm
);

471 
	`TEST
(
¶i
 !ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

472 
	`TEST
(*
¶i
 == 1);

473 
¶i
++;

474 
	`TEST
(
¶i
 !ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

475 
	`TEST
(*
¶i
 == 2);

476 
¶i
++;

477 
	`TEST
(
¶i
 !ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

478 
	`TEST
(*
¶i
 == 3);

479 
¶i
++;

480 
	`TEST
(
¶i
 !ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

481 
	`TEST
(*
¶i
 == 5);

482 
¶i
++;

483 
	`TEST
(
¶i
 !ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

484 
	`TEST
(*
¶i
 == 8);

485 
¶i
++;

486 
	`TEST
(
¶i
 !ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

487 
	`TEST
(*
¶i
 == 13);

488 
¶i
++;

489 
	`TEST
(
¶i
 !ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

490 
	`TEST
(*
¶i
 == 21);

491 
¶i
++;

492 
	`TEST
(
¶i
 !ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

493 
	`TEST
(*
¶i
 == 34);

494 
¶i
++;

495 
	`TEST
(
¶i
 =ğ
mydb
.
	`pos™iÚli¡_’d
(2, 
‹rm
));

497  
Œue
;

498 
	}
}

500 
	$DEFINE_TESTCASE
(
po¦i¡2
, 
pos™iÚ®
 && 
wr™abË
) {

501 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

503 
X­Ÿn
::
Docum’t
 
doc
;

504 
doc
.
	`add_‹rm
("nopos");

505 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc
);

509 
	`TEST_EQUAL
(
db
.
	`pos™iÚli¡_begš
(
did
, "nosuchterm"),

510 
db
.
	`pos™iÚli¡_’d
(
did
, "nosuchterm"));

514 
	`TEST_EQUAL
(
db
.
	`pos™iÚli¡_begš
(123, "nosuchterm"),

515 
db
.
	`pos™iÚli¡_’d
(123, "nosuchterm"));

517 
	`TEST_EQUAL
(
db
.
	`pos™iÚli¡_begš
(
did
, "nopos"),

518 
db
.
	`pos™iÚli¡_’d
(
did
, "nopos"));

520 
X­Ÿn
::
Docum’t
 
doc2
 = 
db
.
	`g‘_docum’t
(
did
);

522 
X­Ÿn
::
T”mI‹¿tÜ
 
‹rm
 = 
doc2
.
	`‹rmli¡_begš
();

525 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
i
 = 
‹rm
.
	`pos™iÚli¡_begš
();

526 
	`TEST_EQUAL
(
i
, 
‹rm
.
	`pos™iÚli¡_’d
());

529 
X­Ÿn
::
Docum’t
 
doc3
;

530 
doc3
.
	`add_po¡šg
("hadpos", 1);

531 
X­Ÿn
::
docid
 
did2
 = 
db
.
	`add_docum’t
(
doc3
);

533 
X­Ÿn
::
Docum’t
 
doc4
 = 
db
.
	`g‘_docum’t
(
did2
);

534 
doc4
.
	`»move_po¡šg
("hadpos", 1);

535 
db
.
	`»¶aû_docum’t
(
did2
, 
doc4
);

538 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
i
 = 
db
.
	`pos™iÚli¡_begš
(
did2
, "hadpos");

539 
	`TEST_EQUAL
(
i
, 
db
.
	`pos™iÚli¡_’d
(
did2
, "hadpos"));

542 
db
.
	`d–‘e_docum’t
(
did
);

544 
	`TEST_EQUAL
(
db
.
	`pos™iÚli¡_begš
(
did
, "nosuchterm"),

545 
db
.
	`pos™iÚli¡_’d
(
did
, "nosuchterm"));

547  
Œue
;

548 
	}
}

552 
	$DEFINE_TESTCASE
(
po¦i¡3
, 
pos™iÚ®
 && 
wr™abË
) {

553 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

555 
veùÜ
<
X­Ÿn
::
‹rmpos
> 
pos™iÚs
;

557 
X­Ÿn
::
Docum’t
 
docum’t
;

558 
docum’t
.
	`add_po¡šg
("foo", 5);

559 
docum’t
.
	`add_po¡šg
("foo", 8);

560 
docum’t
.
	`add_po¡šg
("foo", 10);

561 
docum’t
.
	`add_po¡šg
("foo", 12);

562 
db
.
	`add_docum’t
(
docum’t
);

564 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
¶
 = 
db
.
	`pos™iÚli¡_begš
(1, "foo");

565 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
¶_’d
 = 
db
.
	`pos™iÚli¡_’d
(1, "foo");

567 
	`TEST
(
¶
 !ğ
¶_’d
);

568 
	`TEST_EQUAL
(*
¶
, 5);

569 ++
¶
;

570 
	`TEST
(
¶
 !ğ
¶_’d
);

571 
	`TEST_EQUAL
(*
¶
, 8);

572 ++
¶
;

573 
	`TEST
(
¶
 !ğ
¶_’d
);

574 
	`TEST_EQUAL
(*
¶
, 10);

575 ++
¶
;

576 
	`TEST
(
¶
 !ğ
¶_’d
);

577 
	`TEST_EQUAL
(*
¶
, 12);

578 ++
¶
;

579 
	`TEST
(
¶
 =ğ
¶_’d
);

581 
¶
 = 
db
.
	`pos™iÚli¡_begš
(1, "foo");

582 
¶
.
	`sk_to
(5);

583 
	`TEST
(
¶
 !ğ
¶_’d
);

584 
	`TEST_EQUAL
(*
¶
, 5);

586 
¶
.
	`sk_to
(9);

587 
	`TEST
(
¶
 !ğ
¶_’d
);

588 
	`TEST_EQUAL
(*
¶
, 10);

590 ++
¶
;

591 
	`TEST
(
¶
 !ğ
¶_’d
);

592 
	`TEST_EQUAL
(*
¶
, 12);

594 
¶
.
	`sk_to
(12);

595 
	`TEST
(
¶
 !ğ
¶_’d
);

596 
	`TEST_EQUAL
(*
¶
, 12);

598 
¶
.
	`sk_to
(13);

599 
	`TEST
(
¶
 =ğ
¶_’d
);

601  
Œue
;

602 
	}
}

609 
	$DEFINE_TESTCASE
(
pos™äom‹rm™1
, 
pos™iÚ®
) {

610 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

611 
X­Ÿn
::
T”mI‹¿tÜ
 
	`t
(
db
.
	`‹rmli¡_begš
(7));

612 
	`TEST_NOT_EQUAL
(
t
, 
db
.
	`‹rmli¡_’d
(7));

613 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
p
 = 
t
.
	`pos™iÚli¡_begš
();

614 
	`TEST_NOT_EQUAL
(
p
, 
t
.
	`pos™iÚli¡_’d
());

616 
Œy
 {

617 
	`TEST_EQUAL
(
t
.
	`pos™iÚli¡_couÁ
(), 1);

618 
t
.
	`sk_to
("on");

619 
	`TEST_NOT_EQUAL
(
t
, 
db
.
	`‹rmli¡_’d
(7));

620 
	`TEST_EQUAL
(
t
.
	`pos™iÚli¡_couÁ
(), 2);

621 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Unim¶em’‹dE¼Ü
 &) {

622 
	`SKIP_TEST
("TermList::positionlist_count()‚ot yet implemented forhis backend");

625  
Œue
;

626 
	}
}

	@tests/api_posdb.h

2 
boŞ
 
‹¡_Ã¬1
();

3 
boŞ
 
‹¡_Ã¬2
();

4 
boŞ
 
‹¡_ph¿£1
();

5 
boŞ
 
‹¡_ph¿£2
();

6 
boŞ
 
‹¡_po¦i¡1
();

7 
boŞ
 
‹¡_po¦i¡2
();

8 
boŞ
 
‹¡_po¦i¡3
();

9 
boŞ
 
‹¡_pos™äom‹rm™1
();

	@tests/api_postingsource.cc

23 
	~<cÚfig.h
>

25 
	~"­i_po¡šgsourû.h
"

27 
	~<x­Ÿn.h
>

29 
	~<¡ršg
>

31 
	~"‹¡uts.h
"

32 
	~"uts.h
"

33 
	~"­™e¡.h
"

35 
usšg
 
Çme¥aû
 
	g¡d
;

37 şas 
	cMyOddPo¡šgSourû
 : 
public
 
X­Ÿn
::
Po¡šgSourû
 {

38 
X­Ÿn
::
doccouÁ
 
num_docs
;

40 
	mX­Ÿn
::
doccouÁ
 
Ï¡_docid
;

42 
	mX­Ÿn
::
docid
 
did
;

44 
MyOddPo¡šgSourû
(
X­Ÿn
::
doccouÁ
 
num_docs_
,

45 
X­Ÿn
::
doccouÁ
 
Ï¡_docid_
)

46 : 
num_docs
(
num_docs_
), 
Ï¡_docid
(
Ï¡_docid_
), 
	$did
(0)

49 
public
:

50 
	`MyOddPo¡šgSourû
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db
)

51 : 
	`num_docs
(
db
.
	`g‘_doccouÁ
()), 
	`Ï¡_docid
(db.
	`g‘_Ï¡docid
()), 
	$did
(0)

52 { 
	}
}

54 
Po¡šgSourû
 * 
	$şÚe
(ècÚ¡ {  
Ãw
 
	`MyOddPo¡šgSourû
(
num_docs
, 
Ï¡_docid
); 
	}
}

56 
š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 &è{ 
did
 = 0; }

59 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
(ècÚ¡ {  0; 
	}
}

61 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
(ècÚ¡ {  
num_docs
 / 2; 
	}
}

63 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
(ècÚ¡ {  
num_docs
; 
	}
}

65 
Ãxt
(
X­Ÿn
::
weight
 
wt
) {

66 ()
wt
;

67 ++
	gdid
;

68 ià(
	gdid
 % 2 =ğ0è++
did
;

71 
sk_to
(
X­Ÿn
::
docid
 
to_did
, X­Ÿn::
weight
 
wt
) {

72 ()
wt
;

73 
	gdid
 = 
to_did
;

74 ià(
	gdid
 % 2 =ğ0è++
did
;

77 
boŞ
 
	$©_’d
() const {

79  
did
 > 
Ï¡_docid
;

80 
	}
}

82 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
did
; 
	}
}

84 
¡ršg
 
	$g‘_desütiÚ
(ècÚ¡ {  "MyOddPo¡šgSourû"; 
	}
}

87 
DEFINE_TESTCASE
(
ex‹º®sourû1
, 
back’d
 && !
»mÙe
 && !
muÉi
) {

91 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_phrase"));

92 
	gX­Ÿn
::
Enquœe
 
’q
(
db
);

93 
MyOddPo¡šgSourû
 
¤c
(
db
);

96 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, X­Ÿn::
Qu”y
 
bad
(
NULL
));

97 
	gX­Ÿn
::
Po¡šgSourû
 * 
nuÎ¤c
 = 
NULL
;

98 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, X­Ÿn::
Qu”y
 
bad
(
nuÎ¤c
));

100 
	g’q
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(&
¤c
));

102 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 10);

103 
m£t_ex³ù_Üd”
(
m£t
, 1, 3, 5, 7, 9, 11, 13, 15, 17);

105 
	gX­Ÿn
::
Qu”y
 
q
(
X­Ÿn
::Qu”y::
OP_FILTER
,

106 
X­Ÿn
::
Qu”y
("leav"),

107 
X­Ÿn
::
Qu”y
(&
¤c
));

108 
	g’q
.
£t_qu”y
(
q
);

110 
	gm£t
 = 
’q
.
g‘_m£t
(0, 10);

111 
m£t_ex³ù_Üd”
(
m£t
, 5, 7, 11, 13, 9);

113  
	gŒue
;

119 
	$DEFINE_TESTCASE
(
ex‹º®sourû2
, 
»mÙe
) {

120 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

121 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

122 
MyOddPo¡šgSourû
 
	`¤c
(
db
);

124 
’q
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(&
¤c
));

126 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

127 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 10));

129 
X­Ÿn
::
Qu”y
 
	`q
(X­Ÿn::Qu”y::
OP_FILTER
,

130 
X­Ÿn
::
	`Qu”y
("leav"),

131 
X­Ÿn
::
	`Qu”y
(&
¤c
));

132 
’q
.
	`£t_qu”y
(
q
);

134 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

135 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 10));

137  
Œue
;

138 
	}
}

140 şas 
	cMyOddWeightšgPo¡šgSourû
 : 
public
 
X­Ÿn
::
Po¡šgSourû
 {

141 
X­Ÿn
::
doccouÁ
 
num_docs
;

143 
	mX­Ÿn
::
doccouÁ
 
Ï¡_docid
;

145 
	mX­Ÿn
::
docid
 
did
;

147 
MyOddWeightšgPo¡šgSourû
(
X­Ÿn
::
doccouÁ
 
num_docs_
,

148 
X­Ÿn
::
doccouÁ
 
Ï¡_docid_
)

149 : 
num_docs
(
num_docs_
), 
Ï¡_docid
(
Ï¡_docid_
), 
	$did
(0)

151 
	`£t_maxweight
(1000);

154 
public
:

155 
	`MyOddWeightšgPo¡šgSourû
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db
)

156 : 
	`num_docs
(
db
.
	`g‘_doccouÁ
()), 
	`Ï¡_docid
(db.
	`g‘_Ï¡docid
()), 
	$did
(0)

157 { 
	}
}

159 
Po¡šgSourû
 * 
	$şÚe
() const {

160  
Ãw
 
	`MyOddWeightšgPo¡šgSourû
(
num_docs
, 
Ï¡_docid
);

161 
	}
}

163 
š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 &è{ 
did
 = 0; }

165 
	gX­Ÿn
::
weight
 
	$g‘_weight
() const {

166  (
did
 % 2) ? 1000 : 0.001;

167 
	}
}

170 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
(ècÚ¡ {  0; 
	}
}

172 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
(ècÚ¡ {  
num_docs
 / 2; 
	}
}

174 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
(ècÚ¡ {  
num_docs
; 
	}
}

176 
Ãxt
(
X­Ÿn
::
weight
 
wt
) {

177 ()
wt
;

178 ++
	gdid
;

181 
sk_to
(
X­Ÿn
::
docid
 
to_did
, X­Ÿn::
weight
 
wt
) {

182 ()
wt
;

183 
	gdid
 = 
to_did
;

186 
boŞ
 
	$©_’d
() const {

188  
did
 > 
Ï¡_docid
;

189 
	}
}

191 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
did
; 
	}
}

193 
¡ršg
 
	$g‘_desütiÚ
() const {

195 
	}
}

199 
DEFINE_TESTCASE
(
ex‹º®sourû3
, 
back’d
 && !
»mÙe
 && !
muÉi
) {

203 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_phrase"));

204 
	gX­Ÿn
::
Enquœe
 
’q
(
db
);

205 
MyOddWeightšgPo¡šgSourû
 
¤c
(
db
);

207 
	g’q
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(&
¤c
));

209 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 10);

210 
m£t_ex³ù_Üd”
(
m£t
, 1, 3, 5, 7, 9, 11, 13, 15, 17, 2);

212 
	gX­Ÿn
::
Qu”y
 
q
(
X­Ÿn
::Qu”y::
OP_OR
,

213 
X­Ÿn
::
Qu”y
("leav"),

214 
X­Ÿn
::
Qu”y
(&
¤c
));

215 
	g’q
.
£t_qu”y
(
q
);

217 
	gm£t
 = 
’q
.
g‘_m£t
(0, 5);

218 
m£t_ex³ù_Üd”
(
m£t
, 5, 7, 11, 13, 9);

220 
	gtout
 << "max…ossibË weighˆğ" << 
	gm£t
.
g‘_max_possibË
(è<< 
	g’dl
;

221 
TEST
(
m£t
.
g‘_max_possibË
() > 1000);

223 
	g’q
.
£t_cutoff
(0, 1000.001);

224 
	gm£t
 = 
’q
.
g‘_m£t
(0, 10);

225 
m£t_ex³ù_Üd”
(
m£t
, 5, 7, 11, 13, 9);

227 
	gtout
 << "max…ossibË weighˆğ" << 
	gm£t
.
g‘_max_possibË
(è<< 
	g’dl
;

228 
TEST
(
m£t
.
g‘_max_possibË
() > 1000);

230 
	g’q
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(
q
.
OP_SCALE_WEIGHT
, X­Ÿn::Qu”y(&
¤c
), 0.5));

231 
	gm£t
 = 
’q
.
g‘_m£t
(0, 10);

232 
TEST
(
m£t
.
em±y
());

234 
TEST_EQUAL
(
m£t
.
g‘_max_possibË
(), 500);

236 
	g’q
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(
q
.
OP_SCALE_WEIGHT
, X­Ÿn::Qu”y(&
¤c
), 2));

237 
	gm£t
 = 
’q
.
g‘_m£t
(0, 10);

238 
m£t_ex³ù_Üd”
(
m£t
, 1, 3, 5, 7, 9, 11, 13, 15, 17);

240 
TEST_EQUAL
(
m£t
.
g‘_max_possibË
(), 2000);

242  
	gŒue
;

245 şas 
	cMyDÚtAskWeightPo¡šgSourû
 : 
public
 
X­Ÿn
::
Po¡šgSourû
 {

246 
X­Ÿn
::
doccouÁ
 
num_docs
;

248 
	mX­Ÿn
::
doccouÁ
 
Ï¡_docid
;

250 
	mX­Ÿn
::
docid
 
did
;

252 
MyDÚtAskWeightPo¡šgSourû
(
X­Ÿn
::
doccouÁ
 
num_docs_
,

253 
X­Ÿn
::
doccouÁ
 
Ï¡_docid_
)

254 : 
num_docs
(
num_docs_
), 
Ï¡_docid
(
Ï¡_docid_
), 
	$did
(0)

257 
public
:

258 
	$MyDÚtAskWeightPo¡šgSourû
(è: 
X­Ÿn
::
	$Po¡šgSourû
(è{
	}
}

260 
Po¡šgSourû
 * 
	$şÚe
(ècÚ¡ {  
Ãw
 
	`MyDÚtAskWeightPo¡šgSourû
(
num_docs
, 
Ï¡_docid
); 
	}
}

262 
š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db
) {

263 
num_docs
 = 
db
.
g‘_doccouÁ
();

264 
	gÏ¡_docid
 = 
db
.
g‘_Ï¡docid
();

265 
	gdid
 = 0;

268 
	gX­Ÿn
::
weight
 
	$g‘_weight
() const {

269 
	`FAIL_TEST
("MyDontAskWeightPostingSource::get_weight() called");

270 
	}
}

273 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
(ècÚ¡ {  
num_docs
; 
	}
}

275 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
(ècÚ¡ {  
num_docs
; 
	}
}

277 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
(ècÚ¡ {  
num_docs
; 
	}
}

279 
Ãxt
(
X­Ÿn
::
weight
 
wt
) {

280 ()
wt
;

281 ++
	gdid
;

284 
sk_to
(
X­Ÿn
::
docid
 
to_did
, X­Ÿn::
weight
 
wt
) {

285 ()
wt
;

286 
	gdid
 = 
to_did
;

289 
boŞ
 
	$©_’d
() const {

291  
did
 > 
Ï¡_docid
;

292 
	}
}

294 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
did
; 
	}
}

296 
¡ršg
 
	$g‘_desütiÚ
() const {

298 
	}
}

302 
DEFINE_TESTCASE
(
ex‹º®sourû4
, 
back’d
 && !
»mÙe
) {

303 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_phrase"));

304 
	gX­Ÿn
::
Enquœe
 
’q
(
db
);

305 
MyDÚtAskWeightPo¡šgSourû
 
	g¤c
;

307 
	gtout
 << "OP_SCALE_WEIGHT 0" << 
	g’dl
;

308 
	g’q
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_SCALE_WEIGHT
, X­Ÿn::Qu”y(&
¤c
), 0));

310 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 5);

311 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5);

313 
	gtout
 << "OP_FILTER" << 
	g’dl
;

314 
	gX­Ÿn
::
Qu”y
 
q
(
X­Ÿn
::Qu”y::
OP_FILTER
,

315 
X­Ÿn
::
Qu”y
("leav"),

316 
X­Ÿn
::
Qu”y
(&
¤c
));

317 
	g’q
.
£t_qu”y
(
q
);

319 
	gm£t
 = 
’q
.
g‘_m£t
(0, 5);

320 
m£t_ex³ù_Üd”
(
m£t
, 8, 6, 4, 5, 7);

322 
	gtout
 << "BoŞWeight" << 
	g’dl
;

323 
	g’q
.
£t_qu”y
(
X­Ÿn
::
Qu”y
(&
¤c
));

324 
	g’q
.
£t_weightšg_scheme
(
X­Ÿn
::
BoŞWeight
());

329  
	gŒue
;

333 
	$DEFINE_TESTCASE
(
v®ueweightsourû1
, 
back’d
) {

334 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

335 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

336 
X­Ÿn
::
V®ueWeightPo¡šgSourû
 
	`¤c
(11);

339 
tout
 << "RAW" << 
’dl
;

340 
’q
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(&
¤c
));

341 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 5);

342 
	`m£t_ex³ù_Üd”
(
m£t
, 3, 1, 2, 8, 14);

345 
tout
 << "OP_FILTER" << 
’dl
;

346 
X­Ÿn
::
Qu”y
 
	`q
(X­Ÿn::Qu”y::
OP_FILTER
,

347 
X­Ÿn
::
	`Qu”y
("leav"),

348 
X­Ÿn
::
	`Qu”y
(&
¤c
));

349 
’q
.
	`£t_qu”y
(
q
);

350 
m£t
 = 
’q
.
	`g‘_m£t
(0, 5);

351 
	`m£t_ex³ù_Üd”
(
m£t
, 8, 6, 4, 5, 7);

354 
tout
 << "OP_FILTER oth” way" << 
’dl
;

355 
q
 = 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_FILTER
,

356 
X­Ÿn
::
	`Qu”y
(&
¤c
),

357 
X­Ÿn
::
	`Qu”y
("leav"));

358 
’q
.
	`£t_qu”y
(
q
);

359 
m£t
 = 
’q
.
	`g‘_m£t
(0, 5);

360 
	`m£t_ex³ù_Üd”
(
m£t
, 8, 14, 9, 13, 7);

362  
Œue
;

363 
	}
}

367 
	$DEFINE_TESTCASE
(
v®ueweightsourû2
, 
v®ue¡©s
) {

368 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

369 
X­Ÿn
::
V®ueWeightPo¡šgSourû
 
	`¤c
(11);

370 
¤c
.
	`š™
(
db
);

371 
	`TEST_EQUAL
(
¤c
.
	`g‘_‹rmäeq_mš
(), 17);

372 
	`TEST_EQUAL
(
¤c
.
	`g‘_‹rmäeq_e¡
(), 17);

373 
	`TEST_EQUAL
(
¤c
.
	`g‘_‹rmäeq_max
(), 17);

374 
	`TEST_EQUAL
(
¤c
.
	`g‘_maxweight
(), 135);

376  
Œue
;

377 
	}
}

380 
DEFINE_TESTCASE
(
v®ueweightsourû3
, 
v®ue¡©s
 && !
muÉi
) {

382 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_phrase"));

383 
	gX­Ÿn
::
V®ueWeightPo¡šgSourû
 
¤c
(11);

384 
	g¤c
.
š™
(
db
);

385 
TEST
(!
¤c
.
©_’d
());

386 
	g¤c
.
sk_to
(8, 0.0);

387 
TEST
(!
¤c
.
©_’d
());

388 
TEST_EQUAL
(
¤c
.
g‘_docid
(), 8);

389 
	g¤c
.
sk_to
(8, 0.0);

390 
TEST
(!
¤c
.
©_’d
());

391 
TEST_EQUAL
(
¤c
.
g‘_docid
(), 8);

393  
	gŒue
;

397 
	$DEFINE_TESTCASE
(
fixedweightsourû1
, 
back’d
) {

398 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

399 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

400 
wt
 = 5.6;

403 
X­Ÿn
::
FixedWeightPo¡šgSourû
 
	`¤c
(
wt
);

406 
’q
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(&
¤c
));

407 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 5);

408 
	`m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5);

410 
X­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t
.
	`begš
(); i !ğm£t.
	`’d
(); ++i) {

411 
	`TEST_EQUAL
(
i
.
	`g‘_weight
(), 
wt
);

418 
X­Ÿn
::
FixedWeightPo¡šgSourû
 
	`¤c
(
wt
);

419 
¤c
.
	`š™
(
db
);

421 
¤c
.
	`Ãxt
(1.0);

422 
	`TEST
(!
¤c
.
	`©_’d
());

423 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

424 
¤c
.
	`Ãxt
(1.0);

425 
	`TEST
(!
¤c
.
	`©_’d
());

426 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

427 
¤c
.
	`sk_to
(5, 1.0);

428 
	`TEST
(!
¤c
.
	`©_’d
());

429 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 5);

430 
¤c
.
	`Ãxt
(
wt
 * 2);

431 
	`TEST
(
¤c
.
	`©_’d
());

435 
X­Ÿn
::
FixedWeightPo¡šgSourû
 
	`¤c
(
wt
);

436 
¤c
.
	`š™
(
db
);

438 
	`TEST_EQUAL
(
¤c
.
	`check
(5, 1.0), 
Œue
);

439 
	`TEST
(!
¤c
.
	`©_’d
());

440 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 5);

441 
¤c
.
	`Ãxt
(1.0);

442 
	`TEST
(!
¤c
.
	`©_’d
());

443 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 6);

447 
X­Ÿn
::
FixedWeightPo¡šgSourû
 
	`¤c
(
wt
);

448 
¤c
.
	`š™
(
db
);

450 
	`TEST_EQUAL
(
¤c
.
	`check
(5, 1.0), 
Œue
);

451 
	`TEST
(!
¤c
.
	`©_’d
());

452 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 5);

453 
¤c
.
	`sk_to
(6, 1.0);

454 
	`TEST
(!
¤c
.
	`©_’d
());

455 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 6);

456 
¤c
.
	`sk_to
(7, 
wt
 * 2);

457 
	`TEST
(
¤c
.
	`©_’d
());

460  
Œue
;

461 
	}
}

464 şas 
	cChªgeMaxweightPo¡šgSourû
 : 
public
 
X­Ÿn
::
Po¡šgSourû
 {

465 
X­Ÿn
::
docid
 
did
;

468 
	mX­Ÿn
::
docid
 
maxid_acûs£d
;

470 
	mpublic
:

471 
ChªgeMaxweightPo¡šgSourû
(
X­Ÿn
::
docid
 
maxid_acûs£d_
)

472 : 
did
(0), 
	$maxid_acûs£d
(
maxid_acûs£d_
) { }

474 
	`š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 &è{ 
did
 = 0; 
	}
}

476 
	gX­Ÿn
::
weight
 
	$g‘_weight
() const {

477 ià(
did
 > 
maxid_acûs£d
) {

478 
	`FAIL_TEST
("ChangeMaxweightPostingSource::get_weight() called "

479 "fÜ docid " + 
	`om_to¡ršg
(
did
) + ", max id‡ccessed "

480 "should b" + 
	`om_to¡ršg
(
maxid_acûs£d
));

482  5 - 
did
;

483 
	}
}

485 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
(ècÚ¡ {  4; 
	}
}

486 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
(ècÚ¡ {  4; 
	}
}

487 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
(ècÚ¡ {  4; 
	}
}

489 
Ãxt
(
X­Ÿn
::
weight
) {

490 ++
did
;

491 
£t_maxweight
(5 - 
did
);

494 
sk_to
(
X­Ÿn
::
docid
 
to_did
, X­Ÿn::
weight
) {

495 
did
 = 
to_did
;

496 
£t_maxweight
(5 - 
did
);

499 
boŞ
 
	$©_’d
(ècÚ¡ {  
did
 >ğ5; 
	}
}

500 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  
did
; 
	}
}

501 
¡ršg
 
	$g‘_desütiÚ
(ècÚ¡ {  "ChªgeMaxweightPo¡šgSourû"; 
	}
}

505 
DEFINE_TESTCASE
(
chªgemaxweightsourû1
, 
back’d
 && !
»mÙe
 && !
muÉi
) {

507 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_phrase"));

508 
	gX­Ÿn
::
Enquœe
 
’q
(
db
);

511 
ChªgeMaxweightPo¡šgSourû
 
¤c1
(5);

512 
	gX­Ÿn
::
FixedWeightPo¡šgSourû
 
¤c2
(2.5);

514 
	gX­Ÿn
::
Qu”y
 
q
(
X­Ÿn
::Qu”y::
OP_AND
,

515 
X­Ÿn
::
Qu”y
(&
¤c1
), X­Ÿn::Qu”y(&
¤c2
));

516 
	g’q
.
£t_qu”y
(
q
);

519 
	g’q
.
£t_docid_Üd”
(
’q
.
DESCENDING
);

521 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 4);

522 
TEST
(
¤c1
.
©_’d
());

523 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4);

524 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t
.
begš
(); 
	gi
 !ğm£t.
’d
(); ++i) {

525 
TEST_EQUAL_DOUBLE
(
i
.
g‘_weight
(), 7.5 - *i);

530 
ChªgeMaxweightPo¡šgSourû
 
¤c1
(3);

531 
	gX­Ÿn
::
FixedWeightPo¡šgSourû
 
¤c2
(2.5);

533 
	gX­Ÿn
::
Qu”y
 
q
(
X­Ÿn
::Qu”y::
OP_AND
,

534 
X­Ÿn
::
Qu”y
(&
¤c1
), X­Ÿn::Qu”y(&
¤c2
));

535 
	g’q
.
£t_qu”y
(
q
);

537 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 2);

538 
TEST
(!
¤c1
.
©_’d
());

539 
TEST_EQUAL
(
¤c1
.
g‘_docid
(), 3);

540 
TEST_EQUAL_DOUBLE
(
¤c1
.
g‘_maxweight
(), 2.0);

541 
m£t_ex³ù_Üd”
(
m£t
, 1, 2);

542 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t
.
begš
(); 
	gi
 !ğm£t.
’d
(); ++i) {

543 
TEST_EQUAL_DOUBLE
(
i
.
g‘_weight
(), 7.5 - *i);

547  
	gŒue
;

551 
DEFINE_TESTCASE
(
em±yv®wtsourû1
, 
back’d
 && !
»mÙe
 && !
muÉi
) {

552 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_phrase"));

553 
	gX­Ÿn
::
Enquœe
 
’q
(
db
);

555 
	gX­Ÿn
::
V®ueWeightPo¡šgSourû
 
¤c2
(11);

556 
	gX­Ÿn
::
V®ueWeightPo¡šgSourû
 
¤c3
(100);

557 
	gX­Ÿn
::
Qu”y
 
q1
("leav");

558 
	gX­Ÿn
::
Qu”y
 
q2
(&
¤c2
);

559 
	gX­Ÿn
::
Qu”y
 
q3
(&
¤c3
);

560 
	gX­Ÿn
::
Qu”y
 
q
(
X­Ÿn
::Qu”y::
OP_OR
, X­Ÿn::Qu”y(X­Ÿn::Qu”y::
OP_AND_MAYBE
, 
q1
, 
q2
), 
q3
);

563 
	gX­Ÿn
::
doccouÁ
 
size1
;

565 
	g’q
.
£t_qu”y
(
q1
);

566 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 10);

567 
TEST_REL
(
m£t
.
g‘_max_possibË
(), >, 0.0);

568 
	gsize1
 = 
m£t
.
size
();

569 
TEST_REL
(
size1
, >, 0);

575 
	g’q
.
£t_qu”y
(
q2
);

576 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 10);

577 
TEST_REL
(
m£t
.
g‘_max_possibË
(), >, 0.0);

578 
TEST_REL
(
m£t
.
size
(), >, 0);

584 
	g’q
.
£t_qu”y
(
q3
);

585 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 10);

590 
TEST_REL
(
m£t
.
g‘_max_possibË
(), >=, 0.0);

592 
TEST_EQUAL
(
m£t
.
size
(), 0);

598 
	g’q
.
£t_qu”y
(
q
);

599 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’q
.
g‘_m£t
(0, 10);

600 
TEST_REL
(
m£t
.
g‘_max_possibË
(), >, 0.0);

601 
TEST_REL
(
m£t
.
size
(), >, 0.0);

602 
TEST_EQUAL
(
m£t
.
size
(), 
size1
);

605  
	gŒue
;

	@tests/api_postingsource.h

2 
boŞ
 
‹¡_ex‹º®sourû1
();

3 
boŞ
 
‹¡_ex‹º®sourû2
();

4 
boŞ
 
‹¡_ex‹º®sourû3
();

5 
boŞ
 
‹¡_ex‹º®sourû4
();

6 
boŞ
 
‹¡_v®ueweightsourû1
();

7 
boŞ
 
‹¡_v®ueweightsourû2
();

8 
boŞ
 
‹¡_v®ueweightsourû3
();

9 
boŞ
 
‹¡_fixedweightsourû1
();

10 
boŞ
 
‹¡_chªgemaxweightsourû1
();

11 
boŞ
 
‹¡_em±yv®wtsourû1
();

	@tests/api_qpbackend.cc

22 
	~<cÚfig.h
>

24 
	~"­i_qpback’d.h
"

26 
	~<x­Ÿn.h
>

28 
	~"back’dmªag”.h
"

29 
	~"‹¡su™e.h
"

30 
	~"‹¡uts.h
"

32 
	~"­™e¡.h
"

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	s‹¡
 {

37 cÚ¡ *
	mqu”y
;

38 cÚ¡ *
	mex³ù
;

42 
	$DEFINE_TESTCASE
(
qpsynÚym·¹Ÿl1
, 
synÚyms
) {

43 cÚ¡ 
‹¡
 
‹¡_qu”›s
[] = {

49 { 
NULL
, NULL }

51 cÚ¡ 
‹¡
 
‹¡_qu”›s_auto
[] = {

57 { 
NULL
, NULL }

59 cÚ¡ 
‹¡
 
‹¡_qu”›s_·¹Ÿl_auto
[] = {

65 { 
NULL
, NULL }

68 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
());

69 
db
.
	`add_synÚym
("hello", "hi");

70 
db
.
	`add_synÚym
("hello", "howdy");

71 
db
.
	`comm™
();

73 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

74 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

75 
X­Ÿn
::
S‹m
 
	`¡emmm”
("english");

76 
qp
.
	`£t_d©aba£
(
db
);

77 
qp
.
	`add_´efix
("foo", "XFOO");

79 cÚ¡ 
‹¡
 *
p
;

80 
p
 = 
‹¡_qu”›s
;…->
qu”y
; ++p) {

81 
¡ršg
 
ex³ù
, 
·r£d
;

82 ià(
p
->
ex³ù
)

83 
ex³ù
 = 
p
->expect;

85 
ex³ù
 = "parseƒrror";

86 
Œy
 {

87 
f
 = 
qp
.
FLAG_SYNONYM
 | qp.
FLAG_PARTIAL
 | qp.
FLAG_DEFAULT
;

88 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
, 
f
);

89 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

90 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

91 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

92 
·r£d
 = 
e
.
	`g‘_msg
();

93 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

94 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

95 } 
	`ÿtch
 (...) {

96 
·r£d
 = "Unknownƒxception!";

98 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

99 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

102 
p
 = 
‹¡_qu”›s_auto
;…->
qu”y
; ++p) {

103 
¡ršg
 
ex³ù
, 
·r£d
;

104 ià(
p
->
ex³ù
)

105 
ex³ù
 = 
p
->expect;

107 
ex³ù
 = "parseƒrror";

108 
Œy
 {

109 
f
 = 
qp
.
FLAG_AUTO_SYNONYMS
 | qp.
FLAG_DEFAULT
;

110 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
, 
f
);

111 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

112 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

113 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

114 
·r£d
 = 
e
.
	`g‘_msg
();

115 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

116 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

117 } 
	`ÿtch
 (...) {

118 
·r£d
 = "Unknownƒxception!";

120 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

121 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

124 
p
 = 
‹¡_qu”›s_·¹Ÿl_auto
;…->
qu”y
; ++p) {

125 
¡ršg
 
ex³ù
, 
·r£d
;

126 ià(
p
->
ex³ù
)

127 
ex³ù
 = 
p
->expect;

129 
ex³ù
 = "parseƒrror";

130 
Œy
 {

131 
f
 = 
qp
.
FLAG_AUTO_SYNONYMS
 | qp.
FLAG_PARTIAL
;

132 
f
 |ğ
qp
.
FLAG_DEFAULT
;

133 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
, 
f
);

134 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

135 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

136 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

137 
·r£d
 = 
e
.
	`g‘_msg
();

138 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

139 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

140 } 
	`ÿtch
 (...) {

141 
·r£d
 = "Unknownƒxception!";

143 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

144 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

147  
Œue
;

148 
	}
}

	@tests/api_qpbackend.h

2 
boŞ
 
‹¡_qpsynÚym·¹Ÿl1
();

	@tests/api_query.cc

22 
	~<cÚfig.h
>

24 
	~"­i_qu”y.h
"

26 
	~<x­Ÿn.h
>

28 
	~"‹¡su™e.h
"

29 
	~"‹¡uts.h
"

30 
	~"uts.h
"

32 
	~"­™e¡.h
"

34 
usšg
 
Çme¥aû
 
	g¡d
;

37 
DEFINE_TESTCASE
(
qu”y‹rms1
, !
back’d
) {

38 
	gX­Ÿn
::
Qu”y
 
qu”y
 = 
X­Ÿn
::Qu”y::
M©chAÎ
;

39 
TEST
(
qu”y
.
g‘_‹rms_begš
(è=ğqu”y.
g‘_‹rms_’d
());

40 
	gqu”y
 = 
X­Ÿn
::
Qu”y
(
qu”y
.
OP_AND_NOT
, query, Xapian::Query("fair"));

41 
TEST_EQUAL
(*
qu”y
.
g‘_‹rms_begš
(), "fair");

42  
	gŒue
;

45 
DEFINE_TESTCASE
(
m©chnÙhšg1
, !
back’d
) {

46 
	gveùÜ
<
	gX­Ÿn
::
Qu”y
> 
subqs
;

47 
	gsubqs
.
push_back
(
X­Ÿn
::
Qu”y
("foo"));

48 
	gsubqs
.
push_back
(
X­Ÿn
::
Qu”y
::
M©chNÙhšg
);

49 
	gX­Ÿn
::
Qu”y
 
q
(
X­Ÿn
::Qu”y::
OP_AND
, 
subqs
.
begš
(), subqs.
’d
());

50 
TEST_STRINGS_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query()");

52 
	gX­Ÿn
::
Qu”y
 
q2
(
X­Ÿn
::Qu”y::
OP_AND
,

53 
X­Ÿn
::
Qu”y
("foo"), X­Ÿn::Qu”y::
M©chNÙhšg
);

54 
TEST_STRINGS_EQUAL
(
q2
.
g‘_desütiÚ
(), "Xapian::Query()");

55  
	gŒue
;

66 
DEFINE_TESTCASE
(
Ã¬subqu”›s1
, !
back’d
) {

67 
	gX­Ÿn
::
Qu”y
 
a_Ü_b
(
X­Ÿn
::Qu”y::
OP_OR
,

68 
X­Ÿn
::
Qu”y
("a"),

69 
X­Ÿn
::
Qu”y
("b"));

70 
	gX­Ÿn
::
Qu”y
 
Ã¬
(
X­Ÿn
::Qu”y::
OP_NEAR
, 
a_Ü_b
,‡_or_b);

71 
TEST_STRINGS_EQUAL
(
Ã¬
.
g‘_desütiÚ
(),

74 
	gX­Ÿn
::
Qu”y
 
a_Ã¬_b
(
X­Ÿn
::Qu”y::
OP_NEAR
,

75 
X­Ÿn
::
Qu”y
("a"),

76 
X­Ÿn
::
Qu”y
("b"));

77 
	gX­Ÿn
::
Qu”y
 
x_phrs_y
(
X­Ÿn
::Qu”y::
OP_PHRASE
,

78 
X­Ÿn
::
Qu”y
("a"),

79 
X­Ÿn
::
Qu”y
("b"));

81 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

82 
X­Ÿn
::
Qu”y
 
q
(X­Ÿn::Qu”y::
OP_NEAR
,

83 
a_Ã¬_b
,

84 
X­Ÿn
::
Qu”y
("c"))

87 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

88 
X­Ÿn
::
Qu”y
 
q
(X­Ÿn::Qu”y::
OP_NEAR
,

89 
x_phrs_y
,

90 
X­Ÿn
::
Qu”y
("c"))

93 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

94 
X­Ÿn
::
Qu”y
 
q
(X­Ÿn::Qu”y::
OP_PHRASE
,

95 
a_Ã¬_b
,

96 
X­Ÿn
::
Qu”y
("c"))

99 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

100 
X­Ÿn
::
Qu”y
 
q
(X­Ÿn::Qu”y::
OP_PHRASE
,

101 
x_phrs_y
,

102 
X­Ÿn
::
Qu”y
("c"))

105  
	gŒue
;

	@tests/api_query.h

2 
boŞ
 
‹¡_qu”y‹rms1
();

3 
boŞ
 
‹¡_m©chnÙhšg1
();

4 
boŞ
 
‹¡_Ã¬subqu”›s1
();

	@tests/api_replacedoc.cc

21 
	~<cÚfig.h
>

23 
	~"­i_»¶aûdoc.h
"

25 
	~<¡ršg
>

26 
	~<m­
>

28 
usšg
 
Çme¥aû
 
	g¡d
;

30 
	~<x­Ÿn.h
>

31 
	~"‹¡su™e.h
"

32 
	~"‹¡uts.h
"

34 
	~"­™e¡.h
"

35 
	~"dbcheck.h
"

38 
	$DEFINE_TESTCASE
(
po¦i¡upd©e1
, 
pos™iÚ®
 && 
wr™abË
) {

39 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

41 
X­Ÿn
::
Docum’t
 
doc
;

42 
doc
.
	`add_po¡šg
("pos", 2);

43 
doc
.
	`add_po¡šg
("pos", 3);

44 
db
.
	`add_docum’t
(
doc
);

45 
db
.
	`æush
();

47 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "Term(pos, wdf=2,…os=[2, 3])");

49 
doc
 = 
db
.
	`g‘_docum’t
(1);

50 
doc
.
	`add_‹rm
("pos2");

51 
db
.
	`»¶aû_docum’t
(1, 
doc
);

52 
db
.
	`æush
();

53 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1),

57 
doc
 = 
db
.
	`g‘_docum’t
(1);

58 
doc
.
	`add_po¡šg
("pos3", 1);

59 
doc
.
	`add_po¡šg
("pos3", 5);

60 
db
.
	`»¶aû_docum’t
(1, 
doc
);

61 
db
.
	`æush
();

62 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1),

67 
doc
 = 
db
.
	`g‘_docum’t
(1);

68 
doc
.
	`»move_‹rm
("pos");

69 
db
.
	`»¶aû_docum’t
(1, 
doc
);

70 
db
.
	`æush
();

71 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1),

77 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	`pos™
(
db
.
	`pos™iÚli¡_begš
(1, "pos"));

78 
	`TEST
(
pos™
 =ğ
db
.
	`pos™iÚli¡_’d
(1, "pos"));

80 
doc
 = 
db
.
	`g‘_docum’t
(1);

81 
doc
.
	`»move_‹rm
("pos3");

82 
db
.
	`»¶aû_docum’t
(1, 
doc
);

83 
db
.
	`æush
();

84 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1),

89 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	`pos™2
(
db
.
	`pos™iÚli¡_begš
(1, "pos3"));

90 
	`TEST
(
pos™2
 =ğ
db
.
	`pos™iÚli¡_’d
(1, "pos3"));

92 
doc
 = 
db
.
	`g‘_docum’t
(1);

93 
doc
.
	`add_‹rm
("pos");

94 
db
.
	`»¶aû_docum’t
(1, 
doc
);

95 
db
.
	`æush
();

96 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1),

100  
Œue
;

101 
	}
}

103 
	gX­Ÿn
::
Docum’t


104 
	$basic_doc
() {

105 
X­Ÿn
::
Docum’t
 
doc
;

106 
doc
.
	`add_‹rm
("z0", 0);

107 
doc
.
	`add_‹rm
("z1", 1);

108  
doc
;

109 
	}
}

111 
¡ršg


112 
	$basic_doù”ms
() {

114 
	}
}

118 
	$DEFINE_TESTCASE
(
mod‹rmwdf1
, 
wr™abË
) {

119 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
());

121 
¡ršg
 
	`bdt
(
	`basic_doù”ms
());

124 
X­Ÿn
::
Docum’t
 
	`doc1
(
	`basic_doc
());

125 
doc1
.
	`add_‹rm
("takeaway", 1);

126 
db
.
	`add_docum’t
(
doc1
);

128 
	`dbcheck
(
db
, 1, 1);

129 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=1)" + 
bdt
);

132 
X­Ÿn
::
Docum’t
 
	`doc2
(
	`basic_doc
());

133 
doc2
.
	`add_‹rm
("takeaway", 2);

134 
db
.
	`»¶aû_docum’t
(1, 
doc2
);

135 
	`dbcheck
(
db
, 1, 1);

136 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=2)" + 
bdt
);

139 
X­Ÿn
::
Docum’t
 
	`doc0
(
	`basic_doc
());

140 
db
.
	`»¶aû_docum’t
(1, 
doc0
);

141 
	`dbcheck
(
db
, 1, 1);

142 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), 
bdt
.
	`sub¡r
(2));

143 
db
.
	`»¶aû_docum’t
(1, 
doc1
);

144 
	`dbcheck
(
db
, 1, 1);

145 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=1)" + 
bdt
);

149 
db
.
	`»¶aû_docum’t
(1, 
doc0
);

150 
db
.
	`æush
();

151 
db
.
	`»¶aû_docum’t
(1, 
doc2
);

152 
db
.
	`»¶aû_docum’t
(1, 
doc0
);

153 
db
.
	`»¶aû_docum’t
(1, 
doc2
);

154 
db
.
	`æush
();

155 
	`dbcheck
(
db
, 1, 1);

156 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=2)" + 
bdt
);

159 
db
.
	`»¶aû_docum’t
(1, 
doc0
);

160 
db
.
	`»¶aû_docum’t
(1, 
doc2
);

161 
	`dbcheck
(
db
, 1, 1);

162 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=2)" + 
bdt
);

165 
db
.
	`»¶aû_docum’t
(1, 
doc1
);

166 
db
.
	`»¶aû_docum’t
(1, 
doc2
);

167 
	`dbcheck
(
db
, 1, 1);

168 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=2)" + 
bdt
);

171 
X­Ÿn
::
Docum’t
 
	`doc3
(
	`basic_doc
());

172 
doc3
.
	`add_‹rm
("takeaway", 3);

173 
db
.
	`»¶aû_docum’t
(1, 
doc3
);

174 
db
.
	`æush
();

175 
	`dbcheck
(
db
, 1, 1);

176 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=3)" + 
bdt
);

179 
X­Ÿn
::
Docum’t
 
	`doc3_diff
(
	`basic_doc
());

180 
doc3_diff
.
	`add_‹rm
("takeaways", 3);

181 
db
.
	`»¶aû_docum’t
(1, 
doc3_diff
);

182 
db
.
	`æush
();

183 
	`dbcheck
(
db
, 1, 1);

184 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—ways, wdf=3)" + 
bdt
);

187 
db
.
	`»¶aû_docum’t
(1, 
doc3
);

188 
	`dbcheck
(
db
, 1, 1);

189 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=3)" + 
bdt
);

192 
X­Ÿn
::
Docum’t
 
	`doc4
(
db
.
	`g‘_docum’t
(1));

193 
X­Ÿn
::
Docum’t
 
	`doc3a
(
db
.
	`g‘_docum’t
(1));

194 
doc3a
.
	`‹rmli¡_couÁ
();

195 
doc4
.
	`add_‹rm
("takeaway", 1);

196 
db
.
	`»¶aû_docum’t
(1, 
doc4
);

197 
	`dbcheck
(
db
, 1, 1);

198 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=4)" + 
bdt
);

201 
doc1
.
	`add_‹rm
("takeaway", 1);

202 
db
.
	`»¶aû_docum’t
(1, 
doc1
);

203 
	`dbcheck
(
db
, 1, 1);

204 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=2)" + 
bdt
);

207 
db
.
	`»¶aû_docum’t
(1, 
doc3a
);

208 
	`dbcheck
(
db
, 1, 1);

209 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=3)" + 
bdt
);

212 
X­Ÿn
::
Docum’t
 
	`doc5
(
db
.
	`g‘_docum’t
(1));

213 
doc5
.
	`add_po¡šg
("takeaway", 1, 2);

214 
db
.
	`»¶aû_docum’t
(1, 
doc5
);

215 
	`dbcheck
(
db
, 1, 1);

216 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=5,…os=[1])" + 
bdt
);

219 
X­Ÿn
::
Docum’t
 
	`doc5b
(
db
.
	`g‘_docum’t
(1));

220 
doc5b
.
	`add_po¡šg
("takeaway", 2, 0);

221 
db
.
	`»¶aû_docum’t
(1, 
doc5b
);

222 
	`dbcheck
(
db
, 1, 1);

223 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=5,…os=[1, 2])" + 
bdt
);

226 
X­Ÿn
::
Docum’t
 
	`doc5c
(
	`basic_doc
());

227 
doc5c
.
	`add_po¡šg
("takeaway", 2, 5);

228 
db
.
	`»¶aû_docum’t
(1, 
doc5c
);

229 
	`dbcheck
(
db
, 1, 1);

230 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=5,…os=[2])" + 
bdt
);

233 
X­Ÿn
::
Docum’t
 
	`doc5d
(
	`basic_doc
());

234 
doc5d
.
	`add_‹rm
("takeaway", 5);

235 
db
.
	`»¶aû_docum’t
(1, 
doc5d
);

236 
	`dbcheck
(
db
, 1, 1);

237 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=5)" + 
bdt
);

240 
X­Ÿn
::
Docum’t
 
	`doc0äeq
(
	`basic_doc
());

241 
doc0äeq
.
	`add_‹rm
("takeaway", 0);

242 
db
.
	`»¶aû_docum’t
(1, 
doc0äeq
);

243 
	`dbcheck
(
db
, 1, 1);

244 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), "T”mÑak—way, wdf=0)" + 
bdt
);

247 
db
.
	`»¶aû_docum’t
(1, 
doc0
);

248 
	`dbcheck
(
db
, 1, 1);

249 
	`TEST_EQUAL
(
	`doù”ms_to_¡ršg
(
db
, 1), 
bdt
.
	`sub¡r
(2));

252 
db
.
	`d–‘e_docum’t
(1);

253 
	`dbcheck
(
db
, 0, 1);

254 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
	`doù”ms_to_¡ršg
(
db
, 1));

255 
	`TEST_EQUAL
(
	`po¡li¡_to_¡ršg
(
db
, "takeaway"), "");

256 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
	`doc¡©s_to_¡ršg
(
db
, 1));

257 
	`TEST_EQUAL
(
	`‹rm¡©s_to_¡ršg
(
db
, "takeaway"), "tf=0,cf=0");

258 
	`TEST_EQUAL
(
	`db¡©s_to_¡ršg
(
db
), "dc=0,al=0,ld=1");

260  
Œue
;

261 
	}
}

	@tests/api_replacedoc.h

2 
boŞ
 
‹¡_po¦i¡upd©e1
();

3 
boŞ
 
‹¡_mod‹rmwdf1
();

	@tests/api_replicate.cc

22 
	~<cÚfig.h
>

24 
	~"­i_»¶iÿ‹.h
"

26 
	~<x­Ÿn.h
>

28 
	~"­™e¡.h
"

29 
	~"§ã”ºo.h
"

30 
	~"§ãfú.h
"

31 
	~"§ãsys¡©.h
"

32 
	~"‹¡su™e.h
"

33 
	~"‹¡uts.h
"

34 
	~"uts.h
"

35 
	~"unixcmds.h
"

37 
	~<c¡dlib
>

38 
	~<¡ršg
>

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
	$rmtmpdœ
(cÚ¡ 
¡ršg
 & 
·th
) {

43 
	`rm_rf
(
·th
);

44 
	}
}

46 
	$mktmpdœ
(cÚ¡ 
¡ršg
 & 
·th
) {

47 
	`rmtmpdœ
(
·th
);

48 ià(
	`mkdœ
(
·th
, 0700è=ğ-1 && 
”ºo
 !ğ
EEXIST
) {

49 
	`FAIL_TEST
("Can't makeemporary directory");

51 
	}
}

56 
»¶iÿ‹
(
X­Ÿn
::
D©aba£Ma¡”
 & 
ma¡”
,

57 
X­Ÿn
::
D©aba£R•liÿ
 &
»¶iÿ
,

58 cÚ¡ 
¡ršg
 & 
‹mpdœ
,

59 
ex³ùed_chªge£ts
,

60 
ex³ùed_fuÎcİ›s
,

61 
boŞ
 
ex³ùed_chªged
)

63 
¡ršg
 
	gchªge£©h
 = 
‹mpdœ
 + "/changeset";

64 
	gfd
 = 
İ’
(
chªge£©h
.
c_¡r
(), 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
, 0666);

65 ià(
	gfd
 == -1) {

66 
FAIL_TEST
("Open failed (when creating‡‚ew changeset file‡t '"

67 + 
chªge£©h
 + "')");

69 
	gX­Ÿn
::
R•liÿtiÚInfo
 
šfo1
;

70 
	gma¡”
.
wr™e_chªge£ts_to_fd
(
fd
, 
»¶iÿ
.
g‘_»visiÚ_šfo
(), &
šfo1
);

72 
TEST_EQUAL
(
šfo1
.
chªge£t_couÁ
, 
ex³ùed_chªge£ts
);

73 
TEST_EQUAL
(
šfo1
.
fuÎcİy_couÁ
, 
ex³ùed_fuÎcİ›s
);

74 
TEST_EQUAL
(
šfo1
.
chªged
, 
ex³ùed_chªged
);

76 
şo£
(
fd
);

78 
	gfd
 = 
İ’
(
chªge£©h
.
c_¡r
(), 
O_RDONLY
);

79 ià(
	gfd
 == -1) {

80 
FAIL_TEST
("Open failed (when„eading changeset file‡t '"

81 + 
chªge£©h
 + "')");

84 
	gcouÁ
 = 1;

85 
	g»¶iÿ
.
£t_»ad_fd
(
fd
);

86 
	gX­Ÿn
::
R•liÿtiÚInfo
 
šfo2
;

87 
boŞ
 
	gş›Á_chªged
 = 
çl£
;

88 
	g»¶iÿ
.
­¶y_Ãxt_chªge£t
(&
šfo2
)) {

89 ++
	gcouÁ
;

90 
	gšfo1
.
	gchªge£t_couÁ
 -ğ
šfo2
.
chªge£t_couÁ
;

91 
	gšfo1
.
	gfuÎcİy_couÁ
 -ğ
šfo2
.
fuÎcİy_couÁ
;

92 ià(
	gšfo2
.
	gchªged
)

93 
	gş›Á_chªged
 = 
Œue
;

95 
	gšfo1
.
	gchªge£t_couÁ
 -ğ
šfo2
.
chªge£t_couÁ
;

96 
	gšfo1
.
	gfuÎcİy_couÁ
 -ğ
šfo2
.
fuÎcİy_couÁ
;

97 ià(
	gšfo2
.
	gchªged
)

98 
	gş›Á_chªged
 = 
Œue
;

99 
şo£
(
fd
);

101 
TEST_EQUAL
(
šfo1
.
chªge£t_couÁ
, 0);

102 
TEST_EQUAL
(
šfo1
.
fuÎcİy_couÁ
, 0);

103 
TEST_EQUAL
(
šfo1
.
chªged
, 
ş›Á_chªged
);

104  
	gcouÁ
;

109 
	$check_equ®_dbs
(cÚ¡ 
¡ršg
 & 
·th1
, cÚ¡ sŒšg & 
·th2
)

111 
X­Ÿn
::
D©aba£
 
	`db1
(
·th1
);

112 
X­Ÿn
::
D©aba£
 
	`db2
(
·th2
);

114 
	`TEST_EQUAL
(
db1
.
	`g‘_doccouÁ
(), 
db2
.get_doccount());

115 
	}
}

121 
	$DEFINE_TESTCASE
(
»¶iÿ‹1
, 
»¶iÿs
) {

122 
¡ršg
 
‹mpdœ
 = ".replicatmp";

123 
	`mktmpdœ
(
‹mpdœ
);

124 
¡ršg
 
ma¡”·th
 = 
	`g‘_Çmed_wr™abË_d©aba£_·th
("master");

126 #ifdeà
__WIN32__


127 
	`_pu‹nv
("XAPIAN_MAX_CHANGESETS=10");

129 
	`£‹nv
("XAPIAN_MAX_CHANGESETS", "10", 1);

132 
X­Ÿn
::
Wr™abËD©aba£
 
	`Üig
(
	`g‘_Çmed_wr™abË_d©aba£
("master"));

133 
X­Ÿn
::
D©aba£Ma¡”
 
	`ma¡”
(
ma¡”·th
);

134 
¡ršg
 
»¶iÿ·th
 = 
‹mpdœ
 + "/replica";

135 
X­Ÿn
::
D©aba£R•liÿ
 
	`»¶iÿ
(
»¶iÿ·th
);

138 
X­Ÿn
::
Docum’t
 
doc1
;

139 
doc1
.
	`£t_d©a
(
	`¡ršg
("doc1"));

140 
doc1
.
	`add_po¡šg
("doc", 1);

141 
doc1
.
	`add_po¡šg
("one", 1);

142 
Üig
.
	`add_docum’t
(
doc1
);

143 
Üig
.
	`comm™
();

147 
couÁ
 = 
	`»¶iÿ‹
(
ma¡”
, 
»¶iÿ
, 
‹mpdœ
, 0, 1, 1);

148 
	`TEST_EQUAL
(
couÁ
, 1);

150 
X­Ÿn
::
D©aba£
 
	`dbcİy
(
»¶iÿ·th
);

151 
	`TEST_EQUAL
(
Üig
.
	`g‘_uuid
(), 
dbcİy
.get_uuid());

156 
couÁ
 = 
	`»¶iÿ‹
(
ma¡”
, 
»¶iÿ
, 
‹mpdœ
, 0, 0, 0);

157 
	`TEST_EQUAL
(
couÁ
, 1);

159 
X­Ÿn
::
D©aba£
 
	`dbcİy
(
»¶iÿ·th
);

160 
	`TEST_EQUAL
(
Üig
.
	`g‘_uuid
(), 
dbcİy
.get_uuid());

165 
»¶iÿ
.
	`şo£
();

166 
»¶iÿ
 = 
X­Ÿn
::
	`D©aba£R•liÿ
(
»¶iÿ·th
);

167 
couÁ
 = 
	`»¶iÿ‹
(
ma¡”
, 
»¶iÿ
, 
‹mpdœ
, 0, 0, 0);

168 
	`TEST_EQUAL
(
couÁ
, 1);

170 
X­Ÿn
::
D©aba£
 
	`dbcİy
(
»¶iÿ·th
);

171 
	`TEST_EQUAL
(
Üig
.
	`g‘_uuid
(), 
dbcİy
.get_uuid());

174 
Üig
.
	`add_docum’t
(
doc1
);

175 
Üig
.
	`comm™
();

176 
Üig
.
	`add_docum’t
(
doc1
);

177 
Üig
.
	`comm™
();

179 
couÁ
 = 
	`»¶iÿ‹
(
ma¡”
, 
»¶iÿ
, 
‹mpdœ
, 2, 0, 1);

180 
	`TEST_EQUAL
(
couÁ
, 3);

182 
X­Ÿn
::
D©aba£
 
	`dbcİy
(
»¶iÿ·th
);

183 
	`TEST_EQUAL
(
Üig
.
	`g‘_uuid
(), 
dbcİy
.get_uuid());

186 
	`check_equ®_dbs
(
ma¡”·th
, 
»¶iÿ·th
);

190 
»¶iÿ
.
	`şo£
();

191 
	`rmtmpdœ
(
‹mpdœ
);

192  
Œue
;

193 
	}
}

	@tests/api_replicate.h

2 
boŞ
 
‹¡_»¶iÿ‹1
();

	@tests/api_scalability.cc

22 
	~<cÚfig.h
>

24 
	~"­i_sÿÏb™y.h
"

26 
	~"­™e¡.h
"

27 
	~"ıutim”.h
"

28 
	~"sÿÏb™y.h
"

29 
	~"‹¡su™e.h
"

30 
	~"‹¡uts.h
"

32 
	~<x­Ÿn.h
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	$bigßddv®ue1_h–³r
(
num_v®ues
)

39 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

41 
X­Ÿn
::
Docum’t
 
doc
;

42 
i
 = 0; i < 
num_v®ues
; ++i) {

43 
doc
.
	`add_v®ue
(
i
, "moo");

46 
CPUTim”
 
tim”
;

48 
db
.
	`add_docum’t
(
doc
);

49 
db
.
	`comm™
();

51  
tim”
.
	`g‘_time
();

52 
	}
}

54 
	$DEFINE_TESTCASE
(
bigßddv®ue1
, 
wr™abË
) {

56 
	`‹¡_sÿÏb™y
(
bigßddv®ue1_h–³r
, 5000, 
O_N_LOG_N
);

57  
Œue
;

58 
	}
}

	@tests/api_scalability.h

2 
boŞ
 
‹¡_bigßddv®ue1
();

	@tests/api_serialise.cc

22 
	~<cÚfig.h
>

24 
	~"­i_£rŸli£.h
"

26 
	~<x­Ÿn.h
>

28 
	~<exû±iÚ
>

29 
	~<¡dexû±
>

31 
	~"­™e¡.h
"

32 
	~"‹¡uts.h
"

34 
usšg
 
Çme¥aû
 
	g¡d
;

37 
DEFINE_TESTCASE
(
£rŸli£_docum’t1
, !
back’d
) {

38 
	gX­Ÿn
::
Docum’t
 
doc
;

39 
	gdoc
.
add_‹rm
("foo", 2);

40 
	gdoc
.
add_po¡šg
("foo", 10);

41 
	gdoc
.
add_v®ue
(1, "bar");

42 
	gdoc
.
£t_d©a
("baz");

44 
	gX­Ÿn
::
Docum’t
 
doc2
 = 
X­Ÿn
::Docum’t::
un£rŸli£
(
doc
.
£rŸli£
());

46 
TEST_EQUAL
(
doc
.
‹rmli¡_couÁ
(), 
doc2
.termlist_count());

47 
TEST_EQUAL
(
doc
.
‹rmli¡_couÁ
(), 1);

48 
	gX­Ÿn
::
T”mI‹¿tÜ
 
i
;

49 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
j
;

50 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
k
;

52 
	gi
 = 
doc
.
‹rmli¡_begš
();

53 
TEST_NOT_EQUAL
(
i
, 
doc
.
‹rmli¡_’d
());

54 
TEST_EQUAL
(
i
.
g‘_wdf
(), 3);

55 
TEST_EQUAL
(*
i
, "foo");

56 
TEST_EQUAL
(
i
.
pos™iÚli¡_couÁ
(), 1);

57 
	gj
 = 
i
.
pos™iÚli¡_begš
();

58 
TEST_NOT_EQUAL
(
j
, 
i
.
pos™iÚli¡_’d
());

59 
TEST_EQUAL
(*
j
, 10);

60 ++
	gj
;

61 
TEST_EQUAL
(
j
, 
i
.
pos™iÚli¡_’d
());

62 ++
	gi
;

63 
TEST_EQUAL
(
i
, 
doc
.
‹rmli¡_’d
());

65 
TEST_EQUAL
(
doc
.
v®ues_couÁ
(), 1);

66 
	gk
 = 
doc
.
v®ues_begš
();

67 
TEST_NOT_EQUAL
(
k
, 
doc
.
v®ues_’d
());

68 
TEST_EQUAL
(
k
.
g‘_v®u’o
(), 1);

69 
TEST_EQUAL
(*
k
, "bar");

70 ++
	gk
;

71 
TEST_EQUAL
(
k
, 
doc
.
v®ues_’d
());

73 
TEST_EQUAL
(
doc
.
g‘_d©a
(), "baz");

75 
	gi
 = 
doc2
.
‹rmli¡_begš
();

76 
TEST_NOT_EQUAL
(
i
, 
doc2
.
‹rmli¡_’d
());

77 
TEST_EQUAL
(
i
.
g‘_wdf
(), 3);

78 
TEST_EQUAL
(*
i
, "foo");

79 
TEST_EQUAL
(
i
.
pos™iÚli¡_couÁ
(), 1);

80 
	gj
 = 
i
.
pos™iÚli¡_begš
();

81 
TEST_NOT_EQUAL
(
j
, 
i
.
pos™iÚli¡_’d
());

82 
TEST_EQUAL
(*
j
, 10);

83 ++
	gj
;

84 
TEST_EQUAL
(
j
, 
i
.
pos™iÚli¡_’d
());

85 ++
	gi
;

86 
TEST_EQUAL
(
i
, 
doc2
.
‹rmli¡_’d
());

88 
TEST_EQUAL
(
doc2
.
v®ues_couÁ
(), 1);

89 
	gk
 = 
doc2
.
v®ues_begš
();

90 
TEST_NOT_EQUAL
(
k
, 
doc2
.
v®ues_’d
());

91 
TEST_EQUAL
(
k
.
g‘_v®u’o
(), 1);

92 
TEST_EQUAL
(*
k
, "bar");

93 ++
	gk
;

94 
TEST_EQUAL
(
k
, 
doc2
.
v®ues_’d
());

96 
TEST_EQUAL
(
doc2
.
g‘_d©a
(), "baz");

98  
	gŒue
;

102 
	$DEFINE_TESTCASE
(
£rŸli£_docum’t2
, 
wr™abË
) {

103 
X­Ÿn
::
Docum’t
 
Üigdoc
;

104 
Üigdoc
.
	`add_‹rm
("foo", 2);

105 
Üigdoc
.
	`add_po¡šg
("foo", 10);

106 
Üigdoc
.
	`add_v®ue
(1, "bar");

107 
Üigdoc
.
	`£t_d©a
("baz");

108 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

109 
db
.
	`add_docum’t
(
Üigdoc
);

111 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(1);

113 
X­Ÿn
::
Docum’t
 
doc2
 = X­Ÿn::Docum’t::
	`un£rŸli£
(
doc
.
	`£rŸli£
());

115 
	`TEST_EQUAL
(
doc
.
	`‹rmli¡_couÁ
(), 
doc2
.termlist_count());

116 
	`TEST_EQUAL
(
doc
.
	`‹rmli¡_couÁ
(), 1);

117 
X­Ÿn
::
T”mI‹¿tÜ
 
i
;

118 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
j
;

119 
X­Ÿn
::
V®ueI‹¿tÜ
 
k
;

121 
i
 = 
doc
.
	`‹rmli¡_begš
();

122 
	`TEST_NOT_EQUAL
(
i
, 
doc
.
	`‹rmli¡_’d
());

123 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 3);

124 
	`TEST_EQUAL
(*
i
, "foo");

125 
	`TEST_EQUAL
(
i
.
	`pos™iÚli¡_couÁ
(), 1);

126 
j
 = 
i
.
	`pos™iÚli¡_begš
();

127 
	`TEST_NOT_EQUAL
(
j
, 
i
.
	`pos™iÚli¡_’d
());

128 
	`TEST_EQUAL
(*
j
, 10);

129 ++
j
;

130 
	`TEST_EQUAL
(
j
, 
i
.
	`pos™iÚli¡_’d
());

131 ++
i
;

132 
	`TEST_EQUAL
(
i
, 
doc
.
	`‹rmli¡_’d
());

134 
	`TEST_EQUAL
(
doc
.
	`v®ues_couÁ
(), 1);

135 
k
 = 
doc
.
	`v®ues_begš
();

136 
	`TEST_NOT_EQUAL
(
k
, 
doc
.
	`v®ues_’d
());

137 
	`TEST_EQUAL
(
k
.
	`g‘_v®u’o
(), 1);

138 
	`TEST_EQUAL
(*
k
, "bar");

139 ++
k
;

140 
	`TEST_EQUAL
(
k
, 
doc
.
	`v®ues_’d
());

142 
	`TEST_EQUAL
(
doc
.
	`g‘_d©a
(), "baz");

144 
i
 = 
doc2
.
	`‹rmli¡_begš
();

145 
	`TEST_NOT_EQUAL
(
i
, 
doc2
.
	`‹rmli¡_’d
());

146 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 3);

147 
	`TEST_EQUAL
(*
i
, "foo");

148 
	`TEST_EQUAL
(
i
.
	`pos™iÚli¡_couÁ
(), 1);

149 
j
 = 
i
.
	`pos™iÚli¡_begš
();

150 
	`TEST_NOT_EQUAL
(
j
, 
i
.
	`pos™iÚli¡_’d
());

151 
	`TEST_EQUAL
(*
j
, 10);

152 ++
j
;

153 
	`TEST_EQUAL
(
j
, 
i
.
	`pos™iÚli¡_’d
());

154 ++
i
;

155 
	`TEST_EQUAL
(
i
, 
doc2
.
	`‹rmli¡_’d
());

157 
	`TEST_EQUAL
(
doc2
.
	`v®ues_couÁ
(), 1);

158 
k
 = 
doc2
.
	`v®ues_begš
();

159 
	`TEST_NOT_EQUAL
(
k
, 
doc2
.
	`v®ues_’d
());

160 
	`TEST_EQUAL
(
k
.
	`g‘_v®u’o
(), 1);

161 
	`TEST_EQUAL
(*
k
, "bar");

162 ++
k
;

163 
	`TEST_EQUAL
(
k
, 
doc2
.
	`v®ues_’d
());

165 
	`TEST_EQUAL
(
doc2
.
	`g‘_d©a
(), "baz");

167  
Œue
;

168 
	}
}

171 
DEFINE_TESTCASE
(
£rŸli£_qu”y1
, !
back’d
) {

172 
	gX­Ÿn
::
Qu”y
 
q
;

173 
	gX­Ÿn
::
Qu”y
 
q2
 = 
X­Ÿn
::Qu”y::
un£rŸli£
(
q
.
£rŸli£
());

174 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

175 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query()");

177 
	gq
 = 
X­Ÿn
::
Qu”y
("hello");

178 
	gq2
 = 
X­Ÿn
::
Qu”y
::
un£rŸli£
(
q
.
£rŸli£
());

179 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

180 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query(hello)");

182 
	gq
 = 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_OR
, Xapian::Query("hello"), Xapian::Query("world"));

183 
	gq2
 = 
X­Ÿn
::
Qu”y
::
un£rŸli£
(
q
.
£rŸli£
());

184 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

185 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query((hello OR world))");

187  
	gŒue
;

191 
DEFINE_TESTCASE
(
£rŸli£_qu”y2
, !
back’d
) {

192 
	gX­Ÿn
::
V®ueWeightPo¡šgSourû
 
s1
(10);

193 
	gX­Ÿn
::
Qu”y
 
q
(&
s1
);

194 
	gX­Ÿn
::
Qu”y
 
q2
 = 
X­Ÿn
::Qu”y::
un£rŸli£
(
q
.
£rŸli£
());

195 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

196 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query(PostingSource(Xapian::ValueWeightPostingSource(slot=10)))");

198 
	gX­Ÿn
::
V®ueM­Po¡šgSourû
 
s2
(11);

199 
	gs2
.
£t_deçuÉ_weight
(5.0);

200 
	gq
 = 
X­Ÿn
::
Qu”y
(&
s2
);

201 
	gq2
 = 
X­Ÿn
::
Qu”y
::
un£rŸli£
(
q
.
£rŸli£
());

202 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

203 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query(PostingSource(Xapian::ValueMapPostingSource(slot=11)))");

205 
	gX­Ÿn
::
FixedWeightPo¡šgSourû
 
s3
(5.5);

206 
	gq
 = 
X­Ÿn
::
Qu”y
(&
s3
);

207 
	gq2
 = 
X­Ÿn
::
Qu”y
::
un£rŸli£
(
q
.
£rŸli£
());

208 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

209 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query(PostingSource(Xapian::FixedWeightPostingSource(wt=5.5)))");

211  
	gŒue
;

215 
DEFINE_TESTCASE
(
£rŸli£_qu”y3
, !
back’d
) {

216 
	gX­Ÿn
::
V®ueWeightPo¡šgSourû
 
s1
(10);

217 
	gX­Ÿn
::
Qu”y
 
q
(&
s1
);

218 
	gX­Ÿn
::
Regi¡ry
 
»g
;

219 
	gX­Ÿn
::
Qu”y
 
q2
 = 
X­Ÿn
::Qu”y::
un£rŸli£
(
q
.
£rŸli£
(), 
»g
);

220 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

221 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query(PostingSource(Xapian::ValueWeightPostingSource(slot=10)))");

223 
	gX­Ÿn
::
V®ueM­Po¡šgSourû
 
s2
(11);

224 
	gs2
.
£t_deçuÉ_weight
(5.0);

225 
	gq
 = 
X­Ÿn
::
Qu”y
(&
s2
);

226 
	gq2
 = 
X­Ÿn
::
Qu”y
::
un£rŸli£
(
q
.
£rŸli£
(), 
»g
);

227 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

228 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query(PostingSource(Xapian::ValueMapPostingSource(slot=11)))");

230 
	gX­Ÿn
::
FixedWeightPo¡šgSourû
 
s3
(5.5);

231 
	gq
 = 
X­Ÿn
::
Qu”y
(&
s3
);

232 
	gq2
 = 
X­Ÿn
::
Qu”y
::
un£rŸli£
(
q
.
£rŸli£
(), 
»g
);

233 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

234 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query(PostingSource(Xapian::FixedWeightPostingSource(wt=5.5)))");

236  
	gŒue
;

239 şas 
	cMyPo¡šgSourû2
 : 
public
 
X­Ÿn
::
V®uePo¡šgSourû
 {

240 
¡d
::
¡ršg
 
desc
;

241 
	mpublic
:

242 
MyPo¡šgSourû2
(cÚ¡ 
¡d
::
¡ršg
 & 
desc_
)

243 : 
X­Ÿn
::
V®uePo¡šgSourû
(0), 
	$desc
(
desc_
)

247 
MyPo¡šgSourû2
 * 
	$şÚe
() const

249  
Ãw
 
	`MyPo¡šgSourû2
(
desc
);

250 
	}
}

252 
	g¡d
::
¡ršg
 
	$Çme
() const {

254 
	}
}

256 
	g¡d
::
¡ršg
 
	$£rŸli£
() const {

257  
desc
;

258 
	}
}

260 
MyPo¡šgSourû2
 * 
un£rŸli£
(cÚ¡ 
¡d
::
¡ršg
 & 
s
) const {

261  
Ãw
 
MyPo¡šgSourû2
(
s
);

264 
	gX­Ÿn
::
weight
 
	$g‘_weight
(ècÚ¡ {  1.0; 
	}
}

266 
	g¡d
::
¡ršg
 
	$g‘_desütiÚ
() const {

267  "MyPo¡šgSourû2(" + 
desc
 + ")";

268 
	}
}

272 
DEFINE_TESTCASE
(
£rŸli£_qu”y4
, !
back’d
) {

273 
MyPo¡šgSourû2
 
s1
("foo");

274 
	gX­Ÿn
::
Qu”y
 
q
(&
s1
);

275 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), "Xapian::Query(PostingSource(MyPostingSource2(foo)))");

276 
	g¡d
::
¡ršg
 
£rŸli£d
 = 
q
.
£rŸli£
();

278 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, X­Ÿn::
Qu”y
::
un£rŸli£
(
£rŸli£d
));

279 
	gX­Ÿn
::
Regi¡ry
 
»g
;

280 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, X­Ÿn::
Qu”y
::
un£rŸli£
(
£rŸli£d
, 
»g
));

282 
	g»g
.
»gi¡”_po¡šg_sourû
(
s1
);

283 
	gX­Ÿn
::
Qu”y
 
q2
 = 
X­Ÿn
::Qu”y::
un£rŸli£
(
£rŸli£d
, 
»g
);

284 
TEST_EQUAL
(
q
.
g‘_desütiÚ
(), 
q2
.get_description());

286  
	gŒue
;

290 
DEFINE_TESTCASE
(
doubË_»gi¡”_Ëak
, !
back’d
) {

291 
MyPo¡šgSourû2
 
s1
("foo");

292 
	gX­Ÿn
::
BM25Weight
 
w1
;

294 
	gX­Ÿn
::
Regi¡ry
 
»g
;

295 
	g»g
.
»gi¡”_po¡šg_sourû
(
s1
);

296 
	g»g
.
»gi¡”_po¡šg_sourû
(
s1
);

297 
	g»g
.
»gi¡”_po¡šg_sourû
(
s1
);

299 
	g»g
.
»gi¡”_weightšg_scheme
(
w1
);

300 
	g»g
.
»gi¡”_weightšg_scheme
(
w1
);

301 
	g»g
.
»gi¡”_weightšg_scheme
(
w1
);

303  
	gŒue
;

306 şas 
	cExû±iÚ®Po¡šgSourû
 : 
public
 
X­Ÿn
::
Po¡šgSourû
 {

307 
public
:

308 ’um { 
NONE
, 
	mCLONE
, 
	mDTOR
 } 
	tçmode
;

310 
çmode
 
	gç
;

312 
	gPo¡šgSourû
 * & 
	g®loÿ‹d
;

314 
	$Exû±iÚ®Po¡šgSourû
(
çmode
 
ç_
, 
Po¡šgSourû
 * & 
®loÿ‹d_
)

315 : 
	`ç
(
ç_
), 
	$®loÿ‹d
(
®loÿ‹d_
è{ 
	}
}

317 ~
	$Exû±iÚ®Po¡šgSourû
() {

318 ià(
ç
 =ğ
DTOR
) {

319 
throw
 
	`ruÁime_”rÜ
(
	`¡ršg
("arfle barfle gloop?"));

321 
	}
}

323 
¡ršg
 
	$Çme
() const {

325 
	}
}

327 
Po¡šgSourû
 * 
	$şÚe
() const {

328 ià(
ç
 =ğ
CLONE
)

329 
throw
 
	`bad_®loc
();

330 
®loÿ‹d
 = 
Ãw
 
	`Exû±iÚ®Po¡šgSourû
(
ç
,‡llocated);

331  
®loÿ‹d
;

332 
	}
}

334 
š™
(cÚ¡ 
X­Ÿn
::
D©aba£
 &) { }

336 
X­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_mš
(ècÚ¡ {  0; 
	}
}

337 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_e¡
(ècÚ¡ {  1; 
	}
}

338 
	gX­Ÿn
::
doccouÁ
 
	$g‘_‹rmäeq_max
(ècÚ¡ {  2; 
	}
}

340 
Ãxt
(
X­Ÿn
::
weight
) { }

342 
sk_to
(
X­Ÿn
::
docid
, X­Ÿn::
weight
) { }

344 
boŞ
 
	$©_’d
(ècÚ¡ {  
Œue
; 
	}
}

345 
	gX­Ÿn
::
docid
 
	$g‘_docid
(ècÚ¡ {  0; 
	}
}

349 
DEFINE_TESTCASE
(
»gi¡ry1
, !
back’d
) {

352 
	gX­Ÿn
::
Regi¡ry
 
»g
;

354 
	gX­Ÿn
::
Po¡šgSourû
 * 
±r
 = 
NULL
;

355 
Exû±iÚ®Po¡šgSourû
 
•s
(Exû±iÚ®Po¡šgSourû::
NONE
, 
±r
);

356 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
•s
.
£rŸli£
());

357 
TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
, 
•s
.
un£rŸli£
(
¡ršg
()));

358 
	g»g
.
»gi¡”_po¡šg_sourû
(
•s
);

359 
	gŒy
 {

360 
	gX­Ÿn
::
Po¡šgSourû
 * 
±r_şÚe
 = 
NULL
;

361 
Exû±iÚ®Po¡šgSourû
 
•s_şÚe
(Exû±iÚ®Po¡šgSourû::
CLONE
,

362 
±r_şÚe
);

363 
	g»g
.
»gi¡”_po¡šg_sourû
(
•s_şÚe
);

364  
	gçl£
;

365 } 
ÿtch
 (cÚ¡ 
bad_®loc
 &) {

369 cÚ¡ 
	gX­Ÿn
::
Po¡šgSourû
 * 
p
;

370 
	gp
 = 
»g
.
g‘_po¡šg_sourû
("ExceptionalPostingSource");

371 ià(
	gp
) {

372 
TEST_EQUAL
(
p
->
Çme
(), "ExceptionalPostingSource");

378 
	gX­Ÿn
::
Regi¡ry
 
»g
;

380 
	gX­Ÿn
::
Po¡šgSourû
 * 
±r_dtÜ
 = 
NULL
;

381 
Exû±iÚ®Po¡šgSourû
 
•s_dtÜ
(Exû±iÚ®Po¡šgSourû::
DTOR
,

382 
±r_dtÜ
);

383 
	g»g
.
»gi¡”_po¡šg_sourû
(
•s_dtÜ
);

385 
	g•s_dtÜ
.
	gç
 = 
Exû±iÚ®Po¡šgSourû
::
NONE
;

387 
	gŒy
 {

388 
	gX­Ÿn
::
Po¡šgSourû
 * 
±r
 = 
NULL
;

389 
Exû±iÚ®Po¡šgSourû
 
•s
(Exû±iÚ®Po¡šgSourû::
NONE
, 
±r
);

390 
	g»g
.
»gi¡”_po¡šg_sourû
(
•s
);

391  
	gçl£
;

392 } 
ÿtch
 (cÚ¡ 
ruÁime_”rÜ
 &) {

396 cÚ¡ 
	gX­Ÿn
::
Po¡šgSourû
 * 
p
;

397 
	gp
 = 
»g
.
g‘_po¡šg_sourû
("ExceptionalPostingSource");

398 ià(
	gp
) {

399 
TEST_EQUAL
(
p
->
Çme
(), "ExceptionalPostingSource");

404 
İ”©Ü
 
d–‘e
(
±r_dtÜ
);

407  
	gŒue
;

410 şas 
	cExû±iÚ®Weight
 : 
public
 
X­Ÿn
::
Weight
 {

411 
public
:

412 ’um { 
NONE
, 
	mCLONE
, 
	mDTOR
 } 
	tçmode
;

414 
çmode
 
	gç
;

416 
	gWeight
 * & 
	g®loÿ‹d
;

418 
	$Exû±iÚ®Weight
(
çmode
 
ç_
, 
Weight
 * & 
®loÿ‹d_
)

419 : 
	`ç
(
ç_
), 
	$®loÿ‹d
(
®loÿ‹d_
è{ 
	}
}

421 ~
	$Exû±iÚ®Weight
() {

422 ià(
ç
 =ğ
DTOR
) {

423 
throw
 
	`ruÁime_”rÜ
(
	`¡ršg
("arfle barfle gloop?"));

425 
	}
}

427 
¡ršg
 
	$Çme
() const {

429 
	}
}

431 
Weight
 * 
	$şÚe
() const {

432 ià(
ç
 =ğ
CLONE
)

433 
throw
 
	`bad_®loc
();

434 
®loÿ‹d
 = 
Ãw
 
	`Exû±iÚ®Weight
(
ç
,‡llocated);

435  
®loÿ‹d
;

436 
	}
}

438 
	$š™
(è{ 
	}
}

440 
	gX­Ÿn
::
weight
 
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
, Xapian::termcount) const {

443 
	gX­Ÿn
::
weight
 
	$g‘_max·¹
(ècÚ¡ {  0; 
	}
}

445 
	gX­Ÿn
::
weight
 
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
) const {  0; }

446 
	gX­Ÿn
::
weight
 
	$g‘_maxexŒa
(ècÚ¡ {  0; 
	}
}

450 
DEFINE_TESTCASE
(
»gi¡ry2
, !
back’d
) {

453 
	gX­Ÿn
::
Regi¡ry
 
»g
;

455 
	gX­Ÿn
::
Weight
 * 
±r
 = 
NULL
;

456 
Exû±iÚ®Weight
 
ewt
(Exû±iÚ®Weight::
NONE
, 
±r
);

457 
	g»g
.
»gi¡”_weightšg_scheme
(
ewt
);

458 
	gŒy
 {

459 
	gX­Ÿn
::
Weight
 * 
±r_şÚe
 = 
NULL
;

460 
Exû±iÚ®Weight
 
ewt_şÚe
(Exû±iÚ®Weight::
CLONE
,

461 
±r_şÚe
);

462 
	g»g
.
»gi¡”_weightšg_scheme
(
ewt_şÚe
);

463  
	gçl£
;

464 } 
ÿtch
 (cÚ¡ 
bad_®loc
 &) {

468 cÚ¡ 
	gX­Ÿn
::
Weight
 * 
p
;

469 
	gp
 = 
»g
.
g‘_weightšg_scheme
("ExceptionalWeight");

470 ià(
	gp
) {

471 
TEST_EQUAL
(
p
->
Çme
(), "ExceptionalWeight");

477 
	gX­Ÿn
::
Regi¡ry
 
»g
;

479 
	gX­Ÿn
::
Weight
 * 
±r_dtÜ
 = 
NULL
;

480 
Exû±iÚ®Weight
 
ewt_dtÜ
(Exû±iÚ®Weight::
DTOR
,

481 
±r_dtÜ
);

482 
	g»g
.
»gi¡”_weightšg_scheme
(
ewt_dtÜ
);

484 
	gewt_dtÜ
.
	gç
 = 
Exû±iÚ®Weight
::
NONE
;

486 
	gŒy
 {

487 
	gX­Ÿn
::
Weight
 * 
±r
 = 
NULL
;

488 
Exû±iÚ®Weight
 
ewt
(Exû±iÚ®Weight::
NONE
, 
±r
);

489 
	g»g
.
»gi¡”_weightšg_scheme
(
ewt
);

490  
	gçl£
;

491 } 
ÿtch
 (cÚ¡ 
ruÁime_”rÜ
 &) {

495 cÚ¡ 
	gX­Ÿn
::
Weight
 * 
p
;

496 
	gp
 = 
»g
.
g‘_weightšg_scheme
("ExceptionalWeight");

497 ià(
	gp
) {

498 
TEST_EQUAL
(
p
->
Çme
(), "ExceptionalWeight");

503 
İ”©Ü
 
d–‘e
(
±r_dtÜ
);

506  
	gŒue
;

509 şas 
	cExû±iÚ®M©chSpy
 : 
public
 
X­Ÿn
::
M©chSpy
 {

510 
public
:

511 ’um { 
NONE
, 
	mCLONE
, 
	mDTOR
 } 
	tçmode
;

513 
çmode
 
	gç
;

515 
	gM©chSpy
 * & 
	g®loÿ‹d
;

517 
	$Exû±iÚ®M©chSpy
(
çmode
 
ç_
, 
M©chSpy
 * & 
®loÿ‹d_
)

518 : 
	`ç
(
ç_
), 
	$®loÿ‹d
(
®loÿ‹d_
è{ 
	}
}

520 ~
	$Exû±iÚ®M©chSpy
() {

521 ià(
ç
 =ğ
DTOR
) {

522 
throw
 
	`ruÁime_”rÜ
(
	`¡ršg
("arfle barfle gloop?"));

524 
	}
}

526 
¡ršg
 
	$Çme
() const {

528 
	}
}

530 
M©chSpy
 * 
	$şÚe
() const {

531 ià(
ç
 =ğ
CLONE
)

532 
throw
 
	`bad_®loc
();

533 
®loÿ‹d
 = 
Ãw
 
	`Exû±iÚ®M©chSpy
(
ç
,‡llocated);

534  
®loÿ‹d
;

535 
	}
}

537 
	$İ”©Ü
()(cÚ¡ 
X­Ÿn
::
Docum’t
 &, X­Ÿn::
weight
) {

538 
	}
}

542 
DEFINE_TESTCASE
(
»gi¡ry3
, !
back’d
) {

545 
	gX­Ÿn
::
Regi¡ry
 
»g
;

547 
	gX­Ÿn
::
M©chSpy
 * 
±r
 = 
NULL
;

548 
Exû±iÚ®M©chSpy
 
ems
(Exû±iÚ®M©chSpy::
NONE
, 
±r
);

549 
	g»g
.
»gi¡”_m©ch_¥y
(
ems
);

550 
	gŒy
 {

551 
	gX­Ÿn
::
M©chSpy
 * 
±r_şÚe
 = 
NULL
;

552 
Exû±iÚ®M©chSpy
 
ems_şÚe
(Exû±iÚ®M©chSpy::
CLONE
,

553 
±r_şÚe
);

554 
	g»g
.
»gi¡”_m©ch_¥y
(
ems_şÚe
);

555  
	gçl£
;

556 } 
ÿtch
 (cÚ¡ 
bad_®loc
 &) {

560 cÚ¡ 
	gX­Ÿn
::
M©chSpy
 * 
p
;

561 
	gp
 = 
»g
.
g‘_m©ch_¥y
("ExceptionalMatchSpy");

562 ià(
	gp
) {

563 
TEST_EQUAL
(
p
->
Çme
(), "ExceptionalMatchSpy");

569 
	gX­Ÿn
::
Regi¡ry
 
»g
;

571 
	gX­Ÿn
::
M©chSpy
 * 
±r_dtÜ
 = 
NULL
;

572 
Exû±iÚ®M©chSpy
 
ems_dtÜ
(Exû±iÚ®M©chSpy::
DTOR
, 
±r_dtÜ
);

573 
	g»g
.
»gi¡”_m©ch_¥y
(
ems_dtÜ
);

575 
	gems_dtÜ
.
	gç
 = 
Exû±iÚ®M©chSpy
::
NONE
;

577 
	gŒy
 {

578 
	gX­Ÿn
::
M©chSpy
 * 
±r
 = 
NULL
;

579 
Exû±iÚ®M©chSpy
 
ems
(Exû±iÚ®M©chSpy::
NONE
, 
±r
);

580 
	g»g
.
»gi¡”_m©ch_¥y
(
ems
);

581  
	gçl£
;

582 } 
ÿtch
 (cÚ¡ 
ruÁime_”rÜ
 &) {

586 cÚ¡ 
	gX­Ÿn
::
M©chSpy
 * 
p
;

587 
	gp
 = 
»g
.
g‘_m©ch_¥y
("ExceptionalMatchSpy");

588 ià(
	gp
) {

589 
TEST_EQUAL
(
p
->
Çme
(), "ExceptionalMatchSpy");

594 
İ”©Ü
 
d–‘e
(
±r_dtÜ
);

597  
	gŒue
;

	@tests/api_serialise.h

2 
boŞ
 
‹¡_£rŸli£_docum’t1
();

3 
boŞ
 
‹¡_£rŸli£_docum’t2
();

4 
boŞ
 
‹¡_£rŸli£_qu”y1
();

5 
boŞ
 
‹¡_£rŸli£_qu”y2
();

6 
boŞ
 
‹¡_£rŸli£_qu”y3
();

7 
boŞ
 
‹¡_£rŸli£_qu”y4
();

8 
boŞ
 
‹¡_doubË_»gi¡”_Ëak
();

9 
boŞ
 
‹¡_»gi¡ry1
();

10 
boŞ
 
‹¡_»gi¡ry2
();

11 
boŞ
 
‹¡_»gi¡ry3
();

	@tests/api_sorting.cc

21 
	~<cÚfig.h
>

23 
	~"­i_sÜtšg.h
"

25 
	~<x­Ÿn.h
>

27 
	~"­™e¡.h
"

28 
	~"‹¡uts.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

32 
DEFINE_TESTCASE
(
sÜtfunùÜ1
,
back’d
 && !
»mÙe
) {

33 
	gX­Ÿn
::
Enquœe
 
’quœe
(
g‘_d©aba£
("apitest_sortrel"));

34 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("woman"));

37 cÚ¡ 
	gkeys
[] = { 3, 1 };

38 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
(
keys
, keys + 2);

40 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

41 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

42 
m£t_ex³ù_Üd”
(
m£t
, 2, 6, 7, 1, 3, 4, 5, 8, 9);

46 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

47 
	gsÜ‹r
.
add_v®ue
(3);

48 
	gsÜ‹r
.
add_v®ue
(1, 
Œue
);

50 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

51 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

52 
m£t_ex³ù_Üd”
(
m£t
, 7, 6, 2, 8, 9, 4, 5, 1, 3);

56 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

57 
	gsÜ‹r
.
add_v®ue
(100);

58 
	gsÜ‹r
.
add_v®ue
(3);

59 
	gsÜ‹r
.
add_v®ue
(1, 
Œue
);

61 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

62 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

63 
m£t_ex³ù_Üd”
(
m£t
, 7, 6, 2, 8, 9, 4, 5, 1, 3);

67 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

68 
	gsÜ‹r
.
add_v®ue
(10);

69 
	gsÜ‹r
.
add_v®ue
(1, 
Œue
);

71 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

72 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

73 
m£t_ex³ù_Üd”
(
m£t
, 8, 9, 4, 5, 1, 3, 7, 6, 2);

76  
	gŒue
;

80 
DEFINE_TESTCASE
(
sÜtfunùÜ2
,
wr™abË
 && !
»mÙe
) {

81 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

82 
	gX­Ÿn
::
Docum’t
 
doc
;

83 
	gdoc
.
add_‹rm
("foo");

84 
	gdoc
.
add_v®ue
(0, "ABB");

85 
	gdb
.
add_docum’t
(
doc
);

86 
	gdoc
.
add_v®ue
(0, "ABC");

87 
	gdb
.
add_docum’t
(
doc
);

88 
	gdoc
.
add_v®ue
(0, 
¡ršg
("ABC", 4));

89 
	gdb
.
add_docum’t
(
doc
);

90 
	gdoc
.
add_v®ue
(0, "ABCD");

91 
	gdb
.
add_docum’t
(
doc
);

92 
	gdoc
.
add_v®ue
(0, "ABC\xff");

93 
	gdb
.
add_docum’t
(
doc
);

95 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

96 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("foo"));

99 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

100 
	gsÜ‹r
.
add_v®ue
(0);

101 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

102 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

103 
m£t_ex³ù_Üd”
(
m£t
, 5, 4, 3, 2, 1);

107 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

108 
	gsÜ‹r
.
add_v®ue
(0, 
Œue
);

109 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

110 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

111 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5);

115 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

116 
	gsÜ‹r
.
add_v®ue
(0);

117 
	gsÜ‹r
.
add_v®ue
(1);

118 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

119 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

120 
m£t_ex³ù_Üd”
(
m£t
, 5, 4, 3, 2, 1);

124 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

125 
	gsÜ‹r
.
add_v®ue
(0, 
Œue
);

126 
	gsÜ‹r
.
add_v®ue
(1);

127 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

128 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

129 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5);

133 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

134 
	gsÜ‹r
.
add_v®ue
(0);

135 
	gsÜ‹r
.
add_v®ue
(1, 
Œue
);

136 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

137 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

138 
m£t_ex³ù_Üd”
(
m£t
, 5, 4, 3, 2, 1);

142 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
;

143 
	gsÜ‹r
.
add_v®ue
(0, 
Œue
);

144 
	gsÜ‹r
.
add_v®ue
(1, 
Œue
);

145 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

146 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

147 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5);

150  
	gŒue
;

153 şas 
	cNev”U£MeKeyMak”
 : 
public
 
X­Ÿn
::
KeyMak”
 {

154 
public
:

155 
¡d
::
¡ršg
 
	$İ”©Ü
(è(cÚ¡ 
X­Ÿn
::
Docum’t
 &) const

157 
	`FAIL_TEST
("NeverUseMeKeyMaker was called");

159 
	}
};

162 
DEFINE_TESTCASE
(
chªgesÜ‹r1
, 
back’d
 && !
»mÙe
) {

163 
	gX­Ÿn
::
Enquœe
 
’quœe
(
g‘_d©aba£
("apitest_simpledata"));

164 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("word"));

165 
Nev”U£MeKeyMak”
 
	gsÜ‹r
;

167 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

168 
	g’quœe
.
£t_sÜt_by_v®ue
(0, 
Œue
);

169 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 25);

170 
TEST_EQUAL
(
m£t
.
size
(), 2);

172 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

173 
	g’quœe
.
£t_sÜt_by_v®ue_th’_»Ëvªû
(0, 
Œue
);

174 
	gm£t
 = 
’quœe
.
g‘_m£t
(0, 25);

175 
TEST_EQUAL
(
m£t
.
size
(), 2);

177 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

178 
	g’quœe
.
£t_sÜt_by_»Ëvªû_th’_v®ue
(0, 
Œue
);

179 
	gm£t
 = 
’quœe
.
g‘_m£t
(0, 25);

180 
TEST_EQUAL
(
m£t
.
size
(), 2);

182 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

183 
	g’quœe
.
£t_sÜt_by_»Ëvªû
();

184 
	gm£t
 = 
’quœe
.
g‘_m£t
(0, 25);

185 
TEST_EQUAL
(
m£t
.
size
(), 2);

187  
	gŒue
;

191 
DEFINE_TESTCASE
(
sÜtfunùÜem±y1
,
back’d
 && !
»mÙe
) {

192 
	gX­Ÿn
::
Enquœe
 
’quœe
(
g‘_d©aba£
("apitest_sortrel"));

193 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("woman"));

196 
	gi
;

197 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
(&
i
, &i);

199 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

200 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

201 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5, 6, 7, 8, 9);

204  
	gŒue
;

207 
DEFINE_TESTCASE
(
muÉiv®uekeymak”1
,!
back’d
) {

208 cÚ¡ 
	gkeys
[] = { 0, 1, 2, 3 };

209 
	gX­Ÿn
::
MuÉiV®ueKeyMak”
 
sÜ‹r
(
keys
, keys + 4);

211 
	gX­Ÿn
::
Docum’t
 
doc
;

212 
TEST_EQUAL
(
sÜ‹r
(
doc
), 
¡ršg
());

214 
	gdoc
.
add_v®ue
(1, "foo");

215 
TEST_EQUAL
(
sÜ‹r
(
doc
), 
¡ršg
("\0\0foo", 5));

216 
	gdoc
.
add_v®ue
(1, 
¡ršg
("f\0o", 3));

217 
TEST_EQUAL
(
sÜ‹r
(
doc
), 
¡ršg
("\0\0f\0\xffo", 6));

218 
	gdoc
.
add_v®ue
(3, "xyz");

219 
TEST_EQUAL
(
sÜ‹r
(
doc
), 
¡ršg
("\0\0f\0\xffo\0\0\0\0xyz", 13));

221 
	gsÜ‹r
.
add_v®ue
(4, 
Œue
);

222 
TEST_EQUAL
(
sÜ‹r
(
doc
), 
¡ršg
("\0\0f\0\xffo\0\0\0\0xyz\0\0\xff\xff", 17));

224  
	gŒue
;

227 
	$DEFINE_TESTCASE
(
sÜtfunùÜ»mÙe1
,
»mÙe
) {

228 
X­Ÿn
::
Enquœe
 
	`’quœe
(
	`g‘_d©aba£
(
	`¡ršg
()));

229 
Nev”U£MeKeyMak”
 
sÜ‹r
;

230 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("word"));

231 
’quœe
.
	`£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

232 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

233 
X­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

235  
Œue
;

236 
	}
}

	@tests/api_sorting.h

2 
boŞ
 
‹¡_sÜtfunùÜ1
();

3 
boŞ
 
‹¡_sÜtfunùÜ2
();

4 
boŞ
 
‹¡_chªgesÜ‹r1
();

5 
boŞ
 
‹¡_sÜtfunùÜem±y1
();

6 
boŞ
 
‹¡_muÉiv®uekeymak”1
();

7 
boŞ
 
‹¡_sÜtfunùÜ»mÙe1
();

	@tests/api_sortingold.cc

21 
	~<cÚfig.h
>

23 
	~"­i_sÜtšgŞd.h
"

25 
	#XAPIAN_DEPRECATED
(
D
è
	)
D

26 
	~<x­Ÿn.h
>

28 
	~"­™e¡.h
"

29 
	~"‹¡uts.h
"

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
DEFINE_TESTCASE
(
ŞdsÜtfunùÜ1
,
back’d
 && !
»mÙe
) {

34 
	gX­Ÿn
::
Enquœe
 
’quœe
(
g‘_d©aba£
("apitest_sortrel"));

35 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("woman"));

38 cÚ¡ 
	gkeys
[] = { 3, 1 };

39 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
(
keys
, keys + 2);

41 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

42 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

43 
m£t_ex³ù_Üd”
(
m£t
, 2, 6, 7, 1, 3, 4, 5, 8, 9);

47 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

48 
	gsÜ‹r
.
add
(3);

49 
	gsÜ‹r
.
add
(1, 
çl£
);

51 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

52 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

53 
m£t_ex³ù_Üd”
(
m£t
, 7, 6, 2, 8, 9, 4, 5, 1, 3);

57 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

58 
	gsÜ‹r
.
add
(100);

59 
	gsÜ‹r
.
add
(3);

60 
	gsÜ‹r
.
add
(1, 
çl£
);

62 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

63 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

64 
m£t_ex³ù_Üd”
(
m£t
, 7, 6, 2, 8, 9, 4, 5, 1, 3);

68 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

69 
	gsÜ‹r
.
add
(10);

70 
	gsÜ‹r
.
add
(1, 
çl£
);

72 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

73 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

74 
m£t_ex³ù_Üd”
(
m£t
, 8, 9, 4, 5, 1, 3, 7, 6, 2);

77  
	gŒue
;

81 
DEFINE_TESTCASE
(
ŞdsÜtfunùÜ2
,
wr™abË
 && !
»mÙe
) {

82 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

83 
	gX­Ÿn
::
Docum’t
 
doc
;

84 
	gdoc
.
add_‹rm
("foo");

85 
	gdoc
.
add_v®ue
(0, "ABB");

86 
	gdb
.
add_docum’t
(
doc
);

87 
	gdoc
.
add_v®ue
(0, "ABC");

88 
	gdb
.
add_docum’t
(
doc
);

89 
	gdoc
.
add_v®ue
(0, 
¡ršg
("ABC", 4));

90 
	gdb
.
add_docum’t
(
doc
);

91 
	gdoc
.
add_v®ue
(0, "ABCD");

92 
	gdb
.
add_docum’t
(
doc
);

93 
	gdoc
.
add_v®ue
(0, "ABC\xff");

94 
	gdb
.
add_docum’t
(
doc
);

96 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

97 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("foo"));

100 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

101 
	gsÜ‹r
.
add
(0);

102 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

103 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

104 
m£t_ex³ù_Üd”
(
m£t
, 5, 4, 3, 2, 1);

108 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

109 
	gsÜ‹r
.
add
(0, 
çl£
);

110 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

111 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

112 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5);

116 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

117 
	gsÜ‹r
.
add
(0);

118 
	gsÜ‹r
.
add
(1);

119 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

120 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

121 
m£t_ex³ù_Üd”
(
m£t
, 5, 4, 3, 2, 1);

125 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

126 
	gsÜ‹r
.
add
(0, 
çl£
);

127 
	gsÜ‹r
.
add
(1);

128 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

129 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

130 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5);

134 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

135 
	gsÜ‹r
.
add
(0);

136 
	gsÜ‹r
.
add
(1, 
çl£
);

137 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

138 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

139 
m£t_ex³ù_Üd”
(
m£t
, 5, 4, 3, 2, 1);

143 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
;

144 
	gsÜ‹r
.
add
(0, 
çl£
);

145 
	gsÜ‹r
.
add
(1, 
çl£
);

146 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

147 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

148 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5);

151  
	gŒue
;

154 şas 
	cNev”U£MeSÜ‹r
 : 
public
 
X­Ÿn
::
SÜ‹r
 {

155 
public
:

156 
¡d
::
¡ršg
 
	$İ”©Ü
(è(cÚ¡ 
X­Ÿn
::
Docum’t
 &) const

158 
	`FAIL_TEST
("NeverUseMeSorter was called");

160 
	}
};

163 
DEFINE_TESTCASE
(
ŞdchªgesÜ‹r1
, 
back’d
 && !
»mÙe
) {

164 
	gX­Ÿn
::
Enquœe
 
’quœe
(
g‘_d©aba£
("apitest_simpledata"));

165 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("word"));

166 
Nev”U£MeSÜ‹r
 
	gsÜ‹r
;

168 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

169 
	g’quœe
.
£t_sÜt_by_v®ue
(0, 
Œue
);

170 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 25);

171 
TEST_EQUAL
(
m£t
.
size
(), 2);

173 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

174 
	g’quœe
.
£t_sÜt_by_v®ue_th’_»Ëvªû
(0, 
Œue
);

175 
	gm£t
 = 
’quœe
.
g‘_m£t
(0, 25);

176 
TEST_EQUAL
(
m£t
.
size
(), 2);

178 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

179 
	g’quœe
.
£t_sÜt_by_»Ëvªû_th’_v®ue
(0, 
Œue
);

180 
	gm£t
 = 
’quœe
.
g‘_m£t
(0, 25);

181 
TEST_EQUAL
(
m£t
.
size
(), 2);

183 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

184 
	g’quœe
.
£t_sÜt_by_»Ëvªû
();

185 
	gm£t
 = 
’quœe
.
g‘_m£t
(0, 25);

186 
TEST_EQUAL
(
m£t
.
size
(), 2);

188  
	gŒue
;

192 
DEFINE_TESTCASE
(
ŞdsÜtfunùÜem±y1
,
back’d
 && !
»mÙe
) {

193 
	gX­Ÿn
::
Enquœe
 
’quœe
(
g‘_d©aba£
("apitest_sortrel"));

194 
	g’quœe
.
£t_qu”y
(
X­Ÿn
::
Qu”y
("woman"));

197 
	gi
;

198 
	gX­Ÿn
::
MuÉiV®ueSÜ‹r
 
sÜ‹r
(&
i
, &i);

200 
	g’quœe
.
£t_sÜt_by_key
(&
sÜ‹r
, 
Œue
);

201 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

202 
m£t_ex³ù_Üd”
(
m£t
, 1, 2, 3, 4, 5, 6, 7, 8, 9);

205  
	gŒue
;

	@tests/api_sortingold.h

2 
boŞ
 
‹¡_ŞdsÜtfunùÜ1
();

3 
boŞ
 
‹¡_ŞdsÜtfunùÜ2
();

4 
boŞ
 
‹¡_ŞdchªgesÜ‹r1
();

5 
boŞ
 
‹¡_ŞdsÜtfunùÜem±y1
();

	@tests/api_spelling.cc

22 
	~<cÚfig.h
>

24 
	~"­i_¥–lšg.h
"

26 
	~<x­Ÿn.h
>

28 
	~"­™e¡.h
"

29 
	~"‹¡su™e.h
"

30 
	~"‹¡uts.h
"

32 
	~<¡ršg
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	$DEFINE_TESTCASE
(
¥–l1
, 
¥–lšg
) {

38 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

41 
db
.
	`add_¥–lšg
("hello");

42 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cell"), "hello");

43 
db
.
	`add_¥–lšg
("cell", 2);

44 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "cell");

45 
db
.
	`comm™
();

46 
X­Ÿn
::
D©aba£
 
	`dbr
(
	`g‘_wr™abË_d©aba£_as_d©aba£
());

47 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "cell");

48 
	`TEST_EQUAL
(
dbr
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "cell");

51 
db
.
	`add_¥–lšg
("zig");

53 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("izg"), "zig");

54 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("zgi"), "zig");

56 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("sig"), "zig");

57 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("zog"), "zig");

58 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("zif"), "zig");

60 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("ig"), "zig");

61 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("zg"), "zig");

62 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("zi"), "zig");

64 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("azig"), "zig");

65 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("zaig"), "zig");

66 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("ziag"), "zig");

67 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("ziga"), "zig");

70 
db
.
	`add_¥–lšg
("ch");

72 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hc"), "ch");

74 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("qh"), "");

75 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cq"), "");

77 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("c"), "");

78 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("h"), "");

80 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("qch"), "ch");

81 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cqh"), "ch");

82 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("chq"), "ch");

85 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("shello"), "hello");

86 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hellot"), "hello");

87 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("acell"), "cell");

88 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cella"), "cell");

89 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("acella"), "cell");

90 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("helo"), "hello");

91 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cll"), "cell");

92 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("helol"), "hello");

93 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("clel"), "cell");

94 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("ecll"), "cell");

95 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cll"), "cell");

98 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("shelolx"), "");

99 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("celling"), "");

100 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("dellin"), "");

103 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("shelolx", 3), "hello");

104 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("celling", 3), "cell");

105 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("dellin", 3), "cell");

108 
db
.
	`add_¥–lšg
("hello", 2);

109 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "hello");

110 
db
.
	`comm™
();

111 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cello"), "hello");

112 
db
.
	`»move_¥–lšg
("hello", 2);

113 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "cell");

115 
db
.
	`»move_¥–lšg
("cell", 6);

116 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cell"), "hello");

117 
db
.
	`comm™
();

118 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cell"), "hello");

119 
db
.
	`»move_¥–lšg
("hello");

120 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("cell"), "");

123 
db
.
	`»move_¥–lšg
("nonsuch");

124 
db
.
	`»move_¥–lšg
("zzzzzzzzz", 1000000);

125 
db
.
	`»move_¥–lšg
("aarvark");

128 
db
.
	`»move_¥–lšg
("hello");

129 
db
.
	`comm™
();

130 
db
.
	`»move_¥–lšg
("hello");

132  
Œue
;

133 
	}
}

136 
	$DEFINE_TESTCASE
(
¥–l2
, 
¥–lšg
) {

137 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

140 
db
.
	`add_¥–lšg
("h\xc3\xb6hle");

141 
db
.
	`add_¥–lšg
("ascii");

142 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hohle", 1), "h\xc3\xb6hle");

143 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hhle", 1), "h\xc3\xb6hle");

144 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("\xf0\xa8\xa8\x8f\xc3\xb6le", 2), "h\xc3\xb6hle");

145 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hh\xc3\xb6l"), "h\xc3\xb6hle");

146 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("as\xc3\xb6\xc3\xb7i"), "ascii");

147 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("asc\xc3\xb6i\xc3\xb7i"), "ascii");

148 
db
.
	`comm™
();

149 
X­Ÿn
::
D©aba£
 
	`dbr
(
	`g‘_wr™abË_d©aba£_as_d©aba£
());

150 
	`TEST_EQUAL
(
dbr
.
	`g‘_¥–lšg_sugge¡iÚ
("hohle", 1), "h\xc3\xb6hle");

151 
	`TEST_EQUAL
(
dbr
.
	`g‘_¥–lšg_sugge¡iÚ
("hhle", 1), "h\xc3\xb6hle");

152 
	`TEST_EQUAL
(
dbr
.
	`g‘_¥–lšg_sugge¡iÚ
("\xf0\xa8\xa8\x8f\xc3\xb6le", 2), "h\xc3\xb6hle");

153 
	`TEST_EQUAL
(
dbr
.
	`g‘_¥–lšg_sugge¡iÚ
("hh\xc3\xb6l"), "h\xc3\xb6hle");

154 
	`TEST_EQUAL
(
dbr
.
	`g‘_¥–lšg_sugge¡iÚ
("as\xc3\xb6\xc3\xb7i"), "ascii");

155 
	`TEST_EQUAL
(
dbr
.
	`g‘_¥–lšg_sugge¡iÚ
("asc\xc3\xb6i\xc3\xb7i"), "ascii");

157  
Œue
;

158 
	}
}

161 
	$DEFINE_TESTCASE
(
¥–l3
, 
¥–lšg
) {

162 
X­Ÿn
::
Wr™abËD©aba£
 
db1
 = 
	`g‘_wr™abË_d©aba£
();

166 
X­Ÿn
::
Wr™abËD©aba£
 
db2
 = 
	`g‘_Çmed_wr™abË_d©aba£
("spell3", "");

168 
db1
.
	`add_¥–lšg
("hello");

169 
db1
.
	`add_¥–lšg
("cell", 2);

170 
db2
.
	`add_¥–lšg
("hello", 2);

171 
db2
.
	`add_¥–lšg
("helo");

173 
X­Ÿn
::
D©aba£
 
db
;

174 
db
.
	`add_d©aba£
(
db1
);

175 
db
.
	`add_d©aba£
(
db2
);

177 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hello"), "");

178 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "hello");

179 
	`TEST_EQUAL
(
db1
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "cell");

180 
	`TEST_EQUAL
(
db2
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "hello");

184 
X­Ÿn
::
T”mI‹¿tÜ
 
	`i
(
db1
.
	`¥–lšgs_begš
());

185 
	`TEST_EQUAL
(*
i
, "cell");

186 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 2);

187 ++
i
;

188 
	`TEST_EQUAL
(*
i
, "hello");

189 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 1);

190 ++
i
;

191 
	`TEST
(
i
 =ğ
db1
.
	`¥–lšgs_’d
());

193 
i
 = 
db2
.
	`¥–lšgs_begš
();

194 
	`TEST_EQUAL
(*
i
, "hello");

195 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 2);

196 ++
i
;

197 
	`TEST_EQUAL
(*
i
, "helo");

198 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 1);

199 ++
i
;

200 
	`TEST
(
i
 =ğ
db2
.
	`¥–lšgs_’d
());

202 
i
 = 
db
.
	`¥–lšgs_begš
();

203 
	`TEST_EQUAL
(*
i
, "cell");

204 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 2);

205 ++
i
;

206 
	`TEST_EQUAL
(*
i
, "hello");

207 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 3);

208 ++
i
;

209 
	`TEST_EQUAL
(*
i
, "helo");

210 
	`TEST_EQUAL
(
i
.
	`g‘_‹rmäeq
(), 1);

211 ++
i
;

212 
	`TEST
(
i
 =ğ
db
.
	`¥–lšgs_’d
());

214  
Œue
;

215 
	}
}

218 
	$DEFINE_TESTCASE
(
¥–l4
, 
¥–lšg
) {

219 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

221 
db
.
	`add_¥–lšg
("check");

222 
db
.
	`add_¥–lšg
("pecks", 2);

223 
db
.
	`comm™
();

224 
db
.
	`add_¥–lšg
("becky");

225 
db
.
	`comm™
();

227 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("jeck", 2), "pecks");

229  
Œue
;

230 
	}
}

233 
	$DEFINE_TESTCASE
(
¥–l5
, 
¥–lšg
) {

234 cÚ¡ * 
rg‘
 = "\xe4\xb8\x80\xe4\xba\x9b";

236 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

237 
db
.
	`add_¥–lšg
(
rg‘
);

238 
db
.
	`comm™
();

240 
¡ršg
 
s
 = 
db
.
	`g‘_¥–lšg_sugge¡iÚ
("\xe4\xb8\x8d", 3);

241 
	`TEST_EQUAL
(
s
, 
rg‘
);

243  
Œue
;

244 
	}
}

247 
	$DEFINE_TESTCASE
(
¥–l6
, 
¥–lšg
) {

248 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

251 
db
.
	`add_¥–lšg
("hello", 2);

252 
db
.
	`add_¥–lšg
("sell", 3);

253 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "sell");

254 
db
.
	`comm™
();

255 
X­Ÿn
::
D©aba£
 
	`dbr
(
	`g‘_wr™abË_d©aba£_as_d©aba£
());

256 
	`TEST_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "sell");

257 
	`TEST_EQUAL
(
dbr
.
	`g‘_¥–lšg_sugge¡iÚ
("hell"), "sell");

259  
Œue
;

260 
	}
}

	@tests/api_spelling.h

2 
boŞ
 
‹¡_¥–l1
();

3 
boŞ
 
‹¡_¥–l2
();

4 
boŞ
 
‹¡_¥–l3
();

5 
boŞ
 
‹¡_¥–l4
();

6 
boŞ
 
‹¡_¥–l5
();

7 
boŞ
 
‹¡_¥–l6
();

	@tests/api_transdb.cc

21 
	~<cÚfig.h
>

23 
	~"­i_Œªsdb.h
"

25 
	~<x­Ÿn.h
>

27 
	~"­™e¡.h
"

28 
	~"‹¡uts.h
"

30 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	$DEFINE_TESTCASE
(
badŒª§ùiÚ1
, 
Œª§ùiÚs
) {

34 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
("apitest_simpledata"));

36 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`comm™_Œª§ùiÚ
());

37 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`ÿnûl_Œª§ùiÚ
());

39 
db
.
	`begš_Œª§ùiÚ
();

40 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`begš_Œª§ùiÚ
());

41 
db
.
	`comm™_Œª§ùiÚ
();

43 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`comm™_Œª§ùiÚ
());

44 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`ÿnûl_Œª§ùiÚ
());

46 
db
.
	`begš_Œª§ùiÚ
();

47 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`begš_Œª§ùiÚ
());

48 
db
.
	`ÿnûl_Œª§ùiÚ
();

50 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`comm™_Œª§ùiÚ
());

51 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`ÿnûl_Œª§ùiÚ
());

53 
db
.
	`begš_Œª§ùiÚ
();

54 
db
.
	`comm™_Œª§ùiÚ
();

56 
db
.
	`begš_Œª§ùiÚ
();

57 
db
.
	`ÿnûl_Œª§ùiÚ
();

59  
Œue
;

60 
	}
}

63 
	$DEFINE_TESTCASE
(
comm™Œª§ùiÚ1
, 
Œª§ùiÚs
) {

64 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
("apitest_simpledata"));

66 
X­Ÿn
::
doccouÁ
 
docs
 = 
db
.
	`g‘_doccouÁ
();

67 
db
.
	`begš_Œª§ùiÚ
();

68 
X­Ÿn
::
Docum’t
 
doc
;

69 
doc
.
	`£t_d©a
("testing");

70 
doc
.
	`add_‹rm
("befuddlement");

71 
db
.
	`add_docum’t
(
doc
);

72 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`begš_Œª§ùiÚ
());

73 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
docs
 + 1);

74 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("befuddlement"), 1);

75 
db
.
	`comm™_Œª§ùiÚ
();

76 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
docs
 + 1);

77 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("befuddlement"), 1);

79  
Œue
;

80 
	}
}

83 
	$DEFINE_TESTCASE
(
ÿnûÉ¿n§ùiÚ1
, 
Œª§ùiÚs
) {

84 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
("apitest_simpledata"));

86 
X­Ÿn
::
doccouÁ
 
docs
 = 
db
.
	`g‘_doccouÁ
();

87 
db
.
	`begš_Œª§ùiÚ
();

88 
X­Ÿn
::
Docum’t
 
doc
;

89 
doc
.
	`£t_d©a
("testing");

90 
doc
.
	`add_‹rm
("befuddlement");

91 
db
.
	`add_docum’t
(
doc
);

92 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
db
.
	`begš_Œª§ùiÚ
());

93 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
docs
 + 1);

94 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("befuddlement"), 1);

95 
db
.
	`ÿnûl_Œª§ùiÚ
();

96 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
docs
);

97 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("befuddlement"), 0);

99  
Œue
;

100 
	}
}

104 
	$DEFINE_TESTCASE
(
ÿnûÉ¿n§ùiÚ2
, 
Œª§ùiÚs
) {

105 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
("apitest_simpledata"));

107 
X­Ÿn
::
doccouÁ
 
docs
 = 
db
.
	`g‘_doccouÁ
();

108 
X­Ÿn
::
Docum’t
 
doc0
;

109 
doc0
.
	`£t_d©a
("pending");

110 
doc0
.
	`add_‹rm
("pending_update");

111 
X­Ÿn
::
docid
 docid = 
db
.
	`add_docum’t
(
doc0
);

113 
db
.
	`begš_Œª§ùiÚ
();

114 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
docs
 + 1);

115 
X­Ÿn
::
Docum’t
 
doc
;

116 
doc
.
	`£t_d©a
("testing");

117 
doc
.
	`add_‹rm
("befuddlement");

118 
db
.
	`add_docum’t
(
doc
);

119 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
docs
 + 2);

120 
db
.
	`ÿnûl_Œª§ùiÚ
();

122 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
docs
 + 1);

123 
	`TEST
(
db
.
	`‹rm_exi¡s
("pending_update"));

124 
X­Ÿn
::
Docum’t
 
doc_out
 = 
db
.
	`g‘_docum’t
(
docid
);

125 
	`TEST_EQUAL
(
doc_out
.
	`g‘_d©a
(), "pending");

127  
Œue
;

128 
	}
}

	@tests/api_transdb.h

2 
boŞ
 
‹¡_badŒª§ùiÚ1
();

3 
boŞ
 
‹¡_comm™Œª§ùiÚ1
();

4 
boŞ
 
‹¡_ÿnûÉ¿n§ùiÚ1
();

5 
boŞ
 
‹¡_ÿnûÉ¿n§ùiÚ2
();

	@tests/api_unicode.cc

21 
	~<cÚfig.h
>

23 
	~"­i_unicode.h
"

25 
	~<x­Ÿn.h
>

27 
	~"­™e¡.h
"

28 
	~"‹¡uts.h
"

30 
	~<cùy³
>

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	s‹¡ÿ£
 {

35 cÚ¡ * 
	ma
, * 
	mb
;

38 cÚ¡ 
‹¡ÿ£
 
	g‹¡ÿ£s
[] = {

46 
DEFINE_TESTCASE
(
utf8™”©Ü1
,!
back’d
) {

47 cÚ¡ 
‹¡ÿ£
 * 
	gp
;

48 
	gp
 = 
‹¡ÿ£s
;…->
	ga
; ++p) {

49 
	gtout
 << '"' << 
	gp
->
	ga
 << "\"‡nd \"" <<…->
	gb
 << '"' << 
	g’dl
;

50 
size_t
 
	ga_Ën
 = 
¡¾’
(
p
->
a
);

51 
	gX­Ÿn
::
Utf8I‹¿tÜ
 
a
(
p
->a, 
a_Ën
);

53 
size_t
 
	gb_Ën
 = 
¡¾’
(
p
->
b
);

54 
	gX­Ÿn
::
Utf8I‹¿tÜ
 
b
(
p
->b, 
b_Ën
);

56 
	ga
 !ğ
X­Ÿn
::
Utf8I‹¿tÜ
(è&& 
b
 != Xapian::Utf8Iterator()) {

57 
TEST_EQUAL
(*
a
, *
b
);

58 ++
	ga
;

59 ++
	gb
;

63 
TEST
(
a
 =ğ
X­Ÿn
::
Utf8I‹¿tÜ
());

64 
TEST
(
b
 =ğ
X­Ÿn
::
Utf8I‹¿tÜ
());

66  
	gŒue
;

69 
	s‹¡ÿ£2
 {

70 cÚ¡ * 
	ma
;

71 
	mn
;

74 cÚ¡ 
‹¡ÿ£2
 
	g‹¡ÿ£s2
[] = {

85 
DEFINE_TESTCASE
(
utf8™”©Ü2
,!
back’d
) {

86 cÚ¡ 
‹¡ÿ£2
 * 
	gp
;

87 
	gp
 = 
‹¡ÿ£s2
;…->
	ga
; ++p) {

88 
	gX­Ÿn
::
Utf8I‹¿tÜ
 
a
(
p
->a, 
¡¾’
(p->a));

90 
TEST
(
a
 !ğ
X­Ÿn
::
Utf8I‹¿tÜ
());

91 
TEST_EQUAL
(*
a
, 
p
->
n
);

92 
TEST
(++
a
 =ğ
X­Ÿn
::
Utf8I‹¿tÜ
());

94  
	gŒue
;

98 
DEFINE_TESTCASE
(
unicode1
,!
back’d
) {

99 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

100 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
('a'), Unicode::
LOWERCASE_LETTER
);

101 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
('0'), Unicode::
DECIMAL_DIGIT_NUMBER
);

102 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
('$'), Unicode::
CURRENCY_SYMBOL
);

103 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0xa3), Unicode::
CURRENCY_SYMBOL
);

105 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x242), Unicode::
LOWERCASE_LETTER
);

107 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x11A7), Unicode::
OTHER_LETTER
);

109 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x9FCB), Unicode::
OTHER_LETTER
);

111 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0xFA6C), Unicode::
OTHER_LETTER
);

112 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0xFFFF), Unicode::
UNASSIGNED
);

114 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x10345), Unicode::
OTHER_LETTER
);

115 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x10FFFD), Unicode::
PRIVATE_USE
);

116 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x10FFFF), Unicode::
UNASSIGNED
);

118 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x1109a), Unicode::
OTHER_LETTER
);

120 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x110000), Unicode::
UNASSIGNED
);

121 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0xFFFFFFFF), Unicode::
UNASSIGNED
);

122  
	gŒue
;

125 
DEFINE_TESTCASE
(
ÿ£cÚv”t1
,!
back’d
) {

126 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

127 
	gch
 = 0; ch < 128; ++ch) {

128 ià(
isuµ”
(()
ch
)) {

129 
TEST_EQUAL
(
Unicode
::
tŞow”
(
ch
), (tolower(()ch)));

131 
TEST_EQUAL
(
Unicode
::
tŞow”
(
ch
), ch);

133 ià(
i¦ow”
(()
ch
)) {

134 
TEST_EQUAL
(
Unicode
::
touµ”
(
ch
), (toupper(()ch)));

136 
TEST_EQUAL
(
Unicode
::
touµ”
(
ch
), ch);

141 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x242), 0x242);

142 
TEST_EQUAL
(
Unicode
::
touµ”
(0x242), 0x241);

143 
TEST_EQUAL
(
Unicode
::
touµ”
(0x241), 0x241);

144 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x241), 0x242);

147 
TEST_EQUAL
(
Unicode
::
tŞow”
(0xa3), 0xa3);

148 
TEST_EQUAL
(
Unicode
::
touµ”
(0xa3), 0xa3);

150 
TEST_EQUAL
(
Unicode
::
tŞow”
(0xFFFF), 0xFFFF);

151 
TEST_EQUAL
(
Unicode
::
touµ”
(0xFFFF), 0xFFFF);

153 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x10345), 0x10345);

154 
TEST_EQUAL
(
Unicode
::
touµ”
(0x10345), 0x10345);

155 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x10FFFD), 0x10FFFD);

156 
TEST_EQUAL
(
Unicode
::
touµ”
(0x10FFFD), 0x10FFFD);

157 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x10FFFF), 0x10FFFF);

158 
TEST_EQUAL
(
Unicode
::
touµ”
(0x10FFFF), 0x10FFFF);

160 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x110000), 0x110000);

161 
TEST_EQUAL
(
Unicode
::
touµ”
(0x110000), 0x110000);

162 
TEST_EQUAL
(
Unicode
::
tŞow”
(0xFFFFFFFF), 0xFFFFFFFF);

163 
TEST_EQUAL
(
Unicode
::
touµ”
(0xFFFFFFFF), 0xFFFFFFFF);

165  
	gŒue
;

169 
DEFINE_TESTCASE
(
ÿ£cÚv”t2
,!
back’d
) {

170 
usšg
 
Çme¥aû
 
	gX­Ÿn
;

172 
TEST_EQUAL
(
Unicode
::
touµ”
(0x250), 0x2c6f);

173 
TEST_EQUAL
(
Unicode
::
touµ”
(0x251), 0x2c6d);

174 
TEST_EQUAL
(
Unicode
::
touµ”
(0x271), 0x2c6e);

176 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x2ec), Unicode::
MODIFIER_LETTER
);

177 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x374), Unicode::
MODIFIER_LETTER
);

178 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x487), Unicode::
NON_SPACING_MARK
);

179 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x5be), Unicode::
DASH_PUNCTUATION
);

180 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(0x1f093), Unicode::
OTHER_SYMBOL
);

182 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x370), 0x371);

183 
TEST_EQUAL
(
Unicode
::
touµ”
(0x371), 0x370);

184 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x372), 0x373);

185 
TEST_EQUAL
(
Unicode
::
touµ”
(0x373), 0x372);

186 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x376), 0x377);

187 
TEST_EQUAL
(
Unicode
::
touµ”
(0x377), 0x376);

188 
TEST_EQUAL
(
Unicode
::
tŞow”
(0x3cf), 0x3d7);

189 
TEST_EQUAL
(
Unicode
::
touµ”
(0x3d7), 0x3cf);

191 
	gu
;

192 
	gu
 = 0x514; u < 0x524; u += 2) {

193 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(
u
), Unicode::
UPPERCASE_LETTER
);

194 
TEST_EQUAL
(
Unicode
::
g‘_ÿ‹gÜy
(
u
 + 1), Unicode::
LOWERCASE_LETTER
);

195 
TEST_EQUAL
(
Unicode
::
tŞow”
(
u
), u + 1);

196 
TEST_EQUAL
(
Unicode
::
touµ”
(
u
 + 1), u);

199  
	gŒue
;

202 
DEFINE_TESTCASE
(
utf8cÚv”t1
,!
back’d
) {

203 
¡ršg
 
	gs
;

204 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 'a');

205 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 128);

206 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 160);

207 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 0xFFFF);

208 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 166415);

209 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 0x10345);

210 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 0x10FFFD);

211 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 0xFFFFFFFF);

212 
	gX­Ÿn
::
Unicode
::
­³nd_utf8
(
s
, 'z');

213 
TEST_STRINGS_EQUAL
(
s
, "a"

224  
	gŒue
;

227 
DEFINE_TESTCASE
(
unicod•»diÿ‹s1
,!
back’d
) {

228 cÚ¡ 
	gwÜdch¬s
[] = {

251 cÚ¡ 
	gcu¼’cy
[] = {

256 cÚ¡ 
	gwh™e¥aû
[] = {

263 cÚ¡ 
	gÙh”
[] = {

275 cÚ¡ * 
	gp
 = 
wÜdch¬s
; *p; ++p) {

276 
TEST
(
X­Ÿn
::
Unicode
::
is_wÜdch¬
(*
p
));

277 
TEST
(!
X­Ÿn
::
Unicode
::
is_cu¼’cy
(*
p
));

278 
TEST
(!
X­Ÿn
::
Unicode
::
is_wh™e¥aû
(*
p
));

281 cÚ¡ * 
	gp
 = 
cu¼’cy
; *p; ++p) {

282 
TEST
(!
X­Ÿn
::
Unicode
::
is_wÜdch¬
(*
p
));

283 
TEST
(
X­Ÿn
::
Unicode
::
is_cu¼’cy
(*
p
));

284 
TEST
(!
X­Ÿn
::
Unicode
::
is_wh™e¥aû
(*
p
));

287 cÚ¡ * 
	gp
 = 
wh™e¥aû
; *p; ++p) {

288 
TEST
(!
X­Ÿn
::
Unicode
::
is_wÜdch¬
(*
p
));

289 
TEST
(!
X­Ÿn
::
Unicode
::
is_cu¼’cy
(*
p
));

290 
TEST
(
X­Ÿn
::
Unicode
::
is_wh™e¥aû
(*
p
));

293 cÚ¡ * 
	gp
 = 
Ùh”
; *p; ++p) {

294 
TEST
(!
X­Ÿn
::
Unicode
::
is_wÜdch¬
(*
p
));

295 
TEST
(!
X­Ÿn
::
Unicode
::
is_cu¼’cy
(*
p
));

296 
TEST
(!
X­Ÿn
::
Unicode
::
is_wh™e¥aû
(*
p
));

299  
	gŒue
;

	@tests/api_unicode.h

2 
boŞ
 
‹¡_utf8™”©Ü1
();

3 
boŞ
 
‹¡_utf8™”©Ü2
();

4 
boŞ
 
‹¡_unicode1
();

5 
boŞ
 
‹¡_ÿ£cÚv”t1
();

6 
boŞ
 
‹¡_ÿ£cÚv”t2
();

7 
boŞ
 
‹¡_utf8cÚv”t1
();

8 
boŞ
 
‹¡_unicod•»diÿ‹s1
();

	@tests/api_valuestats.cc

22 
	~<cÚfig.h
>

24 
	~"­i_v®ue¡©s.h
"

26 
	~<x­Ÿn.h
>

27 
	~"‹¡su™e.h
"

28 
	~"‹¡uts.h
"

30 
	~"­™e¡.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

38 
	$DEFINE_TESTCASE
(
v®ue¡©s1
, 
wr™abË
 && 
v®ue¡©s
) {

39 
X­Ÿn
::
Wr™abËD©aba£
 
db_w
 = 
	`g‘_wr™abË_d©aba£
();

42 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 0);

43 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "");

44 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "");

45 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 0);

46 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "");

47 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "");

49 
X­Ÿn
::
Docum’t
 
doc
;

50 
doc
.
	`add_v®ue
(0, "hello");

55 
db_w
.
	`add_docum’t
(
doc
);

56 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 0);

57 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "");

58 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "");

59 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 1);

60 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "hello");

61 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "hello");

64 
doc
 = 
X­Ÿn
::
	`Docum’t
();

65 
doc
.
	`add_v®ue
(0, "world");

66 
doc
.
	`add_v®ue
(1, "cheese");

67 
db_w
.
	`»¶aû_docum’t
(2, 
doc
);

68 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 2);

69 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "hello");

70 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "world");

71 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 1);

72 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "cheese");

73 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "cheese");

76 
db_w
.
	`d–‘e_docum’t
(1);

77 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 1);

78 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "cheese");

79 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "cheese");

80 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 1);

81 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "hello");

82 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "world");

85 
db_w
.
	`d–‘e_docum’t
(2);

86 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 0);

87 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "");

88 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "");

89 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 0);

90 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "");

91 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "");

95 
doc
 = 
X­Ÿn
::
	`Docum’t
();

96 
doc
.
	`add_v®ue
(1, "newval");

97 
db_w
.
	`»¶aû_docum’t
(2, 
doc
);

98 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 1);

99 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "newval");

100 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "newval");

101 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 0);

102 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "");

103 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "");

105  
Œue
;

106 
	}
}

109 
	$DEFINE_TESTCASE
(
v®ue¡©s2
, 
Œª§ùiÚs
 && 
v®ue¡©s
) {

110 
X­Ÿn
::
Wr™abËD©aba£
 
db_w
 = 
	`g‘_wr™abË_d©aba£
();

111 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

114 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 0);

115 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "");

116 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "");

117 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 0);

118 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "");

119 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "");

120 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(0), 0);

121 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(0), "");

122 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(0), "");

123 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(1), 0);

124 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(1), "");

125 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(1), "");

127 
X­Ÿn
::
Docum’t
 
doc
;

128 
doc
.
	`add_v®ue
(0, "hello");

133 
db_w
.
	`add_docum’t
(
doc
);

134 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 0);

135 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "");

136 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "");

137 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 1);

138 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "hello");

139 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "hello");

142 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(1), 0);

143 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(1), "");

144 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(1), "");

145 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(0), 0);

146 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(0), "");

147 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(0), "");

150 
doc
 = 
X­Ÿn
::
	`Docum’t
();

151 
doc
.
	`add_v®ue
(0, "world");

152 
doc
.
	`add_v®ue
(1, "cheese");

153 
db_w
.
	`»¶aû_docum’t
(2, 
doc
);

154 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 2);

155 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "hello");

156 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "world");

157 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 1);

158 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "cheese");

159 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "cheese");

162 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(0), 0);

163 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(0), "");

164 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(0), "");

165 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(1), 0);

166 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(1), "");

167 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(1), "");

170 
db_w
.
	`comm™
();

171 
db
.
	`»İ’
();

172 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(1), 1);

173 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(1), "cheese");

174 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(1), "cheese");

175 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(0), 2);

176 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(0), "hello");

177 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(0), "world");

180 
db_w
.
	`d–‘e_docum’t
(1);

181 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 1);

182 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "cheese");

183 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "cheese");

184 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 1);

185 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "hello");

186 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "world");

189 
db_w
.
	`d–‘e_docum’t
(2);

190 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 0);

191 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "");

192 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "");

193 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 0);

194 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "");

195 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "");

199 
doc
 = 
X­Ÿn
::
	`Docum’t
();

200 
doc
.
	`add_v®ue
(1, "newval");

201 
db_w
.
	`»¶aû_docum’t
(2, 
doc
);

202 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(1), 1);

203 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(1), "newval");

204 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(1), "newval");

205 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_äeq
(0), 0);

206 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_low”_bound
(0), "");

207 
	`TEST_EQUAL
(
db_w
.
	`g‘_v®ue_uµ”_bound
(0), "");

210 
db_w
.
	`comm™
();

211 
db
.
	`»İ’
();

212 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(0), 0);

213 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(0), "");

214 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(0), "");

215 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(1), 1);

216 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(1), "newval");

217 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(1), "newval");

219  
Œue
;

220 
	}
}

223 
	$DEFINE_TESTCASE
(
v®ue¡©s3
, 
v®ue¡©s
) {

224 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
("apitest_simpledata");

226 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(1), 6);

227 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(1), "h");

228 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(1), "n");

229 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(2), 6);

230 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(2), "d");

231 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(2), "i");

232 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(3), 6);

233 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(3), " ");

234 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(3), "s");

235 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(4), 6);

236 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(4), " ");

237 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(4), "y");

238 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(5), 6);

239 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(5), "e");

240 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(5), "p");

241 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(6), 6);

242 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(6), "a");

243 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(6), "t");

244 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(7), 6);

245 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(7), " ");

246 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(7), "r");

247 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(8), 6);

248 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(8), "a");

249 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(8), "t");

250 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(9), 6);

251 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(9), " ");

252 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(9), "n");

253 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(10), 6);

254 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(10), "e");

255 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(10), "w");

256 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(11), 6);

257 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(11), "\xb9P");

258 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(11), "\xc7\x04");

260  
Œue
;

261 
	}
}

263 
	$DEFINE_TESTCASE
(
v®ue¡©s4
, 
Œª§ùiÚs
 && 
v®ue¡©s
) {

264 cÚ¡ 
size_t
 
FLUSH_THRESHOLD
 = 10000;

266 
X­Ÿn
::
Wr™abËD©aba£
 
db_w
 = 
	`g‘_wr™abË_d©aba£
();

267 
X­Ÿn
::
Docum’t
 
doc
;

268 
doc
.
	`add_v®ue
(1, "test");

269 
size_t
 
i
 = 0; i < 
FLUSH_THRESHOLD
; ++i) {

270 
db_w
.
	`add_docum’t
(
doc
);

273 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

275 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
FLUSH_THRESHOLD
);

277 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(1), 
FLUSH_THRESHOLD
);

278 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(1), "test");

279 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(1), "test");

281 
db_w
.
	`begš_Œª§ùiÚ
();

282 
doc
.
	`add_v®ue
(1, "umbrella");

283 
db_w
.
	`ÿnûl_Œª§ùiÚ
();

287 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

289 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
FLUSH_THRESHOLD
);

291 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_äeq
(1), 
FLUSH_THRESHOLD
);

292 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_low”_bound
(1), "test");

293 
	`TEST_EQUAL
(
db
.
	`g‘_v®ue_uµ”_bound
(1), "test");

296  
Œue
;

297 
	}
}

300 
DEFINE_TESTCASE
(
v®ue¡©s5
, !
back’d
) {

301 
	gX­Ÿn
::
Docum’t
 
doc
;

302 
	gdoc
.
add_v®ue
(0, "zero");

303 
	gdoc
.
add_v®ue
(1, "one");

304 
	gdoc
.
add_v®ue
(2, "two");

305 
	gdoc
.
add_v®ue
(3, "three");

306 
	gdoc
.
add_v®ue
(4, "");

307 
	gdoc
.
add_v®ue
(5, "five");

308 
	gdoc
.
»move_v®ue
(3);

309 
	gdoc
.
add_v®ue
(1, "");

312 
size_t
 
	gc
 = 0;

313 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v
 = 
doc
.
v®ues_begš
();

314 
	gv
 !ğ
doc
.
v®ues_’d
()) {

315 
TEST
(!(*
v
).
em±y
());

316 ++
	gc
;

317 ++
	gv
;

319 
TEST_EQUAL
(
c
, 3);

321  
	gŒue
;

	@tests/api_valuestats.h

2 
boŞ
 
‹¡_v®ue¡©s1
();

3 
boŞ
 
‹¡_v®ue¡©s2
();

4 
boŞ
 
‹¡_v®ue¡©s3
();

5 
boŞ
 
‹¡_v®ue¡©s4
();

6 
boŞ
 
‹¡_v®ue¡©s5
();

	@tests/api_valuestream.cc

23 
	~<cÚfig.h
>

25 
	~"­i_v®ue¡»am.h
"

27 
	~<x­Ÿn.h
>

28 
	~"‹¡su™e.h
"

29 
	~"‹¡uts.h
"

31 
	~"­™e¡.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

36 
DEFINE_TESTCASE
(
v®ue¡»am1
, 
back’d
 && !
muÉi
) {

38 
	gX­Ÿn
::
D©aba£
 
db
 = 
g‘_d©aba£
("apitest_simpledata");

40 
	gX­Ÿn
::
v®u’o
 
¦Ù
 = 0; 
	g¦Ù
 < 15; ++slot) {

41 
	gtout
 << "‹¡šg v®ue¡»am i‹¿tiÚ fÜ slÙ " << 
	g¦Ù
 << 
	g’dl
;

42 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
™
 = 
db
.
v®ue¡»am_begš
(
¦Ù
);

43 
	g™
 !ğ
db
.
v®ue¡»am_’d
(
¦Ù
)) {

44 
TEST_EQUAL
(
™
.
g‘_v®u’o
(), 
¦Ù
);

45 
¡ršg
 
	gv®ue
 = *
™
;

46 
	gX­Ÿn
::
docid
 
did
 = 
™
.
g‘_docid
();

48 
	gX­Ÿn
::
Docum’t
 
doc
 = 
db
.
g‘_docum’t
(
did
);

49 
TEST_EQUAL
(
doc
.
g‘_v®ue
(
¦Ù
), 
v®ue
);

51 ++
	g™
;

55  
	gŒue
;

59 
	$DEFINE_TESTCASE
(
v®ue¡»am2
, 
back’d
) {

60 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
("etext");

62 
X­Ÿn
::
v®u’o
 
¦Ù
 = 0; slot < 15; ++slot) {

63 
š‹rv®
 = 1;

64 
š‹rv®
 < 1999) {

65 
tout
 << "‹¡šg v®ue¡»am sk_tØfÜ slÙ " << 
¦Ù


66 << " w™h iÁ”v® " << 
š‹rv®
 << 
’dl
;

67 
X­Ÿn
::
docid
 
did
 = 1;

68 
X­Ÿn
::
V®ueI‹¿tÜ
 
™
 = 
db
.
	`v®ue¡»am_begš
(
¦Ù
);

69 ià(
™
 =ğ
db
.
	`v®ue¡»am_’d
(
¦Ù
)) ;

70 
™
.
	`sk_to
(
did
), iˆ!ğ
db
.
	`v®ue¡»am_’d
(
¦Ù
)) {

71 
	`TEST_EQUAL
(
™
.
	`g‘_v®u’o
(), 
¦Ù
);

72 
¡ršg
 
v®ue
 = *
™
;

75 
X­Ÿn
::
docid
 
aùu®_did
 = 
™
.
	`g‘_docid
();

76 
	`TEST_REL
(
aùu®_did
,>=,
did
);

77 
did
 < 
aùu®_did
) {

78 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(
did
);

79 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(
¦Ù
), "");

80 ++
did
;

83 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(
aùu®_did
);

84 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(
¦Ù
), 
v®ue
);

85 
did
 +ğ
š‹rv®
;

87 
š‹rv®
 = interval * 3 - 1;

91  
Œue
;

92 
	}
}

95 
	$DEFINE_TESTCASE
(
v®ue¡»am3
, 
back’d
) {

96 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
("etext");

100 
CHECK
, 
CHECK_AND_NEXT
, 
CHECK2
, 
SKIP_TO
, 
CHECK_AND_LOOP


101 } 
	t‹¡_İ
;

102 
‹¡_İ
 
İ”©iÚ
 = 
CHECK
;

104 
X­Ÿn
::
v®u’o
 
¦Ù
 = 0; slot < 15; ++slot) {

105 
š‹rv®
 = 1;

106 
š‹rv®
 < 1999) {

107 
tout
 << "‹¡šg v®ue¡»am check fÜ slÙ " << 
¦Ù


108 << " w™h iÁ”v® " << 
š‹rv®
 << 
’dl
;

109 
X­Ÿn
::
docid
 
did
 = 1;

110 
X­Ÿn
::
V®ueI‹¿tÜ
 
™
 = 
db
.
	`v®ue¡»am_begš
(
¦Ù
);

111 ià(
™
 =ğ
db
.
	`v®ue¡»am_’d
(
¦Ù
)) ;

112 
Œue
) {

113 
boŞ
 
pos™iÚed
 = 
Œue
;

114 
İ”©iÚ
) {

115 
CHECK_AND_LOOP
:

116 
İ”©iÚ
 = 
CHECK
;

118 
CHECK
: 
CHECK2
:

119 
pos™iÚed
 = 
™
.
	`check
(
did
);

121 
CHECK_AND_NEXT
: {

122 
boŞ
 
was_sk_to
 = 
™
.
	`check
(
did
);

123 ià(!
was_sk_to
è++
™
;

126 
SKIP_TO
:

127 
™
.
	`sk_to
(
did
);

130 
İ”©iÚ
 = 
	`‹¡_İ
(operation + 1);

131 ià(
pos™iÚed
) {

132 ià(
™
 =ğ
db
.
	`v®ue¡»am_’d
(
¦Ù
)) ;

133 
	`TEST_EQUAL
(
™
.
	`g‘_v®u’o
(), 
¦Ù
);

134 
¡ršg
 
v®ue
 = *
™
;

137 
X­Ÿn
::
docid
 
aùu®_did
 = 
™
.
	`g‘_docid
();

138 
did
 < 
aùu®_did
) {

139 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(
did
);

140 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(
¦Ù
), "");

141 ++
did
;

144 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(
aùu®_did
);

145 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(
¦Ù
), 
v®ue
);

147 
did
 +ğ
š‹rv®
;

149 
š‹rv®
 = interval * 3 - 1;

153  
Œue
;

154 
	}
}

160 
	$DEFINE_TESTCASE
(
v®ueweightsourû5
, 
wr™abË
 && 
v®ue¡©s
) {

162 
	`SKIP_TEST_FOR_BACKEND
("inmemory");

166 
	`SKIP_TEST_FOR_BACKEND
("remote");

167 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

168 
X­Ÿn
::
Docum’t
 
doc
;

169 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(3.14));

170 
db
.
	`»¶aû_docum’t
(1, 
doc
);

171 
db
.
	`»¶aû_docum’t
(0xffffffff, 
doc
);

172 
db
.
	`comm™
();

174 
X­Ÿn
::
V®ueWeightPo¡šgSourû
 
	`¤c
(1);

175 
¤c
.
	`š™
(
db
);

176 
¤c
.
	`Ãxt
(0.0);

177 
	`TEST
(!
¤c
.
	`©_’d
());

178 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

179 
¤c
.
	`Ãxt
(0.0);

180 
	`TEST
(!
¤c
.
	`©_’d
());

181 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 0xffffffff);

182 
¤c
.
	`Ãxt
(0.0);

183 
	`TEST
(
¤c
.
	`©_’d
());

185  
Œue
;

186 
	}
}

208 
	$DEFINE_TESTCASE
(
v®uem­sourû1
, 
back’d
) {

209 
X­Ÿn
::
D©aba£
 
	`db
(
	`g‘_d©aba£
("apitest_phrase"));

210 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

212 
X­Ÿn
::
V®ueM­Po¡šgSourû
 
	`¤c
(13);

213 
¤c
.
	`add_m­pšg
("Thi", 2.0);

214 
¤c
.
	`add_m­pšg
("The", 1.0);

215 
¤c
.
	`add_m­pšg
("You", 3.0);

216 
¤c
.
	`add_m­pšg
("War", 4.0);

217 
¤c
.
	`add_m­pšg
("Fri", 5.0);

220 
’q
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(&
¤c
));

221 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 5);

223 
	`TEST
(
m£t
.
	`size
() == 5);

224 
	`m£t_ex³ù_Üd”
(
m£t
, 5, 4, 3, 1, 2);

227 
¤c
.
	`ş—r_m­pšgs
();

228 
¤c
.
	`£t_deçuÉ_weight
(3.5);

229 
¤c
.
	`add_m­pšg
("Thi", 2.0);

230 
¤c
.
	`add_m­pšg
("The", 1.0);

231 
¤c
.
	`add_m­pšg
("You", 3.0);

232 
¤c
.
	`add_m­pšg
("War", 4.0);

233 
¤c
.
	`add_m­pšg
("Fri", 5.0);

235 
’q
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(&
¤c
));

236 
m£t
 = 
’q
.
	`g‘_m£t
(0, 5);

238 
	`TEST
(
m£t
.
	`size
() == 5);

239 
	`m£t_ex³ù_Üd”
(
m£t
, 5, 4, 6, 7, 8);

241  
Œue
;

242 
	}
}

246 
DEFINE_TESTCASE
(
v®uem­sourû2
, 
back’d
 && !
muÉi
) {

247 
	gX­Ÿn
::
D©aba£
 
db
(
g‘_d©aba£
("apitest_phrase"));

250 
	gX­Ÿn
::
V®ueM­Po¡šgSourû
 
¤c
(100);

251 
	g¤c
.
š™
(
db
);

252 
TEST
(
¤c
.
©_’d
(è=ğ
çl£
);

253 
	g¤c
.
Ãxt
(0.0);

254 
TEST
(
¤c
.
©_’d
(è=ğ
Œue
);

258 
	gX­Ÿn
::
V®ueM­Po¡šgSourû
 
¤c
(100);

259 
	g¤c
.
š™
(
db
);

260 
TEST
(
¤c
.
©_’d
(è=ğ
çl£
);

261 
	g¤c
.
sk_to
(1, 0.0);

262 
TEST
(
¤c
.
©_’d
(è=ğ
Œue
);

266 
	gX­Ÿn
::
V®ueM­Po¡šgSourû
 
¤c
(100);

267 
	g¤c
.
š™
(
db
);

268 
TEST
(
¤c
.
©_’d
(è=ğ
çl£
);

269 
	g¤c
.
check
(1, 0.0);

270 
TEST
(
¤c
.
©_’d
(è=ğ
Œue
);

273  
	gŒue
;

278 
DEFINE_TESTCASE
(
fixedweightsourû2
, !
back’d
) {

279 
	gX­Ÿn
::
D©aba£
 
db
;

282 
	gX­Ÿn
::
FixedWeightPo¡šgSourû
 
¤c
(5.0);

283 
	g¤c
.
š™
(
db
);

284 
TEST
(
¤c
.
©_’d
(è=ğ
çl£
);

285 
	g¤c
.
Ãxt
(0.0);

286 
TEST
(
¤c
.
©_’d
(è=ğ
Œue
);

290 
	gX­Ÿn
::
FixedWeightPo¡šgSourû
 
¤c
(5.0);

291 
	g¤c
.
š™
(
db
);

292 
TEST
(
¤c
.
©_’d
(è=ğ
çl£
);

293 
	g¤c
.
sk_to
(1, 0.0);

294 
TEST
(
¤c
.
©_’d
(è=ğ
Œue
);

301  
	gŒue
;

305 
	$DEFINE_TESTCASE
(
decv®wtsourû1
, 
wr™abË
) {

306 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

308 
X­Ÿn
::
Docum’t
 
doc
;

309 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(3));

310 
db
.
	`add_docum’t
(
doc
);

311 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(2));

312 
db
.
	`add_docum’t
(
doc
);

313 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(1));

314 
db
.
	`add_docum’t
(
doc
);

315 
db
.
	`comm™
();

319 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1);

320 
¤c
.
	`š™
(
db
);

322 
¤c
.
	`Ãxt
(0.0);

323 
	`TEST
(!
¤c
.
	`©_’d
());

324 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

326 
¤c
.
	`Ãxt
(0.0);

327 
	`TEST
(!
¤c
.
	`©_’d
());

328 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

330 
¤c
.
	`Ãxt
(0.0);

331 
	`TEST
(!
¤c
.
	`©_’d
());

332 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 3);

334 
¤c
.
	`Ãxt
(0.0);

335 
	`TEST
(
¤c
.
	`©_’d
());

340 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1);

341 
¤c
.
	`š™
(
db
);

343 
¤c
.
	`Ãxt
(1.5);

344 
	`TEST
(!
¤c
.
	`©_’d
());

345 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

347 
¤c
.
	`Ãxt
(1.5);

348 
	`TEST
(!
¤c
.
	`©_’d
());

349 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

351 
¤c
.
	`Ãxt
(1.5);

352 
	`TEST
(
¤c
.
	`©_’d
());

356 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(2));

357 
db
.
	`add_docum’t
(
doc
);

360 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1, 1, 3);

361 
¤c
.
	`š™
(
db
);

363 
¤c
.
	`Ãxt
(1.5);

364 
	`TEST
(!
¤c
.
	`©_’d
());

365 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

367 
¤c
.
	`Ãxt
(1.5);

368 
	`TEST
(!
¤c
.
	`©_’d
());

369 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

371 
¤c
.
	`Ãxt
(1.5);

372 
	`TEST
(!
¤c
.
	`©_’d
());

373 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 4);

375 
¤c
.
	`Ãxt
(1.5);

376 
	`TEST
(
¤c
.
	`©_’d
());

380 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1, 1, 3);

381 
¤c
.
	`š™
(
db
);

383 
¤c
.
	`Ãxt
(1.5);

384 
	`TEST
(!
¤c
.
	`©_’d
());

385 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

387 
¤c
.
	`sk_to
(3, 1.5);

388 
	`TEST
(!
¤c
.
	`©_’d
());

389 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 4);

391 
¤c
.
	`Ãxt
(1.5);

392 
	`TEST
(
¤c
.
	`©_’d
());

396 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1, 1, 3);

397 
¤c
.
	`š™
(
db
);

399 
¤c
.
	`Ãxt
(1.5);

400 
	`TEST
(!
¤c
.
	`©_’d
());

401 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

403 
	`TEST
(
¤c
.
	`check
(3, 1.5));

404 
	`TEST
(!
¤c
.
	`©_’d
());

405 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 4);

407 
¤c
.
	`Ãxt
(1.5);

408 
	`TEST
(
¤c
.
	`©_’d
());

411  
Œue
;

412 
	}
}

416 
	$DEFINE_TESTCASE
(
decv®wtsourû2
, 
wr™abË
) {

417 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

419 
X­Ÿn
::
Docum’t
 
doc
;

420 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(1));

421 
db
.
	`add_docum’t
(
doc
);

422 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(3));

423 
db
.
	`add_docum’t
(
doc
);

424 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(3));

425 
db
.
	`add_docum’t
(
doc
);

426 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(1));

427 
db
.
	`add_docum’t
(
doc
);

428 
db
.
	`comm™
();

432 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1);

433 
¤c
.
	`š™
(
db
);

435 
¤c
.
	`Ãxt
(0.0);

436 
	`TEST
(!
¤c
.
	`©_’d
());

437 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

439 
¤c
.
	`Ãxt
(0.0);

440 
	`TEST
(!
¤c
.
	`©_’d
());

441 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

443 
¤c
.
	`Ãxt
(0.0);

444 
	`TEST
(!
¤c
.
	`©_’d
());

445 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 3);

447 
¤c
.
	`Ãxt
(0.0);

448 
	`TEST
(!
¤c
.
	`©_’d
());

449 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 4);

451 
¤c
.
	`Ãxt
(0.0);

452 
	`TEST
(
¤c
.
	`©_’d
());

457 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1, 2);

458 
¤c
.
	`š™
(
db
);

460 
¤c
.
	`Ãxt
(1.5);

461 
	`TEST
(!
¤c
.
	`©_’d
());

462 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

464 
¤c
.
	`Ãxt
(1.5);

465 
	`TEST
(!
¤c
.
	`©_’d
());

466 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

468 
¤c
.
	`Ãxt
(1.5);

469 
	`TEST
(!
¤c
.
	`©_’d
());

470 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 3);

472 
¤c
.
	`Ãxt
(1.5);

473 
	`TEST
(
¤c
.
	`©_’d
());

477 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(2));

478 
db
.
	`add_docum’t
(
doc
);

481 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1, 2, 4);

482 
¤c
.
	`š™
(
db
);

484 
¤c
.
	`Ãxt
(1.5);

485 
	`TEST
(!
¤c
.
	`©_’d
());

486 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

488 
¤c
.
	`Ãxt
(1.5);

489 
	`TEST
(!
¤c
.
	`©_’d
());

490 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

492 
¤c
.
	`Ãxt
(1.5);

493 
	`TEST
(!
¤c
.
	`©_’d
());

494 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 3);

496 
¤c
.
	`Ãxt
(1.5);

497 
	`TEST
(!
¤c
.
	`©_’d
());

498 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 5);

500 
¤c
.
	`Ãxt
(1.5);

501 
	`TEST
(
¤c
.
	`©_’d
());

505 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1, 2, 4);

506 
¤c
.
	`š™
(
db
);

508 
	`TEST
(
¤c
.
	`check
(1, 1.5));

509 
	`TEST
(!
¤c
.
	`©_’d
());

510 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

512 
¤c
.
	`Ãxt
(1.5);

513 
	`TEST
(!
¤c
.
	`©_’d
());

514 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

516 
¤c
.
	`sk_to
(4, 1.5);

517 
	`TEST
(!
¤c
.
	`©_’d
());

518 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 5);

520 
¤c
.
	`Ãxt
(1.5);

521 
	`TEST
(
¤c
.
	`©_’d
());

525 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`¤c
(1, 2, 4);

526 
¤c
.
	`š™
(
db
);

528 
	`TEST
(
¤c
.
	`check
(1, 1.5));

529 
	`TEST
(!
¤c
.
	`©_’d
());

530 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 1);

532 
¤c
.
	`Ãxt
(1.5);

533 
	`TEST
(!
¤c
.
	`©_’d
());

534 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 2);

536 
	`TEST
(
¤c
.
	`check
(4, 1.5));

537 
	`TEST
(!
¤c
.
	`©_’d
());

538 
	`TEST_EQUAL
(
¤c
.
	`g‘_docid
(), 5);

540 
¤c
.
	`Ãxt
(1.5);

541 
	`TEST
(
¤c
.
	`©_’d
());

544  
Œue
;

545 
	}
}

548 
	$DEFINE_TESTCASE
(
decv®wtsourû3
, 
wr™abË
) {

549 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

551 
X­Ÿn
::
Docum’t
 
doc
;

552 
doc
.
	`add_‹rm
("foo");

553 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(1));

554 
db
.
	`add_docum’t
(
doc
);

555 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(3));

556 
db
.
	`add_docum’t
(
doc
);

557 
doc
.
	`add_‹rm
("bar");

558 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(3));

559 
db
.
	`add_docum’t
(
doc
);

560 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(1));

561 
db
.
	`add_docum’t
(
doc
);

562 
db
.
	`comm™
();

564 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`ps
(1, 2, 5);

565 
X­Ÿn
::
Qu”y
 
	`q
(&
ps
);

566 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

567 
’q
.
	`£t_qu”y
(
q
);

569 
X­Ÿn
::
MS‘
 
	`m£t1
(
’q
.
	`g‘_m£t
(0, 1));

570 
X­Ÿn
::
MS‘
 
	`m£t2
(
’q
.
	`g‘_m£t
(0, 2));

571 
X­Ÿn
::
MS‘
 
	`m£t3
(
’q
.
	`g‘_m£t
(0, 3));

572 
X­Ÿn
::
MS‘
 
	`m£t4
(
’q
.
	`g‘_m£t
(0, 4));

574 
	`TEST_EQUAL
(
m£t1
.
	`size
(), 1);

575 
	`TEST_EQUAL
(
m£t2
.
	`size
(), 2);

576 
	`TEST_EQUAL
(
m£t3
.
	`size
(), 3);

577 
	`TEST_EQUAL
(
m£t4
.
	`size
(), 4);

579 
	`TEST
(
	`m£t_¿nge_is_§me
(
m£t1
, 0, 
m£t2
, 0, 1));

580 
	`TEST
(
	`m£t_¿nge_is_§me
(
m£t2
, 0, 
m£t3
, 0, 2));

581 
	`TEST
(
	`m£t_¿nge_is_§me
(
m£t3
, 0, 
m£t4
, 0, 3));

583  
Œue
;

584 
	}
}

588 
DEFINE_TESTCASE
(
decv®wtsourû4
, 
back’d
 && !
muÉi
) {

589 
	gX­Ÿn
::
D©aba£
 
db
 = 
g‘_d©aba£
("apitest_declen");

591 
	gX­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
ps
(11, 2, 5);

592 
	gX­Ÿn
::
Qu”y
 
q
(&
ps
);

593 
	gX­Ÿn
::
Enquœe
 
’q
(
db
);

594 
	g’q
.
£t_qu”y
(
q
);

596 
	gX­Ÿn
::
MS‘
 
m£t1
(
’q
.
g‘_m£t
(0, 1));

597 
	gX­Ÿn
::
MS‘
 
m£t2
(
’q
.
g‘_m£t
(0, 2));

598 
	gX­Ÿn
::
MS‘
 
m£t3
(
’q
.
g‘_m£t
(0, 3));

599 
	gX­Ÿn
::
MS‘
 
m£t4
(
’q
.
g‘_m£t
(0, 4));

601 
TEST_EQUAL
(
m£t1
.
size
(), 1);

602 
TEST_EQUAL
(
m£t2
.
size
(), 2);

603 
TEST_EQUAL
(
m£t3
.
size
(), 3);

604 
TEST_EQUAL
(
m£t4
.
size
(), 4);

606 
TEST
(
m£t_¿nge_is_§me
(
m£t1
, 0, 
m£t2
, 0, 1));

607 
TEST
(
m£t_¿nge_is_§me
(
m£t2
, 0, 
m£t3
, 0, 2));

608 
TEST
(
m£t_¿nge_is_§me
(
m£t3
, 0, 
m£t4
, 0, 3));

610  
	gŒue
;

615 
	$DEFINE_TESTCASE
(
decv®wtsourû5
, 
wr™abË
) {

616 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

618 
X­Ÿn
::
Docum’t
 
doc
;

619 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(1));

620 
db
.
	`add_docum’t
(
doc
);

621 
doc
.
	`add_v®ue
(2, 
X­Ÿn
::
	`sÜbË_£rŸli£
(1));

622 
db
.
	`add_docum’t
(
doc
);

623 
db
.
	`comm™
();

626 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`ps
(1);

627 
X­Ÿn
::
Qu”y
 
	`q
(&
ps
);

628 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

629 
’q
.
	`£t_qu”y
(
q
);

630 
X­Ÿn
::
MS‘
 
	`m£t1
(
’q
.
	`g‘_m£t
(0, 3));

631 
	`TEST_EQUAL
(
m£t1
.
	`size
(), 2);

634 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`ps
(2);

635 
X­Ÿn
::
Qu”y
 
	`q
(&
ps
);

636 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

637 
’q
.
	`£t_qu”y
(
q
);

638 
X­Ÿn
::
MS‘
 
	`m£t1
(
’q
.
	`g‘_m£t
(0, 3));

639 
	`TEST_EQUAL
(
m£t1
.
	`size
(), 1);

642 
X­Ÿn
::
Deü—sšgV®ueWeightPo¡šgSourû
 
	`ps
(3);

643 
X­Ÿn
::
Qu”y
 
	`q
(&
ps
);

644 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

645 
’q
.
	`£t_qu”y
(
q
);

646 
X­Ÿn
::
MS‘
 
	`m£t1
(
’q
.
	`g‘_m£t
(0, 3));

647 
	`TEST_EQUAL
(
m£t1
.
	`size
(), 0);

650  
Œue
;

651 
	}
}

	@tests/api_valuestream.h

2 
boŞ
 
‹¡_v®ue¡»am1
();

3 
boŞ
 
‹¡_v®ue¡»am2
();

4 
boŞ
 
‹¡_v®ue¡»am3
();

5 
boŞ
 
‹¡_v®ueweightsourû5
();

6 
boŞ
 
‹¡_v®uem­sourû1
();

7 
boŞ
 
‹¡_v®uem­sourû2
();

8 
boŞ
 
‹¡_fixedweightsourû2
();

9 
boŞ
 
‹¡_decv®wtsourû1
();

10 
boŞ
 
‹¡_decv®wtsourû2
();

11 
boŞ
 
‹¡_decv®wtsourû3
();

12 
boŞ
 
‹¡_decv®wtsourû4
();

13 
boŞ
 
‹¡_decv®wtsourû5
();

	@tests/api_wrdb.cc

26 
	~<cÚfig.h
>

28 
	~"­i_wrdb.h
"

30 
	~<x­Ÿn.h
>

32 
	~"back’dmªag”.h
"

33 
	~"omas£¹.h
"

34 
	~"‹¡su™e.h
"

35 
	~"‹¡uts.h
"

36 
	~"uts.h
"

37 
	~"unixcmds.h
"

39 
	~"­™e¡.h
"

41 
	~<cm©h
>

42 
	~<c¡dlib
>

43 
	~<m­
>

44 
	~<¡ršg
>

46 
usšg
 
Çme¥aû
 
	g¡d
;

53 
	$DEFINE_TESTCASE
(
adddoc1
, 
wr™abË
) {

54 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

56 
X­Ÿn
::
Docum’t
 
doc1
, 
doc2
, 
doc3
;

61 
doc1
.
	`£t_d©a
(
	`¡ršg
("tom"));

62 
doc1
.
	`add_po¡šg
("foo", 1);

63 
doc1
.
	`add_po¡šg
("foo", 1);

64 
doc1
.
	`add_po¡šg
("foo", 1);

65 
doc1
.
	`add_po¡šg
("bar", 3);

66 
doc1
.
	`add_po¡šg
("bar", 4);

67 
db
.
	`add_docum’t
(
doc1
);

69 
doc2
.
	`£t_d©a
(
	`¡ršg
("dick"));

70 
doc2
.
	`add_po¡šg
("foo", 1);

71 
doc2
.
	`add_po¡šg
("foo", 2);

72 
doc2
.
	`add_po¡šg
("bar", 3);

73 
doc2
.
	`add_po¡šg
("bar", 3);

74 
doc2
.
	`add_po¡šg
("bar", 3);

75 
db
.
	`add_docum’t
(
doc2
);

77 
doc3
.
	`£t_d©a
(
	`¡ršg
("harry"));

78 
doc3
.
	`add_po¡šg
("foo", 1);

79 
doc3
.
	`add_po¡šg
("foo", 1);

80 
doc3
.
	`add_po¡šg
("foo", 2);

81 
doc3
.
	`add_po¡šg
("foo", 2);

82 
doc3
.
	`add_po¡šg
("bar", 3);

83 
db
.
	`add_docum’t
(
doc3
);

85 
X­Ÿn
::
Qu”y
 
	`qu”y
("foo");

87 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

88 
’q
.
	`£t_qu”y
(
qu”y
);

90 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 10);

92 
	`m£t_ex³ù_Üd”
(
m£t
, 3, 1, 2);

94  
Œue
;

95 
	}
}

98 
	$DEFINE_TESTCASE
(
adddoc2
, 
wr™abË
) {

99 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

101 
X­Ÿn
::
Docum’t
 
doc1
;

103 
doc1
.
	`add_po¡šg
("foo", 1);

104 
doc1
.
	`add_po¡šg
("foo", 1);

105 
doc1
.
	`add_po¡šg
("foo", 2);

106 
doc1
.
	`add_po¡šg
("foo", 2);

107 
doc1
.
	`add_po¡šg
("bar", 3);

108 
doc1
.
	`add_po¡šg
("gone", 1);

111 
doc1
.
	`add_po¡šg
("fooXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX", 1);

112 
X­Ÿn
::
docid
 
did
;

114 
X­Ÿn
::
Docum’t
 
doc2
 = 
db
.
	`g‘_docum’t
(
did
 = db.
	`add_docum’t
(
doc1
));

115 
	`TEST_EQUAL
(
did
, 1);

117 
X­Ÿn
::
T”mI‹¿tÜ
 
™”1
 = 
doc1
.
	`‹rmli¡_begš
();

118 
X­Ÿn
::
T”mI‹¿tÜ
 
™”2
 = 
doc2
.
	`‹rmli¡_begš
();

119 
	`TEST
(
™”1
 !ğ
doc1
.
	`‹rmli¡_’d
());

120 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

121 
	`TEST_EQUAL
(*
™”1
, "bar");

122 
	`TEST_EQUAL
(*
™”2
, *
™”1
);

123 
	`TEST_EQUAL
(
™”1
.
	`g‘_wdf
(), 1);

124 
	`TEST_EQUAL
(
™”2
.
	`g‘_wdf
(), 1);

126 
	`TEST_EQUAL
(
™”2
.
	`g‘_‹rmäeq
(), 1);

128 
™”1
++;

129 
™”2
++;

130 
	`TEST
(
™”1
 !ğ
doc1
.
	`‹rmli¡_’d
());

131 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

132 
	`TEST_EQUAL
(*
™”1
, "foo");

133 
	`TEST_EQUAL
(*
™”2
, *
™”1
);

134 
	`TEST_EQUAL
(
™”1
.
	`g‘_wdf
(), 4);

135 
	`TEST_EQUAL
(
™”2
.
	`g‘_wdf
(), 4);

137 
	`TEST_EQUAL
(
™”2
.
	`g‘_‹rmäeq
(), 1);

139 
™”1
++;

140 
™”2
++;

141 
	`TEST
(
™”1
 !ğ
doc1
.
	`‹rmli¡_’d
());

142 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

143 
	`TEST_EQUAL
(*
™”1
, "fooXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX");

144 
	`TEST_EQUAL
(*
™”2
, *
™”1
);

145 
	`TEST_EQUAL
(
™”1
.
	`g‘_wdf
(), 1);

146 
	`TEST_EQUAL
(
™”2
.
	`g‘_wdf
(), 1);

148 
	`TEST_EQUAL
(
™”2
.
	`g‘_‹rmäeq
(), 1);

150 
™”1
++;

151 
™”2
++;

152 
	`TEST
(
™”1
 !ğ
doc1
.
	`‹rmli¡_’d
());

153 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

154 
	`TEST_EQUAL
(*
™”1
, "gone");

155 
	`TEST_EQUAL
(*
™”2
, *
™”1
);

156 
	`TEST_EQUAL
(
™”1
.
	`g‘_wdf
(), 1);

157 
	`TEST_EQUAL
(
™”2
.
	`g‘_wdf
(), 1);

159 
	`TEST_EQUAL
(
™”2
.
	`g‘_‹rmäeq
(), 1);

161 
™”1
++;

162 
™”2
++;

163 
	`TEST
(
™”1
 =ğ
doc1
.
	`‹rmli¡_’d
());

164 
	`TEST
(
™”2
 =ğ
doc2
.
	`‹rmli¡_’d
());

166 
doc2
.
	`»move_po¡šg
("foo", 1, 5);

167 
doc2
.
	`add_‹rm
("bat", 0);

168 
doc2
.
	`add_‹rm
("bar", 8);

169 
doc2
.
	`add_‹rm
("bag", 0);

170 
doc2
.
	`»move_‹rm
("gone");

171 
doc2
.
	`»move_‹rm
("fooXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX");

176 
™”2
 = 
doc2
.
	`‹rmli¡_begš
();

177 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

178 
	`TEST_EQUAL
(*
™”2
, "bag");

180 
™”2
++;

181 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

182 
	`TEST_EQUAL
(*
™”2
, "bar");

184 
™”2
++;

185 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

186 
	`TEST_EQUAL
(*
™”2
, "bat");

188 
™”2
++;

189 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

190 
	`TEST_EQUAL
(*
™”2
, "foo");

192 
™”2
++;

193 
	`TEST
(
™”2
 =ğ
doc2
.
	`‹rmli¡_’d
());

195 
doc1
 = 
db
.
	`g‘_docum’t
(
did
 = db.
	`add_docum’t
(
doc2
));

196 
	`TEST_EQUAL
(
did
, 2);

198 
™”1
 = 
doc1
.
	`‹rmli¡_begš
();

199 
™”2
 = 
doc2
.
	`‹rmli¡_begš
();

200 
	`TEST
(
™”1
 !ğ
doc1
.
	`‹rmli¡_’d
());

201 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

202 
	`TEST_EQUAL
(*
™”1
, "bag");

203 
	`TEST_EQUAL
(*
™”2
, *
™”1
);

204 
	`TEST_EQUAL
(
™”1
.
	`g‘_wdf
(), 0);

205 
	`TEST_EQUAL
(
™”2
.
	`g‘_wdf
(), 0);

206 
	`TEST_EQUAL
(
™”1
.
	`g‘_‹rmäeq
(), 1);

208 
	`TEST
(
™”1
.
	`pos™iÚli¡_begš
(è=ğ™”1.
	`pos™iÚli¡_’d
());

209 
	`TEST
(
™”2
.
	`pos™iÚli¡_begš
(è=ğ™”2.
	`pos™iÚli¡_’d
());

211 
™”1
++;

212 
™”2
++;

213 
	`TEST
(
™”1
 !ğ
doc1
.
	`‹rmli¡_’d
());

214 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

215 
	`TEST_EQUAL
(*
™”1
, "bar");

216 
	`TEST_EQUAL
(*
™”2
, *
™”1
);

217 
	`TEST_EQUAL
(
™”1
.
	`g‘_wdf
(), 9);

218 
	`TEST_EQUAL
(
™”2
.
	`g‘_wdf
(), 9);

219 
	`TEST_EQUAL
(
™”1
.
	`g‘_‹rmäeq
(), 2);

222 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pi1
;

223 
pi1
 = 
™”1
.
	`pos™iÚli¡_begš
();

224 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pi2
 = 
™”2
.
	`pos™iÚli¡_begš
();

225 
	`TEST_EQUAL
(*
pi1
, 3);…i1++;

226 
	`TEST_EQUAL
(*
pi2
, 3);…i2++;

227 
	`TEST
(
pi1
 =ğ
™”1
.
	`pos™iÚli¡_’d
());

228 
	`TEST
(
pi2
 =ğ
™”2
.
	`pos™iÚli¡_’d
());

230 
™”1
++;

231 
™”2
++;

232 
	`TEST
(
™”1
 !ğ
doc1
.
	`‹rmli¡_’d
());

233 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

234 
	`TEST_EQUAL
(*
™”1
, "bat");

235 
	`TEST_EQUAL
(*
™”2
, *
™”1
);

236 
	`TEST_EQUAL
(
™”1
.
	`g‘_wdf
(), 0);

237 
	`TEST_EQUAL
(
™”2
.
	`g‘_wdf
(), 0);

238 
	`TEST_EQUAL
(
™”1
.
	`g‘_‹rmäeq
(), 1);

240 
	`TEST
(
™”1
.
	`pos™iÚli¡_begš
(è=ğ™”1.
	`pos™iÚli¡_’d
());

241 
	`TEST
(
™”2
.
	`pos™iÚli¡_begš
(è=ğ™”2.
	`pos™iÚli¡_’d
());

243 
™”1
++;

244 
™”2
++;

245 
	`TEST
(
™”1
 !ğ
doc1
.
	`‹rmli¡_’d
());

246 
	`TEST
(
™”2
 !ğ
doc2
.
	`‹rmli¡_’d
());

247 
	`TEST_EQUAL
(*
™”1
, "foo");

248 
	`TEST_EQUAL
(*
™”2
, *
™”1
);

249 
	`TEST_EQUAL
(
™”1
.
	`g‘_wdf
(), 0);

250 
	`TEST_EQUAL
(
™”2
.
	`g‘_wdf
(), 0);

251 
	`TEST_EQUAL
(
™”1
.
	`g‘_‹rmäeq
(), 2);

254 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
‹mp1
 = 
™”1
.
	`pos™iÚli¡_begš
();

255 
pi1
 = 
‹mp1
;

256 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
‹mp2
 = 
™”2
.
	`pos™iÚli¡_begš
();

257 
pi2
 = 
‹mp2
;

258 
	`TEST_EQUAL
(*
pi1
, 2);…i1++;

259 
	`TEST_EQUAL
(*
pi2
, 2);…i2++;

260 
	`TEST
(
pi1
 =ğ
™”1
.
	`pos™iÚli¡_’d
());

261 
	`TEST
(
pi2
 =ğ
™”2
.
	`pos™iÚli¡_’d
());

263 
™”1
++;

264 
™”2
++;

265 
	`TEST
(
™”1
 =ğ
doc1
.
	`‹rmli¡_’d
());

266 
	`TEST
(
™”2
 =ğ
doc2
.
	`‹rmli¡_’d
());

268  
Œue
;

269 
	}
}

273 
	$DEFINE_TESTCASE
(
adddoc3
, 
wr™abË
) {

274 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

276 
X­Ÿn
::
doccouÁ
 
i
 = 0; i < 2100; ++i) {

277 
X­Ÿn
::
Docum’t
 
doc
;

278 
X­Ÿn
::
‹rmcouÁ
 
t
 = 0; < 100; ++t) {

279 
¡ršg
 
	`‹rm
("foo");

280 
‹rm
 +ğ(
t
 ^ 70 ^ 
i
);

281 
doc
.
	`add_po¡šg
(
‹rm
, 
t
);

283 
db
.
	`add_docum’t
(
doc
);

285  
Œue
;

286 
	}
}

291 
	$DEFINE_TESTCASE
(
adddoc4
, 
wr™abË
) {

292 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

294 
X­Ÿn
::
doccouÁ
 
i
 = 1; i <= 240; ++i) {

295 
X­Ÿn
::
Docum’t
 
doc
;

296 
¡ršg
 
	`‹rm
(
i
, 'X');

297 
doc
.
	`add_‹rm
(
‹rm
);

298 
db
.
	`add_docum’t
(
doc
);

300 
db
.
	`add_docum’t
(
X­Ÿn
::
	`Docum’t
());

301 
db
.
	`comm™
();

303 
X­Ÿn
::
doccouÁ
 
i
 = 1; i <= 240; ++i) {

304 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(
i
);

305 
X­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
doc
.
	`‹rmli¡_begš
();

306 
	`TEST
(
t
 !ğ
doc
.
	`‹rmli¡_’d
());

307 
	`TEST_EQUAL
((*
t
).
	`size
(), 
i
);

308 ++
t
;

309 
	`TEST
(
t
 =ğ
doc
.
	`‹rmli¡_’d
());

313 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(241);

314 
	`TEST
(
doc
.
	`‹rmli¡_begš
(è=ğdoc.
	`‹rmli¡_’d
());

316  
Œue
;

317 
	}
}

321 
	$DEFINE_TESTCASE
(
adddoc5
, 
wr™abË
) {

323 
	`SKIP_TEST_FOR_BACKEND
("inmemory");

325 
X­Ÿn
::
docid
 
did
;

326 
X­Ÿn
::
Docum’t
 
docum’t_š
;

327 
docum’t_š
.
	`£t_d©a
("Foobar„ising");

328 
docum’t_š
.
	`add_v®ue
(7, "Value7");

329 
docum’t_š
.
	`add_v®ue
(13, "Value13");

330 
docum’t_š
.
	`add_po¡šg
("foobar", 1);

331 
docum’t_š
.
	`add_po¡šg
("rising", 2);

332 
docum’t_š
.
	`add_po¡šg
("foobar", 3);

334 
X­Ÿn
::
Docum’t
 
docum’t_š2
;

335 
docum’t_š2
.
	`£t_d©a
("Foobar falling");

336 
docum’t_š2
.
	`add_po¡šg
("foobar", 1);

337 
docum’t_š2
.
	`add_po¡šg
("falling", 2);

339 
X­Ÿn
::
Wr™abËD©aba£
 
	`d©aba£
(
	`g‘_wr™abË_d©aba£
());

341 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_doccouÁ
(), 0);

342 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_avËngth
(), 0);

344 
did
 = 
d©aba£
.
	`add_docum’t
(
docum’t_š
);

345 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_doccouÁ
(), 1);

346 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_avËngth
(), 3);

348 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("foobar"), 1);

349 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("foobar"), 2);

350 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("rising"), 1);

351 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("rising"), 1);

352 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("falling"), 0);

353 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("falling"), 0);

355 
X­Ÿn
::
docid
 
did2
 = 
d©aba£
.
	`add_docum’t
(
docum’t_š2
);

356 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_doccouÁ
(), 2);

357 
	`TEST_NOT_EQUAL
(
did
, 
did2
);

358 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_avËngth
(), 5.0/2.0);

360 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("foobar"), 2);

361 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("foobar"), 3);

362 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("rising"), 1);

363 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("rising"), 1);

364 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("falling"), 1);

365 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("falling"), 1);

367 
d©aba£
.
	`d–‘e_docum’t
(
did
);

368 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_doccouÁ
(), 1);

369 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_avËngth
(), 2);

371 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("foobar"), 1);

372 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("foobar"), 1);

373 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("rising"), 0);

374 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("rising"), 0);

375 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("falling"), 1);

376 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("falling"), 1);

378 
did
 = 
d©aba£
.
	`add_docum’t
(
docum’t_š
);

379 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_doccouÁ
(), 2);

380 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_avËngth
(), 5.0/2.0);

382 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("foobar"), 2);

383 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("foobar"), 3);

384 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("rising"), 1);

385 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("rising"), 1);

386 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("falling"), 1);

387 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("falling"), 1);

391 
X­Ÿn
::
D©aba£
 
	`d©aba£
(
	`g‘_wr™abË_d©aba£_as_d©aba£
());

392 
X­Ÿn
::
Docum’t
 
docum’t_out
 = 
d©aba£
.
	`g‘_docum’t
(
did
);

394 
	`TEST_EQUAL
(
docum’t_š
.
	`g‘_d©a
(), 
docum’t_out
.get_data());

397 
X­Ÿn
::
V®ueI‹¿tÜ
 
	`i
(
docum’t_š
.
	`v®ues_begš
());

398 
X­Ÿn
::
V®ueI‹¿tÜ
 
	`j
(
docum’t_out
.
	`v®ues_begš
());

399 ; 
i
 !ğ
docum’t_š
.
	`v®ues_’d
(); i++, 
j
++) {

400 
	`TEST_NOT_EQUAL
(
j
, 
docum’t_out
.
	`v®ues_’d
());

401 
	`TEST_EQUAL
(*
i
, *
j
);

402 
	`TEST_EQUAL
(
i
.
	`g‘_v®u’o
(), 
j
.get_valueno());

404 
	`TEST_EQUAL
(
j
, 
docum’t_out
.
	`v®ues_’d
());

412 
X­Ÿn
::
Docum’t
 
doc_tmp
 = 
d©aba£
.
	`g‘_docum’t
(
did
);

413 
X­Ÿn
::
V®ueI‹¿tÜ
 
i
 = 
docum’t_š
.
	`v®ues_begš
();

414 
X­Ÿn
::
V®ueI‹¿tÜ
 
j
 = 
doc_tmp
.
	`v®ues_begš
();

415 
	`TEST_EQUAL
(*
i
, *
j
);

419 
X­Ÿn
::
T”mI‹¿tÜ
 
	`i
(
docum’t_š
.
	`‹rmli¡_begš
());

420 
X­Ÿn
::
T”mI‹¿tÜ
 
	`j
(
docum’t_out
.
	`‹rmli¡_begš
());

421 ; 
i
 !ğ
docum’t_š
.
	`‹rmli¡_’d
(); i++, 
j
++) {

422 
	`TEST_NOT_EQUAL
(
j
, 
docum’t_out
.
	`‹rmli¡_’d
());

423 
	`TEST_EQUAL
(*
i
, *
j
);

424 
	`TEST_EQUAL
(
i
.
	`g‘_wdf
(), 
j
.get_wdf());

425 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
,

426 ()
i
.
	`g‘_‹rmäeq
());

427 
	`TEST_NOT_EQUAL
(0, 
j
.
	`g‘_‹rmäeq
());

428 ià(*
i
 == "foobar") {

430 
	`TEST_EQUAL
(2, 
j
.
	`g‘_‹rmäeq
());

433 
	`TEST_EQUAL
(*
i
, "rising");

434 
	`TEST_EQUAL
(1, 
j
.
	`g‘_‹rmäeq
());

436 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	`k
(
i
.
	`pos™iÚli¡_begš
());

437 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
	`l
(
j
.
	`pos™iÚli¡_begš
());

438 ; 
k
 !ğ
i
.
	`pos™iÚli¡_’d
(); k++, 
l
++) {

439 
	`TEST_NOT_EQUAL
(
l
, 
j
.
	`pos™iÚli¡_’d
());

440 
	`TEST_EQUAL
(*
k
, *
l
);

442 
	`TEST_EQUAL
(
l
, 
j
.
	`pos™iÚli¡_’d
());

444 
	`TEST_EQUAL
(
j
, 
docum’t_out
.
	`‹rmli¡_’d
());

448  
Œue
;

449 
	}
}

453 
	$DEFINE_TESTCASE
(
adddoc6
, 
wr™abË
) {

455 
	`SKIP_TEST_FOR_BACKEND
("inmemory");

457 
X­Ÿn
::
docid
 
did
;

458 
X­Ÿn
::
Docum’t
 
docum’t_š
;

459 
docum’t_š
.
	`£t_d©a
("Foobar„ising");

460 
docum’t_š
.
	`add_v®ue
(7, "Value7");

461 
docum’t_š
.
	`add_v®ue
(13, "Value13");

462 
docum’t_š
.
	`add_po¡šg
("foo", 1);

463 
docum’t_š
.
	`add_po¡šg
("bar", 2);

466 
X­Ÿn
::
Wr™abËD©aba£
 
	`d©aba£
(
	`g‘_wr™abË_d©aba£
());

468 
did
 = 
d©aba£
.
	`add_docum’t
(
docum’t_š
);

469 
	`TEST_EQUAL
(
did
, 1);

470 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_doccouÁ
(), 1);

471 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_avËngth
(), 2);

475 
X­Ÿn
::
Wr™abËD©aba£
 
	`d©aba£
(
	`g‘_wr™abË_d©aba£_agaš
());

477 
docum’t_š
.
	`»move_‹rm
("foo");

478 
docum’t_š
.
	`add_po¡šg
("baz", 1);

480 
d©aba£
.
	`»¶aû_docum’t
(1, 
docum’t_š
);

482 
d©aba£
.
	`d–‘e_docum’t
(1);

484 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_doccouÁ
(), 0);

485 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_avËngth
(), 0);

486 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("foo"), 0);

487 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("foo"), 0);

488 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("bar"), 0);

489 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("bar"), 0);

490 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_‹rmäeq
("baz"), 0);

491 
	`TEST_EQUAL
(
d©aba£
.
	`g‘_cŞËùiÚ_äeq
("baz"), 0);

494  
Œue
;

495 
	}
}

498 
	$DEFINE_TESTCASE
(
im¶ic™’d£ssiÚ1
, 
wr™abË
) {

499 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

501 
X­Ÿn
::
Docum’t
 
doc
;

503 
doc
.
	`£t_d©a
(
	`¡ršg
("top secret"));

504 
doc
.
	`add_po¡šg
("cia", 1);

505 
doc
.
	`add_po¡šg
("nsa", 2);

506 
doc
.
	`add_po¡šg
("fbi", 3);

507 
db
.
	`add_docum’t
(
doc
);

509  
Œue
;

510 
	}
}

514 
	$DEFINE_TESTCASE
(
d©aba£assign1
, 
wr™abË
) {

515 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 = 
	`g‘_wr™abË_d©aba£
();

516 
X­Ÿn
::
D©aba£
 
db
 = 
	`g‘_d©aba£
("");

517 
X­Ÿn
::
D©aba£
 
aùu®ly_wdb
 = 
wdb
;

518 
X­Ÿn
::
Wr™abËD©aba£
 
	`w1
(
wdb
);

519 
w1
 = 
wdb
;

520 
X­Ÿn
::
D©aba£
 
	`d1
(
wdb
);

521 
X­Ÿn
::
D©aba£
 
	`d2
(
aùu®ly_wdb
);

522 
d2
 = 
wdb
;

523 
d2
 = 
aùu®ly_wdb
;

524 
wdb
 = wdb;

525 
db
 = db;

526  
Œue
;

527 
	}
}

530 
	$DEFINE_TESTCASE
(
d–doc1
, 
wr™abË
) {

531 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

533 
X­Ÿn
::
Docum’t
 
doc1
;

535 
doc1
.
	`add_po¡šg
("foo", 1);

536 
doc1
.
	`add_po¡šg
("foo", 1);

537 
doc1
.
	`add_po¡šg
("foo", 2);

538 
doc1
.
	`add_po¡šg
("foo", 2);

539 
doc1
.
	`add_po¡šg
("bar", 3);

540 
doc1
.
	`add_po¡šg
("gone", 1);

542 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc1
);

543 
	`TEST_EQUAL
(
did
, 1);

545 
doc1
.
	`»move_‹rm
("gone");

547 
did
 = 
db
.
	`add_docum’t
(
doc1
);

548 
	`TEST_EQUAL
(
did
, 2);

550 
doc1
.
	`add_‹rm
("new", 1);

551 
did
 = 
db
.
	`add_docum’t
(
doc1
);

552 
	`TEST_EQUAL
(
did
, 3);

554 
db
.
	`d–‘e_docum’t
(1);

556 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(1));

558 
doc1
 = 
db
.
	`g‘_docum’t
(2);

559 
doc1
.
	`»move_‹rm
("foo");

560 
doc1
.
	`add_‹rm
("fwing");

561 
db
.
	`»¶aû_docum’t
(2, 
doc1
);

563 
X­Ÿn
::
Docum’t
 
doc2
 = 
db
.
	`g‘_docum’t
(2);

564 
X­Ÿn
::
T”mI‹¿tÜ
 
t™
 = 
doc2
.
	`‹rmli¡_begš
();

565 
	`TEST_NOT_EQUAL
(
t™
, 
doc2
.
	`‹rmli¡_’d
());

566 
	`TEST_EQUAL
(*
t™
, "bar");

567 
t™
++;

568 
	`TEST_NOT_EQUAL
(
t™
, 
doc2
.
	`‹rmli¡_’d
());

569 
	`TEST_EQUAL
(*
t™
, "fwing");

570 
t™
++;

571 
	`TEST_EQUAL
(
t™
, 
doc2
.
	`‹rmli¡_’d
());

573  
Œue
;

574 
	}
}

577 
	$DEFINE_TESTCASE
(
d–doc2
, 
wr™abË
) {

578 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

580 
X­Ÿn
::
Docum’t
 
doc1
;

582 
doc1
.
	`add_po¡šg
("one", 1);

583 
doc1
.
	`add_po¡šg
("two", 2);

584 
doc1
.
	`add_po¡šg
("two", 3);

585 
X­Ÿn
::
docid
 
did
;

587 
did
 = 
db
.
	`add_docum’t
(
doc1
);

588 
	`TEST_EQUAL
(
did
, 1);

590 
doc1
.
	`»move_‹rm
("one");

591 
doc1
.
	`add_po¡šg
("three", 4);

593 
did
 = 
db
.
	`add_docum’t
(
doc1
);

594 
	`TEST_EQUAL
(
did
, 2);

596 
doc1
.
	`add_po¡šg
("one", 7);

597 
doc1
.
	`»move_‹rm
("two");

599 
did
 = 
db
.
	`add_docum’t
(
doc1
);

600 
	`TEST_EQUAL
(
did
, 3);

602 
db
.
	`comm™
();

604 
db
.
	`»İ’
();

606 
db
.
	`d–‘e_docum’t
(1);

607 
db
.
	`d–‘e_docum’t
(2);

608 
db
.
	`d–‘e_docum’t
(3);

610 
db
.
	`comm™
();

612 
db
.
	`»İ’
();

614 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
("Úe"), db.
	`po¡li¡_’d
("one"));

615 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
("two"), db.
	`po¡li¡_’d
("two"));

616 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
("th»e"), db.
	`po¡li¡_’d
("three"));

618 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`‹rmli¡_begš
(1));

619 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`‹rmli¡_begš
(2));

620 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`‹rmli¡_begš
(3));

621 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`‹rmli¡_begš
(4));

625 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

626 
	`TEST_EQUAL
(
db
.
	`g‘_avËngth
(), 0);

627 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("one"), 0);

628 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("two"), 0);

629 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("three"), 0);

631 
	`TEST
(!
db
.
	`‹rm_exi¡s
("one"));

632 
	`TEST
(!
db
.
	`‹rm_exi¡s
("two"));

633 
	`TEST
(!
db
.
	`‹rm_exi¡s
("three"));

635 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("one"), 0);

636 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("two"), 0);

637 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("three"), 0);

639 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_doş’gth
(1));

640 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_doş’gth
(2));

641 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_doş’gth
(3));

643 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(1));

644 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(2));

645 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(3));

647 
	`TEST_EQUAL
(
db
.
	`®É”ms_begš
(), db.
	`®É”ms_’d
());

649  
Œue
;

650 
	}
}

653 
	$DEFINE_TESTCASE
(
d–doc3
, 
wr™abË
) {

654 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

656 
X­Ÿn
::
Docum’t
 
doc1
;

658 
doc1
.
	`add_po¡šg
("one", 1);

660 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc1
);

661 
	`TEST_EQUAL
(
did
, 1);

663 
db
.
	`comm™
();

665 
db
.
	`»İ’
();

667 
db
.
	`d–‘e_docum’t
(1);

669 
db
.
	`comm™
();

671 
db
.
	`»İ’
();

673 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
("Úe"), db.
	`po¡li¡_’d
("one"));

675 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`‹rmli¡_begš
(1));

676 ()&
db
;

677 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`‹rmli¡_begš
(2));

681 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

682 
	`TEST_EQUAL
(
db
.
	`g‘_avËngth
(), 0);

683 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("one"), 0);

685 
	`TEST
(!
db
.
	`‹rm_exi¡s
("one"));

687 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("one"), 0);

689 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_doş’gth
(1));

690 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_doş’gth
(2));

692 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(1));

693 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(2));

695 
	`TEST_EQUAL
(
db
.
	`®É”ms_begš
(), db.
	`®É”ms_’d
());

697  
Œue
;

698 
	}
}

701 
	$DEFINE_TESTCASE
(
d–doc4
, 
wr™abË
) {

702 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

704 
X­Ÿn
::
Docum’t
 
doc1
;

706 
doc1
.
	`add_po¡šg
("one", 1);

707 
doc1
.
	`add_po¡šg
("two", 2);

708 
doc1
.
	`add_po¡šg
("two", 3);

710 
X­Ÿn
::
Docum’t
 
doc2
 = 
doc1
;

711 
doc2
.
	`»move_‹rm
("one");

712 
doc2
.
	`add_po¡šg
("three", 4);

714 
X­Ÿn
::
Docum’t
 
doc3
 = 
doc2
;

715 
doc3
.
	`add_po¡šg
("one", 7);

716 
doc3
.
	`»move_‹rm
("two");

718 cÚ¡ 
X­Ÿn
::
docid
 
maxdoc
 = 1000 * 3;

719 
X­Ÿn
::
docid
 
did
;

720 
X­Ÿn
::
docid
 
i
 = 0; i < 
maxdoc
 / 3; ++i) {

721 
did
 = 
db
.
	`add_docum’t
(
doc1
);

722 
	`TEST_EQUAL
(
did
, 
i
 * 3 + 1);

723 
did
 = 
db
.
	`add_docum’t
(
doc2
);

724 
	`TEST_EQUAL
(
did
, 
i
 * 3 + 2);

725 
did
 = 
db
.
	`add_docum’t
(
doc3
);

726 
	`TEST_EQUAL
(
did
, 
i
 * 3 + 3);

728 
boŞ
 
is_pow”_of_two
 = ((
i
 & (i - 1)) == 0);

729 ià(
is_pow”_of_two
) {

730 
db
.
	`comm™
();

731 
db
.
	`»İ’
();

734 
db
.
	`comm™
();

735 
db
.
	`»İ’
();

738 
X­Ÿn
::
docid
 
i
 = 0; i < 
maxdoc
 / 3; ++i) {

739 
db
.
	`d–‘e_docum’t
(
maxdoc
 - 
i
);

740 
db
.
	`d–‘e_docum’t
(
maxdoc
 / 3 + 
i
 + 1);

741 
db
.
	`d–‘e_docum’t
(
i
 + 1);

744 
db
.
	`comm™
();

746 
db
.
	`»İ’
();

748 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
("Úe"), db.
	`po¡li¡_’d
("one"));

749 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
("two"), db.
	`po¡li¡_’d
("two"));

750 
	`TEST_EQUAL
(
db
.
	`po¡li¡_begš
("th»e"), db.
	`po¡li¡_’d
("three"));

752 
X­Ÿn
::
docid
 
i
 = 1; i <ğ
maxdoc
; ++i) {

758 
tout
.
	`¡r
(
	`¡ršg
());

759 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`‹rmli¡_begš
(
i
));

760 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_doş’gth
(
i
));

761 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(
i
));

766 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

767 
	`TEST_EQUAL
(
db
.
	`g‘_avËngth
(), 0);

768 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("one"), 0);

769 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("two"), 0);

770 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("three"), 0);

772 
	`TEST
(!
db
.
	`‹rm_exi¡s
("one"));

773 
	`TEST
(!
db
.
	`‹rm_exi¡s
("two"));

774 
	`TEST
(!
db
.
	`‹rm_exi¡s
("three"));

776 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("one"), 0);

777 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("two"), 0);

778 
	`TEST_EQUAL
(
db
.
	`g‘_cŞËùiÚ_äeq
("three"), 0);

780 
	`TEST_EQUAL
(
db
.
	`®É”ms_begš
(), db.
	`®É”ms_’d
());

782  
Œue
;

783 
	}
}

786 
	$DEFINE_TESTCASE
(
d–doc5
, 
wr™abË
) {

787 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

789 
X­Ÿn
::
Docum’t
 
doc1
;

791 
doc1
.
	`add_po¡šg
("foo", 1);

792 
doc1
.
	`add_po¡šg
("bar", 2);

793 
doc1
.
	`add_po¡šg
("aardvark", 3);

795 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc1
);

796 
	`TEST_EQUAL
(
did
, 1);

798 
doc1
.
	`»move_‹rm
("bar");

799 
doc1
.
	`add_‹rm
("hello");

801 
did
 = 
db
.
	`add_docum’t
(
doc1
);

802 
	`TEST_EQUAL
(
did
, 2);

804 
doc1
.
	`add_‹rm
("world", 1);

805 
did
 = 
db
.
	`add_docum’t
(
doc1
);

806 
	`TEST_EQUAL
(
did
, 3);

808 
db
.
	`d–‘e_docum’t
(2);

810 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(2));

812 
db
.
	`comm™
();

814 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(2));

816 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("foo"), 2);

817 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("aardvark"), 2);

818 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("hello"), 1);

820 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p
 = 
db
.
	`po¡li¡_begš
("foo");

821 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

822 
	`TEST_EQUAL
(*
p
, 1);

823 ++
p
;

824 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

825 
	`TEST_EQUAL
(*
p
, 3);

826 ++
p
;

827 
	`TEST_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

829  
Œue
;

830 
	}
}

833 
	$DEFINE_TESTCASE
(
d–doc6
, 
wr™abË
) {

834 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

836 
X­Ÿn
::
Docum’t
 
doc1
;

838 
doc1
.
	`add_po¡šg
("foo", 1);

839 
doc1
.
	`add_po¡šg
("bar", 2);

840 
doc1
.
	`add_po¡šg
("aardvark", 3);

842 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc1
);

843 
	`TEST_EQUAL
(
did
, 1);

845 
doc1
.
	`»move_‹rm
("bar");

846 
doc1
.
	`add_‹rm
("hello");

848 
did
 = 
db
.
	`add_docum’t
(
doc1
);

849 
	`TEST_EQUAL
(
did
, 2);

851 
db
.
	`comm™
();

853 
db
.
	`d–‘e_docum’t
(2);

854 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`d–‘e_docum’t
(3));

856 
db
.
	`comm™
();

858 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(2));

860  
Œue
;

861 
	}
}

863 
	$DEFINE_TESTCASE
(
»¶aûdoc1
, 
wr™abË
) {

864 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

866 
X­Ÿn
::
Docum’t
 
doc1
;

868 
doc1
.
	`add_po¡šg
("foo", 1);

869 
doc1
.
	`add_po¡šg
("foo", 2);

870 
doc1
.
	`add_po¡šg
("gone",3);

871 
doc1
.
	`add_po¡šg
("bar", 4);

872 
doc1
.
	`add_po¡šg
("foo", 5);

873 
X­Ÿn
::
docid
 
did
;

875 
did
 = 
db
.
	`add_docum’t
(
doc1
);

876 
	`TEST_EQUAL
(
did
, 1);

878 
X­Ÿn
::
Docum’t
 
doc2
;

880 
doc2
.
	`add_po¡šg
("foo", 1);

881 
doc2
.
	`add_po¡šg
("pipco", 2);

882 
doc2
.
	`add_po¡šg
("bar", 4);

883 
doc2
.
	`add_po¡šg
("foo", 5);

885 
db
.
	`»¶aû_docum’t
(
did
, 
doc2
);

887 
X­Ÿn
::
Docum’t
 
doc3
 = 
db
.
	`g‘_docum’t
(
did
);

888 
X­Ÿn
::
T”mI‹¿tÜ
 
tI‹r
 = 
doc3
.
	`‹rmli¡_begš
();

889 
	`TEST_EQUAL
(*
tI‹r
, "bar");

890 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pI‹r
 = 
tI‹r
.
	`pos™iÚli¡_begš
();

891 
	`TEST_EQUAL
(*
pI‹r
, 4);

892 ++
tI‹r
;

893 
	`TEST_EQUAL
(*
tI‹r
, "foo");

894 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
qI‹r
 = 
tI‹r
.
	`pos™iÚli¡_begš
();

895 
	`TEST_EQUAL
(*
qI‹r
, 1);

896 ++
qI‹r
;

897 
	`TEST_EQUAL
(*
qI‹r
, 5);

898 ++
tI‹r
;

899 
	`TEST_EQUAL
(*
tI‹r
, "pipco");

900 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
rI‹r
 = 
tI‹r
.
	`pos™iÚli¡_begš
();

901 
	`TEST_EQUAL
(*
rI‹r
, 2);

902 ++
tI‹r
;

903 
	`TEST_EQUAL
(
tI‹r
, 
doc3
.
	`‹rmli¡_’d
());

904  
Œue
;

905 
	}
}

909 
	$DEFINE_TESTCASE
(
»¶aûdoc2
, 
wr™abË
) {

910 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

912 
X­Ÿn
::
Docum’t
 
doc1
;

914 
doc1
.
	`add_po¡šg
("foo", 1);

915 
doc1
.
	`add_po¡šg
("foo", 2);

916 
doc1
.
	`add_po¡šg
("gone",3);

917 
doc1
.
	`add_po¡šg
("bar", 4);

918 
doc1
.
	`add_po¡šg
("foo", 5);

919 
X­Ÿn
::
docid
 
did
 = 31770;

921 
db
.
	`»¶aû_docum’t
(
did
, 
doc1
);

924 
	`TEST_EXCEPTION
(
X­Ÿn
::
DocNÙFoundE¼Ü
, 
db
.
	`g‘_docum’t
(1));

925 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
po¡™
 = 
db
.
	`po¡li¡_begš
("");

926 
	`TEST
(
po¡™
 !ğ
db
.
	`po¡li¡_’d
(""));

927 
	`TEST_EQUAL
(*
po¡™
, 31770);

929 
X­Ÿn
::
Docum’t
 
doc2
;

931 
doc2
.
	`add_po¡šg
("foo", 1);

932 
doc2
.
	`add_po¡šg
("pipco", 2);

933 
doc2
.
	`add_po¡šg
("bar", 4);

934 
doc2
.
	`add_po¡šg
("foo", 5);

936 
db
.
	`»¶aû_docum’t
(
did
, 
doc2
);

937 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 1);

939 
X­Ÿn
::
Docum’t
 
doc3
 = 
db
.
	`g‘_docum’t
(
did
);

940 
X­Ÿn
::
T”mI‹¿tÜ
 
tI‹r
 = 
doc3
.
	`‹rmli¡_begš
();

941 
	`TEST_EQUAL
(*
tI‹r
, "bar");

942 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
pI‹r
 = 
tI‹r
.
	`pos™iÚli¡_begš
();

943 
	`TEST_EQUAL
(*
pI‹r
, 4);

944 ++
tI‹r
;

945 
	`TEST_EQUAL
(*
tI‹r
, "foo");

946 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
qI‹r
 = 
tI‹r
.
	`pos™iÚli¡_begš
();

947 
	`TEST_EQUAL
(*
qI‹r
, 1);

948 ++
qI‹r
;

949 
	`TEST_EQUAL
(*
qI‹r
, 5);

950 ++
tI‹r
;

951 
	`TEST_EQUAL
(*
tI‹r
, "pipco");

952 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
rI‹r
 = 
tI‹r
.
	`pos™iÚli¡_begš
();

953 
	`TEST_EQUAL
(*
rI‹r
, 2);

954 ++
tI‹r
;

955 
	`TEST_EQUAL
(
tI‹r
, 
doc3
.
	`‹rmli¡_’d
());

957 
did
 = 
db
.
	`add_docum’t
(
doc1
);

958 
	`TEST_EQUAL
(
did
, 31771);

959 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 2);

961 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
db
.
	`»¶aû_docum’t
(0, 
doc2
));

963  
Œue
;

964 
	}
}

967 
	$DEFINE_TESTCASE
(
»¶aûdoc3
, 
wr™abË
) {

968 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

970 
X­Ÿn
::
Docum’t
 
doc1
;

972 
doc1
.
	`add_po¡šg
("foo", 1);

973 
doc1
.
	`add_po¡šg
("bar", 2);

974 
doc1
.
	`add_po¡šg
("aardvark", 3);

976 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc1
);

977 
	`TEST_EQUAL
(
did
, 1);

979 
doc1
.
	`»move_‹rm
("bar");

980 
doc1
.
	`add_‹rm
("hello");

982 
did
 = 
db
.
	`add_docum’t
(
doc1
);

983 
	`TEST_EQUAL
(
did
, 2);

985 
doc1
.
	`add_‹rm
("world", 1);

986 
did
 = 
db
.
	`add_docum’t
(
doc1
);

987 
	`TEST_EQUAL
(
did
, 3);

989 
X­Ÿn
::
Docum’t
 
doc2
;

990 
doc2
.
	`add_‹rm
("world");

991 
db
.
	`»¶aû_docum’t
(2, 
doc2
);

993 
db
.
	`comm™
();

996 
doc2
 = 
db
.
	`g‘_docum’t
(2);

998 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("foo"), 2);

999 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("aardvark"), 2);

1000 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("hello"), 1);

1001 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("world"), 2);

1003 
	`TEST_EQUAL
(
db
.
	`g‘_doş’gth
(1), 3);

1004 
	`TEST_EQUAL
(
db
.
	`g‘_doş’gth
(2), 1);

1005 
	`TEST_EQUAL
(
db
.
	`g‘_doş’gth
(3), 4);

1007 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p
 = 
db
.
	`po¡li¡_begš
("foo");

1008 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

1009 
	`TEST_EQUAL
(*
p
, 1);

1010 
	`TEST_EQUAL
(
p
.
	`g‘_doş’gth
(), 3);

1011 ++
p
;

1012 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

1013 
	`TEST_EQUAL
(*
p
, 3);

1014 
	`TEST_EQUAL
(
p
.
	`g‘_doş’gth
(), 4);

1015 ++
p
;

1016 
	`TEST_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

1018 
p
 = 
db
.
	`po¡li¡_begš
("world");

1019 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("world"));

1020 
	`TEST_EQUAL
(*
p
, 2);

1021 
	`TEST_EQUAL
(
p
.
	`g‘_doş’gth
(), 1);

1022 ++
p
;

1023 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("world"));

1024 
	`TEST_EQUAL
(*
p
, 3);

1025 
	`TEST_EQUAL
(
p
.
	`g‘_doş’gth
(), 4);

1026 ++
p
;

1027 
	`TEST_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("world"));

1029  
Œue
;

1030 
	}
}

1033 
	$DEFINE_TESTCASE
(
»¶aûdoc4
, 
wr™abË
) {

1034 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1036 
X­Ÿn
::
Docum’t
 
doc1
;

1038 
doc1
.
	`add_po¡šg
("foo", 1);

1039 
doc1
.
	`add_po¡šg
("bar", 2);

1040 
doc1
.
	`add_po¡šg
("aardvark", 3);

1042 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc1
);

1043 
	`TEST_EQUAL
(
did
, 1);

1045 
doc1
.
	`»move_‹rm
("bar");

1046 
doc1
.
	`add_‹rm
("hello");

1048 
did
 = 
db
.
	`add_docum’t
(
doc1
);

1049 
	`TEST_EQUAL
(
did
, 2);

1051 
doc1
.
	`add_‹rm
("world", 1);

1052 
did
 = 
db
.
	`add_docum’t
(
doc1
);

1053 
	`TEST_EQUAL
(
did
, 3);

1055 
db
.
	`d–‘e_docum’t
(2);

1057 
X­Ÿn
::
Docum’t
 
doc2
;

1058 
doc2
.
	`add_‹rm
("world");

1059 
db
.
	`»¶aû_docum’t
(2, 
doc2
);

1061 
db
.
	`comm™
();

1064 
doc2
 = 
db
.
	`g‘_docum’t
(2);

1066 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("foo"), 2);

1067 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("aardvark"), 2);

1068 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("hello"), 1);

1069 
	`TEST_EQUAL
(
db
.
	`g‘_‹rmäeq
("world"), 2);

1071 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p
 = 
db
.
	`po¡li¡_begš
("foo");

1072 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

1073 
	`TEST_EQUAL
(*
p
, 1);

1074 ++
p
;

1075 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

1076 
	`TEST_EQUAL
(*
p
, 3);

1077 ++
p
;

1078 
	`TEST_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("foo"));

1080 
p
 = 
db
.
	`po¡li¡_begš
("world");

1081 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("world"));

1082 
	`TEST_EQUAL
(*
p
, 2);

1083 ++
p
;

1084 
	`TEST_NOT_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("world"));

1085 
	`TEST_EQUAL
(*
p
, 3);

1086 ++
p
;

1087 
	`TEST_EQUAL
(
p
, 
db
.
	`po¡li¡_’d
("world"));

1089  
Œue
;

1090 
	}
}

1095 
	$DEFINE_TESTCASE
(
»¶aûdoc5
, 
wr™abË
) {

1096 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1099 
X­Ÿn
::
Docum’t
 
doc
;

1100 
doc
.
	`add_po¡šg
("hello", 1);

1101 
doc
.
	`add_po¡šg
("world", 2);

1103 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc
);

1104 
	`TEST_EQUAL
(
did
, 1);

1105 
db
.
	`comm™
();

1109 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(1);

1110 
	`TEST
(
db
.
	`has_pos™iÚs
());

1111 
	`TEST
(
db
.
	`pos™iÚli¡_begš
(1, "h–lo"è!ğdb.
	`pos™iÚli¡_’d
(1, "hello"));

1112 
	`TEST
(
db
.
	`pos™iÚli¡_begš
(1, "wÜld"è!ğdb.
	`pos™iÚli¡_’d
(1, "world"));

1113 
db
.
	`»¶aû_docum’t
(1, 
doc
);

1114 
db
.
	`comm™
();

1116 
	`TEST
(
db
.
	`has_pos™iÚs
());

1117 
	`TEST
(
db
.
	`pos™iÚli¡_begš
(1, "h–lo"è!ğdb.
	`pos™iÚli¡_’d
(1, "hello"));

1118 
	`TEST
(
db
.
	`pos™iÚli¡_begš
(1, "wÜld"è!ğdb.
	`pos™iÚli¡_’d
(1, "world"));

1126 
X­Ÿn
::
Docum’t
 
doc
;

1127 
doc
.
	`add_‹rm
("Q2");

1128 
db
.
	`add_docum’t
(
doc
);

1129 
db
.
	`comm™
();

1133 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(1);

1134 
	`TEST
(
db
.
	`has_pos™iÚs
());

1135 
	`TEST
(
db
.
	`pos™iÚli¡_begš
(1, "h–lo"è!ğdb.
	`pos™iÚli¡_’d
(1, "hello"));

1136 
	`TEST
(
db
.
	`pos™iÚli¡_begš
(1, "wÜld"è!ğdb.
	`pos™iÚli¡_’d
(1, "world"));

1137 ()
db
.
	`g‘_docum’t
(2);

1138 
db
.
	`»¶aû_docum’t
(1, 
doc
);

1139 
db
.
	`comm™
();

1141 
	`TEST
(
db
.
	`has_pos™iÚs
());

1142 
	`TEST
(
db
.
	`pos™iÚli¡_begš
(1, "h–lo"è!ğdb.
	`pos™iÚli¡_’d
(1, "hello"));

1143 
	`TEST
(
db
.
	`pos™iÚli¡_begš
(1, "wÜld"è!ğdb.
	`pos™iÚli¡_’d
(1, "world"));

1146  
Œue
;

1147 
	}
}

1152 
	$DEFINE_TESTCASE
(
»¶aûdoc6
, 
wr™abË
) {

1153 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1155 
X­Ÿn
::
Docum’t
 
doc
;

1156 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc
);

1157 
	`TEST_EQUAL
(
did
, 1);

1158 
db
.
	`comm™
();

1161 
doc
 = 
db
.
	`g‘_docum’t
(1);

1162 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(1), "");

1163 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(2), "");

1164 
doc
.
	`add_v®ue
(1, "banana1");

1165 
db
.
	`»¶aû_docum’t
(1, 
doc
);

1167 
doc
 = 
db
.
	`g‘_docum’t
(1);

1168 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(1), "banana1");

1169 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(2), "");

1170 
db
.
	`comm™
();

1172 
doc
 = 
db
.
	`g‘_docum’t
(1);

1173 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(1), "banana1");

1174 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(2), "");

1175 
doc
.
	`add_v®ue
(2, "banana2");

1176 
db
.
	`»¶aû_docum’t
(1, 
doc
);

1178 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(1), "banana1");

1179 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(2), "banana2");

1180 
db
.
	`comm™
();

1182 
doc
 = 
db
.
	`g‘_docum’t
(1);

1183 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(1), "banana1");

1184 
	`TEST_EQUAL
(
doc
.
	`g‘_v®ue
(2), "banana2");

1186  
Œue
;

1187 
	}
}

1191 
	$DEFINE_TESTCASE
(
uniqu‘”m1
, 
wr™abË
) {

1192 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1194 
n
 = 1;‚ <= 20; ++n) {

1195 
X­Ÿn
::
Docum’t
 
doc
;

1196 
¡ršg
 
u‹rm
 = "U" + 
	`om_to¡ršg
(
n
 % 16);

1197 
doc
.
	`add_‹rm
(
u‹rm
);

1198 
doc
.
	`add_‹rm
(
	`om_to¡ršg
(
n
));

1199 
doc
.
	`add_‹rm
(
	`om_to¡ršg
(
n
 ^ 9));

1200 
doc
.
	`add_‹rm
("all");

1201 
doc
.
	`£t_d©a
("pass1");

1202 
db
.
	`add_docum’t
(
doc
);

1205 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 20);

1207 cÚ¡ 
X­Ÿn
::
doccouÁ
 
sizes
[20] = {

1214 
n
 = 1;‚ <= 20; ++n) {

1215 
¡ršg
 
u‹rm
 = "U" + 
	`om_to¡ršg
(
n
 % 16);

1216 ià(
u‹rm
 == "U2") {

1217 
db
.
	`d–‘e_docum’t
(
u‹rm
);

1219 
X­Ÿn
::
Docum’t
 
doc
;

1220 
doc
.
	`add_‹rm
(
u‹rm
);

1221 
doc
.
	`add_‹rm
(
	`om_to¡ršg
(
n
));

1222 
doc
.
	`add_‹rm
(
	`om_to¡ršg
(
n
 ^ 9));

1223 
doc
.
	`add_‹rm
("all");

1224 
doc
.
	`£t_d©a
("pass2");

1225 
db
.
	`»¶aû_docum’t
(
u‹rm
, 
doc
);

1227 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 
sizes
[
n
 - 1]);

1230 
¡ršg
 
u‹rm
 = "U571";

1231 
X­Ÿn
::
Docum’t
 
doc
;

1232 
doc
.
	`add_‹rm
(
u‹rm
);

1233 
doc
.
	`£t_d©a
("pass3");

1234 
db
.
	`»¶aû_docum’t
(
u‹rm
, 
doc
);

1236 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 16);

1238 
db
.
	`d–‘e_docum’t
("U2");

1240 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 16);

1242  
Œue
;

1243 
	}
}

1246 
	$DEFINE_TESTCASE
(
®Ío¡li¡2
, 
wr™abË
) {

1247 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
("apitest_manydocs"));

1248 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
i
 = 
db
.
	`po¡li¡_begš
("");

1249 
j
 = 1;

1250 
i
 !ğ
db
.
	`po¡li¡_’d
("")) {

1251 
	`TEST_EQUAL
(*
i
, 
j
);

1252 
i
++;

1253 
j
++;

1255 
	`TEST_EQUAL
(
j
, 513);

1257 
db
.
	`d–‘e_docum’t
(1);

1258 
db
.
	`d–‘e_docum’t
(50);

1259 
db
.
	`d–‘e_docum’t
(512);

1261 
i
 = 
db
.
	`po¡li¡_begš
("");

1262 
j
 = 2;

1263 
i
 !ğ
db
.
	`po¡li¡_’d
("")) {

1264 
	`TEST_EQUAL
(*
i
, 
j
);

1265 
i
++;

1266 
j
++;

1267 ià(
j
 == 50) j++;

1269 
	`TEST_EQUAL
(
j
, 512);

1271 
i
 = 
db
.
	`po¡li¡_begš
("");

1272 
j
 = 2;

1273 
i
 !ğ
db
.
	`po¡li¡_’d
("")) {

1274 
	`TEST_EQUAL
(*
i
, 
j
);

1275 
i
++;

1276 
j
++;

1277 ià(
j
 == 40) {

1278 
j
 += 10;

1279 
i
.
	`sk_to
(
j
);

1280 
j
++;

1283 
	`TEST_EQUAL
(
j
, 512);

1285  
Œue
;

1286 
	}
}

1288 
‹¡_em±y‹rm2_h–³r
(
X­Ÿn
::
Wr™abËD©aba£
 & 
db
)

1291 
TEST_EXCEPTION
(
X­Ÿn
::
Inv®idArgum’tE¼Ü
, 
db
.
pos™iÚli¡_begš
(1, ""));

1292 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), db.
g‘_‹rmäeq
(""));

1293 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(è!ğ0, db.
‹rm_exi¡s
(""));

1294 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), db.
g‘_cŞËùiÚ_äeq
(""));

1299 
	$DEFINE_TESTCASE
(
em±y‹rm2
, 
wr™abË
) {

1301 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
("apitest_manydocs"));

1302 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 512);

1303 
	`‹¡_em±y‹rm2_h–³r
(
db
);

1304 
db
.
	`d–‘e_docum’t
(1);

1305 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 511);

1306 
	`‹¡_em±y‹rm2_h–³r
(
db
);

1307 
db
.
	`d–‘e_docum’t
(50);

1308 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 510);

1309 
	`‹¡_em±y‹rm2_h–³r
(
db
);

1310 
db
.
	`d–‘e_docum’t
(512);

1311 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 509);

1312 
	`‹¡_em±y‹rm2_h–³r
(
db
);

1316 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
("apitest_onedoc"));

1317 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 1);

1318 
	`‹¡_em±y‹rm2_h–³r
(
db
);

1319 
db
.
	`d–‘e_docum’t
(1);

1320 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

1321 
	`‹¡_em±y‹rm2_h–³r
(
db
);

1325 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
	`g‘_wr™abË_d©aba£
());

1326 
	`TEST_EQUAL
(
db
.
	`g‘_doccouÁ
(), 0);

1327 
	`‹¡_em±y‹rm2_h–³r
(
db
);

1330  
Œue
;

1331 
	}
}

1335 
	$DEFINE_TESTCASE
(
ph¿£ÜÃ¬tßnd1
, 
wr™abË
) {

1336 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1338 
n
 = 1;‚ <= 20; ++n) {

1339 
X­Ÿn
::
Docum’t
 
doc
;

1340 
doc
.
	`add_‹rm
(
	`om_to¡ršg
(
n
));

1341 
doc
.
	`add_‹rm
(
	`om_to¡ršg
(
n
 ^ 9));

1342 
doc
.
	`add_‹rm
("all");

1343 
doc
.
	`£t_d©a
("pass1");

1344 
db
.
	`add_docum’t
(
doc
);

1346 
db
.
	`comm™
();

1348 
X­Ÿn
::
Enquœe
 
	`’quœe
(
db
);

1349 
X­Ÿn
::
MS‘
 
mym£t
;

1351 cÚ¡ * 
q1
[] = { "all", "1" };

1352 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
q1
, q1 + 2));

1353 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1354 
	`TEST_EQUAL
(2, 
mym£t
.
	`size
());

1356 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
q1
, q1 + 2));

1357 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1358 
	`TEST_EQUAL
(2, 
mym£t
.
	`size
());

1360 cÚ¡ * 
q2
[] = { "1", "2" };

1361 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
q2
, q2 + 2));

1362 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1363 
	`TEST_EQUAL
(0, 
mym£t
.
	`size
());

1365 
’quœe
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_NEAR
, 
q2
, q2 + 2));

1366 
mym£t
 = 
’quœe
.
	`g‘_m£t
(0, 10);

1367 
	`TEST_EQUAL
(0, 
mym£t
.
	`size
());

1369  
Œue
;

1370 
	}
}

1374 
	$DEFINE_TESTCASE
(
lÚgpos™iÚli¡1
, 
wr™abË
) {

1375 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1377 
X­Ÿn
::
Docum’t
 
doc
;

1378 
X­Ÿn
::
‹rmpos
 
n
;

1379 
n
 = 1;‚ <= 2000; ++n) {

1380 
doc
.
	`add_po¡šg
("fÜk", 
n
 * 3);

1381 
doc
.
	`add_po¡šg
("kniã", 
n
 * (
	`log
((n + 2))));

1382 
doc
.
	`add_po¡šg
("¥oÚ", 
n
 *‚);

1384 
doc
.
	`£t_d©a
("cutlery");

1385 
X­Ÿn
::
docid
 
did
 = 
db
.
	`add_docum’t
(
doc
);

1386 
db
.
	`comm™
();

1388 
doc
 = 
db
.
	`g‘_docum’t
(
did
);

1390 
X­Ÿn
::
T”mI‹¿tÜ
 
t
, 
‹nd
;

1391 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 
p
, 
³nd
;

1393 
t
 = 
doc
.
	`‹rmli¡_begš
();

1394 
‹nd
 = 
doc
.
	`‹rmli¡_’d
();

1396 
	`TEST
(
t
 !ğ
‹nd
);

1397 
	`TEST_EQUAL
(*
t
, "fork");

1398 
p
 = 
t
.
	`pos™iÚli¡_begš
();

1399 
³nd
 = 
t
.
	`pos™iÚli¡_’d
();

1400 
n
 = 1;‚ <= 2000; ++n) {

1401 
	`TEST
(
p
 !ğ
³nd
);

1402 
	`TEST_EQUAL
(*
p
, 
n
 * 3);

1403 ++
p
;

1405 
	`TEST
(
p
 =ğ
³nd
);

1407 ++
t
;

1408 
	`TEST
(
t
 !ğ
‹nd
);

1409 
	`TEST_EQUAL
(*
t
, "knife");

1410 
p
 = 
t
.
	`pos™iÚli¡_begš
();

1411 
³nd
 = 
t
.
	`pos™iÚli¡_’d
();

1412 
n
 = 1;‚ <= 2000; ++n) {

1413 
	`TEST
(
p
 !ğ
³nd
);

1414 
	`TEST_EQUAL
(*
p
, 
n
 * (
	`log
((n + 2))));

1415 ++
p
;

1417 
	`TEST
(
p
 =ğ
³nd
);

1419 ++
t
;

1420 
	`TEST
(
t
 !ğ
‹nd
);

1421 
	`TEST_EQUAL
(*
t
, "spoon");

1422 
p
 = 
t
.
	`pos™iÚli¡_begš
();

1423 
³nd
 = 
t
.
	`pos™iÚli¡_’d
();

1424 
n
 = 1;‚ <= 2000; ++n) {

1425 
	`TEST
(
p
 !ğ
³nd
);

1426 
	`TEST_EQUAL
(*
p
, 
n
 *‚);

1427 ++
p
;

1429 
	`TEST
(
p
 =ğ
³nd
);

1431 ++
t
;

1432 
	`TEST
(
t
 =ğ
‹nd
);

1434  
Œue
;

1435 
	}
}

1439 
	$DEFINE_TESTCASE
(
cÚsi¡’cy2
, 
wr™abË
) {

1440 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1441 
buf
[2] = "X";

1442 
i
 = 0;

1445 
i
 = 0; i < 5; ++i) {

1446 
X­Ÿn
::
Docum’t
 
doc
;

1447 *
buf
 = '0' + 
i
;

1448 
doc
.
	`add_v®ue
(0, 
buf
);

1449 
doc
.
	`add_‹rm
("test");

1450 
db
.
	`add_docum’t
(
doc
);

1454 
i
 = 0; i < 5; ++i) {

1455 
X­Ÿn
::
Docum’t
 
doc
;

1456 *
buf
 = '0' + 
i
;

1457 
doc
.
	`add_v®ue
(0, 
buf
);

1458 
doc
.
	`add_‹rm
("test", 2);

1459 
db
.
	`add_docum’t
(
doc
);

1462 
db
.
	`comm™
();

1464 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

1465 
’q
.
	`£t_qu”y
(
X­Ÿn
::
	`Qu”y
("test"));

1467 
’q
.
	`£t_sÜt_by_v®ue_th’_»Ëvªû
(0, 
Œue
);

1470 
X­Ÿn
::
MS‘
 
m£t1
 = 
’q
.
	`g‘_m£t
(0, 10);

1471 
	`TEST_EQUAL
(
m£t1
.
	`size
(), 10);

1474 
X­Ÿn
::
MS‘
 
m£t2a
 = 
’q
.
	`g‘_m£t
(0, 1);

1475 
	`TEST_EQUAL
(
m£t2a
.
	`size
(), 1);

1476 
X­Ÿn
::
MS‘
 
m£t2b
 = 
’q
.
	`g‘_m£t
(1, 1);

1477 
	`TEST_EQUAL
(
m£t2b
.
	`size
(), 1);

1478 
X­Ÿn
::
MS‘
 
m£t2c
 = 
’q
.
	`g‘_m£t
(2, 8);

1479 
	`TEST_EQUAL
(
m£t2c
.
	`size
(), 8);

1481 
	`TEST_EQUAL
(*
m£t1
[0], *
m£t2a
[0]);

1482 
	`TEST_EQUAL
(*
m£t1
[1], *
m£t2b
[0]);

1483 
i
 = 0; i < 8; ++i) {

1484 
	`TEST_EQUAL
(*
m£t1
[
i
 + 2], *
m£t2c
[i]);

1487  
Œue
;

1488 
	}
}

1490 
DEFINE_TESTCASE
(
üash»cov”y1
, 
b¿ss
 || 
ch”t
 || 
æšt
) {

1491 cÚ¡ 
	g¡ršg
 & 
	gdbty³
 = 
g‘_dbty³
();

1492 
¡ršg
 
	g·th
 = ".";

1493 
	g·th
 +ğ
dbty³
;

1494 
	g·th
 += "/dbw";

1495 cÚ¡ * 
	gba£_ext
 = ".baseB";

1497 
	gX­Ÿn
::
Docum’t
 
doc
;

1499 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_wr™abË_d©aba£
();

1500 
	gX­Ÿn
::
D©aba£
 
dbr
(
g‘_wr™abË_d©aba£_as_d©aba£
());

1501 
TEST_EQUAL
(
dbr
.
g‘_doccouÁ
(), 0);

1505 
	gdb
.
add_docum’t
(
doc
);

1506 
	gdb
.
comm™
();

1507 
	gdbr
.
»İ’
();

1508 
TEST_EQUAL
(
dbr
.
g‘_doccouÁ
(), 1);

1512 
	gdb
.
add_docum’t
(
doc
);

1513 
	gdb
.
comm™
();

1514 
	gdbr
.
»İ’
();

1515 
TEST_EQUAL
(
dbr
.
g‘_doccouÁ
(), 2);

1521 
uÆšk
(
·th
 + "/»cÜd" + 
ba£_ext
);

1522 
uÆšk
(
·th
 + "/‹rmli¡" + 
ba£_ext
);

1524 
	gdbr
.
»İ’
();

1525 
TEST_EQUAL
(
dbr
.
g‘_doccouÁ
(), 2);

1528 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
(
·th
, 
X­Ÿn
::
DB_OPEN
);

1530 
	gX­Ÿn
::
D©aba£
 
dbr
 = 
X­Ÿn
::D©aba£(
·th
);

1532 
	gdb
.
add_docum’t
(
doc
);

1533 
	gdb
.
comm™
();

1534 
	gdbr
.
»İ’
();

1535 
TEST_EQUAL
(
dbr
.
g‘_doccouÁ
(), 3);

1539 
	gdb
.
add_docum’t
(
doc
);

1540 
	gdb
.
comm™
();

1541 
	gdbr
.
»İ’
();

1542 
TEST_EQUAL
(
dbr
.
g‘_doccouÁ
(), 4);

1544  
	gŒue
;

1549 
	$DEFINE_TESTCASE
(
nomÜedocids1
, 
wr™abË
) {

1552 
	`SKIP_TEST_FOR_BACKEND
("inmemory");

1554 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1555 
X­Ÿn
::
Docum’t
 
doc
;

1556 
doc
.
	`£t_d©a
("prose");

1557 
doc
.
	`add_‹rm
("word");

1559 
db
.
	`»¶aû_docum’t
(
X­Ÿn
::
	`docid
(-1), 
doc
);

1561 
	`TEST_EXCEPTION
(
X­Ÿn
::
D©aba£E¼Ü
, 
db
.
	`add_docum’t
(
doc
));

1563  
Œue
;

1564 
	}
}

1567 
	$DEFINE_TESTCASE
(
synÚym™Ü1
, 
wr™abË
 && 
synÚyms
) {

1568 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1571 
	`TEST
(
db
.
	`synÚyms_begš
("abc"è=ğdb.
	`synÚyms_’d
("abc"));

1574 
	`TEST
(
db
.
	`synÚym_keys_begš
(è=ğdb.
	`synÚym_keys_’d
());

1576 
db
.
	`add_synÚym
("hello", "howdy");

1577 
db
.
	`add_synÚym
("hello", "hi");

1578 
db
.
	`add_synÚym
("goodbye", "bye");

1579 
db
.
	`add_synÚym
("goodbye", "farewell");

1581 
X­Ÿn
::
T”mI‹¿tÜ
 
t
;

1582 
¡ršg
 
s
;

1585 
times
 = 1;imes <= 2; ++times) {

1587 
	`TEST
(
db
.
	`synÚyms_begš
("abc"è=ğdb.
	`synÚyms_’d
("abc"));

1588 
	`TEST
(
db
.
	`synÚyms_begš
("ghi"è=ğdb.
	`synÚyms_’d
("ghi"));

1589 
	`TEST
(
db
.
	`synÚyms_begš
("zzzzz"è=ğdb.
	`synÚyms_’d
("zzzzz"));

1591 
s
 = "|";

1592 
t
 = 
db
.
	`synÚyms_begš
("hello");

1593 
t
 !ğ
db
.
	`synÚyms_’d
("hello")) {

1594 
s
 +ğ*
t
++;

1595 
s
 += '|';

1597 
	`TEST_STRINGS_EQUAL
(
s
, "|hi|howdy|");

1599 
s
 = "|";

1600 
t
 = 
db
.
	`synÚyms_begš
("goodbye");

1601 
t
 !ğ
db
.
	`synÚyms_’d
("goodbye")) {

1602 
s
 +ğ*
t
++;

1603 
s
 += '|';

1605 
	`TEST_STRINGS_EQUAL
(
s
, "|bye|farewell|");

1607 
s
 = "|";

1608 
t
 = 
db
.
	`synÚym_keys_begš
();

1609 
t
 !ğ
db
.
	`synÚym_keys_’d
()) {

1610 
s
 +ğ*
t
++;

1611 
s
 += '|';

1613 
	`TEST_STRINGS_EQUAL
(
s
, "|goodbye|hello|");

1615 
db
.
	`comm™
();

1619 
db
.
	`»move_synÚym
("hello", "hi");

1620 
db
.
	`ş—r_synÚyms
("goodbye");

1623 
times
 = 1;imes <= 2; ++times) {

1625 
	`TEST
(
db
.
	`synÚyms_begš
("abc"è=ğdb.
	`synÚyms_’d
("abc"));

1626 
	`TEST
(
db
.
	`synÚyms_begš
("ghi"è=ğdb.
	`synÚyms_’d
("ghi"));

1627 
	`TEST
(
db
.
	`synÚyms_begš
("zzzzz"è=ğdb.
	`synÚyms_’d
("zzzzz"));

1629 
s
 = "|";

1630 
t
 = 
db
.
	`synÚyms_begš
("hello");

1631 
t
 !ğ
db
.
	`synÚyms_’d
("hello")) {

1632 
s
 +ğ*
t
++;

1633 
s
 += '|';

1635 
	`TEST_STRINGS_EQUAL
(
s
, "|howdy|");

1637 
	`TEST
(
db
.
	`synÚyms_begš
("goodbye"è=ğdb.
	`synÚyms_’d
("goodbye"));

1639 
s
 = "|";

1640 
t
 = 
db
.
	`synÚym_keys_begš
();

1641 
t
 !ğ
db
.
	`synÚym_keys_’d
()) {

1642 
s
 +ğ*
t
++;

1643 
s
 += '|';

1645 
	`TEST_STRINGS_EQUAL
(
s
, "|hello|");

1647 
db
.
	`comm™
();

1650 
X­Ÿn
::
D©aba£
 
db_muÉi
;

1651 
db_muÉi
.
	`add_d©aba£
(
db
);

1652 
db_muÉi
.
	`add_d©aba£
(
	`g‘_d©aba£
("apitest_simpledata"));

1655 
	`TEST
(
db_muÉi
.
	`synÚyms_begš
("abc"è=ğdb_muÉi.
	`synÚyms_’d
("abc"));

1656 
	`TEST
(
db_muÉi
.
	`synÚyms_begš
("ghi"è=ğdb_muÉi.
	`synÚyms_’d
("ghi"));

1657 
	`TEST
(
db_muÉi
.
	`synÚyms_begš
("zzzzz"è=ğdb_muÉi.
	`synÚyms_’d
("zzzzz"));

1659 
s
 = "|";

1660 
t
 = 
db_muÉi
.
	`synÚyms_begš
("hello");

1661 
t
 !ğ
db_muÉi
.
	`synÚyms_’d
("hello")) {

1662 
s
 +ğ*
t
++;

1663 
s
 += '|';

1665 
	`TEST_STRINGS_EQUAL
(
s
, "|howdy|");

1667 
	`TEST
(
db_muÉi
.
	`synÚyms_begš
("goodbye"è=ğdb_muÉi.
	`synÚyms_’d
("goodbye"));

1669 
s
 = "|";

1670 
t
 = 
db_muÉi
.
	`synÚym_keys_begš
();

1671 
t
 !ğ
db_muÉi
.
	`synÚym_keys_’d
()) {

1672 
s
 +ğ*
t
++;

1673 
s
 += '|';

1675 
	`TEST_STRINGS_EQUAL
(
s
, "|hello|");

1677  
Œue
;

1678 
	}
}

1682 
	$DEFINE_TESTCASE
(
‹rmtoŞÚg1
, 
wr™abË
) {

1684 
	`SKIP_TEST_FOR_BACKEND
("inmemory");

1686 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1688 
X­Ÿn
::
doccouÁ
 
i
 = 246; i <= 290; ++i) {

1689 
tout
 << "T”m†’gth " << 
i
 << 
’dl
;

1690 
X­Ÿn
::
Docum’t
 
doc
;

1691 
¡ršg
 
	`‹rm
(
i
, 'X');

1692 
doc
.
	`add_‹rm
(
‹rm
);

1693 
Œy
 {

1694 
db
.
	`add_docum’t
(
doc
);

1695 
	`TEST_AND_EXPLAIN
(
çl£
, "Expectingƒxception InvalidArgumentError");

1696 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Inv®idArgum’tE¼Ü
 &
e
) {

1700 
tout
 << 
e
.
	`g‘_msg
(è<< 
’dl
;

1701 
	`TEST
(
e
.
	`g‘_msg
().
	`fšd
("T”moØlÚg (> 245)"è!ğ
¡ršg
::
Åos
);

1705 
X­Ÿn
::
doccouÁ
 
j
 = 240; j <= 245; ++j) {

1706 
tout
 << "T”m†’gth " << 
j
 << 
’dl
;

1707 
X­Ÿn
::
Docum’t
 
doc
;

1708 
¡ršg
 
	`‹rm
(
j
, 'X');

1709 
doc
.
	`add_‹rm
(
‹rm
);

1710 
db
.
	`add_docum’t
(
doc
);

1713 
db
.
	`comm™
();

1719 
X­Ÿn
::
Docum’t
 
doc
;

1720 
doc
.
	`add_‹rm
(
	`¡ršg
(127, '\0'));

1721 
db
.
	`add_docum’t
(
doc
);

1722 
Œy
 {

1723 
db
.
	`comm™
();

1724 
	`TEST_AND_EXPLAIN
(
çl£
, "Expectingƒxception InvalidArgumentError");

1725 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Inv®idArgum’tE¼Ü
 &
e
) {

1729 
tout
 << 
e
.
	`g‘_msg
(è<< 
’dl
;

1730 
	`TEST
(
e
.
	`g‘_msg
().
	`fšd
(" i 252 by‹s"è!ğ
¡ršg
::
Åos
);

1734  
Œue
;

1735 
	}
}

1738 
	$DEFINE_TESTCASE
(
po¡li¡7
, 
wr™abË
) {

1739 
X­Ÿn
::
Wr™abËD©aba£
 
db_w
 = 
	`g‘_wr™abË_d©aba£
();

1742 
X­Ÿn
::
Docum’t
 
doc
;

1743 
doc
.
	`add_‹rm
("foo", 3);

1744 
doc
.
	`add_‹rm
("zz", 4);

1745 
db_w
.
	`»¶aû_docum’t
(5, 
doc
);

1748 
X­Ÿn
::
Po¡šgI‹¿tÜ
 
p
;

1749 
p
 = 
db_w
.
	`po¡li¡_begš
("foo");

1750 
	`TEST
(
p
 !ğ
db_w
.
	`po¡li¡_’d
("foo"));

1751 
	`TEST_EQUAL
(*
p
, 5);

1752 
	`TEST_EQUAL
(
p
.
	`g‘_wdf
(), 3);

1753 
	`TEST_EQUAL
(
p
.
	`g‘_doş’gth
(), 7);

1754 ++
p
;

1755 
	`TEST
(
p
 =ğ
db_w
.
	`po¡li¡_’d
("foo"));

1758 
X­Ÿn
::
Docum’t
 
doc
;

1759 
doc
.
	`add_‹rm
("foo", 1);

1760 
doc
.
	`add_‹rm
("zz", 1);

1761 
db_w
.
	`»¶aû_docum’t
(6, 
doc
);

1764 
p
 = 
db_w
.
	`po¡li¡_begš
("foo");

1765 
	`TEST
(
p
 !ğ
db_w
.
	`po¡li¡_’d
("foo"));

1766 
	`TEST_EQUAL
(*
p
, 5);

1767 
	`TEST_EQUAL
(
p
.
	`g‘_wdf
(), 3);

1768 
	`TEST_EQUAL
(
p
.
	`g‘_doş’gth
(), 7);

1769 ++
p
;

1770 
	`TEST
(
p
 !ğ
db_w
.
	`po¡li¡_’d
("foo"));

1771 
	`TEST_EQUAL
(*
p
, 6);

1772 
	`TEST_EQUAL
(
p
.
	`g‘_wdf
(), 1);

1773 
	`TEST_EQUAL
(
p
.
	`g‘_doş’gth
(), 2);

1774 ++
p
;

1775 
	`TEST
(
p
 =ğ
db_w
.
	`po¡li¡_’d
("foo"));

1777  
Œue
;

1778 
	}
}

1780 
DEFINE_TESTCASE
(
ÏzybËbug1
, 
b¿ss
 || 
ch”t
 || 
æšt
) {

1782 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
 = 
g‘_Çmed_wr™abË_d©aba£
("ÏzybËbug1", 
¡ršg
());

1784 
	gX­Ÿn
::
Docum’t
 
doc
;

1785 
	gdoc
.
add_‹rm
("foo");

1786 
	gdb
.
add_docum’t
(
doc
);

1787 
	gdb
.
comm™
();

1789 
¡ršg
 
synÚym
(255, 'x');

1790 
	gbuf
[] = " iamafish!!!!!!!!!!";

1791 
	gi
 = 33; i < 120; ++i) {

1792 
	gdb
.
add_synÚym
(
buf
, 
synÚym
);

1793 ++
	gbuf
[0];

1796 
	gdb
.
comm™
();

1799 
	gX­Ÿn
::
D©aba£
 
db
 = 
g‘_wr™abË_d©aba£_as_d©aba£
();

1800 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
.
synÚym_keys_begš
(); 
	gt
 !ğdb.
synÚym_keys_’d
(); ++t) {

1801 
	gtout
 << *
	gt
 << 
	g’dl
;

1804  
	gŒue
;

1812 
DEFINE_TESTCASE
(
cursÜd–bug1
, 
b¿ss
 || 
ch”t
 || 
æšt
) {

1813 cÚ¡ 
	g‹rms
[] = { 219, 221, 222, 223, 224, 225, 226 };

1814 cÚ¡ 
	gcİ›s
[] = { 74, 116, 199, 21, 45, 155, 189 };

1816 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
;

1817 
	gdb
 = 
g‘_Çmed_wr™abË_d©aba£
("cursÜd–bug1", 
¡ršg
());

1819 
size_t
 
	gi
 = 0; i < (
	g‹rms
) / (terms[0]); ++i) {

1820 
	gX­Ÿn
::
Docum’t
 
doc
;

1821 
	gdoc
.
add_‹rm
("XC" + 
om_to¡ršg
(
‹rms
[
i
]));

1822 
	gdoc
.
add_‹rm
("XTabc");

1823 
	gdoc
.
add_‹rm
("XAdef");

1824 
	gdoc
.
add_‹rm
("XRghi");

1825 
	gdoc
.
add_‹rm
("XYabc");

1826 
size_t
 
	gc
 = 
cİ›s
[
i
];

1827 
	gc
--è
	gdb
.
add_docum’t
(
doc
);

1830 
	gdb
.
comm™
();

1832 
size_t
 
	gi
 = 0; i < (
	g‹rms
) / (terms[0]); ++i) {

1833 
	gdb
.
d–‘e_docum’t
("XC" + 
om_to¡ršg
(
‹rms
[
i
]));

1836 
	gdb
.
comm™
();

1838 
¡ršg
 
	gcmd
 = 
XAPIAN_BIN_PATH
"xapian-check ";

1839 
	gcmd
 +ğ
g‘_Çmed_wr™abË_d©aba£_·th
("cursordelbug1");

1840 #ifdeà
__WIN32__


1841 
	gcmd
 += " >nul";

1843 
	gcmd
 += " >/dev/null";

1845 ià(
sy¡em
(
cmd
.
c_¡r
()) != 0)

1846  
çl£
;

1848  
	gŒue
;

1855 
check_v®s
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, cÚ¡ 
m­
<X­Ÿn::
docid
, 
¡ršg
> & 
v®s
)

1857 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), 
v®s
.
size
());

1858 ià(
	gv®s
.
size
() == 0) ;

1859 
TEST_REL
(
v®s
.
rbegš
()->
fœ¡
,<=,
db
.
g‘_Ï¡docid
());

1860 
	gm­
<
	gX­Ÿn
::
docid
, 
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
;

1861 
	gi
 = 
v®s
.
begš
(); i !ğv®s.
’d
(); ++i) {

1862 
	gtout
.
¡r
(
¡ršg
());

1863 
	gtout
 << "Checkšg v®uš doø" << 
	gi
->
	gfœ¡
 << " - should b'" << i->
	g£cÚd
 << "'\n";

1864 
	gX­Ÿn
::
Docum’t
 
doc
 = 
db
.
g‘_docum’t
(
i
->
fœ¡
);

1865 
¡ršg
 
	gdbv®
 = 
doc
.
g‘_v®ue
(1);

1866 
TEST_EQUAL
(
dbv®
, 
i
->
£cÚd
);

1867 ià(
	gdbv®
.
em±y
()) {

1868 
TEST_EQUAL
(0, 
doc
.
v®ues_couÁ
());

1869 
TEST_EQUAL
(
doc
.
v®ues_begš
(), doc.
v®ues_’d
());

1871 
TEST_EQUAL
(1, 
doc
.
v®ues_couÁ
());

1872 
	gX­Ÿn
::
V®ueI‹¿tÜ
 
v®™
 = 
doc
.
v®ues_begš
();

1873 
TEST_NOT_EQUAL
(
v®™
, 
doc
.
v®ues_’d
());

1874 
TEST_EQUAL
(
dbv®
, *
v®™
);

1875 
TEST_EQUAL
(1, 
v®™
.
g‘_v®u’o
());

1876 ++
	gv®™
;

1877 
TEST_EQUAL
(
v®™
, 
doc
.
v®ues_’d
());

1885 
	$DEFINE_TESTCASE
(
modifyv®ues1
, 
wr™abË
) {

1886 
£ed
 = 7;

1887 
X­Ÿn
::
Wr™abËD©aba£
 
db
 = 
	`g‘_wr™abË_d©aba£
();

1889 cÚ¡ 
X­Ÿn
::
doccouÁ
 doccount = 1000;

1890 
	`STATIC_ASSERT
(
doccouÁ
 % 13 != 0);

1892 
m­
<
X­Ÿn
::
docid
, 
¡ršg
> 
v®s
;

1894 
X­Ÿn
::
doccouÁ
 
num
 = 1;‚um <= doccount; ++num) {

1895 
tout
.
	`¡r
(
	`¡ršg
());

1896 
X­Ÿn
::
Docum’t
 
doc
;

1897 
¡ršg
 
v®
 = "v®" + 
	`om_to¡ršg
(
num
);

1898 
tout
 << "S‘tšg v® '" << 
v®
 << "' iÀdoø" << 
num
 << "\n";

1899 
doc
.
	`add_v®ue
(1, 
v®
);

1900 
db
.
	`add_docum’t
(
doc
);

1901 
v®s
[
num
] = 
v®
;

1903 
	`check_v®s
(
db
, 
v®s
);

1904 
db
.
	`comm™
();

1905 
	`check_v®s
(
db
, 
v®s
);

1910 
X­Ÿn
::
Docum’t
 
doc
;

1911 
¡ršg
 
v®
 = "newval0";

1912 
tout
 << "S‘tšg v® '" << 
v®
 << "' in doc 2\n";

1913 
doc
.
	`add_v®ue
(1, 
v®
);

1914 
db
.
	`»¶aû_docum’t
(2, 
doc
);

1915 
v®s
[2] = 
v®
;

1916 
	`check_v®s
(
db
, 
v®s
);

1917 
db
.
	`comm™
();

1918 
	`check_v®s
(
db
, 
v®s
);

1923 
tout
 << "Replacing document 1 with itself\n";

1924 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(1);

1925 
db
.
	`»¶aû_docum’t
(1, 
doc
);

1926 
	`check_v®s
(
db
, 
v®s
);

1927 
db
.
	`comm™
();

1928 
	`check_v®s
(
db
, 
v®s
);

1936 
tout
 << "Replacing document 1 with itself,‡fter„eading doc 2.\n";

1937 
X­Ÿn
::
Docum’t
 
doc
 = 
db
.
	`g‘_docum’t
(1);

1938 
db
.
	`g‘_docum’t
(2);

1939 
db
.
	`»¶aû_docum’t
(1, 
doc
);

1940 
	`check_v®s
(
db
, 
v®s
);

1941 
db
.
	`comm™
();

1942 
	`check_v®s
(
db
, 
v®s
);

1947 
tout
 << "S‘tšg s“dØ" << 
£ed
 << "\n";

1948 
	`¤ªd
(
£ed
);

1949 
X­Ÿn
::
doccouÁ
 
num
 = 1;‚um <= doccount * 2; ++num) {

1950 
tout
.
	`¡r
(
	`¡ršg
());

1951 
X­Ÿn
::
docid
 
did
 = ((
	`¿nd
(è>> 8è% 
doccouÁ
) + 1;

1952 
X­Ÿn
::
Docum’t
 
doc
;

1953 
¡ršg
 
v®
;

1955 ià(
num
 % 5 != 0) {

1956 
v®
 = "Ãwv®" + 
	`om_to¡ršg
(
num
);

1957 
tout
 << "S‘tšg v® '" << 
v®
 << "' iÀdoø" << 
did
 << "\n";

1958 
doc
.
	`add_v®ue
(1, 
v®
);

1960 
tout
 << "Addšg/»¶acšgƒm±y docum’ˆ" << 
did
 << "\n";

1962 
db
.
	`»¶aû_docum’t
(
did
, 
doc
);

1963 
v®s
[
did
] = 
v®
;

1965 
	`check_v®s
(
db
, 
v®s
);

1966 
db
.
	`comm™
();

1967 
	`check_v®s
(
db
, 
v®s
);

1971 
X­Ÿn
::
doccouÁ
 
num
 = 0;‚um < doccount * 13;‚um += 13) {

1972 
tout
.
	`¡r
(
	`¡ršg
());

1973 
X­Ÿn
::
docid
 
did
 = (
num
 % 
doccouÁ
) + 1;

1974 
tout
 << "CË¬šg v® iÀdoø" << 
did
 << "\n";

1975 
X­Ÿn
::
Docum’t
 
doc
;

1976 
db
.
	`»¶aû_docum’t
(
did
, 
doc
);

1977 
v®s
[
did
] = 
	`¡ršg
();

1979 
	`check_v®s
(
db
, 
v®s
);

1980 
db
.
	`comm™
();

1981 
	`check_v®s
(
db
, 
v®s
);

1983  
Œue
;

1984 
	}
}

	@tests/api_wrdb.h

2 
boŞ
 
‹¡_adddoc1
();

3 
boŞ
 
‹¡_adddoc2
();

4 
boŞ
 
‹¡_adddoc3
();

5 
boŞ
 
‹¡_adddoc4
();

6 
boŞ
 
‹¡_adddoc5
();

7 
boŞ
 
‹¡_adddoc6
();

8 
boŞ
 
‹¡_im¶ic™’d£ssiÚ1
();

9 
boŞ
 
‹¡_d©aba£assign1
();

10 
boŞ
 
‹¡_d–doc1
();

11 
boŞ
 
‹¡_d–doc2
();

12 
boŞ
 
‹¡_d–doc3
();

13 
boŞ
 
‹¡_d–doc4
();

14 
boŞ
 
‹¡_d–doc5
();

15 
boŞ
 
‹¡_d–doc6
();

16 
boŞ
 
‹¡_»¶aûdoc1
();

17 
boŞ
 
‹¡_»¶aûdoc2
();

18 
boŞ
 
‹¡_»¶aûdoc3
();

19 
boŞ
 
‹¡_»¶aûdoc4
();

20 
boŞ
 
‹¡_»¶aûdoc5
();

21 
boŞ
 
‹¡_»¶aûdoc6
();

22 
boŞ
 
‹¡_uniqu‘”m1
();

23 
boŞ
 
‹¡_®Ío¡li¡2
();

24 
boŞ
 
‹¡_em±y‹rm2
();

25 
boŞ
 
‹¡_ph¿£ÜÃ¬tßnd1
();

26 
boŞ
 
‹¡_lÚgpos™iÚli¡1
();

27 
boŞ
 
‹¡_cÚsi¡’cy2
();

28 
boŞ
 
‹¡_üash»cov”y1
();

29 
boŞ
 
‹¡_nomÜedocids1
();

30 
boŞ
 
‹¡_synÚym™Ü1
();

31 
boŞ
 
‹¡_‹rmtoŞÚg1
();

32 
boŞ
 
‹¡_po¡li¡7
();

33 
boŞ
 
‹¡_ÏzybËbug1
();

34 
boŞ
 
‹¡_cursÜd–bug1
();

35 
boŞ
 
‹¡_modifyv®ues1
();

	@tests/apitest.cc

24 
	~<cÚfig.h
>

26 
	~"­™e¡.h
"

28 
	~"­i_®l.h
"

29 
	~"back’dmªag”.h
"

30 
	~"¡ršguts.h
"

31 
	~"‹¡ruÂ”.h
"

32 
	~"‹¡su™e.h
"

34 
	~<x­Ÿn.h
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
	g¡d
::
¡ršg
 
	$g‘_dbty³
()

43  
back’dmªag”
->
	`g‘_dbty³
();

44 
	}
}

46 
	gX­Ÿn
::
D©aba£


47 
	$g‘_d©aba£
(cÚ¡ 
¡ršg
 &
dbÇme
)

49  
back’dmªag”
->
	`g‘_d©aba£
(
dbÇme
);

50 
	}
}

52 
	gX­Ÿn
::
D©aba£


53 
	$g‘_d©aba£
(cÚ¡ 
¡ršg
 &
dbÇme
, cÚ¡ sŒšg &
dbÇme2
)

55 
veùÜ
<
¡ršg
> 
dbÇmes
;

56 
dbÇmes
.
	`push_back
(
dbÇme
);

57 
dbÇmes
.
	`push_back
(
dbÇme2
);

58  
back’dmªag”
->
	`g‘_d©aba£
(
dbÇmes
);

59 
	}
}

61 
	gX­Ÿn
::
D©aba£


62 
g‘_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
dbÇme
,

63 (*
g’
)(
X­Ÿn
::
Wr™abËD©aba£
&,

64 cÚ¡ 
¡d
::
¡ršg
 &),

65 cÚ¡ 
¡d
::
¡ršg
 &
¬g
)

67  
back’dmªag”
->
	`g‘_d©aba£
(
dbÇme
, 
g’
, 
¬g
);

68 
	}
}

70 
¡ršg


71 
	$g‘_d©aba£_·th
(cÚ¡ 
¡ršg
 &
dbÇme
)

73  
back’dmªag”
->
	`g‘_d©aba£_·th
(
dbÇme
);

74 
	}
}

76 
¡ršg


77 
g‘_d©aba£_·th
(cÚ¡ 
¡d
::
¡ršg
 &
dbÇme
,

78 (*
g’
)(
X­Ÿn
::
Wr™abËD©aba£
&,

79 cÚ¡ 
¡d
::
¡ršg
 &),

80 cÚ¡ 
¡d
::
¡ršg
 &
¬g
)

82  
back’dmªag”
->
	`g‘_d©aba£_·th
(
dbÇme
, 
g’
, 
¬g
);

83 
	}
}

85 
	gX­Ÿn
::
Wr™abËD©aba£


86 
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 &
dbÇme
)

88  
back’dmªag”
->
	`g‘_wr™abË_d©aba£
("dbw", 
dbÇme
);

89 
	}
}

91 
	gX­Ÿn
::
Wr™abËD©aba£


92 
g‘_Çmed_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, cÚ¡ std::¡ršg &
sourû
)

94  
back’dmªag”
->
g‘_wr™abË_d©aba£
("dbw__" + 
Çme
, 
sourû
);

97 
	g¡d
::
¡ršg


98 
g‘_Çmed_wr™abË_d©aba£_·th
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
)

100  
back’dmªag”
->
g‘_wr™abË_d©aba£_·th
("dbw__" + 
Çme
);

103 
	gX­Ÿn
::
D©aba£


104 
	$g‘_»mÙe_d©aba£
(cÚ¡ 
¡ršg
 &
dbÇme
, 
timeout
)

106 
veùÜ
<
¡ršg
> 
dbÇmes
;

107 
dbÇmes
.
	`push_back
(
dbÇme
);

108  
back’dmªag”
->
	`g‘_»mÙe_d©aba£
(
dbÇmes
, 
timeout
);

109 
	}
}

111 
	gX­Ÿn
::
D©aba£


112 
	$g‘_wr™abË_d©aba£_as_d©aba£
()

114  
back’dmªag”
->
	`g‘_wr™abË_d©aba£_as_d©aba£
();

115 
	}
}

117 
	gX­Ÿn
::
Wr™abËD©aba£


118 
	$g‘_wr™abË_d©aba£_agaš
()

120  
back’dmªag”
->
	`g‘_wr™abË_d©aba£_agaš
();

121 
	}
}

124 
sk_‹¡_uÆess_back’d
(cÚ¡ 
¡d
::
¡ršg
 & 
back’d_´efix
)

126 ià(!
¡¬tsw™h
(
g‘_dbty³
(), 
back’d_´efix
)) {

127 
SKIP_TEST
("Te¡ oÆy suµÜ‹d fÜ " + 
back’d_´efix
 + " backend");

132 
sk_‹¡_fÜ_back’d
(cÚ¡ 
¡d
::
¡ršg
 & 
back’d_´efix
)

134 ià(
¡¬tsw™h
(
g‘_dbty³
(), 
back’d_´efix
)) {

135 
SKIP_TEST
("Te¡‚Ù suµÜ‹d fÜ " + 
back’d_´efix
 + " backend");

139 şas 
	cApiTe¡RuÂ”
 : 
public
 
Te¡RuÂ”


141 
public
:

142 
	$run
() const {

143 
»suÉ
 = 0;

144 
	~"­i_cŞÏ‹d.h
"

145 
‹¡_driv”
::
	`»pÜt
Ñe¡_driv”::
subtÙ®
,

146 "back’d " + 
back’dmªag”
->
	`g‘_dbty³
());

147 
‹¡_driv”
::
tÙ®
 +ğ‹¡_driv”::
subtÙ®
;

148 
‹¡_driv”
::
subtÙ®
.
	`»£t
();

149  
»suÉ
;

151 
	}
};

153 
	$maš
(
¬gc
, **
¬gv
)

155 
ApiTe¡RuÂ”
 
ruÂ”
;

156  
ruÂ”
.
	`run_‹¡s
(
¬gc
, 
¬gv
);

157 
	}
}

	@tests/apitest.h

21 #iâdeà
XAPIAN_INCLUDED_APITEST_H


22 
	#XAPIAN_INCLUDED_APITEST_H


	)

24 
	~<x­Ÿn.h
>

26 
	~"‹¡su™e.h
"

28 
	g¡d
::
¡ršg
 
g‘_dbty³
();

30 
	gX­Ÿn
::
D©aba£
 
g‘_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
db
);

32 
	gX­Ÿn
::
D©aba£
 
g‘_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
db1
, cÚ¡ std::¡ršg &
db2
);

34 
	gX­Ÿn
::
D©aba£
 
g‘_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
db
,

35 (*
g’
)(
X­Ÿn
::
Wr™abËD©aba£
&,

36 cÚ¡ 
¡d
::
¡ršg
 &),

37 cÚ¡ 
¡d
::
¡ršg
 &
¬g
 = std::
	`¡ršg
());

39 
¡d
::
¡ršg
 
	`g‘_d©aba£_·th
(cÚ¡ std::¡ršg &
db
);

41 
¡d
::
¡ršg
 
	`g‘_d©aba£_·th
(cÚ¡ std::¡ršg &
db
,

42 (*
g’
)(
X­Ÿn
::
Wr™abËD©aba£
&,

43 cÚ¡ 
¡d
::
¡ršg
 &),

44 cÚ¡ 
¡d
::
¡ršg
 &
¬g
 = std::
	`¡ršg
());

46 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
db
 = std::
	`¡ršg
());

48 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_Çmed_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, cÚ¡ std::¡ršg &
sourû
 = std::
	`¡ršg
());

50 
¡d
::
¡ršg
 
	`g‘_Çmed_wr™abË_d©aba£_·th
(cÚ¡ std::¡ršg &
Çme
);

52 
X­Ÿn
::
D©aba£
 
	`g‘_»mÙe_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
db
, 
timeout
);

54 
X­Ÿn
::
D©aba£
 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

56 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£_agaš
();

64 
	`sk_‹¡_uÆess_back’d
(cÚ¡ 
¡d
::
¡ršg
 & 
back’d_´efix
);

71 
	`sk_‹¡_fÜ_back’d
(cÚ¡ 
¡d
::
¡ršg
 & 
back’d_´efix
);

73 
	#SKIP_TEST_UNLESS_BACKEND
(
B
è
	`sk_‹¡_uÆess_back’d
(B)

	)

74 
	#SKIP_TEST_FOR_BACKEND
(
B
è
	`sk_‹¡_fÜ_back’d
(B)

	)

	@tests/dbcheck.cc

21 
	~<cÚfig.h
>

23 
	~"dbcheck.h
"

25 
	~"¡r.h
"

26 
	~"‹¡su™e.h
"

28 
usšg
 
Çme¥aû
 
	g¡d
;

30 
¡ršg


31 
pos™iÚs_to_¡ršg
(
X­Ÿn
::
Pos™iÚI‹¿tÜ
 & 
™
,

32 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 & 
’d
,

33 
X­Ÿn
::
‹rmcouÁ
 * 
couÁ
) {

34 
¡ršg
 
»suÉ
;

35 
boŞ
 
	gÃed_comma
 = 
çl£
;

36 
	gX­Ÿn
::
‹rmcouÁ
 
c
 = 0;

37 
	g™
 !ğ
’d
) {

38 ià(
Ãed_comma
)

39 
»suÉ
 += ", ";

40 
	g»suÉ
 +ğ
¡r
(*
™
);

41 
	gÃed_comma
 = 
Œue
;

42 ++
	g™
;

43 ++
	gc
;

45 ià(
	gcouÁ
) {

46 *
	gcouÁ
 = 
c
;

48  
	g»suÉ
;

51 
¡ršg


52 
po¡li¡_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, cÚ¡ 
¡ršg
 & 
Šame
) {

53 
¡ršg
 
	g»suÉ
;

54 
boŞ
 
	gÃed_comma
 = 
çl£
;

56 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 
p
 = 
db
.
po¡li¡_begš
(
Šame
);

57 
	gp
 !ğ
db
.
po¡li¡_’d
(
Šame
);

58 ++
	gp
) {

59 ià(
	gÃed_comma
)

60 
	g»suÉ
 += ", ";

62 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
™
(
p
.
pos™iÚli¡_begš
());

63 
¡ršg
 
	gpo¤•r
 = 
pos™iÚs_to_¡ršg
(
™
, 
p
.
pos™iÚli¡_’d
());

64 ià(!
	gpo¤•r
.
em±y
()) {

65 
	gpo¤•r
 = ",…os=[" + 
po¤•r
 + "]";

68 
	g»suÉ
 +ğ"(" + 
¡r
(*
p
) +

69 ", doş’=" + 
¡r
(
p
.
g‘_doş’gth
()) +

70 ", wdf=" + 
¡r
(
p
.
g‘_wdf
()) +

71 
po¤•r
 + ")";

72 
	gÃed_comma
 = 
Œue
;

74  
	g»suÉ
;

77 
¡ršg


78 
doù”ms_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, X­Ÿn::
docid
 
did
) {

79 
¡ršg
 
»suÉ
;

80 
boŞ
 
	gÃed_comma
 = 
çl£
;

82 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
 = 
db
.
‹rmli¡_begš
(
did
);

83 
	gt
 !ğ
db
.
‹rmli¡_’d
(
did
);

84 ++
	gt
) {

85 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
™
(
t
.
pos™iÚli¡_begš
());

86 
¡ršg
 
	gpo¤•r
 = 
pos™iÚs_to_¡ršg
(
™
, 
t
.
pos™iÚli¡_’d
());

87 ià(!
	gpo¤•r
.
em±y
()) {

88 
	gpo¤•r
 = ",…os=[" + 
po¤•r
 + "]";

90 ià(
	gÃed_comma
)

91 
	g»suÉ
 += ", ";

92 
	g»suÉ
 +ğ"T”m(" + *
t
 + ", wdf=" + 
¡r
Ñ.
g‘_wdf
()è+ 
po¤•r
 + ")";

93 
	gÃed_comma
 = 
Œue
;

95  
	g»suÉ
;

98 
¡ršg


99 
doc¡©s_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, X­Ÿn::
docid
 
did
) {

100 
¡ršg
 
»suÉ
;

102 
	g»suÉ
 +ğ"Ën=" + 
¡r
(
db
.
g‘_doş’gth
(
did
));

104  
	g»suÉ
;

107 
¡ršg


108 
‹rm¡©s_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, cÚ¡ 
¡ršg
 & 
‹rm
) {

109 
¡ršg
 
	g»suÉ
;

111 
	g»suÉ
 +ğ"tf=" + 
¡r
(
db
.
g‘_‹rmäeq
(
‹rm
));

112 
	g»suÉ
 +ğ",cf=" + 
¡r
(
db
.
g‘_cŞËùiÚ_äeq
(
‹rm
));

114  
	g»suÉ
;

117 
¡ršg


118 
db¡©s_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
) {

119 
¡ršg
 
»suÉ
;

121 
	g»suÉ
 +ğ"dc=" + 
¡r
(
db
.
g‘_doccouÁ
());

122 
	g»suÉ
 +ğ",®=" + 
¡r
(
db
.
g‘_avËngth
());

123 
	g»suÉ
 +ğ",ld=" + 
¡r
(
db
.
g‘_Ï¡docid
());

125  
	g»suÉ
;

129 
dbcheck
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
,

130 
X­Ÿn
::
doccouÁ
 
ex³ùed_doccouÁ
,

131 
X­Ÿn
::
docid
 
ex³ùed_Ï¡docid
) {

132 
TEST_EQUAL
(
db
.
g‘_doccouÁ
(), 
ex³ùed_doccouÁ
);

133 
TEST_EQUAL
(
db
.
g‘_Ï¡docid
(), 
ex³ùed_Ï¡docid
);

137 
	gtÙËn
 = 0;

142 
	gm­
<
	g¡ršg
, sŒšg> 
	gpo¡šg_»´s
;

144 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 
doc™”
 = 
db
.
po¡li¡_begš
(
¡ršg
());

145 
	gdoc™”
 !ğ
db
.
po¡li¡_’d
(
¡ršg
());

146 ++
	gdoc™”
) {

147 
	gX­Ÿn
::
docid
 
did
 = *
doc™”
;

148 
TEST_EQUAL
(
doc™”
.
g‘_wdf
(), 1);

149 
	gX­Ÿn
::
Docum’t
 
doc
(
db
.
g‘_docum’t
(
did
));

150 
	gX­Ÿn
::
‹rmcouÁ
 
doş’
(
db
.
g‘_doş’gth
(
did
));

151 
	gtÙËn
 +ğ
doş’
;

153 
	gX­Ÿn
::
‹rmcouÁ
 
found_‹rmcouÁ
 = 0;

154 
	gX­Ÿn
::
‹rmcouÁ
 
wdf_sum
 = 0;

155 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
, 
	gt2
;

156 
	gt
 = 
doc
.
‹rmli¡_begš
(), 
	gt2
 = 
db
.‹rmli¡_begš(
did
);

157 
	gt
 !ğ
doc
.
‹rmli¡_’d
();

158 ++
	gt
, ++
	gt2
) {

159 
TEST
(
t2
 !ğ
db
.
‹rmli¡_’d
(
did
));

161 ++
	gfound_‹rmcouÁ
;

162 
	gwdf_sum
 +ğ
t
.
g‘_wdf
();

164 
TEST_EQUAL
(*
t
, *
t2
);

165 
TEST_EQUAL
(
t
.
g‘_wdf
(), 
t2
.get_wdf());

166 
TEST_EQUAL
(
db
.
g‘_‹rmäeq
(*
t
),.get_termfreq());

167 
TEST_EQUAL
(
db
.
g‘_‹rmäeq
(*
t
), 
t2
.get_termfreq());

170 
	gX­Ÿn
::
‹rmcouÁ
 
tc1
, 
	gtc2
;

171 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
™1
(
t
.
pos™iÚli¡_begš
());

172 
¡ršg
 
	gpo¤•r
 = 
pos™iÚs_to_¡ršg
(
™1
, 
t
.
pos™iÚli¡_’d
(), &
tc1
);

173 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
™2
(
t2
.
pos™iÚli¡_begš
());

174 
¡ršg
 
	gpo¤•r2
 = 
pos™iÚs_to_¡ršg
(
™2
, 
t2
.
pos™iÚli¡_’d
(), &
tc2
);

175 
TEST_EQUAL
(
po¤•r
, 
po¤•r2
);

176 
TEST_EQUAL
(
tc1
, 
tc2
);

177 
	gŒy
 {

178 
TEST_EQUAL
(
tc1
, 
t
.
pos™iÚli¡_couÁ
());

179 } 
ÿtch
 (
X­Ÿn
::
Unim¶em’‹dE¼Ü
) {

184 ià(!
po¤•r
.
em±y
()) {

185 
po¤•r
 = ",[" +…osrepr + "]";

187 
¡ršg
 
	gpo¡šg_»´
 = "(" + 
¡r
(
did
) + "," +

188 
¡r
(
t
.
g‘_wdf
()è+ "/" + sŒ(
doş’
) +

189 
po¤•r
 + ")";

192 
	gm­
<
	g¡ršg
, sŒšg>::
™”©Ü
 
i
 = 
po¡šg_»´s
.
fšd
(*
t
);

193 ià(
	gi
 =ğ
po¡šg_»´s
.
’d
()) {

194 
po¡šg_»´s
[*
t
] = 
po¡šg_»´
;

196 
	gi
->
	g£cÚd
 +ğ"," + 
po¡šg_»´
;

199 
TEST
(
t2
 =ğ
db
.
‹rmli¡_’d
(
did
));

200 
	gX­Ÿn
::
‹rmcouÁ
 
ex³ùed_‹rmcouÁ
 = 
doc
.
‹rmli¡_couÁ
();

201 
TEST_EQUAL
(
ex³ùed_‹rmcouÁ
, 
found_‹rmcouÁ
);

202 
TEST_EQUAL
(
doş’
, 
wdf_sum
);

205 
	gX­Ÿn
::
T”mI‹¿tÜ
 
t
;

206 
	gm­
<
	g¡ršg
, sŒšg>::
cÚ¡_™”©Ü
 
i
;

207 
	gt
 = 
db
.
®É”ms_begš
(), 
	gi
 = 
po¡šg_»´s
.
begš
();

208 
	gt
 !ğ
db
.
®É”ms_’d
();

209 ++
	gt
, ++
	gi
) {

210 
TEST
(
db
.
‹rm_exi¡s
(*
t
));

211 
TEST
(
i
 !ğ
po¡šg_»´s
.
’d
());

212 
TEST_EQUAL
(
i
->
fœ¡
, *
t
);

214 
	gX­Ÿn
::
doccouÁ
 
tf_couÁ
 = 0;

215 
	gX­Ÿn
::
‹rmcouÁ
 
cf_couÁ
 = 0;

216 
¡ršg
 
	gpo¡šg_»´
;

217 
boŞ
 
	gÃed_comma
 = 
çl£
;

218 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 
p
 = 
db
.
po¡li¡_begš
(*
t
);

219 
	gp
 !ğ
db
.
po¡li¡_’d
(*
t
);

220 ++
	gp
) {

221 ià(
	gÃed_comma
) {

222 
	gpo¡šg_»´
 += ",";

225 ++
	gtf_couÁ
;

226 
	gcf_couÁ
 +ğ
p
.
g‘_wdf
();

228 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
™
(
p
.
pos™iÚli¡_begš
());

229 
¡ršg
 
	gpo¤•r
 = 
pos™iÚs_to_¡ršg
(
™
, 
p
.
pos™iÚli¡_’d
());

230 ià(!
	gpo¤•r
.
em±y
()) {

231 
	gpo¤•r
 = ",[" + 
po¤•r
 + "]";

233 
	gpo¡šg_»´
 +ğ"(" + 
¡r
(*
p
) + "," +

234 
¡r
(
p
.
g‘_wdf
()è+ "/" + sŒÕ.
g‘_doş’gth
()) +

235 
po¤•r
 + ")";

236 
	gÃed_comma
 = 
Œue
;

239 
TEST_EQUAL
(
po¡šg_»´
, 
i
->
£cÚd
);

240 
TEST_EQUAL
(
tf_couÁ
, 
t
.
g‘_‹rmäeq
());

241 
TEST_EQUAL
(
tf_couÁ
, 
db
.
g‘_‹rmäeq
(*
t
));

242 
TEST_EQUAL
(
cf_couÁ
, 
db
.
g‘_cŞËùiÚ_äeq
(*
t
));

244 
TEST
(
i
 =ğ
po¡šg_»´s
.
’d
());

246 ià(
	gex³ùed_doccouÁ
 == 0) {

247 
TEST_EQUAL
(0, 
db
.
g‘_avËngth
());

249 
TEST_EQUAL_DOUBLE
((
tÙËn
è/ 
ex³ùed_doccouÁ
,

250 
db
.
g‘_avËngth
());

	@tests/dbcheck.h

21 #iâdeà
XAPIAN_INCLUDED_DBCHECK_H


22 
	#XAPIAN_INCLUDED_DBCHECK_H


	)

24 
	~<x­Ÿn.h
>

25 
	~<¡ršg
>

34 
	g¡d
::
¡ršg


35 
pos™iÚs_to_¡ršg
(
X­Ÿn
::
Pos™iÚI‹¿tÜ
 & 
™
,

36 cÚ¡ 
X­Ÿn
::
Pos™iÚI‹¿tÜ
 & 
’d
,

37 
X­Ÿn
::
‹rmcouÁ
 * 
couÁ
 = 
NULL
);

43 
	g¡d
::
¡ršg


44 
po¡li¡_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, cÚ¡ 
¡d
::
¡ršg
 & 
Šame
);

50 
	g¡d
::
¡ršg


51 
doù”ms_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, X­Ÿn::
docid
 
did
);

54 
	g¡d
::
¡ršg


55 
doc¡©s_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, X­Ÿn::
docid
 
did
);

58 
	g¡d
::
¡ršg


59 
‹rm¡©s_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
, cÚ¡ 
¡d
::
¡ršg
 & 
‹rm
);

62 
	g¡d
::
¡ršg


63 
db¡©s_to_¡ršg
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
);

70 
dbcheck
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
,

71 
X­Ÿn
::
doccouÁ
 
ex³ùed_doccouÁ
,

72 
X­Ÿn
::
docid
 
ex³ùed_Ï¡docid
);

	@tests/harness/backendmanager.cc

23 
	~<cÚfig.h
>

25 
	~<x­Ÿn.h
>

27 #ifdeà
HAVE_VALGRIND


28 
	~<v®gršd/memcheck.h
>

31 
	~"§ã”ºo.h
"

33 
	~<f¡»am
>

34 
	~<¡ršg
>

35 
	~<veùÜ
>

37 
	~<sys/ty³s.h
>

38 
	~"§ãsys¡©.h
"

40 
	~"šdex_uts.h
"

41 
	~"back’dmªag”.h
"

42 
	~"unixcmds.h
"

43 
	~"uts.h
"

45 
usšg
 
Çme¥aû
 
	g¡d
;

48 
	gBack’dMªag”
::
šdex_fes_to_d©aba£
(
X­Ÿn
::
Wr™abËD©aba£
 & 
d©aba£
,

49 cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

51 
FeIndex”
 
f
(
d©adœ
, 
fes
);

52 
	gf
è
	gd©aba£
.
add_docum’t
(
f
.
Ãxt
());

59 
boŞ


60 
	gBack’dMªag”
::
	$ü—‹_dœ_if_Ãeded
(cÚ¡ 
¡ršg
 &
dœÇme
)

63 
¡©
 
sbuf
;

64 
»suÉ
 = 
	`¡©
(
dœÇme
, &
sbuf
);

65 ià(
»suÉ
 < 0) {

66 ià(
”ºo
 !ğ
ENOENT
)

67 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Can't stat directory");

68 ià(
	`mkdœ
(
dœÇme
, 0700) < 0)

69 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Can't create directory");

70  
Œue
;

72 ià(!
	`S_ISDIR
(
sbuf
.
¡_mode
))

73 
throw
 
X­Ÿn
::
	`D©aba£O³nšgE¼Ü
("Is‚ot‡ directory.");

74  
çl£
;

75 
	}
}

77 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


78 
	gX­Ÿn
::
Wr™abËD©aba£


79 
Back’dMªag”
::
g‘wr™edb_šmemÜy
(cÚ¡ 
veùÜ
<
¡ršg
> &
fes
)

81 
X­Ÿn
::
Wr™abËD©aba£
 
db
(X­Ÿn::
InMemÜy
::
İ’
());

82 
šdex_fes_to_d©aba£
(
db
, 
fes
);

83  
	gdb
;

87 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


88 
¡ršg


89 
	gBack’dMªag”
::
ü—‹db_b¿ss
(cÚ¡ 
veùÜ
<
¡ršg
> &
fes
)

91 
¡ršg
 
·»Á_dœ
 = ".brass";

92 
ü—‹_dœ_if_Ãeded
(
·»Á_dœ
);

94 
¡ršg
 
	gdbdœ
 = 
·»Á_dœ
 + "/db";

95 
	gveùÜ
<
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
 = 
fes
.
begš
();

96 
	gi
 !ğ
fes
.
’d
(); i++) {

97 
	gdbdœ
 += '=';

98 
	gdbdœ
 +ğ*
i
;

101 ià(
ü—‹_dœ_if_Ãeded
(
dbdœ
)) {

103 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
(
X­Ÿn
::
B¿ss
::
İ’
(
dbdœ
, X­Ÿn::
DB_CREATE
, 2048));

104 
šdex_fes_to_d©aba£
(
db
, 
fes
);

106  
	gdbdœ
;

109 
	gX­Ÿn
::
Wr™abËD©aba£


110 
Back’dMªag”
::
g‘wr™edb_b¿ss
(cÚ¡ 
¡ršg
 & 
Çme
,

111 cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

113 
¡ršg
 
	gdbdœ
 = 
g‘wr™edb_b¿ss_·th
(
Çme
);

116 
rm_rf
(
dbdœ
);

117 ()
ü—‹_dœ_if_Ãeded
(
dbdœ
);

120 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
(
X­Ÿn
::
B¿ss
::
İ’
(
dbdœ
, X­Ÿn::
DB_CREATE
, 2048));

121 
šdex_fes_to_d©aba£
(
db
, 
fes
);

122  
	gdb
;

125 
	g¡d
::
¡ršg


126 
Back’dMªag”
::
	$g‘wr™edb_b¿ss_·th
(cÚ¡ 
¡ršg
 & 
Çme
)

128 
¡ršg
 
·»Á_dœ
 = ".brass";

129 
	`ü—‹_dœ_if_Ãeded
(
·»Á_dœ
);

131 
¡ršg
 
dbdœ
 = 
·»Á_dœ
;

132 
dbdœ
 += '/';

133 
dbdœ
 +ğ
Çme
;

134  
dbdœ
;

135 
	}
}

138 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


139 
¡ršg


140 
	gBack’dMªag”
::
ü—‹db_ch”t
(cÚ¡ 
veùÜ
<
¡ršg
> &
fes
)

142 
¡ršg
 
·»Á_dœ
 = ".chert";

143 
ü—‹_dœ_if_Ãeded
(
·»Á_dœ
);

145 
¡ršg
 
	gdbdœ
 = 
·»Á_dœ
 + "/db";

146 
	gveùÜ
<
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
 = 
fes
.
begš
();

147 
	gi
 !ğ
fes
.
’d
(); i++) {

148 
	gdbdœ
 += '=';

149 
	gdbdœ
 +ğ*
i
;

152 ià(
ü—‹_dœ_if_Ãeded
(
dbdœ
)) {

154 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
(
X­Ÿn
::
Ch”t
::
İ’
(
dbdœ
, X­Ÿn::
DB_CREATE
, 2048));

155 
šdex_fes_to_d©aba£
(
db
, 
fes
);

157  
	gdbdœ
;

160 
	gX­Ÿn
::
Wr™abËD©aba£


161 
Back’dMªag”
::
g‘wr™edb_ch”t
(cÚ¡ 
¡ršg
 & 
Çme
,

162 cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

164 
¡ršg
 
	gdbdœ
 = 
g‘wr™edb_ch”t_·th
(
Çme
);

167 
rm_rf
(
dbdœ
);

168 ()
ü—‹_dœ_if_Ãeded
(
dbdœ
);

171 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
(
X­Ÿn
::
Ch”t
::
İ’
(
dbdœ
, X­Ÿn::
DB_CREATE
, 2048));

172 
šdex_fes_to_d©aba£
(
db
, 
fes
);

173  
	gdb
;

176 
	g¡d
::
¡ršg


177 
Back’dMªag”
::
	$g‘wr™edb_ch”t_·th
(cÚ¡ 
¡ršg
 & 
Çme
)

179 
¡ršg
 
·»Á_dœ
 = ".chert";

180 
	`ü—‹_dœ_if_Ãeded
(
·»Á_dœ
);

182 
¡ršg
 
dbdœ
 = 
·»Á_dœ
;

183 
dbdœ
 += '/';

184 
dbdœ
 +ğ
Çme
;

185  
dbdœ
;

186 
	}
}

190 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


191 
¡ršg


192 
	gBack’dMªag”
::
ü—‹db_æšt
(cÚ¡ 
veùÜ
<
¡ršg
> &
fes
)

194 
¡ršg
 
·»Á_dœ
 = ".flint";

195 
ü—‹_dœ_if_Ãeded
(
·»Á_dœ
);

197 
¡ršg
 
	gdbdœ
 = 
·»Á_dœ
 + "/db";

198 
	gveùÜ
<
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
 = 
fes
.
begš
();

199 
	gi
 !ğ
fes
.
’d
(); i++) {

200 
	gdbdœ
 += '=';

201 
	gdbdœ
 +ğ*
i
;

204 ià(
ü—‹_dœ_if_Ãeded
(
dbdœ
)) {

206 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
(
X­Ÿn
::
Flšt
::
İ’
(
dbdœ
, X­Ÿn::
DB_CREATE
, 2048));

207 
šdex_fes_to_d©aba£
(
db
, 
fes
);

209  
	gdbdœ
;

212 
	gX­Ÿn
::
Wr™abËD©aba£


213 
Back’dMªag”
::
g‘wr™edb_æšt
(cÚ¡ 
¡ršg
 & 
Çme
,

214 cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

216 
¡ršg
 
	gdbdœ
 = 
g‘wr™edb_æšt_·th
(
Çme
);

219 
rm_rf
(
dbdœ
);

220 ()
ü—‹_dœ_if_Ãeded
(
dbdœ
);

223 
	gX­Ÿn
::
Wr™abËD©aba£
 
db
(
X­Ÿn
::
Flšt
::
İ’
(
dbdœ
, X­Ÿn::
DB_CREATE
, 2048));

224 
šdex_fes_to_d©aba£
(
db
, 
fes
);

225  
	gdb
;

228 
	g¡d
::
¡ršg


229 
Back’dMªag”
::
	$g‘wr™edb_æšt_·th
(cÚ¡ 
¡ršg
 & 
Çme
)

231 
¡ršg
 
·»Á_dœ
 = ".flint";

232 
	`ü—‹_dœ_if_Ãeded
(
·»Á_dœ
);

234 
¡ršg
 
dbdœ
 = 
·»Á_dœ
;

235 
dbdœ
 += '/';

236 
dbdœ
 +ğ
Çme
;

237  
dbdœ
;

238 
	}
}

242 
	gBack’dMªag”
::~
	$Back’dMªag”
(è{ 
	}
}

244 
¡d
::
¡ršg


245 
Back’dMªag”
::
	$g‘_dbty³
() const

248 
	}
}

250 
¡ršg


251 
	gBack’dMªag”
::
do_g‘_d©aba£_·th
(cÚ¡ 
veùÜ
<
¡ršg
> &)

253 
throw
 
X­Ÿn
::
Inv®idArgum’tE¼Ü
("Path isn't meaningful forhis databaseype");

256 
	gX­Ÿn
::
D©aba£


257 
Back’dMªag”
::
do_g‘_d©aba£
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

259  
X­Ÿn
::
D©aba£
(
do_g‘_d©aba£_·th
(
fes
));

262 
	gX­Ÿn
::
D©aba£


263 
Back’dMªag”
::
g‘_d©aba£
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

265  
do_g‘_d©aba£
(
fes
);

268 
	gX­Ÿn
::
D©aba£


269 
Back’dMªag”
::
	$g‘_d©aba£
(cÚ¡ 
¡ršg
 & 
fe
)

271  
	`do_g‘_d©aba£
(
veùÜ
<
¡ršg
>(1, 
fe
));

272 
	}
}

274 
	gX­Ÿn
::
D©aba£


275 
Back’dMªag”
::
g‘_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
dbÇme
,

276 (*
g’
)(
X­Ÿn
::
Wr™abËD©aba£
&,

277 cÚ¡ 
¡d
::
¡ršg
 &),

278 cÚ¡ 
¡d
::
¡ršg
 &
¬g
)

280 
¡ršg
 
dbËaf
 = "db__";

281 
dbËaf
 +ğ
dbÇme
;

282 cÚ¡ 
¡ršg
 & 
·th
 = 
	`g‘_wr™abË_d©aba£_·th
(
dbËaf
);

283 
Œy
 {

284  
X­Ÿn
::
	`D©aba£
(
·th
);

285 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
D©aba£O³nšgE¼Ü
 &) {

287 
	`rm_rf
(
·th
);

289 
¡ršg
 
	`tmp_dbËaf
(
dbËaf
);

290 
tmp_dbËaf
 += '~';

291 
¡ršg
 
	`tmp_·th
(
·th
);

292 
tmp_·th
 += '~';

295 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 = 
	`g‘_wr™abË_d©aba£
(
tmp_dbËaf
,

296 
	`¡ršg
());

297 
	`g’
(
wdb
, 
¬g
);

299 
	`»Çme
(
tmp_·th
.
	`c_¡r
(), 
·th
.c_str());

301  
X­Ÿn
::
	`D©aba£
(
·th
);

302 
	}
}

304 
	g¡d
::
¡ršg


305 
Back’dMªag”
::
g‘_d©aba£_·th
(cÚ¡ 
¡d
::
¡ršg
 &
dbÇme
,

306 (*
g’
)(
X­Ÿn
::
Wr™abËD©aba£
&,

307 cÚ¡ 
¡d
::
¡ršg
 &),

308 cÚ¡ 
¡d
::
¡ršg
 &
¬g
)

310 
¡ršg
 
dbËaf
 = "db__";

311 
dbËaf
 +ğ
dbÇme
;

312 cÚ¡ 
¡ršg
 & 
·th
 = 
	`g‘_wr™abË_d©aba£_·th
(
dbËaf
);

313 
Œy
 {

314 ()
X­Ÿn
::
	`D©aba£
(
·th
);

315  
·th
;

316 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
D©aba£O³nšgE¼Ü
 &) {

318 
	`rm_rf
(
·th
);

320 
¡ršg
 
	`tmp_dbËaf
(
dbËaf
);

321 
tmp_dbËaf
 += '~';

322 
¡ršg
 
	`tmp_·th
(
·th
);

323 
tmp_·th
 += '~';

326 
X­Ÿn
::
Wr™abËD©aba£
 
wdb
 = 
	`g‘_wr™abË_d©aba£
(
tmp_dbËaf
,

327 
	`¡ršg
());

328 
	`g’
(
wdb
, 
¬g
);

330 
	`»Çme
(
tmp_·th
.
	`c_¡r
(), 
·th
.c_str());

332  
·th
;

333 
	}
}

335 
¡ršg


336 
	gBack’dMªag”
::
g‘_d©aba£_·th
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

338  
do_g‘_d©aba£_·th
(
fes
);

341 
¡ršg


342 
	gBack’dMªag”
::
	$g‘_d©aba£_·th
(cÚ¡ 
¡ršg
 & 
fe
)

344  
	`do_g‘_d©aba£_·th
(
veùÜ
<
¡ršg
>(1, 
fe
));

345 
	}
}

347 
	gX­Ÿn
::
Wr™abËD©aba£


348 
Back’dMªag”
::
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 &, const string &)

350 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("Attemptedo open‡ disabled database");

351 
	}
}

353 
¡ršg


354 
	gBack’dMªag”
::
g‘_wr™abË_d©aba£_·th
(cÚ¡ 
¡d
::
¡ršg
 &)

356 
throw
 
X­Ÿn
::
Inv®idArgum’tE¼Ü
("Path isn't meaningful forhis databaseype");

359 
	gX­Ÿn
::
D©aba£


360 
Back’dMªag”
::
g‘_»mÙe_d©aba£
(cÚ¡ 
veùÜ
<
¡ršg
> &, )

362 
¡ršg
 
	gmsg
 = "BackendManager::get_remote_database() called for‚on-remote database (type is ";

363 
	gmsg
 +ğ
g‘_dbty³
();

364 
	gmsg
 += ')';

365 
throw
 
	gX­Ÿn
::
Inv®idO³¿tiÚE¼Ü
(
msg
);

368 
	gX­Ÿn
::
D©aba£


369 
Back’dMªag”
::
	$g‘_wr™abË_d©aba£_as_d©aba£
()

371 
¡ršg
 
msg
 = "Backend ";

372 
msg
 +ğ
	`g‘_dbty³
();

373 
msg
 += " doesn't support get_writable_database_as_database()";

374 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
(
msg
);

375 
	}
}

377 
	gX­Ÿn
::
Wr™abËD©aba£


378 
Back’dMªag”
::
	$g‘_wr™abË_d©aba£_agaš
()

380 
¡ršg
 
msg
 = "Backend ";

381 
msg
 +ğ
	`g‘_dbty³
();

382 
msg
 += " doesn't support get_writable_database_again()";

383 
throw
 
X­Ÿn
::
	`Inv®idO³¿tiÚE¼Ü
(
msg
);

384 
	}
}

387 
	gBack’dMªag”
::
	$ş—n_up
()

389 
	}
}

392 
Back’dMªag”
::
	$g‘_x­Ÿn_´og¤v_commªd
()

394 #ifdeà
HAVE_VALGRIND


395 ià(
RUNNING_ON_VALGRIND
) {

396  "./run¤v "
XAPIAN_PROGSRV
;

399  
XAPIAN_PROGSRV
;

400 
	}
}

	@tests/harness/backendmanager.h

22 #iâdeà
OM_HGUARD_BACKENDMANAGER_H


23 
	#OM_HGUARD_BACKENDMANAGER_H


	)

25 
	~<x­Ÿn.h
>

26 
	~<veùÜ
>

29 #ifdeà
__WIN32__


32 #ifdeà
_MSC_VER


33 #ifdeà
DEBUG


34 
	#XAPIAN_BIN_PATH
 "..\\wš32\\Debug\\"

	)

36 
	#XAPIAN_BIN_PATH
 "..\\wš32\\R–—£\\"

	)

39 
	#XAPIAN_BIN_PATH
 "..\\bin\\"

41 #–£

	)

42 
	#XAPIAN_BIN_PATH
 "../bš/"

	)

44 
	#XAPIAN_TCPSRV
 
XAPIAN_BIN_PATH
"x­Ÿn-tı¤v"

	)

45 
	#XAPIAN_PROGSRV
 
XAPIAN_BIN_PATH
"x­Ÿn-´og¤v"

	)

47 #ifdeà
__SUNPRO_CC


48 
şass
 
	gX­Ÿn
::
Wr™abËD©aba£
;

51 şas 
	cBack’dMªag”
 {

53 
	m¡d
::
¡ršg
 
d©adœ
;

56 
šdex_fes_to_d©aba£
(
X­Ÿn
::
Wr™abËD©aba£
 & 
d©aba£
,

57 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
);

59 
	m´Ùeùed
:

60 
boŞ
 
ü—‹_dœ_if_Ãeded
(cÚ¡ 
¡d
::
¡ršg
 &
dœÇme
);

68 
vœtu®
 
	mX­Ÿn
::
D©aba£
 
do_g‘_d©aba£
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

76 
vœtu®
 
	m¡d
::
¡ršg
 
do_g‘_d©aba£_·th
(cÚ¡ 
¡d
::
veùÜ
<¡d::¡ršg> &
fes
);

78 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


80 
	mX­Ÿn
::
Wr™abËD©aba£
 
g‘wr™edb_šmemÜy
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

83 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


85 
	mX­Ÿn
::
D©aba£
 
g‘db_»mÙ•rog
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

88 
	mX­Ÿn
::
Wr™abËD©aba£
 
g‘wr™edb_»mÙ•rog
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

91 
	mX­Ÿn
::
D©aba£
 
g‘db_»mÙ‘ı
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

94 
	mX­Ÿn
::
Wr™abËD©aba£
 
g‘wr™edb_»mÙ‘ı
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

97 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


98 
	m´Ùeùed
:

99 
¡d
::
¡ršg
 
ü—‹db_b¿ss
(cÚ¡ std::
veùÜ
<¡d::¡ršg> &
fes
);

101 
	mpublic
:

103 
X­Ÿn
::
Wr™abËD©aba£
 
g‘wr™edb_b¿ss
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

104 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

107 
	m¡d
::
¡ršg
 
g‘wr™edb_b¿ss_·th
(cÚ¡ 
¡d
::¡ršg & 
Çme
);

110 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


111 
	m´Ùeùed
:

112 
¡d
::
¡ršg
 
ü—‹db_ch”t
(cÚ¡ std::
veùÜ
<¡d::¡ršg> &
fes
);

114 
	mpublic
:

116 
X­Ÿn
::
Wr™abËD©aba£
 
g‘wr™edb_ch”t
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

117 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

120 
	m¡d
::
¡ršg
 
g‘wr™edb_ch”t_·th
(cÚ¡ 
¡d
::¡ršg & 
Çme
);

123 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


124 
	m´Ùeùed
:

125 
¡d
::
¡ršg
 
ü—‹db_æšt
(cÚ¡ std::
veùÜ
<¡d::¡ršg> &
fes
);

127 
	mpublic
:

129 
X­Ÿn
::
Wr™abËD©aba£
 
g‘wr™edb_æšt
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

130 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

133 
	m¡d
::
¡ršg
 
g‘wr™edb_æšt_·th
(cÚ¡ 
¡d
::¡ršg & 
Çme
);

136 
	mpublic
:

138 
	$Back’dMªag”
() { }

143 
vœtu®
 ~
	`Back’dMªag”
();

147 
vœtu®
 
¡d
::
¡ršg
 
	$g‘_dbty³
() const;

151 
	`£t_d©adœ
(cÚ¡ 
¡d
::
¡ršg
 &
d©adœ_
è{ 
d©adœ
 = d©adœ_; 
	}
}

155 cÚ¡ 
	g¡d
::
¡ršg
 & 
	$g‘_d©adœ
(ècÚ¡ {  
d©adœ
; 
	}
}

158 
	gX­Ÿn
::
D©aba£
 
g‘_d©aba£
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> &
fes
);

161 
	gX­Ÿn
::
D©aba£
 
g‘_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
fe
);

172 
	gX­Ÿn
::
D©aba£
 
g‘_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 &
dbÇme
,

173 (*
g’
)(
X­Ÿn
::
Wr™abËD©aba£
&,

174 cÚ¡ 
¡d
::
¡ršg
 &),

175 cÚ¡ 
¡d
::
¡ršg
 &
¬g
);

178 
¡d
::
¡ršg
 
	`g‘_d©aba£_·th
(cÚ¡ std::
veùÜ
<¡d::¡ršg> &
fes
);

181 
¡d
::
¡ršg
 
	`g‘_d©aba£_·th
(cÚ¡ std::¡ršg &
fe
);

184 
¡d
::
¡ršg
 
	`g‘_d©aba£_·th
(cÚ¡ std::¡ršg &
dbÇme
,

185 (*
g’
)(
X­Ÿn
::
Wr™abËD©aba£
&,

186 cÚ¡ 
¡d
::
¡ršg
 &),

187 cÚ¡ 
¡d
::
¡ršg
 &
¬g
);

190 
vœtu®
 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
, cÚ¡ std::¡ršg & 
fe
);

193 
vœtu®
 
¡d
::
¡ršg
 
	`g‘_wr™abË_d©aba£_·th
(cÚ¡ std::¡ršg & 
Çme
);

196 
vœtu®
 
X­Ÿn
::
D©aba£
 
	`g‘_»mÙe_d©aba£
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
, 
timeout
);

199 
vœtu®
 
X­Ÿn
::
D©aba£
 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

202 
vœtu®
 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£_agaš
();

205 
vœtu®
 
	`ş—n_up
();

208 cÚ¡ * 
	`g‘_x­Ÿn_´og¤v_commªd
();

209 
	}
};

	@tests/harness/backendmanager_brass.cc

21 
	~<cÚfig.h
>

23 
	~"back’dmªag”_b¿ss.h
"

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 
	g¡d
::
¡ršg


28 
Back’dMªag”B¿ss
::
	$g‘_dbty³
() const

31 
	}
}

33 
¡ršg


34 
	gBack’dMªag”B¿ss
::
do_g‘_d©aba£_·th
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

36  
ü—‹db_b¿ss
(
fes
);

39 
	gX­Ÿn
::
Wr™abËD©aba£


40 
Back’dMªag”B¿ss
::
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 & 
Çme
,

41 cÚ¡ 
¡ršg
 & 
fe
)

43 
Ï¡_wdb_Çme
 = 
Çme
;

44  
	`g‘wr™edb_b¿ss
(
Çme
, 
veùÜ
<
¡ršg
>(1, 
fe
));

45 
	}
}

47 
¡ršg


48 
	gBack’dMªag”B¿ss
::
	$g‘_wr™abË_d©aba£_·th
(cÚ¡ 
¡ršg
 & 
Çme
)

50  
	`g‘wr™edb_b¿ss_·th
(
Çme
);

51 
	}
}

53 
	gX­Ÿn
::
D©aba£


54 
Back’dMªag”B¿ss
::
	$g‘_wr™abË_d©aba£_as_d©aba£
()

56  
X­Ÿn
::
B¿ss
::
	`İ’
(".b¿ss/" + 
Ï¡_wdb_Çme
);

57 
	}
}

59 
	gX­Ÿn
::
Wr™abËD©aba£


60 
Back’dMªag”B¿ss
::
	$g‘_wr™abË_d©aba£_agaš
()

62  
X­Ÿn
::
B¿ss
::
	`İ’
(".b¿ss/" + 
Ï¡_wdb_Çme
, X­Ÿn::
DB_OPEN
);

63 
	}
}

	@tests/harness/backendmanager_brass.h

21 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_BRASS_H


22 
	#XAPIAN_INCLUDED_BACKENDMANAGER_BRASS_H


	)

24 
	~"back’dmªag”.h
"

26 
	~<¡ršg
>

28 
	~<x­Ÿn/ba£.h
>

29 
	~<x­Ÿn/ty³s.h
>

30 
	~<x­Ÿn/po¡šg™”©Ü.h
>

32 
	~"pos™iÚli¡.h
"

35 şas 
	cBack’dMªag”B¿ss
 : 
public
 
Back’dMªag”
 {

37 
İ”©Ü
=(cÚ¡ 
Back’dMªag”B¿ss
 &);

40 
Back’dMªag”B¿ss
(const BackendManagerBrass &);

43 
	m¡d
::
¡ršg
 
Ï¡_wdb_Çme
;

45 
	m´iv©e
:

47 
¡d
::
¡ršg
 
do_g‘_d©aba£_·th
(cÚ¡ std::
veùÜ
<¡d::¡ršg> & 
fes
);

49 
	mpublic
:

50 
	$Back’dMªag”B¿ss
() { }

53 
¡d
::
¡ršg
 
	$g‘_dbty³
() const;

56 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

57 cÚ¡ 
¡d
::
¡ršg
 & 
fe
);

60 
¡d
::
¡ršg
 
	`g‘_wr™abË_d©aba£_·th
(cÚ¡ std::¡ršg & 
Çme
);

63 
X­Ÿn
::
D©aba£
 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

66 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£_agaš
();

67 
	}
};

	@tests/harness/backendmanager_chert.cc

21 
	~<cÚfig.h
>

23 
	~"back’dmªag”_ch”t.h
"

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 
	g¡d
::
¡ršg


28 
Back’dMªag”Ch”t
::
	$g‘_dbty³
() const

31 
	}
}

33 
¡ršg


34 
	gBack’dMªag”Ch”t
::
do_g‘_d©aba£_·th
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

36  
ü—‹db_ch”t
(
fes
);

39 
	gX­Ÿn
::
Wr™abËD©aba£


40 
Back’dMªag”Ch”t
::
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 & 
Çme
,

41 cÚ¡ 
¡ršg
 & 
fe
)

43 
Ï¡_wdb_Çme
 = 
Çme
;

44  
	`g‘wr™edb_ch”t
(
Çme
, 
veùÜ
<
¡ršg
>(1, 
fe
));

45 
	}
}

47 
¡ršg


48 
	gBack’dMªag”Ch”t
::
	$g‘_wr™abË_d©aba£_·th
(cÚ¡ 
¡ršg
 & 
Çme
)

50  
	`g‘wr™edb_ch”t_·th
(
Çme
);

51 
	}
}

53 
	gX­Ÿn
::
D©aba£


54 
Back’dMªag”Ch”t
::
	$g‘_wr™abË_d©aba£_as_d©aba£
()

56  
X­Ÿn
::
Ch”t
::
	`İ’
(".ch”t/" + 
Ï¡_wdb_Çme
);

57 
	}
}

59 
	gX­Ÿn
::
Wr™abËD©aba£


60 
Back’dMªag”Ch”t
::
	$g‘_wr™abË_d©aba£_agaš
()

62  
X­Ÿn
::
Ch”t
::
	`İ’
(".ch”t/" + 
Ï¡_wdb_Çme
, X­Ÿn::
DB_OPEN
);

63 
	}
}

	@tests/harness/backendmanager_chert.h

21 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_CHERT_H


22 
	#XAPIAN_INCLUDED_BACKENDMANAGER_CHERT_H


	)

24 
	~"back’dmªag”.h
"

26 
	~<¡ršg
>

28 
	~<x­Ÿn/ba£.h
>

29 
	~<x­Ÿn/ty³s.h
>

30 
	~<x­Ÿn/po¡šg™”©Ü.h
>

32 
	~"pos™iÚli¡.h
"

35 şas 
	cBack’dMªag”Ch”t
 : 
public
 
Back’dMªag”
 {

37 
İ”©Ü
=(cÚ¡ 
Back’dMªag”Ch”t
 &);

40 
Back’dMªag”Ch”t
(const BackendManagerChert &);

43 
	m¡d
::
¡ršg
 
Ï¡_wdb_Çme
;

45 
	m´iv©e
:

47 
¡d
::
¡ršg
 
do_g‘_d©aba£_·th
(cÚ¡ std::
veùÜ
<¡d::¡ršg> & 
fes
);

49 
	mpublic
:

50 
	$Back’dMªag”Ch”t
() { }

53 
¡d
::
¡ršg
 
	$g‘_dbty³
() const;

56 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

57 cÚ¡ 
¡d
::
¡ršg
 & 
fe
);

60 
¡d
::
¡ršg
 
	`g‘_wr™abË_d©aba£_·th
(cÚ¡ std::¡ršg & 
Çme
);

63 
X­Ÿn
::
D©aba£
 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

66 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£_agaš
();

67 
	}
};

	@tests/harness/backendmanager_flint.cc

21 
	~<cÚfig.h
>

23 
	~"back’dmªag”_æšt.h
"

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 
	g¡d
::
¡ršg


28 
Back’dMªag”Flšt
::
	$g‘_dbty³
() const

31 
	}
}

33 
¡ršg


34 
	gBack’dMªag”Flšt
::
do_g‘_d©aba£_·th
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

36  
ü—‹db_æšt
(
fes
);

39 
	gX­Ÿn
::
Wr™abËD©aba£


40 
Back’dMªag”Flšt
::
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 & 
Çme
,

41 cÚ¡ 
¡ršg
 & 
fe
)

43 
Ï¡_wdb_Çme
 = 
Çme
;

44  
	`g‘wr™edb_æšt
(
Çme
, 
veùÜ
<
¡ršg
>(1, 
fe
));

45 
	}
}

47 
¡ršg


48 
	gBack’dMªag”Flšt
::
	$g‘_wr™abË_d©aba£_·th
(cÚ¡ 
¡ršg
 & 
Çme
)

50  
	`g‘wr™edb_æšt_·th
(
Çme
);

51 
	}
}

53 
	gX­Ÿn
::
D©aba£


54 
Back’dMªag”Flšt
::
	$g‘_wr™abË_d©aba£_as_d©aba£
()

56  
X­Ÿn
::
Flšt
::
	`İ’
(".æšt/" + 
Ï¡_wdb_Çme
);

57 
	}
}

59 
	gX­Ÿn
::
Wr™abËD©aba£


60 
Back’dMªag”Flšt
::
	$g‘_wr™abË_d©aba£_agaš
()

62  
X­Ÿn
::
Flšt
::
	`İ’
(".æšt/" + 
Ï¡_wdb_Çme
, X­Ÿn::
DB_OPEN
);

63 
	}
}

	@tests/harness/backendmanager_flint.h

21 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_FLINT_H


22 
	#XAPIAN_INCLUDED_BACKENDMANAGER_FLINT_H


	)

24 
	~"back’dmªag”.h
"

26 
	~<¡ršg
>

28 
	~<x­Ÿn/ba£.h
>

29 
	~<x­Ÿn/ty³s.h
>

30 
	~<x­Ÿn/po¡šg™”©Ü.h
>

32 
	~"pos™iÚli¡.h
"

35 şas 
	cBack’dMªag”Flšt
 : 
public
 
Back’dMªag”
 {

37 
İ”©Ü
=(cÚ¡ 
Back’dMªag”Flšt
 &);

40 
Back’dMªag”Flšt
(const BackendManagerFlint &);

43 
	m¡d
::
¡ršg
 
Ï¡_wdb_Çme
;

45 
	m´Ùeùed
:

47 
¡d
::
¡ršg
 
do_g‘_d©aba£_·th
(cÚ¡ std::
veùÜ
<¡d::¡ršg> & 
fes
);

49 
	mpublic
:

50 
	$Back’dMªag”Flšt
() { }

53 
¡d
::
¡ršg
 
	$g‘_dbty³
() const;

56 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

57 cÚ¡ 
¡d
::
¡ršg
 & 
fe
);

60 
¡d
::
¡ršg
 
	`g‘_wr™abË_d©aba£_·th
(cÚ¡ std::¡ršg & 
Çme
);

63 
X­Ÿn
::
D©aba£
 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

66 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£_agaš
();

67 
	}
};

	@tests/harness/backendmanager_inmemory.cc

21 
	~<cÚfig.h
>

23 
	~"back’dmªag”_šmemÜy.h
"

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 
	g¡d
::
¡ršg


28 
Back’dMªag”InMemÜy
::
	$g‘_dbty³
() const

31 
	}
}

33 
	gX­Ÿn
::
D©aba£


34 
Back’dMªag”InMemÜy
::
do_g‘_d©aba£
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

36  
g‘wr™edb_šmemÜy
(
fes
);

39 
	gX­Ÿn
::
Wr™abËD©aba£


40 
Back’dMªag”InMemÜy
::
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 &,

41 cÚ¡ 
¡ršg
 & 
fe
)

43  
	`g‘wr™edb_šmemÜy
(
veùÜ
<
¡ršg
>(1, 
fe
));

44 
	}
}

	@tests/harness/backendmanager_inmemory.h

21 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_INMEMORY_H


22 
	#XAPIAN_INCLUDED_BACKENDMANAGER_INMEMORY_H


	)

24 
	~"back’dmªag”.h
"

26 
	~<¡ršg
>

28 
	~<x­Ÿn/ba£.h
>

29 
	~<x­Ÿn/ty³s.h
>

30 
	~<x­Ÿn/po¡šg™”©Ü.h
>

32 
	~"pos™iÚli¡.h
"

35 şas 
	cBack’dMªag”InMemÜy
 : 
public
 
Back’dMªag”
 {

37 
İ”©Ü
=(cÚ¡ 
Back’dMªag”InMemÜy
 &);

40 
Back’dMªag”InMemÜy
(const BackendManagerInMemory &);

42 
	m´Ùeùed
:

44 
X­Ÿn
::
D©aba£
 
do_g‘_d©aba£
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
);

46 
	mpublic
:

47 
	$Back’dMªag”InMemÜy
() { }

50 
¡d
::
¡ršg
 
	$g‘_dbty³
() const;

53 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
, cÚ¡ std::¡ršg & 
fe
);

54 
	}
};

	@tests/harness/backendmanager_local.h

21 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_LOCAL_H


22 
	#XAPIAN_INCLUDED_BACKENDMANAGER_LOCAL_H


	)

24 
	~<x­Ÿn.h
>

26 #ià
defšed
 
XAPIAN_HAS_CHERT_BACKEND


27 
	~"back’dmªag”_ch”t.h
"

28 
	#Back’dMªag”Loÿl
 
Back’dMªag”Ch”t


	)

29 #–ià
defšed
 
XAPIAN_HAS_BRASS_BACKEND


30 
	~"back’dmªag”_b¿ss.h
"

31 
	#Back’dMªag”Loÿl
 
Back’dMªag”B¿ss


	)

32 #–ià
defšed
 
XAPIAN_HAS_FLINT_BACKEND


33 
	~"back’dmªag”_æšt.h
"

34 
	#Back’dMªag”Loÿl
 
Back’dMªag”Flšt


	)

36 
	~"back’dmªag”.h
"

37 şas 
	cBack’dMªag”Loÿl
 : 
public
 
Back’dMªag”
 {

38 
	$Back’dMªag”Loÿl
() {

39 
	`SKIP_TEST
("No†ocal database backendƒnabled");

41 
	}
};

	@tests/harness/backendmanager_multi.cc

22 
	~<cÚfig.h
>

24 
	~"back’dmªag”_muÉi.h
"

26 
	~"šdex_uts.h
"

27 
	~"uts.h
"

29 
	~<c¡dio
>

30 
	~<c¡ršg
>

31 
	~"§ã”ºo.h
"

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
	gBack’dMªag”MuÉi
::
Back’dMªag”MuÉi
(cÚ¡ 
¡d
::
¡ršg
 & 
subty³_
)

36 : 
	$subty³
(
subty³_
)

38 ià(!(
çl£


39 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


40 || 
subty³
 == "brass"

42 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


43 || 
subty³
 == "chert"

45 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


46 || 
subty³
 == "flint"

49 
	`throw
 ("UnknowÀback’dy³ \"" + 
subty³
 + "\" specified for multi database subdatabases");

51 
	}
}

53 
	g¡d
::
¡ršg


54 
Back’dMªag”MuÉi
::
	$g‘_dbty³
() const

56  "muÉi_" + 
subty³
;

57 
	}
}

59 
	#NUMBER_OF_SUB_DBS
 2

	)

61 
¡ršg


62 
	gBack’dMªag”MuÉi
::
ü—‹db_muÉi
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

64 
¡ršg
 
dbdœ
 = ".muÉi" + 
subty³
;

65 
ü—‹_dœ_if_Ãeded
(
dbdœ
);

67 
¡ršg
 
	gdbÇme
 = "db";

68 
	gveùÜ
<
	g¡ršg
>::
cÚ¡_™”©Ü
 
i
;

69 
	gi
 = 
fes
.
begš
(); i !ğfes.
’d
(); ++i) {

70 
	gdbÇme
 += "__";

71 
	gdbÇme
 +ğ*
i
;

73 
¡ršg
 
	gdb·th
 = 
dbdœ
 + "/" + 
dbÇme
;

75 ià(
fe_exi¡s
(
db·th
)è 
	gdb·th
;

77 
¡ršg
 
	gtmpfe
 = 
db·th
;

78 
	gtmpfe
 += ".tmp";

79 
of¡»am
 
out
(
tmpfe
.
c_¡r
());

80 ià(!
	gout
.
is_İ’
()) {

81 
¡ršg
 
	gmsg
 = "Couldn't create file '";

82 
	gmsg
 +ğ
tmpfe
;

83 
	gmsg
 += "' (";

84 
	gmsg
 +ğ
¡»¼Ü
(
”ºo
);

85 
	gmsg
 += ')';

86 
throw
 
	gmsg
;

91 
	gX­Ÿn
::
Wr™abËD©aba£
 
dbs
[
NUMBER_OF_SUB_DBS
];

92 
size_t
 
	gn
 = 0;‚ < 
	gNUMBER_OF_SUB_DBS
; ++n) {

93 
¡ršg
 
	gsubdbdœ
 = 
dbÇme
;

94 
	gsubdbdœ
 += "___";

95 
	gsubdbdœ
 +ğ
om_to¡ršg
(
n
);

96 #ià
defšed
 
XAPIAN_HAS_BRASS_BACKEND


97 ià(
	gsubty³
 == "brass") {

98 
dbs
[
n
] = 
X­Ÿn
::
B¿ss
::
İ’
(
dbdœ
 + "/" + 
subdbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

99 
	gout
 << "b¿s " << 
	gsubdbdœ
 << '\n';

102 #ià
defšed
 
XAPIAN_HAS_CHERT_BACKEND


103 ià(
	gsubty³
 == "chert") {

104 
dbs
[
n
] = 
X­Ÿn
::
Ch”t
::
İ’
(
dbdœ
 + "/" + 
subdbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

105 
	gout
 << "ch”ˆ" << 
	gsubdbdœ
 << '\n';

108 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


109 ià(
	gsubty³
 == "flint") {

110 
dbs
[
n
] = 
X­Ÿn
::
Flšt
::
İ’
(
dbdœ
 + "/" + 
subdbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

111 
	gout
 << "æšˆ" << 
	gsubdbdœ
 << '\n';

116 
	gout
.
şo£
();

118 
size_t
 
	gc
 = 0;

119 
FeIndex”
 
f
(
g‘_d©adœ
(), 
fes
);

120 
	gf
) {

121 
	gdbs
[
c
].
add_docum’t
(
f
.
Ãxt
());

122 
	gc
 = (
c
 + 1è% 
NUMBER_OF_SUB_DBS
;

125 
»Çme
(
tmpfe
.
c_¡r
(), 
db·th
.c_str());

127  
	gdb·th
;

130 
¡ršg


131 
	gBack’dMªag”MuÉi
::
do_g‘_d©aba£_·th
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

133  
ü—‹db_muÉi
(
fes
);

136 
	gX­Ÿn
::
Wr™abËD©aba£


137 
Back’dMªag”MuÉi
::
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 &, const string &)

139 
throw
 
X­Ÿn
::
	`Unim¶em’‹dE¼Ü
("Multi-databases don't support writing");

140 
	}
}

	@tests/harness/backendmanager_multi.h

22 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_MULTI_H


23 
	#XAPIAN_INCLUDED_BACKENDMANAGER_MULTI_H


	)

25 
	~"back’dmªag”.h
"

27 
	~<¡ršg
>

29 
	~<x­Ÿn/ba£.h
>

30 
	~<x­Ÿn/ty³s.h
>

31 
	~<x­Ÿn/po¡šg™”©Ü.h
>

33 
	~"pos™iÚli¡.h
"

36 şas 
	cBack’dMªag”MuÉi
 : 
public
 
Back’dMªag”
 {

38 
¡d
::
¡ršg
 
subty³
;

41 
	mİ”©Ü
=(cÚ¡ 
Back’dMªag”MuÉi
 &);

44 
Back’dMªag”MuÉi
(const BackendManagerMulti &);

46 
	m¡d
::
¡ršg
 
ü—‹db_muÉi
(cÚ¡ 
¡d
::
veùÜ
<¡d::¡ršg> & 
fes
);

48 
	m´Ùeùed
:

50 
¡d
::
¡ršg
 
do_g‘_d©aba£_·th
(cÚ¡ std::
veùÜ
<¡d::¡ršg> & 
fes
);

52 
	mpublic
:

53 
Back’dMªag”MuÉi
(cÚ¡ 
¡d
::
¡ršg
 & 
subty³_
);

56 
	m¡d
::
¡ršg
 
	$g‘_dbty³
() const;

59 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
, cÚ¡ std::¡ršg & 
fe
);

	@tests/harness/backendmanager_remote.cc

22 
	~<cÚfig.h
>

23 
	~"back’dmªag”_»mÙe.h
"

24 
	~"uts.h
"

25 
	~<c¡dlib
>

26 
	~<¡ršg
>

28 
	gBack’dMªag”RemÙe
::
Back’dMªag”RemÙe
(cÚ¡ 
¡d
::
¡ršg
 & 
»mÙe_ty³_
)

29 : 
	$»mÙe_ty³
(
»mÙe_ty³_
)

31 ià(!(
çl£


32 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


33 || 
»mÙe_ty³
 == "brass"

35 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


36 || 
»mÙe_ty³
 == "chert"

38 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


39 || 
»mÙe_ty³
 == "flint"

42 
	`throw
 ("UnknowÀback’dy³ \"" + 
»mÙe_ty³
 + "\" specified for„emote database");

44 
	}
}

46 
	g¡d
::
¡ršg


47 
Back’dMªag”RemÙe
::
g‘_wr™abË_d©aba£_¬gs
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

48 cÚ¡ 
¡d
::
¡ršg
 & 
fe
)

50 
Ï¡_wdb_Çme
 = 
Çme
;

54 
	g¡d
::
¡ršg
 
¬gs
 = "-t300000 --writable ";

56 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


57 ià(
	g»mÙe_ty³
 == "brass") {

58 ()
g‘wr™edb_b¿ss
(
Çme
, 
¡d
::
veùÜ
<¡d::
¡ršg
>(1, 
fe
));

59 
	g¬gs
 += ".brass/";

62 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


63 ià(
	g»mÙe_ty³
 == "chert") {

64 ()
g‘wr™edb_ch”t
(
Çme
, 
¡d
::
veùÜ
<¡d::
¡ršg
>(1, 
fe
));

65 
	g¬gs
 += ".chert/";

68 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


69 ià(
	g»mÙe_ty³
 == "flint") {

70 ()
g‘wr™edb_æšt
(
Çme
, 
¡d
::
veùÜ
<¡d::
¡ršg
>(1, 
fe
));

71 
	g¬gs
 += ".flint/";

74 
	g¬gs
 +ğ
Çme
;

76  
	g¬gs
;

79 
	g¡d
::
¡ršg


80 
Back’dMªag”RemÙe
::
g‘_»mÙe_d©aba£_¬gs
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
,

81 
timeout
)

83 
	g¡d
::
¡ršg
 
¬gs
 = "-t";

84 
	g¬gs
 +ğ
om_to¡ršg
(
timeout
);

85 
	g¬gs
 += ' ';

86 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


87 ià(
	g»mÙe_ty³
 == "brass") {

88 
¬gs
 +ğ
ü—‹db_b¿ss
(
fes
);

91 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


92 ià(
	g»mÙe_ty³
 == "chert") {

93 
¬gs
 +ğ
ü—‹db_ch”t
(
fes
);

96 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


97 ià(
	g»mÙe_ty³
 == "flint") {

98 
¬gs
 +ğ
ü—‹db_æšt
(
fes
);

102  
	g¬gs
;

105 
	g¡d
::
¡ršg


106 
Back’dMªag”RemÙe
::
	$g‘_wr™abË_d©aba£_as_d©aba£_¬gs
()

108 
¡d
::
¡ršg
 
¬gs
 = "-t300000 ";

109 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


110 ià(
»mÙe_ty³
 == "brass") {

111 
¬gs
 += ".brass/";

114 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


115 ià(
»mÙe_ty³
 == "chert") {

116 
¬gs
 += ".chert/";

119 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


120 ià(
»mÙe_ty³
 == "flint") {

121 
¬gs
 += ".flint/";

124 
¬gs
 +ğ
Ï¡_wdb_Çme
;

126  
¬gs
;

127 
	}
}

129 
	g¡d
::
¡ršg


130 
Back’dMªag”RemÙe
::
	$g‘_wr™abË_d©aba£_agaš_¬gs
()

132 
¡d
::
¡ršg
 
¬gs
 = "-t300000 --writable ";

133 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


134 ià(
»mÙe_ty³
 == "brass") {

135 
¬gs
 += ".brass/";

138 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


139 ià(
»mÙe_ty³
 == "chert") {

140 
¬gs
 += ".chert/";

143 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


144 ià(
»mÙe_ty³
 == "flint") {

145 
¬gs
 += ".flint/";

148 
¬gs
 +ğ
Ï¡_wdb_Çme
;

150  
¬gs
;

151 
	}
}

	@tests/harness/backendmanager_remote.h

21 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_REMOTE_H


22 
	#XAPIAN_INCLUDED_BACKENDMANAGER_REMOTE_H


	)

24 
	~"back’dmªag”.h
"

26 
	~<¡ršg
>

27 
	~<veùÜ
>

30 şas 
	cBack’dMªag”RemÙe
 : 
public
 
Back’dMªag”
 {

32 
İ”©Ü
=(cÚ¡ 
Back’dMªag”RemÙe
 &);

35 
Back’dMªag”RemÙe
(const BackendManagerRemote &);

38 
	m¡d
::
¡ršg
 
Ï¡_wdb_Çme
;

40 
	m´Ùeùed
:

42 
¡d
::
¡ršg
 
»mÙe_ty³
;

44 
	mpublic
:

45 
Back’dMªag”RemÙe
(cÚ¡ 
¡d
::
¡ršg
 & 
»mÙe_ty³_
);

48 
	m¡d
::
¡ršg
 
g‘_wr™abË_d©aba£_¬gs
(cÚ¡ 
¡d
::¡ršg & 
Çme
,

49 cÚ¡ 
¡d
::
¡ršg
 & 
fe
);

52 
	m¡d
::
¡ršg
 
g‘_»mÙe_d©aba£_¬gs
(cÚ¡ 
¡d
::
veùÜ
<¡d::¡ršg> & 
fes
,

53 
timeout
);

56 
	m¡d
::
¡ršg
 
g‘_wr™abË_d©aba£_as_d©aba£_¬gs
();

59 
	m¡d
::
¡ršg
 
g‘_wr™abË_d©aba£_agaš_¬gs
();

	@tests/harness/backendmanager_remoteprog.cc

22 
	~<cÚfig.h
>

24 
	~"back’dmªag”_»mÙ•rog.h
"

26 
	~<x­Ÿn.h
>

28 
	~"uts.h
"

30 #ifdeà
HAVE_VALGRIND


31 
	~<v®gršd/memcheck.h
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	g¡d
::
¡ršg


37 
Back’dMªag”RemÙeProg
::
	$g‘_dbty³
() const

39  "»mÙ•rog_" + 
»mÙe_ty³
;

40 
	}
}

42 
	gX­Ÿn
::
D©aba£


43 
Back’dMªag”RemÙeProg
::
do_g‘_d©aba£
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

47  
Back’dMªag”RemÙeProg
::
g‘_»mÙe_d©aba£
(
fes
, 300000);

50 
	gX­Ÿn
::
Wr™abËD©aba£


51 
Back’dMªag”RemÙeProg
::
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 & 
Çme
,

52 cÚ¡ 
¡ršg
 & 
fe
)

54 
¡ršg
 
¬gs
 = 
	`g‘_wr™abË_d©aba£_¬gs
(
Çme
, 
fe
);

56 #ifdeà
HAVE_VALGRIND


57 ià(
RUNNING_ON_VALGRIND
) {

58 
¬gs
.
	`š£¹
(0, 
XAPIAN_PROGSRV
" ");

59  
X­Ÿn
::
RemÙe
::
	`İ’_wr™abË
("./run¤v", 
¬gs
);

62  
X­Ÿn
::
RemÙe
::
	`İ’_wr™abË
(
XAPIAN_PROGSRV
, 
¬gs
);

63 
	}
}

65 
	gX­Ÿn
::
D©aba£


66 
Back’dMªag”RemÙeProg
::
g‘_»mÙe_d©aba£
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
,

67 
timeout
)

69 
¡ršg
 
	g¬gs
 = 
g‘_»mÙe_d©aba£_¬gs
(
fes
, 
timeout
);

71 #ifdeà
HAVE_VALGRIND


72 ià(
	gRUNNING_ON_VALGRIND
) {

73 
	g¬gs
.
š£¹
(0, 
XAPIAN_PROGSRV
" ");

74  
	gX­Ÿn
::
RemÙe
::
İ’
("./run¤v", 
¬gs
);

77  
	gX­Ÿn
::
RemÙe
::
İ’
(
XAPIAN_PROGSRV
, 
¬gs
);

80 
	gX­Ÿn
::
D©aba£


81 
Back’dMªag”RemÙeProg
::
	$g‘_wr™abË_d©aba£_as_d©aba£
()

83 
¡ršg
 
¬gs
 = 
	`g‘_wr™abË_d©aba£_as_d©aba£_¬gs
();

85 #ifdeà
HAVE_VALGRIND


86 ià(
RUNNING_ON_VALGRIND
) {

87 
¬gs
.
	`š£¹
(0, 
XAPIAN_PROGSRV
" ");

88  
X­Ÿn
::
RemÙe
::
	`İ’
("./run¤v", 
¬gs
);

91  
X­Ÿn
::
RemÙe
::
	`İ’
(
XAPIAN_PROGSRV
, 
¬gs
);

92 
	}
}

94 
	gX­Ÿn
::
Wr™abËD©aba£


95 
Back’dMªag”RemÙeProg
::
	$g‘_wr™abË_d©aba£_agaš
()

97 
¡ršg
 
¬gs
 = 
	`g‘_wr™abË_d©aba£_agaš_¬gs
();

99 #ifdeà
HAVE_VALGRIND


100 ià(
RUNNING_ON_VALGRIND
) {

101 
¬gs
.
	`š£¹
(0, 
XAPIAN_PROGSRV
" ");

102  
X­Ÿn
::
RemÙe
::
	`İ’_wr™abË
("./run¤v", 
¬gs
);

105  
X­Ÿn
::
RemÙe
::
	`İ’_wr™abË
(
XAPIAN_PROGSRV
, 
¬gs
);

106 
	}
}

	@tests/harness/backendmanager_remoteprog.h

22 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_REMOTEPROG_H


23 
	#XAPIAN_INCLUDED_BACKENDMANAGER_REMOTEPROG_H


	)

25 
	~"back’dmªag”.h
"

26 
	~"back’dmªag”_»mÙe.h
"

28 
	~<¡ršg
>

30 
	~<x­Ÿn/ba£.h
>

31 
	~<x­Ÿn/ty³s.h
>

32 
	~<x­Ÿn/po¡šg™”©Ü.h
>

34 
	~"pos™iÚli¡.h
"

37 şas 
	cBack’dMªag”RemÙeProg
 : 
public
 
Back’dMªag”RemÙe
 {

39 
İ”©Ü
=(cÚ¡ 
Back’dMªag”RemÙeProg
 &);

42 
Back’dMªag”RemÙeProg
(const BackendManagerRemoteProg &);

45 
	m¡d
::
¡ršg
 
Ï¡_wdb_Çme
;

47 
	m´iv©e
:

49 
X­Ÿn
::
D©aba£
 
do_g‘_d©aba£
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
);

51 
	mpublic
:

52 
Back’dMªag”RemÙeProg
(cÚ¡ 
¡d
::
¡ršg
 & 
»mÙe_ty³_
)

53 : 
	$Back’dMªag”RemÙe
(
»mÙe_ty³_
) { }

56 
¡d
::
¡ršg
 
	$g‘_dbty³
() const;

59 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

60 cÚ¡ 
¡d
::
¡ršg
 & 
fe
);

63 
X­Ÿn
::
D©aba£
 
	`g‘_»mÙe_d©aba£
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
,

64 
timeout
);

67 
X­Ÿn
::
D©aba£
 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

70 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£_agaš
();

71 
	}
};

	@tests/harness/backendmanager_remotetcp.cc

22 
	~<cÚfig.h
>

24 
	~"back’dmªag”_»mÙ‘ı.h
"

26 
	~<x­Ÿn.h
>

28 
	~"§ã”ºo.h
"

29 
	~<c¡dio
>

30 
	~<c¡ršg
>

32 #ifdeà
HAVE_FORK


33 
	~<sigÇl.h
>

34 
	~<sys/ty³s.h
>

35 
	~<sys/sock‘.h
>

36 
	~<sys/wa™.h
>

37 
	~<uni¡d.h
>

39 #ià!
defšed
 
SIGCHLD
 && defšed 
SIGCLD


40 
	#SIGCHLD
 
SIGCLD


	)

44 #ifdeà
__WIN32__


45 
	~"§ãfú.h
"

46 
	~"§ãwšdows.h
"

49 
	~"nÜ‘uº.h
"

50 
	~"uts.h
"

52 
	~<¡ršg
>

53 
	~<veùÜ
>

55 #ifdeà
HAVE_VALGRIND


56 
	~<v®gršd/memcheck.h
>

59 
usšg
 
Çme¥aû
 
	g¡d
;

64 
	#LOCALHOST
 "127.0.0.1"

	)

67 
	#DEFAULT_PORT
 1239

	)

69 #ifdeà
HAVE_FORK


74 
	spid_fd
 {

75 
pid_t
 
	mpid
;

76 
	mfd
;

79 
pid_fd
 
	gpid_to_fd
[16];

84 
Ú_SIGCHLD
()

86 
¡©us
;

87 
pid_t
 
chd
;

88 (
chd
 = 
wa™pid
(-1, &
¡©us
, 
WNOHANG
)) > 0) {

89 
i
 = 0; i < (
pid_to_fd
è/ (
pid_fd
); ++i) {

90 ià(
pid_to_fd
[
i
].
pid
 =ğ
chd
) {

91 
fd
 = 
pid_to_fd
[
i
].fd;

92 
pid_to_fd
[
i
].
fd
 = 0;

93 
pid_to_fd
[
i
].
pid
 = 0;

95 
şo£
(
fd
);

105 
	$Ïunch_x­Ÿn_tı¤v
(cÚ¡ 
¡ršg
 & 
¬gs
)

107 
pÜt
 = 
DEFAULT_PORT
;

111 
	`sigÇl
(
SIGCHLD
, 
SIG_DFL
);

112 
Œy_Ãxt_pÜt
:

113 
¡ršg
 
cmd
 = 
XAPIAN_TCPSRV
" --Úe-shÙ --š‹rçû "
LOCALHOST
" --pÜˆ" + 
	`om_to¡ršg
(
pÜt
è+ " " + 
¬gs
;

114 #ifdeà
HAVE_VALGRIND


115 ià(
RUNNING_ON_VALGRIND
è
cmd
 = "./runsrv " + cmd;

117 
fds
[2];

118 ià(
	`sock‘·œ
(
AF_UNIX
, 
SOCK_STREAM
, 
PF_UNSPEC
, 
fds
) < 0) {

119 
¡ršg
 
	`msg
("Couldn't create socketpair: ");

120 
msg
 +ğ
	`¡»¼Ü
(
”ºo
);

121 
throw
 
msg
;

124 
pid_t
 
chd
 = 
	`fÜk
();

125 ià(
chd
 == 0) {

127 
	`şo£
(
fds
[0]);

129 
	`dup2
(
fds
[1], 1);

130 
	`dup2
(
fds
[1], 2);

131 
	`exeş
("/bš/sh", "/bš/sh", "-c", 
cmd
.
	`c_¡r
(), (*)
NULL
);

132 
	`_ex™
(-1);

135 
	`şo£
(
fds
[1]);

136 ià(
chd
 == -1) {

138 
fÜk_”ºo
 = 
”ºo
;

139 
	`şo£
(
fds
[0]);

140 
¡ršg
 
	`msg
("Couldn't fork: ");

141 
msg
 +ğ
	`¡»¼Ü
(
fÜk_”ºo
);

142 
throw
 
msg
;

148 
FILE
 * 
fh
 = 
	`fdİ’
(
fds
[0], "r");

149 ià(
fh
 =ğ
NULL
) {

150 
¡ršg
 
	`msg
("Failedo„un command '");

151 
msg
 +ğ
cmd
;

152 
msg
 += "': ";

153 
msg
 +ğ
	`¡»¼Ü
(
”ºo
);

154 
throw
 
msg
;

157 
¡ršg
 
ouut
;

158 
Œue
) {

159 
buf
[256];

160 ià(
	`fg‘s
(
buf
, (buf), 
fh
è=ğ
NULL
) {

161 
	`fşo£
(
fh
);

163 
¡©us
;

164 ià(
	`wa™pid
(
chd
, &
¡©us
, 0) == -1) {

165 
¡ršg
 
	`msg
("waitpid failed: ");

166 
msg
 +ğ
	`¡»¼Ü
(
”ºo
);

167 
throw
 
msg
;

169 ià(++
pÜt
 < 65536 && 
¡©us
 != 0) {

170 ià(
	`WIFEXITED
(
¡©us
è&& 
	`WEXITSTATUS
(status) == 69) {

174 
Œy_Ãxt_pÜt
;

177 
¡ršg
 
	`msg
("Failedo get 'Listening...' from command '");

178 
msg
 +ğ
cmd
;

179 
msg
 += "' (output: ";

180 
msg
 +ğ
ouut
;

181 
msg
 += ")";

182 
throw
 
msg
;

184 ià(
	`¡rcmp
(
buf
, "Listening...\n") == 0) ;

185 
ouut
 +ğ
buf
;

190 
Œacked_fd
 = 
	`dup
(
fds
[0]);

194 
	`fşo£
(
fh
);

198 
i
 = 0; i < (
pid_to_fd
è/ (
pid_fd
); ++i) {

199 ià(
pid_to_fd
[
i
].
pid
 == 0) {

200 
pid_to_fd
[
i
].
fd
 = 
Œacked_fd
;

201 
pid_to_fd
[
i
].
pid
 = 
chd
;

208 
	`sigÇl
(
SIGCHLD
, 
Ú_SIGCHLD
);

210  
pÜt
;

211 
	}
}

213 #–ià
defšed
 
__WIN32__


215 
XAPIAN_NORETURN
(
wš32_throw_”rÜ_¡ršg
(cÚ¡ * 
¡r
));

216 
	$wš32_throw_”rÜ_¡ršg
(cÚ¡ * 
¡r
)

218 
¡ršg
 
	`msg
(
¡r
);

219 * 
”rÜ
 = 0;

220 
DWORD
 
Ën
;

221 
Ën
 = 
	`FÜm©Mes§ge
(
FORMAT_MESSAGE_FROM_SYSTEM
|
FORMAT_MESSAGE_ALLOCATE_BUFFER
,

222 0, 
	`G‘La¡E¼Ü
(), 0, (
CHAR
*)&
”rÜ
, 0, 0);

223 ià(
”rÜ
) {

225 ià(
Ën
 >ğ2 && 
”rÜ
[len - 2] == '\r' &&ƒrror[len - 1] == '\n')

226 
Ën
 -= 2;

227 ià(
Ën
) {

228 
msg
 += ": ";

229 
msg
.
	`­³nd
(
”rÜ
, 
Ën
);

231 
	`LoÿlF»e
(
”rÜ
);

233 
throw
 
msg
;

234 
	}
}

239 
	$Ïunch_x­Ÿn_tı¤v
(cÚ¡ 
¡ršg
 & 
¬gs
)

241 
pÜt
 = 
DEFAULT_PORT
;

243 
Œy_Ãxt_pÜt
:

244 
¡ršg
 
cmd
 = 
XAPIAN_TCPSRV
" --Úe-shÙ --š‹rçû "
LOCALHOST
" --pÜˆ" + 
	`om_to¡ršg
(
pÜt
è+ " " + 
¬gs
;

247 
HANDLE
 
hR—d
, 
hWr™e
;

248 ià(!
	`C»©ePe
(&
hR—d
, &
hWr™e
, 0, 0))

249 
	`wš32_throw_”rÜ_¡ršg
("Couldn't create…ipe");

252 
	`S‘HªdËInfÜm©iÚ
(
hWr™e
, 
HANDLE_FLAG_INHERIT
, 1);

255 
PROCESS_INFORMATION
 
´ocšfo
;

256 
	`mem£t
(&
´ocšfo
, 0, (
PROCESS_INFORMATION
));

258 
STARTUPINFO
 
¡¬tupšfo
;

259 
	`mem£t
(&
¡¬tupšfo
, 0, (
STARTUPINFO
));

260 
¡¬tupšfo
.
cb
 = (
STARTUPINFO
);

261 
¡¬tupšfo
.
hStdE¼Ü
 = 
hWr™e
;

262 
¡¬tupšfo
.
hStdOuut
 = 
hWr™e
;

263 
¡¬tupšfo
.
hStdIÅut
 = 
INVALID_HANDLE_VALUE
;

264 
¡¬tupšfo
.
dwFÏgs
 |ğ
STARTF_USESTDHANDLES
;

267 
BOOL
 
ok
;

268 * 
cmdlše
 = 
	`¡rdup
(
cmd
.
	`c_¡r
());

269 
ok
 = 
	`C»©eProûss
(0, 
cmdlše
, 0, 0, 
TRUE
, 0, 0, 0, &
¡¬tupšfo
, &
´ocšfo
);

270 
	`ä“
(
cmdlše
);

271 ià(!
ok
)

272 
	`wš32_throw_”rÜ_¡ršg
("Couldn't create child…rocess");

274 
	`Clo£HªdË
(
hWr™e
);

275 
	`Clo£HªdË
(
´ocšfo
.
hTh»ad
);

277 
¡ršg
 
ouut
;

278 
FILE
 *
fh
 = 
	`fdİ’
(
	`_İ’_osfhªdË
((
šŒ_t
)
hR—d
, 
O_RDONLY
), "r");

279 
Œue
) {

280 
buf
[256];

281 ià(
	`fg‘s
(
buf
, (buf), 
fh
è=ğ
NULL
) {

282 
	`fşo£
(
fh
);

283 
DWORD
 
rc
;

286 
	`G‘Ex™CodeProûss
(
´ocšfo
.
hProûss
, &
rc
è&&„ø=ğ
STILL_ACTIVE
) {

287 
	`SË•
(100);

289 
	`Clo£HªdË
(
´ocšfo
.
hProûss
);

290 ià(++
pÜt
 < 65536 && 
rc
 == 69) {

294 
Œy_Ãxt_pÜt
;

296 
¡ršg
 
	`msg
("Failedo get 'Listening...' from command '");

297 
msg
 +ğ
cmd
;

298 
msg
 += "' (output: ";

299 
msg
 +ğ
ouut
;

300 
msg
 += ")";

301 
throw
 
msg
;

303 ià(
	`¡rcmp
(
buf
, "Listening...\r\n") == 0) ;

304 
ouut
 +ğ
buf
;

306 
	`fşo£
(
fh
);

308  
pÜt
;

309 
	}
}

312 #”rÜ 
Ne™h”
 
HAVE_FORK
 
nÜ
 
__WIN32__
 
is
 
defšed


315 
	gBack’dMªag”RemÙeTı
::~
	$Back’dMªag”RemÙeTı
() {

316 
Back’dMªag”RemÙeTı
::
	`ş—n_up
();

317 
	}
}

319 
	g¡d
::
¡ršg


320 
Back’dMªag”RemÙeTı
::
	$g‘_dbty³
() const

322  "»mÙ‘ı_" + 
»mÙe_ty³
;

323 
	}
}

325 
	gX­Ÿn
::
D©aba£


326 
Back’dMªag”RemÙeTı
::
do_g‘_d©aba£
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
)

330  
Back’dMªag”RemÙeTı
::
g‘_»mÙe_d©aba£
(
fes
, 300000);

333 
	gX­Ÿn
::
Wr™abËD©aba£


334 
Back’dMªag”RemÙeTı
::
	$g‘_wr™abË_d©aba£
(cÚ¡ 
¡ršg
 & 
Çme
,

335 cÚ¡ 
¡ršg
 & 
fe
)

337 
¡ršg
 
¬gs
 = 
	`g‘_wr™abË_d©aba£_¬gs
(
Çme
, 
fe
);

338 
pÜt
 = 
	`Ïunch_x­Ÿn_tı¤v
(
¬gs
);

339  
X­Ÿn
::
RemÙe
::
	`İ’_wr™abË
(
LOCALHOST
, 
pÜt
);

340 
	}
}

342 
	gX­Ÿn
::
D©aba£


343 
Back’dMªag”RemÙeTı
::
g‘_»mÙe_d©aba£
(cÚ¡ 
veùÜ
<
¡ršg
> & 
fes
,

344 
timeout
)

346 
¡ršg
 
	g¬gs
 = 
g‘_»mÙe_d©aba£_¬gs
(
fes
, 
timeout
);

347 
	gpÜt
 = 
Ïunch_x­Ÿn_tı¤v
(
¬gs
);

348  
	gX­Ÿn
::
RemÙe
::
İ’
(
LOCALHOST
, 
pÜt
);

351 
	gX­Ÿn
::
D©aba£


352 
Back’dMªag”RemÙeTı
::
	$g‘_wr™abË_d©aba£_as_d©aba£
()

354 
¡ršg
 
¬gs
 = 
	`g‘_wr™abË_d©aba£_as_d©aba£_¬gs
();

355 
pÜt
 = 
	`Ïunch_x­Ÿn_tı¤v
(
¬gs
);

356  
X­Ÿn
::
RemÙe
::
	`İ’
(
LOCALHOST
, 
pÜt
);

357 
	}
}

359 
	gX­Ÿn
::
Wr™abËD©aba£


360 
Back’dMªag”RemÙeTı
::
	$g‘_wr™abË_d©aba£_agaš
()

362 
¡ršg
 
¬gs
 = 
	`g‘_wr™abË_d©aba£_agaš_¬gs
();

363 
pÜt
 = 
	`Ïunch_x­Ÿn_tı¤v
(
¬gs
);

364  
X­Ÿn
::
RemÙe
::
	`İ’_wr™abË
(
LOCALHOST
, 
pÜt
);

365 
	}
}

368 
	gBack’dMªag”RemÙeTı
::
	$ş—n_up
()

370 #ifdeà
HAVE_FORK


371 
	`sigÇl
(
SIGCHLD
, 
SIG_DFL
);

372 
i
 = 0; i < (
pid_to_fd
è/ (
pid_fd
); ++i) {

373 
pid_t
 
chd
 = 
pid_to_fd
[
i
].
pid
;

374 ià(
chd
) {

375 
¡©us
;

376 
	`wa™pid
(
chd
, &
¡©us
, 0è=ğ-1 && 
”ºo
 =ğ
EINTR
) { }

381 
fd
 = 
pid_to_fd
[
i
].fd;

382 
pid_to_fd
[
i
].
fd
 = 0;

383 
pid_to_fd
[
i
].
pid
 = 0;

384 
	`şo£
(
fd
);

388 
	}
}

	@tests/harness/backendmanager_remotetcp.h

22 #iâdeà
XAPIAN_INCLUDED_BACKENDMANAGER_REMOTETCP_H


23 
	#XAPIAN_INCLUDED_BACKENDMANAGER_REMOTETCP_H


	)

25 
	~"back’dmªag”.h
"

26 
	~"back’dmªag”_»mÙe.h
"

28 
	~<¡ršg
>

31 şas 
	cBack’dMªag”RemÙeTı
 : 
public
 
Back’dMªag”RemÙe
 {

33 
İ”©Ü
=(cÚ¡ 
Back’dMªag”RemÙeTı
 &);

36 
Back’dMªag”RemÙeTı
(const BackendManagerRemoteTcp &);

39 
	m¡d
::
¡ršg
 
Ï¡_wdb_Çme
;

41 
	m´iv©e
:

43 
X­Ÿn
::
D©aba£
 
do_g‘_d©aba£
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
);

45 
	mpublic
:

46 
Back’dMªag”RemÙeTı
(cÚ¡ 
¡d
::
¡ršg
 & 
»mÙe_ty³_
)

47 : 
	$Back’dMªag”RemÙe
(
»mÙe_ty³_
) { }

49 ~
	`Back’dMªag”RemÙeTı
();

52 
¡d
::
¡ršg
 
	$g‘_dbty³
() const;

55 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£
(cÚ¡ 
¡d
::
¡ršg
 & 
Çme
,

56 cÚ¡ 
¡d
::
¡ršg
 & 
fe
);

59 
X­Ÿn
::
D©aba£
 
	`g‘_»mÙe_d©aba£
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
,

60 
timeout
);

63 
X­Ÿn
::
D©aba£
 
	`g‘_wr™abË_d©aba£_as_d©aba£
();

66 
X­Ÿn
::
Wr™abËD©aba£
 
	`g‘_wr™abË_d©aba£_agaš
();

69 
	`ş—n_up
();

70 
	}
};

	@tests/harness/cputimer.cc

21 
	~<cÚfig.h
>

23 
	~"ıutim”.h
"

25 
	~"‹¡su™e.h
"

27 
	~"§ã”ºo.h
"

29 #ifdeà
HAVE_GETRUSAGE


30 
	~<sys/time.h
>

31 
	~<sys/»sourû.h
>

32 #–ià
defšed
 
HAVE_TIMES


33 
	~<sys/times.h
>

34 #ifdeà
HAVE_SYSCONF


35 
	~"§ãuni¡d.h
"

37 #–ià
defšed
 
HAVE_FTIME


38 
	~<sys/timeb.h
>

40 
	~<ùime
>

43 
	~<c¡ršg
>

44 
	~<¡ršg
>

46 
usšg
 
Çme¥aû
 
	g¡d
;

49 
	gCPUTim”
::
	$g‘_cu¼’t_ıutime
() const

51 
t
 = 0;

52 #ifdeà
HAVE_GETRUSAGE


53 
ru§ge
 
r
;

54 ià(
	`g‘ru§ge
(
RUSAGE_SELF
, &
r
) == -1) {

55 
	`FAIL_TEST
(
	`¡ršg
("Couldn'ˆm—su» CPU fÜ s–f: "è+ 
	`¡»¼Ü
(
”ºo
));

58 
t
 = 
r
.
ru_utime
.
tv_£c
 +„.
ru_¡ime
.tv_sec;

59 
t
 +ğ(
r
.
ru_utime
.
tv_u£c
 +„.
ru_¡ime
.tv_usec) * 0.000001;

60 #–ià
defšed
 
HAVE_TIMES


61 
tms
 
b
;

62 ià(
	`times
(&
b
è=ğ(
şock_t
)-1) {

63 
	`FAIL_TEST
(
	`¡ršg
("Couldn'ˆm—su» CPU: "è+ 
	`¡»¼Ü
(
”ºo
));

65 
t
 = ()(
b
.
tms_utime
 + b.
tms_¡ime
);

66 #ifdeà
HAVE_SYSCONF


67 
t
 /ğ
	`syscÚf
(
_SC_CLK_TCK
);

69 
t
 /ğ
CLK_TCK
;

75 #ifdeà
HAVE_FTIME


76 
timeb
 
tb
;

77 #ifdeà
FTIME_RETURNS_VOID


78 
	`áime
(&
tb
);

79 
t
 = 
tb
.
time
 + (tb.
ml™m
 * 0.001);

81 ià(
	`áime
(&
tb
) == -1) {

82 
t
 = 
	`time
(
NULL
);

84 
t
 = 
tb
.
time
 + (tb.
ml™m
 * 0.001);

88 
t
 = 
	`time
(
NULL
);

92  
t
;

93 
	}
}

	@tests/harness/cputimer.h

21 #iâdeà
XAPIAN_INCLUDED_CPUTIMER_H


22 
	#XAPIAN_INCLUDED_CPUTIMER_H


	)

24 şas 
	cCPUTim”
 {

25 
	m¡¬t
;

27 
	$g‘_cu¼’t_ıutime
() const;

29 
public
:

31 
	$CPUTim”
(è: 
	`¡¬t
(
	$g‘_cu¼’t_ıutime
()) { }

34 
	$g‘_time
() const {

35  
	`g‘_cu¼’t_ıutime
(è- 
¡¬t
;

36 
	}
}

	@tests/harness/index_utils.cc

20 
	~<cÚfig.h
>

22 
	~"šdex_uts.h
"

24 
	~"¡ršguts.h
"

26 
	~<®gÜ™hm
>

27 
	~<c¡ršg
>

28 
	~<f¡»am
>

30 
	~"§ã”ºo.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

35 
¡ršg


36 
	$g‘_·¿g¿ph
(
i¡»am
 &
šput
)

38 
¡ršg
 
·¿
, 
lše
;

39 
Œue
) {

40 
	`g‘lše
(
šput
, 
lše
);

41 ià(
	`fšd_if
(
lše
.
	`begš
(),†še.
	`’d
(), 
C_i¢Ù¥aû
) ==†ine.end())

42  
·¿
;

43 
·¿
 +ğ
lše
;

44 
·¿
 += '\n';

46 
	}
}

48 
	gX­Ÿn
::
Docum’t


49 
FeIndex”
::
	$Ãxt
()

51 ià(
šput
.
	`eof
()è
	`Ãxt_fe
();

53 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

55 
X­Ÿn
::
Docum’t
 
doc
;

56 
¡ršg
 
·¿
 = 
	`g‘_·¿g¿ph
(
šput
);

57 
doc
.
	`£t_d©a
(
·¿
);

61 
¡ršg
 
	`v®ue0
("X\0\0\0 \1\t"

79 ià(
·¿
.
	`size
(è> 2è
v®ue0
[0] =…ara[2];

80 
v®ue0
 +ğ
·¿
;

81 
doc
.
	`add_v®ue
(0, 
v®ue0
);

83 
X­Ÿn
::
v®u’o
 
i
 = 
	`mš
(
·¿
.
	`Ëngth
(), 
	`size_t
(10)); i >= 1; --i) {

84 
doc
.
	`add_v®ue
(
i
, 
·¿
.
	`sub¡r
(i, 1));

87 
doc
.
	`add_v®ue
(11, 
X­Ÿn
::
	`sÜbË_£rŸli£
(
·¿
.
	`size
()));

90 
doc
.
	`add_v®ue
(12, 
X­Ÿn
::
	`sÜbË_£rŸli£
(
·¿
.
	`size
() % 5));

93 
doc
.
	`add_v®ue
(13, 
·¿
.
	`sub¡r
(0, 3));

95 
X­Ÿn
::
‹rmcouÁ
 
pos
 = 0;

96 
¡ršg
::
cÚ¡_™”©Ü
 
wÜd_’d
 = 
·¿
.
	`begš
();

98 cÚ¡ 
¡ršg
::
cÚ¡_™”©Ü
 
·¿_’d
 = 
·¿
.
	`’d
();

99 
wÜd_’d
 !ğ
·¿_’d
) {

100 
¡ršg
::
cÚ¡_™”©Ü
 
wÜd_¡¬t
;

101 
wÜd_¡¬t
 = 
	`fšd_if
(
wÜd_’d
, 
·¿_’d
, 
C_i¢Ù¥aû
);

102 
wÜd_’d
 = 
	`fšd_if
(
wÜd_¡¬t
, 
·¿_’d
, 
C_is¥aû
);

103 
¡ršg
 
wÜd
 = 
	`¡emm”
(
	`munge_‹rm
(
	`¡ršg
(
wÜd_¡¬t
, 
wÜd_’d
)));

104 ià(!
wÜd
.
	`em±y
()è
doc
.
	`add_po¡šg
(wÜd, ++
pos
);

107  
doc
;

108 
	}
}

111 
¡ršg


112 
	$munge_‹rm
(cÚ¡ 
¡ršg
 &
‹rm
)

114 
¡ršg
 
»suÉ
;

115 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
‹rm
.
	`begš
(); i !ğ‹rm.
	`’d
(); ++i) {

116 
ch
 = *
i
;

117 ià(
	`C_i§Êum
(
ch
))

118 
»suÉ
 +ğ
	`C_tŞow”
(
ch
);

119 ià(
ch
 == '\\') {

120 ++
i
;

121 ià(
i
 !ğ
‹rm
.
	`’d
()) {

122 *
i
) {

123 '\\': 
ch
 = '\\'; ;

124 '0': 
ch
 = '\0'; ;

125 'n': 
ch
 = '\n'; ;

126 'r': 
ch
 = '\r'; ;

127 't': 
ch
 = '\t'; ;

130 ià(
	`size_t
(
i
 - 
‹rm
.
	`begš
()è>ğ‹rm.
	`size
() - 2) {

131 --
i
;

134 
¡ršg
::
cÚ¡_™”©Ü
 
j
 = 
i
;

135 
b
 = *++
i
;

136 
c
 = *++
i
;

137 ià(!
	`C_isxdig™
(
b
è|| !C_isxdig™(
c
)) {

138 
i
 = 
j
 - 1;

141 ià(
	`C_isdig™
(
b
)) {

142 
ch
 = 
b
 - '0';

144 
ch
 = 
	`C_tŞow”
(
b
) - 'a' + 10;

146 
ch
 *= 16;

147 ià(
	`C_isdig™
(
c
)) {

148 
ch
 |ğ
c
 - '0';

150 
ch
 |ğ
	`C_tŞow”
(
c
) - 'a' + 10;

156 
»suÉ
 +ğ
ch
;

159  
»suÉ
;

160 
	}
}

163 
	gFeIndex”
::
	$Ãxt_fe
()

165 ià(
šput
.
	`is_İ’
()) {

166 
šput
.
	`şo£
();

168 
šput
.
	`ş—r
();

172 
fe
 !ğ
’d
 && (*fe).
	`em±y
()) {

173 ++
fe
;

175 ià(
fe
 =ğ
’d
) ;

177 
¡ršg
 
f’ame
;

178 ià(!
d©adœ
.
	`em±y
()) {

179 
f’ame
 = 
d©adœ
;

180 ià(!
	`’dsw™h
(
d©adœ
, '/')è
f’ame
 += '/';

182 
f’ame
 +ğ*
fe
++;

183 
f’ame
 += ".txt";

185 
šput
.
	`İ’
(
f’ame
.
	`c_¡r
());

187 ià(!
šput
.
	`is_İ’
()) {

188 
¡ršg
 
msg
 = "Can't„ead file '";

189 
msg
 +ğ
f’ame
;

190 
msg
 += "' for indexing (";

191 
msg
 +ğ
	`¡»¼Ü
(
”ºo
);

192 
msg
 += ')';

193 
throw
 
msg
;

195 
	}
}

	@tests/harness/index_utils.h

20 #iâdeà
XAPIAN_HGUARD_INDEX_UTILS_H


21 
	#XAPIAN_HGUARD_INDEX_UTILS_H


	)

23 
	~<f¡»am
>

24 
	~<¡ršg
>

25 
	~<veùÜ
>

27 
	~<x­Ÿn.h
>

29 
	g¡d
::
¡ršg
 
munge_‹rm
(cÚ¡ 
¡d
::¡ršg &
‹rm
);

31 şas 
	cFeIndex”
 {

32 
	m¡d
::
¡ršg
 
d©adœ
;

33 
	m¡d
::
veùÜ
<
¡d
::
¡ršg
>::
cÚ¡_™”©Ü
 
fe
, 
	m’d
;

34 
	m¡d
::
if¡»am
 
šput
;

36 
Ãxt_fe
();

38 
	mpublic
:

39 
FeIndex”
(cÚ¡ 
¡d
::
¡ršg
 & 
d©adœ_
,

40 cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
> & 
fes
)

41 : 
d©adœ
(
d©adœ_
), 
fe
(
fes
.
begš
()), 
’d
(fes.
	$’d
())

43 
	`Ãxt_fe
();

46 
İ”©Ü
 
	$boŞ
() {

47  !(
fe
 =ğ
’d
 && (!
šput
.
	`is_İ’
(è|| iÅut.
	`eof
()));

48 
	}
}

50 
	gX­Ÿn
::
Docum’t
 
Ãxt
();

	@tests/harness/scalability.cc

21 
	~<cÚfig.h
>

23 
	~"sÿÏb™y.h
"

25 
	~"ıutim”.h
"

26 
	~"‹¡su™e.h
"

29 
‹¡_sÿÏb™y
((*
func
)(), 
n
, 
th»shŞd
)

31 
time1
;

35 
time1
 = 
	`func
(
n
);

36 
tout
 << "Te¡ w™h " << 
n
 << "„•‘™iÚ took " << 
time1
 << " secs\n";

37 
n_Ãw
 = 
n
 * 10;

38 ià(
n_Ãw
 < 
n
)

39 
	`SKIP_TEST
("Can't countƒnough„epetitionso be‡bleoimeest");

40 
n
 = 
n_Ãw
;

41 } 
time1
 <= 0.001);

43 
time10
 = 
	`func
(
n
);

44 
tout
 << "Te¡ w™h " << 
n
 << "„•‘™iÚ took " << 
time10
 << " secs\n";

46 
	`TEST_REL
(
time10
,<,
time1
 * 
th»shŞd
);

47 
	}
}

	@tests/harness/scalability.h

21 #iâdeà
XAPIAN_INCLUDED_SCALABILITY_H


22 
	#XAPIAN_INCLUDED_SCALABILITY_H


	)

24 
‹¡_sÿÏb™y
((*
func
)(), 
n
, 
th»shŞd
);

32 
	#O_N
 14.1

	)

33 
	#O_N_LOG_N
 44.7

	)

	@tests/harness/testmacros.h

22 #iâdeà
XAPIAN_INCLUDED_TESTMACROS_H


23 
	#XAPIAN_INCLUDED_TESTMACROS_H


	)

26 
	#TEST_REL
(
A
,
REL
,
B
) \

27 
	`TEST_AND_EXPLAIN
((
A
è
	`REL
 (
B
), \

28 "Ev®u©e to: " << (
A
è<< " "#REL" " << (
B
))

	)

	@tests/harness/testrunner.cc

23 
	~<cÚfig.h
>

25 
	~"‹¡ruÂ”.h
"

27 
	~"‹¡su™e.h
"

28 
	~"back’dmªag”.h
"

29 
	~"back’dmªag”_b¿ss.h
"

30 
	~"back’dmªag”_ch”t.h
"

31 
	~"back’dmªag”_æšt.h
"

32 
	~"back’dmªag”_šmemÜy.h
"

33 
	~"back’dmªag”_muÉi.h
"

34 
	~"back’dmªag”_»mÙ•rog.h
"

35 
	~"back’dmªag”_»mÙ‘ı.h
"

37 
	~"¡ršguts.h
"

38 
	~<io¡»am
>

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
Back’dMªag”
 * 
	gback’dmªag”
;

46 
	sBack’dPrİ”t›s
 {

47 cÚ¡ * 
	mÇme
;

48 cÚ¡ * 
	m´İ”t›s
;

53 
Back’dPrİ”t›s
 
	gback’d_´İ”t›s
[] = {

71 { 
NULL
, NULL }

74 
	gTe¡RuÂ”
::~
	$Te¡RuÂ”
(è{ 
	}
}

77 
Te¡RuÂ”
::
	$£t_´İ”t›s
(cÚ¡ 
¡ršg
 & 
´İ”t›s
)

80 
back’d
 = 
çl£
;

81 
»mÙe
 = 
çl£
;

82 
Œª§ùiÚs
 = 
çl£
;

83 
pos™iÚ®
 = 
çl£
;

84 
wr™abË
 = 
çl£
;

85 
muÉi
 = 
çl£
;

86 
¥–lšg
 = 
çl£
;

87 
synÚyms
 = 
çl£
;

88 
m‘ad©a
 = 
çl£
;

89 
»¶iÿs
 = 
çl£
;

90 
v®ue¡©s
 = 
çl£
;

91 
šmemÜy
 = 
çl£
;

92 
b¿ss
 = 
çl£
;

93 
ch”t
 = 
çl£
;

94 
æšt
 = 
çl£
;

97 
¡ršg
::
size_ty³
 
pos
 = 0;

98 
¡ršg
::
size_ty³
 
comma
 = 0;

99 
pos
 !ğ
¡ršg
::
Åos
) {

100 
comma
 = 
´İ”t›s
.
	`fšd
(',', 
pos
 + 1);

101 
¡ršg
 
´İÇme
 = 
´İ”t›s
.
	`sub¡r
(
pos
, 
comma
 -…os);

104 ià(
´İÇme
.
	`em±y
()) {}

105 ià(
´İÇme
 == "backend")

106 
back’d
 = 
Œue
;

107 ià(
´İÇme
 == "remote")

108 
»mÙe
 = 
Œue
;

109 ià(
´İÇme
 == "transactions")

110 
Œª§ùiÚs
 = 
Œue
;

111 ià(
´İÇme
 == "positional")

112 
pos™iÚ®
 = 
Œue
;

113 ià(
´İÇme
 == "writable")

114 
wr™abË
 = 
Œue
;

115 ià(
´İÇme
 == "multi")

116 
muÉi
 = 
Œue
;

117 ià(
´İÇme
 == "spelling")

118 
¥–lšg
 = 
Œue
;

119 ià(
´İÇme
 == "synonyms")

120 
synÚyms
 = 
Œue
;

121 ià(
´İÇme
 == "metadata")

122 
m‘ad©a
 = 
Œue
;

123 ià(
´İÇme
 == "replicas")

124 
»¶iÿs
 = 
Œue
;

125 ià(
´İÇme
 == "valuestats")

126 
v®ue¡©s
 = 
Œue
;

127 ià(
´İÇme
 == "inmemory")

128 
šmemÜy
 = 
Œue
;

129 ià(
´İÇme
 == "brass")

130 
b¿ss
 = 
Œue
;

131 ià(
´İÇme
 == "chert")

132 
ch”t
 = 
Œue
;

133 ià(
´İÇme
 == "flint")

134 
æšt
 = 
Œue
;

136 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("UnknowÀ´İ”ty '" + 
´İÇme
 + "' found in…roplist");

138 ià(
comma
 =ğ
¡ršg
::
Åos
)

140 
pos
 = 
comma
 + 1;

142 
	}
}

144 
boŞ


145 
	gTe¡RuÂ”
::
	$u£_back’d
(cÚ¡ 
¡ršg
 & 
back’d_Çme
)

147 ià(
u£r_back’d
.
	`em±y
())

148  
Œue
;

149 ià(
back’d_Çme
 =ğ
u£r_back’d
)

150  
Œue
;

151 ià(
	`¡¬tsw™h
(
back’d_Çme
, 
u£r_back’d
 + "_"))

152  
Œue
;

153  
çl£
;

154 
	}
}

157 
	gTe¡RuÂ”
::
	$£t_´İ”t›s_fÜ_back’d
(cÚ¡ 
¡ršg
 & 
back’d_Çme
)

159 cÚ¡ * 
´İ¡ršg
 = 
NULL
;

160 cÚ¡ 
Back’dPrİ”t›s
 * 
i
 = 
back’d_´İ”t›s
; i->
Çme
; ++i) {

161 ià(
back’d_Çme
 =ğ
i
->
Çme
) {

162 
´İ¡ršg
 = 
i
->
´İ”t›s
;

166 ià(!
´İ¡ršg
)

167 
throw
 
X­Ÿn
::
	`Inv®idArgum’tE¼Ü
("UnknowÀback’d " + 
back’d_Çme
);

168 
	`£t_´İ”t›s
(
´İ¡ršg
);

169 
	}
}

172 
	gTe¡RuÂ”
::
	$do_‹¡s_fÜ_back’d
(
Back’dMªag”
 * 
mªag”
)

174 
¡ršg
 
back’d_Çme
 = 
mªag”
->
	`g‘_dbty³
();

175 ià(
	`u£_back’d
(
back’d_Çme
)) {

176 
back’dmªag”
 = 
mªag”
;

177 
back’dmªag”
->
	`£t_d©adœ
(
¤cdœ
 + "/testdata/");

178 
	`£t_´İ”t›s_fÜ_back’d
(
back’d_Çme
);

179 
cout
 << "RuÂšge¡ w™h back’d \"" << 
back’dmªag”
->
	`g‘_dbty³
(è<< "\"..." << 
’dl
;

180 
»suÉ_so_çr
 = 
	`max
ÔesuÉ_so_çr, 
	`run
());

182 
d–‘e
 
mªag”
;

183 
	}
}

186 
	gTe¡RuÂ”
::
	$run_‹¡s
(
¬gc
, ** 
¬gv
)

188 
»suÉ_so_çr
 = 0;

189 
Œy
 {

190 
‹¡_driv”
::
	`add_commªd_lše_İtiÚ
("back’d", 'b', &
u£r_back’d
);

191 
‹¡_driv”
::
	`·r£_commªd_lše
(
¬gc
, 
¬gv
);

192 
¤cdœ
 = 
‹¡_driv”
::
	`g‘_¤cdœ
();

194 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
Back’dMªag”
);

196 #ifdeà
XAPIAN_HAS_INMEMORY_BACKEND


197 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
Back’dMªag”InMemÜy
);

200 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


201 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
Back’dMªag”B¿ss
);

204 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


205 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
Back’dMªag”Ch”t
);

208 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


209 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
Back’dMªag”Flšt
);

212 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


213 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”MuÉi
("brass"));

215 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


216 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”MuÉi
("chert"));

218 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


219 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”MuÉi
("flint"));

222 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


223 #ifdeà
XAPIAN_HAS_BRASS_BACKEND


224 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”RemÙeProg
("brass"));

225 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”RemÙeTı
("brass"));

227 #ifdeà
XAPIAN_HAS_CHERT_BACKEND


228 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”RemÙeProg
("chert"));

229 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”RemÙeTı
("chert"));

231 #ifdeà
XAPIAN_HAS_FLINT_BACKEND


232 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”RemÙeProg
("flint"));

233 
	`do_‹¡s_fÜ_back’d
(
Ãw
 
	`Back’dMªag”RemÙeTı
("flint"));

236 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

237 
û¼
 << "\nTe¡ h¬Ãs çed w™h " << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;

238  
çl£
;

239 } 
	`ÿtch
 (cÚ¡ 
¡d
::
¡ršg
 &
e
) {

240 
û¼
 << "\nTe¡ h¬Ãs çed w™h \"" << 
e
 << "\"" << 
’dl
;

241  
çl£
;

243  
»suÉ_so_çr
;

244 
	}
}

	@tests/harness/testrunner.h

23 #iâdeà
XAPIAN_INCLUDED_TESTRUNNER_H


24 
	#XAPIAN_INCLUDED_TESTRUNNER_H


	)

26 
	~<¡ršg
>

28 
şass
 
	gBack’dMªag”
;

31 
Back’dMªag”
 * 
back’dmªag”
;

36 şas 
	cTe¡RuÂ”
 {

39 
	m¡d
::
¡ršg
 
u£r_back’d
;

45 
	m»suÉ_so_çr
;

49 
	m¡d
::
¡ršg
 
¤cdœ
;

53 
£t_´İ”t›s
(cÚ¡ 
¡d
::
¡ršg
 & 
´İ”t›s
);

57 
boŞ
 
u£_back’d
(cÚ¡ 
¡d
::
¡ršg
 & 
back’d_Çme
);

61 
£t_´İ”t›s_fÜ_back’d
(cÚ¡ 
¡d
::
¡ršg
 & 
back’d_Çme
);

65 
do_‹¡s_fÜ_back’d
(
Back’dMªag”
 * 
mªag”
);

67 
	mpublic
:

70 
boŞ
 
back’d
;

73 
boŞ
 
	m»mÙe
;

76 
boŞ
 
	mŒª§ùiÚs
;

79 
boŞ
 
	mpos™iÚ®
;

82 
boŞ
 
	mwr™abË
;

85 
boŞ
 
	m¥–lšg
;

88 
boŞ
 
	msynÚyms
;

91 
boŞ
 
	mm‘ad©a
;

94 
boŞ
 
	m»¶iÿs
;

97 
boŞ
 
	mv®ue¡©s
;

100 
boŞ
 
	mmuÉi
;

103 
boŞ
 
	mšmemÜy
;

106 
boŞ
 
	mb¿ss
;

109 
boŞ
 
	mch”t
;

112 
boŞ
 
	mæšt
;

115 
	mvœtu®
 ~
Te¡RuÂ”
();

122 
run_‹¡s
(
¬gc
, ** 
¬gv
);

129 
vœtu®
 
	$run
() const = 0;

	@tests/harness/testsuite.cc

23 
	~<cÚfig.h
>

25 
	~"‹¡su™e.h
"

26 
	~"‹¡ruÂ”.h
"

27 
	~"back’dmªag”.h
"

29 #ifdeà
HAVE_VALGRIND


30 
	~"§ã”ºo.h
"

31 
	~<v®gršd/memcheck.h
>

32 
	~<c¡dio
>

33 
	~<sys/ty³s.h
>

34 
	~"§ãfú.h
"

35 
	~"§ãuni¡d.h
"

38 
	~<®gÜ™hm
>

39 
	~<io¡»am
>

40 
	~<£t
>

42 
	~<cæßt
>

43 
	~<cm©h
>

44 
	~<c¡dlib
>

45 
	~<c¡ršg
>

47 
	~"gnu_g‘İt.h
"

49 
	~<c£tjmp
>

50 
	~<sigÇl.h
>

52 
	~<exû±iÚ
>

53 #ifdeà
USE_RTTI


54 
	~<ty³šfo
>

55 #ifdeà
__GNUC__


56 
	~<cxxabi.h
>

60 
	~<x­Ÿn/”rÜ.h
>

61 
	~"nÜ‘uº.h
"

62 
	~"¡ršguts.h
"

63 
	~"uts.h
"

65 
usšg
 
Çme¥aû
 
	g¡d
;

68 
boŞ
 
	gv”bo£
;

70 #ifdeà
HAVE_VALGRIND


71 
	gvg_log_fd
 = -1;

78 cÚ¡ * 
	gex³ùed_exû±iÚ
 = 
NULL
;

81 
	g¡d
::
o¡ršg¡»am
 
tout
;

83 
	g‹¡_driv”
::
runs
 = 0;

84 
	g‹¡_driv”
::
»suÉ
 
‹¡_driv”
::
subtÙ®
;

85 
	g‹¡_driv”
::
»suÉ
 
‹¡_driv”
::
tÙ®
;

86 
¡ršg
 
	g‹¡_driv”
::
¬gv0
;

87 
¡ršg
 
	g‹¡_driv”
::
İt_h–p
;

88 
	gm­
<, 
	g¡ršg
 *> 
	g‹¡_driv”
::
shÜt_İts
;

89 
	gveùÜ
<
	g¡ršg
> 
	g‹¡_driv”
::
‹¡_Çmes
;

90 
boŞ
 
	g‹¡_driv”
::
abÜt_Ú_”rÜ
 = 
çl£
;

91 
¡ršg
 
	g‹¡_driv”
::
cŞ_»d
,e¡_driv”::
cŞ_g»’
;

92 
¡ršg
 
	g‹¡_driv”
::
cŞ_y–low
,e¡_driv”::
cŞ_»£t
;

93 
boŞ
 
	g‹¡_driv”
::
u£_ü
 = 
çl£
;

96 
	g‹¡_driv”
::
	$wr™e_ªd_ş—r_tout
()

98 cÚ¡ 
¡ršg
 & 
s
 = 
tout
.
	`¡r
();

99 ià(!
s
.
	`em±y
()) {

100 
out
 << '\n' << 
s
;

101 
tout
.
	`¡r
(
	`¡ršg
());

103 
	}
}

105 
¡ršg


106 
	g‹¡_driv”
::
	$g‘_¤cdœ
()

108 *
p
 = 
	`g‘’v
("srcdir");

109 ià(
p
 !ğ
NULL
è 
	`¡ršg
(p);

111 #ifdeà
__WIN32__


113 cÚ¡ 
ARGV0_SEP
 = '\\';

115 cÚ¡ 
ARGV0_SEP
 = '/';

118 
¡ršg
 
	`¤cdœ
(
¬gv0
);

119 
¡ršg
::
size_ty³
 
i
 = 
¤cdœ
.
	`fšd_Ï¡_of
(
ARGV0_SEP
);

120 
¡ršg
 
¤cfe
;

121 ià(
i
 !ğ
¡ršg
::
Åos
) {

122 
¤cfe
 = 
¤cdœ
.
	`sub¡r
(
i
 + 1);

123 
¤cdœ
.
	`”a£
(
i
);

125 
i
 = 
¤cdœ
.
	`fšd_Ï¡_of
(
ARGV0_SEP
);

126 ià(
¤cdœ
.
	`sub¡r
(
i
 + 1) == ".libs") {

127 
¤cdœ
.
	`”a£
(
i
);

129 ià(
	`¡¬tsw™h
(
¤cfe
, "É-")è¤cfe.
	`”a£
(0, 3);

135 
¤cfe
 = 
¤cdœ
;

136 
¤cdœ
 = ".";

140 ià(
	`’dsw™h
(
¤cfe
, ".exe")è¤cfe.
	`»size
(¤cfe.
	`size
() - 4);

143 ià(!
	`fe_exi¡s
(
¤cdœ
 + '/' + 
¤cfe
 + ".cc")) {

144 
cout
 << 
¬gv0


147 << 
’dl
;

148 
	`ex™
(1);

150  
¤cdœ
;

151 
	}
}

153 
	g‹¡_driv”
::
	$‹¡_driv”
(cÚ¡ 
‹¡_desc
 *
‹¡s_
)

154 : 
	`out
(
cout
.
	`rdbuf
()), 
	$‹¡s
(
‹¡s_
)

156 
	}
}

158 
jmp_buf
 
	gjb
;

159 
	gsignum
 = 0;

164 
XAPIAN_NORETURN
(
hªdË_sig
(
signum_
));

165 
hªdË_sig
(
signum_
)

167 
sigÇl
(
SIGSEGV
, 
SIG_DFL
);

168 
sigÇl
(
SIGFPE
, 
SIG_DFL
);

169 
sigÇl
(
SIGILL
, 
SIG_DFL
);

170 #ifdeà
SIGBUS


171 
sigÇl
(
SIGBUS
, 
SIG_DFL
);

173 #ifdeà
SIGSTKFLT


174 
sigÇl
(
SIGSTKFLT
, 
SIG_DFL
);

176 
signum
 = 
signum_
;

177 
lÚgjmp
(
jb
, 1);

182 şas 
	cSigÇlRedœeùÜ
 {

183 
´iv©e
:

184 
boŞ
 
aùive
;

185 
public
:

186 
	$SigÇlRedœeùÜ
(è: 
	$aùive
(
çl£
) { }

187 
	$aùiv©e
() {

188 
aùive
 = 
Œue
;

189 
	`sigÇl
(
SIGSEGV
, 
hªdË_sig
);

190 
	`sigÇl
(
SIGFPE
, 
hªdË_sig
);

191 
	`sigÇl
(
SIGILL
, 
hªdË_sig
);

192 #ifdeà
SIGBUS


193 
	`sigÇl
(
SIGBUS
, 
hªdË_sig
);

195 #ifdeà
SIGSTKFLT


196 
	`sigÇl
(
SIGSTKFLT
, 
hªdË_sig
);

198 
	}
}

199 ~
	$SigÇlRedœeùÜ
() {

200 ià(
aùive
) {

201 
	`sigÇl
(
SIGSEGV
, 
SIG_DFL
);

202 
	`sigÇl
(
SIGFPE
, 
SIG_DFL
);

203 
	`sigÇl
(
SIGILL
, 
SIG_DFL
);

204 #ifdeà
SIGBUS


205 
	`sigÇl
(
SIGBUS
, 
SIG_DFL
);

207 #ifdeà
SIGSTKFLT


208 
	`sigÇl
(
SIGSTKFLT
, 
SIG_DFL
);

211 
	}
}

220 
	g‹¡_driv”
::
‹¡_»suÉ


221 
‹¡_driv”
::
	$ruÁe¡
(cÚ¡ 
‹¡_desc
 *
‹¡
)

223 #ifdeà
HAVE_VALGRIND


225 vŞ©
runcouÁ
 = 0;

228 
Œue
) {

229 
tout
.
	`¡r
(
	`¡ršg
());

230 
SigÇlRedœeùÜ
 
sig
;

231 ià(!
	`£tjmp
(
jb
)) {

232 
boŞ
 
ÿtch_sigÇls
 =

233 (
	`g‘’v
("XAPIAN_TESTSUITE_SIG_DFL"è=ğ
NULL
);

234 ià(
ÿtch_sigÇls
è
sig
.
	`aùiv©e
();

235 
Œy
 {

236 
ex³ùed_exû±iÚ
 = 
NULL
;

237 #ifdeà
HAVE_VALGRIND


238 
vg_”rs
 = 0;

239 
vg_Ëaks
 = 0, 
vg_dubious
 = 0, 
vg_»achabË
 = 0;

240 ià(
vg_log_fd
 != -1) {

241 
VALGRIND_DO_LEAK_CHECK
;

242 
vg_”rs
 = 
VALGRIND_COUNT_ERRORS
;

243 
dummy
;

244 
	`VALGRIND_COUNT_LEAKS
(
vg_Ëaks
, 
vg_dubious
, 
vg_»achabË
, 
dummy
);

246 
	`l£ek
(
vg_log_fd
, 0, 
SEEK_END
);

249 ià(!
‹¡
->
	`run
()) {

250 
out
 << 
cŞ_»d
 << " FAILED" << 
cŞ_»£t
;

251 
	`wr™e_ªd_ş—r_tout
();

252  
FAIL
;

254 #ifdeà
HAVE_VALGRIND


255 ià(
vg_log_fd
 != -1) {

260 
tout
.
	`¡r
(
	`¡ršg
());

261 
	#REPORT_FAIL_VG
(
M
) do { \

262 ià(
v”bo£
) { \

263 
Œue
) { \

264 
ssize_t
 
c
 = 
	`»ad
(
vg_log_fd
, 
buf
, (buf)); \

265 ià(
c
 =ğ0 || (ø< 0 && 
”ºo
 !ğ
EINTR
)) ; \

266 ià(
c
 > 0è
out
 << 
	`¡ršg
(
buf
, c); \

269 
out
 << " " << 
cŞ_»d
 << 
M
 << 
cŞ_»£t
; \

270 } 0)

	)

273 
off_t
 
cu½os
 = 
	`l£ek
(
vg_log_fd
, 0, 
SEEK_CUR
);

274 
buf
[1024];

275 
Œue
) {

276 
ssize_t
 
c
 = 
	`»ad
(
vg_log_fd
, 
buf
, (buf));

277 ià(
c
 =ğ0 || (ø< 0 && 
”ºo
 !ğ
EINTR
)) {

278 
buf
[0] = 0;

281 ià(
c
 > 0) {

285 
ssize_t
 
i
 = 0;

287 cÚ¡ * 
¥c
;

288 
¥c
 = 
¡©ic_ÿ¡
<const *>(

289 
	`memchr
(
buf
 + 
i
, ' ', 
c
 - i));

290 ià(!
¥c
) {

291 
i
 = 
c
;

294 
i
 = 
¥c
 - 
buf
;

295 } ++
i
 < 
c
 && 
buf
[i] == '\n');

297 *
¡¬t
 = 
buf
 + 
i
;

298 
c
 -ğ
i
;

299 ià(
c
 > 128) c = 128;

302 cÚ¡ *
p
;

303 
p
 = 
¡©ic_ÿ¡
<const *>(

304 
	`memchr
(
¡¬t
, '\n', 
c
));

305 ià(
p
 !ğ
NULL
è
c
 =… - 
¡¬t
;

308 
	`memmove
(
buf
, 
¡¬t
, 
c
);

309 
buf
[
c
] = '\0';

313 
	`l£ek
(
vg_log_fd
, 
cu½os
, 
SEEK_SET
);

315 
vg_”rs2
 = 
VALGRIND_COUNT_ERRORS
;

316 
vg_”rs
 = 
vg_”rs2
 - vg_errs;

317 
VALGRIND_DO_LEAK_CHECK
;

318 
vg_Ëaks2
 = 0, 
vg_dubious2
 = 0, 
vg_»achabË2
 = 0;

319 
dummy
;

320 
	`VALGRIND_COUNT_LEAKS
(
vg_Ëaks2
, 
vg_dubious2
, 
vg_»achabË2
,

321 
dummy
);

322 
vg_Ëaks
 = 
vg_Ëaks2
 - vg_leaks;

323 
vg_dubious
 = 
vg_dubious2
 - vg_dubious;

324 
vg_»achabË
 = 
vg_»achabË2
 - vg_reachable;

325 ià(
vg_”rs
) {

326 
¡ršg
 
	`ç_msg
(
buf
);

327 ià(
ç_msg
.
	`em±y
())

328 
ç_msg
 = "VALGRIND DETECTED A PROBLEM";

329 
	`REPORT_FAIL_VG
(
ç_msg
);

330  
FAIL
;

332 ià(
vg_Ëaks
 > 0) {

333 
	`REPORT_FAIL_VG
("LEAKED " << 
vg_Ëaks
 << " BYTES");

334  
FAIL
;

336 ià(
vg_dubious
 > 0) {

341 ià(
runcouÁ
 == 0) {

342 
out
 << 
cŞ_y–low
 << " PROBABLY LEAKED MEMORY - RETRYING TEST" << 
cŞ_»£t
;

343 ++
runcouÁ
;

346 
	`REPORT_FAIL_VG
("PROBABLY LEAKED " << 
vg_dubious
 << " BYTES");

347  
FAIL
;

349 ià(
vg_»achabË
 > 0) {

362 ià(
runcouÁ
 == 0) {

363 
out
 << 
cŞ_y–low
 << " POSSIBLE UNRELEASED MEMORY - RETRYING TEST" << 
cŞ_»£t
;

364 ++
runcouÁ
;

367 
	`REPORT_FAIL_VG
("FAILED TO RELEASE " << 
vg_»achabË
 << " BYTES");

368  
FAIL
;

372 } 
	`ÿtch
 (cÚ¡ 
Te¡Fa
 &) {

373 
out
 << 
cŞ_»d
 << " FAILED" << 
cŞ_»£t
;

374 
	`wr™e_ªd_ş—r_tout
();

375  
FAIL
;

376 } 
	`ÿtch
 (cÚ¡ 
Te¡Sk
 &) {

377 
out
 << 
cŞ_y–low
 << " SKIPPED" << 
cŞ_»£t
;

378 
	`wr™e_ªd_ş—r_tout
();

379  
SKIP
;

380 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
”r
) {

381 
¡ršg
 
”rşass
 = 
”r
.
	`g‘_ty³
();

382 ià(
ex³ùed_exû±iÚ
 &&ƒx³ùed_exû±iÚ =ğ
”rşass
) {

383 
out
 << 
cŞ_y–low
 << " C++ FAILED TO CATCH " << 
”rşass
 << 
cŞ_»£t
;

384  
SKIP
;

386 
out
 << " " << 
cŞ_»d
 << 
”r
.
	`g‘_desütiÚ
(è<< 
cŞ_»£t
;

387 
	`wr™e_ªd_ş—r_tout
();

388  
FAIL
;

389 } 
	`ÿtch
 (cÚ¡ 
¡ršg
 & 
msg
) {

390 
out
 << 
cŞ_»d
 << " EXCEPTION std::¡ršg " << 
msg
 << 
cŞ_»£t
;

391 
	`wr™e_ªd_ş—r_tout
();

392  
FAIL
;

393 } 
	`ÿtch
 (cÚ¡ 
¡d
::
exû±iÚ
 & 
e
) {

394 
out
 << " " << 
cŞ_»d
;

395 #iâdeà
USE_RTTI


396 
out
 << "std::exception";

398 cÚ¡ * 
Çme
 = 
	`ty³id
(
e
).
	`Çme
();

399 #ifdeà
__GNUC__


402 
¡©us
;

403 * 
»®Çme
 = 
abi
::
	`__cxa_demªgË
(
Çme
, 
NULL
, 0, &
¡©us
);

404 ià(
»®Çme
) {

405 
out
 << 
»®Çme
;

406 
	`ä“
(
»®Çme
);

408 
out
 << 
Çme
;

411 
out
 << 
Çme
;

414 
out
 << ": " << 
e
.
	`wh©
(è<< 
cŞ_»£t
;

415 
	`wr™e_ªd_ş—r_tout
();

416  
FAIL
;

417 } 
	`ÿtch
 (...) {

418 
out
 << 
cŞ_»d
 << " UNKNOWN EXCEPTION" << 
cŞ_»£t
;

419 
	`wr™e_ªd_ş—r_tout
();

420  
FAIL
;

422  
PASS
;

426 cÚ¡ *
sigÇme
 = "SIGNAL";

427 
signum
) {

428 
SIGSEGV
: 
sigÇme
 = "SIGSEGV"; ;

429 
SIGFPE
: 
sigÇme
 = "SIGFPE"; ;

430 
SIGILL
: 
sigÇme
 = "SIGILL"; ;

431 #ifdeà
SIGBUS


432 
SIGBUS
: 
sigÇme
 = "SIGBUS"; ;

434 #ifdeà
SIGSTKFLT


435 
SIGSTKFLT
: 
sigÇme
 = "SIGSTKFLT"; ;

438 
out
 << " " << 
cŞ_»d
 << 
sigÇme
 << 
cŞ_»£t
;

439 
	`wr™e_ªd_ş—r_tout
();

440  
FAIL
;

442 
	}
}

444 
	g‹¡_driv”
::
»suÉ


445 
‹¡_driv”
::
run_‹¡s
(
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

446 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
e
)

448  
do_run_‹¡s
(
b
, 
e
);

451 
	g‹¡_driv”
::
»suÉ


452 
‹¡_driv”
::
	$run_‹¡s
()

454 cÚ¡ 
veùÜ
<
¡ršg
> 
bÏnk
;

455  
	`do_run_‹¡s
(
bÏnk
.
	`begš
(), bÏnk.
	`’d
());

456 
	}
}

458 
	g‹¡_driv”
::
»suÉ


459 
‹¡_driv”
::
do_run_‹¡s
(
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

460 
veùÜ
<
¡ršg
>::
cÚ¡_™”©Ü
 
e
)

462 
£t
<
¡ršg
> 
m
(
b
, 
e
);

463 
boŞ
 
	gcheck_Çme
 = !
m
.
em±y
();

465 
	g‹¡_driv”
::
»suÉ
 
»s
;

467 cÚ¡ 
‹¡_desc
 *
	g‹¡
 = 
‹¡s
;e¡->
	gÇme
;est++) {

468 
boŞ
 
	gdo_this_‹¡
 = !
check_Çme
;

469 ià(!
	gdo_this_‹¡
 && 
	gm
.
fšd
(
‹¡
->
Çme
è!ğ
m
.
’d
())

470 
do_this_‹¡
 = 
Œue
;

471 ià(!
	gdo_this_‹¡
) {

474 
¡ršg
 
	gt
 = 
‹¡
->
Çme
;

475 
	g¡ršg
::
size_ty³
 
i
;

476 
	gi
 = 
t
.
fšd_Ï¡_nÙ_of
("0123456789") + 1;

477 ià(
	gi
 !ğ
¡ršg
::
Åos
) {

478 
t
.
»size
(
i
);

479 ià(
	gm
.
fšd
(
t
è!ğ
m
.
’d
()è
do_this_‹¡
 = 
Œue
;

482 ià(
	gdo_this_‹¡
) {

483 
	gout
 << "RuÂšge¡: " << 
	g‹¡
->
	gÇme
 << "...";

484 
	gout
.
æush
();

485 
	g‹¡_driv”
::
‹¡_»suÉ
 
‹¡_»s
 = 
ruÁe¡
(
‹¡
);

486 ià(
	gback’dmªag”
)

487 
	gback’dmªag”
->
ş—n_up
();

488 
	g‹¡_»s
) {

489 
	gPASS
:

490 ++
»s
.
sucûeded
;

491 ià(
	gv”bo£
 || !
	gu£_ü
) {

492 
	gout
 << 
	gcŞ_g»’
 << " ok" << 
	gcŞ_»£t
 << 
	g’dl
;

494 
	gout
 << "\r \r";

497 
	gFAIL
:

498 ++
»s
.
çed
;

499 
	gout
 << 
	g’dl
;

500 ià(
	gabÜt_Ú_”rÜ
) {

501 
	gout
 << "Te¡ faed -‡bÜtšg fu¹h”e¡s." << 
	g’dl
;

502  
	g»s
;

505 
	gSKIP
:

506 ++
»s
.
sk³d
;

507 
	gout
 << 
	g’dl
;

513  
	g»s
;

517 
	g‹¡_driv”
::
	$u§ge
()

519 
cout
 << "U§ge: " << 
¬gv0
 << " [-v|--v”bo£] [-o|--abÜt-Ú-”rÜ] " << 
İt_h–p


520 << "[TESTNAME]..." << 
’dl
;

521 
cout
 << " " << 
¬gv0
 << " [-h|--h–p]" << 
’dl
;

522 
	`ex™
(1);

523 
	}
}

529 
»pÜt_tÙ®s
()

531 
‹¡_driv”
::
»pÜt
Ñe¡_driv”::
tÙ®
, "total");

536 
‹¡_driv”
::
»pÜt
(cÚ¡e¡_driv”::
»suÉ
 &
r
, cÚ¡ 
¡ršg
 &
desc
)

539 ià(++
runs
 =ğ2è
©ex™
(
»pÜt_tÙ®s
);

541 ià(
r
.
sucûeded
 !ğ0 ||„.
çed
 != 0) {

542 
cout
 << 
¬gv0
 << " " << 
desc
 << ": ";

544 ià(
r
.
çed
 == 0)

545 
cout
 << "All ";

547 
cout
 << 
cŞ_g»’
 << 
r
.
sucûeded
 << 
cŞ_»£t
 << "ests…assed";

549 ià(
r
.
çed
 != 0)

550 
cout
 << ", " << 
cŞ_»d
 << 
r
.
çed
 << 
cŞ_»£t
 << " failed";

552 ià(
r
.
sk³d
) {

553 
cout
 << ", " << 
cŞ_y–low
 << 
r
.
sk³d
 << 
cŞ_»£t


554 << " sk³d." << 
’dl
;

556 
cout
 << "." << 
’dl
;

562 
‹¡_driv”
::
	$add_commªd_lše_İtiÚ
(cÚ¡ 
¡ršg
 &
l
, 
s
, sŒšg * 
¬g
)

564 
shÜt_İts
.
	`š£¹
(
make_·œ
<, 
¡ršg
 *>((
s
), 
¬g
));

565 
İt_h–p
 += "[-";

566 
İt_h–p
 +ğ
s
;

567 
İt_h–p
 += ' ';

568 
İt_h–p
 +ğ
l
;

569 
İt_h–p
 += "] ";

570 
	}
}

573 
‹¡_driv”
::
	$·r£_commªd_lše
(
¬gc
, **
¬gv
)

575 
¬gv0
 = 
¬gv
[0];

577 #iâdeà
__WIN32__


578 
boŞ
 
cŞouri£
 = 
Œue
;

579 cÚ¡ *
p
 = 
	`g‘’v
("XAPIAN_TESTSUITE_OUTPUT");

580 ià(
p
 =ğ
NULL
 || !*°|| 
	`¡rcmp
(p, "auto") == 0) {

581 
cŞouri£
 = 
	`i§‰y
(1);

582 } ià(
	`¡rcmp
(
p
, "plain") == 0) {

583 
cŞouri£
 = 
çl£
;

585 ià(
cŞouri£
) {

586 
cŞ_»d
 = "\x1b[1m\x1b[31m";

587 
cŞ_g»’
 = "\x1b[1m\x1b[32m";

588 
cŞ_y–low
 = "\x1b[1m\x1b[33m";

589 
cŞ_»£t
 = "\x1b[0m";

590 
u£_ü
 = 
Œue
;

594 cÚ¡ 
İtiÚ
 
lÚg_İts
[] = {

595 {"v”bo£", 
no_¬gum’t
, 0, 'v'},

596 {"abÜt-Ú-”rÜ", 
no_¬gum’t
, 0, 'o'},

597 {"h–p", 
no_¬gum’t
, 0, 'h'},

598 {
NULL
, 0, 0, 0}

601 
¡ršg
 
shÜt_İts_¡ršg
 = "voh";

602 
m­
<, 
¡ršg
 *>::
cÚ¡_™”©Ü
 
i
;

603 
i
 = 
shÜt_İts
.
	`begš
(); i !ğshÜt_İts.
	`’d
(); ++i) {

604 
shÜt_İts_¡ršg
 +ğ(
i
->
fœ¡
);

605 
shÜt_İts_¡ršg
 += ':';

607 cÚ¡ * 
İts
 = 
shÜt_İts_¡ršg
.
	`c_¡r
();

609 
c
;

610 (
c
 = 
	`gnu_g‘İt_lÚg
(
¬gc
, 
¬gv
, 
İts
, 
lÚg_İts
, 0)) != -1) {

611 
c
) {

613 
v”bo£
 = 
Œue
;

616 
abÜt_Ú_”rÜ
 = 
Œue
;

619 
i
 = 
shÜt_İts
.
	`fšd
(
c
);

620 ià(
i
 !ğ
shÜt_İts
.
	`’d
()) {

621 
i
->
£cÚd
->
	`assign
(
İrg
);

625 
	`u§ge
();

631 
¬gv
[
İtšd
]) {

632 
‹¡_Çmes
.
	`push_back
(
	`¡ršg
(
¬gv
[
İtšd
]));

633 
İtšd
++;

636 #ifdeà
HAVE_VALGRIND


637 ià(
RUNNING_ON_VALGRIND
) {

638 ià(
	`g‘’v
("XAPIAN_TESTSUITE_VALGRIND"è!ğ
NULL
) {

640 
âame
[64];

641 
	`¥rštf
(
âame
, ".v®gršd.log.%lu", ()
	`g‘pid
());

642 
vg_log_fd
 = 
	`İ’
(
âame
, 
O_RDONLY
|
O_NONBLOCK
);

643 ià(
vg_log_fd
 =ğ-1 && 
”ºo
 =ğ
ENOENT
) {

645 
	`¥rštf
(
âame
, ".v®gršd.log.pid%lu", ()
	`g‘pid
());

646 
vg_log_fd
 = 
	`İ’
(
âame
, 
O_RDONLY
|
O_NONBLOCK
);

648 ià(
vg_log_fd
 !ğ-1è
	`uÆšk
(
âame
);

652 
	}
}

655 
‹¡_driv”
::
	$run
(cÚ¡ 
‹¡_desc
 *
‹¡s
)

657 
‹¡_driv”
 
	`driv”
(
‹¡s
);

659 
‹¡_driv”
::
»suÉ
 
my»suÉ
;

660 
my»suÉ
 = 
driv”
.
	`run_‹¡s
(
‹¡_Çmes
.
	`begš
(),e¡_Çmes.
	`’d
());

662 
subtÙ®
 +ğ
my»suÉ
;

664  
	`boŞ
(
my»suÉ
.
çed
);

665 
	}
}

667 
boŞ


668 
	$TEST_EQUAL_DOUBLE_
(
a
, 
b
)

670 ià(
a
 =ğ
b
è 
Œue
;

671  (
	`û
(
	`log10
(
	`max
(
	`çbs
(
a
), fabs(
b
)))è-†og10(çbs× - b)è> 
DBL_DIG
);

672 
	}
}

	@tests/harness/testsuite.h

22 #iâdeà
OM_HGUARD_TESTSUITE_H


23 
	#OM_HGUARD_TESTSUITE_H


	)

25 
	~"nÜ‘uº.h
"

27 
	~"ouut.h
"

29 
	~"¡ršguts.h
"

31 
	~<iomª
>

32 
	~<m­
>

33 
	~<s¡»am
>

34 
	~<¡ršg
>

35 
	~<veùÜ
>

37 
	~<cæßt
>

41 şas 
	cTe¡Fa
 { };

48 şas 
	cTe¡Sk
 { };

53 
	#FAIL_TEST
(
a
èdØ{ 
Te¡Fa
 
‹¡ç
; \

54 ià(
v”bo£
è{ 
tout
 << 
a
 << '\n'; } \

55 
throw
 
‹¡ç
; } 0)

	)

60 
	#SKIP_TEST
(
a
èdØ{ 
Te¡Sk
 
‹¡sk
; \

61 ià(
v”bo£
è{ 
tout
 << 
a
 << '\n'; } \

62 
throw
 
‹¡sk
; } 0)

	)

65 
boŞ
 (*
	t‹¡_func
)();

68 
	s‹¡_desc
 {

70 cÚ¡ *
	mÇme
;

73 
‹¡_func
 
	mrun
;

81 
boŞ
 
v”bo£
;

86 cÚ¡ * 
ex³ùed_exû±iÚ
;

91 
¡d
::
o¡ršg¡»am
 
tout
;

94 şas 
	c‹¡_driv”
 {

96 
wr™e_ªd_ş—r_tout
();

98 
	mpublic
:

102 
	s»suÉ
 {

104 
sucûeded
;

107 
	mçed
;

110 
	msk³d
;

112 
»suÉ
(è: 
sucûeded
(0), 
çed
(0), 
sk³d
(0) { }

114 
	m»suÉ
 & 
	mİ”©Ü
+=(cÚ¡ 
»suÉ
 & 
o
) {

115 
sucûeded
 +ğ
o
.succeeded;

116 
	mçed
 +ğ
o
.
çed
;

117 
	msk³d
 +ğ
o
.
sk³d
;

118  *
	mthis
;

121 
»£t
() {

122 
	msucûeded
 = 0;

123 
	mçed
 = 0;

124 
	msk³d
 = 0;

136 
add_commªd_lše_İtiÚ
(cÚ¡ 
¡d
::
¡ršg
 &
l
, 
s
,

137 
¡d
::
¡ršg
 * 
¬g
);

144 
·r£_commªd_lše
(
¬gc
, **
¬gv
);

146 
XAPIAN_NORETURN
(
u§ge
());

148 
run
(cÚ¡ 
‹¡_desc
 *
‹¡s
);

154 
‹¡_driv”
(cÚ¡ 
‹¡_desc
 *
‹¡s_
);

158 
»suÉ
 
run_‹¡s
();

162 
»suÉ
 
run_‹¡s
(
¡d
::
veùÜ
<¡d::
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

163 
¡d
::
veùÜ
<¡d::
¡ršg
>::
cÚ¡_™”©Ü
 
e
);

168 
	g¡d
::
¡ršg
 
g‘_¤cdœ
();

171 
»suÉ
 
	gsubtÙ®
;

174 
»suÉ
 
	gtÙ®
;

177 
»pÜt
(cÚ¡ 
‹¡_driv”
::
»suÉ
 &
r
, cÚ¡ 
¡d
::
¡ršg
 &
desc
);

179 
	g´iv©e
:

181 
‹¡_driv”
(constest_driver &);

182 
	g‹¡_driv”
 & 
	gİ”©Ü
 = (cÚ¡ 
‹¡_driv”
 &);

184 ’um { 
	gPASS
 = 1, 
	gFAIL
 = 0, 
	gSKIP
 = -1 } 
	t‹¡_»suÉ
;

186 
	g¡d
::
m­
<, std::
¡ršg
 *> 
shÜt_İts
;

188 
	g¡d
::
¡ršg
 
İt_h–p
;

190 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
‹¡_Çmes
;

198 
‹¡_»suÉ
 
ruÁe¡
(cÚ¡ 
‹¡_desc
 *
‹¡
);

207 
»suÉ
 
do_run_‹¡s
(
¡d
::
veùÜ
<¡d::
¡ršg
>::
cÚ¡_™”©Ü
 
b
,

208 
¡d
::
veùÜ
<¡d::
¡ršg
>::
cÚ¡_™”©Ü
 
e
);

211 
boŞ
 
	gabÜt_Ú_”rÜ
;

214 
	g¡d
::
o¡»am
 
out
;

217 cÚ¡ 
‹¡_desc
 *
	g‹¡s
;

220 
	gruns
;

223 
	g¡d
::
¡ršg
 
¬gv0
;

226 
	g¡d
::
¡ršg
 
cŞ_»d
, 
	gcŞ_g»’
, 
	gcŞ_y–low
, 
	gcŞ_»£t
;

230 
boŞ
 
	gu£_ü
;

234 
	#TESTCASE_LOCN
(
a
è
__FILE__
":"
	`STRINGIZE
(
__LINE__
)": "STRINGIZE×)

	)

240 
	#TEST_AND_EXPLAIN
(
a
, 
b
) do {\

241 ià(!(
a
)è
	`FAIL_TEST
(
	`TESTCASE_LOCN
×è<< 
¡d
::
’dl
 << 
b
 << std::endl);\

242 } 0)

	)

245 
	#TEST
(
a
è
	`TEST_AND_EXPLAIN
×, "")

	)

248 
	#TEST_EQUAL
(
a
, 
b
è
	`TEST_AND_EXPLAIN
(((a) == (b)), \

249 "Ex³ùed `"
	`STRINGIZE
(
a
)"'‡nd `"STRINGIZE(
b
)"'o beƒqual:" \

250 " w”" << (
a
è<< "‡nd " << (
b
))

	)

257 
	#TEST_STRINGS_EQUAL
(
a
, 
b
è
	`TEST_AND_EXPLAIN
(((a) == (b)), \

258 "Ex³ùed "
	`STRINGIZE
(
a
)"‡nd "STRINGIZE(
b
)"o beƒqual, were:\n\"" \

259 << (
a
è<< "\"\n\"" << (
b
è<< '"')

	)

262 
boŞ
 
TEST_EQUAL_DOUBLE_
(
a
, 
b
);

265 
	#TEST_EQUAL_DOUBLE
(
a
, 
b
è
	`TEST_AND_EXPLAIN
(
	`TEST_EQUAL_DOUBLE_
((a), (b)), \

266 "Ex³ùed `"
	`STRINGIZE
(
a
)"'‡nd `"STRINGIZE(
b
)"'o be (nearly)ƒqual:" \

267 " w”" << 
	`£»cisiÚ
(
DBL_DIG
è<< (
a
è<< "‡nd " << (
b
è<< ")" << s‘´ecisiÚ(6))

	)

270 
	#TEST_NOT_EQUAL_DOUBLE
(
a
, 
b
è
	`TEST_AND_EXPLAIN
(!
	`TEST_EQUAL_DOUBLE_
((a), (b)), \

271 "Ex³ùed `"
	`STRINGIZE
(
a
)"'‡nd `"STRINGIZE(
b
)"'‚oto be (nearly)ƒqual:" \

272 " w”" << 
	`£»cisiÚ
(
DBL_DIG
è<< (
a
è<< "‡nd " << (
b
è<< ")" << s‘´ecisiÚ(6))

	)

275 
	#TEST_NOT_EQUAL
(
a
, 
b
è
	`TEST_AND_EXPLAIN
(((a) != (b)), \

276 "Ex³ùed `"
	`STRINGIZE
(
a
)"'‡nd `"STRINGIZE(
b
)"'‚oto beƒqual:" \

277 " w”" << (
a
è<< "‡nd " << (
b
))

	)

279 
	#DEFINE_TESTCASE
(
S
,
COND
è
boŞ
 
‹¡_
##
	`S
()

	)

282 
	~"‹¡maüos.h
"

	@tests/harness/testutils.cc

22 
	~<cÚfig.h
>

24 
	~"‹¡uts.h
"

26 
	~"‹¡su™e.h
"

28 
	~<f¡»am
>

29 
	~<veùÜ
>

31 
usšg
 
Çme¥aû
 
	g¡d
;

33 
	go¡»am
 &

34 
	gİ”©Ü
<<(
	go¡»am
 &
	gos
, cÚ¡ 
	gveùÜ
<> &
	gšts
)

36 
cİy
(
šts
.
begš
(), iÁs.
’d
(),

37 
o¡»am_™”©Ü
<>(
os
, ", "));

38  
	gos
;

44 
boŞ


45 
m£t_¿nge_is_§me
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t1
, 
fœ¡1
,

46 cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t2
, 
fœ¡2
,

47 
couÁ
)

49 
TEST_AND_EXPLAIN
(
m£t1
.
size
(è>ğ
fœ¡1
 + 
couÁ
 - 1,

51 (
fœ¡1
 + 
couÁ
 - 1) << " items, got " <<

52 
m£t1
.
size
() << ".");

54 
TEST_AND_EXPLAIN
(
m£t2
.
size
(è>ğ
fœ¡2
 + 
couÁ
 - 1,

56 (
fœ¡2
 + 
couÁ
 - 1) << " items, got " <<

57 
m£t2
.
size
() << ".");

59 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t1
[
fœ¡1
];

60 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
m£t2
[
fœ¡2
];

62 
	gl
 = 0;† < 
	gcouÁ
; ++l) {

63 ià(*
	gi
 !ğ*
j
) {

64 
tout
 << "docid difã¸© i‹m " << (
l
 + 1) << " in„ange: "

65 << *
i
 << " !ğ" << *
j
 << "\n";

66  
	gçl£
;

69 ià(!
TEST_EQUAL_DOUBLE_
(
i
.
g‘_weight
(), 
j
.get_weight())) {

70 
	gtout
 << "weight difã¸© i‹m " << (
	gl
 + 1) << " in„ange: "

71 << 
	gi
.
g‘_weight
(è<< " !ğ" << 
	gj
.get_weight() << "\n";

72  
	gçl£
;

74 ++
	gi
;

75 ++
	gj
;

77  
	gŒue
;

80 
boŞ


81 
m£t_¿nge_is_§me_weights
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t1
, 
fœ¡1
,

82 cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t2
, 
fœ¡2
,

83 
couÁ
)

85 
TEST_AND_EXPLAIN
(
m£t1
.
size
(è>ğ
fœ¡1
 + 
couÁ
 - 1,

87 (
fœ¡1
 + 
couÁ
 - 1) << " items, got " <<

88 
m£t1
.
size
() << ".");

90 
TEST_AND_EXPLAIN
(
m£t2
.
size
(è>ğ
fœ¡2
 + 
couÁ
 - 1,

92 (
fœ¡2
 + 
couÁ
 - 1) << " items, got " <<

93 
m£t2
.
size
() << ".");

95 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t1
[
fœ¡1
];

96 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
m£t2
[
fœ¡2
];

98 
	gl
 = 0;† < 
	gcouÁ
; ++l) {

100 ià(!
TEST_EQUAL_DOUBLE_
(
i
.
g‘_weight
(), 
j
.get_weight())) {

101 
	gtout
 << "weight difã¸© i‹m " << (
	gl
 + 1) << " in„ange: "

102 << 
	gi
.
g‘_weight
(è<< " !ğ" << 
	gj
.get_weight() << "\n";

103  
	gçl£
;

105 ++
	gi
;

106 ++
	gj
;

108  
	gŒue
;

111 
boŞ


112 
m£t_¿nge_is_§me_³rûÁs
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t1
, 
fœ¡1
,

113 cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t2
, 
fœ¡2
,

114 
couÁ
)

116 
TEST_AND_EXPLAIN
(
m£t1
.
size
(è>ğ
fœ¡1
 + 
couÁ
 - 1,

118 (
fœ¡1
 + 
couÁ
 - 1) << " items, got " <<

119 
m£t1
.
size
() << ".");

121 
TEST_AND_EXPLAIN
(
m£t2
.
size
(è>ğ
fœ¡2
 + 
couÁ
 - 1,

123 (
fœ¡2
 + 
couÁ
 - 1) << " items, got " <<

124 
m£t2
.
size
() << ".");

126 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t1
[
fœ¡1
];

127 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
m£t2
[
fœ¡2
];

129 
	gl
 = 0;† < 
	gcouÁ
; ++l) {

130 ià(
	gi
.
g‘_³rûÁ
(è!ğ
j
.get_percent()) {

131 
tout
 << 
i
.
g‘_³rûÁ
(è<< "% !ğ" << 
j
.get_percent() << "%\n";

132  
	gçl£
;

134 ++
	gi
;

135 ++
	gj
;

137  
	gŒue
;

140 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
X­Ÿn
::
MS‘
 &
fœ¡
, cÚ¡ 
	gX­Ÿn
::MS‘ &
£cÚd
)

142 ià((
fœ¡
.
g‘_m©ches_low”_bound
(è!ğ
£cÚd
.get_matches_lower_bound()) ||

143 (
fœ¡
.
g‘_m©ches_uµ”_bound
(è!ğ
£cÚd
.get_matches_upper_bound()) ||

144 (
fœ¡
.
g‘_m©ches_e¡im©ed
(è!ğ
£cÚd
.get_matches_estimated()) ||

145 (
fœ¡
.
g‘_max_possibË
(è!ğ
£cÚd
.get_max_possible()) ||

146 (
fœ¡
.
size
(è!ğ
£cÚd
.size())) {

147  
çl£
;

149 ià(
	gfœ¡
.
em±y
()è 
	gŒue
;

150  
m£t_¿nge_is_§me
(
fœ¡
, 0, 
£cÚd
, 0, fœ¡.
size
());

154 
m£t_ex³ù_Üd”_
(cÚ¡ 
X­Ÿn
::
MS‘
 &
A
, 
boŞ
 
begšnšg
,

155 
X­Ÿn
::
docid
 
d1
, X­Ÿn::docid 
d2
, X­Ÿn::docid 
d3
, X­Ÿn::docid 
d4
,

156 
X­Ÿn
::
docid
 
d5
, X­Ÿn::docid 
d6
, X­Ÿn::docid 
d7
, X­Ÿn::docid 
d8
,

157 
X­Ÿn
::
docid
 
d9
, X­Ÿn::docid 
d10
, X­Ÿn::docid 
d11
, X­Ÿn::docid 
d12
)

159 
veùÜ
<
X­Ÿn
::
docid
> 
ex³ù
;

160 ià(
	gd1
) {

161 
	gex³ù
.
push_back
(
d1
);

162 ià(
	gd2
) {

163 
	gex³ù
.
push_back
(
d2
);

164 ià(
	gd3
) {

165 
	gex³ù
.
push_back
(
d3
);

166 ià(
	gd4
) {

167 
	gex³ù
.
push_back
(
d4
);

168 ià(
	gd5
) {

169 
	gex³ù
.
push_back
(
d5
);

170 ià(
	gd6
) {

171 
	gex³ù
.
push_back
(
d6
);

172 ià(
	gd7
) {

173 
	gex³ù
.
push_back
(
d7
);

174 ià(
	gd8
) {

175 
	gex³ù
.
push_back
(
d8
);

176 ià(
	gd9
) {

177 
	gex³ù
.
push_back
(
d9
);

178 ià(
	gd10
) {

179 
	gex³ù
.
push_back
(
d10
);

180 ià(
	gd11
) {

181 
	gex³ù
.
push_back
(
d11
);

182 ià(
	gd12
) {

183 
	gex³ù
.
push_back
(
d12
);

198 ià(
	gbegšnšg
) {

199 
TEST_AND_EXPLAIN
(
A
.
size
(è>ğ
ex³ù
.size(),

200 "M£ˆi oàwrÚg siz(" << 
A
.
size
()

201 << " < " << 
ex³ù
.
size
() << "):\n"

202 << "FuÎ m£ˆwas: " << 
A
 << 
’dl


203 << "Ex³ùed ord”Ø¡¬t: {" << 
ex³ù
 << "}");

205 
TEST_AND_EXPLAIN
(
A
.
size
(è=ğ
ex³ù
.size(),

206 "M£ˆi oàwrÚg siz(" << 
A
.
size
()

207 << " !ğ" << 
ex³ù
.
size
() << "):\n"

208 << "FuÎ m£ˆwas: " << 
A
 << 
’dl


209 << "Ex³ùed ord”: {" << 
ex³ù
 << "}");

212 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
A
.
begš
();

213 
size_t
 
	gi
 = 0; i < 
	gex³ù
.
size
(); i++, 
	gj
++) {

214 
TEST_AND_EXPLAIN
(*
j
 =ğ
ex³ù
[
i
],

216 << "I‹m " << 
i
 << " wa " << *
j


217 << ",ƒx³ùed " << 
ex³ù
[
i
] << 
’dl


218 << "FuÎ m£ˆwas: " << 
A
 << 
’dl


219 << "Ex³ùed: {" << 
ex³ù
 << "}");

224 
m£t_ex³ù_Üd”
(cÚ¡ 
X­Ÿn
::
MS‘
 &
A
,

225 
X­Ÿn
::
docid
 
d1
, X­Ÿn::docid 
d2
, X­Ÿn::docid 
d3
, X­Ÿn::docid 
d4
,

226 
X­Ÿn
::
docid
 
d5
, X­Ÿn::docid 
d6
, X­Ÿn::docid 
d7
, X­Ÿn::docid 
d8
,

227 
X­Ÿn
::
docid
 
d9
, X­Ÿn::docid 
d10
, X­Ÿn::docid 
d11
, X­Ÿn::docid 
d12
)

229 
m£t_ex³ù_Üd”_
(
A
, 
çl£
, 
d1
, 
d2
, 
d3
, 
d4
, 
d5
, 
d6
, 
d7
, 
d8
, 
d9
, 
d10
, 
d11
, 
d12
);

233 
‹¡_m£t_Üd”_equ®
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t1
, cÚ¡ X­Ÿn::MS‘ &
m£t2
)

235 
TEST_AND_EXPLAIN
(
m£t1
.
size
(è=ğ
m£t2
.size(),

237 << 
m£t1
.
size
(è<< " !ğ" << 
m£t2
.size());

238 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
i
 = 
m£t1
.
begš
();

239 
	gX­Ÿn
::
MS‘I‹¿tÜ
 
j
 = 
m£t2
.
begš
();

240 ; 
	gi
 !ğ
m£t1
.
’d
(); i++, 
	gj
++) {

241 
TEST_AND_EXPLAIN
(*
i
 =ğ*
j
,

243 
m£t1
 << "\À!=\n" << 
m£t2
);

	@tests/harness/testutils.h

22 #iâdeà
OM_HGUARD_TESTUTILS_H


23 
	#OM_HGUARD_TESTUTILS_H


	)

25 
	~"‹¡su™e.h
"

26 
	~<x­Ÿn.h
>

31 
	g¡d
::
o¡»am
 &
İ”©Ü
<<(
¡d
::o¡»am &
os
,

32 cÚ¡ 
	g¡d
::
veùÜ
<> &
šts
);

38 
boŞ


39 
m£t_¿nge_is_§me
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t1
, 
fœ¡1
,

40 cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t2
, 
fœ¡2
,

41 
couÁ
);

44 
boŞ


45 
m£t_¿nge_is_§me_weights
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t1
, 
fœ¡1
,

46 cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t2
, 
fœ¡2
,

47 
couÁ
);

50 
boŞ


51 
m£t_¿nge_is_§me_³rûÁs
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t1
, 
fœ¡1
,

52 cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t2
, 
fœ¡2
,

53 
couÁ
);

55 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
X­Ÿn
::
MS‘
 &
fœ¡
, cÚ¡ 
	gX­Ÿn
::MS‘ &
£cÚd
);

57 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
X­Ÿn
::
MS‘
 &
fœ¡
, cÚ¡ 
	gX­Ÿn
::MS‘ &
£cÚd
)

59  !(
fœ¡
 =ğ
£cÚd
);

63 
m£t_ex³ù_Üd”
(cÚ¡ 
X­Ÿn
::
MS‘
 &
A
,

64 
X­Ÿn
::
docid
 
d1
 = 0, X­Ÿn::docid 
d2
 = 0,

65 
X­Ÿn
::
docid
 
d3
 = 0, X­Ÿn::docid 
d4
 = 0,

66 
X­Ÿn
::
docid
 
d5
 = 0, X­Ÿn::docid 
d6
 = 0,

67 
X­Ÿn
::
docid
 
d7
 = 0, X­Ÿn::docid 
d8
 = 0,

68 
X­Ÿn
::
docid
 
d9
 = 0, X­Ÿn::docid 
d10
 = 0,

69 
X­Ÿn
::
docid
 
d11
 = 0, X­Ÿn::docid 
d12
 = 0);

71 
‹¡_m£t_Üd”_equ®
(cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t1
,

72 cÚ¡ 
X­Ÿn
::
MS‘
 &
m£t2
);

78 
	#TEST_MSET_SIZE
(
M
, 
S
è
	`TEST_AND_EXPLAIN
(((M).
	`size
() == (S)), \

79 "MS‘ `"
	`STRINGIZE
(
M
)"' is‚ot ofƒxpected size: was `" << \

80 (
M
).
	`size
(è<< "'ƒx³ùed `" << (
S
) << "':\n" << \

81 "FuÎ m£ˆwas:\n" << (
M
))

	)

84 
	#TEST_EXCEPTION
(
a
,
b
) do {\

85 
ex³ùed_exû±iÚ
 = 
	`STRINGIZE
(
a
);\

86 ià(
	`¡ºcmp
(
ex³ùed_exû±iÚ
, "Xapian::", 8) == 0)\

87 
ex³ùed_exû±iÚ
 += 8;\

88 ià(
v”bo£
)\

89 
tout
 << "Ex³ùšgƒxû±iÚ " << 
ex³ùed_exû±iÚ
 << 
’dl
;\

90 
Œy
 {
b
;
	`FAIL_TEST
(
	`TESTCASE_LOCN
(
Ex³ùed
 #a));}\

91 
	`ÿtch
 (cÚ¡ 
a
 &
e
) {\

92 ià(
v”bo£
)\

93 
tout
 << "Caughˆex³ùed " << 
ex³ùed_exû±iÚ
\

94 << "ƒxû±iÚ: " << 
e
.
	`g‘_desütiÚ
(è<< 
’dl
;\

96 
ex³ùed_exû±iÚ
 = 
NULL
;\

97 } 0)

	)

	@tests/harness/unixcmds.cc

21 
	~<cÚfig.h
>

23 
	~"unixcmds.h
"

25 
	~<c¡ršg
>

26 
	~<¡ršg
>

27 
	~<c¡dlib
>

28 
	~<sys/ty³s.h
>

29 
	~"§ãsys¡©.h
"

30 
	~"§ãuni¡d.h
"

31 
	~"§ãfú.h
"

33 #ifdeà
__WIN32__


34 
	~"§ãwšdows.h
"

37 
	~"¡ršguts.h
"

38 
	~"uts.h
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

43 
boŞ


44 
	$­³nd_f’ame_¬gum’t
(
¡ršg
 & 
cmd
, cÚ¡ sŒšg & 
¬g
) {

45 #ifdeà
__WIN32__


46 
cmd
.
	`»£rve
(cmd.
	`size
(è+ 
¬g
.size() + 3);

47 
cmd
 += " \"";

48 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
¬g
.
	`begš
(); i !ğ¬g.
	`’d
(); ++i) {

49 ià(*
i
 == '/') {

53 
cmd
 += '\\';

54 } ià(*
i
 < 32 || 
	`¡rchr
("<>\"|*?", *i)) {

56  
çl£
;

58 
cmd
 +ğ*
i
;

61 
cmd
 += '"';

64 
cmd
.
	`»£rve
(cmd.
	`size
(è+ 
¬g
.size() + 10);

68 ià(
¬g
[0] == '-')

69 
cmd
 += " ./";

71 
cmd
 += ' ';

73 
¡ršg
::
cÚ¡_™”©Ü
 
i
 = 
¬g
.
	`begš
(); i !ğ¬g.
	`’d
(); ++i) {

75 ià(!
	`C_i§Êum
(*
i
è&& 
	`¡rchr
("/._-", *iè=ğ
NULL
) {

76 
cmd
 += '\\';

78 
cmd
 +ğ*
i
;

81  
Œue
;

82 
	}
}

85 
ı_R
(cÚ¡ 
¡d
::
¡ršg
 &
¤c
, cÚ¡ std::¡ršg &
de¡
) {

86 #ifdeà
__WIN32__


91 
mkdœ
(
de¡
.
c_¡r
());

92 
¡ršg
 
cmd
("xcopy /E /Y");

94 
¡ršg
 
cmd
("cp -R");

96 ià(!
­³nd_f’ame_¬gum’t
(
cmd
, 
¤c
)) ;

97 ià(!
­³nd_f’ame_¬gum’t
(
cmd
, 
de¡
)) ;

98 
sy¡em
(
cmd
);

99 #iâdeà
__WIN32__


102 
	gcmd
 = "chmod -R +w";

103 ià(!
­³nd_f’ame_¬gum’t
(
cmd
, 
de¡
)) ;

104 
sy¡em
(
cmd
);

108 #ifdeà
__WIN32__


109 
boŞ
 
	$ruÂšg_Ú_wš9x
() {

110 
wš9x
 = -1;

111 ià(
wš9x
 == -1) {

112 
OSVERSIONINFO
 
šfo
;

113 
	`mem£t
(&
šfo
, 0, (
OSVERSIONINFO
));

114 
šfo
.
dwOSV”siÚInfoSize
 = (
OSVERSIONINFO
);

115 ià(
	`G‘V”siÚEx
(&
šfo
)) {

116 
wš9x
 = (
šfo
.
dwPÏtfÜmId
 =ğ
VER_PLATFORM_WIN32_WINDOWS
);

119  
wš9x
;

120 
	}
}

124 
	$rm_rf
(cÚ¡ 
¡ršg
 &
f’ame
) {

126 
¡©
 
sb
;

127 ià(
f’ame
.
	`em±y
(è|| 
	`¡©
(f’ame, &
sb
è!ğ0 || !
	`S_ISDIR
(sb.
¡_mode
))

130 #ifdeà
__WIN32__


131 
¡ršg
 
cmd
;

132 ià(
	`ruÂšg_Ú_wš9x
()) {

134 
cmd
 = "deltree /y";

137 
cmd
 = "rd /s /q";

140 
¡ršg
 
	`cmd
("rm -rf");

142 ià(!
	`­³nd_f’ame_¬gum’t
(
cmd
, 
f’ame
)) ;

143 
	`sy¡em
(
cmd
);

144 
	}
}

147 
	$touch
(cÚ¡ 
¡ršg
 &
f’ame
) {

148 
fd
 = 
	`İ’
(
f’ame
.
	`c_¡r
(), 
O_CREAT
|
O_WRONLY
|
O_BINARY
, 0644);

149 ià(
fd
 >ğ0è
	`şo£
(fd);

150 
	}
}

	@tests/harness/unixcmds.h

21 #iâdeà
XAPIAN_INCLUDED_UNIXCMDS_H


22 
	#XAPIAN_INCLUDED_UNIXCMDS_H


	)

24 
	~<¡ršg
>

27 
ı_R
(cÚ¡ 
¡d
::
¡ršg
 &
¤c
, cÚ¡ std::¡ršg &
de¡
);

30 
rm_rf
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame
);

33 
touch
(cÚ¡ 
¡d
::
¡ršg
 &
f’ame
);

	@tests/internaltest.cc

24 
	~<cÚfig.h
>

26 
	~<x­Ÿn.h
>

28 
	~<cæßt
>

29 
	~"§ã”ºo.h
"

31 
	~<¡ršg
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
	~"autİŒ.h
"

36 
	~"‹¡su™e.h
"

37 
	~"‹¡uts.h
"

39 
	~"omas£¹.h
"

40 
	~"omqu”yš‹º®.h
"

41 
	~"£rŸli£.h
"

42 
	~"£rŸli£-doubË.h
"

43 
	~"¡r.h
"

44 
	~"uts.h
"

45 
	~"·ck.h
"

47 
boŞ
 
	$‹¡_exû±1
()

49 
Œy
 {

50 
throw
 1;

51 } 
	`ÿtch
 () {

53  
Œue
;

54 
	}
}

56 şas 
	cTe¡_Exû±iÚ
 {

57 
	mpublic
:

58 
v®ue
;

59 
	$Te¡_Exû±iÚ
(
v®ue_
è: 
	$v®ue
(
v®ue_
) {}

60 
	}
};

63 
boŞ
 
	$‹¡_exû±iÚ1
()

65 
Œy
 {

66 
Œy
 {

67 
throw
 
	`Te¡_Exû±iÚ
(1);

68 } 
	`ÿtch
 (...) {

69 
Œy
 {

70 
throw
 
	`Te¡_Exû±iÚ
(2);

71 } 
	`ÿtch
 (...) {

73 
throw
;

75 } 
	`ÿtch
 (
Te¡_Exû±iÚ
 & 
e
) {

76 
	`TEST_EQUAL
(
e
.
v®ue
, 1);

77  
Œue
;

79  
çl£
;

80 
	}
}

86 şas 
	c‹¡_»fút
 : 
public
 
X­Ÿn
::
IÁ”Çl
::
RefCÁBa£
 {

87 
´iv©e
:

88 
boŞ
 &
d–‘ed
;

89 
	mpublic
:

90 
	$‹¡_»fút
(
boŞ
 &
d–‘ed_
è: 
	$d–‘ed
(
d–‘ed_
) {

91 
tout
 << "constructor\n";

93 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
‹¡_»fút
> 
	$‹¡
() {

94  
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<cÚ¡ 
‹¡_»fút
>(
this
);

95 
	}
}

96 ~
	$‹¡_»fút
() {

97 
d–‘ed
 = 
Œue
;

98 
tout
 << "destructor\n";

99 
	}
}

102 
boŞ
 
	$‹¡_»fút1
()

104 
boŞ
 
d–‘ed
 = 
çl£
;

106 
‹¡_»fút
 *
p
 = 
Ãw
 
	`‹¡_»fút
(
d–‘ed
);

108 
	`TEST_EQUAL
(
p
->
»f_couÁ
, 0);

111 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
‹¡_»fút
> 
	`rı
(
p
);

113 
	`TEST_EQUAL
(
rı
->
»f_couÁ
, 1);

116 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
‹¡_»fút
> 
rı2
;

117 
rı2
 = 
rı
;

118 
	`TEST_EQUAL
(
rı
->
»f_couÁ
, 2);

122 
	`TEST_AND_EXPLAIN
(!
d–‘ed
, "Object…rematurely deleted!");

123 
	`TEST_EQUAL
(
rı
->
»f_couÁ
, 1);

127 
	`TEST_AND_EXPLAIN
(
d–‘ed
, "Object‚ot…roperly deleted");

129  
Œue
;

130 
	}
}

134 
boŞ
 
	$‹¡_»fút2
()

136 
boŞ
 
d–‘ed
 = 
çl£
;

138 
‹¡_»fút
 *
p
 = 
Ãw
 
	`‹¡_»fút
(
d–‘ed
);

140 
X­Ÿn
::
IÁ”Çl
::
RefCÁPŒ
<
‹¡_»fút
> 
	`rı
(
p
);

142 
rı
 =„cp;

144 
	`TEST_AND_EXPLAIN
(!
d–‘ed
, "Object deleted by self-assignment");

146  
Œue
;

147 
	}
}

150 şas 
	c‹¡_autİŒ
 {

151 
	mboŞ
 &
	md–‘ed
;

152 
	mpublic
:

153 
	$‹¡_autİŒ
(
boŞ
 &
d–‘ed_
è: 
	$d–‘ed
(
d–‘ed_
) {

154 
tout
 << "test_autoptr constructor\n";

156 ~
	$‹¡_autİŒ
() {

157 
d–‘ed
 = 
Œue
;

158 
tout
 << "test_autoptr destructor\n";

159 
	}
}

163 
boŞ
 
	$‹¡_autİŒ1
()

165 
boŞ
 
d–‘ed
 = 
çl£
;

167 
‹¡_autİŒ
 * 
¿w_±r
 = 
Ãw
 
	`‹¡_autİŒ
(
d–‘ed
);

169 
AutoPŒ
<
‹¡_autİŒ
> 
	`±r
(
¿w_±r
);

171 
	`TEST_EQUAL
(
±r
.
	`g‘
(), 
¿w_±r
);

173 
	`TEST
(!
d–‘ed
);

175 
±r
 =…tr;

177 
	`TEST_EQUAL
(
±r
.
	`g‘
(), 
¿w_±r
);

179 
	`TEST
(!
d–‘ed
);

182 
	`TEST
(
d–‘ed
);

184  
Œue
;

185 
	}
}

188 
boŞ
 
	$‹¡_¡ršgcomp1
()

190 
boŞ
 
sucûss
 = 
Œue
;

192 
¡ršg
 
s1
;

193 
¡ršg
 
s2
;

195 
s1
 = "foo";

196 
s2
 = "foo";

198 ià((
s1
 !ğ
s2
) || (s1 > s2)) {

199 
sucûss
 = 
çl£
;

200 
tout
 << "SŒšg com·risÚ BADLY wrÚg" << 
’dl
;

203 
s1
 += '\0';

205 ià((
s1
 =ğ
s2
) || (s1 < s2)) {

206 
sucûss
 = 
çl£
;

207 
tout
 << "SŒšg com·risiÚ dÚ'ˆcİw™hƒxŒ¨nuÎs" << 
’dl
;

210 
s2
 += '\0';

212 
s1
 += 'a';

213 
s2
 += 'z';

215 ià((
s1
.
	`Ëngth
(è!ğ5è|| (
s2
.length() != 5)) {

216 
sucûss
 = 
çl£
;

217 
tout
 << "L’gth w™h‡dded‚uÎ wrÚg" << 
’dl
;

220 ià((
s1
 =ğ
s2
) || !(s1 < s2)) {

221 
sucûss
 = 
çl£
;

222 
tout
 << "Ch¬aù” aá”‡‚uÎ ignÜed iÀcom·risÚs" << 
’dl
;

225  
sucûss
;

226 
	}
}

228 
boŞ
 
	$‹¡_to¡ršg1
()

230 
	`TEST_EQUAL
(
	`om_to¡ršg
(0), "0");

231 
	`TEST_EQUAL
(
	`om_to¡ršg
(10), "10");

232 
	`TEST_EQUAL
(
	`om_to¡ršg
(10u), "10");

233 
	`TEST_EQUAL
(
	`om_to¡ršg
(-10), "-10");

234 
	`TEST_EQUAL
(
	`om_to¡ršg
(0xffffffff), "4294967295");

235 
	`TEST_EQUAL
(
	`om_to¡ršg
(0x7fffffff), "2147483647");

236 
	`TEST_EQUAL
(
	`om_to¡ršg
(0x7fffffffu), "2147483647");

237 
	`TEST_EQUAL
(
	`om_to¡ršg
(-0x7fffffff), "-2147483647");

239 #ifdeà
__WIN32__


243 
	`TEST_EQUAL
(
	`om_to¡ršg
(10ll), "10");

244 
	`TEST_EQUAL
(
	`om_to¡ršg
(-10ll), "-10");

245 
	`TEST_EQUAL
(
	`om_to¡ršg
(0x200000000ll), "8589934592");

251  
Œue
;

252 
	}
}

254 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


256 
boŞ
 
	$‹¡_£rŸli£Ëngth1
()

258 
size_t
 
n
 = 0;

259 
n
 < 0xff000000) {

260 
¡ršg
 
s
 = 
	`’code_Ëngth
(
n
);

261 cÚ¡ *
p
 = 
s
.
	`d©a
();

262 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

263 
size_t
 
decoded_n
 = 
	`decode_Ëngth
(&
p
, 
p_’d
, 
çl£
);

264 ià(
n
 !ğ
decoded_n
 || 
p
 !ğ
p_’d
è
tout
 << "[" << 
s
 << "]" << 
’dl
;

265 
	`TEST_EQUAL
(
n
, 
decoded_n
);

266 
	`TEST_EQUAL
(
p_’d
 - 
p
, 0);

267 ià(
n
 < 5000) {

268 ++
n
;

270 
n
 += 53643;

274  
Œue
;

275 
	}
}

278 
boŞ
 
	$‹¡_£rŸli£Ëngth2
()

282 
¡ršg
 
s
 = 
	`’code_Ëngth
(0);

284 cÚ¡ *
p
 = 
s
.
	`d©a
();

285 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

286 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
) == 0);

287 
	`TEST
(
p
 =ğ
p_’d
);

289 
s
 += 'x';

291 cÚ¡ *
p
 = 
s
.
	`d©a
();

292 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

293 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
) == 0);

294 
	`TEST_EQUAL
(
p_’d
 - 
p
, 1);

299 
¡ršg
 
s
 = 
	`’code_Ëngth
(1);

300 
	`TEST_EXCEPTION
(
X­Ÿn
::
N‘wÜkE¼Ü
,

301 cÚ¡ *
p
 = 
s
.
	`d©a
();

302 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

303 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
) == 1);

305 
s
 += 'x';

307 cÚ¡ *
p
 = 
s
.
	`d©a
();

308 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

309 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
) == 1);

310 
	`TEST_EQUAL
(
p_’d
 - 
p
, 1);

312 
s
 += 'x';

314 cÚ¡ *
p
 = 
s
.
	`d©a
();

315 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

316 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
) == 1);

317 
	`TEST_EQUAL
(
p_’d
 - 
p
, 2);

321 
size_t
 
n
 = 2;‚ < 1000;‚ = (n + 1) * 2 + (n >> 1)) {

322 
¡ršg
 
s
 = 
	`’code_Ëngth
(
n
);

323 
	`TEST_EXCEPTION
(
X­Ÿn
::
N‘wÜkE¼Ü
,

324 cÚ¡ *
p
 = 
s
.
	`d©a
();

325 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

326 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
è=ğ
n
);

328 
s
.
	`­³nd
(
n
-1, 'x');

329 
	`TEST_EXCEPTION
(
X­Ÿn
::
N‘wÜkE¼Ü
,

330 cÚ¡ *
p
 = 
s
.
	`d©a
();

331 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

332 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
è=ğ
n
);

334 
s
 += 'x';

336 cÚ¡ *
p
 = 
s
.
	`d©a
();

337 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

338 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
è=ğ
n
);

339 
	`TEST_EQUAL
(
	`size_t
(
p_’d
 - 
p
), 
n
);

341 
s
 += 'x';

343 cÚ¡ *
p
 = 
s
.
	`d©a
();

344 cÚ¡ *
p_’d
 = 
p
 + 
s
.
	`size
();

345 
	`TEST
(
	`decode_Ëngth
(&
p
, 
p_’d
, 
Œue
è=ğ
n
);

346 
	`TEST_EQUAL
(
	`size_t
(
p_’d
 - 
p
), 
n
 + 1);

350  
Œue
;

351 
	}
}

354 
	$check_doubË_£rŸli§tiÚ
(
u
)

356 
¡ršg
 
’coded
 = 
	`£rŸli£_doubË
(
u
);

357 cÚ¡ * 
±r
 = 
’coded
.
	`d©a
();

358 cÚ¡ * 
’d
 = 
±r
 + 
’coded
.
	`size
();

359 
v
 = 
	`un£rŸli£_doubË
(&
±r
, 
’d
);

360 ià(
±r
 !ğ
’d
 || 
u
 !ğ
v
) {

361 
tout
 << 
u
 << " -> " << 
v
 << ", difã»nû = " << v - u << 
’dl
;

362 
tout
 << "FLT_RADIX = " << 
FLT_RADIX
 << 
’dl
;

363 
tout
 << "DBL_MAX_EXP = " << 
DBL_MAX_EXP
 << 
’dl
;

365 
	`TEST
(
±r
 =ğ
’d
);

366 
	`TEST_EQUAL
(
u
, 
v
);

367 
	}
}

370 
boŞ
 
	$‹¡_£rŸli£doubË1
()

372 cÚ¡ 
‹¡_v®ues
[] = {

383 
	`check_doubË_£rŸli§tiÚ
(0.0);

384 
	`check_doubË_£rŸli§tiÚ
(1.0);

385 
	`check_doubË_£rŸli§tiÚ
(-1.0);

386 
	`check_doubË_£rŸli§tiÚ
(
DBL_MAX
);

387 
	`check_doubË_£rŸli§tiÚ
(-
DBL_MAX
);

388 
	`check_doubË_£rŸli§tiÚ
(
DBL_MIN
);

389 
	`check_doubË_£rŸli§tiÚ
(-
DBL_MIN
);

391 cÚ¡ *
p
;

392 
p
 = 
‹¡_v®ues
;… <est_values + (test_values) / (); ++p) {

393 
v®
 = *
p
;

394 
	`check_doubË_£rŸli§tiÚ
(
v®
);

395 
	`check_doubË_£rŸli§tiÚ
(-
v®
);

396 
	`check_doubË_£rŸli§tiÚ
(1.0 / 
v®
);

397 
	`check_doubË_£rŸli§tiÚ
(-1.0 / 
v®
);

400  
Œue
;

401 
	}
}

403 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


405 
boŞ
 
	$‹¡_£rŸli£doc1
()

407 
X­Ÿn
::
Docum’t
 
doc
;

409 
¡ršg
 
s
;

411 
s
 = 
	`£rŸli£_docum’t
(
doc
);

412 
	`TEST
(
	`£rŸli£_docum’t
(
	`un£rŸli£_docum’t
(
s
)) == s);

414 
doc
.
	`£t_d©a
("helllooooo");

415 
doc
.
	`add_‹rm
("term");

416 
doc
.
	`add_v®ue
(1, "foo");

418 
s
 = 
	`£rŸli£_docum’t
(
doc
);

419 
	`TEST
(
	`£rŸli£_docum’t
(
	`un£rŸli£_docum’t
(
s
)) == s);

421  
Œue
;

422 
	}
}

425 
£rŸli£qu”y1_h–³r
(cÚ¡ 
X­Ÿn
::
Qu”y
 & 
qu”y
)

427 
¡ršg
 
befÜe
 = 
qu”y
.
š‹º®
->
£rŸli£
();

428 
	gX­Ÿn
::
Regi¡ry
 
»g
;

429 
	gX­Ÿn
::
Qu”y
::
IÁ”Çl
 * 
qšt
;

430 
	gqšt
 = 
X­Ÿn
::
Qu”y
::
IÁ”Çl
::
un£rŸli£
(
befÜe
, 
»g
);

431 
¡ršg
 
	gaá”
 = 
qšt
->
£rŸli£
();

432 
d–‘e
 
	gqšt
;

433 
TEST
(
befÜe
 =ğ
aá”
);

437 
boŞ
 
	$‹¡_£rŸli£qu”y1
()

439 
¡ršg
 
s
;

441 
	`£rŸli£qu”y1_h–³r
(
X­Ÿn
::
	`Qu”y
("foo"));

444 
	`£rŸli£qu”y1_h–³r
(
X­Ÿn
::
	`Qu”y
("foo", 1, 1));

446 
	`£rŸli£qu”y1_h–³r
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

447 
X­Ÿn
::
	`Qu”y
("foo", 1, 1),

448 
X­Ÿn
::
	`Qu”y
("bar", 1, 1)));

450 cÚ¡ * 
wÜds
[] = { "paragraph", "word" };

451 
	`£rŸli£qu”y1_h–³r
(
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
, 
wÜds
, words + 2));

453 cÚ¡ * 
wÜds2
[] = { "milk", "on", "fridge" };

454 
	`£rŸli£qu”y1_h–³r
(

455 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_SCALE_WEIGHT
,

456 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_OR
,

457 
X­Ÿn
::
	`Qu”y
("leave"),

458 
X­Ÿn
::
	`Qu”y
(X­Ÿn::
Qu”y
::
OP_PHRASE
, 
wÜds2
, words2 + 3)

463  
Œue
;

464 
	}
}

467 
boŞ
 
	$‹¡_£rŸli£”rÜ1
()

469 
¡ršg
 
	`’ÛÁ_msg
(
	`¡»¼Ü
(
ENOENT
));

470 
X­Ÿn
::
D©aba£O³nšgE¼Ü
 
	`e
("FaedØİ’ d©aba£", 
ENOENT
);

473 
	`TEST_STRINGS_EQUAL
(
e
.
	`g‘_desütiÚ
(), "D©aba£O³nšgE¼Ü: FaedØİ’ d©aba£ (" + 
’ÛÁ_msg
 + ")");

475 
	`TEST_STRINGS_EQUAL
(
e
.
	`g‘_”rÜ_¡ršg
(), 
’ÛÁ_msg
);

477 
¡ršg
 
£rŸli§tiÚ
 = 
	`£rŸli£_”rÜ
(
e
);

482 
boŞ
 
th»w
 = 
çl£
;

483 
Œy
 {

485 
	`un£rŸli£_”rÜ
(
£rŸli§tiÚ
, "", "");

486 } 
	`ÿtch
 (
X­Ÿn
::
E¼Ü
 & 
eÿught
) {

487 
	`TEST_STRINGS_EQUAL
(
eÿught
.
	`g‘_”rÜ_¡ršg
(), 
’ÛÁ_msg
);

488 
th»w
 = 
Œue
;

490 
	`TEST
(
th»w
);

493 
	`TEST_STRINGS_EQUAL
(
e
.
	`g‘_”rÜ_¡ršg
(), 
’ÛÁ_msg
);

497 
X­Ÿn
::
D©aba£O³nšgE¼Ü
 
	`ecİy
(
e
);

498 
	`TEST_STRINGS_EQUAL
(
ecİy
.
	`g‘_”rÜ_¡ršg
(), 
’ÛÁ_msg
);

500  
Œue
;

501 
	}
}

510 
	sTempDtÜTe¡
 {

511 
	mcouÁ
;

512 
TempDtÜTe¡
 
çùÜy
() {  TempDtorTest(); }

513 
TempDtÜTe¡
(è{ ++
	mcouÁ
; }

514 ~
TempDtÜTe¡
(è{ --
	mcouÁ
; }

517 
	gTempDtÜTe¡
::
couÁ
 = 0;

519 
boŞ
 
	$‹¡_‹mpÜ¬ydtÜ1
()

521 
	`TEST_EQUAL
(
TempDtÜTe¡
::
couÁ
, 0);

522 
TempDtÜTe¡
::
	`çùÜy
();

523 
	`TEST_EQUAL
(
TempDtÜTe¡
::
couÁ
, 0);

525  
Œue
;

526 
	}
}

528 
boŞ
 
	$‹¡_¡©ic_as£¹1
()

530 
	`STATIC_ASSERT
(
Œue
);

531 
	`STATIC_ASSERT
(1);

532 
	`STATIC_ASSERT
(-1);

533 
	`STATIC_ASSERT
(42);

534 
	`STATIC_ASSERT
(() == 1);

539 
	`STATIC_ASSERT_UNSIGNED_TYPE
(
boŞ
);

540 
	`STATIC_ASSERT_UNSIGNED_TYPE
();

541 
	`STATIC_ASSERT_UNSIGNED_TYPE
();

542 
	`STATIC_ASSERT_UNSIGNED_TYPE
();

543 
	`STATIC_ASSERT_UNSIGNED_TYPE
();

548 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

549 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

550 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

551 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

553 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

554 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

555 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

556 
	`STATIC_ASSERT_TYPE_DOMINATES
(signed , signed );

558 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

560 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

561 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

562 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

564 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

565 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

566 
	`STATIC_ASSERT_TYPE_DOMINATES
(, signed );

568 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

569 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

570 
	`STATIC_ASSERT_TYPE_DOMINATES
(, );

575  
Œue
;

576 
	}
}

579 
boŞ
 
	$‹¡_¡rboŞ1
()

581 
	`TEST_EQUAL
(
	`¡r
(
Œue
), "1");

582 
	`TEST_EQUAL
(
	`¡r
(
çl£
), "0");

583  
Œue
;

584 
	}
}

587 
boŞ
 
	$‹¡_·ck_ušt_´e£rvšg_sÜt1
()

589 
¡ršg
 
´ev_·cked
;

590 
i
 = 0; i != 1000; ++i) {

591 
¡ršg
 
·cked
;

592 
	`·ck_ušt_´e£rvšg_sÜt
(
·cked
, 
i
);

593 cÚ¡ * 
±r
 = 
·cked
.
	`d©a
();

594 cÚ¡ * 
’d
 = 
±r
 + 
·cked
.
	`size
();

595 
»suÉ
;

596 
	`TEST
(
	`uÅack_ušt_´e£rvšg_sÜt
(&
±r
, 
’d
, &
»suÉ
));

597 
	`TEST_EQUAL
(
»suÉ
, 
i
);

598 
	`TEST
(
±r
 =ğ
’d
);

599 
	`TEST_REL
(
´ev_·cked
, <, 
·cked
);

600 
	`sw­
(
´ev_·cked
, 
·cked
);

602  
Œue
;

603 
	}
}

610 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

611 {"exû±1", 
‹¡_exû±1
},

612 {"exû±iÚ1", 
‹¡_exû±iÚ1
},

613 {"»fút1", 
‹¡_»fút1
},

614 {"»fút2", 
‹¡_»fút2
},

615 {"autİŒ1", 
‹¡_autİŒ1
},

616 {"¡ršgcomp1", 
‹¡_¡ršgcomp1
},

617 {"‹mpÜ¬ydtÜ1", 
‹¡_‹mpÜ¬ydtÜ1
},

618 {"to¡ršg1", 
‹¡_to¡ršg1
},

619 {"£rŸli£doubË1", 
‹¡_£rŸli£doubË1
},

620 #ifdeà
XAPIAN_HAS_REMOTE_BACKEND


621 {"£rŸli£Ëngth1", 
‹¡_£rŸli£Ëngth1
},

622 {"£rŸli£Ëngth2", 
‹¡_£rŸli£Ëngth2
},

623 {"£rŸli£doc1", 
‹¡_£rŸli£doc1
},

624 {"£rŸli£qu”y1", 
‹¡_£rŸli£qu”y1
},

625 {"£rŸli£”rÜ1", 
‹¡_£rŸli£”rÜ1
},

627 {"¡©ic_as£¹1", 
‹¡_¡©ic_as£¹1
},

628 {"¡rboŞ1", 
‹¡_¡rboŞ1
},

629 {"·ck1", 
‹¡_·ck_ušt_´e£rvšg_sÜt1
},

633 
	$maš
(
¬gc
, **
¬gv
)

635 
‹¡_driv”
::
	`·r£_commªd_lše
(
¬gc
, 
¬gv
);

636  
‹¡_driv”
::
	`run
(
‹¡s
);

637 
	}
}

	@tests/perftest/freemem.cc

21 
	~<cÚfig.h
>

23 
	~"ä“mem.h
"

25 
	~<sys/ty³s.h
>

26 
	~<şim™s
>

27 #ifdeà
HAVE_UNISTD_H


28 
	~<uni¡d.h
>

30 #ifdeà
HAVE_SYS_SYSCTL_H


31 
	~<sys/sysùl.h
>

33 #ifdeà
HAVE_VM_VM_PARAM_H


34 
	~<vm/vm_·¿m.h
>

36 #ifdeà
HAVE_SYS_VMMETER_H


37 
	~<sys/vmm‘”.h
>

39 #ifdeà
HAVE_SYS_SYSMP_H


40 
	~<sys/sysmp.h
>

42 #ifdeà
HAVE_SYS_SYSINFO_H


43 
	~<sys/sysšfo.h
>

45 #ifdeà
HAVE_SYS_PSTAT_H


46 
	~<sys/p¡©.h
>

49 #ifdeà
__WIN32__


50 
	~"§ãwšdows.h
"

58 
	$g‘_ä“_physiÿl_memÜy
()

60 #ifdeà
__WIN32__


61 
MEMORYSTATUSEX
 
¡©ex
;

62 
¡©ex
.
dwL’gth
 =  (statex);

63 
	`Glob®MemÜyStusEx
 (&
¡©ex
);

64  
¡©ex
.
uÎAvaPhys
;

66 
·gesize
 = 1;

67 
·ges
 = -1;

68 #ià
	`defšed
(
_SC_PAGESIZE
è&& defšed(
_SC_AVPHYS_PAGES
)

70 
·gesize
 = 
	`syscÚf
(
_SC_PAGESIZE
);

71 
·ges
 = 
	`syscÚf
(
_SC_AVPHYS_PAGES
);

72 #–ià
defšed
 
HAVE_SYSMP


74 
rmšfo
 
memšfo
;

75 ià(
	`sysmp
(
MP_SAGET
, 
MPSA_RMINFO
, &
memšfo
, (meminfo)) == 0) {

76 
·gesize
 = 
	`syscÚf
(
_SC_PAGESIZE
);

77 
·ges
 = 
memšfo
.
avarmem
;

79 #–ià
defšed
 
HAVE_PSTAT_GETDYNAMIC


81 
p¡_dyÇmic
 
šfo
;

82 ià(
	`p¡©_g‘dyÇmic
(&
šfo
, (info), 1, 0) == 1) {

83 
·gesize
 = 
	`g‘·gesize
();

84 
·ges
 = 
šfo
.
psd_ä“
;

86 #–ià
defšed
 
CTL_VM
 && (defšed 
VM_TOTAL
 || defšed 
VM_METER
)

88 
vmtÙ®
 
vm_šfo
;

89 
mib
[2] = {

90 
CTL_VM
,

91 #ifdeà
VM_TOTAL


92 
VM_TOTAL


94 
VM_METER


97 
size_t
 
Ën
 = (
vm_šfo
);

98 ià(
	`sysùl
(
mib
, 2, &
vm_šfo
, &
Ën
, 
NULL
, 0) == 0) {

99 
·gesize
 = 
	`g‘·gesize
();

100 
·ges
 = 
vm_šfo
.
t_ä“
;

103 ià(
·gesize
 > 0 && 
·ges
 > 0) {

104 
mem
 = 
LONG_MAX
;

105 ià(
·ges
 < 
LONG_MAX
 / 
·gesize
) {

106 
mem
 = 
·ges
 * 
·gesize
;

108  
mem
;

112 
	}
}

119 
	$g‘_tÙ®_physiÿl_memÜy
()

121 #ifdeà
__WIN32__


122 
MEMORYSTATUSEX
 
¡©ex
;

123 
¡©ex
.
dwL’gth
 =  (statex);

124 
	`Glob®MemÜyStusEx
 (&
¡©ex
);

125  
¡©ex
.
uÎTÙ®Phys
;

127 
·gesize
 = 1;

128 
·ges
 = -1;

129 #ià
	`defšed
(
_SC_PAGESIZE
è&& defšed(
_SC_AVPHYS_PAGES
)

131 
·gesize
 = 
	`syscÚf
(
_SC_PAGESIZE
);

132 
·ges
 = 
	`syscÚf
(
_SC_PHYS_PAGES
);

133 #–ià
defšed
 
HAVE_SYSMP


135 
rmšfo
 
memšfo
;

136 ià(
	`sysmp
(
MP_SAGET
, 
MPSA_RMINFO
, &
memšfo
, (meminfo)) == 0) {

137 
·gesize
 = 
	`syscÚf
(
_SC_PAGESIZE
);

138 
·ges
 = 
memšfo
.
physmem
;

140 #–ià
defšed
 
HAVE_PSTAT_GETDYNAMIC


142 
p¡_dyÇmic
 
šfo
;

143 ià(
	`p¡©_g‘dyÇmic
(&
šfo
, (info), 1, 0) == 1) {

144 
·gesize
 = 
	`g‘·gesize
();

145 
·ges
 = 
šfo
.
psd_rm
;

147 #–ià
defšed
 
CTL_VM
 && (defšed 
VM_TOTAL
 || defšed 
VM_METER
)

149 
vmtÙ®
 
vm_šfo
;

150 
mib
[2] = {

151 
CTL_VM
,

152 #ifdeà
VM_TOTAL


153 
VM_TOTAL


155 
VM_METER


158 
size_t
 
Ën
 = (
vm_šfo
);

159 ià(
	`sysùl
(
mib
, 2, &
vm_šfo
, &
Ën
, 
NULL
, 0) == 0) {

160 
·gesize
 = 
	`g‘·gesize
();

161 
·ges
 = 
vm_šfo
.
t_rm
;

164 ià(
·gesize
 > 0 && 
·ges
 > 0) {

165 
mem
 = 
LONG_MAX
;

166 ià(
·ges
 < 
LONG_MAX
 / 
·gesize
) {

167 
mem
 = 
·ges
 * 
·gesize
;

169  
mem
;

173 
	}
}

	@tests/perftest/freemem.h

21 #iâdeà
XAPIAN_INCLUDED_FREEMEM_H


22 
	#XAPIAN_INCLUDED_FREEMEM_H


	)

29 
g‘_ä“_physiÿl_memÜy
();

35 
g‘_tÙ®_physiÿl_memÜy
();

	@tests/perftest/perftest.cc

23 
	~<cÚfig.h
>

24 
	~"³ráe¡.h
"

26 
	~"back’dmªag”.h
"

27 
	~"ä“mem.h
"

28 
	~"omas£¹.h
"

29 
	~"³ráe¡/³ráe¡_®l.h
"

30 
	~"ruÅroûss.h
"

31 
	~"¡ršguts.h
"

32 
	~"‹¡ruÂ”.h
"

33 
	~"‹¡su™e.h
"

34 
	~"uts.h
"

36 
	~<io¡»am
>

38 
	~"§ãuni¡d.h
"

39 #ifdeà
HAVE_SYS_UTSNAME_H


40 
	~<sys/ut¢ame.h
>

43 #ifdeà
__WIN32__


44 
	~"§ãwšdows.h
"

45 
	~"§ãwšsock2.h
"

48 
usšg
 
Çme¥aû
 
	g¡d
;

50 
P”fTe¡Logg”
 
	glogg”
;

52 
¡ršg


53 
	$time_to_¡ršg
(cÚ¡ 
OmTime
 & 
time
)

55 
¡ršg
 
äac
 = 
	`om_to¡ršg
(
time
.
u£c
);

56 
äac
 = 
	`¡ršg
(6 - f¿c.
	`size
(), '0') + frac;

57  
	`om_to¡ršg
(
time
.
£c
è+ "." + 
äac
;

58 
	}
}

60 
¡ršg


61 
	$esÿ³_xml
(cÚ¡ 
¡ršg
 & 
¡r
)

63 
¡ršg
 
»s
;

64 
¡ršg
::
size_ty³
 
p
 = 0;

65 
p
 < 
¡r
.
	`size
()) {

66 
ch
 = 
¡r
[
p
++];

67 
ch
) {

69 
»s
 += "&lt;";

72 
»s
 += "&gt;";

75 
»s
 += "&amp;";

78 
»s
 += "&quot;";

81 
»s
 +ğ
ch
;

84  
»s
;

85 
	}
}

87 
	gP”fTe¡Logg”
::
	$P”fTe¡Logg”
()

88 : 
	`‹¡ÿ£_¡¬‹d
(
çl£
),

89 
	`šdexšg_¡¬‹d
(
çl£
),

90 
	$£¬chšg_¡¬‹d
(
çl£
)

91 {
	}
}

93 
	gP”fTe¡Logg”
::~
	$P”fTe¡Logg”
()

95 
	`şo£
();

96 
	}
}

99 
¡ršg


100 
	$g‘_ho¡Çme
()

102 #ifdeà
__WIN32__


103 
buf
[256];

104 
WORD
 
WSAV”Req
 = 
	`MAKEWORD
(1,1);

105 
WSADATA
 
WSAD©a
;

107 ià(
	`WSAS¹up
(
WSAV”Req
, &
WSAD©a
) != 0) {

109  
	`¡ršg
();

111 ià(
	`g‘ho¡Çme
(
buf
, (buf)) != 0) {

112 *
buf
 = '\0';

114 
	`WSACËªup
();

115  
buf
;

116 #–ià
defšed
 
HAVE_SYS_UTSNAME_H


117 
ut¢ame
 
uÇme_buf
;

118 ià(
	`uÇme
(&
uÇme_buf
) != 0) {

119 
uÇme_buf
.
nod’ame
[0] = '\0';

121  
uÇme_buf
.
nod’ame
;

122 #–ià
defšed
 
HAVE_GETHOSTNAME


123 
buf
[256];

124 ià(
	`g‘ho¡Çme
(
buf
, (buf)) != 0) {

125 *
buf
 = '\0';

127  
buf
;

129  
	`¡ršg
();

131 
	}
}

134 
¡ršg


135 
	$g‘_lßdavg
()

137 #ifdeà
__WIN32__


138  
	`¡ršg
();

140 
¡ršg
 
lßdavg
;

141 
Œy
 {

142 
lßdavg
 = 
	`¡dout_to_¡ršg
("uptime 2>/dev/null | sed 's/.*: \\([0-9][0-9]*\\)/\\1/;s/, .*//'");

143 } 
	`ÿtch
 (
NoSuchProg¿m
è{} c©ch (
R—dE¼Ü
) {}

144  
lßdavg
;

146 
	}
}

149 
¡ršg


150 
	$g‘_nıus
()

152 
¡ršg
 
nıus
;

153 #ifdeà
__WIN32__


154 
SYSTEM_INFO
 
siSysInfo
;

155 
	`G‘Sy¡emInfo
(&
siSysInfo
);

156 
nıus
 = 
	`om_to¡ršg
(
siSysInfo
.
dwNumb”OfProûssÜs
);

158 
Œy
 {

160 
nıus
 = 
	`¡dout_to_¡ršg
("getconf _NPROCESSORS_ONLN 2>/dev/null | grep -v '[^0-9]'");

161 } 
	`ÿtch
 (
NoSuchProg¿m
è{} c©ch (
R—dE¼Ü
) {}

162 ià(
nıus
.
	`em±y
())

163 
Œy
 {

165 
nıus
 = 
	`¡dout_to_¡ršg
("sysctl hw.ncpu 2>/dev/null | sed 's/.*=//'");

166 } 
	`ÿtch
 (
NoSuchProg¿m
è{} c©ch (
R—dE¼Ü
) {}

167 ià(
nıus
.
	`em±y
())

168 
Œy
 {

170 
nıus
 = 
	`¡dout_to_¡ršg
("PATH=/usr/sbin:$PATH…srinfo 2>/dev/null | grep -c on-line");

171 } 
	`ÿtch
 (
NoSuchProg¿m
è{} c©ch (
R—dE¼Ü
) {}

172 ià(
nıus
.
	`em±y
())

173 
Œy
 {

177 
nıus
 = 
	`¡dout_to_¡ršg
("grep -c…rocessor /proc/cpuinfo 2>/dev/null");

178 } 
	`ÿtch
 (
NoSuchProg¿m
è{} c©ch (
R—dE¼Ü
) {}

180  
nıus
;

181 
	}
}

184 
¡ršg


185 
	$g‘_di¡ro
()

187 
¡ršg
 
di¡ro
;

188 #ifdeà
__WIN32__


189 
OSVERSIONINFO
 
osvi
;

190 
	`Z”oMemÜy
(&
osvi
, (
OSVERSIONINFO
));

191 
osvi
.
dwOSV”siÚInfoSize
 = (
OSVERSIONINFO
);

192 
	`G‘V”siÚEx
(&
osvi
);

193 
di¡ro
 = "MSWš32 v" + 
	`om_to¡ršg
(
osvi
.
dwMajÜV”siÚ
) + "." +

194 
	`om_to¡ršg
(
osvi
.
dwMšÜV”siÚ
) + "." +

195 
	`om_to¡ršg
(
osvi
.
dwBudNumb”
);

197 
Œy
 {

198 
di¡ro
 = 
	`¡dout_to_¡ršg
("perftest/get_machine_info 2>/dev/null");

199 } 
	`ÿtch
 (
NoSuchProg¿m
è{} c©ch (
R—dE¼Ü
) {}

201  
di¡ro
;

202 
	}
}

205 
¡ršg


206 
	$g‘_svÄev
()

208 
¡ršg
 
svÄev
;

209 
Œy
 {

210 
svÄev
 = 
	`¡dout_to_¡ršg
("svn info --non-interactive -R $srcdir/.. 2>/dev/null | sed 's/^Revision: //p;d' | sort -rn | head -n 1");

211 } 
	`ÿtch
 (
NoSuchProg¿m
è{} c©ch (
R—dE¼Ü
) {}

213  
svÄev
;

214 
	}
}

217 
¡ršg


218 
	$g‘_svnb¿nch
()

220 
¡ršg
 
b¿nch
;

221 
Œy
 {

222 
¡ršg
 
svnu¾
 = 
	`¡dout_to_¡ršg
("svn info --non-interactive $srcdir/.. 2>/dev/null | sed 's/^URL: //p;d'");

223 
¡ršg
 
svÄoÙ
 = 
	`¡dout_to_¡ršg
("svn info --non-interactive $srcdir/.. 2>/dev/null | sed 's/^Repository Root: //p;d'");

224 
¡ršg
 
svn¡
 = 
	`¡dout_to_¡ršg
("svn status --non-interactive -q --no-ignore $srcdir/.. 2>/dev/null");

225 
svnu¾
.
	`”a£
(0, 
svÄoÙ
.
	`size
());

227 ià(
	`¡¬tsw™h
(
svnu¾
, '/'))

228 
svnu¾
.
	`”a£
(0, 1);

231 
¡ršg
::
size_ty³
 
i
 = 
svnu¾
.
	`fšd
('/');

232 ià(
i
 !ğ
svnu¾
.
Åos
) {

233 ià(
i
 =ğ
	`CONST_STRLEN
("Œunk"è&& 
	`¡¬tsw™h
(
svnu¾
, "trunk")) {

235 
b¿nch
 = "trunk";

236 } ià(
i
 =ğ
	`CONST_STRLEN
("b¿nches"è&& 
	`¡¬tsw™h
(
svnu¾
, "branches")) {

237 
svnu¾
.
	`”a£
(0, 
i
 + 1);

238 
i
 = 
svnu¾
.
	`fšd
('/');

239 ià(
i
 !ğ
svnu¾
.
Åos
) {

240 
b¿nch
 = 
svnu¾
.
	`sub¡r
(0, 
i
);

242 
b¿nch
 = 
svnu¾
;

246 ià(!
b¿nch
.
	`em±y
(è&& !
svn¡
.empty())

247 
b¿nch
 += " (modified)";

248 } 
	`ÿtch
 (
NoSuchProg¿m
è{} c©ch (
R—dE¼Ü
) {}

250  
b¿nch
;

251 
	}
}

253 
boŞ


254 
	gP”fTe¡Logg”
::
	$İ’
(cÚ¡ 
¡ršg
 & 
log·th
)

256 
out
.
	`İ’
(
log·th
.
	`c_¡r
(), 
ios
::ouˆ| ios::
bš¬y
 | ios::
Œunc
);

257 ià(!
out
.
	`is_İ’
()) {

258 
û¼
 << "Couldn'ˆİ’ ouuˆlogf'" << 
log·th
 << "'" << 
’dl
;

259  
çl£
;

262 
¡ršg
 
lßdavg
 = 
	`g‘_lßdavg
();

263 
¡ršg
 
ho¡Çme
 = 
	`g‘_ho¡Çme
();

264 
¡ršg
 
nıus
 = 
	`g‘_nıus
();

265 
¡ršg
 
di¡ro
 = 
	`g‘_di¡ro
();

268 
	`wr™e
("<?xml version=\"1.0\"ƒncoding=\"UTF-8\"?>\n<testrun>\n"

270 ià(!
ho¡Çme
.
	`em±y
())

271 
	`wr™e
(" <ho¡Çme>" + 
ho¡Çme
 + "</hostname>\n");

272 ià(!
lßdavg
.
	`em±y
())

273 
	`wr™e
(" <lßdavg>" + 
lßdavg
 + "</loadavg>\n");

274 ià(!
nıus
.
	`em±y
())

275 
	`wr™e
(" <nıus>" + 
nıus
 + "</ncpus>\n");

276 ià(!
di¡ro
.
	`em±y
())

277 
	`wr™e
(" <di¡ro>" + 
di¡ro
 + "</distro>\n");

278 
	`wr™e
(" <physmem>" + 
	`om_to¡ršg
(
	`g‘_tÙ®_physiÿl_memÜy
()) + "</physmem>\n");

279 
	`wr™e
(" </machineinfo>\n");

281 
¡ršg
 
svÄev
 = 
	`g‘_svÄev
();

282 
¡ršg
 
svnb¿nch
 = 
	`g‘_svnb¿nch
();

284 
	`wr™e
(" <sourceinfo>\n");

285 ià(!
svÄev
.
	`em±y
())

286 
	`wr™e
(" <svÄev>" + 
svÄev
 + "</svnrev>\n");

287 ià(!
svnb¿nch
.
	`em±y
())

288 
	`wr™e
(" <svnb¿nch>" + 
svnb¿nch
 + "</svnbranch>\n");

289 
	`wr™e
(" <v”siÚ>" + 
	`¡ršg
(
X­Ÿn
::
	`v”siÚ_¡ršg
()) + "</version>\n");

290 
	`wr™e
(" </sourceinfo>\n");

293  
Œue
;

294 
	}
}

297 
	gP”fTe¡Logg”
::
	$wr™e
(cÚ¡ 
¡ršg
 & 
‹xt
)

299 
out
.
	`wr™e
(
‹xt
.
	`d©a
(),ext.
	`size
());

300 
out
.
	`æush
();

301 
	}
}

304 
	gP”fTe¡Logg”
::
	$şo£
()

306 
	`»³t™iÚ_’d
();

307 ià(
out
.
	`is_İ’
()) {

308 
	`wr™e
("</testrun>\n");

309 
out
.
	`şo£
();

311 
	}
}

314 
	gP”fTe¡Logg”
::
šdexšg_begš
(cÚ¡ 
¡ršg
 & 
dbÇme
,

315 cÚ¡ 
¡d
::
m­
<¡d::
¡ršg
, std::¡ršg> & 
·¿ms
)

317 
£¬chšg_’d
();

318 
šdexšg_’d
();

319 
wr™e
(" <šdexruÀdbÇme=\"" + 
dbÇme
 + "\">\n <params>\n");

320 
	g¡d
::
m­
<
¡d
::
¡ršg
, std::¡ršg>::
cÚ¡_™”©Ü
 
i
;

321 
	gi
 = 
·¿ms
.
begš
(); i !ğ·¿ms.
’d
(); ++i) {

322 
wr™e
(" <·¿m‚ame=\"" + 
i
->
fœ¡
 + "\">" + 
esÿ³_xml
(i->
£cÚd
) + "</param>\n");

324 
	gi
 = 
·¿ms
.
fšd
("flush_threshold");

325 ià(
	gi
 =ğ
·¿ms
.
’d
()) {

326 
X­Ÿn
::
doccouÁ
 
æush_th»shŞd
 = 0;

327 cÚ¡ *
	gp
 = 
g‘’v
("XAPIAN_FLUSH_THRESHOLD");

328 ià(
	gp
)

329 
	gæush_th»shŞd
 = 
©oi
(
p
);

330 ià(
	gæush_th»shŞd
 == 0)

331 
æush_th»shŞd
 = 10000;

332 
wr™e
(" <param‚ame=\"flush_threshold\">" +

333 
esÿ³_xml
(
om_to¡ršg
(
æush_th»shŞd
)) + "</param>\n");

335 
wr™e
(" </params>\n");

336 
	gšdexšg_addcouÁ
 = 0;

337 
	gšdexšg_uÆogged_chªges
 = 
çl£
;

338 
	gšdexšg_tim”
 = 
OmTime
::
now
();

339 
	gÏ¡_šdexlog_tim”
 = 
šdexšg_tim”
;

340 
	gšdexšg_¡¬‹d
 = 
Œue
;

342 
šdexšg_log
();

346 
	gP”fTe¡Logg”
::
	$šdexšg_log
()

348 
	`As£¹
(
šdexšg_¡¬‹d
);

349 
Ï¡_šdexlog_tim”
 = 
OmTime
::
	`now
();

350 
OmTime
 
	`–­£d
(
Ï¡_šdexlog_tim”
 - 
šdexšg_tim”
);

351 
	`wr™e
(" <item>"

352 "<time>" + 
	`time_to_¡ršg
(
–­£d
) + "</time>"

353 "<adds>" + 
	`om_to¡ršg
(
šdexšg_addcouÁ
) + "</adds>"

355 
šdexšg_uÆogged_chªges
 = 
çl£
;

356 
	}
}

359 
	gP”fTe¡Logg”
::
	$šdexšg_’d
()

361 ià(
šdexšg_¡¬‹d
) {

362 
	`šdexšg_log
();

363 
	`wr™e
(" </indexrun>\n");

364 
šdexšg_¡¬‹d
 = 
çl£
;

366 
	}
}

369 
	gP”fTe¡Logg”
::
	$£¬chšg_¡¬t
(cÚ¡ 
¡ršg
 & 
desütiÚ
)

371 
	`šdexšg_’d
();

372 
	`£¬chšg_’d
();

373 
	`wr™e
(" <searchrun>\n"

374 " <desütiÚ>" + 
	`esÿ³_xml
(
desütiÚ
) + "</description>\n");

375 
£¬chšg_¡¬‹d
 = 
Œue
;

376 
	`£¬ch_¡¬t
();

377 
	}
}

380 
	gP”fTe¡Logg”
::
£¬ch_’d
(cÚ¡ 
X­Ÿn
::
Qu”y
 & 
qu”y
,

381 cÚ¡ 
X­Ÿn
::
MS‘
 & 
m£t
)

383 
As£¹
(
£¬chšg_¡¬‹d
);

384 
OmTime
 
–­£d
(OmTime::
now
(è- 
£¬chšg_tim”
);

385 
wr™e
(" <search>"

386 "<time>" + 
time_to_¡ršg
(
–­£d
) + "</time>"

387 "<qu”y>" + 
esÿ³_xml
(
qu”y
.
g‘_desütiÚ
()) + "</query>"

389 "<size>" + 
om_to¡ršg
(
m£t
.
size
()) + "</size>"

390 "<lb>" + 
om_to¡ršg
(
m£t
.
g‘_m©ches_low”_bound
()) + "</lb>"

391 "<e¡>" + 
om_to¡ršg
(
m£t
.
g‘_m©ches_e¡im©ed
()) + "</est>"

392 "<ub>" + 
om_to¡ršg
(
m£t
.
g‘_m©ches_uµ”_bound
()) + "</ub>"

395 
£¬ch_¡¬t
();

399 
	gP”fTe¡Logg”
::
	$£¬chšg_’d
()

401 ià(
£¬chšg_¡¬‹d
) {

402 
	`wr™e
(" </searchrun>\n");

403 
£¬chšg_¡¬‹d
 = 
çl£
;

405 
	}
}

408 
	gP”fTe¡Logg”
::
	$‹¡ÿ£_begš
(cÚ¡ 
¡ršg
 & 
‹¡ÿ£
)

410 
	`‹¡ÿ£_’d
();

411 
	`wr™e
(" <‹¡ÿ£‚ame=\"" + 
‹¡ÿ£
 + "\" backend=\"" +

412 
back’dmªag”
->
	`g‘_dbty³
() + "\"„epnum=\"" +

413 
	`om_to¡ršg
(
»³t™iÚ_numb”
) + "\">\n");

414 
‹¡ÿ£_¡¬‹d
 = 
Œue
;

415 
	}
}

418 
	gP”fTe¡Logg”
::
	$‹¡ÿ£_’d
()

420 
	`šdexšg_’d
();

421 ià(
‹¡ÿ£_¡¬‹d
) {

422 
	`wr™e
(" </testcase>\n");

423 
‹¡ÿ£_¡¬‹d
 = 
çl£
;

425 
	}
}

428 
	gP”fTe¡Logg”
::
	$»³t™iÚ_begš
(
num
)

430 
	`»³t™iÚ_’d
();

431 
»³t™iÚ_numb”
 = 
num
;

432 
	}
}

435 
	gP”fTe¡Logg”
::
	$»³t™iÚ_’d
()

437 
	`‹¡ÿ£_’d
();

438 
	}
}

441 şas 
	cP”fTe¡RuÂ”
 : 
public
 
Te¡RuÂ”


443 
¡ršg
 
»³t™iÚs_¡ršg
;

444 
mubË
 
boŞ
 
	m»³t™iÚs_·r£d
;

445 
mubË
 
	m»³t™iÚs
;

446 
	mpublic
:

447 
	$P”fTe¡RuÂ”
()

448 : 
	`»³t™iÚs_·r£d
(
çl£
), 
	$»³t™iÚs
(5)

450 
‹¡_driv”
::
	`add_commªd_lše_İtiÚ
("repetitions", 'r',

451 &
»³t™iÚs_¡ršg
);

454 
	$run
() const {

455 
»suÉ
 = 0;

456 ià(!
»³t™iÚs_·r£d
) {

457 ià(!
»³t™iÚs_¡ršg
.
	`em±y
()) {

458 
»³t™iÚs
 = 
	`©oi
(
»³t™iÚs_¡ršg
);

460 
»³t™iÚs_·r£d
 = 
Œue
;

462 
i
 = 0; i !ğ
»³t™iÚs
; ++i) {

463 
logg”
.
	`»³t™iÚ_begš
(
i
 + 1);

464 
	~"³ráe¡/³ráe¡_cŞÏ‹d.h
"

465 
logg”
.
	`»³t™iÚ_’d
();

467  
»suÉ
;

468 
	}
}

471 
	$maš
(
¬gc
, **
¬gv
)

473 ià(!
logg”
.
	`İ’
("perflog.xml"))

476 
P”fTe¡RuÂ”
 
ruÂ”
;

478  
ruÂ”
.
	`run_‹¡s
(
¬gc
, 
¬gv
);

479 
	}
}

	@tests/perftest/perftest.h

22 #iâdeà
XAPIAN_INCLUDED_PERFTEST_H


23 
	#XAPIAN_INCLUDED_PERFTEST_H


	)

25 
	~<x­Ÿn.h
>

26 
	~<f¡»am
>

27 
	~<m­
>

28 
	~<¡ršg
>

29 
	~"omtime.h
"

31 şas 
	cP”fTe¡Logg”
 {

32 
	m¡d
::
of¡»am
 
out
;

34 
	m»³t™iÚ_numb”
;

36 
boŞ
 
	m‹¡ÿ£_¡¬‹d
;

38 
boŞ
 
	mšdexšg_¡¬‹d
;

39 
	mX­Ÿn
::
doccouÁ
 
šdexšg_addcouÁ
;

40 
boŞ
 
	mšdexšg_uÆogged_chªges
;

41 
OmTime
 
	mšdexšg_tim”
;

42 
OmTime
 
	mÏ¡_šdexlog_tim”
;

44 
boŞ
 
	m£¬chšg_¡¬‹d
;

45 
OmTime
 
	m£¬chšg_tim”
;

49 
šdexšg_log
();

51 
wr™e
(cÚ¡ 
¡d
::
¡ršg
 & 
‹xt
);

53 
	mpublic
:

54 
P”fTe¡Logg”
();

55 ~
P”fTe¡Logg”
();

61 
boŞ
 
İ’
(cÚ¡ 
¡d
::
¡ršg
 & 
log·th
);

65 
şo£
();

69 
šdexšg_begš
(cÚ¡ 
¡d
::
¡ršg
 & 
dbÇme
,

70 cÚ¡ 
¡d
::
m­
<¡d::
¡ršg
, std::¡ršg> & 
·¿ms
);

74 
	$šdexšg_add
() {

75 ++
šdexšg_addcouÁ
;

76 
šdexšg_uÆogged_chªges
 = 
Œue
;

78 ià(
šdexšg_addcouÁ
 % 1000 == 0) {

79 
	`šdexšg_log
();

82 
OmTime
 
	`now
(OmTime::now());

83 ià(
now
 > 
Ï¡_šdexlog_tim”
 + 
	`OmTime
(5, 0))

84 
	`šdexšg_log
();

90 
	`šdexšg_’d
();

94 
	`£¬chšg_¡¬t
(cÚ¡ 
¡d
::
¡ršg
 & 
desütiÚ
);

98 
	$£¬ch_¡¬t
()

100 
£¬chšg_tim”
 = 
OmTime
::
	`now
();

101 
	}
}

105 
£¬ch_’d
(cÚ¡ 
X­Ÿn
::
Qu”y
 & 
qu”y
,

106 cÚ¡ 
X­Ÿn
::
MS‘
 & 
m£t
);

110 
£¬chšg_’d
();

114 
‹¡ÿ£_begš
(cÚ¡ 
¡d
::
¡ršg
 & 
‹¡ÿ£
);

118 
‹¡ÿ£_’d
();

122 
»³t™iÚ_begš
(
num
);

126 
»³t™iÚ_’d
();

129 
P”fTe¡Logg”
 
logg”
;

	@tests/perftest/perftest_all.h

2 
	~"³ráe¡/³ráe¡_m©chdecid”.h
"

3 
	~"³ráe¡/³ráe¡_¿ndomidx.h
"

	@tests/perftest/perftest_collated.h

3 ià(
	gwr™abË
&&!
	gšmemÜy
) {

4 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

5 { "¿ndomidx1", 
‹¡_¿ndomidx1
 },

8 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

10 ià(
	gwr™abË
&&!
	g»mÙe
&&!
	gšmemÜy
) {

11 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

12 { "v®ue£tm©chdecid”1", 
‹¡_v®ue£tm©chdecid”1
 },

13 { "®ldocs™”1", 
‹¡_®ldocs™”1
 },

16 
	g»suÉ
 = 
max
(
»suÉ
, 
‹¡_driv”
::
run
(
‹¡s
));

	@tests/perftest/perftest_matchdecider.cc

22 
	~<cÚfig.h
>

24 
	~"³ráe¡/³ráe¡_m©chdecid”.h
"

26 
	~<x­Ÿn.h
>

28 
	~"back’dmªag”.h
"

29 
	~"³ráe¡.h
"

30 
	~"‹¡ruÂ”.h
"

31 
	~"‹¡su™e.h
"

32 
	~"‹¡uts.h
"

33 
	~"uts.h
"

35 
usšg
 
Çme¥aû
 
	g¡d
;

38 
buddb_v®ue¡e¡1
(
X­Ÿn
::
Wr™abËD©aba£
 &
db
, cÚ¡ 
¡ršg
 & 
dbÇme
)

40 
	glogg”
.
‹¡ÿ£_begš
(
dbÇme
);

41 
	grunsize
 = 1000000;

44 
	g¡d
::
m­
<
¡d
::
¡ršg
, std::¡ršg> 
·¿ms
;

45 
	g·¿ms
["runsize"] = 
om_to¡ršg
(
runsize
);

46 
	glogg”
.
šdexšg_begš
(
dbÇme
, 
·¿ms
);

47 
	gi
 = 0; i < 
	grunsize
; ++i) {

48 
	gv
 = 
i
 % 100;

49 
	gX­Ÿn
::
Docum’t
 
doc
;

50 
	gdoc
.
£t_d©a
("‹¡ docum’ˆ" + 
om_to¡ršg
(
i
));

51 
	gdoc
.
add_‹rm
("foo");

52 
¡ršg
 
	gvs
 = 
om_to¡ršg
(
v
);

53 ià(
	gvs
.
size
(è=ğ1è
vs
 = "0" + vs;

54 
	gdoc
.
add_v®ue
(0, 
vs
);

55 
	gdoc
.
add_‹rm
("F" + 
vs
);

56 
	gdoc
.
add_‹rm
("Q" + 
om_to¡ršg
(
i
));

57 
	gj
 = 0; j != 100; ++j)

58 
	gdoc
.
add_‹rm
("J" + 
om_to¡ršg
(
j
));

59 
	gdb
.
»¶aû_docum’t
(
i
 + 10, 
doc
);

60 
	glogg”
.
šdexšg_add
();

62 
	gdb
.
comm™
();

63 
	glogg”
.
šdexšg_’d
();

64 
	glogg”
.
‹¡ÿ£_’d
();

68 
DEFINE_TESTCASE
(
v®ue£tm©chdecid”1
, 
wr™abË
 && !
»mÙe
 && !
šmemÜy
) {

69 
	gX­Ÿn
::
D©aba£
 
db
;

70 
	gdb
 = 
back’dmªag”
->
g‘_d©aba£
("v®ue¡e¡1", 
buddb_v®ue¡e¡1
,

73 
	glogg”
.
‹¡ÿ£_begš
("valuesetmatchdecider1");

74 
	gX­Ÿn
::
Enquœe
 
’quœe
(
db
);

75 
	gX­Ÿn
::
doccouÁ
 
runsize
 = 
db
.
g‘_doccouÁ
();

77 
	gX­Ÿn
::
Qu”y
 
qu”y
("foo");

78 
	glogg”
.
£¬chšg_¡¬t
("No match decider");

79 
	glogg”
.
£¬ch_¡¬t
();

80 
	g’quœe
.
£t_qu”y
(
qu”y
);

81 
	gX­Ÿn
::
MS‘
 
m£t
 = 
’quœe
.
g‘_m£t
(0, 10);

82 
	glogg”
.
£¬ch_’d
(
qu”y
, 
m£t
);

83 
TEST
(
m£t
.
size
() == 10);

84 
TEST
(
m£t
.
g‘_m©ches_low”_bound
(è<ğ
runsize
);

85 
TEST
(
m£t
.
g‘_m©ches_uµ”_bound
(è<ğ
runsize
);

87 
	glogg”
.
£¬ch_¡¬t
();

88 
	gm£t
 = 
’quœe
.
g‘_m£t
(0, 10);

89 
	glogg”
.
£¬ch_’d
(
qu”y
, 
m£t
);

90 
TEST
(
m£t
.
size
() == 10);

91 
TEST
(
m£t
.
g‘_m©ches_low”_bound
(è<ğ
runsize
);

92 
	glogg”
.
£¬chšg_’d
();

94 
	gX­Ÿn
::
V®ueS‘M©chDecid”
 
md
(0, 
Œue
);

96 
	gi
 = 0; i < 100; ++i) {

97 
¡ršg
 
	gvs
 = 
om_to¡ršg
(
i
);

98 ià(
	gvs
.
size
(è=ğ1è
vs
 = "0" + vs;

99 
	gmd
.
add_v®ue
(
vs
);

101 
	glogg”
.
£¬chšg_¡¬t
("M©ch decid”‡cû±šg " + 
om_to¡ršg
(
i
 + 1) + "%");

102 
	glogg”
.
£¬ch_¡¬t
();

103 
	g’quœe
.
£t_qu”y
(
qu”y
);

104 
	gm£t
 = 
’quœe
.
g‘_m£t
(0, 10, 0, 
NULL
, &
md
);

105 
	glogg”
.
£¬ch_’d
(
qu”y
, 
m£t
);

106 
TEST_EQUAL
(
m£t
.
size
(), 10);

107 
TEST_REL
(
m£t
.
g‘_m©ches_low”_bound
(),<=,
runsize
 * (
i
 + 1) / 100);

108 
	glogg”
.
£¬chšg_’d
();

110 
	gX­Ÿn
::
Qu”y
 
qu”y2
(
X­Ÿn
::Qu”y::
OP_FILTER
, 
qu”y
,

111 
X­Ÿn
::
Qu”y
(X­Ÿn::Qu”y::
OP_VALUE_LE
, 0, 
vs
));

112 
	glogg”
.
£¬chšg_¡¬t
("V®u¿ngLE‡cû±šg " + 
om_to¡ršg
(
i
 + 1) + "%");

113 
	gX­Ÿn
::
MS‘
 
m£t2
;

114 
	glogg”
.
£¬ch_¡¬t
();

115 
	g’quœe
.
£t_qu”y
(
qu”y2
);

116 
	gm£t2
 = 
’quœe
.
g‘_m£t
(0, 10);

117 
	glogg”
.
£¬ch_’d
(
qu”y2
, 
m£t2
);

118 
TEST_EQUAL
(
m£t2
.
size
(), 10);

119 
TEST_REL
(
m£t2
.
g‘_m©ches_low”_bound
(),<=,
runsize
 * (
i
 + 1) / 100);

120 
‹¡_m£t_Üd”_equ®
(
m£t
, 
m£t2
);

121 
	glogg”
.
£¬chšg_’d
();

124 
	glogg”
.
‹¡ÿ£_’d
();

125  
	gŒue
;

129 
DEFINE_TESTCASE
(
®ldocs™”1
, 
wr™abË
 && !
»mÙe
 && !
šmemÜy
) {

130 
	gX­Ÿn
::
D©aba£
 
db
;

131 
	gdb
 = 
back’dmªag”
->
g‘_d©aba£
("v®ue¡e¡1", 
buddb_v®ue¡e¡1
,

134 
	glogg”
.
‹¡ÿ£_begš
("alldocsiter1");

136 
	glogg”
.
£¬chšg_¡¬t
("AllDocsPostingIterator, full iteration");

137 
	glogg”
.
£¬ch_¡¬t
();

138 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 
begš
(
db
.
po¡li¡_begš
(""));

139 
	gX­Ÿn
::
Po¡šgI‹¿tÜ
 
’d
(
db
.
po¡li¡_’d
(""));

140 
	gbegš
 !ğ
’d
) {

141 ++
begš
;

143 
	glogg”
.
£¬ch_’d
(
X­Ÿn
::
Qu”y
(), X­Ÿn::
MS‘
());

145 
	glogg”
.
£¬chšg_’d
();

147 
	glogg”
.
‹¡ÿ£_’d
();

148  
	gŒue
;

	@tests/perftest/perftest_matchdecider.h

2 
boŞ
 
‹¡_v®ue£tm©chdecid”1
();

3 
boŞ
 
‹¡_®ldocs™”1
();

	@tests/perftest/perftest_randomidx.cc

22 
	~<cÚfig.h
>

24 
	~"³ráe¡/³ráe¡_¿ndomidx.h
"

26 
	~<c¡dlib
>

27 
	~<¡ršg
>

28 
	~<x­Ÿn.h
>

30 
	~"back’dmªag”.h
"

31 
	~"³ráe¡.h
"

32 
	~"‹¡ruÂ”.h
"

33 
	~"‹¡su™e.h
"

34 
	~"‹¡uts.h
"

35 
	~"uts.h
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

42 
	$¿nd_št
(
¿nge
)

44  ()(
¿nge
 * (
	`¿nd
(è/ (
RAND_MAX
 + 1.0)));

45 
	}
}

50 
	$¿nd_št
(
mš
, 
max
)

52  
mš
 + ()((
max
 + 1 - mšè* (
	`¿nd
(è/ (
RAND_MAX
 + 1.0)));

53 
	}
}

60 
	$¿nd_01
()

62  
	`¿nd
(è/ (
RAND_MAX
 + 1.0);

63 
	}
}

70 
¡ršg


71 
	$g’_wÜd
(
Ëngth
, 
ch¬_¿nge
)

73 
¡ršg
 
»suÉ
;

74 
»suÉ
.
	`»£rve
(
Ëngth
);

75 
i
 = 0; i !ğ
Ëngth
; ++i) {

76 
ch
 = ('a' + 
	`¿nd_št
(
ch¬_¿nge
));

77 
»suÉ
.
	`­³nd
(1, 
ch
);

79  
»suÉ
;

80 
	}
}

83 
DEFINE_TESTCASE
(
¿ndomidx1
, 
wr™abË
 && !
šmemÜy
) {

84 
	glogg”
.
‹¡ÿ£_begš
("randomidx1");

86 
	g¡d
::
¡ršg
 
dbÇme
("randomidx1");

87 
	gX­Ÿn
::
Wr™abËD©aba£
 
dbw
 = 
back’dmªag”
->
g‘_wr™abË_d©aba£
(
dbÇme
, "");

89 
	grunsize
 = 100000;

90 
	g£ed
 = 42;

93 
	g¦Ùs_u£d
 = 10;

94 
	g¦Ù_´obab™y
 = 0.7;

95 
	g¦Ùv®_mšËn
 = 1;

96 
	g¦Ùv®_maxËn
 = 6;

98 
	gmš‹rms
 = 100;

99 
	gmax‹rms
 = 1000;

100 
	gmš‹rmËn
 = 1;

101 
	gmax‹rmËn
 = 10;

102 
	g‹rmch¬¿nge
 = 10;

104 
¤ªd
(
£ed
);

106 
	g¡d
::
m­
<
¡d
::
¡ršg
, std::¡ršg> 
·¿ms
;

107 
	g·¿ms
["runsize"] = 
om_to¡ršg
(
runsize
);

108 
	g·¿ms
["£ed"] = 
om_to¡ršg
(
£ed
);

109 
	g·¿ms
["¦Ùs_u£d"] = 
om_to¡ršg
(
¦Ùs_u£d
);

110 
	g·¿ms
["¦Ù_´obab™y"] = 
om_to¡ršg
(
¦Ù_´obab™y
);

111 
	g·¿ms
["¦Ùv®_mšËn"] = 
om_to¡ršg
(
¦Ùv®_mšËn
);

112 
	g·¿ms
["¦Ùv®_maxËn"] = 
om_to¡ršg
(
¦Ùv®_maxËn
);

113 
	g·¿ms
["mš‹rms"] = 
om_to¡ršg
(
mš‹rms
);

114 
	g·¿ms
["max‹rms"] = 
om_to¡ršg
(
max‹rms
);

115 
	g·¿ms
["mš‹rmËn"] = 
om_to¡ršg
(
mš‹rmËn
);

116 
	g·¿ms
["max‹rmËn"] = 
om_to¡ršg
(
max‹rmËn
);

117 
	g·¿ms
["‹rmch¬¿nge"] = 
om_to¡ršg
(
‹rmch¬¿nge
);

118 
	glogg”
.
šdexšg_begš
(
dbÇme
, 
·¿ms
);

120 
	gi
;

121 
	gi
 = 0; i < 
	grunsize
; ++i) {

122 
	gX­Ÿn
::
Docum’t
 
doc
;

123 
	gdoc
.
£t_d©a
("¿ndom docum’ˆ" + 
om_to¡ršg
(
i
));

125 
	g‹rms
 = 
¿nd_št
(
mš‹rms
, 
max‹rms
);

126 
	gj
 = 0; j < 
	g‹rms
; ++j) {

127 
	g‹rmËn
 = 
¿nd_št
(
mš‹rmËn
, 
max‹rmËn
);

128 
	gdoc
.
add_‹rm
(
g’_wÜd
(
‹rmËn
, 
‹rmch¬¿nge
));

134 
	g¦Ù
 = 0; slÙ < 
	g¦Ùs_u£d
; ++slot) {

135 ià(
¿nd_01
(è< 
	g¦Ù_´obab™y
) {

136 
	gËn
 = 
¿nd_št
(
¦Ùv®_mšËn
, 
¦Ùv®_maxËn
);

137 
	gdoc
.
add_v®ue
(
¦Ù
, 
g’_wÜd
(
Ën
, slot + 2));

141 
	gdbw
.
add_docum’t
(
doc
);

142 
	glogg”
.
šdexšg_add
();

144 
	gdbw
.
comm™
();

145 
	glogg”
.
šdexšg_’d
();

147 
	glogg”
.
‹¡ÿ£_’d
();

148  
	gŒue
;

	@tests/perftest/perftest_randomidx.h

2 
boŞ
 
‹¡_¿ndomidx1
();

	@tests/perftest/runprocess.cc

20 
	~<cÚfig.h
>

22 
	~"ruÅroûss.h
"

23 
	~"¡ršguts.h
"

25 
	~<c¡dio
>

26 
	~<¡ršg
>

28 #ifdeà
__WIN32__


29 #iâdeà
WIFEXITED


30 
	#WIFEXITED
(
¡©us
è(¡©u !ğ-1)

	)

32 #iâdeà
WEXITSTATUS


33 
	#WEXITSTATUS
(
¡©us
è(¡©us)

	)

37 #ifdeà
_MSC_VER


38 
	#pİ’
 
_pİ’


	)

39 
	#pşo£
 
_pşo£


	)

42 
usšg
 
Çme¥aû
 
	g¡d
;

44 
¡ršg


45 
	$¡dout_to_¡ršg
(cÚ¡ 
¡ršg
 &
cmd
)

47 
¡ršg
 
out
;

48 
FILE
 * 
fh
 = 
	`pİ’
(
cmd
.
	`c_¡r
(), "r");

49 ià(
fh
 =ğ
NULL
è
throw
 
	`R—dE¼Ü
();

50 !
	`ãof
(
fh
)) {

51 
buf
[4096];

52 
size_t
 
Ën
 = 
	`ä—d
(
buf
, 1, 4096, 
fh
);

53 ià(
	`ã¼Ü
(
fh
)) {

54 ()
	`pşo£
(
fh
);

55 
throw
 
	`R—dE¼Ü
();

57 
out
.
	`­³nd
(
buf
, 
Ën
);

59 
¡©us
 = 
	`pşo£
(
fh
);

61 ià(
¡©us
 != 0) {

62 ià(
	`WIFEXITED
(
¡©us
è&& 
	`WEXITSTATUS
(status) == 127) {

63 
throw
 
	`NoSuchProg¿m
();

65 
throw
 
	`R—dE¼Ü
();

67 
out
.
	`size
(è> 0 && 
	`C_is¥aû
(out[out.size() - 1])) {

68 
out
.
	`»size
(out.
	`size
() - 1);

70  
out
;

71 
	}
}

	@tests/perftest/runprocess.h

20 #iâdeà
XAPIAN_INCLUDED_RUNPROCESS_H


21 
	#XAPIAN_INCLUDED_RUNPROCESS_H


	)

23 
	~<¡ršg
>

26 
	sR—dE¼Ü
 {};

29 
	sNoSuchProg¿m
 {};

32 
	g¡d
::
¡ršg
 
¡dout_to_¡ršg
(cÚ¡ 
¡d
::¡ršg &
cmd
);

	@tests/queryparsertest.cc

22 
	~<cÚfig.h
>

24 
	~<x­Ÿn.h
>

26 
	~"ıutim”.h
"

27 
	~"¡ršguts.h
"

28 
	~"uts.h
"

30 
	~<cm©h
>

31 
	~<¡ršg
>

32 
	~<veùÜ
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	#TESTCASE
(
S
è{#S, 
‹¡_
##S}

	)

37 
	#END_OF_TESTCASES
 {0, 0}

	)

39 
	~"‹¡su™e.h
"

40 
	~"‹¡uts.h
"

42 
	s‹¡
 {

43 cÚ¡ *
	mqu”y
;

44 cÚ¡ *
	mex³ù
;

47 cÚ¡ 
‹¡
 
	g‹¡_Ü_qu”›s
[] = {

612 { 
NULL
, NULL }

615 
boŞ
 
	$‹¡_qu”y·r£r1
()

617 
X­Ÿn
::
Qu”yP¬£r
 
qu”y·r£r
;

618 
qu”y·r£r
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

619 
qu”y·r£r
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

620 
qu”y·r£r
.
	`add_´efix
("author", "A");

621 
qu”y·r£r
.
	`add_´efix
("writer", "A");

622 
qu”y·r£r
.
	`add_´efix
("title", "XT");

623 
qu”y·r£r
.
	`add_´efix
("subject", "XT");

624 
qu”y·r£r
.
	`add_´efix
("authortitle", "A");

625 
qu”y·r£r
.
	`add_´efix
("authortitle", "XT");

626 
qu”y·r£r
.
	`add_boŞ—n_´efix
("site", "H");

627 
qu”y·r£r
.
	`add_boŞ—n_´efix
("site2", "J");

628 
qu”y·r£r
.
	`add_boŞ—n_´efix
("multisite", "H");

629 
qu”y·r£r
.
	`add_boŞ—n_´efix
("multisite", "J");

630 
qu”y·r£r
.
	`add_boŞ—n_´efix
("category", "XCAT");

631 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
,

632 
qu”y·r£r
.
	`add_boŞ—n_´efix
("authortitle", "B");

634 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
,

635 
qu”y·r£r
.
	`add_´efix
("multisite", "B");

637 cÚ¡ 
‹¡
 *
p
 = 
‹¡_Ü_qu”›s
;…->
qu”y
; ++p) {

638 
¡ršg
 
ex³ù
, 
·r£d
;

639 ià(
p
->
ex³ù
)

640 
ex³ù
 = 
p
->expect;

642 
ex³ù
 = "parseƒrror";

643 
Œy
 {

644 
X­Ÿn
::
Qu”y
 
qobj
 = 
qu”y·r£r
.
	`·r£_qu”y
(
p
->
qu”y
);

645 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

646 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

647 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

648 
·r£d
 = 
e
.
	`g‘_msg
();

649 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

650 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

651 } 
	`ÿtch
 (...) {

652 
·r£d
 = "Unknownƒxception!";

654 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

655 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

657  
Œue
;

658 
	}
}

660 cÚ¡ 
‹¡
 
	g‹¡_ªd_qu”›s
[] = {

682 { 
NULL
, NULL }

686 
boŞ
 
	$‹¡_qp_deçuÉ_İ1
()

688 
X­Ÿn
::
Qu”yP¬£r
 
qu”y·r£r
;

689 
qu”y·r£r
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

690 
qu”y·r£r
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

691 
qu”y·r£r
.
	`add_´efix
("author", "A");

692 
qu”y·r£r
.
	`add_´efix
("title", "XT");

693 
qu”y·r£r
.
	`add_´efix
("subject", "XT");

694 
qu”y·r£r
.
	`add_boŞ—n_´efix
("site", "H");

695 
qu”y·r£r
.
	`£t_deçuÉ_İ
(
X­Ÿn
::
Qu”y
::
OP_AND
);

696 cÚ¡ 
‹¡
 *
p
 = 
‹¡_ªd_qu”›s
;…->
qu”y
; ++p) {

697 
¡ršg
 
ex³ù
, 
·r£d
;

698 ià(
p
->
ex³ù
)

699 
ex³ù
 = 
p
->expect;

701 
ex³ù
 = "parseƒrror";

702 
Œy
 {

703 
X­Ÿn
::
Qu”y
 
qobj
 = 
qu”y·r£r
.
	`·r£_qu”y
(
p
->
qu”y
);

704 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

705 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

706 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

707 
·r£d
 = 
e
.
	`g‘_msg
();

708 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

709 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

710 } 
	`ÿtch
 (...) {

711 
·r£d
 = "Unknownƒxception!";

713 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

714 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

716  
Œue
;

717 
	}
}

720 
boŞ
 
	$‹¡_qp_deçuÉ_´efix1
()

722 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

723 
qp
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

724 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

725 
qp
.
	`add_´efix
("title", "XT");

727 
X­Ÿn
::
Qu”y
 
qobj
;

728 
qobj
 = 
qp
.
	`·r£_qu”y
("hello world", 0, "A");

729 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZAhello:(pos=1) OR ZAworld:(pos=2)))");

730 
qobj
 = 
qp
.
	`·r£_qu”y
("meitle:stuff", 0, "A");

731 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZAme:(pos=1) OR ZXTstuff:(pos=2)))");

732 
qobj
 = 
qp
.
	`·r£_qu”y
("t™Ë:(¡uffème", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
, "A");

733 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZXTstuff:(pos=1) OR ZAme:(pos=2)))");

734  
Œue
;

735 
	}
}

739 
boŞ
 
	$‹¡_qp_deçuÉ_´efix2
()

741 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

742 
qp
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

743 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

746 
	`TEST_EXCEPTION
(
X­Ÿn
::
Unim¶em’‹dE¼Ü
,

747 
qp
.
	`add_boŞ—n_´efix
("", "B");

750 
qp
.
	`add_´efix
("title", "XT");

751 
qp
.
	`add_´efix
("", "A");

753 
X­Ÿn
::
Qu”y
 
qobj
;

754 
qobj
 = 
qp
.
	`·r£_qu”y
("hello world", 0);

755 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZAhello:(pos=1) OR ZAworld:(pos=2)))");

756 
qobj
 = 
qp
.
	`·r£_qu”y
("meitle:stuff", 0);

757 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZAme:(pos=1) OR ZXTstuff:(pos=2)))");

758 
qobj
 = 
qp
.
	`·r£_qu”y
("t™Ë:(¡uffème", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
);

759 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZXTstuff:(pos=1) OR ZAme:(pos=2)))");

761 
qobj
 = 
qp
.
	`·r£_qu”y
("hello world", 0, "B");

762 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZBhello:(pos=1) OR ZBworld:(pos=2)))");

763 
qobj
 = 
qp
.
	`·r£_qu”y
("meitle:stuff", 0, "B");

764 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZBme:(pos=1) OR ZXTstuff:(pos=2)))");

765 
qobj
 = 
qp
.
	`·r£_qu”y
("t™Ë:(¡uffème", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
, "B");

766 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZXTstuff:(pos=1) OR ZBme:(pos=2)))");

768 
qp
.
	`add_´efix
("", "B");

769 
qobj
 = 
qp
.
	`·r£_qu”y
("me-u t™Ë:(¡uffème", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
);

770 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((Ame:(pos=1) PHRASE 2 Aus:(pos=2)) OR (Bme:(pos=1) PHRASE 2 Bus:(pos=2)) OR ZXTstuff:(pos=3) OR ZAme:(pos=4) OR ZBme:(pos=4)))");

771 
qobj
 = 
qp
.
	`·r£_qu”y
("me-u t™Ë:(¡uffème", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
, "C");

772 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((Cme:(pos=1) PHRASE 2 Cus:(pos=2)) OR ZXTstuff:(pos=3) OR ZCme:(pos=4)))");

774 
qobj
 = 
qp
.
	`·r£_qu”y
("me-u t™Ë:\"nÙ-me\"", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PHRASE
);

775 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((Ame:(pos=1) PHRASE 2 Aus:(pos=2)) OR (Bme:(pos=1) PHRASE 2 Bus:(pos=2)) OR (XTnot:(pos=3) PHRASE 2 XTme:(pos=4))))");

776  
Œue
;

777 
	}
}

780 
boŞ
 
	$‹¡_qp_odd_ch¬s1
()

782 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

783 
¡ršg
 
	`qu”y
("\x01weird\x00stuff\x7f", 13);

784 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
qu”y
);

785 
tout
 << "Qu”y: " << 
qu”y
 << '\n';

786 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((weird:(pos=1) OR stuff:(pos=2)))");

787  
Œue
;

788 
	}
}

791 
boŞ
 
	$‹¡_qp_æag_wdÿrd1
()

793 #iâdeà
XAPIAN_HAS_INMEMORY_BACKEND


794 
	`SKIP_TEST
("Testcase„equireshe InMemory backend which is disabled");

796 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(X­Ÿn::
InMemÜy
::
	`İ’
());

797 
X­Ÿn
::
Docum’t
 
doc
;

798 
doc
.
	`add_‹rm
("abc");

799 
doc
.
	`add_‹rm
("main");

800 
doc
.
	`add_‹rm
("muscat");

801 
doc
.
	`add_‹rm
("muscle");

802 
doc
.
	`add_‹rm
("musclebound");

803 
doc
.
	`add_‹rm
("muscular");

804 
doc
.
	`add_‹rm
("mutton");

805 
db
.
	`add_docum’t
(
doc
);

806 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

807 
qp
.
	`£t_d©aba£
(
db
);

808 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
("ab*", X­Ÿn::
Qu”yP¬£r
::
FLAG_WILDCARD
);

809 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(abc:(pos=1))");

810 
qobj
 = 
qp
.
	`·r£_qu”y
("musşe*", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

811 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((muscle:(pos=1) SYNONYM musclebound:(pos=1)))");

812 
qobj
 = 
qp
.
	`·r£_qu”y
("m—t*", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

813 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

814 
qobj
 = 
qp
.
	`·r£_qu”y
("musc*", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

815 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((muscat:(pos=1) SYNONYM muscle:(pos=1) SYNONYM musclebound:(pos=1) SYNONYM muscular:(pos=1)))");

816 
qobj
 = 
qp
.
	`·r£_qu”y
("mu‰*", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

817 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(mutton:(pos=1))");

820 
qobj
 = 
qp
.
	`·r£_qu”y
("mUTTON++");

821 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(mutton:(pos=1))");

823 
æags
 = 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
 |

824 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_LOVEHATE
;

825 
qobj
 = 
qp
.
	`·r£_qu”y
("+mai* maš", 
æags
);

826 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((main:(pos=1) AND_MAYBE main:(pos=2)))");

829 
qobj
 = 
qp
.
	`·r£_qu”y
("foo* maš", 
æags
);

830 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(main:(pos=2))");

831 
qobj
 = 
qp
.
	`·r£_qu”y
("maš foo*", 
æags
);

832 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(main:(pos=1))");

833 
qobj
 = 
qp
.
	`·r£_qu”y
("+foo* maš", 
æags
);

834 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

835 
qobj
 = 
qp
.
	`·r£_qu”y
("maš +foo*", 
æags
);

836 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

837 
qobj
 = 
qp
.
	`·r£_qu”y
("foo* +maš", 
æags
);

838 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(main:(pos=2))");

839 
qobj
 = 
qp
.
	`·r£_qu”y
("+maš foo*", 
æags
);

840 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(main:(pos=1))");

841 
qobj
 = 
qp
.
	`·r£_qu”y
("+foo* +maš", 
æags
);

842 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

843 
qobj
 = 
qp
.
	`·r£_qu”y
("+maš +foo*", 
æags
);

844 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

845 
qobj
 = 
qp
.
	`·r£_qu”y
("foo* mai", 
æags
);

846 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(mai:(pos=2))");

847 
qobj
 = 
qp
.
	`·r£_qu”y
("ma˜foo*", 
æags
);

848 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(mai:(pos=1))");

849 
qobj
 = 
qp
.
	`·r£_qu”y
("+foo* mai", 
æags
);

850 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

851 
qobj
 = 
qp
.
	`·r£_qu”y
("ma˜+foo*", 
æags
);

852 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

853 
qobj
 = 
qp
.
	`·r£_qu”y
("foo* +mai", 
æags
);

854 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(mai:(pos=2))");

855 
qobj
 = 
qp
.
	`·r£_qu”y
("+ma˜foo*", 
æags
);

856 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(mai:(pos=1))");

857 
qobj
 = 
qp
.
	`·r£_qu”y
("+foo* +mai", 
æags
);

858 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

859 
qobj
 = 
qp
.
	`·r£_qu”y
("+ma˜+foo*", 
æags
);

860 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

861 
qobj
 = 
qp
.
	`·r£_qu”y
("-foo* maš", 
æags
);

862 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(main:(pos=2))");

863 
qobj
 = 
qp
.
	`·r£_qu”y
("maš -foo*", 
æags
);

864 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(main:(pos=1))");

865 
qobj
 = 
qp
.
	`·r£_qu”y
("maš -foo* -b¬", 
æags
);

866 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((main:(pos=1) AND_NOT bar:(pos=3)))");

867 
qobj
 = 
qp
.
	`·r£_qu”y
("maš -b¬ -foo*", 
æags
);

868 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((main:(pos=1) AND_NOT bar:(pos=2)))");

870 
qp
.
	`£t_deçuÉ_İ
(
X­Ÿn
::
Qu”y
::
OP_AND
);

871 
qobj
 = 
qp
.
	`·r£_qu”y
("foo* maš", 
æags
);

872 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

873 
qobj
 = 
qp
.
	`·r£_qu”y
("maš foo*", 
æags
);

874 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

875 
qp
.
	`£t_deçuÉ_İ
(
X­Ÿn
::
Qu”y
::
OP_AND
);

876 
qobj
 = 
qp
.
	`·r£_qu”y
("+foo* maš", 
æags
);

877 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

878 
qobj
 = 
qp
.
	`·r£_qu”y
("maš +foo*", 
æags
);

879 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

880 
qobj
 = 
qp
.
	`·r£_qu”y
("-foo* maš", 
æags
);

881 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(main:(pos=2))");

882 
qobj
 = 
qp
.
	`·r£_qu”y
("maš -foo*", 
æags
);

883 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(main:(pos=1))");

885 
qobj
 = 
qp
.
	`·r£_qu”y
("foo* -maš", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

886 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query()");

887  
Œue
;

889 
	}
}

892 
boŞ
 
	$‹¡_qp_æag_wdÿrd2
()

894 #iâdeà
XAPIAN_HAS_INMEMORY_BACKEND


895 
	`SKIP_TEST
("Testcase„equireshe InMemory backend which is disabled");

897 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(X­Ÿn::
InMemÜy
::
	`İ’
());

898 
X­Ÿn
::
Docum’t
 
doc
;

899 
doc
.
	`add_‹rm
("Aheinlein");

900 
doc
.
	`add_‹rm
("Ahuxley");

901 
doc
.
	`add_‹rm
("hello");

902 
db
.
	`add_docum’t
(
doc
);

903 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

904 
qp
.
	`£t_d©aba£
(
db
);

905 
qp
.
	`add_´efix
("author", "A");

906 
X­Ÿn
::
Qu”y
 
qobj
;

907 
qobj
 = 
qp
.
	`·r£_qu”y
("authÜ:h*", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

908 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((Aheinlein:(pos=1) SYNONYM Ahuxley:(pos=1)))");

909 
qobj
 = 
qp
.
	`·r£_qu”y
("authÜ:h*e¡", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

910 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((Aheinlein:(pos=1) SYNONYM Ahuxley:(pos=1)) ORest:(pos=2)))");

911  
Œue
;

913 
	}
}

916 
boŞ
 
	$‹¡_qp_æag_·¹Ÿl1
()

918 #iâdeà
XAPIAN_HAS_INMEMORY_BACKEND


919 
	`SKIP_TEST
("Testcase„equireshe InMemory backend which is disabled");

921 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(X­Ÿn::
InMemÜy
::
	`İ’
());

922 
X­Ÿn
::
Docum’t
 
doc
;

923 
X­Ÿn
::
S‹m
 
	`¡emm”
("english");

924 
doc
.
	`add_‹rm
("abc");

925 
doc
.
	`add_‹rm
("main");

926 
doc
.
	`add_‹rm
("muscat");

927 
doc
.
	`add_‹rm
("muscle");

928 
doc
.
	`add_‹rm
("musclebound");

929 
doc
.
	`add_‹rm
("muscular");

930 
doc
.
	`add_‹rm
("mutton");

931 
doc
.
	`add_‹rm
("Z" + 
	`¡emm”
("outside"));

932 
doc
.
	`add_‹rm
("Z" + 
	`¡emm”
("out"));

933 
doc
.
	`add_‹rm
("outside");

934 
doc
.
	`add_‹rm
("out");

935 
doc
.
	`add_‹rm
("XTcove");

936 
doc
.
	`add_‹rm
("XTcows");

937 
doc
.
	`add_‹rm
("XTcowl");

938 
doc
.
	`add_‹rm
("XTcox");

939 
doc
.
	`add_‹rm
("ZXTcow");

940 
doc
.
	`add_‹rm
("XONEpartial");

941 
doc
.
	`add_‹rm
("XONEpartial2");

942 
doc
.
	`add_‹rm
("XTWOpartial3");

943 
doc
.
	`add_‹rm
("XTWOpartial4");

944 
db
.
	`add_docum’t
(
doc
);

945 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

946 
qp
.
	`£t_d©aba£
(
db
);

947 
qp
.
	`£t_¡emm”
(
¡emm”
);

948 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

949 
qp
.
	`add_´efix
("title", "XT");

950 
qp
.
	`add_´efix
("double", "XONE");

951 
qp
.
	`add_´efix
("double", "XTWO");

954 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
("a", X­Ÿn::
Qu”yP¬£r
::
FLAG_PARTIAL
);

955 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((abc:(pos=1) OR Za:(pos=1)))");

956 
qobj
 = 
qp
.
	`·r£_qu”y
("ab", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

957 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((abc:(pos=1) OR Zab:(pos=1)))");

958 
qobj
 = 
qp
.
	`·r£_qu”y
("musşe", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

959 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((muscle:(pos=1) SYNONYM musclebound:(pos=1)) OR Zmuscl:(pos=1)))");

960 
qobj
 = 
qp
.
	`·r£_qu”y
("m—t", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

961 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(Zmeat:(pos=1))");

962 
qobj
 = 
qp
.
	`·r£_qu”y
("musc", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

963 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((muscat:(pos=1) SYNONYM muscle:(pos=1) SYNONYM musclebound:(pos=1) SYNONYM muscular:(pos=1)) OR Zmusc:(pos=1)))");

964 
qobj
 = 
qp
.
	`·r£_qu”y
("mu‰", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

965 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((mutton:(pos=1) OR Zmutt:(pos=1)))");

966 
qobj
 = 
qp
.
	`·r£_qu”y
("abømusc", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

967 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((Zabc:(pos=1) OR (muscat:(pos=2) SYNONYM muscle:(pos=2) SYNONYM musclebound:(pos=2) SYNONYM muscular:(pos=2)) OR Zmusc:(pos=2)))");

968 
qobj
 = 
qp
.
	`·r£_qu”y
("a* mu‰", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
 | X­Ÿn::Qu”yP¬£r::
FLAG_WILDCARD
);

969 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((abc:(pos=1) OR mutton:(pos=2) OR Zmutt:(pos=2)))");

972 
qobj
 = 
qp
.
	`·r£_qu”y
("o", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

973 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((out:(pos=1) SYNONYM outside:(pos=1)) OR Zo:(pos=1)))");

974 
qobj
 = 
qp
.
	`·r£_qu”y
("ou", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

975 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((out:(pos=1) SYNONYM outside:(pos=1)) OR Zou:(pos=1)))");

976 
qobj
 = 
qp
.
	`·r£_qu”y
("out", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

977 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((out:(pos=1) SYNONYM outside:(pos=1)) OR Zout:(pos=1)))");

978 
qobj
 = 
qp
.
	`·r£_qu”y
("outs", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

979 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((outside:(pos=1) OR Zout:(pos=1)))");

980 
qobj
 = 
qp
.
	`·r£_qu”y
("outsi", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

981 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((outside:(pos=1) OR Zoutsi:(pos=1)))");

982 
qobj
 = 
qp
.
	`·r£_qu”y
("outsid", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

983 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((outside:(pos=1) OR Zoutsid:(pos=1)))");

984 
qobj
 = 
qp
.
	`·r£_qu”y
("outside", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

985 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((outside:(pos=1) OR Zoutsid:(pos=1)))");

988 
qobj
 = 
qp
.
	`·r£_qu”y
("Out", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

989 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((out:(pos=1) SYNONYM outside:(pos=1)) OR out:(pos=1)))");

990 
qobj
 = 
qp
.
	`·r£_qu”y
("Outs", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

991 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((outside:(pos=1) OR outs:(pos=1)))");

992 
qobj
 = 
qp
.
	`·r£_qu”y
("Outside", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

993 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(outside:(pos=1,wqf=2))");

996 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_ALL
);

997 
qobj
 = 
qp
.
	`·r£_qu”y
("Out", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

998 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((out:(pos=1) SYNONYM outside:(pos=1)) OR out:(pos=1)))");

999 
qobj
 = 
qp
.
	`·r£_qu”y
("Outs", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1000 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((outside:(pos=1) OR out:(pos=1)))");

1001 
qobj
 = 
qp
.
	`·r£_qu”y
("Outside", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1002 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((outside:(pos=1) OR outsid:(pos=1)))");

1005 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

1006 
qobj
 = 
qp
.
	`·r£_qu”y
("t™Ë:cow", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1007 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((XTcowl:(pos=1) SYNONYM XTcows:(pos=1)) OR ZXTcow:(pos=1)))");

1008 
qobj
 = 
qp
.
	`·r£_qu”y
("t™Ë:cows", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1009 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((XTcows:(pos=1) OR ZXTcow:(pos=1)))");

1010 
qobj
 = 
qp
.
	`·r£_qu”y
("t™Ë:Cow", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1011 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((XTcowl:(pos=1) SYNONYM XTcows:(pos=1)) OR XTcow:(pos=1)))");

1012 
qobj
 = 
qp
.
	`·r£_qu”y
("t™Ë:Cows", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1013 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(XTcows:(pos=1,wqf=2))");

1018 
qobj
 = 
qp
.
	`·r£_qu”y
("doubË:visiÚ", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1019 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((ZXONEvision:(pos=1) SYNONYM ZXTWOvision:(pos=1)))");

1022 
qobj
 = 
qp
.
	`·r£_qu”y
("doubË:·¹", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1023 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((XONEpartial:(pos=1) SYNONYM XONEpartial2:(pos=1) SYNONYM XTWOpartial3:(pos=1) SYNONYM XTWOpartial4:(pos=1)) OR (ZXONEpart:(pos=1) SYNONYM ZXTWOpart:(pos=1))))");

1027 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_NONE
);

1028 
qobj
 = 
qp
.
	`·r£_qu”y
("doubË:·¹", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1029 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((XONEpartial:(pos=1) SYNONYM XONEpartial2:(pos=1) SYNONYM XTWOpartial3:(pos=1) SYNONYM XTWOpartial4:(pos=1)) OR (XONEpart:(pos=1) SYNONYM XTWOpart:(pos=1))))");

1030 
qobj
 = 
qp
.
	`·r£_qu”y
("doubË:·¹Ÿl", 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1031 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query(((XONEpartial:(pos=1) SYNONYM XONEpartial2:(pos=1) SYNONYM XTWOpartial3:(pos=1) SYNONYM XTWOpartial4:(pos=1)) OR (XONEpartial:(pos=1) SYNONYM XTWOpartial:(pos=1))))");

1033  
Œue
;

1035 
	}
}

1037 
boŞ
 
	$‹¡_qp_æag_boŞ_ªy_ÿ£1
()

1039 
usšg
 
X­Ÿn
::
Qu”yP¬£r
;

1040 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1041 
X­Ÿn
::
Qu”y
 
qobj
;

1042 
qobj
 = 
qp
.
	`·r£_qu”y
("tØªd fro", 
Qu”yP¬£r
::
FLAG_BOOLEAN
 | Qu”yP¬£r::
FLAG_BOOLEAN_ANY_CASE
);

1043 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((to:(pos=1) AND fro:(pos=2)))");

1044 
qobj
 = 
qp
.
	`·r£_qu”y
("tØªd fro", 
Qu”yP¬£r
::
FLAG_BOOLEAN
);

1045 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((to:(pos=1) OR‡nd:(pos=2) OR fro:(pos=3)))");

1047 
qobj
 = 
qp
.
	`·r£_qu”y
("tØAnd fro", 
Qu”yP¬£r
::
FLAG_BOOLEAN
 | Qu”yP¬£r::
FLAG_BOOLEAN_ANY_CASE
);

1048 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((to:(pos=1) AND fro:(pos=2)))");

1049 
qobj
 = 
qp
.
	`·r£_qu”y
("tØAnd fro", 
Qu”yP¬£r
::
FLAG_BOOLEAN
);

1050 
	`TEST_STRINGS_EQUAL
(
qobj
.
	`g‘_desütiÚ
(), "Xapian::Query((to:(pos=1) OR‡nd:(pos=2) OR fro:(pos=3)))");

1051  
Œue
;

1052 
	}
}

1054 cÚ¡ 
‹¡
 
	g‹¡_¡İ_qu”›s
[] = {

1065 { 
NULL
, NULL }

1068 
boŞ
 
	$‹¡_qp_¡İ³r1
()

1070 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1071 cÚ¡ * 
¡İwÜds
[] = { "a", "an", "the" };

1072 
X­Ÿn
::
Sim¶eStİ³r
 
	`¡İ
(
¡İwÜds
, stopwords + 3);

1073 
qp
.
	`£t_¡İ³r
(&
¡İ
);

1074 
qp
.
	`£t_deçuÉ_İ
(
X­Ÿn
::
Qu”y
::
OP_AND
);

1075 cÚ¡ 
‹¡
 *
p
 = 
‹¡_¡İ_qu”›s
;…->
qu”y
; ++p) {

1076 
¡ršg
 
ex³ù
, 
·r£d
;

1077 ià(
p
->
ex³ù
)

1078 
ex³ù
 = 
p
->expect;

1080 
ex³ù
 = "parseƒrror";

1081 
Œy
 {

1082 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
);

1083 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1084 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1085 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1086 
·r£d
 = 
e
.
	`g‘_msg
();

1087 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1088 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1089 } 
	`ÿtch
 (...) {

1090 
·r£d
 = "Unknownƒxception!";

1092 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1093 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1095  
Œue
;

1096 
	}
}

1098 cÚ¡ 
‹¡
 
	g‹¡_pu»_nÙ_qu”›s
[] = {

1104 { 
NULL
, NULL }

1107 
boŞ
 
	$‹¡_qp_æag_pu»_nÙ1
()

1109 
usšg
 
X­Ÿn
::
Qu”yP¬£r
;

1110 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1111 
qp
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

1112 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
Qu”yP¬£r
::
STEM_SOME
);

1113 cÚ¡ 
‹¡
 *
p
 = 
‹¡_pu»_nÙ_qu”›s
;…->
qu”y
; ++p) {

1114 
¡ršg
 
ex³ù
, 
·r£d
;

1115 ià(
p
->
ex³ù
)

1116 
ex³ù
 = 
p
->expect;

1118 
ex³ù
 = "parseƒrror";

1119 
Œy
 {

1120 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
,

1121 
Qu”yP¬£r
::
FLAG_BOOLEAN
 |

1122 
Qu”yP¬£r
::
FLAG_PURE_NOT
);

1123 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1124 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1125 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1126 
·r£d
 = 
e
.
	`g‘_msg
();

1127 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1128 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1129 } 
	`ÿtch
 (...) {

1130 
·r£d
 = "Unknownƒxception!";

1132 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1133 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1135  
Œue
;

1136 
	}
}

1141 
boŞ
 
	$‹¡_qp_un¡em_boŞ—n_´efix
()

1143 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1144 
qp
.
	`add_boŞ—n_´efix
("test", "XTEST");

1145 
X­Ÿn
::
Qu”y
 
q
 = 
qp
.
	`·r£_qu”y
("helloest:foo");

1146 
	`TEST_STRINGS_EQUAL
(
q
.
	`g‘_desütiÚ
(), "Xapian::Query((hello:(pos=1) FILTER XTESTfoo))");

1147 
X­Ÿn
::
T”mI‹¿tÜ
 
u
 = 
qp
.
	`un¡em_begš
("XTESTfoo");

1148 
	`TEST
(
u
 !ğ
qp
.
	`un¡em_’d
("XTESTfoo"));

1149 
	`TEST_EQUAL
(*
u
, "test:foo");

1150 ++
u
;

1151 
	`TEST
(
u
 =ğ
qp
.
	`un¡em_’d
("XTESTfoo"));

1152  
Œue
;

1153 
	}
}

1155 cÚ¡ 
‹¡
 
	g‹¡_v®ue_¿nge1_qu”›s
[] = {

1171 { 
NULL
, NULL }

1175 
boŞ
 
	$‹¡_qp_v®ue_¿nge1
()

1177 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1178 
qp
.
	`add_boŞ—n_´efix
("test", "XTEST");

1179 
X­Ÿn
::
SŒšgV®ueRªgeProûssÜ
 
	`v½
(1);

1180 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½
);

1181 cÚ¡ 
‹¡
 *
p
 = 
‹¡_v®ue_¿nge1_qu”›s
;…->
qu”y
; ++p) {

1182 
¡ršg
 
ex³ù
, 
·r£d
;

1183 ià(
p
->
ex³ù
)

1184 
ex³ù
 = 
p
->expect;

1186 
ex³ù
 = "parseƒrror";

1187 
Œy
 {

1188 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
);

1189 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1190 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1191 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1192 
·r£d
 = 
e
.
	`g‘_msg
();

1193 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1194 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1195 } 
	`ÿtch
 (...) {

1196 
·r£d
 = "Unknownƒxception!";

1198 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1199 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1201  
Œue
;

1202 
	}
}

1204 cÚ¡ 
‹¡
 
	g‹¡_v®ue_¿nge2_qu”›s
[] = {

1227 { 
NULL
, NULL }

1231 
boŞ
 
	$‹¡_qp_v®ue_¿nge2
()

1233 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1234 
qp
.
	`add_boŞ—n_´efix
("test", "XTEST");

1235 
X­Ÿn
::
D©eV®ueRªgeProûssÜ
 
	`v½_d©e
(1);

1236 
X­Ÿn
::
Numb”V®ueRªgeProûssÜ
 
	`v½_num
(2);

1237 
X­Ÿn
::
SŒšgV®ueRªgeProûssÜ
 
	`v½_¡r
(3);

1238 
X­Ÿn
::
Numb”V®ueRªgeProûssÜ
 
	`v½_ÿsh
(4, "$");

1239 
X­Ÿn
::
Numb”V®ueRªgeProûssÜ
 
	`v½_weight
(5, "kg", 
çl£
);

1240 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_d©e
);

1241 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_num
);

1242 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_ÿsh
);

1243 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_weight
);

1244 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_¡r
);

1245 cÚ¡ 
‹¡
 *
p
 = 
‹¡_v®ue_¿nge2_qu”›s
;…->
qu”y
; ++p) {

1246 
¡ršg
 
ex³ù
, 
·r£d
;

1247 ià(
p
->
ex³ù
)

1248 
ex³ù
 = 
p
->expect;

1250 
ex³ù
 = "parseƒrror";

1251 
Œy
 {

1252 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
);

1253 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1254 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1255 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1256 
·r£d
 = 
e
.
	`g‘_msg
();

1257 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1258 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1259 } 
	`ÿtch
 (...) {

1260 
·r£d
 = "Unknownƒxception!";

1262 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1263 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1265  
Œue
;

1266 
	}
}

1269 
boŞ
 
	$‹¡_qp_v®ue_¿nge3
()

1271 #iâdeà
XAPIAN_HAS_INMEMORY_BACKEND


1272 
	`SKIP_TEST
("Testcase„equireshe InMemory backend which is disabled");

1274 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(X­Ÿn::
InMemÜy
::
	`İ’
());

1275 
low
 = -10;

1276 
¡•s
 = 60;

1277 
¡•
 = 0.5;

1279 
i
 = 0; i <ğ
¡•s
; ++i) {

1280 
v
 = 
low
 + 
i
 * 
¡•
;

1281 
X­Ÿn
::
Docum’t
 
doc
;

1282 
doc
.
	`add_v®ue
(1, 
X­Ÿn
::
	`sÜbË_£rŸli£
(
v
));

1283 
db
.
	`add_docum’t
(
doc
);

1286 
X­Ÿn
::
Numb”V®ueRªgeProûssÜ
 
	`v½_num
(1);

1287 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1288 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_num
);

1290 
j
 = 0; j <ğ
¡•s
; ++j) {

1291 
¡¬t
 = 
low
 + 
j
 * 
¡•
;

1292 
k
 = 0; k <ğ
¡•s
; ++k) {

1293 
’d
 = 
low
 + 
k
 * 
¡•
;

1294 
¡ršg
 
qu”y
 = 
	`om_to¡ršg
(
¡¬t
è+ ".." + om_to¡ršg(
’d
);

1295 
tout
 << "Qu”y: " << 
qu”y
 << '\n';

1296 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
qu”y
);

1297 
X­Ÿn
::
Enquœe
 
	`’q
(
db
);

1298 
’q
.
	`£t_qu”y
(
qobj
);

1299 
X­Ÿn
::
MS‘
 
m£t
 = 
’q
.
	`g‘_m£t
(0, 
¡•s
 + 1);

1300 ià(
’d
 < 
¡¬t
) {

1301 
	`TEST_EQUAL
(
m£t
.
	`size
(), 0);

1303 
	`TEST_EQUAL
(
m£t
.
	`size
(), 1u + (
k
 - 
j
));

1304 
m
 = 0; m !ğ
m£t
.
	`size
(); ++m) {

1305 
v
 = 
¡¬t
 + 
m
 * 
¡•
;

1306 
	`TEST_EQUAL
(
m£t
[
m
].
	`g‘_docum’t
().
	`g‘_v®ue
(1),

1307 
X­Ÿn
::
	`sÜbË_£rŸli£
(
v
));

1312  
Œue
;

1314 
	}
}

1316 cÚ¡ 
	g‹¡_v®ue_¿nge_numb”s
[] = {

1317 #ifdeà
INFINITY


1318 -
INFINITY
,

1320 -
HUGE_VAL
,

1321 -
DBL_MAX
,

1322 -
pow
(2.0, 1022),

1336 -
pow
(2.0, -1023),

1337 -
pow
(2.0, -1024),

1338 -
pow
(2.0, -1074),

1339 -
DBL_MIN
,

1341 
DBL_MIN
,

1342 
pow
(2.0, -1074),

1343 
pow
(2.0, -1024),

1344 
pow
(2.0, -1023),

1358 
pow
(2.0, 1022),

1359 
DBL_MAX
,

1360 
HUGE_VAL
,

1361 #ifdeà
INFINITY


1362 
INFINITY
,

1369 
boŞ
 
	$‹¡_v®ue_¿nge_£rŸli£1
()

1371 
´evnum
 = 0;

1372 
¡ršg
 
´ev¡r
;

1373 
boŞ
 
¡¬‹d
 = 
çl£
;

1374 cÚ¡ *
p
 = 
‹¡_v®ue_¿nge_numb”s
; *p != 64; ++p) {

1375 
num
 = *
p
;

1376 
tout
 << "Numb”: " << 
num
 << '\n';

1377 
¡ršg
 
¡r
 = 
X­Ÿn
::
	`sÜbË_£rŸli£
(
num
);

1378 
tout
 << "SŒšg: " << 
¡r
 << '\n';

1379 
	`TEST_EQUAL
(
X­Ÿn
::
	`sÜbË_un£rŸli£
(
¡r
), 
num
);

1381 ià(
¡¬‹d
) {

1382 
num_cmp
 = 0;

1383 ià(
´evnum
 < 
num
) {

1384 
num_cmp
 = -1;

1385 } ià(
´evnum
 > 
num
) {

1386 
num_cmp
 = 1;

1388 
¡r_cmp
 = 0;

1389 ià(
´ev¡r
 < 
¡r
) {

1390 
¡r_cmp
 = -1;

1391 } ià(
´ev¡r
 > 
¡r
) {

1392 
¡r_cmp
 = 1;

1395 
	`TEST_AND_EXPLAIN
(
num_cmp
 =ğ
¡r_cmp
,

1396 "Numb” " << 
´evnum
 << "‡nd " << 
num
 <<

1401 
´evnum
 = 
num
;

1402 
´ev¡r
 = 
¡r
;

1403 
¡¬‹d
 = 
Œue
;

1405  
Œue
;

1406 
	}
}

1408 cÚ¡ 
‹¡
 
	g‹¡_v®ue_d©”ªge1_qu”›s
[] = {

1415 { 
NULL
, NULL }

1419 
boŞ
 
	$‹¡_qp_v®ue_d©”ªge1
()

1421 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1422 
X­Ÿn
::
D©eV®ueRªgeProûssÜ
 
	`v½_d©e
(1, 
Œue
, 1960);

1423 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_d©e
);

1424 cÚ¡ 
‹¡
 *
p
 = 
‹¡_v®ue_d©”ªge1_qu”›s
;…->
qu”y
; ++p) {

1425 
¡ršg
 
ex³ù
, 
·r£d
;

1426 ià(
p
->
ex³ù
)

1427 
ex³ù
 = 
p
->expect;

1429 
ex³ù
 = "parseƒrror";

1430 
Œy
 {

1431 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
);

1432 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1433 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1434 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1435 
·r£d
 = 
e
.
	`g‘_msg
();

1436 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1437 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1438 } 
	`ÿtch
 (...) {

1439 
·r£d
 = "Unknownƒxception!";

1441 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1442 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1444  
Œue
;

1445 
	}
}

1447 cÚ¡ 
‹¡
 
	g‹¡_v®ue_d©”ªge2_qu”›s
[] = {

1457 { 
NULL
, NULL }

1461 
boŞ
 
	$‹¡_qp_v®ue_d©”ªge2
()

1463 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1464 
X­Ÿn
::
D©eV®ueRªgeProûssÜ
 
	`v½_cd©e
(1, "ü—‹d:", 
Œue
,rue, 1970);

1465 
X­Ÿn
::
D©eV®ueRªgeProûssÜ
 
	`v½_md©e
(2, "modif›d:", 
Œue
,rue, 1970);

1466 
X­Ÿn
::
D©eV®ueRªgeProûssÜ
 
	`v½_ad©e
(3, "acûs£d:", 
Œue
,rue, 1970);

1467 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_cd©e
);

1468 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_md©e
);

1469 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_ad©e
);

1470 cÚ¡ 
‹¡
 *
p
 = 
‹¡_v®ue_d©”ªge2_qu”›s
;…->
qu”y
; ++p) {

1471 
¡ršg
 
ex³ù
, 
·r£d
;

1472 ià(
p
->
ex³ù
)

1473 
ex³ù
 = 
p
->expect;

1475 
ex³ù
 = "parseƒrror";

1476 
Œy
 {

1477 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
);

1478 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1479 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1480 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1481 
·r£d
 = 
e
.
	`g‘_msg
();

1482 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1483 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1484 } 
	`ÿtch
 (...) {

1485 
·r£d
 = "Unknownƒxception!";

1487 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1488 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1490  
Œue
;

1491 
	}
}

1493 cÚ¡ 
‹¡
 
	g‹¡_v®ue_¡ršg¿nge1_qu”›s
[] = {

1496 { 
NULL
, NULL }

1500 
boŞ
 
	$‹¡_qp_v®ue_¡ršg¿nge1
()

1502 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1503 
X­Ÿn
::
SŒšgV®ueRªgeProûssÜ
 
	`v½_deçuÉ
(0);

1504 
X­Ÿn
::
SŒšgV®ueRªgeProûssÜ
 
	`v½_g
(1, "g:", 
Œue
);

1505 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_g
);

1506 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_deçuÉ
);

1507 cÚ¡ 
‹¡
 *
p
 = 
‹¡_v®ue_¡ršg¿nge1_qu”›s
;…->
qu”y
; ++p) {

1508 
¡ršg
 
ex³ù
, 
·r£d
;

1509 ià(
p
->
ex³ù
)

1510 
ex³ù
 = 
p
->expect;

1512 
ex³ù
 = "parseƒrror";

1513 
Œy
 {

1514 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
);

1515 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1516 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1517 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1518 
·r£d
 = 
e
.
	`g‘_msg
();

1519 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1520 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1521 } 
	`ÿtch
 (...) {

1522 
·r£d
 = "Unknownƒxception!";

1524 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1525 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1527  
Œue
;

1528 
	}
}

1530 
	gAuthÜV®ueRªgeProûssÜ
 : 
public
 
X­Ÿn
::
V®ueRªgeProûssÜ
 {

1531 
AuthÜV®ueRªgeProûssÜ
() {}

1533 
X­Ÿn
::
v®u’o
 
İ”©Ü
()(
¡d
::
¡ršg
 &
begš
, 
	g¡d
::¡ršg &
’d
) {

1534 ià(!
¡¬tsw™h
(
begš
, "author:"))

1535  
	gX­Ÿn
::
BAD_VALUENO
;

1536 
	gbegš
.
”a£
(0, 7);

1537 
	gbegš
 = 
X­Ÿn
::
Unicode
::
tŞow”
(
begš
);

1538 
	g’d
 = 
X­Ÿn
::
Unicode
::
tŞow”
(
’d
);

1543 cÚ¡ 
‹¡
 
	g‹¡_v®ue_cu¡om¿nge1_qu”›s
[] = {

1545 { 
NULL
, NULL }

1549 
boŞ
 
	$‹¡_qp_v®ue_cu¡om¿nge1
()

1551 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1552 
AuthÜV®ueRªgeProûssÜ
 
v½_authÜ
;

1553 
qp
.
	`add_v®u”ªg•roûssÜ
(&
v½_authÜ
);

1554 cÚ¡ 
‹¡
 *
p
 = 
‹¡_v®ue_cu¡om¿nge1_qu”›s
;…->
qu”y
; ++p) {

1555 
¡ršg
 
ex³ù
, 
·r£d
;

1556 ià(
p
->
ex³ù
)

1557 
ex³ù
 = 
p
->expect;

1559 
ex³ù
 = "parseƒrror";

1560 
Œy
 {

1561 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
);

1562 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1563 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1564 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1565 
·r£d
 = 
e
.
	`g‘_msg
();

1566 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1567 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1568 } 
	`ÿtch
 (...) {

1569 
·r£d
 = "Unknownƒxception!";

1571 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1572 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1574  
Œue
;

1575 
	}
}

1577 
boŞ
 
	$‹¡_qp_¡İli¡1
()

1579 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1580 cÚ¡ * 
¡İwÜds
[] = { "a", "an", "the" };

1581 
X­Ÿn
::
Sim¶eStİ³r
 
	`¡İ
(
¡İwÜds
, stopwords + 3);

1582 
qp
.
	`£t_¡İ³r
(&
¡İ
);

1584 
X­Ÿn
::
T”mI‹¿tÜ
 
i
;

1586 
X­Ÿn
::
Qu”y
 
qu”y1
 = 
qp
.
	`·r£_qu”y
("some mice");

1587 
i
 = 
qp
.
	`¡İli¡_begš
();

1588 
	`TEST
(
i
 =ğ
qp
.
	`¡İli¡_’d
());

1590 
X­Ÿn
::
Qu”y
 
qu”y2
 = 
qp
.
	`·r£_qu”y
("the cat");

1591 
i
 = 
qp
.
	`¡İli¡_begš
();

1592 
	`TEST
(
i
 !ğ
qp
.
	`¡İli¡_’d
());

1593 
	`TEST_EQUAL
(*
i
, "the");

1594 ++
i
;

1595 
	`TEST
(
i
 =ğ
qp
.
	`¡İli¡_’d
());

1599 
X­Ÿn
::
Qu”y
 
qu”y3
 = 
qp
.
	`·r£_qu”y
("an‡ardvark");

1600 
i
 = 
qp
.
	`¡İli¡_begš
();

1601 
	`TEST
(
i
 !ğ
qp
.
	`¡İli¡_’d
());

1602 
	`TEST_EQUAL
(*
i
, "an");

1603 ++
i
;

1604 
	`TEST
(
i
 =ğ
qp
.
	`¡İli¡_’d
());

1606  
Œue
;

1607 
	}
}

1609 cÚ¡ 
‹¡
 
	g‹¡_mi¥–Ëd_qu”›s
[] = {

1620 { 
NULL
, NULL }

1624 
boŞ
 
	$‹¡_qp_¥–l1
()

1626 
	`mkdœ
(".flint", 0755);

1627 
¡ršg
 
dbdœ
 = ".flint/qp_spell1";

1628 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1630 
db
.
	`add_¥–lšg
("document");

1631 
db
.
	`add_¥–lšg
("search");

1632 
db
.
	`add_¥–lšg
("paragraph");

1633 
db
.
	`add_¥–lšg
("band");

1635 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1636 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

1637 
qp
.
	`£t_d©aba£
(
db
);

1639 cÚ¡ 
‹¡
 *
p
 = 
‹¡_mi¥–Ëd_qu”›s
;…->
qu”y
; ++p) {

1640 
X­Ÿn
::
Qu”y
 
q
;

1641 
q
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
,

1642 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_SPELLING_CORRECTION
 |

1643 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
 );

1644 
tout
 << "Qu”y: " << 
p
->
qu”y
 << 
’dl
;

1645 
	`TEST_STRINGS_EQUAL
(
qp
.
	`g‘_cÜ»ùed_qu”y_¡ršg
(), 
p
->
ex³ù
);

1648  
Œue
;

1649 
	}
}

1652 
boŞ
 
	$‹¡_qp_¥–l2
()

1654 
	`mkdœ
(".flint", 0755);

1655 
¡ršg
 
dbdœ
 = ".flint/qp_spell2";

1656 
X­Ÿn
::
Wr™abËD©aba£
 
	`db1
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1658 
db1
.
	`add_¥–lšg
("document");

1659 
db1
.
	`add_¥–lšg
("search");

1660 
db1
.
	`comm™
();

1662 
dbdœ
 = ".flint/qp_spell2b";

1663 
X­Ÿn
::
Wr™abËD©aba£
 
	`db2
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1665 
db2
.
	`add_¥–lšg
("document");

1666 
db2
.
	`add_¥–lšg
("paragraph");

1667 
db2
.
	`add_¥–lšg
("band");

1669 
X­Ÿn
::
D©aba£
 
db
;

1670 
db
.
	`add_d©aba£
(
db1
);

1671 
db
.
	`add_d©aba£
(
db2
);

1673 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1674 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

1675 
qp
.
	`£t_d©aba£
(
db
);

1677 cÚ¡ 
‹¡
 *
p
 = 
‹¡_mi¥–Ëd_qu”›s
;…->
qu”y
; ++p) {

1678 
X­Ÿn
::
Qu”y
 
q
;

1679 
q
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
,

1680 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_SPELLING_CORRECTION
 |

1681 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
 );

1682 
tout
 << "Qu”y: " << 
p
->
qu”y
 << 
’dl
;

1683 
	`TEST_STRINGS_EQUAL
(
qp
.
	`g‘_cÜ»ùed_qu”y_¡ršg
(), 
p
->
ex³ù
);

1686  
Œue
;

1687 
	}
}

1689 cÚ¡ 
‹¡
 
	g‹¡_mi¥–Ëd_wdÿrd_qu”›s
[] = {

1694 { 
NULL
, NULL }

1699 
boŞ
 
	$‹¡_qp_¥–lwd1
()

1701 
	`mkdœ
(".flint", 0755);

1702 
¡ršg
 
dbdœ
 = ".flint/qp_spellwild1";

1703 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1705 
db
.
	`add_¥–lšg
("document");

1706 
db
.
	`add_¥–lšg
("search");

1707 
db
.
	`add_¥–lšg
("paragraph");

1708 
db
.
	`add_¥–lšg
("band");

1710 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1711 
qp
.
	`£t_d©aba£
(
db
);

1713 cÚ¡ 
‹¡
 *
p
;

1714 
p
 = 
‹¡_mi¥–Ëd_qu”›s
;…->
qu”y
; ++p) {

1715 
X­Ÿn
::
Qu”y
 
q
;

1716 
q
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
,

1717 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_SPELLING_CORRECTION
 |

1718 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
 |

1719 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

1720 
tout
 << "Qu”y: " << 
p
->
qu”y
 << 
’dl
;

1721 
	`TEST_STRINGS_EQUAL
(
qp
.
	`g‘_cÜ»ùed_qu”y_¡ršg
(), 
p
->
ex³ù
);

1723 
p
 = 
‹¡_mi¥–Ëd_wdÿrd_qu”›s
;…->
qu”y
; ++p) {

1724 
X­Ÿn
::
Qu”y
 
q
;

1725 
q
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
,

1726 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_SPELLING_CORRECTION
 |

1727 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
 |

1728 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_WILDCARD
);

1729 
tout
 << "Qu”y: " << 
p
->
qu”y
 << 
’dl
;

1730 
	`TEST_STRINGS_EQUAL
(
qp
.
	`g‘_cÜ»ùed_qu”y_¡ršg
(), 
p
->
ex³ù
);

1733  
Œue
;

1734 
	}
}

1736 cÚ¡ 
‹¡
 
	g‹¡_mi¥–Ëd_·¹Ÿl_qu”›s
[] = {

1743 { 
NULL
, NULL }

1748 
boŞ
 
	$‹¡_qp_¥–Í¬tŸl1
()

1750 
	`mkdœ
(".flint", 0755);

1751 
¡ršg
 
dbdœ
 = ".flint/qp_spellpartial1";

1752 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1754 
db
.
	`add_¥–lšg
("document");

1755 
db
.
	`add_¥–lšg
("search");

1756 
db
.
	`add_¥–lšg
("paragraph");

1757 
db
.
	`add_¥–lšg
("band");

1759 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1760 
qp
.
	`£t_d©aba£
(
db
);

1762 cÚ¡ 
‹¡
 *
p
 = 
‹¡_mi¥–Ëd_·¹Ÿl_qu”›s
;…->
qu”y
; ++p) {

1763 
X­Ÿn
::
Qu”y
 
q
;

1764 
q
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
,

1765 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_SPELLING_CORRECTION
 |

1766 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PARTIAL
);

1767 
tout
 << "Qu”y: " << 
p
->
qu”y
 << 
’dl
;

1768 
	`TEST_STRINGS_EQUAL
(
qp
.
	`g‘_cÜ»ùed_qu”y_¡ršg
(), 
p
->
ex³ù
);

1771  
Œue
;

1772 
	}
}

1774 cÚ¡ 
‹¡
 
	g‹¡_synÚym_qu”›s
[] = {

1788 { 
NULL
, NULL }

1792 
boŞ
 
	$‹¡_qp_synÚym1
()

1794 
	`mkdœ
(".flint", 0755);

1795 
¡ršg
 
dbdœ
 = ".flint/qp_synonym1";

1796 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1798 
db
.
	`add_synÚym
("Zsearch", "Zfind");

1799 
db
.
	`add_synÚym
("Zsearch", "Zlocate");

1800 
db
.
	`add_synÚym
("search", "find");

1801 
db
.
	`add_synÚym
("Zseek", "Zsearch");

1803 
db
.
	`comm™
();

1805 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1806 
qp
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

1807 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

1808 
qp
.
	`£t_d©aba£
(
db
);

1810 cÚ¡ 
‹¡
 *
p
 = 
‹¡_synÚym_qu”›s
;…->
qu”y
; ++p) {

1811 
¡ršg
 
ex³ù
 = "Xapian::Query(";

1812 
ex³ù
 +ğ
p
->expect;

1813 
ex³ù
 += ')';

1814 
X­Ÿn
::
Qu”y
 
q
;

1815 
q
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
, qp.
FLAG_AUTO_SYNONYMS
|qp.
FLAG_DEFAULT
);

1816 
tout
 << "Qu”y: " << 
p
->
qu”y
 << 
’dl
;

1817 
	`TEST_STRINGS_EQUAL
(
q
.
	`g‘_desütiÚ
(), 
ex³ù
);

1820  
Œue
;

1821 
	}
}

1823 cÚ¡ 
‹¡
 
	g‹¡_muÉi_synÚym_qu”›s
[] = {

1830 { 
NULL
, NULL }

1834 
boŞ
 
	$‹¡_qp_synÚym2
()

1836 
	`mkdœ
(".flint", 0755);

1837 
¡ršg
 
dbdœ
 = ".flint/qp_synonym2";

1838 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1840 
db
.
	`add_synÚym
("sunan cream", "lotion");

1841 
db
.
	`add_synÚym
("sunan", "bathe");

1842 
db
.
	`add_synÚym
("single", "record");

1844 
db
.
	`comm™
();

1846 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1847 
qp
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

1848 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

1849 
qp
.
	`£t_d©aba£
(
db
);

1851 cÚ¡ 
‹¡
 *
p
 = 
‹¡_muÉi_synÚym_qu”›s
;…->
qu”y
; ++p) {

1852 
¡ršg
 
ex³ù
 = "Xapian::Query(";

1853 
ex³ù
 +ğ
p
->expect;

1854 
ex³ù
 += ')';

1855 
X­Ÿn
::
Qu”y
 
q
;

1856 
q
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
,

1857 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_AUTO_MULTIWORD_SYNONYMS
 |

1858 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_DEFAULT
);

1859 
tout
 << "Qu”y: " << 
p
->
qu”y
 << 
’dl
;

1860 
	`TEST_STRINGS_EQUAL
(
q
.
	`g‘_desütiÚ
(), 
ex³ù
);

1863  
Œue
;

1864 
	}
}

1866 cÚ¡ 
‹¡
 
	g‹¡_synÚym_İ_qu”›s
[] = {

1881 { 
NULL
, NULL }

1885 
boŞ
 
	$‹¡_qp_synÚym3
()

1887 
	`mkdœ
(".flint", 0755);

1888 
¡ršg
 
dbdœ
 = ".flint/qp_synonym3";

1889 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

1891 
db
.
	`add_synÚym
("Zsearch", "Zfind");

1892 
db
.
	`add_synÚym
("Zsearch", "Zlocate");

1893 
db
.
	`add_synÚym
("search", "find");

1894 
db
.
	`add_synÚym
("Zseek", "Zsearch");

1896 
db
.
	`comm™
();

1898 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1899 
qp
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

1900 
qp
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

1901 
qp
.
	`£t_d©aba£
(
db
);

1903 cÚ¡ 
‹¡
 *
p
 = 
‹¡_synÚym_İ_qu”›s
;…->
qu”y
; ++p) {

1904 
¡ršg
 
ex³ù
 = "Xapian::Query(";

1905 
ex³ù
 +ğ
p
->expect;

1906 
ex³ù
 += ')';

1907 
X­Ÿn
::
Qu”y
 
q
;

1908 
q
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
,

1909 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_SYNONYM
 |

1910 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_BOOLEAN
 |

1911 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_LOVEHATE
 |

1912 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_PHRASE
 );

1913 
tout
 << "Qu”y: " << 
p
->
qu”y
 << 
’dl
;

1914 
	`TEST_STRINGS_EQUAL
(
q
.
	`g‘_desütiÚ
(), 
ex³ù
);

1917  
Œue
;

1918 
	}
}

1920 cÚ¡ 
‹¡
 
	g‹¡_¡em_®l_qu”›s
[] = {

1924 { 
NULL
, NULL }

1927 
boŞ
 
	$‹¡_qp_¡em_®l1
()

1929 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

1930 
qp
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

1931 
qp
.
	`£t_¡emmšg_¡¿‹gy
(qp.
STEM_ALL
);

1932 cÚ¡ 
‹¡
 *
p
 = 
‹¡_¡em_®l_qu”›s
;…->
qu”y
; ++p) {

1933 
¡ršg
 
ex³ù
, 
·r£d
;

1934 ià(
p
->
ex³ù
)

1935 
ex³ù
 = 
p
->expect;

1937 
ex³ù
 = "parseƒrror";

1938 
Œy
 {

1939 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
);

1940 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

1941 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

1942 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

1943 
·r£d
 = 
e
.
	`g‘_msg
();

1944 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

1945 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

1946 } 
	`ÿtch
 (...) {

1947 
·r£d
 = "Unknownƒxception!";

1949 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

1950 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

1952  
Œue
;

1953 
	}
}

1955 
time_qu”y_·r£
(cÚ¡ 
X­Ÿn
::
D©aba£
 & 
db
,

1956 cÚ¡ 
¡ršg
 & 
q
,

1957 
»³t™iÚs
,

1958 
æags
)

1960 
	gX­Ÿn
::
Qu”yP¬£r
 
qp
;

1961 
	gqp
.
£t_d©aba£
(
db
);

1962 
CPUTim”
 
	gtim”
;

1963 
	g¡d
::
veùÜ
<
X­Ÿn
::
Qu”y
> 
qs
;

1964 
	gqs
.
»£rve
(
»³t™iÚs
);

1965 
	gi
 = 0; i !ğ
»³t™iÚs
; ++i) {

1966 
	gqs
.
push_back
(
qp
.
·r£_qu”y
(
q
, 
æags
));

1968 ià(
	g»³t™iÚs
 > 1) {

1969 
	gX­Ÿn
::
Qu”y
 
qc
(
X­Ÿn
::Qu”y::
OP_OR
, 
qs
.
begš
(), qs.
’d
());

1971  
	gtim”
.
g‘_time
();

1975 
qp_sÿË1_h–³r
(cÚ¡ 
X­Ÿn
::
D©aba£
 &
db
, cÚ¡ 
¡ršg
 & 
q
, 
n
,

1976 
æags
)

1978 
	gtime1
;

1979 
	gŒue
) {

1980 
	gtime1
 = 
time_qu”y_·r£
(
db
, 
q
, 
n
, 
æags
);

1981 ià(
	gtime1
 != 0.0) ;

1985 
	gn_Ãw
 = 
n
 * 10;

1986 ià(
	gn_Ãw
 < 
	gn
)

1987 
SKIP_TEST
("Can't countƒnough„epetitionso be‡bleoimeest");

1988 
	gn
 = 
n_Ãw
;

1991 
¡ršg
 
	gq_n
;

1992 
	gq_n
.
»£rve
(
q
.
size
(è* 
n
);

1993 
	gi
 = 
n
; i != 0; --i) {

1994 
	gq_n
 +ğ
q
;

1997 
	gtime2
 = 
time_qu”y_·r£
(
db
, 
q_n
, 1, 
æags
);

1998 
	gtout
 << "sm®l=" << 
	gtime1
 << "s,†¬ge=" << 
	gtime2
 << "s\n";

2002 
TEST_REL
(
time2
,<,
time1
 * 2.15);

2007 
boŞ
 
	$‹¡_qp_sÿË1
()

2009 
	`mkdœ
(".flint", 0755);

2010 
¡ršg
 
dbdœ
 = ".flint/qp_scale1";

2011 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

2013 
db
.
	`add_synÚym
("foo", "bar");

2014 
db
.
	`comm™
();

2016 
¡ršg
 
	`q1
("foo ");

2017 
¡ršg
 
	`q1b
("baz ");

2018 cÚ¡ 
»³t™iÚs
 = 5000;

2021 
¡ršg
 
syn
;

2022 
j
 = 60; j != 0; --j) {

2023 
syn
 +ğ
q1
;

2025 
syn
.
	`»size
(syn.
	`size
() - 1);

2027 
synæags
 = 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_DEFAULT
 |

2028 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_SYNONYM
 |

2029 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_AUTO_MULTIWORD_SYNONYMS
;

2032 
	`qp_sÿË1_h–³r
(
db
, 
q1
, 
»³t™iÚs
, 
X­Ÿn
::
Qu”yP¬£r
::
FLAG_DEFAULT
);

2036 
	`qp_sÿË1_h–³r
(
db
, 
q1b
, 
»³t™iÚs
, 
synæags
);

2039 
	`qp_sÿË1_h–³r
(
db
, 
q1
, 
»³t™iÚs
, 
synæags
);

2042 
db
.
	`add_synÚym
(
syn
, "bar");

2043 
db
.
	`comm™
();

2045 
	`qp_sÿË1_h–³r
(
db
, 
q1
, 
»³t™iÚs
, 
synæags
);

2047  
Œue
;

2048 
	}
}

2050 cÚ¡ 
‹¡
 
	g‹¡_Ã¬_qu”›s
[] = {

2079 { 
NULL
, NULL }

2082 
boŞ
 
	$‹¡_qp_Ã¬1
()

2084 
X­Ÿn
::
Qu”yP¬£r
 
qu”y·r£r
;

2085 
qu”y·r£r
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
("english"));

2086 
qu”y·r£r
.
	`£t_¡emmšg_¡¿‹gy
(
X­Ÿn
::
Qu”yP¬£r
::
STEM_SOME
);

2087 
qu”y·r£r
.
	`add_´efix
("author", "A");

2088 
qu”y·r£r
.
	`add_´efix
("writer", "A");

2089 
qu”y·r£r
.
	`add_´efix
("title", "XT");

2090 
qu”y·r£r
.
	`add_´efix
("subject", "XT");

2091 
qu”y·r£r
.
	`add_´efix
("authortitle", "A");

2092 
qu”y·r£r
.
	`add_´efix
("authortitle", "XT");

2093 
qu”y·r£r
.
	`add_boŞ—n_´efix
("site", "H");

2094 
qu”y·r£r
.
	`add_boŞ—n_´efix
("site2", "J");

2095 
qu”y·r£r
.
	`add_boŞ—n_´efix
("multisite", "H");

2096 
qu”y·r£r
.
	`add_boŞ—n_´efix
("multisite", "J");

2097 
qu”y·r£r
.
	`add_boŞ—n_´efix
("category", "XCAT");

2098 
qu”y·r£r
.
	`£t_deçuÉ_İ
(
X­Ÿn
::
Qu”y
::
OP_NEAR
);

2099 cÚ¡ 
‹¡
 *
p
 = 
‹¡_Ã¬_qu”›s
;…->
qu”y
; ++p) {

2100 
¡ršg
 
ex³ù
, 
·r£d
;

2101 ià(
p
->
ex³ù
)

2102 
ex³ù
 = 
p
->expect;

2104 
ex³ù
 = "parseƒrror";

2105 
Œy
 {

2106 
X­Ÿn
::
Qu”y
 
qobj
 = 
qu”y·r£r
.
	`·r£_qu”y
(
p
->
qu”y
);

2107 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

2108 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

2109 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

2110 
·r£d
 = 
e
.
	`g‘_msg
();

2111 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

2112 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

2113 } 
	`ÿtch
 (...) {

2114 
·r£d
 = "Unknownƒxception!";

2116 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

2117 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

2119  
Œue
;

2120 
	}
}

2122 cÚ¡ 
‹¡
 
	g‹¡_¡İwÜd_group_Ü_qu”›s
[] = {

2130 { 
NULL
, NULL }

2133 cÚ¡ 
‹¡
 
	g‹¡_¡İwÜd_group_ªd_qu”›s
[] = {

2144 { 
NULL
, NULL }

2148 
boŞ
 
	$‹¡_qp_¡İwÜd_group1
()

2150 #iâdeà
XAPIAN_HAS_INMEMORY_BACKEND


2151 
	`SKIP_TEST
("Testcase„equireshe InMemory backend which is disabled");

2153 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(X­Ÿn::
InMemÜy
::
	`İ’
());

2154 
X­Ÿn
::
Docum’t
 
doc
;

2155 
doc
.
	`add_‹rm
("test");

2156 
doc
.
	`add_‹rm
("tester");

2157 
doc
.
	`add_‹rm
("testable");

2158 
doc
.
	`add_‹rm
("user");

2159 
db
.
	`add_docum’t
(
doc
);

2161 
X­Ÿn
::
Sim¶eStİ³r
 
¡İ³r
;

2162 
¡İ³r
.
	`add
("this");

2163 
¡İ³r
.
	`add
("is");

2164 
¡İ³r
.
	`add
("a");

2166 
X­Ÿn
::
Qu”yP¬£r
 
qp
;

2167 
qp
.
	`£t_¡İ³r
(&
¡İ³r
);

2168 
qp
.
	`£t_d©aba£
(
db
);

2171 
qp
.
	`£t_deçuÉ_İ
(
X­Ÿn
::
Qu”y
::
OP_OR
);

2172 cÚ¡ 
‹¡
 *
p
 = 
‹¡_¡İwÜd_group_Ü_qu”›s
;

2173 
i
 = 1; i <= 2; ++i) {

2174  ; 
p
->
qu”y
; ++p) {

2175 
¡ršg
 
ex³ù
, 
·r£d
;

2176 ià(
p
->
ex³ù
)

2177 
ex³ù
 = 
p
->expect;

2179 
ex³ù
 = "parseƒrror";

2180 
Œy
 {

2181 
X­Ÿn
::
Qu”y
 
qobj
 = 
qp
.
	`·r£_qu”y
(
p
->
qu”y
, qp.
FLAG_WILDCARD
);

2182 
·r£d
 = 
qobj
.
	`g‘_desütiÚ
();

2183 
ex³ù
 = 
	`¡ršg
("Xapian::Query(") +ƒxpect + ')';

2184 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
Qu”yP¬£rE¼Ü
 &
e
) {

2185 
·r£d
 = 
e
.
	`g‘_msg
();

2186 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

2187 
·r£d
 = 
e
.
	`g‘_desütiÚ
();

2188 } 
	`ÿtch
 (...) {

2189 
·r£d
 = "Unknownƒxception!";

2191 
tout
 << "Qu”y: " << 
p
->
qu”y
 << '\n';

2192 
	`TEST_STRINGS_EQUAL
(
·r£d
, 
ex³ù
);

2195 
qp
.
	`£t_deçuÉ_İ
(
X­Ÿn
::
Qu”y
::
OP_AND
);

2196 
p
 = 
‹¡_¡İwÜd_group_ªd_qu”›s
;

2199  
Œue
;

2201 
	}
}

2204 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

2205 
TESTCASE
(
qu”y·r£r1
),

2206 
TESTCASE
(
qp_deçuÉ_İ1
),

2207 
TESTCASE
(
qp_odd_ch¬s1
),

2208 
TESTCASE
(
qp_æag_wdÿrd1
),

2209 
TESTCASE
(
qp_æag_wdÿrd2
),

2210 
TESTCASE
(
qp_æag_·¹Ÿl1
),

2211 
TESTCASE
(
qp_æag_boŞ_ªy_ÿ£1
),

2212 
TESTCASE
(
qp_¡İ³r1
),

2213 
TESTCASE
(
qp_æag_pu»_nÙ1
),

2214 
TESTCASE
(
qp_un¡em_boŞ—n_´efix
),

2215 
TESTCASE
(
qp_deçuÉ_´efix1
),

2216 
TESTCASE
(
qp_deçuÉ_´efix2
),

2217 
TESTCASE
(
v®ue_¿nge_£rŸli£1
),

2218 
TESTCASE
(
qp_v®ue_¿nge1
),

2219 
TESTCASE
(
qp_v®ue_¿nge2
),

2220 
TESTCASE
(
qp_v®ue_¿nge3
),

2221 
TESTCASE
(
qp_v®ue_d©”ªge1
),

2222 
TESTCASE
(
qp_v®ue_d©”ªge2
),

2223 
TESTCASE
(
qp_v®ue_¡ršg¿nge1
),

2224 
TESTCASE
(
qp_v®ue_cu¡om¿nge1
),

2225 
TESTCASE
(
qp_¡İli¡1
),

2226 
TESTCASE
(
qp_¥–l1
),

2227 
TESTCASE
(
qp_¥–l2
),

2228 
TESTCASE
(
qp_¥–lwd1
),

2229 
TESTCASE
(
qp_¥–Í¬tŸl1
),

2230 
TESTCASE
(
qp_synÚym1
),

2231 
TESTCASE
(
qp_synÚym2
),

2232 
TESTCASE
(
qp_synÚym3
),

2233 
TESTCASE
(
qp_¡em_®l1
),

2234 
TESTCASE
(
qp_sÿË1
),

2235 
TESTCASE
(
qp_Ã¬1
),

2236 
TESTCASE
(
qp_¡İwÜd_group1
),

2237 
END_OF_TESTCASES


2240 
	$maš
(
¬gc
, **
¬gv
)

2242 
‹¡_driv”
::
	`·r£_commªd_lše
(
¬gc
, 
¬gv
);

2243  
‹¡_driv”
::
	`run
(
‹¡s
);

2244 
	}
}

	@tests/stemtest.cc

23 
	~<cÚfig.h
>

25 
	~<c¡dlib
>

27 
	~<¡ršg
>

28 
	~<f¡»am
>

29 
	~<io¡»am
>

31 
	~<x­Ÿn/¡em.h
>

32 
	~"‹¡su™e.h
"

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 cÚ¡ 
	gJUNKSIZE
 = 2 * 1048576;

38 
¡ršg
 
	gÏnguage
;

40 
	gX­Ÿn
::
S‹m
 
¡emm”
;

42 
¡ršg
 
	g¤cdœ
;

44 
	g£ed
;

47 
boŞ


48 
	$‹¡_¡em¿ndom
()

50 cÚ¡ 
wÜdch¬s
[] =

53 
tout
 << "S‹mmšg„ªdomext... (£ed " << 
£ed
 << ")" << 
’dl
;

54 
	`¤ªd
(
£ed
);

56 
¡ršg
 
wÜd
;

57 
¡emmed_size
 = 0;

58 
c
 = 
JUNKSIZE
; c; --c) {

59 
ch
 = 
wÜdch¬s
[(
	`¿nd
() >> 8) %  wordchars];

60 ià(
ch
) {

61 
wÜd
 +ğ
ch
;

64 
¡emmed_size
 +ğ
	`¡emm”
(
wÜd
).
	`Ëngth
();

65 
wÜd
.
	`»size
(0);

67 
¡emmed_size
 +ğ
	`¡emm”
(
wÜd
).
	`Ëngth
();

68 
tout
 << "IÅuˆsiz" << 
JUNKSIZE
 << ", s‹mmed siz" << 
¡emmed_size


69 << 
’dl
;

71 ià(
¡emmed_size
 > 
JUNKSIZE
 * 101 / 100) {

72 
	`FAIL_TEST
("Stemmed data is significantly biggerhan input: "

73 << 
¡emmed_size
 << " vs. " << 
JUNKSIZE
);

75 ià(
¡emmed_size
 < 
JUNKSIZE
 / 2) {

76 
	`FAIL_TEST
("Stemmed data is significantly smallerhan input: "

77 << 
¡emmed_size
 << " vs. " << 
JUNKSIZE
);

79  
Œue
;

80 
	}
}

83 
boŞ


84 
	$‹¡_¡emjunk
()

86 
tout
 << "S‹mmšg„ªdom junk... (£ed " << 
£ed
 << ")" << 
’dl
;

87 
	`¤ªd
(
£ed
);

89 
¡ršg
 
wÜd
;

90 
¡emmed_size
 = 0;

91 
c
 = 
JUNKSIZE
; c; --c) {

92 
ch
 = 
	`¿nd
() >> 8;

93 ià(
ch
) {

94 
wÜd
 +ğ
ch
;

97 
¡emmed_size
 +ğ
	`¡emm”
(
wÜd
).
	`Ëngth
();

98 
wÜd
.
	`»size
(0);

100 
¡emmed_size
 +ğ
	`¡emm”
(
wÜd
).
	`Ëngth
();

101 
tout
 << "IÅuˆsiz" << 
JUNKSIZE
 << ", s‹mmed siz" << 
¡emmed_size


102 << 
’dl
;

104 ià(
¡emmed_size
 > 
JUNKSIZE
 * 101 / 100) {

105 
	`FAIL_TEST
("Stemmed data is significantly biggerhan input ("

106 << 
¡emmed_size
 << " vs. " << 
JUNKSIZE
);

108 ià(
¡emmed_size
 < 
JUNKSIZE
 / 2) {

109 
	`FAIL_TEST
("Stemmed data is significantly smallerhan input ("

110 << 
¡emmed_size
 << " vs. " << 
JUNKSIZE
);

112  
Œue
;

113 
	}
}

115 
boŞ


116 
	$‹¡_¡emdiù
()

118 
¡ršg
 
dœ
 = 
¤cdœ
 + "/../../xapian-data/stemming/";

120 
if¡»am
 
	`voc
((
dœ
 + 
Ïnguage
 + "/voc.txt").
	`c_¡r
());

121 ià(!
voc
.
	`is_İ’
()) {

122 
	`SKIP_TEST
(
Ïnguage
 + "/voc.txt‚ot found");

125 
if¡»am
 
	`¡
((
dœ
 + 
Ïnguage
 + "/ouut.txt").
	`c_¡r
());

126 ià(!
¡
.
	`is_İ’
()) {

127 
voc
.
	`şo£
();

128 
	`FAIL_TEST
(
Ïnguage
 + "/output.txt‚ot found");

131 
tout
 << "Te¡šg " << 
Ïnguage
 << " w™h Snowb®ÈdiùiÚ¬y..." << 
’dl
;

133 
·ss
 = 1;

134 
Œue
) {

135 
¡ršg
 
wÜd
, 
¡em
, 
ex³ù
;

136 !
voc
.
	`eof
(è&& !
¡
.eof()) {

137 
	`g‘lše
(
voc
, 
wÜd
);

138 
	`g‘lše
(
¡
, 
ex³ù
);

140 
¡em
 = 
	`¡emm”
(
wÜd
);

142 
	`TEST_EQUAL
(
¡em
, 
ex³ù
);

144 
voc
.
	`şo£
();

145 
¡
.
	`şo£
();

147 ià(
·ss
 == 2) ;

149 
voc
.
	`İ’
((
dœ
 + 
Ïnguage
 + "/voc2.txt").
	`c_¡r
());

150 ià(!
voc
.
	`is_İ’
()) ;

152 
¡
.
	`İ’
((
dœ
 + 
Ïnguage
 + "/ouut2.txt").
	`c_¡r
());

153 ià(!
¡
.
	`is_İ’
()) {

154 
voc
.
	`şo£
();

155 
	`FAIL_TEST
(
Ïnguage
 + "/output2.txt‚ot found");

157 
tout
 << "Te¡šg " << 
Ïnguage
 << " with supplemental dictionary..."

158 << 
’dl
;

159 ++
·ss
;

162  
Œue
;

163 
	}
}

170 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

171 {"¡em¿ndom", 
‹¡_¡em¿ndom
},

172 {"¡emjunk", 
‹¡_¡emjunk
},

173 {"¡emdiù", 
‹¡_¡emdiù
},

177 
	$maš
(
¬gc
, **
¬gv
)

179 
¡ršg
 
Ïngs
 = 
X­Ÿn
::
S‹m
::
	`g‘_avaabË_Ïnguages
();

180 
‹¡_driv”
::
	`add_commªd_lše_İtiÚ
("Ïnguages", 'l', &
Ïngs
);

182 
£ed
 = 42;

183 
¡ršg
 
£ed_¡r
;

184 
‹¡_driv”
::
	`add_commªd_lše_İtiÚ
("£ed", 's', &
£ed_¡r
);

186 
‹¡_driv”
::
	`·r£_commªd_lše
(
¬gc
, 
¬gv
);

187 
¤cdœ
 = 
‹¡_driv”
::
	`g‘_¤cdœ
();

188 
»suÉ
 = 0;

190 ià(!
£ed_¡r
.
	`em±y
()è
£ed
 = 
	`©oi
(£ed_¡r.
	`c_¡r
());

191 
cout
 << "Th¿ndom s“d i " << 
£ed
 << 
’dl
;

192 
cout
 << "PËa£„•Üˆth£ed wh’„•Ütšg‡e¡ fau»." << 
’dl
;

194 
¡ršg
::
size_ty³
 
b
 = 0;

195 
b
 !ğ
Ïngs
.
	`size
()) {

196 
¡ršg
::
size_ty³
 
a
 = 
b
;

197 
b
 < 
Ïngs
.
	`size
() &&†angs[b] != ' ') ++b;

198 
Ïnguage
 = 
Ïngs
.
	`sub¡r
(
a
, 
b
 -‡);

199 
b
 < 
Ïngs
.
	`size
() &&†angs[b] == ' ') ++b;

200 
cout
 << "RuÂšge¡ w™h " << 
Ïnguage
 << " s‹mm”..." << 
’dl
;

201 
¡emm”
 = 
X­Ÿn
::
	`S‹m
(
Ïnguage
);

202 
»suÉ
 = 
	`max
ÔesuÉ, 
‹¡_driv”
::
	`run
(
‹¡s
));

204  
»suÉ
;

205 
	}
}

	@tests/termgentest.cc

22 
	~<cÚfig.h
>

24 
	~<x­Ÿn.h
>

26 
	~<¡ršg
>

28 
	~"‹¡su™e.h
"

29 
	~"‹¡uts.h
"

30 
	~"uts.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
	#TESTCASE
(
S
è{#S, 
‹¡_
##S}

	)

35 
	#END_OF_TESTCASES
 {0, 0}

	)

37 
	s‹¡
 {

47 cÚ¡ *
	mİtiÚs
;

50 cÚ¡ *
	m‹xt
;

58 cÚ¡ *
	mex³ù
;

61 cÚ¡ 
‹¡
 
	g‹¡_sim¶e
[] = {

115 { 
NULL
, NULL, NULL }

610 
¡ršg


611 
fÜm©_doc_‹rmli¡
(cÚ¡ 
X­Ÿn
::
Docum’t
 & 
doc
)

613 
¡ršg
 
ouut
;

614 
	gX­Ÿn
::
T”mI‹¿tÜ
 
™
;

615 
	g™
 = 
doc
.
‹rmli¡_begš
(); iˆ!ğdoc.
‹rmli¡_’d
(); ++it) {

616 ià(!
	gouut
.
em±y
()) output += ' ';

617 
	gouut
 +ğ*
™
;

618 ià(
	g™
.
pos™iÚli¡_couÁ
() != 0) {

621 ià(
™
.
g‘_wdf
(è!ğ™.
pos™iÚli¡_couÁ
()) {

622 
ouut
 += ':';

623 
	gouut
 +ğ
om_to¡ršg
(
™
.
g‘_wdf
());

625 
	gch
 = '[';

626 
	gX­Ÿn
::
Pos™iÚI‹¿tÜ
 
pos™
;

627 
	gpos™
 = 
™
.
pos™iÚli¡_begš
();…os™ !ğ™.
pos™iÚli¡_’d
();…osit++) {

628 
	gouut
 +ğ
ch
;

629 
	gch
 = ',';

630 
	gouut
 +ğ
om_to¡ršg
(*
pos™
);

632 
	gouut
 += ']';

633 } ià(
	g™
.
g‘_wdf
() != 0) {

635 
ouut
 += ':';

636 
	gouut
 +ğ
om_to¡ršg
(
™
.
g‘_wdf
());

639  
	gouut
;

642 
boŞ
 
	$‹¡_‹rmg’1
()

644 
X­Ÿn
::
T”mG’”©Ü
 
‹rmg’
;

645 
X­Ÿn
::
Docum’t
 
doc
;

646 
‹rmg’
.
	`£t_docum’t
(
doc
);

647 
¡ršg
 
´efix
;

649 cÚ¡ 
‹¡
 *
p
 = 
‹¡_sim¶e
;…->
‹xt
; ++p) {

650 
weight
 = 1;

651 
boŞ
 
Ãw_doc
 = 
Œue
;

652 
boŞ
 
nİos
 = 
çl£
;

654 cÚ¡ * 
o
 = 
p
->
İtiÚs
;

655 *
o
 != '\0') {

656 ià(*
o
 == ',') ++o;

657 ià(
	`¡ºcmp
(
o
, "cont", 4) == 0) {

658 
o
 += 4;

659 
Ãw_doc
 = 
çl£
;

660 } ià(
	`¡ºcmp
(
o
, "nopos", 5) == 0) {

661 
o
 += 5;

662 
nİos
 = 
Œue
;

663 } ià(
	`¡ºcmp
(
o
, "weight=", 7) == 0) {

664 
o
 += 7;

665 
weight
 = 
	`©oi
(
o
);

666 *
o
 >= '0' && *o <= '9')

667 ++
o
;

668 } ià(
	`¡ºcmp
(
o
, "stem=", 5) == 0) {

669 
o
 += 5;

670 
¡ršg
 
¡emm”
;

671 *
o
 != '\0' && *o != ',') {

672 
¡emm”
 +ğ*
o
;

673 ++
o
;

675 
‹rmg’
.
	`£t_¡emm”
(
X­Ÿn
::
	`S‹m
(
¡emm”
));

676 
tout
 << "S‘tšg s‹mm”o: " << 
¡emm”
 << '\n';

677 } ià(
	`¡ºcmp
(
o
, "prefix=", 7) == 0) {

678 
o
 += 7;

679 
´efix
.
	`»size
(0);

680 *
o
 != '\0' && *o != ',') {

681 
´efix
 +ğ*
o
;

682 ++
o
;

685 
	`FAIL_TEST
("Inv®id o±iÚ ¡ršg: " << 
p
->
İtiÚs
);

689 ià(
Ãw_doc
) {

690 
doc
 = 
X­Ÿn
::
	`Docum’t
();

691 
‹rmg’
.
	`£t_docum’t
(
doc
);

693 
‹rmg’
.
	`šü—£_‹rmpos
();

696 
¡ršg
 
ex³ù
, 
ouut
;

697 
ex³ù
 = 
p
->expect;

698 
Œy
 {

699 ià(
nİos
) {

700 
‹rmg’
.
	`šdex_‹xt_w™hout_pos™iÚs
(
p
->
‹xt
, 
weight
, 
´efix
);

702 
‹rmg’
.
	`šdex_‹xt
(
p
->
‹xt
, 
weight
, 
´efix
);

704 
ouut
 = 
	`fÜm©_doc_‹rmli¡
(
doc
);

705 } 
	`ÿtch
 (cÚ¡ 
X­Ÿn
::
E¼Ü
 &
e
) {

706 
ouut
 = 
e
.
	`g‘_desütiÚ
();

707 } 
	`ÿtch
 (...) {

708 
ouut
 = "Unknownƒxception!";

710 ià(
´efix
.
	`em±y
())

711 
tout
 << "Text: " << 
p
->
‹xt
 << '\n';

713 
tout
 << "P»fix: " << 
´efix
 << " Text: " << 
p
->
‹xt
 << '\n';

714 
	`TEST_STRINGS_EQUAL
(
ouut
, 
ex³ù
);

716  
Œue
;

717 
	}
}

720 
boŞ
 
	$‹¡_tg_¥–l1
()

722 
	`mkdœ
(".flint", 0755);

723 
¡ršg
 
dbdœ
 = ".flint/tg_spell1";

724 
X­Ÿn
::
Wr™abËD©aba£
 
	`db
(
dbdœ
, X­Ÿn::
DB_CREATE_OR_OVERWRITE
);

726 
X­Ÿn
::
T”mG’”©Ü
 
‹rmg’
;

727 
X­Ÿn
::
Docum’t
 
doc
;

729 
‹rmg’
.
	`£t_docum’t
(
doc
);

730 
‹rmg’
.
	`£t_d©aba£
(
db
);

731 
‹rmg’
.
	`£t_æags
(
X­Ÿn
::
T”mG’”©Ü
::
FLAG_SPELLING
);

733 
‹rmg’
.
	`šdex_‹xt
("hello world hullo");

734 
‹rmg’
.
	`šdex_‹xt
("zebra", 1, "S");

735 
‹rmg’
.
	`šdex_‹xt
("hello mum hallo");

737 
	`TEST_STRINGS_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hillo"), "hello");

738 
	`TEST_STRINGS_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hillo"), "hello");

739 
	`TEST_STRINGS_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("hull"), "hullo");

740 
	`TEST_STRINGS_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("mamm"), "mum");

742 
	`TEST_STRINGS_EQUAL
(
db
.
	`g‘_¥–lšg_sugge¡iÚ
("zzebra"), "");

744  
Œue
;

745 
	}
}

748 
boŞ
 
	$‹¡_tg_¥–l2
()

750 
X­Ÿn
::
T”mG’”©Ü
 
‹rmg’
;

751 
X­Ÿn
::
Docum’t
 
doc
;

753 
‹rmg’
.
	`£t_docum’t
(
doc
);

754 
‹rmg’
.
	`£t_æags
(
X­Ÿn
::
T”mG’”©Ü
::
FLAG_SPELLING
);

756 
	`TEST_EXCEPTION
(
X­Ÿn
::
Inv®idO³¿tiÚE¼Ü
, 
‹rmg’
.
	`šdex_‹xt
("foo"));

758  
Œue
;

759 
	}
}

762 cÚ¡ 
‹¡_desc
 
	g‹¡s
[] = {

763 
TESTCASE
(
‹rmg’1
),

764 
TESTCASE
(
tg_¥–l1
),

765 
TESTCASE
(
tg_¥–l2
),

766 
END_OF_TESTCASES


769 
	$maš
(
¬gc
, **
¬gv
)

771 
‹¡_driv”
::
	`·r£_commªd_lše
(
¬gc
, 
¬gv
);

772  
‹¡_driv”
::
	`run
(
‹¡s
);

773 
	}
}

	@unicode/tclUniData.cc

14 
	~<cÚfig.h
>

16 
	~<x­Ÿn/unicode.h
>

17 
	~"omas£¹.h
"

25 
	#OFFSET_BITS
 8

	)

34 
	g·geM­
[] = {

300 
	ggroupM­
[] = {

1714 
	ggroups
[] = {

1745 
	#UNICODE_CATEGORY_MASK
 0X1F

	)

1748 
	mUNASSIGNED
,

1749 
	mUPPERCASE_LETTER
,

1750 
	mLOWERCASE_LETTER
,

1751 
	mTITLECASE_LETTER
,

1752 
	mMODIFIER_LETTER
,

1753 
	mOTHER_LETTER
,

1754 
	mNON_SPACING_MARK
,

1755 
	mENCLOSING_MARK
,

1756 
	mCOMBINING_SPACING_MARK
,

1757 
	mDECIMAL_DIGIT_NUMBER
,

1758 
	mLETTER_NUMBER
,

1759 
	mOTHER_NUMBER
,

1760 
	mSPACE_SEPARATOR
,

1761 
	mLINE_SEPARATOR
,

1762 
	mPARAGRAPH_SEPARATOR
,

1763 
	mCONTROL
,

1764 
	mFORMAT
,

1765 
	mPRIVATE_USE
,

1766 
	mSURROGATE
,

1767 
	mCONNECTOR_PUNCTUATION
,

1768 
	mDASH_PUNCTUATION
,

1769 
	mOPEN_PUNCTUATION
,

1770 
	mCLOSE_PUNCTUATION
,

1771 
	mINITIAL_QUOTE_PUNCTUATION
,

1772 
	mFINAL_QUOTE_PUNCTUATION
,

1773 
	mOTHER_PUNCTUATION
,

1774 
	mMATH_SYMBOL
,

1775 
	mCURRENCY_SYMBOL
,

1776 
	mMODIFIER_SYMBOL
,

1777 
	mOTHER_SYMBOL


1786 
	#G‘Ca£Ty³
(
šfo
è(((šfoè& 0xE0è>> 5)

	)

1787 
	#G‘C©egÜy
(
šfo
è((šfoè& 0x1F)

	)

1788 
	#G‘D–
(
šfo
è(((šfoè> 0è? ((šfoè>> 15è: (~(~((šfo)è>> 15)))

	)

1797 
	gX­Ÿn
::
Unicode
::
IÁ”Çl
::
	$g‘_ch¬aù”_šfo
(
ch
)

1799 
	`As£¹
(
ch
 < 0x110000);

1800  (
groups
[
groupM­
[(
·geM­
[(()(
ch
)è>> 
OFFSET_BITS
] << OFFSET_BITS) | ((ch) & ((1 << OFFSET_BITS)-1))]]);

1801 
	}
}

	@unicode/utf8itor.cc

20 
	~<cÚfig.h
>

22 
	~<x­Ÿn/unicode.h
>

24 
	~<c¡ršg
>

26 
šlše
 
boŞ
 
	$bad_cÚt
(
ch
è{  (ch & 0xc0è!ğ0x80; 
	}
}

28 
Çme¥aû
 
	gX­Ÿn
 {

30 
Çme¥aû
 
	gUnicode
 {

34 
nÚascii_to_utf8
(
ch
, * 
buf
)

36 ià(
	gch
 < 0x800) {

37 
	gbuf
[0] = 0xc0 | (
ch
 >> 6);

38 
	gbuf
[1] = 0x80 | (
ch
 & 0x3f);

41 ià(
	gch
 < 0x10000) {

42 
	gbuf
[0] = 0xe0 | (
ch
 >> 12);

43 
	gbuf
[1] = 0x80 | ((
ch
 >> 6) & 0x3f);

44 
	gbuf
[2] = 0x80 | (
ch
 & 0x3f);

47 ià(
	gch
 < 0x200000) {

48 
	gbuf
[0] = 0xf0 | (
ch
 >> 18);

49 
	gbuf
[1] = 0x80 | ((
ch
 >> 12) & 0x3f);

50 
	gbuf
[2] = 0x80 | ((
ch
 >> 6) & 0x3f);

51 
	gbuf
[3] = 0x80 | (
ch
 & 0x3f);

62 
	gUtf8I‹¿tÜ
::
Utf8I‹¿tÜ
(cÚ¡ *
p_
)

64 
assign
(
p_
, 
¡¾’
(p_));

68 
	gUtf8I‹¿tÜ
::
ÿlcuÏ‹_£qu’û_Ëngth
() const

75 
ch
 = *
p
;

77 
	g£qËn
 = 1;

82 ià(
	gch
 < 0xc2) ;

84 ià(
	gch
 < 0xe0) {

85 ià(
	gp
 + 1 =ğ
’d
 ||

86 (
p
[1] & 0xc0) != 0x80)

88 
	g£qËn
 = 2;

91 ià(
	gch
 < 0xf0) {

92 ià(
	g’d
 - 
	gp
 < 3 ||

93 
bad_cÚt
(
p
[1]) || bad_cont(p[2]) ||

94 (
	gp
[0] =ğ0xe0 && 
p
[1] < 0xa0))

96 
	g£qËn
 = 3;

99 ià(
	gch
 >= 0xf5 ||

100 
’d
 - 
p
 < 4 ||

101 
bad_cÚt
(
p
[1]) || bad_cont(p[2]) || bad_cont(p[3]) ||

102 (
p
[0] == 0xf0 &&…[1] < 0x90) ||

103 (
p
[0] == 0xf4 &&…[1] >= 0x90))

105 
	g£qËn
 = 4;

109 
	gUtf8I‹¿tÜ
::
İ”©Ü
*() const {

110 ià(
p
 =ğ
NULL
)  (-1);

111 ià(
	g£qËn
 =ğ0è
ÿlcuÏ‹_£qu’û_Ëngth
();

112 
	gch
 = *
p
;

113 ià(
	g£qËn
 =ğ1è 
ch
;

114 ià(
	g£qËn
 =ğ2è ((
ch
 & 0x1fè<< 6è| (
p
[1] & 0x3f);

115 ià(
	g£qËn
 == 3)

116  ((
ch
 & 0x0fè<< 12è| ((
p
[1] & 0x3f) << 6) | (p[2] & 0x3f);

117  ((
	gch
 & 0x07è<< 18è| ((
	gp
[1] & 0x3f) << 12) |

118 ((
	gp
[2] & 0x3f) << 6) | (p[3] & 0x3f);

	@weight/bm25weight.cc

21 
	~<cÚfig.h
>

23 
	~"x­Ÿn/weight.h
"

25 
	~"debuglog.h
"

26 
	~"omas£¹.h
"

27 
	~"£rŸli£-doubË.h
"

29 
	~"x­Ÿn/”rÜ.h
"

31 
	~<®gÜ™hm
>

32 
	~<cm©h
>

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
Çme¥aû
 
	gX­Ÿn
 {

38 
BM25Weight
 *

39 
	gBM25Weight
::
şÚe
() const

41  
Ãw
 
BM25Weight
(
·¿m_k1
, 
·¿m_k2
, 
·¿m_k3
, 
·¿m_b
,

42 
·¿m_mš_nÜmËn
);

46 
	gBM25Weight
::
š™
(
çùÜ
)

48 
X­Ÿn
::
doccouÁ
 
tf
 = 
g‘_‹rmäeq
();

50 
	gX­Ÿn
::
weight
 
tw
 = 0;

51 ià(
g‘_r£t_size
() != 0) {

52 
X­Ÿn
::
doccouÁ
 
»É”mäeq
 = 
g‘_»É”mäeq
();

56 
As£¹R–
(
»É”mäeq
,<=,
tf
);

60 
As£¹R–
(
»É”mäeq
,<=,
g‘_r£t_size
());

62 
	gX­Ÿn
::
doccouÁ
 
»ldocs_nÙ_šdexed
 = 
g‘_r£t_size
(è- 
»É”mäeq
;

66 
As£¹R–
(
»ldocs_nÙ_šdexed
,<=,
g‘_cŞËùiÚ_size
(è- 
tf
);

68 
	gX­Ÿn
::
doccouÁ
 
Q
 = 
g‘_cŞËùiÚ_size
(è- 
»ldocs_nÙ_šdexed
;

70 
	gX­Ÿn
::
doccouÁ
 
nÚ»ldocs_šdexed
 = 
tf
 - 
»É”mäeq
;

71 
	gnum”©Ü
 = (
»É”mäeq
 + 0.5è* (
Q
 - 
tf
 + 0.5);

72 
	gd’om
 = (
»ldocs_nÙ_šdexed
 + 0.5è* (
nÚ»ldocs_šdexed
 + 0.5);

73 
	gtw
 = 
num”©Ü
 / 
d’om
;

75 
	gtw
 = (
g‘_cŞËùiÚ_size
(è- 
tf
 + 0.5) / (tf + 0.5);

78 
As£¹R–
(
tw
,>,0);

96 ià(
¿»
(
tw
 <= 1.0)) {

97 
‹rmweight
 = 0;

99 
	g‹rmweight
 = 
log
(
tw
è* 
çùÜ
;

100 ià(
	g·¿m_k3
 != 0) {

101 
wqf_doubË
 = 
g‘_wqf
();

102 
	g‹rmweight
 *ğ(
·¿m_k3
 + 1è* 
wqf_doubË
 / (param_k3 + wqf_double);

106 ià(
	gtw
 < 2ètw = 
tw
 * 0.5 + 1;

107 
	g‹rmweight
 = 
log
(
tw
è* 
çùÜ
;

108 ià(
	g·¿m_k3
 != 0) {

109 
wqf_doubË
 = 
g‘_wqf
();

110 
	g‹rmweight
 *ğ(
·¿m_k3
 + 1è* 
wqf_doubË
 / (param_k3 + wqf_double);

114 
LOGVALUE
(
WTCALC
, 
‹rmweight
);

116 ià(
	g·¿m_b
 =ğ0 || 
·¿m_k1
 == 0) {

119 
Ën_çùÜ
 = 0;

121 
	gËn_çùÜ
 = 
g‘_av”age_Ëngth
();

124 ià(
	gËn_çùÜ
 !ğ0è
Ën_çùÜ
 = 1 /†en_factor;

127 
LOGVALUE
(
WTCALC
, 
Ën_çùÜ
);

130 
¡ršg


131 
	gBM25Weight
::
Çme
() const

136 
¡ršg


137 
	gBM25Weight
::
£rŸli£
() const

139 
¡ršg
 
»suÉ
 = 
£rŸli£_doubË
(
·¿m_k1
);

140 
	g»suÉ
 +ğ
£rŸli£_doubË
(
·¿m_k2
);

141 
	g»suÉ
 +ğ
£rŸli£_doubË
(
·¿m_k3
);

142 
	g»suÉ
 +ğ
£rŸli£_doubË
(
·¿m_b
);

143 
	g»suÉ
 +ğ
£rŸli£_doubË
(
·¿m_mš_nÜmËn
);

144  
	g»suÉ
;

147 
BM25Weight
 *

148 
	gBM25Weight
::
un£rŸli£
(cÚ¡ 
¡ršg
 & 
s
) const

150 cÚ¡ *
±r
 = 
s
.
d©a
();

151 cÚ¡ *
	g’d
 = 
±r
 + 
s
.
size
();

152 
	gk1
 = 
un£rŸli£_doubË
(&
±r
, 
’d
);

153 
	gk2
 = 
un£rŸli£_doubË
(&
±r
, 
’d
);

154 
	gk3
 = 
un£rŸli£_doubË
(&
±r
, 
’d
);

155 
	gb
 = 
un£rŸli£_doubË
(&
±r
, 
’d
);

156 
	gmš_nÜmËn
 = 
un£rŸli£_doubË
(&
±r
, 
’d
);

157 ià(
¿»
(
±r
 !ğ
’d
))

158 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Extra data in BM25Weight::unserialise()");

159  
Ãw
 
BM25Weight
(
k1
, 
k2
, 
k3
, 
b
, 
mš_nÜmËn
);

162 
	gX­Ÿn
::
weight


163 
BM25Weight
::
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
 
wdf
, X­Ÿn::‹rmcouÁ 
Ën
) const

165 
LOGCALL
(
WTCALC
, 
X­Ÿn
::
weight
, "BM25Weight::get_sumpart",

166 
wdf
 << ", " << 
Ën
);

167 
	gX­Ÿn
::
doş’gth
 
nÜmËn
 = 
max
(
Ën
 * 
Ën_çùÜ
, 
·¿m_mš_nÜmËn
);

169 
wdf_doubË
(
wdf
);

170 
	gd’om
 = 
·¿m_k1
 * (
nÜmËn
 * 
·¿m_b
 + (1 -…¬am_b)è+ 
wdf_doubË
;

171 
As£¹R–
(
d’om
,>,0);

172 
RETURN
(
‹rmweight
 * 
wdf_doubË
 * (
·¿m_k1
 + 1è/ 
d’om
);

175 
	gX­Ÿn
::
weight


176 
BM25Weight
::
g‘_max·¹
() const

178 
LOGCALL
(
WTCALC
, 
X­Ÿn
::
weight
, "BM25Weight::get_maxpart", "");

179 
	gX­Ÿn
::
doş’gth
 
nÜmËn_lb
 = 
max
(
g‘_doş’gth_low”_bound
(è* 
Ën_çùÜ
,

180 
·¿m_mš_nÜmËn
);

183 
wdf_max
(
max
(
g‘_wdf_uµ”_bound
(), 
X­Ÿn
::
‹rmcouÁ
(1)));

184 
	gd’om
 = 
·¿m_k1
 * (
nÜmËn_lb
 * 
·¿m_b
 + (1 -…¬am_b)è+ 
wdf_max
;

185 
As£¹R–
(
d’om
,>,0);

186 
RETURN
(
‹rmweight
 * 
wdf_max
 * (
·¿m_k1
 + 1è/ 
d’om
);

198 
	gX­Ÿn
::
weight


199 
BM25Weight
::
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
 
Ën
) const

201 
LOGCALL
(
WTCALC
, 
X­Ÿn
::
weight
, "BM25Weight::g‘_sumexŒa", 
Ën
);

202 
	gX­Ÿn
::
weight
 
num
 = (2.0 * 
·¿m_k2
 * 
g‘_qu”y_Ëngth
());

203 
RETURN
(
num
 / (1.0 + 
max
(
Ën
 * 
Ën_çùÜ
, 
·¿m_mš_nÜmËn
)));

206 
	gX­Ÿn
::
weight


207 
BM25Weight
::
g‘_maxexŒa
() const

209 
LOGCALL
(
WTCALC
, 
X­Ÿn
::
weight
, "BM25Weight::get_maxextra", "");

210 
	gX­Ÿn
::
weight
 
num
 = (2.0 * 
·¿m_k2
 * 
g‘_qu”y_Ëngth
());

211 
RETURN
(
num
 / (1.0 + 
max
((
g‘_doş’gth_low”_bound
()),

212 
·¿m_mš_nÜmËn
)));

	@weight/boolweight.cc

21 
	~<cÚfig.h
>

23 
	~"x­Ÿn/weight.h
"

25 
usšg
 
Çme¥aû
 
	g¡d
;

27 
Çme¥aû
 
	gX­Ÿn
 {

29 
BoŞWeight
 *

30 
	gBoŞWeight
::
şÚe
() const

32  
Ãw
 
BoŞWeight
;

36 
	gBoŞWeight
::
š™
()

41 
¡ršg


42 
BoŞWeight
::
Çme
() const

47 
¡ršg


48 
	gBoŞWeight
::
£rŸli£
() const

51  
¡ršg
();

54 
BoŞWeight
 *

55 
	gBoŞWeight
::
un£rŸli£
(cÚ¡ 
¡ršg
 &) const

57  
Ãw
 
BoŞWeight
;

60 
	gX­Ÿn
::
weight


61 
BoŞWeight
::
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
, Xapian::termcount) const

66 
	gX­Ÿn
::
weight


67 
BoŞWeight
::
g‘_max·¹
() const

72 
	gX­Ÿn
::
weight


73 
BoŞWeight
::
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
) const

78 
	gX­Ÿn
::
weight


79 
BoŞWeight
::
g‘_maxexŒa
() const

	@weight/tradweight.cc

21 
	~<cÚfig.h
>

23 
	~"x­Ÿn/weight.h
"

25 
	~"debuglog.h
"

26 
	~"omas£¹.h
"

27 
	~"£rŸli£-doubË.h
"

29 
	~"x­Ÿn/”rÜ.h
"

31 
	~<cm©h
>

33 
usšg
 
Çme¥aû
 
	g¡d
;

35 
Çme¥aû
 
	gX­Ÿn
 {

37 
T¿dWeight
 *

38 
	gT¿dWeight
::
şÚe
() const

40  
Ãw
 
T¿dWeight
(
·¿m_k
);

44 
	gT¿dWeight
::
š™
(
çùÜ
)

46 
X­Ÿn
::
doccouÁ
 
tf
 = 
g‘_‹rmäeq
();

48 
	gX­Ÿn
::
weight
 
tw
 = 0;

49 ià(
g‘_r£t_size
() != 0) {

50 
X­Ÿn
::
doccouÁ
 
»É”mäeq
 = 
g‘_»É”mäeq
();

54 
As£¹R–
(
»É”mäeq
,<=,
tf
);

58 
As£¹R–
(
»É”mäeq
,<=,
g‘_r£t_size
());

60 
	gX­Ÿn
::
doccouÁ
 
»ldocs_nÙ_šdexed
 = 
g‘_r£t_size
(è- 
»É”mäeq
;

64 
As£¹R–
(
»ldocs_nÙ_šdexed
,<=,
g‘_cŞËùiÚ_size
(è- 
tf
);

66 
	gX­Ÿn
::
doccouÁ
 
Q
 = 
g‘_cŞËùiÚ_size
(è- 
»ldocs_nÙ_šdexed
;

68 
	gX­Ÿn
::
doccouÁ
 
nÚ»ldocs_šdexed
 = 
tf
 - 
»É”mäeq
;

69 
	gnum”©Ü
 = (
»É”mäeq
 + 0.5è* (
Q
 - 
tf
 + 0.5);

70 
	gd’om
 = (
»ldocs_nÙ_šdexed
 + 0.5è* (
nÚ»ldocs_šdexed
 + 0.5);

71 
	gtw
 = 
num”©Ü
 / 
d’om
;

73 
	gtw
 = (
g‘_cŞËùiÚ_size
(è- 
tf
 + 0.5) / (tf + 0.5);

76 
As£¹R–
(
tw
,>,0);

94 ià(
¿»
(
tw
 <= 1.0)) {

95 
‹rmweight
 = 0;

97 
	g‹rmweight
 = 
log
(
tw
è* 
çùÜ
;

100 ià(
	gtw
 < 2ètw = 
tw
 * 0.5 + 1;

101 
	g‹rmweight
 = 
log
(
tw
è* 
çùÜ
;

104 
LOGVALUE
(
WTCALC
, 
‹rmweight
);

106 ià(
	g·¿m_k
 == 0) {

108 
Ën_çùÜ
 = 0;

110 
	gËn_çùÜ
 = 
g‘_av”age_Ëngth
();

113 ià(
	gËn_çùÜ
 !ğ0è
Ën_çùÜ
 = 
·¿m_k
 /†en_factor;

116 
LOGVALUE
(
WTCALC
, 
Ën_çùÜ
);

119 
¡ršg


120 
	gT¿dWeight
::
Çme
() const

125 
¡ršg


126 
	gT¿dWeight
::
£rŸli£
() const

128  
£rŸli£_doubË
(
·¿m_k
);

131 
T¿dWeight
 *

132 
	gT¿dWeight
::
un£rŸli£
(cÚ¡ 
¡ršg
 & 
s
) const

134 cÚ¡ *
±r
 = 
s
.
d©a
();

135 cÚ¡ *
	g’d
 = 
±r
 + 
s
.
size
();

136 
	gk
 = 
un£rŸli£_doubË
(&
±r
, 
’d
);

137 ià(
¿»
(
±r
 !ğ
’d
))

138 
throw
 
X­Ÿn
::
N‘wÜkE¼Ü
("Extra data in BM25Weight::unserialise()");

139  
Ãw
 
T¿dWeight
(
k
);

142 
	gX­Ÿn
::
weight


143 
T¿dWeight
::
g‘_sum·¹
(
X­Ÿn
::
‹rmcouÁ
 
wdf
, X­Ÿn::‹rmcouÁ 
Ën
) const

145 
wdf_doubË
(
wdf
);

146  
‹rmweight
 * 
	gwdf_doubË
 / (
Ën
 * 
	gËn_çùÜ
 + wdf_double);

149 
	gX­Ÿn
::
weight


150 
T¿dWeight
::
g‘_max·¹
() const

153 
wdf_max
(
max
(
g‘_wdf_uµ”_bound
(), 
X­Ÿn
::
‹rmcouÁ
(1)));

154 
	gnum
 = 
‹rmweight
 * 
wdf_max
;

155  
	gnum
 / (
g‘_doş’gth_low”_bound
(è* 
	gËn_çùÜ
 + 
	gwdf_max
);

158 
	gX­Ÿn
::
weight


159 
T¿dWeight
::
g‘_sumexŒa
(
X­Ÿn
::
‹rmcouÁ
) const

164 
	gX­Ÿn
::
weight


165 
T¿dWeight
::
g‘_maxexŒa
() const

	@weight/weight.cc

22 
	~<cÚfig.h
>

24 
	~"x­Ÿn/weight.h
"

26 
	~"weightš‹º®.h
"

28 
	~"debuglog.h
"

30 
	~"x­Ÿn/”rÜ.h
"

32 
usšg
 
Çme¥aû
 
	g¡d
;

34 
Çme¥aû
 
	gX­Ÿn
 {

37 
	gWeight
::
š™_
(cÚ¡ 
IÁ”Çl
 & 
¡©s
, 
X­Ÿn
::
‹rmcouÁ
 
qu”y_Ëngth
)

39 
LOGCALL_VOID
(
MATCH
, "Weight::š™_", 
¡©s
 << ", " << 
qu”y_Ëngth
);

40 
	gcŞËùiÚ_size_
 = 
¡©s
.
cŞËùiÚ_size
;

41 
	gr£t_size_
 = 
¡©s
.
r£t_size
;

42 ià(
	g¡©s_Ãeded
 & 
	gAVERAGE_LENGTH
)

43 
	gav”age_Ëngth_
 = 
¡©s
.
g‘_av”age_Ëngth
();

44 ià(
	g¡©s_Ãeded
 & 
	gDOC_LENGTH_MAX
)

45 
	gdoş’gth_uµ”_bound_
 = 
¡©s
.
db
.
g‘_doş’gth_uµ”_bound
();

46 ià(
	g¡©s_Ãeded
 & 
	gDOC_LENGTH_MIN
)

47 
	gdoş’gth_low”_bound_
 = 
¡©s
.
db
.
g‘_doş’gth_low”_bound
();

48 
	gwdf_uµ”_bound_
 = 0;

49 
	g‹rmäeq_
 = 0;

50 
	g»É”mäeq_
 = 0;

51 
	gqu”y_Ëngth_
 = 
qu”y_Ëngth
;

52 
	gwqf_
 = 1;

56 
	gWeight
::
š™_
(cÚ¡ 
IÁ”Çl
 & 
¡©s
, 
X­Ÿn
::
‹rmcouÁ
 
qu”y_Ëngth
,

57 cÚ¡ 
¡ršg
 & 
‹rm
, 
X­Ÿn
::
‹rmcouÁ
 
wqf
, 
çùÜ
)

59 
LOGCALL_VOID
(
MATCH
, "Weight::š™_", 
¡©s
 << ", " << 
qu”y_Ëngth
 <<

60 ", " << 
‹rm
 << ", " << 
wqf
 << ", " << 
çùÜ
);

61 
	gcŞËùiÚ_size_
 = 
¡©s
.
cŞËùiÚ_size
;

62 
	gr£t_size_
 = 
¡©s
.
r£t_size
;

63 ià(
	g¡©s_Ãeded
 & 
	gAVERAGE_LENGTH
)

64 
	gav”age_Ëngth_
 = 
¡©s
.
g‘_av”age_Ëngth
();

65 ià(
	g¡©s_Ãeded
 & 
	gDOC_LENGTH_MAX
)

66 
	gdoş’gth_uµ”_bound_
 = 
¡©s
.
db
.
g‘_doş’gth_uµ”_bound
();

67 ià(
	g¡©s_Ãeded
 & 
	gDOC_LENGTH_MIN
)

68 
	gdoş’gth_low”_bound_
 = 
¡©s
.
db
.
g‘_doş’gth_low”_bound
();

69 ià(
	g¡©s_Ãeded
 & 
	gWDF_MAX
)

70 
	gwdf_uµ”_bound_
 = 
¡©s
.
db
.
g‘_wdf_uµ”_bound
(
‹rm
);

71 ià(
	g¡©s_Ãeded
 & 
	gTERMFREQ
)

72 
	g‹rmäeq_
 = 
¡©s
.
g‘_‹rmäeq
(
‹rm
);

73 ià(
	g¡©s_Ãeded
 & 
	gRELTERMFREQ
)

74 
	g»É”mäeq_
 = 
¡©s
.
g‘_»É”mäeq
(
‹rm
);

75 
	gqu”y_Ëngth_
 = 
qu”y_Ëngth
;

76 
	gwqf_
 = 
wqf
;

77 
š™
(
çùÜ
);

81 
	gWeight
::
š™_
(cÚ¡ 
IÁ”Çl
 & 
¡©s
, 
X­Ÿn
::
‹rmcouÁ
 
qu”y_Ëngth
,

82 
çùÜ
, 
X­Ÿn
::
doccouÁ
 
‹rmäeq
,

83 
X­Ÿn
::
doccouÁ
 
»É”mäeq
)

85 
LOGCALL_VOID
(
MATCH
, "Weight::š™_", 
¡©s
 << ", " << 
qu”y_Ëngth
 <<

86 ", " << 
çùÜ
 << ", " << 
‹rmäeq
 << ", " << 
»É”mäeq
);

88 
	gcŞËùiÚ_size_
 = 
¡©s
.
cŞËùiÚ_size
;

89 
	gr£t_size_
 = 
¡©s
.
r£t_size
;

90 ià(
	g¡©s_Ãeded
 & 
	gAVERAGE_LENGTH
)

91 
	gav”age_Ëngth_
 = 
¡©s
.
g‘_av”age_Ëngth
();

92 ià(
	g¡©s_Ãeded
 & 
	gDOC_LENGTH_MAX
)

93 
	gdoş’gth_uµ”_bound_
 = 
¡©s
.
db
.
g‘_doş’gth_uµ”_bound
();

94 ià(
	g¡©s_Ãeded
 & 
	gDOC_LENGTH_MIN
)

95 
	gdoş’gth_low”_bound_
 = 
¡©s
.
db
.
g‘_doş’gth_low”_bound
();

103 ià(
	g¡©s_Ãeded
 & 
	gWDF_MAX
)

104 
	gwdf_uµ”_bound_
 = 
¡©s
.
db
.
g‘_doş’gth_uµ”_bound
();

106 
	g‹rmäeq_
 = 
‹rmäeq
;

107 
	g»É”mäeq_
 = 
»É”mäeq
;

108 
	gqu”y_Ëngth_
 = 
qu”y_Ëngth
;

109 
	gwqf_
 = 1;

110 
š™
(
çùÜ
);

113 
	gWeight
::~
Weight
() { }

115 
¡ršg


116 
Weight
::
Çme
() const

118  
¡ršg
();

121 
¡ršg


122 
	gWeight
::
£rŸli£
() const

124 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("serialise()‚ot supported forhis Xapian::Weight subclass");

127 
Weight
 *

128 
	gWeight
::
un£rŸli£
(cÚ¡ 
¡ršg
 &) const

130 
throw
 
X­Ÿn
::
Unim¶em’‹dE¼Ü
("unserialise()‚ot supported forhis Xapian::Weight subclass");

	@weight/weightinternal.cc

22 
	~<cÚfig.h
>

24 
	~"weightš‹º®.h
"

26 
	~"omas£¹.h
"

27 
	~"¡r.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 
¡ršg


32 
	gT”mF»qs
::
	$g‘_desütiÚ
() const {

33 
¡ršg
 
	`desc
("TermFreqs(");

34 
desc
 +ğ
	`¡r
(
‹rmäeq
);

35 
desc
 += ", ";

36 
desc
 +ğ
	`¡r
(
»É”mäeq
);

37 
desc
 += ")";

38  
desc
;

39 
	}
}

41 
Çme¥aû
 
	gX­Ÿn
 {

43 
	gWeight
::
IÁ”Çl
 &

44 
Weight
::
IÁ”Çl
::
İ”©Ü
 +=(cÚ¡ Weight::IÁ”ÇÈ& 
šc
)

46 
tÙ®_Ëngth
 +ğ
šc
.total_length;

47 
	gcŞËùiÚ_size
 +ğ
šc
.
cŞËùiÚ_size
;

48 
	gr£t_size
 +ğ
šc
.
r£t_size
;

51 
	gm­
<
	g¡ršg
, 
	gT”mF»qs
>::
cÚ¡_™”©Ü
 
i
;

52 
	gi
 = 
šc
.
‹rmäeqs
.
begš
(); i !ğšc.‹rmäeqs.
’d
(); ++i) {

53 
	g‹rmäeqs
[
i
->
fœ¡
] +ği->
£cÚd
;

55  *
	gthis
;

58 
	gX­Ÿn
::
doccouÁ


59 
Weight
::
IÁ”Çl
::
g‘_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

62 ià(
‹rm
.
em±y
())  0;

64 
	gm­
<
	g¡ršg
, 
	gT”mF»qs
>::
cÚ¡_™”©Ü
 
täeq
 = 
‹rmäeqs
.
fšd
(
‹rm
);

65 
As£¹
(
täeq
 !ğ
‹rmäeqs
.
’d
());

66  
	gtäeq
->
	g£cÚd
.
	g‹rmäeq
;

70 
	gWeight
::
IÁ”Çl
::
£t_‹rmäeq
(cÚ¡ 
¡ršg
 & 
‹rm
, 
X­Ÿn
::
doccouÁ
 
täeq
)

74 
As£¹
(
‹rmäeqs
.
fšd
(
‹rm
è=ğ‹rmäeqs.
’d
() ||

75 
‹rmäeqs
.
fšd
(
‹rm
)->
£cÚd
.
‹rmäeq
 == 0 ||

76 
‹rmäeqs
.
fšd
(
‹rm
)->
£cÚd
.
‹rmäeq
 =ğ
täeq
);

77 
	g‹rmäeqs
[
‹rm
].
	g‹rmäeq
 = 
täeq
;

80 
	gX­Ÿn
::
doccouÁ


81 
Weight
::
IÁ”Çl
::
g‘_»É”mäeq
(cÚ¡ 
¡ršg
 & 
‹rm
) const

84 ià(
‹rm
.
em±y
())  0;

86 
	gm­
<
	g¡ršg
, 
	gT”mF»qs
>::
cÚ¡_™”©Ü
 
täeq
 = 
‹rmäeqs
.
fšd
(
‹rm
);

87 
As£¹
(
täeq
 !ğ
‹rmäeqs
.
’d
());

88  
	gtäeq
->
	g£cÚd
.
	g»É”mäeq
;

92 
	gWeight
::
IÁ”Çl
::
£t_»É”mäeq
(cÚ¡ 
¡ršg
 & 
‹rm
, 
X­Ÿn
::
doccouÁ
 
¹äeq
)

96 
As£¹
(
‹rmäeqs
.
fšd
(
‹rm
è=ğ‹rmäeqs.
’d
() ||

97 
‹rmäeqs
.
fšd
(
‹rm
)->
£cÚd
.
»É”mäeq
 == 0 ||

98 
‹rmäeqs
.
fšd
(
‹rm
)->
£cÚd
.
»É”mäeq
 =ğ
¹äeq
);

99 
	g‹rmäeqs
[
‹rm
].
	g»É”mäeq
 = 
¹äeq
;

102 
¡ršg


103 
	gWeight
::
IÁ”Çl
::
g‘_desütiÚ
() const

105 
¡ršg
 
desc
 = "Weight::Internal(totlen=";

106 
	gdesc
 +ğ
¡r
(
tÙ®_Ëngth
);

107 
	gdesc
 += ", collection_size=";

108 
	gdesc
 +ğ
¡r
(
cŞËùiÚ_size
);

109 
	gdesc
 += ",„set_size=";

110 
	gdesc
 +ğ
¡r
(
r£t_size
);

111 
	gdesc
 += ')';

112  
	gdesc
;

	@/usr/include/arpa/inet.h

19 #iâdeà
_ARPA_INET_H


20 
	#_ARPA_INET_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<Ãtš‘/š.h
>

26 #iâdeà
__sockËn_t_defšed


27 
__sockËn_t
 
	tsockËn_t
;

28 
	#__sockËn_t_defšed


	)

31 
__BEGIN_DECLS


35 
š_addr_t
 
	$š‘_addr
 (
__cÚ¡
 *
__ı
è
__THROW
;

38 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

42 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

43 
__THROW
;

46 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

50 
š_addr_t
 
	$š‘_ÃtwÜk
 (
__cÚ¡
 *
__ı
è
__THROW
;

54 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

59 
	$š‘_±Ú
 (
__af
, 
__cÚ¡
 *
__»¡riù
 
__ı
,

60 *
__»¡riù
 
__buf
è
__THROW
;

65 
__cÚ¡
 *
	$š‘_Áİ
 (
__af
, 
__cÚ¡
 *
__»¡riù
 
__ı
,

66 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

67 
__THROW
;

71 #ifdeà
__USE_MISC


74 
	$š‘_©Ú
 (
__cÚ¡
 *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

78 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

83 *
	$š‘_Ãt_Áİ
 (
__af
, 
__cÚ¡
 *
__ı
, 
__b™s
,

84 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

89 
	$š‘_Ãt_±Ú
 (
__af
, 
__cÚ¡
 *
__ı
,

90 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

95 
	$š‘_n§p_addr
 (
__cÚ¡
 *
__ı
,

96 *
__buf
, 
__Ën
è
__THROW
;

100 *
	$š‘_n§p_Áß
 (
__Ën
, 
__cÚ¡
 *
__ı
,

101 *
__buf
è
__THROW
;

104 
__END_DECLS


	@/usr/include/assert.h

24 #ifdef 
_ASSERT_H


26 #undeà
_ASSERT_H


27 #undeà
as£¹


28 #undeà
__ASSERT_VOID_CAST


30 #ifdef 
__USE_GNU


31 #undeà
as£¹_³¼Ü


36 
	#_ASSERT_H
 1

	)

37 
	~<ã©u»s.h
>

39 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

40 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

42 
	#__ASSERT_VOID_CAST
 ()

	)

50 #ifdef 
NDEBUG


52 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

60 #ifdef 
__USE_GNU


61 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

66 #iâdeà
_ASSERT_H_DECLS


67 
	#_ASSERT_H_DECLS


	)

68 
__BEGIN_DECLS


71 
	$__as£¹_ç
 (
__cÚ¡
 *
__as£¹iÚ
, __cÚ¡ *
__fe
,

72 
__lše
, 
__cÚ¡
 *
__funùiÚ
)

73 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

76 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, 
__cÚ¡
 *
__fe
,

77 
__lše
,

78 
__cÚ¡
 *
__funùiÚ
)

79 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

84 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

85 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

88 
__END_DECLS


91 
	#as£¹
(
ex´
) \

92 ((
ex´
) \

93 ? 
	`__ASSERT_VOID_CAST
 (0) \

94 : 
	`__as£¹_ç
 (
	`__STRING
(
ex´
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #ifdef 
__USE_GNU


97 
	#as£¹_³¼Ü
(
”ºum
) \

98 (!(
”ºum
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

108 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

109 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

111 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

112 
	#__ASSERT_FUNCTION
 
__func__


	)

114 
	#__ASSERT_FUNCTION
 ((
__cÚ¡
 *è0)

	)

	@/usr/include/ctype.h

24 #iâdef 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

30 
	g__BEGIN_DECLS


32 #iâdeà
_ISb™


41 
	~<’dŸn.h
>

42 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


43 
	#_ISb™
(
b™
è(1 << (b™))

	)

45 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

50 
	m_ISuµ”
 = 
_ISb™
 (0),

51 
	m_ISlow”
 = 
_ISb™
 (1),

52 
	m_IS®pha
 = 
_ISb™
 (2),

53 
	m_ISdig™
 = 
_ISb™
 (3),

54 
	m_ISxdig™
 = 
_ISb™
 (4),

55 
	m_IS¥aû
 = 
_ISb™
 (5),

56 
	m_IS´št
 = 
_ISb™
 (6),

57 
	m_ISg¿ph
 = 
_ISb™
 (7),

58 
	m_ISbÏnk
 = 
_ISb™
 (8),

59 
	m_ISúŒl
 = 
_ISb™
 (9),

60 
	m_ISpunù
 = 
_ISb™
 (10),

61 
	m_IS®num
 = 
_ISb™
 (11)

81 
__cÚ¡
 **
	$__ùy³_b_loc
 ()

82 
	`__©Œibu‹__
 ((
__cÚ¡
));

83 
__cÚ¡
 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

84 
	`__©Œibu‹__
 ((
__cÚ¡
));

85 
__cÚ¡
 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

86 
	`__©Œibu‹__
 ((
__cÚ¡
));

88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

91 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

92 
	#__tßscii
(
c
è((cè& 0x7fè

	)

94 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

96 
__BEGIN_NAMESPACE_STD


102 
	`__exùy³
 (
i§Êum
);

103 
	`__exùy³
 (
i§Íha
);

104 
	`__exùy³
 (
isúŒl
);

105 
	`__exùy³
 (
isdig™
);

106 
	`__exùy³
 (
i¦ow”
);

107 
	`__exùy³
 (
isg¿ph
);

108 
	`__exùy³
 (
i¥ršt
);

109 
	`__exùy³
 (
i¥unù
);

110 
	`__exùy³
 (
is¥aû
);

111 
	`__exùy³
 (
isuµ”
);

112 
	`__exùy³
 (
isxdig™
);

116 
	$tŞow”
 (
__c
è
__THROW
;

119 
	$touµ”
 (
__c
è
__THROW
;

121 
__END_NAMESPACE_STD


125 #ifdef 
__USE_ISOC99


126 
__BEGIN_NAMESPACE_C99


128 
	`__exùy³
 (
isbÏnk
);

130 
__END_NAMESPACE_C99


133 #ifdeà
__USE_GNU


135 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

138 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


142 
	$i§scii
 (
__c
è
__THROW
;

146 
	$tßscii
 (
__c
è
__THROW
;

150 
	`__exùy³
 (
_touµ”
);

151 
	`__exùy³
 (
_tŞow”
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

156 (
__ex‹nsiÚ__
 \

157 ({ 
__»s
; \

158 ià( (
c
) > 1) \

160 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

166 
__»s
 = 
f
 
¬gs
; \

169 
__»s
 = (
a
)[(è(
c
)]; \

170 
__»s
; 
	}
}))

	)

172 #ià!
defšed
 
__NO_CTYPE
 && !defšed 
__ılu¥lus


173 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

174 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

175 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

176 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

177 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

178 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

179 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

180 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

181 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

182 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

183 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

185 #ifdeà
__USE_ISOC99


186 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

189 #ifdeà
__USE_EXTERN_INLINES


190 
__ex‹º_šlše
 

191 
__NTH
 (
	$tŞow”
 (
__c
))

193  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

194 
	}
}

196 
__ex‹º_šlše
 

197 
__NTH
 (
	$touµ”
 (
__c
))

199  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

200 
	}
}

203 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


204 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

205 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

208 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


209 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

210 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

212 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

213 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

219 #ifdeà
__USE_GNU


233 
	~<xloÿË.h
>

237 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

238 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

240 
	#__exùy³_l
(
Çme
) \

241 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

247 
__exùy³_l
 (
i§Êum_l
);

248 
__exùy³_l
 (
i§Íha_l
);

249 
__exùy³_l
 (
isúŒl_l
);

250 
__exùy³_l
 (
isdig™_l
);

251 
__exùy³_l
 (
i¦ow”_l
);

252 
__exùy³_l
 (
isg¿ph_l
);

253 
__exùy³_l
 (
i¥ršt_l
);

254 
__exùy³_l
 (
i¥unù_l
);

255 
__exùy³_l
 (
is¥aû_l
);

256 
__exùy³_l
 (
isuµ”_l
);

257 
__exùy³_l
 (
isxdig™_l
);

259 
__exùy³_l
 (
isbÏnk_l
);

263 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

264 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

267 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

268 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

270 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


271 
	#__tŞow”_l
(
c
, 
loÿË
) \

272 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

273 
	#__touµ”_l
(
c
, 
loÿË
) \

274 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

275 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

276 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

280 #iâdeà
__NO_CTYPE


281 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

282 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

283 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

284 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

285 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

286 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

287 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

288 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

289 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

290 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

291 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

293 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

295 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


296 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

297 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

300 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

301 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

302 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

303 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

304 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

305 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

306 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

307 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

308 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

309 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

310 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

312 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

314 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


315 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

316 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

323 
__END_DECLS


	@/usr/include/dirent.h

23 #iâdef 
_DIRENT_H


24 
	#_DIRENT_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


30 
	~<b™s/ty³s.h
>

32 #ifdeà
__USE_XOPEN


33 #iâdeà
__šo_t_defšed


34 #iâdeà
__USE_FILE_OFFSET64


35 
__šo_t
 
	tšo_t
;

37 
__šo64_t
 
	tšo_t
;

39 
	#__šo_t_defšed


	)

41 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


42 
__šo64_t
 
	tšo64_t
;

43 
	#__šo64_t_defšed


	)

62 
	~<b™s/dœ’t.h
>

64 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
è&& !defšed 
d_f’o


65 
	#d_šo
 
d_f’o


	)

82 #ifdeà
_DIRENT_HAVE_D_NAMLEN


83 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

84 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

86 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

87 #ifdeà
_DIRENT_HAVE_D_RECLEN


88 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

90 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

91 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

96 #ifdeà
__USE_BSD


100 
	mDT_UNKNOWN
 = 0,

101 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

102 
	mDT_FIFO
 = 1,

103 
	#DT_FIFO
 
DT_FIFO


	)

104 
	mDT_CHR
 = 2,

105 
	#DT_CHR
 
DT_CHR


	)

106 
	mDT_DIR
 = 4,

107 
	#DT_DIR
 
DT_DIR


	)

108 
	mDT_BLK
 = 6,

109 
	#DT_BLK
 
DT_BLK


	)

110 
	mDT_REG
 = 8,

111 
	#DT_REG
 
DT_REG


	)

112 
	mDT_LNK
 = 10,

113 
	#DT_LNK
 
DT_LNK


	)

114 
	mDT_SOCK
 = 12,

115 
	#DT_SOCK
 
DT_SOCK


	)

116 
	mDT_WHT
 = 14

117 
	#DT_WHT
 
DT_WHT


	)

121 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

122 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

128 
__dœ¡»am
 
	tDIR
;

135 
DIR
 *
	$İ’dœ
 (
__cÚ¡
 *
__Çme
è
	`__nÚnuÎ
 ((1));

137 #ifdeà
__USE_GNU


142 
DIR
 *
	`fdİ’dœ
 (
__fd
);

150 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

162 #iâdeà
__USE_FILE_OFFSET64


163 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

165 #ifdeà
__REDIRECT


166 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

167 
	`__nÚnuÎ
 ((1));

169 
	#»addœ
 
»addœ64


	)

173 #ifdeà
__USE_LARGEFILE64


174 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

177 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


183 #iâdeà
__USE_FILE_OFFSET64


184 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

185 
dœ’t
 *
__»¡riù
 
__’Œy
,

186 
dœ’t
 **
__»¡riù
 
__»suÉ
)

187 
	`__nÚnuÎ
 ((1, 2, 3));

189 #ifdeà
__REDIRECT


190 
	`__REDIRECT
 (
»addœ_r
,

191 (
DIR
 *
__»¡riù
 
__dœp
,

192 
dœ’t
 *
__»¡riù
 
__’Œy
,

193 
dœ’t
 **
__»¡riù
 
__»suÉ
),

194 
»addœ64_r
è
	`__nÚnuÎ
 ((1, 2, 3));

196 
	#»addœ_r
 
»addœ64_r


	)

200 #ifdeà
__USE_LARGEFILE64


201 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

202 
dœ’t64
 *
__»¡riù
 
__’Œy
,

203 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

204 
	`__nÚnuÎ
 ((1, 2, 3));

209 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

211 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


212 
	~<b™s/ty³s.h
>

215 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


224 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

226 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


227 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

230 #iâdeà
MAXNAMLEN


232 
	~<b™s/posix1_lim.h
>

235 #ifdeà
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

242 
	#__Ãed_size_t


	)

243 
	~<¡ddef.h
>

249 #iâdeà
__USE_FILE_OFFSET64


250 
	`sÿndœ
 (
__cÚ¡
 *
__»¡riù
 
__dœ
,

251 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

252 (*
__£ËùÜ
è(
__cÚ¡
 
dœ’t
 *),

253 (*
__cmp
è(
__cÚ¡
 *, __const *))

254 
	`__nÚnuÎ
 ((1, 2));

256 #ifdeà
__REDIRECT


257 
	`__REDIRECT
 (
sÿndœ
,

258 (
__cÚ¡
 *
__»¡riù
 
__dœ
,

259 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

260 (*
__£ËùÜ
è(
__cÚ¡
 
dœ’t
 *),

261 (*
__cmp
è(
__cÚ¡
 *, __const *)),

262 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

264 
	#sÿndœ
 
sÿndœ64


	)

268 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


271 
	`sÿndœ64
 (
__cÚ¡
 *
__»¡riù
 
__dœ
,

272 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

273 (*
__£ËùÜ
è(
__cÚ¡
 
dœ’t64
 *),

274 (*
__cmp
è(
__cÚ¡
 *, __const *))

275 
	`__nÚnuÎ
 ((1, 2));

279 #iâdeà
__USE_FILE_OFFSET64


280 
	$®phasÜt
 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
)

281 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

283 #ifdeà
__REDIRECT


284 
	`__REDIRECT_NTH
 (
®phasÜt
,

285 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
),

286 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

288 
	#®phasÜt
 
®phasÜt64


	)

292 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


293 
	$®phasÜt64
 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
)

294 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 #ifdeà
__USE_GNU


299 #iâdeà
__USE_FILE_OFFSET64


300 
	$v”siÚsÜt
 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
)

301 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

303 #ifdeà
__REDIRECT


304 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

305 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
),

306 
v”siÚsÜt64
)

307 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

309 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

313 #ifdeà
__USE_LARGEFILE64


314 
	$v”siÚsÜt64
 (
__cÚ¡
 *
__e1
, __cÚ¡ *
__e2
)

315 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

323 #iâdeà
__USE_FILE_OFFSET64


324 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

325 
size_t
 
__nby‹s
,

326 
__off_t
 *
__»¡riù
 
__ba£p
)

327 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

329 #ifdeà
__REDIRECT


330 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

331 (
__fd
, *
__»¡riù
 
__buf
,

332 
size_t
 
__nby‹s
,

333 
__off64_t
 *
__»¡riù
 
__ba£p
),

334 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

336 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

340 #ifdeà
__USE_LARGEFILE64


341 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

342 
size_t
 
__nby‹s
,

343 
__off64_t
 *
__»¡riù
 
__ba£p
)

344 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

349 
__END_DECLS


	@/usr/include/fcntl.h

24 #iâdef 
_FCNTL_H


25 
	#_FCNTL_H
 1

	)

27 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 
	~<b™s/fú.h
>

37 #ifdeà
__USE_XOPEN


38 
	~<sys/¡©.h
>

41 #ifdef 
__USE_MISC


42 #iâdeà
R_OK


45 
	#R_OK
 4

	)

46 
	#W_OK
 2

	)

47 
	#X_OK
 1

	)

48 
	#F_OK
 0

	)

53 #ifdeà
__USE_XOPEN


54 
	#SEEK_SET
 0

	)

55 
	#SEEK_CUR
 1

	)

56 
	#SEEK_END
 2

	)

59 #ifdeà
__USE_ATFILE


60 
	#AT_FDCWD
 -100

	)

63 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

64 
	#AT_REMOVEDIR
 0x200

	)

66 
	#AT_SYMLINK_FOLLOW
 0x400

	)

67 
	#AT_EACCESS
 0x200

	)

76 
fú
 (
__fd
, 
__cmd
, ...);

84 #iâdeà
__USE_FILE_OFFSET64


85 
	$İ’
 (
__cÚ¡
 *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

87 #ifdeà
__REDIRECT


88 
	`__REDIRECT
 (
İ’
, (
__cÚ¡
 *
__fe
, 
__oæag
, ...), 
İ’64
)

89 
	`__nÚnuÎ
 ((1));

91 
	#İ’
 
İ’64


	)

94 #ifdeà
__USE_LARGEFILE64


95 
	$İ’64
 (
__cÚ¡
 *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

98 #ifdeà
__USE_ATFILE


108 #iâdeà
__USE_FILE_OFFSET64


109 
	$İ’©
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
, ...)

110 
	`__nÚnuÎ
 ((2));

112 #ifdeà
__REDIRECT


113 
	`__REDIRECT
 (
İ’©
, (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
,

114 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

116 
	#İ’©
 
İ’©64


	)

120 
	$İ’©64
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
, ...)

121 
	`__nÚnuÎ
 ((2));

129 #iâdeà
__USE_FILE_OFFSET64


130 
	$ü—t
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

132 #ifdeà
__REDIRECT


133 
	`__REDIRECT
 (
ü—t
, (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
),

134 
ü—t64
è
	`__nÚnuÎ
 ((1));

136 
	#ü—t
 
ü—t64


	)

139 #ifdeà
__USE_LARGEFILE64


140 
	$ü—t64
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

143 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

144 && !
defšed
 
__USE_POSIX
))

153 
	#F_ULOCK
 0

	)

154 
	#F_LOCK
 1

	)

155 
	#F_TLOCK
 2

	)

156 
	#F_TEST
 3

	)

158 #iâdeà
__USE_FILE_OFFSET64


159 
	`lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
);

161 #ifdeà
__REDIRECT


162 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

164 
	#lockf
 
lockf64


	)

167 #ifdeà
__USE_LARGEFILE64


168 
	`lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
);

172 #ifdeà
__USE_XOPEN2K


175 #iâdeà
__USE_FILE_OFFSET64


176 
	$posix_çdvi£
 (
__fd
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
,

177 
__advi£
è
__THROW
;

179 #ifdeà
__REDIRECT_NTH


180 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

181 
__off64_t
 
__Ën
, 
__advi£
),

182 
posix_çdvi£64
);

184 
	#posix_çdvi£
 
posix_çdvi£64


	)

187 #ifdeà
__USE_LARGEFILE64


188 
	$posix_çdvi£64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__Ën
,

189 
__advi£
è
__THROW
;

197 #iâdeà
__USE_FILE_OFFSET64


198 
	`posix_çÎoÿ‹
 (
__fd
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
);

200 #ifdeà
__REDIRECT


201 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

202 
__off64_t
 
__Ën
),

203 
posix_çÎoÿ‹64
);

205 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

208 #ifdeà
__USE_LARGEFILE64


209 
	`posix_çÎoÿ‹64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__Ën
);

215 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše
 \

216 && 
defšed
 
__va_¬g_·ck_Ën


217 
	~<b™s/fú2.h
>

220 
__END_DECLS


	@/usr/include/getopt.h

21 #iâdeà
_GETOPT_H


23 #iâdeà
__Ãed_g‘İt


24 
	#_GETOPT_H
 1

	)

34 #ià!
defšed
 
__GNU_LIBRARY__


35 
	~<ùy³.h
>

38 #iâdeà
__THROW


39 #iâdeà
__GNUC_PREREQ


40 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

42 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

43 
	#__THROW
 
	`throw
 ()

	)

45 
	#__THROW


	)

49 #ifdef 
__ılu¥lus


59 *
İrg
;

73 
İtšd
;

78 
İ‹¼
;

82 
İtİt
;

84 #iâdeà
__Ãed_g‘İt


106 
	sİtiÚ


108 cÚ¡ *
	gÇme
;

111 
	ghas_¬g
;

112 *
	gæag
;

113 
	gv®
;

118 
	#no_¬gum’t
 0

	)

119 
	#»quœed_¬gum’t
 1

	)

120 
	#İtiÚ®_¬gum’t
 2

	)

148 #ifdeà
__GNU_LIBRARY__


152 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

153 
__THROW
;

155 
g‘İt
 ();

158 #iâdeà
__Ãed_g‘İt


159 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
,

161 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

162 
__THROW
;

163 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
,

165 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

166 
__THROW
;

170 #ifdef 
__ılu¥lus


175 #undeà
__Ãed_g‘İt


	@/usr/include/gnu-versions.h

20 #iâdeà
_GNU_VERSIONS_H


21 
	#_GNU_VERSIONS_H
 1

	)

47 
	#_GNU_OBSTACK_INTERFACE_VERSION
 1

	)

48 
	#_GNU_REGEX_INTERFACE_VERSION
 1

	)

49 
	#_GNU_GLOB_INTERFACE_VERSION
 1

	)

50 
	#_GNU_GETOPT_INTERFACE_VERSION
 2

	)

	@/usr/include/libintl.h

21 #iâdeà
_LIBINTL_H


22 
	#_LIBINTL_H
 1

	)

24 
	~<ã©u»s.h
>

28 
	#__USE_GNU_GETTEXT
 1

	)

32 
	#__GNU_GETTEXT_SUPPORTED_REVISION
(
majÜ
) \

33 ((
majÜ
è=ğ0 ? 1 : -1)

	)

35 
__BEGIN_DECLS


40 *
	$g‘‹xt
 (
__cÚ¡
 *
__msgid
)

41 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (1);

45 *
	$dg‘‹xt
 (
__cÚ¡
 *
__domašÇme
, __cÚ¡ *
__msgid
)

46 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

47 *
	$__dg‘‹xt
 (
__cÚ¡
 *
__domašÇme
, __cÚ¡ *
__msgid
)

48 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

52 *
	$dcg‘‹xt
 (
__cÚ¡
 *
__domašÇme
,

53 
__cÚ¡
 *
__msgid
, 
__ÿ‹gÜy
)

54 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

55 *
	$__dcg‘‹xt
 (
__cÚ¡
 *
__domašÇme
,

56 
__cÚ¡
 *
__msgid
, 
__ÿ‹gÜy
)

57 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

62 *
	$ng‘‹xt
 (
__cÚ¡
 *
__msgid1
, __cÚ¡ *
__msgid2
,

63 
__n
)

64 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (1è
	`__©Œibu‹_fÜm©_¬g__
 (2);

68 *
	$dng‘‹xt
 (
__cÚ¡
 *
__domašÇme
, __cÚ¡ *
__msgid1
,

69 
__cÚ¡
 *
__msgid2
, 
__n
)

70 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (2è
	`__©Œibu‹_fÜm©_¬g__
 (3);

74 *
	$dúg‘‹xt
 (
__cÚ¡
 *
__domašÇme
, __cÚ¡ *
__msgid1
,

75 
__cÚ¡
 *
__msgid2
, 
__n
,

76 
__ÿ‹gÜy
)

77 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (2è
	`__©Œibu‹_fÜm©_¬g__
 (3);

83 *
	$‹xtdomaš
 (
__cÚ¡
 *
__domašÇme
è
__THROW
;

87 *
	$bšd‹xtdomaš
 (
__cÚ¡
 *
__domašÇme
,

88 
__cÚ¡
 *
__dœÇme
è
__THROW
;

92 *
	$bšd_‹xtdomaš_code£t
 (
__cÚ¡
 *
__domašÇme
,

93 
__cÚ¡
 *
__code£t
è
__THROW
;

97 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


100 
	#__Ãed_NULL


	)

101 
	~<¡ddef.h
>

104 
	~<loÿË.h
>

110 
	#g‘‹xt
(
msgid
è
	`dg‘‹xt
 (
NULL
, msgid)

	)

112 
	#dg‘‹xt
(
domašÇme
, 
msgid
) \

113 
	`dcg‘‹xt
 (
domašÇme
, 
msgid
, 
LC_MESSAGES
)

	)

115 
	#ng‘‹xt
(
msgid1
, 
msgid2
, 
n
è
	`dng‘‹xt
 (
NULL
, msgid1, msgid2,‚)

	)

117 
	#dng‘‹xt
(
domašÇme
, 
msgid1
, 
msgid2
, 
n
) \

118 
	`dúg‘‹xt
 (
domašÇme
, 
msgid1
, 
msgid2
, 
n
, 
LC_MESSAGES
)

	)

122 
__END_DECLS


	@/usr/include/limits.h

24 #iâdeà
_LIBC_LIMITS_H_


25 
	#_LIBC_LIMITS_H_
 1

	)

27 
	~<ã©u»s.h
>

33 
	#MB_LEN_MAX
 16

	)

38 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

43 #iâdeà
_LIMITS_H


44 
	#_LIMITS_H
 1

	)

46 
	~<b™s/wÜdsize.h
>

55 
	#CHAR_BIT
 8

	)

58 
	#SCHAR_MIN
 (-128)

	)

59 
	#SCHAR_MAX
 127

	)

62 
	#UCHAR_MAX
 255

	)

65 #ifdeà
__CHAR_UNSIGNED__


66 
	#CHAR_MIN
 0

	)

67 
	#CHAR_MAX
 
UCHAR_MAX


	)

69 
	#CHAR_MIN
 
SCHAR_MIN


	)

70 
	#CHAR_MAX
 
SCHAR_MAX


	)

74 
	#SHRT_MIN
 (-32768)

	)

75 
	#SHRT_MAX
 32767

	)

78 
	#USHRT_MAX
 65535

	)

81 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

82 
	#INT_MAX
 2147483647

	)

85 
	#UINT_MAX
 4294967295U

	)

88 #ià
__WORDSIZE
 == 64

89 
	#LONG_MAX
 9223372036854775807L

	)

91 
	#LONG_MAX
 2147483647L

	)

93 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

96 #ià
__WORDSIZE
 == 64

97 
	#ULONG_MAX
 18446744073709551615UL

	)

99 
	#ULONG_MAX
 4294967295UL

	)

102 #ifdeà
__USE_ISOC99


105 
	#LLONG_MAX
 9223372036854775807LL

	)

106 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

109 
	#ULLONG_MAX
 18446744073709551615ULL

	)

123 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


125 #šşude_Ãxˆ<
lim™s
.
h
>

131 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


132 #iâdeà
LLONG_MIN


133 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

135 #iâdeà
LLONG_MAX


136 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

138 #iâdeà
ULLONG_MAX


139 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

143 #ifdef 
__USE_POSIX


145 
	~<b™s/posix1_lim.h
>

148 #ifdef 
__USE_POSIX2


149 
	~<b™s/posix2_lim.h
>

152 #ifdef 
__USE_XOPEN


153 
	~<b™s/xİ’_lim.h
>

	@/usr/include/netdb.h

23 #iâdef 
_NETDB_H


24 
	#_NETDB_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	~<Ãtš‘/š.h
>

29 
	~<¡dšt.h
>

30 #ifdeà
__USE_MISC


33 
	~<½c/Ãtdb.h
>

36 #ifdeà
__USE_GNU


37 
	#__Ãed_sigev’t_t


	)

38 
	~<b™s/sigšfo.h
>

39 
	#__Ãed_time¥ec


	)

40 
	~<time.h
>

43 
	~<b™s/Ãtdb.h
>

46 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

47 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

48 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

49 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

50 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

51 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

54 
	g__BEGIN_DECLS


58 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

61 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

65 
	#NETDB_INTERNAL
 -1

	)

66 
	#NETDB_SUCCESS
 0

	)

67 
	#HOST_NOT_FOUND
 1

	)

68 
	#TRY_AGAIN
 2

	)

70 
	#NO_RECOVERY
 3

	)

72 
	#NO_DATA
 4

	)

74 
	#NO_ADDRESS
 
NO_DATA


	)

76 #ifdeà
__USE_XOPEN2K


78 
	#IPPORT_RESERVED
 1024

	)

81 #ifdeà
__USE_GNU


83 
	#SCOPE_DELIMITER
 '%'

	)

88 
	$h”rÜ
 (
__cÚ¡
 *
__¡r
è
__THROW
;

91 
__cÚ¡
 *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

96 
	sho¡’t


98 *
h_Çme
;

99 **
h_®Ÿ£s
;

100 
h_add¹y³
;

101 
h_Ëngth
;

102 **
h_addr_li¡
;

103 
	#h_addr
 
h_addr_li¡
[0]

	)

111 
	`£tho¡’t
 (
__¡ay_İ’
);

117 
	`’dho¡’t
 ();

124 
ho¡’t
 *
	`g‘ho¡’t
 ();

131 
ho¡’t
 *
	`g‘ho¡byaddr
 (
__cÚ¡
 *
__addr
, 
__sockËn_t
 
__Ën
,

132 
__ty³
);

138 
ho¡’t
 *
	`g‘ho¡byÇme
 (
__cÚ¡
 *
__Çme
);

140 #ifdeà
__USE_MISC


149 
ho¡’t
 *
	`g‘ho¡byÇme2
 (
__cÚ¡
 *
__Çme
, 
__af
);

161 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

162 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

163 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

164 *
__»¡riù
 
__h_”ºİ
);

166 
	`g‘ho¡byaddr_r
 (
__cÚ¡
 *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

167 
__ty³
,

168 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

169 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

170 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

171 *
__»¡riù
 
__h_”ºİ
);

173 
	`g‘ho¡byÇme_r
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

174 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

176 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

177 *
__»¡riù
 
__h_”ºİ
);

179 
	`g‘ho¡byÇme2_r
 (
__cÚ¡
 *
__»¡riù
 
__Çme
, 
__af
,

180 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

181 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

182 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

183 *
__»¡riù
 
__h_”ºİ
);

192 
	`£Š‘’t
 (
__¡ay_İ’
);

198 
	`’dÃ‹Á
 ();

205 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

212 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

218 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (
__cÚ¡
 *
__Çme
);

220 #ifdef 
__USE_MISC


231 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

232 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

233 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

234 *
__»¡riù
 
__h_”ºİ
);

236 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

237 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

238 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

239 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

240 *
__»¡riù
 
__h_”ºİ
);

242 
	`g‘ÃtbyÇme_r
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

243 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

244 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

245 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

246 *
__»¡riù
 
__h_”ºİ
);

251 
	s£rv’t


253 *
s_Çme
;

254 **
s_®Ÿ£s
;

255 
s_pÜt
;

256 *
s_´Ùo
;

264 
	`£t£rv’t
 (
__¡ay_İ’
);

270 
	`’d£rv’t
 ();

277 
£rv’t
 *
	`g‘£rv’t
 ();

284 
£rv’t
 *
	`g‘£rvbyÇme
 (
__cÚ¡
 *
__Çme
,

285 
__cÚ¡
 *
__´Ùo
);

292 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, 
__cÚ¡
 *
__´Ùo
);

295 #ifdef 
__USE_MISC


303 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

304 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

305 
£rv’t
 **
__»¡riù
 
__»suÉ
);

307 
	`g‘£rvbyÇme_r
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

308 
__cÚ¡
 *
__»¡riù
 
__´Ùo
,

309 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

310 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

311 
£rv’t
 **
__»¡riù
 
__»suÉ
);

313 
	`g‘£rvbypÜt_r
 (
__pÜt
, 
__cÚ¡
 *
__»¡riù
 
__´Ùo
,

314 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

315 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

316 
£rv’t
 **
__»¡riù
 
__»suÉ
);

321 
	s´ÙÛÁ


323 *
p_Çme
;

324 **
p_®Ÿ£s
;

325 
p_´Ùo
;

333 
	`£rÙÛÁ
 (
__¡ay_İ’
);

339 
	`’d´ÙÛÁ
 ();

346 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

352 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (
__cÚ¡
 *
__Çme
);

358 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

361 #ifdef 
__USE_MISC


369 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

370 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

371 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

373 
	`g‘´ÙobyÇme_r
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

374 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

375 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

376 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

378 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

379 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

380 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

381 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

390 
	`£Š‘g»Á
 (
__cÚ¡
 *
__Ãtgroup
);

398 
	`’dÃtg»Á
 ();

407 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

408 **
__»¡riù
 
__u£½
,

409 **
__»¡riù
 
__domašp
);

418 
	`šÃtgr
 (
__cÚ¡
 *
__Ãtgroup
, __cÚ¡ *
__ho¡
,

419 
__cÚ¡
 *
__u£r
, __cÚ¡ *
domaš
);

427 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

428 **
__»¡riù
 
__u£½
,

429 **
__»¡riù
 
__domašp
,

430 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

434 #ifdeà
__USE_BSD


446 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

447 
__cÚ¡
 *
__»¡riù
 
__locu£r
,

448 
__cÚ¡
 *
__»¡riù
 
__»mu£r
,

449 
__cÚ¡
 *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

458 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

459 
__cÚ¡
 *
__»¡riù
 
__locu£r
,

460 
__cÚ¡
 *
__»¡riù
 
__»mu£r
,

461 
__cÚ¡
 *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

462 
§_çmy_t
 
__af
);

474 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

475 
__cÚ¡
 *
__»¡riù
 
__Çme
,

476 
__cÚ¡
 *
__»¡riù
 
__·ss
,

477 
__cÚ¡
 *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

486 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

487 
__cÚ¡
 *
__»¡riù
 
__Çme
,

488 
__cÚ¡
 *
__»¡riù
 
__·ss
,

489 
__cÚ¡
 *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

490 
§_çmy_t
 
__af
);

500 
	`ru£rok
 (
__cÚ¡
 *
__rho¡
, 
__su£r
,

501 
__cÚ¡
 *
__»mu£r
, __cÚ¡ *
__locu£r
);

510 
	`ru£rok_af
 (
__cÚ¡
 *
__rho¡
, 
__su£r
,

511 
__cÚ¡
 *
__»mu£r
, __cÚ¡ *
__locu£r
,

512 
§_çmy_t
 
__af
);

522 
	`¼esvpÜt
 (*
__®pÜt
);

531 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

536 #ifdef 
__USE_POSIX


538 
	saddršfo


540 
ai_æags
;

541 
ai_çmy
;

542 
ai_sockty³
;

543 
ai_´ÙocŞ
;

544 
sockËn_t
 
ai_add¾’
;

545 
sockaddr
 *
ai_addr
;

546 *
ai_ÿnÚÇme
;

547 
addršfo
 *
ai_Ãxt
;

550 #ifdeà
__USE_GNU


552 
	sgaicb


554 cÚ¡ *
¬_Çme
;

555 cÚ¡ *
¬_£rviû
;

556 cÚ¡ 
addršfo
 *
¬_»que¡
;

557 
addršfo
 *
¬_»suÉ
;

559 
__»tuº
;

560 
__unu£d
[5];

564 
	#GAI_WAIT
 0

	)

565 
	#GAI_NOWAIT
 1

	)

569 
	#AI_PASSIVE
 0x0001

	)

570 
	#AI_CANONNAME
 0x0002

	)

571 
	#AI_NUMERICHOST
 0x0004

	)

572 
	#AI_V4MAPPED
 0x0008

	)

573 
	#AI_ALL
 0x0010

	)

574 
	#AI_ADDRCONFIG
 0x0020

	)

576 #ifdeà
__USE_GNU


577 
	#AI_IDN
 0x0040

	)

580 
	#AI_CANONIDN
 0x0080

	)

581 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

583 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

586 
	#AI_NUMERICSERV
 0x0400

	)

589 
	#EAI_BADFLAGS
 -1

	)

590 
	#EAI_NONAME
 -2

	)

591 
	#EAI_AGAIN
 -3

	)

592 
	#EAI_FAIL
 -4

	)

593 
	#EAI_NODATA
 -5

	)

594 
	#EAI_FAMILY
 -6

	)

595 
	#EAI_SOCKTYPE
 -7

	)

596 
	#EAI_SERVICE
 -8

	)

597 
	#EAI_ADDRFAMILY
 -9

	)

598 
	#EAI_MEMORY
 -10

	)

599 
	#EAI_SYSTEM
 -11

	)

600 
	#EAI_OVERFLOW
 -12

	)

601 #ifdeà
__USE_GNU


602 
	#EAI_INPROGRESS
 -100

	)

603 
	#EAI_CANCELED
 -101

	)

604 
	#EAI_NOTCANCELED
 -102

	)

605 
	#EAI_ALLDONE
 -103

	)

606 
	#EAI_INTR
 -104

	)

607 
	#EAI_IDN_ENCODE
 -105

	)

610 
	#NI_MAXHOST
 1025

	)

611 
	#NI_MAXSERV
 32

	)

613 
	#NI_NUMERICHOST
 1

	)

614 
	#NI_NUMERICSERV
 2

	)

615 
	#NI_NOFQDN
 4

	)

616 
	#NI_NAMEREQD
 8

	)

617 
	#NI_DGRAM
 16

	)

618 #ifdeà
__USE_GNU


619 
	#NI_IDN
 32

	)

620 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

622 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

631 
	`g‘addršfo
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

632 
__cÚ¡
 *
__»¡riù
 
__£rviû
,

633 
__cÚ¡
 
addršfo
 *
__»¡riù
 
__»q
,

634 
addršfo
 **
__»¡riù
 
__·i
);

637 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

640 
__cÚ¡
 *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

646 
	`g‘Çmešfo
 (
__cÚ¡
 
sockaddr
 *
__»¡riù
 
__§
,

647 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

648 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

649 
sockËn_t
 
__£rvËn
, 
__æags
);

652 #ifdeà
__USE_GNU


661 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

662 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

672 
	`gai_su¥’d
 (
__cÚ¡
 
gaicb
 *__cÚ¡ 
__li¡
[], 
__’t
,

673 
__cÚ¡
 
time¥ec
 *
__timeout
);

676 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

679 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

682 
__END_DECLS


	@/usr/include/netinet/in.h

20 #iâdef 
_NETINET_IN_H


21 
	#_NETINET_IN_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<¡dšt.h
>

25 
	~<sys/sock‘.h
>

26 
	~<b™s/ty³s.h
>

29 
__BEGIN_DECLS


34 
	mIPPROTO_IP
 = 0,

35 
	#IPPROTO_IP
 
IPPROTO_IP


	)

36 
	mIPPROTO_HOPOPTS
 = 0,

37 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

38 
	mIPPROTO_ICMP
 = 1,

39 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

40 
	mIPPROTO_IGMP
 = 2,

41 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

42 
	mIPPROTO_IPIP
 = 4,

43 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

44 
	mIPPROTO_TCP
 = 6,

45 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

46 
	mIPPROTO_EGP
 = 8,

47 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

48 
	mIPPROTO_PUP
 = 12,

49 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

50 
	mIPPROTO_UDP
 = 17,

51 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

52 
	mIPPROTO_IDP
 = 22,

53 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

54 
	mIPPROTO_TP
 = 29,

55 
	#IPPROTO_TP
 
IPPROTO_TP


	)

56 
	mIPPROTO_IPV6
 = 41,

57 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

58 
	mIPPROTO_ROUTING
 = 43,

59 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

60 
	mIPPROTO_FRAGMENT
 = 44,

61 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

62 
	mIPPROTO_RSVP
 = 46,

63 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

64 
	mIPPROTO_GRE
 = 47,

65 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

66 
	mIPPROTO_ESP
 = 50,

67 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

68 
	mIPPROTO_AH
 = 51,

69 
	#IPPROTO_AH
 
IPPROTO_AH


	)

70 
	mIPPROTO_ICMPV6
 = 58,

71 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

72 
	mIPPROTO_NONE
 = 59,

73 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

74 
	mIPPROTO_DSTOPTS
 = 60,

75 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

76 
	mIPPROTO_MTP
 = 92,

77 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_RAW
 = 255,

87 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

88 
	mIPPROTO_MAX


93 
ušt16_t
 
	tš_pÜt_t
;

98 
	mIPPORT_ECHO
 = 7,

99 
	mIPPORT_DISCARD
 = 9,

100 
	mIPPORT_SYSTAT
 = 11,

101 
	mIPPORT_DAYTIME
 = 13,

102 
	mIPPORT_NETSTAT
 = 15,

103 
	mIPPORT_FTP
 = 21,

104 
	mIPPORT_TELNET
 = 23,

105 
	mIPPORT_SMTP
 = 25,

106 
	mIPPORT_TIMESERVER
 = 37,

107 
	mIPPORT_NAMESERVER
 = 42,

108 
	mIPPORT_WHOIS
 = 43,

109 
	mIPPORT_MTP
 = 57,

111 
	mIPPORT_TFTP
 = 69,

112 
	mIPPORT_RJE
 = 77,

113 
	mIPPORT_FINGER
 = 79,

114 
	mIPPORT_TTYLINK
 = 87,

115 
	mIPPORT_SUPDUP
 = 95,

118 
	mIPPORT_EXECSERVER
 = 512,

119 
	mIPPORT_LOGINSERVER
 = 513,

120 
	mIPPORT_CMDSERVER
 = 514,

121 
	mIPPORT_EFSSERVER
 = 520,

124 
	mIPPORT_BIFFUDP
 = 512,

125 
	mIPPORT_WHOSERVER
 = 513,

126 
	mIPPORT_ROUTESERVER
 = 520,

129 
	mIPPORT_RESERVED
 = 1024,

132 
	mIPPORT_USERRESERVED
 = 5000

137 
ušt32_t
 
	tš_addr_t
;

138 
	sš_addr


140 
š_addr_t
 
	ms_addr
;

149 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

150 
	#IN_CLASSA_NET
 0xff000000

	)

151 
	#IN_CLASSA_NSHIFT
 24

	)

152 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

153 
	#IN_CLASSA_MAX
 128

	)

155 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

156 
	#IN_CLASSB_NET
 0xffff0000

	)

157 
	#IN_CLASSB_NSHIFT
 16

	)

158 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

159 
	#IN_CLASSB_MAX
 65536

	)

161 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

162 
	#IN_CLASSC_NET
 0xffffff00

	)

163 
	#IN_CLASSC_NSHIFT
 8

	)

164 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

166 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

167 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

169 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

170 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

173 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

175 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

177 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

180 
	#IN_LOOPBACKNET
 127

	)

182 #iâdeà
INADDR_LOOPBACK


183 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

187 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

188 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

189 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

190 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

194 
	sš6_addr


198 
ušt8_t
 
	mu6_addr8
[16];

199 
ušt16_t
 
	mu6_addr16
[8];

200 
ušt32_t
 
	mu6_addr32
[4];

201 } 
	mš6_u
;

202 
	#s6_addr
 
š6_u
.
u6_addr8


	)

203 
	#s6_addr16
 
š6_u
.
u6_addr16


	)

204 
	#s6_addr32
 
š6_u
.
u6_addr32


	)

207 cÚ¡ 
š6_addr
 
š6addr_ªy
;

208 cÚ¡ 
š6_addr
 
š6addr_loİback
;

209 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

210 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

212 
	#INET_ADDRSTRLEN
 16

	)

213 
	#INET6_ADDRSTRLEN
 46

	)

217 
	ssockaddr_š


219 
__SOCKADDR_COMMON
 (
sš_
);

220 
š_pÜt_t
 
	msš_pÜt
;

221 
š_addr
 
	msš_addr
;

224 
	msš_z”o
[ (
sockaddr
) -

225 
__SOCKADDR_COMMON_SIZE
 -

226  (
š_pÜt_t
) -

227  (
š_addr
)];

231 
	ssockaddr_š6


233 
__SOCKADDR_COMMON
 (
sš6_
);

234 
š_pÜt_t
 
	msš6_pÜt
;

235 
ušt32_t
 
	msš6_æowšfo
;

236 
š6_addr
 
	msš6_addr
;

237 
ušt32_t
 
	msš6_scİe_id
;

242 
	s_m»q


245 
š_addr
 
	mimr_muÉŸddr
;

248 
š_addr
 
	mimr_š‹rçû
;

251 
	s_m»q_sourû


254 
š_addr
 
	mimr_muÉŸddr
;

257 
š_addr
 
	mimr_š‹rçû
;

260 
š_addr
 
	mimr_sourûaddr
;

264 
	sv6_m»q


267 
š6_addr
 
	mv6mr_muÉŸddr
;

270 
	mv6mr_š‹rçû
;

275 
	sgroup_»q


278 
ušt32_t
 
	mgr_š‹rçû
;

281 
sockaddr_¡Üage
 
	mgr_group
;

284 
	sgroup_sourû_»q


287 
ušt32_t
 
	mg¤_š‹rçû
;

290 
sockaddr_¡Üage
 
	mg¤_group
;

293 
sockaddr_¡Üage
 
	mg¤_sourû
;

298 
	s_msf‹r


301 
š_addr
 
	mimsf_muÉŸddr
;

304 
š_addr
 
	mimsf_š‹rçû
;

307 
ušt32_t
 
	mimsf_fmode
;

310 
ušt32_t
 
	mimsf_num¤c
;

312 
š_addr
 
	mimsf_¦i¡
[1];

315 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

316 -  (
š_addr
) \

317 + (
num¤c
è*  (
š_addr
))

	)

319 
	sgroup_f‹r


322 
ušt32_t
 
	mgf_š‹rçû
;

325 
sockaddr_¡Üage
 
	mgf_group
;

328 
ušt32_t
 
	mgf_fmode
;

331 
ušt32_t
 
	mgf_num¤c
;

333 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

336 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

337 -  (
sockaddr_¡Üage
) \

338 + ((
num¤c
) \

339 *  (
sockaddr_¡Üage
)))

	)

343 
	~<b™s/š.h
>

352 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

353 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

354 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

355 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

356 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

357 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

358 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

360 
	~<’dŸn.h
>

363 
	~<b™s/by‹sw­.h
>

365 #ifdeà
__OPTIMIZE__


369 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


372 
	#Áohl
(
x
è(x)

	)

373 
	#Áohs
(
x
è(x)

	)

374 
	#htÚl
(
x
è(x)

	)

375 
	#htÚs
(
x
è(x)

	)

377 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


378 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

379 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

380 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

381 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

386 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

387 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0 \

388 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0 \

389 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0 \

390 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

392 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

393 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0 \

394 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0 \

395 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0 \

396 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

398 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((
__cÚ¡
 
ušt8_t
 *è×))[0] =ğ0xff)

	)

400 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

401 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

402 =ğ
	`htÚl
 (0xã800000))

	)

404 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

405 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

406 =ğ
	`htÚl
 (0xãc00000))

	)

408 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

409 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0) \

410 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0) \

411 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

413 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

414 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0) \

415 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0) \

416 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0) \

417 && (
	`Áohl
 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[3]è> 1))

	)

419 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

420 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[0]) \

421 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[1]) \

422 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[2]) \

423 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

426 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

429 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

430 
__THROW
;

433 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

434 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

435 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

437 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

438 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

439 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

441 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

442 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

443 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

445 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

446 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

447 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

449 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

450 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

451 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

454 
	sš6_pktšfo


456 
š6_addr
 
i6_addr
;

457 
i6_ifšdex
;

461 
	s6_mtušfo


463 
sockaddr_š6
 
6m_addr
;

464 
ušt32_t
 
6m_mtu
;

468 #ifdeà
__USE_GNU


470 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

471 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

472 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

473 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

474 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

475 
__cÚ¡
 
ušt8_t
 *
__ty³p
, 
__muÉx
,

476 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

477 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

478 
__muÉx
, 
__¶usy
)

479 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

480 
	$š‘6_İtiÚ_Ãxt
 (
__cÚ¡
 
cmsghdr
 *
__cmsg
,

481 
ušt8_t
 **
__Œp
)

482 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

483 
	$š‘6_İtiÚ_fšd
 (
__cÚ¡
 
cmsghdr
 *
__cmsg
,

484 
ušt8_t
 **
__Œp
, 
__ty³
)

485 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

489 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

490 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

491 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

492 **
__d©abuå
è
__THROW
;

493 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

494 
__THROW
;

495 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

496 
sockËn_t
 
__v®Ën
è
__THROW
;

497 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

498 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

499 **
__d©abuå
è
__THROW
;

500 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

501 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

502 **
__d©abuå
è
__THROW
;

503 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

504 
sockËn_t
 
__v®Ën
è
__THROW
;

508 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

509 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

510 
__£gm’ts
è
__THROW
;

511 
	$š‘6_¹h_add
 (*
__bp
, 
__cÚ¡
 
š6_addr
 *
__addr
è
__THROW
;

512 
	$š‘6_¹h_»v”£
 (
__cÚ¡
 *
__š
, *
__out
è
__THROW
;

513 
	$š‘6_¹h_£gm’ts
 (
__cÚ¡
 *
__bp
è
__THROW
;

514 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (
__cÚ¡
 *
__bp
, 
__šdex
)

515 
__THROW
;

521 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

522 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

523 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

524 
__THROW
;

527 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

528 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

529 
ušt32_t
 
__num¤c
,

530 
__cÚ¡
 
š_addr
 *
__¦i¡
)

531 
__THROW
;

535 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

536 
__cÚ¡
 
sockaddr
 *
__group
,

537 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

538 
ušt32_t
 *
__num¤c
,

539 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

542 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

543 
__cÚ¡
 
sockaddr
 *
__group
,

544 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

545 
ušt32_t
 
__num¤c
,

546 
__cÚ¡
 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

549 
__END_DECLS


	@/usr/include/netinet/in_systm.h

20 #iâdeà
_NETINET_IN_SYSTM_H


21 
	#_NETINET_IN_SYSTM_H
 1

	)

23 
	~<sys/cdefs.h
>

24 
	~<sys/ty³s.h
>

26 
__BEGIN_DECLS


35 
u_št16_t
 
	tn_shÜt
;

36 
u_št32_t
 
	tn_lÚg
;

37 
u_št32_t
 
	tn_time
;

39 
	g__END_DECLS


	@/usr/include/netinet/ip.h

19 #iâdeà
__NETINET_IP_H


20 
	#__NETINET_IP_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<sys/ty³s.h
>

25 
	~<Ãtš‘/š.h
>

27 
__BEGIN_DECLS


29 
	stime¡amp


31 
u_št8_t
 
	mËn
;

32 
u_št8_t
 
	m±r
;

33 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


34 
	mæags
:4;

35 
	mov”æow
:4;

36 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


37 
	mov”æow
:4;

38 
	mæags
:4;

42 
u_št32_t
 
	md©a
[9];

45 
	shdr


47 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


48 
	mihl
:4;

49 
	mv”siÚ
:4;

50 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


51 
	mv”siÚ
:4;

52 
	mihl
:4;

56 
u_št8_t
 
	mtos
;

57 
u_št16_t
 
	mtÙ_Ën
;

58 
u_št16_t
 
	mid
;

59 
u_št16_t
 
	mäag_off
;

60 
u_št8_t
 
	m‰l
;

61 
u_št8_t
 
	m´ÙocŞ
;

62 
u_št16_t
 
	mcheck
;

63 
u_št32_t
 
	m§ddr
;

64 
u_št32_t
 
	mdaddr
;

68 #ifdeà
__USE_BSD


108 
	s


110 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


111 
	m_hl
:4;

112 
	m_v
:4;

114 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


115 
	m_v
:4;

116 
	m_hl
:4;

118 
u_št8_t
 
	m_tos
;

119 
u_shÜt
 
	m_Ën
;

120 
u_shÜt
 
	m_id
;

121 
u_shÜt
 
	m_off
;

122 
	#IP_RF
 0x8000

	)

123 
	#IP_DF
 0x4000

	)

124 
	#IP_MF
 0x2000

	)

125 
	#IP_OFFMASK
 0x1ffà

	)

126 
u_št8_t
 
	m_‰l
;

127 
u_št8_t
 
	m_p
;

128 
u_shÜt
 
	m_sum
;

129 
š_addr
 
	m_¤c
, 
	m_d¡
;

135 
	s_time¡amp


137 
u_št8_t
 
	mt_code
;

138 
u_št8_t
 
	mt_Ën
;

139 
u_št8_t
 
	mt_±r
;

140 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


141 
	mt_æg
:4;

142 
	mt_oæw
:4;

144 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


145 
	mt_oæw
:4;

146 
	mt_æg
:4;

148 
u_št32_t
 
	md©a
[9];

152 
	#IPVERSION
 4

	)

153 
	#IP_MAXPACKET
 65535

	)

158 
	#IPTOS_TOS_MASK
 0x1E

	)

159 
	#IPTOS_TOS
(
tos
è(Ñosè& 
IPTOS_TOS_MASK
)

	)

160 
	#IPTOS_LOWDELAY
 0x10

	)

161 
	#IPTOS_THROUGHPUT
 0x08

	)

162 
	#IPTOS_RELIABILITY
 0x04

	)

163 
	#IPTOS_LOWCOST
 0x02

	)

164 
	#IPTOS_MINCOST
 
IPTOS_LOWCOST


	)

169 
	#IPTOS_PREC_MASK
 0xe0

	)

170 
	#IPTOS_PREC
(
tos
è(Ñosè& 
IPTOS_PREC_MASK
)

	)

171 
	#IPTOS_PREC_NETCONTROL
 0xe0

	)

172 
	#IPTOS_PREC_INTERNETCONTROL
 0xc0

	)

173 
	#IPTOS_PREC_CRITIC_ECP
 0xa0

	)

174 
	#IPTOS_PREC_FLASHOVERRIDE
 0x80

	)

175 
	#IPTOS_PREC_FLASH
 0x60

	)

176 
	#IPTOS_PREC_IMMEDIATE
 0x40

	)

177 
	#IPTOS_PREC_PRIORITY
 0x20

	)

178 
	#IPTOS_PREC_ROUTINE
 0x00

	)

183 
	#IPOPT_COPY
 0x80

	)

184 
	#IPOPT_CLASS_MASK
 0x60

	)

185 
	#IPOPT_NUMBER_MASK
 0x1f

	)

187 
	#IPOPT_COPIED
(
o
è((oè& 
IPOPT_COPY
)

	)

188 
	#IPOPT_CLASS
(
o
è((oè& 
IPOPT_CLASS_MASK
)

	)

189 
	#IPOPT_NUMBER
(
o
è((oè& 
IPOPT_NUMBER_MASK
)

	)

191 
	#IPOPT_CONTROL
 0x00

	)

192 
	#IPOPT_RESERVED1
 0x20

	)

193 
	#IPOPT_DEBMEAS
 0x40

	)

194 
	#IPOPT_MEASUREMENT
 
IPOPT_DEBMEAS


	)

195 
	#IPOPT_RESERVED2
 0x60

	)

197 
	#IPOPT_EOL
 0

	)

198 
	#IPOPT_END
 
IPOPT_EOL


	)

199 
	#IPOPT_NOP
 1

	)

200 
	#IPOPT_NOOP
 
IPOPT_NOP


	)

202 
	#IPOPT_RR
 7

	)

203 
	#IPOPT_TS
 68

	)

204 
	#IPOPT_TIMESTAMP
 
IPOPT_TS


	)

205 
	#IPOPT_SECURITY
 130

	)

206 
	#IPOPT_SEC
 
IPOPT_SECURITY


	)

207 
	#IPOPT_LSRR
 131

	)

208 
	#IPOPT_SATID
 136

	)

209 
	#IPOPT_SID
 
IPOPT_SATID


	)

210 
	#IPOPT_SSRR
 137

	)

211 
	#IPOPT_RA
 148

	)

216 
	#IPOPT_OPTVAL
 0

	)

217 
	#IPOPT_OLEN
 1

	)

218 
	#IPOPT_OFFSET
 2

	)

219 
	#IPOPT_MINOFF
 4

	)

221 
	#MAX_IPOPTLEN
 40

	)

224 
	#IPOPT_TS_TSONLY
 0

	)

225 
	#IPOPT_TS_TSANDADDR
 1

	)

226 
	#IPOPT_TS_PRESPEC
 3

	)

229 
	#IPOPT_SECUR_UNCLASS
 0x0000

	)

230 
	#IPOPT_SECUR_CONFID
 0xf135

	)

231 
	#IPOPT_SECUR_EFTO
 0x789a

	)

232 
	#IPOPT_SECUR_MMMM
 0xbc4d

	)

233 
	#IPOPT_SECUR_RESTR
 0xaf13

	)

234 
	#IPOPT_SECUR_SECRET
 0xd788

	)

235 
	#IPOPT_SECUR_TOPSECRET
 0x6bc5

	)

240 
	#MAXTTL
 255

	)

241 
	#IPDEFTTL
 64

	)

242 
	#IPFRAGTTL
 60

	)

243 
	#IPTTLDEC
 1

	)

245 
	#IP_MSS
 576

	)

247 
	g__END_DECLS


	@/usr/include/netinet/tcp.h

32 #iâdeà
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<ã©u»s.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

55 #ifdeà
__USE_MISC


56 
	~<sys/ty³s.h
>

57 
	~<sys/sock‘.h
>

59 #ifdeà
__FAVOR_BSD


60 
u_št32_t
 
	ttı_£q
;

65 
	stıhdr


67 
u_št16_t
 
	mth_¥Üt
;

68 
u_št16_t
 
	mth_dpÜt
;

69 
tı_£q
 
	mth_£q
;

70 
tı_£q
 
	mth_ack
;

71 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


72 
u_št8_t
 
	mth_x2
:4;

73 
u_št8_t
 
	mth_off
:4;

75 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


76 
u_št8_t
 
	mth_off
:4;

77 
u_št8_t
 
	mth_x2
:4;

79 
u_št8_t
 
	mth_æags
;

80 
	#TH_FIN
 0x01

	)

81 
	#TH_SYN
 0x02

	)

82 
	#TH_RST
 0x04

	)

83 
	#TH_PUSH
 0x08

	)

84 
	#TH_ACK
 0x10

	)

85 
	#TH_URG
 0x20

	)

86 
u_št16_t
 
	mth_wš
;

87 
u_št16_t
 
	mth_sum
;

88 
u_št16_t
 
	mth_u½
;

92 
	stıhdr


94 
u_št16_t
 
	msourû
;

95 
u_št16_t
 
	mde¡
;

96 
u_št32_t
 
	m£q
;

97 
u_št32_t
 
	mack_£q
;

98 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


99 
u_št16_t
 
	m»s1
:4;

100 
u_št16_t
 
	mdoff
:4;

101 
u_št16_t
 
	mfš
:1;

102 
u_št16_t
 
	msyn
:1;

103 
u_št16_t
 
	mr¡
:1;

104 
u_št16_t
 
	mpsh
:1;

105 
u_št16_t
 
	mack
:1;

106 
u_št16_t
 
	murg
:1;

107 
u_št16_t
 
	m»s2
:2;

108 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


109 
u_št16_t
 
	mdoff
:4;

110 
u_št16_t
 
	m»s1
:4;

111 
u_št16_t
 
	m»s2
:2;

112 
u_št16_t
 
	murg
:1;

113 
u_št16_t
 
	mack
:1;

114 
u_št16_t
 
	mpsh
:1;

115 
u_št16_t
 
	mr¡
:1;

116 
u_št16_t
 
	msyn
:1;

117 
u_št16_t
 
	mfš
:1;

121 
u_št16_t
 
	mwšdow
;

122 
u_št16_t
 
	mcheck
;

123 
u_št16_t
 
	murg_±r
;

129 
	mTCP_ESTABLISHED
 = 1,

130 
	mTCP_SYN_SENT
,

131 
	mTCP_SYN_RECV
,

132 
	mTCP_FIN_WAIT1
,

133 
	mTCP_FIN_WAIT2
,

134 
	mTCP_TIME_WAIT
,

135 
	mTCP_CLOSE
,

136 
	mTCP_CLOSE_WAIT
,

137 
	mTCP_LAST_ACK
,

138 
	mTCP_LISTEN
,

139 
	mTCP_CLOSING


142 
	#TCPOPT_EOL
 0

	)

143 
	#TCPOPT_NOP
 1

	)

144 
	#TCPOPT_MAXSEG
 2

	)

145 
	#TCPOLEN_MAXSEG
 4

	)

146 
	#TCPOPT_WINDOW
 3

	)

147 
	#TCPOLEN_WINDOW
 3

	)

148 
	#TCPOPT_SACK_PERMITTED
 4

	)

149 
	#TCPOLEN_SACK_PERMITTED
 2

	)

150 
	#TCPOPT_SACK
 5

	)

151 
	#TCPOPT_TIMESTAMP
 8

	)

152 
	#TCPOLEN_TIMESTAMP
 10

	)

153 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2è

	)

155 
	#TCPOPT_TSTAMP_HDR
 \

156 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

164 
	#TCP_MSS
 512

	)

166 
	#TCP_MAXWIN
 65535

	)

168 
	#TCP_MAX_WINSHIFT
 14

	)

170 
	#SOL_TCP
 6

	)

173 
	#TCPI_OPT_TIMESTAMPS
 1

	)

174 
	#TCPI_OPT_SACK
 2

	)

175 
	#TCPI_OPT_WSCALE
 4

	)

176 
	#TCPI_OPT_ECN
 8

	)

179 
	etı_ÿ_¡©e


181 
	mTCP_CA_O³n
 = 0,

182 
	mTCP_CA_DisÜd”
 = 1,

183 
	mTCP_CA_CWR
 = 2,

184 
	mTCP_CA_Recov”y
 = 3,

185 
	mTCP_CA_Loss
 = 4

188 
	stı_šfo


190 
u_št8_t
 
	mtıi_¡©e
;

191 
u_št8_t
 
	mtıi_ÿ_¡©e
;

192 
u_št8_t
 
	mtıi_»Œªsm™s
;

193 
u_št8_t
 
	mtıi_´obes
;

194 
u_št8_t
 
	mtıi_backoff
;

195 
u_št8_t
 
	mtıi_İtiÚs
;

196 
u_št8_t
 
	mtıi_¢d_wsÿË
 : 4, 
	mtıi_rcv_wsÿË
 : 4;

198 
u_št32_t
 
	mtıi_¹o
;

199 
u_št32_t
 
	mtıi_©o
;

200 
u_št32_t
 
	mtıi_¢d_mss
;

201 
u_št32_t
 
	mtıi_rcv_mss
;

203 
u_št32_t
 
	mtıi_uÇcked
;

204 
u_št32_t
 
	mtıi_§cked
;

205 
u_št32_t
 
	mtıi_lo¡
;

206 
u_št32_t
 
	mtıi_»Œªs
;

207 
u_št32_t
 
	mtıi_çck‘s
;

210 
u_št32_t
 
	mtıi_Ï¡_d©a_£Á
;

211 
u_št32_t
 
	mtıi_Ï¡_ack_£Á
;

212 
u_št32_t
 
	mtıi_Ï¡_d©a_»cv
;

213 
u_št32_t
 
	mtıi_Ï¡_ack_»cv
;

216 
u_št32_t
 
	mtıi_pmtu
;

217 
u_št32_t
 
	mtıi_rcv_s¡h»sh
;

218 
u_št32_t
 
	mtıi_¹t
;

219 
u_št32_t
 
	mtıi_¹tv¬
;

220 
u_št32_t
 
	mtıi_¢d_s¡h»sh
;

221 
u_št32_t
 
	mtıi_¢d_cwnd
;

222 
u_št32_t
 
	mtıi_advmss
;

223 
u_št32_t
 
	mtıi_»Üd”šg
;

225 
u_št32_t
 
	mtıi_rcv_¹t
;

226 
u_št32_t
 
	mtıi_rcv_¥aû
;

228 
u_št32_t
 
	mtıi_tÙ®_»Œªs
;

233 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

235 
	stı_md5sig


237 
sockaddr_¡Üage
 
	mtım_addr
;

238 
u_št16_t
 
	m__tım_·d1
;

239 
u_št16_t
 
	mtım_keyËn
;

240 
u_št32_t
 
	m__tım_·d2
;

241 
u_št8_t
 
	mtım_key
[
TCP_MD5SIG_MAXKEYLEN
];

	@/usr/include/signal.h

23 #iâdef 
_SIGNAL_H


25 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


26 
	#_SIGNAL_H


	)

29 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


33 
	~<b™s/sig£t.h
>

37 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


38 #iâdeà
__sig_©omic_t_defšed


39 
	#__sig_©omic_t_defšed


	)

40 
__BEGIN_NAMESPACE_STD


41 
__sig_©omic_t
 
	tsig_©omic_t
;

42 
	g__END_NAMESPACE_STD


44 #undeà
__Ãed_sig_©omic_t


47 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

48 #iâdeà
__sig£t_t_defšed


49 
	#__sig£t_t_defšed


	)

50 
__sig£t_t
 
	tsig£t_t
;

52 #undeà
__Ãed_sig£t_t


55 #ifdeà
_SIGNAL_H


57 
	~<b™s/ty³s.h
>

58 
	~<b™s/signum.h
>

60 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


61 #iâdeà
__pid_t_defšed


62 
__pid_t
 
	tpid_t
;

63 
	#__pid_t_defšed


	)

65 #ifdeà
__USE_XOPEN


67 #iâdeà
__uid_t_defšed


68 
__uid_t
 
	tuid_t
;

69 
	#__uid_t_defšed


	)

75 (*
	t__sighªdËr_t
) ();

80 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

81 
__THROW
;

82 #ifdeà
__USE_GNU


83 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

84 
__THROW
;

90 
__BEGIN_NAMESPACE_STD


91 #ifdeà
__USE_BSD


92 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

93 
__THROW
;

96 #ifdeà
__REDIRECT_NTH


97 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

98 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

99 
__sysv_sigÇl
);

101 
	#sigÇl
 
__sysv_sigÇl


	)

104 
__END_NAMESPACE_STD


106 #ifdeà
__USE_XOPEN


109 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

110 
__THROW
;

116 #ifdeà
__USE_POSIX


117 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

120 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


124 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

127 
__BEGIN_NAMESPACE_STD


129 
	$¿i£
 (
__sig
è
__THROW
;

130 
__END_NAMESPACE_STD


132 #ifdeà
__USE_SVID


134 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

135 
__THROW
;

136 
	$gsigÇl
 (
__sig
è
__THROW
;

139 #ifdeà
__USE_MISC


141 
	`psigÇl
 (
__sig
, 
__cÚ¡
 *
__s
);

153 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

155 #ifdeà
__FAVOR_BSD


158 
	$sig·u£
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

160 #ifdeà
__USE_XOPEN


161 #ifdeà
__GNUC__


162 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

165 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

171 #ifdeà
__USE_BSD


178 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

181 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

184 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

187 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

191 #ifdeà
__USE_MISC


192 
	#NSIG
 
_NSIG


	)

195 #ifdeà
__USE_GNU


196 
__sighªdËr_t
 
	tsighªdËr_t
;

200 #ifdeà
__USE_BSD


201 
__sighªdËr_t
 
	tsig_t
;

204 #ifdeà
__USE_POSIX


206 #ifdeà
__USE_POSIX199309


208 
	#__Ãed_time¥ec


	)

209 
	~<time.h
>

212 
	~<b™s/sigšfo.h
>

216 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

219 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

222 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

228 
	$sigismemb”
 (
__cÚ¡
 
sig£t_t
 *
__£t
, 
__signo
)

229 
__THROW
 
	`__nÚnuÎ
 ((1));

231 #ifdeà
__USE_GNU


233 
	$sigi£m±y£t
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

236 
	$sigªd£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

237 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

240 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

241 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

246 
	~<b™s/sigaùiÚ.h
>

249 
	$sig´ocmask
 (
__how
, 
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

250 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

257 
	$sigsu¥’d
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

260 
	$sigaùiÚ
 (
__sig
, 
__cÚ¡
 
sigaùiÚ
 *
__»¡riù
 
__aù
,

261 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

264 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

271 
	$sigwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

272 
	`__nÚnuÎ
 ((1, 2));

274 #ifdeà
__USE_POSIX199309


279 
	$sigwa™šfo
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

280 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

287 
	$sigtimedwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

288 
sigšfo_t
 *
__»¡riù
 
__šfo
,

289 
__cÚ¡
 
time¥ec
 *
__»¡riù
 
__timeout
)

290 
	`__nÚnuÎ
 ((1));

294 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, 
__cÚ¡
 
sigv®
 
__v®
)

295 
__THROW
;

300 #ifdeà
__USE_BSD


304 
__cÚ¡
 *__cÚ¡ 
_sys_sigli¡
[
_NSIG
];

305 
__cÚ¡
 *__cÚ¡ 
sys_sigli¡
[
_NSIG
];

308 
	ssigvec


310 
__sighªdËr_t
 
sv_hªdËr
;

311 
sv_mask
;

313 
sv_æags
;

314 
	#sv_Ú¡ack
 
sv_æags


	)

318 
	#SV_ONSTACK
 (1 << 0)

	)

319 
	#SV_INTERRUPT
 (1 << 1)

	)

320 
	#SV_RESETHAND
 (1 << 2)

	)

328 
	$sigvec
 (
__sig
, 
__cÚ¡
 
sigvec
 *
__vec
,

329 
sigvec
 *
__ovec
è
__THROW
;

333 
	~<b™s/sigcÚ‹xt.h
>

336 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

341 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


342 
	#__Ãed_size_t


	)

343 
	~<¡ddef.h
>

348 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

350 
	~<b™s/sig¡ack.h
>

351 #ifdeà
__USE_XOPEN


353 
	~<sys/ucÚ‹xt.h
>

359 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

360 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

364 
	$sig®t¡ack
 (
__cÚ¡
 
sig®t¡ack
 *
__»¡riù
 
__ss
,

365 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

369 #ifdeà
__USE_XOPEN_EXTENDED


373 
	$sighŞd
 (
__sig
è
__THROW
;

376 
	$sig»l£
 (
__sig
è
__THROW
;

379 
	$sigignÜe
 (
__sig
è
__THROW
;

382 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

385 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


388 
	~<b™s/±h»adty³s.h
>

389 
	~<b™s/sigth»ad.h
>

396 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

398 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

402 
__END_DECLS


	@/usr/include/stdio.h

24 #iâdeà
_STDIO_H


26 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


27 
	#_STDIO_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	#__Ãed_size_t


	)

33 
	#__Ãed_NULL


	)

34 
	~<¡ddef.h
>

36 
	~<b™s/ty³s.h
>

37 
	#__Ãed_FILE


	)

38 
	#__Ãed___FILE


	)

42 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


45 
	g_IO_FILE
;

47 
__BEGIN_NAMESPACE_STD


49 
_IO_FILE
 
	tFILE
;

50 
	g__END_NAMESPACE_STD


51 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

52 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

53 || 
defšed
 
__USE_POSIX2


54 
	$__USING_NAMESPACE_STD
(
FILE
)

57 
	#__FILE_defšed
 1

	)

59 #undeà
__Ãed_FILE


62 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


65 
_IO_FILE
 
	t__FILE
;

67 
	#____FILE_defšed
 1

	)

69 #undeà
__Ãed___FILE


72 #ifdef 
_STDIO_H


73 
	#_STDIO_USES_IOSTREAM


	)

75 
	~<libio.h
>

77 #ifdeà
__USE_XOPEN


78 #ifdeà
__GNUC__


79 #iâdeà
_VA_LIST_DEFINED


80 
_G_va_li¡
 
	tva_li¡
;

81 
	#_VA_LIST_DEFINED


	)

84 
	~<¡d¬g.h
>

89 
__BEGIN_NAMESPACE_STD


90 #iâdeà
__USE_FILE_OFFSET64


91 
_G_åos_t
 
	tåos_t
;

93 
_G_åos64_t
 
	tåos_t
;

95 
__END_NAMESPACE_STD


96 #ifdeà
__USE_LARGEFILE64


97 
_G_åos64_t
 
	tåos64_t
;

101 
	#_IOFBF
 0

	)

102 
	#_IOLBF
 1

	)

103 
	#_IONBF
 2

	)

107 #iâdeà
BUFSIZ


108 
	#BUFSIZ
 
_IO_BUFSIZ


	)

114 #iâdeà
EOF


115 
	#EOF
 (-1)

	)

121 
	#SEEK_SET
 0

	)

122 
	#SEEK_CUR
 1

	)

123 
	#SEEK_END
 2

	)

126 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


128 
	#P_tmpdœ
 "/tmp"

	)

141 
	~<b™s/¡dio_lim.h
>

145 
_IO_FILE
 *
¡dš
;

146 
_IO_FILE
 *
¡dout
;

147 
_IO_FILE
 *
¡d”r
;

149 
	#¡dš
 
¡dš


	)

150 
	#¡dout
 
¡dout


	)

151 
	#¡d”r
 
¡d”r


	)

153 
__BEGIN_NAMESPACE_STD


155 
	$»move
 (
__cÚ¡
 *
__f’ame
è
__THROW
;

157 
	$»Çme
 (
__cÚ¡
 *
__Şd
, __cÚ¡ *
__Ãw
è
__THROW
;

158 
__END_NAMESPACE_STD


160 #ifdeà
__USE_ATFILE


162 
	$»Çm—t
 (
__Şdfd
, 
__cÚ¡
 *
__Şd
, 
__Ãwfd
,

163 
__cÚ¡
 *
__Ãw
è
__THROW
;

166 
__BEGIN_NAMESPACE_STD


171 #iâdeà
__USE_FILE_OFFSET64


172 
FILE
 *
	$tmpfe
 (è
__wur
;

174 #ifdeà
__REDIRECT


175 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

177 
	#tmpfe
 
tmpfe64


	)

181 #ifdeà
__USE_LARGEFILE64


182 
FILE
 *
	$tmpfe64
 (è
__wur
;

186 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

187 
__END_NAMESPACE_STD


189 #ifdeà
__USE_MISC


192 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

196 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


204 *
	$‹m²am
 (
__cÚ¡
 *
__dœ
, __cÚ¡ *
__pfx
)

205 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

209 
__BEGIN_NAMESPACE_STD


214 
	`fşo£
 (
FILE
 *
__¡»am
);

219 
	`fæush
 (
FILE
 *
__¡»am
);

220 
__END_NAMESPACE_STD


222 #ifdeà
__USE_MISC


229 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

232 #ifdeà
__USE_GNU


239 
	`fşo£®l
 ();

243 
__BEGIN_NAMESPACE_STD


244 #iâdeà
__USE_FILE_OFFSET64


249 
FILE
 *
	$fİ’
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

250 
__cÚ¡
 *
__»¡riù
 
__modes
è
__wur
;

255 
FILE
 *
	$äeİ’
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

256 
__cÚ¡
 *
__»¡riù
 
__modes
,

257 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

259 #ifdeà
__REDIRECT


260 
FILE
 *
	`__REDIRECT
 (
fİ’
, (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

261 
__cÚ¡
 *
__»¡riù
 
__modes
), 
fİ’64
)

262 
__wur
;

263 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

264 
__cÚ¡
 *
__»¡riù
 
__modes
,

265 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

266 
__wur
;

268 
	#fİ’
 
fİ’64


	)

269 
	#äeİ’
 
äeİ’64


	)

272 
__END_NAMESPACE_STD


273 #ifdeà
__USE_LARGEFILE64


274 
FILE
 *
	$fİ’64
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

275 
__cÚ¡
 *
__»¡riù
 
__modes
è
__wur
;

276 
FILE
 *
	$äeİ’64
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

277 
__cÚ¡
 *
__»¡riù
 
__modes
,

278 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

281 #ifdef 
__USE_POSIX


283 
FILE
 *
	$fdİ’
 (
__fd
, 
__cÚ¡
 *
__modes
è
__THROW
 
__wur
;

286 #ifdef 
__USE_GNU


289 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

290 
__cÚ¡
 *
__»¡riù
 
__modes
,

291 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

294 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, 
__cÚ¡
 *
__modes
)

295 
__THROW
 
__wur
;

300 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

304 
__BEGIN_NAMESPACE_STD


307 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

311 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

312 
__modes
, 
size_t
 
__n
è
__THROW
;

313 
__END_NAMESPACE_STD


315 #ifdef 
__USE_BSD


318 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

319 
size_t
 
__size
è
__THROW
;

322 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

326 
__BEGIN_NAMESPACE_STD


331 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

332 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

337 
	`´štf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

339 
	$¥rštf
 (*
__»¡riù
 
__s
,

340 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

346 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

347 
_G_va_li¡
 
__¬g
);

352 
	`v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

354 
	$v¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

355 
_G_va_li¡
 
__¬g
è
__THROW
;

356 
__END_NAMESPACE_STD


358 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


359 
__BEGIN_NAMESPACE_C99


361 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

362 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...)

363 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

365 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

366 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

367 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

368 
__END_NAMESPACE_C99


371 #ifdeà
__USE_GNU


374 
	$va¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__f
,

375 
_G_va_li¡
 
__¬g
)

376 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

377 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

378 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

379 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

380 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

381 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

382 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

390 
	$vd´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
,

391 
_G_va_li¡
 
__¬g
)

392 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

393 
	$d´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

394 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

398 
__BEGIN_NAMESPACE_STD


403 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

404 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

409 
	$sÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

411 
	$ssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

412 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

414 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

415 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

416 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

417 #ifdeà
__REDIRECT


421 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

422 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

423 
__isoc99_fsÿnf
è
__wur
;

424 
	`__REDIRECT
 (
sÿnf
, (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

425 
__isoc99_sÿnf
è
__wur
;

426 
	`__REDIRECT
 (
ssÿnf
, (
__cÚ¡
 *
__»¡riù
 
__s
,

427 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

428 
__isoc99_ssÿnf
è
__THROW
;

430 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

431 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

432 
	$__isoc99_sÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$__isoc99_ssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

434 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

435 
	#fsÿnf
 
__isoc99_fsÿnf


	)

436 
	#sÿnf
 
__isoc99_sÿnf


	)

437 
	#ssÿnf
 
__isoc99_ssÿnf


	)

441 
__END_NAMESPACE_STD


443 #ifdef 
__USE_ISOC99


444 
__BEGIN_NAMESPACE_C99


449 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

450 
_G_va_li¡
 
__¬g
)

451 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

457 
	$vsÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

458 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

461 
	$vssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

462 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

463 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

465 #ià!
defšed
 
__USE_GNU
 \

466 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

467 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

468 #ifdeà
__REDIRECT


472 
	`__REDIRECT
 (
vfsÿnf
,

473 (
FILE
 *
__»¡riù
 
__s
,

474 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

475 
__isoc99_vfsÿnf
)

476 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

477 
	`__REDIRECT
 (
vsÿnf
, (
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

478 
_G_va_li¡
 
__¬g
), 
__isoc99_vfsÿnf
)

479 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

480 
	`__REDIRECT
 (
vssÿnf
,

481 (
__cÚ¡
 *
__»¡riù
 
__s
,

482 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

483 
__isoc99_vssÿnf
)

484 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

486 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

487 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

488 
_G_va_li¡
 
__¬g
è
__wur
;

489 
	$__isoc99_vsÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

490 
_G_va_li¡
 
__¬g
è
__wur
;

491 
	$__isoc99_vssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

492 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

493 
_G_va_li¡
 
__¬g
è
__THROW
;

494 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

495 
	#vsÿnf
 
__isoc99_vsÿnf


	)

496 
	#vssÿnf
 
__isoc99_vssÿnf


	)

500 
__END_NAMESPACE_C99


504 
__BEGIN_NAMESPACE_STD


509 
	`fg‘c
 (
FILE
 *
__¡»am
);

510 
	`g‘c
 (
FILE
 *
__¡»am
);

516 
	`g‘ch¬
 ();

517 
__END_NAMESPACE_STD


521 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

523 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


528 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

529 
	`g‘ch¬_uÆocked
 ();

532 #ifdeà
__USE_MISC


539 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

543 
__BEGIN_NAMESPACE_STD


551 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

552 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

558 
	`putch¬
 (
__c
);

559 
__END_NAMESPACE_STD


563 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

565 #ifdeà
__USE_MISC


572 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

575 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


580 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

581 
	`putch¬_uÆocked
 (
__c
);

585 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

586 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

588 
	`g‘w
 (
FILE
 *
__¡»am
);

591 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

595 
__BEGIN_NAMESPACE_STD


600 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

601 
__wur
;

608 *
	$g‘s
 (*
__s
è
__wur
;

609 
__END_NAMESPACE_STD


611 #ifdeà
__USE_GNU


618 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

619 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

623 #ifdef 
__USE_GNU


634 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

635 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

636 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

637 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

638 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

639 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

647 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

648 
size_t
 *
__»¡riù
 
__n
,

649 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

653 
__BEGIN_NAMESPACE_STD


658 
	`åuts
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

664 
	`puts
 (
__cÚ¡
 *
__s
);

671 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

678 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

679 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
size_t
 
	$fwr™e
 (
__cÚ¡
 *
__»¡riù
 
__±r
, 
size_t
 
__size
,

685 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
è
__wur
;

686 
__END_NAMESPACE_STD


688 #ifdeà
__USE_GNU


695 
	`åuts_uÆocked
 (
__cÚ¡
 *
__»¡riù
 
__s
,

696 
FILE
 *
__»¡riù
 
__¡»am
);

699 #ifdeà
__USE_MISC


706 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

707 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

708 
size_t
 
	$fwr™e_uÆocked
 (
__cÚ¡
 *
__»¡riù
 
__±r
, 
size_t
 
__size
,

709 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

713 
__BEGIN_NAMESPACE_STD


718 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

723 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

728 
	`»wšd
 (
FILE
 *
__¡»am
);

729 
__END_NAMESPACE_STD


736 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


737 #iâdeà
__USE_FILE_OFFSET64


742 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

747 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

749 #ifdeà
__REDIRECT


750 
	`__REDIRECT
 (
f£eko
,

751 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

752 
f£eko64
);

753 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

755 
	#f£eko
 
f£eko64


	)

756 
	#á–lo
 
á–lo64


	)

761 
__BEGIN_NAMESPACE_STD


762 #iâdeà
__USE_FILE_OFFSET64


767 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

772 
	`f£os
 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos_t
 *
__pos
);

774 #ifdeà
__REDIRECT


775 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

776 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

777 
	`__REDIRECT
 (
f£os
,

778 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos_t
 *
__pos
), 
f£os64
);

780 
	#fg‘pos
 
fg‘pos64


	)

781 
	#f£os
 
f£os64


	)

784 
__END_NAMESPACE_STD


786 #ifdeà
__USE_LARGEFILE64


787 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

788 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

789 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

790 
	`f£os64
 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos64_t
 *
__pos
);

793 
__BEGIN_NAMESPACE_STD


795 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

797 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

799 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

800 
__END_NAMESPACE_STD


802 #ifdeà
__USE_MISC


804 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

805 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

806 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

810 
__BEGIN_NAMESPACE_STD


815 
	`³¼Ü
 (
__cÚ¡
 *
__s
);

816 
__END_NAMESPACE_STD


822 
	~<b™s/sys_”¾i¡.h
>

825 #ifdef 
__USE_POSIX


827 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 #ifdeà
__USE_MISC


832 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

836 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

837 
defšed
 
__USE_MISC
)

842 
FILE
 *
	$pİ’
 (
__cÚ¡
 *
__commªd
, __cÚ¡ *
__modes
è
__wur
;

848 
	`pşo£
 (
FILE
 *
__¡»am
);

852 #ifdef 
__USE_POSIX


854 *
	$ù”mid
 (*
__s
è
__THROW
;

858 #ifdeà
__USE_XOPEN


860 *
	`cu£rid
 (*
__s
);

864 #ifdef 
__USE_GNU


865 
ob¡ack
;

868 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

869 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...)

870 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

871 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

872 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

873 
_G_va_li¡
 
__¬gs
)

874 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

878 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


882 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

886 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

889 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

892 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


896 
	#__Ãed_g‘İt


	)

897 
	~<g‘İt.h
>

902 #ifdeà
__USE_EXTERN_INLINES


903 
	~<b™s/¡dio.h
>

905 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


906 
	~<b™s/¡dio2.h
>

908 #ifdeà
__LDBL_COMPAT


909 
	~<b™s/¡dio-ldbl.h
>

912 
__END_DECLS


	@/usr/include/stdlib.h

23 #iâdef 
_STDLIB_H


25 
	~<ã©u»s.h
>

28 
	#__Ãed_size_t


	)

29 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


30 
	#__Ãed_wch¬_t


	)

31 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	g__BEGIN_DECLS


37 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


38 
	#_STDLIB_H
 1

	)

40 #ià
defšed
 
__USE_XOPEN
 && !defšed 
_SYS_WAIT_H


42 
	~<b™s/wa™æags.h
>

43 
	~<b™s/wa™¡©us.h
>

45 #ifdeà
__USE_BSD


50 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


51 
	#__WAIT_INT
(
¡©us
) \

52 (
	`__ex‹nsiÚ__
 ({ uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; } 
__u
; \

53 
__u
.
__š
 = (
¡©us
); __u.
__i
; }))

	)

55 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

63 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


64 
	#__WAIT_STATUS
 *

	)

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
wa™
 *
	m__u±r
;

71 *
	m__Œ
;

72 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

79 
	#__WAIT_STATUS
 *

	)

80 
	#__WAIT_STATUS_DEFN
 *

	)

85 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
(
	`__WAIT_INT
(¡©us))

	)

86 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
(
	`__WAIT_INT
(¡©us))

	)

87 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
(
	`__WAIT_INT
(¡©us))

	)

88 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
(
	`__WAIT_INT
(¡©us))

	)

89 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
(
	`__WAIT_INT
(¡©us))

	)

90 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
(
	`__WAIT_INT
(¡©us))

	)

91 #ifdeà
__WIFCONTINUED


92 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
(
	`__WAIT_INT
(¡©us))

	)

96 
__BEGIN_NAMESPACE_STD


100 
	mquÙ
;

101 
	m»m
;

102 } 
	tdiv_t
;

105 #iâdeà
__ldiv_t_defšed


108 
	mquÙ
;

109 
	m»m
;

110 } 
	tldiv_t
;

111 
	#__ldiv_t_defšed
 1

	)

113 
	g__END_NAMESPACE_STD


115 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


116 
__BEGIN_NAMESPACE_C99


118 
__ex‹nsiÚ__
 struct

120 
	mquÙ
;

121 
	m»m
;

122 } 
	tÎdiv_t
;

123 
	#__Îdiv_t_defšed
 1

	)

124 
	g__END_NAMESPACE_C99


129 
	#RAND_MAX
 2147483647

	)

134 
	#EXIT_FAILURE
 1

	)

135 
	#EXIT_SUCCESS
 0

	)

139 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

140 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

143 
__BEGIN_NAMESPACE_STD


145 
	$©of
 (
__cÚ¡
 *
__ÅŒ
)

146 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

148 
	$©oi
 (
__cÚ¡
 *
__ÅŒ
)

149 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

151 
	$©Ş
 (
__cÚ¡
 *
__ÅŒ
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

153 
__END_NAMESPACE_STD


155 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_MISC
)

156 
__BEGIN_NAMESPACE_C99


158 
__ex‹nsiÚ__
 
	$©Şl
 (
__cÚ¡
 *
__ÅŒ
)

159 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

160 
__END_NAMESPACE_C99


163 
__BEGIN_NAMESPACE_STD


165 
	$¡¹od
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

166 **
__»¡riù
 
__’d±r
)

167 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

168 
__END_NAMESPACE_STD


170 #ifdef 
__USE_ISOC99


171 
__BEGIN_NAMESPACE_C99


173 
	$¡¹of
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

174 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

176 
	$¡¹Şd
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

177 **
__»¡riù
 
__’d±r
)

178 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

179 
__END_NAMESPACE_C99


182 
__BEGIN_NAMESPACE_STD


184 
	$¡¹Ş
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

185 **
__»¡riù
 
__’d±r
, 
__ba£
)

186 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

188 
	$¡¹oul
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

189 **
__»¡riù
 
__’d±r
, 
__ba£
)

190 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

191 
__END_NAMESPACE_STD


193 #ià
defšed
 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_BSD


195 
__ex‹nsiÚ__


196 
	$¡¹oq
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

197 **
__»¡riù
 
__’d±r
, 
__ba£
)

198 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

200 
__ex‹nsiÚ__


201 
	$¡¹ouq
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

202 **
__»¡riù
 
__’d±r
, 
__ba£
)

203 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

206 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GLIBC_HAVE_LONG_LONG
 && defšed 
__USE_MISC
)

207 
__BEGIN_NAMESPACE_C99


209 
__ex‹nsiÚ__


210 
	$¡¹Şl
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

211 **
__»¡riù
 
__’d±r
, 
__ba£
)

212 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

214 
__ex‹nsiÚ__


215 
	$¡¹ouÎ
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

216 **
__»¡riù
 
__’d±r
, 
__ba£
)

217 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

218 
__END_NAMESPACE_C99


222 #ifdeà
__USE_GNU


236 
	~<xloÿË.h
>

240 
	$¡¹Ş_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

241 **
__»¡riù
 
__’d±r
, 
__ba£
,

242 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

244 
	$¡¹oul_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

245 **
__»¡riù
 
__’d±r
,

246 
__ba£
, 
__loÿË_t
 
__loc
)

247 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

249 
__ex‹nsiÚ__


250 
	$¡¹Şl_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

251 **
__»¡riù
 
__’d±r
, 
__ba£
,

252 
__loÿË_t
 
__loc
)

253 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

255 
__ex‹nsiÚ__


256 
	$¡¹ouÎ_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

257 **
__»¡riù
 
__’d±r
,

258 
__ba£
, 
__loÿË_t
 
__loc
)

259 
__THROW
 
	`__nÚnuÎ
 ((1, 4)è
__wur
;

261 
	$¡¹od_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

262 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

263 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

265 
	$¡¹of_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

266 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

267 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

269 
	$¡¹Şd_l
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

270 **
__»¡riù
 
__’d±r
,

271 
__loÿË_t
 
__loc
)

272 
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

276 #ifdeà
__USE_EXTERN_INLINES


277 
__BEGIN_NAMESPACE_STD


278 
__ex‹º_šlše
 

279 
	`__NTH
 (
	$©of
 (
__cÚ¡
 *
__ÅŒ
))

281  
	`¡¹od
 (
__ÅŒ
, (**è
NULL
);

282 
	}
}

283 
__ex‹º_šlše
 

284 
__NTH
 (
	$©oi
 (
__cÚ¡
 *
__ÅŒ
))

286  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

287 
	}
}

288 
__ex‹º_šlše
 

289 
__NTH
 (
	$©Ş
 (
__cÚ¡
 *
__ÅŒ
))

291  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

292 
	}
}

293 
	g__END_NAMESPACE_STD


295 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


296 
__BEGIN_NAMESPACE_C99


297 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

298 
__NTH
 (
	$©Şl
 (
__cÚ¡
 *
__ÅŒ
))

300  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

301 
	}
}

302 
	g__END_NAMESPACE_C99


307 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


311 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

314 
	$a64l
 (
__cÚ¡
 *
__s
)

315 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


320 
	~<sys/ty³s.h
>

327 
	$¿ndom
 (è
__THROW
;

330 
	$¤ªdom
 (
__£ed
è
__THROW
;

336 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

337 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

341 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

344 #ifdeà
__USE_MISC


349 
	s¿ndom_d©a


351 
št32_t
 *
åŒ
;

352 
št32_t
 *
½Œ
;

353 
št32_t
 *
¡©e
;

354 
¿nd_ty³
;

355 
¿nd_deg
;

356 
¿nd_£p
;

357 
št32_t
 *
’d_±r
;

360 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

361 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

363 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

364 
__THROW
 
	`__nÚnuÎ
 ((2));

366 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

367 
size_t
 
__¡©–’
,

368 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

369 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

371 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

372 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

373 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

378 
__BEGIN_NAMESPACE_STD


380 
	$¿nd
 (è
__THROW
;

382 
	$¤ªd
 (
__£ed
è
__THROW
;

383 
__END_NAMESPACE_STD


385 #ifdeà
__USE_POSIX


387 
	$¿nd_r
 (*
__£ed
è
__THROW
;

391 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


395 
	$d¿nd48
 (è
__THROW
;

396 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

399 
	$Ìªd48
 (è
__THROW
;

400 
	$Äªd48
 (
__xsubi
[3])

401 
__THROW
 
	`__nÚnuÎ
 ((1));

404 
	$m¿nd48
 (è
__THROW
;

405 
	$j¿nd48
 (
__xsubi
[3])

406 
__THROW
 
	`__nÚnuÎ
 ((1));

409 
	$¤ªd48
 (
__£edv®
è
__THROW
;

410 *
	$£ed48
 (
__£ed16v
[3])

411 
__THROW
 
	`__nÚnuÎ
 ((1));

412 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

414 #ifdeà
__USE_MISC


418 
	sd¿nd48_d©a


420 
__x
[3];

421 
__Şd_x
[3];

422 
__c
;

423 
__š™
;

424 
__a
;

428 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

429 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$”ªd48_r
 (
__xsubi
[3],

431 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

432 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

435 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

436 *
__»¡riù
 
__»suÉ
)

437 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

438 
	$Äªd48_r
 (
__xsubi
[3],

439 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

444 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

445 *
__»¡riù
 
__»suÉ
)

446 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

447 
	$j¿nd48_r
 (
__xsubi
[3],

448 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

449 *
__»¡riù
 
__»suÉ
)

450 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

453 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

454 
__THROW
 
	`__nÚnuÎ
 ((2));

456 
	$£ed48_r
 (
__£ed16v
[3],

457 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$lcÚg48_r
 (
__·¿m
[7],

460 
d¿nd48_d©a
 *
__bufãr
)

461 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

467 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


468 
	#__m®loc_ªd_ÿÎoc_defšed


	)

469 
__BEGIN_NAMESPACE_STD


471 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

473 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

474 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

475 
__END_NAMESPACE_STD


478 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


479 
__BEGIN_NAMESPACE_STD


485 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

486 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

488 
	$ä“
 (*
__±r
è
__THROW
;

489 
__END_NAMESPACE_STD


491 #ifdef 
__USE_MISC


493 
	$cä“
 (*
__±r
è
__THROW
;

496 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


497 
	~<®loÿ.h
>

500 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


502 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

505 #ifdeà
__USE_XOPEN2K


507 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

508 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

511 
__BEGIN_NAMESPACE_STD


513 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

517 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

518 
__END_NAMESPACE_STD


520 #ifdef 
__USE_MISC


523 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

524 
__THROW
 
	`__nÚnuÎ
 ((1));

527 
__BEGIN_NAMESPACE_STD


531 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

532 
__END_NAMESPACE_STD


534 #ifdeà
__USE_ISOC99


535 
__BEGIN_NAMESPACE_C99


538 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

539 
__END_NAMESPACE_C99


543 
__BEGIN_NAMESPACE_STD


545 *
	$g‘’v
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

546 
__END_NAMESPACE_STD


550 *
	$__£cu»_g‘’v
 (
__cÚ¡
 *
__Çme
)

551 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

553 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


557 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

560 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


563 
	$£‹nv
 (
__cÚ¡
 *
__Çme
, __cÚ¡ *
__v®ue
, 
__»¶aû
)

564 
__THROW
 
	`__nÚnuÎ
 ((2));

567 
	$un£‹nv
 (
__cÚ¡
 *
__Çme
è
__THROW
;

570 #ifdef 
__USE_MISC


574 
	$ş—»nv
 (è
__THROW
;

578 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


583 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

593 #iâdeà
__USE_FILE_OFFSET64


594 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

596 #ifdeà
__REDIRECT


597 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

598 
	`__nÚnuÎ
 ((1)è
__wur
;

600 
	#mk¡emp
 
mk¡emp64


	)

603 #ifdeà
__USE_LARGEFILE64


604 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

608 #ifdeà
__USE_BSD


614 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

617 #ifdeà
__USE_GNU


624 #iâdeà
__USE_FILE_OFFSET64


625 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

627 #ifdeà
__REDIRECT


628 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

629 
	`__nÚnuÎ
 ((1)è
__wur
;

631 
	#mko¡emp
 
mko¡emp64


	)

634 #ifdeà
__USE_LARGEFILE64


635 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

640 
__BEGIN_NAMESPACE_STD


645 
	$sy¡em
 (
__cÚ¡
 *
__commªd
è
__wur
;

646 
__END_NAMESPACE_STD


649 #ifdef 
__USE_GNU


652 *
	$ÿnÚiÿlize_fe_Çme
 (
__cÚ¡
 *
__Çme
)

653 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

656 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


662 *
	$»®·th
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

663 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

668 #iâdeà
__COMPAR_FN_T


669 
	#__COMPAR_FN_T


	)

670 (*
	t__com·r_â_t
è(
	t__cÚ¡
 *, __const *);

672 #ifdef 
__USE_GNU


673 
__com·r_â_t
 
	tcom·risÚ_â_t
;

677 
__BEGIN_NAMESPACE_STD


680 *
	$b£¬ch
 (
__cÚ¡
 *
__key
, __cÚ¡ *
__ba£
,

681 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

682 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

686 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

687 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

691 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

692 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

693 
__END_NAMESPACE_STD


695 #ifdeà
__USE_ISOC99


696 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

697 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

701 
__BEGIN_NAMESPACE_STD


705 
div_t
 
	$div
 (
__num”
, 
__d’om
)

706 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

707 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

708 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

709 
__END_NAMESPACE_STD


711 #ifdeà
__USE_ISOC99


712 
__BEGIN_NAMESPACE_C99


713 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

714 
__d’om
)

715 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

716 
__END_NAMESPACE_C99


720 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


727 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

728 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

733 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

734 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

739 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

740 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

743 #ifdeà
__USE_MISC


745 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

746 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

747 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

748 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

749 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

750 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

751 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

752 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

757 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

758 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

759 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

760 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

761 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

762 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

764 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

765 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

766 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

767 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

768 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

769 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

770 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

771 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

776 
__BEGIN_NAMESPACE_STD


779 
	$mbËn
 (
__cÚ¡
 *
__s
, 
size_t
 
__n
è
__THROW
 
__wur
;

782 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

783 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
 
__wur
;

786 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
 
__wur
;

790 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

791 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

793 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

794 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

795 
__THROW
;

796 
__END_NAMESPACE_STD


799 #ifdeà
__USE_SVID


804 
	$½m©ch
 (
__cÚ¡
 *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

808 #ifdeà
__USE_XOPEN_EXTENDED


815 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

816 *
__cÚ¡
 *
__»¡riù
 
__tok’s
,

817 **
__»¡riù
 
__v®u•
)

818 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

822 #ifdeà
__USE_XOPEN


824 
	$£tkey
 (
__cÚ¡
 *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

830 #ifdeà
__USE_XOPEN2K


832 
	$posix_İ’±
 (
__oæag
è
__wur
;

835 #ifdeà
__USE_XOPEN


840 
	$g¿Á±
 (
__fd
è
__THROW
;

844 
	$uÆock±
 (
__fd
è
__THROW
;

849 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

852 #ifdeà
__USE_GNU


856 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

857 
__THROW
 
	`__nÚnuÎ
 ((2));

860 
	`g‘±
 ();

863 #ifdeà
__USE_BSD


867 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

868 
__THROW
 
	`__nÚnuÎ
 ((1));

873 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


874 
	~<b™s/¡dlib.h
>

876 #ifdeà
__LDBL_COMPAT


877 
	~<b™s/¡dlib-ldbl.h
>

881 #undeà
__Ãed_m®loc_ªd_ÿÎoc


883 
__END_DECLS


	@/usr/include/string.h

23 #iâdef 
_STRING_H


24 
	#_STRING_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

36 
__BEGIN_NAMESPACE_STD


38 *
	$memıy
 (*
__»¡riù
 
__de¡
,

39 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

40 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

43 *
	$memmove
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
)

44 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

45 
__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


51 *
	$memcıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

52 
__c
, 
size_t
 
__n
)

53 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

57 
__BEGIN_NAMESPACE_STD


59 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

62 
	$memcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

63 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

66 *
	$memchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

67 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

68 
__END_NAMESPACE_STD


70 #ifdeà
__USE_GNU


73 *
	$¿wmemchr
 (
__cÚ¡
 *
__s
, 
__c
)

74 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

77 *
	$memrchr
 (
__cÚ¡
 *
__s
, 
__c
, 
size_t
 
__n
)

78 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

82 
__BEGIN_NAMESPACE_STD


84 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

85 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

87 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

88 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

89 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

92 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

93 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

95 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

96 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

99 
	$¡rcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

100 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

102 
	$¡ºcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

103 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

106 
	$¡rcŞl
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

107 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

109 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

110 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

111 
__THROW
 
	`__nÚnuÎ
 ((2));

112 
__END_NAMESPACE_STD


114 #ifdeà
__USE_GNU


118 
	~<xloÿË.h
>

121 
	$¡rcŞl_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

122 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

124 
size_t
 
	$¡rxäm_l
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

125 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

128 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


130 *
	$¡rdup
 (
__cÚ¡
 *
__s
)

131 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

137 #ià
defšed
 
__USE_GNU


138 *
	$¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

139 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

142 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


144 
	#¡rdu·
(
s
) \

145 (
__ex‹nsiÚ__
 \

147 
__cÚ¡
 *
__Şd
 = (
s
); \

148 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

149 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

150 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

151 
	}
}))

	)

154 
	#¡ºdu·
(
s
, 
n
) \

155 (
__ex‹nsiÚ__
 \

157 
__cÚ¡
 *
__Şd
 = (
s
); \

158 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

159 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

160 
__Ãw
[
__Ën
] = '\0'; \

161 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

162 }))

	)

165 
__BEGIN_NAMESPACE_STD


167 *
	$¡rchr
 (
__cÚ¡
 *
__s
, 
__c
)

168 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

170 *
	$¡¼chr
 (
__cÚ¡
 *
__s
, 
__c
)

171 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

172 
__END_NAMESPACE_STD


174 #ifdeà
__USE_GNU


177 *
	$¡rchºul
 (
__cÚ¡
 *
__s
, 
__c
)

178 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

181 
__BEGIN_NAMESPACE_STD


184 
size_t
 
	$¡rc¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__»jeù
)

185 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

188 
size_t
 
	$¡r¥n
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

189 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

191 *
	$¡½brk
 (
__cÚ¡
 *
__s
, __cÚ¡ *
__acû±
)

192 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

194 *
	$¡r¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

195 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

199 *
	$¡¹ok
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
)

200 
__THROW
 
	`__nÚnuÎ
 ((2));

201 
__END_NAMESPACE_STD


205 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

206 
__cÚ¡
 *
__»¡riù
 
__d–im
,

207 **
__»¡riù
 
__§ve_±r
)

208 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

209 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


210 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__d–im
,

211 **
__»¡riù
 
__§ve_±r
)

212 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

215 #ifdeà
__USE_GNU


217 *
	$¡rÿ£¡r
 (
__cÚ¡
 *
__hay¡ack
, __cÚ¡ *
__ÃedË
)

218 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

221 #ifdeà
__USE_GNU


225 *
	$memmem
 (
__cÚ¡
 *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

226 
__cÚ¡
 *
__ÃedË
, 
size_t
 
__ÃedËËn
)

227 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

231 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

232 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

233 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

234 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

235 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

236 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

240 
__BEGIN_NAMESPACE_STD


242 
size_t
 
	$¡¾’
 (
__cÚ¡
 *
__s
)

243 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

244 
__END_NAMESPACE_STD


246 #ifdef 
__USE_GNU


249 
size_t
 
	$¡ºËn
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__maxËn
)

250 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

254 
__BEGIN_NAMESPACE_STD


256 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

257 
__END_NAMESPACE_STD


258 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


266 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


269 #ifdeà
__REDIRECT_NTH


270 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

271 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

272 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

274 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

275 
__THROW
 
	`__nÚnuÎ
 ((2));

276 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

281 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

282 
__THROW
 
	`__nÚnuÎ
 ((2));

286 #ifdeà
__USE_GNU


288 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

294 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

296 #ifdeà
__USE_BSD


298 
	$bcİy
 (
__cÚ¡
 *
__¤c
, *
__de¡
, 
size_t
 
__n
)

299 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

302 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$bcmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

306 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

309 *
	$šdex
 (
__cÚ¡
 *
__s
, 
__c
)

310 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

313 *
	$ršdex
 (
__cÚ¡
 *
__s
, 
__c
)

314 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

318 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

322 #ifdef 
__USE_GNU


323 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

324 #ifdeà
__GNUC__


325 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

326 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

331 
	$¡rÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

332 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

335 
	$¡ºÿ£cmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
, 
size_t
 
__n
)

336 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

339 #ifdef 
__USE_GNU


342 
	$¡rÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

343 
__loÿË_t
 
__loc
)

344 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

346 
	$¡ºÿ£cmp_l
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
,

347 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

348 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

351 #ifdef 
__USE_BSD


354 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

355 
__cÚ¡
 *
__»¡riù
 
__d–im
)

356 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

359 #ifdef 
__USE_GNU


361 
	$¡rv”scmp
 (
__cÚ¡
 *
__s1
, __cÚ¡ *
__s2
)

362 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

365 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

368 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

369 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

370 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
)

371 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

375 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

376 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

377 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

378 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

379 
__cÚ¡
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

380 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

383 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

386 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

388 #iâdeà
ba£Çme


393 *
	$ba£Çme
 (
__cÚ¡
 *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

398 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

399 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

400 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


420 
	~<b™s/¡ršg.h
>

423 
	~<b™s/¡ršg2.h
>

426 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


428 
	~<b™s/¡ršg3.h
>

432 
__END_DECLS


	@/usr/include/sys/errno.h

1 
	~<”ºo.h
>

	@/usr/include/sys/resource.h

19 #iâdef 
_SYS_RESOURCE_H


20 
	#_SYS_RESOURCE_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/»sourû.h
>

27 #iâdeà
__id_t_defšed


28 
__id_t
 
	tid_t
;

29 
	#__id_t_defšed


	)

32 
	g__BEGIN_DECLS


38 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


39 
__¾im™_»sourû
 
	t__¾im™_»sourû_t
;

40 
__ru§ge_who
 
	t__ru§ge_who_t
;

41 
__´iÜ™y_which
 
	t__´iÜ™y_which_t
;

43 
	t__¾im™_»sourû_t
;

44 
	t__ru§ge_who_t
;

45 
	t__´iÜ™y_which_t
;

50 #iâdeà
__USE_FILE_OFFSET64


51 
	$g‘¾im™
 (
__¾im™_»sourû_t
 
__»sourû
,

52 
¾im™
 *
__¾im™s
è
__THROW
;

54 #ifdeà
__REDIRECT_NTH


55 
	`__REDIRECT_NTH
 (
g‘¾im™
, (
__¾im™_»sourû_t
 
__»sourû
,

56 
¾im™
 *
__¾im™s
), 
g‘¾im™64
);

58 
	#g‘¾im™
 
g‘¾im™64


	)

61 #ifdeà
__USE_LARGEFILE64


62 
	$g‘¾im™64
 (
__¾im™_»sourû_t
 
__»sourû
,

63 
¾im™64
 *
__¾im™s
è
__THROW
;

69 #iâdeà
__USE_FILE_OFFSET64


70 
	$£Œlim™
 (
__¾im™_»sourû_t
 
__»sourû
,

71 
__cÚ¡
 
¾im™
 *
__¾im™s
è
__THROW
;

73 #ifdeà
__REDIRECT_NTH


74 
	`__REDIRECT_NTH
 (
£Œlim™
, (
__¾im™_»sourû_t
 
__»sourû
,

75 
__cÚ¡
 
¾im™
 *
__¾im™s
),

76 
£Œlim™64
);

78 
	#£Œlim™
 
£Œlim™64


	)

81 #ifdeà
__USE_LARGEFILE64


82 
	$£Œlim™64
 (
__¾im™_»sourû_t
 
__»sourû
,

83 
__cÚ¡
 
¾im™64
 *
__¾im™s
è
__THROW
;

88 
	$g‘ru§ge
 (
__ru§ge_who_t
 
__who
, 
ru§ge
 *
__u§ge
è
__THROW
;

94 
	$g‘´iÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
è
__THROW
;

98 
	$£riÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
, 
__´io
)

99 
__THROW
;

101 
__END_DECLS


	@/usr/include/sys/select.h

22 #iâdeà
_SYS_SELECT_H


23 
	#_SYS_SELECT_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

31 
	~<b™s/£Ëù.h
>

34 
	~<b™s/sig£t.h
>

36 #iâdeà
__sig£t_t_defšed


37 
	#__sig£t_t_defšed


	)

38 
__sig£t_t
 
	tsig£t_t
;

42 
	#__Ãed_time_t


	)

43 
	#__Ãed_time¥ec


	)

44 
	~<time.h
>

45 
	#__Ãed_timev®


	)

46 
	~<b™s/time.h
>

48 #iâdeà
__su£cÚds_t_defšed


49 
__su£cÚds_t
 
	tsu£cÚds_t
;

50 
	#__su£cÚds_t_defšed


	)

55 
	t__fd_mask
;

58 #undeà
__NFDBITS


59 #undeà
__FDELT


60 #undeà
__FDMASK


62 
	#__NFDBITS
 (8 *  (
__fd_mask
))

	)

63 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

64 
	#__FDMASK
(
d
è((
__fd_mask
è1 << ((dè% 
__NFDBITS
))

	)

71 #ifdeà
__USE_XOPEN


72 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

75 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

76 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

78 } 
	tfd_£t
;

81 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

83 #ifdeà
__USE_MISC


85 
__fd_mask
 
	tfd_mask
;

88 
	#NFDBITS
 
__NFDBITS


	)

93 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

94 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

95 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

96 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

99 
__BEGIN_DECLS


109 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

110 
fd_£t
 *
__»¡riù
 
__wr™efds
,

111 
fd_£t
 *
__»¡riù
 
__exû±fds
,

112 
timev®
 *
__»¡riù
 
__timeout
);

114 #ifdeà
__USE_XOPEN2K


121 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

122 
fd_£t
 *
__»¡riù
 
__wr™efds
,

123 
fd_£t
 *
__»¡riù
 
__exû±fds
,

124 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

125 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

128 
	g__END_DECLS


	@/usr/include/sys/socket.h

21 #iâdef 
_SYS_SOCKET_H


22 
	#_SYS_SOCKET_H
 1

	)

24 
	~<ã©u»s.h
>

26 
	g__BEGIN_DECLS


28 
	~<sys/uio.h
>

29 
	#__Ãed_size_t


	)

30 
	~<¡ddef.h
>

36 
	~<b™s/sock‘.h
>

38 #ifdeà
__USE_BSD


41 
	sosockaddr


43 
	m§_çmy
;

44 
	m§_d©a
[14];

52 
	mSHUT_RD
 = 0,

53 
	#SHUT_RD
 
SHUT_RD


	)

54 
	mSHUT_WR
,

55 
	#SHUT_WR
 
SHUT_WR


	)

56 
	mSHUT_RDWR


57 
	#SHUT_RDWR
 
SHUT_RDWR


	)

66 #ià
defšed
 
__ılu¥lus
 || !
__GNUC_PREREQ
 (2, 7è|| !defšed 
__USE_GNU


67 
	#__SOCKADDR_ARG
 
sockaddr
 *
__»¡riù


	)

68 
	#__CONST_SOCKADDR_ARG
 
__cÚ¡
 
sockaddr
 *

	)

72 
	#__SOCKADDR_ALLTYPES
 \

73 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

74 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

75 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

76 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

77 
	`__SOCKADDR_ONETYPE
 (
sockaddr_eÚ
) \

78 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š
) \

79 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š6
) \

80 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š¬p
) \

81 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x
) \

82 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

83 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

84 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

85 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

87 
	#__SOCKADDR_ONETYPE
(
ty³
èty³ *
__»¡riù
 
__
##ty³##__;

	)

88 uniÚ { 
	m__SOCKADDR_ALLTYPES


89 } 
	t__SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

90 #undeà
__SOCKADDR_ONETYPE


91 
	#__SOCKADDR_ONETYPE
(
ty³
è
__cÚ¡
 ty³ *
__»¡riù
 
__
##ty³##__;

	)

92 uniÚ { 
	m__SOCKADDR_ALLTYPES


93 } 
	t__CONST_SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

94 #undeà
__SOCKADDR_ONETYPE


101 
	$sock‘
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
è
__THROW
;

107 
	$sock‘·œ
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
,

108 
__fds
[2]è
__THROW
;

111 
	$bšd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
)

112 
__THROW
;

115 
	$g‘sockÇme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

116 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

125 
	`cÚÃù
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
);

129 
	$g‘³”Çme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

130 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

137 
ssize_t
 
	`£nd
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
, 
__æags
);

144 
ssize_t
 
	`»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
);

151 
ssize_t
 
	`£ndto
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

152 
__æags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

153 
sockËn_t
 
__addr_Ën
);

162 
ssize_t
 
	`»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

163 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

164 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

172 
ssize_t
 
	`£ndmsg
 (
__fd
, 
__cÚ¡
 
msghdr
 *
__mes§ge
,

173 
__æags
);

180 
ssize_t
 
	`»cvmsg
 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
);

186 
	$g‘sockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

187 *
__»¡riù
 
__İtv®
,

188 
sockËn_t
 *
__»¡riù
 
__İ’
è
__THROW
;

193 
	$£tsockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

194 
__cÚ¡
 *
__İtv®
, 
sockËn_t
 
__İ’
è
__THROW
;

200 
	$li¡’
 (
__fd
, 
__n
è
__THROW
;

210 
	`acû±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

211 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

219 
	$shutdown
 (
__fd
, 
__how
è
__THROW
;

222 #ifdeà
__USE_XOPEN2K


224 
	$sock©m¬k
 (
__fd
è
__THROW
;

228 #ifdeà
__USE_MISC


232 
	$isfdty³
 (
__fd
, 
__fdty³
è
__THROW
;

237 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


238 
	~<b™s/sock‘2.h
>

241 
__END_DECLS


	@/usr/include/sys/stat.h

24 #iâdef 
_SYS_STAT_H


25 
	#_SYS_STAT_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	~<b™s/ty³s.h
>

31 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K
 || defšed 
__USE_MISC
 \

32 || 
defšed
 
	g__USE_ATFILE


33 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_time_t


	)

36 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ATFILE


37 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


45 #iâdeà
__dev_t_defšed


46 
__dev_t
 
	tdev_t
;

47 
	#__dev_t_defšed


	)

50 #iâdeà
__gid_t_defšed


51 
__gid_t
 
	tgid_t
;

52 
	#__gid_t_defšed


	)

55 #iâdeà
__šo_t_defšed


56 #iâdeà
__USE_FILE_OFFSET64


57 
__šo_t
 
	tšo_t
;

59 
__šo64_t
 
	tšo_t
;

61 
	#__šo_t_defšed


	)

64 #iâdeà
__mode_t_defšed


65 
__mode_t
 
	tmode_t
;

66 
	#__mode_t_defšed


	)

69 #iâdeà
__Æšk_t_defšed


70 
__Æšk_t
 
	tÆšk_t
;

71 
	#__Æšk_t_defšed


	)

74 #iâdeà
__off_t_defšed


75 #iâdeà
__USE_FILE_OFFSET64


76 
__off_t
 
	toff_t
;

78 
__off64_t
 
	toff_t
;

80 
	#__off_t_defšed


	)

83 #iâdeà
__uid_t_defšed


84 
__uid_t
 
	tuid_t
;

85 
	#__uid_t_defšed


	)

89 #ifdeà
__USE_UNIX98


90 #iâdeà
__blkút_t_defšed


91 #iâdeà
__USE_FILE_OFFSET64


92 
__blkút_t
 
	tblkút_t
;

94 
__blkút64_t
 
	tblkút_t
;

96 
	#__blkút_t_defšed


	)

99 #iâdeà
__blksize_t_defšed


100 
__blksize_t
 
	tblksize_t
;

101 
	#__blksize_t_defšed


	)

105 
	g__BEGIN_DECLS


107 
	~<b™s/¡©.h
>

109 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


110 
	#S_IFMT
 
__S_IFMT


	)

111 
	#S_IFDIR
 
__S_IFDIR


	)

112 
	#S_IFCHR
 
__S_IFCHR


	)

113 
	#S_IFBLK
 
__S_IFBLK


	)

114 
	#S_IFREG
 
__S_IFREG


	)

115 #ifdeà
__S_IFIFO


116 
	#S_IFIFO
 
__S_IFIFO


	)

118 #ifdeà
__S_IFLNK


119 
	#S_IFLNK
 
__S_IFLNK


	)

121 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_UNIX98
) \

122 && 
defšed
 
	g__S_IFSOCK


123 
	#S_IFSOCK
 
__S_IFSOCK


	)

129 
	#__S_ISTYPE
(
mode
, 
mask
è(((modeè& 
__S_IFMT
è=ğ(mask))

	)

131 
	#S_ISDIR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

132 
	#S_ISCHR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

133 
	#S_ISBLK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

134 
	#S_ISREG
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

135 #ifdeà
__S_IFIFO


136 
	#S_ISFIFO
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

138 #ifdeà
__S_IFLNK


139 
	#S_ISLNK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

142 #ià
defšed
 
__USE_BSD
 && !defšed 
__S_IFLNK


143 
	#S_ISLNK
(
mode
è0

	)

146 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
) \

147 && 
defšed
 
	g__S_IFSOCK


148 
	#S_ISSOCK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

155 #ifdef 
__USE_POSIX199309


156 
	#S_TYPEISMQ
(
buf
è
	`__S_TYPEISMQ
(buf)

	)

157 
	#S_TYPEISSEM
(
buf
è
	`__S_TYPEISSEM
(buf)

	)

158 
	#S_TYPEISSHM
(
buf
è
	`__S_TYPEISSHM
(buf)

	)

164 
	#S_ISUID
 
__S_ISUID


	)

165 
	#S_ISGID
 
__S_ISGID


	)

167 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


169 
	#S_ISVTX
 
__S_ISVTX


	)

172 
	#S_IRUSR
 
__S_IREAD


	)

173 
	#S_IWUSR
 
__S_IWRITE


	)

174 
	#S_IXUSR
 
__S_IEXEC


	)

176 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

178 #ià
defšed
 
__USE_MISC
 && defšed 
__USE_BSD


179 
	#S_IREAD
 
S_IRUSR


	)

180 
	#S_IWRITE
 
S_IWUSR


	)

181 
	#S_IEXEC
 
S_IXUSR


	)

184 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

185 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

186 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

188 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

190 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

191 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

192 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

194 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

197 #ifdef 
__USE_BSD


199 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
è

	)

200 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

201 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

203 
	#S_BLKSIZE
 512

	)

207 #iâdeà
__USE_FILE_OFFSET64


209 
	$¡©
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

210 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

214 
	$f¡©
 (
__fd
, 
¡©
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

216 #ifdeà
__REDIRECT_NTH


217 
	`__REDIRECT_NTH
 (
¡©
, (
__cÚ¡
 *
__»¡riù
 
__fe
,

218 
¡©
 *
__»¡riù
 
__buf
), 
¡©64
)

219 
	`__nÚnuÎ
 ((1, 2));

220 
	`__REDIRECT_NTH
 (
f¡©
, (
__fd
, 
¡©
 *
__buf
), 
f¡©64
)

221 
	`__nÚnuÎ
 ((2));

223 
	#¡©
 
¡©64


	)

224 
	#f¡©
 
f¡©64


	)

227 #ifdeà
__USE_LARGEFILE64


228 
	$¡©64
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

229 
¡©64
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

230 
	$f¡©64
 (
__fd
, 
¡©64
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

233 #ifdeà
__USE_ATFILE


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$f¡©©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

239 
¡©
 *
__»¡riù
 
__buf
, 
__æag
)

240 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

242 #ifdeà
__REDIRECT_NTH


243 
	`__REDIRECT_NTH
 (
f¡©©
, (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

244 
¡©
 *
__»¡riù
 
__buf
,

245 
__æag
),

246 
f¡©©64
è
	`__nÚnuÎ
 ((2, 3));

248 
	#f¡©©
 
f¡©©64


	)

252 
	$f¡©©64
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

253 
¡©64
 *
__»¡riù
 
__buf
, 
__æag
)

254 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

257 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


258 #iâdeà
__USE_FILE_OFFSET64


261 
	$l¡©
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

262 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

264 #ifdeà
__REDIRECT_NTH


265 
	`__REDIRECT_NTH
 (
l¡©
,

266 (
__cÚ¡
 *
__»¡riù
 
__fe
,

267 
¡©
 *
__»¡riù
 
__buf
), 
l¡©64
)

268 
	`__nÚnuÎ
 ((1, 2));

270 
	#l¡©
 
l¡©64


	)

273 #ifdeà
__USE_LARGEFILE64


274 
	$l¡©64
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

275 
¡©64
 *
__»¡riù
 
__buf
)

276 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

282 
	$chmod
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
)

283 
__THROW
 
	`__nÚnuÎ
 ((1));

285 #ifdeà
__USE_BSD


289 
	$lchmod
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
)

290 
__THROW
 
	`__nÚnuÎ
 ((1));

294 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


295 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
è
__THROW
;

298 #ifdeà
__USE_ATFILE


301 
	$fchmod©
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__mode_t
 
mode
, 
__æag
)

302 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

309 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
è
__THROW
;

311 #ifdef 
__USE_GNU


314 
__mode_t
 
	$g‘umask
 (è
__THROW
;

318 
	$mkdœ
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

319 
__THROW
 
	`__nÚnuÎ
 ((1));

321 #ifdeà
__USE_ATFILE


325 
	$mkdœ©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

326 
__THROW
 
	`__nÚnuÎ
 ((2));

332 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


333 
	$mknod
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

334 
__THROW
 
	`__nÚnuÎ
 ((1));

337 #ifdeà
__USE_ATFILE


341 
	$mknod©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

342 
__dev_t
 
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2));

347 
	$mkfifo
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

348 
__THROW
 
	`__nÚnuÎ
 ((1));

350 #ifdeà
__USE_ATFILE


354 
	$mkfifßt
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

355 
__THROW
 
	`__nÚnuÎ
 ((2));

358 #ifdeà
__USE_ATFILE


361 
	$utim’§t
 (
__fd
, 
__cÚ¡
 *
__·th
,

362 
__cÚ¡
 
time¥ec
 
__times
[2],

363 
__æags
)

364 
__THROW
 
	`__nÚnuÎ
 ((2));

367 #ifdeà
__USE_GNU


370 
	$futim’s
 (
__fd
, 
__cÚ¡
 
time¥ec
 
__times
[2]è
__THROW
;

388 #iâdeà
_STAT_VER


389 
	#_STAT_VER
 0

	)

391 #iâdeà
_MKNOD_VER


392 
	#_MKNOD_VER
 0

	)

396 #iâdeà
__USE_FILE_OFFSET64


397 
	$__fx¡©
 (
__v”
, 
__fdes
, 
¡©
 *
__¡©_buf
)

398 
__THROW
 
	`__nÚnuÎ
 ((3));

399 
	$__x¡©
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

400 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

401 
	$__lx¡©
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

402 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

403 
	$__fx¡©©
 (
__v”
, 
__fdes
, 
__cÚ¡
 *
__f’ame
,

404 
¡©
 *
__¡©_buf
, 
__æag
)

405 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

407 #ifdeà
__REDIRECT_NTH


408 
	`__REDIRECT_NTH
 (
__fx¡©
, (
__v”
, 
__fdes
,

409 
¡©
 *
__¡©_buf
), 
__fx¡©64
)

410 
	`__nÚnuÎ
 ((3));

411 
	`__REDIRECT_NTH
 (
__x¡©
, (
__v”
, 
__cÚ¡
 *
__f’ame
,

412 
¡©
 *
__¡©_buf
), 
__x¡©64
)

413 
	`__nÚnuÎ
 ((2, 3));

414 
	`__REDIRECT_NTH
 (
__lx¡©
, (
__v”
, 
__cÚ¡
 *
__f’ame
,

415 
¡©
 *
__¡©_buf
), 
__lx¡©64
)

416 
	`__nÚnuÎ
 ((2, 3));

417 
	`__REDIRECT_NTH
 (
__fx¡©©
, (
__v”
, 
__fdes
,

418 
__cÚ¡
 *
__f’ame
,

419 
¡©
 *
__¡©_buf
, 
__æag
),

420 
__fx¡©©64
è
	`__nÚnuÎ
 ((3, 4));

423 
	#__fx¡©
 
__fx¡©64


	)

424 
	#__x¡©
 
__x¡©64


	)

425 
	#__lx¡©
 
__lx¡©64


	)

429 #ifdeà
__USE_LARGEFILE64


430 
	$__fx¡©64
 (
__v”
, 
__fdes
, 
¡©64
 *
__¡©_buf
)

431 
__THROW
 
	`__nÚnuÎ
 ((3));

432 
	$__x¡©64
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

433 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

434 
	$__lx¡©64
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

435 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

436 
	$__fx¡©©64
 (
__v”
, 
__fdes
, 
__cÚ¡
 *
__f’ame
,

437 
¡©64
 *
__¡©_buf
, 
__æag
)

438 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

440 
	$__xmknod
 (
__v”
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

441 
__dev_t
 *
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

443 
	$__xmknod©
 (
__v”
, 
__fd
, 
__cÚ¡
 *
__·th
,

444 
__mode_t
 
__mode
, 
__dev_t
 *
__dev
)

445 
__THROW
 
	`__nÚnuÎ
 ((3, 5));

447 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES


450 
__ex‹º_šlše
 

451 
	`__NTH
 (
	$¡©
 (
__cÚ¡
 *
__·th
, 
¡©
 *
__¡©buf
))

453  
	`__x¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

454 
	}
}

456 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


457 
__ex‹º_šlše
 

458 
__NTH
 (
	$l¡©
 (
__cÚ¡
 *
__·th
, 
¡©
 *
__¡©buf
))

460  
	`__lx¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

461 
	}
}

464 
__ex‹º_šlše
 

465 
__NTH
 (
	$f¡©
 (
__fd
, 
¡©
 *
__¡©buf
))

467  
	`__fx¡©
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

468 
	}
}

470 #ifdeà
__USE_ATFILE


471 
__ex‹º_šlše
 

472 
__NTH
 (
	$f¡©©
 (
__fd
, 
__cÚ¡
 *
__f’ame
, 
¡©
 *
__¡©buf
,

473 
__æag
))

475  
	`__fx¡©©
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

476 
	}
}

479 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_BSD


480 
__ex‹º_šlše
 

481 
__NTH
 (
	$mknod
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
))

483  
	`__xmknod
 (
_MKNOD_VER
, 
__·th
, 
__mode
, &
__dev
);

484 
	}
}

487 #ifdeà
__USE_ATFILE


488 
__ex‹º_šlše
 

489 
__NTH
 (
	$mknod©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

490 
__dev_t
 
__dev
))

492  
	`__xmknod©
 (
_MKNOD_VER
, 
__fd
, 
__·th
, 
__mode
, &
__dev
);

493 
	}
}

496 #ià
defšed
 
__USE_LARGEFILE64
 \

497 && (! 
defšed
 
	g__USE_FILE_OFFSET64
 \

498 || (
defšed
 
	g__REDIRECT_NTH
 && defšed 
	g__OPTIMIZE__
))

499 
__ex‹º_šlše
 

500 
__NTH
 (
	$¡©64
 (
__cÚ¡
 *
__·th
, 
¡©64
 *
__¡©buf
))

502  
	`__x¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

503 
	}
}

505 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


506 
__ex‹º_šlše
 

507 
__NTH
 (
	$l¡©64
 (
__cÚ¡
 *
__·th
, 
¡©64
 *
__¡©buf
))

509  
	`__lx¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

510 
	}
}

513 
__ex‹º_šlše
 

514 
__NTH
 (
	$f¡©64
 (
__fd
, 
¡©64
 *
__¡©buf
))

516  
	`__fx¡©64
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

517 
	}
}

519 #ifdeà
__USE_GNU


520 
__ex‹º_šlše
 

521 
__NTH
 (
	$f¡©©64
 (
__fd
, 
__cÚ¡
 *
__f’ame
, 
¡©64
 *
__¡©buf
,

522 
__æag
))

524  
	`__fx¡©©64
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

525 
	}
}

532 
	g__END_DECLS


	@/usr/include/sys/sysctl.h

19 #iâdef 
_SYS_SYSCTL_H


20 
	#_SYS_SYSCTL_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 #iâdeà
_LINUX_KERNEL_H


27 
	#_LINUX_KERNEL_H
 1

	)

28 
	#__undef_LINUX_KERNEL_H


	)

30 #iâdeà
_LINUX_TYPES_H


31 
	#_LINUX_TYPES_H
 1

	)

32 
	#__undef_LINUX_TYPES_H


	)

34 #iâdeà
_LINUX_LIST_H


35 
	#_LINUX_LIST_H
 1

	)

36 
	#__undef_LINUX_LIST_H


	)

38 #iâdeà
__LINUX_COMPILER_H


39 
	#__LINUX_COMPILER_H
 1

	)

40 
	#__u£r


	)

41 
	#__undef__LINUX_COMPILER_H


	)

44 
	~<lšux/sysùl.h
>

46 #ifdeà
__undef_LINUX_KERNEL_H


47 #undeà
_LINUX_KERNEL_H


48 #undeà
__undef_LINUX_KERNEL_H


50 #ifdeà
__undef_LINUX_TYPES_H


51 #undeà
_LINUX_TYPES_H


52 #undeà
__undef_LINUX_TYPES_H


54 #ifdeà
__undef_LINUX_LIST_H


55 #undeà
_LINUX_LIST_H


56 #undeà
__undef_LINUX_LIST_H


58 #ifdeà
__undef__LINUX_COMPILER_H


59 #undeà
__LINUX_COMPILER_H


60 #undeà
__u£r


61 #undeà
__undef__LINUX_COMPILER_H


64 
__BEGIN_DECLS


67 
	$sysùl
 (*
__Çme
, 
__Æ’
, *
__Şdv®
,

68 
size_t
 *
__ŞdËÅ
, *
__Ãwv®
, size_ˆ
__ÃwËn
è
__THROW
;

70 
__END_DECLS


	@/usr/include/sys/sysinfo.h

19 #iâdeà
_SYS_SYSINFO_H


20 
	#_SYS_SYSINFO_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<lšux/k”Ãl.h
>

27 
__BEGIN_DECLS


30 
	$sysšfo
 (
sysšfo
 *
__šfo
è
__THROW
;

34 
	$g‘_Årocs_cÚf
 (è
__THROW
;

37 
	$g‘_Årocs
 (è
__THROW
;

41 
	$g‘_phys_·ges
 (è
__THROW
;

44 
	$g‘_avphys_·ges
 (è
__THROW
;

46 
__END_DECLS


	@/usr/include/sys/time.h

20 #iâdeà
_SYS_TIME_H


21 
	#_SYS_TIME_H
 1

	)

23 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

26 
	#__Ãed_time_t


	)

27 
	~<time.h
>

28 
	#__Ãed_timev®


	)

29 
	~<b™s/time.h
>

31 
	~<sys/£Ëù.h
>

33 #iâdeà
__su£cÚds_t_defšed


34 
__su£cÚds_t
 
	tsu£cÚds_t
;

35 
	#__su£cÚds_t_defšed


	)

39 
	g__BEGIN_DECLS


41 #ifdeà
__USE_GNU


43 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

44 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

45 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

46 }

	)

47 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

48 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

49 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

50 }

	)

54 #ifdeà
__USE_BSD


57 
	stimezÚe


59 
	mtz_mšu‹swe¡
;

60 
	mtz_d¡time
;

63 
timezÚe
 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

65 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

73 
	$g‘timeofday
 (
timev®
 *
__»¡riù
 
__tv
,

74 
__timezÚe_±r_t
 
__tz
è
__THROW
 
	`__nÚnuÎ
 ((1));

76 #ifdeà
__USE_BSD


79 
	$£‰imeofday
 (
__cÚ¡
 
timev®
 *
__tv
,

80 
__cÚ¡
 
timezÚe
 *
__tz
)

81 
__THROW
 
	`__nÚnuÎ
 ((1));

87 
	$adjtime
 (
__cÚ¡
 
timev®
 *
__d–
,

88 
timev®
 *
__Şdd–
è
__THROW
;

93 
	e__™im”_which


96 
ITIMER_REAL
 = 0,

97 
	#ITIMER_REAL
 
ITIMER_REAL


	)

99 
ITIMER_VIRTUAL
 = 1,

100 
	#ITIMER_VIRTUAL
 
ITIMER_VIRTUAL


	)

103 
ITIMER_PROF
 = 2

104 
	#ITIMER_PROF
 
ITIMER_PROF


	)

109 
	s™im”v®


112 
timev®
 
™_š‹rv®
;

114 
timev®
 
™_v®ue
;

117 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


120 
__™im”_which
 
	t__™im”_which_t
;

122 
	t__™im”_which_t
;

127 
	$g‘™im”
 (
__™im”_which_t
 
__which
,

128 
™im”v®
 *
__v®ue
è
__THROW
;

133 
	$£t™im”
 (
__™im”_which_t
 
__which
,

134 
__cÚ¡
 
™im”v®
 *
__»¡riù
 
__Ãw
,

135 
™im”v®
 *
__»¡riù
 
__Şd
è
__THROW
;

140 
	$utimes
 (
__cÚ¡
 *
__fe
, __cÚ¡ 
timev®
 
__tvp
[2])

141 
__THROW
 
	`__nÚnuÎ
 ((1));

143 #ifdeà
__USE_BSD


145 
	$lutimes
 (
__cÚ¡
 *
__fe
, __cÚ¡ 
timev®
 
__tvp
[2])

146 
__THROW
 
	`__nÚnuÎ
 ((1));

149 
	$futimes
 (
__fd
, 
__cÚ¡
 
timev®
 
__tvp
[2]è
__THROW
;

152 #ifdeà
__USE_ATFILE


156 
	$futime§t
 (
__fd
, 
__cÚ¡
 *
__fe
,

157 
__cÚ¡
 
timev®
 
__tvp
[2]è
__THROW
;

161 #ifdeà
__USE_BSD


164 
	#tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

165 
	#tim”ş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

166 
	#tim”cmp
(
a
, 
b
, 
CMP
) \

167 (((
a
)->
tv_£c
 =ğ(
b
)->tv_sec) ? \

168 ((
a
)->
tv_u£c
 
	`CMP
 (
b
)->tv_usec) : \

169 ((
a
)->
tv_£c
 
	`CMP
 (
b
)->tv_£c))

	)

170 
	#tim”add
(
a
, 
b
, 
»suÉ
) \

172 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø+ (
b
)->tv_sec; \

173 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø+ (
b
)->tv_usec; \

174 ià((
»suÉ
)->
tv_u£c
 >= 1000000) \

176 ++(
»suÉ
)->
tv_£c
; \

177 (
»suÉ
)->
tv_u£c
 -= 1000000; \

179 
	}
} 0)

	)

180 
	#tim”sub
(
a
, 
b
, 
»suÉ
) \

182 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

183 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

184 ià((
»suÉ
)->
tv_u£c
 < 0) { \

185 --(
»suÉ
)->
tv_£c
; \

186 (
»suÉ
)->
tv_u£c
 += 1000000; \

188 } 0)

	)

191 
	g__END_DECLS


	@/usr/include/sys/timeb.h

19 #iâdeà
_SYS_TIMEB_H


20 
	#_SYS_TIMEB_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	#__Ãed_time_t


	)

25 
	~<time.h
>

28 
__BEGIN_DECLS


32 
	stimeb


34 
time_t
 
	mtime
;

35 
	mml™m
;

36 
	mtimezÚe
;

37 
	md¡æag
;

42 
áime
 (
timeb
 *
__timebuf
);

44 
	g__END_DECLS


	@/usr/include/sys/times.h

23 #iâdef 
_SYS_TIMES_H


24 
	#_SYS_TIMES_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	#__Ãed_şock_t


	)

29 
	~<time.h
>

32 
__BEGIN_DECLS


35 
	stms


37 
şock_t
 
	mtms_utime
;

38 
şock_t
 
	mtms_¡ime
;

40 
şock_t
 
	mtms_cutime
;

41 
şock_t
 
	mtms_c¡ime
;

49 
şock_t
 
	$times
 (
tms
 *
__bufãr
è
__THROW
;

51 
__END_DECLS


	@/usr/include/sys/types.h

24 #iâdef 
_SYS_TYPES_H


25 
	#_SYS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

33 #ifdef 
__USE_BSD


34 #iâdeà
__u_ch¬_defšed


35 
__u_ch¬
 
	tu_ch¬
;

36 
__u_shÜt
 
	tu_shÜt
;

37 
__u_št
 
	tu_št
;

38 
__u_lÚg
 
	tu_lÚg
;

39 
__quad_t
 
	tquad_t
;

40 
__u_quad_t
 
	tu_quad_t
;

41 
__fsid_t
 
	tfsid_t
;

42 
	#__u_ch¬_defšed


	)

46 
__loff_t
 
	tloff_t
;

48 #iâdeà
__šo_t_defšed


49 #iâdeà
__USE_FILE_OFFSET64


50 
__šo_t
 
	tšo_t
;

52 
__šo64_t
 
	tšo_t
;

54 
	#__šo_t_defšed


	)

56 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


57 
__šo64_t
 
	tšo64_t
;

58 
	#__šo64_t_defšed


	)

61 #iâdeà
__dev_t_defšed


62 
__dev_t
 
	tdev_t
;

63 
	#__dev_t_defšed


	)

66 #iâdeà
__gid_t_defšed


67 
__gid_t
 
	tgid_t
;

68 
	#__gid_t_defšed


	)

71 #iâdeà
__mode_t_defšed


72 
__mode_t
 
	tmode_t
;

73 
	#__mode_t_defšed


	)

76 #iâdeà
__Æšk_t_defšed


77 
__Æšk_t
 
	tÆšk_t
;

78 
	#__Æšk_t_defšed


	)

81 #iâdeà
__uid_t_defšed


82 
__uid_t
 
	tuid_t
;

83 
	#__uid_t_defšed


	)

86 #iâdeà
__off_t_defšed


87 #iâdeà
__USE_FILE_OFFSET64


88 
__off_t
 
	toff_t
;

90 
__off64_t
 
	toff_t
;

92 
	#__off_t_defšed


	)

94 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


95 
__off64_t
 
	toff64_t
;

96 
	#__off64_t_defšed


	)

99 #iâdeà
__pid_t_defšed


100 
__pid_t
 
	tpid_t
;

101 
	#__pid_t_defšed


	)

104 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__id_t_defšed


105 
__id_t
 
	tid_t
;

106 
	#__id_t_defšed


	)

109 #iâdeà
__ssize_t_defšed


110 
__ssize_t
 
	tssize_t
;

111 
	#__ssize_t_defšed


	)

114 #ifdef 
__USE_BSD


115 #iâdeà
__daddr_t_defšed


116 
__daddr_t
 
	tdaddr_t
;

117 
__ÿddr_t
 
	tÿddr_t
;

118 
	#__daddr_t_defšed


	)

122 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


123 
__key_t
 
	tkey_t
;

124 
	#__key_t_defšed


	)

127 #ifdeà
__USE_XOPEN


128 
	#__Ãed_şock_t


	)

130 
	#__Ãed_time_t


	)

131 
	#__Ãed_tim”_t


	)

132 
	#__Ãed_şockid_t


	)

133 
	~<time.h
>

135 #ifdeà
__USE_XOPEN


136 #iâdeà
__u£cÚds_t_defšed


137 
__u£cÚds_t
 
	tu£cÚds_t
;

138 
	#__u£cÚds_t_defšed


	)

140 #iâdeà
__su£cÚds_t_defšed


141 
__su£cÚds_t
 
	tsu£cÚds_t
;

142 
	#__su£cÚds_t_defšed


	)

146 
	#__Ãed_size_t


	)

147 
	~<¡ddef.h
>

149 #ifdeà
__USE_MISC


151 
	tulÚg
;

152 
	tushÜt
;

153 
	tušt
;

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 #iâdeà
__št8_t_defšed


162 
	#__št8_t_defšed


	)

163 
	tšt8_t
;

164 
	tšt16_t
;

165 
	tšt32_t
;

166 #ià
__WORDSIZE
 == 64

167 
	tšt64_t
;

168 #–ià
__GLIBC_HAVE_LONG_LONG


169 
__ex‹nsiÚ__
 
	tšt64_t
;

174 
	tu_št8_t
;

175 
	tu_št16_t
;

176 
	tu_št32_t
;

177 #ià
__WORDSIZE
 == 64

178 
	tu_št64_t
;

179 #–ià
__GLIBC_HAVE_LONG_LONG


180 
__ex‹nsiÚ__
 
	tu_št64_t
;

183 
	t»gi¡”_t
;

188 
	#__štN_t
(
N
, 
MODE
) \

189 ##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

190 
	t__u_štN_t
(
	tN
, 
	tMODE
) \

191 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

193 #iâdeà
	t__št8_t_defšed


194 
	t__št8_t_defšed


	)

195 
	t__štN_t
 (8, 
	t__QI__
);

196 
__štN_t
 (16, 
__HI__
);

197 
__štN_t
 (32, 
__SI__
);

198 
__štN_t
 (64, 
__DI__
);

201 
__u_štN_t
 (8, 
__QI__
);

202 
__u_štN_t
 (16, 
__HI__
);

203 
__u_štN_t
 (32, 
__SI__
);

204 
__u_štN_t
 (64, 
__DI__
);

206 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

212 
	#__BIT_TYPES_DEFINED__
 1

	)

215 #ifdef 
__USE_BSD


217 
	~<’dŸn.h
>

220 
	~<sys/£Ëù.h
>

223 
	~<sys/sysmaüos.h
>

227 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__blksize_t_defšed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_defšed


	)

233 #iâdeà
__USE_FILE_OFFSET64


234 #iâdeà
__blkút_t_defšed


235 
__blkút_t
 
	tblkút_t
;

236 
	#__blkút_t_defšed


	)

238 #iâdeà
__fsblkút_t_defšed


239 
__fsblkút_t
 
	tfsblkút_t
;

240 
	#__fsblkút_t_defšed


	)

242 #iâdeà
__fsfút_t_defšed


243 
__fsfút_t
 
	tfsfút_t
;

244 
	#__fsfút_t_defšed


	)

247 #iâdeà
__blkút_t_defšed


248 
__blkút64_t
 
	tblkút_t
;

249 
	#__blkút_t_defšed


	)

251 #iâdeà
__fsblkút_t_defšed


252 
__fsblkút64_t
 
	tfsblkút_t
;

253 
	#__fsblkút_t_defšed


	)

255 #iâdeà
__fsfút_t_defšed


256 
__fsfút64_t
 
	tfsfút_t
;

257 
	#__fsfút_t_defšed


	)

261 #ifdeà
__USE_LARGEFILE64


262 
__blkút64_t
 
	tblkút64_t
;

263 
__fsblkút64_t
 
	tfsblkút64_t
;

264 
__fsfút64_t
 
	tfsfút64_t
;

269 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


270 
	~<b™s/±h»adty³s.h
>

273 
	g__END_DECLS


	@/usr/include/sys/utsname.h

23 #iâdef 
_SYS_UTSNAME_H


24 
	#_SYS_UTSNAME_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


30 
	~<b™s/ut¢ame.h
>

32 #iâdeà
_UTSNAME_SYSNAME_LENGTH


33 
	#_UTSNAME_SYSNAME_LENGTH
 
_UTSNAME_LENGTH


	)

35 #iâdeà
_UTSNAME_NODENAME_LENGTH


36 
	#_UTSNAME_NODENAME_LENGTH
 
_UTSNAME_LENGTH


	)

38 #iâdeà
_UTSNAME_RELEASE_LENGTH


39 
	#_UTSNAME_RELEASE_LENGTH
 
_UTSNAME_LENGTH


	)

41 #iâdeà
_UTSNAME_VERSION_LENGTH


42 
	#_UTSNAME_VERSION_LENGTH
 
_UTSNAME_LENGTH


	)

44 #iâdeà
_UTSNAME_MACHINE_LENGTH


45 
	#_UTSNAME_MACHINE_LENGTH
 
_UTSNAME_LENGTH


	)

49 
	sut¢ame


52 
	msy¢ame
[
_UTSNAME_SYSNAME_LENGTH
];

55 
	mnod’ame
[
_UTSNAME_NODENAME_LENGTH
];

58 
	m»Ëa£
[
_UTSNAME_RELEASE_LENGTH
];

60 
	mv”siÚ
[
_UTSNAME_VERSION_LENGTH
];

63 
	mmachše
[
_UTSNAME_MACHINE_LENGTH
];

65 #ià
_UTSNAME_DOMAIN_LENGTH
 - 0

67 #ifdeà
__USE_GNU


68 
	mdomašÇme
[
_UTSNAME_DOMAIN_LENGTH
];

70 
	m__domašÇme
[
_UTSNAME_DOMAIN_LENGTH
];

75 #ifdeà
__USE_SVID


77 
	#SYS_NMLN
 
_UTSNAME_LENGTH


	)

82 
	$uÇme
 (
ut¢ame
 *
__Çme
è
__THROW
;

85 
__END_DECLS


	@/usr/include/sys/wait.h

24 #iâdef 
_SYS_WAIT_H


25 
	#_SYS_WAIT_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	~<sigÇl.h
>

32 
	~<sys/»sourû.h
>

35 #ià!
defšed
 
_STDLIB_H
 || !defšed 
__USE_XOPEN


38 
	~<b™s/wa™æags.h
>

40 #ifdef 
__USE_BSD


45 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


46 
	#__WAIT_INT
(
¡©us
) \

47 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

48 { .
__š
 = (
¡©us
è}).
__i
))

	)

50 
	#__WAIT_INT
(
¡©us
è(*(
__cÚ¡
 *è&(¡©us))

	)

58 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


59 
	#__WAIT_STATUS
 *

	)

60 
	#__WAIT_STATUS_DEFN
 *

	)

65 
wa™
 *
	m__u±r
;

66 *
	m__Œ
;

67 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

68 
	#__WAIT_STATUS_DEFN
 *

	)

73 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

74 
	#__WAIT_STATUS
 *

	)

75 
	#__WAIT_STATUS_DEFN
 *

	)

80 
	~<b™s/wa™¡©us.h
>

82 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
(
	`__WAIT_INT
(¡©us))

	)

83 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
(
	`__WAIT_INT
(¡©us))

	)

84 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
(
	`__WAIT_INT
(¡©us))

	)

85 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
(
	`__WAIT_INT
(¡©us))

	)

86 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
(
	`__WAIT_INT
(¡©us))

	)

87 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
(
	`__WAIT_INT
(¡©us))

	)

88 #ifdeà
__WIFCONTINUED


89 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
(
	`__WAIT_INT
(¡©us))

	)

93 #ifdef 
__USE_BSD


94 
	#WCOREFLAG
 
__WCOREFLAG


	)

95 
	#WCOREDUMP
(
¡©us
è
	`__WCOREDUMP
(
	`__WAIT_INT
(¡©us))

	)

96 
	#W_EXITCODE
(
»t
, 
sig
è
	`__W_EXITCODE
Ô‘, sig)

	)

97 
	#W_STOPCODE
(
sig
è
	`__W_STOPCODE
(sig)

	)

101 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


104 
	mP_ALL
,

105 
	mP_PID
,

106 
	mP_PGID


107 } 
	tidty³_t
;

116 
__pid_t
 
wa™
 (
__WAIT_STATUS
 
__¡©_loc
);

118 #ifdef 
__USE_BSD


120 
	#WAIT_ANY
 (-1è

	)

121 
	#WAIT_MYPGRP
 0

	)

139 
__pid_t
 
wa™pid
 (__pid_ˆ
__pid
, *
__¡©_loc
, 
__İtiÚs
);

141 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


142 
	#__Ãed_sigšfo_t


	)

143 
	~<b™s/sigšfo.h
>

155 
wa™id
 (
idty³_t
 
__idty³
, 
__id_t
 
__id
, 
sigšfo_t
 *
__šfİ
,

156 
__İtiÚs
);

159 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


162 
	gru§ge
;

169 
__pid_t
 
	$wa™3
 (
__WAIT_STATUS
 
__¡©_loc
, 
__İtiÚs
,

170 
ru§ge
 * 
__u§ge
è
__THROW
;

173 #ifdeà
__USE_BSD


175 
__pid_t
 
	$wa™4
 (
__pid_t
 
__pid
, 
__WAIT_STATUS
 
__¡©_loc
, 
__İtiÚs
,

176 
ru§ge
 *
__u§ge
è
__THROW
;

180 
__END_DECLS


	@/usr/include/unistd.h

23 #iâdef 
_UNISTD_H


24 
	#_UNISTD_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


34 
	#_POSIX_VERSION
 200112L

	)

40 
	#_POSIX2_VERSION
 200112L

	)

44 
	#_POSIX2_C_BIND
 200112L

	)

48 
	#_POSIX2_C_DEV
 200112L

	)

52 
	#_POSIX2_SW_DEV
 200112L

	)

56 
	#_POSIX2_LOCALEDEF
 200112L

	)

59 #ifdeà
__USE_XOPEN2K


60 
	#_XOPEN_VERSION
 600

	)

61 #–ià
defšed
 
__USE_UNIX98


62 
	#_XOPEN_VERSION
 500

	)

64 
	#_XOPEN_VERSION
 4

	)

68 
	#_XOPEN_XCU_VERSION
 4

	)

71 
	#_XOPEN_XPG2
 1

	)

72 
	#_XOPEN_XPG3
 1

	)

73 
	#_XOPEN_XPG4
 1

	)

76 
	#_XOPEN_UNIX
 1

	)

79 
	#_XOPEN_CRYPT
 1

	)

83 
	#_XOPEN_ENH_I18N
 1

	)

86 
	#_XOPEN_LEGACY
 1

	)

173 
	~<b™s/posix_İt.h
>

176 #ifdeà
__USE_UNIX98


177 
	~<b™s/’vœÚm’ts.h
>

181 
	#STDIN_FILENO
 0

	)

182 
	#STDOUT_FILENO
 1

	)

183 
	#STDERR_FILENO
 2

	)

188 
	~<b™s/ty³s.h
>

190 #iâdef 
__ssize_t_defšed


191 
__ssize_t
 
	tssize_t
;

192 
	#__ssize_t_defšed


	)

195 
	#__Ãed_size_t


	)

196 
	#__Ãed_NULL


	)

197 
	~<¡ddef.h
>

199 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


202 #iâdeà
__gid_t_defšed


203 
__gid_t
 
	tgid_t
;

204 
	#__gid_t_defšed


	)

207 #iâdeà
__uid_t_defšed


208 
__uid_t
 
	tuid_t
;

209 
	#__uid_t_defšed


	)

212 #iâdeà
__off_t_defšed


213 #iâdeà
__USE_FILE_OFFSET64


214 
__off_t
 
	toff_t
;

216 
__off64_t
 
	toff_t
;

218 
	#__off_t_defšed


	)

220 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


221 
__off64_t
 
	toff64_t
;

222 
	#__off64_t_defšed


	)

225 #iâdeà
__u£cÚds_t_defšed


226 
__u£cÚds_t
 
	tu£cÚds_t
;

227 
	#__u£cÚds_t_defšed


	)

230 #iâdeà
__pid_t_defšed


231 
__pid_t
 
	tpid_t
;

232 
	#__pid_t_defšed


	)

236 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


237 #iâdeà
__šŒ_t_defšed


238 
__šŒ_t
 
	tšŒ_t
;

239 
	#__šŒ_t_defšed


	)

243 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


244 #iâdeà
__sockËn_t_defšed


245 
__sockËn_t
 
	tsockËn_t
;

246 
	#__sockËn_t_defšed


	)

252 
	#R_OK
 4

	)

253 
	#W_OK
 2

	)

254 
	#X_OK
 1

	)

255 
	#F_OK
 0

	)

258 
	$acûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

260 #ifdeà
__USE_GNU


263 
	$euidacûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
)

264 
__THROW
 
	`__nÚnuÎ
 ((1));

267 
	$—cûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
)

268 
__THROW
 
	`__nÚnuÎ
 ((1));

271 #ifdeà
__USE_ATFILE


275 
	$çcûs§t
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__ty³
, 
__æag
)

276 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

281 #iâdef 
_STDIO_H


282 
	#SEEK_SET
 0

	)

283 
	#SEEK_CUR
 1

	)

284 
	#SEEK_END
 2

	)

287 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


289 
	#L_SET
 
SEEK_SET


	)

290 
	#L_INCR
 
SEEK_CUR


	)

291 
	#L_XTND
 
SEEK_END


	)

300 #iâdeà
__USE_FILE_OFFSET64


301 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

303 #ifdeà
__REDIRECT_NTH


304 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

305 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

306 
l£ek64
);

308 
	#l£ek
 
l£ek64


	)

311 #ifdeà
__USE_LARGEFILE64


312 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

313 
__THROW
;

320 
	`şo£
 (
__fd
);

327 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

333 
ssize_t
 
	$wr™e
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
è
__wur
;

335 #ifdeà
__USE_UNIX98


336 #iâdeà
__USE_FILE_OFFSET64


343 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

344 
__off_t
 
__off£t
è
__wur
;

351 
ssize_t
 
	$pwr™e
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

352 
__off_t
 
__off£t
è
__wur
;

354 #ifdeà
__REDIRECT


355 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

356 
__off64_t
 
__off£t
),

357 
´—d64
è
__wur
;

358 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, 
__cÚ¡
 *
__buf
,

359 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

360 
pwr™e64
è
__wur
;

362 
	#´—d
 
´—d64


	)

363 
	#pwr™e
 
pwr™e64


	)

367 #ifdeà
__USE_LARGEFILE64


371 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

372 
__off64_t
 
__off£t
è
__wur
;

375 
ssize_t
 
	$pwr™e64
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

376 
__off64_t
 
__off£t
è
__wur
;

384 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

393 
	$®¬m
 (
__£cÚds
è
__THROW
;

405 
	`¦“p
 (
__£cÚds
);

407 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


412 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

413 
__THROW
;

420 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

429 
	`·u£
 ();

433 
	$chown
 (
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

434 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

436 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


438 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

443 
	$lchown
 (
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

444 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

448 #ifdeà
__USE_ATFILE


451 
	$fchowÇt
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
,

452 
__gid_t
 
__group
, 
__æag
)

453 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

457 
	$chdœ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

459 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


461 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

471 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

473 #ifdef 
__USE_GNU


477 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

480 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


484 *
	$g‘wd
 (*
__buf
)

485 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

490 
	$dup
 (
__fd
è
__THROW
 
__wur
;

493 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

496 **
__’vœÚ
;

497 #ifdeà
__USE_GNU


498 **
’vœÚ
;

504 
	$execve
 (
__cÚ¡
 *
__·th
, *__cÚ¡ 
__¬gv
[],

505 *
__cÚ¡
 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1));

507 #ifdeà
__USE_GNU


510 
	$ãxecve
 (
__fd
, *
__cÚ¡
 
__¬gv
[], *__cÚ¡ 
__’vp
[])

511 
__THROW
;

516 
	$execv
 (
__cÚ¡
 *
__·th
, *__cÚ¡ 
__¬gv
[])

517 
__THROW
 
	`__nÚnuÎ
 ((1));

521 
	$exeşe
 (
__cÚ¡
 *
__·th
, __cÚ¡ *
__¬g
, ...)

522 
__THROW
 
	`__nÚnuÎ
 ((1));

526 
	$exeş
 (
__cÚ¡
 *
__·th
, __cÚ¡ *
__¬g
, ...)

527 
__THROW
 
	`__nÚnuÎ
 ((1));

531 
	$execvp
 (
__cÚ¡
 *
__fe
, *__cÚ¡ 
__¬gv
[])

532 
__THROW
 
	`__nÚnuÎ
 ((1));

537 
	$exeşp
 (
__cÚ¡
 *
__fe
, __cÚ¡ *
__¬g
, ...)

538 
__THROW
 
	`__nÚnuÎ
 ((1));

541 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


543 
	$niû
 (
__šc
è
__THROW
 
__wur
;

548 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

554 
	~<b™s/cÚâame.h
>

557 
	$·thcÚf
 (
__cÚ¡
 *
__·th
, 
__Çme
)

558 
__THROW
 
	`__nÚnuÎ
 ((1));

561 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

564 
	$syscÚf
 (
__Çme
è
__THROW
;

566 #ifdef 
__USE_POSIX2


568 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

573 
__pid_t
 
	$g‘pid
 (è
__THROW
;

576 
__pid_t
 
	$g‘µid
 (è
__THROW
;

580 #iâdeà
__FAVOR_BSD


581 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

583 #ifdeà
__REDIRECT_NTH


584 
__pid_t
 
	`__REDIRECT_NTH
 (
g‘pg½
, (__pid_ˆ
__pid
), 
__g‘pgid
);

586 
	#g‘pg½
 
__g‘pgid


	)

591 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

592 #ifdeà
__USE_XOPEN_EXTENDED


593 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

600 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

602 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


613 #iâdeà
__FAVOR_BSD


617 
	$£g½
 (è
__THROW
;

622 #ifdeà
__REDIRECT_NTH


623 
	`__REDIRECT_NTH
 (
£g½
, (
__pid_t
 
__pid
, __pid_ˆ
__pg½
), 
£gid
);

625 
	#£g½
 
£gid


	)

634 
__pid_t
 
	$£tsid
 (è
__THROW
;

636 #ifdeà
__USE_XOPEN_EXTENDED


638 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

642 
__uid_t
 
	$g‘uid
 (è
__THROW
;

645 
__uid_t
 
	$g‘euid
 (è
__THROW
;

648 
__gid_t
 
	$g‘gid
 (è
__THROW
;

651 
__gid_t
 
	$g‘egid
 (è
__THROW
;

656 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

658 #ifdef 
__USE_GNU


660 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

667 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
;

669 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


672 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
;

675 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


677 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
;

684 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
;

686 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


689 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
;

692 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


694 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
;

697 #ifdeà
__USE_GNU


700 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

701 
__THROW
;

705 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

706 
__THROW
;

710 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

711 
__THROW
;

715 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

716 
__THROW
;

723 
__pid_t
 
	$fÜk
 (è
__THROW
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


730 
__pid_t
 
	$vfÜk
 (è
__THROW
;

736 *
	$‰yÇme
 (
__fd
è
__THROW
;

740 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

741 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

745 
	$i§‰y
 (
__fd
è
__THROW
;

747 #ià
defšed
 
__USE_BSD
 \

748 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

751 
	$‰y¦Ù
 (è
__THROW
;

756 
	$lšk
 (
__cÚ¡
 *
__äom
, __cÚ¡ *
__to
)

757 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

759 #ifdeà
__USE_ATFILE


762 
	$lšk©
 (
__äomfd
, 
__cÚ¡
 *
__äom
, 
__tofd
,

763 
__cÚ¡
 *
__to
, 
__æags
)

764 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

767 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


769 
	$symlšk
 (
__cÚ¡
 *
__äom
, __cÚ¡ *
__to
)

770 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

775 
ssize_t
 
	$»adlšk
 (
__cÚ¡
 *
__»¡riù
 
__·th
,

776 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

777 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

780 #ifdeà
__USE_ATFILE


782 
	$symlšk©
 (
__cÚ¡
 *
__äom
, 
__tofd
,

783 
__cÚ¡
 *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

786 
ssize_t
 
	$»adlšk©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

787 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

788 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

792 
	$uÆšk
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

794 #ifdeà
__USE_ATFILE


796 
	$uÆšk©
 (
__fd
, 
__cÚ¡
 *
__Çme
, 
__æag
)

797 
__THROW
 
	`__nÚnuÎ
 ((2));

801 
	$rmdœ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

805 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

808 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

815 *
	`g‘logš
 ();

816 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


823 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

826 #ifdef 
__USE_BSD


828 
	$£ogš
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

832 #ifdef 
__USE_POSIX2


836 
	#__Ãed_g‘İt


	)

837 
	~<g‘İt.h
>

841 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


845 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

849 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

852 
	$£tho¡Çme
 (
__cÚ¡
 *
__Çme
, 
size_t
 
__Ën
)

853 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

857 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

863 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

864 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

865 
	$£tdomašÇme
 (
__cÚ¡
 *
__Çme
, 
size_t
 
__Ën
)

866 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

872 
	$vhªgup
 (è
__THROW
;

875 
	$»voke
 (
__cÚ¡
 *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

883 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

884 
size_t
 
__off£t
, 
__sÿË
)

885 
__THROW
 
	`__nÚnuÎ
 ((1));

891 
	$acù
 (
__cÚ¡
 *
__Çme
è
__THROW
;

895 *
	$g‘u£rsh–l
 (è
__THROW
;

896 
	$’du£rsh–l
 (è
__THROW
;

897 
	$£tu£rsh–l
 (è
__THROW
;

903 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

907 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

910 
	$chroÙ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

914 *
	$g‘·ss
 (
__cÚ¡
 *
__´om±
è
	`__nÚnuÎ
 ((1));

918 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


923 
	`fsync
 (
__fd
);

927 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


930 
	`g‘ho¡id
 ();

933 
	$sync
 (è
__THROW
;

938 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

943 
	$g‘dbËsize
 (è
__THROW
;

947 #iâdeà
__USE_FILE_OFFSET64


948 
	$Œunÿ‹
 (
__cÚ¡
 *
__fe
, 
__off_t
 
__Ëngth
)

949 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

951 #ifdeà
__REDIRECT_NTH


952 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

953 (
__cÚ¡
 *
__fe
, 
__off64_t
 
__Ëngth
),

954 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

956 
	#Œunÿ‹
 
Œunÿ‹64


	)

959 #ifdeà
__USE_LARGEFILE64


960 
	$Œunÿ‹64
 (
__cÚ¡
 *
__fe
, 
__off64_t
 
__Ëngth
)

961 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

966 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


969 #iâdeà
__USE_FILE_OFFSET64


970 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

972 #ifdeà
__REDIRECT_NTH


973 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

974 
árunÿ‹64
è
__wur
;

976 
	#árunÿ‹
 
árunÿ‹64


	)

979 #ifdeà
__USE_LARGEFILE64


980 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

986 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


990 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

996 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1000 #ifdeà
__USE_MISC


1011 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1016 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1028 
	#F_ULOCK
 0

	)

1029 
	#F_LOCK
 1

	)

1030 
	#F_TLOCK
 2

	)

1031 
	#F_TEST
 3

	)

1033 #iâdeà
__USE_FILE_OFFSET64


1034 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1036 #ifdeà
__REDIRECT


1037 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1038 
lockf64
è
__wur
;

1040 
	#lockf
 
lockf64


	)

1043 #ifdeà
__USE_LARGEFILE64


1044 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1049 #ifdeà
__USE_GNU


1054 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1055 (
__ex‹nsiÚ__
 \

1056 ({ 
__»suÉ
; \

1057 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1058 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1059 
__»suÉ
; 
	}
}))

	)

1062 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1065 
fd©async
 (
__fdes
);

1071 #ifdef 
__USE_XOPEN


1073 *
	$üy±
 (
__cÚ¡
 *
__key
, __cÚ¡ *
__§É
)

1074 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1078 
	$’üy±
 (*
__block
, 
__edæag
è
__THROW
 
	`__nÚnuÎ
 ((1));

1085 
	$swab
 (
__cÚ¡
 *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1086 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1092 #ifdeà
__USE_XOPEN


1094 *
	$ù”mid
 (*
__s
è
__THROW
;

1099 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


1100 
	~<b™s/uni¡d.h
>

1103 
__END_DECLS


	@/usr/include/uuid/uuid.h

35 #iâdeà
_UUID_UUID_H


36 
	#_UUID_UUID_H


	)

38 
	~<sys/ty³s.h
>

39 #iâdeà
_WIN32


40 
	~<sys/time.h
>

42 
	~<time.h
>

44 
	tuuid_t
[16];

47 
	#UUID_VARIANT_NCS
 0

	)

48 
	#UUID_VARIANT_DCE
 1

	)

49 
	#UUID_VARIANT_MICROSOFT
 2

	)

50 
	#UUID_VARIANT_OTHER
 3

	)

53 
	#UUID_TYPE_DCE_TIME
 1

	)

54 
	#UUID_TYPE_DCE_RANDOM
 4

	)

57 #ifdeà
__GNUC__


58 
	#UUID_DEFINE
(
Çme
,
u0
,
u1
,
u2
,
u3
,
u4
,
u5
,
u6
,
u7
,
u8
,
u9
,
u10
,
u11
,
u12
,
u13
,
u14
,
u15
) \

59 cÚ¡ 
uuid_t
 
Çme
 
	`__©Œibu‹__
 ((
unu£d
)èğ{
u0
,
u1
,
u2
,
u3
,
u4
,
u5
,
u6
,
u7
,
u8
,
u9
,
u10
,
u11
,
u12
,
u13
,
u14
,
u15
}

	)

61 
	#UUID_DEFINE
(
Çme
,
u0
,
u1
,
u2
,
u3
,
u4
,
u5
,
u6
,
u7
,
u8
,
u9
,
u10
,
u11
,
u12
,
u13
,
u14
,
u15
) \

62 cÚ¡ 
uuid_t
 
Çme
 = {
u0
,
u1
,
u2
,
u3
,
u4
,
u5
,
u6
,
u7
,
u8
,
u9
,
u10
,
u11
,
u12
,
u13
,
u14
,
u15
}

	)

65 #ifdeà
__ılu¥lus


70 
uuid_ş—r
(
uuid_t
 
uu
);

73 
uuid_com·»
(cÚ¡ 
uuid_t
 
uu1
, cÚ¡ uuid_ˆ
uu2
);

76 
uuid_cİy
(
uuid_t
 
d¡
, cÚ¡ uuid_ˆ
¤c
);

79 
uuid_g’”©e
(
uuid_t
 
out
);

80 
uuid_g’”©e_¿ndom
(
uuid_t
 
out
);

81 
uuid_g’”©e_time
(
uuid_t
 
out
);

84 
uuid_is_nuÎ
(cÚ¡ 
uuid_t
 
uu
);

87 
uuid_·r£
(cÚ¡ *
š
, 
uuid_t
 
uu
);

90 
uuid_uÅ¬£
(cÚ¡ 
uuid_t
 
uu
, *
out
);

91 
uuid_uÅ¬£_low”
(cÚ¡ 
uuid_t
 
uu
, *
out
);

92 
uuid_uÅ¬£_uµ”
(cÚ¡ 
uuid_t
 
uu
, *
out
);

95 
time_t
 
uuid_time
(cÚ¡ 
uuid_t
 
uu
, 
timev®
 *
»t_tv
);

96 
uuid_ty³
(cÚ¡ 
uuid_t
 
uu
);

97 
uuid_v¬ŸÁ
(cÚ¡ 
uuid_t
 
uu
);

99 #ifdeà
__ılu¥lus


	@/usr/include/zlib.h

31 #iâdeà
ZLIB_H


32 
	#ZLIB_H


	)

34 
	~"zcÚf.h
"

36 #ifdeà
__ılu¥lus


40 
	#ZLIB_VERSION
 "1.2.3.3"

	)

41 
	#ZLIB_VERNUM
 0x1233

	)

42 
	#ZLIB_VER_MAJOR
 1

	)

43 
	#ZLIB_VER_MINOR
 2

	)

44 
	#ZLIB_VER_REVISION
 3

	)

80 
voidpf
 (*
	t®loc_func
è
	tOF
((
	tvoidpf
 
	tİaque
, 
	tuIÁ
 
	t™ems
, uIÁ 
	tsize
));

81 (*
ä“_func
è
	tOF
((
	tvoidpf
 
	tİaque
, voidpà
	tadd»ss
));

83 
š‹º®_¡©e
;

85 
	sz_¡»am_s
 {

86 
By‹f
 *
Ãxt_š
;

87 
uIÁ
 
ava_š
;

88 
uLÚg
 
tÙ®_š
;

90 
By‹f
 *
Ãxt_out
;

91 
uIÁ
 
ava_out
;

92 
uLÚg
 
tÙ®_out
;

94 *
msg
;

95 
š‹º®_¡©e
 
FAR
 *
¡©e
;

97 
®loc_func
 
z®loc
;

98 
ä“_func
 
zä“
;

99 
voidpf
 
İaque
;

101 
d©a_ty³
;

102 
uLÚg
 
adËr
;

103 
uLÚg
 
»£rved
;

104 } 
	tz_¡»am
;

106 
z_¡»am
 
	tFAR
 *
	tz_¡»amp
;

112 
	sgz_h—d”_s
 {

113 
‹xt
;

114 
uLÚg
 
time
;

115 
xæags
;

116 
os
;

117 
By‹f
 *
exŒa
;

118 
uIÁ
 
exŒa_Ën
;

119 
uIÁ
 
exŒa_max
;

120 
By‹f
 *
Çme
;

121 
uIÁ
 
Çme_max
;

122 
By‹f
 *
comm’t
;

123 
uIÁ
 
comm_max
;

124 
hüc
;

125 
dÚe
;

127 } 
	tgz_h—d”
;

129 
gz_h—d”
 
	tFAR
 *
	tgz_h—d”p
;

165 
	#Z_NO_FLUSH
 0

	)

166 
	#Z_PARTIAL_FLUSH
 1

	)

167 
	#Z_SYNC_FLUSH
 2

	)

168 
	#Z_FULL_FLUSH
 3

	)

169 
	#Z_FINISH
 4

	)

170 
	#Z_BLOCK
 5

	)

173 
	#Z_OK
 0

	)

174 
	#Z_STREAM_END
 1

	)

175 
	#Z_NEED_DICT
 2

	)

176 
	#Z_ERRNO
 (-1)

	)

177 
	#Z_STREAM_ERROR
 (-2)

	)

178 
	#Z_DATA_ERROR
 (-3)

	)

179 
	#Z_MEM_ERROR
 (-4)

	)

180 
	#Z_BUF_ERROR
 (-5)

	)

181 
	#Z_VERSION_ERROR
 (-6)

	)

186 
	#Z_NO_COMPRESSION
 0

	)

187 
	#Z_BEST_SPEED
 1

	)

188 
	#Z_BEST_COMPRESSION
 9

	)

189 
	#Z_DEFAULT_COMPRESSION
 (-1)

	)

192 
	#Z_FILTERED
 1

	)

193 
	#Z_HUFFMAN_ONLY
 2

	)

194 
	#Z_RLE
 3

	)

195 
	#Z_FIXED
 4

	)

196 
	#Z_DEFAULT_STRATEGY
 0

	)

199 
	#Z_BINARY
 0

	)

200 
	#Z_TEXT
 1

	)

201 
	#Z_ASCII
 
Z_TEXT


	)

202 
	#Z_UNKNOWN
 2

	)

205 
	#Z_DEFLATED
 8

	)

208 
	#Z_NULL
 0

	)

210 
	#zlib_v”siÚ
 
	`zlibV”siÚ
()

	)

215 
ZEXTERN
 cÚ¡ * 
ZEXPORT
 
zlibV”siÚ
 
OF
(());

245 
ZEXTERN
 
ZEXPORT
 
deæ©e
 
OF
((
z_¡»amp
 
¡rm
, 
æush
));

331 
ZEXTERN
 
ZEXPORT
 
deæ©eEnd
 
OF
((
z_¡»amp
 
¡rm
));

370 
ZEXTERN
 
ZEXPORT
 
šæ©e
 
OF
((
z_¡»amp
 
¡rm
, 
æush
));

469 
ZEXTERN
 
ZEXPORT
 
šæ©eEnd
 
OF
((
z_¡»amp
 
¡rm
));

545 
ZEXTERN
 
ZEXPORT
 
deæ©eS‘DiùiÚ¬y
 
OF
((
z_¡»amp
 
¡rm
,

546 cÚ¡ 
By‹f
 *
diùiÚ¬y
,

547 
uIÁ
 
diùL’gth
));

584 
ZEXTERN
 
ZEXPORT
 
deæ©eCİy
 
OF
((
z_¡»amp
 
de¡
,

585 
z_¡»amp
 
sourû
));

602 
ZEXTERN
 
ZEXPORT
 
deæ©eRe£t
 
OF
((
z_¡»amp
 
¡rm
));

613 
ZEXTERN
 
ZEXPORT
 
deæ©eP¬ams
 
OF
((
z_¡»amp
 
¡rm
,

614 
Ëv–
,

615 
¡¿‹gy
));

634 
ZEXTERN
 
ZEXPORT
 
deæ©eTuÃ
 
OF
((
z_¡»amp
 
¡rm
,

635 
good_Ëngth
,

636 
max_Ïzy
,

637 
niû_Ëngth
,

638 
max_chaš
));

651 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
deæ©eBound
 
OF
((
z_¡»amp
 
¡rm
,

652 
uLÚg
 
sourûL’
));

661 
ZEXTERN
 
ZEXPORT
 
deæ©ePrime
 
OF
((
z_¡»amp
 
¡rm
,

662 
b™s
,

663 
v®ue
));

677 
ZEXTERN
 
ZEXPORT
 
deæ©eS‘H—d”
 
OF
((
z_¡»amp
 
¡rm
,

678 
gz_h—d”p
 
h—d
));

748 
ZEXTERN
 
ZEXPORT
 
šæ©eS‘DiùiÚ¬y
 
OF
((
z_¡»amp
 
¡rm
,

749 cÚ¡ 
By‹f
 *
diùiÚ¬y
,

750 
uIÁ
 
diùL’gth
));

770 
ZEXTERN
 
ZEXPORT
 
šæ©eSync
 
OF
((
z_¡»amp
 
¡rm
));

785 
ZEXTERN
 
ZEXPORT
 
šæ©eCİy
 
OF
((
z_¡»amp
 
de¡
,

786 
z_¡»amp
 
sourû
));

801 
ZEXTERN
 
ZEXPORT
 
šæ©eRe£t
 
OF
((
z_¡»amp
 
¡rm
));

811 
ZEXTERN
 
ZEXPORT
 
šæ©ePrime
 
OF
((
z_¡»amp
 
¡rm
,

812 
b™s
,

813 
v®ue
));

827 
ZEXTERN
 
ZEXPORT
 
šæ©eG‘H—d”
 
OF
((
z_¡»amp
 
¡rm
,

828 
gz_h—d”p
 
h—d
));

889 (*
š_func
è
	tOF
((
	tFAR
 *, FAR * FAR *));

890 (*
out_func
è
	tOF
((
	tFAR
 *, FAR *, ));

892 
ZEXTERN
 
ZEXPORT
 
šæ©eBack
 
OF
((
z_¡»amp
 
¡rm
,

893 
š_func
 
š
, 
FAR
 *
š_desc
,

894 
out_func
 
out
, 
FAR
 *
out_desc
));

961 
ZEXTERN
 
ZEXPORT
 
šæ©eBackEnd
 
OF
((
z_¡»amp
 
¡rm
));

969 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
zlibCompeFÏgs
 
OF
(());

1021 
ZEXTERN
 
ZEXPORT
 
com´ess
 
OF
((
By‹f
 *
de¡
, 
uLÚgf
 *
de¡L’
,

1022 cÚ¡ 
By‹f
 *
sourû
, 
uLÚg
 
sourûL’
));

1036 
ZEXTERN
 
ZEXPORT
 
com´ess2
 
OF
((
By‹f
 *
de¡
, 
uLÚgf
 *
de¡L’
,

1037 cÚ¡ 
By‹f
 *
sourû
, 
uLÚg
 
sourûL’
,

1038 
Ëv–
));

1052 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
com´essBound
 
OF
((uLÚg 
sourûL’
));

1059 
ZEXTERN
 
ZEXPORT
 
uncom´ess
 
OF
((
By‹f
 *
de¡
, 
uLÚgf
 *
de¡L’
,

1060 cÚ¡ 
By‹f
 *
sourû
, 
uLÚg
 
sourûL’
));

1078 
voidp
 
	tgzFe
;

1098 
ZEXTERN
 
gzFe
 
ZEXPORT
 
gzdİ’
 
OF
((
fd
, cÚ¡ *
mode
));

1111 
ZEXTERN
 
ZEXPORT
 
gz£¬ams
 
OF
((
gzFe
 
fe
, 
Ëv–
, 
¡¿‹gy
));

1119 
ZEXTERN
 
ZEXPORT
 
gz»ad
 
OF
((
gzFe
 
fe
, 
voidp
 
buf
, 
Ën
));

1127 
ZEXTERN
 
ZEXPORT
 
gzwr™e
 
OF
((
gzFe
 
fe
,

1128 
voidpc
 
buf
, 
Ën
));

1135 
ZEXTERN
 
ZEXPORTVA
 
gz´štf
 
OF
((
gzFe
 
fe
, cÚ¡ *
fÜm©
, ...));

1148 
ZEXTERN
 
ZEXPORT
 
gzputs
 
OF
((
gzFe
 
fe
, cÚ¡ *
s
));

1155 
ZEXTERN
 * 
ZEXPORT
 
gzg‘s
 
OF
((
gzFe
 
fe
, *
buf
, 
Ën
));

1164 
ZEXTERN
 
ZEXPORT
 
gzputc
 
OF
((
gzFe
 
fe
, 
c
));

1170 
ZEXTERN
 
ZEXPORT
 
gzg‘c
 
OF
((
gzFe
 
fe
));

1176 
ZEXTERN
 
ZEXPORT
 
gzung‘c
 
OF
((
c
, 
gzFe
 
fe
));

1186 
ZEXTERN
 
ZEXPORT
 
gzæush
 
OF
((
gzFe
 
fe
, 
æush
));

1215 
ZEXTERN
 
ZEXPORT
 
gz»wšd
 
OF
((
gzFe
 
fe
));

1232 
ZEXTERN
 
ZEXPORT
 
gzeof
 
OF
((
gzFe
 
fe
));

1238 
ZEXTERN
 
ZEXPORT
 
gzdœeù
 
OF
((
gzFe
 
fe
));

1244 
ZEXTERN
 
ZEXPORT
 
gzşo£
 
OF
((
gzFe
 
fe
));

1252 
ZEXTERN
 cÚ¡ * 
ZEXPORT
 
gz”rÜ
 
OF
((
gzFe
 
fe
, *
”ºum
));

1264 
ZEXTERN
 
ZEXPORT
 
gzş—»¼
 
OF
((
gzFe
 
fe
));

1279 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
adËr32
 
OF
((uLÚg 
adËr
, cÚ¡ 
By‹f
 *
buf
, 
uIÁ
 
Ën
));

1305 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
üc32
 
OF
((uLÚg 
üc
, cÚ¡ 
By‹f
 *
buf
, 
uIÁ
 
Ën
));

1337 
ZEXTERN
 
ZEXPORT
 
deæ©eIn™_
 
OF
((
z_¡»amp
 
¡rm
, 
Ëv–
,

1338 cÚ¡ *
v”siÚ
, 
¡»am_size
));

1339 
ZEXTERN
 
ZEXPORT
 
šæ©eIn™_
 
OF
((
z_¡»amp
 
¡rm
,

1340 cÚ¡ *
v”siÚ
, 
¡»am_size
));

1341 
ZEXTERN
 
ZEXPORT
 
deæ©eIn™2_
 
OF
((
z_¡»amp
 
¡rm
, 
Ëv–
, 
m‘hod
,

1342 
wšdowB™s
, 
memLev–
,

1343 
¡¿‹gy
, cÚ¡ *
v”siÚ
,

1344 
¡»am_size
));

1345 
ZEXTERN
 
ZEXPORT
 
šæ©eIn™2_
 
OF
((
z_¡»amp
 
¡rm
, 
wšdowB™s
,

1346 cÚ¡ *
v”siÚ
, 
¡»am_size
));

1347 
ZEXTERN
 
ZEXPORT
 
šæ©eBackIn™_
 
OF
((
z_¡»amp
 
¡rm
, 
wšdowB™s
,

1348 
FAR
 *
wšdow
,

1349 cÚ¡ *
v”siÚ
,

1350 
¡»am_size
));

1351 
	#deæ©eIn™
(
¡rm
, 
Ëv–
) \

1352 
	`deæ©eIn™_
((
¡rm
), (
Ëv–
), 
ZLIB_VERSION
, (
z_¡»am
))

	)

1353 
	#šæ©eIn™
(
¡rm
) \

1354 
	`šæ©eIn™_
((
¡rm
), 
ZLIB_VERSION
, (
z_¡»am
))

	)

1355 
	#deæ©eIn™2
(
¡rm
, 
Ëv–
, 
m‘hod
, 
wšdowB™s
, 
memLev–
, 
¡¿‹gy
) \

1356 
	`deæ©eIn™2_
((
¡rm
),(
Ëv–
),(
m‘hod
),(
wšdowB™s
),(
memLev–
),\

1357 (
¡¿‹gy
), 
ZLIB_VERSION
, (
z_¡»am
))

	)

1358 
	#šæ©eIn™2
(
¡rm
, 
wšdowB™s
) \

1359 
	`šæ©eIn™2_
((
¡rm
), (
wšdowB™s
), 
ZLIB_VERSION
, (
z_¡»am
))

	)

1360 
	#šæ©eBackIn™
(
¡rm
, 
wšdowB™s
, 
wšdow
) \

1361 
	`šæ©eBackIn™_
((
¡rm
), (
wšdowB™s
), (
wšdow
), \

1362 
ZLIB_VERSION
, (
z_¡»am
))

	)

1364 #ifdeà
_LARGEFILE64_SOURCE


1365 
ZEXTERN
 
gzFe
 
ZEXPORT
 
gzİ’64
 
OF
((const *, const *));

1366 
ZEXTERN
 
off64_t
 
ZEXPORT
 
gz£ek64
 
OF
((
gzFe
, off64_t, ));

1367 
ZEXTERN
 
off64_t
 
ZEXPORT
 
gz‹Î64
 
OF
((
gzFe
));

1368 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
adËr32_combše64
 
OF
((uLÚg, uLÚg, 
off64_t
));

1369 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
üc32_combše64
 
OF
((uLÚg, uLÚg, 
off64_t
));

1372 #ià
_FILE_OFFSET_BITS
 == 64

1373 
	#gzİ’
 
gzİ’64


	)

1374 
	#gz£ek
 
gz£ek64


	)

1375 
	#gz‹Î
 
gz‹Î64


	)

1376 
	#adËr32_combše
 
adËr32_combše64


	)

1377 
	#üc32_combše
 
üc32_combše64


	)

1379 
ZEXTERN
 
gzFe
 
ZEXPORT
 
gzİ’
 
OF
((const *, const *));

1380 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gz£ek
 
OF
((
gzFe
, z_off_t, ));

1381 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gz‹Î
 
OF
((
gzFe
));

1382 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
adËr32_combše
 
OF
((uLÚg, uLÚg, 
z_off_t
));

1383 
ZEXTERN
 
uLÚg
 
ZEXPORT
 
üc32_combše
 
OF
((uLÚg, uLÚg, 
z_off_t
));

1386 #ià!
defšed
(
ZUTIL_H
è&& !defšed(
NO_DUMMY_DECL
)

1387 
	sš‹º®_¡©e
 {
dummy
;};

1390 
ZEXTERN
 cÚ¡ * 
ZEXPORT
 
zE¼Ü
 
OF
(());

1391 
ZEXTERN
 
ZEXPORT
 
šæ©eSyncPošt
 
OF
((
z_¡»amp
));

1392 
ZEXTERN
 cÚ¡ 
uLÚgf
 * 
ZEXPORT
 
g‘_üc_bË
 
OF
(());

1393 
ZEXTERN
 
ZEXPORT
 
šæ©eUnd”mše
 
OF
((
z_¡»amp
, ));

1395 #ifdeà
__ılu¥lus


	@/usr/include/alloca.h

19 #iâdef 
_ALLOCA_H


20 
	#_ALLOCA_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

27 
	g__BEGIN_DECLS


30 #undeà
®loÿ


33 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

35 #ifdef 
__GNUC__


36 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

39 
__END_DECLS


	@/usr/include/bits/byteswap.h

21 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H


25 #iâdeà
_BITS_BYTESWAP_H


26 
	#_BITS_BYTESWAP_H
 1

	)

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8))

	)

34 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

35 
	#__bsw­_16
(
x
) \

36 (
__ex‹nsiÚ__
 \

37 ({ 
__v
, 
__x
 = (
x
); \

38 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

39 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

41 
	`__asm__
 ("rorw $8, %w0" \

42 : "ô" (
__v
) \

43 : "0" (
__x
) \

45 
__v
; }))

	)

48 
	#__bsw­_16
(
x
) \

49 (
__ex‹nsiÚ__
 \

50 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_16
 (__x); }))

	)

55 
	#__bsw­_cÚ¡ªt_32
(
x
) \

56 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

57 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

59 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

60 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

61 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

62 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

63 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

64 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

65 || 
defšed
 
	g__amdçm10__
)

68 
	#__bsw­_32
(
x
) \

69 (
__ex‹nsiÚ__
 \

70 ({ 
__v
, 
__x
 = (
x
); \

71 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

72 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

74 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

75 
__v
; }))

	)

77 
	#__bsw­_32
(
x
) \

78 (
__ex‹nsiÚ__
 \

79 ({ 
__v
, 
__x
 = (
x
); \

80 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

81 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

83 
	`__asm__
 ("rorw $8, %w0;" \

86 : "ô" (
__v
) \

87 : "0" (
__x
) \

89 
__v
; }))

	)

92 
	#__bsw­_32
(
x
) \

93 (
__ex‹nsiÚ__
 \

94 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

98 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

100 
	#__bsw­_cÚ¡ªt_64
(
x
) \

101 ((((
x
) & 0xff00000000000000ull) >> 56) \

102 | (((
x
) & 0x00ff000000000000ull) >> 40) \

103 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

104 | (((
x
) & 0x000000ff00000000ull) >> 8) \

105 | (((
x
) & 0x00000000ff000000ull) << 8) \

106 | (((
x
) & 0x0000000000ff0000ull) << 24) \

107 | (((
x
) & 0x000000000000ff00ull) << 40) \

108 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

110 #ià
__WORDSIZE
 == 64

111 
	#__bsw­_64
(
x
) \

112 (
__ex‹nsiÚ__
 \

113 ({ 
__v
, 
__x
 = (
x
); \

114 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

115 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

117 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

118 
__v
; }))

	)

120 
	#__bsw­_64
(
x
) \

121 (
__ex‹nsiÚ__
 \

122 ({ uniÚ { 
__ex‹nsiÚ__
 
__Î
; \

123 
__l
[2]; } 
__w
, 
__r
; \

124 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

125 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

128 
__w
.
__Î
 = (
x
); \

129 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

130 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

132 
__r
.
__Î
; }))

	)

	@/usr/include/bits/confname.h

21 #iâdeà
_UNISTD_H


28 
	m_PC_LINK_MAX
,

29 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

30 
	m_PC_MAX_CANON
,

31 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

32 
	m_PC_MAX_INPUT
,

33 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

34 
	m_PC_NAME_MAX
,

35 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

36 
	m_PC_PATH_MAX
,

37 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

38 
	m_PC_PIPE_BUF
,

39 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

40 
	m_PC_CHOWN_RESTRICTED
,

41 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

42 
	m_PC_NO_TRUNC
,

43 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

44 
	m_PC_VDISABLE
,

45 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

46 
	m_PC_SYNC_IO
,

47 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

48 
	m_PC_ASYNC_IO
,

49 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

50 
	m_PC_PRIO_IO
,

51 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

52 
	m_PC_SOCK_MAXBUF
,

53 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

54 
	m_PC_FILESIZEBITS
,

55 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

56 
	m_PC_REC_INCR_XFER_SIZE
,

57 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

58 
	m_PC_REC_MAX_XFER_SIZE
,

59 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

60 
	m_PC_REC_MIN_XFER_SIZE
,

61 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

62 
	m_PC_REC_XFER_ALIGN
,

63 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

64 
	m_PC_ALLOC_SIZE_MIN
,

65 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

66 
	m_PC_SYMLINK_MAX
,

67 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

68 
	m_PC_2_SYMLINKS


69 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

75 
	m_SC_ARG_MAX
,

76 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

77 
	m_SC_CHILD_MAX
,

78 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

79 
	m_SC_CLK_TCK
,

80 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

81 
	m_SC_NGROUPS_MAX
,

82 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

83 
	m_SC_OPEN_MAX
,

84 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

85 
	m_SC_STREAM_MAX
,

86 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

87 
	m_SC_TZNAME_MAX
,

88 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

89 
	m_SC_JOB_CONTROL
,

90 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

91 
	m_SC_SAVED_IDS
,

92 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

93 
	m_SC_REALTIME_SIGNALS
,

94 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

95 
	m_SC_PRIORITY_SCHEDULING
,

96 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

97 
	m_SC_TIMERS
,

98 
	#_SC_TIMERS
 
_SC_TIMERS


	)

99 
	m_SC_ASYNCHRONOUS_IO
,

100 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

101 
	m_SC_PRIORITIZED_IO
,

102 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

103 
	m_SC_SYNCHRONIZED_IO
,

104 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

105 
	m_SC_FSYNC
,

106 
	#_SC_FSYNC
 
_SC_FSYNC


	)

107 
	m_SC_MAPPED_FILES
,

108 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

109 
	m_SC_MEMLOCK
,

110 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

111 
	m_SC_MEMLOCK_RANGE
,

112 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

113 
	m_SC_MEMORY_PROTECTION
,

114 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

115 
	m_SC_MESSAGE_PASSING
,

116 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

117 
	m_SC_SEMAPHORES
,

118 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

119 
	m_SC_SHARED_MEMORY_OBJECTS
,

120 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

121 
	m_SC_AIO_LISTIO_MAX
,

122 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

123 
	m_SC_AIO_MAX
,

124 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

125 
	m_SC_AIO_PRIO_DELTA_MAX
,

126 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

127 
	m_SC_DELAYTIMER_MAX
,

128 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

129 
	m_SC_MQ_OPEN_MAX
,

130 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

131 
	m_SC_MQ_PRIO_MAX
,

132 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

133 
	m_SC_VERSION
,

134 
	#_SC_VERSION
 
_SC_VERSION


	)

135 
	m_SC_PAGESIZE
,

136 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

137 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

138 
	m_SC_RTSIG_MAX
,

139 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

140 
	m_SC_SEM_NSEMS_MAX
,

141 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

142 
	m_SC_SEM_VALUE_MAX
,

143 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

144 
	m_SC_SIGQUEUE_MAX
,

145 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

146 
	m_SC_TIMER_MAX
,

147 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

151 
	m_SC_BC_BASE_MAX
,

152 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

153 
	m_SC_BC_DIM_MAX
,

154 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

155 
	m_SC_BC_SCALE_MAX
,

156 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

157 
	m_SC_BC_STRING_MAX
,

158 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

159 
	m_SC_COLL_WEIGHTS_MAX
,

160 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

161 
	m_SC_EQUIV_CLASS_MAX
,

162 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

163 
	m_SC_EXPR_NEST_MAX
,

164 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

165 
	m_SC_LINE_MAX
,

166 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

167 
	m_SC_RE_DUP_MAX
,

168 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

169 
	m_SC_CHARCLASS_NAME_MAX
,

170 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

172 
	m_SC_2_VERSION
,

173 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

174 
	m_SC_2_C_BIND
,

175 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

176 
	m_SC_2_C_DEV
,

177 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

178 
	m_SC_2_FORT_DEV
,

179 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

180 
	m_SC_2_FORT_RUN
,

181 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

182 
	m_SC_2_SW_DEV
,

183 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

184 
	m_SC_2_LOCALEDEF
,

185 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

187 
	m_SC_PII
,

188 
	#_SC_PII
 
_SC_PII


	)

189 
	m_SC_PII_XTI
,

190 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

191 
	m_SC_PII_SOCKET
,

192 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

193 
	m_SC_PII_INTERNET
,

194 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

195 
	m_SC_PII_OSI
,

196 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

197 
	m_SC_POLL
,

198 
	#_SC_POLL
 
_SC_POLL


	)

199 
	m_SC_SELECT
,

200 
	#_SC_SELECT
 
_SC_SELECT


	)

201 
	m_SC_UIO_MAXIOV
,

202 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

203 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

204 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

205 
	m_SC_PII_INTERNET_STREAM
,

206 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

207 
	m_SC_PII_INTERNET_DGRAM
,

208 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

209 
	m_SC_PII_OSI_COTS
,

210 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

211 
	m_SC_PII_OSI_CLTS
,

212 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

213 
	m_SC_PII_OSI_M
,

214 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

215 
	m_SC_T_IOV_MAX
,

216 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

219 
	m_SC_THREADS
,

220 
	#_SC_THREADS
 
_SC_THREADS


	)

221 
	m_SC_THREAD_SAFE_FUNCTIONS
,

222 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

223 
	m_SC_GETGR_R_SIZE_MAX
,

224 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

225 
	m_SC_GETPW_R_SIZE_MAX
,

226 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

227 
	m_SC_LOGIN_NAME_MAX
,

228 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

229 
	m_SC_TTY_NAME_MAX
,

230 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

231 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

232 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

233 
	m_SC_THREAD_KEYS_MAX
,

234 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

235 
	m_SC_THREAD_STACK_MIN
,

236 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

237 
	m_SC_THREAD_THREADS_MAX
,

238 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

239 
	m_SC_THREAD_ATTR_STACKADDR
,

240 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

241 
	m_SC_THREAD_ATTR_STACKSIZE
,

242 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

243 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

244 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

245 
	m_SC_THREAD_PRIO_INHERIT
,

246 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

247 
	m_SC_THREAD_PRIO_PROTECT
,

248 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

249 
	m_SC_THREAD_PROCESS_SHARED
,

250 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

252 
	m_SC_NPROCESSORS_CONF
,

253 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

254 
	m_SC_NPROCESSORS_ONLN
,

255 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

256 
	m_SC_PHYS_PAGES
,

257 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

258 
	m_SC_AVPHYS_PAGES
,

259 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

260 
	m_SC_ATEXIT_MAX
,

261 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

262 
	m_SC_PASS_MAX
,

263 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

265 
	m_SC_XOPEN_VERSION
,

266 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

267 
	m_SC_XOPEN_XCU_VERSION
,

268 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

269 
	m_SC_XOPEN_UNIX
,

270 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

271 
	m_SC_XOPEN_CRYPT
,

272 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

273 
	m_SC_XOPEN_ENH_I18N
,

274 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

275 
	m_SC_XOPEN_SHM
,

276 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

278 
	m_SC_2_CHAR_TERM
,

279 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

280 
	m_SC_2_C_VERSION
,

281 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

282 
	m_SC_2_UPE
,

283 
	#_SC_2_UPE
 
_SC_2_UPE


	)

285 
	m_SC_XOPEN_XPG2
,

286 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

287 
	m_SC_XOPEN_XPG3
,

288 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

289 
	m_SC_XOPEN_XPG4
,

290 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

292 
	m_SC_CHAR_BIT
,

293 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

294 
	m_SC_CHAR_MAX
,

295 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

296 
	m_SC_CHAR_MIN
,

297 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

298 
	m_SC_INT_MAX
,

299 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

300 
	m_SC_INT_MIN
,

301 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

302 
	m_SC_LONG_BIT
,

303 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

304 
	m_SC_WORD_BIT
,

305 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

306 
	m_SC_MB_LEN_MAX
,

307 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

308 
	m_SC_NZERO
,

309 
	#_SC_NZERO
 
_SC_NZERO


	)

310 
	m_SC_SSIZE_MAX
,

311 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

312 
	m_SC_SCHAR_MAX
,

313 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

314 
	m_SC_SCHAR_MIN
,

315 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

316 
	m_SC_SHRT_MAX
,

317 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

318 
	m_SC_SHRT_MIN
,

319 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

320 
	m_SC_UCHAR_MAX
,

321 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

322 
	m_SC_UINT_MAX
,

323 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

324 
	m_SC_ULONG_MAX
,

325 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

326 
	m_SC_USHRT_MAX
,

327 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

329 
	m_SC_NL_ARGMAX
,

330 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

331 
	m_SC_NL_LANGMAX
,

332 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

333 
	m_SC_NL_MSGMAX
,

334 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

335 
	m_SC_NL_NMAX
,

336 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

337 
	m_SC_NL_SETMAX
,

338 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

339 
	m_SC_NL_TEXTMAX
,

340 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

342 
	m_SC_XBS5_ILP32_OFF32
,

343 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

344 
	m_SC_XBS5_ILP32_OFFBIG
,

345 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

346 
	m_SC_XBS5_LP64_OFF64
,

347 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

348 
	m_SC_XBS5_LPBIG_OFFBIG
,

349 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

351 
	m_SC_XOPEN_LEGACY
,

352 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

353 
	m_SC_XOPEN_REALTIME
,

354 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

355 
	m_SC_XOPEN_REALTIME_THREADS
,

356 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

358 
	m_SC_ADVISORY_INFO
,

359 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

360 
	m_SC_BARRIERS
,

361 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

362 
	m_SC_BASE
,

363 
	#_SC_BASE
 
_SC_BASE


	)

364 
	m_SC_C_LANG_SUPPORT
,

365 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

366 
	m_SC_C_LANG_SUPPORT_R
,

367 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

368 
	m_SC_CLOCK_SELECTION
,

369 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

370 
	m_SC_CPUTIME
,

371 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

372 
	m_SC_THREAD_CPUTIME
,

373 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

374 
	m_SC_DEVICE_IO
,

375 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

376 
	m_SC_DEVICE_SPECIFIC
,

377 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

378 
	m_SC_DEVICE_SPECIFIC_R
,

379 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

380 
	m_SC_FD_MGMT
,

381 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

382 
	m_SC_FIFO
,

383 
	#_SC_FIFO
 
_SC_FIFO


	)

384 
	m_SC_PIPE
,

385 
	#_SC_PIPE
 
_SC_PIPE


	)

386 
	m_SC_FILE_ATTRIBUTES
,

387 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

388 
	m_SC_FILE_LOCKING
,

389 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

390 
	m_SC_FILE_SYSTEM
,

391 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

392 
	m_SC_MONOTONIC_CLOCK
,

393 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

394 
	m_SC_MULTI_PROCESS
,

395 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

396 
	m_SC_SINGLE_PROCESS
,

397 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

398 
	m_SC_NETWORKING
,

399 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

400 
	m_SC_READER_WRITER_LOCKS
,

401 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

402 
	m_SC_SPIN_LOCKS
,

403 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

404 
	m_SC_REGEXP
,

405 
	#_SC_REGEXP
 
_SC_REGEXP


	)

406 
	m_SC_REGEX_VERSION
,

407 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

408 
	m_SC_SHELL
,

409 
	#_SC_SHELL
 
_SC_SHELL


	)

410 
	m_SC_SIGNALS
,

411 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

412 
	m_SC_SPAWN
,

413 
	#_SC_SPAWN
 
_SC_SPAWN


	)

414 
	m_SC_SPORADIC_SERVER
,

415 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

416 
	m_SC_THREAD_SPORADIC_SERVER
,

417 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

418 
	m_SC_SYSTEM_DATABASE
,

419 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

420 
	m_SC_SYSTEM_DATABASE_R
,

421 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

422 
	m_SC_TIMEOUTS
,

423 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

424 
	m_SC_TYPED_MEMORY_OBJECTS
,

425 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

426 
	m_SC_USER_GROUPS
,

427 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

428 
	m_SC_USER_GROUPS_R
,

429 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

430 
	m_SC_2_PBS
,

431 
	#_SC_2_PBS
 
_SC_2_PBS


	)

432 
	m_SC_2_PBS_ACCOUNTING
,

433 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

434 
	m_SC_2_PBS_LOCATE
,

435 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

436 
	m_SC_2_PBS_MESSAGE
,

437 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

438 
	m_SC_2_PBS_TRACK
,

439 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

440 
	m_SC_SYMLOOP_MAX
,

441 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

442 
	m_SC_STREAMS
,

443 
	#_SC_STREAMS
 
_SC_STREAMS


	)

444 
	m_SC_2_PBS_CHECKPOINT
,

445 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

447 
	m_SC_V6_ILP32_OFF32
,

448 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

449 
	m_SC_V6_ILP32_OFFBIG
,

450 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

451 
	m_SC_V6_LP64_OFF64
,

452 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

453 
	m_SC_V6_LPBIG_OFFBIG
,

454 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

456 
	m_SC_HOST_NAME_MAX
,

457 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

458 
	m_SC_TRACE
,

459 
	#_SC_TRACE
 
_SC_TRACE


	)

460 
	m_SC_TRACE_EVENT_FILTER
,

461 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

462 
	m_SC_TRACE_INHERIT
,

463 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

464 
	m_SC_TRACE_LOG
,

465 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

467 
	m_SC_LEVEL1_ICACHE_SIZE
,

468 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

469 
	m_SC_LEVEL1_ICACHE_ASSOC
,

470 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

471 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

472 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

473 
	m_SC_LEVEL1_DCACHE_SIZE
,

474 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

475 
	m_SC_LEVEL1_DCACHE_ASSOC
,

476 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

477 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

478 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

479 
	m_SC_LEVEL2_CACHE_SIZE
,

480 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

481 
	m_SC_LEVEL2_CACHE_ASSOC
,

482 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

483 
	m_SC_LEVEL2_CACHE_LINESIZE
,

484 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

485 
	m_SC_LEVEL3_CACHE_SIZE
,

486 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

487 
	m_SC_LEVEL3_CACHE_ASSOC
,

488 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

489 
	m_SC_LEVEL3_CACHE_LINESIZE
,

490 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

491 
	m_SC_LEVEL4_CACHE_SIZE
,

492 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

493 
	m_SC_LEVEL4_CACHE_ASSOC
,

494 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

495 
	m_SC_LEVEL4_CACHE_LINESIZE
,

496 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

499 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

500 
	#_SC_IPV6
 
_SC_IPV6


	)

501 
	m_SC_RAW_SOCKETS


502 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

508 
	m_CS_PATH
,

509 
	#_CS_PATH
 
_CS_PATH


	)

511 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

512 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

513 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

515 
	m_CS_GNU_LIBC_VERSION
,

516 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

517 
	m_CS_GNU_LIBPTHREAD_VERSION
,

518 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

520 
	m_CS_LFS_CFLAGS
 = 1000,

521 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

522 
	m_CS_LFS_LDFLAGS
,

523 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

524 
	m_CS_LFS_LIBS
,

525 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

526 
	m_CS_LFS_LINTFLAGS
,

527 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

528 
	m_CS_LFS64_CFLAGS
,

529 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

530 
	m_CS_LFS64_LDFLAGS
,

531 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

532 
	m_CS_LFS64_LIBS
,

533 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

534 
	m_CS_LFS64_LINTFLAGS
,

535 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

537 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

538 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

539 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

540 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

541 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

542 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

543 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

544 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

545 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

546 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

547 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

548 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

549 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

550 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

551 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

552 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

553 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

554 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

555 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

556 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

557 
	m_CS_XBS5_LP64_OFF64_LIBS
,

558 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

559 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

560 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

561 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

562 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

563 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

564 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

565 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

566 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

567 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

568 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

570 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

571 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

572 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

573 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

574 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

575 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

576 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

577 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

578 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

579 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

580 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

581 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

582 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

583 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

584 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

585 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

586 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

587 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

588 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

589 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

590 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

591 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

592 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

593 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

594 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

595 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

596 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

597 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

598 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

599 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

600 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


601 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

	@/usr/include/bits/dirent.h

19 #iâdeà
_DIRENT_H


23 
	sdœ’t


25 #iâdeà
__USE_FILE_OFFSET64


26 
__šo_t
 
	md_šo
;

27 
__off_t
 
	md_off
;

29 
__šo64_t
 
	md_šo
;

30 
__off64_t
 
	md_off
;

32 
	md_»ş’
;

33 
	md_ty³
;

34 
	md_Çme
[256];

37 #ifdeà
__USE_LARGEFILE64


38 
	sdœ’t64


40 
__šo64_t
 
	md_šo
;

41 
__off64_t
 
	md_off
;

42 
	md_»ş’
;

43 
	md_ty³
;

44 
	md_Çme
[256];

48 
	#d_f’o
 
d_šo


	)

50 #undeà
_DIRENT_HAVE_D_NAMLEN


51 
	#_DIRENT_HAVE_D_RECLEN


	)

52 
	#_DIRENT_HAVE_D_OFF


	)

53 
	#_DIRENT_HAVE_D_TYPE


	)

	@/usr/include/bits/environments.h

19 #iâdeà
_UNISTD_H


23 
	~<b™s/wÜdsize.h
>

41 #ià
__WORDSIZE
 == 64

53 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

54 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

57 
	#_POSIX_V6_LP64_OFF64
 1

	)

58 
	#_XBS5_LP64_OFF64
 1

	)

64 
	#_POSIX_V6_ILP32_OFF32
 1

	)

65 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

66 
	#_XBS5_ILP32_OFF32
 1

	)

67 
	#_XBS5_ILP32_OFFBIG
 1

	)

82 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

83 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

84 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

85 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

86 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

87 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/fcntl.h

20 #iâdef 
_FCNTL_H


24 
	~<sys/ty³s.h
>

25 
	~<b™s/wÜdsize.h
>

26 #ifdeà
__USE_GNU


27 
	~<b™s/uio.h
>

33 
	#O_ACCMODE
 0003

	)

34 
	#O_RDONLY
 00

	)

35 
	#O_WRONLY
 01

	)

36 
	#O_RDWR
 02

	)

37 
	#O_CREAT
 0100

	)

38 
	#O_EXCL
 0200

	)

39 
	#O_NOCTTY
 0400

	)

40 
	#O_TRUNC
 01000

	)

41 
	#O_APPEND
 02000

	)

42 
	#O_NONBLOCK
 04000

	)

43 
	#O_NDELAY
 
O_NONBLOCK


	)

44 
	#O_SYNC
 010000

	)

45 
	#O_FSYNC
 
O_SYNC


	)

46 
	#O_ASYNC
 020000

	)

48 #ifdeà
__USE_GNU


49 
	#O_DIRECT
 040000

	)

50 
	#O_DIRECTORY
 0200000

	)

51 
	#O_NOFOLLOW
 0400000

	)

52 
	#O_NOATIME
 01000000

	)

53 
	#O_CLOEXEC
 02000000

	)

59 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


60 
	#O_DSYNC
 
O_SYNC


	)

61 
	#O_RSYNC
 
O_SYNC


	)

64 #ifdeà
__USE_LARGEFILE64


65 #ià
__WORDSIZE
 == 64

66 
	#O_LARGEFILE
 0

	)

68 
	#O_LARGEFILE
 0100000

	)

73 
	#F_DUPFD
 0

	)

74 
	#F_GETFD
 1

	)

75 
	#F_SETFD
 2

	)

76 
	#F_GETFL
 3

	)

77 
	#F_SETFL
 4

	)

78 #ià
__WORDSIZE
 == 64

79 
	#F_GETLK
 5

	)

80 
	#F_SETLK
 6

	)

81 
	#F_SETLKW
 7

	)

83 
	#F_GETLK64
 5

	)

84 
	#F_SETLK64
 6

	)

85 
	#F_SETLKW64
 7

	)

87 #iâdeà
__USE_FILE_OFFSET64


88 
	#F_GETLK
 5

	)

89 
	#F_SETLK
 6

	)

90 
	#F_SETLKW
 7

	)

92 
	#F_GETLK
 
F_GETLK64


	)

93 
	#F_SETLK
 
F_SETLK64


	)

94 
	#F_SETLKW
 
F_SETLKW64


	)

96 
	#F_GETLK64
 12

	)

97 
	#F_SETLK64
 13

	)

98 
	#F_SETLKW64
 14

	)

101 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


102 
	#F_SETOWN
 8

	)

103 
	#F_GETOWN
 9

	)

106 #ifdeà
__USE_GNU


107 
	#F_SETSIG
 10

	)

108 
	#F_GETSIG
 11

	)

111 #ifdeà
__USE_GNU


112 
	#F_SETLEASE
 1024

	)

113 
	#F_GETLEASE
 1025

	)

114 
	#F_NOTIFY
 1026

	)

115 
	#F_DUPFD_CLOEXEC
 1030

	)

120 
	#FD_CLOEXEC
 1

	)

123 
	#F_RDLCK
 0

	)

124 
	#F_WRLCK
 1

	)

125 
	#F_UNLCK
 2

	)

128 
	#F_EXLCK
 4

	)

129 
	#F_SHLCK
 8

	)

131 #ifdeà
__USE_BSD


133 
	#LOCK_SH
 1

	)

134 
	#LOCK_EX
 2

	)

135 
	#LOCK_NB
 4

	)

137 
	#LOCK_UN
 8

	)

140 #ifdeà
__USE_GNU


141 
	#LOCK_MAND
 32

	)

142 
	#LOCK_READ
 64

	)

143 
	#LOCK_WRITE
 128

	)

144 
	#LOCK_RW
 192

	)

147 #ifdeà
__USE_GNU


149 
	#DN_ACCESS
 0x00000001

	)

150 
	#DN_MODIFY
 0x00000002

	)

151 
	#DN_CREATE
 0x00000004

	)

152 
	#DN_DELETE
 0x00000008

	)

153 
	#DN_RENAME
 0x00000010

	)

154 
	#DN_ATTRIB
 0x00000020

	)

155 
	#DN_MULTISHOT
 0x80000000

	)

158 
	sæock


160 
	ml_ty³
;

161 
	ml_wh’û
;

162 #iâdeà
__USE_FILE_OFFSET64


163 
__off_t
 
	ml_¡¬t
;

164 
__off_t
 
	ml_Ën
;

166 
__off64_t
 
	ml_¡¬t
;

167 
__off64_t
 
	ml_Ën
;

169 
__pid_t
 
	ml_pid
;

172 #ifdeà
__USE_LARGEFILE64


173 
	sæock64


175 
	ml_ty³
;

176 
	ml_wh’û
;

177 
__off64_t
 
	ml_¡¬t
;

178 
__off64_t
 
	ml_Ën
;

179 
__pid_t
 
	ml_pid
;

185 #ifdef 
__USE_BSD


186 
	#FAPPEND
 
O_APPEND


	)

187 
	#FFSYNC
 
O_FSYNC


	)

188 
	#FASYNC
 
O_ASYNC


	)

189 
	#FNONBLOCK
 
O_NONBLOCK


	)

190 
	#FNDELAY
 
O_NDELAY


	)

194 #ifdeà
__USE_XOPEN2K


195 
	#POSIX_FADV_NORMAL
 0

	)

196 
	#POSIX_FADV_RANDOM
 1

	)

197 
	#POSIX_FADV_SEQUENTIAL
 2

	)

198 
	#POSIX_FADV_WILLNEED
 3

	)

199 
	#POSIX_FADV_DONTNEED
 4

	)

200 
	#POSIX_FADV_NOREUSE
 5

	)

204 #ifdeà
__USE_GNU


206 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

209 
	#SYNC_FILE_RANGE_WRITE
 2

	)

212 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

217 
	#SPLICE_F_MOVE
 1

	)

218 
	#SPLICE_F_NONBLOCK
 2

	)

221 
	#SPLICE_F_MORE
 4

	)

222 
	#SPLICE_F_GIFT
 8

	)

225 
	g__BEGIN_DECLS


227 #ifdeà
__USE_GNU


230 
ssize_t
 
	$»adah—d
 (
__fd
, 
__off64_t
 
__off£t
, 
size_t
 
__couÁ
)

231 
__THROW
;

235 
	`sync_fe_¿nge
 (
__fd
, 
__off64_t
 
__äom
, __off64_ˆ
__to
,

236 
__æags
);

240 
ssize_t
 
	`vm¥liû
 (
__fdout
, cÚ¡ 
iovec
 *
__iov
,

241 
size_t
 
__couÁ
, 
__æags
);

244 
ssize_t
 
	`¥liû
 (
__fdš
, 
__off64_t
 *
__offš
, 
__fdout
,

245 
__off64_t
 *
__offout
, 
size_t
 
__Ën
,

246 
__æags
);

249 
ssize_t
 
	`‹e
 (
__fdš
, 
__fdout
, 
size_t
 
__Ën
,

250 
__æags
);

254 
__END_DECLS


	@/usr/include/bits/fcntl2.h

20 #iâdef 
_FCNTL_H


26 #iâdeà
__USE_FILE_OFFSET64


27 
	$__İ’_2
 (
__cÚ¡
 *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

28 
	`__REDIRECT
 (
__İ’_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
, ...),

29 
İ’
è
	`__nÚnuÎ
 ((1));

31 
	`__REDIRECT
 (
__İ’_2
, (
__cÚ¡
 *
__·th
, 
__oæag
),

32 
__İ’64_2
è
	`__nÚnuÎ
 ((1));

33 
	`__REDIRECT
 (
__İ’_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
, ...),

34 
İ’64
è
	`__nÚnuÎ
 ((1));

36 
	`__”rÜdeş
 (
__İ’_too_mªy_¬gs
,

38 
	`__”rÜdeş
 (
__İ’_missšg_mode
,

41 
__ex‹º_®ways_šlše
 

42 
	$İ’
 (
__cÚ¡
 *
__·th
, 
__oæag
, ...)

44 ià(
	`__va_¬g_·ck_Ën
 () > 1)

45 
	`__İ’_too_mªy_¬gs
 ();

47 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

49 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

51 
	`__İ’_missšg_mode
 ();

52  
	`__İ’_2
 (
__·th
, 
__oæag
);

54  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

57 ià(
	`__va_¬g_·ck_Ën
 () < 1)

58  
	`__İ’_2
 (
__·th
, 
__oæag
);

60  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

61 
	}
}

64 #ifdeà
__USE_LARGEFILE64


65 
	$__İ’64_2
 (
__cÚ¡
 *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

66 
	`__REDIRECT
 (
__İ’64_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
,

67 ...), 
İ’64
è
	`__nÚnuÎ
 ((1));

68 
	`__”rÜdeş
 (
__İ’64_too_mªy_¬gs
,

70 
	`__”rÜdeş
 (
__İ’64_missšg_mode
,

73 
__ex‹º_®ways_šlše
 

74 
	$İ’64
 (
__cÚ¡
 *
__·th
, 
__oæag
, ...)

76 ià(
	`__va_¬g_·ck_Ën
 () > 1)

77 
	`__İ’64_too_mªy_¬gs
 ();

79 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

81 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

83 
	`__İ’64_missšg_mode
 ();

84  
	`__İ’64_2
 (
__·th
, 
__oæag
);

86  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

89 ià(
	`__va_¬g_·ck_Ën
 () < 1)

90  
	`__İ’64_2
 (
__·th
, 
__oæag
);

92  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

93 
	}
}

97 #ifdeà
__USE_ATFILE


98 #iâdeà
__USE_FILE_OFFSET64


99 
	$__İ’©_2
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
)

100 
	`__nÚnuÎ
 ((2));

101 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

102 
__oæag
, ...), 
İ’©
)

103 
	`__nÚnuÎ
 ((2));

105 
	`__REDIRECT
 (
__İ’©_2
, (
__fd
, 
__cÚ¡
 *
__·th
,

106 
__oæag
), 
__İ’©64_2
)

107 
	`__nÚnuÎ
 ((2));

108 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

109 
__oæag
, ...), 
İ’©64
)

110 
	`__nÚnuÎ
 ((2));

112 
	`__”rÜdeş
 (
__İ’©_too_mªy_¬gs
,

114 
	`__”rÜdeş
 (
__İ’©_missšg_mode
,

117 
__ex‹º_®ways_šlše
 

118 
	$İ’©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
, ...)

120 ià(
	`__va_¬g_·ck_Ën
 () > 1)

121 
	`__İ’©_too_mªy_¬gs
 ();

123 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

125 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

127 
	`__İ’©_missšg_mode
 ();

128  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

130  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

133 ià(
	`__va_¬g_·ck_Ën
 () < 1)

134  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

136  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

137 
	}
}

140 #ifdeà
__USE_LARGEFILE64


141 
	$__İ’©64_2
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
)

142 
	`__nÚnuÎ
 ((2));

143 
	`__REDIRECT
 (
__İ’©64_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

144 
__oæag
, ...), 
İ’©64
)

145 
	`__nÚnuÎ
 ((2));

146 
	`__”rÜdeş
 (
__İ’©64_too_mªy_¬gs
,

148 
	`__”rÜdeş
 (
__İ’©64_missšg_mode
,

151 
__ex‹º_®ways_šlše
 

152 
	$İ’©64
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
, ...)

154 ià(
	`__va_¬g_·ck_Ën
 () > 1)

155 
	`__İ’©64_too_mªy_¬gs
 ();

157 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

159 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

161 
	`__İ’©64_missšg_mode
 ();

162  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

164  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

167 ià(
	`__va_¬g_·ck_Ën
 () < 1)

168  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

170  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

171 
	}
}

	@/usr/include/bits/in.h

21 #iâdeà
_NETINET_IN_H


28 
	#IP_OPTIONS
 4

	)

29 
	#IP_HDRINCL
 3

	)

30 
	#IP_TOS
 1

	)

31 
	#IP_TTL
 2

	)

32 
	#IP_RECVOPTS
 6

	)

34 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

35 
	#IP_RETOPTS
 7

	)

36 
	#IP_MULTICAST_IF
 32

	)

37 
	#IP_MULTICAST_TTL
 33

	)

38 
	#IP_MULTICAST_LOOP
 34

	)

39 
	#IP_ADD_MEMBERSHIP
 35

	)

40 
	#IP_DROP_MEMBERSHIP
 36

	)

41 
	#IP_UNBLOCK_SOURCE
 37

	)

42 
	#IP_BLOCK_SOURCE
 38

	)

43 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

44 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

45 
	#IP_MSFILTER
 41

	)

46 
	#MCAST_JOIN_GROUP
 42

	)

47 
	#MCAST_BLOCK_SOURCE
 43

	)

48 
	#MCAST_UNBLOCK_SOURCE
 44

	)

49 
	#MCAST_LEAVE_GROUP
 45

	)

50 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

51 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

52 
	#MCAST_MSFILTER
 48

	)

54 
	#MCAST_EXCLUDE
 0

	)

55 
	#MCAST_INCLUDE
 1

	)

57 
	#IP_ROUTER_ALERT
 5

	)

58 
	#IP_PKTINFO
 8

	)

59 
	#IP_PKTOPTIONS
 9

	)

60 
	#IP_PMTUDISC
 10

	)

61 
	#IP_MTU_DISCOVER
 10

	)

62 
	#IP_RECVERR
 11

	)

63 
	#IP_RECVTTL
 12

	)

64 
	#IP_RECVTOS
 13

	)

68 
	#IP_PMTUDISC_DONT
 0

	)

69 
	#IP_PMTUDISC_WANT
 1

	)

70 
	#IP_PMTUDISC_DO
 2

	)

73 
	#SOL_IP
 0

	)

75 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

76 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

77 
	#IP_MAX_MEMBERSHIPS
 20

	)

82 
	s_İts


84 
š_addr
 
	m_d¡
;

85 
	m_İts
[40];

89 
	s_m»qn


91 
š_addr
 
	mimr_muÉŸddr
;

92 
š_addr
 
	mimr_add»ss
;

93 
	mimr_ifšdex
;

97 
	sš_pktšfo


99 
	mi_ifšdex
;

100 
š_addr
 
	mi_¥ec_d¡
;

101 
š_addr
 
	mi_addr
;

107 
	#IPV6_ADDRFORM
 1

	)

108 
	#IPV6_2292PKTINFO
 2

	)

109 
	#IPV6_2292HOPOPTS
 3

	)

110 
	#IPV6_2292DSTOPTS
 4

	)

111 
	#IPV6_2292RTHDR
 5

	)

112 
	#IPV6_2292PKTOPTIONS
 6

	)

113 
	#IPV6_CHECKSUM
 7

	)

114 
	#IPV6_2292HOPLIMIT
 8

	)

116 
	#SCM_SRCRT
 
IPV6_RXSRCRT


	)

118 
	#IPV6_NEXTHOP
 9

	)

119 
	#IPV6_AUTHHDR
 10

	)

120 
	#IPV6_UNICAST_HOPS
 16

	)

121 
	#IPV6_MULTICAST_IF
 17

	)

122 
	#IPV6_MULTICAST_HOPS
 18

	)

123 
	#IPV6_MULTICAST_LOOP
 19

	)

124 
	#IPV6_JOIN_GROUP
 20

	)

125 
	#IPV6_LEAVE_GROUP
 21

	)

126 
	#IPV6_ROUTER_ALERT
 22

	)

127 
	#IPV6_MTU_DISCOVER
 23

	)

128 
	#IPV6_MTU
 24

	)

129 
	#IPV6_RECVERR
 25

	)

130 
	#IPV6_V6ONLY
 26

	)

131 
	#IPV6_JOIN_ANYCAST
 27

	)

132 
	#IPV6_LEAVE_ANYCAST
 28

	)

133 
	#IPV6_IPSEC_POLICY
 34

	)

134 
	#IPV6_XFRM_POLICY
 35

	)

136 
	#IPV6_RECVPKTINFO
 49

	)

137 
	#IPV6_PKTINFO
 50

	)

138 
	#IPV6_RECVHOPLIMIT
 51

	)

139 
	#IPV6_HOPLIMIT
 52

	)

140 
	#IPV6_RECVHOPOPTS
 53

	)

141 
	#IPV6_HOPOPTS
 54

	)

142 
	#IPV6_RTHDRDSTOPTS
 55

	)

143 
	#IPV6_RECVRTHDR
 56

	)

144 
	#IPV6_RTHDR
 57

	)

145 
	#IPV6_RECVDSTOPTS
 58

	)

146 
	#IPV6_DSTOPTS
 59

	)

148 
	#IPV6_RECVTCLASS
 66

	)

149 
	#IPV6_TCLASS
 67

	)

152 
	#IPV6_ADD_MEMBERSHIP
 
IPV6_JOIN_GROUP


	)

153 
	#IPV6_DROP_MEMBERSHIP
 
IPV6_LEAVE_GROUP


	)

154 
	#IPV6_RXHOPOPTS
 
IPV6_HOPOPTS


	)

155 
	#IPV6_RXDSTOPTS
 
IPV6_DSTOPTS


	)

158 
	#IPV6_PMTUDISC_DONT
 0

	)

159 
	#IPV6_PMTUDISC_WANT
 1

	)

160 
	#IPV6_PMTUDISC_DO
 2

	)

163 
	#SOL_IPV6
 41

	)

164 
	#SOL_ICMPV6
 58

	)

167 
	#IPV6_RTHDR_LOOSE
 0

	)

168 
	#IPV6_RTHDR_STRICT
 1

	)

170 
	#IPV6_RTHDR_TYPE_0
 0

	)

	@/usr/include/bits/netdb.h

19 #iâdeà
_NETDB_H


27 
	sÃ‹Á


29 *
	mn_Çme
;

30 **
	mn_®Ÿ£s
;

31 
	mn_add¹y³
;

32 
ušt32_t
 
	mn_Ãt
;

	@/usr/include/bits/posix1_lim.h

25 #iâdef 
_BITS_POSIX1_LIM_H


26 
	#_BITS_POSIX1_LIM_H
 1

	)

32 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

35 
	#_POSIX_AIO_MAX
 1

	)

38 
	#_POSIX_ARG_MAX
 4096

	)

41 #ifdeà
__USE_XOPEN2K


42 
	#_POSIX_CHILD_MAX
 25

	)

44 
	#_POSIX_CHILD_MAX
 6

	)

48 
	#_POSIX_DELAYTIMER_MAX
 32

	)

52 
	#_POSIX_HOST_NAME_MAX
 255

	)

55 
	#_POSIX_LINK_MAX
 8

	)

58 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

61 
	#_POSIX_MAX_CANON
 255

	)

65 
	#_POSIX_MAX_INPUT
 255

	)

68 
	#_POSIX_MQ_OPEN_MAX
 8

	)

71 
	#_POSIX_MQ_PRIO_MAX
 32

	)

74 
	#_POSIX_NAME_MAX
 14

	)

77 #ifdeà
__USE_XOPEN2K


78 
	#_POSIX_NGROUPS_MAX
 8

	)

80 
	#_POSIX_NGROUPS_MAX
 0

	)

84 #ifdeà
__USE_XOPEN2K


85 
	#_POSIX_OPEN_MAX
 20

	)

87 
	#_POSIX_OPEN_MAX
 16

	)

92 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

95 
	#_POSIX_PATH_MAX
 256

	)

98 
	#_POSIX_PIPE_BUF
 512

	)

102 
	#_POSIX_RE_DUP_MAX
 255

	)

105 
	#_POSIX_RTSIG_MAX
 8

	)

108 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

111 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

114 
	#_POSIX_SIGQUEUE_MAX
 32

	)

117 
	#_POSIX_SSIZE_MAX
 32767

	)

120 
	#_POSIX_STREAM_MAX
 8

	)

123 
	#_POSIX_SYMLINK_MAX
 255

	)

127 
	#_POSIX_SYMLOOP_MAX
 8

	)

130 
	#_POSIX_TIMER_MAX
 32

	)

133 
	#_POSIX_TTY_NAME_MAX
 9

	)

136 
	#_POSIX_TZNAME_MAX
 6

	)

139 
	#_POSIX_QLIMIT
 1

	)

143 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

146 
	#_POSIX_UIO_MAXIOV
 16

	)

149 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

153 
	~<b™s/loÿl_lim.h
>

156 #iâdef 
SSIZE_MAX


157 
	#SSIZE_MAX
 
LONG_MAX


	)

164 #iâdef 
NGROUPS_MAX


165 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

23 #iâdef 
_BITS_POSIX2_LIM_H


24 
	#_BITS_POSIX2_LIM_H
 1

	)

28 
	#_POSIX2_BC_BASE_MAX
 99

	)

31 
	#_POSIX2_BC_DIM_MAX
 2048

	)

34 
	#_POSIX2_BC_SCALE_MAX
 99

	)

37 
	#_POSIX2_BC_STRING_MAX
 1000

	)

41 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

45 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

48 
	#_POSIX2_LINE_MAX
 2048

	)

52 
	#_POSIX2_RE_DUP_MAX
 255

	)

56 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

63 #iâdef 
BC_BASE_MAX


64 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

66 #iâdef 
BC_DIM_MAX


67 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

69 #iâdef 
BC_SCALE_MAX


70 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

72 #iâdef 
BC_STRING_MAX


73 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

75 #iâdef 
COLL_WEIGHTS_MAX


76 
	#COLL_WEIGHTS_MAX
 255

	)

78 #iâdef 
EXPR_NEST_MAX


79 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

81 #iâdef 
LINE_MAX


82 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

84 #iâdef 
CHARCLASS_NAME_MAX


85 
	#CHARCLASS_NAME_MAX
 2048

	)

89 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/posix_opt.h

20 #iâdef 
_POSIX_OPT_H


21 
	#_POSIX_OPT_H
 1

	)

24 
	#_POSIX_JOB_CONTROL
 1

	)

27 
	#_POSIX_SAVED_IDS
 1

	)

30 
	#_POSIX_PRIORITY_SCHEDULING
 200112L

	)

33 
	#_POSIX_SYNCHRONIZED_IO
 200112L

	)

36 
	#_POSIX_FSYNC
 200112L

	)

39 
	#_POSIX_MAPPED_FILES
 200112L

	)

42 
	#_POSIX_MEMLOCK
 200112L

	)

45 
	#_POSIX_MEMLOCK_RANGE
 200112L

	)

48 
	#_POSIX_MEMORY_PROTECTION
 200112L

	)

51 
	#_POSIX_CHOWN_RESTRICTED
 1

	)

55 
	#_POSIX_VDISABLE
 '\0'

	)

58 
	#_POSIX_NO_TRUNC
 1

	)

61 
	#_XOPEN_REALTIME
 1

	)

64 
	#_XOPEN_REALTIME_THREADS
 1

	)

67 
	#_XOPEN_SHM
 1

	)

70 
	#_POSIX_THREADS
 200112L

	)

73 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

74 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200112L

	)

77 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200112L

	)

80 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200112L

	)

83 
	#_POSIX_THREAD_ATTR_STACKADDR
 200112L

	)

86 
	#_POSIX_THREAD_PRIO_INHERIT
 200112L

	)

90 
	#_POSIX_THREAD_PRIO_PROTECT
 200112L

	)

93 
	#_POSIX_SEMAPHORES
 200112L

	)

96 
	#_POSIX_REALTIME_SIGNALS
 200112L

	)

99 
	#_POSIX_ASYNCHRONOUS_IO
 200112L

	)

100 
	#_POSIX_ASYNC_IO
 1

	)

102 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

104 
	#_POSIX_PRIORITIZED_IO
 200112L

	)

107 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

110 
	#_LFS_LARGEFILE
 1

	)

111 
	#_LFS64_LARGEFILE
 1

	)

112 
	#_LFS64_STDIO
 1

	)

115 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200112L

	)

118 
	#_POSIX_CPUTIME
 0

	)

121 
	#_POSIX_THREAD_CPUTIME
 0

	)

124 
	#_POSIX_REGEXP
 1

	)

127 
	#_POSIX_READER_WRITER_LOCKS
 200112L

	)

130 
	#_POSIX_SHELL
 1

	)

133 
	#_POSIX_TIMEOUTS
 200112L

	)

136 
	#_POSIX_SPIN_LOCKS
 200112L

	)

139 
	#_POSIX_SPAWN
 200112L

	)

142 
	#_POSIX_TIMERS
 200112L

	)

145 
	#_POSIX_BARRIERS
 200112L

	)

148 
	#_POSIX_MESSAGE_PASSING
 200112L

	)

151 
	#_POSIX_THREAD_PROCESS_SHARED
 200112L

	)

154 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

157 
	#_POSIX_CLOCK_SELECTION
 200112L

	)

160 
	#_POSIX_ADVISORY_INFO
 200112L

	)

163 
	#_POSIX_IPV6
 200112L

	)

166 
	#_POSIX_RAW_SOCKETS
 200112L

	)

169 
	#_POSIX2_CHAR_TERM
 200112L

	)

172 
	#_POSIX_SPORADIC_SERVER
 -1

	)

173 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

176 
	#_POSIX_TRACE
 -1

	)

177 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

178 
	#_POSIX_TRACE_INHERIT
 -1

	)

179 
	#_POSIX_TRACE_LOG
 -1

	)

182 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

	@/usr/include/bits/pthreadtypes.h

20 #iâdeà
_BITS_PTHREADTYPES_H


21 
	#_BITS_PTHREADTYPES_H
 1

	)

23 
	~<b™s/wÜdsize.h
>

25 #ià
__WORDSIZE
 == 64

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

29 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

30 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

31 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

32 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

34 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

36 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

37 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

38 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

39 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

40 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

43 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

50 
	t±h»ad_t
;

55 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

56 
	m__®ign
;

57 } 
	t±h»ad_©Œ_t
;

60 #ià
__WORDSIZE
 == 64

61 
	s__±h»ad_š‹º®_li¡


63 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

64 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

65 } 
	t__±h»ad_li¡_t
;

67 
	s__±h»ad_š‹º®_¦i¡


69 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

70 } 
	t__±h»ad_¦i¡_t
;

78 
	s__±h»ad_mu‹x_s


80 
	m__lock
;

81 
	m__couÁ
;

82 
	m__owÃr
;

83 #ià
__WORDSIZE
 == 64

84 
	m__nu£rs
;

88 
	m__kšd
;

89 #ià
__WORDSIZE
 == 64

90 
	m__¥šs
;

91 
__±h»ad_li¡_t
 
	m__li¡
;

92 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

94 
	m__nu£rs
;

95 
__ex‹nsiÚ__
 union

97 
	m__¥šs
;

98 
__±h»ad_¦i¡_t
 
	m__li¡
;

101 } 
	m__d©a
;

102 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

103 
	m__®ign
;

104 } 
	t±h»ad_mu‹x_t
;

108 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

109 
	m__®ign
;

110 } 
	t±h»ad_mu‹x©Œ_t
;

119 
	m__lock
;

120 
	m__fu‹x
;

121 
__ex‹nsiÚ__
 
	m__tÙ®_£q
;

122 
__ex‹nsiÚ__
 
	m__wakeup_£q
;

123 
__ex‹nsiÚ__
 
	m__wok’_£q
;

124 *
	m__mu‹x
;

125 
	m__nwa™”s
;

126 
	m__brßdÿ¡_£q
;

127 } 
	m__d©a
;

128 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

129 
__ex‹nsiÚ__
 
	m__®ign
;

130 } 
	t±h»ad_cÚd_t
;

134 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

135 
	m__®ign
;

136 } 
	t±h»ad_cÚd©Œ_t
;

140 
	t±h»ad_key_t
;

144 
	t±h»ad_Úû_t
;

147 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


152 #ià
__WORDSIZE
 == 64

155 
	m__lock
;

156 
	m__Ä_»ad”s
;

157 
	m__»ad”s_wakeup
;

158 
	m__wr™”_wakeup
;

159 
	m__Ä_»ad”s_queued
;

160 
	m__Ä_wr™”s_queued
;

161 
	m__wr™”
;

162 
	m__sh¬ed
;

163 
	m__·d1
;

164 
	m__·d2
;

167 
	m__æags
;

168 } 
	m__d©a
;

172 
	m__lock
;

173 
	m__Ä_»ad”s
;

174 
	m__»ad”s_wakeup
;

175 
	m__wr™”_wakeup
;

176 
	m__Ä_»ad”s_queued
;

177 
	m__Ä_wr™”s_queued
;

180 
	m__æags
;

181 
	m__sh¬ed
;

182 
	m__·d1
;

183 
	m__·d2
;

184 
	m__wr™”
;

185 } 
	m__d©a
;

187 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

188 
	m__®ign
;

189 } 
	t±h»ad_rwlock_t
;

193 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

194 
	m__®ign
;

195 } 
	t±h»ad_rwlock©Œ_t
;

199 #ifdeà
__USE_XOPEN2K


201 vŞ©
	t±h»ad_¥šlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

209 
	m__®ign
;

210 } 
	t±h»ad_b¬r›r_t
;

214 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

215 
	m__®ign
;

216 } 
	t±h»ad_b¬r›¿‰r_t
;

220 #ià
__WORDSIZE
 == 32

222 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/resource.h

21 #iâdeà
_SYS_RESOURCE_H


25 
	~<b™s/ty³s.h
>

33 
	e__¾im™_»sourû


36 
	mRLIMIT_CPU
 = 0,

37 
	#RLIMIT_CPU
 
RLIMIT_CPU


	)

40 
	mRLIMIT_FSIZE
 = 1,

41 
	#RLIMIT_FSIZE
 
RLIMIT_FSIZE


	)

44 
	mRLIMIT_DATA
 = 2,

45 
	#RLIMIT_DATA
 
RLIMIT_DATA


	)

48 
	mRLIMIT_STACK
 = 3,

49 
	#RLIMIT_STACK
 
RLIMIT_STACK


	)

52 
	mRLIMIT_CORE
 = 4,

53 
	#RLIMIT_CORE
 
RLIMIT_CORE


	)

59 
	m__RLIMIT_RSS
 = 5,

60 
	#RLIMIT_RSS
 
__RLIMIT_RSS


	)

63 
	mRLIMIT_NOFILE
 = 7,

64 
	m__RLIMIT_OFILE
 = 
RLIMIT_NOFILE
,

65 
	#RLIMIT_NOFILE
 
RLIMIT_NOFILE


	)

66 
	#RLIMIT_OFILE
 
__RLIMIT_OFILE


	)

69 
	mRLIMIT_AS
 = 9,

70 
	#RLIMIT_AS
 
RLIMIT_AS


	)

73 
	m__RLIMIT_NPROC
 = 6,

74 
	#RLIMIT_NPROC
 
__RLIMIT_NPROC


	)

77 
	m__RLIMIT_MEMLOCK
 = 8,

78 
	#RLIMIT_MEMLOCK
 
__RLIMIT_MEMLOCK


	)

81 
	m__RLIMIT_LOCKS
 = 10,

82 
	#RLIMIT_LOCKS
 
__RLIMIT_LOCKS


	)

85 
	m__RLIMIT_SIGPENDING
 = 11,

86 
	#RLIMIT_SIGPENDING
 
__RLIMIT_SIGPENDING


	)

89 
	m__RLIMIT_MSGQUEUE
 = 12,

90 
	#RLIMIT_MSGQUEUE
 
__RLIMIT_MSGQUEUE


	)

95 
	m__RLIMIT_NICE
 = 13,

96 
	#RLIMIT_NICE
 
__RLIMIT_NICE


	)

100 
	m__RLIMIT_RTPRIO
 = 14,

101 
	#RLIMIT_RTPRIO
 
__RLIMIT_RTPRIO


	)

103 
	m__RLIMIT_NLIMITS
 = 15,

104 
	m__RLIM_NLIMITS
 = 
__RLIMIT_NLIMITS


105 
	#RLIMIT_NLIMITS
 
__RLIMIT_NLIMITS


	)

106 
	#RLIM_NLIMITS
 
__RLIM_NLIMITS


	)

110 #iâdeà
__USE_FILE_OFFSET64


111 
	#RLIM_INFINITY
 (()(~0UL))

	)

113 
	#RLIM_INFINITY
 0xffffffffffffffffuLL

	)

116 #ifdeà
__USE_LARGEFILE64


117 
	#RLIM64_INFINITY
 0xffffffffffffffffuLL

	)

121 
	#RLIM_SAVED_MAX
 
RLIM_INFINITY


	)

122 
	#RLIM_SAVED_CUR
 
RLIM_INFINITY


	)

126 #iâdeà
__USE_FILE_OFFSET64


127 
__¾im_t
 
	t¾im_t
;

129 
__¾im64_t
 
	t¾im_t
;

131 #ifdeà
__USE_LARGEFILE64


132 
__¾im64_t
 
	t¾im64_t
;

135 
	s¾im™


138 
¾im_t
 
	m¾im_cur
;

140 
¾im_t
 
	m¾im_max
;

143 #ifdeà
__USE_LARGEFILE64


144 
	s¾im™64


147 
¾im64_t
 
	m¾im_cur
;

149 
¾im64_t
 
	m¾im_max
;

154 
	e__ru§ge_who


157 
	mRUSAGE_SELF
 = 0,

158 
	#RUSAGE_SELF
 
RUSAGE_SELF


	)

161 
	mRUSAGE_CHILDREN
 = -1

162 
	#RUSAGE_CHILDREN
 
RUSAGE_CHILDREN


	)

165 
	#__Ãed_timev®


	)

166 
	~<b™s/time.h
>

169 
	sru§ge


172 
timev®
 
	mru_utime
;

174 
timev®
 
	mru_¡ime
;

176 
	mru_maxrss
;

179 
	mru_ixrss
;

181 
	mru_idrss
;

183 
	mru_i¤ss
;

186 
	mru_mšæt
;

188 
	mru_majæt
;

190 
	mru_nsw­
;

193 
	mru_šblock
;

195 
	mru_oublock
;

197 
	mru_msg¢d
;

199 
	mru_msgrcv
;

201 
	mru_nsigÇls
;

205 
	mru_nvcsw
;

208 
	mru_nivcsw
;

212 
	#PRIO_MIN
 -20

	)

213 
	#PRIO_MAX
 20

	)

217 
	e__´iÜ™y_which


219 
	mPRIO_PROCESS
 = 0,

220 
	#PRIO_PROCESS
 
PRIO_PROCESS


	)

221 
	mPRIO_PGRP
 = 1,

222 
	#PRIO_PGRP
 
PRIO_PGRP


	)

223 
	mPRIO_USER
 = 2

224 
	#PRIO_USER
 
PRIO_USER


	)

	@/usr/include/bits/select.h

19 #iâdeà
_SYS_SELECT_H


26 
	#__FD_ZERO
(
s
) \

28 
__i
; \

29 
fd_£t
 *
__¬r
 = (
s
); \

30 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

31 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

32 } 0)

	)

33 
	#__FD_SET
(
d
, 
s
è(
	`__FDS_BITS
 (s)[
	`__FDELT
(d)] |ğ
	`__FDMASK
(d))

	)

34 
	#__FD_CLR
(
d
, 
s
è(
	`__FDS_BITS
 (s)[
	`__FDELT
(d)] &ğ~
	`__FDMASK
(d))

	)

35 
	#__FD_ISSET
(
d
, 
s
è((
	`__FDS_BITS
 (s)[
	`__FDELT
(d)] & 
	`__FDMASK
(d)è!ğ0)

	)

	@/usr/include/bits/sigaction.h

20 #iâdeà
_SIGNAL_H


25 
	ssigaùiÚ


28 #ifdeà
__USE_POSIX199309


32 
__sighªdËr_t
 
	m§_hªdËr
;

34 (*
	m§_sigaùiÚ
è(, 
	msigšfo_t
 *, *);

36 
	m__sigaùiÚ_hªdËr
;

37 
	#§_hªdËr
 
__sigaùiÚ_hªdËr
.
§_hªdËr


	)

38 
	#§_sigaùiÚ
 
__sigaùiÚ_hªdËr
.
§_sigaùiÚ


	)

40 
__sighªdËr_t
 
	m§_hªdËr
;

44 
__sig£t_t
 
	m§_mask
;

47 
	m§_æags
;

50 (*
	m§_»¡Ü”
) ();

54 
	#SA_NOCLDSTOP
 1

	)

55 
	#SA_NOCLDWAIT
 2

	)

56 
	#SA_SIGINFO
 4

	)

58 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_MISC


59 
	#SA_ONSTACK
 0x08000000

	)

60 
	#SA_RESTART
 0x10000000

	)

61 
	#SA_NODEFER
 0x40000000

	)

63 
	#SA_RESETHAND
 0x80000000

	)

65 #ifdeà
__USE_MISC


66 
	#SA_INTERRUPT
 0x20000000

	)

69 
	#SA_NOMASK
 
SA_NODEFER


	)

70 
	#SA_ONESHOT
 
SA_RESETHAND


	)

71 
	#SA_STACK
 
SA_ONSTACK


	)

75 
	#SIG_BLOCK
 0

	)

76 
	#SIG_UNBLOCK
 1

	)

77 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

19 #iâdeà
_BITS_SIGCONTEXT_H


20 
	#_BITS_SIGCONTEXT_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


26 
	~<b™s/wÜdsize.h
>

28 
	s_å»g


30 
	msignifiÿnd
[4];

31 
	mexpÚ’t
;

34 
	s_åx»g


36 
	msignifiÿnd
[4];

37 
	mexpÚ’t
;

38 
	m·ddšg
[3];

41 
	s_xmm»g


43 
__ušt32_t
 
	m–em’t
[4];

48 #ià
__WORDSIZE
 == 32

50 
	s_å¡©e


53 
__ušt32_t
 
	mcw
;

54 
__ušt32_t
 
	msw
;

55 
__ušt32_t
 
	mg
;

56 
__ušt32_t
 
	moff
;

57 
__ušt32_t
 
	mcs£l
;

58 
__ušt32_t
 
	md©aoff
;

59 
__ušt32_t
 
	md©a£l
;

60 
_å»g
 
	m_¡
[8];

61 
	m¡©us
;

62 
	mmagic
;

65 
__ušt32_t
 
	m_fx¤_’v
[6];

66 
__ušt32_t
 
	mmxc¤
;

67 
__ušt32_t
 
	m»£rved
;

68 
_åx»g
 
	m_fx¤_¡
[8];

69 
_xmm»g
 
	m_xmm
[8];

70 
__ušt32_t
 
	m·ddšg
[56];

73 #iâdeà
sigcÚ‹xt_¡ruù


78 
	#sigcÚ‹xt_¡ruù
 
sigcÚ‹xt


	)

81 
	ssigcÚ‹xt


83 
	mgs
, 
	m__gsh
;

84 
	mfs
, 
	m__fsh
;

85 
	mes
, 
	m__esh
;

86 
	mds
, 
	m__dsh
;

87 
	medi
;

88 
	mesi
;

89 
	mebp
;

90 
	me¥
;

91 
	mebx
;

92 
	medx
;

93 
	mecx
;

94 
	m—x
;

95 
	mŒ­no
;

96 
	m”r
;

97 
	me
;

98 
	mcs
, 
	m__csh
;

99 
	meæags
;

100 
	me¥_©_sigÇl
;

101 
	mss
, 
	m__ssh
;

102 
_å¡©e
 * 
	må¡©e
;

103 
	mŞdmask
;

104 
	mü2
;

109 
	s_å¡©e


112 
__ušt16_t
 
	mcwd
;

113 
__ušt16_t
 
	mswd
;

114 
__ušt16_t
 
	máw
;

115 
__ušt16_t
 
	mfİ
;

116 
__ušt64_t
 
	mr
;

117 
__ušt64_t
 
	mrdp
;

118 
__ušt32_t
 
	mmxc¤
;

119 
__ušt32_t
 
	mmxü_mask
;

120 
_åx»g
 
	m_¡
[8];

121 
_xmm»g
 
	m_xmm
[16];

122 
__ušt32_t
 
	m·ddšg
[24];

125 
	ssigcÚ‹xt


127 
	mr8
;

128 
	mr9
;

129 
	mr10
;

130 
	mr11
;

131 
	mr12
;

132 
	mr13
;

133 
	mr14
;

134 
	mr15
;

135 
	mrdi
;

136 
	mrsi
;

137 
	mrbp
;

138 
	mrbx
;

139 
	mrdx
;

140 
	m¿x
;

141 
	mrcx
;

142 
	mr¥
;

143 
	mr
;

144 
	meæags
;

145 
	mcs
;

146 
	mgs
;

147 
	mfs
;

148 
	m__·d0
;

149 
	m”r
;

150 
	mŒ­no
;

151 
	mŞdmask
;

152 
	mü2
;

153 
_å¡©e
 * 
	må¡©e
;

154 
	m__»£rved1
 [8];

	@/usr/include/bits/siginfo.h

20 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
__Ãed_sigšfo_t
 \

21 && !
defšed
 
	g__Ãed_sigev’t_t


25 
	~<b™s/wÜdsize.h
>

27 #ià(!
defšed
 
__have_sigv®_t
 \

28 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
 \

29 || 
defšed
 
	g__Ãed_sigev’t_t
))

30 
	#__have_sigv®_t
 1

	)

33 
	usigv®


35 
	msiv®_št
;

36 *
	msiv®_±r
;

37 } 
	tsigv®_t
;

40 #ià(!
defšed
 
__have_sigšfo_t
 \

41 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
))

42 
	#__have_sigšfo_t
 1

	)

44 
	#__SI_MAX_SIZE
 128

	)

45 #ià
__WORDSIZE
 == 64

46 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 4)

	)

48 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 3)

	)

51 
	ssigšfo


53 
	msi_signo
;

54 
	msi_”ºo
;

56 
	msi_code
;

60 
	m_·d
[
__SI_PAD_SIZE
];

65 
__pid_t
 
	msi_pid
;

66 
__uid_t
 
	msi_uid
;

67 } 
	m_kl
;

72 
	msi_tid
;

73 
	msi_ov”run
;

74 
sigv®_t
 
	msi_sigv®
;

75 } 
	m_tim”
;

80 
__pid_t
 
	msi_pid
;

81 
__uid_t
 
	msi_uid
;

82 
sigv®_t
 
	msi_sigv®
;

83 } 
	m_¹
;

88 
__pid_t
 
	msi_pid
;

89 
__uid_t
 
	msi_uid
;

90 
	msi_¡©us
;

91 
__şock_t
 
	msi_utime
;

92 
__şock_t
 
	msi_¡ime
;

93 } 
	m_sigchld
;

98 *
	msi_addr
;

99 } 
	m_sigçuÉ
;

104 
	msi_bªd
;

105 
	msi_fd
;

106 } 
	m_sigpŞl
;

107 } 
	m_sif›lds
;

108 } 
	tsigšfo_t
;

112 
	#si_pid
 
_sif›lds
.
_kl
.
si_pid


	)

113 
	#si_uid
 
_sif›lds
.
_kl
.
si_uid


	)

114 
	#si_tim”id
 
_sif›lds
.
_tim”
.
si_tid


	)

115 
	#si_ov”run
 
_sif›lds
.
_tim”
.
si_ov”run


	)

116 
	#si_¡©us
 
_sif›lds
.
_sigchld
.
si_¡©us


	)

117 
	#si_utime
 
_sif›lds
.
_sigchld
.
si_utime


	)

118 
	#si_¡ime
 
_sif›lds
.
_sigchld
.
si_¡ime


	)

119 
	#si_v®ue
 
_sif›lds
.
_¹
.
si_sigv®


	)

120 
	#si_št
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_št


	)

121 
	#si_±r
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_±r


	)

122 
	#si_addr
 
_sif›lds
.
_sigçuÉ
.
si_addr


	)

123 
	#si_bªd
 
_sif›lds
.
_sigpŞl
.
si_bªd


	)

124 
	#si_fd
 
_sif›lds
.
_sigpŞl
.
si_fd


	)

131 
	mSI_ASYNCNL
 = -60,

132 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

133 
	mSI_TKILL
 = -6,

134 
	#SI_TKILL
 
SI_TKILL


	)

135 
	mSI_SIGIO
,

136 
	#SI_SIGIO
 
SI_SIGIO


	)

137 
	mSI_ASYNCIO
,

138 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

139 
	mSI_MESGQ
,

140 
	#SI_MESGQ
 
SI_MESGQ


	)

141 
	mSI_TIMER
,

142 
	#SI_TIMER
 
SI_TIMER


	)

143 
	mSI_QUEUE
,

144 
	#SI_QUEUE
 
SI_QUEUE


	)

145 
	mSI_USER
,

146 
	#SI_USER
 
SI_USER


	)

147 
	mSI_KERNEL
 = 0x80

148 
	#SI_KERNEL
 
SI_KERNEL


	)

155 
	mILL_ILLOPC
 = 1,

156 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

157 
	mILL_ILLOPN
,

158 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

159 
	mILL_ILLADR
,

160 
	#ILL_ILLADR
 
ILL_ILLADR


	)

161 
	mILL_ILLTRP
,

162 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

163 
	mILL_PRVOPC
,

164 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

165 
	mILL_PRVREG
,

166 
	#ILL_PRVREG
 
ILL_PRVREG


	)

167 
	mILL_COPROC
,

168 
	#ILL_COPROC
 
ILL_COPROC


	)

169 
	mILL_BADSTK


170 
	#ILL_BADSTK
 
ILL_BADSTK


	)

176 
	mFPE_INTDIV
 = 1,

177 
	#FPE_INTDIV
 
FPE_INTDIV


	)

178 
	mFPE_INTOVF
,

179 
	#FPE_INTOVF
 
FPE_INTOVF


	)

180 
	mFPE_FLTDIV
,

181 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

182 
	mFPE_FLTOVF
,

183 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

184 
	mFPE_FLTUND
,

185 
	#FPE_FLTUND
 
FPE_FLTUND


	)

186 
	mFPE_FLTRES
,

187 
	#FPE_FLTRES
 
FPE_FLTRES


	)

188 
	mFPE_FLTINV
,

189 
	#FPE_FLTINV
 
FPE_FLTINV


	)

190 
	mFPE_FLTSUB


191 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

197 
	mSEGV_MAPERR
 = 1,

198 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

199 
	mSEGV_ACCERR


200 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

206 
	mBUS_ADRALN
 = 1,

207 
	#BUS_ADRALN
 
BUS_ADRALN


	)

208 
	mBUS_ADRERR
,

209 
	#BUS_ADRERR
 
BUS_ADRERR


	)

210 
	mBUS_OBJERR


211 
	#BUS_OBJERR
 
BUS_OBJERR


	)

217 
	mTRAP_BRKPT
 = 1,

218 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

219 
	mTRAP_TRACE


220 
	#TRAP_TRACE
 
TRAP_TRACE


	)

226 
	mCLD_EXITED
 = 1,

227 
	#CLD_EXITED
 
CLD_EXITED


	)

228 
	mCLD_KILLED
,

229 
	#CLD_KILLED
 
CLD_KILLED


	)

230 
	mCLD_DUMPED
,

231 
	#CLD_DUMPED
 
CLD_DUMPED


	)

232 
	mCLD_TRAPPED
,

233 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

234 
	mCLD_STOPPED
,

235 
	#CLD_STOPPED
 
CLD_STOPPED


	)

236 
	mCLD_CONTINUED


237 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

243 
	mPOLL_IN
 = 1,

244 
	#POLL_IN
 
POLL_IN


	)

245 
	mPOLL_OUT
,

246 
	#POLL_OUT
 
POLL_OUT


	)

247 
	mPOLL_MSG
,

248 
	#POLL_MSG
 
POLL_MSG


	)

249 
	mPOLL_ERR
,

250 
	#POLL_ERR
 
POLL_ERR


	)

251 
	mPOLL_PRI
,

252 
	#POLL_PRI
 
POLL_PRI


	)

253 
	mPOLL_HUP


254 
	#POLL_HUP
 
POLL_HUP


	)

257 #undeà
__Ãed_sigšfo_t


261 #ià(
defšed
 
_SIGNAL_H
 || defšed 
__Ãed_sigev’t_t
) \

262 && !
defšed
 
	g__have_sigev’t_t


263 
	#__have_sigev’t_t
 1

	)

266 
	#__SIGEV_MAX_SIZE
 64

	)

267 #ià
__WORDSIZE
 == 64

268 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 4)

	)

270 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 3)

	)

273 
	ssigev’t


275 
sigv®_t
 
	msigev_v®ue
;

276 
	msigev_signo
;

277 
	msigev_nÙify
;

281 
	m_·d
[
__SIGEV_PAD_SIZE
];

285 
__pid_t
 
	m_tid
;

289 (*
	m_funùiÚ
è(
	msigv®_t
);

290 *
	m_©Œibu‹
;

291 } 
	m_sigev_th»ad
;

292 } 
	m_sigev_un
;

293 } 
	tsigev’t_t
;

296 
	#sigev_nÙify_funùiÚ
 
_sigev_un
.
_sigev_th»ad
.
_funùiÚ


	)

297 
	#sigev_nÙify_©Œibu‹s
 
_sigev_un
.
_sigev_th»ad
.
_©Œibu‹


	)

302 
	mSIGEV_SIGNAL
 = 0,

303 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

304 
	mSIGEV_NONE
,

305 
	#SIGEV_NONE
 
SIGEV_NONE


	)

306 
	mSIGEV_THREAD
,

307 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

309 
	mSIGEV_THREAD_ID
 = 4

310 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/signum.h

20 #ifdef 
_SIGNAL_H


23 
	#SIG_ERR
 ((
__sighªdËr_t
è-1è

	)

24 
	#SIG_DFL
 ((
__sighªdËr_t
è0è

	)

25 
	#SIG_IGN
 ((
__sighªdËr_t
è1è

	)

27 #ifdeà
__USE_UNIX98


28 
	#SIG_HOLD
 ((
__sighªdËr_t
è2è

	)

33 
	#SIGHUP
 1

	)

34 
	#SIGINT
 2

	)

35 
	#SIGQUIT
 3

	)

36 
	#SIGILL
 4

	)

37 
	#SIGTRAP
 5

	)

38 
	#SIGABRT
 6

	)

39 
	#SIGIOT
 6

	)

40 
	#SIGBUS
 7

	)

41 
	#SIGFPE
 8

	)

42 
	#SIGKILL
 9

	)

43 
	#SIGUSR1
 10

	)

44 
	#SIGSEGV
 11

	)

45 
	#SIGUSR2
 12

	)

46 
	#SIGPIPE
 13

	)

47 
	#SIGALRM
 14

	)

48 
	#SIGTERM
 15

	)

49 
	#SIGSTKFLT
 16

	)

50 
	#SIGCLD
 
SIGCHLD


	)

51 
	#SIGCHLD
 17

	)

52 
	#SIGCONT
 18

	)

53 
	#SIGSTOP
 19

	)

54 
	#SIGTSTP
 20

	)

55 
	#SIGTTIN
 21

	)

56 
	#SIGTTOU
 22

	)

57 
	#SIGURG
 23

	)

58 
	#SIGXCPU
 24

	)

59 
	#SIGXFSZ
 25

	)

60 
	#SIGVTALRM
 26

	)

61 
	#SIGPROF
 27

	)

62 
	#SIGWINCH
 28

	)

63 
	#SIGPOLL
 
SIGIO


	)

64 
	#SIGIO
 29

	)

65 
	#SIGPWR
 30

	)

66 
	#SIGSYS
 31

	)

67 
	#SIGUNUSED
 31

	)

69 
	#_NSIG
 65

	)

72 
	#SIGRTMIN
 (
	`__libc_cu¼’t_sig¹mš
 ())

	)

73 
	#SIGRTMAX
 (
	`__libc_cu¼’t_sig¹max
 ())

	)

77 
	#__SIGRTMIN
 32

	)

78 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigset.h

21 #iâdef 
_SIGSET_H_ty³s


22 
	#_SIGSET_H_ty³s
 1

	)

24 
	t__sig_©omic_t
;

28 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

31 
	m__v®
[
_SIGSET_NWORDS
];

32 } 
	t__sig£t_t
;

43 #ià!
defšed
 
_SIGSET_H_âs
 && defšed 
_SIGNAL_H


44 
	#_SIGSET_H_âs
 1

	)

46 #iâdeà
_EXTERN_INLINE


47 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

51 
	#__sigmask
(
sig
) \

52 (((è1è<< (((
sig
è- 1è% (8 *  ())))

	)

55 
	#__sigwÜd
(
sig
è(((sigè- 1è/ (8 *  ()))

	)

57 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

58 
	#__sigem±y£t
(
£t
) \

59 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

60 
sig£t_t
 *
__£t
 = (
£t
); \

61 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = 0; \

62 0; }))

	)

63 
	#__sigfl£t
(
£t
) \

64 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

65 
sig£t_t
 *
__£t
 = (
£t
); \

66 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = ~0UL; \

67 0; }))

	)

69 #ifdeà
__USE_GNU


73 
	#__sigi£m±y£t
(
£t
) \

74 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

75 cÚ¡ 
sig£t_t
 *
__£t
 = (
£t
); \

76 
__»t
 = 
__£t
->
__v®
[--
__út
]; \

77 !
__»t
 && --
__út
 >= 0) \

78 
__»t
 = 
__£t
->
__v®
[
__út
]; \

79 
__»t
 =ğ0; }))

	)

80 
	#__sigªd£t
(
de¡
, 
Ëá
, 
right
) \

81 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

82 
sig£t_t
 *
__de¡
 = (
de¡
); \

83 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

84 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

85 --
__út
 >= 0) \

86 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

87 & 
__right
->
__v®
[
__út
]); \

88 0; }))

	)

89 
	#__sigÜ£t
(
de¡
, 
Ëá
, 
right
) \

90 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

91 
sig£t_t
 *
__de¡
 = (
de¡
); \

92 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

93 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

94 --
__út
 >= 0) \

95 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

96 | 
__right
->
__v®
[
__út
]); \

97 0; }))

	)

104 
__sigismemb”
 (
__cÚ¡
 
__sig£t_t
 *, );

105 
__sigadd£t
 (
__sig£t_t
 *, );

106 
__sigd–£t
 (
__sig£t_t
 *, );

108 #ifdeà
__USE_EXTERN_INLINES


109 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

110 
_EXTERN_INLINE
 \

111 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

113 
__mask
 = 
	`__sigmask
 (
__sig
); \

114 
__wÜd
 = 
	`__sigwÜd
 (
__sig
); \

115  
BODY
; \

116 }

	)

118 
__SIGSETFN
 (
__sigismemb”
, (
__£t
->
__v®
[
__wÜd
] & 
__mask
è? 1 : 0, 
__cÚ¡
)

119 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__v®
[
__wÜd
] |ğ
__mask
), 0), )

120 
__SIGSETFN
 (
__sigd–£t
, ((
__£t
->
__v®
[
__wÜd
] &ğ~
__mask
), 0), )

122 #undeà
__SIGSETFN


	@/usr/include/bits/sigstack.h

20 #iâdeà
_SIGNAL_H


26 
	ssig¡ack


28 *
	mss_¥
;

29 
	mss_Ú¡ack
;

36 
	mSS_ONSTACK
 = 1,

37 
	#SS_ONSTACK
 
SS_ONSTACK


	)

38 
	mSS_DISABLE


39 
	#SS_DISABLE
 
SS_DISABLE


	)

43 
	#MINSIGSTKSZ
 2048

	)

46 
	#SIGSTKSZ
 8192

	)

50 
	ssig®t¡ack


52 *
	mss_¥
;

53 
	mss_æags
;

54 
size_t
 
	mss_size
;

55 } 
	t¡ack_t
;

	@/usr/include/bits/sigthread.h

20 #iâdeà
_BITS_SIGTHREAD_H


21 
	#_BITS_SIGTHREAD_H
 1

	)

23 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_PTHREAD_H


31 
	$±h»ad_sigmask
 (
__how
,

32 
__cÚ¡
 
__sig£t_t
 *
__»¡riù
 
__Ãwmask
,

33 
__sig£t_t
 *
__»¡riù
 
__Şdmask
)
__THROW
;

36 
	$±h»ad_kl
 (
±h»ad_t
 
__th»adid
, 
__signo
è
__THROW
;

	@/usr/include/bits/socket.h

21 #iâdeà
__BITS_SOCKET_H


22 
	#__BITS_SOCKET_H


	)

24 #iâdeà
_SYS_SOCKET_H


28 
	#__Ãed_size_t


	)

29 
	#__Ãed_NULL


	)

30 
	~<¡ddef.h
>

32 
	~<lim™s.h
>

33 
	~<sys/ty³s.h
>

36 #iâdeà
__sockËn_t_defšed


37 
__sockËn_t
 
	tsockËn_t
;

38 
	#__sockËn_t_defšed


	)

42 
	e__sock‘_ty³


44 
	mSOCK_STREAM
 = 1,

46 
	#SOCK_STREAM
 
SOCK_STREAM


	)

47 
	mSOCK_DGRAM
 = 2,

49 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

50 
	mSOCK_RAW
 = 3,

51 
	#SOCK_RAW
 
SOCK_RAW


	)

52 
	mSOCK_RDM
 = 4,

53 
	#SOCK_RDM
 
SOCK_RDM


	)

54 
	mSOCK_SEQPACKET
 = 5,

56 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

57 
	mSOCK_PACKET
 = 10

60 
	#SOCK_PACKET
 
SOCK_PACKET


	)

64 
	#PF_UNSPEC
 0

	)

65 
	#PF_LOCAL
 1

	)

66 
	#PF_UNIX
 
PF_LOCAL


	)

67 
	#PF_FILE
 
PF_LOCAL


	)

68 
	#PF_INET
 2

	)

69 
	#PF_AX25
 3

	)

70 
	#PF_IPX
 4

	)

71 
	#PF_APPLETALK
 5

	)

72 
	#PF_NETROM
 6

	)

73 
	#PF_BRIDGE
 7

	)

74 
	#PF_ATMPVC
 8

	)

75 
	#PF_X25
 9

	)

76 
	#PF_INET6
 10

	)

77 
	#PF_ROSE
 11

	)

78 
	#PF_DECÃt
 12

	)

79 
	#PF_NETBEUI
 13

	)

80 
	#PF_SECURITY
 14

	)

81 
	#PF_KEY
 15

	)

82 
	#PF_NETLINK
 16

	)

83 
	#PF_ROUTE
 
PF_NETLINK


	)

84 
	#PF_PACKET
 17

	)

85 
	#PF_ASH
 18

	)

86 
	#PF_ECONET
 19

	)

87 
	#PF_ATMSVC
 20

	)

88 
	#PF_SNA
 22

	)

89 
	#PF_IRDA
 23

	)

90 
	#PF_PPPOX
 24

	)

91 
	#PF_WANPIPE
 25

	)

92 
	#PF_BLUETOOTH
 31

	)

93 
	#PF_IUCV
 32

	)

94 
	#PF_RXRPC
 33

	)

95 
	#PF_MAX
 34

	)

98 
	#AF_UNSPEC
 
PF_UNSPEC


	)

99 
	#AF_LOCAL
 
PF_LOCAL


	)

100 
	#AF_UNIX
 
PF_UNIX


	)

101 
	#AF_FILE
 
PF_FILE


	)

102 
	#AF_INET
 
PF_INET


	)

103 
	#AF_AX25
 
PF_AX25


	)

104 
	#AF_IPX
 
PF_IPX


	)

105 
	#AF_APPLETALK
 
PF_APPLETALK


	)

106 
	#AF_NETROM
 
PF_NETROM


	)

107 
	#AF_BRIDGE
 
PF_BRIDGE


	)

108 
	#AF_ATMPVC
 
PF_ATMPVC


	)

109 
	#AF_X25
 
PF_X25


	)

110 
	#AF_INET6
 
PF_INET6


	)

111 
	#AF_ROSE
 
PF_ROSE


	)

112 
	#AF_DECÃt
 
PF_DECÃt


	)

113 
	#AF_NETBEUI
 
PF_NETBEUI


	)

114 
	#AF_SECURITY
 
PF_SECURITY


	)

115 
	#AF_KEY
 
PF_KEY


	)

116 
	#AF_NETLINK
 
PF_NETLINK


	)

117 
	#AF_ROUTE
 
PF_ROUTE


	)

118 
	#AF_PACKET
 
PF_PACKET


	)

119 
	#AF_ASH
 
PF_ASH


	)

120 
	#AF_ECONET
 
PF_ECONET


	)

121 
	#AF_ATMSVC
 
PF_ATMSVC


	)

122 
	#AF_SNA
 
PF_SNA


	)

123 
	#AF_IRDA
 
PF_IRDA


	)

124 
	#AF_PPPOX
 
PF_PPPOX


	)

125 
	#AF_WANPIPE
 
PF_WANPIPE


	)

126 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

127 
	#AF_IUCV
 
PF_IUCV


	)

128 
	#AF_RXRPC
 
PF_RXRPC


	)

129 
	#AF_MAX
 
PF_MAX


	)

135 
	#SOL_RAW
 255

	)

136 
	#SOL_DECNET
 261

	)

137 
	#SOL_X25
 262

	)

138 
	#SOL_PACKET
 263

	)

139 
	#SOL_ATM
 264

	)

140 
	#SOL_AAL
 265

	)

141 
	#SOL_IRDA
 266

	)

144 
	#SOMAXCONN
 128

	)

147 
	~<b™s/sockaddr.h
>

150 
	ssockaddr


152 
__SOCKADDR_COMMON
 (
§_
);

153 
	m§_d©a
[14];

159 #ià
ULONG_MAX
 > 0xffffffff

160 
	#__ss_®igÁy³
 
__ušt64_t


	)

162 
	#__ss_®igÁy³
 
__ušt32_t


	)

164 
	#_SS_SIZE
 128

	)

165 
	#_SS_PADSIZE
 (
_SS_SIZE
 - (2 *  (
__ss_®igÁy³
)))

	)

167 
	ssockaddr_¡Üage


169 
__SOCKADDR_COMMON
 (
ss_
);

170 
__ss_®igÁy³
 
	m__ss_®ign
;

171 
	m__ss_·ddšg
[
_SS_PADSIZE
];

178 
	mMSG_OOB
 = 0x01,

179 
	#MSG_OOB
 
MSG_OOB


	)

180 
	mMSG_PEEK
 = 0x02,

181 
	#MSG_PEEK
 
MSG_PEEK


	)

182 
	mMSG_DONTROUTE
 = 0x04,

183 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

184 #ifdeà
__USE_GNU


186 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

187 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

189 
	mMSG_CTRUNC
 = 0x08,

190 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

191 
	mMSG_PROXY
 = 0x10,

192 
	#MSG_PROXY
 
MSG_PROXY


	)

193 
	mMSG_TRUNC
 = 0x20,

194 
	#MSG_TRUNC
 
MSG_TRUNC


	)

195 
	mMSG_DONTWAIT
 = 0x40,

196 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

197 
	mMSG_EOR
 = 0x80,

198 
	#MSG_EOR
 
MSG_EOR


	)

199 
	mMSG_WAITALL
 = 0x100,

200 
	#MSG_WAITALL
 
MSG_WAITALL


	)

201 
	mMSG_FIN
 = 0x200,

202 
	#MSG_FIN
 
MSG_FIN


	)

203 
	mMSG_SYN
 = 0x400,

204 
	#MSG_SYN
 
MSG_SYN


	)

205 
	mMSG_CONFIRM
 = 0x800,

206 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

207 
	mMSG_RST
 = 0x1000,

208 
	#MSG_RST
 
MSG_RST


	)

209 
	mMSG_ERRQUEUE
 = 0x2000,

210 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

211 
	mMSG_NOSIGNAL
 = 0x4000,

212 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

213 
	mMSG_MORE
 = 0x8000,

214 
	#MSG_MORE
 
MSG_MORE


	)

216 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

219 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

225 
	smsghdr


227 *
	mmsg_Çme
;

228 
sockËn_t
 
	mmsg_Çm–’
;

230 
iovec
 *
	mmsg_iov
;

231 
size_t
 
	mmsg_iovËn
;

233 *
	mmsg_cÚŒŞ
;

234 
size_t
 
	mmsg_cÚŒŞËn
;

239 
	mmsg_æags
;

243 
	scmsghdr


245 
size_t
 
	mcmsg_Ën
;

250 
	mcmsg_Ëv–
;

251 
	mcmsg_ty³
;

252 #ià(!
defšed
 
__STRICT_ANSI__
 && 
__GNUC__
 >ğ2è|| 
__STDC_VERSION__
 >= 199901L

253 
__ex‹nsiÚ__
 
__cmsg_d©a
 
	m__æex¬r
;

258 #ià(!
defšed
 
__STRICT_ANSI__
 && 
__GNUC__
 >ğ2è|| 
__STDC_VERSION__
 >= 199901L

259 
	#CMSG_DATA
(
cmsg
è((cmsg)->
__cmsg_d©a
)

	)

261 
	#CMSG_DATA
(
cmsg
è((*è((
cmsghdr
 *è(cmsgè+ 1))

	)

263 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
è
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

264 
	#CMSG_FIRSTHDR
(
mhdr
) \

265 ((
size_t
è(
mhdr
)->
msg_cÚŒŞËn
 >ğ (
cmsghdr
) \

266 ? (
cmsghdr
 *è(
mhdr
)->
msg_cÚŒŞ
 : (cmsghd¸*è
NULL
)

	)

267 
	#CMSG_ALIGN
(
Ën
è((Ö’è+  (
size_t
) - 1) \

268 & (
size_t
è~( (size_tè- 1))

	)

269 
	#CMSG_SPACE
(
Ën
è(
	`CMSG_ALIGN
 (len) \

270 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

271 
	#CMSG_LEN
(
Ën
è(
	`CMSG_ALIGN
 ( (
cmsghdr
)è+ (Ën))

	)

273 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

274 
cmsghdr
 *
__cmsg
è
__THROW
;

275 #ifdeà
__USE_EXTERN_INLINES


276 #iâdeà
_EXTERN_INLINE


277 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

279 
_EXTERN_INLINE
 
cmsghdr
 *

280 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

282 ià((
size_t
è
__cmsg
->
cmsg_Ën
 <  (
cmsghdr
))

286 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

287 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Ën
));

288 ià((*è(
__cmsg
 + 1è> ((*è
__mhdr
->
msg_cÚŒŞ


289 + 
__mhdr
->
msg_cÚŒŞËn
)

290 || ((*è
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Ën
)

291 > ((*è
__mhdr
->
msg_cÚŒŞ
 + __mhdr->
msg_cÚŒŞËn
)))

294  
__cmsg
;

295 
	}
}

302 
	mSCM_RIGHTS
 = 0x01

303 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

304 #ifdeà
__USE_BSD


305 , 
	mSCM_CREDENTIALS
 = 0x02

306 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

312 
	suüed


314 
pid_t
 
	mpid
;

315 
uid_t
 
	muid
;

316 
gid_t
 
	mgid
;

320 
	~<asm/sock‘.h
>

324 
	slšg”


326 
	ml_Úoff
;

327 
	ml_lšg”
;

	@/usr/include/bits/socket2.h

20 #iâdeà
_SYS_SOCKET_H


24 
ssize_t
 
__»cv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

25 
__æags
);

26 
ssize_t
 
__REDIRECT
 (
__»cv_®Ÿs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

27 
__æags
), 
»cv
);

28 
ssize_t
 
__REDIRECT
 (
__»cv_chk_w¬n
,

29 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

30 
__æags
), 
__»cv_chk
)

31 
__w¬Ç‰r
 ("recv called with bigger†engthhan size of destination "

34 
__ex‹º_®ways_šlše
 
ssize_t


35 
	$»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
)

37 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

39 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

40  
	`__»cv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

42 ià(
__n
 > 
	`__bos0
 (
__buf
))

43  
	`__»cv_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

45  
	`__»cv_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
);

46 
	}
}

48 
ssize_t
 
__»cväom_chk
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

49 
size_t
 
__buæ’
, 
__æags
,

50 
__SOCKADDR_ARG
 
__addr
,

51 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

52 
ssize_t
 
__REDIRECT
 (
__»cväom_®Ÿs
,

53 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

54 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

55 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
»cväom
);

56 
ssize_t
 
__REDIRECT
 (
__»cväom_chk_w¬n
,

57 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

58 
size_t
 
__buæ’
, 
__æags
,

59 
__SOCKADDR_ARG
 
__addr
,

60 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
__»cväom_chk
)

61 
__w¬Ç‰r
 ("recvfrom called with bigger†engthhan size of "

64 
__ex‹º_®ways_šlše
 
ssize_t


65 
	$»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
, 
__æags
,

66 
__SOCKADDR_ARG
 
__addr
, 
sockËn_t
 *
__»¡riù
 
__addr_Ën
)

68 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

70 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

71  
	`__»cväom_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

72 
__addr
, 
__addr_Ën
);

73 ià(
__n
 > 
	`__bos0
 (
__buf
))

74  
	`__»cväom_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

75 
__addr
, 
__addr_Ën
);

77  
	`__»cväom_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
, 
__addr
, 
__addr_Ën
);

78 
	}
}

	@/usr/include/bits/stat.h

19 #iâdeà
_SYS_STAT_H


24 
	#_STAT_VER_KERNEL
 0

	)

26 #ià
__WORDSIZE
 == 32

27 
	#_STAT_VER_SVR4
 2

	)

28 
	#_STAT_VER_LINUX
 3

	)

31 
	#_MKNOD_VER_LINUX
 1

	)

32 
	#_MKNOD_VER_SVR4
 2

	)

33 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

35 
	#_STAT_VER_LINUX
 1

	)

38 
	#_MKNOD_VER_LINUX
 0

	)

41 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

43 
	s¡©


45 
__dev_t
 
	m¡_dev
;

46 #ià
__WORDSIZE
 == 32

47 
	m__·d1
;

49 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


50 
__šo_t
 
	m¡_šo
;

52 
__šo_t
 
	m__¡_šo
;

54 #ià
__WORDSIZE
 == 32

55 
__mode_t
 
	m¡_mode
;

56 
__Æšk_t
 
	m¡_Æšk
;

58 
__Æšk_t
 
	m¡_Æšk
;

59 
__mode_t
 
	m¡_mode
;

61 
__uid_t
 
	m¡_uid
;

62 
__gid_t
 
	m¡_gid
;

63 #ià
__WORDSIZE
 == 64

64 
	m·d0
;

66 
__dev_t
 
	m¡_rdev
;

67 #ià
__WORDSIZE
 == 32

68 
	m__·d2
;

70 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


71 
__off_t
 
	m¡_size
;

73 
__off64_t
 
	m¡_size
;

75 
__blksize_t
 
	m¡_blksize
;

76 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


77 
__blkút_t
 
	m¡_blocks
;

79 
__blkút64_t
 
	m¡_blocks
;

81 #ifdeà
__USE_MISC


88 
time¥ec
 
	m¡_©im
;

89 
time¥ec
 
	m¡_mtim
;

90 
time¥ec
 
	m¡_ùim
;

91 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

92 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

93 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

95 
__time_t
 
	m¡_©ime
;

96 
	m¡_©im’£c
;

97 
__time_t
 
	m¡_mtime
;

98 
	m¡_mtim’£c
;

99 
__time_t
 
	m¡_ùime
;

100 
	m¡_ùim’£c
;

102 #ià
__WORDSIZE
 == 64

103 
	m__unu£d
[3];

105 #iâdeà
__USE_FILE_OFFSET64


106 
	m__unu£d4
;

107 
	m__unu£d5
;

109 
__šo64_t
 
	m¡_šo
;

114 #ifdeà
__USE_LARGEFILE64


116 
	s¡©64


118 
__dev_t
 
	m¡_dev
;

119 #ià
__WORDSIZE
 == 64

120 
__šo64_t
 
	m¡_šo
;

121 
__Æšk_t
 
	m¡_Æšk
;

122 
__mode_t
 
	m¡_mode
;

124 
	m__·d1
;

125 
__šo_t
 
	m__¡_šo
;

126 
__mode_t
 
	m¡_mode
;

127 
__Æšk_t
 
	m¡_Æšk
;

129 
__uid_t
 
	m¡_uid
;

130 
__gid_t
 
	m¡_gid
;

131 #ià
__WORDSIZE
 == 64

132 
	m·d0
;

133 
__dev_t
 
	m¡_rdev
;

134 
__off_t
 
	m¡_size
;

136 
__dev_t
 
	m¡_rdev
;

137 
	m__·d2
;

138 
__off64_t
 
	m¡_size
;

140 
__blksize_t
 
	m¡_blksize
;

141 
__blkút64_t
 
	m¡_blocks
;

142 #ifdeà
__USE_MISC


149 
time¥ec
 
	m¡_©im
;

150 
time¥ec
 
	m¡_mtim
;

151 
time¥ec
 
	m¡_ùim
;

152 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

153 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

154 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

156 
__time_t
 
	m¡_©ime
;

157 
	m¡_©im’£c
;

158 
__time_t
 
	m¡_mtime
;

159 
	m¡_mtim’£c
;

160 
__time_t
 
	m¡_ùime
;

161 
	m¡_ùim’£c
;

163 #ià
__WORDSIZE
 == 64

164 
	m__unu£d
[3];

166 
__šo64_t
 
	m¡_šo
;

172 
	#_STATBUF_ST_BLKSIZE


	)

173 
	#_STATBUF_ST_RDEV


	)

175 
	#_STATBUF_ST_NSEC


	)

179 
	#__S_IFMT
 0170000

	)

182 
	#__S_IFDIR
 0040000

	)

183 
	#__S_IFCHR
 0020000

	)

184 
	#__S_IFBLK
 0060000

	)

185 
	#__S_IFREG
 0100000

	)

186 
	#__S_IFIFO
 0010000

	)

187 
	#__S_IFLNK
 0120000

	)

188 
	#__S_IFSOCK
 0140000

	)

192 
	#__S_TYPEISMQ
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

193 
	#__S_TYPEISSEM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

194 
	#__S_TYPEISSHM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

198 
	#__S_ISUID
 04000

	)

199 
	#__S_ISGID
 02000

	)

200 
	#__S_ISVTX
 01000

	)

201 
	#__S_IREAD
 0400

	)

202 
	#__S_IWRITE
 0200

	)

203 
	#__S_IEXEC
 0100

	)

205 #ià
defšed
 
__USE_ATFILE
 || defšed 
__USE_GNU


207 
	#UTIME_NOW
 ((1È<< 30è- 1l)

	)

208 
	#UTIME_OMIT
 ((1È<< 30è- 2l)

	)

	@/usr/include/bits/stdio-ldbl.h

20 #iâdeà
_STDIO_H


24 
__BEGIN_NAMESPACE_STD


25 
	$__LDBL_REDIR_DECL
 (
årštf
)

26 
	$__LDBL_REDIR_DECL
 (
´štf
)

27 
	$__LDBL_REDIR_DECL
 (
¥rštf
)

28 
	$__LDBL_REDIR_DECL
 (
vårštf
)

29 
	$__LDBL_REDIR_DECL
 (
v´štf
)

30 
	$__LDBL_REDIR_DECL
 (
v¥rštf
)

31 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

32 && !
defšed
 
__REDIRECT
 \

33 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

34 
	$__LDBL_REDIR1_DECL
 (
fsÿnf
, 
__Ædbl___isoc99_fsÿnf
)

35 
	$__LDBL_REDIR1_DECL
 (
sÿnf
, 
__Ædbl___isoc99_sÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
ssÿnf
, 
__Ædbl___isoc99_ssÿnf
)

38 
	$__LDBL_REDIR_DECL
 (
fsÿnf
)

39 
	$__LDBL_REDIR_DECL
 (
sÿnf
)

40 
	$__LDBL_REDIR_DECL
 (
ssÿnf
)

42 
__END_NAMESPACE_STD


44 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


45 
__BEGIN_NAMESPACE_C99


46 
	$__LDBL_REDIR_DECL
 (
¢´štf
)

47 
	$__LDBL_REDIR_DECL
 (
v¢´štf
)

48 
__END_NAMESPACE_C99


51 #ifdef 
__USE_ISOC99


52 
__BEGIN_NAMESPACE_C99


53 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

54 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

55 
	$__LDBL_REDIR1_DECL
 (
vfsÿnf
, 
__Ædbl___isoc99_vfsÿnf
)

56 
	$__LDBL_REDIR1_DECL
 (
vsÿnf
, 
__Ædbl___isoc99_vsÿnf
)

57 
	$__LDBL_REDIR1_DECL
 (
vssÿnf
, 
__Ædbl___isoc99_vssÿnf
)

59 
	$__LDBL_REDIR_DECL
 (
vfsÿnf
)

60 
	$__LDBL_REDIR_DECL
 (
vssÿnf
)

61 
	$__LDBL_REDIR_DECL
 (
vsÿnf
)

63 
__END_NAMESPACE_C99


66 #ifdeà
__USE_GNU


67 
	$__LDBL_REDIR_DECL
 (
vd´štf
)

68 
	$__LDBL_REDIR_DECL
 (
d´štf
)

69 
	$__LDBL_REDIR_DECL
 (
va¥rštf
)

70 
	$__LDBL_REDIR_DECL
 (
__a¥rštf
)

71 
	$__LDBL_REDIR_DECL
 (
a¥rštf
)

72 
	$__LDBL_REDIR_DECL
 (
ob¡ack_´štf
)

73 
	$__LDBL_REDIR_DECL
 (
ob¡ack_v´štf
)

76 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


77 
	$__LDBL_REDIR_DECL
 (
__¥rštf_chk
)

78 
	$__LDBL_REDIR_DECL
 (
__v¥rštf_chk
)

79 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


80 
	$__LDBL_REDIR_DECL
 (
__¢´štf_chk
)

81 
	$__LDBL_REDIR_DECL
 (
__v¢´štf_chk
)

83 #ià
__USE_FORTIFY_LEVEL
 > 1

84 
	$__LDBL_REDIR_DECL
 (
__årštf_chk
)

85 
	$__LDBL_REDIR_DECL
 (
__´štf_chk
)

86 
	$__LDBL_REDIR_DECL
 (
__vårštf_chk
)

87 
	$__LDBL_REDIR_DECL
 (
__v´štf_chk
)

	@/usr/include/bits/stdio.h

20 #iâdeà
_STDIO_H


24 #iâdeà
__ex‹º_šlše


25 
	#__STDIO_INLINE
 
šlše


	)

27 
	#__STDIO_INLINE
 
__ex‹º_šlše


	)

31 #ifdeà
__USE_EXTERN_INLINES


34 #ià!(
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše
)

36 
__STDIO_INLINE
 

37 
	$v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

39  
	`vårštf
 (
¡dout
, 
__fmt
, 
__¬g
);

40 
	}
}

44 
__STDIO_INLINE
 

45 
	$g‘ch¬
 ()

47  
	`_IO_g‘c
 (
¡dš
);

48 
	}
}

51 #ifdeà
__USE_MISC


53 
__STDIO_INLINE
 

54 
	$fg‘c_uÆocked
 (
FILE
 *
__å
)

56  
	`_IO_g‘c_uÆocked
 (
__å
);

57 
	}
}

61 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


63 
__STDIO_INLINE
 

64 
	$g‘c_uÆocked
 (
FILE
 *
__å
)

66  
	`_IO_g‘c_uÆocked
 (
__å
);

67 
	}
}

70 
__STDIO_INLINE
 

71 
	$g‘ch¬_uÆocked
 ()

73  
	`_IO_g‘c_uÆocked
 (
¡dš
);

74 
	}
}

79 
__STDIO_INLINE
 

80 
	$putch¬
 (
__c
)

82  
	`_IO_putc
 (
__c
, 
¡dout
);

83 
	}
}

86 #ifdeà
__USE_MISC


88 
__STDIO_INLINE
 

89 
	$åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

91  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

92 
	}
}

96 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


98 
__STDIO_INLINE
 

99 
	$putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

101  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

102 
	}
}

105 
__STDIO_INLINE
 

106 
	$putch¬_uÆocked
 (
__c
)

108  
	`_IO_putc_uÆocked
 (
__c
, 
¡dout
);

109 
	}
}

113 #ifdef 
__USE_GNU


115 
__STDIO_INLINE
 
_IO_ssize_t


116 
	$g‘lše
 (**
__lš•Œ
, 
size_t
 *
__n
, 
FILE
 *
__¡»am
)

118  
	`__g‘d–im
 (
__lš•Œ
, 
__n
, '\n', 
__¡»am
);

119 
	}
}

123 #ifdeà
__USE_MISC


125 
__STDIO_INLINE
 

126 
__NTH
 (
	$ãof_uÆocked
 (
FILE
 *
__¡»am
))

128  
	`_IO_ãof_uÆocked
 (
__¡»am
);

129 
	}
}

132 
__STDIO_INLINE
 

133 
__NTH
 (
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
))

135  
	`_IO_ã¼Ü_uÆocked
 (
__¡»am
);

136 
	}
}

142 #ià
defšed
 
__USE_MISC
 && defšed 
__GNUC__
 && defšed 
__OPTIMIZE__
 \

143 && !
defšed
 
	g__ılu¥lus


145 
	#ä—d_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

146 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

147 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

148 && (
size_t
è(
size
) != 0) \

149 ? ({ *
__±r
 = (*è(
±r
); \

150 
FILE
 *
__¡»am
 = (
¡»am
); \

151 
size_t
 
__út
; \

152 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

153 
__út
 > 0; --__cnt) \

155 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
); \

156 ià(
__c
 =ğ
EOF
) \

158 *
__±r
++ = 
__c
; \

160 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

161 / (
size_t
è(
size
); }) \

162 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

163 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

165 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

166 (è(
n
), (
size_t
) 0) \

167 : 
	`ä—d_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

169 
	#fwr™e_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

170 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

171 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

172 && (
size_t
è(
size
) != 0) \

173 ? ({ cÚ¡ *
__±r
 = (cÚ¡ *è(
±r
); \

174 
FILE
 *
__¡»am
 = (
¡»am
); \

175 
size_t
 
__út
; \

176 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

177 
__út
 > 0; --__cnt) \

178 ià(
	`_IO_putc_uÆocked
 (*
__±r
++, 
__¡»am
è=ğ
EOF
) \

180 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

181 / (
size_t
è(
size
); }) \

182 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

183 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

185 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

186 (è(
n
), (
size_t
) 0) \

187 : 
	`fwr™e_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

191 #undeà
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

20 #iâdeà
_STDIO_H


24 
	$__¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

25 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

26 
	$__v¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

27 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

28 
_G_va_li¡
 
__­
è
__THROW
;

30 #ifdeà
__va_¬g_·ck


31 
__ex‹º_®ways_šlše
 

32 
	`__NTH
 (
	$¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...))

34  
	`__butš___¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

35 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

36 
	}
}

37 #–ià!
defšed
 
__ılu¥lus


38 
	#¥rštf
(
¡r
, ...) \

39 
	`__butš___¥rštf_chk
 (
¡r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

40 
__VA_ARGS__
)

	)

43 
__ex‹º_®ways_šlše
 

44 
__NTH
 (
	$v¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fmt
,

45 
_G_va_li¡
 
__­
))

47  
	`__butš___v¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

48 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

49 
	}
}

51 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


53 
	$__¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

54 
size_t
 
__¦’
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

55 ...è
__THROW
;

56 
	$__v¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

57 
size_t
 
__¦’
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

58 
_G_va_li¡
 
__­
è
__THROW
;

60 #ifdeà
__va_¬g_·ck


61 
__ex‹º_®ways_šlše
 

62 
	`__NTH
 (
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

63 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...))

65  
	`__butš___¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

66 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

67 
	}
}

68 #–ià!
defšed
 
__ılu¥lus


69 
	#¢´štf
(
¡r
, 
Ën
, ...) \

70 
	`__butš___¢´štf_chk
 (
¡r
, 
Ën
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

71 
__VA_ARGS__
)

	)

74 
__ex‹º_®ways_šlše
 

75 
__NTH
 (
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

76 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

78  
	`__butš___v¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

79 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

80 
	}
}

84 #ià
__USE_FORTIFY_LEVEL
 > 1

86 
__årštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

87 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

88 
__´štf_chk
 (
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

89 
__vårštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

90 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__­
);

91 
__v´štf_chk
 (
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

92 
_G_va_li¡
 
__­
);

94 #ifdeà
__va_¬g_·ck


95 
__ex‹º_®ways_šlše
 

96 
	$årštf
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...)

98  
	`__årštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

99 
	`__va_¬g_·ck
 ());

100 
	}
}

102 
__ex‹º_®ways_šlše
 

103 
	$´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

105  
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

106 
	}
}

107 #–ià!
defšed
 
__ılu¥lus


108 
	#´štf
(...) \

109 
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

110 
	#årštf
(
¡»am
, ...) \

111 
	`__årštf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

114 
__ex‹º_®ways_šlše
 

115 
	$v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

117 #ifdeà
__USE_EXTERN_INLINES


118  
	`__vårštf_chk
 (
¡dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

120  
	`__v´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

122 
	}
}

124 
__ex‹º_®ways_šlše
 

125 
	$vårštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

126 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

128  
	`__vårštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

129 
	}
}

133 *
	$__g‘s_chk
 (*
__¡r
, 
size_t
è
__wur
;

134 *
	`__REDIRECT
 (
__g‘s_w¬n
, (*
__¡r
), 
g‘s
)

135 
__wur
 
	`__w¬Ç‰r
 ("please use fgets or getline instead, gets can't "

138 
__ex‹º_®ways_šlše
 
__wur
 *

139 
	$g‘s
 (*
__¡r
)

141 ià(
	`__bos
 (
__¡r
è!ğ(
size_t
) -1)

142  
	`__g‘s_chk
 (
__¡r
, 
	`__bos
 (__str));

143  
	`__g‘s_w¬n
 (
__¡r
);

144 
	}
}

146 *
	$__fg‘s_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

147 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

148 *
	`__REDIRECT
 (
__fg‘s_®Ÿs
,

149 (*
__»¡riù
 
__s
, 
__n
,

150 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s
è
__wur
;

151 *
	`__REDIRECT
 (
__fg‘s_chk_w¬n
,

152 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

153 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_chk
)

154 
__wur
 
	`__w¬Ç‰r
 ("fgets called with bigger sizehan†ength "

157 
__ex‹º_®ways_šlše
 
__wur
 *

158 
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

160 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

162 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

163  
	`__fg‘s_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

165 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

166  
	`__fg‘s_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

168  
	`__fg‘s_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

169 
	}
}

171 
size_t
 
	$__ä—d_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

172 
size_t
 
__size
, size_ˆ
__n
,

173 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

174 
size_t
 
	`__REDIRECT
 (
__ä—d_®Ÿs
,

175 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

176 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

177 
ä—d
è
__wur
;

178 
size_t
 
	`__REDIRECT
 (
__ä—d_chk_w¬n
,

179 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

180 
size_t
 
__size
, size_ˆ
__n
,

181 
FILE
 *
__»¡riù
 
__¡»am
),

182 
__ä—d_chk
)

183 
__wur
 
	`__w¬Ç‰r
 ("fread called with bigger size *‚membhan†ength "

186 
__ex‹º_®ways_šlše
 
__wur
 
size_t


187 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

188 
FILE
 *
__»¡riù
 
__¡»am
)

190 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

192 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

193 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

194 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

195  
	`__ä—d_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

197 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

198  
	`__ä—d_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

200  
	`__ä—d_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

201 
	}
}

203 #ifdeà
__USE_GNU


204 *
	$__fg‘s_uÆocked_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
,

205 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

206 *
	`__REDIRECT
 (
__fg‘s_uÆocked_®Ÿs
,

207 (*
__»¡riù
 
__s
, 
__n
,

208 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s_uÆocked
è
__wur
;

209 *
	`__REDIRECT
 (
__fg‘s_uÆocked_chk_w¬n
,

210 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

211 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_uÆocked_chk
)

212 
__wur
 
	`__w¬Ç‰r
 ("fgets_unlocked called with bigger sizehan†ength "

215 
__ex‹º_®ways_šlše
 
__wur
 *

216 
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

218 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

220 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

221  
	`__fg‘s_uÆocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

223 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

224  
	`__fg‘s_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

226  
	`__fg‘s_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

227 
	}
}

230 #ifdeà
__USE_MISC


231 #undeà
ä—d_uÆocked


232 
size_t
 
	$__ä—d_uÆocked_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

233 
size_t
 
__size
, size_ˆ
__n
,

234 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

235 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_®Ÿs
,

236 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

237 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

238 
ä—d_uÆocked
è
__wur
;

239 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_chk_w¬n
,

240 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

241 
size_t
 
__size
, size_ˆ
__n
,

242 
FILE
 *
__»¡riù
 
__¡»am
),

243 
__ä—d_uÆocked_chk
)

244 
__wur
 
	`__w¬Ç‰r
 ("fread_unlocked called with bigger size *‚membhan "

247 
__ex‹º_®ways_šlše
 
__wur
 
size_t


248 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

249 
FILE
 *
__»¡riù
 
__¡»am
)

251 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

253 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

254 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

255 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

256  
	`__ä—d_uÆocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

257 
__¡»am
);

259 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

260  
	`__ä—d_uÆocked_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

261 
__¡»am
);

264 #ifdeà
__USE_EXTERN_INLINES


265 ià(
	`__butš_cÚ¡ªt_p
 (
__size
)

266 && 
	`__butš_cÚ¡ªt_p
 (
__n
)

267 && (
__size
 | 
__n
è< (((
size_t
) 1) << (8 *  (size_t) / 2))

268 && 
__size
 * 
__n
 <= 8)

270 
size_t
 
__út
 = 
__size
 * 
__n
;

271 *
__ıŒ
 = (*è
__±r
;

272 ià(
__út
 == 0)

275 ; 
__út
 > 0; --__cnt)

277 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
);

278 ià(
__c
 =ğ
EOF
)

280 *
__ıŒ
++ = 
__c
;

282  (
__ıŒ
 - (*è
__±r
è/ 
__size
;

285  
	`__ä—d_uÆocked_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

286 
	}
}

	@/usr/include/bits/stdio_lim.h

19 #ià!
defšed
 
_STDIO_H
 && !defšed 
__Ãed_FOPEN_MAX
 && !defšed 
__Ãed_IOV_MAX


23 #ifdeà
_STDIO_H


24 
	#L_tm²am
 20

	)

25 
	#TMP_MAX
 238328

	)

26 
	#FILENAME_MAX
 4096

	)

28 #ifdeà
__USE_POSIX


29 
	#L_ù”mid
 9

	)

30 
	#L_cu£rid
 9

	)

34 #ià
defšed
 
__Ãed_FOPEN_MAX
 || defšed 
_STDIO_H


35 #undeà
FOPEN_MAX


36 
	#FOPEN_MAX
 16

	)

39 #ià
defšed
 
__Ãed_IOV_MAX
 && !defšed 
IOV_MAX


40 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/stdlib-ldbl.h

20 #iâdeà
_STDLIB_H


24 #ifdef 
__USE_ISOC99


25 
__BEGIN_NAMESPACE_C99


26 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd
, 
¡¹od
)

27 
__END_NAMESPACE_C99


30 #ifdeà
__USE_GNU


31 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd_l
, 
¡¹od_l
)

34 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


35 #ifdeà
__USE_MISC


36 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

39 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

40 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

20 #iâdeà
_STDLIB_H


24 *
	$__»®·th_chk
 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

25 *
__»¡riù
 
__»sŞved
,

26 
size_t
 
__»sŞvedËn
è
__THROW
 
__wur
;

27 *
	`__REDIRECT_NTH
 (
__»®·th_®Ÿs
,

28 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

29 *
__»¡riù
 
__»sŞved
), 
»®·th
è
__wur
;

30 *
	`__REDIRECT_NTH
 (
__»®·th_chk_w¬n
,

31 (
__cÚ¡
 *
__»¡riù
 
__Çme
,

32 *
__»¡riù
 
__»sŞved
,

33 
size_t
 
__»sŞvedËn
), 
__»®·th_chk
è
__wur


34 
	`__w¬Ç‰r
 ("second‡rgument of„ealpath must beƒither NULL or‡t "

37 
__ex‹º_®ways_šlše
 
__wur
 *

38 
	`__NTH
 (
	$»®·th
 (
__cÚ¡
 *
__»¡riù
 
__Çme
, *__»¡riù 
__»sŞved
))

40 ià(
	`__bos
 (
__»sŞved
è!ğ(
size_t
) -1)

42 #ià
defšed
 
_LIBC_LIMITS_H_
 && defšed 
PATH_MAX


43 ià(
	`__bos
 (
__»sŞved
è< 
PATH_MAX
)

44  
	`__»®·th_chk_w¬n
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

46  
	`__»®·th_chk
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

49  
	`__»®·th_®Ÿs
 (
__Çme
, 
__»sŞved
);

50 
	}
}

53 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

54 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

55 
	`__REDIRECT_NTH
 (
__±¢ame_r_®Ÿs
, (
__fd
, *
__buf
,

56 
size_t
 
__buæ’
), 
±¢ame_r
)

57 
	`__nÚnuÎ
 ((2));

58 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¬n
,

59 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

60 
size_t
 
__Ä—l
), 
__±¢ame_r_chk
)

61 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ptsname_r called with buflen biggerhan "

64 
__ex‹º_®ways_šlše
 

65 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

67 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

69 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

70  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

71 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

72  
	`__±¢ame_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

74  
	`__±¢ame_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

75 
	}
}

78 
	$__wùomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
size_t
 
__buæ’
)

79 
__THROW
 
__wur
;

80 
	`__REDIRECT_NTH
 (
__wùomb_®Ÿs
, (*
__s
, 
wch¬_t
 
__wch¬
),

81 
wùomb
è
__wur
;

83 
__ex‹º_®ways_šlše
 
__wur
 

84 
	`__NTH
 (
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
))

89 
	#__STDLIB_MB_LEN_MAX
 16

	)

90 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__STDLIB_MB_LEN_MAX


93 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

94  
	`__wùomb_chk
 (
__s
, 
__wch¬
, 
	`__bos
 (__s));

95  
	`__wùomb_®Ÿs
 (
__s
, 
__wch¬
);

96 
	}
}

99 
size_t
 
	$__mb¡owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

100 
__cÚ¡
 *
__»¡riù
 
__¤c
,

101 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

102 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_®Ÿs
,

103 (
wch¬_t
 *
__»¡riù
 
__d¡
,

104 
__cÚ¡
 *
__»¡riù
 
__¤c
,

105 
size_t
 
__Ën
), 
mb¡owcs
);

106 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_chk_w¬n
,

107 (
wch¬_t
 *
__»¡riù
 
__d¡
,

108 
__cÚ¡
 *
__»¡riù
 
__¤c
,

109 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__mb¡owcs_chk
)

110 
	`__w¬Ç‰r
 ("mbstowcs called with dst buffer smallerhan†en "

113 
__ex‹º_®ways_šlše
 
size_t


114 
	`__NTH
 (
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

115 
size_t
 
__Ën
))

117 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

119 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

120  
	`__mb¡owcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
,

121 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

123 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

124  
	`__mb¡owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
,

125 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

127  
	`__mb¡owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

128 
	}
}

131 
size_t
 
	$__wc¡ombs_chk
 (*
__»¡riù
 
__d¡
,

132 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

133 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

134 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_®Ÿs
,

135 (*
__»¡riù
 
__d¡
,

136 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

137 
size_t
 
__Ën
), 
wc¡ombs
);

138 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_chk_w¬n
,

139 (*
__»¡riù
 
__d¡
,

140 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

141 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__wc¡ombs_chk
)

142 
	`__w¬Ç‰r
 ("wcstombs called with dst buffer smallerhan†en");

144 
__ex‹º_®ways_šlše
 
size_t


145 
	`__NTH
 (
	$wc¡ombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 *__»¡riù 
__¤c
,

146 
size_t
 
__Ën
))

148 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

150 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

151  
	`__wc¡ombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

152 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

153  
	`__wc¡ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

155  
	`__wc¡ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

156 
	}
}

	@/usr/include/bits/string.h

20 #iâdeà
_STRING_H


26 
	#_STRING_ARCH_uÇligÃd
 1

	)

	@/usr/include/bits/string2.h

21 #iâdeà
_STRING_H


25 #ià!
defšed
 
__NO_STRING_INLINES
 && !defšed 
__BOUNDED_POINTERS__


42 #iâdeà
__STRING_INLINE


43 #ifdeà
__ılu¥lus


44 
	#__STRING_INLINE
 
šlše


	)

46 
	#__STRING_INLINE
 
__ex‹º_šlše


	)

50 #ià
_STRING_ARCH_uÇligÃd


52 
	~<’dŸn.h
>

53 
	~<b™s/ty³s.h
>

55 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


56 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

57 (((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1] << 8 \

58 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
])

	)

59 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

60 (((((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 3] << 8 \

61 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

62 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

63 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
])

	)

65 
	#__STRING2_SMALL_GET16
(
¤c
, 
idx
) \

66 (((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
] << 8 \

67 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1])

	)

68 
	#__STRING2_SMALL_GET32
(
¤c
, 
idx
) \

69 (((((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
] << 8 \

70 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 1]) << 8 \

71 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 2]) << 8 \

72 | ((
__cÚ¡
 *è(__cÚ¡ *è(
¤c
))[
idx
 + 3])

	)

77 
	#__STRING2_COPY_TYPE
(
N
) \

78 ¡ruù { 
__¬r
[
N
]; } \

79 
	t__©Œibu‹__
 ((
	t__·cked__
)è
	t__STRING2_COPY_ARR
##
	tN


	)

80 
	t__STRING2_COPY_TYPE
 (2);

81 
__STRING2_COPY_TYPE
 (3);

82 
__STRING2_COPY_TYPE
 (4);

83 
__STRING2_COPY_TYPE
 (5);

84 
__STRING2_COPY_TYPE
 (6);

85 
__STRING2_COPY_TYPE
 (7);

86 
__STRING2_COPY_TYPE
 (8);

87 #undeà
__STRING2_COPY_TYPE


93 
	#__¡ršg2_1b±r_p
(
__x
) \

94 ((
size_t
)(cÚ¡ *)((
__x
è+ 1è- (size_t)(cÚ¡ *)(__xè=ğ1)

	)

97 #ià!
defšed
 
_HAVE_STRING_ARCH_mem£t


98 #ià!
__GNUC_PREREQ
 (3, 0)

99 #ià
_STRING_ARCH_uÇligÃd


100 
	#mem£t
(
s
, 
c
, 
n
) \

101 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) && (n) <= 16 \

102 ? ((
n
) == 1 \

103 ? 
	`__mem£t_1
 (
s
, 
c
) \

104 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

105 : (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

106 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

107 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

109 
	#__mem£t_1
(
s
, 
c
è({ *
__s
 = (s); \

110 *((
__ušt8_t
 *è
__s
èğ(__ušt8_tè
c
; __s; })

	)

112 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

113 ({ *
__s
 = (
s
); \

115 
__ui
; \

116 
__usi
; \

117 
__uc
; \

118 } *
__u
 = 
__s
; \

119 
__ušt8_t
 
__c
 = (__ušt8_tè(
c
); \

122 (è(
n
)) \

125 
__u
->
__ui
 = 
__c
 * 0x01010101; \

126 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

128 
__u
->
__ui
 = 
__c
 * 0x01010101; \

129 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

131 
__u
->
__ui
 = 
__c
 * 0x01010101; \

132 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

134 
__u
->
__usi
 = (è
__c
 * 0x0101; \

135 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2); \

136 
__u
->
__uc
 = (è
__c
; \

140 
__u
->
__ui
 = 
__c
 * 0x01010101; \

141 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

143 
__u
->
__ui
 = 
__c
 * 0x01010101; \

144 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

146 
__u
->
__ui
 = 
__c
 * 0x01010101; \

147 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

149 
__u
->
__usi
 = (è
__c
 * 0x0101; \

153 
__u
->
__ui
 = 
__c
 * 0x01010101; \

154 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

156 
__u
->
__ui
 = 
__c
 * 0x01010101; \

157 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

159 
__u
->
__ui
 = 
__c
 * 0x01010101; \

160 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

162 
__u
->
__uc
 = (è
__c
; \

166 
__u
->
__ui
 = 
__c
 * 0x01010101; \

167 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

169 
__u
->
__ui
 = 
__c
 * 0x01010101; \

170 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

172 
__u
->
__ui
 = 
__c
 * 0x01010101; \

173 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4); \

175 
__u
->
__ui
 = 
__c
 * 0x01010101; \

180 
__s
; })

	)

182 
	#mem£t
(
s
, 
c
, 
n
) \

183 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

184 ? ({ *
__s
 = (
s
); 
	`__bz”o
 (__s, 
n
); __s; }) \

185 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

194 #ià
__GNUC_PREREQ
 (2, 91)

195 
	#__bz”o
(
s
, 
n
è
	`__butš_mem£t
 (s, '\0',‚)

	)

203 #ifdeà
__USE_GNU


204 #ià!
defšed
 
_HAVE_STRING_ARCH_mempıy
 || defšed 
_FORCE_INLINES


205 #iâdeà
_HAVE_STRING_ARCH_mempıy


206 #ià
__GNUC_PREREQ
 (3, 4)

207 
	#__mempıy
(
de¡
, 
¤c
, 
n
è
	`__butš_mempıy
 (de¡, src,‚)

	)

208 #–ià
__GNUC_PREREQ
 (3, 0)

209 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

210 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

211 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

212 ? 
	`__butš_memıy
 (
de¡
, 
¤c
, 
n
) + (n) \

213 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

215 
	#__mempıy
(
de¡
, 
¤c
, 
n
) \

216 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

217 && 
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
n
 <= 8 \

218 ? 
	`__mempıy_sm®l
 (
de¡
, 
	`__mempıy_¬gs
 (
¤c
), 
n
) \

219 : 
	`__mempıy
 (
de¡
, 
¤c
, 
n
)))

	)

223 
	#mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy
 (de¡, src,‚)

	)

226 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


227 #ià
_STRING_ARCH_uÇligÃd


228 #iâdeà
_FORCE_INLINES


229 
	#__mempıy_¬gs
(
¤c
) \

230 ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[2], \

231 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[6], \

232 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

233 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

234 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

235 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

237 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , , , ,

238 
__ušt16_t
, __ušt16_t, 
__ušt32_t
,

239 
__ušt32_t
, 
size_t
);

240 
__STRING_INLINE
 *

241 
	$__mempıy_sm®l
 (*
__de¡1
,

242 
__¤c0_1
, 
__¤c2_1
, 
__¤c4_1
, 
__¤c6_1
,

243 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

244 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

245 
size_t
 
__¤ş’
)

248 
__ušt32_t
 
__ui
;

249 
__ušt16_t
 
__usi
;

250 
__uc
;

251 
__c
;

252 } *
__u
 = 
__de¡1
;

253 (è
__¤ş’
)

256 
__u
->
__c
 = 
__¤c0_1
;

257 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

260 
__u
->
__usi
 = 
__¤c0_2
;

261 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

264 
__u
->
__usi
 = 
__¤c0_2
;

265 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

266 
__u
->
__c
 = 
__¤c2_1
;

267 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

270 
__u
->
__ui
 = 
__¤c0_4
;

271 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

274 
__u
->
__ui
 = 
__¤c0_4
;

275 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

276 
__u
->
__c
 = 
__¤c4_1
;

277 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

280 
__u
->
__ui
 = 
__¤c0_4
;

281 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

282 
__u
->
__usi
 = 
__¤c4_2
;

283 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

286 
__u
->
__ui
 = 
__¤c0_4
;

287 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

288 
__u
->
__usi
 = 
__¤c4_2
;

289 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

290 
__u
->
__c
 = 
__¤c6_1
;

291 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

294 
__u
->
__ui
 = 
__¤c0_4
;

295 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

296 
__u
->
__ui
 = 
__¤c4_4
;

297 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

300  (*è
__u
;

301 
	}
}

303 #iâdeà
_FORCE_INLINES


304 
	#__mempıy_¬gs
(
¤c
) \

305 ((
__cÚ¡
 *è(
¤c
))[0], \

306 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

307 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1] } }), \

308 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

309 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

310 ((
__cÚ¡
 *è(
¤c
))[2] } }), \

311 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

312 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

313 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3] } }), \

314 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

315 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

316 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

317 ((
__cÚ¡
 *è(
¤c
))[4] } }), \

318 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

319 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

320 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

321 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5] } }), \

322 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

323 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

324 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

325 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

326 ((
__cÚ¡
 *è(
¤c
))[6] } }), \

327 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

328 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

329 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

330 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

331 ((
__cÚ¡
 *è(
¤c
))[6], ((__cÚ¡ *è(¤c))[7] } })

	)

333 
__STRING_INLINE
 *
__mempıy_sm®l
 (*, , 
__STRING2_COPY_ARR2
,

334 
__STRING2_COPY_ARR3
,

335 
__STRING2_COPY_ARR4
,

336 
__STRING2_COPY_ARR5
,

337 
__STRING2_COPY_ARR6
,

338 
__STRING2_COPY_ARR7
,

339 
__STRING2_COPY_ARR8
, 
size_t
);

340 
__STRING_INLINE
 *

341 
	$__mempıy_sm®l
 (*
__de¡
, 
__¤c1
,

342 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

343 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

344 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

345 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

348 
__c
;

349 
__STRING2_COPY_ARR2
 
__sÿ2
;

350 
__STRING2_COPY_ARR3
 
__sÿ3
;

351 
__STRING2_COPY_ARR4
 
__sÿ4
;

352 
__STRING2_COPY_ARR5
 
__sÿ5
;

353 
__STRING2_COPY_ARR6
 
__sÿ6
;

354 
__STRING2_COPY_ARR7
 
__sÿ7
;

355 
__STRING2_COPY_ARR8
 
__sÿ8
;

356 } *
__u
 = 
__de¡
;

357 (è
__¤ş’
)

360 
__u
->
__c
 = 
__¤c1
;

363 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

366 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

369 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

372 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

375 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

378 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

381 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

384  
	`__ex‹nsiÚ__
 ((*è
__u
 + 
__¤ş’
);

385 
	}
}

393 #iâdeà
_HAVE_STRING_ARCH_¡rchr


394 *
__¿wmemchr
 (cÚ¡ *
__s
, 
__c
);

395 #ià
__GNUC_PREREQ
 (3, 2)

396 
	#¡rchr
(
s
, 
c
) \

397 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
è&& !__butš_cÚ¡ªt_°(
s
) \

398 && (
c
) == '\0' \

399 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

400 : 
	`__butš_¡rchr
 (
s
, 
c
)))

	)

402 
	#¡rchr
(
s
, 
c
) \

403 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
c
) && (c) == '\0' \

404 ? (*è
	`__¿wmemchr
 (
s
, 
c
) \

405 : 
	`¡rchr
 (
s
, 
c
)))

	)

411 #ià(!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)) \

412 || 
defšed
 
	g_FORCE_INLINES


413 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rıy
 && !
__GNUC_PREREQ
 (3, 0)

414 
	#¡rıy
(
de¡
, 
¤c
) \

415 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

416 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

417 ? 
	`__¡rıy_sm®l
 (
de¡
, 
	`__¡rıy_¬gs
 (
¤c
), \

418 
	`¡¾’
 (
¤c
) + 1) \

419 : (*è
	`memıy
 (
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1)) \

420 : 
	`¡rıy
 (
de¡
, 
¤c
)))

	)

423 #ià
_STRING_ARCH_uÇligÃd


424 #iâdeà
_FORCE_INLINES


425 
	#__¡rıy_¬gs
(
¤c
) \

426 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

427 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

428 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

429 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

431 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

432 
__ušt32_t
, __ušt32_t, 
size_t
);

433 
__STRING_INLINE
 *

434 
	$__¡rıy_sm®l
 (*
__de¡
,

435 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

436 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

437 
size_t
 
__¤ş’
)

440 
__ušt32_t
 
__ui
;

441 
__ušt16_t
 
__usi
;

442 
__uc
;

443 } *
__u
 = (*è
__de¡
;

444 (è
__¤ş’
)

447 
__u
->
__uc
 = '\0';

450 
__u
->
__usi
 = 
__¤c0_2
;

453 
__u
->
__usi
 = 
__¤c0_2
;

454 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

455 
__u
->
__uc
 = '\0';

458 
__u
->
__ui
 = 
__¤c0_4
;

461 
__u
->
__ui
 = 
__¤c0_4
;

462 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

463 
__u
->
__uc
 = '\0';

466 
__u
->
__ui
 = 
__¤c0_4
;

467 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

468 
__u
->
__usi
 = 
__¤c4_2
;

471 
__u
->
__ui
 = 
__¤c0_4
;

472 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

473 
__u
->
__usi
 = 
__¤c4_2
;

474 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

475 
__u
->
__uc
 = '\0';

478 
__u
->
__ui
 = 
__¤c0_4
;

479 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

480 
__u
->
__ui
 = 
__¤c4_4
;

483  
__de¡
;

484 
	}
}

486 #iâdeà
_FORCE_INLINES


487 
	#__¡rıy_¬gs
(
¤c
) \

488 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

489 { { ((
__cÚ¡
 *è(
¤c
))[0], '\0' } }), \

490 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

491 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

493 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

494 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

495 ((
__cÚ¡
 *è(
¤c
))[2], '\0' } }), \

496 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

497 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

498 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

500 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

501 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

502 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

503 ((
__cÚ¡
 *è(
¤c
))[4], '\0' } }), \

504 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

505 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

506 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

507 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

509 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

510 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

511 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

512 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

513 ((
__cÚ¡
 *è(
¤c
))[6], '\0' } })

	)

515 
__STRING_INLINE
 *
__¡rıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

516 
__STRING2_COPY_ARR3
,

517 
__STRING2_COPY_ARR4
,

518 
__STRING2_COPY_ARR5
,

519 
__STRING2_COPY_ARR6
,

520 
__STRING2_COPY_ARR7
,

521 
__STRING2_COPY_ARR8
, 
size_t
);

522 
__STRING_INLINE
 *

523 
	$__¡rıy_sm®l
 (*
__de¡
,

524 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

525 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

526 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

527 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

530 
__c
;

531 
__STRING2_COPY_ARR2
 
__sÿ2
;

532 
__STRING2_COPY_ARR3
 
__sÿ3
;

533 
__STRING2_COPY_ARR4
 
__sÿ4
;

534 
__STRING2_COPY_ARR5
 
__sÿ5
;

535 
__STRING2_COPY_ARR6
 
__sÿ6
;

536 
__STRING2_COPY_ARR7
 
__sÿ7
;

537 
__STRING2_COPY_ARR8
 
__sÿ8
;

538 } *
__u
 = (*è
__de¡
;

539 (è
__¤ş’
)

542 
__u
->
__c
 = '\0';

545 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

548 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

551 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

554 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

557 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

560 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

563 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

566  
__de¡
;

567 
	}
}

573 #ifdeà
__USE_GNU


574 #ià!
defšed
 
_HAVE_STRING_ARCH_¡pıy
 || defšed 
_FORCE_INLINES


575 #iâdeà
_HAVE_STRING_ARCH_¡pıy


576 #ià
__GNUC_PREREQ
 (3, 4)

577 
	#__¡pıy
(
de¡
, 
¤c
è
	`__butš_¡pıy
 (de¡, src)

	)

578 #–ià
__GNUC_PREREQ
 (3, 0)

579 
	#__¡pıy
(
de¡
, 
¤c
) \

580 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

581 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

582 ? 
	`__butš_¡rıy
 (
de¡
, 
¤c
è+ 
	`¡¾’
 (src) \

583 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

585 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

587 
	#__¡pıy
(
de¡
, 
¤c
) \

588 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
) \

589 ? (
	`__¡ršg2_1b±r_p
 (
¤c
è&& 
	`¡¾’
 (src) + 1 <= 8 \

590 ? 
	`__¡pıy_sm®l
 (
de¡
, 
	`__¡pıy_¬gs
 (
¤c
), \

591 
	`¡¾’
 (
¤c
) + 1) \

592 : ((*è(
__mempıy
è(
de¡
, 
¤c
, 
	`¡¾’
 (src) + 1) \

594 : 
	`__¡pıy
 (
de¡
, 
¤c
)))

	)

598 
	#¡pıy
(
de¡
, 
¤c
è
	`__¡pıy
 (de¡, src)

	)

601 #ià!
__GNUC_PREREQ
 (3, 0è|| 
defšed
 
_FORCE_INLINES


602 #ià
_STRING_ARCH_uÇligÃd


603 #iâdeà
_FORCE_INLINES


604 
	#__¡pıy_¬gs
(
¤c
) \

605 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 0), \

606 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET16
 (
¤c
, 4), \

607 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 0), \

608 
__ex‹nsiÚ__
 
	`__STRING2_SMALL_GET32
 (
¤c
, 4)

	)

610 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__ušt16_t
, __uint16_t,

611 
__ušt32_t
, __ušt32_t, 
size_t
);

612 
__STRING_INLINE
 *

613 
	$__¡pıy_sm®l
 (*
__de¡
,

614 
__ušt16_t
 
__¤c0_2
, __ušt16_ˆ
__¤c4_2
,

615 
__ušt32_t
 
__¤c0_4
, __ušt32_ˆ
__¤c4_4
,

616 
size_t
 
__¤ş’
)

619 
__ui
;

620 
__usi
;

621 
__uc
;

622 
__c
;

623 } *
__u
 = (*è
__de¡
;

624 (è
__¤ş’
)

627 
__u
->
__uc
 = '\0';

630 
__u
->
__usi
 = 
__¤c0_2
;

631 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

634 
__u
->
__usi
 = 
__¤c0_2
;

635 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

636 
__u
->
__uc
 = '\0';

639 
__u
->
__ui
 = 
__¤c0_4
;

640 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

643 
__u
->
__ui
 = 
__¤c0_4
;

644 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

645 
__u
->
__uc
 = '\0';

648 
__u
->
__ui
 = 
__¤c0_4
;

649 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

650 
__u
->
__usi
 = 
__¤c4_2
;

651 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 1);

654 
__u
->
__ui
 = 
__¤c0_4
;

655 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

656 
__u
->
__usi
 = 
__¤c4_2
;

657 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 2);

658 
__u
->
__uc
 = '\0';

661 
__u
->
__ui
 = 
__¤c0_4
;

662 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 4);

663 
__u
->
__ui
 = 
__¤c4_4
;

664 
__u
 = 
	`__ex‹nsiÚ__
 ((*) __u + 3);

667  &
__u
->
__c
;

668 
	}
}

670 #iâdeà
_FORCE_INLINES


671 
	#__¡pıy_¬gs
(
¤c
) \

672 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR2
) \

673 { { ((
__cÚ¡
 *è(
¤c
))[0], '\0' } }), \

674 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR3
) \

675 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

677 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR4
) \

678 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

679 ((
__cÚ¡
 *è(
¤c
))[2], '\0' } }), \

680 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR5
) \

681 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

682 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

684 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR6
) \

685 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

686 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

687 ((
__cÚ¡
 *è(
¤c
))[4], '\0' } }), \

688 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR7
) \

689 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

690 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

691 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

693 
	`__ex‹nsiÚ__
 ((
__STRING2_COPY_ARR8
) \

694 { { ((
__cÚ¡
 *è(
¤c
))[0], ((__const *) (src))[1], \

695 ((
__cÚ¡
 *è(
¤c
))[2], ((__const *) (src))[3], \

696 ((
__cÚ¡
 *è(
¤c
))[4], ((__const *) (src))[5], \

697 ((
__cÚ¡
 *è(
¤c
))[6], '\0' } })

	)

699 
__STRING_INLINE
 *
__¡pıy_sm®l
 (*, 
__STRING2_COPY_ARR2
,

700 
__STRING2_COPY_ARR3
,

701 
__STRING2_COPY_ARR4
,

702 
__STRING2_COPY_ARR5
,

703 
__STRING2_COPY_ARR6
,

704 
__STRING2_COPY_ARR7
,

705 
__STRING2_COPY_ARR8
, 
size_t
);

706 
__STRING_INLINE
 *

707 
	$__¡pıy_sm®l
 (*
__de¡
,

708 
__STRING2_COPY_ARR2
 
__¤c2
, 
__STRING2_COPY_ARR3
 
__¤c3
,

709 
__STRING2_COPY_ARR4
 
__¤c4
, 
__STRING2_COPY_ARR5
 
__¤c5
,

710 
__STRING2_COPY_ARR6
 
__¤c6
, 
__STRING2_COPY_ARR7
 
__¤c7
,

711 
__STRING2_COPY_ARR8
 
__¤c8
, 
size_t
 
__¤ş’
)

714 
__c
;

715 
__STRING2_COPY_ARR2
 
__sÿ2
;

716 
__STRING2_COPY_ARR3
 
__sÿ3
;

717 
__STRING2_COPY_ARR4
 
__sÿ4
;

718 
__STRING2_COPY_ARR5
 
__sÿ5
;

719 
__STRING2_COPY_ARR6
 
__sÿ6
;

720 
__STRING2_COPY_ARR7
 
__sÿ7
;

721 
__STRING2_COPY_ARR8
 
__sÿ8
;

722 } *
__u
 = (*è
__de¡
;

723 (è
__¤ş’
)

726 
__u
->
__c
 = '\0';

729 
__ex‹nsiÚ__
 
__u
->
__sÿ2
 = 
__¤c2
;

732 
__ex‹nsiÚ__
 
__u
->
__sÿ3
 = 
__¤c3
;

735 
__ex‹nsiÚ__
 
__u
->
__sÿ4
 = 
__¤c4
;

738 
__ex‹nsiÚ__
 
__u
->
__sÿ5
 = 
__¤c5
;

741 
__ex‹nsiÚ__
 
__u
->
__sÿ6
 = 
__¤c6
;

744 
__ex‹nsiÚ__
 
__u
->
__sÿ7
 = 
__¤c7
;

747 
__ex‹nsiÚ__
 
__u
->
__sÿ8
 = 
__¤c8
;

750  
__de¡
 + 
__¤ş’
 - 1;

751 
	}
}

759 #iâdeà
_HAVE_STRING_ARCH_¡ºıy


760 #ià
__GNUC_PREREQ
 (3, 2)

761 
	#¡ºıy
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºıy
 (de¡, src,‚)

	)

763 
	#¡ºıy
(
de¡
, 
¤c
, 
n
) \

764 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

765 ? (
	`¡¾’
 (
¤c
è+ 1 >ğ((
size_t
è(
n
)) \

766 ? (*è
	`memıy
 (
de¡
, 
¤c
, 
n
) \

767 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)) \

768 : 
	`¡ºıy
 (
de¡
, 
¤c
, 
n
)))

	)

774 #iâdeà
_HAVE_STRING_ARCH_¡ºÿt


775 #ifdeà
_USE_STRING_ARCH_¡rchr


776 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

777 (
	`__ex‹nsiÚ__
 ({ *
__de¡
 = (
de¡
); \

778 
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

779 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

780 ? 
	`¡rÿt
 (
__de¡
, 
¤c
) \

781 : (*((*è
	`__mempıy
 (
	`¡rchr
 (
__de¡
, '\0'), \

782 
¤c
, 
n
)èğ'\0', 
__de¡
)) \

783 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
); }))

	)

784 #–ià
__GNUC_PREREQ
 (3, 2)

785 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
è
	`__butš_¡ºÿt
 (de¡, src,‚)

	)

787 
	#¡ºÿt
(
de¡
, 
¤c
, 
n
) \

788 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
¤c
è&& __butš_cÚ¡ªt_°(
n
) \

789 ? (
	`¡¾’
 (
¤c
è< ((
size_t
è(
n
)) \

790 ? 
	`¡rÿt
 (
de¡
, 
¤c
) \

791 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)) \

792 : 
	`¡ºÿt
 (
de¡
, 
¤c
, 
n
)))

	)

798 #iâdeà
_HAVE_STRING_ARCH_¡rcmp


799 #ià
__GNUC_PREREQ
 (3, 2)

800 
	#¡rcmp
(
s1
, 
s2
) \

801 
__ex‹nsiÚ__
 \

802 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

803 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

804 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), 
__s2_Ën
 = sŒËÀ(
s2
), \

805 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

806 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

807 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

808 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

809 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), __s1_len < 4) \

810 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

811 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

812 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

813 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

814 && (
__s2_Ën
 = 
	`¡¾’
 (
s2
), __s2_len < 4) \

815 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

816 ? 
	`__butš_¡rcmp
 (
s1
, 
s2
) \

817 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

818 : 
	`__butš_¡rcmp
 (
s1
, 
s2
)))); })

	)

820 
	#¡rcmp
(
s1
, 
s2
) \

821 
__ex‹nsiÚ__
 \

822 ({ 
size_t
 
__s1_Ën
, 
__s2_Ën
; \

823 (
	`__butš_cÚ¡ªt_p
 (
s1
è&& __butš_cÚ¡ªt_°(
s2
) \

824 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), 
__s2_Ën
 = sŒËÀ(
s2
), \

825 (!
	`__¡ršg2_1b±r_p
 (
s1
è|| 
__s1_Ën
 >= 4) \

826 && (!
	`__¡ršg2_1b±r_p
 (
s2
è|| 
__s2_Ën
 >= 4)) \

827 ? 
	`memcmp
 ((
__cÚ¡
 *è(
s1
), (__cÚ¡ *è(
s2
), \

828 (
__s1_Ën
 < 
__s2_Ën
 ? __s1_len : __s2_len) + 1) \

829 : (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

830 && (
__s1_Ën
 = 
	`¡¾’
 (
s1
), __s1_len < 4) \

831 ? (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

832 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s1_Ën
) \

833 : 
	`__¡rcmp_cg
 (
s1
, 
s2
, 
__s1_Ën
)) \

834 : (
	`__butš_cÚ¡ªt_p
 (
s2
è&& 
	`__¡ršg2_1b±r_p
 (s2) \

835 && (
__s2_Ën
 = 
	`¡¾’
 (
s2
), __s2_len < 4) \

836 ? (
	`__butš_cÚ¡ªt_p
 (
s1
è&& 
	`__¡ršg2_1b±r_p
 (s1) \

837 ? 
	`__¡rcmp_cc
 (
s1
, 
s2
, 
__s2_Ën
) \

838 : 
	`__¡rcmp_gc
 (
s1
, 
s2
, 
__s2_Ën
)) \

839 : 
	`¡rcmp
 (
s1
, 
s2
)))); })

	)

842 
	#__¡rcmp_cc
(
s1
, 
s2
, 
l
) \

843 (
	`__ex‹nsiÚ__
 ({ 
__»suÉ
 = \

844 (((
__cÚ¡
 *è(__cÚ¡ *è(
s1
))[0] \

845 - ((
__cÚ¡
 *è(__cÚ¡ *)(
s2
))[0]);\

846 ià(
l
 > 0 && 
__»suÉ
 == 0) \

848 
__»suÉ
 = (((
__cÚ¡
 *) \

849 (
__cÚ¡
 *è(
s1
))[1] \

850 - ((
__cÚ¡
 *) \

851 (
__cÚ¡
 *è(
s2
))[1]); \

852 ià(
l
 > 1 && 
__»suÉ
 == 0) \

854 
__»suÉ
 = \

855 (((
__cÚ¡
 *) \

856 (
__cÚ¡
 *è(
s1
))[2] \

857 - ((
__cÚ¡
 *) \

858 (
__cÚ¡
 *è(
s2
))[2]); \

859 ià(
l
 > 2 && 
__»suÉ
 == 0) \

860 
__»suÉ
 = \

861 (((
__cÚ¡
 *) \

862 (
__cÚ¡
 *è(
s1
))[3] \

863 - ((
__cÚ¡
 *) \

864 (
__cÚ¡
 *è(
s2
))[3]); \

867 
__»suÉ
; }))

	)

869 
	#__¡rcmp_cg
(
s1
, 
s2
, 
l1
) \

870 (
	`__ex‹nsiÚ__
 ({ 
__cÚ¡
 *
__s2
 = \

871 (
__cÚ¡
 *è(__cÚ¡ *è(
s2
); \

872 
__»suÉ
 = \

873 (((
__cÚ¡
 *è(__cÚ¡ *è(
s1
))[0] \

874 - 
__s2
[0]); \

875 ià(
l1
 > 0 && 
__»suÉ
 == 0) \

877 
__»suÉ
 = (((
__cÚ¡
 *) \

878 (
__cÚ¡
 *è(
s1
))[1] - 
__s2
[1]); \

879 ià(
l1
 > 1 && 
__»suÉ
 == 0) \

881 
__»suÉ
 = (((
__cÚ¡
 *) \

882 (
__cÚ¡
 *è(
s1
))[2] - 
__s2
[2]);\

883 ià(
l1
 > 2 && 
__»suÉ
 == 0) \

884 
__»suÉ
 = (((
__cÚ¡
 *) \

885 (
__cÚ¡
 *è(
s1
))[3] \

886 - 
__s2
[3]); \

889 
__»suÉ
; }))

	)

891 
	#__¡rcmp_gc
(
s1
, 
s2
, 
l2
) \

892 (
	`__ex‹nsiÚ__
 ({ 
__cÚ¡
 *
__s1
 = \

893 (
__cÚ¡
 *è(__cÚ¡ *è(
s1
); \

894 
__»suÉ
 = \

895 
__s1
[0] - ((
__cÚ¡
 *) \

896 (
__cÚ¡
 *è(
s2
))[0]; \

897 ià(
l2
 > 0 && 
__»suÉ
 == 0) \

899 
__»suÉ
 = (
__s1
[1] \

900 - ((
__cÚ¡
 *) \

901 (
__cÚ¡
 *è(
s2
))[1]); \

902 ià(
l2
 > 1 && 
__»suÉ
 == 0) \

904 
__»suÉ
 = \

905 (
__s1
[2] - ((
__cÚ¡
 *) \

906 (
__cÚ¡
 *è(
s2
))[2]); \

907 ià(
l2
 > 2 && 
__»suÉ
 == 0) \

908 
__»suÉ
 = \

909 (
__s1
[3] \

910 - ((
__cÚ¡
 *) \

911 (
__cÚ¡
 *è(
s2
))[3]); \

914 
__»suÉ
; }))

	)

919 #iâdeà
_HAVE_STRING_ARCH_¡ºcmp


920 
	#¡ºcmp
(
s1
, 
s2
, 
n
) \

921 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
n
) \

922 && ((
	`__butš_cÚ¡ªt_p
 (
s1
) \

923 && 
	`¡¾’
 (
s1
è< ((
size_t
è(
n
))) \

924 || (
	`__butš_cÚ¡ªt_p
 (
s2
) \

925 && 
	`¡¾’
 (
s2
è< ((
size_t
è(
n
)))) \

926 ? 
	`¡rcmp
 (
s1
, 
s2
è: 
	`¡ºcmp
 (s1, s2, 
n
)))

	)

932 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rc¥n
 || defšed 
_FORCE_INLINES


933 #iâdeà
_HAVE_STRING_ARCH_¡rc¥n


934 #ià
__GNUC_PREREQ
 (3, 2)

935 
	#¡rc¥n
(
s
, 
»jeù
) \

936 
__ex‹nsiÚ__
 \

937 ({ 
__r0
, 
__r1
, 
__r2
; \

938 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

939 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

940 ? 
	`__butš_¡rc¥n
 (
s
, 
»jeù
) \

941 : ((
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], __r0 == '\0') \

942 ? 
	`¡¾’
 (
s
) \

943 : ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], __r1 == '\0') \

944 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

945 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

946 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

947 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

948 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

949 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)))))) \

950 : 
	`__butš_¡rc¥n
 (
s
, 
»jeù
)); })

	)

952 
	#¡rc¥n
(
s
, 
»jeù
) \

953 
__ex‹nsiÚ__
 \

954 ({ 
__r0
, 
__r1
, 
__r2
; \

955 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

956 ? ((
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], __r0 == '\0') \

957 ? 
	`¡¾’
 (
s
) \

958 : ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], __r1 == '\0') \

959 ? 
	`__¡rc¥n_c1
 (
s
, 
__r0
) \

960 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

961 ? 
	`__¡rc¥n_c2
 (
s
, 
__r0
, 
__r1
) \

962 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

963 ? 
	`__¡rc¥n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

964 : 
	`¡rc¥n
 (
s
, 
»jeù
))))) \

965 : 
	`¡rc¥n
 (
s
, 
»jeù
)); })

	)

969 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c1
 (
__cÚ¡
 *
__s
, 
__»jeù
);

970 
__STRING_INLINE
 
size_t


971 
	$__¡rc¥n_c1
 (
__cÚ¡
 *
__s
, 
__»jeù
)

973 
size_t
 
__»suÉ
 = 0;

974 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù
)

975 ++
__»suÉ
;

976  
__»suÉ
;

977 
	}
}

979 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c2
 (
__cÚ¡
 *
__s
, 
__»jeù1
,

980 
__»jeù2
);

981 
__STRING_INLINE
 
size_t


982 
	$__¡rc¥n_c2
 (
__cÚ¡
 *
__s
, 
__»jeù1
, 
__»jeù2
)

984 
size_t
 
__»suÉ
 = 0;

985 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


986 && 
__s
[
__»suÉ
] !ğ
__»jeù2
)

987 ++
__»suÉ
;

988  
__»suÉ
;

989 
	}
}

991 
__STRING_INLINE
 
size_t
 
__¡rc¥n_c3
 (
__cÚ¡
 *
__s
, 
__»jeù1
,

992 
__»jeù2
, 
__»jeù3
);

993 
__STRING_INLINE
 
size_t


994 
	$__¡rc¥n_c3
 (
__cÚ¡
 *
__s
, 
__»jeù1
, 
__»jeù2
,

995 
__»jeù3
)

997 
size_t
 
__»suÉ
 = 0;

998 
__s
[
__»suÉ
] !ğ'\0' && __s[__»suÉ] !ğ
__»jeù1


999 && 
__s
[
__»suÉ
] !ğ
__»jeù2
 && __s[__»suÉ] !ğ
__»jeù3
)

1000 ++
__»suÉ
;

1001  
__»suÉ
;

1002 
	}
}

1008 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¥n
 || defšed 
_FORCE_INLINES


1009 #iâdeà
_HAVE_STRING_ARCH_¡r¥n


1010 #ià
__GNUC_PREREQ
 (3, 2)

1011 
	#¡r¥n
(
s
, 
acû±
) \

1012 
__ex‹nsiÚ__
 \

1013 ({ 
__a0
, 
__a1
, 
__a2
; \

1014 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1015 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1016 ? 
	`__butš_¡r¥n
 (
s
, 
acû±
) \

1017 : ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1018 ? ((è(
s
), 0) \

1019 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1020 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1021 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1022 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1023 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1024 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1025 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)))))) \

1026 : 
	`__butš_¡r¥n
 (
s
, 
acû±
)); })

	)

1028 
	#¡r¥n
(
s
, 
acû±
) \

1029 
__ex‹nsiÚ__
 \

1030 ({ 
__a0
, 
__a1
, 
__a2
; \

1031 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1032 ? ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1033 ? ((è(
s
), 0) \

1034 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1035 ? 
	`__¡r¥n_c1
 (
s
, 
__a0
) \

1036 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1037 ? 
	`__¡r¥n_c2
 (
s
, 
__a0
, 
__a1
) \

1038 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1039 ? 
	`__¡r¥n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1040 : 
	`¡r¥n
 (
s
, 
acû±
))))) \

1041 : 
	`¡r¥n
 (
s
, 
acû±
)); })

	)

1045 
__STRING_INLINE
 
size_t
 
__¡r¥n_c1
 (
__cÚ¡
 *
__s
, 
__acû±
);

1046 
__STRING_INLINE
 
size_t


1047 
	$__¡r¥n_c1
 (
__cÚ¡
 *
__s
, 
__acû±
)

1049 
size_t
 
__»suÉ
 = 0;

1051 
__s
[
__»suÉ
] =ğ
__acû±
)

1052 ++
__»suÉ
;

1053  
__»suÉ
;

1054 
	}
}

1056 
__STRING_INLINE
 
size_t
 
__¡r¥n_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1057 
__acû±2
);

1058 
__STRING_INLINE
 
size_t


1059 
	$__¡r¥n_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
)

1061 
size_t
 
__»suÉ
 = 0;

1063 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2
)

1064 ++
__»suÉ
;

1065  
__»suÉ
;

1066 
	}
}

1068 
__STRING_INLINE
 
size_t
 
__¡r¥n_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1069 
__acû±2
, 
__acû±3
);

1070 
__STRING_INLINE
 
size_t


1071 
	$__¡r¥n_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
, 
__acû±3
)

1073 
size_t
 
__»suÉ
 = 0;

1075 
__s
[
__»suÉ
] =ğ
__acû±1
 || __s[__»suÉ] =ğ
__acû±2


1076 || 
__s
[
__»suÉ
] =ğ
__acû±3
)

1077 ++
__»suÉ
;

1078  
__»suÉ
;

1079 
	}
}

1084 #ià!
defšed
 
_HAVE_STRING_ARCH_¡½brk
 || defšed 
_FORCE_INLINES


1085 #iâdeà
_HAVE_STRING_ARCH_¡½brk


1086 #ià
__GNUC_PREREQ
 (3, 2)

1087 
	#¡½brk
(
s
, 
acû±
) \

1088 
__ex‹nsiÚ__
 \

1089 ({ 
__a0
, 
__a1
, 
__a2
; \

1090 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1091 ? ((
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s)) \

1092 ? 
	`__butš_¡½brk
 (
s
, 
acû±
) \

1093 : ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1094 ? ((è(
s
), (*è
NULL
) \

1095 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1096 ? 
	`__butš_¡rchr
 (
s
, 
__a0
) \

1097 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1098 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1099 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1100 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1101 : 
	`__butš_¡½brk
 (
s
, 
acû±
)))))) \

1102 : 
	`__butš_¡½brk
 (
s
, 
acû±
)); })

	)

1104 
	#¡½brk
(
s
, 
acû±
) \

1105 
__ex‹nsiÚ__
 \

1106 ({ 
__a0
, 
__a1
, 
__a2
; \

1107 (
	`__butš_cÚ¡ªt_p
 (
acû±
è&& 
	`__¡ršg2_1b±r_p
 (accept) \

1108 ? ((
__a0
 = ((
__cÚ¡
 *è(
acû±
))[0], __a0 == '\0') \

1109 ? ((è(
s
), (*è
NULL
) \

1110 : ((
__a1
 = ((
__cÚ¡
 *è(
acû±
))[1], __a1 == '\0') \

1111 ? 
	`¡rchr
 (
s
, 
__a0
) \

1112 : ((
__a2
 = ((
__cÚ¡
 *è(
acû±
))[2], __a2 == '\0') \

1113 ? 
	`__¡½brk_c2
 (
s
, 
__a0
, 
__a1
) \

1114 : (((
__cÚ¡
 *è(
acû±
))[3] == '\0' \

1115 ? 
	`__¡½brk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1116 : 
	`¡½brk
 (
s
, 
acû±
))))) \

1117 : 
	`¡½brk
 (
s
, 
acû±
)); })

	)

1121 
__STRING_INLINE
 *
__¡½brk_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1122 
__acû±2
);

1123 
__STRING_INLINE
 *

1124 
	$__¡½brk_c2
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
)

1127 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2
)

1128 ++
__s
;

1129  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1130 
	}
}

1132 
__STRING_INLINE
 *
__¡½brk_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
,

1133 
__acû±2
, 
__acû±3
);

1134 
__STRING_INLINE
 *

1135 
	$__¡½brk_c3
 (
__cÚ¡
 *
__s
, 
__acû±1
, 
__acû±2
,

1136 
__acû±3
)

1139 *
__s
 !ğ'\0' && *__ !ğ
__acû±1
 && *__ !ğ
__acû±2


1140 && *
__s
 !ğ
__acû±3
)

1141 ++
__s
;

1142  *
__s
 =ğ'\0' ? 
NULL
 : (*è(
size_t
) __s;

1143 
	}
}

1149 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r¡r
 && !
__GNUC_PREREQ
 (2, 97)

1150 
	#¡r¡r
(
hay¡ack
, 
ÃedË
) \

1151 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
ÃedË
è&& 
	`__¡ršg2_1b±r_p
 (needle) \

1152 ? (((
__cÚ¡
 *è(
ÃedË
))[0] == '\0' \

1153 ? (*è(
size_t
è(
hay¡ack
) \

1154 : (((
__cÚ¡
 *è(
ÃedË
))[1] == '\0' \

1155 ? 
	`¡rchr
 (
hay¡ack
, \

1156 ((
__cÚ¡
 *è(
ÃedË
))[0]) \

1157 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
))) \

1158 : 
	`¡r¡r
 (
hay¡ack
, 
ÃedË
)))

	)

1162 #ià!
defšed
 
_HAVE_STRING_ARCH_¡¹ok_r
 || defšed 
_FORCE_INLINES


1163 #iâdeà
_HAVE_STRING_ARCH_¡¹ok_r


1164 
	#__¡¹ok_r
(
s
, 
£p
, 
Ãx
) \

1165 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
£p
è&& 
	`__¡ršg2_1b±r_p
 (sep) \

1166 ? (((
__cÚ¡
 *è(
£p
))[0] != '\0' \

1167 && ((
__cÚ¡
 *è(
£p
))[1] == '\0' \

1168 ? 
	`__¡¹ok_r_1c
 (
s
, ((
__cÚ¡
 *è(
£p
))[0], 
Ãx
) \

1169 : 
	`__¡¹ok_r
 (
s
, 
£p
, 
Ãx
)) \

1170 : 
	`__¡¹ok_r
 (
s
, 
£p
, 
Ãx
)))

	)

1173 
__STRING_INLINE
 *
__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
);

1174 
__STRING_INLINE
 *

1175 
	$__¡¹ok_r_1c
 (*
__s
, 
__£p
, **
__Ãx
)

1177 *
__»suÉ
;

1178 ià(
__s
 =ğ
NULL
)

1179 
__s
 = *
__Ãx
;

1180 *
__s
 =ğ
__£p
)

1181 ++
__s
;

1182 
__»suÉ
 = 
NULL
;

1183 ià(*
__s
 != '\0')

1185 
__»suÉ
 = 
__s
++;

1186 *
__s
 != '\0')

1187 ià(*
__s
++ =ğ
__£p
)

1189 
__s
[-1] = '\0';

1192 *
__Ãx
 = 
__s
;

1194  
__»suÉ
;

1195 
	}
}

1196 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


1197 
	#¡¹ok_r
(
s
, 
£p
, 
Ãx
è
	`__¡¹ok_r
 (s, s•,‚ex)

	)

1202 #ià!
defšed
 
_HAVE_STRING_ARCH_¡r£p
 || defšed 
_FORCE_INLINES


1203 #iâdeà
_HAVE_STRING_ARCH_¡r£p


1205 *
__¡r£p_g
 (**
__¡ršgp
, 
__cÚ¡
 *
__d–im
);

1206 
	#__¡r£p
(
s
, 
»jeù
) \

1207 
__ex‹nsiÚ__
 \

1208 ({ 
__r0
, 
__r1
, 
__r2
; \

1209 (
	`__butš_cÚ¡ªt_p
 (
»jeù
è&& 
	`__¡ršg2_1b±r_p
 (reject) \

1210 && (
__r0
 = ((
__cÚ¡
 *è(
»jeù
))[0], \

1211 ((
__cÚ¡
 *è(
»jeù
))[0] != '\0') \

1212 ? ((
__r1
 = ((
__cÚ¡
 *è(
»jeù
))[1], \

1213 ((
__cÚ¡
 *è(
»jeù
))[1] == '\0') \

1214 ? 
	`__¡r£p_1c
 (
s
, 
__r0
) \

1215 : ((
__r2
 = ((
__cÚ¡
 *è(
»jeù
))[2], __r2 == '\0') \

1216 ? 
	`__¡r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1217 : (((
__cÚ¡
 *è(
»jeù
))[3] == '\0' \

1218 ? 
	`__¡r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1219 : 
	`__¡r£p_g
 (
s
, 
»jeù
)))) \

1220 : 
	`__¡r£p_g
 (
s
, 
»jeù
)); })

	)

1223 
__STRING_INLINE
 *
__¡r£p_1c
 (**
__s
, 
__»jeù
);

1224 
__STRING_INLINE
 *

1225 
	$__¡r£p_1c
 (**
__s
, 
__»jeù
)

1227 *
__»tv®
 = *
__s
;

1228 ià(
__»tv®
 !ğ
NULL
 && (*
__s
 = 
	`¡rchr
 (__»tv®, 
__»jeù
)) != NULL)

1229 *(*
__s
)++ = '\0';

1230  
__»tv®
;

1231 
	}
}

1233 
__STRING_INLINE
 *
__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
);

1234 
__STRING_INLINE
 *

1235 
	$__¡r£p_2c
 (**
__s
, 
__»jeù1
, 
__»jeù2
)

1237 *
__»tv®
 = *
__s
;

1238 ià(
__»tv®
 !ğ
NULL
)

1240 *
__ı
 = 
__»tv®
;

1243 ià(*
__ı
 == '\0')

1245 
__ı
 = 
NULL
;

1248 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
)

1250 *
__ı
++ = '\0';

1253 ++
__ı
;

1255 *
__s
 = 
__ı
;

1257  
__»tv®
;

1258 
	}
}

1260 
__STRING_INLINE
 *
__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
,

1261 
__»jeù3
);

1262 
__STRING_INLINE
 *

1263 
	$__¡r£p_3c
 (**
__s
, 
__»jeù1
, 
__»jeù2
, 
__»jeù3
)

1265 *
__»tv®
 = *
__s
;

1266 ià(
__»tv®
 !ğ
NULL
)

1268 *
__ı
 = 
__»tv®
;

1271 ià(*
__ı
 == '\0')

1273 
__ı
 = 
NULL
;

1276 ià(*
__ı
 =ğ
__»jeù1
 || *__ı =ğ
__»jeù2
 || *__ı =ğ
__»jeù3
)

1278 *
__ı
++ = '\0';

1281 ++
__ı
;

1283 *
__s
 = 
__ı
;

1285  
__»tv®
;

1286 
	}
}

1287 #ifdeà
__USE_BSD


1288 
	#¡r£p
(
s
, 
»jeù
è
	`__¡r£p
 (s,„ejeù)

	)

1295 #ifdeà
__USE_MISC


1297 #ià!
defšed
 
_HAVE_STRING_ARCH_¡rdup
 || !defšed 
_HAVE_STRING_ARCH_¡ºdup


1298 
	#__Ãed_m®loc_ªd_ÿÎoc


	)

1299 
	~<¡dlib.h
>

1302 #iâdeà
_HAVE_STRING_ARCH_¡rdup


1304 *
	$__¡rdup
 (
__cÚ¡
 *
__¡ršg
è
__THROW
 
__©Œibu‹_m®loc__
;

1305 
	#__¡rdup
(
s
) \

1306 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1307 ? (((
__cÚ¡
 *è(
s
))[0] == '\0' \

1308 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1309 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1310 *
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1311 ià(
__»tv®
 !ğ
NULL
) \

1312 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, 
__Ën
); \

1313 
__»tv®
; 
	}
})) \

1314 : 
	`__¡rdup
 (
s
)))

	)

1316 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


1317 
	#¡rdup
(
s
è
	`__¡rdup
 (s)

	)

1321 #iâdeà
_HAVE_STRING_ARCH_¡ºdup


1323 *
	$__¡ºdup
 (
__cÚ¡
 *
__¡ršg
, 
size_t
 
__n
)

1324 
__THROW
 
__©Œibu‹_m®loc__
;

1325 
	#__¡ºdup
(
s
, 
n
) \

1326 (
	`__ex‹nsiÚ__
 (
	`__butš_cÚ¡ªt_p
 (
s
è&& 
	`__¡ršg2_1b±r_p
 (s) \

1327 ? (((
__cÚ¡
 *è(
s
))[0] == '\0' \

1328 ? (*è
	`ÿÎoc
 ((
size_t
) 1, (size_t) 1) \

1329 : ({ 
size_t
 
__Ën
 = 
	`¡¾’
 (
s
) + 1; \

1330 
size_t
 
__n
 = (
n
); \

1331 *
__»tv®
; \

1332 ià(
__n
 < 
__Ën
) \

1333 
__Ën
 = 
__n
 + 1; \

1334 
__»tv®
 = (*è
	`m®loc
 (
__Ën
); \

1335 ià(
__»tv®
 !ğ
NULL
) \

1337 
__»tv®
[
__Ën
 - 1] = '\0'; \

1338 
__»tv®
 = (*è
	`memıy
 (__»tv®, 
s
, \

1339 
__Ën
 - 1); \

1341 
__»tv®
; 
	}
})) \

1342 : 
	`__¡ºdup
 (
s
, 
n
)))

	)

1344 #ifdeà
__USE_GNU


1345 
	#¡ºdup
(
s
, 
n
è
	`__¡ºdup
 (s,‚)

	)

1351 #iâdeà
_FORCE_INLINES


1352 #undeà
__STRING_INLINE


	@/usr/include/bits/string3.h

19 #iâdeà
_STRING_H


23 
__w¬ndeş
 (
__w¬n_mem£t_z”o_Ën
,

26 #iâdeà
__ılu¥lus


30 #undeà
memıy


31 #undeà
memmove


32 #undeà
mem£t


33 #undeà
¡rÿt


34 #undeà
¡rıy


35 #undeà
¡ºÿt


36 #undeà
¡ºıy


37 #ifdeà
__USE_GNU


38 #undeà
mempıy


39 #undeà
¡pıy


41 #ifdeà
__USE_BSD


42 #undeà
bcİy


43 #undeà
bz”o


48 
__ex‹º_®ways_šlše
 *

49 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

50 
size_t
 
__Ën
))

52  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

53 
	}
}

55 
__ex‹º_®ways_šlše
 *

56 
__NTH
 (
	$memmove
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

57 
size_t
 
__Ën
))

59  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

60 
	}
}

62 #ifdeà
__USE_GNU


63 
__ex‹º_®ways_šlše
 *

64 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

65 
size_t
 
__Ën
))

67  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

68 
	}
}

77 
__ex‹º_®ways_šlše
 *

78 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

80 ià(
	`__butš_cÚ¡ªt_p
 (
__Ën
) && __len == 0)

82 
	`__w¬n_mem£t_z”o_Ën
 ();

83  
__de¡
;

85  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
, 
	`__bos0
 (__dest));

86 
	}
}

88 #ifdeà
__USE_BSD


89 
__ex‹º_®ways_šlše
 

90 
__NTH
 (
	$bcİy
 (
__cÚ¡
 *
__»¡riù
 
__¤c
, *__»¡riù 
__de¡
,

91 
size_t
 
__Ën
))

93 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

94 
	}
}

96 
__ex‹º_®ways_šlše
 

97 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

99 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
, 
	`__bos0
 (__dest));

100 
	}
}

103 
__ex‹º_®ways_šlše
 *

104 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

106  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

107 
	}
}

109 #ifdeà
__USE_GNU


110 
__ex‹º_®ways_šlše
 *

111 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

113  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

114 
	}
}

118 
__ex‹º_®ways_šlše
 *

119 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

120 
size_t
 
__Ën
))

122  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

123 
	}
}

126 *
	$__¡²ıy_chk
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
,

127 
size_t
 
__de¡Ën
è
__THROW
;

128 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
,

129 
__cÚ¡
 *
__¤c
,

130 
size_t
 
__n
), 
¡²ıy
);

132 
__ex‹º_®ways_šlše
 *

133 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, 
__cÚ¡
 *
__¤c
, 
size_t
 
__n
))

135 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

136 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À<ğ
	`__bos
 (
__de¡
)))

137  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

138  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

139 
	}
}

142 
__ex‹º_®ways_šlše
 *

143 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
))

145  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

146 
	}
}

149 
__ex‹º_®ways_šlše
 *

150 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, 
__cÚ¡
 *__»¡riù 
__¤c
,

151 
size_t
 
__Ën
))

153  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

154 
	}
}

	@/usr/include/bits/sys_errlist.h

20 #iâdeà
_STDIO_H


26 #ifdeà 
__USE_BSD


27 
sys_Ã¼
;

28 
__cÚ¡
 *__cÚ¡ 
sys_”¾i¡
[];

30 #ifdeà 
__USE_GNU


31 
_sys_Ã¼
;

32 
__cÚ¡
 *__cÚ¡ 
_sys_”¾i¡
[];

	@/usr/include/bits/time.h

24 #iâdeà
__Ãed_timev®


25 #iâdeà
_BITS_TIME_H


26 
	#_BITS_TIME_H
 1

	)

34 
	#CLOCKS_PER_SEC
 1000000l

	)

36 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


39 
	~<b™s/ty³s.h
>

40 
__syscÚf
 ();

41 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

44 #ifdeà
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

55 
	#TIMER_ABSTIME
 1

	)

61 #ifdeà
__Ãed_timev®


62 #undeà
__Ãed_timev®


63 #iâdeà
_STRUCT_TIMEVAL


64 
	#_STRUCT_TIMEVAL
 1

	)

65 
	~<b™s/ty³s.h
>

69 
	stimev®


71 
__time_t
 
	mtv_£c
;

72 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/types.h

24 #iâdef 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	t__u_ch¬
;

32 
	t__u_shÜt
;

33 
	t__u_št
;

34 
	t__u_lÚg
;

37 sigÃd 
	t__št8_t
;

38 
	t__ušt8_t
;

39 sigÃd 
	t__št16_t
;

40 
	t__ušt16_t
;

41 sigÃd 
	t__št32_t
;

42 
	t__ušt32_t
;

43 #ià
__WORDSIZE
 == 64

44 sigÃd 
	t__št64_t
;

45 
	t__ušt64_t
;

46 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


47 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

48 
__ex‹nsiÚ__
 
	t__ušt64_t
;

52 #ià
__WORDSIZE
 == 64

53 
	t__quad_t
;

54 
	t__u_quad_t
;

55 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


56 
__ex‹nsiÚ__
 
	t__quad_t
;

57 
__ex‹nsiÚ__
 
	t__u_quad_t
;

61 
	m__v®
[2];

62 } 
	t__quad_t
;

65 
__u_lÚg
 
	m__v®
[2];

66 } 
	t__u_quad_t
;

99 
	#__S16_TYPE
 

	)

100 
	#__U16_TYPE
 

	)

101 
	#__S32_TYPE
 

	)

102 
	#__U32_TYPE
 

	)

103 
	#__SLONGWORD_TYPE
 

	)

104 
	#__ULONGWORD_TYPE
 

	)

105 #ià
__WORDSIZE
 == 32

106 
	#__SQUAD_TYPE
 
__quad_t


	)

107 
	#__UQUAD_TYPE
 
__u_quad_t


	)

108 
	#__SWORD_TYPE
 

	)

109 
	#__UWORD_TYPE
 

	)

110 
	#__SLONG32_TYPE
 

	)

111 
	#__ULONG32_TYPE
 

	)

112 
	#__S64_TYPE
 
__quad_t


	)

113 
	#__U64_TYPE
 
__u_quad_t


	)

116 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

117 #–ià
__WORDSIZE
 == 64

118 
	t__SQUAD_TYPE
 

	)

119 
	t__UQUAD_TYPE
 

	)

120 
	t__SWORD_TYPE
 

	)

121 
	t__UWORD_TYPE
 

	)

122 
	t__SLONG32_TYPE
 

	)

123 
	t__ULONG32_TYPE
 

	)

124 
	t__S64_TYPE
 

	)

125 
	t__U64_TYPE
 

	)

127 
	t__STD_TYPE
 

	)

131 
	~<b™s/ty³sizes.h
>

134 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

135 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

136 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

137 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

138 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

139 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

140 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

141 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

142 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

143 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

144 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

145 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

146 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

147 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

148 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

149 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

150 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

151 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

153 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

154 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

155 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

158 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

161 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

164 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

169 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

170 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

173 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

174 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

177 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

178 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

180 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__off64_t
 
	t__loff_t
;

185 
__quad_t
 *
	t__qaddr_t
;

186 *
	t__ÿddr_t
;

189 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

192 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

195 #undeà
__STD_TYPE


	@/usr/include/bits/unistd.h

20 #iâdeà
_UNISTD_H


24 
ssize_t
 
	$__»ad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

25 
size_t
 
__buæ’
è
__wur
;

26 
ssize_t
 
	`__REDIRECT
 (
__»ad_®Ÿs
, (
__fd
, *
__buf
,

27 
size_t
 
__nby‹s
), 
»ad
è
__wur
;

28 
ssize_t
 
	`__REDIRECT
 (
__»ad_chk_w¬n
,

29 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

30 
size_t
 
__buæ’
), 
__»ad_chk
)

31 
__wur
 
	`__w¬Ç‰r
 ("read called with bigger†engthhan size of "

34 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


35 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
)

37 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

39 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

40  
	`__»ad_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

42 ià(
__nby‹s
 > 
	`__bos0
 (
__buf
))

43  
	`__»ad_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

45  
	`__»ad_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
);

46 
	}
}

48 #ifdeà
__USE_UNIX98


49 
ssize_t
 
	$__´—d_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

50 
__off_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

51 
ssize_t
 
	$__´—d64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

52 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

53 
ssize_t
 
	`__REDIRECT
 (
__´—d_®Ÿs
,

54 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

55 
__off_t
 
__off£t
), 
´—d
è
__wur
;

56 
ssize_t
 
	`__REDIRECT
 (
__´—d64_®Ÿs
,

57 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

58 
__off64_t
 
__off£t
), 
´—d64
è
__wur
;

59 
ssize_t
 
	`__REDIRECT
 (
__´—d_chk_w¬n
,

60 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

61 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__´—d_chk
)

62 
__wur
 
	`__w¬Ç‰r
 ("pread called with bigger†engthhan size of "

64 
ssize_t
 
	`__REDIRECT
 (
__´—d64_chk_w¬n
,

65 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

66 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

67 
__´—d64_chk
)

68 
__wur
 
	`__w¬Ç‰r
 ("pread64 called with bigger†engthhan size of "

71 #iâdeà
__USE_FILE_OFFSET64


72 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


73 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off_t
 
__off£t
)

75 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

77 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

78  
	`__´—d_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

80 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

81  
	`__´—d_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

82 
	`__bos0
 (
__buf
));

84  
	`__´—d_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

85 
	}
}

87 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


88 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

90 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

92 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

93  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

95 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

96  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

97 
	`__bos0
 (
__buf
));

100  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

101 
	}
}

104 #ifdeà
__USE_LARGEFILE64


105 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


106 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

108 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

110 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

111  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

113 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

114  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

115 
	`__bos0
 (
__buf
));

118  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

119 
	}
}

123 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


124 
ssize_t
 
	$__»adlšk_chk
 (
__cÚ¡
 *
__»¡riù
 
__·th
,

125 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

126 
size_t
 
__buæ’
)

127 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

128 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_®Ÿs
,

129 (
__cÚ¡
 *
__»¡riù
 
__·th
,

130 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
), 
»adlšk
)

131 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

132 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_chk_w¬n
,

133 (
__cÚ¡
 *
__»¡riù
 
__·th
,

134 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

135 
size_t
 
__buæ’
), 
__»adlšk_chk
)

136 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
	`__w¬Ç‰r
 ("readlink called with bigger†ength "

139 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
ssize_t


140 
	`__NTH
 (
	$»adlšk
 (
__cÚ¡
 *
__»¡riù
 
__·th
, *__»¡riù 
__buf
,

141 
size_t
 
__Ën
))

143 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

145 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

146  
	`__»adlšk_chk
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

148 iàĞ
__Ën
 > 
	`__bos
 (
__buf
))

149  
	`__»adlšk_chk_w¬n
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

151  
	`__»adlšk_®Ÿs
 (
__·th
, 
__buf
, 
__Ën
);

152 
	}
}

155 #ifdeà
__USE_ATFILE


156 
ssize_t
 
	$__»adlšk©_chk
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

157 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

158 
size_t
 
__buæ’
)

159 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

160 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_®Ÿs
,

161 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

162 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
),

163 
»adlšk©
)

164 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

165 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_chk_w¬n
,

166 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

167 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

168 
size_t
 
__buæ’
), 
__»adlšk©_chk
)

169 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
	`__w¬Ç‰r
 ("readlinkat called with bigger "

173 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
ssize_t


174 
	`__NTH
 (
	$»adlšk©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
))

177 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

179 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

180  
	`__»adlšk©_chk
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

182 ià(
__Ën
 > 
	`__bos
 (
__buf
))

183  
	`__»adlšk©_chk_w¬n
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
,

184 
	`__bos
 (
__buf
));

186  
	`__»adlšk©_®Ÿs
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
);

187 
	}
}

190 *
	$__g‘cwd_chk
 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
)

191 
__THROW
 
__wur
;

192 *
	`__REDIRECT_NTH
 (
__g‘cwd_®Ÿs
,

193 (*
__buf
, 
size_t
 
__size
), 
g‘cwd
è
__wur
;

194 *
	`__REDIRECT_NTH
 (
__g‘cwd_chk_w¬n
,

195 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
),

196 
__g‘cwd_chk
)

197 
__wur
 
	`__w¬Ç‰r
 ("getcwd caller with bigger†engthhan size of "

200 
__ex‹º_®ways_šlše
 
__wur
 *

201 
	`__NTH
 (
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
))

203 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

205 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
))

206  
	`__g‘cwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

208 ià(
__size
 > 
	`__bos
 (
__buf
))

209  
	`__g‘cwd_chk_w¬n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

211  
	`__g‘cwd_®Ÿs
 (
__buf
, 
__size
);

212 
	}
}

214 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


215 *
	$__g‘wd_chk
 (*
__buf
, 
size_t
 
buæ’
)

216 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

217 *
	`__REDIRECT_NTH
 (
__g‘wd_w¬n
, (*
__buf
), 
g‘wd
)

218 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("please use getcwd instead,‡s getwd "

221 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
 *

222 
	`__NTH
 (
	$g‘wd
 (*
__buf
))

224 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

225  
	`__g‘wd_chk
 (
__buf
, 
	`__bos
 (__buf));

226  
	`__g‘wd_w¬n
 (
__buf
);

227 
	}
}

230 
size_t
 
	$__cÚf¡r_chk
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

231 
size_t
 
__buæ’
è
__THROW
;

232 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_®Ÿs
, (
__Çme
, *
__buf
,

233 
size_t
 
__Ën
), 
cÚf¡r
);

234 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_chk_w¬n
,

235 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

236 
size_t
 
__buæ’
), 
__cÚf¡r_chk
)

237 
	`__w¬Ç‰r
 ("confstr called with bigger†engthhan size of destination "

240 
__ex‹º_®ways_šlše
 
size_t


241 
	`__NTH
 (
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
))

243 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

245 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

246  
	`__cÚf¡r_chk
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

248 ià(
	`__bos
 (
__buf
è< 
__Ën
)

249  
	`__cÚf¡r_chk_w¬n
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

251  
	`__cÚf¡r_®Ÿs
 (
__Çme
, 
__buf
, 
__Ën
);

252 
	}
}

255 
	$__g‘groups_chk
 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
)

256 
__THROW
 
__wur
;

257 
	`__REDIRECT_NTH
 (
__g‘groups_®Ÿs
, (
__size
, 
__gid_t
 
__li¡
[]),

258 
g‘groups
è
__wur
;

259 
	`__REDIRECT_NTH
 (
__g‘groups_chk_w¬n
,

260 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
),

261 
__g‘groups_chk
)

262 
__wur
 
	`__w¬Ç‰r
 ("getgroups called with bigger group counthan what "

265 
__ex‹º_®ways_šlše
 

266 
	`__NTH
 (
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]))

268 ià(
	`__bos
 (
__li¡
è!ğ(
size_t
) -1)

270 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
))

271  
	`__g‘groups_chk
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

273 ià(
__size
 *  (
__gid_t
è> 
	`__bos
 (
__li¡
))

274  
	`__g‘groups_chk_w¬n
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

276  
	`__g‘groups_®Ÿs
 (
__size
, 
__li¡
);

277 
	}
}

280 
	$__‰yÇme_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

281 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

282 
	`__REDIRECT_NTH
 (
__‰yÇme_r_®Ÿs
, (
__fd
, *
__buf
,

283 
size_t
 
__buæ’
), 
‰yÇme_r
)

284 
	`__nÚnuÎ
 ((2));

285 
	`__REDIRECT_NTH
 (
__‰yÇme_r_chk_w¬n
,

286 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

287 
size_t
 
__Ä—l
), 
__‰yÇme_r_chk
)

288 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ttyname_r called with bigger buflenhan "

291 
__ex‹º_®ways_šlše
 

292 
	`__NTH
 (
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

294 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

296 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

297  
	`__‰yÇme_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

299 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

300  
	`__‰yÇme_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

302  
	`__‰yÇme_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

303 
	}
}

306 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


307 
	$__g‘logš_r_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

308 
	`__nÚnuÎ
 ((1));

309 
	`__REDIRECT
 (
__g‘logš_r_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

310 
g‘logš_r
è
	`__nÚnuÎ
 ((1));

311 
	`__REDIRECT
 (
__g‘logš_r_chk_w¬n
,

312 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

313 
__g‘logš_r_chk
)

314 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("getlogin_r called with bigger buflenhan "

317 
__ex‹º_®ways_šlše
 

318 
	$g‘logš_r
 (*
__buf
, 
size_t
 
__buæ’
)

320 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

322 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

323  
	`__g‘logš_r_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

325 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

326  
	`__g‘logš_r_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

328  
	`__g‘logš_r_®Ÿs
 (
__buf
, 
__buæ’
);

329 
	}
}

333 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


334 
	$__g‘ho¡Çme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

335 
__THROW
 
	`__nÚnuÎ
 ((1));

336 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

337 
g‘ho¡Çme
è
	`__nÚnuÎ
 ((1));

338 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_chk_w¬n
,

339 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

340 
__g‘ho¡Çme_chk
)

341 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("gethostname called with bigger buflenhan "

344 
__ex‹º_®ways_šlše
 

345 
	`__NTH
 (
	$g‘ho¡Çme
 (*
__buf
, 
size_t
 
__buæ’
))

347 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

349 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

350  
	`__g‘ho¡Çme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

352 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

353  
	`__g‘ho¡Çme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

355  
	`__g‘ho¡Çme_®Ÿs
 (
__buf
, 
__buæ’
);

356 
	}
}

360 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

361 
	$__g‘domašÇme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

362 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

363 
	`__REDIRECT_NTH
 (
__g‘domašÇme_®Ÿs
, (*
__buf
,

364 
size_t
 
__buæ’
),

365 
g‘domašÇme
è
	`__nÚnuÎ
 ((1)è
__wur
;

366 
	`__REDIRECT_NTH
 (
__g‘domašÇme_chk_w¬n
,

367 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

368 
__g‘domašÇme_chk
)

369 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("getdomainname called with bigger "

373 
__ex‹º_®ways_šlše
 

374 
	`__NTH
 (
	$g‘domašÇme
 (*
__buf
, 
size_t
 
__buæ’
))

376 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

378 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

379  
	`__g‘domašÇme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

381 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

382  
	`__g‘domašÇme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

384  
	`__g‘domašÇme_®Ÿs
 (
__buf
, 
__buæ’
);

385 
	}
}

	@/usr/include/bits/utsname.h

19 #iâdeà
_SYS_UTSNAME_H


24 
	#_UTSNAME_LENGTH
 65

	)

29 
	#_UTSNAME_DOMAIN_LENGTH
 
_UTSNAME_LENGTH


	)

	@/usr/include/bits/waitflags.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


26 
	#WNOHANG
 1

	)

27 
	#WUNTRACED
 2

	)

30 
	#WSTOPPED
 2

	)

31 
	#WEXITED
 4

	)

32 
	#WCONTINUED
 8

	)

33 
	#WNOWAIT
 0x01000000

	)

35 
	#__WNOTHREAD
 0x20000000

	)

37 
	#__WALL
 0x40000000

	)

38 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

20 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


29 
	#__WEXITSTATUS
(
¡©us
è(((¡©usè& 0xff00è>> 8)

	)

32 
	#__WTERMSIG
(
¡©us
è((¡©usè& 0x7f)

	)

35 
	#__WSTOPSIG
(
¡©us
è
	`__WEXITSTATUS
(¡©us)

	)

38 
	#__WIFEXITED
(
¡©us
è(
	`__WTERMSIG
(¡©usè=ğ0)

	)

41 
	#__WIFSIGNALED
(
¡©us
) \

42 (((sigÃd è(((
¡©us
è& 0x7fè+ 1è>> 1è> 0)

	)

45 
	#__WIFSTOPPED
(
¡©us
è(((¡©usè& 0xffè=ğ0x7f)

	)

49 #ifdeà
WCONTINUED


50 
	#__WIFCONTINUED
(
¡©us
è((¡©usè=ğ
__W_CONTINUED
)

	)

54 
	#__WCOREDUMP
(
¡©us
è((¡©usè& 
__WCOREFLAG
)

	)

57 
	#__W_EXITCODE
(
»t
, 
sig
è(Ô‘è<< 8 | (sig))

	)

58 
	#__W_STOPCODE
(
sig
è((sigè<< 8 | 0x7f)

	)

59 
	#__W_CONTINUED
 0xffff

	)

60 
	#__WCOREFLAG
 0x80

	)

63 #ifdef 
__USE_BSD


65 
	~<’dŸn.h
>

67 
	uwa™


69 
	mw_¡©us
;

72 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


73 
	m__w_‹rmsig
:7;

74 
	m__w_cÜedump
:1;

75 
	m__w_»tcode
:8;

78 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


80 
	m__w_»tcode
:8;

81 
	m__w_cÜedump
:1;

82 
	m__w_‹rmsig
:7;

84 } 
	m__wa™_‹rmš©ed
;

87 #if 
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


88 
	m__w_¡İv®
:8;

89 
	m__w_¡İsig
:8;

92 #if 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


94 
	m__w_¡İsig
:8;

95 
	m__w_¡İv®
:8;

97 } 
	m__wa™_¡İ³d
;

100 
	#w_‹rmsig
 
__wa™_‹rmš©ed
.
__w_‹rmsig


	)

101 
	#w_cÜedump
 
__wa™_‹rmš©ed
.
__w_cÜedump


	)

102 
	#w_»tcode
 
__wa™_‹rmš©ed
.
__w_»tcode


	)

103 
	#w_¡İsig
 
__wa™_¡İ³d
.
__w_¡İsig


	)

104 
	#w_¡İv®
 
__wa™_¡İ³d
.
__w_¡İv®


	)

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__


4 
	#__WORDSIZE
 64

	)

5 
	#__WORDSIZE_COMPAT32
 1

	)

7 
	#__WORDSIZE
 32

	)

	@/usr/include/bits/xopen_lim.h

30 #iâdeà
_XOPEN_LIM_H


31 
	#_XOPEN_LIM_H
 1

	)

33 
	#__Ãed_IOV_MAX


	)

34 
	~<b™s/¡dio_lim.h
>

66 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

71 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

74 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

77 
	#NL_MSGMAX
 
INT_MAX


	)

81 
	#NL_NMAX
 
INT_MAX


	)

84 
	#NL_SETMAX
 
INT_MAX


	)

87 
	#NL_TEXTMAX
 
INT_MAX


	)

90 
	#NZERO
 20

	)

94 #ifdeà
INT_MAX


95 #ià
INT_MAX
 == 32767

96 
	#WORD_BIT
 16

	)

98 #ià
INT_MAX
 == 2147483647

99 
	#WORD_BIT
 32

	)

102 
	#WORD_BIT
 64

	)

105 #–ià
defšed
 
__INT_MAX__


106 #ià
__INT_MAX__
 == 32767

107 
	#WORD_BIT
 16

	)

109 #ià
__INT_MAX__
 == 2147483647

110 
	#WORD_BIT
 32

	)

113 
	#WORD_BIT
 64

	)

117 
	#WORD_BIT
 32

	)

121 #ifdeà
LONG_MAX


122 #ià
LONG_MAX
 == 2147483647

123 
	#LONG_BIT
 32

	)

126 
	#LONG_BIT
 64

	)

128 #–ià
defšed
 
__LONG_MAX__


129 #ià
__LONG_MAX__
 == 2147483647

130 
	#LONG_BIT
 32

	)

133 
	#LONG_BIT
 64

	)

136 
	~<b™s/wÜdsize.h
>

137 #ià
__WORDSIZE
 == 64

138 
	#LONG_BIT
 64

	)

140 
	#LONG_BIT
 32

	)

	@/usr/include/endian.h

19 #iâdef 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<ã©u»s.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<b™s/’dŸn.h
>

41 #iâdeà
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

54 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

	@/usr/include/errno.h

23 #iâdef 
_ERRNO_H


27 #iâdef 
__Ãed_Em©h


28 
	#_ERRNO_H
 1

	)

29 
	~<ã©u»s.h
>

32 
	g__BEGIN_DECLS


36 
	~<b™s/”ºo.h
>

37 #undeà
__Ãed_Em©h


39 #ifdef 
_ERRNO_H


46 #iâdef 
”ºo


47 
”ºo
;

50 #ifdeà
__USE_GNU


55 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

59 
	g__END_DECLS


67 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


68 #iâdeà
__”rÜ_t_defšed


69 
	t”rÜ_t
;

70 
	#__”rÜ_t_defšed
 1

	)

72 #undeà
__Ãed_”rÜ_t


	@/usr/include/features.h

19 #iâdef 
_FEATURES_H


20 
	#_FEATURES_H
 1

	)

93 #undeà
__USE_ISOC99


94 #undeà
__USE_ISOC95


95 #undeà
__USE_POSIX


96 #undeà
__USE_POSIX2


97 #undeà
__USE_POSIX199309


98 #undeà
__USE_POSIX199506


99 #undeà
__USE_XOPEN


100 #undeà
__USE_XOPEN_EXTENDED


101 #undeà
__USE_UNIX98


102 #undeà
__USE_XOPEN2K


103 #undeà
__USE_LARGEFILE


104 #undeà
__USE_LARGEFILE64


105 #undeà
__USE_FILE_OFFSET64


106 #undeà
__USE_BSD


107 #undeà
__USE_SVID


108 #undeà
__USE_MISC


109 #undeà
__USE_ATFILE


110 #undeà
__USE_GNU


111 #undeà
__USE_REENTRANT


112 #undeà
__USE_FORTIFY_LEVEL


113 #undeà
__FAVOR_BSD


114 #undeà
__KERNEL_STRICT_NAMES


118 #iâdeà
_LOOSE_KERNEL_NAMES


119 
	#__KERNEL_STRICT_NAMES


	)

123 
	#__USE_ANSI
 1

	)

132 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


133 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

134 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

136 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

141 #ià
defšed
 
_BSD_SOURCE
 && \

142 !(
defšed
 
	g_POSIX_SOURCE
 || defšed 
	g_POSIX_C_SOURCE
 || \

143 
defšed
 
	g_XOPEN_SOURCE
 || defšed 
	g_XOPEN_SOURCE_EXTENDED
 || \

144 
defšed
 
	g_GNU_SOURCE
 || defšed 
	g_SVID_SOURCE
)

145 
	#__FAVOR_BSD
 1

	)

149 #ifdeà
_GNU_SOURCE


150 #undeà
_ISOC99_SOURCE


151 
	#_ISOC99_SOURCE
 1

	)

152 #undeà
_POSIX_SOURCE


153 
	#_POSIX_SOURCE
 1

	)

154 #undeà
_POSIX_C_SOURCE


155 
	#_POSIX_C_SOURCE
 200112L

	)

156 #undeà
_XOPEN_SOURCE


157 
	#_XOPEN_SOURCE
 600

	)

158 #undeà
_XOPEN_SOURCE_EXTENDED


159 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

160 #undeà
_LARGEFILE64_SOURCE


161 
	#_LARGEFILE64_SOURCE
 1

	)

162 #undeà
_BSD_SOURCE


163 
	#_BSD_SOURCE
 1

	)

164 #undeà
_SVID_SOURCE


165 
	#_SVID_SOURCE
 1

	)

166 #undeà
_ATFILE_SOURCE


167 
	#_ATFILE_SOURCE
 1

	)

172 #ià(!
defšed
 
__STRICT_ANSI__
 && !defšed 
_ISOC99_SOURCE
 && \

173 !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 && \

174 !
defšed
 
	g_XOPEN_SOURCE
 && !defšed 
	g_XOPEN_SOURCE_EXTENDED
 && \

175 !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
)

176 
	#_BSD_SOURCE
 1

	)

177 
	#_SVID_SOURCE
 1

	)

184 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

185 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

186 
	#__USE_ISOC99
 1

	)

190 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

191 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

192 
	#__USE_ISOC95
 1

	)

197 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

198 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

199 
	#_POSIX_SOURCE
 1

	)

200 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

201 
	#_POSIX_C_SOURCE
 2

	)

202 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

203 
	#_POSIX_C_SOURCE
 199506L

	)

205 
	#_POSIX_C_SOURCE
 200112L

	)

209 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


210 
	#__USE_POSIX
 1

	)

213 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


214 
	#__USE_POSIX2
 1

	)

217 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

218 
	#__USE_POSIX199309
 1

	)

221 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

222 
	#__USE_POSIX199506
 1

	)

225 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

226 
	#__USE_XOPEN2K
 1

	)

229 #ifdef 
_XOPEN_SOURCE


230 
	#__USE_XOPEN
 1

	)

231 #ià(
_XOPEN_SOURCE
 - 0) >= 500

232 
	#__USE_XOPEN_EXTENDED
 1

	)

233 
	#__USE_UNIX98
 1

	)

234 #undeà
_LARGEFILE_SOURCE


235 
	#_LARGEFILE_SOURCE
 1

	)

236 #ià(
_XOPEN_SOURCE
 - 0) >= 600

237 
	#__USE_XOPEN2K
 1

	)

238 #undeà
__USE_ISOC99


239 
	#__USE_ISOC99
 1

	)

242 #ifdeà
_XOPEN_SOURCE_EXTENDED


243 
	#__USE_XOPEN_EXTENDED
 1

	)

248 #ifdeà
_LARGEFILE_SOURCE


249 
	#__USE_LARGEFILE
 1

	)

252 #ifdeà
_LARGEFILE64_SOURCE


253 
	#__USE_LARGEFILE64
 1

	)

256 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

257 
	#__USE_FILE_OFFSET64
 1

	)

260 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


261 
	#__USE_MISC
 1

	)

264 #ifdef 
_BSD_SOURCE


265 
	#__USE_BSD
 1

	)

268 #ifdef 
_SVID_SOURCE


269 
	#__USE_SVID
 1

	)

272 #ifdef 
_ATFILE_SOURCE


273 
	#__USE_ATFILE
 1

	)

276 #ifdef 
_GNU_SOURCE


277 
	#__USE_GNU
 1

	)

280 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


281 
	#__USE_REENTRANT
 1

	)

284 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

285 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

286 #ià
_FORTIFY_SOURCE
 > 1

287 
	#__USE_FORTIFY_LEVEL
 2

	)

289 
	#__USE_FORTIFY_LEVEL
 1

	)

292 
	#__USE_FORTIFY_LEVEL
 0

	)

296 
	#__STDC_IEC_559__
 1

	)

297 
	#__STDC_IEC_559_COMPLEX__
 1

	)

300 
	#__STDC_ISO_10646__
 200009L

	)

308 #undeà
__GNU_LIBRARY__


309 
	#__GNU_LIBRARY__
 6

	)

313 
	#__GLIBC__
 2

	)

314 
	#__GLIBC_MINOR__
 7

	)

316 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

317 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

320 #ià
defšed
 
__GNUC__
 \

321 || (
defšed
 
	g__PGI
 && defšed 
	g__i386__
 ) \

322 || (
defšed
 
	g__INTEL_COMPILER
 && (defšed 
	g__i386__
 || defšed 
	g__Ÿ64__
)) \

323 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

324 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

328 #iâdeà
__ASSEMBLER__


329 #iâdeà
_SYS_CDEFS_H


330 
	~<sys/cdefs.h
>

335 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


336 
	#__USE_LARGEFILE
 1

	)

337 
	#__USE_LARGEFILE64
 1

	)

343 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

344 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

345 && 
defšed
 
	g__ex‹º_šlše


346 
	#__USE_EXTERN_INLINES
 1

	)

354 
	~<gnu/¡ubs.h
>

	@/usr/include/libio.h

29 #iâdeà
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_cÚfig.h
>

34 
	#_IO_pos_t
 
_G_åos_t


	)

35 
	#_IO_åos_t
 
_G_åos_t


	)

36 
	#_IO_åos64_t
 
_G_åos64_t


	)

37 
	#_IO_size_t
 
_G_size_t


	)

38 
	#_IO_ssize_t
 
_G_ssize_t


	)

39 
	#_IO_off_t
 
_G_off_t


	)

40 
	#_IO_off64_t
 
_G_off64_t


	)

41 
	#_IO_pid_t
 
_G_pid_t


	)

42 
	#_IO_uid_t
 
_G_uid_t


	)

43 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

44 
	#_IO_HAVE_SYS_WAIT
 
_G_HAVE_SYS_WAIT


	)

45 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

46 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

47 
	#_IO_va_li¡
 
_G_va_li¡


	)

48 
	#_IO_wšt_t
 
_G_wšt_t


	)

50 #ifdeà
_G_NEED_STDARG_H


52 
	#__Ãed___va_li¡


	)

53 
	~<¡d¬g.h
>

54 #ifdeà
__GNUC_VA_LIST


55 #undeà
_IO_va_li¡


56 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

60 #iâdeà
__P


61 #ià
_G_HAVE_SYS_CDEFS


62 
	~<sys/cdefs.h
>

64 #ifdeà
__STDC__


65 
	#__P
(
p
è
	)
p

66 
	#__PMT
(
p
è
	)
p

68 
	#__P
(
p
è()

	)

69 
	#__PMT
(
p
è()

	)

75 #iâdeà
_PARAMS


76 
	#_PARAMS
(
´Ùos
è
	`__P
ÕrÙos)

	)

79 #iâdeà
__STDC__


81 cÚ¡

	)

84 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

85 #iâdeà
_G_HAVE_PRINTF_FP


86 
	#_IO_USE_DTOA
 1

	)

89 #iâdeà
EOF


90 
	#EOF
 (-1)

	)

92 #iâdeà
NULL


93 #ià
defšed
 
__GNUG__
 && \

94 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

95 
	#NULL
 (
__nuÎ
)

	)

97 #ià!
defšed
(
__ılu¥lus
)

98 
	#NULL
 ((*)0)

	)

100 
	#NULL
 (0)

	)

105 
	#_IOS_INPUT
 1

	)

106 
	#_IOS_OUTPUT
 2

	)

107 
	#_IOS_ATEND
 4

	)

108 
	#_IOS_APPEND
 8

	)

109 
	#_IOS_TRUNC
 16

	)

110 
	#_IOS_NOCREATE
 32

	)

111 
	#_IOS_NOREPLACE
 64

	)

112 
	#_IOS_BIN
 128

	)

120 
	#_IO_MAGIC
 0xFBAD0000

	)

121 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

122 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

123 
	#_IO_USER_BUF
 1

	)

124 
	#_IO_UNBUFFERED
 2

	)

125 
	#_IO_NO_READS
 4

	)

126 
	#_IO_NO_WRITES
 8

	)

127 
	#_IO_EOF_SEEN
 0x10

	)

128 
	#_IO_ERR_SEEN
 0x20

	)

129 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

130 
	#_IO_LINKED
 0x80

	)

131 
	#_IO_IN_BACKUP
 0x100

	)

132 
	#_IO_LINE_BUF
 0x200

	)

133 
	#_IO_TIED_PUT_GET
 0x400

	)

134 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

135 
	#_IO_IS_APPENDING
 0x1000

	)

136 
	#_IO_IS_FILEBUF
 0x2000

	)

137 
	#_IO_BAD_SEEN
 0x4000

	)

138 
	#_IO_USER_LOCK
 0x8000

	)

140 
	#_IO_FLAGS2_MMAP
 1

	)

141 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

142 #ifdeà
_LIBC


143 
	#_IO_FLAGS2_FORTIFY
 4

	)

145 
	#_IO_FLAGS2_USER_WBUF
 8

	)

146 #ifdeà
_LIBC


147 
	#_IO_FLAGS2_SCANF_STD
 16

	)

151 
	#_IO_SKIPWS
 01

	)

152 
	#_IO_LEFT
 02

	)

153 
	#_IO_RIGHT
 04

	)

154 
	#_IO_INTERNAL
 010

	)

155 
	#_IO_DEC
 020

	)

156 
	#_IO_OCT
 040

	)

157 
	#_IO_HEX
 0100

	)

158 
	#_IO_SHOWBASE
 0200

	)

159 
	#_IO_SHOWPOINT
 0400

	)

160 
	#_IO_UPPERCASE
 01000

	)

161 
	#_IO_SHOWPOS
 02000

	)

162 
	#_IO_SCIENTIFIC
 04000

	)

163 
	#_IO_FIXED
 010000

	)

164 
	#_IO_UNITBUF
 020000

	)

165 
	#_IO_STDIO
 040000

	)

166 
	#_IO_DONT_CLOSE
 0100000

	)

167 
	#_IO_BOOLALPHA
 0200000

	)

170 
_IO_jump_t
; 
	g_IO_FILE
;

173 #ifdeà
_IO_MTSAFE_IO


174 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

175 
	~<b™s/¡dio-lock.h
>

180 
	t_IO_lock_t
;

186 
	s_IO_m¬k”
 {

187 
_IO_m¬k”
 *
	m_Ãxt
;

188 
_IO_FILE
 *
	m_sbuf
;

192 
	m_pos
;

194 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

195 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

196 
	mpublic
:

197 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

198 ~
¡»amm¬k”
();

199 
§všg
(è{  
	m_¥os
 == -2; }

200 
d–
(
¡»amm¬k”
&);

201 
d–
();

206 
	e__codecvt_»suÉ


208 
	m__codecvt_ok
,

209 
	m__codecvt_·¹Ÿl
,

210 
	m__codecvt_”rÜ
,

211 
	m__codecvt_nocÚv


214 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


217 
	s_IO_codecvt


219 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

220 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

221 
	m__mb¡©e_t
 *,

222 cÚ¡ 
	mwch¬_t
 *,

223 cÚ¡ 
	mwch¬_t
 *,

224 cÚ¡ 
	mwch¬_t
 **, *,

226 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

227 
	m__mb¡©e_t
 *, *,

229 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

230 
	m__mb¡©e_t
 *,

232 cÚ¡ **, 
	mwch¬_t
 *,

233 
	mwch¬_t
 *, wchar_t **);

234 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

235 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

236 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

237 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

238 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

240 
_IO_icÚv_t
 
	m__cd_š
;

241 
_IO_icÚv_t
 
	m__cd_out
;

245 
	s_IO_wide_d©a


247 
wch¬_t
 *
	m_IO_»ad_±r
;

248 
wch¬_t
 *
	m_IO_»ad_’d
;

249 
wch¬_t
 *
	m_IO_»ad_ba£
;

250 
wch¬_t
 *
	m_IO_wr™e_ba£
;

251 
wch¬_t
 *
	m_IO_wr™e_±r
;

252 
wch¬_t
 *
	m_IO_wr™e_’d
;

253 
wch¬_t
 *
	m_IO_buf_ba£
;

254 
wch¬_t
 *
	m_IO_buf_’d
;

256 
wch¬_t
 *
	m_IO_§ve_ba£
;

257 
wch¬_t
 *
	m_IO_backup_ba£
;

259 
wch¬_t
 *
	m_IO_§ve_’d
;

261 
__mb¡©e_t
 
	m_IO_¡©e
;

262 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

263 
_IO_codecvt
 
	m_codecvt
;

265 
wch¬_t
 
	m_shÜtbuf
[1];

267 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

271 
	s_IO_FILE
 {

272 
	m_æags
;

273 
	#_IO_fe_æags
 
_æags


	)

277 * 
	m_IO_»ad_±r
;

278 * 
	m_IO_»ad_’d
;

279 * 
	m_IO_»ad_ba£
;

280 * 
	m_IO_wr™e_ba£
;

281 * 
	m_IO_wr™e_±r
;

282 * 
	m_IO_wr™e_’d
;

283 * 
	m_IO_buf_ba£
;

284 * 
	m_IO_buf_’d
;

286 *
	m_IO_§ve_ba£
;

287 *
	m_IO_backup_ba£
;

288 *
	m_IO_§ve_’d
;

290 
_IO_m¬k”
 *
	m_m¬k”s
;

292 
_IO_FILE
 *
	m_chaš
;

294 
	m_f’o
;

296 
	m_blksize
;

298 
	m_æags2
;

300 
_IO_off_t
 
	m_Şd_off£t
;

302 
	#__HAVE_COLUMN


	)

304 
	m_cur_cŞumn
;

305 sigÃd 
	m_vbË_off£t
;

306 
	m_shÜtbuf
[1];

310 
_IO_lock_t
 *
	m_lock
;

311 #ifdeà
_IO_USE_OLD_IO_FILE


314 
	s_IO_FILE_com¶‘e


316 
_IO_FILE
 
	m_fe
;

318 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

319 
_IO_off64_t
 
	m_off£t
;

320 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


322 
_IO_codecvt
 *
	m_codecvt
;

323 
_IO_wide_d©a
 *
	m_wide_d©a
;

324 
_IO_FILE
 *
	m_ä“»s_li¡
;

325 *
	m_ä“»s_buf
;

326 
size_t
 
	m_ä“»s_size
;

328 *
	m__·d1
;

329 *
	m__·d2
;

330 *
	m__·d3
;

331 *
	m__·d4
;

332 
size_t
 
	m__·d5
;

334 
	m_mode
;

336 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

340 #iâdeà
__ılu¥lus


341 
_IO_FILE
 
	t_IO_FILE
;

344 
	g_IO_FILE_¶us
;

346 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

347 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

348 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

349 #iâdeà
_LIBC


350 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

351 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

352 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

354 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

355 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

356 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

364 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

372 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, 
	t__cÚ¡
 *
	t__buf
,

373 
	tsize_t
 
	t__n
);

381 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

384 
	t__io_şo£_â
 (*
	t__cook›
);

387 #ifdeà
_GNU_SOURCE


389 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

390 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

391 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

392 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

397 
__io_»ad_â
 *
	m»ad
;

398 
__io_wr™e_â
 *
	mwr™e
;

399 
__io_£ek_â
 *
	m£ek
;

400 
__io_şo£_â
 *
	mşo£
;

401 } 
	t_IO_cook›_io_funùiÚs_t
;

402 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

404 
	g_IO_cook›_fe
;

407 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

408 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

412 #ifdeà
__ılu¥lus


416 
__und”æow
 (
_IO_FILE
 *);

417 
__uæow
 (
_IO_FILE
 *);

418 
__ov”æow
 (
_IO_FILE
 *, );

419 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


420 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

421 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

422 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

425 #ià 
__GNUC__
 >= 3

426 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

428 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

431 
	#_IO_g‘c_uÆocked
(
_å
) \

432 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

433 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

434 
	#_IO_³ekc_uÆocked
(
_å
) \

435 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

436 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

437 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

438 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

439 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

440 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

441 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

443 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


444 
	#_IO_g‘wc_uÆocked
(
_å
) \

445 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 >ğ(_å)->_wide_d©a->
_IO_»ad_’d
,\

447 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

448 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

449 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

450 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
, 0) \

451 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

452 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

455 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

456 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

458 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

459 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

460 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

461 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

463 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

466 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

467 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

469 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

470 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

471 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

473 #ifdeà
_IO_MTSAFE_IO


474 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

475 
	#_IO_æockfe
(
_å
) \

476 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

477 
	#_IO_fuÆockfe
(
_å
) \

478 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

480 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

481 
	#_IO_æockfe
(
_å
è

	)

482 
	#_IO_fuÆockfe
(
_å
è

	)

483 
	#_IO_árylockfe
(
_å
è

	)

484 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

485 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

488 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

489 
_IO_va_li¡
, *
__»¡riù
);

490 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

491 
_IO_va_li¡
);

492 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

493 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

495 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

496 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

498 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

500 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


501 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

502 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

503 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

504 #ià
__GNUC__
 >= 2

507 #ià
defšed
 
_LIBC
 && defšed 
SHARED


508 
	~<shlib-com·t.h
>

509 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

510 
	#_IO_fwide_maybe_šcom·tibË
 \

511 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

512 cÚ¡ 
_IO_¡dš_u£d
;

513 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

516 #iâdeà
_IO_fwide_maybe_šcom·tibË


517 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

521 
	#_IO_fwide
(
__å
, 
__mode
) \

522 ({ 
__»suÉ
 = (
__mode
); \

523 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

525 ià((
__å
)->
_mode
 == 0) \

527 (
__å
)->
_mode
 = -1; \

528 
__»suÉ
 = (
__å
)->
_mode
; \

530 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

531 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

533 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

534 
__»suÉ
; })

	)

537 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

538 
_IO_va_li¡
, *
__»¡riù
);

539 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

540 
_IO_va_li¡
);

541 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

542 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

545 #ifdeà
__LDBL_COMPAT


546 
	~<b™s/libio-ldbl.h
>

549 #ifdeà
__ılu¥lus


	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

9 
	#SI_LOAD_SHIFT
 16

	)

10 
	ssysšfo
 {

11 
	mu±ime
;

12 
	mlßds
[3];

13 
	mtÙ®¿m
;

14 
	mä“¿m
;

15 
	msh¬ed¿m
;

16 
	mbufã¼am
;

17 
	mtÙ®sw­
;

18 
	mä“sw­
;

19 
	m´ocs
;

20 
	m·d
;

21 
	mtÙ®high
;

22 
	mä“high
;

23 
	mmem_un™
;

24 
	m_f
[20-2*()-()];

28 
	#BUILD_BUG_ON
(
cÚd™iÚ
è(()([1 - 2*!!(cÚd™iÚ)]))

	)

34 
	#BUILD_BUG_ON_ZERO
(
e
è(([1 - 2 * !!Ó)]è- 1)

	)

37 
	#__FUNCTION__
 (
__func__
)

	)

40 #ifdeà
CONFIG_NUMA


41 
	#NUMA_BUILD
 1

	)

43 
	#NUMA_BUILD
 0

	)

	@/usr/include/linux/sysctl.h

25 #iâdeà
_LINUX_SYSCTL_H


26 
	#_LINUX_SYSCTL_H


	)

28 
	~<lšux/k”Ãl.h
>

29 
	~<lšux/ty³s.h
>

31 
	gfe
;

32 
	gcom¶‘iÚ
;

34 
	#CTL_MAXNAME
 10

	)

39 
	s__sysùl_¬gs
 {

40 *
	mÇme
;

41 
	mÆ’
;

42 *
	mŞdv®
;

43 
size_t
 *
	mŞdËÅ
;

44 *
	mÃwv®
;

45 
size_t
 
	mÃwËn
;

46 
	m__unu£d
[4];

57 
	mCTL_KERN
=1,

58 
	mCTL_VM
=2,

59 
	mCTL_NET
=3,

60 
	mCTL_PROC
=4,

61 
	mCTL_FS
=5,

62 
	mCTL_DEBUG
=6,

63 
	mCTL_DEV
=7,

64 
	mCTL_BUS
=8,

65 
	mCTL_ABI
=9,

66 
	mCTL_CPU
=10,

67 
	mCTL_ARLAN
=254,

68 
	mCTL_S390DBF
=5677,

69 
	mCTL_SUNRPC
=7249,

70 
	mCTL_PM
=9899,

71 
	mCTL_FRV
=9898,

77 
	mCTL_BUS_ISA
=1

83 
	mINOTIFY_MAX_USER_INSTANCES
=1,

84 
	mINOTIFY_MAX_USER_WATCHES
=2,

85 
	mINOTIFY_MAX_QUEUED_EVENTS
=3

91 
	mKERN_OSTYPE
=1,

92 
	mKERN_OSRELEASE
=2,

93 
	mKERN_OSREV
=3,

94 
	mKERN_VERSION
=4,

95 
	mKERN_SECUREMASK
=5,

96 
	mKERN_PROF
=6,

97 
	mKERN_NODENAME
=7,

98 
	mKERN_DOMAINNAME
=8,

100 
	mKERN_PANIC
=15,

101 
	mKERN_REALROOTDEV
=16,

103 
	mKERN_SPARC_REBOOT
=21,

104 
	mKERN_CTLALTDEL
=22,

105 
	mKERN_PRINTK
=23,

106 
	mKERN_NAMETRANS
=24,

107 
	mKERN_PPC_HTABRECLAIM
=25,

108 
	mKERN_PPC_ZEROPAGED
=26,

109 
	mKERN_PPC_POWERSAVE_NAP
=27,

110 
	mKERN_MODPROBE
=28,

111 
	mKERN_SG_BIG_BUFF
=29,

112 
	mKERN_ACCT
=30,

113 
	mKERN_PPC_L2CR
=31,

115 
	mKERN_RTSIGNR
=32,

116 
	mKERN_RTSIGMAX
=33,

118 
	mKERN_SHMMAX
=34,

119 
	mKERN_MSGMAX
=35,

120 
	mKERN_MSGMNB
=36,

121 
	mKERN_MSGPOOL
=37,

122 
	mKERN_SYSRQ
=38,

123 
	mKERN_MAX_THREADS
=39,

124 
	mKERN_RANDOM
=40,

125 
	mKERN_SHMALL
=41,

126 
	mKERN_MSGMNI
=42,

127 
	mKERN_SEM
=43,

128 
	mKERN_SPARC_STOP_A
=44,

129 
	mKERN_SHMMNI
=45,

130 
	mKERN_OVERFLOWUID
=46,

131 
	mKERN_OVERFLOWGID
=47,

132 
	mKERN_SHMPATH
=48,

133 
	mKERN_HOTPLUG
=49,

134 
	mKERN_IEEE_EMULATION_WARNINGS
=50,

135 
	mKERN_S390_USER_DEBUG_LOGGING
=51,

136 
	mKERN_CORE_USES_PID
=52,

137 
	mKERN_TAINTED
=53,

138 
	mKERN_CADPID
=54,

139 
	mKERN_PIDMAX
=55,

140 
	mKERN_CORE_PATTERN
=56,

141 
	mKERN_PANIC_ON_OOPS
=57,

142 
	mKERN_HPPA_PWRSW
=58,

143 
	mKERN_HPPA_UNALIGNED
=59,

144 
	mKERN_PRINTK_RATELIMIT
=60,

145 
	mKERN_PRINTK_RATELIMIT_BURST
=61,

146 
	mKERN_PTY
=62,

147 
	mKERN_NGROUPS_MAX
=63,

148 
	mKERN_SPARC_SCONS_PWROFF
=64,

149 
	mKERN_HZ_TIMER
=65,

150 
	mKERN_UNKNOWN_NMI_PANIC
=66,

151 
	mKERN_BOOTLOADER_TYPE
=67,

152 
	mKERN_RANDOMIZE
=68,

153 
	mKERN_SETUID_DUMPABLE
=69,

154 
	mKERN_SPIN_RETRY
=70,

155 
	mKERN_ACPI_VIDEO_FLAGS
=71,

156 
	mKERN_IA64_UNALIGNED
=72,

157 
	mKERN_COMPAT_LOG
=73,

158 
	mKERN_MAX_LOCK_DEPTH
=74,

159 
	mKERN_NMI_WATCHDOG
=75,

160 
	mKERN_PANIC_ON_NMI
=76,

168 
	mVM_UNUSED1
=1,

169 
	mVM_UNUSED2
=2,

170 
	mVM_UNUSED3
=3,

171 
	mVM_UNUSED4
=4,

172 
	mVM_OVERCOMMIT_MEMORY
=5,

173 
	mVM_UNUSED5
=6,

174 
	mVM_UNUSED7
=7,

175 
	mVM_UNUSED8
=8,

176 
	mVM_UNUSED9
=9,

177 
	mVM_PAGE_CLUSTER
=10,

178 
	mVM_DIRTY_BACKGROUND
=11,

179 
	mVM_DIRTY_RATIO
=12,

180 
	mVM_DIRTY_WB_CS
=13,

181 
	mVM_DIRTY_EXPIRE_CS
=14,

182 
	mVM_NR_PDFLUSH_THREADS
=15,

183 
	mVM_OVERCOMMIT_RATIO
=16,

184 
	mVM_PAGEBUF
=17,

185 
	mVM_HUGETLB_PAGES
=18,

186 
	mVM_SWAPPINESS
=19,

187 
	mVM_LOWMEM_RESERVE_RATIO
=20,

188 
	mVM_MIN_FREE_KBYTES
=21,

189 
	mVM_MAX_MAP_COUNT
=22,

190 
	mVM_LAPTOP_MODE
=23,

191 
	mVM_BLOCK_DUMP
=24,

192 
	mVM_HUGETLB_GROUP
=25,

193 
	mVM_VFS_CACHE_PRESSURE
=26,

194 
	mVM_LEGACY_VA_LAYOUT
=27,

195 
	mVM_SWAP_TOKEN_TIMEOUT
=28,

196 
	mVM_DROP_PAGECACHE
=29,

197 
	mVM_PERCPU_PAGELIST_FRACTION
=30,

198 
	mVM_ZONE_RECLAIM_MODE
=31,

199 
	mVM_MIN_UNMAPPED
=32,

200 
	mVM_PANIC_ON_OOM
=33,

201 
	mVM_VDSO_ENABLED
=34,

202 
	mVM_MIN_SLAB
=35,

209 
	mNET_CORE
=1,

210 
	mNET_ETHER
=2,

211 
	mNET_802
=3,

212 
	mNET_UNIX
=4,

213 
	mNET_IPV4
=5,

214 
	mNET_IPX
=6,

215 
	mNET_ATALK
=7,

216 
	mNET_NETROM
=8,

217 
	mNET_AX25
=9,

218 
	mNET_BRIDGE
=10,

219 
	mNET_ROSE
=11,

220 
	mNET_IPV6
=12,

221 
	mNET_X25
=13,

222 
	mNET_TR
=14,

223 
	mNET_DECNET
=15,

224 
	mNET_ECONET
=16,

225 
	mNET_SCTP
=17,

226 
	mNET_LLC
=18,

227 
	mNET_NETFILTER
=19,

228 
	mNET_DCCP
=20,

229 
	mNET_IRDA
=412,

235 
	mRANDOM_POOLSIZE
=1,

236 
	mRANDOM_ENTROPY_COUNT
=2,

237 
	mRANDOM_READ_THRESH
=3,

238 
	mRANDOM_WRITE_THRESH
=4,

239 
	mRANDOM_BOOT_ID
=5,

240 
	mRANDOM_UUID
=6

246 
	mPTY_MAX
=1,

247 
	mPTY_NR
=2

253 
	mBUS_ISA_MEM_BASE
=1,

254 
	mBUS_ISA_PORT_BASE
=2,

255 
	mBUS_ISA_PORT_SHIFT
=3

261 
	mNET_CORE_WMEM_MAX
=1,

262 
	mNET_CORE_RMEM_MAX
=2,

263 
	mNET_CORE_WMEM_DEFAULT
=3,

264 
	mNET_CORE_RMEM_DEFAULT
=4,

266 
	mNET_CORE_MAX_BACKLOG
=6,

267 
	mNET_CORE_FASTROUTE
=7,

268 
	mNET_CORE_MSG_COST
=8,

269 
	mNET_CORE_MSG_BURST
=9,

270 
	mNET_CORE_OPTMEM_MAX
=10,

271 
	mNET_CORE_HOT_LIST_LENGTH
=11,

272 
	mNET_CORE_DIVERT_VERSION
=12,

273 
	mNET_CORE_NO_CONG_THRESH
=13,

274 
	mNET_CORE_NO_CONG
=14,

275 
	mNET_CORE_LO_CONG
=15,

276 
	mNET_CORE_MOD_CONG
=16,

277 
	mNET_CORE_DEV_WEIGHT
=17,

278 
	mNET_CORE_SOMAXCONN
=18,

279 
	mNET_CORE_BUDGET
=19,

280 
	mNET_CORE_AEVENT_ETIME
=20,

281 
	mNET_CORE_AEVENT_RSEQTH
=21,

282 
	mNET_CORE_WARNINGS
=22,

293 
	mNET_UNIX_DESTROY_DELAY
=1,

294 
	mNET_UNIX_DELETE_DELAY
=2,

295 
	mNET_UNIX_MAX_DGRAM_QLEN
=3,

301 
	mNET_NF_CONNTRACK_MAX
=1,

302 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

303 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

304 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

305 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

306 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

307 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

308 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

309 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

310 
	mNET_NF_CONNTRACK_UDP_TIMEOUT
=10,

311 
	mNET_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

312 
	mNET_NF_CONNTRACK_ICMP_TIMEOUT
=12,

313 
	mNET_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

314 
	mNET_NF_CONNTRACK_BUCKETS
=14,

315 
	mNET_NF_CONNTRACK_LOG_INVALID
=15,

316 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

317 
	mNET_NF_CONNTRACK_TCP_LOOSE
=17,

318 
	mNET_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

319 
	mNET_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

320 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

321 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

322 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

323 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

324 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

325 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

326 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

327 
	mNET_NF_CONNTRACK_COUNT
=27,

328 
	mNET_NF_CONNTRACK_ICMPV6_TIMEOUT
=28,

329 
	mNET_NF_CONNTRACK_FRAG6_TIMEOUT
=29,

330 
	mNET_NF_CONNTRACK_FRAG6_LOW_THRESH
=30,

331 
	mNET_NF_CONNTRACK_FRAG6_HIGH_THRESH
=31,

332 
	mNET_NF_CONNTRACK_CHECKSUM
=32,

339 
	mNET_IPV4_FORWARD
=8,

340 
	mNET_IPV4_DYNADDR
=9,

342 
	mNET_IPV4_CONF
=16,

343 
	mNET_IPV4_NEIGH
=17,

344 
	mNET_IPV4_ROUTE
=18,

345 
	mNET_IPV4_FIB_HASH
=19,

346 
	mNET_IPV4_NETFILTER
=20,

348 
	mNET_IPV4_TCP_TIMESTAMPS
=33,

349 
	mNET_IPV4_TCP_WINDOW_SCALING
=34,

350 
	mNET_IPV4_TCP_SACK
=35,

351 
	mNET_IPV4_TCP_RETRANS_COLLAPSE
=36,

352 
	mNET_IPV4_DEFAULT_TTL
=37,

353 
	mNET_IPV4_AUTOCONFIG
=38,

354 
	mNET_IPV4_NO_PMTU_DISC
=39,

355 
	mNET_IPV4_TCP_SYN_RETRIES
=40,

356 
	mNET_IPV4_IPFRAG_HIGH_THRESH
=41,

357 
	mNET_IPV4_IPFRAG_LOW_THRESH
=42,

358 
	mNET_IPV4_IPFRAG_TIME
=43,

359 
	mNET_IPV4_TCP_MAX_KA_PROBES
=44,

360 
	mNET_IPV4_TCP_KEEPALIVE_TIME
=45,

361 
	mNET_IPV4_TCP_KEEPALIVE_PROBES
=46,

362 
	mNET_IPV4_TCP_RETRIES1
=47,

363 
	mNET_IPV4_TCP_RETRIES2
=48,

364 
	mNET_IPV4_TCP_FIN_TIMEOUT
=49,

365 
	mNET_IPV4_IP_MASQ_DEBUG
=50,

366 
	mNET_TCP_SYNCOOKIES
=51,

367 
	mNET_TCP_STDURG
=52,

368 
	mNET_TCP_RFC1337
=53,

369 
	mNET_TCP_SYN_TAILDROP
=54,

370 
	mNET_TCP_MAX_SYN_BACKLOG
=55,

371 
	mNET_IPV4_LOCAL_PORT_RANGE
=56,

372 
	mNET_IPV4_ICMP_ECHO_IGNORE_ALL
=57,

373 
	mNET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS
=58,

374 
	mNET_IPV4_ICMP_SOURCEQUENCH_RATE
=59,

375 
	mNET_IPV4_ICMP_DESTUNREACH_RATE
=60,

376 
	mNET_IPV4_ICMP_TIMEEXCEED_RATE
=61,

377 
	mNET_IPV4_ICMP_PARAMPROB_RATE
=62,

378 
	mNET_IPV4_ICMP_ECHOREPLY_RATE
=63,

379 
	mNET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES
=64,

380 
	mNET_IPV4_IGMP_MAX_MEMBERSHIPS
=65,

381 
	mNET_TCP_TW_RECYCLE
=66,

382 
	mNET_IPV4_ALWAYS_DEFRAG
=67,

383 
	mNET_IPV4_TCP_KEEPALIVE_INTVL
=68,

384 
	mNET_IPV4_INET_PEER_THRESHOLD
=69,

385 
	mNET_IPV4_INET_PEER_MINTTL
=70,

386 
	mNET_IPV4_INET_PEER_MAXTTL
=71,

387 
	mNET_IPV4_INET_PEER_GC_MINTIME
=72,

388 
	mNET_IPV4_INET_PEER_GC_MAXTIME
=73,

389 
	mNET_TCP_ORPHAN_RETRIES
=74,

390 
	mNET_TCP_ABORT_ON_OVERFLOW
=75,

391 
	mNET_TCP_SYNACK_RETRIES
=76,

392 
	mNET_TCP_MAX_ORPHANS
=77,

393 
	mNET_TCP_MAX_TW_BUCKETS
=78,

394 
	mNET_TCP_FACK
=79,

395 
	mNET_TCP_REORDERING
=80,

396 
	mNET_TCP_ECN
=81,

397 
	mNET_TCP_DSACK
=82,

398 
	mNET_TCP_MEM
=83,

399 
	mNET_TCP_WMEM
=84,

400 
	mNET_TCP_RMEM
=85,

401 
	mNET_TCP_APP_WIN
=86,

402 
	mNET_TCP_ADV_WIN_SCALE
=87,

403 
	mNET_IPV4_NONLOCAL_BIND
=88,

404 
	mNET_IPV4_ICMP_RATELIMIT
=89,

405 
	mNET_IPV4_ICMP_RATEMASK
=90,

406 
	mNET_TCP_TW_REUSE
=91,

407 
	mNET_TCP_FRTO
=92,

408 
	mNET_TCP_LOW_LATENCY
=93,

409 
	mNET_IPV4_IPFRAG_SECRET_INTERVAL
=94,

410 
	mNET_IPV4_IGMP_MAX_MSF
=96,

411 
	mNET_TCP_NO_METRICS_SAVE
=97,

412 
	mNET_TCP_DEFAULT_WIN_SCALE
=105,

413 
	mNET_TCP_MODERATE_RCVBUF
=106,

414 
	mNET_TCP_TSO_WIN_DIVISOR
=107,

415 
	mNET_TCP_BIC_BETA
=108,

416 
	mNET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR
=109,

417 
	mNET_TCP_CONG_CONTROL
=110,

418 
	mNET_TCP_ABC
=111,

419 
	mNET_IPV4_IPFRAG_MAX_DIST
=112,

420 
	mNET_TCP_MTU_PROBING
=113,

421 
	mNET_TCP_BASE_MSS
=114,

422 
	mNET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS
=115,

423 
	mNET_TCP_DMA_COPYBREAK
=116,

424 
	mNET_TCP_SLOW_START_AFTER_IDLE
=117,

425 
	mNET_CIPSOV4_CACHE_ENABLE
=118,

426 
	mNET_CIPSOV4_CACHE_BUCKET_SIZE
=119,

427 
	mNET_CIPSOV4_RBM_OPTFMT
=120,

428 
	mNET_CIPSOV4_RBM_STRICTVALID
=121,

429 
	mNET_TCP_AVAIL_CONG_CONTROL
=122,

430 
	mNET_TCP_ALLOWED_CONG_CONTROL
=123,

431 
	mNET_TCP_MAX_SSTHRESH
=124,

432 
	mNET_TCP_FRTO_RESPONSE
=125,

436 
	mNET_IPV4_ROUTE_FLUSH
=1,

437 
	mNET_IPV4_ROUTE_MIN_DELAY
=2,

438 
	mNET_IPV4_ROUTE_MAX_DELAY
=3,

439 
	mNET_IPV4_ROUTE_GC_THRESH
=4,

440 
	mNET_IPV4_ROUTE_MAX_SIZE
=5,

441 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL
=6,

442 
	mNET_IPV4_ROUTE_GC_TIMEOUT
=7,

443 
	mNET_IPV4_ROUTE_GC_INTERVAL
=8,

444 
	mNET_IPV4_ROUTE_REDIRECT_LOAD
=9,

445 
	mNET_IPV4_ROUTE_REDIRECT_NUMBER
=10,

446 
	mNET_IPV4_ROUTE_REDIRECT_SILENCE
=11,

447 
	mNET_IPV4_ROUTE_ERROR_COST
=12,

448 
	mNET_IPV4_ROUTE_ERROR_BURST
=13,

449 
	mNET_IPV4_ROUTE_GC_ELASTICITY
=14,

450 
	mNET_IPV4_ROUTE_MTU_EXPIRES
=15,

451 
	mNET_IPV4_ROUTE_MIN_PMTU
=16,

452 
	mNET_IPV4_ROUTE_MIN_ADVMSS
=17,

453 
	mNET_IPV4_ROUTE_SECRET_INTERVAL
=18,

454 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL_MS
=19,

459 
	mNET_PROTO_CONF_ALL
=-2,

460 
	mNET_PROTO_CONF_DEFAULT
=-3

467 
	mNET_IPV4_CONF_FORWARDING
=1,

468 
	mNET_IPV4_CONF_MC_FORWARDING
=2,

469 
	mNET_IPV4_CONF_PROXY_ARP
=3,

470 
	mNET_IPV4_CONF_ACCEPT_REDIRECTS
=4,

471 
	mNET_IPV4_CONF_SECURE_REDIRECTS
=5,

472 
	mNET_IPV4_CONF_SEND_REDIRECTS
=6,

473 
	mNET_IPV4_CONF_SHARED_MEDIA
=7,

474 
	mNET_IPV4_CONF_RP_FILTER
=8,

475 
	mNET_IPV4_CONF_ACCEPT_SOURCE_ROUTE
=9,

476 
	mNET_IPV4_CONF_BOOTP_RELAY
=10,

477 
	mNET_IPV4_CONF_LOG_MARTIANS
=11,

478 
	mNET_IPV4_CONF_TAG
=12,

479 
	mNET_IPV4_CONF_ARPFILTER
=13,

480 
	mNET_IPV4_CONF_MEDIUM_ID
=14,

481 
	mNET_IPV4_CONF_NOXFRM
=15,

482 
	mNET_IPV4_CONF_NOPOLICY
=16,

483 
	mNET_IPV4_CONF_FORCE_IGMP_VERSION
=17,

484 
	mNET_IPV4_CONF_ARP_ANNOUNCE
=18,

485 
	mNET_IPV4_CONF_ARP_IGNORE
=19,

486 
	mNET_IPV4_CONF_PROMOTE_SECONDARIES
=20,

487 
	mNET_IPV4_CONF_ARP_ACCEPT
=21,

488 
	m__NET_IPV4_CONF_MAX


494 
	mNET_IPV4_NF_CONNTRACK_MAX
=1,

495 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

496 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

497 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

498 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

499 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

500 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

501 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

502 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

503 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT
=10,

504 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

505 
	mNET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT
=12,

506 
	mNET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

507 
	mNET_IPV4_NF_CONNTRACK_BUCKETS
=14,

508 
	mNET_IPV4_NF_CONNTRACK_LOG_INVALID
=15,

509 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

510 
	mNET_IPV4_NF_CONNTRACK_TCP_LOOSE
=17,

511 
	mNET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

512 
	mNET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

513 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

514 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

515 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

516 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

517 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

518 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

519 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

520 
	mNET_IPV4_NF_CONNTRACK_COUNT
=27,

521 
	mNET_IPV4_NF_CONNTRACK_CHECKSUM
=28,

526 
	mNET_IPV6_CONF
=16,

527 
	mNET_IPV6_NEIGH
=17,

528 
	mNET_IPV6_ROUTE
=18,

529 
	mNET_IPV6_ICMP
=19,

530 
	mNET_IPV6_BINDV6ONLY
=20,

531 
	mNET_IPV6_IP6FRAG_HIGH_THRESH
=21,

532 
	mNET_IPV6_IP6FRAG_LOW_THRESH
=22,

533 
	mNET_IPV6_IP6FRAG_TIME
=23,

534 
	mNET_IPV6_IP6FRAG_SECRET_INTERVAL
=24,

535 
	mNET_IPV6_MLD_MAX_MSF
=25,

539 
	mNET_IPV6_ROUTE_FLUSH
=1,

540 
	mNET_IPV6_ROUTE_GC_THRESH
=2,

541 
	mNET_IPV6_ROUTE_MAX_SIZE
=3,

542 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL
=4,

543 
	mNET_IPV6_ROUTE_GC_TIMEOUT
=5,

544 
	mNET_IPV6_ROUTE_GC_INTERVAL
=6,

545 
	mNET_IPV6_ROUTE_GC_ELASTICITY
=7,

546 
	mNET_IPV6_ROUTE_MTU_EXPIRES
=8,

547 
	mNET_IPV6_ROUTE_MIN_ADVMSS
=9,

548 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL_MS
=10

552 
	mNET_IPV6_FORWARDING
=1,

553 
	mNET_IPV6_HOP_LIMIT
=2,

554 
	mNET_IPV6_MTU
=3,

555 
	mNET_IPV6_ACCEPT_RA
=4,

556 
	mNET_IPV6_ACCEPT_REDIRECTS
=5,

557 
	mNET_IPV6_AUTOCONF
=6,

558 
	mNET_IPV6_DAD_TRANSMITS
=7,

559 
	mNET_IPV6_RTR_SOLICITS
=8,

560 
	mNET_IPV6_RTR_SOLICIT_INTERVAL
=9,

561 
	mNET_IPV6_RTR_SOLICIT_DELAY
=10,

562 
	mNET_IPV6_USE_TEMPADDR
=11,

563 
	mNET_IPV6_TEMP_VALID_LFT
=12,

564 
	mNET_IPV6_TEMP_PREFERED_LFT
=13,

565 
	mNET_IPV6_REGEN_MAX_RETRY
=14,

566 
	mNET_IPV6_MAX_DESYNC_FACTOR
=15,

567 
	mNET_IPV6_MAX_ADDRESSES
=16,

568 
	mNET_IPV6_FORCE_MLD_VERSION
=17,

569 
	mNET_IPV6_ACCEPT_RA_DEFRTR
=18,

570 
	mNET_IPV6_ACCEPT_RA_PINFO
=19,

571 
	mNET_IPV6_ACCEPT_RA_RTR_PREF
=20,

572 
	mNET_IPV6_RTR_PROBE_INTERVAL
=21,

573 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN
=22,

574 
	mNET_IPV6_PROXY_NDP
=23,

575 
	mNET_IPV6_ACCEPT_SOURCE_ROUTE
=25,

576 
	m__NET_IPV6_MAX


581 
	mNET_IPV6_ICMP_RATELIMIT
=1

586 
	mNET_NEIGH_MCAST_SOLICIT
=1,

587 
	mNET_NEIGH_UCAST_SOLICIT
=2,

588 
	mNET_NEIGH_APP_SOLICIT
=3,

589 
	mNET_NEIGH_RETRANS_TIME
=4,

590 
	mNET_NEIGH_REACHABLE_TIME
=5,

591 
	mNET_NEIGH_DELAY_PROBE_TIME
=6,

592 
	mNET_NEIGH_GC_STALE_TIME
=7,

593 
	mNET_NEIGH_UNRES_QLEN
=8,

594 
	mNET_NEIGH_PROXY_QLEN
=9,

595 
	mNET_NEIGH_ANYCAST_DELAY
=10,

596 
	mNET_NEIGH_PROXY_DELAY
=11,

597 
	mNET_NEIGH_LOCKTIME
=12,

598 
	mNET_NEIGH_GC_INTERVAL
=13,

599 
	mNET_NEIGH_GC_THRESH1
=14,

600 
	mNET_NEIGH_GC_THRESH2
=15,

601 
	mNET_NEIGH_GC_THRESH3
=16,

602 
	mNET_NEIGH_RETRANS_TIME_MS
=17,

603 
	mNET_NEIGH_REACHABLE_TIME_MS
=18,

604 
	m__NET_NEIGH_MAX


609 
	mNET_DCCP_DEFAULT
=1,

614 
	mNET_IPX_PPROP_BROADCASTING
=1,

615 
	mNET_IPX_FORWARDING
=2

620 
	mNET_LLC2
=1,

621 
	mNET_LLC_STATION
=2,

626 
	mNET_LLC2_TIMEOUT
=1,

631 
	mNET_LLC_STATION_ACK_TIMEOUT
=1,

636 
	mNET_LLC2_ACK_TIMEOUT
=1,

637 
	mNET_LLC2_P_TIMEOUT
=2,

638 
	mNET_LLC2_REJ_TIMEOUT
=3,

639 
	mNET_LLC2_BUSY_TIMEOUT
=4,

644 
	mNET_ATALK_AARP_EXPIRY_TIME
=1,

645 
	mNET_ATALK_AARP_TICK_TIME
=2,

646 
	mNET_ATALK_AARP_RETRANSMIT_LIMIT
=3,

647 
	mNET_ATALK_AARP_RESOLVE_TIME
=4

653 
	mNET_NETROM_DEFAULT_PATH_QUALITY
=1,

654 
	mNET_NETROM_OBSOLESCENCE_COUNT_INITIALISER
=2,

655 
	mNET_NETROM_NETWORK_TTL_INITIALISER
=3,

656 
	mNET_NETROM_TRANSPORT_TIMEOUT
=4,

657 
	mNET_NETROM_TRANSPORT_MAXIMUM_TRIES
=5,

658 
	mNET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY
=6,

659 
	mNET_NETROM_TRANSPORT_BUSY_DELAY
=7,

660 
	mNET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE
=8,

661 
	mNET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT
=9,

662 
	mNET_NETROM_ROUTING_CONTROL
=10,

663 
	mNET_NETROM_LINK_FAILS_COUNT
=11,

664 
	mNET_NETROM_RESET
=12

669 
	mNET_AX25_IP_DEFAULT_MODE
=1,

670 
	mNET_AX25_DEFAULT_MODE
=2,

671 
	mNET_AX25_BACKOFF_TYPE
=3,

672 
	mNET_AX25_CONNECT_MODE
=4,

673 
	mNET_AX25_STANDARD_WINDOW
=5,

674 
	mNET_AX25_EXTENDED_WINDOW
=6,

675 
	mNET_AX25_T1_TIMEOUT
=7,

676 
	mNET_AX25_T2_TIMEOUT
=8,

677 
	mNET_AX25_T3_TIMEOUT
=9,

678 
	mNET_AX25_IDLE_TIMEOUT
=10,

679 
	mNET_AX25_N2
=11,

680 
	mNET_AX25_PACLEN
=12,

681 
	mNET_AX25_PROTOCOL
=13,

682 
	mNET_AX25_DAMA_SLAVE_TIMEOUT
=14

687 
	mNET_ROSE_RESTART_REQUEST_TIMEOUT
=1,

688 
	mNET_ROSE_CALL_REQUEST_TIMEOUT
=2,

689 
	mNET_ROSE_RESET_REQUEST_TIMEOUT
=3,

690 
	mNET_ROSE_CLEAR_REQUEST_TIMEOUT
=4,

691 
	mNET_ROSE_ACK_HOLD_BACK_TIMEOUT
=5,

692 
	mNET_ROSE_ROUTING_CONTROL
=6,

693 
	mNET_ROSE_LINK_FAIL_TIMEOUT
=7,

694 
	mNET_ROSE_MAX_VCS
=8,

695 
	mNET_ROSE_WINDOW_SIZE
=9,

696 
	mNET_ROSE_NO_ACTIVITY_TIMEOUT
=10

701 
	mNET_X25_RESTART_REQUEST_TIMEOUT
=1,

702 
	mNET_X25_CALL_REQUEST_TIMEOUT
=2,

703 
	mNET_X25_RESET_REQUEST_TIMEOUT
=3,

704 
	mNET_X25_CLEAR_REQUEST_TIMEOUT
=4,

705 
	mNET_X25_ACK_HOLD_BACK_TIMEOUT
=5,

706 
	mNET_X25_FORWARD
=6

712 
	mNET_TR_RIF_TIMEOUT
=1

717 
	mNET_DECNET_NODE_TYPE
 = 1,

718 
	mNET_DECNET_NODE_ADDRESS
 = 2,

719 
	mNET_DECNET_NODE_NAME
 = 3,

720 
	mNET_DECNET_DEFAULT_DEVICE
 = 4,

721 
	mNET_DECNET_TIME_WAIT
 = 5,

722 
	mNET_DECNET_DN_COUNT
 = 6,

723 
	mNET_DECNET_DI_COUNT
 = 7,

724 
	mNET_DECNET_DR_COUNT
 = 8,

725 
	mNET_DECNET_DST_GC_INTERVAL
 = 9,

726 
	mNET_DECNET_CONF
 = 10,

727 
	mNET_DECNET_NO_FC_MAX_CWND
 = 11,

728 
	mNET_DECNET_MEM
 = 12,

729 
	mNET_DECNET_RMEM
 = 13,

730 
	mNET_DECNET_WMEM
 = 14,

731 
	mNET_DECNET_DEBUG_LEVEL
 = 255

736 
	mNET_DECNET_CONF_LOOPBACK
 = -2,

737 
	mNET_DECNET_CONF_DDCMP
 = -3,

738 
	mNET_DECNET_CONF_PPP
 = -4,

739 
	mNET_DECNET_CONF_X25
 = -5,

740 
	mNET_DECNET_CONF_GRE
 = -6,

741 
	mNET_DECNET_CONF_ETHER
 = -7

748 
	mNET_DECNET_CONF_DEV_PRIORITY
 = 1,

749 
	mNET_DECNET_CONF_DEV_T1
 = 2,

750 
	mNET_DECNET_CONF_DEV_T2
 = 3,

751 
	mNET_DECNET_CONF_DEV_T3
 = 4,

752 
	mNET_DECNET_CONF_DEV_FORWARDING
 = 5,

753 
	mNET_DECNET_CONF_DEV_BLKSIZE
 = 6,

754 
	mNET_DECNET_CONF_DEV_STATE
 = 7

759 
	mNET_SCTP_RTO_INITIAL
 = 1,

760 
	mNET_SCTP_RTO_MIN
 = 2,

761 
	mNET_SCTP_RTO_MAX
 = 3,

762 
	mNET_SCTP_RTO_ALPHA
 = 4,

763 
	mNET_SCTP_RTO_BETA
 = 5,

764 
	mNET_SCTP_VALID_COOKIE_LIFE
 = 6,

765 
	mNET_SCTP_ASSOCIATION_MAX_RETRANS
 = 7,

766 
	mNET_SCTP_PATH_MAX_RETRANS
 = 8,

767 
	mNET_SCTP_MAX_INIT_RETRANSMITS
 = 9,

768 
	mNET_SCTP_HB_INTERVAL
 = 10,

769 
	mNET_SCTP_PRESERVE_ENABLE
 = 11,

770 
	mNET_SCTP_MAX_BURST
 = 12,

771 
	mNET_SCTP_ADDIP_ENABLE
 = 13,

772 
	mNET_SCTP_PRSCTP_ENABLE
 = 14,

773 
	mNET_SCTP_SNDBUF_POLICY
 = 15,

774 
	mNET_SCTP_SACK_TIMEOUT
 = 16,

775 
	mNET_SCTP_RCVBUF_POLICY
 = 17,

780 
	mNET_BRIDGE_NF_CALL_ARPTABLES
 = 1,

781 
	mNET_BRIDGE_NF_CALL_IPTABLES
 = 2,

782 
	mNET_BRIDGE_NF_CALL_IP6TABLES
 = 3,

783 
	mNET_BRIDGE_NF_FILTER_VLAN_TAGGED
 = 4,

784 
	mNET_BRIDGE_NF_FILTER_PPPOE_TAGGED
 = 5,

789 
	mNET_IRDA_DISCOVERY
=1,

790 
	mNET_IRDA_DEVNAME
=2,

791 
	mNET_IRDA_DEBUG
=3,

792 
	mNET_IRDA_FAST_POLL
=4,

793 
	mNET_IRDA_DISCOVERY_SLOTS
=5,

794 
	mNET_IRDA_DISCOVERY_TIMEOUT
=6,

795 
	mNET_IRDA_SLOT_TIMEOUT
=7,

796 
	mNET_IRDA_MAX_BAUD_RATE
=8,

797 
	mNET_IRDA_MIN_TX_TURN_TIME
=9,

798 
	mNET_IRDA_MAX_TX_DATA_SIZE
=10,

799 
	mNET_IRDA_MAX_TX_WINDOW
=11,

800 
	mNET_IRDA_MAX_NOREPLY_TIME
=12,

801 
	mNET_IRDA_WARN_NOREPLY_TIME
=13,

802 
	mNET_IRDA_LAP_KEEPALIVE_TIME
=14,

809 
	mFS_NRINODE
=1,

810 
	mFS_STATINODE
=2,

811 
	mFS_MAXINODE
=3,

812 
	mFS_NRDQUOT
=4,

813 
	mFS_MAXDQUOT
=5,

814 
	mFS_NRFILE
=6,

815 
	mFS_MAXFILE
=7,

816 
	mFS_DENTRY
=8,

817 
	mFS_NRSUPER
=9,

818 
	mFS_MAXSUPER
=10,

819 
	mFS_OVERFLOWUID
=11,

820 
	mFS_OVERFLOWGID
=12,

821 
	mFS_LEASES
=13,

822 
	mFS_DIR_NOTIFY
=14,

823 
	mFS_LEASE_TIME
=15,

824 
	mFS_DQSTATS
=16,

825 
	mFS_XFS
=17,

826 
	mFS_AIO_NR
=18,

827 
	mFS_AIO_MAX_NR
=19,

828 
	mFS_INOTIFY
=20,

829 
	mFS_OCFS2
=988,

834 
	mFS_DQ_LOOKUPS
 = 1,

835 
	mFS_DQ_DROPS
 = 2,

836 
	mFS_DQ_READS
 = 3,

837 
	mFS_DQ_WRITES
 = 4,

838 
	mFS_DQ_CACHE_HITS
 = 5,

839 
	mFS_DQ_ALLOCATED
 = 6,

840 
	mFS_DQ_FREE
 = 7,

841 
	mFS_DQ_SYNCS
 = 8,

842 
	mFS_DQ_WARNINGS
 = 9,

849 
	mDEV_CDROM
=1,

850 
	mDEV_HWMON
=2,

851 
	mDEV_PARPORT
=3,

852 
	mDEV_RAID
=4,

853 
	mDEV_MAC_HID
=5,

854 
	mDEV_SCSI
=6,

855 
	mDEV_IPMI
=7,

860 
	mDEV_CDROM_INFO
=1,

861 
	mDEV_CDROM_AUTOCLOSE
=2,

862 
	mDEV_CDROM_AUTOEJECT
=3,

863 
	mDEV_CDROM_DEBUG
=4,

864 
	mDEV_CDROM_LOCK
=5,

865 
	mDEV_CDROM_CHECK_MEDIA
=6

870 
	mDEV_PARPORT_DEFAULT
=-3

875 
	mDEV_RAID_SPEED_LIMIT_MIN
=1,

876 
	mDEV_RAID_SPEED_LIMIT_MAX
=2

881 
	mDEV_PARPORT_DEFAULT_TIMESLICE
=1,

882 
	mDEV_PARPORT_DEFAULT_SPINTIME
=2

887 
	mDEV_PARPORT_SPINTIME
=1,

888 
	mDEV_PARPORT_BASE_ADDR
=2,

889 
	mDEV_PARPORT_IRQ
=3,

890 
	mDEV_PARPORT_DMA
=4,

891 
	mDEV_PARPORT_MODES
=5,

892 
	mDEV_PARPORT_DEVICES
=6,

893 
	mDEV_PARPORT_AUTOPROBE
=16

898 
	mDEV_PARPORT_DEVICES_ACTIVE
=-3,

903 
	mDEV_PARPORT_DEVICE_TIMESLICE
=1,

908 
	mDEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES
=1,

909 
	mDEV_MAC_HID_KEYBOARD_LOCK_KEYCODES
=2,

910 
	mDEV_MAC_HID_MOUSE_BUTTON_EMULATION
=3,

911 
	mDEV_MAC_HID_MOUSE_BUTTON2_KEYCODE
=4,

912 
	mDEV_MAC_HID_MOUSE_BUTTON3_KEYCODE
=5,

913 
	mDEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES
=6

918 
	mDEV_SCSI_LOGGING_LEVEL
=1,

923 
	mDEV_IPMI_POWEROFF_POWERCYCLE
=1,

929 
	mABI_DEFHANDLER_COFF
=1,

930 
	mABI_DEFHANDLER_ELF
=2,

931 
	mABI_DEFHANDLER_LCALL7
=3,

932 
	mABI_DEFHANDLER_LIBCSO
=4,

933 
	mABI_TRACE
=5,

934 
	mABI_FAKE_UTSNAME
=6,

	@/usr/include/locale.h

23 #iâdef 
_LOCALE_H


24 
	#_LOCALE_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

30 
	~<b™s/loÿË.h
>

32 
	g__BEGIN_DECLS


36 
	#LC_CTYPE
 
__LC_CTYPE


	)

37 
	#LC_NUMERIC
 
__LC_NUMERIC


	)

38 
	#LC_TIME
 
__LC_TIME


	)

39 
	#LC_COLLATE
 
__LC_COLLATE


	)

40 
	#LC_MONETARY
 
__LC_MONETARY


	)

41 
	#LC_MESSAGES
 
__LC_MESSAGES


	)

42 
	#LC_ALL
 
__LC_ALL


	)

43 
	#LC_PAPER
 
__LC_PAPER


	)

44 
	#LC_NAME
 
__LC_NAME


	)

45 
	#LC_ADDRESS
 
__LC_ADDRESS


	)

46 
	#LC_TELEPHONE
 
__LC_TELEPHONE


	)

47 
	#LC_MEASUREMENT
 
__LC_MEASUREMENT


	)

48 
	#LC_IDENTIFICATION
 
__LC_IDENTIFICATION


	)

51 
__BEGIN_NAMESPACE_STD


54 
	slcÚv


58 *
	mdecim®_pošt
;

59 *
	mthou§nds_£p
;

65 *
	mgroupšg
;

71 *
	mšt_cu¼_symbŞ
;

72 *
	mcu¼’cy_symbŞ
;

73 *
	mmÚ_decim®_pošt
;

74 *
	mmÚ_thou§nds_£p
;

75 *
	mmÚ_groupšg
;

76 *
	mpos™ive_sign
;

77 *
	mÃg©ive_sign
;

78 
	mšt_äac_dig™s
;

79 
	mäac_dig™s
;

81 
	mp_cs_´eûdes
;

83 
	mp_£p_by_¥aû
;

85 
	mn_cs_´eûdes
;

87 
	mn_£p_by_¥aû
;

94 
	mp_sign_po¢
;

95 
	mn_sign_po¢
;

96 #ifdeà
__USE_ISOC99


98 
	mšt_p_cs_´eûdes
;

100 
	mšt_p_£p_by_¥aû
;

102 
	mšt_n_cs_´eûdes
;

104 
	mšt_n_£p_by_¥aû
;

111 
	mšt_p_sign_po¢
;

112 
	mšt_n_sign_po¢
;

114 
	m__št_p_cs_´eûdes
;

115 
	m__št_p_£p_by_¥aû
;

116 
	m__št_n_cs_´eûdes
;

117 
	m__št_n_£p_by_¥aû
;

118 
	m__št_p_sign_po¢
;

119 
	m__št_n_sign_po¢
;

125 *
	$£oÿË
 (
__ÿ‹gÜy
, 
__cÚ¡
 *
__loÿË
è
__THROW
;

128 
lcÚv
 *
	$loÿËcÚv
 (è
__THROW
;

130 
__END_NAMESPACE_STD


133 #ifdef 
__USE_GNU


146 
	~<xloÿË.h
>

148 
__loÿË_t
 
	tloÿË_t
;

154 
__loÿË_t
 
	$ÃwloÿË
 (
__ÿ‹gÜy_mask
, 
__cÚ¡
 *
__loÿË
,

155 
__loÿË_t
 
__ba£
è
__THROW
;

161 
	#LC_CTYPE_MASK
 (1 << 
__LC_CTYPE
)

	)

162 
	#LC_NUMERIC_MASK
 (1 << 
__LC_NUMERIC
)

	)

163 
	#LC_TIME_MASK
 (1 << 
__LC_TIME
)

	)

164 
	#LC_COLLATE_MASK
 (1 << 
__LC_COLLATE
)

	)

165 
	#LC_MONETARY_MASK
 (1 << 
__LC_MONETARY
)

	)

166 
	#LC_MESSAGES_MASK
 (1 << 
__LC_MESSAGES
)

	)

167 
	#LC_PAPER_MASK
 (1 << 
__LC_PAPER
)

	)

168 
	#LC_NAME_MASK
 (1 << 
__LC_NAME
)

	)

169 
	#LC_ADDRESS_MASK
 (1 << 
__LC_ADDRESS
)

	)

170 
	#LC_TELEPHONE_MASK
 (1 << 
__LC_TELEPHONE
)

	)

171 
	#LC_MEASUREMENT_MASK
 (1 << 
__LC_MEASUREMENT
)

	)

172 
	#LC_IDENTIFICATION_MASK
 (1 << 
__LC_IDENTIFICATION
)

	)

173 
	#LC_ALL_MASK
 (
LC_CTYPE_MASK
 \

174 | 
LC_NUMERIC_MASK
 \

175 | 
LC_TIME_MASK
 \

176 | 
LC_COLLATE_MASK
 \

177 | 
LC_MONETARY_MASK
 \

178 | 
LC_MESSAGES_MASK
 \

179 | 
LC_PAPER_MASK
 \

180 | 
LC_NAME_MASK
 \

181 | 
LC_ADDRESS_MASK
 \

182 | 
LC_TELEPHONE_MASK
 \

183 | 
LC_MEASUREMENT_MASK
 \

184 | 
LC_IDENTIFICATION_MASK
 \

185 )

	)

189 
__loÿË_t
 
	$du¶oÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

193 
	$ä“loÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

200 
__loÿË_t
 
	$u£loÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

204 
	#LC_GLOBAL_LOCALE
 ((
__loÿË_t
è-1L)

	)

208 
__END_DECLS


	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (
__cÚ¡
 *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (
__cÚ¡
 *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/stdint.h

23 #iâdeà
_STDINT_H


24 
	#_STDINT_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wch¬.h
>

28 
	~<b™s/wÜdsize.h
>

35 #iâdeà
__št8_t_defšed


36 
	#__št8_t_defšed


	)

37 sigÃd 
	tšt8_t
;

38 
	tšt16_t
;

39 
	tšt32_t
;

40 #ià
__WORDSIZE
 == 64

41 
	tšt64_t
;

43 
__ex‹nsiÚ__


44 
	tšt64_t
;

49 
	tušt8_t
;

50 
	tušt16_t
;

51 #iâdeà
__ušt32_t_defšed


52 
	tušt32_t
;

53 
	#__ušt32_t_defšed


	)

55 #ià
__WORDSIZE
 == 64

56 
	tušt64_t
;

58 
__ex‹nsiÚ__


59 
	tušt64_t
;

66 sigÃd 
	tšt_Ëa¡8_t
;

67 
	tšt_Ëa¡16_t
;

68 
	tšt_Ëa¡32_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_Ëa¡64_t
;

72 
__ex‹nsiÚ__


73 
	tšt_Ëa¡64_t
;

77 
	tušt_Ëa¡8_t
;

78 
	tušt_Ëa¡16_t
;

79 
	tušt_Ëa¡32_t
;

80 #ià
__WORDSIZE
 == 64

81 
	tušt_Ëa¡64_t
;

83 
__ex‹nsiÚ__


84 
	tušt_Ëa¡64_t
;

91 sigÃd 
	tšt_ç¡8_t
;

92 #ià
__WORDSIZE
 == 64

93 
	tšt_ç¡16_t
;

94 
	tšt_ç¡32_t
;

95 
	tšt_ç¡64_t
;

97 
	tšt_ç¡16_t
;

98 
	tšt_ç¡32_t
;

99 
__ex‹nsiÚ__


100 
	tšt_ç¡64_t
;

104 
	tušt_ç¡8_t
;

105 #ià
__WORDSIZE
 == 64

106 
	tušt_ç¡16_t
;

107 
	tušt_ç¡32_t
;

108 
	tušt_ç¡64_t
;

110 
	tušt_ç¡16_t
;

111 
	tušt_ç¡32_t
;

112 
__ex‹nsiÚ__


113 
	tušt_ç¡64_t
;

118 #ià
__WORDSIZE
 == 64

119 #iâdeà
__šŒ_t_defšed


120 
	tšŒ_t
;

121 
	#__šŒ_t_defšed


	)

123 
	tušŒ_t
;

125 #iâdeà
__šŒ_t_defšed


126 
	tšŒ_t
;

127 
	#__šŒ_t_defšed


	)

129 
	tušŒ_t
;

134 #ià
__WORDSIZE
 == 64

135 
	tštmax_t
;

136 
	tuštmax_t
;

138 
__ex‹nsiÚ__


139 
	tštmax_t
;

140 
__ex‹nsiÚ__


141 
	tuštmax_t
;

147 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_LIMIT_MACROS


149 #ià
__WORDSIZE
 == 64

150 
	#__INT64_C
(
c
èø## 
L


	)

151 
	#__UINT64_C
(
c
èø## 
UL


	)

153 
	#__INT64_C
(
c
èø## 
LL


	)

154 
	#__UINT64_C
(
c
èø## 
ULL


	)

160 
	#INT8_MIN
 (-128)

	)

161 
	#INT16_MIN
 (-32767-1)

	)

162 
	#INT32_MIN
 (-2147483647-1)

	)

163 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

165 
	#INT8_MAX
 (127)

	)

166 
	#INT16_MAX
 (32767)

	)

167 
	#INT32_MAX
 (2147483647)

	)

168 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

171 
	#UINT8_MAX
 (255)

	)

172 
	#UINT16_MAX
 (65535)

	)

173 
	#UINT32_MAX
 (4294967295U)

	)

174 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

178 
	#INT_LEAST8_MIN
 (-128)

	)

179 
	#INT_LEAST16_MIN
 (-32767-1)

	)

180 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

181 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

183 
	#INT_LEAST8_MAX
 (127)

	)

184 
	#INT_LEAST16_MAX
 (32767)

	)

185 
	#INT_LEAST32_MAX
 (2147483647)

	)

186 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

189 
	#UINT_LEAST8_MAX
 (255)

	)

190 
	#UINT_LEAST16_MAX
 (65535)

	)

191 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

192 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

196 
	#INT_FAST8_MIN
 (-128)

	)

197 #ià
__WORDSIZE
 == 64

198 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

199 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

201 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

202 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

204 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

206 
	#INT_FAST8_MAX
 (127)

	)

207 #ià
__WORDSIZE
 == 64

208 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

209 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

211 
	#INT_FAST16_MAX
 (2147483647)

	)

212 
	#INT_FAST32_MAX
 (2147483647)

	)

214 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

217 
	#UINT_FAST8_MAX
 (255)

	)

218 #ià
__WORDSIZE
 == 64

219 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

220 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

222 
	#UINT_FAST16_MAX
 (4294967295U)

	)

223 
	#UINT_FAST32_MAX
 (4294967295U)

	)

225 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

229 #ià
__WORDSIZE
 == 64

230 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

231 
	#INTPTR_MAX
 (9223372036854775807L)

	)

232 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

234 
	#INTPTR_MIN
 (-2147483647-1)

	)

235 
	#INTPTR_MAX
 (2147483647)

	)

236 
	#UINTPTR_MAX
 (4294967295U)

	)

241 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

243 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

246 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

252 #ià
__WORDSIZE
 == 64

253 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

254 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

256 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

257 
	#PTRDIFF_MAX
 (2147483647)

	)

261 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

262 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

265 #ià
__WORDSIZE
 == 64

266 
	#SIZE_MAX
 (18446744073709551615UL)

	)

268 
	#SIZE_MAX
 (4294967295U)

	)

272 #iâdeà
WCHAR_MIN


274 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

275 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

279 
	#WINT_MIN
 (0u)

	)

280 
	#WINT_MAX
 (4294967295u)

	)

287 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_CONSTANT_MACROS


290 
	#INT8_C
(
c
è
	)
c

291 
	#INT16_C
(
c
è
	)
c

292 
	#INT32_C
(
c
è
	)
c

293 #ià
__WORDSIZE
 == 64

294 
	#INT64_C
(
c
èø## 
L


	)

296 
	#INT64_C
(
c
èø## 
LL


	)

300 
	#UINT8_C
(
c
è
	)
c

301 
	#UINT16_C
(
c
è
	)
c

302 
	#UINT32_C
(
c
èø## 
U


	)

303 #ià
__WORDSIZE
 == 64

304 
	#UINT64_C
(
c
èø## 
UL


	)

306 
	#UINT64_C
(
c
èø## 
ULL


	)

310 #ià
__WORDSIZE
 == 64

311 
	#INTMAX_C
(
c
èø## 
L


	)

312 
	#UINTMAX_C
(
c
èø## 
UL


	)

314 
	#INTMAX_C
(
c
èø## 
LL


	)

315 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/sys/cdefs.h

20 #iâdef 
_SYS_CDEFS_H


21 
	#_SYS_CDEFS_H
 1

	)

24 #iâdeà
_FEATURES_H


25 
	~<ã©u»s.h
>

31 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


36 #undeà
__P


37 #undeà
__PMT


39 #ifdeà
__GNUC__


46 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

47 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

48 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

50 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

51 
	#__THROW
 
	`throw
 ()

	)

52 
	#__NTH
(
fù
èfù 
	`throw
 ()

	)

54 
	#__THROW


	)

55 
	#__NTH
(
fù
è
	)
fct

61 
	#__šlše


	)

63 
	#__THROW


	)

64 
	#__NTH
(
fù
è
	)
fct

66 
	#__cÚ¡
 cÚ¡

	)

67 
	#__sigÃd
 sigÃd

	)

68 
	#__vŞ©e
 vŞ©e

	)

74 
	#__P
(
¬gs
è
	)
args

75 
	#__PMT
(
¬gs
è
	)
args

80 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

81 
	#__STRING
(
x
è#x

	)

84 
	#__±r_t
 *

	)

85 
	#__lÚg_doubË_t
 

	)

89 #ifdef 
__ılu¥lus


90 
	#__BEGIN_DECLS
 "C" {

	)

91 
	#__END_DECLS
 }

	)

93 
	#__BEGIN_DECLS


	)

94 
	#__END_DECLS


	)

103 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


104 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

105 
	#__END_NAMESPACE_STD
 }

	)

106 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

107 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

108 
	#__END_NAMESPACE_C99
 }

	)

109 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

114 
	#__BEGIN_NAMESPACE_STD


	)

115 
	#__END_NAMESPACE_STD


	)

116 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

117 
	#__BEGIN_NAMESPACE_C99


	)

118 
	#__END_NAMESPACE_C99


	)

119 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

124 #iâdeà
__BOUNDED_POINTERS__


125 
	#__bounded


	)

126 
	#__unbounded


	)

127 
	#__±rv®ue


	)

132 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

135 #ià
__GNUC_PREREQ
 (4,3)

136 
	#__w¬ndeş
(
Çme
, 
msg
) \

137 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

138 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

139 
	#__”rÜdeş
(
Çme
, 
msg
) \

140 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

142 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

143 
	#__w¬Ç‰r
(
msg
)

	)

144 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

148 #ià
__GNUC_PREREQ
 (2,97)

150 
	#__æex¬r
 []

	)

152 #ifdeà
__GNUC__


153 
	#__æex¬r
 [0]

	)

155 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

156 
	#__æex¬r
 []

	)

159 
	#__æex¬r
 [1]

	)

175 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

177 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

178 #ifdeà
__ılu¥lus


179 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

180 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

182 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

183 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

185 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

186 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

199 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

200 
	#__©Œibu‹__
(
xyz
è

	)

206 #ià
__GNUC_PREREQ
 (2,96)

207 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

209 
	#__©Œibu‹_m®loc__


	)

215 #ià
__GNUC_PREREQ
 (2,96)

216 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

218 
	#__©Œibu‹_pu»__


	)

224 #ià
__GNUC_PREREQ
 (3,1)

225 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

226 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

228 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

229 
	#__©Œibu‹_nošlše__


	)

233 #ià
__GNUC_PREREQ
 (3,2)

234 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

236 
	#__©Œibu‹_d•»ÿ‹d__


	)

245 #ià
__GNUC_PREREQ
 (2,8)

246 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

248 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

255 #ià
__GNUC_PREREQ
 (2,97)

256 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

257 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

259 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

264 #ià
__GNUC_PREREQ
 (3,3)

265 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

267 
	#__nÚnuÎ
(
·¿ms
)

	)

272 #ià
__GNUC_PREREQ
 (3,4)

273 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

274 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

275 #ià
__USE_FORTIFY_LEVEL
 > 0

276 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

279 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

281 #iâdeà
__wur


282 
	#__wur


	)

286 #ià
__GNUC_PREREQ
 (3,2)

287 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

289 
	#__®ways_šlše
 
__šlše


	)

294 #ià!
defšed
 
__ılu¥lus
 || 
__GNUC_PREREQ
 (4,3)

295 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


296 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

297 #ià
__GNUC_PREREQ
 (4,3)

298 
	#__ex‹º_®ways_šlše
 \

299 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
, 
__¬tificŸl__
))

	)

301 
	#__ex‹º_®ways_šlše
 \

302 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

305 
	#__ex‹º_šlše
 
__šlše


	)

306 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

312 #ià
__GNUC_PREREQ
 (4,3)

313 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

314 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

321 #ià!
__GNUC_PREREQ
 (2,8)

322 
	#__ex‹nsiÚ__


	)

326 #ià!
__GNUC_PREREQ
 (2,92)

327 
	#__»¡riù


	)

333 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


334 
	#__»¡riù_¬r
 
__»¡riù


	)

336 #ifdeà
__GNUC__


337 
	#__»¡riù_¬r


	)

339 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

340 
	#__»¡riù_¬r
 
»¡riù


	)

343 
	#__»¡riù_¬r


	)

348 
	~<b™s/wÜdsize.h
>

350 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


351 
	#__LDBL_COMPAT
 1

	)

352 #ifdeà
__REDIRECT


353 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

354 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

355 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

356 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

357 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

358 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

359 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

360 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

361 
	#__LDBL_REDIR_DECL
(
Çme
) \

362 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

363 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

364 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

365 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

366 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

369 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


370 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

371 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

372 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

373 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

374 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

375 #ifdeà
__REDIRECT


376 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

377 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

378 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

	@/usr/include/sys/sysmacros.h

21 #iâdeà
_SYS_SYSMACROS_H


22 
	#_SYS_SYSMACROS_H
 1

	)

24 
	~<ã©u»s.h
>

29 #ifdeà
__GLIBC_HAVE_LONG_LONG


30 
__ex‹nsiÚ__


31 
	$gnu_dev_majÜ
 (
__dev
)

32 
__THROW
;

33 
__ex‹nsiÚ__


34 
	$gnu_dev_mšÜ
 (
__dev
)

35 
__THROW
;

36 
__ex‹nsiÚ__


37 
	$gnu_dev_makedev
 (
__majÜ
,

38 
__mšÜ
)

39 
__THROW
;

41 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES


42 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

43 
	`__NTH
 (
	$gnu_dev_majÜ
 (
__dev
))

45  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

46 
	}
}

48 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

49 
__NTH
 (
	$gnu_dev_mšÜ
 (
__dev
))

51  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

52 
	}
}

54 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

55 
__NTH
 (
	$gnu_dev_makedev
 (
__majÜ
, 
__mšÜ
))

57  ((
__mšÜ
 & 0xffè| ((
__majÜ
 & 0xfff) << 8)

58 | (((è(
__mšÜ
 & ~0xff)) << 12)

59 | (((è(
__majÜ
 & ~0xfff)) << 32));

60 
	}
}

65 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

66 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

67 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/sys/ucontext.h

19 #iâdeà
_SYS_UCONTEXT_H


20 
	#_SYS_UCONTEXT_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<sigÇl.h
>

24 
	~<b™s/wÜdsize.h
>

28 
	~<b™s/sigcÚ‹xt.h
>

30 #ià
__WORDSIZE
 == 64

33 
	tg»g_t
;

36 
	#NGREG
 23

	)

39 
g»g_t
 
	tg»g£t_t
[
NGREG
];

41 #ifdeà
__USE_GNU


45 
	mREG_R8
 = 0,

46 
	#REG_R8
 
REG_R8


	)

47 
	mREG_R9
,

48 
	#REG_R9
 
REG_R9


	)

49 
	mREG_R10
,

50 
	#REG_R10
 
REG_R10


	)

51 
	mREG_R11
,

52 
	#REG_R11
 
REG_R11


	)

53 
	mREG_R12
,

54 
	#REG_R12
 
REG_R12


	)

55 
	mREG_R13
,

56 
	#REG_R13
 
REG_R13


	)

57 
	mREG_R14
,

58 
	#REG_R14
 
REG_R14


	)

59 
	mREG_R15
,

60 
	#REG_R15
 
REG_R15


	)

61 
	mREG_RDI
,

62 
	#REG_RDI
 
REG_RDI


	)

63 
	mREG_RSI
,

64 
	#REG_RSI
 
REG_RSI


	)

65 
	mREG_RBP
,

66 
	#REG_RBP
 
REG_RBP


	)

67 
	mREG_RBX
,

68 
	#REG_RBX
 
REG_RBX


	)

69 
	mREG_RDX
,

70 
	#REG_RDX
 
REG_RDX


	)

71 
	mREG_RAX
,

72 
	#REG_RAX
 
REG_RAX


	)

73 
	mREG_RCX
,

74 
	#REG_RCX
 
REG_RCX


	)

75 
	mREG_RSP
,

76 
	#REG_RSP
 
REG_RSP


	)

77 
	mREG_RIP
,

78 
	#REG_RIP
 
REG_RIP


	)

79 
	mREG_EFL
,

80 
	#REG_EFL
 
REG_EFL


	)

81 
	mREG_CSGSFS
,

82 
	#REG_CSGSFS
 
REG_CSGSFS


	)

83 
	mREG_ERR
,

84 
	#REG_ERR
 
REG_ERR


	)

85 
	mREG_TRAPNO
,

86 
	#REG_TRAPNO
 
REG_TRAPNO


	)

87 
	mREG_OLDMASK
,

88 
	#REG_OLDMASK
 
REG_OLDMASK


	)

89 
	mREG_CR2


90 
	#REG_CR2
 
REG_CR2


	)

94 
	s_libc_åx»g


96 
	msignifiÿnd
[4];

97 
	mexpÚ’t
;

98 
	m·ddšg
[3];

101 
	s_libc_xmm»g


103 
__ušt32_t
 
	m–em’t
[4];

106 
	s_libc_å¡©e


109 
__ušt16_t
 
	mcwd
;

110 
__ušt16_t
 
	mswd
;

111 
__ušt16_t
 
	máw
;

112 
__ušt16_t
 
	mfİ
;

113 
__ušt64_t
 
	mr
;

114 
__ušt64_t
 
	mrdp
;

115 
__ušt32_t
 
	mmxc¤
;

116 
__ušt32_t
 
	mmxü_mask
;

117 
_libc_åx»g
 
	m_¡
[8];

118 
_libc_xmm»g
 
	m_xmm
[16];

119 
__ušt32_t
 
	m·ddšg
[24];

123 
_libc_å¡©e
 *
	tå»g£t_t
;

128 
g»g£t_t
 
	mg»gs
;

130 
å»g£t_t
 
	må»gs
;

131 
	m__»£rved1
 [8];

132 } 
	tmcÚ‹xt_t
;

135 
	sucÚ‹xt


137 
	muc_æags
;

138 
ucÚ‹xt
 *
	muc_lšk
;

139 
¡ack_t
 
	muc_¡ack
;

140 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

141 
__sig£t_t
 
	muc_sigmask
;

142 
_libc_å¡©e
 
	m__å»gs_mem
;

143 } 
	tucÚ‹xt_t
;

148 
	tg»g_t
;

151 
	#NGREG
 19

	)

154 
g»g_t
 
	tg»g£t_t
[
NGREG
];

156 #ifdeà
__USE_GNU


160 
	mREG_GS
 = 0,

161 
	#REG_GS
 
REG_GS


	)

162 
	mREG_FS
,

163 
	#REG_FS
 
REG_FS


	)

164 
	mREG_ES
,

165 
	#REG_ES
 
REG_ES


	)

166 
	mREG_DS
,

167 
	#REG_DS
 
REG_DS


	)

168 
	mREG_EDI
,

169 
	#REG_EDI
 
REG_EDI


	)

170 
	mREG_ESI
,

171 
	#REG_ESI
 
REG_ESI


	)

172 
	mREG_EBP
,

173 
	#REG_EBP
 
REG_EBP


	)

174 
	mREG_ESP
,

175 
	#REG_ESP
 
REG_ESP


	)

176 
	mREG_EBX
,

177 
	#REG_EBX
 
REG_EBX


	)

178 
	mREG_EDX
,

179 
	#REG_EDX
 
REG_EDX


	)

180 
	mREG_ECX
,

181 
	#REG_ECX
 
REG_ECX


	)

182 
	mREG_EAX
,

183 
	#REG_EAX
 
REG_EAX


	)

184 
	mREG_TRAPNO
,

185 
	#REG_TRAPNO
 
REG_TRAPNO


	)

186 
	mREG_ERR
,

187 
	#REG_ERR
 
REG_ERR


	)

188 
	mREG_EIP
,

189 
	#REG_EIP
 
REG_EIP


	)

190 
	mREG_CS
,

191 
	#REG_CS
 
REG_CS


	)

192 
	mREG_EFL
,

193 
	#REG_EFL
 
REG_EFL


	)

194 
	mREG_UESP
,

195 
	#REG_UESP
 
REG_UESP


	)

196 
	mREG_SS


197 
	#REG_SS
 
REG_SS


	)

202 
	s_libc_å»g


204 
	msignifiÿnd
[4];

205 
	mexpÚ’t
;

208 
	s_libc_å¡©e


210 
	mcw
;

211 
	msw
;

212 
	mg
;

213 
	moff
;

214 
	mcs£l
;

215 
	md©aoff
;

216 
	md©a£l
;

217 
_libc_å»g
 
	m_¡
[8];

218 
	m¡©us
;

222 
_libc_å¡©e
 *
	tå»g£t_t
;

227 
g»g£t_t
 
	mg»gs
;

230 
å»g£t_t
 
	må»gs
;

231 
	mŞdmask
;

232 
	mü2
;

233 } 
	tmcÚ‹xt_t
;

236 
	sucÚ‹xt


238 
	muc_æags
;

239 
ucÚ‹xt
 *
	muc_lšk
;

240 
¡ack_t
 
	muc_¡ack
;

241 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

242 
__sig£t_t
 
	muc_sigmask
;

243 
_libc_å¡©e
 
	m__å»gs_mem
;

244 } 
	tucÚ‹xt_t
;

	@/usr/include/sys/uio.h

19 #iâdeà
_SYS_UIO_H


20 
	#_SYS_UIO_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	~<sys/ty³s.h
>

26 
	g__BEGIN_DECLS


29 
	~<b™s/uio.h
>

40 
ssize_t
 
»adv
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
);

50 
ssize_t
 
wr™ev
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
);

52 
	g__END_DECLS


	@/usr/include/time.h

24 #iâdef 
_TIME_H


26 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

27 ! 
defšed
 
	g__Ãed_time¥ec
)

28 
	#_TIME_H
 1

	)

29 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 #ifdef 
_TIME_H


37 
	#__Ãed_size_t


	)

38 
	#__Ãed_NULL


	)

39 
	~<¡ddef.h
>

43 
	~<b™s/time.h
>

46 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


47 #iâdeà
CLK_TCK


48 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

54 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

55 
	#__şock_t_defšed
 1

	)

57 
	~<b™s/ty³s.h
>

59 
__BEGIN_NAMESPACE_STD


61 
__şock_t
 
	tşock_t
;

62 
	g__END_NAMESPACE_STD


63 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


64 
	$__USING_NAMESPACE_STD
(
şock_t
)

68 #undeà
__Ãed_şock_t


70 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

71 
	#__time_t_defšed
 1

	)

73 
	~<b™s/ty³s.h
>

75 
__BEGIN_NAMESPACE_STD


77 
__time_t
 
	ttime_t
;

78 
__END_NAMESPACE_STD


79 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


80 
	$__USING_NAMESPACE_STD
(
time_t
)

84 #undeà
__Ãed_time_t


86 #ià!
defšed
 
__şockid_t_defšed
 && \

87 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

88 
	#__şockid_t_defšed
 1

	)

90 
	~<b™s/ty³s.h
>

93 
__şockid_t
 
	tşockid_t
;

96 #undeà
__şockid_time_t


98 #ià!
defšed
 
__tim”_t_defšed
 && \

99 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

100 
	#__tim”_t_defšed
 1

	)

102 
	~<b™s/ty³s.h
>

105 
__tim”_t
 
	ttim”_t
;

108 #undeà
__Ãed_tim”_t


111 #ià!
defšed
 
__time¥ec_defšed
 && \

112 ((
defšed
 
_TIME_H
 && \

113 (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
)) || \

114 
defšed
 
__Ãed_time¥ec
)

115 
	#__time¥ec_defšed
 1

	)

117 
	~<b™s/ty³s.h
>

121 
	stime¥ec


123 
__time_t
 
tv_£c
;

124 
tv_n£c
;

128 #undeà
__Ãed_time¥ec


131 #ifdef 
_TIME_H


132 
__BEGIN_NAMESPACE_STD


134 
	stm


136 
tm_£c
;

137 
tm_mš
;

138 
tm_hour
;

139 
tm_mday
;

140 
tm_mÚ
;

141 
tm_y—r
;

142 
tm_wday
;

143 
tm_yday
;

144 
tm_isd¡
;

146 #ifdef 
__USE_BSD


147 
tm_gmtoff
;

148 
__cÚ¡
 *
tm_zÚe
;

150 
__tm_gmtoff
;

151 
__cÚ¡
 *
__tm_zÚe
;

154 
__END_NAMESPACE_STD


155 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


156 
	$__USING_NAMESPACE_STD
(
tm
)

160 #ifdeà
__USE_POSIX199309


162 
	s™im”¥ec


164 
time¥ec
 
™_š‹rv®
;

165 
time¥ec
 
™_v®ue
;

169 
sigev’t
;

173 #ifdeà
__USE_XOPEN2K


174 #iâdeà
__pid_t_defšed


175 
__pid_t
 
	tpid_t
;

176 
	#__pid_t_defšed


	)

181 
__BEGIN_NAMESPACE_STD


184 
şock_t
 
	$şock
 (è
__THROW
;

187 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

190 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

191 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

194 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

200 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

201 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

202 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

203 
__END_NAMESPACE_STD


205 #ifdeà
__USE_XOPEN


208 *
	$¡½time
 (
__cÚ¡
 *
__»¡riù
 
__s
,

209 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
)

210 
__THROW
;

213 #ifdeà
__USE_GNU


216 
	~<xloÿË.h
>

218 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

219 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

220 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

221 
__loÿË_t
 
__loc
è
__THROW
;

223 *
	$¡½time_l
 (
__cÚ¡
 *
__»¡riù
 
__s
,

224 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
,

225 
__loÿË_t
 
__loc
è
__THROW
;

229 
__BEGIN_NAMESPACE_STD


232 
tm
 *
	$gmtime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

236 
tm
 *
	$loÿÉime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

237 
__END_NAMESPACE_STD


239 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


242 
tm
 *
	$gmtime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

243 
tm
 *
__»¡riù
 
__
è
__THROW
;

247 
tm
 *
	$loÿÉime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

248 
tm
 *
__»¡riù
 
__
è
__THROW
;

251 
__BEGIN_NAMESPACE_STD


254 *
	$asùime
 (
__cÚ¡
 
tm
 *
__
è
__THROW
;

257 *
	$ùime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

258 
__END_NAMESPACE_STD


260 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


265 *
	$asùime_r
 (
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

266 *
__»¡riù
 
__buf
è
__THROW
;

269 *
	$ùime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

270 *
__»¡riù
 
__buf
è
__THROW
;

275 *
__tzÇme
[2];

276 
__daylight
;

277 
__timezÚe
;

280 #ifdef 
__USE_POSIX


282 *
tzÇme
[2];

286 
	$tz£t
 (è
__THROW
;

289 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


290 
daylight
;

291 
timezÚe
;

294 #ifdeà
__USE_SVID


297 
	$¡ime
 (
__cÚ¡
 
time_t
 *
__wh’
è
__THROW
;

303 
	#__i¦—p
(
y—r
) \

304 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

307 #ifdeà
__USE_MISC


312 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

315 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

318 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

322 #ifdeà
__USE_POSIX199309


327 
	`Çno¦“p
 (
__cÚ¡
 
time¥ec
 *
__»que¡ed_time
,

328 
time¥ec
 *
__»maššg
);

332 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

335 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

338 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, 
__cÚ¡
 
time¥ec
 *
__
)

339 
__THROW
;

341 #ifdeà
__USE_XOPEN2K


346 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

347 
__cÚ¡
 
time¥ec
 *
__»q
,

348 
time¥ec
 *
__»m
);

351 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

356 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

357 
sigev’t
 *
__»¡riù
 
__evp
,

358 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

361 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

364 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

365 
__cÚ¡
 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

366 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

369 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

370 
__THROW
;

373 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

377 #ifdeà
__USE_XOPEN_EXTENDED


389 
g‘d©e_”r
;

398 
tm
 *
	`g‘d©e
 (
__cÚ¡
 *
__¡ršg
);

401 #ifdeà
__USE_GNU


412 
	`g‘d©e_r
 (
__cÚ¡
 *
__»¡riù
 
__¡ršg
,

413 
tm
 *
__»¡riù
 
__»sbuå
);

416 
__END_DECLS


	@/usr/include/xlocale.h

21 #iâdeà
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loÿË_¡ruù


31 
loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

40 } *
	t__loÿË_t
;

	@/usr/include/zconf.h

8 #iâdeà
ZCONF_H


9 
	#ZCONF_H


	)

17 #ifdeà
Z_PREFIX


20 
	#_di¡_code
 
z__di¡_code


	)

21 
	#_Ëngth_code
 
z__Ëngth_code


	)

22 
	#_Œ_®ign
 
z__Œ_®ign


	)

23 
	#_Œ_æush_block
 
z__Œ_æush_block


	)

24 
	#_Œ_š™
 
z__Œ_š™


	)

25 
	#_Œ_¡Üed_block
 
z__Œ_¡Üed_block


	)

26 
	#_Œ_Îy
 
z__Œ_Îy


	)

27 
	#adËr32
 
z_adËr32


	)

28 
	#adËr32_combše
 
z_adËr32_combše


	)

29 
	#com´ess
 
z_com´ess


	)

30 
	#com´ess2
 
z_com´ess2


	)

31 
	#com´essBound
 
z_com´essBound


	)

32 
	#üc32
 
z_üc32


	)

33 
	#üc32_combše
 
z_üc32_combše


	)

34 
	#deæ©e
 
z_deæ©e


	)

35 
	#deæ©eBound
 
z_deæ©eBound


	)

36 
	#deæ©eCİy
 
z_deæ©eCİy


	)

37 
	#deæ©eEnd
 
z_deæ©eEnd


	)

38 
	#deæ©eIn™2_
 
z_deæ©eIn™2_


	)

39 
	#deæ©eIn™_
 
z_deæ©eIn™_


	)

40 
	#deæ©eP¬ams
 
z_deæ©eP¬ams


	)

41 
	#deæ©ePrime
 
z_deæ©ePrime


	)

42 
	#deæ©eRe£t
 
z_deæ©eRe£t


	)

43 
	#deæ©eS‘DiùiÚ¬y
 
z_deæ©eS‘DiùiÚ¬y


	)

44 
	#deæ©eS‘H—d”
 
z_deæ©eS‘H—d”


	)

45 
	#deæ©eTuÃ
 
z_deæ©eTuÃ


	)

46 
	#deæ©e_cİyright
 
z_deæ©e_cİyright


	)

47 
	#g‘_üc_bË
 
z_g‘_üc_bË


	)

48 
	#gzş—»¼
 
z_gzş—»¼


	)

49 
	#gzşo£
 
z_gzşo£


	)

50 
	#gzdœeù
 
z_gzdœeù


	)

51 
	#gzdİ’
 
z_gzdİ’


	)

52 
	#gzeof
 
z_gzeof


	)

53 
	#gz”rÜ
 
z_gz”rÜ


	)

54 
	#gzæush
 
z_gzæush


	)

55 
	#gzg‘c
 
z_gzg‘c


	)

56 
	#gzg‘s
 
z_gzg‘s


	)

57 
	#gzİ’
 
z_gzİ’


	)

58 
	#gz´štf
 
z_gz´štf


	)

59 
	#gzputc
 
z_gzputc


	)

60 
	#gzputs
 
z_gzputs


	)

61 
	#gz»ad
 
z_gz»ad


	)

62 
	#gz»wšd
 
z_gz»wšd


	)

63 
	#gz£ek
 
z_gz£ek


	)

64 
	#gz£¬ams
 
z_gz£¬ams


	)

65 
	#gz‹Î
 
z_gz‹Î


	)

66 
	#gzung‘c
 
z_gzung‘c


	)

67 
	#gzwr™e
 
z_gzwr™e


	)

68 
	#šæ©e
 
z_šæ©e


	)

69 
	#šæ©eBack
 
z_šæ©eBack


	)

70 
	#šæ©eBackEnd
 
z_šæ©eBackEnd


	)

71 
	#šæ©eBackIn™_
 
z_šæ©eBackIn™_


	)

72 
	#šæ©eCİy
 
z_šæ©eCİy


	)

73 
	#šæ©eEnd
 
z_šæ©eEnd


	)

74 
	#šæ©eG‘H—d”
 
z_šæ©eG‘H—d”


	)

75 
	#šæ©eIn™2_
 
z_šæ©eIn™2_


	)

76 
	#šæ©eIn™_
 
z_šæ©eIn™_


	)

77 
	#šæ©ePrime
 
z_šæ©ePrime


	)

78 
	#šæ©eRe£t
 
z_šæ©eRe£t


	)

79 
	#šæ©eS‘DiùiÚ¬y
 
z_šæ©eS‘DiùiÚ¬y


	)

80 
	#šæ©eSync
 
z_šæ©eSync


	)

81 
	#šæ©eSyncPošt
 
z_šæ©eSyncPošt


	)

82 
	#šæ©e_cİyright
 
z_šæ©e_cİyright


	)

83 
	#šæ©e_ç¡
 
z_šæ©e_ç¡


	)

84 
	#šæ©e_bË
 
z_šæ©e_bË


	)

85 
	#uncom´ess
 
z_uncom´ess


	)

86 
	#zE¼Ü
 
z_zE¼Ü


	)

87 
	#z_”rmsg
 
z_z_”rmsg


	)

88 
	#zÿÎoc
 
z_zÿÎoc


	)

89 
	#zcä“
 
z_zcä“


	)

90 
	#zlibCompeFÏgs
 
z_zlibCompeFÏgs


	)

91 
	#zlibV”siÚ
 
z_zlibV”siÚ


	)

94 
	#By‹
 
z_By‹


	)

95 
	#By‹f
 
z_By‹f


	)

96 
	#®loc_func
 
z_®loc_func


	)

97 
	#ch¬f
 
z_ch¬f


	)

98 
	#ä“_func
 
z_ä“_func


	)

99 
	#gzFe
 
z_gzFe


	)

100 
	#gz_h—d”
 
z_gz_h—d”


	)

101 
	#gz_h—d”p
 
z_gz_h—d”p


	)

102 
	#š_func
 
z_š_func


	)

103 
	#štf
 
z_štf


	)

104 
	#out_func
 
z_out_func


	)

105 
	#uIÁ
 
z_uIÁ


	)

106 
	#uIÁf
 
z_uIÁf


	)

107 
	#uLÚg
 
z_uLÚg


	)

108 
	#uLÚgf
 
z_uLÚgf


	)

109 
	#voidp
 
z_voidp


	)

110 
	#voidp
 
z_voidp


	)

111 
	#voidpc
 
z_voidpc


	)

112 
	#voidpc
 
z_voidpc


	)

113 
	#voidpf
 
z_voidpf


	)

114 
	#voidpf
 
z_voidpf


	)

115 
	#z_¡»am
 
z_z_¡»am


	)

116 
	#z_¡»amp
 
z_z_¡»amp


	)

119 
	#gz_h—d”_s
 
z_gz_h—d”_s


	)

120 
	#š‹º®_¡©e
 
z_š‹º®_¡©e


	)

121 
	#z_¡»am_s
 
z_z_¡»am_s


	)

125 #ià
defšed
(
__MSDOS__
è&& !defšed(
MSDOS
)

126 
	#MSDOS


	)

128 #ià(
defšed
(
OS_2
è|| defšed(
__OS2__
)è&& !defšed(
OS2
)

129 
	#OS2


	)

131 #ià
defšed
(
_WINDOWS
è&& !defšed(
WINDOWS
)

132 
	#WINDOWS


	)

134 #ià
defšed
(
_WIN32
è|| defšed(
_WIN32_WCE
è|| defšed(
__WIN32__
)

135 #iâdeà
WIN32


136 
	#WIN32


	)

139 #ià(
defšed
(
MSDOS
è|| defšed(
OS2
è|| defšed(
WINDOWS
)è&& !defšed(
WIN32
)

140 #ià!
defšed
(
__GNUC__
è&& !defšed(
__FLAT__
è&& !defšed(
__386__
)

141 #iâdeà
SYS16BIT


142 
	#SYS16BIT


	)

151 #ifdeà
SYS16BIT


152 
	#MAXSEG_64K


	)

154 #ifdeà
MSDOS


155 
	#UNALIGNED_OK


	)

158 #ifdeà
__STDC_VERSION__


159 #iâdeà
STDC


160 
	#STDC


	)

162 #ià
__STDC_VERSION__
 >= 199901L

163 #iâdeà
STDC99


164 
	#STDC99


	)

168 #ià!
defšed
(
STDC
è&& (defšed(
__STDC__
è|| defšed(
__ılu¥lus
))

169 
	#STDC


	)

171 #ià!
defšed
(
STDC
è&& (defšed(
__GNUC__
è|| defšed(
__BORLANDC__
))

172 
	#STDC


	)

174 #ià!
defšed
(
STDC
è&& (defšed(
MSDOS
è|| defšed(
WINDOWS
è|| defšed(
WIN32
))

175 
	#STDC


	)

177 #ià!
defšed
(
STDC
è&& (defšed(
OS2
è|| defšed(
__HOS_AIX__
))

178 
	#STDC


	)

181 #ià
defšed
(
__OS400__
è&& !defšed(
STDC
)

182 
	#STDC


	)

185 #iâdeà
STDC


187 cÚ¡

	)

192 #ià
defšed
(
__MWERKS__
)||defšed(
­¶ec
)||defšed(
THINK_C
)||defšed(
__SC__
)

193 
	#NO_DUMMY_DECL


	)

197 #iâdeà
MAX_MEM_LEVEL


198 #ifdeà
MAXSEG_64K


199 
	#MAX_MEM_LEVEL
 8

	)

201 
	#MAX_MEM_LEVEL
 9

	)

210 #iâdeà
MAX_WBITS


211 
	#MAX_WBITS
 15

	)

229 #iâdeà
OF


230 #ifdeà
STDC


231 
	#OF
(
¬gs
è
	)
args

233 
	#OF
(
¬gs
è()

	)

243 #ifdeà
SYS16BIT


244 #ià
defšed
(
M_I86SM
è|| defšed(
M_I86MM
)

246 
	#SMALL_MEDIUM


	)

247 #ifdeà
_MSC_VER


248 
	#FAR
 
_çr


	)

250 
	#FAR
 
çr


	)

253 #ià(
defšed
(
__SMALL__
è|| defšed(
__MEDIUM__
))

255 
	#SMALL_MEDIUM


	)

256 #ifdeà
__BORLANDC__


257 
	#FAR
 
_çr


	)

259 
	#FAR
 
çr


	)

264 #ià
defšed
(
WINDOWS
è|| defšed(
WIN32
)

268 #ifdeà
ZLIB_DLL


269 #ià
defšed
(
WIN32
è&& (!defšed(
__BORLANDC__
) || (__BORLANDC__ >= 0x500))

270 #ifdeà
ZLIB_INTERNAL


271 
	#ZEXTERN
 
	`__deş¥ec
(
dÎexpÜt
)

	)

273 
	#ZEXTERN
 
	`__deş¥ec
(
dÎimpÜt
)

	)

281 #ifdeà
ZLIB_WINAPI


282 #ifdeà
FAR


283 #undeà
FAR


285 
	~<wšdows.h
>

288 
	#ZEXPORT
 
WINAPI


	)

289 #ifdeà
WIN32


290 
	#ZEXPORTVA
 
WINAPIV


	)

292 
	#ZEXPORTVA
 
FAR
 
CDECL


	)

297 #ià
defšed
 (
__BEOS__
)

298 #ifdeà
ZLIB_DLL


299 #ifdeà
ZLIB_INTERNAL


300 
	#ZEXPORT
 
	`__deş¥ec
(
dÎexpÜt
)

	)

301 
	#ZEXPORTVA
 
	`__deş¥ec
(
dÎexpÜt
)

	)

303 
	#ZEXPORT
 
	`__deş¥ec
(
dÎimpÜt
)

	)

304 
	#ZEXPORTVA
 
	`__deş¥ec
(
dÎimpÜt
)

	)

309 #ifdeà
HAVE_VISIBILITY_PRAGMA


310 
	#ZEXTERN
 
	`__©Œibu‹__
((
	`visib™y
 ("deçuÉ"))è

	)

313 #iâdeà
ZEXTERN


314 
	#ZEXTERN
 

	)

316 #iâdeà
ZEXPORT


317 
	#ZEXPORT


	)

319 #iâdeà
ZEXPORTVA


320 
	#ZEXPORTVA


	)

323 #iâdeà
FAR


324 
	#FAR


	)

327 #ià!
defšed
(
__MACTYPES__
)

328 
	tBy‹
;

330 
	tuIÁ
;

331 
	tuLÚg
;

333 #ifdeà
SMALL_MEDIUM


335 
	#By‹f
 
By‹
 
FAR


	)

337 
By‹
 
	tFAR
 
	tBy‹f
;

339 
	tFAR
 
	tch¬f
;

340 
	tFAR
 
	tštf
;

341 
uIÁ
 
	tFAR
 
	tuIÁf
;

342 
uLÚg
 
	tFAR
 
	tuLÚgf
;

344 #ifdeà
STDC


345 cÚ¡ *
	tvoidpc
;

346 
	tFAR
 *
	tvoidpf
;

347 *
	tvoidp
;

349 
By‹
 cÚ¡ *
	tvoidpc
;

350 
By‹
 
	tFAR
 *
	tvoidpf
;

351 
By‹
 *
	tvoidp
;

354 
	~"zlibdefs.h
"

356 #ifdeà
_LARGEFILE64_SOURCE


357 
	~<sys/ty³s.h
>

360 #iâdeà
SEEK_SET


361 
	#SEEK_SET
 0

	)

362 
	#SEEK_CUR
 1

	)

363 
	#SEEK_END
 2

	)

365 #iâdeà
z_off_t


366 
	#z_off_t
 

	)

369 #ià
defšed
(
__OS400__
)

370 
	#NO_v¢´štf


	)

373 #ià
defšed
(
__MVS__
)

374 
	#NO_v¢´štf


	)

378 #ià
defšed
(
__MVS__
)

379 #´agm¨
m­
(
deæ©eIn™_
,"DEIN")

380 #´agm¨
m­
(
deæ©eIn™2_
,"DEIN2")

381 #´agm¨
m­
(
deæ©eEnd
,"DEEND")

382 #´agm¨
m­
(
deæ©eBound
,"DEBND")

383 #´agm¨
m­
(
šæ©eIn™_
,"ININ")

384 #´agm¨
m­
(
šæ©eIn™2_
,"ININ2")

385 #´agm¨
m­
(
šæ©eEnd
,"INEND")

386 #´agm¨
m­
(
šæ©eSync
,"INSY")

387 #´agm¨
m­
(
šæ©eS‘DiùiÚ¬y
,"INSEDI")

388 #´agm¨
m­
(
com´essBound
,"CMBND")

389 #´agm¨
m­
(
šæ©e_bË
,"INTABL")

390 #´agm¨
m­
(
šæ©e_ç¡
,"INFA")

391 #´agm¨
m­
(
šæ©e_cİyright
,"INCOPY")

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

21 
	#_G_size_t
 
size_t


	)

24 
__off_t
 
	m__pos
;

25 
__mb¡©e_t
 
	m__¡©e
;

26 } 
	t_G_åos_t
;

29 
__off64_t
 
	m__pos
;

30 
__mb¡©e_t
 
	m__¡©e
;

31 } 
	t_G_åos64_t
;

32 
	#_G_ssize_t
 
__ssize_t


	)

33 
	#_G_off_t
 
__off_t


	)

34 
	#_G_off64_t
 
__off64_t


	)

35 
	#_G_pid_t
 
__pid_t


	)

36 
	#_G_uid_t
 
__uid_t


	)

37 
	#_G_wch¬_t
 
wch¬_t


	)

38 
	#_G_wšt_t
 
wšt_t


	)

39 
	#_G_¡©64
 
¡©64


	)

40 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


41 
	~<gcÚv.h
>

44 
__gcÚv_šfo
 
	m__cd
;

47 
__gcÚv_šfo
 
	m__cd
;

48 
__gcÚv_¡•_d©a
 
	m__d©a
;

49 } 
	m__combšed
;

50 } 
	t_G_icÚv_t
;

53 
	t_G_št16_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HI__
)));

54 
	t_G_št32_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__SI__
)));

55 
	t_G_ušt16_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HI__
)));

56 
	t_G_ušt32_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__SI__
)));

58 
	#_G_HAVE_BOOL
 1

	)

62 
	#_G_HAVE_ATEXIT
 1

	)

63 
	#_G_HAVE_SYS_CDEFS
 1

	)

64 
	#_G_HAVE_SYS_WAIT
 1

	)

65 
	#_G_NEED_STDARG_H
 1

	)

66 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

68 
	#_G_HAVE_PRINTF_FP
 1

	)

69 
	#_G_HAVE_MMAP
 1

	)

70 
	#_G_HAVE_MREMAP
 1

	)

71 
	#_G_HAVE_LONG_DOUBLE_IO
 1

	)

72 
	#_G_HAVE_IO_FILE_OPEN
 1

	)

73 
	#_G_HAVE_IO_GETLINE_INFO
 1

	)

75 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

77 
	#_G_OPEN64
 
__İ’64


	)

78 
	#_G_LSEEK64
 
__l£ek64


	)

79 
	#_G_MMAP64
 
__mm­64


	)

80 
	#_G_FSTAT64
(
fd
,
buf
è
	`__fx¡©64
 (
_STAT_VER
, fd, buf)

	)

83 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

85 
	#_G_BUFSIZ
 8192

	)

88 
	#_G_NAMES_HAVE_UNDERSCORE
 0

	)

89 
	#_G_VTABLE_LABEL_HAS_LENGTH
 1

	)

90 
	#_G_USING_THUNKS
 1

	)

91 
	#_G_VTABLE_LABEL_PREFIX
 "__vt_"

	)

92 
	#_G_VTABLE_LABEL_PREFIX_ID
 
__vt_


	)

95 #ià
defšed
 
__ılu¥lus
 || defšed 
__STDC__


96 
	#_G_ARGS
(
ARGLIST
è
	)
ARGLIST

98 
	#_G_ARGS
(
ARGLIST
è()

	)

	@/usr/include/asm/socket.h

1 #iâdeà
_ASM_SOCKET_H


2 
	#_ASM_SOCKET_H


	)

4 
	~<asm/sockios.h
>

7 
	#SOL_SOCKET
 1

	)

9 
	#SO_DEBUG
 1

	)

10 
	#SO_REUSEADDR
 2

	)

11 
	#SO_TYPE
 3

	)

12 
	#SO_ERROR
 4

	)

13 
	#SO_DONTROUTE
 5

	)

14 
	#SO_BROADCAST
 6

	)

15 
	#SO_SNDBUF
 7

	)

16 
	#SO_RCVBUF
 8

	)

17 
	#SO_SNDBUFFORCE
 32

	)

18 
	#SO_RCVBUFFORCE
 33

	)

19 
	#SO_KEEPALIVE
 9

	)

20 
	#SO_OOBINLINE
 10

	)

21 
	#SO_NO_CHECK
 11

	)

22 
	#SO_PRIORITY
 12

	)

23 
	#SO_LINGER
 13

	)

24 
	#SO_BSDCOMPAT
 14

	)

26 
	#SO_PASSCRED
 16

	)

27 
	#SO_PEERCRED
 17

	)

28 
	#SO_RCVLOWAT
 18

	)

29 
	#SO_SNDLOWAT
 19

	)

30 
	#SO_RCVTIMEO
 20

	)

31 
	#SO_SNDTIMEO
 21

	)

34 
	#SO_SECURITY_AUTHENTICATION
 22

	)

35 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

36 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

38 
	#SO_BINDTODEVICE
 25

	)

41 
	#SO_ATTACH_FILTER
 26

	)

42 
	#SO_DETACH_FILTER
 27

	)

44 
	#SO_PEERNAME
 28

	)

45 
	#SO_TIMESTAMP
 29

	)

46 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

48 
	#SO_ACCEPTCONN
 30

	)

50 
	#SO_PEERSEC
 31

	)

51 
	#SO_PASSSEC
 34

	)

52 
	#SO_TIMESTAMPNS
 35

	)

53 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

55 
	#SO_MARK
 36

	)

	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/errno.h

20 #ifdeà
_ERRNO_H


22 #undeà
EDOM


23 #undeà
EILSEQ


24 #undeà
ERANGE


25 
	~<lšux/”ºo.h
>

28 
	#ENOTSUP
 
EOPNOTSUPP


	)

31 #iâdeà
ECANCELED


32 
	#ECANCELED
 125

	)

36 #iâdeà
EOWNERDEAD


37 
	#EOWNERDEAD
 130

	)

38 
	#ENOTRECOVERABLE
 131

	)

41 #iâdeà
__ASSEMBLER__


43 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

45 #ià!
defšed
 
_LIBC
 || defšed 
_LIBC_REENTRANT


47 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

52 #ià!
defšed
 
_ERRNO_H
 && defšed 
__Ãed_Em©h


56 
	#EDOM
 33

	)

57 
	#EILSEQ
 84

	)

58 
	#ERANGE
 34

	)

	@/usr/include/bits/libio-ldbl.h

20 #iâdeà
_IO_STDIO_H


24 
	$__LDBL_REDIR_DECL
 (
_IO_vfsÿnf
)

25 
	`__LDBL_REDIR_DECL
 (
_IO_vårštf
)

	@/usr/include/bits/local_lim.h

25 #iâdeà
NR_OPEN


26 
	#__undef_NR_OPEN


	)

28 #iâdeà
LINK_MAX


29 
	#__undef_LINK_MAX


	)

31 #iâdeà
OPEN_MAX


32 
	#__undef_OPEN_MAX


	)

36 
	~<lšux/lim™s.h
>

39 #ifdeà
__undef_NR_OPEN


40 #undeà
NR_OPEN


41 #undeà
__undef_NR_OPEN


44 #ifdeà
__undef_LINK_MAX


45 #undeà
LINK_MAX


46 #undeà
__undef_LINK_MAX


49 #ifdeà
__undef_OPEN_MAX


50 #undeà
OPEN_MAX


51 #undeà
__undef_OPEN_MAX


55 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

57 
	#PTHREAD_KEYS_MAX
 1024

	)

60 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

62 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

65 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

67 #undeà
PTHREAD_THREADS_MAX


71 
	#AIO_PRIO_DELTA_MAX
 20

	)

74 
	#PTHREAD_STACK_MIN
 16384

	)

77 
	#DELAYTIMER_MAX
 2147483647

	)

80 
	#TTY_NAME_MAX
 32

	)

83 
	#LOGIN_NAME_MAX
 256

	)

86 
	#HOST_NAME_MAX
 64

	)

89 
	#MQ_PRIO_MAX
 32768

	)

92 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/locale.h

20 #ià!
defšed
 
_LOCALE_H
 && !defšed 
_LANGINFO_H


24 #iâdeà
_BITS_LOCALE_H


25 
	#_BITS_LOCALE_H
 1

	)

29 
	m__LC_CTYPE
 = 0,

30 
	m__LC_NUMERIC
 = 1,

31 
	m__LC_TIME
 = 2,

32 
	m__LC_COLLATE
 = 3,

33 
	m__LC_MONETARY
 = 4,

34 
	m__LC_MESSAGES
 = 5,

35 
	m__LC_ALL
 = 6,

36 
	m__LC_PAPER
 = 7,

37 
	m__LC_NAME
 = 8,

38 
	m__LC_ADDRESS
 = 9,

39 
	m__LC_TELEPHONE
 = 10,

40 
	m__LC_MEASUREMENT
 = 11,

41 
	m__LC_IDENTIFICATION
 = 12

	@/usr/include/bits/sockaddr.h

24 #iâdeà
_BITS_SOCKADDR_H


25 
	#_BITS_SOCKADDR_H
 1

	)

29 
	t§_çmy_t
;

35 
	#__SOCKADDR_COMMON
(
§_´efix
) \

36 
§_çmy_t
 
§_´efix
##
çmy


	)

38 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

	@/usr/include/bits/stdio-lock.h

20 #iâdeà
_BITS_STDIO_LOCK_H


21 
	#_BITS_STDIO_LOCK_H
 1

	)

23 
	~<b™s/libc-lock.h
>

24 
	~<lowËv–lock.h
>

28 
	#_IO_lock_šex³nsive
 1

	)

30 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t_IO_lock_t
;

32 
	#_IO_lock_š™Ÿliz”
 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

34 
	#_IO_lock_š™
(
_Çme
) \

35 ((
_Çme
èğ(
_IO_lock_t
è
_IO_lock_š™Ÿliz”
 , 0)

	)

37 
	#_IO_lock_fši
(
_Çme
) \

38 ((è0)

	)

40 
	#_IO_lock_lock
(
_Çme
) \

42 *
__£lf
 = 
THREAD_SELF
; \

43 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

45 
	`Îl_lock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

46 (
_Çme
).
owÃr
 = 
__£lf
; \

48 ++(
_Çme
).
út
; \

49 } 0)

	)

51 
	#_IO_lock_Œylock
(
_Çme
) \

53 
__»suÉ
 = 0; \

54 *
__£lf
 = 
THREAD_SELF
; \

55 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

57 ià(
	`Îl_Œylock
 ((
_Çme
).
lock
) == 0) \

59 (
_Çme
).
owÃr
 = 
__£lf
; \

60 (
_Çme
).
út
 = 1; \

63 
__»suÉ
 = 
EBUSY
; \

66 ++(
_Çme
).
út
; \

67 
__»suÉ
; \

68 })

	)

70 
	#_IO_lock_uÆock
(
_Çme
) \

72 ià(--(
_Çme
).
út
 == 0) \

74 (
_Çme
).
owÃr
 = 
NULL
; \

75 
	`Îl_uÆock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

77 } 0)

	)

81 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
) \

82 
	`__libc_ş—nup_»giÚ_¡¬t
 (((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0, 
_fù
, _å)

	)

83 
	#_IO_ş—nup_»giÚ_¡¬t_nßrg
(
_fù
) \

84 
	`__libc_ş—nup_»giÚ_¡¬t
 (1, 
_fù
, 
NULL
)

	)

85 
	#_IO_ş—nup_»giÚ_’d
(
_do™
) \

86 
	`__libc_ş—nup_»giÚ_’d
 (
_do™
)

	)

88 #ià
defšed
 
_LIBC
 && !defšed 
NOT_IN_libc


90 #ifdeà
__EXCEPTIONS


91 
	#_IO_acquœe_lock
(
_å
) \

93 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

94 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_fù
))) \

95 ğ(
_å
); \

96 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

97 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
) \

99 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

100 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_ş—r_æags2_fù
))) \

101 ğ(
_å
); \

102 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

104 
	#_IO_acquœe_lock
(
_å
è
_IO_acquœe_lock_Ãeds_exû±iÚs_’abËd


	)

105 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
è
	`_IO_acquœe_lock
 (_å)

	)

107 
	#_IO_»Ëa£_lock
(
_å
è; } 0)

	)

	@/usr/include/bits/typesizes.h

20 #iâdeà
_BITS_TYPES_H


24 #iâdef 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 *

	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uio.h

19 #ià!
defšed
 
_SYS_UIO_H
 && !defšed 
_FCNTL_H


23 #iâdeà
_BITS_UIO_H


24 
	#_BITS_UIO_H
 1

	)

26 
	~<sys/ty³s.h
>

40 
	#UIO_MAXIOV
 1024

	)

44 
	siovec


46 *
	miov_ba£
;

47 
size_t
 
	miov_Ën
;

	@/usr/include/bits/wchar.h

20 #iâdeà
_BITS_WCHAR_H


21 
	#_BITS_WCHAR_H
 1

	)

23 
	#__WCHAR_MIN
 (-2147483647 - 1)

	)

24 
	#__WCHAR_MAX
 (2147483647)

	)

	@/usr/include/gnu/stubs.h

4 
	~<b™s/wÜdsize.h
>

6 #ià
__WORDSIZE
 == 32

7 
	~<gnu/¡ubs-32.h
>

8 #–ià
__WORDSIZE
 == 64

9 
	~<gnu/¡ubs-64.h
>

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

5 
	~<lšux/posix_ty³s.h
>

6 
	~<asm/ty³s.h
>

8 #iâdeà
__KERNEL_STRICT_NAMES


10 
__u32
 
	t__k”Ãl_dev_t
;

12 
__k”Ãl_fd_£t
 
	tfd_£t
;

13 
__k”Ãl_dev_t
 
	tdev_t
;

14 
__k”Ãl_šo_t
 
	tšo_t
;

15 
__k”Ãl_mode_t
 
	tmode_t
;

16 
__k”Ãl_Æšk_t
 
	tÆšk_t
;

17 
__k”Ãl_off_t
 
	toff_t
;

18 
__k”Ãl_pid_t
 
	tpid_t
;

19 
__k”Ãl_daddr_t
 
	tdaddr_t
;

20 
__k”Ãl_key_t
 
	tkey_t
;

21 
__k”Ãl_su£cÚds_t
 
	tsu£cÚds_t
;

22 
__k”Ãl_tim”_t
 
	ttim”_t
;

23 
__k”Ãl_şockid_t
 
	tşockid_t
;

24 
__k”Ãl_mqd_t
 
	tmqd_t
;

26 
__k”Ãl_uid_t
 
	tuid_t
;

27 
__k”Ãl_gid_t
 
	tgid_t
;

29 #ià
defšed
(
__GNUC__
)

30 
__k”Ãl_loff_t
 
	tloff_t
;

37 #iâdeà
_SIZE_T


38 
	#_SIZE_T


	)

39 
__k”Ãl_size_t
 
	tsize_t
;

42 #iâdeà
_SSIZE_T


43 
	#_SSIZE_T


	)

44 
__k”Ãl_ssize_t
 
	tssize_t
;

47 #iâdeà
_PTRDIFF_T


48 
	#_PTRDIFF_T


	)

49 
__k”Ãl_±rdiff_t
 
	t±rdiff_t
;

52 #iâdeà
_TIME_T


53 
	#_TIME_T


	)

54 
__k”Ãl_time_t
 
	ttime_t
;

57 #iâdeà
_CLOCK_T


58 
	#_CLOCK_T


	)

59 
__k”Ãl_şock_t
 
	tşock_t
;

62 #iâdeà
_CADDR_T


63 
	#_CADDR_T


	)

64 
__k”Ãl_ÿddr_t
 
	tÿddr_t
;

68 
	tu_ch¬
;

69 
	tu_shÜt
;

70 
	tu_št
;

71 
	tu_lÚg
;

74 
	tunch¬
;

75 
	tushÜt
;

76 
	tušt
;

77 
	tulÚg
;

79 #iâdeà
__BIT_TYPES_DEFINED__


80 
	#__BIT_TYPES_DEFINED__


	)

82 
__u8
 
	tu_št8_t
;

83 
__s8
 
	tšt8_t
;

84 
__u16
 
	tu_št16_t
;

85 
__s16
 
	tšt16_t
;

86 
__u32
 
	tu_št32_t
;

87 
__s32
 
	tšt32_t
;

91 
__u8
 
	tušt8_t
;

92 
__u16
 
	tušt16_t
;

93 
__u32
 
	tušt32_t
;

95 #ià
defšed
(
__GNUC__
)

96 
__u64
 
	tušt64_t
;

97 
__u64
 
	tu_št64_t
;

98 
__s64
 
	tšt64_t
;

102 
	#®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

103 
	#®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

104 
	#®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

112 #ifdeà
CONFIG_LBD


113 
u64
 
	t£ùÜ_t
;

115 
	t£ùÜ_t
;

121 #ifdeà
CONFIG_LSF


122 
u64
 
	tblkút_t
;

124 
	tblkút_t
;

131 #iâdeà
pgoff_t


132 
	#pgoff_t
 

	)

142 #ifdeà
__CHECKER__


143 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

145 
	#__b™wi£__


	)

147 #ifdeà
__CHECK_ENDIAN__


148 
	#__b™wi£
 
__b™wi£__


	)

150 
	#__b™wi£


	)

153 
__u16
 
	t__b™wi£
 
	t__Ë16
;

154 
__u16
 
	t__b™wi£
 
	t__be16
;

155 
__u32
 
	t__b™wi£
 
	t__Ë32
;

156 
__u32
 
	t__b™wi£
 
	t__be32
;

157 #ià
defšed
(
__GNUC__
)

158 
__u64
 
	t__b™wi£
 
	t__Ë64
;

159 
__u64
 
	t__b™wi£
 
	t__be64
;

161 
__u16
 
	t__b™wi£
 
	t__sum16
;

162 
__u32
 
	t__b™wi£
 
	t__wsum
;

	@/usr/include/zlibdefs.h

6 
	~<sys/ty³s.h
>

7 
	~<uni¡d.h
>

8 #ifdeà
VMS


9 
	~<unixio.h
>

11 #iâdeà
z_off_t


12 
	#z_off_t
 
off_t


	)

	@/usr/include/asm/sockios.h

1 #iâdeà
_ASM_X86_SOCKIOS_H


2 
	#_ASM_X86_SOCKIOS_H


	)

5 
	#FIOSETOWN
 0x8901

	)

6 
	#SIOCSPGRP
 0x8902

	)

7 
	#FIOGETOWN
 0x8903

	)

8 
	#SIOCGPGRP
 0x8904

	)

9 
	#SIOCATMARK
 0x8905

	)

10 
	#SIOCGSTAMP
 0x8906

	)

11 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/asm/types.h

1 #iâdeà
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-g’”ic/št-Î64.h
>

6 #iâdeà
__ASSEMBLY__


8 
	tumode_t
;

	@/usr/include/bits/libc-lock.h

20 #iâdeà
_BITS_LIBC_LOCK_H


21 
	#_BITS_LIBC_LOCK_H
 1

	)

23 
	~<±h»ad.h
>

24 
	#__Ãed_NULL


	)

25 
	~<¡ddef.h
>

34 #ifdeà
_LIBC


35 
	~<lowËv–lock.h
>

36 
	~<s.h
>

37 
	~<±h»ad-funùiÚs.h
>

41 #ià
defšed
 
_LIBC
 || defšed 
_IO_MTSAFE_IO


42 #ià(
defšed
 
NOT_IN_libc
 && !defšed 
IS_IN_lib±h»ad
è|| !defšed 
_LIBC


43 
±h»ad_mu‹x_t
 
	t__libc_lock_t
;

44 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__libc_lock_»cursive_t
;

46 
	t__libc_lock_t
;

47 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t__libc_lock_»cursive_t
;

49 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__¹ld_lock_»cursive_t
;

50 #ifdeà
__USE_UNIX98


51 
±h»ad_rwlock_t
 
	t__libc_rwlock_t
;

53 
__libc_rwlock_İaque__
 
	t__libc_rwlock_t
;

56 
__libc_lock_İaque__
 
	t__libc_lock_t
;

57 
__libc_lock_»cursive_İaque__
 
	t__libc_lock_»cursive_t
;

58 
__libc_rwlock_İaque__
 
	t__libc_rwlock_t
;

62 
±h»ad_key_t
 
	t__libc_key_t
;

71 
	#__libc_lock_defše
(
CLASS
,
NAME
) \

72 
CLASS
 
__libc_lock_t
 
NAME
;

	)

73 
	#__libc_rwlock_defše
(
CLASS
,
NAME
) \

74 
CLASS
 
__libc_rwlock_t
 
NAME
;

	)

75 
	#__libc_lock_defše_»cursive
(
CLASS
,
NAME
) \

76 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

77 
	#__¹ld_lock_defše_»cursive
(
CLASS
,
NAME
) \

78 
CLASS
 
__¹ld_lock_»cursive_t
 
NAME
;

	)

89 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

90 #ià
LLL_LOCK_INITIALIZER
 == 0

91 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

92 
CLASS
 
__libc_lock_t
 
NAME
;

	)

94 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

95 
CLASS
 
__libc_lock_t
 
NAME
 = 
LLL_LOCK_INITIALIZER
;

	)

98 #ià
__LT_SPINLOCK_INIT
 == 0

99 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

100 
CLASS
 
__libc_lock_t
 
NAME
;

	)

102 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

103 
CLASS
 
__libc_lock_t
 
NAME
 = 
PTHREAD_MUTEX_INITIALIZER
;

	)

107 
	#__libc_rwlock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

108 
CLASS
 
__libc_rwlock_t
 
NAME
 = 
PTHREAD_RWLOCK_INITIALIZER
;

	)

112 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

113 #ià
LLL_LOCK_INITIALIZER
 == 0

114 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

115 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

117 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

118 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

120 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

121 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

123 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

124 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

125 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

126 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

129 
	#__¹ld_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

130 
CLASS
 
__¹ld_lock_»cursive_t
 
NAME
 = 
_RTLD_LOCK_RECURSIVE_INITIALIZER
;

	)

131 
	#_RTLD_LOCK_RECURSIVE_INITIALIZER
 \

132 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

134 
	#__¹ld_lock_š™Ÿlize
(
NAME
) \

135 (è((
NAME
èğ(
__¹ld_lock_»cursive_t
è
_RTLD_LOCK_RECURSIVE_INITIALIZER
)

	)

142 #ifdeà
__PIC__


143 
	#__libc_maybe_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

144 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of
 (
FUNC
è*
_â
 = (FUNC); \

145 
_â
 !ğ
NULL
 ? (*_âè
ARGS
 : 
ELSE
; }))

	)

147 
	#__libc_maybe_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

148 (
FUNC
 !ğ
NULL
 ? FUNC 
ARGS
 : 
ELSE
)

	)

152 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


153 
	#PTFAVAIL
(
NAME
è
__libc_±h»ad_funùiÚs_š™


	)

154 
	#__libc_±f_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

155 (
__libc_±h»ad_funùiÚs_š™
 ? 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
è: 
ELSE
)

	)

156 
	#__libc_±f_ÿÎ_®ways
(
FUNC
, 
ARGS
) \

157 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
)

	)

159 
	#PTFAVAIL
(
NAME
è(NAME !ğ
NULL
)

	)

160 
	#__libc_±f_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

161 
	`__libc_maybe_ÿÎ
 (
FUNC
, 
ARGS
, 
ELSE
)

	)

162 
	#__libc_±f_ÿÎ_®ways
(
FUNC
, 
ARGS
) \

163 
FUNC
 
ARGS


	)

169 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

170 
	#__libc_lock_š™
(
NAME
è((NAMEèğ
LLL_LOCK_INITIALIZER
, 0)

	)

172 
	#__libc_lock_š™
(
NAME
) \

173 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_š™
, (&(
NAME
), 
NULL
), 0)

	)

175 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


178 
	#__libc_rwlock_š™
(
NAME
) \

179 (
	`__butš_mem£t
 (&(
NAME
), '\0',  (NAME)), 0)

	)

181 
	#__libc_rwlock_š™
(
NAME
) \

182 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_š™
, (&(
NAME
), 
NULL
), 0)

	)

186 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

187 
	#__libc_lock_š™_»cursive
(
NAME
) \

188 ((
NAME
èğ(
__libc_lock_»cursive_t
è
_LIBC_LOCK_RECURSIVE_INITIALIZER
, 0)

	)

190 
	#__libc_lock_š™_»cursive
(
NAME
) \

192 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

194 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

195 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

196 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

197 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

198 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

200 } 0)

	)

203 
	#__¹ld_lock_š™_»cursive
(
NAME
) \

205 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

207 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

208 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

209 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

210 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

211 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

213 } 0)

	)

218 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

219 
	#__libc_lock_fši
(
NAME
è((è0)

	)

221 
	#__libc_lock_fši
(
NAME
) \

222 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
)), 0)

	)

224 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


225 
	#__libc_rwlock_fši
(
NAME
è((è0)

	)

227 
	#__libc_rwlock_fši
(
NAME
) \

228 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_de¡roy
, (&(
NAME
)), 0)

	)

232 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

233 
	#__libc_lock_fši_»cursive
(
NAME
è((è0)

	)

235 
	#__libc_lock_fši_»cursive
(
NAME
) \

236 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
)), 0)

	)

240 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

241 
	#__libc_lock_lock
(
NAME
) \

242 ({ 
	`Îl_lock
 (
NAME
, 
LLL_PRIVATE
); 0; })

	)

244 
	#__libc_lock_lock
(
NAME
) \

245 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
)), 0)

	)

247 
	#__libc_rwlock_rdlock
(
NAME
) \

248 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_rdlock
, (&(
NAME
)), 0)

	)

249 
	#__libc_rwlock_w¾ock
(
NAME
) \

250 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_w¾ock
, (&(
NAME
)), 0)

	)

253 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

254 
	#__libc_lock_lock_»cursive
(
NAME
) \

256 *
£lf
 = 
THREAD_SELF
; \

257 ià((
NAME
).
owÃr
 !ğ
£lf
) \

259 
	`Îl_lock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

260 (
NAME
).
owÃr
 = 
£lf
; \

262 ++(
NAME
).
út
; \

263 } 0)

	)

265 
	#__libc_lock_lock_»cursive
(
NAME
) \

266 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

270 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

271 
	#__libc_lock_Œylock
(
NAME
) \

272 
	`Îl_Œylock
 (
NAME
)

	)

274 
	#__libc_lock_Œylock
(
NAME
) \

275 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
)), 0)

	)

277 
	#__libc_rwlock_Œyrdlock
(
NAME
) \

278 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_Œyrdlock
, (&(
NAME
)), 0)

	)

279 
	#__libc_rwlock_Œyw¾ock
(
NAME
) \

280 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_Œyw¾ock
, (&(
NAME
)), 0)

	)

283 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

284 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

286 
»suÉ
 = 0; \

287 *
£lf
 = 
THREAD_SELF
; \

288 ià((
NAME
).
owÃr
 !ğ
£lf
) \

290 ià(
	`Îl_Œylock
 ((
NAME
).
lock
) == 0) \

292 (
NAME
).
owÃr
 = 
£lf
; \

293 (
NAME
).
út
 = 1; \

296 
»suÉ
 = 
EBUSY
; \

299 ++(
NAME
).
út
; \

300 
»suÉ
; \

301 })

	)

303 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

304 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
)), 0)

	)

307 
	#__¹ld_lock_Œylock_»cursive
(
NAME
) \

308 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
).
mu‹x
), 0)

	)

311 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

312 
	#__libc_lock_uÆock
(
NAME
) \

313 
	`Îl_uÆock
 (
NAME
, 
LLL_PRIVATE
)

	)

315 
	#__libc_lock_uÆock
(
NAME
) \

316 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
)), 0)

	)

318 
	#__libc_rwlock_uÆock
(
NAME
) \

319 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_uÆock
, (&(
NAME
)), 0)

	)

322 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

324 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

326 ià(--(
NAME
).
út
 == 0) \

328 (
NAME
).
owÃr
 = 
NULL
; \

329 
	`Îl_uÆock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

331 } 0)

	)

333 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

334 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
)), 0)

	)

337 #ià
defšed
 
_LIBC
 && defšed 
SHARED


338 
	#__¹ld_lock_deçuÉ_lock_»cursive
(
lock
) \

339 ++((
±h»ad_mu‹x_t
 *)(
lock
))->
__d©a
.
__couÁ
;

	)

341 
	#__¹ld_lock_deçuÉ_uÆock_»cursive
(
lock
) \

342 --((
±h»ad_mu‹x_t
 *)(
lock
))->
__d©a
.
__couÁ
;

	)

344 
	#__¹ld_lock_lock_»cursive
(
NAME
) \

345 
	`GL
(
dl_¹ld_lock_»cursive
è(&(
NAME
).
mu‹x
)

	)

347 
	#__¹ld_lock_uÆock_»cursive
(
NAME
) \

348 
	`GL
(
dl_¹ld_uÆock_»cursive
è(&(
NAME
).
mu‹x
)

	)

350 
	#__¹ld_lock_lock_»cursive
(
NAME
) \

351 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

353 
	#__¹ld_lock_uÆock_»cursive
(
NAME
) \

354 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
).
mu‹x
), 0)

	)

358 #ià
PTHREAD_ONCE_INIT
 == 0

361 
	#__libc_Úû_defše
(
CLASS
, 
NAME
) \

362 
CLASS
 
±h»ad_Úû_t
 
NAME


	)

364 
	#__libc_Úû_defše
(
CLASS
, 
NAME
) \

365 
CLASS
 
±h»ad_Úû_t
 
NAME
 = 
PTHREAD_ONCE_INIT


	)

369 
	#__libc_Úû
(
ONCE_CONTROL
, 
INIT_FUNCTION
) \

371 ià(
	`PTFAVAIL
 (
__±h»ad_Úû
)) \

372 
	`__libc_±f_ÿÎ_®ways
 (
__±h»ad_Úû
, (&(
ONCE_CONTROL
), \

373 
INIT_FUNCTION
)); \

374 ià((
ONCE_CONTROL
è=ğ
PTHREAD_ONCE_INIT
) { \

375 
	`INIT_FUNCTION
 (); \

376 (
ONCE_CONTROL
) |= 2; \

378 } 0)

	)

381 
	#__libc_Úû_g‘
(
ONCE_CONTROL
) \

382 ((
ONCE_CONTROL
è!ğ
PTHREAD_ONCE_INIT
)

	)

388 
_±h»ad_ş—nup_push
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

389 (*
routše
è(*), *
¬g
);

390 
	`_±h»ad_ş—nup_pİ
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

391 
execu‹
);

392 
	`_±h»ad_ş—nup_push_deãr
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

393 (*
routše
è(*), *
¬g
);

394 
	`_±h»ad_ş—nup_pİ_»¡Üe
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

395 
execu‹
);

398 
	#__libc_ş—nup_»giÚ_¡¬t
(
DOIT
, 
FCT
, 
ARG
) \

399 { 
_±h»ad_ş—nup_bufãr
 
_bufãr
; \

400 
_ava
; \

401 ià(
DOIT
) { \

402 
_ava
 = 
	`PTFAVAIL
 (
_±h»ad_ş—nup_push_deãr
); \

403 ià(
_ava
) { \

404 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_push_deãr
, (&
_bufãr
, 
FCT
, \

405 
ARG
)); \

407 
_bufãr
.
__routše
 = (
FCT
); \

408 
_bufãr
.
__¬g
 = (
ARG
); \

411 
_ava
 = 0; \

412 }

	)

415 
	#__libc_ş—nup_»giÚ_’d
(
DOIT
) \

416 ià(
_ava
) { \

417 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

418 } ià(
DOIT
) \

419 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
); \

420 
	}

	)
}

423 
	#__libc_ş—nup_’d
(
DOIT
) \

424 ià(
_ava
) { \

425 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

426 } ià(
DOIT
) \

427 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
)

	)

431 
__ex‹º_šlše
 

432 
	$__libc_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
f
)

434 ià(
f
->
__do_™
)

435 
f
->
	`__ÿnûl_routše
 (f->
__ÿnûl_¬g
);

436 
	}
}

438 
	#__libc_ş—nup_push
(
fù
, 
¬g
) \

440 
__±h»ad_ş—nup_äame
 
__şäame
 \

441 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__libc_ş—nup_routše
))) \

442 ğ{ .
__ÿnûl_routše
 = (
fù
), .
__ÿnûl_¬g
 = (
¬g
), \

443 .
__do_™
 = 1 };

	)

445 
	#__libc_ş—nup_pİ
(
execu‹
) \

446 
__şäame
.
__do_™
 = (
execu‹
); \

447 } 0)

	)

451 
	#__libc_key_ü—‹
(
KEY
, 
DESTRUCTOR
) \

452 
	`__libc_±f_ÿÎ
 (
__±h»ad_key_ü—‹
, (
KEY
, 
DESTRUCTOR
), 1)

	)

455 
	#__libc_g‘¥ecific
(
KEY
) \

456 
	`__libc_±f_ÿÎ
 (
__±h»ad_g‘¥ecific
, (
KEY
), 
NULL
)

	)

459 
	#__libc_£t¥ecific
(
KEY
, 
VALUE
) \

460 
	`__libc_±f_ÿÎ
 (
__±h»ad_£t¥ecific
, (
KEY
, 
VALUE
), 0)

	)

466 
	#__libc_©fÜk
(
PREPARE
, 
PARENT
, 
CHILD
) \

467 
	`__»gi¡”_©fÜk
 (
PREPARE
, 
PARENT
, 
CHILD
, 
NULL
)

	)

468 
__»gi¡”_©fÜk
 ((*
__´•¬e
) (),

469 (*
__·»Á
) (),

470 (*
__chd
) (),

471 *
__dso_hªdË
);

476 
	`__±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

477 
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__mu‹x_©Œ
);

479 
	`__±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

481 
	`__±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

483 
	`__±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

485 
	`__±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

487 
	`__±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
);

489 
	`__±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
);

491 
	`__±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

492 
__kšd
);

494 #ifdeà
__USE_UNIX98


495 
	`__±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__rwlock
,

496 
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *
__©Œ
);

498 
	`__±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
);

500 
	`__±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
);

502 
	`__±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
);

504 
	`__±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
);

506 
	`__±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
);

508 
	`__±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
);

511 
	`__±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

512 (*
__de¡r_funùiÚ
) (*));

514 
	`__±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

515 
__cÚ¡
 *
__poš‹r
);

517 *
	`__±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
);

519 
	`__±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

520 (*
__š™_routše
) ());

522 
	`__±h»ad_©fÜk
 ((*
__´•¬e
) (),

523 (*
__·»Á
) (),

524 (*
__chd
) ());

530 #iâdeà
__NO_WEAK_PTHREAD_ALIASES


531 #ifdeà
w—k_ex‹º


532 #ià
_LIBC


533 
	~<bp-sym.h
>

535 
	#BP_SYM
 (
sym
è
	)
sym

537 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_š™
))

538 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_de¡roy
))

539 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_lock
))

540 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_Œylock
))

541 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_uÆock
))

542 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_š™
))

543 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_de¡roy
))

544 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_£‰y³
))

545 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_š™
))

546 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_de¡roy
))

547 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_rdlock
))

548 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_Œyrdlock
))

549 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_w¾ock
))

550 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_Œyw¾ock
))

551 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_uÆock
))

552 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_key_ü—‹
))

553 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_£t¥ecific
))

554 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_g‘¥ecific
))

555 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_Úû
))

556 
	$w—k_ex‹º
 (
__±h»ad_š™Ÿlize
)

557 
	$w—k_ex‹º
 (
__±h»ad_©fÜk
)

558 
	`w—k_ex‹º
 (
	$BP_SYM
 (
_±h»ad_ş—nup_push_deãr
))

559 
	`w—k_ex‹º
 (
	$BP_SYM
 (
_±h»ad_ş—nup_pİ_»¡Üe
))

560 
	`w—k_ex‹º
 (
	$BP_SYM
 (
±h»ad_£tÿnûl¡©e
))

562 #´agm¨
w—k
 
__±h»ad_mu‹x_š™


563 #´agm¨
w—k
 
__±h»ad_mu‹x_de¡roy


564 #´agm¨
w—k
 
__±h»ad_mu‹x_lock


565 #´agm¨
w—k
 
__±h»ad_mu‹x_Œylock


566 #´agm¨
w—k
 
__±h»ad_mu‹x_uÆock


567 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_š™


568 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_de¡roy


569 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_£‰y³


570 #´agm¨
w—k
 
__±h»ad_rwlock_de¡roy


571 #´agm¨
w—k
 
__±h»ad_rwlock_rdlock


572 #´agm¨
w—k
 
__±h»ad_rwlock_Œyrdlock


573 #´agm¨
w—k
 
__±h»ad_rwlock_w¾ock


574 #´agm¨
w—k
 
__±h»ad_rwlock_Œyw¾ock


575 #´agm¨
w—k
 
__±h»ad_rwlock_uÆock


576 #´agm¨
w—k
 
__±h»ad_key_ü—‹


577 #´agm¨
w—k
 
__±h»ad_£t¥ecific


578 #´agm¨
w—k
 
__±h»ad_g‘¥ecific


579 #´agm¨
w—k
 
__±h»ad_Úû


580 #´agm¨
w—k
 
__±h»ad_š™Ÿlize


581 #´agm¨
w—k
 
__±h»ad_©fÜk


582 #´agm¨
w—k
 
_±h»ad_ş—nup_push_deãr


583 #´agm¨
w—k
 
_±h»ad_ş—nup_pİ_»¡Üe


584 #´agm¨
w—k
 
±h»ad_£tÿnûl¡©e


	@/usr/include/gconv.h

23 #iâdeà
_GCONV_H


24 
	#_GCONV_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	#__Ãed_mb¡©e_t


	)

28 
	#__Ãed_wšt_t


	)

29 
	~<wch¬.h
>

30 
	#__Ãed_size_t


	)

31 
	#__Ãed_wch¬_t


	)

32 
	~<¡ddef.h
>

35 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

40 
	m__GCONV_OK
 = 0,

41 
	m__GCONV_NOCONV
,

42 
	m__GCONV_NODB
,

43 
	m__GCONV_NOMEM
,

45 
	m__GCONV_EMPTY_INPUT
,

46 
	m__GCONV_FULL_OUTPUT
,

47 
	m__GCONV_ILLEGAL_INPUT
,

48 
	m__GCONV_INCOMPLETE_INPUT
,

50 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

51 
	m__GCONV_INTERNAL_ERROR


58 
	m__GCONV_IS_LAST
 = 0x0001,

59 
	m__GCONV_IGNORE_ERRORS
 = 0x0002

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

72 
	t__cÚ¡
 **, __const *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

86 
	t__cÚ¡
 *,

87 
	t__cÚ¡
 **,

88 
	t__cÚ¡
 *, **,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
è(*, 
	t__cÚ¡
 *,

93 
	t__cÚ¡
 *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
è(
	t__cÚ¡
 *, __const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 
__cÚ¡
 *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___k”Ãl_co¦


	)

11 
	#__¡ub___k”Ãl_sšl


	)

12 
	#__¡ub___k”Ãl_Æ


	)

13 
	#__¡ub_chæags


	)

14 
	#__¡ub_ç‰ach


	)

15 
	#__¡ub_fchæags


	)

16 
	#__¡ub_fd‘ach


	)

17 
	#__¡ub_g‰y


	)

18 
	#__¡ub_lchmod


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/linux/errno.h

1 #iâdeà
_LINUX_ERRNO_H


2 
	#_LINUX_ERRNO_H


	)

4 
	~<asm/”ºo.h
>

	@/usr/include/linux/limits.h

1 #iâdeà
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #undeà
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #undeà
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #undeà
__FDELT


31 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

33 #undeà
__FDMASK


34 
	#__FDMASK
(
d
è(1UL << ((dè% 
__NFDBITS
))

	)

37 
	mfds_b™s
 [
__FDSET_LONGS
];

38 } 
	t__k”Ãl_fd_£t
;

41 (*
	t__k”Ãl_sighªdËr_t
)();

44 
	t__k”Ãl_key_t
;

45 
	t__k”Ãl_mqd_t
;

47 
	~<asm/posix_ty³s.h
>

	@/usr/include/wchar.h

24 #iâdeà
_WCHAR_H


26 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


27 
	#_WCHAR_H
 1

	)

28 
	~<ã©u»s.h
>

31 #ifdeà
_WCHAR_H


33 
	#__Ãed___FILE


	)

34 #ifdeà
__USE_UNIX98


35 
	#__Ãed_FILE


	)

37 
	~<¡dio.h
>

39 
	#__Ãed___va_li¡


	)

40 
	~<¡d¬g.h
>

42 
	~<b™s/wch¬.h
>

45 
	#__Ãed_size_t


	)

46 
	#__Ãed_wch¬_t


	)

47 
	#__Ãed_NULL


	)

49 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


50 #undeà
__Ãed_wšt_t


51 
	#__Ãed_wšt_t


	)

52 
	~<¡ddef.h
>

56 #iâdeà
_WINT_T


61 
	#_WINT_T


	)

62 
	twšt_t
;

66 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

67 && 
defšed
 
__WINT_TYPE__


68 
__BEGIN_NAMESPACE_STD


69 
__WINT_TYPE__
 
	twšt_t
;

70 
	g__END_NAMESPACE_STD


75 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
__mb¡©e_t_defšed


76 
	#__mb¡©e_t_defšed
 1

	)

80 
	m__couÁ
;

83 #ifdeà
__WINT_TYPE__


84 
__WINT_TYPE__
 
	m__wch
;

86 
wšt_t
 
	m__wch
;

88 
	m__wchb
[4];

89 } 
	m__v®ue
;

90 } 
	t__mb¡©e_t
;

92 #undeà
__Ãed_mb¡©e_t


97 #ifdeà
_WCHAR_H


99 
__BEGIN_NAMESPACE_C99


101 
__mb¡©e_t
 
	tmb¡©e_t
;

102 
	g__END_NAMESPACE_C99


103 #ifdeà
__USE_GNU


104 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

107 #iâdeà
WCHAR_MIN


109 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

110 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

113 #iâdeà
WEOF


114 
	#WEOF
 (0xffffffffu)

	)

119 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


120 
	~<wùy³.h
>

124 
__BEGIN_DECLS


126 
__BEGIN_NAMESPACE_STD


129 
tm
;

130 
__END_NAMESPACE_STD


134 
	$__USING_NAMESPACE_STD
(
tm
)

137 
__BEGIN_NAMESPACE_STD


139 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

140 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

142 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

143 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

144 
__THROW
;

147 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

150 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

151 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
;

155 
	$wcscmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
)

156 
__THROW
 
__©Œibu‹_pu»__
;

158 
	$wc¢cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

159 
__THROW
 
__©Œibu‹_pu»__
;

160 
__END_NAMESPACE_STD


162 #ifdeà
__USE_GNU


164 
	$wcsÿ£cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

167 
	$wc¢ÿ£cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

168 
size_t
 
__n
è
__THROW
;

172 
	~<xloÿË.h
>

174 
	$wcsÿ£cmp_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

175 
__loÿË_t
 
__loc
è
__THROW
;

177 
	$wc¢ÿ£cmp_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

178 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

181 
__BEGIN_NAMESPACE_STD


184 
	$wcscŞl
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

188 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

189 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_GNU


198 
	$wcscŞl_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

199 
__loÿË_t
 
__loc
è
__THROW
;

204 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
,

205 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

208 
wch¬_t
 *
	$wcsdup
 (
__cÚ¡
 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

211 
__BEGIN_NAMESPACE_STD


213 
wch¬_t
 *
	$wcschr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

214 
__THROW
 
__©Œibu‹_pu»__
;

216 
wch¬_t
 *
	$wc¤chr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

217 
__THROW
 
__©Œibu‹_pu»__
;

218 
__END_NAMESPACE_STD


220 #ifdeà
__USE_GNU


223 
wch¬_t
 *
	$wcschºul
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

224 
__THROW
 
__©Œibu‹_pu»__
;

227 
__BEGIN_NAMESPACE_STD


230 
size_t
 
	$wcsc¥n
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__»jeù
)

231 
__THROW
 
__©Œibu‹_pu»__
;

234 
size_t
 
	$wcs¥n
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__acû±
)

235 
__THROW
 
__©Œibu‹_pu»__
;

237 
wch¬_t
 *
	$wc¥brk
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__acû±
)

238 
__THROW
 
__©Œibu‹_pu»__
;

240 
wch¬_t
 *
	$wcs¡r
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
, __cÚ¡ wch¬_ˆ*
__ÃedË
)

241 
__THROW
 
__©Œibu‹_pu»__
;

244 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

245 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__d–im
,

246 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

249 
size_t
 
	$wc¦’
 (
__cÚ¡
 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

250 
__END_NAMESPACE_STD


252 #ifdeà
__USE_XOPEN


254 
wch¬_t
 *
	$wcswcs
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
, __cÚ¡ wch¬_ˆ*
__ÃedË
)

255 
__THROW
 
__©Œibu‹_pu»__
;

258 #ifdeà
__USE_GNU


260 
size_t
 
	$wc¢Ën
 (
__cÚ¡
 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

261 
__THROW
 
__©Œibu‹_pu»__
;

265 
__BEGIN_NAMESPACE_STD


267 
wch¬_t
 *
	$wmemchr
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

268 
__THROW
 
__©Œibu‹_pu»__
;

271 
	$wmemcmp
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s1
,

272 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

273 
__THROW
 
__©Œibu‹_pu»__
;

276 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

277 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

281 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
, 
size_t
 
__n
)

282 
__THROW
;

285 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

286 
__END_NAMESPACE_STD


288 #ifdeà
__USE_GNU


291 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

292 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

293 
__THROW
;

297 
__BEGIN_NAMESPACE_STD


300 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

304 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

308 
	$mbsš™
 (
__cÚ¡
 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

312 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

313 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

314 
mb¡©e_t
 *
__p
è
__THROW
;

317 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

318 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

321 
size_t
 
	$__mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

322 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

323 
size_t
 
	$mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

324 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

325 
__END_NAMESPACE_STD


327 #ifdeà
__USE_EXTERN_INLINES


333 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

334 
__ex‹º_šlše
 
wšt_t


335 
	`__NTH
 (
	$btowc
 (
__c
))

336 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

337 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

339 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

340 
__ex‹º_šlše
 

341 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

342 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

343 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

345 
__ex‹º_šlše
 
size_t


346 
__NTH
 (
	$mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

347 
mb¡©e_t
 *
__»¡riù
 
__ps
))

348 {  (
__ps
 !ğ
NULL


349 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

352 
__BEGIN_NAMESPACE_STD


355 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

356 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

357 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

361 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

362 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

363 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

364 
__END_NAMESPACE_STD


367 #ifdef 
__USE_GNU


370 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

371 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

372 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

377 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

378 
size_t
 
__nwc
, size_ˆ
__Ën
,

379 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

384 #ifdeà
__USE_XOPEN


386 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

390 
	$wcswidth
 (
__cÚ¡
 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

394 
__BEGIN_NAMESPACE_STD


397 
	$wc¡od
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

398 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

399 
__END_NAMESPACE_STD


401 #ifdeà
__USE_ISOC99


402 
__BEGIN_NAMESPACE_C99


404 
	$wc¡of
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

405 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

406 
	$wc¡Şd
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

407 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

408 
__END_NAMESPACE_C99


412 
__BEGIN_NAMESPACE_STD


415 
	$wc¡Ş
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

416 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

420 
	$wc¡oul
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

421 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

422 
__THROW
;

423 
__END_NAMESPACE_STD


425 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GNUC__
 && defšed 
__USE_GNU
)

426 
__BEGIN_NAMESPACE_C99


429 
__ex‹nsiÚ__


430 
	$wc¡Şl
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

431 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

432 
__THROW
;

436 
__ex‹nsiÚ__


437 
	$wc¡ouÎ
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

438 
wch¬_t
 **
__»¡riù
 
__’d±r
,

439 
__ba£
è
__THROW
;

440 
__END_NAMESPACE_C99


443 #ià
defšed
 
__GNUC__
 && defšed 
__USE_GNU


446 
__ex‹nsiÚ__


447 
	$wc¡oq
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

448 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

449 
__THROW
;

453 
__ex‹nsiÚ__


454 
	$wc¡ouq
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

455 
wch¬_t
 **
__»¡riù
 
__’d±r
,

456 
__ba£
è
__THROW
;

459 #ifdeà
__USE_GNU


473 
	~<xloÿË.h
>

477 
	$wc¡Ş_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

478 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

479 
__loÿË_t
 
__loc
è
__THROW
;

481 
	$wc¡oul_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

482 
wch¬_t
 **
__»¡riù
 
__’d±r
,

483 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

485 
__ex‹nsiÚ__


486 
	$wc¡Şl_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

487 
wch¬_t
 **
__»¡riù
 
__’d±r
,

488 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

490 
__ex‹nsiÚ__


491 
	$wc¡ouÎ_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

492 
wch¬_t
 **
__»¡riù
 
__’d±r
,

493 
__ba£
, 
__loÿË_t
 
__loc
)

494 
__THROW
;

496 
	$wc¡od_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

497 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

498 
__THROW
;

500 
	$wc¡of_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

502 
__THROW
;

504 
	$wc¡Şd_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

505 
wch¬_t
 **
__»¡riù
 
__’d±r
,

506 
__loÿË_t
 
__loc
è
__THROW
;

510 #ifdef 
__USE_GNU


513 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
è
__THROW
;

517 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
)

518 
__THROW
;

524 #ifdef 
__USE_GNU


527 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

530 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


531 
__BEGIN_NAMESPACE_STD


534 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

541 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

542 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

548 
	`w´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

551 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

552 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

553 
__THROW
 ;

559 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

560 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

561 
__gnuc_va_li¡
 
__¬g
)

567 
	`vw´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

568 
__gnuc_va_li¡
 
__¬g
)

572 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

573 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

574 
__gnuc_va_li¡
 
__¬g
)

575 
__THROW
 ;

582 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

583 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

589 
	`wsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

592 
	$swsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

593 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

594 
__THROW
 ;

596 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

597 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

598 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

599 #ifdeà
__REDIRECT


603 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

604 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

605 
__isoc99_fwsÿnf
)

607 
	`__REDIRECT
 (
wsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

608 
__isoc99_wsÿnf
)

610 
	`__REDIRECT
 (
swsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

611 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

612 
__isoc99_swsÿnf
)

613 
__THROW
 ;

615 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

616 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

617 
	`__isoc99_wsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

618 
	$__isoc99_swsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

619 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

620 
__THROW
;

621 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

622 
	#wsÿnf
 
__isoc99_wsÿnf


	)

623 
	#swsÿnf
 
__isoc99_swsÿnf


	)

627 
__END_NAMESPACE_STD


630 #ifdeà
__USE_ISOC99


631 
__BEGIN_NAMESPACE_C99


636 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

637 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

638 
__gnuc_va_li¡
 
__¬g
)

644 
	`vwsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

645 
__gnuc_va_li¡
 
__¬g
)

648 
	$vswsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

649 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

650 
__gnuc_va_li¡
 
__¬g
)

651 
__THROW
 ;

653 #ià!
defšed
 
__USE_GNU
 \

654 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

655 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

656 #ifdeà
__REDIRECT


657 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

658 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

659 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

661 
	`__REDIRECT
 (
vwsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

662 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

664 
	`__REDIRECT
 (
vswsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

665 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

666 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

667 
__THROW
 ;

669 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

670 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

671 
__gnuc_va_li¡
 
__¬g
);

672 
	`__isoc99_vwsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

673 
__gnuc_va_li¡
 
__¬g
);

674 
	$__isoc99_vswsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

675 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

676 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

677 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

678 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

679 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

683 
__END_NAMESPACE_C99


687 
__BEGIN_NAMESPACE_STD


692 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

693 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

699 
wšt_t
 
	`g‘wch¬
 ();

706 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

707 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

713 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

721 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

722 
__FILE
 *
__»¡riù
 
__¡»am
);

728 
	`åutws
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ws
,

729 
__FILE
 *
__»¡riù
 
__¡»am
);

736 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

737 
__END_NAMESPACE_STD


740 #ifdeà
__USE_GNU


748 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

749 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

757 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

765 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

774 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

775 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

784 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

785 
__FILE
 *
__»¡riù
 
__¡»am
);

793 
	`åutws_uÆocked
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ws
,

794 
__FILE
 *
__»¡riù
 
__¡»am
);

798 
__BEGIN_NAMESPACE_C99


802 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

803 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

804 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

805 
__END_NAMESPACE_C99


807 #ifdeà
__USE_GNU


808 
	~<xloÿË.h
>

812 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

813 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

814 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

815 
__loÿË_t
 
__loc
è
__THROW
;

824 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


825 
	#__Ãed_iswxxx


	)

826 
	~<wùy³.h
>

830 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


831 
	~<b™s/wch¬2.h
>

834 #ifdeà
__LDBL_COMPAT


835 
	~<b™s/wch¬-ldbl.h
>

838 
__END_DECLS


844 #undeà
__Ãed_mb¡©e_t


845 #undeà
__Ãed_wšt_t


	@/usr/include/asm-generic/int-ll64.h

8 #iâdeà
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 #iâdeà
__ASSEMBLY__


17 
__sigÃd__
 
	t__s8
;

18 
	t__u8
;

20 
__sigÃd__
 
	t__s16
;

21 
	t__u16
;

23 
__sigÃd__
 
	t__s32
;

24 
	t__u32
;

26 #ifdeà
__GNUC__


27 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

28 
__ex‹nsiÚ__
 
	t__u64
;

29 #–ià
defšed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

30 
__sigÃd__
 
	t__s64
;

31 
	t__u64
;

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm/posix_types.h

1 #ifdeà
__i386__


2 
	~"posix_ty³s_32.h
"

4 
	~"posix_ty³s_64.h
"

	@/usr/include/bits/wchar-ldbl.h

20 #iâdeà
_WCHAR_H


24 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


25 
__BEGIN_NAMESPACE_C99


26 
__LDBL_REDIR_DECL
 (
fw´štf
);

27 
__LDBL_REDIR_DECL
 (
w´štf
);

28 
__LDBL_REDIR_DECL
 (
sw´štf
);

29 
__LDBL_REDIR_DECL
 (
vfw´štf
);

30 
__LDBL_REDIR_DECL
 (
vw´štf
);

31 
__LDBL_REDIR_DECL
 (
vsw´štf
);

32 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

33 && !
defšed
 
	g__REDIRECT
 \

34 && (
defšed
 
	g__STRICT_ANSI__
 || defšed 
	g__USE_XOPEN2K
)

35 
	$__LDBL_REDIR1_DECL
 (
fwsÿnf
, 
__Ædbl___isoc99_fwsÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
wsÿnf
, 
__Ædbl___isoc99_wsÿnf
)

37 
	$__LDBL_REDIR1_DECL
 (
swsÿnf
, 
__Ædbl___isoc99_swsÿnf
)

39 
	`__LDBL_REDIR_DECL
 (
fwsÿnf
);

40 
	`__LDBL_REDIR_DECL
 (
wsÿnf
);

41 
	`__LDBL_REDIR_DECL
 (
swsÿnf
);

43 
__END_NAMESPACE_C99


46 #ifdeà
__USE_ISOC99


47 
__BEGIN_NAMESPACE_C99


48 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd
, 
wc¡od
);

49 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

50 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

51 
	$__LDBL_REDIR1_DECL
 (
vfwsÿnf
, 
__Ædbl___isoc99_vfwsÿnf
)

52 
	$__LDBL_REDIR1_DECL
 (
vwsÿnf
, 
__Ædbl___isoc99_vwsÿnf
)

53 
	$__LDBL_REDIR1_DECL
 (
vswsÿnf
, 
__Ædbl___isoc99_vswsÿnf
)

55 
	`__LDBL_REDIR_DECL
 (
vfwsÿnf
);

56 
	`__LDBL_REDIR_DECL
 (
vwsÿnf
);

57 
	`__LDBL_REDIR_DECL
 (
vswsÿnf
);

59 
__END_NAMESPACE_C99


62 #ifdeà
__USE_GNU


63 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd_l
, 
wc¡od_l
);

66 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


67 
	$__LDBL_REDIR_DECL
 (
__sw´štf_chk
)

68 
	$__LDBL_REDIR_DECL
 (
__vsw´štf_chk
)

69 #ià
__USE_FORTIFY_LEVEL
 > 1

70 
	$__LDBL_REDIR_DECL
 (
__fw´štf_chk
)

71 
	$__LDBL_REDIR_DECL
 (
__w´štf_chk
)

72 
	$__LDBL_REDIR_DECL
 (
__vfw´štf_chk
)

73 
	$__LDBL_REDIR_DECL
 (
__vw´štf_chk
)

	@/usr/include/bits/wchar2.h

20 #iâdeà
_WCHAR_H


25 
wch¬_t
 *
	$__wmemıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

26 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

27 
size_t
 
__ns1
è
__THROW
;

28 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_®Ÿs
,

29 (
wch¬_t
 *
__»¡riù
 
__s1
,

30 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
),

31 
wmemıy
);

32 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_chk_w¬n
,

33 (
wch¬_t
 *
__»¡riù
 
__s1
,

34 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

35 
size_t
 
__ns1
), 
__wmemıy_chk
)

36 
	`__w¬Ç‰r
 ("wmemcpy called with†ength biggerhan size of destination "

39 
__ex‹º_®ways_šlše
 
wch¬_t
 *

40 
	`__NTH
 (
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

41 
size_t
 
__n
))

43 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

45 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

46  
	`__wmemıy_chk
 (
__s1
, 
__s2
, 
__n
,

47 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

49 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

50  
	`__wmemıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

51 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

53  
	`__wmemıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

54 
	}
}

57 
wch¬_t
 *
	$__wmemmove_chk
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
,

58 
size_t
 
__n
, size_ˆ
__ns1
è
__THROW
;

59 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_®Ÿs
, (wch¬_ˆ*
__s1
,

60 
__cÚ¡
 
wch¬_t
 *
__s2
,

61 
size_t
 
__n
), 
wmemmove
);

62 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¬n
,

63 (
wch¬_t
 *
__»¡riù
 
__s1
,

64 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

65 
size_t
 
__ns1
), 
__wmemmove_chk
)

66 
	`__w¬Ç‰r
 ("wmemmove called with†ength biggerhan size of destination "

69 
__ex‹º_®ways_šlše
 
wch¬_t
 *

70 
	`__NTH
 (
	$wmemmove
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

71 
size_t
 
__n
))

73 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

75 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

76  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

77 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

79 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

80  
	`__wmemmove_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

81 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

83  
	`__wmemmove_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

84 
	}
}

87 #ifdeà
__USE_GNU


88 
wch¬_t
 *
	$__wmempıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

89 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

90 
size_t
 
__ns1
è
__THROW
;

91 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_®Ÿs
,

92 (
wch¬_t
 *
__»¡riù
 
__s1
,

93 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
,

94 
size_t
 
__n
), 
wmempıy
);

95 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_chk_w¬n
,

96 (
wch¬_t
 *
__»¡riù
 
__s1
,

97 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

98 
size_t
 
__ns1
), 
__wmempıy_chk
)

99 
	`__w¬Ç‰r
 ("wmempcpy called with†ength biggerhan size of destination "

102 
__ex‹º_®ways_šlše
 
wch¬_t
 *

103 
	`__NTH
 (
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

104 
size_t
 
__n
))

106 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

108 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

109  
	`__wmempıy_chk
 (
__s1
, 
__s2
, 
__n
,

110 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

112 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

113  
	`__wmempıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

114 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

116  
	`__wmempıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

117 
	}
}

121 
wch¬_t
 *
	$__wmem£t_chk
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

122 
size_t
 
__ns
è
__THROW
;

123 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_®Ÿs
, (wch¬_ˆ*
__s
, wch¬_ˆ
__c
,

124 
size_t
 
__n
), 
wmem£t
);

125 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¬n
,

126 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

127 
size_t
 
__ns
), 
__wmem£t_chk
)

128 
	`__w¬Ç‰r
 ("wmemset called with†ength biggerhan size of destination "

131 
__ex‹º_®ways_šlše
 
wch¬_t
 *

132 
	`__NTH
 (
	$wmem£t
 (
wch¬_t
 *
__»¡riù
 
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
))

134 ià(
	`__bos0
 (
__s
è!ğ(
size_t
) -1)

136 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

137  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sè/  (
wch¬_t
));

139 ià(
__n
 > 
	`__bos0
 (
__s
è/  (
wch¬_t
))

140  
	`__wmem£t_chk_w¬n
 (
__s
, 
__c
, 
__n
,

141 
	`__bos0
 (
__s
è/  (
wch¬_t
));

143  
	`__wmem£t_®Ÿs
 (
__s
, 
__c
, 
__n
);

144 
	}
}

147 
wch¬_t
 *
	$__wcsıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

149 
size_t
 
__n
è
__THROW
;

150 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsıy_®Ÿs
,

151 (
wch¬_t
 *
__»¡riù
 
__de¡
,

152 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsıy
);

154 
__ex‹º_®ways_šlše
 
wch¬_t
 *

155 
	`__NTH
 (
	$wcsıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

157 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

158  
	`__wcsıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

159  
	`__wcsıy_®Ÿs
 (
__de¡
, 
__¤c
);

160 
	}
}

163 
wch¬_t
 *
	$__wııy_chk
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
,

164 
size_t
 
__de¡Ën
è
__THROW
;

165 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wııy_®Ÿs
, (wch¬_ˆ*
__de¡
,

166 
__cÚ¡
 
wch¬_t
 *
__¤c
),

167 
wııy
);

169 
__ex‹º_®ways_šlše
 
wch¬_t
 *

170 
	`__NTH
 (
	$wııy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

172 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

173  
	`__wııy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

174  
	`__wııy_®Ÿs
 (
__de¡
, 
__¤c
);

175 
	}
}

178 
wch¬_t
 *
	$__wc¢ıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

179 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

180 
size_t
 
__de¡Ën
è
__THROW
;

181 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_®Ÿs
,

182 (
wch¬_t
 *
__»¡riù
 
__de¡
,

183 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

184 
size_t
 
__n
), 
wc¢ıy
);

185 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_chk_w¬n
,

186 (
wch¬_t
 *
__»¡riù
 
__de¡
,

187 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

188 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wc¢ıy_chk
)

189 
	`__w¬Ç‰r
 ("wcsncpy called with†ength biggerhan size of destination "

192 
__ex‹º_®ways_šlše
 
wch¬_t
 *

193 
	`__NTH
 (
	$wc¢ıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

195 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

197 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

198  
	`__wc¢ıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

199 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

200 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

201  
	`__wc¢ıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

202 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

204  
	`__wc¢ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

205 
	}
}

208 
wch¬_t
 *
	$__wınıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

209 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

210 
size_t
 
__de¡Ën
è
__THROW
;

211 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_®Ÿs
,

212 (
wch¬_t
 *
__»¡riù
 
__de¡
,

213 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

214 
size_t
 
__n
), 
wınıy
);

215 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_chk_w¬n
,

216 (
wch¬_t
 *
__»¡riù
 
__de¡
,

217 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

218 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wınıy_chk
)

219 
	`__w¬Ç‰r
 ("wcpncpy called with†ength biggerhan size of destination "

222 
__ex‹º_®ways_šlše
 
wch¬_t
 *

223 
	`__NTH
 (
	$wınıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

225 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

227 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

228  
	`__wınıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

229 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

230 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

231  
	`__wınıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

232 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

234  
	`__wınıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

235 
	}
}

238 
wch¬_t
 *
	$__wcsÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

239 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

240 
size_t
 
__de¡Ën
è
__THROW
;

241 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsÿt_®Ÿs
,

242 (
wch¬_t
 *
__»¡riù
 
__de¡
,

243 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsÿt
);

245 
__ex‹º_®ways_šlše
 
wch¬_t
 *

246 
	`__NTH
 (
	$wcsÿt
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

248 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

249  
	`__wcsÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

250  
	`__wcsÿt_®Ÿs
 (
__de¡
, 
__¤c
);

251 
	}
}

254 
wch¬_t
 *
	$__wc¢ÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

255 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

256 
size_t
 
__n
, size_ˆ
__de¡Ën
è
__THROW
;

257 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ÿt_®Ÿs
,

258 (
wch¬_t
 *
__»¡riù
 
__de¡
,

259 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

260 
size_t
 
__n
), 
wc¢ÿt
);

262 
__ex‹º_®ways_šlše
 
wch¬_t
 *

263 
	`__NTH
 (
	$wc¢ÿt
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

265 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

266  
	`__wc¢ÿt_chk
 (
__de¡
, 
__¤c
, 
__n
,

267 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

268  
	`__wc¢ÿt_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

269 
	}
}

272 
	$__sw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

273 
__æag
, 
size_t
 
__s_Ën
,

274 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

275 
__THROW
 ;

277 
	`__REDIRECT_NTH_LDBL
 (
__sw´štf_®Ÿs
,

278 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

279 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...),

280 
sw´štf
);

282 #ifdeà
__va_¬g_·ck


283 
__ex‹º_®ways_šlše
 

284 
	`__NTH
 (
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

285 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...))

287 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

288  
	`__sw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

289 
	`__bos
 (
__s
è/  (
wch¬_t
),

290 
__fmt
, 
	`__va_¬g_·ck
 ());

291  
	`__sw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¬g_·ck
 ());

292 
	}
}

293 #–ià!
defšed
 
__ılu¥lus


295 
	#sw´štf
(
s
, 
n
, ...) \

296 (
	`__bos
 (
s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

297 ? 
	`__sw´štf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

298 
	`__bos
 (
s
è/  (
wch¬_t
), 
__VA_ARGS__
) \

299 : 
	`sw´štf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

302 
	$__vsw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

303 
__æag
, 
size_t
 
__s_Ën
,

304 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

305 
__gnuc_va_li¡
 
__¬g
)

306 
__THROW
 ;

308 
	`__REDIRECT_NTH_LDBL
 (
__vsw´štf_®Ÿs
,

309 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

310 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
,

311 
__gnuc_va_li¡
 
__­
), 
vsw´štf
);

313 
__ex‹º_®ways_šlše
 

314 
	`__NTH
 (
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

315 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
))

317 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

318  
	`__vsw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

319 
	`__bos
 (
__s
è/  (
wch¬_t
), 
__fmt
, 
__­
);

320  
	`__vsw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
__­
);

321 
	}
}

324 #ià
__USE_FORTIFY_LEVEL
 > 1

326 
__fw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

327 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

328 
__w´štf_chk
 (
__æag
, 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

330 
__vfw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

331 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

332 
__gnuc_va_li¡
 
__­
);

333 
__vw´štf_chk
 (
__æag
, 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

334 
__gnuc_va_li¡
 
__­
);

336 #ifdeà
__va_¬g_·ck


337 
__ex‹º_®ways_šlše
 

338 
	$w´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...)

340  
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

341 
	}
}

343 
__ex‹º_®ways_šlše
 

344 
	$fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__cÚ¡
 
wch¬_t
 *__»¡riù 
__fmt
, ...)

346  
	`__fw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

347 
	`__va_¬g_·ck
 ());

348 
	}
}

349 #–ià!
defšed
 
__ılu¥lus


350 
	#w´štf
(...) \

351 
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

352 
	#fw´štf
(
¡»am
, ...) \

353 
	`__fw´štf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

356 
__ex‹º_®ways_šlše
 

357 
	$vw´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

359  
	`__vw´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

360 
	}
}

362 
__ex‹º_®ways_šlše
 

363 
	$vfw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

364 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

366  
	`__vfw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

367 
	}
}

371 
wch¬_t
 *
	$__fg‘ws_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

372 
__FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

373 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_®Ÿs
,

374 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

375 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws
è
__wur
;

376 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_chk_w¬n
,

377 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

378 
__FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘ws_chk
)

379 
__wur
 
	`__w¬Ç‰r
 ("fgetws called with bigger sizehan†ength "

382 
__ex‹º_®ways_šlše
 
__wur
 
wch¬_t
 *

383 
	$fg‘ws
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

385 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

387 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

388  
	`__fg‘ws_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

389 
__n
, 
__¡»am
);

391 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

392  
	`__fg‘ws_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

393 
__n
, 
__¡»am
);

395  
	`__fg‘ws_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

396 
	}
}

398 #ifdeà
__USE_GNU


399 
wch¬_t
 *
	$__fg‘ws_uÆocked_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
,

400 
__n
, 
__FILE
 *
__»¡riù
 
__¡»am
)

401 
__wur
;

402 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_®Ÿs
,

403 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

404 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws_uÆocked
)

405 
__wur
;

406 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_chk_w¬n
,

407 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

408 
__FILE
 *
__»¡riù
 
__¡»am
),

409 
__fg‘ws_uÆocked_chk
)

410 
__wur
 
	`__w¬Ç‰r
 ("fgetws_unlocked called with bigger sizehan†ength "

413 
__ex‹º_®ways_šlše
 
__wur
 
wch¬_t
 *

414 
	$fg‘ws_uÆocked
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

416 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

418 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

419  
	`__fg‘ws_uÆocked_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

420 
__n
, 
__¡»am
);

422 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

423  
	`__fg‘ws_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

424 
__n
, 
__¡»am
);

426  
	`__fg‘ws_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

427 
	}
}

431 
size_t
 
	$__wütomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
mb¡©e_t
 *
__p
,

432 
size_t
 
__buæ’
è
__THROW
 
__wur
;

433 
size_t
 
	`__REDIRECT_NTH
 (
__wütomb_®Ÿs
,

434 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

435 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wütomb
è
__wur
;

437 
__ex‹º_®ways_šlše
 
__wur
 
size_t


438 
	`__NTH
 (
	$wütomb
 (*
__s
, 
wch¬_t
 
__wch¬
, 
mb¡©e_t
 *
__ps
))

443 
	#__WCHAR_MB_LEN_MAX
 16

	)

444 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__WCHAR_MB_LEN_MAX


447 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

448  
	`__wütomb_chk
 (
__s
, 
__wch¬
, 
__ps
, 
	`__bos
 (__s));

449  
	`__wütomb_®Ÿs
 (
__s
, 
__wch¬
, 
__ps
);

450 
	}
}

453 
size_t
 
	$__mb¤towcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

454 
__cÚ¡
 **
__»¡riù
 
__¤c
,

455 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

456 
size_t
 
__d¡Ën
è
__THROW
;

457 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_®Ÿs
,

458 (
wch¬_t
 *
__»¡riù
 
__d¡
,

459 
__cÚ¡
 **
__»¡riù
 
__¤c
,

460 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

461 
mb¤towcs
);

462 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_chk_w¬n
,

463 (
wch¬_t
 *
__»¡riù
 
__d¡
,

464 
__cÚ¡
 **
__»¡riù
 
__¤c
,

465 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

466 
size_t
 
__d¡Ën
), 
__mb¤towcs_chk
)

467 
	`__w¬Ç‰r
 ("mbsrtowcs called with dst buffer smallerhan†en "

470 
__ex‹º_®ways_šlše
 
size_t


471 
	`__NTH
 (
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 **__»¡riù 
__¤c
,

472 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

474 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

476 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

477  
	`__mb¤towcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

478 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

480 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

481  
	`__mb¤towcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

482 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

484  
	`__mb¤towcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

485 
	}
}

488 
size_t
 
	$__wc¤tombs_chk
 (*
__»¡riù
 
__d¡
,

489 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

490 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

491 
size_t
 
__d¡Ën
è
__THROW
;

492 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_®Ÿs
,

493 (*
__»¡riù
 
__d¡
,

494 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

495 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

496 
wc¤tombs
);

497 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_chk_w¬n
,

498 (*
__»¡riù
 
__d¡
,

499 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

500 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

501 
size_t
 
__d¡Ën
), 
__wc¤tombs_chk
)

502 
	`__w¬Ç‰r
 ("wcsrtombs called with dst buffer smallerhan†en");

504 
__ex‹º_®ways_šlše
 
size_t


505 
	`__NTH
 (
	$wc¤tombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 **__»¡riù 
__¤c
,

506 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

508 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

510 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

511  
	`__wc¤tombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

513 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

514  
	`__wc¤tombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

516  
	`__wc¤tombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

517 
	}
}

520 #ifdeà
__USE_GNU


521 
size_t
 
	$__mb¢¹owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

522 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

523 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

524 
size_t
 
__d¡Ën
è
__THROW
;

525 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_®Ÿs
,

526 (
wch¬_t
 *
__»¡riù
 
__d¡
,

527 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

528 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

529 
mb¢¹owcs
);

530 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_chk_w¬n
,

531 (
wch¬_t
 *
__»¡riù
 
__d¡
,

532 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

533 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

534 
size_t
 
__d¡Ën
), 
__mb¢¹owcs_chk
)

535 
	`__w¬Ç‰r
 ("mbsnrtowcs called with dst buffer smallerhan†en "

538 
__ex‹º_®ways_šlše
 
size_t


539 
	`__NTH
 (
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 **__»¡riù 
__¤c
,

540 
size_t
 
__nmc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

542 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

544 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

545  
	`__mb¢¹owcs_chk
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

546 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

548 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

549  
	`__mb¢¹owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

550 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

552  
	`__mb¢¹owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
);

553 
	}
}

556 
size_t
 
	$__wc¢¹ombs_chk
 (*
__»¡riù
 
__d¡
,

557 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

558 
size_t
 
__nwc
, size_ˆ
__Ën
,

559 
mb¡©e_t
 *
__»¡riù
 
__ps
, 
size_t
 
__d¡Ën
)

560 
__THROW
;

561 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_®Ÿs
,

562 (*
__»¡riù
 
__d¡
,

563 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

564 
size_t
 
__nwc
, size_ˆ
__Ën
,

565 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wc¢¹ombs
);

566 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_chk_w¬n
,

567 (*
__»¡riù
 
__d¡
,

568 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

569 
size_t
 
__nwc
, size_ˆ
__Ën
,

570 
mb¡©e_t
 *
__»¡riù
 
__ps
,

571 
size_t
 
__d¡Ën
), 
__wc¢¹ombs_chk
)

572 
	`__w¬Ç‰r
 ("wcsnrtombs called with dst buffer smallerhan†en");

574 
__ex‹º_®ways_šlše
 
size_t


575 
	`__NTH
 (
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 **__»¡riù 
__¤c
,

576 
size_t
 
__nwc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

578 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

580 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

581  
	`__wc¢¹ombs_chk
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

582 
	`__bos
 (
__d¡
));

584 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

585  
	`__wc¢¹ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

586 
	`__bos
 (
__d¡
));

588  
	`__wc¢¹ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
);

589 
	}
}

	@/usr/include/linux/stddef.h

1 #iâdeà
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

5 #undeà
NULL


6 #ià
defšed
(
__ılu¥lus
)

7 
	#NULL
 0

	)

9 
	#NULL
 ((*)0)

	)

	@/usr/include/pthread.h

20 #iâdeà
_PTHREAD_H


21 
	#_PTHREAD_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<’dŸn.h
>

25 
	~<sched.h
>

26 
	~<time.h
>

28 
	#__Ãed_sig£t_t


	)

29 
	~<sigÇl.h
>

30 
	~<b™s/±h»adty³s.h
>

31 
	~<b™s/£tjmp.h
>

32 
	~<b™s/wÜdsize.h
>

38 
	mPTHREAD_CREATE_JOINABLE
,

39 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

40 
	mPTHREAD_CREATE_DETACHED


41 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

48 
	mPTHREAD_MUTEX_TIMED_NP
,

49 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

50 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

51 
	mPTHREAD_MUTEX_ADAPTIVE_NP


52 #ifdeà
__USE_UNIX98


54 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

55 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

56 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

57 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


59 #ifdeà
__USE_GNU


61 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


66 #ifdeà
__USE_GNU


70 
	mPTHREAD_MUTEX_STALLED_NP
,

71 
	mPTHREAD_MUTEX_ROBUST_NP


76 #ifdeà
__USE_UNIX98


80 
	mPTHREAD_PRIO_NONE
,

81 
	mPTHREAD_PRIO_INHERIT
,

82 
	mPTHREAD_PRIO_PROTECT


88 #ià
__WORDSIZE
 == 64

89 
	#PTHREAD_MUTEX_INITIALIZER
 \

90 { { 0, 0, 0, 0, 0, 0, { 0, 0 } } }

	)

91 #ifdeà
__USE_GNU


92 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

93 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0, 0 } } }

	)

94 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0, 0 } } }

	)

96 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

97 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0, 0 } } }

	)

100 
	#PTHREAD_MUTEX_INITIALIZER
 \

101 { { 0, 0, 0, 0, 0, { 0 } } }

	)

102 #ifdeà
__USE_GNU


103 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0 } } }

	)

105 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0 } } }

	)

107 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

108 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0 } } }

	)

114 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


117 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

120 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


124 
	#PTHREAD_RWLOCK_INITIALIZER
 \

125 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

126 #ifdeà
__USE_GNU


127 #ià
__WORDSIZE
 == 64

128 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

130 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

132 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


133 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

134 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

135 0, 0, 0, 0 } }

	)

137 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

138 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

139 0 } }

	)

149 
	mPTHREAD_INHERIT_SCHED
,

150 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

151 
	mPTHREAD_EXPLICIT_SCHED


152 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

159 
	mPTHREAD_SCOPE_SYSTEM
,

160 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

161 
	mPTHREAD_SCOPE_PROCESS


162 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

169 
	mPTHREAD_PROCESS_PRIVATE
,

170 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

171 
	mPTHREAD_PROCESS_SHARED


172 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

178 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

182 
	s_±h»ad_ş—nup_bufãr


184 (*
	m__routše
) (*);

185 *
	m__¬g
;

186 
	m__ÿnûÉy³
;

187 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

193 
	mPTHREAD_CANCEL_ENABLE
,

194 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

195 
	mPTHREAD_CANCEL_DISABLE


196 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

200 
	mPTHREAD_CANCEL_DEFERRED
,

201 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

202 
	mPTHREAD_CANCEL_ASYNCHRONOUS


203 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

205 
	#PTHREAD_CANCELED
 ((*è-1)

	)

209 
	#PTHREAD_ONCE_INIT
 0

	)

212 #ifdeà
__USE_XOPEN2K


216 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

220 
__BEGIN_DECLS


225 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

226 
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

227 *(*
__¡¬t_routše
) (*),

228 *
__»¡riù
 
__¬g
è
__THROW
 
__nÚnuÎ
 ((1, 3));

234 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

242 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

244 #ifdeà
__USE_GNU


247 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

255 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

256 
__cÚ¡
 
time¥ec
 *
__ab¡ime
);

263 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

267 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

270 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
è
__THROW
;

278 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

281 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

282 
__THROW
 
	`__nÚnuÎ
 ((1));

285 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

286 *
__d‘ach¡©e
)

287 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

290 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

291 
__d‘ach¡©e
)

292 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$±h»ad_©Œ_g‘gu¬dsize
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

297 
size_t
 *
__gu¬dsize
)

298 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

301 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

302 
size_t
 
__gu¬dsize
)

303 
__THROW
 
	`__nÚnuÎ
 ((1));

307 
	$±h»ad_©Œ_g‘sched·¿m
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


308 
__©Œ
,

309 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

310 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

313 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

314 
__cÚ¡
 
sched_·¿m
 *
__»¡riù


315 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

318 
	$±h»ad_©Œ_g‘schedpŞicy
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


319 
__©Œ
, *
__»¡riù
 
__pŞicy
)

320 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

323 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

324 
__THROW
 
	`__nÚnuÎ
 ((1));

327 
	$±h»ad_©Œ_g‘šh”™sched
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


328 
__©Œ
, *
__»¡riù
 
__šh”™
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

333 
__šh”™
)

334 
__THROW
 
	`__nÚnuÎ
 ((1));

338 
	$±h»ad_©Œ_g‘scİe
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

339 *
__»¡riù
 
__scİe
)

340 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

343 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

344 
__THROW
 
	`__nÚnuÎ
 ((1));

347 
	$±h»ad_©Œ_g‘¡ackaddr
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


348 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

349 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

355 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

356 *
__¡ackaddr
)

357 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

360 
	$±h»ad_©Œ_g‘¡acksize
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


361 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

362 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

367 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

368 
size_t
 
__¡acksize
)

369 
__THROW
 
	`__nÚnuÎ
 ((1));

371 #ifdeà
__USE_XOPEN2K


373 
	$±h»ad_©Œ_g‘¡ack
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

374 **
__»¡riù
 
__¡ackaddr
,

375 
size_t
 *
__»¡riù
 
__¡acksize
)

376 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

381 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

382 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

385 #ifdeà
__USE_GNU


388 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

389 
size_t
 
__ıu£tsize
,

390 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
)

391 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

395 
	$±h»ad_©Œ_g‘affš™y_Å
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

396 
size_t
 
__ıu£tsize
,

397 
ıu_£t_t
 *
__ıu£t
)

398 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

404 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

405 
__THROW
 
	`__nÚnuÎ
 ((2));

413 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

414 
__cÚ¡
 
sched_·¿m
 *
__·¿m
)

415 
__THROW
 
	`__nÚnuÎ
 ((3));

418 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

419 *
__»¡riù
 
__pŞicy
,

420 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

421 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

424 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

425 
__THROW
;

428 #ifdeà
__USE_UNIX98


430 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

433 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

436 #ifdeà
__USE_GNU


441 
	$±h»ad_y›ld
 (è
__THROW
;

446 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

447 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
)

448 
__THROW
 
	`__nÚnuÎ
 ((3));

451 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

452 
ıu_£t_t
 *
__ıu£t
)

453 
__THROW
 
	`__nÚnuÎ
 ((3));

466 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

467 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

478 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

482 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

485 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

490 
	`±h»ad_‹¡ÿnûl
 ();

499 
__jmp_buf
 
__ÿnûl_jmp_buf
;

500 
__mask_was_§ved
;

501 } 
__ÿnûl_jmp_buf
[1];

502 *
__·d
[4];

503 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

506 #iâdeà
__ş—nup_fù_©Œibu‹


507 
	#__ş—nup_fù_©Œibu‹


	)

512 
	s__±h»ad_ş—nup_äame


514 (*
__ÿnûl_routše
) (*);

515 *
__ÿnûl_¬g
;

516 
__do_™
;

517 
__ÿnûl_ty³
;

520 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


521 #ifdeà
__ılu¥lus


523 şas 
	c__±h»ad_ş—nup_şass


525 (*
__ÿnûl_routše
) (*);

526 *
__ÿnûl_¬g
;

527 
__do_™
;

528 
__ÿnûl_ty³
;

530 
public
:

531 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

532 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

533 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

534 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

535 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

536 &
__ÿnûl_ty³
); 
	}
}

537 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

547 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

549 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

553 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

554 
__şäame
.
	`__£tdo™
 (
execu‹
); \

555 } 0)

	)

557 #ifdeà
__USE_GNU


561 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

563 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

564 
__şäame
.
	`__deãr
 ()

	)

569 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

570 
__şäame
.
	`__»¡Üe
 (); \

571 
__şäame
.
	`__£tdo™
 (
execu‹
); \

572 } 0)

	)

579 
__ex‹º_šlše
 

580 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

582 ià(
__äame
->
__do_™
)

583 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

584 
	}
}

593 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

595 
__±h»ad_ş—nup_äame
 
__şäame
 \

596 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

597 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

598 .
__do_™
 = 1 };

	)

602 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

603 
__şäame
.
__do_™
 = (
execu‹
); \

604 } 0)

	)

606 #ifdeà
__USE_GNU


610 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

612 
__±h»ad_ş—nup_äame
 
__şäame
 \

613 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

614 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

615 .
__do_™
 = 1 }; \

616 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

617 &
__şäame
.
__ÿnûl_ty³
)

	)

622 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

623 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

624 
__şäame
.
__do_™
 = (
execu‹
); \

625 } 0)

	)

636 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

638 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

639 (*
__ÿnûl_routše
è(*èğ(
routše
); \

640 *
__ÿnûl_¬g
 = (
¬g
); \

641 
nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) \

642 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

643 ià(
	`__butš_ex³ù
 (
nÙ_fœ¡_ÿÎ
, 0)) \

645 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

646 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

650 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

651 dØ{

	)

652 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

653 
__ş—nup_fù_©Œibu‹
;

657 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

659 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

660 ià(
execu‹
) \

661 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

662 } 0)

	)

663 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

664 
__ş—nup_fù_©Œibu‹
;

666 #ifdeà
__USE_GNU


670 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

672 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

673 (*
__ÿnûl_routše
è(*èğ(
routše
); \

674 *
__ÿnûl_¬g
 = (
¬g
); \

675 
nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) \

676 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

677 ià(
	`__butš_ex³ù
 (
nÙ_fœ¡_ÿÎ
, 0)) \

679 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

680 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

684 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

685 dØ{

	)

686 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

687 
__ş—nup_fù_©Œibu‹
;

692 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

694 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

695 ià(
execu‹
) \

696 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

697 
	}
} 0)

	)

698 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

699 
__ş—nup_fù_©Œibu‹
;

703 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

704 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

705 #iâdeà
SHARED


706 
	`__©Œibu‹__
 ((
__w—k__
))

712 
__jmp_buf_g
;

713 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROW
;

719 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

720 
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

721 
__THROW
 
	`__nÚnuÎ
 ((1));

724 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

725 
__THROW
 
	`__nÚnuÎ
 ((1));

728 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

729 
__THROW
 
	`__nÚnuÎ
 ((1));

732 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

733 
__THROW
 
	`__nÚnuÎ
 ((1));

735 #ifdeà
__USE_XOPEN2K


737 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

738 
__cÚ¡
 
time¥ec
 *
__»¡riù


739 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

743 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

744 
__THROW
 
	`__nÚnuÎ
 ((1));

747 #ifdeà
__USE_UNIX98


749 
	$±h»ad_mu‹x_g‘´ioûšg
 (
__cÚ¡
 
±h»ad_mu‹x_t
 *

750 
__»¡riù
 
__mu‹x
,

751 *
__»¡riù
 
__´ioûšg
)

752 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

756 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

757 
__´ioûšg
,

758 *
__»¡riù
 
__Şd_ûšg
)

759 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

763 #ifdeà
__USE_GNU


765 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

766 
__THROW
 
	`__nÚnuÎ
 ((1));

774 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

775 
__THROW
 
	`__nÚnuÎ
 ((1));

778 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

779 
__THROW
 
	`__nÚnuÎ
 ((1));

782 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

783 
__»¡riù
 
__©Œ
,

784 *
__»¡riù
 
__psh¬ed
)

785 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

788 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

789 
__psh¬ed
)

790 
__THROW
 
	`__nÚnuÎ
 ((1));

792 #ifdeà
__USE_UNIX98


794 
	$±h»ad_mu‹x©Œ_g‘ty³
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


795 
__©Œ
, *
__»¡riù
 
__kšd
)

796 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

801 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

802 
__THROW
 
	`__nÚnuÎ
 ((1));

805 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

806 
__»¡riù
 
__©Œ
,

807 *
__»¡riù
 
__´ÙocŞ
)

808 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

812 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

813 
__´ÙocŞ
)

814 
__THROW
 
	`__nÚnuÎ
 ((1));

817 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

818 
__»¡riù
 
__©Œ
,

819 *
__»¡riù
 
__´ioûšg
)

820 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

823 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

824 
__´ioûšg
)

825 
__THROW
 
	`__nÚnuÎ
 ((1));

828 #ifdeà
__USE_GNU


830 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

831 *
__robu¡Ãss
)

832 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

835 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

836 
__robu¡Ãss
)

837 
__THROW
 
	`__nÚnuÎ
 ((1));

841 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


846 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

847 
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *
__»¡riù


848 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

851 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

852 
__THROW
 
	`__nÚnuÎ
 ((1));

855 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

856 
__THROW
 
	`__nÚnuÎ
 ((1));

859 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

860 
__THROW
 
	`__nÚnuÎ
 ((1));

862 #ifdeà
__USE_XOPEN2K


864 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

865 
__cÚ¡
 
time¥ec
 *
__»¡riù


866 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

870 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

871 
__THROW
 
	`__nÚnuÎ
 ((1));

874 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

875 
__THROW
 
	`__nÚnuÎ
 ((1));

877 #ifdeà
__USE_XOPEN2K


879 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

880 
__cÚ¡
 
time¥ec
 *
__»¡riù


881 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

885 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

886 
__THROW
 
	`__nÚnuÎ
 ((1));

892 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

893 
__THROW
 
	`__nÚnuÎ
 ((1));

896 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

897 
__THROW
 
	`__nÚnuÎ
 ((1));

900 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *

901 
__»¡riù
 
__©Œ
,

902 *
__»¡riù
 
__psh¬ed
)

903 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

906 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

907 
__psh¬ed
)

908 
__THROW
 
	`__nÚnuÎ
 ((1));

911 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *

912 
__»¡riù
 
__©Œ
,

913 *
__»¡riù
 
__´ef
)

914 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

917 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

918 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

926 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

927 
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *
__»¡riù


928 
__cÚd_©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

931 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

932 
__THROW
 
	`__nÚnuÎ
 ((1));

935 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

936 
__THROW
 
	`__nÚnuÎ
 ((1));

939 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

940 
__THROW
 
	`__nÚnuÎ
 ((1));

947 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

948 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

949 
	`__nÚnuÎ
 ((1, 2));

958 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

959 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

960 
__cÚ¡
 
time¥ec
 *
__»¡riù


961 
__ab¡ime
è
	`__nÚnuÎ
 ((1, 2, 3));

966 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

967 
__THROW
 
	`__nÚnuÎ
 ((1));

970 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

971 
__THROW
 
	`__nÚnuÎ
 ((1));

974 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *

975 
__»¡riù
 
__©Œ
,

976 *
__»¡riù
 
__psh¬ed
)

977 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

980 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

981 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

983 #ifdeà
__USE_XOPEN2K


985 
	$±h»ad_cÚd©Œ_g‘şock
 (
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *

986 
__»¡riù
 
__©Œ
,

987 
__şockid_t
 *
__»¡riù
 
__şock_id
)

988 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

991 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

992 
__şockid_t
 
__şock_id
)

993 
__THROW
 
	`__nÚnuÎ
 ((1));

997 #ifdeà
__USE_XOPEN2K


1002 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1003 
__THROW
 
	`__nÚnuÎ
 ((1));

1006 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1));

1010 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1011 
__THROW
 
	`__nÚnuÎ
 ((1));

1014 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1015 
__THROW
 
	`__nÚnuÎ
 ((1));

1018 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1019 
__THROW
 
	`__nÚnuÎ
 ((1));

1026 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1027 
__cÚ¡
 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1028 
__©Œ
, 
__couÁ
)

1029 
__THROW
 
	`__nÚnuÎ
 ((1));

1032 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1033 
__THROW
 
	`__nÚnuÎ
 ((1));

1036 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1037 
__THROW
 
	`__nÚnuÎ
 ((1));

1041 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1042 
__THROW
 
	`__nÚnuÎ
 ((1));

1045 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1049 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_b¬r›¿‰r_t
 *

1050 
__»¡riù
 
__©Œ
,

1051 *
__»¡riù
 
__psh¬ed
)

1052 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1055 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1056 
__psh¬ed
)

1057 
__THROW
 
	`__nÚnuÎ
 ((1));

1069 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1070 (*
__de¡r_funùiÚ
) (*))

1071 
__THROW
 
	`__nÚnuÎ
 ((1));

1074 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1077 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1080 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1081 
__cÚ¡
 *
__poš‹r
è
__THROW
 ;

1084 #ifdeà
__USE_XOPEN2K


1086 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1087 
__şockid_t
 *
__şock_id
)

1088 
__THROW
 
	`__nÚnuÎ
 ((2));

1103 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1104 (*
__·»Á
) (),

1105 (*
__chd
è()è
__THROW
;

1108 #ifdeà
__USE_EXTERN_INLINES


1110 
__ex‹º_šlše
 

1111 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1113  
__th»ad1
 =ğ
__th»ad2
;

1114 
	}
}

1117 
	g__END_DECLS


	@/usr/include/wctype.h

24 #iâdeà
_WCTYPE_H


26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

29 #iâdeà
__Ãed_iswxxx


30 
	#_WCTYPE_H
 1

	)

33 
	#__Ãed_wšt_t


	)

34 
	~<wch¬.h
>

38 #iâdeà
WEOF


39 
	#WEOF
 (0xffffffffu)

	)

42 #undeà
__Ãed_iswxxx


47 #iâdeà
__iswxxx_defšed


48 
	#__iswxxx_defšed
 1

	)

50 
__BEGIN_NAMESPACE_C99


53 
	twùy³_t
;

54 
	g__END_NAMESPACE_C99


56 #iâdeà
_ISwb™


61 
	~<’dŸn.h
>

62 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


63 
	#_ISwb™
(
b™
è(1 << (b™))

	)

65 
	#_ISwb™
(
b™
) \

66 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

67 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

68 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

69 : (è((1UL << (
b™
)è>> 24))))

	)

74 
	m__ISwuµ”
 = 0,

75 
	m__ISwlow”
 = 1,

76 
	m__ISw®pha
 = 2,

77 
	m__ISwdig™
 = 3,

78 
	m__ISwxdig™
 = 4,

79 
	m__ISw¥aû
 = 5,

80 
	m__ISw´št
 = 6,

81 
	m__ISwg¿ph
 = 7,

82 
	m__ISwbÏnk
 = 8,

83 
	m__ISwúŒl
 = 9,

84 
	m__ISwpunù
 = 10,

85 
	m__ISw®num
 = 11,

87 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

88 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

89 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

90 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

91 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

92 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

93 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

94 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

95 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

96 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

97 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

98 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

103 
__BEGIN_DECLS


105 
__BEGIN_NAMESPACE_C99


112 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

118 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

121 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

125 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

129 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

134 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

137 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

142 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

147 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

152 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

157 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

162 #ifdeà
__USE_ISOC99


163 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

172 
wùy³_t
 
	$wùy³
 (
__cÚ¡
 *
__´İ”ty
è
__THROW
;

176 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

177 
__END_NAMESPACE_C99


184 
__BEGIN_NAMESPACE_C99


187 
__cÚ¡
 
	t__št32_t
 *
	twù¿ns_t
;

188 
__END_NAMESPACE_C99


189 #ifdeà
__USE_GNU


190 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

193 
__BEGIN_NAMESPACE_C99


195 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

198 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

199 
__END_NAMESPACE_C99


201 
__END_DECLS


208 #ifdeà
_WCTYPE_H


214 
__BEGIN_DECLS


216 
__BEGIN_NAMESPACE_C99


219 
wù¿ns_t
 
	$wù¿ns
 (
__cÚ¡
 *
__´İ”ty
è
__THROW
;

222 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

223 
__END_NAMESPACE_C99


225 #ifdeà
__USE_GNU


227 
	~<xloÿË.h
>

231 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

237 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

240 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

244 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

248 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

253 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

256 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

261 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

266 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

271 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

276 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

281 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

285 
wùy³_t
 
	$wùy³_l
 (
__cÚ¡
 *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

286 
__THROW
;

290 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

291 
__THROW
;

299 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

302 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

306 
wù¿ns_t
 
	$wù¿ns_l
 (
__cÚ¡
 *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

307 
__THROW
;

310 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

311 
__loÿË_t
 
__loÿË
è
__THROW
;

315 
__END_DECLS


	@/usr/include/asm-generic/errno.h

1 #iâdeà
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-g’”ic/”ºo-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

	@/usr/include/bits/setjmp.h

20 #iâdeà
_BITS_SETJMP_H


21 
	#_BITS_SETJMP_H
 1

	)

23 #ià!
defšed
 
_SETJMP_H
 && !defšed 
_PTHREAD_H


27 
	~<b™s/wÜdsize.h
>

29 #iâdeà
_ASM


31 #ià
__WORDSIZE
 == 64

32 
	t__jmp_buf
[8];

34 
	t__jmp_buf
[6];

	@/usr/include/sched.h

20 #iâdef 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	#__Ãed_size_t


	)

29 
	~<¡ddef.h
>

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

35 
	~<b™s/sched.h
>

37 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

40 
__BEGIN_DECLS


43 
	$sched_£¬am
 (
__pid_t
 
__pid
, 
__cÚ¡
 
sched_·¿m
 *
__·¿m
)

44 
__THROW
;

47 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

50 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

51 
__cÚ¡
 
sched_·¿m
 *
__·¿m
è
__THROW
;

54 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

57 
	$sched_y›ld
 (è
__THROW
;

60 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

63 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

66 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

69 #ifdeà
__USE_GNU


71 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

72 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

73 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

74 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

75 
ıu£
)

	)

76 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

77 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

80 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

81 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

82 
ıu£
)

	)

83 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

84 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

86 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

87 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

88 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

89 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

91 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

92 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

93 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

94 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

95 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

96 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

97 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

104 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

105 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

106 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

110 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

111 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

114 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

115 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

118 
__END_DECLS


	@/usr/include/asm-generic/errno-base.h

1 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/bits/sched.h

22 #iâdeà
__Ãed_sched·¿m


24 #iâdeà
_SCHED_H


30 
	#SCHED_OTHER
 0

	)

31 
	#SCHED_FIFO
 1

	)

32 
	#SCHED_RR
 2

	)

33 #ifdeà
__USE_GNU


34 
	#SCHED_BATCH
 3

	)

37 #ifdeà
__USE_MISC


39 
	#CSIGNAL
 0x000000fà

	)

40 
	#CLONE_VM
 0x00000100

	)

41 
	#CLONE_FS
 0x00000200

	)

42 
	#CLONE_FILES
 0x00000400

	)

43 
	#CLONE_SIGHAND
 0x00000800

	)

44 
	#CLONE_PTRACE
 0x00002000

	)

45 
	#CLONE_VFORK
 0x00004000

	)

47 
	#CLONE_PARENT
 0x00008000

	)

49 
	#CLONE_THREAD
 0x00010000

	)

50 
	#CLONE_NEWNS
 0x00020000

	)

51 
	#CLONE_SYSVSEM
 0x00040000

	)

52 
	#CLONE_SETTLS
 0x00080000

	)

53 
	#CLONE_PARENT_SETTID
 0x00100000

	)

55 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

57 
	#CLONE_DETACHED
 0x00400000

	)

58 
	#CLONE_UNTRACED
 0x00800000

	)

60 
	#CLONE_CHILD_SETTID
 0x01000000

	)

62 
	#CLONE_STOPPED
 0x02000000

	)

66 
	ssched_·¿m


68 
	m__sched_´iÜ™y
;

71 
	g__BEGIN_DECLS


73 #ifdeà
__USE_MISC


75 
şÚe
 ((*
__â
è(*
__¬g
), *
__chd_¡ack
,

76 
__æags
, *
__¬g
, ...è
__THROW
;

79 
	$unsh¬e
 (
__æags
è
__THROW
;

82 
	$sched_g‘ıu
 (è
__THROW
;

85 
__END_DECLS


89 #ià!
defšed
 
__defšed_sched·¿m
 \

90 && (
defšed
 
__Ãed_sched·¿m
 || defšed 
_SCHED_H
)

91 
	#__defšed_sched·¿m
 1

	)

93 
	s__sched_·¿m


95 
__sched_´iÜ™y
;

97 #undeà
__Ãed_sched·¿m


101 #ià
defšed
 
_SCHED_H
 && !defšed 
__ıu_£t_t_defšed


102 
	#__ıu_£t_t_defšed


	)

104 
	#__CPU_SETSIZE
 1024

	)

105 
	#__NCPUBITS
 (8 *  (
__ıu_mask
))

	)

108 
	t__ıu_mask
;

111 
	#__CPUELT
(
ıu
è((ıuè/ 
__NCPUBITS
)

	)

112 
	#__CPUMASK
(
ıu
è((
__ıu_mask
è1 << ((ıuè% 
__NCPUBITS
))

	)

117 
__ıu_mask
 
__b™s
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

118 } 
	tıu_£t_t
;

121 #ià
	`__GNUC_PREREQ
 (2, 91)

122 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

123 dØ
	`__butš_mem£t
 (
ıu£
, '\0', 
£tsize
); 0)

	)

125 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

127 
size_t
 
__i
; \

128 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

129 
ıu_£t_t
 *
__¬r
 = (
ıu£
); \

130 
__i
 = 0; __˜< 
__imax
; ++__i) \

131 
__¬r
->
__b™s
[
__i
] = 0; \

132 
	}
} 0)

	)

134 
	#__CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
) \

135 (
__ex‹nsiÚ__
 \

136 ({ 
size_t
 
__ıu
 = (
ıu
); \

137 
__ıu
 < 8 * (
£tsize
) \

138 ? ((
ıu£
)->
__b™s
[
	`__CPUELT
 (
__ıu
)] |ğ
	`__CPUMASK
 (__ıu)è: 0; }))

	)

139 
	#__CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
) \

140 (
__ex‹nsiÚ__
 \

141 ({ 
size_t
 
__ıu
 = (
ıu
); \

142 
__ıu
 < 8 * (
£tsize
) \

143 ? ((
ıu£
)->
__b™s
[
	`__CPUELT
 (
__ıu
)] &ğ~
	`__CPUMASK
 (__ıu)è: 0; }))

	)

144 
	#__CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
) \

145 (
__ex‹nsiÚ__
 \

146 ({ 
size_t
 
__ıu
 = (
ıu
); \

147 
__ıu
 < 8 * (
£tsize
) \

148 ? (((
ıu£
)->
__b™s
[
	`__CPUELT
 (
__ıu
)] & 
	`__CPUMASK
 (__cpu))) != 0 \

149 : 0; }))

	)

151 
	#__CPU_COUNT_S
(
£tsize
, 
ıu£
) \

152 
	`__sched_ıucouÁ
 (
£tsize
, 
ıu£
)

	)

154 #ià
__GNUC_PREREQ
 (2, 91)

155 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

156 (
	`__butš_memcmp
 (
ıu£1
, 
ıu£2
, 
£tsize
è=ğ0)

	)

158 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

159 (
__ex‹nsiÚ__
 \

160 ({ 
ıu_£t_t
 *
__¬r1
 = (
ıu£1
); \

161 
ıu_£t_t
 *
__¬r2
 = (
ıu£2
); \

162 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

163 
size_t
 
__i
; \

164 
__i
 = 0; __˜< 
__imax
; ++__i) \

165 ià(
__¬r1
->
__b™s
[
__i
] !ğ
__¬r2
->__bits[__i]) \

167 
__i
 =ğ
__imax
; }))

	)

170 
	#__CPU_OP_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, 
İ
) \

171 (
__ex‹nsiÚ__
 \

172 ({ 
ıu_£t_t
 *
__de¡
 = (
de¡£t
); \

173 
ıu_£t_t
 *
__¬r1
 = (
¤c£t1
); \

174 
ıu_£t_t
 *
__¬r2
 = (
¤c£t2
); \

175 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

176 
size_t
 
__i
; \

177 
__i
 = 0; __˜< 
__imax
; ++__i) \

178 
__de¡
->
__b™s
[
__i
] = 
__¬r1
->__b™s[__i] 
İ
 
__¬r2
->__bits[__i]; \

179 
__de¡
; }))

	)

181 
	#__CPU_ALLOC_SIZE
(
couÁ
) \

182 ((((
couÁ
è+ 
__NCPUBITS
 - 1è/ __NCPUBITSè* 8)

	)

183 
	#__CPU_ALLOC
(
couÁ
è
	`__sched_ıu®loc
 (couÁ)

	)

184 
	#__CPU_FREE
(
ıu£t
è
	`__sched_ıuä“
 (ıu£t)

	)

186 
__BEGIN_DECLS


188 
	$__sched_ıucouÁ
 (
size_t
 
__£tsize
, cÚ¡ 
ıu_£t_t
 *
__£
)

189 
__THROW
;

190 
ıu_£t_t
 *
	$__sched_ıu®loc
 (
size_t
 
__couÁ
è
__THROW
 
__wur
;

191 
	$__sched_ıuä“
 (
ıu_£t_t
 *
__£t
è
__THROW
;

193 
__END_DECLS


	@
1
.
1
/usr/include
725
19389
api/decvalwtsource.cc
api/documentvaluelist.cc
api/documentvaluelist.h
api/editdistance.cc
api/editdistance.h
api/emptypostlist.cc
api/error.cc
api/errorhandler.cc
api/expanddecider.cc
api/keymaker.cc
api/leafpostlist.cc
api/maptermlist.h
api/matchspy.cc
api/omdatabase.cc
api/omdocument.cc
api/omenquire.cc
api/ompositionlistiterator.cc
api/ompostlistiterator.cc
api/omquery.cc
api/omqueryinternal.cc
api/omtermlistiterator.cc
api/postingsource.cc
api/postlist.cc
api/registry.cc
api/replication.cc
api/sortable-serialise.cc
api/termlist.cc
api/valueiterator.cc
api/valuerangeproc.cc
api/valuesetmatchdecider.cc
api/version.cc
backends/alltermslist.cc
backends/brass/brass_alldocspostlist.cc
backends/brass/brass_alldocspostlist.h
backends/brass/brass_alltermslist.cc
backends/brass/brass_alltermslist.h
backends/brass/brass_btreebase.cc
backends/brass/brass_btreebase.h
backends/brass/brass_check.cc
backends/brass/brass_check.h
backends/brass/brass_cursor.cc
backends/brass/brass_cursor.h
backends/brass/brass_database.cc
backends/brass/brass_database.h
backends/brass/brass_databasereplicator.cc
backends/brass/brass_databasereplicator.h
backends/brass/brass_dbstats.cc
backends/brass/brass_dbstats.h
backends/brass/brass_document.cc
backends/brass/brass_document.h
backends/brass/brass_inverter.cc
backends/brass/brass_inverter.h
backends/brass/brass_io.cc
backends/brass/brass_io.h
backends/brass/brass_lazytable.h
backends/brass/brass_metadata.cc
backends/brass/brass_metadata.h
backends/brass/brass_positionlist.cc
backends/brass/brass_positionlist.h
backends/brass/brass_postlist.cc
backends/brass/brass_postlist.h
backends/brass/brass_record.cc
backends/brass/brass_record.h
backends/brass/brass_replicate_internal.h
backends/brass/brass_spelling.cc
backends/brass/brass_spelling.h
backends/brass/brass_spellingwordslist.cc
backends/brass/brass_spellingwordslist.h
backends/brass/brass_synonym.cc
backends/brass/brass_synonym.h
backends/brass/brass_table.cc
backends/brass/brass_table.h
backends/brass/brass_termlist.cc
backends/brass/brass_termlist.h
backends/brass/brass_termlisttable.cc
backends/brass/brass_termlisttable.h
backends/brass/brass_types.h
backends/brass/brass_valuelist.cc
backends/brass/brass_valuelist.h
backends/brass/brass_values.cc
backends/brass/brass_values.h
backends/brass/brass_version.cc
backends/brass/brass_version.h
backends/chert/chert_alldocsmodifiedpostlist.cc
backends/chert/chert_alldocsmodifiedpostlist.h
backends/chert/chert_alldocspostlist.cc
backends/chert/chert_alldocspostlist.h
backends/chert/chert_alltermslist.cc
backends/chert/chert_alltermslist.h
backends/chert/chert_btreebase.cc
backends/chert/chert_btreebase.h
backends/chert/chert_check.cc
backends/chert/chert_check.h
backends/chert/chert_cursor.cc
backends/chert/chert_cursor.h
backends/chert/chert_database.cc
backends/chert/chert_database.h
backends/chert/chert_databasereplicator.cc
backends/chert/chert_databasereplicator.h
backends/chert/chert_dbstats.cc
backends/chert/chert_dbstats.h
backends/chert/chert_document.cc
backends/chert/chert_document.h
backends/chert/chert_io.cc
backends/chert/chert_io.h
backends/chert/chert_lazytable.h
backends/chert/chert_metadata.cc
backends/chert/chert_metadata.h
backends/chert/chert_modifiedpostlist.cc
backends/chert/chert_modifiedpostlist.h
backends/chert/chert_positionlist.cc
backends/chert/chert_positionlist.h
backends/chert/chert_postlist.cc
backends/chert/chert_postlist.h
backends/chert/chert_record.cc
backends/chert/chert_record.h
backends/chert/chert_replicate_internal.h
backends/chert/chert_spelling.cc
backends/chert/chert_spelling.h
backends/chert/chert_spellingwordslist.cc
backends/chert/chert_spellingwordslist.h
backends/chert/chert_synonym.cc
backends/chert/chert_synonym.h
backends/chert/chert_table.cc
backends/chert/chert_table.h
backends/chert/chert_termlist.cc
backends/chert/chert_termlist.h
backends/chert/chert_termlisttable.cc
backends/chert/chert_termlisttable.h
backends/chert/chert_types.h
backends/chert/chert_valuelist.cc
backends/chert/chert_valuelist.h
backends/chert/chert_values.cc
backends/chert/chert_values.h
backends/chert/chert_version.cc
backends/chert/chert_version.h
backends/contiguousalldocspostlist.cc
backends/database.cc
backends/databasereplicator.cc
backends/dbfactory.cc
backends/dbfactory_remote.cc
backends/flint/flint_alldocspostlist.cc
backends/flint/flint_alldocspostlist.h
backends/flint/flint_alltermslist.cc
backends/flint/flint_alltermslist.h
backends/flint/flint_btreebase.cc
backends/flint/flint_btreebase.h
backends/flint/flint_check.cc
backends/flint/flint_check.h
backends/flint/flint_cursor.cc
backends/flint/flint_cursor.h
backends/flint/flint_database.cc
backends/flint/flint_database.h
backends/flint/flint_databasereplicator.cc
backends/flint/flint_databasereplicator.h
backends/flint/flint_document.cc
backends/flint/flint_document.h
backends/flint/flint_io.cc
backends/flint/flint_io.h
backends/flint/flint_metadata.cc
backends/flint/flint_metadata.h
backends/flint/flint_modifiedpostlist.cc
backends/flint/flint_modifiedpostlist.h
backends/flint/flint_positionlist.cc
backends/flint/flint_positionlist.h
backends/flint/flint_postlist.cc
backends/flint/flint_postlist.h
backends/flint/flint_record.cc
backends/flint/flint_record.h
backends/flint/flint_replicate_internal.h
backends/flint/flint_spelling.cc
backends/flint/flint_spelling.h
backends/flint/flint_spellingwordslist.cc
backends/flint/flint_spellingwordslist.h
backends/flint/flint_synonym.cc
backends/flint/flint_synonym.h
backends/flint/flint_table.cc
backends/flint/flint_table.h
backends/flint/flint_termlist.cc
backends/flint/flint_termlist.h
backends/flint/flint_termlisttable.cc
backends/flint/flint_termlisttable.h
backends/flint/flint_types.h
backends/flint/flint_utils.h
backends/flint/flint_values.cc
backends/flint/flint_values.h
backends/flint/flint_version.cc
backends/flint/flint_version.h
backends/flint_lock.cc
backends/flint_lock.h
backends/inmemory/inmemory_alltermslist.cc
backends/inmemory/inmemory_alltermslist.h
backends/inmemory/inmemory_database.cc
backends/inmemory/inmemory_database.h
backends/inmemory/inmemory_document.cc
backends/inmemory/inmemory_document.h
backends/inmemory/inmemory_positionlist.cc
backends/multi/multi_alltermslist.cc
backends/multi/multi_postlist.cc
backends/multi/multi_postlist.h
backends/multi/multi_termlist.cc
backends/multi/multi_termlist.h
backends/multi/multi_valuelist.cc
backends/remote/net_postlist.cc
backends/remote/net_postlist.h
backends/remote/net_termlist.cc
backends/remote/net_termlist.h
backends/remote/remote-database.cc
backends/remote/remote-document.cc
backends/remote/remote-document.h
backends/slowvaluelist.cc
backends/slowvaluelist.h
backends/valuelist.cc
bin/xapian-check-brass.cc
bin/xapian-check-brass.h
bin/xapian-check-chert.cc
bin/xapian-check-chert.h
bin/xapian-check-flint.cc
bin/xapian-check-flint.h
bin/xapian-check.cc
bin/xapian-chert-update.cc
bin/xapian-compact-brass.cc
bin/xapian-compact-chert.cc
bin/xapian-compact-flint.cc
bin/xapian-compact.cc
bin/xapian-compact.h
bin/xapian-inspect.cc
bin/xapian-progsrv.cc
bin/xapian-replicate-server.cc
bin/xapian-replicate.cc
bin/xapian-tcpsrv.cc
common/alltermslist.h
common/autoptr.h
common/bitstream.cc
common/bitstream.h
common/const_database_wrapper.cc
common/const_database_wrapper.h
common/contiguousalldocspostlist.h
common/database.h
common/databasereplicator.h
common/debuglog.cc
common/debuglog.h
common/document.h
common/documentterm.h
common/emptypostlist.h
common/esetinternal.h
common/expand.h
common/expandweight.h
common/fileutils.cc
common/fileutils.h
common/getopt.cc
common/gnu_getopt.h
common/inmemory_positionlist.h
common/internaltypes.h
common/leafpostlist.h
common/msvc_dirent.cc
common/msvc_dirent.h
common/msvc_posix_wrapper.cc
common/msvc_posix_wrapper.h
common/multialltermslist.h
common/multimatch.h
common/multivaluelist.h
common/noreturn.h
common/omassert.h
common/omdebug.cc
common/omdebug.h
common/omenquireinternal.h
common/omqueryinternal.h
common/omtime.h
common/ortermlist.h
common/output.h
common/pack.h
common/positionlist.h
common/postlist.h
common/progclient.h
common/registryinternal.h
common/remote-database.h
common/remoteconnection.h
common/remoteprotocol.h
common/remoteserver.h
common/remotetcpclient.h
common/remotetcpserver.h
common/replicatetcpclient.h
common/replicatetcpserver.h
common/replication.h
common/replicationprotocol.h
common/rset.h
common/safe.cc
common/safedirent.h
common/safeerrno.h
common/safefcntl.h
common/safesysselect.h
common/safesysstat.h
common/safesyswait.h
common/safeunistd.h
common/safeuuid.h
common/safewindows.h
common/safewinsock2.h
common/serialise-double.cc
common/serialise-double.h
common/serialise.h
common/socket_utils.cc
common/socket_utils.h
common/str.cc
common/str.h
common/stringutils.cc
common/stringutils.h
common/submatch.h
common/tcpclient.h
common/tcpserver.h
common/termlist.h
common/unaligned.h
common/utils.cc
common/utils.h
common/valuelist.h
common/valuestats.h
common/vectortermlist.h
common/weightinternal.h
common/win32_uuid.cc
common/win32_uuid.h
config.h
examples/copydatabase.cc
examples/delve.cc
examples/quest.cc
examples/simpleexpand.cc
examples/simpleindex.cc
examples/simplesearch.cc
expand/esetinternal.cc
expand/expandweight.cc
expand/ortermlist.cc
include/xapian.h
include/xapian/base.h
include/xapian/database.h
include/xapian/dbfactory.h
include/xapian/deprecated.h
include/xapian/derefwrapper.h
include/xapian/document.h
include/xapian/enquire.h
include/xapian/error.h
include/xapian/errordispatch.h
include/xapian/errorhandler.h
include/xapian/expanddecider.h
include/xapian/keymaker.h
include/xapian/matchspy.h
include/xapian/positioniterator.h
include/xapian/postingiterator.h
include/xapian/postingsource.h
include/xapian/query.h
include/xapian/queryparser.h
include/xapian/registry.h
include/xapian/stem.h
include/xapian/termgenerator.h
include/xapian/termiterator.h
include/xapian/types.h
include/xapian/unicode.h
include/xapian/valueiterator.h
include/xapian/valuesetmatchdecider.h
include/xapian/version.h
include/xapian/version_h.cc
include/xapian/visibility.h
include/xapian/weight.h
languages/allsnowballheaders.h
languages/compiler/analyser.c
languages/compiler/driver.c
languages/compiler/generator.c
languages/compiler/header.h
languages/compiler/space.c
languages/compiler/syswords.h
languages/compiler/syswords2.h
languages/compiler/tokeniser.c
languages/danish.cc
languages/danish.h
languages/dutch.cc
languages/dutch.h
languages/english.cc
languages/english.h
languages/finnish.cc
languages/finnish.h
languages/french.cc
languages/french.h
languages/german.cc
languages/german.h
languages/german2.cc
languages/german2.h
languages/hungarian.cc
languages/hungarian.h
languages/italian.cc
languages/italian.h
languages/kraaij_pohlmann.cc
languages/kraaij_pohlmann.h
languages/lovins.cc
languages/lovins.h
languages/norwegian.cc
languages/norwegian.h
languages/porter.cc
languages/porter.h
languages/portuguese.cc
languages/portuguese.h
languages/romanian.cc
languages/romanian.h
languages/russian.cc
languages/russian.h
languages/spanish.cc
languages/spanish.h
languages/stem.cc
languages/steminternal.cc
languages/steminternal.h
languages/swedish.cc
languages/swedish.h
languages/turkish.cc
languages/turkish.h
matcher/andmaybepostlist.cc
matcher/andmaybepostlist.h
matcher/andnotpostlist.cc
matcher/andnotpostlist.h
matcher/branchpostlist.cc
matcher/branchpostlist.h
matcher/collapser.cc
matcher/collapser.h
matcher/exactphrasepostlist.cc
matcher/exactphrasepostlist.h
matcher/externalpostlist.cc
matcher/externalpostlist.h
matcher/extraweightpostlist.h
matcher/localmatch.cc
matcher/localmatch.h
matcher/mergepostlist.cc
matcher/mergepostlist.h
matcher/msetcmp.cc
matcher/msetcmp.h
matcher/msetpostlist.cc
matcher/msetpostlist.h
matcher/multiandpostlist.cc
matcher/multiandpostlist.h
matcher/multimatch.cc
matcher/orpostlist.cc
matcher/orpostlist.h
matcher/phrasepostlist.cc
matcher/phrasepostlist.h
matcher/queryoptimiser.cc
matcher/queryoptimiser.h
matcher/remotesubmatch.cc
matcher/remotesubmatch.h
matcher/rset.cc
matcher/selectpostlist.cc
matcher/selectpostlist.h
matcher/synonympostlist.cc
matcher/synonympostlist.h
matcher/valuegepostlist.cc
matcher/valuegepostlist.h
matcher/valuerangepostlist.cc
matcher/valuerangepostlist.h
matcher/valuestreamdocument.cc
matcher/valuestreamdocument.h
matcher/xorpostlist.cc
matcher/xorpostlist.h
net/progclient.cc
net/remoteconnection.cc
net/remoteserver.cc
net/remotetcpclient.cc
net/remotetcpserver.cc
net/replicatetcpclient.cc
net/replicatetcpserver.cc
net/serialise.cc
net/tcpclient.cc
net/tcpserver.cc
queryparser/lemon.c
queryparser/queryparser.cc
queryparser/queryparser_internal.cc
queryparser/queryparser_internal.h
queryparser/queryparser_token.h
queryparser/termgenerator.cc
queryparser/termgenerator_internal.cc
queryparser/termgenerator_internal.h
tests/api_all.h
tests/api_anydb.cc
tests/api_anydb.h
tests/api_backend.cc
tests/api_backend.h
tests/api_closedb.cc
tests/api_closedb.h
tests/api_collapse.cc
tests/api_collapse.h
tests/api_collated.h
tests/api_compact.cc
tests/api_compact.h
tests/api_db.cc
tests/api_db.h
tests/api_generated.cc
tests/api_generated.h
tests/api_matchspy.cc
tests/api_matchspy.h
tests/api_metadata.cc
tests/api_metadata.h
tests/api_nodb.cc
tests/api_nodb.h
tests/api_none.cc
tests/api_none.h
tests/api_opsynonym.cc
tests/api_opsynonym.h
tests/api_percentages.cc
tests/api_percentages.h
tests/api_posdb.cc
tests/api_posdb.h
tests/api_postingsource.cc
tests/api_postingsource.h
tests/api_qpbackend.cc
tests/api_qpbackend.h
tests/api_query.cc
tests/api_query.h
tests/api_replacedoc.cc
tests/api_replacedoc.h
tests/api_replicate.cc
tests/api_replicate.h
tests/api_scalability.cc
tests/api_scalability.h
tests/api_serialise.cc
tests/api_serialise.h
tests/api_sorting.cc
tests/api_sorting.h
tests/api_sortingold.cc
tests/api_sortingold.h
tests/api_spelling.cc
tests/api_spelling.h
tests/api_transdb.cc
tests/api_transdb.h
tests/api_unicode.cc
tests/api_unicode.h
tests/api_valuestats.cc
tests/api_valuestats.h
tests/api_valuestream.cc
tests/api_valuestream.h
tests/api_wrdb.cc
tests/api_wrdb.h
tests/apitest.cc
tests/apitest.h
tests/dbcheck.cc
tests/dbcheck.h
tests/harness/backendmanager.cc
tests/harness/backendmanager.h
tests/harness/backendmanager_brass.cc
tests/harness/backendmanager_brass.h
tests/harness/backendmanager_chert.cc
tests/harness/backendmanager_chert.h
tests/harness/backendmanager_flint.cc
tests/harness/backendmanager_flint.h
tests/harness/backendmanager_inmemory.cc
tests/harness/backendmanager_inmemory.h
tests/harness/backendmanager_local.h
tests/harness/backendmanager_multi.cc
tests/harness/backendmanager_multi.h
tests/harness/backendmanager_remote.cc
tests/harness/backendmanager_remote.h
tests/harness/backendmanager_remoteprog.cc
tests/harness/backendmanager_remoteprog.h
tests/harness/backendmanager_remotetcp.cc
tests/harness/backendmanager_remotetcp.h
tests/harness/cputimer.cc
tests/harness/cputimer.h
tests/harness/index_utils.cc
tests/harness/index_utils.h
tests/harness/scalability.cc
tests/harness/scalability.h
tests/harness/testmacros.h
tests/harness/testrunner.cc
tests/harness/testrunner.h
tests/harness/testsuite.cc
tests/harness/testsuite.h
tests/harness/testutils.cc
tests/harness/testutils.h
tests/harness/unixcmds.cc
tests/harness/unixcmds.h
tests/internaltest.cc
tests/perftest/freemem.cc
tests/perftest/freemem.h
tests/perftest/perftest.cc
tests/perftest/perftest.h
tests/perftest/perftest_all.h
tests/perftest/perftest_collated.h
tests/perftest/perftest_matchdecider.cc
tests/perftest/perftest_matchdecider.h
tests/perftest/perftest_randomidx.cc
tests/perftest/perftest_randomidx.h
tests/perftest/runprocess.cc
tests/perftest/runprocess.h
tests/queryparsertest.cc
tests/stemtest.cc
tests/termgentest.cc
unicode/tclUniData.cc
unicode/utf8itor.cc
weight/bm25weight.cc
weight/boolweight.cc
weight/tradweight.cc
weight/weight.cc
weight/weightinternal.cc
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/fcntl.h
/usr/include/getopt.h
/usr/include/gnu-versions.h
/usr/include/libintl.h
/usr/include/limits.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netinet/in_systm.h
/usr/include/netinet/ip.h
/usr/include/netinet/tcp.h
/usr/include/signal.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/sys/errno.h
/usr/include/sys/resource.h
/usr/include/sys/select.h
/usr/include/sys/socket.h
/usr/include/sys/stat.h
/usr/include/sys/sysctl.h
/usr/include/sys/sysinfo.h
/usr/include/sys/time.h
/usr/include/sys/timeb.h
/usr/include/sys/times.h
/usr/include/sys/types.h
/usr/include/sys/utsname.h
/usr/include/sys/wait.h
/usr/include/unistd.h
/usr/include/uuid/uuid.h
/usr/include/zlib.h
/usr/include/alloca.h
/usr/include/bits/byteswap.h
/usr/include/bits/confname.h
/usr/include/bits/dirent.h
/usr/include/bits/environments.h
/usr/include/bits/fcntl.h
/usr/include/bits/fcntl2.h
/usr/include/bits/in.h
/usr/include/bits/netdb.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/posix_opt.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/resource.h
/usr/include/bits/select.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/siginfo.h
/usr/include/bits/signum.h
/usr/include/bits/sigset.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/stat.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/time.h
/usr/include/bits/types.h
/usr/include/bits/unistd.h
/usr/include/bits/utsname.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/endian.h
/usr/include/errno.h
/usr/include/features.h
/usr/include/libio.h
/usr/include/linux/kernel.h
/usr/include/linux/sysctl.h
/usr/include/locale.h
/usr/include/rpc/netdb.h
/usr/include/stdint.h
/usr/include/sys/cdefs.h
/usr/include/sys/sysmacros.h
/usr/include/sys/ucontext.h
/usr/include/sys/uio.h
/usr/include/time.h
/usr/include/xlocale.h
/usr/include/zconf.h
/usr/include/_G_config.h
/usr/include/asm/socket.h
/usr/include/bits/endian.h
/usr/include/bits/errno.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/local_lim.h
/usr/include/bits/locale.h
/usr/include/bits/sockaddr.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/typesizes.h
/usr/include/bits/uio.h
/usr/include/bits/wchar.h
/usr/include/gnu/stubs.h
/usr/include/linux/types.h
/usr/include/zlibdefs.h
/usr/include/asm/sockios.h
/usr/include/asm/types.h
/usr/include/bits/libc-lock.h
/usr/include/gconv.h
/usr/include/gnu/stubs-32.h
/usr/include/linux/errno.h
/usr/include/linux/limits.h
/usr/include/linux/posix_types.h
/usr/include/wchar.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm/errno.h
/usr/include/asm/posix_types.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar2.h
/usr/include/linux/stddef.h
/usr/include/pthread.h
/usr/include/wctype.h
/usr/include/asm-generic/errno.h
/usr/include/bits/setjmp.h
/usr/include/sched.h
/usr/include/asm-generic/errno-base.h
/usr/include/bits/sched.h
